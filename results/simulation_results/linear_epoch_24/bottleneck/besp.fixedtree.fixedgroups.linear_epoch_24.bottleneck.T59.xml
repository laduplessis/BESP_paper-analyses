<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t319:8.944672582,(((t320:6.368029139,((t321:2.907202677,t322:2.86665599):1.720437599,(t323:4.153604462,t324:3.924993068):0.4299046096):1.691013636):1.710785197,((t325:2.348732679,t326:2.320144693):3.664140417,(((t327:2.086152606,t328:1.911652994):0.3207738891,t329:2.178439608):0.5521034828,(t330:1.770956926,t331:1.636176784):0.8838131949):2.995099924):1.730693582):0.8111819945,(t332:0.3922821174,t333:0.2919306837):7.550482048):0.01935343814):2.1700121,(((t334:0.4213690046,t335:0.4094470111):3.816090807,t336:4.119552215):1.84207021,t337:5.868098785):3.890181722):5.063037992,((((t338:4.142246757,((t339:1.894210691,(t340:1.084858558,t342:0.6638620897):0.7292624749):0.4449970135,t343:1.677900116):1.788824232):0.6625476835,t344:4.083624487):6.064298445,((t345:0.8052266394,t346:0.7074722923):7.880017477,(t347:4.709126269,t348:4.69495546):3.846719031):1.396707963):2.479228548,((t349:1.044126844,t350:1.005652086):9.329712718,(((t351:0.2770548628,t352:0.2129494755):1.001974364,t353:1.033426165):6.318254125,((t354:0.5171427129,(t355:0.4143008891,t356:0.409552933):0.02751227661):1.738179791,t357:2.103563539):5.080948843):2.717918796):1.959252111):1.187494736):10.8538144,((((t358:1.233427515,t359:0.9091319062):3.269326847,t360:4.054101285):0.2158631669,((t361:1.687434682,t362:1.642083396):2.066886256,t363:3.704362258):0.5019024775):10.3290707,((((((t364:0.1945283865,t365:0.1150869332):1.059206379,t366:1.173359561):1.433202386,(t367:2.361626918,(t368:1.524556117,t369:1.487501397):0.7787882556):0.2169438828):3.072317845,(t370:4.090763068,((t371:0.375795369,t372:0.348930363):0.7527002831,t373:1.070730852):2.86867423):1.368867071):0.6125679689,((t374:3.379807443,t375:3.361748233):2.4740404,(((t376:2.429283018,t377:2.243946719):0.6496838174,t378:2.834365208):2.549763559,((t379:4.350606979,t380:4.286627796):0.1494356145,t381:4.394941382):0.878803939):0.1879544666):0.04468247426):1.906058119,(((t382:0.7586026829,t383:0.6411141854):0.5237021716,t384:1.164522136):4.037426514,t385:4.994368784):2.007193275):6.227202005):8.781980153):0.868235037,((t386:9.900605981,(t387:0.04549998382,t388:0.04284547933):9.712957373):6.506748442,(t389:12.82949084,(((t390:0.3280115886,t391:0.125058271):1.198645423,t392:1.216991619):1.925851684,((t393:1.103890156,t394:0.9521644076):0.5212450363,t395:1.446877237):1.49567208):9.31564816):3.29457941):6.348003384):34.32527323,(((t396:1.574849317,t397:1.545670497):2.485378476,((t398:0.2023652337,t399:0.1726076376):3.609380228,(t400:1.473925121,t401:1.312807962):2.103210864):0.1689744108):7.421424518,(t402:5.516301892,(t403:0.2763118816,t404:0.1231971432):5.17538237):5.283855543):44.71799667):33.17062581,((((t405:8.395617189,((((t408:1.36934159,t409:1.098742995):2.105457684,t410:3.183433768):1.130207853,(t411:1.926965729,t412:1.724948167):2.268301172):2.978368524,(((t413:2.80438174,t414:2.783491995):2.485330765,((t415:2.702627765,t416:2.446586479):0.6964613445,((t417:0.1649120757,t418:0.1207546643):2.032261148,t419:1.976094787):0.9039533355):1.743238251):0.9176444459,t420:5.229971211):0.7143971062):0.07526412207):1.224895626,((t421:1.526074898,((t422:0.8231739953,t423:0.8162764755):0.02231957813,t424:0.6867317867):0.603717738):3.480005065,t425:4.639152947):2.072258179):5.649603783,((t426:0.4446536488,t427:0.3552272333):0.207623352,t429:0.5350999377):11.66708657):4.89481858,((((t430:2.386649379,t431:2.264096449):0.4888121769,(t432:1.714608739,t434:1.436127256):0.9625497678):9.378372214,((t435:4.258099153,t436:4.084354575):0.9463987425,t437:4.982774435):6.247902641):2.582550304,(((t438:4.7169199,t439:4.185367866):1.346134624,(t440:0.2181600615,t441:0.0904655283):5.267622026):2.665330988,((t442:5.52883598,(t443:2.722267027,t444:2.674044913):2.700341483):1.832099487,t445:7.149596425):0.6110466147):5.058554617):2.05719265):68.30588872):165.5676439,((((((((t446:3.833058452,t447:3.807527799):1.328889468,(t448:2.05035639,(t449:1.525894117,t450:1.4322972):0.4564305095):3.077151752):0.7282597255,(t451:1.129775544,t452:0.8605240008):4.171570831):2.419285924,(t453:2.776444793,t454:2.737353594):4.611910951):0.8504692339,((t455:1.257975294,((t456:0.1662598766,t457:0.05883347077):0.3170942692,t458:0.2820999819):0.6832172439):0.8862260304,t459:1.801264525):5.875300153):2.935117578,(((t461:2.549602094,(t462:1.291311779,t463:1.050856671):1.238872023):1.113797317,(t464:0.9963127297,t465:0.8931772082):1.810091648):1.424693623,t466:3.888275633):5.3622764):9.6780028,t467:18.91337379):37.34410451,((((t468:6.470045971,t469:6.453045324):3.506150148,((t470:0.8073144419,t471:0.7745311156):2.460111029,t474:2.840445665):6.561271866):6.8208978,((t475:5.921674731,((t476:0.8819464269,t477:0.6746941056):0.8639664753,t479:1.185004924):4.158680547):2.468469799,(t480:6.458035675,t481:6.378836789):1.330019724):7.584259123):25.54879151,((t482:0.922012716,t483:0.9014994557):29.33730693,((t478:0.1462690374,(t473:0.2241746424,(t472:0.07147443417,(((t460:0.01136671274,(t433:0.008579028115,(t428:0.01603200071,((t407:0.01813573758,(t406:0.05111332675,(((t341:0.2032911548,((t283:0.04091383964,(t266:0.04263438877,(t249:0.1000040758,((t167:0.09977107153,((t133:0.3320518934,(t126:0.1805073124,((((t114:0.1258249189,(((t105:0.039946236,((((t93:0.004260637109,(t38:0.08633851253,(t39:0.02328006774,t1:4.328484138):0.02538229947):4.801575343):0.8731124301,(t2:8.379303014,(t3:7.071100469,(t4:2.605071258,t5:2.36858783):4.37622101):1.282241723):1.454301701):0.04437188494,((((t6:0.2801233685,t7:0.1206478459):7.77487497,((((t8:0.4452536181,t9:0.1123801656):1.540351867,t10:1.562230127):2.390855304,((t11:3.283033985,t12:2.99554535):0.5813691445,(((t13:2.008749451,t14:1.947516183):0.5283953121,t15:2.40472604):0.6465695168,t16:3.009528527):0.192642555):0.08565451002):3.14965711,t17:6.32608314):0.3052451125):1.26831115,(t18:1.91216329,t19:1.880540258):5.810831145):0.05397801044,(((t20:2.630139945,t21:2.534527871):2.466949838,(t22:3.521867196,t23:3.318089751):1.475751662):1.761284716,(t24:5.96575174,t25:5.843608753):0.4854324952):0.6549367463):0.102541653):0.1666280413,(t26:7.101310663,((t27:1.661409856,t28:1.260626257):5.175512583,(((t29:3.315414894,t30:3.132068563):0.4802923734,(t31:2.401152549,t32:2.382508529):1.191972762):1.215397623,t33:4.755818385):1.404328004):0.2430695431):0.02813687761):0.09218741133):0.5571815275,((t34:6.613779926,((t35:6.065168891,(t36:0.6959447453,t37:0.3748564951):5.31911121):0.2473301104,(t40:2.48169951,t41:2.238229835):3.255176387):0.2443631831):0.298432956,(t42:2.408676285,t43:2.318243327):3.51870013):0.1418025118):0.1478243364,((((t44:2.219378957,t45:2.180914597):0.6726346129,(t46:2.258273911,t47:2.194738079):0.5043973568):0.514792314,(t48:1.801157391,t49:1.726782743):1.077528866):1.650540367,((t50:3.521448249,(t51:1.287905327,t52:1.253855983):2.071879583):0.9091943554,(((t53:1.06992636,t54:0.8805986599):2.567511777,(t55:1.12729531,t56:1.063110161):2.263443546):0.3279400717,(t57:3.419606662,t58:3.387499547):0.2215163818):0.08233023992):0.02410362299):0.9984578841):0.09076529679):0.3675671652,((t59:0.3008794986,t60:0.2811845394):3.467589026,(((t61:1.103070134,t62:1.08604413):0.6069324676,t63:1.402489151):1.67488445,(t64:2.319498789,(t65:1.475642588,t66:1.450902393):0.7066963872):0.7227422086):0.358676834):1.379982519):0.6787079037,(((t67:1.593576431,t68:1.548675436):0.07686013549,(t69:0.985262087,t70:0.9648530789):0.6368505866):1.133291776,(t71:0.9403805508,t72:0.8657487793):1.692205922):2.476389223):0.01293868432,t73:4.877333577):0.7108810051):1.192279177):0.4978843808,(((t74:3.2625014,((t75:1.986586208,t76:1.594001465):1.12920407,(t77:2.297693379,t78:2.283383422):0.3937831839):0.05978575004):3.625247817,(((t79:2.085948806,(t80:1.31446865,t81:1.22886443):0.6728138106):1.372337933,((t82:2.566421577,(((t83:1.846102543,t84:1.796684436):0.1964241541,(t85:1.023594995,(t86:0.7753124127,t87:0.6397010015):0.1402409812):0.9515630286):0.01080599164,(((t88:0.3369255452,t89:0.3121276349):1.067888581,((t90:1.159568136,(t91:0.8603380488,t92:0.686286391):0.2372724706):0.1292248488,t94:0.9859103788):0.07909662595):0.09498082698,t95:1.078690516):0.09411391611):0.4390298417):0.1641467949,(((t96:0.5009458304,t97:0.4044184473):0.2826322632,t98:0.6857317434):0.004915557039,t99:0.5504844237):0.7261099932):0.2549310974):1.216844886,((t100:0.1905364504,t101:0.1762373162):0.7889150292,(t102:0.6448086851,t103:0.5798476815):0.2056832948):1.709726389):1.67389923):0.1064248802,(t104:0.2500504345,t106:0.0319692438):3.881325297):0.2764890433):2.096496981):0.7405867035,((((((t107:0.6052776399,t108:0.5976277097):0.3841082214,t109:0.954431774):0.8952854065,t110:1.758949869):0.6540187566,(t111:0.3104113151,t112:0.2352781912):1.922562718):2.947788552,((((t113:0.3783366215,t115:0.08833719193):0.6936517479,((t116:0.1319562631,t117:0.1043785304):0.3936573114,t118:0.3761139965):0.1350824227):0.4565024944,(t119:0.3266406666,t120:0.258316627):0.5567009579):3.269578594,(t121:3.663778253,((((t122:0.1887585745,t123:0.1312187189):0.5213215953,t124:0.1352896674):1.749154768,((t125:0.4723601005,t127:0.1396622927):0.8013628139,((t128:0.3898925779,t129:0.1826146429):0.2108979479,(t130:0.1226796618,t131:0.05622168663):0.1695576805):0.3110537379):0.5338692623):0.1273805055,(t132:0.803613676,t134:0.3323112133):0.1001753285):0.8304883628):0.3469951208):0.2463124232):0.7821430721,t135:2.583987293):0.6610211363):6.451454441):1.655467099):1.282173031):0.3801574207,((t136:0.6347180869,(t137:0.3634486093,t138:0.3482453955):0.227467084):11.51852909,((((((((t139:0.6966955591,t140:0.6587705895):0.4067800016,t141:0.9893386268):0.3431122273,t142:1.317062878):0.4610910207,((t143:1.019743326,t144:0.7832342085):0.2413895711,(t145:0.5838291165,t146:0.570516921):0.1469614452):0.3263189005):0.3784744746,((t147:0.7419926473,(t148:0.6231063786,t149:0.5660485648):0.0775210103):0.1991682004,t150:0.8309057725):0.4229819332):2.018144158,(t151:2.703297064,((t152:0.5225169493,t153:0.3411418998):0.7808130116,t154:1.052831112):1.38745117):0.4722848783):0.01473897474,((t155:0.3507371185,t156:0.2815566733):0.7120407835,((t157:0.1006163746,t158:0.07172399582):0.1746445472,t159:0.2261295074):0.7079359221):1.745051304):0.03745511782,((t160:1.335385087,t161:1.308344213):0.948585032,((t162:0.4106623131,(t163:0.1828464444,t164:0.1464835002):0.16894637):1.504752928,(t165:0.6391177787,(t166:0.2953380102,t168:0.03205392539):0.1185451239):1.102828733):0.2942299412):0.4199541181):7.651529187):0.8494206667):5.960882664):0.8185645832,(((((((((t169:0.5491264146,t170:0.2403156558):1.29936524,t171:1.32815164):0.5908085593,(t172:0.9182009632,t173:0.8511923184):0.7572222854):0.1556299269,(((((t174:0.1411748016,t175:0.09496564884):0.03770552217,t176:0.1214253098):0.958480902,t177:1.06912486):0.01828033495,((t178:0.4102630882,t179:0.3631286417):0.4600888147,t180:0.6280272293):0.213595757):0.4627006432,(t181:0.1693390878,t182:0.1418148359):1.074225398):0.005182347771):0.0419856541,(t183:0.28471948,t184:0.1059636425):0.7892597574):0.06294750386,t185:0.8149235927):0.1712036045,(t186:0.106763362,t187:0.06320990672):0.844594607):1.713728702,((t188:0.9246227312,t189:0.5757862743):1.486240649,t190:1.97209088):0.149452376):7.227017114,((t191:3.285624731,t192:3.261086852):3.56935209,(t193:5.61103745,((t194:5.071833953,(t195:2.421196335,t196:2.374474851):2.565802465):0.04099208716,t197:4.643559659):0.2829913479):1.013359206):2.43295601):5.35202816):2.081556311,(((((t198:2.330551386,t199:2.136099943):2.544803021,((t200:0.3063932328,t201:0.263897759):2.823390515,t202:3.036439872):1.350393867):0.1169497819,((t203:2.28643268,t204:2.161613847):1.295424677,(t205:1.613815836,t206:1.54121246):1.786661185):0.8884008741):2.810271886,t207:6.953894685):6.26225718,((t208:1.299789796,t209:1.262389111):11.02873845,(((t210:3.32701349,t211:3.322235963):1.634923388,t212:4.903164391):6.177088011,(((((t213:1.940147162,t214:1.888816638):0.7039377949,t215:2.579317131):0.8515955075,(t216:2.080160608,t217:1.983048038):1.322227401):0.9164401242,(t218:3.683680953,t219:3.667030246):0.5078479924):3.578922755,(t220:6.325170062,(t221:2.463403362,(t222:0.9456364801,t223:0.882483678):1.306313681):3.851332579):1.397112437):2.924244042):1.103572676):0.8703180836):1.683209734):2.03071261):0.1492379962):1.768929815,(((((((t224:0.3089077499,t225:0.3016432322):0.842838734,t226:1.107040996):0.7199493724,t227:1.650413313):3.265078057,t228:4.849408098):8.035197435,(((t229:5.98102681,((((t230:2.614969473,t231:2.434302006):0.8479811928,((t232:1.622954251,t233:1.582614814):0.3855249018,(t234:1.407494096,t235:1.332907455):0.5554422513):1.20999048):0.05189350303,(t236:1.310596567,t237:1.209698822):1.809376459):1.488279788,t238:4.487563718):0.969830365):4.838184355,t239:10.21228512):1.7834095,(t240:6.822761417,(t241:4.759750966,((t242:1.024648312,t243:0.8486094465):3.185076974,t244:3.923493287):0.4233160559):2.030184885):5.151493674):0.1630941736):1.326164208,(((t245:3.383187507,t246:3.359453299):0.04859169574,t247:3.366118964):5.14850011,(((t248:0.5573295881,t250:0.3512682304):2.607564693,t251:2.952021916):4.106050402,((((t252:0.05541891364,t253:0.0316639281):0.6200138806,t254:0.6227436256):5.7478282,(((t255:0.4036324482,t256:0.01503911257):3.783774869,(t257:1.430035702,t258:1.305840406):2.267706068):1.575723905,(t259:2.233186884,t260:1.978328219):2.905013626):0.4324120435):0.01070900855,(t261:2.156148667,(t262:0.1385453998,t263:0.1379048203):1.792027279):3.142818856):0.5784420789):1.235860793):4.412006212):0.3739895589,(((t264:0.7266931602,t265:0.7105244909):0.2893773775,t267:0.8764757779):2.288328081,t268:3.155412856):8.338654196):2.952577184):1.059616632):0.5033542496):3.274431734):0.4697712269,(((t269:8.673072562,(((t270:3.637741492,t271:3.485444634):0.8623696069,(t272:2.790824694,t273:2.754071548):1.408358732):2.40700842,((t274:2.225819972,t275:2.221611424):3.926685882,t276:6.032185795):0.3836685865):1.630929208):0.392467057,(t277:1.935539419,t278:1.910501112):6.487466964):2.626788817,(((t279:3.71643122,(t280:3.138700142,((t281:0.7037528363,t282:0.6217852394):2.087466242,t284:2.460780803):0.252975833):0.5643428656):4.90471128,(((((t285:1.629921628,t286:1.61995818):1.332647922,(t287:1.362822476,t288:1.186478643):1.528002256):0.7225706225,((t289:0.3666138664,t290:0.07628974283):0.7160570579,t291:0.769008535):2.348678461):1.034496722,t292:4.108266228):2.950753244,t293:7.039872005):0.2228593805):0.9165564604,t294:8.174910307):1.251993515):8.008164262):0.3488961722,(((t295:4.469450904,(((t296:0.7687593209,t297:0.6875973078):0.4423568401,t298:1.050335366):1.654781401,t299:2.582868211):1.162212243):0.1367536722,(t300:0.1628342601,t301:0.1443736525):3.54002185):3.362643597,t302:6.92864862):9.749488507):0.8411657345):0.2250632472):0.8627940324):0.3447743809,((((t303:1.753993194,t304:1.494051758):4.875474169,(t305:4.720350075,((t306:0.2575618436,t307:0.2347269936):0.6467560721,t308:0.8081014434):3.222235708):1.620378567):5.977852735,t309:11.62538573):1.528474058,(((t310:3.530530892,t311:3.48491785):3.367024929,((t312:1.866720408,t313:1.607013387):2.37614179,t314:3.966391294):2.472334683):2.513197449,((t315:0.9098954519,t316:0.9074267412):2.782885974,(t317:1.171355497,t318:1.033122608):2.518015428):5.048660326):3.579238843):4.725246039):30.09055313):10.53071146):13.8703132):189.6140541);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T59.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
