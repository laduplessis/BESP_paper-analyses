<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t431:3.294023607,t432:3.255158597):4.491350032,((t433:1.700219593,(t434:0.2360069543,t435:0.1147714826):1.448497792):5.30705244,(t436:1.413007786,t437:1.32375532):5.10232554):0.5527765703):8.886046498,((((t438:0.1070152402,t439:0.06601992825):0.3214898767,t440:0.3728397482):5.858144374,(((t441:1.375694839,t442:1.314440866):0.8718299163,t443:2.173330301):3.84810274,t444:5.703116106):0.004551991294):0.466036423,((t445:1.884434773,t446:1.883449546):1.117199995,(t447:0.9116355761,t449:0.6367728605):1.920355456):3.08745242):9.089432744):2.772046017,(t450:4.901418233,t451:4.593822008):12.48684001):5.152323011,(((((t452:1.972761555,t453:1.927652511):0.1315365292,t454:1.974574874):0.3648933183,t455:1.898755022):3.647917635,t456:5.481777408):3.477161805,(((t457:0.5530512537,t458:0.3532760207):2.352878964,((t459:0.1495687423,t460:0.002060952713):1.11340623,t461:1.0778518):1.414198054):4.081677521,(t462:4.385368026,t463:4.333299659):2.088882368):1.883939939):12.62767107):54.53884454,((t464:2.697297036,(t465:2.191012102,(t466:1.716900976,t467:1.684745183):0.2809419517):0.4574842124):23.68346304,((t468:2.241466438,(t469:0.6769754726,t470:0.6213709002):1.534739523):13.86149167,(t471:7.654866533,t472:7.567845573):8.272392798):9.744858015):49.0856996):259.4580486,(((((t473:10.23989856,t474:10.21135755):1.868328192,(t475:2.116142709,(t476:0.3519974837,t477:0.2281335291):1.643967888):9.939266067):15.40336584,((((t478:0.7325010068,(t479:0.2762293976,t480:0.2143561893):0.4280623695):0.6868193317,t481:1.302213916):5.739936072,(((t482:1.541063746,t483:1.525526723):1.491041818,(((t484:0.4673565559,t485:0.432818244):0.6042387129,t486:0.8387033949):1.57613715,t487:2.363447056):0.2752982674):1.190423319,t488:3.734730352):2.802279843):4.403925359,t489:10.9398993):15.64791362):40.89946298,(t490:1.275592195,t491:1.243001335):65.7745749):109.140848,(((t492:4.852506078,t493:4.300808697):4.682394938,(t494:2.36322712,t495:2.324927951):6.422362688):32.91764854,(((((t496:0.6036019136,t497:0.6031931785):4.038786606,(t498:1.564056426,t499:1.539182829):3.038921365):1.126501989,(t500:0.3595480206,t502:0.005862249027):5.338498581):2.962439847,(((t501:0.2033184723,((t448:0.05840864449,(((t361:0.2821466137,(t349:0.1245677186,(((((t204:0.05297886468,((t172:0.06578167924,t173:0.01806653129):0.07245992005,((t106:0.03884379966,(((t99:0.1891217185,t100:0.1713265716):0.09475340959,(((t87:0.02889834851,(((t1:1.409333715,t2:1.376750711):2.586612083,t3:3.870592611):1.139383545,t4:4.794162421):1.876202292):1.01882437,(t5:3.468753031,t6:3.30187287):4.210410757):0.6947916606,(t7:1.027781638,t8:0.9582480489):7.044273507):0.691548901):0.4075396329,t9:9.069376639):0.1960734964):5.697534831,((((((((t10:2.213346703,t11:2.077557641):7.143324877,((t12:1.199708681,t13:1.197265158):7.64914579,((t14:2.891030891,t15:2.795933445):3.825652072,t16:6.558387978):1.850982669):0.252035888):0.04063588205,(t17:5.875625934,t18:5.621748255):2.784469526):0.902698581,(((t19:1.415920087,t20:1.231642915):3.905406319,(((t21:0.3807591312,t22:0.2718472104):1.82379277,t23:1.903579145):1.370890397,t24:3.254712906):1.463751952):2.636007867,(((t25:2.968893505,(t26:1.369892512,t27:1.353084212):1.573804166):1.095691406,t28:4.017950907):2.951371361,(t29:4.015151731,t30:4.014898851):2.903421753):0.2575526115):1.224420837):1.376531988,((((((((t31:0.3002294657,t32:0.2914481788):1.761063155,t33:1.888966692):1.025675995,t34:2.833528082):1.863796259,t35:4.536088007):2.231743156,(t36:4.619394583,((t37:0.5184251308,t38:0.509740565):2.464936294,t39:2.913055282):1.606953438):2.139838877):0.4564544322,((t40:6.418898219,(t41:2.324248601,(t42:2.150859265,t43:2.130725025):0.1587134718):3.997283184):0.4206269026,((t44:1.039599059,t45:0.9940666226):1.710874115,(t46:1.622634098,t47:1.610468322):0.8694135237):3.926285701):0.2541592076):0.4922165939,((((t48:0.2409613852,t49:0.1640388568):6.698719185,(t50:5.935352981,t51:5.753021228):0.8056352449):0.08816206486,(t52:1.37002293,t53:1.336055424):5.205096201):0.05997087601,((t54:1.910738496,t55:1.892757721):3.674259965,t56:5.517259393):0.952583517):0.05342225438):1.487283632,((t57:2.981249606,(t58:2.308826661,t59:2.196783669):0.6610558562):0.9762508285,(t60:0.9837595477,t61:0.8733476127):2.823240582):4.03911127):0.1447673518):0.109992901,(((((((t62:0.8377236373,t63:0.4166211061):0.5629006456,t64:0.9224405287):1.06734847,t65:1.977263333):3.06225009,t66:4.970147103):1.604429434,(t67:5.080681695,(((t68:1.111342475,t69:1.030637426):0.1833635541,t70:1.071643556):1.91249702,(t71:2.036644407,t72:1.949199053):0.9086103646):1.856625613):1.185163348):0.01254460445,(((t73:3.789589334,t74:3.620095386):1.439391931,(((t75:2.597963266,t76:2.570983032):1.967846837,((t77:1.80285846,t78:1.793591817):1.934272585,((((t79:2.089025249,t80:2.019220016):1.331865465,(t81:0.9097977842,(t82:0.2814436348,t83:0.2140775349):0.5678991881):2.3161254):0.16687202,((t84:2.915948471,t85:2.897268679):0.2327852023,(t86:2.448732679,t88:2.317438227):0.6234163857):0.08359543524):0.04721634664,((t89:2.456643822,t90:2.363694189):0.5897236012,(t91:2.337175197,(t92:0.6232483838,t93:0.2850199318):1.519867995):0.3087248035):0.01574839164):0.01903134599):0.7855220488):0.04480933327,(((t94:0.935358257,t95:0.6867078453):1.596269124,t96:1.67302643):0.2221769608,((t97:0.7045024837,t98:0.5730103053):0.9677073173,t101:1.116159496):0.1663873917):0.1963089362):0.4386888198):0.1962156055,(((t102:0.8426674578,(t103:0.5590565048,t104:0.4294097914):0.2803625628):0.2992667041,t105:0.9740267107):0.2747035969,t107:0.5563159922):0.5828054683):0.4151981169):0.384117366,t108:1.933758669):0.271762722):0.8012005757,((t109:2.517009931,((t110:1.758058212,(t111:0.6548530821,t112:0.6366204212):0.9292471182):0.5760533223,(((t113:0.3050705055,t114:0.2779858042):0.006249691205,t115:0.04229409138):1.700611854,t116:1.715418224):0.03531398845):0.07726464702):0.3523994458,t117:2.102600883):0.08944246914):1.926063071,((((t118:0.5102008992,t119:0.4225062035):1.041069041,t120:0.9444471031):0.3091600226,((t121:0.8070371481,(t122:0.474496965,t123:0.4230446421):0.2775339584):0.1914260247,t124:0.8524398001):0.2095974213):0.6088361094,(t125:1.240031912,(t126:0.7866975257,t127:0.7836716382):0.2400019867):0.4131730555):1.599479875):0.2772006322):1.054242112):1.97981426):0.1781112095,((((t128:0.5318833717,(t129:0.432318896,t130:0.2089237113):0.06739346611):3.808276383,((t131:0.1565769123,t132:0.1434172121):3.119436512,(t133:1.35801487,((t134:0.3184194817,t135:0.2682384482):0.5939036623,t136:0.8120726424):0.429743387):1.763612292):0.7256105165):1.429570348,(((((t137:0.676052018,t138:0.6590978619):0.5015000251,((t139:0.1107045399,t140:0.1065946074):0.3201043675,t141:0.3873534953):0.7250559433):3.350445687,(((t142:3.173252065,(((t143:0.5427447755,(t144:0.4631612027,t145:0.3706904311):0.01737134263):0.7050067475,((((t146:0.4492220935,t147:0.3585075578):0.1683484724,t148:0.380146081):0.2305173977,t149:0.3976789223):0.1184658964,t150:0.3439148265):0.07252964052):1.656096094,t151:2.002716374):0.157921805):0.08572783733,t152:2.094826785):0.6540380676,((((t153:0.3349798446,t154:0.2777141047):0.5129595102,t155:0.6291166967):0.1003537733,t156:0.677686939):0.00873540601,t157:0.3548610916):1.77418117):0.5363098003):0.5423354332,((((((t158:0.5921772759,t159:0.334268927):0.5812281356,t160:0.874790131):0.7079418557,t161:1.508236657):0.4780895458,t162:1.832684195):0.4560295424,(t163:1.134117927,t164:1.066916621):1.044062928):0.1804731631,(t165:1.131814826,t166:1.119983198):1.023299027):0.1857778179):0.04424088137,(((t167:0.6578630376,((t168:0.1665527332,t169:0.05313787755):0.2720887992,t170:0.2316697688):0.1505489991):0.1219388061,t171:0.4967609351):0.1213344233,t174:0.04689053547):1.435430188):0.001333293247):0.5734259762,(t175:1.400097892,((t176:0.1901957443,t177:0.1791376168):0.2019728319,t178:0.3195027805):0.8695044711):0.6020554599):0.08068989345):11.52092404,((((t179:0.3853287978,t180:0.3762462104):1.123636445,t181:1.425126904):0.898310999,((t182:1.164082,t183:1.10671752):0.4188980367,t184:1.523029346):0.6595878676):10.47366025,(((((t185:0.7865015286,t186:0.6993774333):1.007506495,((t187:0.1336704854,t188:0.0219830468):1.24903724,(t189:0.8274978384,t190:0.6811936236):0.4413607376):0.257487875):6.893877442,((t191:5.952591217,((t192:4.489377012,(t193:0.1911142959,t194:0.1116806927):4.185703835):0.4030456448,(t195:1.419664199,t196:1.356346325):3.116436893):1.025754811):0.68415504,((t197:0.8531209614,(t198:0.2356810119,t199:0.201173742):0.512846027):4.454658586,((((t200:0.1774132985,t201:0.1585256571):0.9280754025,(t202:0.5547391345,t203:0.5417363272):0.5251441977):0.1353159402,t205:0.8247165985):0.7490530624,t206:1.532161948):3.087349683):0.8566348936):1.532629437):0.02805769485,(t207:4.131116329,t208:4.078360083):2.887742214):2.790696568,((t209:5.744956506,((t210:0.2283870316,t211:0.2234819451):4.497156646,(t212:1.011242592,t213:0.9779470181):3.6195467):0.9075200906):2.27199546,(((t214:1.488199408,t215:1.258536017):0.4752379609,t216:1.664374685):4.946432649,((t217:1.511275034,(t218:0.4705365781,t219:0.4683795172):1.040395375):1.830862419,t220:3.168650978):3.224898581):0.846358774):1.392443208):1.108017696):0.4105019676):0.3322865241,(((t221:4.600057287,(t222:1.219452003,t223:1.084793676):3.324099433):4.063448372,(t224:7.038652798,(t225:1.660317338,(t226:0.1315596047,t227:0.03503988438):1.405546372):5.335465184):1.34975333):0.3994491586,(((t228:1.962510849,t229:1.921856149):2.524346477,t230:4.274833792):0.3084797136,(t231:0.439830603,t232:0.3068956657):4.076180419):3.651564573):1.395136058):1.589319771,(t233:8.806276906,((((t234:1.644608022,t235:1.530373823):5.317475611,t236:6.599202465):0.3350780879,(((t237:2.515402738,t238:2.449293121):0.8420054683,t239:3.178200368):3.012060187,(t240:3.990487466,(t241:2.269494819,t242:2.258139058):1.71583129):2.174455946):0.3809767107):0.06235690415,((t243:2.187499057,t244:1.937785388):4.16536434,(((t245:0.5117736388,t246:0.4488842775):1.752716619,(t247:1.397261633,t248:1.132333017):0.8023603779):2.884432997,t249:4.797153819):0.8010054649):0.2345274552):1.350464154):2.201896471):0.3836585512):1.267666557):7.360987546,((t250:11.91591477,(t251:10.79067466,((t252:6.778582779,t253:6.743957488):3.008091593,((t254:4.235497408,(t255:2.465483549,(t256:2.021881607,t257:1.771576158):0.4256261772):1.66857407):3.87847856,((t258:1.117761835,t259:1.103154536):3.691852767,t260:4.304798568):2.843598388):1.595613369):0.7733167955):1.116422404):5.339102806,(((((t261:5.829637621,t262:5.639373109):2.178893473,((t263:0.3270909424,t264:0.1028329661):2.165140582,t265:2.233479068):5.184482273):2.25623463,((t266:3.233182592,((t267:0.5415807883,t268:0.5253565935):0.2364495252,t269:0.513461586):2.144027681):4.064839126,((t270:2.413004282,t271:2.2792639):0.4044153237,t272:2.56072498):3.869432065):2.249932159):2.432800575,((((t273:3.779887336,t274:3.754683364):0.1508656943,(t275:3.09757408,t276:2.989742374):0.7888925324):0.6694515198,((t277:1.283705649,t278:1.024124686):2.907373169,(((t279:0.8075406314,t280:0.7993127839):2.283953769,(t281:2.664227182,t282:2.607798084):0.3030646713):0.09674723538,(t283:2.34550152,(t284:1.268878593,t285:1.150751987):0.9268160806):0.4874337455):0.6704074178):0.1218473569):6.361956787,(t286:4.52058172,((t287:0.4428428304,t288:0.4333208664):1.347037215,t289:1.770545661):2.450919142):5.193480603):0.03048936637):0.3714252651,((t290:0.6913587626,t291:0.6721755199):6.057987223,((t292:3.214521165,t293:3.201495007):0.7974802703,t294:3.993291292):2.659880214):3.067251124):2.724605123):1.002226238):0.8472729514,(t295:9.949042437,((t296:1.634853765,t297:1.524173661):3.341889809,(t298:4.483645184,t299:4.373859543):0.3541536124):4.933120569):4.3113455):0.07934720921):0.6103348807,((t300:3.451311559,t301:3.354835128):10.09340626,((((t302:3.689520545,((t303:0.07380993613,t304:0.02199472948):2.450421768,t305:2.470785826):1.139936806):2.689249092,t306:6.264482735):2.700535476,((((t307:1.331330671,t308:1.189928546):1.407456972,t309:2.56451365):1.402396595,t310:3.9221222):2.923758934,((t311:1.123200851,t312:1.092414947):2.36530159,((t313:2.187148962,t314:2.093888375):0.9771517418,((((t315:0.08515041631,t316:0.045762481):1.673773458,(t317:0.9069237847,t318:0.9036420801):0.5745067786):0.09095430304,(t319:0.1245743867,t320:0.09417292263):1.399283475):0.2818253625,t321:1.68083924):0.8818367302):0.2419579142):3.321234018):1.869166948):2.923741122,(((t322:1.231805551,t323:1.122753976):2.587341925,(t324:2.074519257,t325:2.058667897):1.298786537):0.3362427799,(t326:2.834570707,(t327:1.256523177,t328:1.040295167):1.535831856):0.7989178248):6.744696245):1.375991094):1.103668938):4.730826187):3.81492369,(((((((t329:2.791253068,t330:2.732941777):5.799654722,((((t331:0.6326350308,(t332:0.2102695604,t333:0.1613481797):0.255107714):1.722548717,t334:2.034332658):2.926372536,((t335:3.393592007,t336:3.075414598):0.8649743613,((t337:1.458122488,(t338:1.216982313,t339:1.175572162):0.2150525466):1.745144725,(t340:0.02257084738,t341:0.01116032091):3.107149684):0.4745027965):0.5872711703):1.472362022,(t342:4.142783998,(t343:3.421887096,t344:3.336863936):0.7184205435):1.427549277):1.559889516):1.002852215,(t345:6.020476094,t346:6.018561446):1.800717471):2.61008587,(((t347:0.771148697,t348:0.4933539023):2.185350939,(t350:0.2992293413,t351:0.2128150317):2.145581221):2.747892315,t352:4.869322743):4.498232806):4.428217531,(((t353:0.7568750223,t354:0.7247511959):2.489904737,((t355:2.988416834,t356:2.954792066):0.1101778361,t357:3.042901217):0.06827569212):9.469953708,((t358:1.472915246,t359:1.468640722):4.719666285,(t360:5.427119228,((t362:0.9618758884,t363:0.9157774299):2.09057436,t364:2.897953461):1.951634657):0.7372494923):6.369164062):0.7147028455):0.5854956348,(t365:7.094080215,(((t366:3.469056087,(t367:1.277195519,t368:1.244518766):2.137554287):1.717659751,(t369:1.956660796,t370:1.866198942):2.737193515):0.06480732464,((t371:1.047786922,t372:1.045310552):0.484129868,t373:1.491017075):3.09175583):1.805766635):6.085493298):1.81386898,(t374:12.88913434,((t375:5.031868068,t376:4.977428809):4.335882294,(t377:0.9260981672,t378:0.6816317255):8.176162289):3.443043339):1.340683449):2.096199066):1.795314579,(((((t379:5.348437859,t380:5.233140533):0.3745847639,t381:5.552788953):3.443681105,t382:8.915551031):1.45185281,(((((((t383:1.029221076,t384:0.9383908463):0.1709972544,t385:1.103447799):0.127770238,t386:0.9887432956):1.410814206,t387:2.359058658):1.993884807,(((t388:0.7677383373,t389:0.7439585074):1.305302309,t390:1.756127849):1.138085321,(t391:1.646829568,t392:1.433934926):1.092578245):1.091709159):3.141113447,(t393:0.8244149999,t394:0.8076766685):5.903371677):2.097247167,t395:8.760755647):0.2129554349):0.1358319606,((t396:2.864691516,(t397:2.047808867,t398:1.859909348):0.6460582162):1.578257537,t399:4.069136665):4.654781706):6.771295447):2.703646554):16.95207597,((t400:3.043601964,t401:3.027462657):11.89792291,((((t402:2.080655662,(t403:0.241812211,t404:0.1475531561):1.387297325):5.532673076,((((t405:1.829622982,t406:1.75142176):0.4315192148,t407:2.093115144):3.896135979,t408:5.818973999):0.5840148813,((t409:4.849481348,(t410:0.3175332884,t411:0.2869691423):4.502233995):1.23022001,((t412:2.451345632,(t413:1.046111681,t414:1.03252269):1.312031298):0.7989675905,(t415:1.222505083,t416:1.166985312):1.789602857):2.688088841):0.1979528857):0.2341707943):2.839772122,(((t417:5.777666738,(t418:2.216857172,((t419:0.5712594249,t420:0.5667326221):1.324698124,t421:1.879929738):0.249131064):3.470478649):0.1321969173,t422:5.719298415):2.134788644,t423:7.714216638):0.7817525293):3.719813252,(((t424:0.5015747831,t425:0.4722683676):4.740368444,t426:5.081490485):2.19334354,((t427:0.5548239479,t428:0.5198341168):3.635216288,(t429:0.1837477189,t430:0.08647828352):3.912381523):3.052796323):4.769022874):0.613316879):20.12973669):15.96429791):133.6305541):156.5449752);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T80.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
