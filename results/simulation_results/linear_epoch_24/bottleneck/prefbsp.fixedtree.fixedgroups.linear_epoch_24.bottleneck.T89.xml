<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t475:5.19982974,((t476:0.1323602557,t477:0.1115156769):1.437489572,t478:1.530613646):3.564503761):16.5585003,(t479:3.998172426,t480:3.926939938):17.64722347):49.48864166,(((t481:2.386177389,(t482:1.953224696,(t483:0.7520089899,t484:0.6931830533):1.068167072):0.3973555313):14.94867544,(t485:16.06990386,(t486:2.089054971,(t487:0.6232522378,t488:0.2280074606):1.421433434):13.87454131):0.8991954827):35.02254047,((((t489:8.525035368,t490:8.483963918):2.146546461,(t491:1.64828983,(t492:1.310941522,t493:1.305954343):0.2440489988):8.938800387):20.54043161,(t494:4.570230741,t495:4.505214477):26.41334284):19.29881763,((((t496:1.604653239,t497:1.586852819):5.32010507,(t498:4.137034956,(t499:0.5609491693,(((((t451:0.07953791337,((t424:0.07543830672,((t388:0.000438752376,(t383:0.04633220659,((((((t273:0.4013420733,((t264:0.0782847559,((t215:0.07925471821,(((t204:0.001088622048,(t178:0.08569384468,(t179:0.02008119882,(t176:0.3561477688,(t174:0.03307326708,(t158:0.02069872612,(t152:0.1004912102,(((((t125:0.01193820218,(t117:0.1367467899,((t113:0.01836525047,(t111:0.06647973385,((t74:0.325292084,((t53:0.005060627096,(((t4:0.02486396914,t1:0.3988731183):3.479334211,t2:3.833443882):0.9789692007,(t3:4.417793601,(t5:1.029232522,t6:1.019120063):3.00239257):0.3522092479):0.1358244553):1.098342089,(t7:3.089591311,t8:3.061258675):2.498524481):0.3503546866):1.496114223,t9:7.338723394):1.580021011):0.1119334571):0.04622521939,(((t10:7.124195122,(t11:3.628674522,t12:3.549258605):3.228191307):1.590255308,(((t13:2.794324963,(t14:1.030442215,t15:0.9416794289):1.75856362):4.75668335,((t16:0.3127742814,t17:0.3043908788):4.440185569,(t18:4.50555825,(t19:0.3233080987,t20:0.2071093727):4.008727358):0.2210833609):2.626053491):0.6688555657,(t21:7.378976517,(t22:7.090595915,t23:7.027202465):0.2309027022):0.07709416191):0.007225385945):0.06761751893,(((t24:5.101581428,t25:4.90119531):1.127744297,(t26:2.668368032,t27:2.565370814):3.300405209):0.2954629593,(((t28:1.945048481,t29:1.938251129):1.794325534,t30:3.585261523):1.145796082,(t31:1.067801361,t32:1.061830309):3.504835739):1.2353564):0.7904326908):0.01313842406):0.1972729468):0.6636659604):0.07827133241,((t33:0.9567296422,t34:0.829943352):5.400711541,((t35:2.071004016,t36:2.043682752):3.412955899,(t37:4.174583903,(t38:3.175768282,t39:3.025566968):0.9245543866):1.125474139):0.4831413325):1.157932772):0.07614561415,(((((t40:1.027676256,t41:0.9854904204):4.092861995,t42:5.013870548):0.123296261,t43:5.027192776):0.3858638427,((t44:1.959397969,t45:1.832695653):0.7043403197,(t46:1.734213273,t47:1.717731674):0.7943757652):2.652335622):0.4496979322,(t48:0.3639949126,t49:0.3168101389):5.20286032):0.5973618705):0.3629663124,(((t50:4.899091035,(t51:4.780167983,((t52:0.8921982727,t54:0.6188942941):2.760189672,((t55:0.3803389368,t56:0.3632791352):1.299136903,t57:1.646964194):1.661247525):1.087396146):0.03575579875):0.1006429183,t58:4.5268897):1.20997419,(t59:5.247316189,(((t60:1.54471156,t61:1.458418411):2.74972166,t62:4.179472145):0.300737824,t63:4.428391824):0.6497598995):0.4467242364):0.03695676233):0.3201116525,(((t64:1.617094246,t65:1.422739158):2.985427374,((t66:0.4594714285,t67:0.4247306666):3.381139863,t68:3.781969895):0.4446046632):0.8371432966,(((((t69:0.5402374451,(t70:0.5233909105,t71:0.4423369494):0.01474610236):3.459084465,((t72:1.168342404,t73:1.141757852):2.25667666,((t75:2.029437687,(t76:1.689769473,(t77:1.411106723,t78:1.284670609):0.1883996003):0.2004586126):0.4366934915,t79:2.085292385):0.5896855842):0.3946682585):0.06790273021,((t80:2.537180979,(t81:0.6492126519,(t82:0.3039241492,t83:0.1375933796):0.2069654503):1.782122046):0.07589301885,t84:1.92691056):0.3888319012):0.1622598357,t85:2.458981106):0.175323325,(t86:1.87482116,t87:1.817453177):0.6822725972):0.6438951052):0.4281211573):0.9749618513):0.4427483334):1.759861991):0.4791040134):0.1671397082):0.04215569891):2.796260321):0.5450528636,((((((((t88:1.455362266,t89:1.355689832):0.02743388291,t90:1.379858232):0.02372305771,t91:1.37075629):0.3891118269,(((t92:1.267821041,t93:1.190041344):0.3438461049,t94:1.436916575):0.05546676829,t95:1.488188654):0.06731366751):1.396483963,(((t96:1.186856006,((t97:0.6101629158,t98:0.4989000048):0.2357717017,(t99:0.1427055248,t100:0.1424992322):0.5734036738):0.2351365669):0.4600367219,((t101:0.8658325768,t102:0.7750805433):0.4024336521,((t103:0.5102610312,t104:0.4358210176):0.155050405,t105:0.5092359023):0.4508513323):0.078406973):0.4410882036,(t106:0.4992964107,t107:0.4511232951):0.8620226777):0.8377303909):2.64195349,((t108:1.612611653,(((t109:0.1693438336,t110:0.1161580014):0.1176727436,t112:0.002056300757):1.079969509,(t114:0.8585436581,t115:0.8433023104):0.1825309466):0.1750808719):0.3572359181,(t116:0.8303935869,t118:0.5912966878):0.6689850735):2.783766867):0.7988148829,((t119:2.037149372,(t120:1.424715665,(t121:0.6164000835,t122:0.6150013082):0.4315488492):0.603757579):2.580730652,((t123:0.09917239432,t124:0.09834458685):0.521033677,t126:0.4264382211):3.521739631):0.1931933934):2.853659472,(((((((((t127:0.3631148037,(t128:0.09679688307,t129:0.09660122756):0.1688886721):0.7274822582,t130:0.9663815777):0.5218946562,t131:1.421947286):0.4439394472,((t132:0.5388125796,t133:0.4970212732):0.09509567177,(t134:0.3095883992,t135:0.1465665446):0.2609515838):1.108239267):2.115588159,((((t136:0.2305781622,t137:0.2272556484):0.04785290001,t138:0.249589204):0.9183563446,(((t139:0.3310649669,(t140:0.211398922,t141:0.1078750734):0.0951648279):0.2192052091,(t142:0.2239515404,t143:0.1904579136):0.1649515065):0.156274918,(t144:0.3855073217,t145:0.2570516311):0.1035041742):0.2497237932):1.650950294,((t146:1.280387265,((t147:0.7342744063,((t148:0.07999786904,t149:0.07064443204):0.07419980153,t150:0.03802987985):0.5066181066):0.4170813107,t151:0.9521251732):0.09084154732):0.0698529234,t153:0.9803125269):0.9084681305):0.689147407):1.253470623,(((t154:0.3191976422,t155:0.2808039799):0.3606852488,t156:0.5127180204):1.678096501,((((t157:0.2965558041,t159:0.05132584042):0.3441872598,t160:0.3020866305):0.230121641,t161:0.5311489684):0.3695138025,t162:0.8857816104):0.9035788294):1.455955548):0.04037720647,(((t163:0.9711766502,t164:0.8483024676):1.15598203,((t165:0.2732761225,t166:0.2414305165):0.5832623294,t167:0.7754657642):1.147198878):0.2100492321,(t168:0.9189609457,(t169:0.5063045657,((t170:0.3271725361,t171:0.287244816):0.1481283867,t172:0.1236418241):0.01489876787):0.3606584581):1.199716979):0.4178608232):0.7905072029,t173:2.878096112):0.6082180275,(t175:2.442655477,((t177:1.025263451,(t180:0.4603667507,t181:0.3471713164):0.2410271596):0.267395555,t182:0.642590676):0.6304606803):0.6115760919):0.03020895622):0.924034025):0.1012982356,(t183:1.084139014,t184:0.6554157569):1.793404327):0.358326396):0.02061665356,t185:2.814692707):4.230413012):0.1068047221,(((((t186:0.8676032727,(t187:0.3222338044,t188:0.1924485913):0.4438241944):0.6811461149,t189:1.168560106):0.3547617845,((t190:0.3544138192,t191:0.2864094127):0.1345776527,t192:0.3426252775):0.9175515235):0.4469688807,(t193:0.8278571273,(t194:0.5004104692,t195:0.4641462117):0.2476686583):0.8288015586):3.198031344,(t196:1.536655051,t197:1.491415755):3.030380531):1.414816335):1.433504466):0.3444955259,((t198:0.7493020743,(t199:0.5454853013,(t200:0.3735501891,t201:0.3676497698):0.1399845644):0.0834296957):4.295602082,(t202:1.435232005,((((t203:0.2640125942,t205:0.03289312769):0.3090193745,t206:0.0759752409):0.3551915995,(t207:0.06663465018,t208:0.06503266592):0.2510195955):0.230940989,t209:0.4287777608):0.1607300704):3.277224925):2.559819092):5.944853486,(t210:11.51855286,(t211:9.629510616,(t212:6.359045508,((((t213:0.1934230768,t214:0.1729375033):0.2340968768,t216:0.2979475356):3.979801244,t217:4.252132406):1.458011036,(t218:3.741458992,((t219:2.955278514,t220:2.907122104):0.2209975498,t221:3.065527806):0.5479073609):1.934445994):0.4257878118):3.218893212):1.82880409):0.8460310415):1.339317433,((((t222:4.428159018,t223:4.320880833):4.978290342,((((t224:3.423107226,t225:3.393300605):3.019180819,(t226:4.658217038,t227:4.638899798):1.706300152):1.587752221,t228:7.801892575):0.3999306743,((t229:2.535360277,((t230:2.054904743,t231:1.83725658):0.2853702068,t232:1.784632102):0.1718835643):0.4658612148,t233:2.271796284):5.061323352):0.8003248052):1.627494151,t234:9.582000335):1.222403273,((((t235:0.1892392329,t236:0.06950290929):2.556217934,t237:2.619669967):1.838196529,t238:4.1748772):0.3087443986,(t239:3.148852721,t240:3.11524872):1.265845548):5.808440597):0.8521264238):0.3811204133,(((t241:6.68462657,(t242:4.22471978,t243:4.205325732):2.380555415):2.86854121,t244:9.436314537):1.121906345,t245:10.42888038):0.735429127):2.624050254,((t246:2.970904082,(t247:1.156769466,(t248:0.5025867101,t249:0.2176642602):0.4979219286):1.812365998):1.894370251,(t250:1.788661099,t251:1.667573692):2.530159528):8.899010136):1.110480297):0.4718209363):2.265422445,(((((t252:3.697366237,(t253:1.599044857,(t254:1.320404631,t255:1.299608393):0.2519643929):2.047338972):3.254443126,(t256:2.970616686,t257:2.964425721):3.851382145):0.6680130046,(t258:2.507787198,t259:2.497455965):4.962554329):1.631281864,((t260:4.660826085,(((t261:1.487686851,t262:1.398816441):1.886657043,(t263:0.8791488864,t265:0.7254484565):2.351351624):1.224350458,t266:3.931690474):0.0331635835):2.182067209,(t267:1.5721054,t268:1.299494435):4.51491861):1.990411625):2.01710531,((((t269:0.7633574306,t270:0.654450965):0.3253874864,t271:0.9143626923):3.328324523,t272:4.07273117):1.960242952,t274:5.515743538):3.426557731):5.469037318):0.7115448839):2.687187647,((t275:1.418372767,t276:0.9953520283):3.877519434,(t277:2.331552411,t278:2.322167652):2.53082548):12.49926833):0.808535805):2.306529333,(((((t279:6.420427065,((t280:1.877546542,t281:1.814808847):3.579635291,t282:5.257683944):0.9163953404):7.371359855,(((t283:0.7849147543,t284:0.7332520783):3.721870438,(((t285:1.266520305,((t286:0.2531699332,t287:0.2248070918):0.8122035633,t288:0.8428141013):0.1988979729):1.944327257,(t289:2.11782248,t290:2.107159375):0.8668121029):0.1354695998,((t291:0.9914889661,t292:0.8345061153):0.828578313,t293:1.579809404):1.257645573):1.052497679):8.420414818,((((t294:1.429970091,t295:1.207754335):3.311229333,(((t296:0.4018959691,t297:0.3043606169):1.156335219,t298:1.314075157):2.249390013,t299:3.513755854):0.6770059278):3.404075112,t300:7.554680396):1.334999458,(((t301:0.1894252002,t302:0.08263438057):2.676620239,(t303:1.987723497,t304:1.986744247):0.5054517013):0.1548851557,(t305:0.8261007207,(t306:0.5656364261,t307:0.5270528583):0.2506335301):1.65607826):5.777554948):2.461986282):0.4730725724):0.2606527508,(((t308:5.469943896,t309:5.393879044):3.25162832,(((t310:4.857091751,t311:4.565914609):1.395775073,(t312:3.20087919,(t313:2.961572686,t314:2.484751249):0.1666667396):2.695953252):1.558081792,t315:6.751532141):0.5377808257):2.498782504,(((((t316:0.5841577084,t317:0.5557198024):1.775515925,t318:2.097048124):0.7695835653,t319:2.718996327):1.1274449,t320:3.844459177):2.195599016,t321:5.837869467):3.172826158):0.1698766637):3.413819801,t322:12.19907208):0.9947403884,(((((((t323:1.347834191,t324:1.108537494):3.496291784,t325:4.427731306):0.372009623,(t326:2.192391242,t327:2.061993685):2.579750645):0.2312244003,t328:4.822237323):2.590231603,((t329:3.811964304,t330:3.658890292):0.8691064888,((t331:0.3452221007,t332:0.04687727672):1.324311139,t333:1.360620043):2.794796507):2.526560599):1.522874351,(t334:7.782150505,t335:7.529915224):0.3545273087):2.666385977,((t336:6.991861107,((t337:1.988530887,(t338:1.89949624,t339:1.527297586):0.05472682632):2.560083655,t340:4.131959472):2.440029521):1.414001832,(((t341:2.600500059,t342:2.523981865):0.3421958822,(t343:0.3033950661,t344:0.07120649622):2.468907839):2.280663352,((t345:2.725469521,t346:2.628328384):1.764812061,t347:4.385649817):0.1976705043):2.746213261):2.041939241):0.9590111438):1.981444862):0.3932772437,(((t348:1.904330415,t349:1.902738755):1.924127947,((t350:0.1766936105,t351:0.02064042973):0.1410106038,t352:0.1513815383):3.50201041):2.340660856,((t353:1.587600236,(t354:0.2084803427,t355:0.174210519):1.065491781):0.6780179611,(t356:1.564164082,(t357:1.409964292,t358:1.291444338):0.07855761767):0.33009086):3.671384383):6.521920239):1.334968871,(((t359:0.2684955144,t360:0.04541408402):4.733114516,((t361:0.09034526452,t362:0.07535057479):4.381982606,t363:4.440633375):0.3003199911):2.70410347,((t364:4.165383098,t365:3.878043137):2.826894375,((((t366:0.06798701557,t367:0.02665988739):2.027385498,t368:2.031332014):0.4875561667,(t369:1.701641566,t370:1.630678095):0.5958948859):3.036827903,(t371:2.539735399,t372:2.438402973):2.701768817):1.073157586):0.4360980706):5.468507962):0.07803439229,(((t373:2.383948758,t374:2.33777755):0.8320138008,(t375:0.5235395423,t376:0.5022169841):2.633529492):8.87578475,((t377:6.390405554,(t378:1.350706851,(t379:0.8967081663,t380:0.7592209769):0.3135356678):4.988566828):4.479035321,t381:10.51773859):0.7378062826):0.06951513147):0.2427365608):3.567056389):2.767776911):8.289361763,((((t382:1.429307608,t384:1.018670246):2.472154158,t385:3.423308995):12.3949419,((((t386:4.719767331,((t387:2.87931128,t389:2.634383699):1.554854473,(t390:1.497874469,t391:1.454032928):2.476266808):0.2726889315):0.03711253206,(t392:3.842220033,t393:3.801937551):0.2823249351):4.902961898,((t394:0.5548855051,t395:0.5533299356):7.355003572,t396:7.731359762):1.061166043):4.596956864,((t397:1.267013562,t398:1.099403291):9.290582185,t399:10.31580949):2.570666747):1.439817589):7.903267195,(((((t400:7.863553761,((t401:5.201167333,(t402:3.741499495,((t403:2.414879505,(t404:2.251118826,t405:1.948937552):0.1334429886):0.4785251667,t406:2.557816313):0.8106461793):1.380385866):1.87336961,(t407:6.147342039,(t408:5.451609294,t409:5.450710929):0.6707327625):0.3306062844):0.5696150164):3.246367283,t410:10.23928771):3.615635326,((t411:1.013072014,((t412:0.7883420074,t413:0.6561482479):0.135625907,t414:0.7892430646):0.05794208479):0.6588690237,t415:1.500883274):12.1567588):1.249209557,((((t416:2.629086926,t417:2.610957406):1.498517791,(t418:2.264498941,t419:2.206097316):1.780931635):0.9731569822,t420:4.957262356):4.036009194,((t421:5.147842947,t422:5.094208074):2.209841742,(t423:6.087997717,((t425:4.075188255,(t426:2.420192513,(t427:1.137381623,((t428:0.2217356789,t429:0.1738548045):0.1980794832,t430:0.2757456726):0.4418363377):1.218281779):1.423463267):0.287115403,t431:3.615809025):1.587677729):1.161274499):1.623844891):5.563972091):5.853514293,(t432:4.079039291,((t433:1.968068589,t434:1.78010691):1.485880331,t435:2.952589268):0.2774181029):15.2183352):0.3192243512):1.966607726):2.377692574,((((((((t436:0.1933343745,t437:0.1167217134):2.808442792,((t438:0.1662766069,t439:0.1617734993):0.3269226625,t440:0.4587809059):2.154052651):0.7881388406,t441:3.335058125):0.002878400164,t442:3.333686406):1.726994735,(t443:2.725134349,t444:2.471868492):2.242409813):0.1412158395,(t445:4.509862353,((t446:0.6185880768,t447:0.3287007221):1.975103168,t448:2.263687818):1.888928559):0.2445969374):8.649266479,((t449:1.233193746,t450:1.208638808):4.536027226,(t452:0.1367546694,t453:0.1097190107):5.492502438):7.012184521):2.864644365,(t454:2.073525373,t455:1.956171742):13.4033226):5.848035688):32.60885875):0.78589937):18.62541899):22.93023044,((((t456:0.4064447907,t457:0.09382092623):1.415210717,t458:1.272561868):12.96648795,t459:14.15366911):15.41762584,(((t460:2.275569607,t461:2.243046119):2.010556517,t462:4.147728353):3.357203405,(t463:2.75239441,t464:2.72963342):4.681922343):21.60268432):65.865108):51.50262058,(((((t465:1.003521767,t466:0.9776547146):0.5534103442,(t467:1.084524973,t468:1.078191392):0.3986204126):3.425565611,((t469:1.151567705,t470:1.134477319):1.064478061,t471:2.090437869):2.584967134):1.18540967,(t472:1.362637003,t473:1.198854203):4.42157934):11.31755245,t474:16.92154949):128.8034793);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T89.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
