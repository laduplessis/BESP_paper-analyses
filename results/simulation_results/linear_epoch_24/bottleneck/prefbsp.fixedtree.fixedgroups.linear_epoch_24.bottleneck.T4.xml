<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t243:5.647897343,((t244:2.739945743,(t245:2.020856247,t246:1.948205022):0.6891123929):2.030255106,t247:4.667529003):0.8732491741):2.500373046,(t248:0.4940391814,t249:0.4109189602):7.415671954):0.01972314055,t250:7.779793593):8.894167404,((((t251:4.405138209,(t252:4.142067672,((((t253:2.159326904,t254:2.047916783):0.7820039821,(t255:1.315609475,t256:1.111697512):1.503917031):0.09101408259,t257:2.434849708):0.8234310497,t258:3.21316316):0.2674034761):0.2074505305):1.578661398,(t259:0.4468431381,t260:0.4144912857):4.696837017):0.2219844685,t261:5.077096612):1.704570806,((t262:2.168061886,(t263:0.5569739497,t264:0.4947755534):1.527791327):4.564416888,(t265:5.753534583,((t266:3.353467024,((t267:0.7631166867,t268:0.7424312793):1.379481692,t269:2.090533822):1.208218662):1.489958682,(t270:2.696424533,t271:2.621036717):2.02043325):0.8140699557):0.761701591):0.03309963176):8.750088659):0.8865436511,((((t272:1.086449961,t273:0.9452152733):1.139160182,(t274:0.3260895302,t275:0.2923407228):1.628813688):0.6717983292,t276:2.584240895):9.911059625,(t277:5.969015692,((t278:2.002423488,t279:1.82696104):0.4916613719,(t280:0.8411608468,t281:0.8169455015):1.298979797):3.431890236):6.45239099):3.077263259):17.95006773,(((((((t282:2.174222355,(t283:0.5011285047,t284:0.4601470383):1.633227447):0.1515690414,t285:2.20627777):8.446042453,(t286:8.600485639,t287:8.21613881):1.832718581):0.7729500026,(((t288:3.025187793,(t289:2.542466451,((t290:0.7360433184,t291:0.7259789255):0.3559463183,(t292:0.3405551435,t293:0.2398985172):0.7344726611):1.416105064):0.4676203891):1.824731462,((t294:3.201115541,t295:3.146669765):1.130582428,(t296:2.93672329,((t297:0.482599092,t298:0.4022402398):0.9595593267,t299:1.113993688):1.444945896):1.156532039):0.3465437594):2.895890053,((t301:2.394952169,(t302:1.133182925,t303:1.09317353):1.206280216):1.18155239,(t304:0.2030342275,t305:0.188591656):3.158007384):3.16989471):3.031154959):7.238426342,(((((t306:1.45049234,t307:1.390728564):7.512204885,((t308:8.533776175,t309:8.237116086):0.2105378785,(((t310:2.512505195,t311:2.311848544):1.480891354,t312:3.667953405):3.09249615,t313:6.551536456):1.355107216):0.1077038736):0.9954906948,((((((t314:2.343372563,t315:2.066218823):0.4098229426,t316:2.396737733):2.115683676,t317:4.337419674):0.0330405999,(t318:3.151237149,((t319:1.212592857,(t320:0.7871007533,t321:0.6854058602):0.3515418298):0.5771631393,t322:1.518369819):1.309860417):1.19480012):0.00568099805,(t323:2.124466531,(t324:0.3787847988,t325:0.2171439047):1.633968769):1.892857903):1.370626753,t326:4.911089528):2.711431078):1.295013133,((t327:4.445927966,(t328:3.020033556,(t329:1.616612215,(t330:0.6975185511,(t331:0.668040597,(t332:0.4649620972,t333:0.4510196427):0.07589837191):0.02380480734):0.8886431827):1.378548808):1.184846958):1.559440786,t334:5.499057556):2.814519984):1.423224233,((t335:6.592084775,(t336:3.501914219,(t337:0.5040268268,t338:0.4136619073):2.846726033):3.08987396):2.617570417,t339:8.89139898):0.5120923656):4.061071379):2.17567683,((((t340:1.442244676,t341:1.405561527):6.735121896,((t342:2.704478846,t343:2.611543627):2.50823731,t344:5.080481492):2.889542695):2.044211397,t345:9.805418675):4.047106339,(t346:7.60119047,t347:7.527726925):6.235611268):1.327237852):6.684235836,((((((t348:0.1084643405,t349:0.02357521217):1.002653033,t350:0.8499648587):0.1715762841,(t351:0.8600639029,t352:0.6714597832):0.1390899518):0.2245021145,t353:0.9562887263):5.916019137,((((t354:2.678081261,t355:2.521226853):0.9187624099,t356:3.406633884):2.266456978,(t357:1.909398907,(t358:0.3815457902,t359:0.3288970228):1.518548159):3.755273348):0.4454892446,(((t360:0.3878370168,t361:0.2386141553):1.71632102,t362:1.520623482):1.830951058,t363:3.340954701):1.859975397):0.5212283934):1.41421913,(t364:3.964782529,(t365:0.1803602015,t366:0.09138469557):3.678572038):3.143091691):12.52685297):5.144857117):36.95324608,((((t367:6.718043477,(t368:1.113320615,t369:0.8241073867):5.586128572):4.172920456,((t370:4.004215191,((((t371:0.7713139124,t372:0.6283213479):0.1946897121,(t373:0.2977974034,t374:0.2193739658):0.4746551869):0.8743682738,(t375:1.196554442,((t376:0.2649233366,t377:0.1482573908):0.7627097962,t378:0.9061310379):0.0665057742):0.1076308733):0.7295597031,t379:1.725859126):1.407301281):0.1582802208,t380:2.966795086):6.341596373):6.805804549,(t381:9.585390548,((t382:5.211495644,(t383:1.767213458,t384:1.57083698):3.40491953):3.868890732,((t385:3.413709752,((t386:1.254796874,(t387:0.2014537756,t388:0.1467884857):0.9996169785):0.9907518871,(t389:0.9297578914,t390:0.8083412756):1.203131083):1.160417868):0.768534145,t391:3.775817856):4.627357748):0.3453574617):6.465355763):7.730310314,((((t392:1.526172012,t393:1.390861528):2.494375028,((t394:2.092162071,(t395:1.175407994,(t396:0.708779993,t397:0.5955064041):0.4182461115):0.7318454829):0.3728123784,t398:2.0808007):1.240630681):5.696406958,((t399:4.432718167,(t400:1.589765392,t401:1.567630177):2.792177335):1.025683097,((t402:2.042487427,(t403:0.2047864755,t404:0.1779199478):1.825590335):3.224141504,t405:5.181028127):0.07933825227):3.547975561):0.6179970222,((((t406:4.522739638,(t407:3.602463368,t408:3.500797717):0.9032131201):1.512042322,(((t409:2.673190218,t410:2.641225981):0.6524416218,t411:3.277992094):1.937863419,((t413:1.200277735,t414:1.103548746):2.396135065,t415:3.341698946):0.9982860491):0.6007776742):1.00380652,t416:5.830513312):2.099653886,((t417:0.8763250341,t418:0.6009426038):0.798860656,(t419:0.335382273,t420:0.2881752314):1.057773412):6.186574881):0.2768098013):12.53093232):36.02155781):54.12776621,(((((t421:3.011475821,(t422:0.8496409654,t423:0.5289737484):2.137266896):1.040955821,t424:3.68562301):8.507144597,(((t425:0.8724329904,(t426:0.3569433587,t427:0.3412252972):0.5134317361):1.278949613,t428:2.088641484):1.090331859,t429:3.092264947):8.928701696):2.377344303,(((t430:0.664657305,t431:0.4272433011):5.89098581,((t432:2.29094438,(t433:0.6364133501,t434:0.5376378836):1.41699482):3.250722117,(t435:4.420489786,(t436:1.031014868,(t437:0.4809258748,t438:0.3834952992):0.5159575221):3.287263981):0.7518972545):0.7527373318):2.208139109,((t439:0.2066908356,t440:0.1129665937):1.859203756,t441:1.775825202):5.817026379):5.567583324):85.01238267,(((((t442:9.027552724,((t443:4.822900023,(t444:3.841244732,t446:3.632745187):0.9516495782):0.9465973982,t447:5.509707541):3.22270083):10.79895691,(((((t448:0.891066469,t449:0.6368740906):3.821981099,(((t450:0.583220524,t451:0.5615311226):1.322086058,(t452:1.298044342,t453:1.141352):0.5166351477):1.74606959,t454:3.399580407):0.7970651819):2.115412514,t455:6.221301846):2.631221551,t456:8.789137163):3.112828263,(t457:9.642659541,t458:9.621839519):2.126277777):6.939280307):4.941346778,(((((t459:1.393493464,(t460:0.4581855438,t461:0.4573261035):0.7214892383):6.731503279,((t462:2.185698824,t463:2.157385785):1.480132924,t464:3.47267294):4.011471068):1.29672574,(t465:3.324270806,(t466:2.042891881,(t467:0.0478121948,t468:0.03427474411):1.935505552):0.9618480741):5.454302459):3.210776174,t469:11.48116908):6.729409203,((t470:6.927775005,(t471:3.349447869,t472:3.264610326):3.557767012):10.63687774,(t474:2.237819566,t475:2.145370314):14.83591044):0.6272167838):4.221870248):14.71912426,(t476:5.32967203,(t477:1.551170309,t478:1.374692507):3.699322797):31.00881363):6.871750484,(t473:0.05723936375,((t445:0.03038883432,((t412:0.1506776861,((((t300:0.009299652301,((((t181:0.07870974453,(t176:0.01901014694,(t164:0.1458095286,(t151:0.0657533637,(t150:0.04176517008,((t126:0.02434210269,(t115:0.01982874637,(t114:0.0008887169106,((t104:0.2634460971,((t105:0.01738248904,((t1:5.202477474,t2:5.191691505):1.647869152,(t3:3.150086846,(t4:2.104429984,t5:2.038720688):0.9982857493):3.672136643):3.553223465):0.1637942287,((t6:7.723343617,t7:7.690272082):2.311778204,((t8:5.118324205,t9:5.059848662):4.592466496,t10:9.500773487):0.2697230859):0.3798719565):0.04717784504):0.5690159679,((t11:1.57784954,t12:1.572124496):8.274086865,(((((t13:2.625419695,t14:2.433566609):1.133439552,(t15:1.186619284,t16:1.051660481):2.262009548):3.403041429,((t17:0.9312307666,t18:0.8006700509):0.8762720256,(t19:0.856934843,t20:0.838752421):0.7652060735):4.686978018):2.315588492,(((t21:0.0686872432,t22:0.06774979578):4.029301503,(t23:3.412612054,(t24:0.6686308502,t25:0.6182464116):2.343591234):0.6011621202):4.438173976,t26:7.982902678):0.007789132139):0.02833895363,((t27:3.371559708,(t28:1.094461005,t29:1.094380986):2.212391891):0.4786487462,t30:3.773607611):4.111411708):0.2075575908):0.8886557357):1.055962921):0.2796400052):1.511846614):1.520118763,(t31:11.76435293,(((t32:1.737184698,(t33:0.3222913436,t34:0.1700594753):1.293809699):5.769238327,(t35:2.575512,(t36:1.765962068,t37:1.745100674):0.7425672935):4.65268672):3.262169773,((t38:0.4989209355,t39:0.3024768176):5.024914091,(t40:4.633846057,t41:4.590005866):0.6282621702):4.782482858):0.9850463584):1.546228768):1.199828263):0.2852175457):1.305200437):1.33511499):0.6590200712):1.088509776,(((((((((t42:5.381801477,t43:5.165601435):1.433447091,(t44:5.221733532,t45:5.190571873):1.305798389):1.692848029,((((t46:2.902040581,t47:2.876702968):3.068634268,t48:5.944152909):0.6396792005,((((t49:2.981628356,t50:2.837905254):0.5000277304,t51:3.263646627):1.392164069,(t52:2.504791583,(t53:1.398150471,t54:1.317088523):0.8393906288):2.08872407):0.5121803831,((t55:1.489914747,t56:1.463862801):1.568650178,t57:2.496216847):1.641308821):1.063519946):1.570176529,(t58:0.7588841049,(t59:0.3023527663,t60:0.2050193816):0.4434337855):5.812196019):0.0001746754544):0.5573583011,((((t61:5.159037929,(t62:2.764358225,t63:2.585543241):2.329109616):0.3409177254,t64:5.180166062):0.1982768211,((((((t65:2.02262666,t66:1.836193081):1.087784471,t67:2.841867337):1.508893595,(t68:3.941647458,t69:3.802187611):0.1980454517):0.0006829621098,(t70:2.599572648,(t71:1.703905228,t72:1.530147266):0.8039258015):1.341074898):0.0003298528064,(t73:1.826280525,t74:1.818917002):1.806702453):0.1961324804,t75:3.80312623):0.5303832251):0.348023119,(t76:1.336325995,t77:1.126933354):3.266791892):0.9621141769):0.6570675797,(((t78:2.266977855,t79:2.191933626):0.7320151668,t80:2.80496085):2.420953684,(((t81:0.9057610046,(t82:0.52448043,t83:0.4833538565):0.3187107715):2.544723324,(((t84:0.5537777875,t85:0.4256693559):1.24066119,t86:1.425594421):0.8570019516,(t87:0.5095284014,t88:0.3514056272):1.682858519):0.3251682727):1.283985564,(((t89:0.6350950226,t90:0.4535268229):1.17265748,t91:1.536741235):1.708091835,((((t92:1.426288564,t93:1.359832219):0.2718399519,(t94:0.7632567769,t95:0.3940948465):0.8512995437):0.1710846089,(t96:0.999831665,(t97:0.2360954212,t98:0.1497950412):0.6913461135):0.389400232):0.1819958045,t99:1.161412601):1.13120814):0.1183050608):0.4104548665):0.5249263364):2.901538856,(((((((t100:1.311264864,(t101:0.5202608664,t102:0.4179868323):0.580313244):0.4526571925,t103:1.114163677):0.06504641965,t106:0.2854053723):2.241379133,(t107:1.951039735,t108:1.914061694):0.209376544):0.5687541737,((t109:1.779400255,((t110:0.5153860893,t111:0.4797637622):0.8032941915,t112:0.8939449992):0.2563358785):0.6888535132,t113:1.798428727):0.218885107):0.4460584666,(t116:0.8164169025,(t117:0.7000465359,t118:0.5177256338):0.08962229379):1.335639925):0.9458660686,t119:2.380595825):0.1341642595):0.8030467508,(t120:0.4061174372,t121:0.2698883747):2.844496819):2.255806068,((((t122:0.7950417277,t123:0.5956355984):2.524070586,(((t124:2.037542706,(((t125:0.7102783785,t127:0.2463806636):0.002812070852,t128:0.1114087661):0.8305083765,t129:0.940651241):0.492007861):0.6558059708,(t130:0.4801170215,t131:0.2911321306):1.391861496):0.344410792,((t132:0.265941086,t133:0.1959621811):1.39581964,(t134:1.477301702,t135:1.441484704):0.05965729576):0.3368413612):0.01635614234):0.9208826512,(t136:0.5344983839,t137:0.1620862877):1.93386121):0.5820409437,(((t138:0.3934064347,t139:0.3812524022):0.5380412971,t140:0.6875894037):1.382091056,(t141:0.6482864376,t142:0.6052700513):1.41281109):0.2888941114):0.5306407952):0.1579946267,(((t143:1.662141964,t144:1.615242115):0.3852968715,t145:1.603883954):0.5193764782,t146:2.080783447):0.4071563016):2.441530277):4.90408513,(((t147:0.2039320846,(t148:0.06781309682,t149:0.03344429729):0.05508204153):7.999445909,((((t152:0.3550307392,t153:0.1313209887):2.010751729,((t154:0.4310550157,(t155:0.3619394757,(t156:0.2917140946,t157:0.2652668906):0.03084385892):0.05432043083):1.537084542,(t158:0.3748994113,t159:0.2970295951):1.423407476):0.1085840927):0.1298968894,(((t160:0.2324921208,t161:0.1581912738):0.07685827557,t162:0.09687340756):0.4154878999,t163:0.4166240332):1.111015311):0.01769874299,((t165:0.9085806133,(t166:0.6707667343,t167:0.6261998399):0.1705138825):0.03499799041,(t168:0.6655203015,t169:0.53358491):0.0802592016):0.25858551):5.098713775):0.8588493643,t170:6.564289369):0.6801179926):2.635907981,((((t171:0.228564771,t172:0.1188526746):0.2225202479,t173:0.1336469855):5.424407694,t174:5.534823166):0.3691322461,(t175:5.126570532,(t177:2.836367166,t178:2.75951415):1.984903638):0.6178330296):3.587299376):1.9837578):0.09835222513,((t179:6.835157815,t180:6.679143528):1.64150976,((t182:6.012757536,t183:6.00551381):1.843316796,(t184:6.388192624,(t185:5.145304959,t186:5.10514081):1.068012383):1.384700223):0.3187774202):2.521237165):2.760390627,((t187:0.1622744901,t188:0.1279658424):7.4275197,t189:7.548908208):5.494019186):6.250295501,((((t190:3.304297822,t191:3.264257751):10.72132958,((t192:2.451324844,t193:2.390517732):5.740689288,((t194:1.717422159,((t195:0.8425474631,t196:0.8238597697):0.6380952669,t197:1.419928614):0.1958524998):2.853403405,t198:4.42430073):3.506476941):5.612239693):2.741338227,(((t199:4.425790095,(t200:2.416237058,(t201:1.376750461,(t202:1.177399024,(t203:0.7425676619,t204:0.631334509):0.1600028637):0.1964857365):0.790928269):1.331179172):7.067611053,((t205:2.51492748,t206:2.384722396):3.68586054,(((t207:1.644400712,t208:1.621915068):2.598480438,(t209:0.2700350559,t210:0.2534726579):3.597863435):1.081882067,(t211:2.633509718,t212:2.597780425):2.256351747):0.6344075546):3.967672712):2.19642452,((t213:6.173374525,t214:6.157249694):1.297340741,((t215:2.102450718,t216:2.018458449):3.9285356,(t217:1.963836527,t218:1.954816675):3.823238958):1.133547545):4.099987412):2.57375458):1.428068491,((((t219:1.656270632,(t220:1.425891209,t221:1.3478868):0.04031140101):4.277063048,t222:5.542398313):4.542440968,((((t223:0.2723315714,(t224:0.1963650703,t225:0.1949000868):0.05260437628):0.9307170605,t226:1.166630056):2.631145034,t227:3.769937802):4.128736829,(t228:4.330441374,t229:4.27604853):3.446064276):1.973759652):0.8641030548,((((t230:0.1004692471,t231:0.08152976085):1.328187488,t232:1.329792918):2.607337254,t233:3.704677106):1.672507228,((t234:1.453445879,t235:1.195816502):3.435880554,(t236:2.886827573,t237:2.805826583):1.648915931):0.1194598722):4.78727109):3.630768264):1.066317632):1.380927696):2.171600918,((t238:2.884967504,t239:2.860259533):2.465141742,(t240:4.571984055,t241:4.564369686):0.7307379681):12.23116007):0.983199211):1.706202909,t242:20.21274743):0.9132531299):43.63993438):51.74185697):10.53509339);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T4.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
