<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t454:3.733473376,t455:3.688195154):91.00796386,((t456:3.598401993,(t457:2.681505004,t458:2.671719832):0.8898233812):5.322712326,((t459:2.139090053,t460:2.115080579):1.228150702,(t461:1.423208866,t462:1.28515997):1.887454709):5.515739005):85.74894235):2.478644333,(((t463:2.45534765,t464:2.38097732):11.22376448,(((t465:3.862084168,(t466:2.681379138,t467:2.455213921):1.140072327):2.755322662,(((((t468:0.1309157654,t469:0.03923437953):0.7182170956,t470:0.6948147048):3.344146412,t471:3.956101085):0.6499191427,((t472:3.10977122,(t473:0.2639756447,t474:0.1586235936):2.817030758):0.3355359197,t475:3.086612475):1.147249314):0.237693221,((t476:3.315843813,t477:3.20735275):0.4930889839,t478:3.689943324):0.1595917828):1.145051471):3.611624583,t479:8.535097338):3.308707896):38.30165567,((((((t480:0.8662211409,t481:0.7080159078):2.216146259,t482:2.892090734):9.229381448,((t483:2.199217294,t484:2.161228328):1.178567836,t485:3.243380849):8.728218631):9.604057251,((t486:4.439784381,t487:4.207294762):7.150303744,((t488:2.762163652,t489:2.735088489):2.119953985,(t490:0.2759007421,t491:0.2475055782):4.311759217):6.457535705):9.78155529):4.923477147,(t492:3.173633119,(((t419:0.1669632189,((t357:0.05682547678,(t345:0.03068954067,(t280:0.1521059094,(t262:0.09132791023,(t260:0.2367107097,((t243:0.2605298516,(t230:0.07373452907,(t176:0.1122610862,((((t154:0.1905376643,(t155:0.03345642563,((t147:0.2065598881,(t146:0.01248404273,(((t132:0.03658328605,((t127:0.08869717531,(t105:0.1141769974,(t96:0.1390484472,((t91:0.01780980725,(((t74:0.2564011872,(t75:0.03459887899,(t1:4.398160685,t2:4.065667264):3.571582683):0.04225778667):1.604590634,(t3:2.033726333,t4:1.808090806):7.238242647):0.08379400121,((t5:1.617751085,t6:1.598351682):3.294099252,((t7:3.058948957,t8:3.05105648):0.06230346493,t9:3.012034385):1.677392936):4.098563597):0.01113797971):0.02145824131,((t10:2.307958041,(t11:1.600743698,t12:1.54720257):0.6897107272):2.843109535,((t13:2.033817893,t14:1.960640698):0.7394509108,t15:2.546745544):2.028521555):3.297935542):0.4448803959):0.9763679259):2.296386869):0.3577321311,(((((t16:1.387084532,t17:1.301980734):3.717237956,t18:4.940103121):2.63468934,t19:7.378126505):2.117660523,(((t20:3.044819599,t21:3.02547966):0.7469842915,((t22:1.829031893,t23:1.665663417):0.8140660567,t24:2.415845412):0.7640355506):5.308848088,((t25:6.158632355,(t26:3.988704918,t27:3.9684721):2.126390334):0.874635032,(((t28:2.596423699,(t29:0.7967114864,t30:0.6501303656):1.547439893):2.137634471,((t31:3.166952362,(t32:0.8637010455,t33:0.8558871732):2.120274877):0.9155960529,t34:3.849616382):0.04848420021):0.1367821252,t35:3.974393677):1.977195373):1.022135175):0.2728866309):0.2850438979,(((((t36:4.635410446,t37:4.588259051):0.3793976345,t38:4.910290459):0.3040696606,t39:5.086369633):1.064809456,(((((t40:3.560545292,t41:3.5428252):0.04889182279,(t42:2.763700165,t43:2.740604419):0.794078591):0.824034891,t44:4.319979256):0.05463028438,((t45:3.252329059,(t46:1.517796402,t47:1.481437645):1.675692593):1.003504351,t48:4.069930249):0.08655681782):0.6377643709,(((t49:4.024452433,t50:3.910484049):0.1455931419,(((t51:1.407795378,(t52:1.226807972,t53:1.218766138):0.1152677869):0.5920466124,t54:1.902413325):1.205704508,t55:3.02865314):0.7649145969):0.2421958075,t56:3.901639512):0.268467823):0.5990478933):0.5670882565,(((t57:2.60387666,(t58:1.532036422,t59:1.480505129):0.8710736315):0.5034358629,t60:2.728928237):0.8927384237,(((((t61:1.465812578,t62:1.414162606):0.900307745,t63:2.265438456):0.02002725092,t64:2.262784447):0.2325334694,t65:2.472298471):0.7886825718,(((t66:0.5691674586,t67:0.5163606281):1.847221672,t68:2.305777912):0.5012060126,(t69:2.414516857,((t70:0.8156339252,(t71:0.4356785933,t72:0.3826587889):0.3270296264):1.542627083,(t73:2.196514266,t76:1.765196277):0.01211184945):0.03162407418):0.3039831692):0.1571044722):0.1922201939):0.9539940955):0.4969127898):1.751733936):0.1631938783):0.1565218393,(((t77:1.544113732,t78:1.484394744):2.458955067,((t79:2.12472424,(((t80:1.010002951,t81:0.9440636456):0.5292652259,(t82:1.159030449,(t83:0.9597752745,t84:0.7615923983):0.1671957062):0.2852731249):0.2764302655,(t85:0.5838775362,t86:0.2242056752):0.7761413811):0.1017691387):0.3171311681,((t87:0.80251358,(t88:0.6913351716,(t89:0.3945871743,t90:0.2838939636):0.2164886387):0.1000226853):0.1254032416,t92:0.4899340459):0.4686762684):1.411668055):1.698443628,(((((t93:0.6355584032,t94:0.5460324945):1.709793931,(t95:1.983601032,t97:1.63881704):0.25710861):0.06333258965,((t98:0.7800605747,((t99:0.3764839324,t100:0.3166780414):0.04737340287,t101:0.3637703795):0.2838158798):0.82896098,t102:1.192222226):0.23211578):0.4029765961,(t103:0.408461134,(t104:0.247089412,t106:0.07665138681):0.02811887086):1.398700971):0.828513436,(((((t107:0.05484432598,t108:0.003808998613):0.4591350044,(t109:0.2299885042,t110:0.2089296965):0.1733003056):0.280813737,t111:0.4707793992):0.8775265232,t112:1.320500261):0.2725310918,(t113:0.2412314694,t114:0.2315911161):1.332162623):0.2781676638):0.4266005243):0.1662768871):0.420787789,((t115:0.8892407973,t116:0.7798580133):1.109410404,((t117:0.9084747251,t118:0.7342909821):0.170654762,t119:0.7498431544):0.6654008767):0.8101388506):0.2322815551):0.2148624548):0.5862274641,(t120:1.416860134,t121:1.284875821):1.776370848):0.05334527459):0.01075310749):0.0152141758,t122:3.090458098):0.6728172406,(((t123:1.777482365,(t124:1.41294156,t125:1.394801558):0.1761333813):0.4367885339,(t126:1.376311661,(t128:0.1445041575,t129:0.06092117233):0.8698024407):0.54393684):0.1946294205,(t130:1.037438296,t131:0.8396489517):0.5298375605):1.094267523):0.7452846841,((t133:1.46449444,(t134:1.170716201,t135:1.09986847):0.2537556346):0.07836464185,(t136:0.80696408,(t137:0.6976632993,t138:0.657515754):0.04545909883):0.594632556):1.536690738):0.8985429472):4.216914786):1.47289564):1.586523747,(((t139:4.004842408,((t140:1.269508606,t141:1.017740907):0.6879537697,(((t142:0.6669630335,(t143:0.2113063434,t144:0.07474157499):0.4524512264):0.2878709855,(t145:0.5310679137,t148:0.2783758755):0.2081218366):0.3620174651,t149:0.742493317):0.3817575014):2.022735258):0.1232508915,(t150:0.3349049345,t151:0.3216908185):2.9026191):1.801213563,((((t152:1.388704842,t153:1.329594158):0.9262498215,(t156:0.8698294124,(t157:0.1718627796,t158:0.07281634862):0.5979663328):0.948566391):1.38577161,(((t159:0.3825978186,t160:0.2009285908):0.5249408234,(t161:0.3996114366,t162:0.2544896447):0.3062096759):1.738135646,(t163:1.299204123,(((t164:0.9979640301,t165:0.9356086007):0.1121873924,t166:0.9982330615):0.06185684975,t167:0.9334832769):0.08032571087):0.865049375):0.3231074869):0.08543610549,(t168:0.9843845085,t169:0.7633231889):1.220143748):1.087191192):5.068535081):0.3175822696):0.2847772447):2.15416975):6.441411674):0.6180133933):2.950720772,((((((t170:1.738581999,t171:1.683988774):0.1892147664,t172:1.54329919):0.2947085213,(t173:0.5248567247,(t174:0.1024792239,t175:0.0547201119):0.3151952691):1.233931605):2.204283202,t177:3.649105978):0.1676753157,(t178:2.609698188,((t179:0.7838339741,t180:0.7430093471):0.3738038364,t181:1.103047103):1.307152599):1.131225355):7.934918003,((t182:5.929873167,(t183:5.04951198,(t184:0.6635499044,t185:0.5917273836):4.262829832):0.6768375977):5.075642464,(((t186:5.316888788,(t187:2.405373337,t188:2.234399857):2.85859778):3.31261813,(((t189:0.3774354491,t190:0.09165642645):1.217377019,t191:1.300857728):3.524497727,t192:4.764072892):3.253312783):1.721824734,(((t193:5.125162665,(((t194:1.931008511,t195:1.908169285):0.7645876691,(t196:1.175824782,t197:1.011417563):1.491834855):0.7711146329,t198:3.266935701):1.540777935):0.08817557514,(((t199:0.6269508707,t200:0.5576282865):1.699728697,(t201:1.150314479,t202:1.150162209):1.071140451):1.310295767,(t203:2.835659617,t204:2.711152154):0.6924796416):1.232703525):3.681758933,((((t205:2.237079936,(t206:1.404900102,t207:1.396190072):0.6268329649):0.2123613536,t208:2.219205493):0.7082232384,(t209:0.7872879335,t210:0.6963947911):2.135962482):4.146179445,(t211:2.6530702,t212:2.451300637):4.303319286):1.001743273):0.8378400939):0.2293202059):0.4422281979):8.256812827):2.342536182):3.16568763,(((t213:7.137738381,(t214:2.645247716,t215:2.542563559):4.43951691):4.833832857,(((((t216:1.663469015,t217:1.323342075):0.1457666736,t218:1.465863945):2.636761302,(t219:3.86586546,(t220:2.630204825,t221:2.61328733):1.113603722):0.2110931829):3.174592622,(t222:2.103498942,t223:2.043221139):4.992881776):2.261728294,t224:9.285877649):1.886425359):7.560353882,(t225:1.34464168,t226:1.320405555):17.05385169):3.446434382):5.583680847,(((t227:3.925463476,(t228:3.723249053,t229:3.629280356):0.1544881339):3.260011567,(t231:6.585867137,(((((t232:2.453020141,t233:2.311874073):0.7262790101,(t234:0.5839317303,t235:0.5786343647):2.383498113):0.461591455,t236:3.411525984):0.8896820797,t237:4.301154577):1.704330757,(t238:2.629593357,t239:2.476232753):3.288182376):0.2920051858):0.1182813792):17.40374878,(((((t240:2.896075469,t241:2.77975747):1.64877726,(t242:1.314998288,t244:0.8150313537):2.895953436):11.17561581,((((t245:1.173399759,t246:1.160111542):0.04335965251,t247:1.040383384):7.976350247,t248:8.999439354):2.714288023,(t249:6.912683887,(t250:5.254839877,t251:5.090897676):1.56435159):4.70514678):2.956071319):1.487745586,((((((t252:0.40787653,t253:0.2441376394):6.225506938,(t254:5.007598292,(t255:4.360735283,(t256:2.344116226,t257:2.297164259):1.911728446):0.4532039265):1.329317567):1.637684432,(t258:7.297035207,((t259:1.627891626,t261:1.257432537):1.536412703,(t263:0.8282728284,t264:0.5786376777):1.481289903):4.089837716):0.2026500012):1.819885083,(((t265:1.140031804,(t266:0.9136212645,t267:0.8605028232):0.07241022461):0.9588051062,t268:1.889998408):4.676787392,(t269:1.391052071,t270:1.159752742):4.989450687):1.288645171):0.7987812666,(((t271:0.3589887315,t272:0.3482140865):5.627493358,(t273:2.543446098,t274:2.324166189):3.311767527):0.7459048129,t275:6.374852871):1.475599213):3.454294406,(t276:7.040612682,(((((t277:0.4210599213,t278:0.2963608437):1.963930669,t279:2.175638343):0.4874765727,t281:2.344542427):1.043024878,t282:3.336937343):2.669877985,(t283:0.5125799581,t284:0.359350945):5.437849952):0.4205456746):4.262125909):1.425383136):2.960111121,(((((t285:1.379253453,t286:1.283067242):0.2140933466,t287:1.484807575):6.538053421,(t288:6.523128962,(((t289:2.425840882,t290:2.187485125):1.253110773,t291:3.262366176):2.467520843,(((t292:0.3460031655,t293:0.3233518181):0.6460455775,t294:0.8770387268):0.5713495824,t295:1.293728859):4.128745205):0.2029886529):1.386332056):0.7518845442,(((t296:3.474645479,((t297:0.6470598887,t298:0.6067173771):2.398539945,(t299:0.2492684161,(t300:0.08120240821,t301:0.01219757358):0.1074602435):2.692895919):0.4026645808):1.626049764,t302:4.815201002):1.638438991,t303:6.435088617):1.013723367):4.638894615,((t304:4.14847863,t305:3.848875861):0.008346877204,t306:3.776718365):7.896254866):1.324826065):3.303459543):2.601929958):1.541370752):22.53645961):12.61803084,(((((t307:7.569727661,(t308:6.118936145,(t309:2.356610127,t310:2.19715583):3.672055269):1.291934838):10.00546154,((t311:13.75079773,t312:13.60201293):0.8087836559,(((((t313:7.556170094,((((((t314:0.6421259168,t315:0.436943927):2.563788674,(t316:0.5289240598,t317:0.5001961144):2.187150195):0.6955139523,t318:3.360248421):0.5798112031,t319:3.887744132):1.317548766,(((t320:0.7457942648,(t321:0.6433049328,t322:0.531902396):0.04900301786):0.1762204475,t323:0.6349427536):3.800389088,t324:4.40709058):0.1846230494):0.4842868994,((t325:0.952523801,t326:0.8694424648):2.526217905,t327:3.23873452):1.570305144):1.223254443):0.5090398605,(t328:5.393702616,(t329:1.089824851,t330:1.078029489):4.15506351):0.7895175582):3.614814753,(((t331:1.650910315,t332:1.543744111):3.526583382,((t333:2.960411317,(t334:0.6069263674,t335:0.3795014073):2.270839378):0.4389234896,t336:3.085635115):1.50779056):2.117758311,((t337:0.03626124854,t338:0.02622522567):3.806888503,((t339:0.3610494234,t340:0.3413373203):1.134909379,t341:1.330443803):2.30941083):2.799564601):2.329703171):0.5653239827,(((t342:0.9242259093,t343:0.8629230947):0.5994498818,t344:1.242165013):5.818506752,((t346:0.7990978462,(t347:0.6665566206,t348:0.599993148):0.1207336968):3.085678988,(t349:0.7834985801,t350:0.7557215816):2.961680986):2.970410148):1.991840003):1.864427383,((t351:0.3897129552,t352:0.3893646913):6.460254516,(((t353:1.342509523,t354:1.337134901):0.8037055216,t355:2.115535985):0.3530135194,(t356:0.9812798304,t358:0.7367876073):1.47070834):4.094222731):3.650792565):0.09420491029):2.528629228):6.256311549,(((t359:2.14203837,t360:2.071255736):1.12141551,t361:3.15857772):3.295555726,t362:6.229368656):12.20900202):9.95389405,(((t363:1.242027617,t364:1.235890422):9.733911135,(((t365:1.242657115,t366:1.090695754):3.996607615,((t367:0.9345263702,t368:0.9076168824):2.076570158,t369:2.837113622):1.9857754):3.434797387,(((((t370:1.324825192,(t371:1.062417328,t372:1.024957284):0.2237204283):3.397513076,(((t373:1.059781287,t374:1.047887863):1.912422235,(t375:2.275275382,t376:2.20284685):0.658158756):0.8651046536,t377:3.687755583):0.7935436476):1.00437643,(t378:3.039106586,(t379:1.275358197,t380:1.274853529):1.686507424):2.379877774):0.8237238967,t381:6.1250672):0.6809379644,(t382:3.867820122,t383:3.832885023):2.905683353):0.976460458):2.235529466):2.998137114,((((((t384:0.0780949979,t385:0.07640278757):0.5602713656,t386:0.6231615599):0.5327424661,t387:1.088909718):3.716078538,((t388:0.625301626,t389:0.5884497896):3.40728978,t390:3.984361905):0.5842827984):2.99289901,((t391:4.536171695,(((t392:0.818981403,t393:0.6832240978):2.036503089,t394:2.65993013):0.9429917125,(t395:2.954139581,((t396:0.2874426571,t397:0.2506354189):1.231409059,t398:1.093957276):1.372142429):0.6298364349):0.6259923872):0.2164067775,t399:3.795574075):2.768230577):3.928343688,(t400:5.928507771,((t401:0.2726374041,t402:0.2190545482):1.619210567,t403:1.820234476):3.781121575):4.141977537):1.051439635):14.37960168):17.87526987,((((((t404:5.283465468,t405:5.175402432):6.539230572,((t406:1.066058032,(t407:0.6246846722,(t408:0.306936692,t409:0.2153415191):0.248453393):0.4355448249):4.779900322,t410:5.504083224):5.777975602):3.478917887,((((t411:1.140916196,t412:0.9938350244):2.750122129,(t413:3.446093325,t414:3.438883054):0.178161822):4.221533194,((((t415:1.283377949,t416:1.226103567):3.29120192,(t417:1.467595395,t418:1.388252563):3.044532483):1.310242857,((t420:3.1111114,(t421:0.1380061879,t422:0.07052430181):2.961292366):0.052940827,t423:3.076451528):1.968057641):0.6786168946,((t424:2.128750211,t425:2.117106023):1.330297026,t426:3.434439699):2.258392522):1.199090101):3.28680241,((t427:4.322681427,(t428:1.167105254,t429:0.4190470172):3.135999949):3.372418833,t430:6.919523503):2.39695177):3.296999213):5.092526363,((t431:0.6232251901,t432:0.553914022):8.440824125,((t433:3.501102263,(((t434:0.4337895502,t435:0.4176440717):1.249711676,t436:1.633778581):1.569460418,(t437:0.8318861565,(t438:0.4299113626,t439:0.2553743605):0.3676808099):2.313638438):0.2032965399):1.90180301,(t440:1.37642761,t441:1.211162405):3.509854268):3.57861181):8.615219319):3.131456369,(((t442:8.564970526,(t443:6.671153841,(t444:2.625655314,(t445:1.813719822,t446:1.490299321):0.7217964542):3.978682267):1.75766167):2.042258356,((t447:6.032382523,t448:5.901185365):0.3888261454,(t449:4.918647919,t450:4.898520698):1.368475112):3.539969366):7.963119555,t451:17.65667163):1.03116757):1.54186947,(t452:9.223269243,t453:9.083645297):10.97724305):17.82858312):3.935721107):10.66576324):44.81763087);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T46.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
