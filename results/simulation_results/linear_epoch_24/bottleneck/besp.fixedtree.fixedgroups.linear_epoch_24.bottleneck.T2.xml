<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t472:1.46077609,t473:1.410666881):81.37376462,(((((((t474:0.111556405,t475:0.02624781172):0.2055708413,t476:0.02197142672):10.76933427,((t477:0.3317083804,t478:0.119953894):2.694964444,t479:2.769752403):7.746788285):5.563099285,t480:15.89909827):12.65869351,(t481:28.3622807,(t482:0.6960415416,t483:0.4838078823):27.49049407):0.01675147936):2.83518214,(((((((t460:0.3859506127,(t382:0.1132323727,((t328:0.202676963,((((t250:0.004482926484,(t230:0.01851781052,(t191:0.1220383724,((t168:0.001825195683,(((t157:0.00907602279,(t151:0.0270348781,(t140:0.01932148421,(t138:0.02524097347,(t130:0.2331824689,((((t59:0.08025186704,t1:5.479155082):4.958413621,((t2:2.450405014,t3:2.447796446):4.516552406,t4:6.918830475):3.4196197):1.43211345,((((t5:10.08109536,((t6:3.558389956,t7:3.531798391):4.757322768,t8:8.240210362):1.684941204):0.2668238106,(((t9:4.326977798,(t10:2.871398383,t11:2.775872569):1.373624536):2.092581334,(t12:1.438296627,t13:1.394753337):4.655756562):3.050145442,(t14:5.956188015,t15:5.790847711):3.112061838):0.5768899987):0.739304507,(((((t16:2.527159495,(t17:2.013028661,t18:1.887596051):0.3917329478):5.402497231,(t19:5.561947282,((t20:0.1439523253,t21:0.06189736201):2.22938004,(t22:1.015196796,t23:0.9341572487):1.176756547):3.155790332):2.119382574):0.5485106491,(t24:4.852230485,t25:4.768293719):2.951570827):0.3549865671,((t26:2.353006254,t27:2.309780076):5.292758065,((((((t28:0.4817354675,t29:0.4772386528):2.056595448,(t30:2.134664193,t31:2.110635741):0.3785875564):4.068280365,(t32:0.3482794238,t33:0.2264136768):6.060026948):0.3524714517,((t34:3.991274749,(t35:0.2875555137,t36:0.276971821):3.690083194):1.570814649,(t37:4.81240368,t38:4.697205635):0.630080618):1.064483266):0.26098997,((((t39:0.9309675647,t40:0.8988312748):4.645472059,t41:5.426041866):0.9430116299,(((t42:1.034799648,t43:0.7424648503):2.025291032,(t44:0.08735607297,t45:0.04766209715):2.596414132):3.034467435,((((t46:0.1384320442,t47:0.02481902822):2.184711123,t48:2.11197988):1.161949361,(t49:1.518558895,t50:1.455316578):1.32616825):0.5942806538,t51:3.349910709):1.573284183):0.2449442574):0.02755034106,(t52:1.864802203,(t53:1.486340867,t54:1.485318032):0.2487710997):3.217460173):0.1025052169):0.1273093944,t55:5.151952498):0.1215130523):0.4077505658):0.1774092457,(((t56:1.976863246,(t57:0.3927065605,t58:0.2368780845):1.564570512):2.828191201,(t60:4.462837135,t61:4.348140042):0.01996739219):0.1376860977,(t62:4.238011059,t63:4.207502648):0.08452909003):0.8964932724):0.2483075891):0.07932413996,((t64:3.101061748,(t65:0.5136177936,(t66:0.2063631569,t67:0.199241057):0.1933966107):2.266695667):1.431849118,(t68:3.184463082,t69:3.160113633):0.8669269145):0.8129043483):0.4958750401):1.221166431,(((t70:3.548935022,(t71:3.165006289,(t72:0.9545961462,t73:0.9385081024):2.187913066):0.2339722084):0.8896793486,((((t74:3.488275478,(t75:0.479633094,t76:0.2882593416):2.976957317):0.04595494564,t77:3.302654951):0.1766595153,t78:3.287219271):0.3410707979,((t79:3.236123166,(((t80:1.54868991,((t81:0.4983818733,t82:0.3680994149):1.014739214,t83:0.9584022828):0.007795979999):1.22305883,(((t84:0.7218714537,t85:0.6255808252):1.108817747,t86:1.639473804):0.05462717145,((((t87:0.8761054621,t88:0.8037163996):0.01021397227,t89:0.805127753):0.449314731,t90:1.102945526):0.2603485784,t91:1.353667769):0.002635700315):0.1535650944):0.2179377389,((t92:0.7041439663,t93:0.6935222598):0.7338611052,t94:1.391811441):0.1444947608):0.1207335446):0.1059908644,t95:1.723420411):0.2725572442):0.1615619763):1.230676047,((((t96:0.2163755409,t97:0.1944010993):0.9814411684,t98:1.165945824):1.176923012,(((t99:0.9164036674,t100:0.8159746266):0.9060611198,(t101:1.238766349,(t102:0.4496961768,t103:0.143749592):0.7371735874):0.4134920402):0.155854577,t104:1.429317563):0.3436201112):0.3005227749,(t105:0.6086764934,t106:0.5669145512):1.172138018):0.6368794692):0.7884007562):0.5275076733):0.9371068743):0.1140610737):1.13106512):0.1728629064):0.2334856021,(t107:3.502146673,((t108:0.7608389451,((t109:0.1581430546,t110:0.05703370081):0.07138365149,(t111:0.04877221662,t112:0.04703430537):0.06777341268):0.4919961091):0.175526841,t113:0.5390178995):2.492863373):2.744044792):0.02117970541,(t114:3.931369286,(t115:1.460869513,t116:1.299524881):2.189754592):1.831274271):0.5498335547):1.356392396,(((t117:0.5918090802,(t118:0.2877245529,t119:0.0268041647):0.1641951614):0.5174350558,t120:0.6262589473):3.632563284,((((t121:0.6271623066,t122:0.3772099465):0.345644488,t123:0.6987866266):1.83190831,(t124:0.4711028442,t125:0.2894685969):1.836079899):0.5948279442,(((t126:0.3153352814,t127:0.2542613752):0.05306936709,t128:0.2792825473):0.1145645563,t129:0.285000387):1.534649004):0.6131660631):2.337563989):0.9198565142):3.524236057):1.45091706):1.605797954,((t131:4.576544176,((t132:3.149767066,(t133:0.9068131841,t134:0.7199250901):2.059919038):0.8951244119,(t135:0.7590992864,(t136:0.4140436039,t137:0.4023801605):0.3010832275):2.734485466):0.4727685827):4.08655905,((((t139:0.955542193,t141:0.8836657802):0.7613637666,(t142:0.6235846666,t143:0.548299487):1.011133884):0.4879873645,((t144:1.457978906,(t145:1.036221152,t146:0.9704395314):0.07865822827):0.1721759604,(t147:0.7355987013,(t148:0.3342204908,t149:0.2631164113):0.3879467993):0.279163002):0.2672844951):0.04482031132,t150:1.214204648):5.396466515):3.352105833):1.0093913,((((((t152:0.3349521221,t153:0.3222143991):1.276668827,(((t154:0.412685151,(t155:0.06686658843,t156:0.04544036708):0.3256486926):0.2165728143,t158:0.3517719964):0.360224742,(t159:0.5236957616,(t160:0.2662137903,t161:0.09750871432):0.2532200194):0.1214611961):0.5583069042):1.272468788,(t162:0.6358268211,(t163:0.5682287173,t164:0.5557806091):0.06459941033):1.562142873):0.2611341991,((t165:0.3503577087,t166:0.3469485712):1.471019898,t167:1.761777745):0.552921055):4.142345606,(((t169:1.837160948,(t170:1.489723709,t171:1.3699617):0.2985656688):0.122311054,(t172:0.521270675,(t173:0.3273703944,t174:0.3243038751):0.155441029):0.9517399243):0.8945489823,t175:2.20201566):3.381252891):1.056947043,(((t176:1.253269928,((t177:0.2369884626,t178:0.1161330539):0.628016166,t179:0.6256689366):0.1187770397):0.1616370075,t180:0.8817244452):3.884863038,((t181:0.5662763176,t182:0.4457193778):0.5430629877,(t183:0.2706137141,t184:0.2465996365):0.6956030905):3.435313411):1.302253808):2.497713213):1.003600121,(t185:2.341650433,((t186:0.301988957,t187:0.2520595748):0.7226480032,(t188:0.4460880473,t189:0.334864528):0.4227050814):1.272062736):6.813156558):4.008976829):4.154098167,(t190:13.56741079,(t192:2.17914729,t193:1.839982936):11.13683697):3.434778669):1.052813882):8.346256225):0.7220218402,(((((((((t194:4.3654514,(t195:3.012448391,t196:2.990876432):1.178613957):0.8955925462,t197:4.983615668):0.2085278425,((t198:2.782651968,t199:2.352093722):0.01168941402,t200:2.350407536):2.366548928):4.578177959,(t201:4.987802273,(t202:4.330203284,(t203:1.987318435,t204:1.940271531):2.099764216):0.6282137052):4.283798994):4.801571016,((t205:4.085609472,t206:4.016883749):4.06351693,t207:8.057634596):5.56833162):1.218173081,((((((t208:6.836619646,((t209:5.106195085,(t210:3.445285781,t211:3.370040382):1.608269148):0.06980831304,(t212:4.516100582,(t213:1.467230638,t214:1.415770467):3.047735752):0.4304409465):1.627258852):0.2862654962,(t215:3.313392404,(t216:1.023842713,t217:0.8989152629):2.080398617):3.351771056):0.4666408305,((t218:5.143543617,((t219:1.713269249,t220:1.608647969):2.212672726,t221:3.7705756):1.199514265):0.04269137125,t222:4.994250175):1.506760786):0.3318094667,(t223:6.562654624,((t224:3.135267091,t225:3.043647593):3.144709573,((t226:1.117713181,t227:1.015772364):0.03212504941,t228:1.013461713):5.020429049):0.2742167092):0.2383966872):3.279315956,(((t229:3.848519129,((t231:0.2051485975,t232:0.1944390645):1.57615829,(t233:1.024254239,t234:0.992179585):0.6265399165):2.022788188):3.808446968,(t235:5.28785021,(t236:3.983345469,(t237:0.7792351656,t238:0.7108632205):3.110602033):1.273321038):2.103840002):1.234709101,(t239:3.829973042,((t240:0.2848353028,t241:0.08062727239):1.732101571,t242:1.756372596):1.737205821):4.514419938):0.88302289):2.963501234,((t243:5.310136763,((t244:1.979021744,(t245:1.795936477,t246:1.749776369):0.09886551439):1.606415939,((t247:2.361957803,(t248:0.9424762709,t249:0.8616763346):1.381648267):0.9495263004,((t251:1.536467441,t252:1.480683721):1.43703973,((((t253:0.6545204537,t254:0.6304549181):0.6570615455,t255:1.137428992):0.4321777216,t256:1.527891612):1.042313463,(t257:0.7614869989,t258:0.6769046864):1.774349559):0.1250129058):0.1759043579):0.1317400204):1.559809834):6.083617462,((((t259:5.700618487,t260:5.603114076):0.1144962301,t261:5.577252066):0.291268374,(t262:3.914024273,(t263:2.104255497,t264:2.076647473):1.786402409):1.705217105):3.443598365,(t265:4.833035035,(t266:1.907975464,t267:1.853589962):2.85846271):3.867845385):0.9684237395):0.3266197529):0.5541629088):1.720727349,(t268:1.398884403,t269:1.365678864):10.69766735):5.946038366,t270:17.78513236):2.364210278,(((t271:7.573142481,t272:7.496909261):0.8116591189,((t273:4.940774287,(t274:1.10096672,t275:1.031378143):3.826191928):0.6801873546,(t276:0.1368231131,t277:0.09955662585):5.19596563):2.550718202):10.86476506,(((((t278:6.733537666,((t279:0.1980999577,t280:0.1808517798):0.5678950158,t281:0.5669759922):5.917711612):0.1301692507,t282:6.308505024):2.244253355,(t283:2.558564638,(t284:0.7872085475,t285:0.6009602203):1.747972969):5.880515108):2.073552765,(((t286:1.80778518,t287:1.785953857):3.41929066,t288:5.200642163):2.243074314,((t289:0.7035218725,t290:0.6421094877):3.801483349,t291:4.253925597):2.813556902):2.828530682):3.565388357,(((((((t292:0.585540829,t293:0.2966324494):5.08586177,(t294:1.865970383,t295:1.697726134):3.477820455):0.3707049696,t296:5.521399943):0.1816212786,((t297:0.4913353812,t298:0.4440988725):4.135824926,t299:4.393733548):1.000477544):0.828954773,(t300:4.928980778,(t301:4.627011356,(t302:1.222781311,t303:1.130871317):3.386370844):0.2899270016):1.200443129):3.635614062,(((t304:0.4225045111,t305:0.2559358793):2.650280582,t306:2.704462623):3.181665341,((((t307:1.366878974,t308:1.307477272):0.9701599722,t309:2.161697175):0.5645895593,(t310:2.211098031,t311:2.160189138):0.3713210227):1.762008875,((t312:0.1012356833,t313:0.02196190248):0.7675865756,t314:0.7782964403):3.254363115):1.142163961):2.944688809):2.647805924,(t315:3.307834034,(t316:2.290273043,(t317:0.09259493247,t318:0.07098171971):2.037392535):0.9487294637):7.176897639):0.1042434739):3.93287488):0.8766464751):0.05822546686):0.05359897491,(t319:11.12346198,(((t320:2.732496371,(t321:0.09209678875,t322:0.06269543752):2.627390921):5.976567319,((t323:1.5695292,t324:1.441145891):5.438982372,(t325:4.492768903,(t326:1.238061546,t327:1.145524185):3.155872471):2.159526884):1.62827993):1.021008032,((t329:5.319064154,t330:5.241978239):1.224931646,(((t331:0.9292618635,t332:0.7643282052):1.469334778,t333:2.040150175):1.330951613,t334:3.35670554):2.727660687):2.285849887):1.371021497):4.065106367):3.831838365,(((t335:3.066220547,t336:2.941924604):5.165160727,(((t337:0.7105871961,t338:0.6101500173):4.838078584,t339:5.378682128):0.451322849,t340:5.825553787):2.030876743):8.596601881,(((t341:1.524588787,t342:1.519118648):5.70801676,((((t343:0.2130309836,t344:0.1731411646):1.263016638,t345:1.385986054):1.569863729,t346:2.927615213):3.368912295,(t347:5.822893154,((t348:3.558137886,(t349:0.1998654547,t350:0.09304354002):3.326431874):0.187098547,(t351:0.2707316988,t352:0.2432197896):3.329090724):2.056483538):0.3832862816):0.6801680905):2.506808909,(t353:2.194890488,t354:2.004132319):6.867412893):6.687988503):0.7177594037):7.205934865,(((t355:2.286605586,(t356:0.8519553926,t357:0.6933372102):1.431844989):10.99859194,((t358:3.169804784,((t359:0.8139087611,(t360:0.4911732318,t361:0.4745194733):0.2061177305):1.322779655,t362:1.926840521):1.020631828):6.028235441,(((t363:0.9296556028,(t364:0.2267199903,t365:0.2158406819):0.532392692):3.993092063,((t366:0.3840758314,t367:0.3698602167):0.59647117,t368:0.7116021674):3.651095363):2.656952349,(t369:3.305401159,t370:3.258663496):3.639486786):1.300455323):3.75165667):1.29542995,((((t371:0.32566055,t372:0.2991937673):4.40211634,((t373:1.173838585,t374:0.8246345129):2.369566687,t375:2.900052838):0.7244332824):3.123239533,t376:6.57363108):1.868664003,(t377:5.383923958,(t378:2.191367362,t379:2.133662242):3.000454334):2.952870281):3.433954434):8.902133754):0.2255262629,(((t380:5.63153561,t381:5.577511451):10.06732715,((t383:1.823413677,t384:1.715936052):9.804246627,((t385:7.487000997,((((t386:1.019688615,t387:1.003110125):0.8171832782,(t388:1.116670728,t389:1.108980102):0.3737937805):0.8653794292,t390:2.299354041):2.413504642,t391:4.708059047):2.299422043):0.6404085652,t392:7.571123889):3.383616238):3.850657537):1.356273783,(((((t393:2.35505852,(t394:0.7174006217,t395:0.6974605961):1.592648959):0.05593641642,t396:2.277769978):5.260033511,(t397:6.821486382,((t398:1.82498127,t399:1.820322851):1.649777327,t400:3.366961947):3.343650443):0.679244583):4.505917225,(((t401:0.4665356632,t402:0.1559497867):3.822505101,t403:3.953878046):3.712884528,t404:7.636449776):3.877923443):0.3593507626,(t405:5.649590073,t406:5.477569375):6.082562183):3.334153134):3.517364807):7.541001567,((((t407:1.171469868,t408:1.107664919):4.573375046,(t409:4.033764727,((t410:0.559161684,t411:0.5492436327):2.706500539,t412:3.191741383):0.7623244456):1.436819655):5.082001263,(((t413:4.558366926,(t414:1.969201432,t415:1.955241945):2.588401399):4.949626162,(((t416:0.7701692986,t417:0.7116796542):1.170966043,t418:1.455730962):6.200866404,(t419:5.874003235,(((t420:3.26109695,(t421:2.510653005,((t422:0.4219466826,t423:0.3978152117):0.940064926,(t424:0.9389398235,t425:0.9367155667):0.1811301053):1.124974621):0.703411468):1.046207919,(t426:1.627817545,(t427:1.120535383,t428:1.098317699):0.4623179082):2.224914937):1.389099368,((t429:0.6216675982,t430:0.6194187862):1.773088052,t431:2.243497849):2.772985157):0.1692286734):1.242601333):1.206389588):0.1557851173,((((t432:5.197814078,t433:5.183155987):0.6401081024,t434:5.805816967):0.5315273164,((t435:2.469237133,(t436:0.1223010505,t437:0.1216889937):2.181548194):2.873256978,t438:5.1036465):0.8551829642):0.6296686231,(t439:0.5022359801,t440:0.4925076327):5.945961579):0.5159594371):0.5958529224):4.284331661,((((((t441:2.535995237,(t442:2.01290427,t443:1.79351262):0.4623754565):1.277724487,(t444:1.855425519,t445:1.732136083):1.55022897):0.5610684118,t446:3.545866831):0.4824310683,(t447:1.04007477,t448:1.038770797):2.69725374):2.755762054,t449:6.300761402):1.711085763,(t450:0.7269283799,t451:0.6949835341):7.244744989):2.40994674):10.30946279):13.86437639):9.65101235,(((t452:3.150549659,t453:3.095191485):22.56767589,((t454:0.3725198585,t455:0.2453700424):12.87681775,(t456:6.962984383,t457:6.945382104):6.15798409):12.18484757):1.564457348,((((t458:1.965662235,(t459:1.716179248,t461:1.06984517):0.1809492156):2.718242138,t462:3.838195363):9.05715883,t463:12.87226689):11.22604269,t464:24.07225163):1.852980225):16.87341803):40.85271706):79.55964815,((t465:9.464041063,(t466:1.033913683,t467:0.9270774262):8.376092976):8.012753952,((t468:1.679055803,t469:1.571076524):3.786048059,(t470:2.701735106,t471:2.666179038):2.376341922):11.68942935):145.6909144);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T2.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
