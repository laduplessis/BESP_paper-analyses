<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t423:9.515062775,((t424:1.259672914,t425:1.255995536):2.886495434,(((t426:0.9477516013,t427:0.9143502681):0.1719460624,t428:0.7968782464):2.331540502,t429:3.045607578):0.6143718667):5.240433816):3.357469727,((t430:2.350519052,(t431:0.9338739757,t432:0.8555397001):1.391367586):3.086865672,((t433:0.4810737198,t434:0.3769762473):1.111549287,t435:1.476993288):3.641812407):6.783123205):33.91346082,(((t436:6.301004088,t437:6.095690442):5.289868443,((((t438:0.2517509855,t439:0.2310455864):2.233815512,(t440:0.4029671928,t441:0.3714850322):1.955351304):2.172231092,(t442:2.938568668,(t443:2.548800698,(t444:2.39189351,(t445:1.741578325,t446:1.54546657):0.6427048796):0.1396330066):0.3202001968):1.551480596):3.957696793,(t447:0.1288777179,t448:0.01488235392):7.77788651):2.559423277):8.969844103,(((t449:1.781185918,t450:1.765137447):11.15340755,t451:12.80793489):5.010115804,(((t452:3.095259745,((t453:0.5245121517,t454:0.4433795628):1.554018345,t455:1.958198916):0.7077232727):1.146050179,t456:3.808978531):9.38334608,(t457:5.885103866,t458:5.022115542):7.099307968):4.174370401):1.362426484):25.21662515):81.56405045,((t459:15.42536961,((t460:1.338747403,t461:1.220718193):13.44622466,(((t462:4.041852283,t463:4.016315267):1.408424906,(t464:3.065238174,(t465:1.89147116,t466:1.731894476):1.146269042):2.243386062):0.3111994089,(t467:4.795515564,((t391:0.07136115158,(t389:0.005060406941,(((t306:0.1056299224,((t290:0.3882244019,(((((((t149:0.07108819109,(t145:0.0917000354,(t140:0.05579326624,(t124:0.0425505644,((((t97:0.005579049592,((((t38:0.02329004983,(t25:0.023527484,t1:3.393476532):1.037777242):2.28973353,(t2:4.531909813,(t3:2.070140203,t4:1.978523783):2.383461927):2.135811002):2.205275108,t5:8.687089063):1.145654157,t6:9.691511732):0.01498973963):0.2801154861,(t7:9.255729313,((t8:2.754757753,t9:2.594710132):6.42770732,t10:9.012895939):0.04981917395):0.3581141045):0.07872512427,(((t11:5.695374747,(t12:4.766933979,t13:4.716089622):0.858628319):2.056612358,t14:7.611212572):0.6584569431,((t15:4.656897897,(t16:1.179717428,t17:0.9053217093):3.184447816):3.333036461,t18:7.202019597):0.2597745298):0.9105392536):0.3018174626,((t19:5.033245851,(t20:4.301359392,(t21:2.956503834,t22:2.690725568):1.267092273):0.5528059661):3.068722865,((t23:4.349182857,t24:4.267276029):2.025774762,t26:6.177083251):0.5934099766):0.5570689055):2.032628428):1.594186473):0.3957816561):0.8278177434):0.3826810601,(((((((t27:4.55989596,(t28:1.415730508,t29:1.105760426):2.983964331):2.038486288,((t30:3.195036665,t31:3.121734753):2.859267668,t32:5.94502684):0.05873911713):0.1849015974,t33:6.104783379):2.103201141,(((((t34:0.9703281089,t35:0.9521501172):1.536066053,t36:2.4712072):2.861125801,(t37:2.657703205,(t39:0.7189844901,(t40:0.542821828,t41:0.5299736892):0.0855166703):1.836035191):2.587184805):0.400327584,(t42:0.636371139,t43:0.6276580478):4.710924534):0.2622201329,(((t44:3.910609455,t45:3.895296246):0.6180504917,((t46:2.190989428,(t47:0.1872376499,t48:0.1407684179):1.918420701):0.3068352337,t49:2.277879157):2.001597767):0.8418986919,(t50:5.050480662,t51:4.959465799):0.04433316252):0.2235283217):2.061691505):2.189140844,((((((t52:1.019165894,t53:0.9790280756):1.989813053,t54:2.921883843):0.8792995825,t55:3.782941995):1.180359897,t56:4.933060834):2.493820816,(((t57:1.804836218,t58:1.740637103):3.682857957,(t59:4.821369261,((t60:1.904361288,t61:1.865254558):2.605768536,t62:4.312188605):0.1875657423):0.5865878428):1.123546223,(((((t63:1.438412623,t64:0.92445304):3.046826355,((t65:2.059246495,(t66:1.345647418,((t67:0.7187849202,t68:0.6504001508):0.2986436009,t69:0.9376592012):0.2578849858):0.7117592717):0.6337898037,t70:2.369281186):1.097062393):0.3465090824,((t71:2.396237904,t72:2.341356552):0.7977911652,(t73:3.07023017,((t74:0.9821173053,t75:0.9273554271):1.431487068,t76:2.109512624):0.5549496415):0.005296376049):0.5553366897):0.009546128388,(((((t77:0.5452161014,t78:0.216341478):0.8106150285,(t79:0.2969170311,t80:0.290563893):0.6979241706):1.436178913,((t81:0.9924329924,t82:0.9253524905):1.165549051,t83:2.083012205):0.1776468057):0.0962146889,(t84:1.974711105,t85:1.889097997):0.06676227866):0.09776702783,((t86:0.3770528583,t87:0.3263455278):0.3247840477,t88:0.3028647561):1.265080897):0.1391535913):1.060081925,(((t89:0.9962270951,t90:0.9839457997):0.1666453147,t91:0.9733666273):0.4674432124,(t92:0.7653745404,t93:0.6794891898):0.6448051242):1.080290774):0.1758059005):0.7547097683):0.05046360229,((t94:0.9018585633,t95:0.8711053736):1.525459777,((t96:0.8967926013,t98:0.332728791):0.3012480295,(t99:0.4761010858,t100:0.4607559818):0.07594458517):0.8106499531):0.7402140427):1.844167936):0.9473643663,(((t101:2.030035985,t102:1.831913234):1.717364567,(((t103:0.5555746172,t104:0.3970822369):2.306485302,((t105:0.6638563818,t106:0.3820446215):1.02826375,((((t107:0.2593178479,t108:0.1383438911):0.2945512844,t109:0.3909710286):0.1683003861,(t110:0.2672929637,t111:0.2112694275):0.1892012591):0.2261790682,(t112:0.1356418251,t113:0.08744340496):0.3643078138):0.3702218245):0.9756043407):0.06245166339,t114:1.857465822):0.5614307896):0.2211806648,(t115:1.606613665,(t116:0.3581077399,t117:0.3417721659):1.009564561):0.9613366065):0.8442881176):0.1719780846,((t118:0.6892852658,(t119:0.2972193604,t120:0.2082111791):0.3866269681):1.462273373,((t121:0.5270538164,t122:0.3692538824):0.0804575598,t123:0.3769325066):1.379626192):1.173409828):0.3585881109):0.8359292442,(((t125:0.9013964685,(t126:0.1990441827,t127:0.1719374091):0.5911286105):1.066116346,((t128:0.2692366739,t129:0.1967665449):1.424724998,((t130:1.264191492,t131:1.183676422):0.154397603,t132:1.330607294):0.1846074497):0.08582481001):1.494937238,((t133:0.1807258745,t134:0.04838661073):0.8487407074,t135:0.874701695):1.5749674):0.5682086814):2.229796255,((t136:0.2749350306,t137:0.2006207646):2.136520361,(((t138:0.3596508845,t139:0.2882171886):0.4841778508,t141:0.5432628015):0.2987998295,(t142:0.0839173076,t143:0.0477451267):0.6609422802):1.010150161):2.717175779):0.06992096023,(((t144:0.7480961973,t146:0.3646081671):2.461420134,(((t147:0.905034088,(t148:0.6681038778,t150:0.2498139458):0.1403333932):1.633805551,((t151:0.3614030675,t152:0.2182023604):0.6237915993,t153:0.8251454672):0.7523623422):0.1047322405,(t154:0.4193254306,t155:0.3937142321):1.258157782):0.04812470762):0.2983693415,(t156:1.375496792,t157:1.349729189):0.358423859):0.9570459413):0.6156991066,t158:3.165198847):2.762658143,((((t159:1.047367842,(t160:0.4935200474,t161:0.4525483762):0.3478713062):0.7408114132,t162:1.288530804):0.8720826903,(t163:0.1597923089,t164:0.00744889137):1.86982102):0.3465200325,(t165:1.995460742,(t166:0.6847397149,(t167:0.02041464978,t168:0.006104630228):0.5209208323):1.307119214):0.1723588404):2.86042562):6.980305568):0.3836495445,((((t169:1.82571666,t170:1.779739444):5.104152318,(t171:1.929599514,t172:1.834175735):4.793871676):0.2937658496,(t173:6.412681048,(t174:1.108778075,(t175:0.6009695487,t176:0.2835603295):0.4956703654):5.047597231):0.4769772097):0.1105719177,(((t177:0.1196868088,t178:0.08877853992):0.443383096,t179:0.3875483369):0.03779507468,t180:0.3732791152):5.783560413):4.770340963):1.046572057):0.1523450996,(((t181:0.8599873703,t182:0.8437102191):7.995200812,((t183:3.993151304,(t184:3.817277956,((t185:1.261140322,t186:1.143907675):0.7403367749,t187:1.863901919):1.633162294):0.1380951006):0.1504783561,t188:3.490290603):4.68516704):2.235378613,((t189:0.1799946975,t190:0.102292477):7.395053317,(t191:6.070554714,((t192:3.955636579,t193:3.691461896):0.02657500814,t194:3.565021503):2.05555197):1.413028718):2.811251612):0.9595333457):3.11829096,((t195:3.773714656,t196:3.41120017):7.70666551,((((t197:3.137073168,t198:2.962116869):0.4777707863,t199:3.418312519):1.433178398,(t200:1.785406394,t201:1.50181348):3.006572352):1.233987676,(t202:2.704021738,(t203:2.471683592,(t204:1.294237091,t205:1.165064897):0.9977620933):0.1043740825):2.909792416):4.594954513):2.439803921):4.879621258):0.1349576213):11.51333571,((((((t206:2.715953983,t207:2.629048869):7.251057949,t208:9.827143837):1.098592486,(t209:10.24968332,((t210:0.9682569852,t211:0.9102459204):4.839477399,((t212:3.988458463,t213:3.971220486):0.9308229574,((t214:1.060611541,t215:0.9661589672):1.105240636,(t216:1.0494129,(t217:0.2912565727,t218:0.231270793):0.5981313215):0.8348303177):2.635778214):0.7932465587):4.262297767):0.4714794378):8.377618282,((((((((t219:4.704049557,t220:4.662999981):3.195955575,t221:7.840694086):0.3102446058,(t222:3.546517395,t223:3.515525327):4.547283864):3.736435088,(((t224:1.286664338,t225:1.235481307):0.2597995696,t226:1.489776622):8.12495041,((t227:0.3328982897,t228:0.3196661149):4.986558314,((t229:1.954219541,t230:1.809871735):1.972925362,((t231:0.6906960134,t232:0.6866408524):0.5880278377,((t233:0.2025779181,t234:0.1670662256):0.6781582853,(t235:0.7641774175,(t236:0.1325079791,t237:0.07216071116):0.6115190434):0.01145054062):0.3472922023):2.431631873):1.339823462):4.177391597):2.089416646):2.485336109,(((t238:3.970572072,((t239:1.464883351,t240:1.329419649):1.407424457,t241:2.674212236):1.021721423):0.07127731795,(t242:1.813705369,t243:1.811897941):1.925375114):4.701227177,(((((t244:2.056808307,t245:2.053916495):0.1581656351,t246:2.129324106):2.643568539,t247:4.435528854):1.708852746,t248:6.108978916):0.270920923,(((t249:0.3780141816,t250:0.2870137471):0.5218855633,t251:0.749364913):2.244813886,t252:2.923242438):3.210736397):1.590505021):4.757249794):1.211867376,(((t253:0.7899642736,t254:0.7702094773):6.323080582,(t255:3.954480409,t256:3.600364474):3.023604888):3.072691629,(((t257:3.467987924,t258:3.438880955):0.3205197471,t259:3.703093643):2.295936862,(t260:3.006707659,t261:2.778033932):2.921756228):3.553364247):3.404126187):0.1446066595,(((((((t262:0.9664857478,t263:0.9322174538):1.673044012,(t264:1.831484642,(t265:0.394067741,t266:0.1797111905):1.426514255):0.74538946):3.728440037,((t267:2.629571685,((t268:0.7865659788,t269:0.6860348217):0.5749897294,t270:1.221365105):1.041443789):1.134738155,(t271:3.236883432,t272:3.005021302):0.07503499411):2.299136229):1.654909238,(t273:6.67986465,(((((t274:1.577975908,t275:1.535886742):1.787877341,t276:3.069774028):1.237245018,(t277:1.344389481,t278:1.305951825):2.866739471):0.5001285654,(((t279:0.8098322122,t280:0.8090873893):0.1185435195,t281:0.7190921432):1.741760408,(t282:0.2012734409,t283:0.01609105153):2.155267569):1.956622362):0.7439522842,((t284:0.8290363502,t285:0.7476441198):1.749461841,t286:2.439079269):2.204432469):0.8018203339):0.2510169853):3.206489163,t287:8.883185872):0.2658402765,(((t288:4.879710401,t289:4.700279774):0.001656913339,((t291:0.6832355133,t292:0.5438920672):1.151514276,t293:1.66979903):2.261136462):0.3354085015,(t294:3.293400906,t295:3.157367411):0.916188159):3.916698284):0.07029971416,((t296:2.054509261,(t297:1.182106907,t298:1.129649382):0.8706481156):1.382481378,(t299:0.576845598,t300:0.563917731):2.794299236):4.338697638):1.10627903):1.95585915,(((t301:2.730588639,(t302:0.7225475073,t303:0.7187976366):1.968478278):4.743237414,((t304:3.566816263,(t305:0.4970866595,t307:0.1676953709):2.890387943):1.048768429,t308:4.04993595):2.751138306):0.4024155876,((t309:0.4095272522,t310:0.3694586602):1.823366042,(t311:0.2413510295,t312:0.1810863499):1.846896854):4.943908408):2.843112933):0.3060017939):5.159371939,(((t313:1.8712589,t314:1.860841589):2.27807392,((t315:1.538784071,t316:1.464753488):2.514607802,((t317:1.193725362,t318:1.077980577):2.265580778,t319:3.279782387):0.4170707717):0.04573812308):9.009515529,((t320:11.17753008,(t321:4.350097458,(t322:3.967613887,t323:3.926621101):0.2036489103):6.740774996):0.3786684334,(t324:0.3465647423,t325:0.3287820714):10.77892203):1.09080277):1.884699391):2.97928047,(((t326:4.980848513,t327:4.974782403):3.223345825,(((t328:0.910712439,t329:0.8720124712):4.808515181,(t330:2.293516934,((t331:1.844623674,t332:1.789425183):0.2234853863,t333:1.820072551):0.1305281498):3.345977377):0.2818595484,(((((t334:0.09340262509,t335:0.08811020528):0.0498358308,t336:0.07811401774):0.5289732512,t337:0.2879682993):3.968223623,(((t338:1.819910335,(t339:1.240738346,t340:1.084897351):0.3790524893):0.6758457073,t341:2.129482515):0.7980666628,t342:2.792256732):0.6848995064):0.01553514196,(t343:2.740584643,t344:2.531711877):0.6561016401):0.8460634306):2.188366319):6.073790897,(t345:6.62017006,((t346:1.554890643,t347:1.446813717):0.6844547089,t348:2.089793784):4.216294852):5.428053765):2.776590834):1.128603889):1.940542683):0.3425378497):8.85089379):0.4790562748):30.04684311,(((((t349:0.3213158213,t350:0.2187503832):2.449888039,t351:2.559841903):5.197924607,(((t352:5.20105691,(t353:2.615659649,t354:2.583573821):2.467694744):1.548883126,(t355:2.098799476,t356:1.996063115):4.403968783):0.6181956718,(((t357:0.997788082,t358:0.8393055886):2.490281343,t359:3.318598038):1.292082448,t360:4.57665013):2.064452043):0.3810191663):2.622897738,t361:9.519300278):20.74822465,(((((((t362:2.268162361,(t363:0.1363984879,t364:0.07467655063):1.831596877):3.313074449,t365:4.929126713):3.641133092,(((t366:1.219582353,(t367:0.08995449108,t368:0.004182677561):1.097837373):2.687371934,t369:3.648398281):0.5779452672,(t370:1.325850407,t371:1.272937254):2.879876649):4.02998692):4.242289144,((((t372:0.4850885534,t373:0.39435589):1.475325386,t374:1.848225642):3.137253211,(t375:2.463345796,(t376:0.1881574832,t377:0.0272220822):2.056142095):2.448585938):4.051183062,((t378:0.5259928056,t379:0.4864676567):7.342365166,t380:7.584835522):0.6948184167):3.157518649):2.702822286,((t381:1.027638016,(t382:0.6526385525,t383:0.5288478642):0.3457163854):3.716439969,(t384:3.665338961,((t385:0.3823795743,t386:0.2634604509):0.3066961941,t387:0.527563747):2.94806616):0.6470152486):9.260666302):0.307578106,(t388:4.120197414,t390:4.067592512):9.556727782):7.873230374,(t392:0.9875405221,(t393:0.8099359239,t394:0.5909462401):0.04614458065):20.3598368):5.859148549):25.90776996):78.82378803):92.49090361,(((t395:8.924420626,(((t396:4.840164917,t397:4.496000182):1.278439036,(t398:5.072313156,t399:5.038630974):0.6500951833):1.498096341,((((t400:0.1022222451,t401:0.01731233426):0.9511964151,t402:0.7435228327):3.538415018,t403:4.000434987):2.182923906,(t404:2.411574493,t405:2.211091456):3.659856334):0.2731804655):1.166099548):20.09758857,(((t406:6.54866692,t407:6.451246525):7.309433549,t408:13.75343769):4.103212771,(t409:8.470876991,(t410:3.24255177,(t411:1.583425501,(t412:0.34466174,t413:0.3425872935):1.199794646):1.654943552):5.107808516):9.182972948):9.383497326):41.19931138,(((t414:1.04055967,t415:0.9059171294):5.696531286,(((t416:0.1221609567,t417:0.04512575403):1.531439334,t418:1.574287558):1.134075999,t419:2.69153275):3.417788307):0.6777161636,(t420:2.092331085,(t421:1.148725138,t422:1.049936135):0.7765585303):4.650335255):60.54864344):153.8389318);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T8.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
