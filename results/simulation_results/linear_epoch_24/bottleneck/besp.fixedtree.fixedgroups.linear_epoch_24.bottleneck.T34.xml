<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t474:14.57057579,((t475:1.877355554,t476:1.789178262):2.377181728,(t477:3.376643913,(t478:2.147006149,((t479:0.9213122361,t480:0.7916285422):0.632423767,t481:1.372975287):0.554099973):1.208308799):0.7619781829):10.17805993):161.705388,((t483:8.177379723,(t484:6.746118519,((t482:0.01633231294,(t448:0.06031671177,(t442:0.0761025589,((((t333:0.06496573975,(((t278:0.2214424125,((t203:0.08645751946,((t181:0.01587586347,(((((t144:0.06790920501,((t110:0.01286083403,(((t1:2.317521446,(t2:1.851840533,t3:1.832080237):0.4602175646):3.419591243,t4:5.649493866):4.317119244,(t5:9.811970126,((t6:4.534296549,t7:4.394270179):4.412814747,(t8:6.016251531,(t9:1.057462044,(t10:0.9666189429,t11:0.8648828453):0.05570928139):4.810522983):2.740008547):0.5581126614):0.09752970347):0.5442043792):0.42622637,(((((t12:4.50552799,t13:4.497185066):4.60067954,(t14:3.837418719,t15:3.832626549):5.258445304):0.3399951703,((((t16:0.7335787411,t17:0.6906252965):4.016384354,((t18:1.226750907,t19:1.120733224):2.557646185,(t20:2.772124042,t21:2.701062457):0.819053428):0.8967990294):2.278293547,(((t22:0.3675984386,t23:0.2068257429):1.575867382,t24:1.728176916):0.3146381197,t25:1.579477658):4.368153276):0.3788994148,t26:6.207931568):1.860807645):0.02852969526,(((t27:1.254169385,t28:1.188164394):0.06279282553,t29:1.130115709):5.486284406,(((t30:0.4819728041,t31:0.2120390002):0.08280789006,t32:0.2675855307):1.856347244,t33:2.036620801):4.174497068):1.158517871):0.03329813211,((((t34:0.3411612418,t35:0.240185027):4.574327547,(t36:4.486424614,(t37:1.564748243,t38:1.387423924):2.873276567):0.3010515022):0.3108972395,((((t39:0.5799045578,t40:0.5074183393):0.3490696684,t41:0.8290805217):1.695544261,t42:2.484513041):0.4055311039,t43:2.8565902):1.793278997):0.6304668211,t44:5.227653884):1.513685892):0.5818373736):2.476839834):0.9583746536,(((((((((((t45:2.914634018,t46:2.82737941):1.434064678,t47:3.863446615):1.834426681,t48:5.634495106):0.4503517654,((t49:5.296575361,t50:5.256279055):0.3423445698,((t51:3.149958875,t52:3.096971924):2.353041045,(t53:1.60243931,(t54:0.566175814,t55:0.4032447764):1.00412409):3.65587354):0.03876218108):0.3923691008):0.2785455925,(((t56:0.1906218958,t57:0.1168201488):4.418495124,((t58:2.169747154,t59:2.15283882):2.058516566,(t60:0.3460011992,t61:0.1361314359):3.718659021):0.1911943892):1.096165472,((t62:4.7886344,t63:4.643129862):0.1049516582,t64:4.648493219):0.1982894674):0.02496477114):0.6060363517,((t65:4.396507541,t66:4.295358698):0.0436931612,((t67:3.730372195,(t68:0.3324031028,t69:0.3140527428):3.290309994):0.3768080598,t70:3.678952232):0.07855899486):0.8166963087):0.20201198,((t71:3.617602191,t72:3.501574313):0.3863053338,(((t73:2.845100031,(t74:1.526843387,t75:1.196093632):1.248801506):0.4182479965,((t76:0.5502779159,t77:0.4479247557):0.9708281807,t78:1.26575248):1.328033521):0.381943655,(t79:2.36230128,(t80:2.132843272,t81:2.126768311):0.1900978045):0.6037912844):0.02975784036):0.749956394):0.7669513071,((t82:2.300047516,t83:2.100920826):1.572780283,((((t84:1.442073018,t85:1.377183466):0.7483144615,(((t86:1.316792639,t87:1.257948246):0.3624742928,t88:1.579143809):0.1620164729,t89:1.647700846):0.2612001003):0.4974016873,(t90:1.627776949,t91:1.534850269):0.7047846273):0.1720022685,t92:2.390140181):0.4441163569):0.4425781196):0.1495890941,((t93:1.309810023,(((t94:0.3958581895,t95:0.2877623452):0.7393967451,(t96:0.8926015194,t97:0.7377021299):0.09302796194):0.03294415284,t98:0.7045231642):0.1217026102):0.7499856578,((t99:0.5538819248,t100:0.4879027626):0.5228164501,(t101:0.837853312,(t102:0.4742852551,t103:0.2159826666):0.3220178006):0.1454088162):0.408603253):1.308458688):0.2497801623,(((((t104:0.1098014376,(t105:0.05417000324,t106:0.004156835921):0.01935273115):1.519308108,t107:1.453214172):0.006128645896,(t108:0.3622765937,t109:0.2470342685):1.025359097):0.1675091324,((t111:0.3705552487,t112:0.2333632471):0.06749956926,t113:0.1581739538):0.6518060035):0.2159489656,t114:0.9916051523):0.5983928805):0.6046302002,(t115:0.3439544818,t116:0.320680401):1.758865873):1.162486374):0.5964356032,((t117:2.048613759,((((t118:0.2310534982,t119:0.2055975703):0.2390328067,t120:0.3974525402):0.1218678426,t121:0.50591269):1.320473161,(t122:0.8272103448,((t123:0.4384563215,t124:0.4179127681):0.04327238073,t125:0.4440692947):0.1646711984):0.9717431636):0.03234043342):0.2284000141,((t126:0.9402357125,t127:0.8895979975):0.2435813418,t128:1.116595949):0.5939388921):1.354316729):1.587389107,((((t129:1.877242209,(t130:0.4945051269,t131:0.2654188447):1.326694639):1.428140965,(t132:0.8990086449,(t133:0.06011710109,t134:0.00445169888):0.7193713643):2.085091316):0.8854429112,((((((t135:0.6130155762,t136:0.5457997638):0.08813121781,(t137:0.4133627967,t138:0.3618662229):0.1310092632):0.04397322975,(t139:0.396307644,t140:0.2396786633):0.001936072801):1.406717708,t141:1.46375449):0.684721636,(t142:1.866977335,(t143:1.61349929,t145:1.405045065):0.1355222393):0.2269628814):0.2292046274,t146:1.849581172):0.597151389):0.4418177502,((t147:0.09660574174,t148:0.04762688917):1.724894235,((t149:1.139730664,((t150:0.4839322816,t151:0.3848403778):0.2561659526,t152:0.6226948001):0.2473420867):0.05392704228,t153:0.8361168629):0.2820243967):0.8380503322):0.007101709148):0.5402610572,(t154:1.042866729,t155:0.9541936098):1.139274748):0.29161494):1.394768602,(((t156:1.021373503,(t157:0.135083712,t158:0.05170786135):0.7977677016):2.520464004,(((((t159:0.1479053182,t160:0.01788911892):1.591313434,((t161:0.6616184348,t162:0.4551510419):0.06892868724,t163:0.4111607753):0.7331259705):0.4495046374,((t164:0.4533697923,t165:0.3804484967):0.02849769833,(t166:0.368279147,t167:0.2322963006):0.008990730415):1.048815303):0.5255533407,t168:1.811906749):0.5310362605,((((t169:0.5446882207,t170:0.5227714261):0.3973308001,t171:0.8415990618):0.4191845482,t172:1.209722762):0.6805071538,t173:1.826942802):0.2961688725):0.03493693826):0.02473276264,((t174:1.374612115,t175:1.367938774):0.3481558359,t176:1.474247824):0.4545377328):0.1416630063):0.5820312784):6.76757672,(((t177:0.2398201173,t178:0.09338473079):5.115378214,((t179:0.6130972155,t180:0.6126120258):2.092365371,((t182:0.2327926303,t183:0.1723445901):1.189216606,(t184:0.5413011449,t185:0.2223046414):0.7653091786):0.8935813428):2.472543401):1.662751436,(t186:1.599735738,t187:1.583509182):4.331798932):2.267308486):0.03720783481):0.598948995,((((t188:2.888633167,(t189:0.9233955232,t190:0.9104956145):1.853448411):1.803369209,(((t191:1.447806317,(t192:1.376470306,(t193:0.7249313503,(t194:0.3868844008,t195:0.2089272502):0.2495463981):0.5848074346):0.05949012662):0.6693481092,t196:1.705905514):2.202727446,t197:3.891546485):0.1998489881):2.560108584,(t198:0.174310677,t199:0.1418005137):6.417664994):0.8319260247,(t200:2.757384434,(t201:0.3510327908,t202:0.2213088586):2.375934787):4.44264438):0.4627642502):2.784582483,(t204:10.09743551,((((t205:0.9286099078,(t206:0.3282401953,t207:0.2930078381):0.4933321887):6.068719091,((t208:0.1699373611,t209:0.1378328656):1.854901356,(t210:1.567926717,t211:1.516633666):0.2014097614):4.7157398):2.063624021,((((t212:1.521084629,t213:1.498151657):1.393554467,t214:2.774901336):1.555647466,(t215:3.833268609,t216:3.664676194):0.4036189224):1.727084006,((t217:2.127318657,t218:1.978323682):1.646015787,t219:3.570686689):1.973274512):2.296583557):0.9633845168,(((t220:3.206852774,t221:3.193846266):2.720023212,(t222:1.29000325,t223:1.258272074):4.515506496):0.6499640541,t224:6.281794083):2.143683835):0.06611559716):0.04846883898):2.498111733):3.855542901,(((t225:5.636160897,(t226:5.112766134,(t227:1.486041748,t228:0.9771190617):3.515115125):0.5026149238):1.920838999,((t229:2.91224071,t230:2.907332291):2.669894705,(t231:4.521032923,(t232:4.135619467,(t233:0.8149236472,t234:0.8109698108):3.271106196):0.2512899209):0.9972285317):1.274557417):0.1893474254,((t235:3.550582554,(t236:2.638262651,(t237:1.005923726,t238:0.964639321):1.596157327):0.8924919703):1.364710915,(t239:1.223930158,(t240:0.2357367904,t241:0.216824116):0.855369034):3.574213202):1.800185412):7.119974601):3.86314343,((((t242:3.704107272,((t243:1.92103929,(t244:0.7089203617,t245:0.3497800596):1.107566677):1.032400282,t246:2.375800957):0.6083544321):1.471672728,t247:4.441106165):8.750436842,((((t248:0.6840373533,t249:0.6559157045):1.774557925,t250:2.22909997):5.199782784,((t251:1.168079782,(t252:0.9524058154,t253:0.8913514594):0.1623667139):4.563136384,t254:5.009998866):1.687305391):5.055218272,(t255:9.96072861,t256:9.932510477):1.784242737):0.4711716702):0.4998414602,(t257:5.658872744,(t258:0.792709439,t259:0.6757995924):4.827775756):6.984172498):2.717921378):0.8053764688,((((t260:7.282120118,t261:6.930915026):2.280053957,(((((t262:0.3750739662,t263:0.3337547784):4.271246437,(t264:2.061213419,t265:1.969181217):2.463898942):0.9738249082,(t266:5.391185623,(t267:2.776050802,(t268:2.216592448,(t269:0.09641318586,t270:0.04947840007):2.082665482):0.5145108116):2.593981885):0.007630077741):2.691975803,(t271:6.169320133,(t272:4.330633455,t273:4.289738281):1.836079956):1.745319323):0.6362463671,(t274:4.61880248,((t275:0.944137153,t276:0.9147088605):1.303408259,t277:2.214526521):2.279833609):3.7225008):0.2038303548):5.303610282,(((((t279:0.286102941,t280:0.2436503589):2.587671134,t281:2.667753625):2.623084185,t282:5.233876294):0.6709939469,t283:5.776798519):5.57340905,(((((t284:0.3446790575,t285:0.335549598):1.59886479,t286:1.912560571):2.084814429,(t287:2.40640865,t288:2.373012161):1.571724045):3.605564729,((t289:6.144206634,((t290:4.821596925,(t291:0.9321759077,t292:0.9321420756):3.475973011):1.188789303,(t293:3.885317368,t294:3.866324038):1.691523061):0.1265516906):0.4069455857,(t295:3.828339069,t296:3.74451646):2.096004339):0.9325556327):2.918348858,((t297:2.844450206,((t298:0.5285419957,t299:0.5136879203):1.321573112,t300:1.774356662):0.7911679356):2.15832323,t301:4.641624809):4.618463842):0.7926552081):1.270729126):0.3578327851,((t302:0.4233508044,t303:0.2989336661):6.510361321,(t304:6.099686331,t305:5.862429842):0.5206987113):4.635346102):0.7540197448):3.08193876):0.7679091186):2.735277868):2.950102078,(((((t306:0.7860614769,t307:0.7416233313):9.972036486,((t308:1.502608497,t309:1.253566199):3.201205738,t310:4.411851375):5.995032549):6.476156575,(((((((((t311:0.9311760279,t312:0.9306386729):1.119064796,t313:1.954461409):4.891413799,(((((t314:0.4197489016,t315:0.3932903519):0.2297677599,t316:0.6141265005):3.82666024,t317:4.405490845):0.3134513415,(t318:1.507760158,t319:1.359853553):2.691834512):1.037126081,((t320:0.2460928213,t321:0.0756395863):2.211218508,t322:1.946136929):2.505071786):0.9128765449):1.157683282,(((t323:0.3286541068,t324:0.3205038524):0.8842835001,(t325:1.027982908,t326:1.004883941):0.05752361012):0.7433651209,t327:1.792352333):4.486372158):2.663787055,(t328:4.640315202,t329:4.034852868):4.301740953):2.118061411,t330:10.34861394):0.336746978,(((t331:0.2949492449,t332:0.2507805397):4.630905687,t334:4.682975323):2.643141059,t335:7.195081927):3.112620623):0.312524452,((t336:2.612861697,(t337:1.540432409,t338:1.496365417):0.7810839432):6.251540836,(t339:2.725871357,t340:2.479726629):5.164461127):1.649007588):0.6300429441,t341:9.881446009):2.633668647):0.8960829182,((t342:3.097745484,(t343:2.243141794,(t344:0.7206098065,t345:0.5816996381):1.479034576):0.7297572829):6.202228552,(t346:7.618944104,((t347:2.34979398,((t348:0.7536023678,t349:0.6130232122):1.055985764,t350:1.636778119):0.3978580422):3.892517434,((t351:1.707045226,(t352:0.186840482,t353:0.04954285778):1.504156958):2.995669389,(t354:3.32724626,t355:3.299347004):0.9305996807):1.191109407):1.366836695):1.365135443):4.036181379):0.1949933786,((t356:2.97016747,(t357:2.435522557,(t358:2.036024758,t359:2.006683528):0.1451407535):0.3354167131):5.767305865,(t360:3.229153006,t361:3.140683638):4.697740672):3.396121693):2.911036681):4.479111933):1.23904108):54.90835389,((((t362:2.853321858,((t363:1.124655287,t364:1.088875978):0.8348897167,(t365:0.2879232156,t366:0.211967107):1.36051535):0.8882277509):10.84153543,((((t367:0.09334641371,t368:0.07823207324):1.910966635,(t369:1.682235274,t370:1.575211073):0.2149427472):6.270735855,((t371:3.690849856,t372:3.659194952):3.975296833,(t373:2.374492889,(t374:1.056959859,t375:1.030170479):1.265279594):5.154413712):0.1587147851):3.228194577,t376:10.8155257):1.687803909):11.42730431,(((((t377:0.3042697032,(t378:0.1746227164,t379:0.1619528598):0.0001242459836):4.938624063,t380:5.09238365):8.364028541,(((((t381:3.031279474,t382:2.913483238):0.4400776836,((t383:0.9520673792,t384:0.8423452329):0.9255536472,t385:1.649818233):1.445170833):3.220888055,(((t386:0.9720072439,t387:0.904913397):1.624768328,t388:2.361052146):2.714971669,((t389:1.651464084,t390:1.642454296):1.384484782,t391:3.02025497):1.971100744):0.9595647629):0.6659938659,((((t392:0.9560838564,t393:0.8874008827):2.399167969,(t394:1.164796144,t395:1.154807584):2.09239436):0.5406056067,t396:3.510448344):0.6410130479,(t397:1.615772364,t398:1.587584796):2.126914239):1.936096804):1.482959639,((((t399:0.2207366057,t400:0.1813364924):1.53742742,(t401:1.148070699,(t402:0.8030686712,t403:0.749190809):0.2422316792):0.3732778484):0.3372709013,t404:1.574299789):2.787468921,(t405:0.1288475205,t406:0.08306044358):3.874694083):2.14704294):4.523552165):0.3143607196,(t407:0.9247984811,t408:0.8130409814):9.930415552):2.446861329,(t409:7.710655162,(t410:0.7335289794,(t411:0.168583254,t412:0.152977294):0.5592831729):6.761720862):5.474523477):7.535589723):30.68828791,(((((((t413:0.3125573076,t414:0.2783831601):2.291162304,t415:2.179939776):5.544559788,((t416:4.916032316,(t417:4.547773092,(t418:0.6636471224,t419:0.6219232261):3.841126274):0.3678015796):0.4495410043,(t420:4.262225538,t421:4.169553246):0.9972783938):2.31012435):1.596988507,(t422:6.870557503,(((t423:3.312111248,t424:3.269508078):1.534482289,((t425:2.795357477,t426:2.507075971):0.4041963565,(t427:0.2307350512,t428:0.181541411):2.598651811):1.398107094):0.06468152824,((t429:0.8505854236,t430:0.8423654425):3.162727799,t431:3.99335051):0.2244036079):1.849870742):1.916905453):17.04592281,(((((t432:1.634593202,t433:1.523588507):1.45285297,(t434:2.739344432,(t435:1.076159292,t436:1.066625872):1.599060089):0.2359541486):3.1628988,(t437:0.3213050445,t438:0.1864384893):5.408021592):1.269160119,(t439:3.979499851,t440:3.96170824):2.777481552):12.14102146,((t441:2.462956843,t443:2.200227366):0.6570059697,t444:2.780704029):15.74302164):5.286331377):21.46072127,(((t445:5.530169132,((t446:1.353721717,(t447:1.238280832,t449:0.96331987):0.08096941592):1.384369257,(t450:1.021534053,((t451:0.1740877615,t452:0.1193887811):0.008602182767,t453:0.1095640515):0.720541514):1.333349061):2.51650123):0.8716944893,t454:5.543464544):1.640843633,(((t455:2.657260403,t456:2.54190307):1.436706999,t457:3.964732175):2.751964365,t458:6.678892714):0.2308874511):37.13512872):1.66915048,(((((t459:1.772824359,t460:1.627417642):1.680642084,(t461:1.711677406,t462:1.684403526):1.413189606):2.795678195,(t463:2.355750639,t464:1.960713236):3.508641373):31.9167305,((t465:3.277618686,((t466:0.5747603948,t467:0.5534937407):1.566023568,t468:2.036246268):0.9873755985):1.630330842,t469:4.626879382):32.47663489):5.984682875,((t470:1.563140639,t471:1.487943111):5.02231831,(t472:0.9823996762,t473:0.9663257326):5.509222725):36.23183239):1.508265076):1.14215101):18.83258675):112.1419867);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T34.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
