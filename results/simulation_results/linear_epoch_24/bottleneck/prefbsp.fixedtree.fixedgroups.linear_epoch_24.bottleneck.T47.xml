<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t353:8.512165911,t354:8.416748921):10.0707895,(t355:6.40400604,t356:6.401572377):12.0281294):6.710627205,((t357:2.33657934,(t358:1.653131347,t359:1.631193405):0.5683089597):3.170123505,((t360:4.309351994,t361:4.145786465):0.8707949677,(t362:3.242485874,(t363:2.737212984,t364:2.68635391):0.4108417122):1.725469169):0.1501375688):19.53227249):1.156425678,((((t365:5.388320211,(t366:3.573937989,((t367:0.850552943,t368:0.7680141669):0.4867818478,t369:1.230715694):1.820360654):1.814326805):0.3496720288,(t370:0.4287077132,t371:0.1392438835):4.717605077):1.769940876,(((t372:3.458887294,(t373:2.127067879,t375:1.612912058):1.230306346):1.668059687,(t376:3.154356277,(t377:1.661747724,t378:1.6483808):1.338931718):1.256368184):1.330522125,(((t379:0.7186467249,t380:0.6439356363):1.640480915,t381:2.199593006):0.4958133476,(t382:0.3294600751,t383:0.3017639289):2.146440183):2.5881252):0.1225097056):3.297707692,t384:8.421949407):14.8142468):52.12108633,(((((t385:1.166349159,t386:1.108063422):6.038992356,t387:7.102313681):8.268664692,(((t388:0.6790419939,t389:0.56785766):0.9058143881,t390:1.443651284):5.164049175,(t391:6.315476103,t392:6.188772182):0.2479459465):8.575812806):36.79525343,(((((t393:1.468073623,((t394:0.3956070145,t395:0.245550109):0.5965172405,t396:0.7642936727):0.1375937467):17.90495103,t397:18.6340245):1.59772781,t398:20.09008904):2.052803671,((t399:1.436141254,t400:1.277560879):2.234035242,((((t401:0.2003828769,t402:0.1631692841):0.1166381067,(t403:0.2158749166,t404:0.0479335801):0.05708884162):1.303094961,((t405:1.166189956,t406:1.145414483):0.1286250935,t407:1.25970899):0.09575765219):0.9321312991,(((t408:0.6703629812,t409:0.466497264):0.7492773964,t410:0.9347011455):0.5816345505,(t411:0.1929715332,t412:0.1060287226):1.300114453):0.1840803379):0.907539778):18.4127995):20.23766713,(((t413:0.4426345719,t414:0.3804179356):8.80172631,t415:9.157922274):0.5526540526,(((t416:1.171707386,t417:1.088800788):0.8052556447,t418:1.886257321):2.820915946,t419:4.583743632):4.75331844):31.34099015):8.504991279):1.919945572,(((t420:0.8700130688,t421:0.8571014394):3.845321185,t422:4.503784874):4.335426387,t423:8.768451508):42.04200543):21.06668315):491.8963603,(((t424:2.342374574,(t425:0.945047397,(t426:0.3912036299,t427:0.3876575661):0.4997509626):1.21564295):2.269800602,(t428:1.00661584,t429:0.8889611393):3.210092834):46.73562594,((((t430:0.7004824073,t431:0.6592106527):2.097012082,(t432:2.384369901,t433:2.309971374):0.05787477331):18.53229459,((t434:2.013265007,((t374:0.1982747339,(t340:0.1362273,(((t281:0.1510746281,(t250:0.1341560684,((t239:0.001987055232,((t225:0.05183344376,((t158:0.2907912728,(t159:0.01600751742,(t149:0.05546407041,(t134:0.3527323204,(((((t107:0.2331558098,t108:0.1717684069):0.08652438937,t109:0.02588996631):0.1711188745,(t110:0.06608903703,(t105:0.24050908,(t49:0.08671914264,t1:5.041260134):5.561970319):0.5199285991):0.04804396019):0.7922702854,((((t2:7.304114311,t3:7.265736593):1.688030091,((t4:2.736664648,t5:2.652725641):2.169841198,(t6:3.975619308,t7:3.762256617):0.8216083175):3.933956279):1.462693914,((t8:9.485153148,(((t9:5.477171997,(t10:5.131894008,t11:4.858520132):0.248822862):1.324520535,(t12:0.3866349857,t13:0.1936209968):6.02116035):0.2762280981,((t14:4.845018246,(t15:4.08997841,((t16:2.948511356,t17:2.930675316):0.1877215522,t18:2.772374472):0.9436338748):0.5726161061):1.225809187,(t19:1.940337586,t20:1.853507056):3.571036549):0.3457604294):2.392047673):0.3663154211,t21:8.385432725):0.07293714879):1.189655097,((((t22:4.522142134,(t23:2.154127599,t24:2.130364129):2.336427128):3.315637253,(t25:0.8908968846,t26:0.8535708653):6.85156817):0.1357425539,(t27:7.746107676,(((t28:3.351517337,t29:3.341003529):3.817734499,t30:6.94353262):0.3992255217,((t31:3.999348312,t32:3.927298434):0.8754726668,(t33:4.015026521,t34:3.778775093):0.5854907548):2.161514625):0.1050860523):0.05231629473):0.0001357577119,(((t35:2.826388629,(t36:0.9432393486,t37:0.8850481856):1.853099067):1.588432633,t38:4.089325918):0.8395190242,(t39:2.461313741,t40:2.386832703):2.437348244):1.324991577):1.49581876):0.3157142544):3.175779443,((((((((t41:4.184771903,t42:4.154320293):1.062299854,t43:4.826478777):0.875190348,t44:5.674868459):0.1702151134,(((t45:0.3855164104,t46:0.382320895):1.79521506,t47:1.823914239):3.604102633,t48:5.373422413):0.03936714172):0.01378149261,(t50:2.195493947,(t51:0.3588107587,t52:0.3188086003):1.790650341):3.075362809):0.2017254436,((((t53:0.3850891135,t54:0.2785588658):3.887902267,(t55:0.9625940417,t56:0.8348306605):3.153239129):0.3256388868,(((t57:3.603757807,t58:3.44490007):0.5997402253,((t59:0.1279877771,t60:0.06226850791):1.148420583,t61:1.117970571):2.660986394):0.005080396911,t62:3.657816636):0.09867412815):0.04976357281,t63:3.709509821):0.3681852966):0.9068072427,(t64:3.819416512,(t65:3.479767433,(t66:2.818732224,t67:2.79618116):0.3353382286):0.2788300367):1.105879483):0.4946364712,((((((t68:1.046507226,(t69:0.2306459268,t70:0.1712726211):0.4206236488):1.670941089,t71:2.020262375):0.2537193225,t72:2.127260916):0.9332259215,(((t73:1.485480926,t74:1.398128102):0.7661320685,(t75:0.2964961624,t76:0.1810986821):1.823776008):0.01982721401,t77:1.865906775):0.6620108562):0.2141919001,(((t78:1.541016233,((t79:1.07780481,(t80:0.7152479237,t81:0.5827186519):0.28713931):0.05251499156,t82:0.8334441847):0.2564570486):0.7286456527,t83:1.764407009):0.2723516446,(((t84:1.456769781,t85:1.445236223):0.2491480804,(t86:1.244299541,t87:1.227709364):0.222819721):0.2901234243,(t88:0.2608754208,t89:0.1445515134):1.46768258):0.01708505028):0.198489663):0.5412921563,((t90:0.2982396395,(t91:0.2255361189,t92:0.218026024):0.02297245552):1.558951386,t93:1.782933366):0.4579933898):0.2109228877):3.181708934):0.2894897072):1.314086573):1.005636831):0.08026238176):5.788935608,((((((t94:0.1528162318,t95:0.02689270485):1.367958585,(t96:0.2797186479,t97:0.0674151566):0.9575121635):0.7250286769,t98:1.641243289):0.966133643,(((t99:0.1662753988,t100:0.1193552418):0.008053672558,t101:0.1105393223):2.097773419,((t102:0.01888846151,t103:0.01490691268):0.9685331509,t104:0.9518356963):1.218152975):0.2977387376):0.4152269351,(t106:1.931894944,t111:1.291406795):0.5528548709):4.789145152,((((((t112:1.019047109,t113:0.668399834):0.8057495076,t114:1.437090728):2.2000678,((t115:0.113474329,t116:0.008901754835):0.4973753072,t117:0.4614836602):2.559607786):0.672025977,((t118:2.404325307,t119:2.231109528):0.5388931171,(t120:0.4241475433,(t121:0.2496788632,t122:0.2153985295):0.01355677038):2.335211402):0.4184968588):0.3984293673,t123:3.315201847):0.9475649333,(((((t124:0.7370377448,((t125:0.1666998552,t126:0.1513049469):0.06827314404,t127:0.09515842221):0.3369036117):0.457007089,t128:0.789143725):1.124636545,(t129:0.66677221,t130:0.3738685604):0.9135725218):1.454639813,((t131:0.2769299665,t132:0.2023238459):1.498837098,t133:1.051416211):0.8304668482):0.370773986,(t135:1.246737813,((t136:0.9512000678,t137:0.7047001154):0.1642637307,t138:0.8152038405):0.1024624068):0.5127564946):0.08139170905):0.5443610567):5.684621815):1.958483018):0.762054892,(((t139:0.6841165141,(t140:0.4508211338,t141:0.3702860163):0.2269420984):1.45866496,(((t142:0.5162346777,(t143:0.2322342499,t144:0.203137192):0.1712045007):0.1762582323,(t145:0.1549210332,t146:0.1375847298):0.2366586435):0.8316669845,(t147:1.000827441,t148:0.9886558326):0.1339061881):0.4022572047):0.7813142776,(t150:1.517673163,(t151:0.80320622,(t152:0.2790090843,t153:0.2502814061):0.377226473):0.5240697908):0.6027648483):7.471446522):0.2877972537):0.7391997303,(((t154:1.648237235,(t155:1.465031948,(t156:0.10780529,t157:0.04631476777):1.18809953):0.03046158857):0.3123459295,t160:1.249283271):5.792547128,(((t161:1.217041962,(t162:0.603565976,((t163:0.3743830848,t164:0.3602621699):0.1374469831,t165:0.2792795512):0.06197882323):0.4806568947):2.798823725,(t166:2.411601692,t167:2.247684452):0.971200181):1.583749191,t168:4.725860074):1.435909565):2.49403932):0.234563307):3.046776761):2.829329514,(((((t169:0.2445390632,t170:0.2196234663):0.3931044169,t171:0.3995792749):0.7096137036,t172:0.6558976662):4.02358548,t173:4.604316662):0.157011636,(t174:3.060504158,t175:2.917560557):1.506711623):9.079035725):2.427510142,((((t176:0.4660669572,t177:0.3923037311):2.504890184,((t178:0.7112362531,t179:0.6872831855):0.6286172574,(t180:0.8611644358,t181:0.7379548433):0.3452874503):1.364360792):5.991268081,((((t182:0.05209230706,t183:0.03579900489):2.362783403,t184:2.397072912):1.284347798,t185:3.61391203):0.2052204939,t186:3.714950838):4.42628563):3.661269715,(t187:5.13263457,(t188:3.684378041,(t189:1.812812113,t190:1.554172914):1.760864078):1.266232358):6.654019649):3.068178666):2.72378523):3.680396499):1.077159654,(((t191:2.490579677,t192:2.466762234):0.1948441372,t193:2.623895427):16.54938481,((((t194:0.212836245,t195:0.2119411667):5.959902407,t196:5.926317998):1.315232587,t197:7.233513069):6.892626798,(((((((t198:2.065048266,t199:1.932693835):1.105076654,(t200:1.089618375,t201:0.9124580383):1.920542767):6.247928437,t202:9.013274765):1.370202362,t203:10.33006159):1.027738603,((t204:6.127622483,(t205:4.821892684,(t206:3.866437922,(t207:2.277488062,t208:2.047518717):1.463426876):0.7014530418):1.250633514):0.6060908105,(((t209:1.731743397,t210:1.371609764):0.009319709624,t211:1.366351105):3.533432508,((t212:1.710971774,t213:1.611673297):2.367399961,(t214:1.226820473,t215:1.005685677):2.751364184):0.7810878477):0.6457764211):4.540915905):0.456024589,(t216:0.4421190021,t217:0.3813511778):9.694256022):1.022397013,((t218:1.895219731,t219:1.775899322):1.153047771,t220:2.921009882):7.808797408):0.7992924916):4.584296862):2.430758488):6.486734655):2.079970038,(((((((((t221:0.7608370207,t222:0.5869386525):4.505711459,t223:5.075218883):0.7365063595,t224:5.499230732):2.76136743,((((t226:0.4085876778,(t227:0.1135618662,t228:0.0982633385):0.2702342841):2.43307636,t229:2.607826926):2.861088911,t230:5.38842233):0.6179484225,t231:5.862695404):1.709451509):4.629858716,(((t232:1.505992953,t233:1.502030903):8.610937548,(((t234:1.44845155,t235:1.348894528):5.199473086,((t236:2.646391186,(t237:1.807973134,t238:1.762292924):0.8182586718):3.175391335,(t240:2.069461528,(t241:0.2141857634,t242:0.1645345486):1.834564026):3.583926184):0.5618123041):0.3487644175,t243:6.468054408):3.076008134):0.2780785479,(((t244:0.4629358081,t245:0.4072896358):2.649411382,(t246:2.786391302,t247:2.756915848):0.2174725226):4.541232675,(((t248:0.8070469764,t249:0.7372527309):0.2175217705,t251:0.4887235977):0.4095273866,t252:0.8361761833):6.080016537):1.879439971):1.754833429):8.382322834,(((((((t253:1.659571641,t254:1.613198401):1.96223917,t255:3.347822329):1.008344356,t256:4.27467895):1.652099501,(t257:4.995188823,((t258:0.9957983969,t259:0.6114436952):2.002393946,(t260:0.8155339172,t261:0.7337970509):1.655228152):1.829592914):0.6438599643):4.569302179,(((t262:2.447673267,((t263:1.183740764,(t264:1.006276208,(t265:0.5060714389,t266:0.4654512726):0.4987794877):0.1519378418):0.9414774413,t267:2.051074667):0.2695283189):2.122749853,((t268:0.2570348962,t269:0.1731116895):0.05652626181,t270:0.2149685819):4.033771117):3.647105427,(t271:5.661174497,t272:5.661109441):2.204956291):1.164481276):0.1236633292,((t273:1.108285686,t274:1.085860172):3.752985131,t275:4.315836011):4.290532835):2.492587124,(((t276:5.954776961,((t277:2.267307568,t278:2.235555885):2.545710885,t279:4.688821095):1.123220533):2.633974177,((t280:0.6649179086,t282:0.4725348726):1.740470061,t283:2.143377205):6.020955491):2.144469399,t284:10.29411367):0.302084837):5.360103315):0.2260154526,(((((t285:2.125056196,t286:2.074432919):2.372866062,(t287:4.338137214,t288:4.108824966):0.03051595064):7.214916947,(((t289:1.764663869,(t290:0.5107738041,t291:0.4365312089):1.248527073):5.412182084,((t292:2.911227786,t293:2.736010489):2.0541681,t294:4.713326639):2.049100167):3.60901154,t295:10.19649805):0.5601054833):0.176339451,(((((((t296:1.053498873,t297:1.023515398):2.184473834,(t298:1.608871441,t299:1.600168469):1.542008709):0.4699705042,(t300:1.991759204,t301:1.811528602):1.535421339):0.5345672653,t302:3.647848424):2.318582472,(t303:5.198594843,((t304:4.133370002,(t305:1.928227942,((t306:0.4767938977,t307:0.3919713179):1.174963136,(t308:0.4712406282,t309:0.3433212621):0.6728920194):0.1945487777):2.188702248):0.7344459527,t310:4.064285935):0.3145656191):0.4336226256):2.377071053,((t311:2.863354727,((t312:0.1821702618,t313:0.009717492998):1.807864608,(t314:0.8674080072,t315:0.7540686152):0.8222797253):0.7043992987):2.47721616,t316:4.500400617):1.774853296):0.8383920458,(t317:4.057851957,t318:4.000194024):2.963641554):1.105160359):0.1703848873,(((t319:5.736280846,(t320:2.270978588,(t321:1.295460496,t322:1.190491904):0.8909011402):3.427848483):0.4366490225,(t323:1.706033252,t324:1.679130277):4.017584837):0.7743681864,((t325:2.634498922,t326:2.573168825):3.470740654,(t327:5.902252064,((t328:5.324494133,(t329:3.066813493,t330:2.968031909):2.245029593):0.3847008985,(t331:3.522642467,t332:3.340412934):1.668902685):0.1885221237):0.1393125888):0.3317471444):1.17391913):4.017309288):3.18952167,(((((t333:0.5403384807,t334:0.07671403968):2.749551511,(t335:0.5822684316,t336:0.2724500865):1.772423566):2.998759287,((t337:3.380319549,(t338:1.102978709,t339:1.066106813):1.376097886):0.1225588191,t341:2.253351517):1.408196716):3.941081795,((t342:0.9358213861,t343:0.8276845432):2.32380516,t344:3.121217748):3.926140375):0.8801315672,t345:7.920956004):2.875197988):0.8092571937,(t346:9.743003678,t347:9.739910911):1.851505211):1.011599936):16.74342856):13.695941,(((t348:0.7812373476,(t349:0.2763838715,t350:0.1801046573):0.4829822935):1.082250904,t351:1.590634893):10.84847869,t352:12.38779344):30.11220716):15.76490216):512.3308651);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T47.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
