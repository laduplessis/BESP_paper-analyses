<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t433:8.329656338,((((((t434:4.104208521,t435:3.777094736):0.7062858584,(t436:2.056904797,t437:1.982603421):2.120883601):0.6710751348,((((t438:1.52642282,(t439:1.488156566,t440:1.364011733):0.02910051404):0.2401755201,t441:1.56441976):0.1006495171,t442:1.592694615):1.943672617,t443:3.515137435):0.8701224181):0.81196927,(t444:1.377828226,((t445:0.6530509445,t446:0.6224219825):0.4866025579,t447:1.069405449):0.2171449194):3.721635559):0.5143259843,t448:5.288277753):0.6740544725,(t449:1.197990347,(t450:1.000108355,t451:0.9981419787):0.130950108):4.592915655):0.7972671777):0.5189835788,t452:6.800599295):60.2763974,((((t453:6.265496638,t454:6.182033475):0.07821240046,(((t455:1.429392323,(t456:0.4079981708,t457:0.3702680623):0.9929145642):0.06039955271,t458:1.395166744):2.810027563,(t459:0.7742046892,t460:0.6794458755):3.375842253):1.932864979):31.98535445,((((((t461:3.498052218,t462:3.411510458):0.7924010511,(t463:1.996295503,t464:1.949599177):2.181796694):0.307280492,(t465:3.716824101,(t466:0.2444303944,t467:0.1280668201):3.354982423):0.5885596828):1.543331717,t468:5.598928444):0.4664407252,t469:6.051475982):2.977539076,t470:8.915745232):28.33292699):23.49575049,(((((t471:0.138354172,t472:0.1199166649):4.135023505,t473:4.203888388):0.9969669393,(t474:1.853677508,t475:1.72348888):3.341282008):44.82004515,((((t476:1.106839167,t477:1.046761268):3.725528629,((t478:1.439024772,t479:1.082648843):0.7741882033,t480:1.805507467):2.548581424):4.909458074,t481:9.226192271):25.3483649,((t482:14.70884623,t483:14.67099034):1.897881813,(t484:1.574645672,t485:1.327515258):14.98970045):17.90169287):14.79148183):8.872230326,((((t486:2.368763957,t487:2.134509586):10.53630031,(t488:5.93783855,t489:5.798597559):6.637805316):6.77236724,(t490:10.49128515,t491:10.42003751):8.702356879):25.49292247,t492:44.51619508):12.46944952):1.660834679):5.077075556):5.518538564,(((t493:0.07669070019,((t431:0.08869357819,(t422:0.05685469727,((t390:0.02411184015,(t381:0.01141786265,(((((t169:0.7286465278,((t170:0.2631818474,((t168:0.09397840086,((t163:0.04881011787,(t131:0.02347797502,(t127:0.03329664384,(t119:0.08025189245,(((t104:0.05016928383,((((t36:0.1480817179,(t19:0.1749666287,(t1:2.155729233,t2:2.02173056):0.4968180398):2.029065407):3.289983487,t3:7.760515664):0.9950797198,(t4:2.386072141,t5:1.808499479):6.205737712):1.357298007,(t6:8.775860483,(t7:8.671308246,(((t8:3.201594423,(t9:2.412016761,t10:2.39967416):0.7752232015):0.1267231369,t11:3.293492882):3.273899438,t12:6.52139123):1.627140651):0.02752496993):0.386635496):0.2957506827):0.2108043518,((((t13:0.8565503538,t14:0.5804580541):4.7222135,((t15:2.64300414,t16:2.504285589):1.676054574,(t17:0.09562860811,t18:0.09454867672):3.960462545):0.9420966191):2.05517673,t20:6.718441784):0.4600218258,((t21:0.5637732978,t22:0.4242676535):3.51629676,t23:3.927344266):3.023767632):0.9156064045):0.08549867313,(t24:3.831834669,(t25:2.362052901,(t26:1.261606563,t27:1.209322205):0.8723473878):1.241822883):4.114420887):1.022080223):0.3560805188):0.3755595876):2.64285555):0.2380781771,(((((((t28:3.210344642,t29:3.176427704):2.894437521,((t30:0.4980722121,t31:0.4880394744):4.937193902,(t32:4.649210018,t33:4.606300085):0.7695943864):0.4620210547):0.1956695796,t34:5.941790468):3.926658801,((((((t35:4.310889994,(t37:3.491009946,t38:3.384992027):0.3469612426):1.359920389,(((t39:2.441858724,(t40:0.2259336431,t41:0.1364565064):2.212471325):2.262988243,(t42:4.010976315,t43:3.984830751):0.4252229803):0.3773163026,(t44:3.762255395,((t45:0.7318590892,t46:0.6818930547):1.201029415,t47:1.861251856):1.782066174):0.7902895947):0.003335394733):1.202651402,(((t48:1.01541626,t49:0.9716980449):2.620488034,(t50:0.3241730322,t51:0.2127717266):3.055295969):0.8861262089,(t52:3.11636737,t53:2.899074494):0.9220656325):1.019165632):0.394952718,(t54:4.935198483,((t55:1.139359185,t56:1.138097882):2.586130615,t57:3.327045114):1.207193056):0.2763590255):0.09563475438,(t58:4.498826607,((t59:2.977682299,t60:2.96447831):0.3405687129,(t61:2.785365493,t62:2.74812848):0.5161914095):1.085277225):0.2841194131):2.16554745,((((((t63:1.089149382,((t64:0.8020236315,t65:0.605465915):0.1437689977,t66:0.7040841019):0.1266718509):0.5971963363,t67:1.396639472):1.384620937,(t68:2.486537805,t69:2.373155894):0.2356108447):0.605311258,((t70:1.851127616,(t71:1.823913515,t72:1.661074267):0.01728086481):0.8800118467,((t73:1.035742049,t74:1.01936207):1.314989981,(t75:1.937197139,(t76:1.824595707,t77:1.717502147):0.06284042656):0.2659995593):0.1792107009):0.3706827446):2.100521847,(((((t78:1.846369761,t79:1.680669706):0.8790140434,(((t80:1.699180562,t81:1.587873893):0.2931471087,((t82:0.3381021666,t83:0.2402657373):0.4114082558,t84:0.6190154515):1.072980686):0.04972430837,t85:1.716001257):0.4480130817):0.07718561792,((t86:1.10999766,t87:1.107331507):0.650048537,(((t88:1.016873997,t89:0.941803611):0.1220188023,(t90:0.9484149356,(t91:0.3335613584,t92:0.1104835457):0.5883291177):0.05077944992):0.4994079488,(t93:0.5333217706,t94:0.3724380245):0.6355270531):0.07768692703):0.4644326867):0.84698898,((((t95:0.2860615157,t96:0.04625270251):1.000394371,t97:0.7588004486):0.05177941357,t98:0.7893279044):0.1234227392,((t99:0.3218997609,t100:0.3150800648):0.02745855666,t101:0.2924240042):0.4100793165):0.8361088709):0.002390513558,(t102:1.189717021,t103:1.178675483):0.2325751092):1.04302283):0.6740902681,(t105:2.154094085,(t106:0.3963460746,t107:0.3388721557):1.646109047):0.7219855639):0.3461967215):0.03664179572):0.1604592764,((t108:1.980789742,((t109:0.6130667521,t110:0.3898934691):0.4974355506,((t111:0.213187336,t112:0.07720597551):0.1507025283,t113:0.1115674759):0.4896012638):0.7919059018):0.296055927,((((t114:0.3804175149,t115:0.3564899832):0.1018095005,((t116:0.1261145059,t117:0.0747757019):0.2375630809,t118:0.2971949627):0.007120815329):0.5845211176,(t120:0.4581694434,t121:0.4459530519):0.2004422751):0.03503860801,t122:0.6735589359):0.5749995663):0.9207991567):0.9714282628,(((t123:1.696794028,(t124:0.3245213749,((t125:0.2907153469,t126:0.1966954417):0.02083302306,t128:0.02101572004):0.01063149699):1.363563684):0.06261900035,t129:1.249906413):0.1840772038,((t130:0.7834671058,t132:0.7185675336):0.2461111852,t133:0.9639499225):0.3941961498):1.140308728):0.007869676473,(t134:2.142483063,(((t135:0.5070396812,(t136:0.2119118315,t137:0.07602480287):0.1276347327):0.1420737603,t138:0.2233452133):1.270447438,((t139:0.1223188939,t140:0.1060564278):0.4655913934,t141:0.2030121109):0.8930122878):0.2087419515):0.2536580225):0.3671676246):0.106315697):0.1810077716,(t142:0.4696544501,t143:0.1930519709):1.679443186):0.7964277272):0.009283469563,((t144:0.5151122531,t145:0.5018791437):1.09108562,(((t146:0.630897249,t147:0.5975416139):0.1881846055,((t148:0.2687377789,t149:0.1622490519):0.2202687634,t150:0.3397571157):0.2580708841):0.7239976205,(t151:0.02454063998,t152:0.01807401751):1.186381497):0.0421093529):0.862079645):0.049053219):0.6055367703,((t153:2.048031843,t154:2.009704008):0.5161058076,(t155:1.052065546,t156:0.9463080405):1.459543621):0.09924904945):0.6768966392,((t157:0.5577102604,t158:0.3734746978):0.9242172558,t159:1.24613666):1.6826413):0.4257864172,((t160:0.4482238882,t161:0.410305776):2.291142473,(t162:1.558184888,t164:1.442190959):1.127601111):0.4591186525):16.93903938,((((t165:2.047985904,((t166:0.3137246535,t167:0.2243935389):1.043689208,t171:0.05222070127):0.6843196272):1.370493372,((t172:0.9041453023,t173:0.7877360834):0.8183875449,(t174:1.523416981,(t175:0.6991515017,(t176:0.3007701746,t177:0.214930606):0.2674777585):0.7463197412):0.05764242157):0.3779100402):0.1047145761,t178:1.768671259):6.212569189,(t179:6.547315326,(t180:0.1856932036,t181:0.1570194584):6.260231994):1.133009817):10.15470168):1.619018882):0.5631781486):2.329859726,(((((((((t182:0.8861505222,t183:0.7201355794):0.02369579792,((t184:0.196522947,t185:0.1315416648):0.4643190338,((t186:0.3517239949,(t187:0.2475362786,t188:0.08130903895):0.04006582969):0.003562684577,t189:0.08510015419):0.09418376129):0.05216734754):0.7933608773,t190:0.9962343148):2.35338054,((t191:0.5736478664,(t192:0.3996294539,t193:0.1309584395):0.1120800369):0.6492152188,t194:0.7752521556):2.113948716):7.799248974,(t195:2.380096554,t196:2.322384737):8.184849286):0.851345781,(t197:7.542153891,((t198:0.4688133686,(t199:0.3381060924,t200:0.2336146066):0.002747519106):6.892471557,t201:6.964323651):0.008751920984):3.560238792):1.602273955,t202:11.95727651):1.449053299,(t203:8.318866298,(t204:7.854748734,(t205:2.781340875,(t206:1.435109441,t207:1.415131875):1.069244118):5.05981206):0.2666159501):4.947860555):4.541445772,(((((t208:11.10277267,t209:11.07195807):0.5208487718,t210:11.55218034):2.796617899,(((((((((t211:0.1842745808,t212:0.050414132):1.352649496,t213:1.2446088):3.464447311,t214:4.654827946):1.349517262,(((t215:0.8421957116,t216:0.8384568673):0.6495448072,t217:1.262060142):0.2924354519,t218:1.449742123):4.165160469):3.976743366,((((t219:0.793546926,t220:0.7196417659):0.7842978362,t221:1.457663145):1.859077495,t222:3.222245672):3.178668996,(t223:3.309260642,t224:3.248675915):3.082528503):2.89190459):0.7103945313,((t225:0.963022879,t226:0.8262020709):1.417702232,t227:2.195946055):7.485537287):0.1486282653,(((t228:2.432349742,t229:2.411794944):0.3488616016,t230:2.734739615):4.483371546,t231:7.154208994):2.354531682):1.403070813,(((((t232:0.6093897549,t233:0.5077428939):0.9070712953,t234:0.9944405906):1.981358155,(t235:2.713513886,t236:2.65726705):0.2369725714):1.579283669,t237:4.282819947):1.459281053,t238:5.691764159):4.274633472):0.811887139,(((t239:2.818947236,t240:2.742537451):4.372174775,((t241:1.738816398,(t242:0.8505434403,t243:0.8337935763):0.7239028835):2.539150312,t244:3.936188494):2.809304948):2.064099964,t245:8.441493375):1.307665496):0.9254942552):1.243478573,((t246:1.651894248,t247:1.593530032):0.6296458353,(t248:1.549315741,t249:1.430521754):0.567211744):9.630502383):0.4720293044,(((t250:7.603781928,t251:7.550294197):2.753258338,((((((t252:2.645972045,(t253:1.188833823,t254:1.150422221):1.416370311):0.1713224904,(t255:0.1231450308,t256:0.01850578146):2.519820838):0.3584886447,t257:2.833572107):0.8405970768,t258:3.619509864):0.3920680232,t259:3.985145173):2.628118717,(((t260:0.958476936,(t261:0.8950517089,t262:0.8751128413):0.03985478221):5.055299858,(t263:2.039852413,t264:1.856839179):3.898765224):0.4012188541,((((((t265:1.611016137,t266:1.537376575):1.494586264,((t267:0.9527369967,t268:0.7334729727):1.087065611,t269:1.808211516):0.8796989408):0.3811964182,t270:2.852507356):0.1948501824,t271:3.04003847):0.5067436962,t272:3.51424572):0.5103512298,t273:3.783615622):1.387512002):0.05199618423):3.175583957):1.253270256,((t274:4.310027961,t275:4.284845163):4.357314391,((t276:5.630137571,((t277:3.271711913,(t278:2.07257203,t279:2.059608257):1.188269225):0.5961058598,(t280:2.253070754,t281:2.165675872):1.557344604):1.669151596):2.606803344,(t282:0.4275831394,t283:0.4137410768):7.550443625):0.005469207958):0.9726390608):0.4339890107):1.156943658):1.897507989):1.279474163):1.051697081):1.970831355,(((((((t284:4.124571406,((t285:1.862005349,t286:1.347156979):0.5844970003,t287:1.760412493):1.661327833):1.137917537,(t288:2.160938239,t289:2.04899601):2.13387758):2.323172881,t290:6.494452105):3.898167813,(((t291:4.597968717,(t292:3.437013024,t293:3.420632675):1.146196732):0.5715613214,(((t294:1.725012019,t295:1.721603837):0.2297676926,t296:1.412565693):0.7266741234,(t297:0.3377247839,t298:0.3264342463):1.748618417):2.342449495):1.432577338,((t299:3.031293479,(t300:0.1641818547,t301:0.1133789006):2.779861533):2.314893397,(t302:0.02271725439,t303:0.02256654218):5.176542423):0.4501633529):3.690179396):3.60031965,((((t304:1.492925651,t305:1.426508721):3.969948553,(t306:2.447810611,t307:2.361460024):2.883970048):1.288425492,(t308:4.712335651,((t309:1.804681418,t310:1.71129681):1.259115929,t311:2.883050868):1.512720675):1.603166527):5.272110795,((t312:0.1423547649,t313:0.09296513016):0.7250413607,t314:0.7724781572):10.22950372):0.8500263251):0.851795281,((t315:0.1337007844,t316:0.02239438155):6.739349762,(((t317:1.398545612,(t318:1.071044552,t319:1.063305533):0.2444887285):3.956583272,t320:5.222587113):0.2526061921,t321:5.466958491):1.063229168):5.571333949):0.6967760947,((t322:7.496330869,(((t323:0.2907150243,(t324:0.1423078901,t325:0.1299559172):0.01198886563):6.342914684,(t326:2.335077375,(t327:0.1986213527,t328:0.01199678472):2.020927631):4.101177686):0.4104656272,(t329:3.8781317,t330:3.665291718):2.650192243):0.449621204):1.018288791,(((t331:1.076449532,t332:0.8871541726):3.402363386,((t333:0.2862019621,t334:0.2799541781):2.982808094,t335:3.141513773):1.006227881):1.813162847,t336:5.916499391):1.438269003):4.268125986):0.02933467409):3.814373621):0.05386650805,(((t337:9.189340486,(((t338:1.519435772,t339:1.494536317):1.584984804,(t340:1.654336746,(t341:0.8683254013,t342:0.8050610961):0.5852533826):1.393332333):2.030312023,t343:4.52177318):4.028847214):1.07907977,((t344:7.447492011,(t345:6.501253365,(t346:4.834253462,t347:4.651373398):1.65065098):0.7900571252):0.9481939801,t348:8.019634865):1.144537216):1.485149154,((t349:5.034821378,(t350:3.270524795,(t351:1.68509922,t352:1.596062915):1.458466215):1.545158827):4.318744706,((t353:6.529873369,t354:6.400273917):0.06933031706,((t355:0.4099939135,t356:0.3192790043):0.6020229334,t357:0.7713656115):5.387653689):2.258083112):0.9789325534):3.711033161):13.8731296,((((((t358:7.57536936,(((t359:2.00705792,(t360:0.5699141961,t361:0.4798682615):1.401025128):3.661092038,(((t362:2.01502912,t363:1.905510051):0.126310288,t364:1.939112954):3.249742674,(t365:0.572445829,t366:0.2849647976):4.483448425):0.04967878591):0.07920185447,(((t367:0.1457907543,t368:0.1317883059):0.7109381719,t369:0.8049745321):3.415920469,(t370:3.128180691,(t371:0.9548184736,t372:0.9023746154):2.151776955):1.014491011):0.5299208042):1.789251459):0.1187116827,((t373:0.5632500991,t374:0.561217957):5.534692594,(t375:3.400148306,t376:3.365185089):2.657940452):0.1856209127):0.5236289697,(t377:0.9902138771,t378:0.9845185267):5.701143904):2.405449383,(((t379:0.5246439703,t380:0.5119390577):2.179665595,t382:2.512611781):5.720928341,(t383:3.824931548,(t384:3.260303299,t385:3.124391374):0.4341390714):4.37223267):0.538744329):6.210252861,(t386:2.178548484,(t387:0.2441356881,t388:0.1969204182):1.892540799):12.48772536):6.500065902,(((((((t389:1.77225959,(t391:1.410884417,t392:1.029830989):0.182772571):1.01923638,(t393:1.707355816,t394:1.534043791):0.1103770084):4.139585112,(t395:1.355207181,(t396:0.7246292983,t397:0.4471850442):0.5511614626):4.21377133):2.114953873,(t398:5.897248107,t399:5.895734509):1.394689313):5.290848028,t400:12.42159186):0.605563318,((((t401:6.865583214,((((t402:0.3838793483,t403:0.2637373704):0.3604902058,t404:0.6027526658):5.311335765,(t405:1.501972774,t406:1.438664861):4.374486073):0.714045494,(t407:4.881974,t408:4.872690187):1.642752799):0.02744555225):3.515691633,t409:10.04522388):1.472623656,(t410:5.033657899,(t411:1.458082424,t412:1.440653485):3.384783273):6.368453355):1.011674583,((t413:1.892298829,(t414:0.7460583622,t415:0.6888891497):1.126727639):1.848916776,t416:3.265966371):8.434928548):0.1513636675):0.7274907558,((t417:9.046865658,(((((t418:3.397770726,t419:3.382209544):0.8088594308,(t420:2.375179609,t421:2.300122407):1.547772832):1.318492462,t423:4.915622547):0.2719614863,((t424:0.8889648118,t425:0.7912901231):4.058949044,(t426:4.798430974,t427:4.769547948):0.01003044008):0.1293318366):2.513133485,(t428:2.643756883,t429:2.504891421):4.538730161):0.5846461662):0.01315145993,(t430:4.541657796,t432:4.195368961):3.069460054):3.51705842):5.392652644):3.42237181):55.224721);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T33.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
