<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t386:4.356250391,(((t387:1.76141646,t388:1.754883429):0.1675052542,t389:1.872692191):0.5413000518,t390:2.381554946):1.855163246):2.450347436,(t391:0.148022191,t392:0.04320298821):6.488905436):7.37424818,((t393:12.70489327,(t395:4.962523559,((t396:1.599743174,(t397:1.07525027,t398:1.038586285):0.486578242):1.122961626,(t399:2.265485708,(t400:0.2128524428,t401:0.1641118463):1.828032964):0.2643363578):2.211143102):7.526247442):0.3128136279,(((t402:3.644503543,(t403:2.578024747,t404:2.572292041):0.9622526224):1.215438573,(t405:3.533283834,((t406:0.217146674,t407:0.1181674058):1.014304009,t408:0.7404452145):2.161644237):0.7722185344):1.995406744,t409:5.640193229):5.391688158):0.7365999706):48.48662729,((((((t410:1.228582929,t411:1.149467974):1.723253959,t412:2.827996875):0.7318759,(t413:2.145067069,t414:2.130070582):1.393913867):0.6882693696,t415:4.108940457):5.879297053,((t416:5.668993226,(t417:3.441163769,t418:3.248831043):2.067718213):3.219880769,((t419:2.367687595,t420:2.308610503):2.800352845,(t421:0.5510635629,t422:0.4945146363):4.138551136):3.351829101):1.087490834):10.38947071,((t423:9.739628609,((t424:5.385170619,t425:5.328742356):1.602815971,t426:6.799755818):2.739554987):0.7269773767,(((t427:0.2734338064,t428:0.1869168831):6.986381082,(t429:0.8418866359,(t430:0.2550532582,t431:0.2361831094):0.5253899818):6.281579912):0.5615998699,((t432:4.001159414,t433:3.965334852):1.424029976,t434:5.231205406):2.14403679):2.440060397):8.909143792):39.5421189):135.1618169,((((((((t435:1.969728822,((t436:0.5157023463,t437:0.2128449939):0.664621021,t439:0.3591278659):0.7758096235):1.853952793,t440:2.923245345):0.1015768035,(t441:2.768277714,t442:2.679925657):0.06672346876):0.9809885313,(t443:1.921519815,t444:1.76982785):1.767593596):15.88702843,(((t445:1.378331017,t446:1.308218838):2.118344704,t447:3.249043467):2.769199694,t448:5.966058186):12.97715118):3.959809734,(t449:3.864524924,(((t450:2.11056507,(t451:0.9269836483,t452:0.8508398317):1.005344096):0.0409065611,(t453:0.6935933618,t454:0.6261776289):1.186361165):0.1828817645,(t455:0.3788351966,t456:0.2352151061):1.316421989):1.459272187):18.93451833):7.783029803,((t457:5.448396851,(t458:1.972880851,t459:1.821616075):3.41626491):14.77916311,((((t460:0.9737334324,t462:0.6932118174):8.869930525,(t463:3.956680325,(t461:0.2195422726,(((t438:0.02431364259,(((t394:0.02214725676,(((t333:0.004946778345,(t289:0.1401940669,(t285:0.0160603075,(t278:0.07511344044,(t207:0.02210552827,(((t184:0.143983626,(t167:0.2546693183,(t136:0.08371619136,(t124:0.003673842964,((t107:0.04042827658,(t102:0.06809955632,((t98:0.1451379609,(((t91:0.01388140917,(((t50:0.1226972204,(t1:1.86752951,t2:1.862652898):3.971436611):4.153938303,((((t3:1.813582356,t4:1.728401518):1.768299906,(t5:3.387781913,t6:3.165295869):0.06505324453):1.13209029,t7:4.315764493):1.190739496,(t8:0.867182707,t9:0.8582348074):4.532846983):4.058932746):0.01258550572,(t10:6.940207009,t11:6.824865033):2.48716103):0.5466811945):0.07785267709,((((t12:2.441135375,t13:2.377516615):0.004113938339,t14:2.372277239):2.797792559,t15:5.037009043):4.064180899,((t16:0.5572957419,t17:0.394992724):5.978791003,t18:6.207204227):2.41993864):0.5652366838):0.3201197909,(((t19:5.419581254,t20:5.240911597):3.143780286,(((t21:3.427821622,(t22:2.394020943,t23:2.327562685):0.9933717987):0.5812976514,t24:3.873061055):3.739587376,(t25:7.090303376,t26:7.044438466):0.4010421879):0.6085884822):0.3406551531,t27:8.326491206):0.556180568):0.2646161025):0.417212482,((((t28:1.466059023,t29:1.336540873):6.350690568,(((t30:5.466925457,(t31:2.341712599,t32:2.303737701):2.79244957):0.9002595837,(t33:3.945458685,t34:3.463016758):2.048788829):1.197339137,(t35:1.313865956,(t36:0.8824821741,t37:0.8211013197):0.3406163622):5.184959831):0.007402015149):0.1521901244,((t38:0.5339370903,t39:0.3938998294):3.488518002,t40:3.740631502):2.437228095):0.4858722859,((((t41:3.399981546,t42:3.343787171):0.8389253324,t43:4.145525179):0.3446041299,((t44:0.3685577732,t45:0.3088797607):1.80689804,t46:2.019214938):2.141141353):0.9248048613,t47:4.786292231):0.2347914734):0.9518273165):0.1725025382):0.6037593499):1.194575985,(((t48:1.166589875,t49:1.149438603):3.289255609,t51:4.149533908):0.691725148,t52:4.758439968):2.79563401):0.9012499494):1.429186226):3.58760276):1.837890115):1.380269487,(((((t53:0.6901422646,t54:0.6229034634):3.420749412,((t55:1.591699737,t56:1.500345633):1.97365336,t57:2.862370066):0.4222732886):0.3383978939,t58:3.56440243):4.666687329,((((((((t59:3.021565103,t60:2.935437974):0.07511111932,(t61:2.731744615,(t62:0.8331908527,t63:0.6936223981):1.634881755):0.06445908646):0.03622895613,t64:2.343081385):0.2353434609,((t65:1.416241949,t66:1.412438371):0.4665632597,(t67:1.706364518,t68:1.678178113):0.1280551003):0.2236008808):2.223326511,((t69:0.1205492216,t70:0.04632007148):2.707662409,(t71:2.67440411,(t72:2.60778425,(t73:1.65019888,t74:1.54401141):0.7970689478):0.03686103975):0.07089207803):1.228436714):0.9411256473,(t75:2.604322102,(t76:1.002336445,(t77:0.8135204204,t78:0.6863514931):0.1105731099):1.466248541):1.975878432):0.195007626,(((t79:2.762636686,((((t80:1.034214918,t81:0.9851560429):0.1119874458,(t82:0.5610326209,t83:0.5565786359):0.5211237022):0.8529202872,t84:1.850902793):0.5122496084,((t85:0.7508117638,(t86:0.3965882348,(t87:0.07843526374,t88:0.03562848937):0.07529281725):0.1878297884):0.5680570865,t89:0.7888421345):0.8571403759):0.2335916212):0.05671841646,((t90:1.182882212,(((t92:0.04443374783,t93:0.0147371096):0.7692851203,(t94:0.6725651251,t95:0.6285109084):0.003092956772):0.2313280781,(t96:0.04591113861,t97:0.0446521381):0.6394922304):0.0409553053):0.2844288407,t99:0.7068271414):0.3131440554):1.049802501,(t100:1.444791179,t101:1.014542423):0.5901354807):0.4172711249):0.393576409,(t103:2.182707163,(t104:0.4814608465,t105:0.4728929648):1.362001697):0.0143216892):1.083933266):3.324593438,((((t106:1.888540758,t108:1.622477068):0.3943248521,t109:1.849208705):2.903657928,((((t110:0.7882117213,(t111:0.3162327449,t112:0.08568569538):0.4324070643):1.076506124,t113:1.538274482):0.1757595994,((t114:0.9732933581,t115:0.8291910077):0.5950686622,t116:1.374942351):0.04368358491):1.601291723,(((t117:0.8808307565,(t118:0.6694213884,t119:0.255978258):0.1442720294):0.002299387374,t120:0.3864822681):0.878515991,t121:1.201915519):1.175034649):0.9780840775):0.1940284881,((t122:0.6025481628,t123:0.3103088726):2.442641173,(t125:0.9513702433,t126:0.9158211526):1.676870837):0.4882480121):0.8619975398):4.231218732):0.1442293506,(((t127:0.9591846502,t128:0.7193437315):0.1265718657,t129:0.801353766):4.892059658,((t130:1.576752293,(t131:0.1350662718,t132:0.09518819911):1.062362309):0.5396538621,((t133:0.5865944345,t134:0.4237483903):0.5366026309,t135:0.7980972753):0.5704324813):3.487220248):2.197340642):0.7043162884):6.451077985):0.767206909):0.5768428233):3.842744589):0.2997596497,(((((t137:2.529474613,t138:2.495125198):0.7703069392,(t139:0.7132138638,t140:0.6307538319):2.470786505):13.35861972,(((((((t141:0.4613845979,t142:0.4467788964):0.1164197178,t143:0.1877643921):0.2585652874,t144:0.4275690635):0.8257620668,(t145:0.5002468068,t146:0.4911814866):0.7484168635):0.8535100207,(t147:1.247301795,t148:1.183499568):0.5050619258):7.403738312,((((t149:0.2212911234,t150:0.2091986379):0.863126598,(t151:0.2285335431,t152:0.04388458931):0.6678665468):0.07239529562,t153:0.5141772557):1.196400838,t154:1.698377989):6.630216639):4.424256124,((t155:7.214063914,((t156:0.6307771724,t157:0.4371851339):0.7164462802,(t158:0.5216090975,t159:0.4879474111):0.616716066):5.748192682):1.582448524,((t160:0.5733771005,t161:0.4390434536):5.32201633,((((t162:0.2574765417,t163:0.1569615342):0.3003943786,t164:0.4078489723):4.240584784,((t165:0.8293954607,t166:0.3470351708):3.181822761,t168:3.032312278):0.5282511982):0.436046527,(t169:1.226070098,t170:0.9940844082):2.701165672):0.3967992206):2.520097386):3.847790793):2.079195514):0.4732537344,((t171:6.489514552,((t172:3.614799199,t173:3.569765559):1.985998337,t174:5.462529264):0.8370299252):1.836359781,t175:8.035496751):4.588377952):1.254066143,(t176:13.47882676,((((((((t177:2.339140139,t178:2.328199383):3.395571251,t179:5.689031123):0.1948083627,(t180:0.8070235228,t181:0.5817128009):5.019942881):2.045941368,(t182:1.311374779,t183:1.090277711):6.310823726):2.323012287,((t185:4.62648143,(t186:2.929639623,t187:2.878453539):1.645802362):4.104737671,(t188:1.140892009,t189:0.8270757127):7.477710617):0.7789674968):1.541848824,t190:10.52967225):0.07433690264,(t191:1.380256945,t192:1.373185005):9.22370032):0.7610310787,(t193:6.343798117,((t194:3.476231345,(t195:2.478770893,(t196:1.096104447,t197:1.082831625):1.367093305):0.5443000572):2.596281493,((t198:1.138442868,t199:0.9863327671):2.606199896,(t200:1.158537433,t201:1.111793867):2.302441828):1.7737869):0.2704654079):4.838984365):0.7527931358):0.3236380761):1.199445965):0.6961877081,((t202:8.648270138,((((t203:1.609143111,((t204:1.28725152,(t205:0.5122105046,t206:0.4925318654):0.6989015337):0.2349372277,(t208:0.5776412494,t209:0.4048379275):0.6817556398):0.002177478019):0.7547232347,t210:1.827034937):1.053487323,t211:2.873956995):0.1905752884,(t212:3.030171875,(((t213:0.04352124953,t214:0.008449146389):0.1060571237,t215:0.05725434823):1.710876591,(t216:1.361176344,t217:1.239441073):0.3871465868):1.157398846):0.00412666156):4.805718807):1.887303062,((t218:6.937977858,t219:6.895318138):0.3771129565,(t220:0.06848863402,t221:0.04921813804):6.963817726):2.078599703):2.651199831):4.143247006):1.653291603,((((((t222:4.835385563,(t223:3.753514575,(t224:1.368275292,t225:1.321632483):1.94175019):1.049092785):0.05008120963,t226:4.282097087):1.455726117,(((t227:1.573545619,t228:1.463044262):0.09369914688,(t229:1.266518879,t230:1.08244261):0.2413599993):1.202975901,(t231:2.293602989,t232:2.181261203):0.2321266712):2.846146126):5.78517147,((t233:0.4649127914,t234:0.3205926187):6.997617162,t235:7.16984759):3.572212376):2.496966043,(t236:9.968352978,(t237:6.525209018,(((t238:1.121582671,t239:1.067255298):0.734678864,(t240:1.602839414,((t241:0.6927140007,t242:0.3271135377):0.6233198806,(t243:0.474687466,t244:0.2915095497):0.2939269534):0.2795552886):0.1949709393):2.777293553,(t245:0.2747174017,t246:0.252727476):3.526315131):1.868263618):3.127134651):3.246088755):0.5044907838,(((t247:0.3459657802,t248:0.242585706):5.056986277,t249:5.126878873):6.700266884,(((t250:7.236642033,((t251:3.957810232,t252:3.912769204):1.084068664,(t253:2.362940395,t254:2.317726504):2.461681942):2.14719652):2.091396972,t255:8.960092799):1.641356289,(((t256:2.331483213,(t257:1.196248227,t258:0.985892176):0.8514826651):6.935144119,(t259:2.576522892,(t260:1.516587893,(t261:1.011620798,t262:0.9184269061):0.440636589):0.7908002101):6.167964959):0.5900133529,t263:8.807752066):0.7227633245):0.7748424893):0.4047741706):2.331701102):1.15274817,((t264:3.371227881,(t265:1.530036722,t266:1.42691102):1.828932204):5.145977725,((t267:0.4862997915,t268:0.4636400496):5.554787877,t269:6.007438345):2.267181627):5.651993915):1.498893631):1.018583594,(((((((t270:3.064890952,(((t271:1.692029439,t272:1.681693017):0.08930082636,(t273:0.5588751465,((t274:0.2808429119,t275:0.2446846431):0.1529246258,t276:0.2884300026):0.1029049439):1.057178455):0.2668880205,t277:1.634999991):0.8407412543):1.45503361,t279:3.534044856):1.585468886,(t280:1.441176601,t281:1.391770668):3.444808617):4.558858591,(((((t282:0.6006009097,t283:0.5782137027):4.208524617,t284:4.744482912):0.5514121026,(((t286:0.5556816379,t287:0.3315377137):0.8466529955,t288:1.027067199):2.015975148,(t290:2.673939167,t291:2.434480057):0.1129657809):1.804855814):0.3140063979,t292:4.336199189):2.795569609,(((t293:1.308600377,t294:1.276655946):4.757011074,(t295:2.429539402,t296:2.374273754):3.519763045):0.5402974113,((((t297:0.5977196996,t298:0.5187022924):0.5209405438,t299:1.017039964):0.7475727105,(t300:1.279027317,t301:1.11902016):0.4748108641):0.3848032644,t302:1.977691416):4.179521073):0.484949805):0.8175454355):1.467914208,(((t303:2.848371888,t304:2.839079173):3.715917962,t305:6.419061163):0.5225651691,t306:6.819733681):1.61355518):0.3607897551,((t307:4.403378043,(t308:0.3635872835,t309:0.1896683545):4.004144629):3.877536729,((((t310:0.2697837323,t311:0.2565217463):2.534457136,t312:2.781567333):1.54881953,t313:4.325031519):1.87730751,((t314:2.18124684,(t315:0.7205248615,t316:0.603060483):1.434528933):1.567406913,t317:3.469697462):2.439269311):1.457913984):0.474270552):0.4249487993,t318:8.186585372):3.452220874):0.5006792466,((t319:0.6032106986,t320:0.5177042449):9.883673429,((((t321:1.155145397,t322:0.9862226702):0.005999000873,t323:0.8662804463):3.173041715,(t324:1.455177284,t325:1.304856351):2.557729815):0.2315242421,(t326:1.35458597,t327:1.337493096):2.733203221):5.759463806):1.513546835):1.597820849):4.013192645):5.555909969):7.406380948,((t328:4.559409853,t329:4.530031823):3.669422247,((((t330:2.425284471,(t331:2.277687451,t332:2.207937281):0.1031488266):0.7814405089,(t334:2.840226229,t335:2.736202029):0.1608012097):1.737903816,(t336:0.3212120551,t337:0.08707308947):4.22761624):0.8478197421,((((t338:0.06085623461,t339:0.01447855714):0.8516454367,t340:0.8238748158):0.4148456903,t341:1.162070402):1.581758537,((t342:0.4264427266,t343:0.2715471863):1.398202274,t344:1.55544549):0.6208916565):2.218295349):2.305153099):21.56214652):1.356926226,((((t345:4.798803931,(t346:3.567322531,t347:3.558645549):1.216344812):5.307794695,t348:9.943462965):1.359651994,t349:11.28660108):7.785891169,(((t350:8.606578251,((((t351:0.6504691505,t352:0.2951226753):0.8808788301,(t353:0.8408031627,(t354:0.381630533,t355:0.3210611605):0.454235488):0.2853018729):0.1975287344,t356:1.229705722):1.907398377,(t357:1.300391655,t358:1.228129299):1.743849251):4.903804787):0.5375627983,((t359:2.454842699,t360:2.140641595):0.7690963408,((t361:0.6987385496,t362:0.627467659):1.579181101,t363:2.160637744):0.6023901173):5.172112965):1.021489706,(t364:2.341384378,t365:2.234705537):6.608713726):8.889125273):10.33653835):1.340098927):9.405025846):36.94569643,(((((t366:2.403614709,t367:2.121010053):1.08596433,t368:3.150257868):0.5050649394,((t369:0.2781902327,t370:0.2666753097):2.257962876,(t371:0.44731859,t372:0.4085577328):2.016879981):0.7297696989):0.7791519527,(t373:1.084452921,(t374:0.5851599479,t375:0.5318665237):0.4327485721):2.793956782):32.94048984,((((t376:1.090502041,(t377:0.6454838849,(t378:0.2244696979,t379:0.07606421163):0.4085957544):0.3556618008):2.84407034,t380:3.619026826):11.04365032,t381:14.6077306):1.249817106,((t382:0.613904399,(t383:0.444709963,t384:0.2783876684):0.1677386363):4.187114312,t385:4.612082631):11.01696124):20.35162305):38.00407429):123.8902648);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T42.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
