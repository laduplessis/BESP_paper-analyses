<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((t356:0.02424132915,((t290:0.191845706,t291:0.11745864):0.0341832317,(t280:0.01390636969,(t208:0.01558906735,((((t171:0.08882222577,((t149:0.02683540561,(t143:0.07163003418,(t144:0.02602794145,(t126:0.07295188516,((t115:0.06964378037,(t109:0.2324105354,(t77:0.07036514633,(t67:0.04926456609,t1:6.343622763):0.6573318485):2.452538838):0.5208725436):1.493647959,(((t2:6.779114434,(t3:6.171191682,(t4:2.464047179,t5:2.420718838):3.618083384):0.4046080081):3.184357192,(t6:1.661201251,t7:1.651408096):7.821114202):0.9905716193,(t8:9.423935449,t9:9.225133211):1.029362106):0.392608974):0.02007244766):1.774692881):0.03906202338):0.4861218774):0.2405388625,((((((t10:2.218340799,t11:2.159383793):5.005783781,((t12:2.34469509,t13:2.282876561):1.976844532,((t14:0.884493472,t15:0.8134101396):3.125807633,t16:3.934459346):0.20291752):2.745354245):0.8484428659,t17:7.647071692):1.889339219,((((t18:0.8697640492,t19:0.8404366482):2.645812075,t20:3.428974782):0.45535712,(t21:2.552877785,(t22:2.057277007,t23:2.051714001):0.4384852214):1.304249145):2.986650731,(t24:5.011835309,(t25:2.620651874,(t26:0.1081194745,t27:0.0008340755508):2.494756668):2.324105378):1.676536587):2.190463121):0.2691815723,(((t28:1.237940014,t29:1.227941297):3.580745492,(t30:2.884980303,t31:2.850886075):1.830699502):2.036901444,((t32:1.740239979,(t33:0.6090858771,t34:0.5915131957):0.9597652964):4.900814154,(t35:2.425202415,t36:2.286443148):3.575922528):0.04378992703):2.023326514):1.424745844,(((t37:6.632728888,((t38:2.607384695,t39:2.578691593):3.758773403,t40:6.255035364):0.04454447058):0.6894430095,((((t41:3.187012729,t42:3.182229156):3.086231757,((t43:3.680845003,(t44:3.168989502,t45:3.052167324):0.3721270373):2.349463739,((t46:0.2464391268,t47:0.2381585058):4.058957064,((t48:0.9766437456,t49:0.8761381081):2.804802387,(t50:2.517978056,(t51:1.918054648,t52:1.880609541):0.2925575902):1.142774229):0.2931396542):1.432255619):0.1181893419):0.441801325,((((t53:0.06147942458,t54:0.04631384601):2.850363778,(t55:2.005478526,t56:1.951248344):0.7880744051):2.403368127,t57:5.120675833):0.1307467527,((t58:3.150566029,(t59:0.6347032074,t60:0.6268397096):2.474516414):1.797917462,((t61:0.3986798184,t62:0.1975129204):1.182790425,t63:1.301999585):3.290675698):0.008788301939):0.1284725756):0.01769960217,((((t64:4.108618224,(t65:2.20161215,t66:2.138286137):1.758184413):0.07224698085,((t68:1.08220116,t69:1.067797228):0.2328366601,t70:1.278021862):2.297579317):0.00157850612,(t71:2.459572475,t72:2.328727698):0.9420795167):0.009408581751,t73:3.279400628):0.5495154877):0.2388485133):0.9946092441,((t74:3.747543576,(((t75:1.925188496,t76:1.890728883):1.161097754,t78:2.939179227):0.2593569231,t79:3.179224108):0.2299436119):0.1569914479,t80:3.437833079):1.151387034):0.8949904451):1.36979322):2.098686769):0.9410648078,(((t81:2.739051443,(t82:2.60527616,t83:2.567391659):0.05611055306):3.754171597,((t84:3.3620516,((((t85:0.8166108082,t86:0.7969698447):1.607520811,t87:2.314661142):0.11173032,(t88:1.522194215,t89:1.40396522):0.8388315478):0.373311397,(t90:2.491768992,(t91:2.153137659,(t92:0.3394821625,t93:0.1574314659):1.690486559):0.2786896191):0.07101988418):0.3355524994):2.049591481,((((t94:2.631508902,(t95:1.855599574,(t96:1.637447018,t97:1.588331075):0.2029445266):0.7506887316):0.9673639147,((t98:0.1636098843,t99:0.1244549133):3.098287512,((t100:1.041038948,t101:1.014923248):1.098529415,(((t102:1.381214088,t103:1.359559058):0.03866349471,t104:1.29634724):0.538328642,(t105:0.9729721222,t106:0.8007416071):0.7669935705):0.0477500993):1.010886749):0.1481358047):0.5714359766,((((t107:1.388509946,(t108:1.025544978,(t110:0.4898509265,t111:0.4184700407):0.2851901909):0.2617707423):0.0370099342,t112:0.8611609736):0.3040667809,((t113:0.3061561753,t114:0.2568708901):0.2108189652,t116:0.04948497636):0.5999990858):1.484045744,(t117:1.042812609,t118:0.9296808007):0.8130900837):0.0519479264):0.01509117657,(((t119:0.6741184561,t120:0.5029646029):0.7304805401,t121:0.8870188963):0.06297116762,(t122:0.5776163258,(t123:0.505978675,t124:0.3226553839):0.008975798092):0.3434327122):0.324413034):0.3666842813):0.9544984325):0.4755578131,t125:2.785866137):2.873951143):0.9976403976,(((((t127:0.8237611948,t128:0.66362333):3.533405816,(t129:1.738004446,(t130:0.2401226539,t131:0.1932103708):1.180992793):2.412563335):0.6755713129,(((((((t132:0.9824560662,t133:0.9271052005):1.092235234,(((t134:0.5713901477,t135:0.3805982409):0.3188672025,t136:0.6842692099):0.8169981488,(t137:0.3231375226,t138:0.1970775732):0.9423803883):0.2894276664):0.7722079353,(t139:1.176824591,(t140:0.666081807,(t141:0.1411610515,t142:0.06626496127):0.292240119):0.4999776935):0.9404800688):0.1362519683,t145:1.810613528):0.09727832933,(t146:1.042718274,(t147:0.8603335709,t148:0.8238789921):0.1704932721):0.6020804025):0.1741587615,(t150:0.692037964,t151:0.6902399876):0.8300974073):0.6163847631,t152:2.003373192):0.5311085137):0.4113324777,(((t153:1.361238207,((t154:0.8905703334,t155:0.8776738878):0.07201729364,t156:0.8182460991):0.3703240344):0.2905313369,t157:1.117683939):0.1853127438,(t158:0.3659936061,t159:0.3226953565):0.8463787218):0.9920569273):0.2000526315,t160:2.263814953):0.8953049274):0.3351454929,(t161:2.350787135,(t162:1.671564877,t163:1.487999055):0.6650837977):1.063243407):1.130973897):6.092285116):0.9333187422):6.891482027):0.2961411485,((((t164:7.907102019,((t165:0.2470883002,t166:0.1721638768):0.9278948573,t167:1.026856265):6.711550514):1.76571043,(((t168:0.3167511612,t169:0.2835270139):3.174032332,(((((t170:0.6325184227,t172:0.3998901154):0.6015457942,t173:0.9776886382):0.221250251,(t174:0.7512018031,((t175:0.1412960545,t176:0.08479554935):0.2397137225,(t177:0.3105560834,t178:0.01357307512):0.006839430947):0.3104144886):0.3697476154):0.4605775311,t179:1.151510136):0.8142412335,(t180:1.208349814,((t181:0.4345296364,t182:0.3816766421):0.1120239835,t183:0.4930322521):0.581532171):0.7231075714):0.5221268552):0.6355591019,(((t184:0.6633334803,(t185:0.3809631225,t186:0.3246659357):0.1219036147):0.07324555788,(t187:0.1151483366,t188:0.0567089203):0.3758081654):0.6844808292,((t189:0.08202481925,t190:0.02823867839):0.2784729103,t191:0.294252299):0.7369651928):1.478391268):5.221575589):1.744348673,(((t192:0.9978061091,(t193:0.5462802808,t194:0.0655167174):0.2500878004):0.6590977524,(t195:0.04455586502,t196:0.005209321883):0.9105168266):6.076802494,(t197:1.070117766,t198:0.9418017545):5.813335378):1.599308685):1.023669246,(((t199:4.186978367,(t200:1.195921668,(t201:0.7463737385,t202:0.5475430651):0.3819364887):2.932275679):2.150401786,(t203:5.87246998,(t204:0.7558646325,t205:0.6587515038):5.046306053):0.06582812326):0.901153674,(((t206:0.9643451209,(t207:0.356707577,t209:0.2211879569):0.5395554544):0.8232625469,t210:1.551912418):0.19386945,t211:1.692402214):4.362216192):2.073994977):5.930505299):3.124826069,(t212:9.700017224,(t213:5.158053627,(t214:4.506506529,t215:4.44518069):0.536989437):4.282139369):7.466329924):3.204457944,(((((t216:0.1831330047,t217:0.1540944087):7.877726911,(t218:6.217753122,(t219:5.115124061,t220:5.028562285):1.097099117):1.720983052):3.163867153,((t221:4.864999864,(t222:3.493863944,t223:3.471808047):1.206345695):5.201605272,(((t224:2.159316214,(t225:0.6137929638,t226:0.5719268192):1.400870854):4.203131315,t227:6.131251049):1.148814427,(t228:5.003140989,(t229:2.043865333,(t230:1.578356818,t231:1.511892878):0.446117362):2.878904826):2.238307566):2.215009969):0.877313619):1.613798385,((((t232:0.6434278797,t233:0.4712115174):3.754953313,t234:3.91480844):1.6632461,((t235:2.692649345,((t236:0.6221781869,t237:0.3958981235):0.4112833073,t238:0.7615266901):1.314993658):1.15138802,(t239:0.5687934184,(t240:0.4472090734,t241:0.3992380115):0.03060408343):2.640607781):1.731470572):0.9621904064,((t242:1.067000839,(t243:0.7698386585,t244:0.7466122777):0.2826164585):2.517127156,(t245:3.363664369,(t246:1.549679555,t247:1.544172866):1.765777676):0.1826196678):2.127692213):4.699859992):2.443728115,(((t248:7.00406264,((t249:2.248434296,(t250:0.4637254959,t251:0.4508643297):1.566785647):0.1053368868,t252:2.093929733):4.631442968):0.2810628557,((t253:1.834056568,(t254:1.191870351,t255:1.171731788):0.6301700614):0.1347267786,t256:1.920630893):4.993016393):2.726901691,(t257:8.840596535,((((((t258:0.3356035902,t259:0.2474131534):0.391473835,t260:0.5590719853):5.01511189,(t261:1.269578179,(t262:1.168568203,t263:1.129895361):0.01073067795):4.228909688):1.233984238,t264:6.519024118):0.2784378904,((t265:0.2111431741,t266:0.155180822):0.8113882772,t267:0.9043755901):5.690008548):0.5882422914,((((t268:1.810619436,t269:1.790032022):0.2881496235,(t270:1.426872798,t271:1.417597727):0.6455833471):2.932365527,((t272:1.160917147,(t273:0.4974725182,t274:0.4621505766):0.4933985139):1.337159311,t275:2.225079061):2.423666182):1.38888935,(((t276:0.5555247383,t277:0.3937958612):2.57322296,t278:2.919377922):0.558729327,(t279:1.325234492,t281:1.035220648):2.148649169):2.116789223):0.6534650924):0.711573768):0.6392389819):2.682614517):4.430526472):17.09139018,(((((((t282:1.420470896,(t283:0.7692340477,t284:0.724258136):0.6132452239):9.361805084,(((t285:2.144647916,((t286:0.2038597277,t287:0.1685559716):0.3227984042,t288:0.4836708733):1.52834637):0.8214322508,(t289:0.9850920146,t292:0.5840255679):1.652675047):2.815480934,t293:4.875804185):4.908517344):1.676390168,((t294:4.535166709,(t295:2.355069965,(t296:0.5682821049,t297:0.4958651879):1.756538176):2.15798251):0.5290660619,t298:4.891685179):6.350699973):6.984282414,((((t299:0.9938661458,t300:0.8631952109):5.441471812,(((t301:0.7372929775,t302:0.7274875022):0.04365688961,t303:0.5314177482):4.742774541,(t304:0.6274130437,t305:0.5627419436):4.46149116):0.5711427923):0.8777773901,t306:6.286924938):7.005787446,(((t307:3.375354414,((t308:2.612045259,t309:2.483440465):0.324072309,t310:2.770982863):0.4186237216):3.850579124,((t311:1.980846888,t312:1.816856503):4.869676042,(t313:0.8206047335,t314:0.8181690679):5.701515395):0.110356461):1.018474697,(t315:3.67285456,(t316:0.5361047718,t317:0.1010970967):3.039236983):3.707926145):4.972289988):3.891197835):4.61024752,(((t318:7.538801615,(t319:0.5101026782,t320:0.452609047):6.993406174):6.624190868,(((((t321:0.08903017723,t322:0.002673046094):8.837517637,(t323:6.457793347,((t324:4.033571514,t325:3.970528326):0.9356022335,((t326:1.796189221,t327:1.621895394):0.8493806879,t328:2.277857001):2.206601303):1.249152518):2.310247761):0.3258171235,t329:8.236668408):0.1764542403,(((t330:3.227123329,((t331:0.3984648202,t332:0.2598718874):2.073517505,t333:2.114137525):0.7476210493):0.4563109898,(t334:1.432460687,t335:1.33550171):1.865059734):2.366037923,(((t336:0.7533668818,t337:0.6098918396):0.9916310171,t338:1.595095875):3.280260393,((t339:1.559860529,t340:1.51295787):1.229483394,t341:2.414518881):2.081274892):0.4252699276):2.27060624):2.546088007,((((((t342:0.8619687387,t343:0.8437154784):1.206243764,t344:1.810801008):0.1400958676,(t345:0.7793873952,t346:0.5709073067):1.14623854):0.1650339496,t347:1.78731537):1.877361187,t348:3.650997128):0.2198446311,((t349:2.281978137,(t350:2.020337685,(t351:0.6759732641,t352:0.5646836125):1.330071196):0.1956499592):0.316537029,(t353:0.513274175,t354:0.4877366949):1.85794869):1.074102366):5.247938929):2.05392808):3.905496975,((((t355:3.649614738,t357:3.136852902):6.427018282,((t358:1.195107509,t359:1.121599521):6.014848587,((((t360:1.02751947,t361:0.9567697025):3.07186932,(t362:2.269540067,t363:2.245809231):1.690114834):0.7274464205,t364:4.612033352):2.255919718,(t365:6.484995308,t366:6.400153235):0.3371827453):0.02992962862):2.251989104):0.02590227502,((((t367:1.983802123,t368:1.959137515):3.164759763,((t369:1.11617693,t370:0.9969317086):1.546248858,t371:2.515558264):2.276400092):1.119649295,(t372:2.327970127,t373:2.246094559):3.462705286):1.100772806,(t374:1.247454253,t375:1.139575073):5.315314749):1.652598954):1.419671371,(t376:7.683182138,(t377:5.211755353,t378:5.109259577):2.38860757):1.689080021):2.98018876):2.15121798):0.145632734,(t379:2.547265904,((t380:0.1444195225,t381:0.05287167383):1.383894496,t382:1.405432652):0.9511568011):11.72807313):0.345822769,((((t383:2.610431047,(t384:0.8757723688,t385:0.7704826046):1.551498042):0.0112781604,t386:2.10316523):4.306358359,(t387:1.428996602,t388:1.251953931):4.9789783):6.9410384,(((t389:0.6112105767,(t390:0.5009788869,t391:0.3101311277):0.03490563364):4.289528028,t392:4.619269564):5.007524745,(t393:3.865796409,((t394:0.0444814078,t395:0.04328808323):2.90554977,t396:2.944501811):0.8294414879):5.576020711):3.159832024):0.5507474439):6.860260975):15.42233193,((((((t397:1.068573501,t398:1.066822079):1.979407811,t399:2.957844859):0.7529962183,(t400:2.940639565,(t401:2.053848611,(t402:1.596314172,t403:1.534124192):0.2968742802):0.7908245274):0.6321750616):7.187447945,t404:10.36680022):2.896395176,((t405:8.855544791,t406:8.698713933):2.952951172,(((((((((t407:0.5360809541,t408:0.5285280565):1.081955488,t409:1.528561862):0.1929893872,(t410:1.194848848,(t411:0.2733451484,t412:0.1324673675):0.7865674367):0.5152574335):0.7401522515,(t413:1.113004787,t414:0.8110304041):0.8388137655):0.6973950714,t415:2.279355063):0.9472540044,t416:3.076232327):0.3420602049,(t417:1.903238363,t418:1.830923736):1.491149814):0.2723661016,t419:3.580849965):5.199771393,t420:8.644124743):1.583672142):1.438015336):7.819227125,(((t421:6.622727281,((t422:5.563608642,(t423:4.200556403,(((t424:2.276243164,t425:2.229862721):1.158419077,(t426:0.09024700144,t427:0.03357025463):3.247671067):0.3363123394,t428:3.524799684):0.3562369003):1.256659454):0.7967855418,(((t429:2.427161412,(t430:1.021383117,(t431:0.4189219959,t432:0.4044376793):0.4651154809):1.303781255):0.9406371902,(t433:1.91086104,(t434:0.8942303887,(t435:0.4941049311,t436:0.4736261679):0.2853847217):0.6700736852):1.107374565):1.059307656,(t437:1.110277911,t438:1.064726763):2.280494861):1.50641312):0.2594977698):1.334681415,((t439:1.801638194,t440:1.629890474):3.085379644,t441:4.714675474):1.193725179):8.223286743,(t442:12.13209558,t443:12.05446052):1.910099311):3.20051005):13.63518067):14.06188304,(t444:2.18590861,t445:2.021607492):42.62922005):61.38049929,(((((t446:4.221722885,((t447:2.33588401,(t448:0.8765358577,t449:0.6271903362):1.39734979):1.529212125,(t450:2.266730534,t451:2.228932733):1.123629734):0.06374185784):8.473663718,(t452:2.622765044,t453:2.616159972):9.201229135):0.1333852887,(t454:4.219307638,t455:4.103257467):6.979137305):30.71177736,((t456:4.385331966,(((t457:0.3903673567,t458:0.3221298392):1.940295462,(t459:1.658266637,t460:1.358962918):0.4654331033):1.758474625,t461:3.534607398):0.2842744692):11.26582617,t462:15.06088096):25.99309164):13.09515957,(((t463:0.9501837647,t464:0.7943722556):9.882380979,(t465:2.99859874,(t466:0.1369166615,t467:0.06826338205):2.84266226):7.666682513):30.198201,((t468:8.302470702,((t469:3.265975151,(t470:1.272734271,t471:0.917627258):1.948116565):0.6276884512,(((t472:0.03322416353,t473:0.002388192757):0.3715227794,t474:0.2948756053):2.24186447,((t475:0.07377007283,t476:0.03431441966):1.378278009,(t477:0.6888969336,t478:0.4912208705):0.6493927639):0.9970182108):0.6319063932):4.327237661):17.61501898,((((t479:0.5758536114,t480:0.4696495781):7.671610812,((t481:0.3125839439,t482:0.2489510002):1.394334009,t483:1.479493136):6.412785743):7.690017126,t484:15.42058802):1.134912503,(t485:0.7754396663,t486:0.6889941759):15.70770497):7.459187974):14.76671489):13.08516605):49.03808328):20.33596185,((t487:1.331859889,t488:1.285622167):2.648146955,(((t489:0.1483109883,t490:0.002051602178):2.347005259,t491:2.259714861):0.9628234986,t492:3.137503008):0.4398363045):116.9197043);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T27.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
