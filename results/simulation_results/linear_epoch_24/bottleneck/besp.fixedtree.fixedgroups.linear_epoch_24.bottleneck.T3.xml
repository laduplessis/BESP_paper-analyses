<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t475:0.6650318183,(t476:0.1428193881,t477:0.1218448294):0.3387079829):4.504372858,(t478:1.436742558,(t479:0.08513950974,t480:0.05524230095):1.187402098):3.501902376):11.06482554,((t481:5.068441854,(t482:1.605291542,(t483:0.3156446754,t484:0.3116130131):1.230289566):3.432764119):8.306356763,(t485:6.151365686,((t486:0.8573459027,t487:0.8254014741):2.806944386,t488:3.568094247):2.234520907):7.06892311):2.391181543):7.941845618,((t489:3.233123381,t490:3.228088367):0.9077905027,((((t491:1.156529496,t492:1.144328493):0.7768826915,t493:1.746106083):0.5433681549,(t494:1.367409859,(t495:0.4674014045,t496:0.2983696294):0.8136296255):0.9163604627):0.2450044855,((t497:0.3494831695,t498:0.3235928327):1.234540145,t500:1.098030704):0.4406248493):1.105399287):19.03795155):12.9090088,(((t501:3.731793538,(t502:0.1824098388,t503:0.1323084054):3.535691212):9.100762281,t504:12.66913614):12.17843515,(((((t499:0.003238295116,(((((t369:0.03799841749,((t307:0.000622426832,((t223:0.2735496281,(t191:0.001084307331,((t163:0.09614468946,(((t150:0.01654430104,((t142:0.03511933732,(t125:0.1039910359,(t111:0.1962694092,(t109:0.02364781165,((t99:0.01643631185,(((t91:0.3749062188,t92:0.2614389013):0.03749126438,(t35:0.1595574608,(t1:2.604455156,t2:2.558143343):0.891195492):6.083289832):0.3074514542,(((t3:5.089958633,t4:4.777373287):0.5884085733,t5:5.317083943):3.058370108,(t6:3.050094749,t7:2.889243862):5.301119013):0.9978226944):0.1292731436):0.5463425158,((((t8:3.686632838,(((t9:0.4636606705,t10:0.4004762038):1.332616525,t11:1.543936238):0.2927009346,t12:1.836451645):1.530859127):3.604362252,t13:6.953488657):2.110852588,(t14:8.428447483,((t15:4.134445499,(t16:2.102806175,t17:2.076677392):1.897355299):4.2459289,(t18:7.72711151,((t19:0.7555744928,t20:0.7548231237):0.2884791934,t21:1.009917033):6.563698609):0.2923878647):0.001287789599):0.3714432968):0.007747265043,(t22:7.461919209,(t23:2.485294257,t24:2.392094311):4.839664522):0.723748422):0.1706331364):0.7588729667):0.2604154409):1.188333826):1.463525693):0.3348266322,(((((((t25:2.386453375,t26:2.366940294):4.661360763,((t27:1.037179313,t28:1.023678806):3.167733922,(t29:2.274149242,t30:2.196174235):1.903808014):2.720322479):0.6122385192,t31:7.379338638):0.6690491374,((((t32:6.50817339,((t33:1.713566054,t34:1.596415387):0.2173461187,t36:1.122778441):4.258923657):0.4595218143,t37:5.41502235):0.04627995883,(t38:4.731748904,t39:4.331632036):0.592255313):1.00530818,((((((t40:1.926242441,(t41:0.7191651019,t42:0.609825617):1.197459545):0.2483872517,t43:1.811667092):2.07433571,t44:3.872982847):0.3631573454,t45:4.132233189):0.4839512732,(t46:2.803173256,(t47:2.185989105,t48:2.125280755):0.3547003383):1.544222245):0.6335538356,((t49:3.750086565,(((((t50:2.765025197,(t51:0.3175408679,t52:0.2523418765):2.441088893):0.6158987687,t53:3.058587969):0.1345230022,t54:3.183287293):0.06673502083,t55:3.220498363):0.001003182631,(t56:2.721048662,t57:2.713532692):0.1020768151):0.1057683128):0.2846249533,(t58:2.731540055,t59:2.553730318):0.4063815883):0.6044349051):0.1052312019):0.01986772728):0.2617616546,(((t60:2.655737381,t61:2.588100782):0.1849085859,((t62:0.7432336792,t63:0.7054645115):1.037816636,t64:1.712246598):0.9533578162):0.5731195032,(((t65:2.218075332,(t66:1.621354914,(t67:0.2788844271,t68:0.1589438696):1.218160417):0.5010197723):0.2545913149,(t69:2.06370949,(t70:1.165600602,t71:1.155773342):0.8123050336):0.0555761511):0.03971625609,t72:2.056203684):0.5863673481):0.4754398492):2.917786596,(t73:0.7389927865,t74:0.7013819004):5.221824382):0.2889597096,(t75:6.129011568,((((t76:1.513967202,(t77:1.281868834,t78:1.264925186):0.1472306614):0.4375711543,t79:1.743690433):0.4954235378,(((t80:1.153013092,t81:0.7326139769):0.5122070996,(t82:0.763663284,(t83:0.7406173014,t84:0.6333966019):0.02111606011):0.4521777464):0.3971071936,t85:1.489794795):0.1626970738):1.1967163,(((t86:0.3257298276,t87:0.300025448):1.147415659,((t88:0.5151876074,t89:0.4433345527):0.7735120589,(t90:0.7224487627,t93:0.0636789181):0.4911949407):0.1435339051):0.7142138413,(t94:0.01869580248,t95:0.01804791396):1.372283856):0.6543348879):2.476863438):0.00625227517):0.2080125012):0.4690348403):0.1160132906,((((t96:2.180450606,(((t97:0.2589690507,t98:0.2490334193):0.1712216284,t100:0.3195130378):1.383602159,((((t101:0.03328988476,t102:0.002121886317):0.5385966742,t103:0.2217928627):0.1861723569,t104:0.4051615163):0.6876483788,t105:0.7218349143):0.2105772216):0.2921601112):1.447335224,((((t106:0.3296147292,t107:0.1826440543):1.098614289,t108:1.194796759):0.5870665805,t110:1.722418603):0.1481376761,t112:1.561563931):0.2958196722):0.3244873192,((t113:0.3972807611,t114:0.3523043362):1.216416563,t115:1.451173508):0.2681892018):0.7657965427,(t116:2.291630706,((((t117:0.3078691025,t118:0.3007930402):0.4431978363,(t119:0.3303985723,t120:0.2868279779):0.4035852445):0.7127590989,(t121:0.1142346831,t122:0.0605019182):1.176470313):0.2037837183,(t123:0.9849487868,t124:0.8617840539):0.4529841069):0.6204804446):0.07956536612):0.5546175479):0.1630163055,((t126:0.314405906,t127:0.3099791403):0.6126484068,(t128:0.3710477272,t129:0.2933061593):0.3469876776):1.60045176):0.8951503948):1.857320583,((((t130:2.328678129,t131:2.121014654):0.4547512343,((((t132:0.1641270652,t133:0.11823516):0.1549248985,t134:0.2694058809):0.179571766,t135:0.4013460414):1.454485947,t136:1.82561473):0.6044404977):0.7307384523,t137:3.063764206):0.5443421568,t138:3.564758993):0.892410652):1.528687259):3.121777594):1.560093723,((((((t139:0.3719431981,t140:0.3561506532):0.11509597,t141:0.3052780808):1.311421,(t143:0.1304005557,t144:0.07236441511):1.205205438):0.4771276722,(t145:1.014839781,(t146:0.4670361197,t147:0.1704399833):0.5280094778):0.7364536562):1.852189401,(t148:0.5135117236,t149:0.460373074):2.536027404):4.75503365,(((t151:2.234777126,((t152:0.6519001348,t153:0.5861029721):1.216909237,((t154:0.06612544686,t155:0.03114117489):0.7224700335,(t156:0.3080302031,t157:0.2376574848):0.4067427743):1.011396777):0.3053464951):0.7944068282,(((t158:0.2124094646,t159:0.0307911574):2.069118509,((t160:0.771502937,t161:0.4703854823):1.005458238,t162:1.465752074):0.08057909994):0.4008186614,((t164:0.4825517277,t165:0.4058087252):0.7058347088,t166:0.9396292902):0.4592515455):0.05230101884):0.1863318281,((t167:0.9062450057,(t168:0.8375642814,t169:0.7401083952):0.06367524083):0.04782622826,(t170:0.6104040821,(t171:0.368301337,t172:0.2265154514):0.223466314):0.08827051752):0.6505885673):4.378315557):1.615552843):6.774090668):4.826625585,((t173:1.607032401,(t174:1.476263299,((t175:0.03875824032,t176:0.03092721352):0.09487201128,t177:0.002176662536):1.331230421):0.083944562):8.74546893,((((t178:0.2804492553,t179:0.2278605545):0.2643567357,t180:0.4516601181):0.1540864204,t181:0.5786351283):4.38799603,t182:4.919746132):5.006324415):8.062415805):0.1564732695):0.2368278449,(((t183:1.113902055,(t184:0.5247903814,t185:0.4810295872):0.4117437451):12.97350579,((t186:1.400191092,t187:1.206906667):0.7673224986,t188:1.829114118):10.86585643):0.4892653056,((t189:7.925761076,t190:7.871340236):0.3653873859,((t192:5.421842021,(t193:1.487417866,t194:1.453840444):3.91432425):0.03850173869,t195:5.069609664):2.605728191):4.842767999):3.719468743):3.145382268,(((((((((t196:1.540568873,t197:1.493103542):1.492772509,t198:2.95009629):8.476324983,((t199:4.788000667,(((t200:1.090765627,t201:0.9678184414):1.817630929,t202:2.697275126):0.8512079412,((t203:2.438613754,t204:2.327091203):0.7049757862,t205:3.020406622):0.3309805654):0.8759819295):4.519933645,(((t206:4.162813103,(t207:3.060903277,t208:3.004554475):1.034406655):0.8245046638,(t209:3.618250917,t210:3.580577518):1.211032656):0.02812997303,t211:4.765274652):3.693464972):1.86934474):1.841611887,(t212:9.63477216,(t213:4.013794822,(t214:1.366119861,t215:1.245711689):2.622291601):5.598208552):2.448640355):1.626854397,(t216:8.33145767,(t217:4.483462075,(t218:2.330489925,((t219:0.8077467111,t220:0.7110580722):0.1182278435,t221:0.6132481995):1.401288718):1.694990556):3.803258365):5.160904583):1.23729576,((((((t222:1.054605385,t224:0.6432514223):1.522918138,t225:2.152888018):4.558953733,(t226:6.149540488,(t227:4.78826571,(t228:3.758259448,t229:3.682972504):0.8187763891):1.352261006):0.4326356473):3.941044786,((t230:1.48866985,(t231:0.4894009322,t232:0.3213890229):0.8830547298):1.093102824,t233:2.260284354):7.605622076):1.728107554,(t234:3.692823409,(t235:1.350933466,t236:1.229178662):2.239162676):7.486418711):0.1189011966,((t237:3.853605842,t238:3.766880839):2.740354026,t239:6.418952013):4.436012985):0.9546480671):0.061882897,(((((t240:1.263646968,t241:1.243464452):0.7303321892,(t242:1.550488999,(t243:1.225928266,t244:1.063248228):0.1988210456):0.4102620363):2.35098051,t245:3.79364152):2.224350165,(t246:4.970267751,t247:4.902671201):1.005934635):2.177739444,((t248:0.1638580177,t249:0.1081379492):1.190310208,t250:0.9923866503):6.580831489):2.915220361):2.123959092,(((t251:5.74565512,t252:5.441843399):4.328140028,(((t253:0.6997149232,t254:0.687056668):7.505739191,t255:8.181456206):0.66021666,((t256:2.383650355,t257:2.356215643):5.056139037,t258:7.152590728):1.390206463):0.8604304079):0.6747844196,((t259:8.017652023,t260:7.486925423):1.568507952,(t261:4.981670167,(t262:3.427646453,t263:3.359905305):1.523648484):4.040739571):0.4729388051):1.689940282):0.465080274,(((t264:3.171247656,(t265:2.040095109,t266:1.979218787):1.097968521):0.4488702403,((t267:0.7001717863,t268:0.6234119874):0.602847177,t269:1.160435496):2.162959392):3.132572279,(((t270:0.828670508,t271:0.7627894475):0.3508381455,t272:1.087842959):1.259181784,t273:2.263042106):3.973219302):4.789380343):0.5064389511):1.447991596,((((t274:3.004593047,(t275:0.3919638331,t276:0.3633133174):2.302396711):4.109357145,(((((t277:0.688069582,t278:0.6489767545):1.868219548,t279:2.220862258):2.55072725,((t280:0.3978314511,t281:0.3942890246):2.644073447,(t282:2.313668094,(t283:0.961830523,t284:0.9322466423):1.316251763):0.6139329876):1.444789068):0.373191866,t285:4.60069553):0.8437468739,t286:5.412107337):0.4423500289):3.475658274,((((t287:2.454978028,(t288:0.4665754022,t289:0.4665702864):1.917364531):0.3925151163,t290:2.723416092):2.254236021,((t291:0.9582028213,t292:0.8699984463):3.627284262,((t293:0.3990353558,t294:0.3295752725):0.8753095965,t295:1.178738193):3.013427317):0.3916109744):0.8532804369,t296:5.427317749):3.187068967):2.214946161,((t297:0.8562746212,t298:0.7940342689):2.179864268,t299:2.668837856):7.659339112):0.00702271733):0.5480098433,((((t300:2.85993316,(t301:0.1345362137,t302:0.09573045746):2.691906919):2.984484851,(t303:0.9552592979,t304:0.8616751748):4.751246879):1.361890025,(t305:2.066845326,(t306:0.6111634501,t308:0.5457520155):1.417847923):4.832431436):3.501984169,(((((t309:3.477933842,(t310:2.175437452,t311:2.112029354):1.119463866):2.8782001,t312:6.089280697):0.7858963644,((t313:4.400245656,((t314:1.058335311,t315:1.053668811):1.867819249,t316:2.876954643):1.236768368):1.22091536,(t317:4.827122221,(t318:1.000547711,t319:0.874715122):3.787689718):0.440583015):1.175810748):0.03636330554,(((t320:1.265962223,t321:1.206422704):0.4397291301,(t322:0.7451666761,t323:0.5356505364):0.8756812971):3.332420485,t324:4.642119504):1.133816055):0.151428537,(t325:4.515982476,(t326:0.4346574231,(t327:0.104879773,t328:0.003403365841):0.1602000921):4.074241513):1.338653519):2.748986622):0.04850388383):5.529310768):1.738201633,(((t329:0.5897651474,t330:0.5335662999):0.6121887257,t331:1.085996558):3.086446995,(t332:2.673907834,t333:2.625925958):1.473089127):11.33676088):1.013685876,(t334:0.05637700109,t335:0.02646202453):16.31945477):1.307941673,(((t336:1.768569152,(t337:1.173579203,t338:1.047139009):0.4062312336):1.495086523,(t339:0.07886787283,t340:0.06569323002):2.847133267):11.18657921,(((t341:1.929150133,t342:1.781367673):0.3243588842,(t343:1.181697422,t344:0.9729023563):0.7923452893):4.122417612,(t345:4.187968961,((t346:0.04673462503,t347:0.04077513751):2.507954341,((t348:0.5965124899,t349:0.4473114712):0.7860255203,t350:1.221350899):1.031350396):1.558047056):1.659147701):7.695449899):3.157367375):0.01089762639,(t351:1.270273014,(t352:0.5018592753,t353:0.4861319681):0.7242307516):14.96809746):21.38948898):9.545580106):6.66322026,((((t354:2.757338793,(t355:1.312843156,((t356:0.71256631,t357:0.5714152612):0.05145003307,t358:0.615261575):0.269293569):1.417095251):8.78900591,(((t359:3.217223401,t360:3.096492355):7.196273859,(t361:3.211300993,(t362:2.6800628,t363:2.526941841):0.4942262166):7.073569169):0.6038338084,(t364:6.683124321,(((t365:3.133656363,t366:3.132160995):0.648609645,(t367:0.2133358464,t368:0.176171176):3.521665229):0.03759323916,((t370:0.9656645472,t371:0.9124540414):0.5020208414,t372:1.300760617):2.067560951):2.836760402):3.995588362):0.01527231135):0.06954611831,((t373:1.538742828,t374:1.522554235):0.5705298706,(t375:1.193483024,t376:1.188428092):0.57980341):8.161865922):11.97995231,(((((t377:0.3294096706,t378:0.3186486713):6.930840878,t379:7.190759305):1.711606027,(((t380:0.9646430609,t381:0.9423779894):0.8959335415,t382:1.836544382):5.039956643,((t383:1.700482825,(t384:0.4902039366,t385:0.3572175419):1.198896556):2.409143762,t386:3.907085915):2.766703773):1.978972986):3.990886491,((t387:4.588434665,(t388:1.5427311,t389:1.448021852):3.026091584):3.314915191,((((t390:3.200177529,((t391:0.706852163,(t392:0.05779987421,t393:0.02131603645):0.6165285357):0.5181968636,t394:1.078699893):1.857939301):1.106223902,t395:4.034561732):1.786781141,((((t396:1.79484989,t397:1.788110544):0.7159809881,(t398:1.022177831,t399:1.000117403):1.464330485):0.4656119536,t400:2.918869194):1.018072318,t401:3.769070588):1.684566432):0.1229045484,(t402:0.539954418,t403:0.4949595408):4.719131859):1.419865861):4.731697622):5.775998578,(((t404:0.3546847313,t405:0.2651283698):4.271579501,(t406:4.012688891,(t407:2.286130235,t408:1.967603854):1.725131481):0.5102185568):3.958190055,((t409:4.236108451,(t410:3.233681906,t411:3.037906845):0.9535329566):2.186644846,(t412:5.35961537,((t413:2.366517154,t414:2.188768619):0.5725655622,(t415:2.401519343,(t416:1.928344798,t417:1.811468371):0.4126011745):0.1000394011):2.197824571):0.7408419628):1.708881828):8.507123624):3.097416945):30.10036019):32.49925272,((((t418:0.7050182214,t419:0.6850541201):1.029599236,t420:1.515004995):2.472244127,t421:3.970436528):8.727201726,((((t422:2.703431931,(t423:2.414467511,(t424:0.6211745946,t425:0.5994135097):1.73741314):0.2108758179):3.073003816,((t426:1.296252976,t427:1.197883172):3.799437556,(t428:4.278826619,(t429:0.3289011786,t430:0.1993679231):3.929487896):0.6898019708):0.505418603):0.1825464469,t431:5.42861313):0.4572059737,(((((((t432:0.8749837989,t433:0.8210270532):0.2728268168,((t434:0.06337733034,t435:0.02090881185):0.514789524,t436:0.4212697993):0.5051152751):0.178252765,t437:1.084831514):1.316999945,(t438:1.247057621,t439:1.207961216):1.07069475):0.5995156286,t440:2.840156248):0.3570558544,t441:3.190725548):0.2793603994,t442:3.348868611):1.916208711):6.228559779):68.19846107):199.6219105,(((t443:0.6769521287,t444:0.5978916501):36.43073783,(((((t445:2.67033771,(t446:1.153382967,t447:1.05571258):1.480576298):1.311313958,t448:3.66739511):7.418919378,(t449:4.665740741,t450:4.594510067):6.281216668):11.79423135,(t451:5.734395307,(t452:5.45928003,(t453:0.3878321307,t454:0.2744621675):5.069751104):0.2482193696):16.91040908):1.067016772,(((((t455:0.6097060865,t456:0.4547117743):0.6000447019,(t457:0.7707070913,t458:0.441374335):0.201657211):0.1684635268,t459:0.6684748848):2.67330171,t460:3.075959084):8.530015233,((t461:3.745028504,t462:3.739468241):1.639028231,t463:5.32622686):6.144798095):10.95795239):12.76195472):222.7649335,(((t464:1.205169223,(t465:0.74072829,t466:0.7204809335):0.4629032935):5.988380286,((t467:3.46317498,(t468:2.300548798,t469:2.06197204):1.09182):2.188015183,(t470:4.90091898,(t471:2.767943048,t472:2.155819466):2.088551933):0.4324297563):1.497784269):16.6887218,(t473:0.3738411429,t474:0.2337980313):22.36381359):233.9286372):19.37139045);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T3.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
