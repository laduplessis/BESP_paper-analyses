<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t470:2.381823336,t471:2.197485334):7.143627044,((t472:0.3440921136,t473:0.3324646909):6.908901173,((t474:1.404638762,(t475:0.5848626455,t476:0.5438335461):0.6927044058):3.100013411,(t477:0.8522193077,(t478:0.587574097,(t479:0.174831345,t480:0.03121941054):0.4060152055):0.261573157):3.424294712):2.596121736):2.087053414):1.932465794,(t481:1.435205815,t482:1.228991654):9.274837662):5.627996737,(((((t483:1.770274496,t484:1.704281416):0.1876634241,t485:1.809362318):2.517608075,(t486:3.619376112,(t487:0.6036982135,t488:0.5919583108):2.947125591):0.3378793914):0.8139473218,t489:4.677241514):10.04860637,((t490:0.8968720123,t491:0.7927789128):3.942083056,t492:4.670939097):9.717064861):0.491757499):5.185121435,(((t493:0.8113582315,t494:0.760532136):4.397757639,t495:5.085250626):11.71420585,(((t433:0.04219620748,(t416:0.2442531383,(t258:0.02334712544,(t239:0.1399090596,(t237:0.02037686051,((t224:0.2067802879,((((((t134:0.1107067309,(t132:0.01688326865,((t110:0.03832315308,(t108:0.01293056221,(((t52:0.01714169654,((t1:0.9999717359,t2:0.9760159125):3.558636788,t3:4.531848805):1.100568523):2.19125367,t4:7.823336607):0.1346630281,(t5:0.7143460769,(t6:0.3203358573,t7:0.2959294698):0.01410982653):6.799023997):1.937538182):0.1013854116):0.7855391899,(((((t8:3.330609763,t9:3.315001063):4.910506894,(t10:7.225773395,((t11:2.994007241,t12:2.789045855):2.770656972,t13:5.374143698):1.459820753):0.9117519962):0.8697167093,(((t14:3.297987391,(t15:2.619032776,t16:2.601524874):0.6657154642):4.296958839,(t17:6.944185376,(t18:2.575173956,t19:2.564942603):4.336896078):0.2303514344):0.03536615292,(((t20:3.91842161,t21:3.813895461):0.9594139398,(((t22:2.072725949,t23:2.019367394):1.011303312,(t24:1.731727439,t25:1.669657579):1.179987199):1.120968309,t26:3.940863144):0.5299878072):0.03906837675,t27:4.297544945):2.123950574):0.8824575247):0.3866757012,((((t28:0.9722666772,t29:0.905064477):2.307350491,((t30:1.022203343,(t31:0.5343346145,t32:0.02605088906):0.4874823961):0.7293107521,(t33:0.9594964449,t34:0.8393558216):0.2229046008):1.396949094):1.099362412,(t35:0.586907526,t36:0.5382178952):2.94349125):2.721614032,(t37:5.838852821,(t38:4.199430129,((t39:0.6026475931,t40:0.2508576874):3.168091569,(t41:0.642519951,t42:0.349900589):2.73602776):0.3609785172):1.622043696):0.006157440492):0.2215769491):0.007497115104,((((t43:2.860687872,(t44:1.666367072,t45:1.580405672):1.089787584):0.656982791,t46:3.319434909):1.428303069,t47:4.687900888):0.3037023994,((t48:1.918617556,t49:1.885285703):2.04811991,(t50:2.544560387,(t51:1.30600623,t53:1.184751134):1.231011795):1.277749209):0.9796528124):0.02181654229):0.426138823):1.378073281):0.1954650898):0.9236795974,(((t54:1.056857893,(t55:0.04044296674,t56:0.01522759523):0.8871349741):2.511622296,(t57:2.438330655,t58:2.418262409):0.9542978745):2.198044886,((t59:4.033452181,(t60:2.580455226,t61:2.449802066):1.234217594):0.007831134313,t62:3.572756036):1.496256153):1.795699785):0.7536809648,(((((((((t63:1.255775052,(t64:0.7933038908,t65:0.7216084015):0.4399815878):3.195569233,(t66:3.366504895,t67:3.355442334):0.8499710126):0.01757610536,(((t68:1.280845561,t69:1.249741293):0.771928193,t70:2.006680555):1.360044126,((t71:1.746355601,(t72:0.7931687355,t73:0.7096687809):0.9356503544):1.323414569,(t74:2.704366009,(t75:1.615483592,(t76:0.3825849561,t77:0.2886823048):0.956212993):1.059908083):0.2456089514):0.05697710349):0.8077999272):0.4872635214,(t78:3.284060373,t79:3.233204786):0.5980572463):0.3624418076,(((t80:1.999511515,t81:1.92683936):0.4229146479,t82:2.292547465):0.04222559118,t83:2.162528894):1.619479853):0.1413718029,(t84:3.050614411,(t85:2.090010495,(((t86:1.786998577,t87:1.741626468):0.08545200375,t88:1.687600869):0.08404194404,(t89:0.2004706959,t90:0.1986332528):1.322238272):0.109124985):0.942356363):0.8061618664):0.07336174202,((t91:2.437801975,t92:2.431896405):0.04631350542,(t93:1.620005817,((t94:1.405276797,t95:1.382492383):0.09273060057,((t96:0.4628994055,t97:0.433249128):0.8418173335,(t98:1.185194591,t99:1.058422309):0.08310922512):0.152351985):0.02323770105):0.7117187712):0.8546835243):1.328965087,(((t100:1.707001513,t101:1.551162216):0.2141896098,((t102:1.058156311,t103:1.015334196):0.07093274637,t104:0.9071016269):0.6034551028):1.031503714,(((((t105:0.5600462155,t106:0.5285507021):0.1058108676,((t107:0.3777167522,t109:0.1097640623):0.04415480852,t111:0.07795882053):0.1424372557):0.5051676133,t112:0.6774770571):0.007777885641,t113:0.6199443043):0.3019728751,(t114:0.3038766588,t115:0.2059761019):0.5632115704):1.027538545):1.225407382):0.470629433,(t116:1.735191046,(t117:1.125549409,t118:1.047267555):0.316638465):1.666034635):0.2676776184):1.680990763,((((t119:0.4569794213,t120:0.426599753):1.797952083,((t121:0.3886825736,t122:0.3798670923):1.155502131,t123:1.410221021):0.3983871043):0.6303620933,t124:2.427805852):1.570848035,(((((t125:0.7768159976,t126:0.6434646596):0.7480050732,t127:1.178602352):1.39737256,((t128:0.3309278167,t129:0.1410140986):1.642122472,(t130:0.3152318946,t131:0.2734191497):1.434952596):0.5958122585):0.03967607758,(t133:0.1981417338,t135:0.04312373112):1.830730326):0.3413936472,(t136:0.293578878,t137:0.1364001529):1.765761238):0.6242479128):0.5055959054):2.781105715,(t138:3.854470267,(((((t139:0.8931084322,t140:0.8185533258):0.2391859004,((t141:0.4874263867,t142:0.3927673665):0.1300474702,t143:0.4435113374):0.2573071352):1.66701294,(t144:1.524963092,(t145:0.5351604975,(t146:0.3761618452,t147:0.3221040529):0.08966459751):0.9335103847):0.6617975328):0.1464241669,t148:1.978295305):0.5664657973,t149:2.291490507):0.2232739166):1.671300232):0.3589609219,(t150:1.652166341,(((t151:0.5912346245,t152:0.5127409264):0.2999540543,t153:0.7513160315):0.6164536687,((t154:0.7511019876,t155:0.710601979):0.3485969501,t156:0.9177254696):0.2191606312):0.1396656495):2.668008609):3.791372924):0.7449563843,(((t157:0.6507902722,(t158:0.4452164982,t159:0.4409067988):0.1512581004):3.259279466,((((t160:0.07084775704,t161:0.05150807264):1.261827313,t162:1.219916263):0.07941490506,((t163:0.7215662827,(t164:0.1098843539,t165:0.07472963961):0.2737423982):0.126982182,t166:0.4466658525):0.4247725449):1.707062645,((t167:0.5214852057,t168:0.2097458634):0.4948311438,t169:0.6882614814):1.550978349):0.718956861):0.4742715726,((t170:1.300811243,((t171:0.9559007266,t172:0.9115191766):0.1866898257,t173:1.064932413):0.1284254861):0.1633406315,(t174:0.2138292737,t175:0.167267634):1.081076819):1.948142173):3.993749698):0.3002326484):0.2544127158):1.367603823):14.92770272):1.936162944):3.946394808,((((((((t176:1.505560015,t177:1.423441983):1.631682046,t178:3.000223278):10.91877662,(((((t179:1.238602547,(t180:1.15287295,(t181:0.238362809,t182:0.1767417288):0.8688039527):0.06785333378):0.7548861047,t183:1.52741005):1.030221281,(t184:2.03399986,t185:2.013858982):0.3607286944):1.222942486,(t186:1.331487299,t187:1.247187533):1.976084136):7.675974022,((t188:0.5682033294,t189:0.5365144632):2.229120285,t190:2.650258752):8.030043556):1.616100728):5.16180069,(((((((t191:0.6979704676,t192:0.4287941847):0.327099534,t193:0.2442788153):0.2504137869,t194:0.4370846036):2.52889054,t195:2.959753936):2.428849737,(t196:1.94950579,(t197:1.46071294,t198:1.339439704):0.2946332939):3.337986931):1.011398726,t199:5.775318481):5.933711478,(((t200:4.543912212,(t201:1.930024059,t202:1.747449304):2.462487891):0.06946367778,t203:4.277807834):5.005719075,t204:8.997663657):1.504327662):4.114178696):1.318648407,((((t205:5.719717263,(t206:0.5948106211,t207:0.5180956514):5.09991488):0.8709624069,t208:6.397377078):2.987264473,t209:9.341435684):6.208708277,(((t210:3.898744515,(t211:2.352171157,(t212:0.7163950602,t213:0.6589270003):1.597985754):1.373988115):5.772553846,(t214:7.653064157,((t215:4.162913127,(t216:3.406070604,t217:3.263673893):0.7550222064):0.4862601545,t218:4.474088203):2.879704077):1.672217845):5.71571209,((((t219:5.752941794,t220:5.674400507):1.212764213,t221:6.859060646):4.113382625,((t222:4.491415408,(t223:4.281732482,t225:3.949374089):0.02729133757):4.829423103,t226:8.784427285):1.645159054):1.264853177,((t227:3.340180809,((t228:1.368815565,t229:1.169201811):1.096374183,t230:2.189235173):0.763051604):8.26244234,(((t231:0.5682430141,t232:0.5626793903):0.9058615145,t233:1.339939725):2.965363357,(t234:0.1281569405,t235:0.04040370932):4.083532528):6.624673759):0.02416789127):2.330609184):0.05644832776):0.1225291248):1.070378174,(((t236:5.870745268,((t238:1.571057335,t240:1.357535738):2.084229255,(t241:0.6089853359,t242:0.6063323192):2.783667313):2.057674663):3.771116163,((((t243:0.1103463856,t244:0.09648127509):2.716731909,(t245:0.3967977381,t246:0.2997772392):1.994807282):1.469816635,((t247:1.968774816,((t248:0.6254485175,t249:0.6228469936):0.5581164294,t250:1.175472628):0.7119120005):1.640158274,((t251:1.031599952,(t252:0.8960134592,t253:0.8878339371):0.0927984919):1.743082941,t254:2.722044164):0.7125195532):0.07948647632):0.05094881782,(t255:2.183241543,t256:2.161021822):1.337372766):4.81264945):0.6824914974,((t257:1.779750382,(t259:1.230305062,t260:1.110450451):0.2357166305):6.850239533,(t261:3.209199307,t262:2.767006136):4.98482893):0.3074387479):3.995429754):3.512046788,(((((((t263:5.855135244,(t264:3.329074108,t265:3.230515822):2.190635316):3.642741662,(t266:8.785439066,(((t267:2.718284514,t268:2.689520162):1.95774014,t269:4.638393124):2.514032527,(t270:2.297387835,(t271:1.41462204,t272:1.189428594):0.8360157601):4.796208609):1.480642017):0.1719603514):0.462773556,(t273:1.230051861,(t274:0.3102792025,t275:0.1797537407):0.8874892308):7.680055076):0.7560349269,(((t276:1.293294838,(t277:1.061615246,t278:1.056875545):0.08144060713):0.3206078888,t279:1.379809393):1.927515688,((t280:0.5426013802,t281:0.5179714371):0.7283937842,t282:1.167249688):1.591767444):5.896765722):3.00207935,(t283:2.248113157,((((t284:0.5155802292,t285:0.3375382341):0.3858860686,t286:0.4804599642):0.4902059098,t287:0.9366997123):0.736336495,t288:1.456186853):0.04369853323):9.314094785):0.1931125255,((((t289:1.499723979,(t290:1.257162029,t291:0.9208764566):0.1651174897):0.07098227112,t292:1.122777085):2.663181356,t293:3.730047748):3.537714537,t294:7.023102059):3.196661023):0.9241183969,(t295:9.460880051,t296:9.341069167):1.639733706):0.7302984981):3.043026259,(((((((t297:0.6098807768,t298:0.59098588):4.304011908,t299:4.802146342):2.838116607,((t300:3.69637936,t301:3.616068429):3.096851245,t302:6.695808384):0.6737884729):3.548005157,(t303:2.174903018,t304:2.109617526):8.693513145):0.1451690342,((t305:5.515973839,(t306:3.581479403,t307:3.344392075):1.69783969):5.128254954,((t308:6.163853431,(((t309:2.821899876,t310:2.78122974):1.490747974,(t311:3.882526669,t312:3.670726121):0.2344331394):0.3684044982,t313:4.251339759):1.40624106):1.438629838,(t314:0.412617882,t315:0.3011695461):6.657858713):2.277015374):0.1548292257):1.282303941,((t316:6.775367467,((t317:3.793175839,((t318:0.4356491115,t319:0.3380346695):2.085860323,t320:2.321665312):1.232894259):1.705122005,(t321:0.7158085245,t322:0.6390870048):4.528735429):1.14904838):3.610766545,((((t323:2.505457607,t324:2.487561938):0.4073087984,t325:2.70638745):2.289393848,(t326:0.04579413681,t327:0.03683900926):4.578990677):3.569634145,(t328:7.187337181,((t329:4.699890569,(t330:2.003246184,(t331:0.525408297,t332:0.5187770768):1.463168408):2.654619436):1.564596269,(((t333:1.469073098,t334:1.46159879):0.8325397521,t335:2.29319011):0.3241982509,t336:2.547026201):3.499617733):0.8418332746):0.7368821921):1.014589363):0.06123824743):0.01000175073,(((t337:4.695743311,t338:4.62282453):0.5752977152,((t339:2.126507919,t340:1.954166933):2.874643751,(t341:0.5790086991,t342:0.3666048396):4.216088683):0.1360147547):0.2297102764,((t343:0.8583082492,t344:0.8212957601):3.505858028,(t345:2.048216129,t346:1.819040087):2.260073777):0.5661344865):3.129586071):1.946081946):1.615635044):3.305705629,((((t347:3.793000552,t348:3.777509267):2.825604967,t349:6.580482327):0.8273199906,((t350:3.924683745,t351:3.919699853):3.428373707,(((t352:1.016087093,t353:0.8767650852):2.152199961,((t354:1.125968427,(t355:0.2532863355,t356:0.2100870328):0.6057885842):0.8645711365,t357:1.625405717):0.8169695838):0.06132418366,t358:2.434984201):4.036518027):0.02035324656):0.8243296655,t359:7.127659901):6.15292222):15.29908734):3.013397192):83.91164604,(((((((t360:1.794691243,t361:1.367266577):2.367955778,(t362:3.049856304,(t363:2.321483511,t364:2.201559628):0.5894502681):0.6550875864):0.897055772,(t365:0.7696619475,t366:0.7281196419):3.501632797):0.7102742157,t367:4.846941504):5.492016411,(((((t368:1.25083075,(t369:0.416156067,t370:0.3655910375):0.711930006):0.555086546,(t371:1.239475058,t372:1.092138468):0.1561558809):0.5163389302,((t373:0.5784391554,t374:0.5103838162):0.748702674,(t375:1.015888277,t376:0.9858414851):0.163617687):0.3765837309):2.161958887,t377:3.64047609):5.362304216,t378:8.981391525):0.4851514514):0.1612928363,(((t379:0.3938738723,t380:0.3715840672):3.083927947,t381:3.364558823):4.041683477,(t382:0.2540626911,t383:0.1644618915):7.110532386):2.042152105):16.27014006,((t384:8.455665145,((t385:4.71129025,(t386:2.736496451,t387:2.715497825):1.957457159):0.3259168318,(t388:0.4188867718,t389:0.4034028253):4.549069433):3.41114405):7.93810124,((((t390:4.015590808,(t391:2.588306877,t392:2.55918875):1.399714869):3.466069731,((((((t393:0.1219288117,t394:0.1143085134):2.378192233,((t395:0.1866299563,t396:0.1563865656):2.063730977,(t397:1.577176149,t398:1.546347945):0.514929242):0.0707520671):1.099791789,(t399:2.17054044,((t400:0.3003406343,t401:0.281546792):0.6803946632,t402:0.8766191385):1.16229308):0.9915661871):0.1645457895,t403:3.158828557):0.7383078587,t404:3.887812824):0.6942350653,(t405:3.570747234,((t406:0.4182759413,t407:0.3713494927):1.75247585,t408:2.120661653):1.211345846):0.9622562598):2.197482464):2.263829863,(((t409:0.9480102322,(t410:0.7731116302,t411:0.6506043472):0.03947742829):1.277559715,t412:1.957431104):6.342015291,(((t413:0.8648884344,t414:0.8232661672):0.4572940765,t415:1.248018604):6.132536408,(((t417:4.473440047,((t418:2.965507433,((t419:2.16960284,(t420:1.673541665,t421:1.647502397):0.4772426832):0.3436898824,(t422:1.77650287,t423:1.754243165):0.6127590359):0.1493502559):0.1889413381,t424:2.594138498):1.16390883):0.4191430266,(t425:0.9392650516,t426:0.9380976154):3.204220524):0.5983812425,t427:4.273316903):1.608217338):0.7099486488):0.1319548808):3.446778198,(t428:4.710142404,(((t429:2.264380642,t430:2.01770923):0.002530072442,t431:2.001527318):2.21865112,t432:4.066584931):0.05820423225):5.455458674):3.054946289):9.176339503):87.78288326):17.21149439,(((t434:5.293465257,((t435:0.7356997984,t436:0.7243511039):0.4694718834,t437:1.093343264):4.024693778):0.3608832616,(t438:5.272196717,(t439:1.054738315,t440:0.9397591126):4.192323198):0.05771760055):10.27710206,((t441:1.894460835,t442:1.805429816):0.1143952583,t443:1.818548705):13.41050631):110.6503157):158.180457,(t444:37.25642701,((((((((t445:0.3433786778,t446:0.3374703045):1.893416271,t447:2.063160943):1.382597851,(t448:0.1922628377,t449:0.1059268853):3.250155142):0.1374355068,t450:3.459378232):0.5049789774,(t451:0.3439112163,t452:0.2526193705):3.613856249):0.9260673719,(t453:1.620703695,t454:1.13559887):3.16255841):8.264629554,t455:12.51830447):9.580679668,(((((t456:3.276872892,t457:3.270721471):0.2479329867,t458:3.337832495):2.750140017,(t459:1.440142072,t460:1.407441095):4.604887791):1.790003356,(t461:5.83335042,(t462:5.061872,((t463:1.444280353,t464:1.38568676):1.761880453,t465:3.053305777):1.789706029):0.7620568893):1.966165297):1.73913393,(t466:2.98240034,(t467:0.603508114,(t468:0.25673013,t469:0.1564217723):0.3217949909):2.023497983):6.269693416):12.01831563):14.10869918):246.7236123);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T84.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
