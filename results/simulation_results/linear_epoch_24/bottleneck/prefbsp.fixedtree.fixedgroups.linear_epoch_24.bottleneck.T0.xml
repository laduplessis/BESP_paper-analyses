<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((t333:6.193432768,((t334:0.1940130554,t335:0.1497373437):2.921154116,(t336:2.01215634,(t337:1.092561575,t338:1.016711637):0.9055974104):1.053150582):2.967020145):5.59157101,((((t339:5.809934352,((t340:0.8387494646,t341:0.8220481821):4.82285371,((t342:1.745024497,t343:1.475321961):1.378608282,t344:2.841367592):2.450145672):0.01156973186):0.03409035983,(((t345:1.466465667,t346:1.234230663):0.389468527,t347:1.492862264):3.078439324,(t348:3.706080665,(t349:3.355300075,t350:3.317385781):0.3050781368):0.8333547581):0.2870254029):1.495337553,t351:6.145165791):0.6972974402,(((((t352:0.7957525021,t353:0.7508876814):1.520574843,t354:2.249906778):0.1761147593,t355:2.347234169):1.515481674,t356:3.745135388):1.830540003,(t358:0.8405402175,t359:0.7610617748):4.476860023):0.8817726168):3.291367666):6.916960353,(((t360:3.388289084,t361:3.386203619):3.969223766,((t362:4.939237883,(t363:3.437132437,(t364:2.198322603,(t365:1.693489599,(t366:0.5649299087,t367:0.5537035517):1.075988861):0.4940482253):1.149014195):1.238147551):2.181689512,(t368:1.117268963,(t369:0.6788103626,(t370:0.2290686175,t371:0.1633896396):0.4349135116):0.3390193174):5.53263953):0.1884723427):6.677786338,(((t372:9.508451044,(t373:5.481981954,(t374:2.524335562,t375:2.219262441):2.901972542):4.020393948):0.7371348011,(((t376:2.947595792,(t378:0.736406297,t379:0.7130416702):2.100681736):1.537570171,t380:4.252883967):3.527430505,((((t381:0.08072944361,t382:0.0789543684):0.01217719987,t383:0.03212457647):0.9090148276,t384:0.8658903696):4.463682233,t385:5.26305031):2.301383436):1.852787402):0.125292679,(((t386:4.380223471,t387:4.203998233):0.5447308661,(((t388:0.1394005806,t389:0.1200324611):1.574320372,t390:1.244763932):2.258406158,((t391:0.7487234024,t392:0.7485186288):2.505932507,((t393:2.163800606,t394:2.158239685):0.4543861624,t395:2.564166668):0.2179768424):0.2332720468):0.6410569953):0.5643517276,t396:4.140121821):3.929336147):2.899986198):2.203289109):16.00528472,(((t397:3.129708716,t398:3.1118232):5.121762589,(t399:3.129664637,t401:2.907266805):5.102793422):11.36672286,(t402:8.507049256,t403:8.472764389):10.85154629):9.542261654):14.7313345,t404:43.56941404):3.560446064,((t405:3.965275148,t406:3.846362481):10.11678222,(((t407:1.377791637,t408:1.138736048):9.316169769,((t409:4.444889772,(t410:1.62137102,t411:1.563166348):2.791469163):2.882693215,(t412:1.921973171,t413:1.744771529):5.304127277):3.105647273):1.798785845,((t414:6.344444206,t415:6.147464742):2.105512572,t416:8.21384757):3.333641701):1.149907148):32.76400654):69.75372994,((t417:21.22929119,(((((((t418:2.393972047,(t419:1.861727313,t420:1.604428738):0.4524784437):2.498732127,(t421:4.0957447,t422:3.934365521):0.4515055459):0.3668488148,t423:4.543422458):0.3551206357,((t424:0.4700375384,(t425:0.390680948,t426:0.2123717649):0.04574966537):0.8954198595,t427:1.115434311):3.241528291):1.060234899,(t428:0.1751816202,t429:0.06427161949):5.092086519):4.661977245,((t430:5.986295876,(t431:4.631705247,t432:4.384492379):1.326086721):0.5020634053,(t433:0.9193167989,t434:0.8211815105):5.124828793):3.274613461):2.21374259,((t435:4.212004615,t436:4.009050041):3.117714654,((t438:2.461745443,(t439:1.717803782,t440:1.648664359):0.7049222616):1.753728929,(t441:1.572158606,(t442:0.3873675867,t443:0.0442032792):1.07300427):2.47234587):2.519928483):4.088177714):7.536284473):22.80408506,(((((t444:3.362853611,(t445:3.188798579,t446:3.041946246):0.1650033431):6.147845767,((t447:3.007140816,((t448:0.7067948647,(t449:0.2824726689,(t450:0.1442854973,t451:0.04656648872):0.08716111512):0.3145269346):1.345814809,(t452:0.1971097424,t453:0.1907383454):1.53406007):0.9277729489):4.787112589,(t454:2.814236672,t455:2.516410318):4.441490858):1.544444992):0.4547623235,(t456:7.994283303,((t457:0.4878200596,t458:0.4673509929):2.933729578,t459:3.357910433):4.539768975):0.8524778752):17.56655208,(((t460:0.9421156037,t461:0.8488189213):0.9364156999,(t462:1.103184387,(t463:0.4494139385,t464:0.3363351892):0.5452567289):0.665079695):17.38997843,t465:18.74699028):7.034989121):0.5335230398,((t466:8.043188173,(t467:1.89741305,t468:1.798382097):6.068408777):8.483189549,(((t469:0.3832865066,t470:0.3099014682):1.263066855,t471:1.229003233):5.618145971,t472:6.830545154):8.934073997):9.657810926):12.43440096):71.16964557):11.98995451,(((t473:4.60620544,t474:4.589809386):5.188515422,(t475:1.369232024,t476:0.9655600023):8.389653288):41.69885158,(t477:0.9753525137,t478:0.9583005706):50.06501437):69.45979749):15.17432438,(((t479:0.00516204305,(t437:0.2029662763,(t400:0.1645963459,(((t377:0.04390624509,((t357:0.1686298548,(t320:0.1207067979,(t321:0.01688651199,(t268:0.02444485099,((t243:0.0137182234,(t215:0.1006337247,(t197:0.05401907538,((((t162:0.03264075742,((t159:0.0004567473468,(t156:0.1111642736,(((t147:0.04197040299,(t132:0.102117187,(t127:0.04131881871,((t120:0.003203730221,(t118:0.05132608897,(((((t102:0.2124132883,t103:0.1701453292):0.04287748638,t104:0.15181433):0.09552512048,(t105:0.1469390513,((t18:0.5740313674,t1:2.076738028):7.858524306,((t2:5.499651532,t3:5.216308912):3.622246098,(t4:4.765074488,(t5:2.593354467,t6:2.586565574):2.074151842):3.997460707):0.6387164432):0.6530286647):0.08447305231):0.101278047,(((t7:5.671689644,t8:5.64256095):1.342408417,t9:6.956593062):2.42916995,(((t10:0.6484172694,t11:0.5751998677):2.746509356,t12:3.266132722):5.878467855,((t13:6.358612065,((t14:0.5602998996,t15:0.4341857854):5.251697295,t16:5.599844678):0.4318773194):0.5096567539,(t17:6.140726483,(t19:3.084651101,((t20:1.065923808,t21:0.8200053958):1.626459739,t22:2.389567134):0.2259711314):2.269003848):0.2369823873):2.26119496):0.04421926744):0.6839585311):0.370481502,((t23:0.5963950561,t24:0.5372251224):0.1353046303,t25:0.5839771092):7.665089012):0.7833813811):0.09667921414):0.02896504072,(t26:8.884425544,(((t27:1.984887745,((t28:0.8344275088,t29:0.7609164894):0.7515130857,t30:1.45507666):0.2400882281):5.318151084,((((t31:0.9142877689,t32:0.9114676203):1.828685806,t33:2.602575748):1.323975165,((t34:1.6664639,t35:1.538575953):1.97771126,t36:3.281098317):0.2615036073):2.423362714,t37:5.954081677):0.3561435521):0.08896689143,(t38:1.688759944,t39:1.36625828):4.694807121):1.483650311):0.1358153001):0.6782077406):0.468540259):1.769233371):0.0656696474,(((((t40:0.1258776596,t41:0.05021923111):3.366872337,t42:3.359568537):2.81936544,t43:6.069530659):1.118202707,(((((t44:3.907825151,(((t45:1.650050924,t46:1.626471348):0.06610481952,(t47:1.512167526,t48:1.505578494):0.1786973835):1.544037072,t49:3.222112442):0.6213542754):1.281536169,t50:5.005563699):0.50464396,(t51:4.845303989,(t52:0.7995475233,t53:0.5482503311):3.842276084):0.5175532155):0.105888712,(((t54:0.9928672816,(t55:0.1523621402,t56:0.09717492556):0.7160392632):3.731486453,t57:4.494996568):0.00105588675,(t58:4.004520234,((t59:0.4910528673,t60:0.4021202111):1.69156862,((t61:0.3334537582,t62:0.1643201095):0.5165768303,t63:0.6473092396):0.9745463365):1.758191497):0.4411366668):0.2045807132):0.2885048696,((t64:2.152902029,t65:1.992430868):2.084367043,(t66:3.147126927,((t67:0.6465651985,t68:0.4049671992):0.412819972,t69:0.8026722761):2.040216488):0.8278274838):0.06124058254):0.961953486):2.33079355,(t70:3.330852742,(((t71:2.883344015,(t72:0.5733603693,t73:0.5355048671):2.155728968):0.02045487357,((t74:1.360891438,t75:1.320576996):1.123788142,t76:2.315897415):0.1609659318):0.05090869229,t77:2.511299888):0.2893001911):3.693331632):0.8576276585):0.004804973729,(((((t78:2.233140117,t79:2.069359935):0.2060361392,(t80:2.062375715,(t81:1.512577221,((t82:0.4886387358,(t83:0.1989534058,t84:0.1546237946):0.2527402399):0.9476884606,t85:1.313857687):0.07125356008):0.536589798):0.1362994905):0.5130078739,(((t86:1.46574591,(t87:1.129858413,t88:1.066905344):0.09239457649):0.5090249166,((t89:1.501722081,t90:1.272523807):0.0630459384,t91:1.023803703):0.01212311525):0.0637768434,t92:0.9873253896):0.5265795015):3.706978354,((t93:1.796997335,((t94:1.450427462,(t95:0.08805452472,t96:0.03296226494):1.251455668):0.1480159082,(((t97:0.556794355,t98:0.3704465319):0.1984920213,t99:0.5508320073):0.009569028857,(t100:0.1864536887,t101:0.006357457786):0.1433909204):0.6566233316):0.05686374674):0.2921636096,t106:0.5934381985):3.109153161):0.2541560196,((t107:1.905569821,((t108:0.832746127,t109:0.7656144941):0.2082865682,(t110:0.4439987629,t111:0.4211216509):0.1304836175):0.796439566):0.3202285483,(t112:1.093339708,(t113:0.1667286636,t114:0.1478151435):0.7636965105):0.421744414):1.648477314):0.402054242):1.371842702):0.1918398247):0.2660483249,(((((t115:0.3004589149,t116:0.2642284537):0.3224819529,t117:0.505328023):0.8806005651,(t119:0.9116039921,t121:0.6595673512):0.302364631):0.1877395791,(t122:0.3970584585,t123:0.1968380743):0.7196096897):0.5276986464,(t124:0.6915824597,t125:0.5066802011):0.7513915274):2.950137513):0.1447193423):0.8506438806,((t126:0.9084901694,(t128:0.1966250879,t129:0.1210866189):0.6030187584):0.1486002696,t130:0.7194111251):4.129961587):0.4500827952,((t131:0.2642977293,t133:0.08001773802):1.314506113,(t134:0.1577757599,t135:0.1428821099):1.205199721):3.703394827):1.06850895,(((((t136:1.372499417,t137:1.172786348):0.1781667986,(t138:0.7619635221,t139:0.7006301065):0.4961995044):1.098731758,t140:2.125150446):2.046604377,((t141:1.191691634,(t142:0.330244144,t143:0.3269148591):0.7058801045):2.735763976,((t144:1.623482429,(t145:0.8772118361,t146:0.6461049896):0.695544828):1.242743807,t148:2.330798141):0.2674277072):0.2153736754):0.291165877,t149:3.044515588):1.13022749):0.5502569563):2.526924297):1.853137335):1.466141885,(((t150:2.837427206,((((t151:0.8445702198,t152:0.8187227504):0.3771216084,t153:0.739684721):0.4594829814,((t154:0.4626960413,t155:0.404837787):0.47595815,t157:0.5396523074):0.117505599):0.7013094986,t158:1.320295987):0.2595928211):1.644784263,((((t160:0.1236388166,t161:0.09266884903):0.3143251098,t163:0.2349676478):1.214523527,(t164:1.039939159,t165:0.8331670101):0.3590783597):0.4861812982,(t166:1.388018604,(t167:0.3329026303,t168:0.2416942007):0.8677411913):0.281022685):0.7548287341):5.479208406,((((t169:0.3024599993,t170:0.2649486524):0.3359952295,t171:0.5651875841):1.402412339,(t172:0.3525285568,(t173:0.05613435534,t174:0.002740372061):0.2339594276):1.441007404):3.350147177,t175:5.016089099):2.214581862):0.5450521594):1.262469113):4.100525676):0.08887586339):4.5790097):0.3916348005,((((((t176:0.7850341833,((t177:0.3544023205,t178:0.03866671079):0.1042722203,t179:0.1360446863):0.2974363927):0.4233465348,t180:0.5590656016):0.5063462223,(t181:0.8317239412,((t182:0.2819262945,t183:0.195251337):0.5251116184,t184:0.6809364759):0.02214115715):0.05890230225):11.33508418,((t185:0.6526131716,(t186:0.05518076211,t187:0.05167990192):0.5439195266):9.297379155,((((t188:0.2668088331,t189:0.1801717296):5.618980278,(t190:3.587163924,((t191:0.9668423806,t192:0.9565490044):0.2561943303,(t193:0.7982290566,(t194:0.396062643,t195:0.3902059689):0.2808144473):0.3533240138):2.308850654):1.948601171):0.982794906,t196:6.140759234):1.568789253,(t198:2.96582829,t199:2.858918098):4.631260708):1.445336899):2.070091836):0.6585301881,((((t200:2.42202419,t201:2.332566333):7.898929019,(((t202:7.418029948,t203:7.27943003):0.8620850379,((t204:1.252700062,t205:1.216905605):1.916534997,(t206:0.9974554364,t207:0.6949122247):2.09074396):4.971920243):0.9487568243,(((t208:0.8697604892,t209:0.8695235575):4.944800393,(((t210:1.802397089,((t211:0.413058423,t212:0.2362655918):1.313980282,(t213:1.026215474,t214:0.6087750339):0.4188669449):0.0362711355):1.203251543,(t216:1.878588125,t217:1.848370312):0.1786341033):0.3426205117,t218:2.19577854):2.246006198):2.759428356,t219:7.180714794):0.005664926172):0.5545772794):0.1819889067,t220:7.907524022):0.6166487763,t221:8.512361989):0.4936192541):0.8467449555,((((t222:1.831464847,(t223:1.374718709,(t224:1.352444291,((t225:0.8869600692,t226:0.8776777545):0.3458276589,t227:1.029844604):0.102371539):0.0136877609):0.359410197):1.389222956,t228:2.891085648):1.437440318,t229:4.290580193):2.178727056,(t230:0.5787725366,t231:0.5773706004):5.870350355):2.81332468):3.631617796):1.074526666):1.585701458,((t232:11.32597894,(((t233:1.480959655,t234:1.441884381):3.083333714,t235:4.332529298):3.88722732,(((t236:1.326779054,t237:1.118006601):0.09514541571,t238:1.195642567):5.260368922,((t239:0.2917523778,t240:0.2811060546):5.486123289,((t241:1.250168078,t242:1.239257451):1.353956164,(t244:2.149467616,t245:1.939499901):0.3587207829):3.018925281):0.5910480243):1.358075602):2.866994102):2.957492976,((((t246:2.729651842,(t247:0.3651953479,t248:0.3566317511):2.292252973):5.248359503,(((t249:0.302602645,t250:0.03651447499):2.251968395,(t251:1.52931223,t252:1.495951894):0.5945341884):2.538871016,(t253:3.89489232,((t254:0.4109001289,t255:0.3172081135):1.976153906,t256:2.220562615):1.322149517):0.6504709546):2.674604297):1.373738941,t257:8.10489331):0.6841622597,((t258:1.215429388,(t259:0.1907080817,t260:0.01229530437):0.9306108102):3.629668572,(t261:2.030633234,t262:2.024063958):2.247648384):3.894703994):3.041372668):1.208515096):0.4613499737,((((t263:0.491519118,t264:0.3446079053):4.891268851,((t265:2.225773976,t266:2.135021334):0.175612386,(t267:0.9005961111,(t269:0.5395336434,t270:0.45721811):0.04354006438):1.409171824):2.785706769):3.831346544,t271:8.495789948):1.746145548,(t272:1.714762038,(t273:1.692671915,(t274:0.327276551,t275:0.2328182485):1.363598282):0.009805913037):8.438325421):1.898282267):0.0040681333):4.6278219):3.982175573):2.729246286,(((((t276:0.2017000951,t277:0.1366761788):6.765771621,((t278:3.525110125,t279:3.31166836):1.54530081,t280:4.597391435):1.826720746):3.95303824,(((t281:5.041731214,t282:4.995258474):0.6540850242,t283:5.313226735):2.675246942,(((t284:1.582647553,((t285:0.06388342314,t286:0.05368115733):0.2302558205,t287:0.2516860077):1.258724319):1.564286401,(t288:2.038196719,(t289:0.5002940809,t290:0.4766470245):1.416541685):0.8392285944):4.409159198,t291:7.084938349):0.3041039879):1.819885692):1.346643607,(((((t292:3.590716345,(t293:0.2347214132,t294:0.1449430295):3.331752147):1.841086818,(t295:5.136114305,((t296:1.468294579,(t297:0.3191318769,t298:0.2808203596):1.142253027):2.920195092,t299:4.229396807):0.6502832138):0.1653229662):0.01595278205,(t300:1.762809977,((t301:1.117845887,t302:1.0385068):0.1326198938,(t303:0.6661805232,t304:0.576764165):0.4713671382):0.3683634355):3.235402417):1.93572578,t305:6.53854125):0.5633761165,t306:6.939454276):2.591761189):5.732950779,((((t307:1.454050735,t308:1.352201576):4.483189996,((((t309:0.5027962233,t310:0.4790774676):0.1048511238,t311:0.4419991828):1.748412613,t312:2.005255294):0.1553455686,t313:2.129891376):3.225569761):7.80642868,((t314:4.521005888,((((t315:0.3263836782,t316:0.167070535):2.230141127,t317:2.380047933):1.265406557,t318:3.634679687):0.230844863,t319:3.858792177):0.4632856132):4.35272031,(((t322:0.19876969,t323:0.1192243374):3.042856812,t324:2.848591575):4.748567451,((t325:2.953839803,t326:2.577257744):1.719173821,t327:4.232424402):2.78084664):0.1190601407):4.22240117):0.783943152,(t328:10.33666836,(t329:2.974069604,t330:2.80319125):7.245850393):1.765524285):0.7273343365):5.284084653):13.71376171,(t331:2.775374999,t332:2.45912602):28.38035025):119.1130956);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T0.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
