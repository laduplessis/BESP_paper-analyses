<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t451:1.588444868,(t452:1.281144499,t453:1.263818357):0.2758195659):2.01525848,t454:3.553704642):2.499191631,(t455:1.466919909,(t456:0.9158218923,t457:0.5856318889):0.5097388999):4.579793917):0.193729581,(t458:2.864766158,((t459:1.729814045,(t460:0.145786371,t461:0.1091725509):1.453264367):0.6561115934,(t462:0.5990093603,(t463:0.08237591364,t464:0.07360616491):0.2416956903):1.601691634):0.09663501908):2.780949879):7.954426981,t465:12.65366313):101.0583314,(t466:39.62234761,(t467:12.84682548,((t468:1.643577026,t469:1.307040013):0.3141477694,t470:1.295131346):10.88305612):26.51100273):74.08643743):153.6391366,((t471:2.712729027,t472:2.566982097):87.18026251,((((t473:3.279363606,((t438:0.01632942947,(t417:0.1724275821,((t398:0.1631660872,(((t364:0.1675487059,t365:0.05484268262):0.07862963128,((t262:0.06085607484,((((t179:0.1122956035,(t168:0.08128515049,((t145:0.03357062178,((t136:0.07045890299,(t134:0.02486317601,((t123:0.001585993593,(t116:0.04514148573,((t106:0.01136152445,((t100:0.02748117311,((t59:0.08083417876,(t1:5.666739071,t2:5.632383289):0.6155823576):1.406699385,t3:7.57577594):2.588873963):0.3081499071,((t4:1.608099497,t5:1.522798073):6.777550479,((t6:4.918800386,t7:4.634983248):2.758193805,(t8:6.264115634,(t9:4.414956861,t10:4.400184254):1.844265589):1.125838153):0.6127958127):2.044040052):0.2820423602):0.5475386464,(((t11:8.49245684,(t12:0.8271257605,t13:0.7657332129):7.581412506):1.261267658,(((t14:4.96902513,t15:4.873739561):1.664069786,((t16:2.488648477,t17:1.995131515):1.136311142,t18:3.10808407):2.850696959):0.03919209157,((t19:1.457825201,t20:1.444734863):4.147180159,t21:5.478362792):0.3865041659):2.859513014):0.04130418482,((t22:3.626962744,t23:3.580650462):3.725522367,t24:7.302342782):1.207137475):1.055741886):0.2626220187):0.8210220788):0.050960688,(((t25:8.252745227,(((t26:1.949609735,(t27:1.860686544,t28:1.837576218):0.03662326649):4.496446227,((t29:3.934952296,((t30:0.3927439819,t31:0.2598890643):0.1328526687,t32:0.3893922659):3.342339957):2.032017651,((t33:2.89225232,t34:2.885477988):2.092228998,t35:4.907594829):0.5762256512):0.1355445295):1.716524554,((((t36:2.497217953,t37:2.464689763):1.849985014,(t38:4.239718206,t39:4.186052425):0.05891069586):2.868961113,(t40:5.374363555,t41:5.081049607):1.444918316):0.05129093255,(t42:0.5704749,t43:0.5188755102):5.846572274):0.01270606989):0.02631396643):1.173606805,(((t44:2.860173437,t45:2.380698952):2.189031488,((t46:1.048784401,t47:0.8481573916):1.401102506,t48:1.91818299):1.980275625):1.48026383,(((((t49:2.132413646,t50:2.079818992):2.592420178,(t51:4.410038533,(t52:3.192047304,t53:3.165693207):1.133677844):0.02384401731):0.1555191843,((t54:0.1374617042,t55:0.09951609704):4.209772786,t56:4.254404608):0.07682219514):0.06280533059,((t57:2.48126518,t58:2.454837006):0.9816094642,t60:2.88648518):0.9110626457):0.2187688963,(t61:3.612684359,(t62:2.609190167,t63:2.581326814):0.9854279437):0.3812029746):0.05609777415):0.9116746342):1.087265184,((t64:1.317370223,t65:1.300274751):3.564494075,((t66:4.322280729,((((t67:0.7430437087,t68:0.1344394029):2.796596052,(t69:0.8269816392,t70:0.7452795279):2.025408465):0.6241141552,((t71:1.641681032,t72:1.638307653):1.483984117,t73:3.108811202):0.2440543549):0.05552606746,(((t74:2.647256701,(t75:2.243010795,t76:2.180851189):0.0527358168):0.2247357629,t77:2.329563059):0.4458554289,(t78:1.962522845,t79:1.811910936):0.8035855296):0.01279817572):0.09123564741):0.3136205179,((((t80:1.678405408,(t81:1.122834081,t82:1.035078906):0.4412103716):0.02509702936,t83:1.440273172):0.3423554837,t84:1.542741082):0.5014188882,(t85:1.877605666,((t86:1.169470016,((t87:0.7713574254,t88:0.3220831876):0.09494148006,(t89:0.2345207744,t90:0.2274750291):0.09837128241):0.176304109):0.2779467994,(t91:0.6229477032,t92:0.6173819709):0.1382495865):0.4183597363):0.01525587853):0.3071043553):0.1863589167):1.038513327):0.03378778299):1.214259978):0.1665947657):0.7171093797,((((((t93:2.224471522,(t94:1.040981562,(t95:0.5456272833,((t96:0.2875024983,t97:0.2562831937):0.1913654947,(t98:0.1185828862,t99:0.1015116791):0.2868787928):0.03015664832):0.4286740256):1.149720575):0.1461502291,t101:1.926030506):0.04486894574,(t102:1.156256927,t103:1.098620274):0.724046647):0.08798334702,(t104:0.5152403104,(t105:0.2889053221,t107:0.1923096296):0.1872858426):1.193044716):0.02335375678,(t108:0.8686249623,(t109:0.4030972124,(t110:0.2385227507,t111:0.2226554248):0.1547691833):0.4199771316):0.7125391571):0.4092353929,(t112:0.7143888536,t113:0.6659878774):1.191450865):1.772952192):0.1034517044):2.148432309,((((t114:1.089592398,t115:0.945687879):1.066148247,t117:1.907141799):0.8347924066,t118:2.665085281):1.815954803,((t119:0.4942697908,t120:0.2738672833):3.276548419,((t121:0.5884421236,t122:0.3639694034):0.4297378928,(t124:0.6321093798,t125:0.3938009422):0.04932348528):2.393589735):0.6429846054):0.6430048697):0.3949103518):1.293953705):0.8211910699,(((t126:1.038212458,t127:1.025811385):1.19372675,(t128:1.558728691,(t129:1.020481031,(t130:0.6943883538,t131:0.4709051075):0.3198508103):0.335097247):0.5674125146):0.121368339,(t132:0.9982802064,t133:0.8438784547):0.7626953177):4.202566424):0.1028935174,(((((((((t135:0.3118121512,t137:0.09338625374):0.2827385414,t138:0.3743402414):2.002209191,t139:2.030895999):0.1533213605,(t140:1.086140616,t141:0.9889822492):1.019873159):1.182629611,(((t142:1.301348861,t143:1.215308894):1.12677226,((t144:1.124913225,(t146:0.7050909783,(t147:0.2047397061,t148:0.1880232626):0.4396337315):0.2761195653):0.8921092685,(((((t149:0.2340119539,t150:0.1094924129):0.05600669094,t151:0.1463270673):0.152128518,t152:0.03333810262):0.779520242,t153:0.7169025328):0.329487328,t154:1.032782747):0.06452158038):0.2780035792):0.2719029357,t155:1.313875818):0.468310479):0.8385819063,(t156:0.1059519151,t157:0.01463898095):2.397065923):0.02102337919,t158:2.393502139):0.3684998744,t159:2.698826946):0.1539559408,(t160:1.860522498,((t161:0.6433951103,(t162:0.3796792562,t163:0.2602183186):0.246003926):0.8613332884,t164:1.122418173):0.3535998359):0.9421285654):0.4085547685):0.09360249854,(((t165:0.1406629469,t166:0.1126549357):0.5029600724,t167:0.2235630105):0.5792248437,t169:0.6658915881):1.610735303):7.274075134):0.325548578,(t170:7.409687118,(((t171:0.7545643421,t172:0.7339999154):3.397942774,(t173:1.762998656,((t174:0.1452594602,t175:0.0655692376):0.8488177422,t176:0.8425494563):0.4123358691):2.243035246):2.484756005,((t177:0.8743411767,t178:0.8343854219):1.989200295,(t180:1.206632188,(t181:0.2440676121,t182:0.1544078682):0.7940917337):1.390844856):3.025352013):0.474362718):2.459691201):9.255835742):1.957497403,((((((t183:1.914109474,(t184:1.015900775,t185:0.9812561035):0.8334400458):2.601019049,t186:4.394636151):3.131613532,((t187:1.420818508,t188:1.333085115):4.032664539,t189:5.302951856):1.967493551):4.830169523,(t190:9.938875925,((t191:5.866288772,t192:5.741810193):0.5316722731,(((t193:1.207593187,t194:1.047484862):0.6566475472,t195:1.686605503):3.968509641,(((t196:1.366912738,t197:1.298559793):2.24246947,t198:3.019241301):1.468822866,((t199:0.3109220734,t200:0.2500999977):4.078268779,(t201:3.761754095,t202:3.608210343):0.5454786373):0.08919884953):0.5236441872):0.3486877887):3.234113015):2.139589168):2.061799087,((t203:2.061117315,t204:2.054949298):2.012196391,(t205:0.005691337634,t206:0.003838318169):3.989103633):8.442873888):2.526063073,(t207:7.337689715,t208:7.275272386):7.554551133):2.252964721):2.339970882):1.285570903,((((t209:4.387764144,t210:4.306961919):5.763215036,(t211:7.102249803,(t212:1.271320583,t213:1.235379222):5.595876024):2.895046292):2.622781295,(((t214:3.664374911,(((t215:0.635109917,(t216:0.357832068,t217:0.3068334408):0.2156264459):0.04369030724,t218:0.5085359871):2.061923641,t219:2.297169617):0.8944199325):5.782912155,((t220:1.82365082,t221:1.763312876):3.692369661,(t222:3.163601252,t223:3.088833954):2.216820767):3.361239015):0.4996617657,(((t224:5.764062043,(t225:0.9423850917,t226:0.9384033254):4.751016698):0.4869168452,t227:6.090322123):1.256002759,t228:7.206162824):1.50053549):2.370246128):3.782426085,(((t229:0.443510136,t230:0.4330204365):1.183643755,t231:1.573804435):6.11564553,((t232:3.679053711,(t233:2.263073034,t234:2.158485773):1.311384176):2.330476479,(t235:2.353886006,((t236:1.46744722,t237:1.360461341):0.5278028346,(t238:0.1110357458,t239:0.1091264926):1.682929615):0.1340138895):3.258887191):1.49503137):6.62997155):4.040348493):0.4222018415):1.781385989):1.604055992,(((t240:2.591420274,t241:2.587084802):1.047691001,(t242:0.4040377518,t243:0.3665252012):3.080558904):7.394096792,t244:10.76432609):9.980059097):5.286923785):10.31738797,((((((t245:5.952308738,(t246:4.096828251,(t247:3.374750175,t248:3.325152644):0.5550451842):1.65433692):4.221570708,(t249:7.185381973,(t250:5.814747361,((t251:1.240142369,t252:1.206884227):2.047578417,t253:3.204153556):2.443987878):1.309935151):2.548564865):6.112850338,(t254:4.150626211,(t255:3.658703354,(t256:1.40221649,t257:1.368418294):2.226040589):0.4246838117):11.35789283):1.106115919,((((t258:3.151533079,(t259:0.888793934,t260:0.8840618649):2.14608066):0.7117577741,(t261:3.272128098,t263:2.805383385):0.1209829088):2.901448487,((t264:3.56824868,((t265:1.610414343,(t266:0.8896205701,t267:0.8821979632):0.7194451431):1.040794689,(t268:0.1704362866,t269:0.0395286249):2.455868341):0.8277851539):0.5848686059,((t270:1.453447317,t271:1.398498189):1.922315063,((t272:1.283801576,t273:1.277957654):1.74868623,t274:3.002242093):0.1493654661):0.5170391894):1.506799252):8.465106915,t275:13.46396771):1.248274334):2.510671065,((((((((t276:1.068669885,t277:0.9776897398):2.29297821,t278:3.019813258):3.934539671,(t279:3.281936383,t280:3.271177792):3.576126751):0.2691963645,(((t281:2.322655404,t282:2.17396689):1.158588793,t283:3.321688298):3.571044802,t284:6.879799889):0.01149537524):0.6144576245,(t285:6.679321068,(t286:1.468960969,t287:1.351829487):5.157659398):0.8225236121):1.562227029,((t288:6.299111222,t289:6.058426431):0.8509469487,(t290:2.105326008,((t291:0.928072829,t292:0.9254408057):0.1610251112,(t293:0.7899099524,t294:0.7650363241):0.2881264718):0.9093064452):4.7441484):1.646611804):1.12010073,(((((t295:0.4540057088,t296:0.4235265691):1.083172452,t297:1.323192827):0.4790117906,t298:1.580186196):3.249808898,t299:4.743056389):0.7106540448,(((t300:0.07030765808,t301:0.05001833991):4.127543817,(t302:2.940402905,t303:2.847884226):1.231840021):0.3818534394,t304:4.372585666):0.8642546163):3.454120947):4.533547466,(((t305:1.808837955,t306:1.658624655):5.654224036,((t307:2.053898205,t308:2.05064837):2.211825593,t309:4.046678994):3.03466788):0.7575466291,(t310:3.259470302,t311:3.141625562):4.393633864):4.775667096):1.783576944):15.90445203,(((((((t312:3.639997832,(t313:2.734107717,t314:2.547991967):0.8731552338):5.823828408,((t315:1.720799558,t316:1.593303346):2.451683216,t317:3.692749231):4.972870779):0.7475120135,(((((t318:0.0506687467,t319:0.006972301286):1.470067545,t320:1.41225699):1.461554092,t321:2.852161599):0.1326687152,t322:2.877094341):4.977091584,t323:7.597974587):1.279063039):2.667580834,((t324:1.495745771,t325:1.118349181):9.785977809,(t326:1.886268399,t327:1.854271777):9.007080104):0.2161346591):1.60785768,((t328:7.634153011,t329:7.302205635):2.053245127,((t330:2.041324964,t331:1.931592989):4.723909651,(t332:1.600710526,t333:1.591315386):4.984914304):2.559338526):2.686022075):0.1595776048,(((t334:0.6877129582,(t335:0.5484234119,t336:0.4974063697):0.05814696751):0.3542554238,t337:0.7906136624):7.307908479,(t338:0.2220750864,t339:0.1044306008):7.736875371):3.514772135):3.262520626,((((t340:2.487537931,(((t341:0.8170463925,t342:0.756121414):0.4821980768,(t343:0.6282527952,t344:0.563435924):0.5965661482):0.0878546507,(t345:0.8905435304,t346:0.87330618):0.3281917773):1.066264934):1.517133683,t347:3.747791759):5.368392949,(((t348:0.5231820462,t349:0.4947785927):7.689092507,((((((t350:1.444121714,t351:1.366647302):0.6906058688,(t352:1.542945486,t353:1.510814124):0.2891167677):1.050304624,(t354:0.8827031497,t355:0.8667016686):1.767898458):2.29567723,(t356:0.04990890189,t357:0.04725051658):4.783485292):0.01398723479,t358:4.799821998):2.006147873,(t359:1.293355587,t360:1.245997783):5.489850988):0.5419427426):0.6052852752,((t361:3.321641153,((t362:0.7285544036,t363:0.5755513392):2.408199475,(t366:2.13971035,t367:2.072732768):0.3048048696):0.01272442938):4.000409542,t368:6.22946829):0.4372168323):0.2929538144):4.293073748,(((((t369:3.050806277,t370:2.812771602):0.7131279464,(t371:0.330200002,t372:0.3069807677):3.0714755):3.060203903,((t373:1.103586992,t374:0.9642131184):3.024785275,t375:3.93721791):2.255507401):0.4729857857,(((t376:0.1041020042,t377:0.09621820492):2.016154055,(t378:1.233158139,t379:0.9666996349):0.7192881778):2.239127003,t380:3.910597674):2.199497413):2.305551555,(((t381:1.567943849,t382:1.538507104):1.131955929,(t383:1.906751235,(t384:1.821074182,t385:1.386973702):0.0214070564):0.6120921133):1.045684713,t386:2.564070284):4.538050296):1.430248408):0.6900190407):12.04971386):0.533195056):3.987192687,(((t387:0.8776344266,t388:0.8768974883):1.835543865,t389:2.68940227):3.803503944,(t390:5.669280637,t391:5.661952743):0.7909593633):19.17515176):15.03686288,(((((t392:4.808250747,t393:4.744074766):5.11025781,(((((t394:3.791119252,t395:3.742668825):2.138595755,(((t396:1.046408679,t397:0.8880577716):1.052438754,(t399:0.4492896673,t400:0.3294220752):1.067202962):0.6095590489,t401:1.981280718):3.127797695):0.1655417355,(t402:5.095605631,((t403:1.662164824,t404:1.600322794):2.352375776,(t405:0.6668716191,(t406:0.4291810249,t407:0.428244526):0.07445561391):3.283697842):0.8860651502):0.1639884427):0.8073205478,(t408:2.504487377,t409:2.446806509):3.104658678):0.8694646511,((t410:3.397628843,t411:3.341726749):1.660884087,t412:4.976696346):1.218302847):1.92673002):4.103089389,(t413:1.711516511,t414:1.614679737):10.35784024):0.05114548458,(((((t415:1.950701918,t416:1.922103899):1.124105063,t418:2.585204237):0.3121101069,t419:2.861648537):2.619738883,(((t420:2.720293099,t421:2.694138376):0.7484742805,(t422:1.793282045,t423:1.792904921):1.637312966):1.18760942,(t424:0.7115261667,t425:0.6074091122):3.60419389):0.7624786131):5.186324957,((t426:2.375268713,t427:2.321072257):1.142130314,(t428:0.3574980167,t429:0.2629433945):3.057952385):6.61358198):0.7870205626):22.56042009,(((t430:12.64757167,((t431:7.310607869,((t432:2.786706092,(t433:0.4988313512,t434:0.3576841842):1.679670587):0.753141316,(t435:2.508311661,((t436:0.7698135873,t437:0.7028279843):1.606376311,t439:2.268692083):0.1091486901):0.2387698985):3.756231681):3.994055524,t440:10.26725314):1.336550969):4.086902025,(((t441:1.630810724,t442:1.628710693):0.5132610407,t443:2.073786636):1.898883789,(t444:0.1539406873,t445:0.109003988):3.741628695):11.59605931):2.411488513,(((t446:3.097440359,t447:3.060915747):3.794956649,(t448:4.487951195,t449:4.472477962):2.351017406):5.821757271,t450:12.41897352):5.134434409):14.07959344):3.934437443):57.09318878):176.5077145);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T10.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
