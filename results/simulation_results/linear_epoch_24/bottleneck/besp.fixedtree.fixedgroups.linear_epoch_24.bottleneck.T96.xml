<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t489:5.76842372,((t491:1.276847417,t492:1.18508405):1.154968958,(t493:0.4884254547,t494:0.4581333912):1.631091317):2.86845769):2.661363688,((t495:0.5513734569,t496:0.3287530437):4.593023283,((t490:0.1811434316,((t480:0.04345684432,(((t402:0.01539652594,(t318:0.06318928496,(((t242:0.07201823752,(((t190:0.1128364047,((t176:0.06993424556,(t162:0.02760993704,(t149:0.04692456621,((t103:0.07444828563,(t101:0.04722438459,(t95:0.1976274242,((t91:0.05682228285,t92:0.03406600527):0.007664384052,((t62:0.002800775289,(((t33:0.004680252884,t1:2.555548316):3.246364274,(((t2:0.4290616964,t3:0.3649104051):2.395539129,(t4:0.8868219559,t5:0.8864627876):1.827291405):1.304278916,t6:4.00697809):1.621732935):0.3612546213,t7:5.973480438):0.2167181613):2.050064231,(t8:6.864978626,t9:6.688022528):1.35772156):1.568418237):0.4117228525):0.3889510849):0.3831909114):2.361482822,((((((t10:5.147308902,t11:5.042970866):4.497195815,(t12:3.486032502,t13:3.31499378):6.032566074):0.7365725535,(((t14:0.3304132074,t15:0.3239662805):9.22937236,((((t16:1.038355994,t17:0.9455044537):7.03442413,t18:7.950480663):0.03639361429,t19:7.933448396):0.4791881128,((t20:3.690430085,(t21:3.315946564,t22:3.292235484):0.2916359944):0.1667527696,t23:3.396626064):4.524975712):0.8461682998):0.005427722836,t24:8.496376746):0.3761199878):1.135084417,((t25:2.722245252,t26:2.667787894):5.499043504,(((((t27:4.40203833,t28:4.379566277):2.639241431,((t29:0.5750231574,t30:0.5331697709):0.5795767091,t31:1.062261676):5.839634609):0.5738712765,(t32:2.859204926,t34:2.582353437):4.599003953):0.006227431629,(t35:7.071619805,((t36:4.768498931,t37:4.565068004):1.070369527,t38:5.61471842):1.204509051):0.05796104171):0.09831929457,t39:6.893429084):0.2339552578):1.606822241):0.3571973319,((((t40:6.705595521,t41:6.611726922):0.08068622962,(t42:0.4219403184,t43:0.2659238345):6.18525145):1.327592602,((t44:1.27101692,t45:1.183267688):6.052741506,((((t46:3.27681384,t47:3.248711606):1.888173488,((t48:1.21946201,t49:1.09818488):0.8786471468,t50:1.583724797):3.02847911):1.232880611,t51:5.830578355):0.6139891791,((t52:3.514147332,t53:3.448494207):2.397168994,(t54:3.040705206,t55:2.956650068):2.723477785):0.3973658438):0.03925029496):0.3995820531):0.5565314461,(((t56:2.831296309,t57:2.609013097):1.644794229,(t58:2.697990983,t59:2.559841228):1.287627905):0.6826625179,t60:4.298832019):1.461059998):0.3951264065):1.033356699,((t61:3.51813426,t63:3.416803202):1.533812385,(((t64:1.884247028,t65:1.879192929):1.569646501,(t66:0.5924785554,t67:0.2274447891):2.552600816):1.091563877,(((t68:2.612821358,(t69:0.6173647664,t70:0.5837821223):1.907341901):0.1285514814,t71:2.365223357):0.1770737999,((t72:0.7772731829,t73:0.7688295205):1.509377559,t74:2.14382321):0.1467870843):0.8499172589):0.2939266857):1.951164806):0.2020710744):1.568388082):0.7988206408):1.19032306):0.9399954379,((((((((((t75:1.866599848,((t76:0.3009989936,t77:0.297799562):1.357352165,t78:1.629052738):0.1668911245):0.1286152591,(((t79:0.3074819824,t80:0.2743607356):1.130606426,t81:1.380317341):0.2931742287,(t82:1.102993258,t83:0.6979672278):0.4296563435):0.01397202679):0.5706244413,(t84:0.5073785933,t85:0.4610885482):1.158832468):2.436653201,(((t86:1.337076291,(t87:0.2028173728,t88:0.07076841952):0.9215813488):1.144479268,(((t89:0.2337567635,t90:0.1390896631):0.7481267484,(((t93:0.3186253583,t94:0.2691617407):0.1225903369,t96:0.006317824923):0.1289319356,(t97:0.08358623904,t98:0.06175309166):0.02916436059):0.1040621284):0.8230751119,(t99:0.1386488666,t100:0.09674038959):0.7360943445):0.3272471145):0.0403614346,t102:0.900521067):1.499934585):0.5136374194,(((t104:1.437826076,(t105:0.8464348574,((t106:0.2031365146,t107:0.1714573994):0.4915136559,t108:0.4726151802):0.09953615488):0.5026575955):0.1088333254,t109:1.149073605):0.6036392979,t110:1.702855979):0.5168434684):1.713732377,t111:3.929502728):0.08091730072,((((t112:0.121104076,t113:0.1194657552):1.113711967,((t114:0.1654329183,t115:0.1554383975):0.6258517046,t116:0.7019979626):0.3252095536):1.021731452,((t117:0.6697282189,t118:0.1736036658):1.003970973,t119:1.156220973):0.32996554):1.069174454,(t120:1.192500831,(t121:0.4659946724,t122:0.415447081):0.594450414):1.342268441):0.2165344353):0.2375038714,((t123:1.437848989,t124:1.406858798):1.094108724,((t125:1.312489914,(t126:0.1732689641,t127:0.0897405502):1.099243701):0.1863664913,(t128:0.4555270385,t129:0.3853313976):0.917256707):0.9889701817):0.2241953606):0.1218451999,((t130:1.136534678,t131:0.9815363372):0.2352061516,(((t132:0.410179547,t133:0.3608568595):0.1903571598,t134:0.4931436548):0.3711947797,t135:0.6311073818):0.07938097369):1.103739705):0.8182345685,t136:2.603829862):1.178952734):0.4771199921):0.08194598853,((((((t137:0.3303998622,t138:0.2421010604):0.1056166575,t139:0.3375835281):0.4965835804,t140:0.7729154104):1.200120637,t141:1.930934071):0.5415169503,(t142:1.898025525,((t143:0.4550359757,t144:0.440159048):0.9766403465,(((t145:0.8277921631,t146:0.7822266287):0.04522253867,t147:0.7816898094):0.1197306725,(t148:0.2548815563,(t150:0.03056200213,t151:0.009804325093):0.006534980896):0.3896873274):0.4059733945):0.3036635482):0.5505502027):1.175437195,((t152:0.1738981598,(t153:0.04464279269,t154:0.04268885231):0.1197477715):2.095489789,(t155:0.37796054,t156:0.2563342383):1.859536419):0.5520781751):0.4617843106):4.835771511,((((t157:0.1933803316,t158:0.1553511229):0.4084672641,t159:0.5365905428):1.662938274,((t160:0.495489489,t161:0.3797748328):1.020218075,(t163:0.5123184496,t164:0.5020950167):0.5509274908):0.6522682467):1.218026173,(t165:0.4305673637,t166:0.3758955365):2.443602388):4.467120594):0.09088612622):0.6983855891,(((t167:1.646122168,t168:1.428642281):1.079409079,(t169:2.401403541,(((t170:1.611306683,(t171:1.390613951,(t172:0.9231093808,t173:0.8213846123):0.3786281451):0.1014343758):0.3959919782,((t174:0.3887798998,t175:0.3172576067):0.7435560385,t177:0.8826968789):0.3241134927):0.2076744193,t178:1.302542761):0.1651836165):0.1011623696):4.315339834,(((t179:0.67322363,t180:0.5929534081):0.7726480644,t181:1.32384417):0.09112846152,(t182:1.3445834,((t183:0.4145889476,t184:0.410654682):0.7990212297,t185:1.160884384):0.1293444201):0.07038569213):4.010660428):1.02576925):1.60006806,t186:7.669704934):4.44206101):8.75773699):2.598042612,(((((((t187:0.4259838551,(t188:0.08185746877,t189:0.06892524736):0.1997912305):0.558217097,t191:0.6093470961):0.3543991134,t192:0.791466074):5.262485655,(t193:0.412735051,t194:0.3518102295):5.504900659):2.66146187,(((t195:4.167649687,t196:4.077661875):2.937980341,(t197:2.113483625,t198:1.958327415):4.794360713):0.7428612265,((t199:0.1431319921,t200:0.1138623523):0.2006480382,t201:0.1754676106):7.149908698):0.6024839471):4.593490559,((t202:1.911983477,t203:1.804011976):3.409486217,((t204:4.379666706,t205:4.323100998):0.4644287451,(t206:3.873213327,t207:3.796496657):0.8374693936):0.3587399609):7.052544871):2.076929521,((t208:6.71013623,(t209:4.579676315,t210:4.347392563):2.052747162):2.823475535,((((t211:0.8687945033,t212:0.8577471875):4.413601799,((t213:1.781996483,t214:1.578771675):1.026005197,(t215:0.4385593713,t216:0.09797555004):2.02497548):2.39934425):0.5008434754,((t217:1.067239176,t218:0.8446369926):1.69542873,(t219:0.4355975857,t220:0.2838849833):1.959723815):2.21226716):1.962578773,(((t221:0.6987457156,t222:0.6280485529):0.8735296851,(t223:0.3573805168,t224:0.3081857785):1.051615815):1.983798856,t225:3.320467788):2.818820253):1.307494987):4.498535519):7.519765208):4.025175371,(((((((t226:0.372990384,t227:0.3168363336):4.028405291,(((t228:0.9541108449,t229:0.9466417524):0.3319177263,t230:1.276840687):1.520979979,(t231:0.1771522469,t232:0.164994566):2.604332653):1.460270434):4.745940459,(t233:8.532832157,(((t234:0.935091971,t235:0.6760515278):5.191652235,((t236:3.797139069,t237:3.547541014):0.3695320021,(t238:1.071162233,t239:0.9633242376):2.812126859):1.676257274):1.239306346,(t240:6.18108227,(t241:3.054453824,t243:2.95035754):3.121725036):0.4952103519):1.109535003):0.1273248355):7.156848704,((((t244:2.871117792,t245:2.76715164):0.08017968625,t246:2.829213748):2.268151047,((t247:1.800677049,t248:1.729685827):1.507812275,(t249:1.734285526,t250:1.163898962):1.494219289):1.779689634):2.012055426,((t251:1.770435619,t252:1.755238102):2.389623126,(t253:2.950932469,t254:2.906700487):1.1651922):2.216514432):7.712386085):1.636873696,(((t255:1.439862141,(t256:0.7776574284,t257:0.7066196828):0.5401056283):4.307413015,((t258:0.1642384651,t259:0.09315884633):0.5310781599,t260:0.4207785405):4.839732988):2.014496845,(t261:5.227031835,(t262:2.190224895,(t263:2.013198367,(t264:0.9839788556,t265:0.9407966115):0.8834417668):0.1467865283):3.031235439):1.898141584):7.702142621):1.944448881,(((t266:5.123788333,t267:5.038573854):6.642116694,(t268:2.931154735,(t269:1.465550747,t270:1.460714281):1.376200408):8.713999969):1.193408366,((t271:3.852139824,t272:3.819835589):0.2437393556,((t273:1.496040843,t274:1.461551859):0.5708593575,(t275:0.7932697907,t276:0.7705715811):1.155022492):1.913739087):8.619266595):3.35282487):2.311501015,(t277:5.033313308,((t278:3.056459199,(t279:2.728945323,t280:2.624965172):0.3262341972):1.302957747,t281:4.207046381):0.5253200571):13.0442566):1.248504116):0.1891621448):0.6308989412,(((((t282:1.782589815,(t283:1.220578247,(((t284:0.1345943014,t285:0.1247856172):0.2836871724,t286:0.2596439809):0.2283533209,t287:0.3080025306):0.3901763462):0.5306681299):5.872250068,((t288:0.6988273225,t289:0.597720148):0.07521996646,t290:0.6502642626):6.285870127):1.035528049,(t291:3.079954743,(t292:1.988074559,(t293:1.409602649,t294:1.402654161):0.4872453878):1.044547781):4.715076903):0.3961941506,(((t295:1.219914648,t296:1.203026638):2.232334201,(t297:2.078073839,(t298:1.018900036,t299:0.681702556):1.004668341):1.266922297):3.199292388,(t300:2.835737395,t301:2.83287387):3.160045086):1.214709702):4.02959426,(((t302:0.4117847477,t303:0.2824827014):0.9083259862,t304:1.079845657):9.147454402,(((t305:2.509778423,t306:2.031218442):3.829741676,(t307:0.223000529,t308:0.02071809234):5.457360326):2.255557,(t309:7.541767801,((t310:1.333983443,(t311:0.7123557134,t312:0.6813782622):0.5304646235):1.985526924,t313:3.182572025):4.098588123):0.1211593999):1.630137162):0.7026778943):6.69558281):0.5211652862):5.653079795,(t314:16.78078619,(((((t315:4.877125628,((t316:1.323707453,((t317:0.4592804676,t319:0.3674623393):0.2883944548,t320:0.5497062262):0.5228509281):0.9552113703,t321:1.886151895):2.572412788):0.2097894749,t322:4.617302434):2.086240789,(((t323:1.890141287,t324:1.882852195):2.821230315,(t325:0.7146702519,t326:0.7138378656):3.927967296):0.9386365524,t327:5.531594342):0.9516352922):4.3346795,(((t328:2.331576386,t329:2.156629562):1.333048587,t330:3.414097626):2.210124695,(t331:3.652866517,t332:3.45045423):1.894593125):4.935831684):0.245030905,(t333:1.552531872,t334:1.423855557):8.845619217):4.944171211):5.823232887):0.05889647865):2.417940301):12.08595394,((((t335:2.110079479,((t336:0.2759692819,t337:0.2400550573):1.065909687,t338:1.291727124):0.3612949905):1.706717286,t339:3.235806222):11.3993684,((((t340:3.860724713,((t341:1.885485479,(t342:1.692841774,t343:1.674763906):0.0645310284):0.6276270451,t344:2.09350165):1.335725029):3.24854919,(t345:0.4960724237,t346:0.3586613015):6.018113756):1.381729425,(((t347:2.271507149,t348:2.248712022):4.496159205,((t349:2.291175195,((t350:1.727367196,(t351:0.9261312437,t352:0.6602138527):0.7969714073):0.2992837213,((t353:1.044268022,(t354:0.317989376,t355:0.2895356813):0.4512032146):0.5154389499,t356:1.091285908):0.1438767111):0.03893348988):2.148012716,(t357:1.546142871,(t358:0.8696046267,t359:0.6625917074):0.664212943):1.785842475):2.246687331):0.2093778158,t360:5.296735995):0.7491205352):2.885277085,t361:8.918512921):3.145736383):7.759073242,((((t362:1.726311492,t363:1.717924819):6.0092562,t364:7.673520935):6.183905979,(((t365:3.98527786,t366:3.960677438):1.087052789,(t367:1.009290068,(t368:0.5766444528,t369:0.5616524728):0.2830621413):3.861288409):0.1479173921,(t370:4.269304858,t371:4.020077207):0.3410262371):8.463043349):4.45248014,((t372:3.597846113,t373:3.550759432):4.039253447,((t374:2.980347088,t375:2.867436952):3.903314828,((t376:0.460249166,t377:0.3732962813):5.609504099,t378:5.834941404):0.6207132648):0.5002853855):9.621601008):1.279602469):12.61869065):45.52538879,(((((((t379:1.061910892,(t380:0.1671746406,t381:0.1563127027):0.8689254626):2.656590668,(t382:2.202789749,((t383:1.002173578,(t384:0.8513235151,t385:0.8253147797):0.06996056202):0.3748631274,(t386:0.4927562363,t387:0.4848426063):0.7183519691):0.6858014673):1.448908874):6.500911085,(t388:6.491790692,(t389:5.177581087,(t390:2.893196509,t391:2.861572387):2.190146937):1.292604796):3.20353646):1.644261931,((t392:2.018831016,(t393:1.058750137,t394:0.5892677):0.879284218):1.443092348,t395:2.781972055):7.642003747):5.129046718,(((t396:1.160198314,t397:1.067531298):0.5178930623,t398:1.509036273):4.85113106,t399:6.140243522):9.016492175):22.13666669,(((((t400:2.562964021,t401:2.551039945):1.470946422,(t403:1.928246336,t404:1.599803279):1.877733519):3.957234626,((t405:5.298602924,((t406:2.18400959,(((t407:0.3936007199,t408:0.2810153341):0.06412582703,t409:0.2509611546):1.156179682,t410:1.214049624):0.4834302204):0.736697404,t411:2.280089175):2.277679693):1.185927157,((t412:1.706555212,t413:1.592848889):3.566931838,(((t414:0.5427636009,t415:0.4801557104):1.015206274,t416:1.389516088):0.9870292347,(t417:0.5202216171,t418:0.4735231698):1.789017505):2.503338453):0.453088092):0.9470567809):8.798990651,(t419:8.865433938,t420:8.799975106):6.031843672):14.5150465,((((((t421:1.515418124,t422:1.514885224):2.489644909,(t423:2.930493194,((t424:0.1095182367,t425:0.08600710545):1.672091143,t426:1.752836917):1.12674454):1.056955488):7.456230434,((t427:0.1281878213,t428:0.04113177311):9.062998051,((((t429:1.036179896,t430:0.9505098325):0.8810410221,((t431:0.4332482222,t432:0.3633965895):0.008216009772,t433:0.35465637):1.051915185):1.330099495,t434:2.599131626):1.944341818,(t435:4.26804041,t436:4.266904866):0.2011626923):3.870804942):2.191969596):6.136484479,((((t437:0.0710001045,t438:0.03247394945):0.2096994943,t439:0.1648050186):2.496029752,(t440:0.2041559367,t441:0.09912428108):2.425686712):4.554356406,t442:7.067054098):9.331771778):0.7185469665,(((((t443:0.8025977982,t444:0.7635623098):0.123148869,t445:0.86224525):5.054918022,t446:5.719481063):0.1291165295,((t447:2.33450826,(t448:0.2560813017,t449:0.172104937):2.07382315):2.340170374,(((t450:1.270144562,t451:1.031946886):0.4940479621,(t452:1.206729444,t453:1.129049991):0.234253):2.380667779,t454:3.582498215):0.4333321536):1.062187497):4.479233375,(((t455:2.395618254,(t456:1.156531329,t457:1.151031111):0.9643597971):1.160993373,((t458:0.9845926813,(t459:0.7017011933,t460:0.5419279991):0.2503118872):0.7569748119,(t461:0.5226716736,t462:0.5092083771):0.8619651257):1.299913042):2.089425408,t463:4.689925387):3.869533942):6.523998786):6.007163845,((t464:0.2434842204,(t465:0.08949667148,t466:0.05109869529):0.02205916736):18.63308473,((t467:1.759924397,t468:1.720165779):0.6605579978,(t469:1.777169017,t470:1.676605839):0.4806135779):16.25372203):2.008612734):4.922664971):5.948682272):34.49512625,(((t471:1.544978055,t472:1.503726301):6.268256997,(t473:1.825442211,t474:1.705654735):5.910308051):0.06313438536,(t475:5.620960869,(t476:0.2486968864,t477:0.2127717649):5.269516039):2.04210058):57.68296167):2.104553953):44.57480754,((t478:19.98568565,((t479:2.663231568,(t481:1.294418557,t482:1.011109449):1.224115673):2.50579001,(t483:2.840992605,t484:2.809137197):1.708152723):14.6764216):6.618880173,t485:25.76291139):85.1323838):85.08645772,(t486:4.308650981,(t487:3.540324294,t488:3.464378004):0.7396151272):191.6478622);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T96.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
