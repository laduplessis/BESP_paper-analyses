<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t445:11.9148199,((t446:1.490851543,t447:1.421122843):0.1736179144,(t448:0.9275238963,t449:0.8261250078):0.6636715446):10.24231746):22.91735681,(((t450:2.406394811,((t451:0.7828818661,t452:0.5171603364):0.9106303101,t453:1.092726193):0.5498216518):2.658019136,(t454:2.248442033,t455:2.08649145):2.041206164):3.298387485,(t456:4.107487058,(((t457:0.3067277045,t458:0.1785466344):0.05144700439,t460:0.03949316937):2.582950938,(t461:1.311727816,(t462:0.5147830017,t463:0.5095254786):0.7021839505):1.001058466):1.162227224):3.285026924):26.21137312):45.87122187,(t464:22.42696418,(((t465:3.806742931,(t466:1.128784614,(t467:0.4102025634,t469:0.2852681132):0.5634717912):2.673029968):1.112411622,t470:4.478544505):8.193892975,t471:12.63805507):9.300994604):56.1095606):17.32210565,((t472:23.12664903,t473:23.04879925):62.49088933,(((((t474:0.8552501564,t475:0.8341856719):10.37098167,(((((t476:0.4494832374,t477:0.4021841145):0.126965593,t478:0.5236225632):2.144503297,t479:2.653443593):2.019777049,(t468:0.04109520865,(t459:0.01912577164,(t385:0.1021795151,((((t307:0.08092661653,(t299:0.1972126656,((((t170:0.5055178179,(t162:0.1061271105,(((((t125:0.07980785859,(t103:0.1413275487,((((t88:0.3662767417,t89:0.09307807658):0.01679601692,((t1:5.234042441,(t2:2.142489561,t3:2.13165126):2.989345076):1.577200994,t4:6.461181715):3.149977474):0.2867242214,((t5:4.186033519,(t6:3.641293531,(t7:3.130700568,t8:3.017775876):0.3363826663):0.4813826073):2.96960595,(t9:3.844271447,t10:3.502655975):2.862728165):2.718662627):0.6118678562,(((t11:9.003825975,t12:8.936173379):0.3239489776,(t13:7.411849227,((t14:2.445536175,t15:2.44459917):3.171715601,((t16:5.061668474,((t17:2.26700689,t18:1.961806005):2.651938677,(t19:1.259936132,t20:1.149282607):3.249066222):0.08921929983):0.4587282816,((t21:0.8313438089,t22:0.8118074217):3.287264712,(t23:0.4531552319,t24:0.4386257369):3.536236609):0.8127631579):0.05743255397):1.750530779):1.585413724):0.3241031995,((t25:1.95373927,(t26:1.290075499,t27:1.128856246):0.6345054727):6.134831203,((((t28:3.182269358,(t29:0.5715158979,t30:0.3386969289):2.446511766):2.818451737,((t31:0.5015998007,t32:0.359249683):3.559965457,t33:3.911048252):1.510395368):0.7472412285,(t34:4.216452112,(t35:0.7675379988,t36:0.7027014749):3.117311018):1.919154452):0.5247886128,t37:6.193027926):0.3828709985):0.4156963994):0.03940398243):0.4115983563):2.252232913):2.054823676,(((((t38:6.119401178,(((t39:0.2733788279,t40:0.1251568215):2.815989612,((t41:0.792091335,t42:0.7501102377):1.892023913,t43:2.227941666):0.2402552991):2.220653982,((t44:0.5729732913,t45:0.524749732):3.208938617,t46:3.692364142):0.7290348572):0.7774494805):0.5507799181,t47:5.689575777):0.9634106712,((t48:5.559608187,(t49:1.634657801,t50:1.60226278):3.837357393):0.9103390641,((((t51:2.604604048,((t52:0.5056997424,t53:0.3477649333):1.443974673,(t54:0.5430218388,t55:0.5398399417):1.134200637):0.6365656809):2.562920609,((t56:4.233454882,t57:4.184912034):0.4741011924,(t58:3.72662155,((t59:1.240836625,t60:1.155806697):1.1914607,t61:2.330105444):1.140912626):0.7945710705):0.01203228807):0.114767016,t62:4.257414645):0.729010147,((t63:3.476088763,(t64:3.379337737,(t65:0.08274093512,t66:0.02515304331):3.23055095):0.04420190021):0.6601323453,(((t67:2.480127281,(t68:0.2591120629,t69:0.1576270442):2.053270467):0.9507981807,(t70:2.965056809,(t71:2.514932566,t72:2.421178396):0.4326776839):0.1135192604):0.1294814382,t73:2.900056219):0.3234362972):0.6960669827):0.2318310775):0.04101477001):1.393226062,(((((t74:1.051599004,t75:0.9666052008):0.2728774651,t76:1.034508381):1.500557412,(t77:0.3770060064,t78:0.3188281054):2.095166936):0.3808195813,(t79:2.035405757,(t80:1.701098924,t81:1.620880072):0.299775716):0.5798534632):2.023386732,(t82:1.96198563,t83:1.640077238):2.443659359):0.2196067034):1.885729659,(t84:3.882641886,((((t85:1.350527009,(t86:0.7555194654,t87:0.7494249836):0.2608973348):0.06754639043,(t90:0.3597465875,t91:0.3422855828):0.00415910489):0.2867025131,t92:0.395963793):2.038518715,((((t93:0.5187044409,t94:0.4944380787):1.124147841,((t95:0.8741558084,(t96:0.5307706107,t97:0.4609413917):0.284820402):0.4006088878,(t98:0.3186381739,t99:0.2060927269):0.8104532595):0.1321858087):0.1238094175,((t100:0.422572224,t101:0.3065831834):0.1862169215,t102:0.4544136921):0.4617750451):0.4891682535,(t104:0.680930316,t105:0.5122333085):0.5087748911):0.1512973343):0.03479153524):2.17787572):0.6949266034):0.3256684517,((((t106:1.265783886,t107:1.250845333):1.690265472,(((t108:0.5706608172,t109:0.5552699973):0.8370720315,(t110:0.2529552481,t111:0.1745381528):1.049692637):0.634819447,((t112:1.057656752,(t113:0.7605848702,t114:0.6657851192):0.2126969048):0.6341401172,((t115:0.8684070551,t116:0.655686233):0.1784063751,t117:0.7931927502):0.3661078858):0.1158308515):0.8867802314):0.1820826869,(t118:2.12144493,(t119:1.061525803,t120:1.017889459):0.8536903366):0.1340677326):1.150021949,(t121:2.764228128,(t122:1.392538009,t123:1.392221008):1.046385044):0.35725247):0.1156071497):1.190653947,(t124:2.252340043,(t126:0.8890637284,t127:0.8519279728):0.9410492737):1.534271098):0.1201992525,((t128:0.2711866202,t129:0.195888683):1.714438637,t130:1.846272712):1.452562223):0.238378068):1.151088399):6.470991403,((((t131:1.019337155,((t132:0.4065000993,t133:0.2011249886):0.21475118,t134:0.3716210782):0.04206631752):0.9978264693,(t135:0.6510016926,t136:0.5751743105):0.7165519388):3.470466165,((((t137:1.343898055,t138:1.265113991):0.7603139381,t139:2.018087277):0.3685090594,((t140:1.934895653,(((t141:0.6676933558,t142:0.6545989595):0.02779001463,(t143:0.4733731903,(t144:0.2902496281,t145:0.2571614781):0.03527413047):0.1342184827):0.5574213221,t146:0.8619992866):0.610860371):0.1850616096,((t147:0.283918633,t148:0.1816463069):0.4568938097,t149:0.6241881852):0.8634792748):0.2189658485):0.7599173088,((((t150:0.2705253464,t151:0.2658924436):0.05397811875,t152:0.2761266367):1.625004546,t153:1.560489441):0.0173567693,t154:1.486560851):0.06561315402):1.296461973):1.82876725,(((t155:1.187572797,t156:1.149069169):0.5046626715,t157:1.61743502):0.3775614386,t158:1.883319889):2.572345296):3.651927763):2.607511531,(((t159:1.175014281,t160:1.102011784):1.313699043,t161:2.295221366):6.011657949,t163:8.083929666):2.099656895):2.08781611,((t164:6.451845468,((t165:0.3923677501,t166:0.3498489458):0.6557284088,t167:0.8531433427):5.403441494):4.129992994,((t168:1.754785961,(t169:1.061787494,t171:0.2346927848):0.5185297329):0.1044498439,t172:0.7108390159):8.436181103):1.599037519):1.324710634):0.5614568494):1.895849871,(((t173:2.911938443,(t174:0.6368950534,t175:0.6229826019):2.269242186):3.451184843,(t176:1.682265456,t177:1.426526392):4.614678088):6.498100094,(((t178:5.420609678,t179:5.352428471):2.511425221,(t180:6.024458556,((t181:1.752672206,t182:1.722208996):0.4969651604,(t183:1.252679733,t184:1.195729369):0.9414661185):3.740650871):1.771865689):3.283837399,(t185:7.910658585,(t186:6.553374372,t187:6.518895957):1.169752814):2.975878641):1.249238926):1.417650958):0.03171539727,(((((t188:2.450098615,t189:2.408791201):6.82177446,(t190:1.279926038,t191:1.273073306):7.872509311):1.958282952,((((((t192:1.165109803,t193:1.16299993):0.5320160659,t194:1.662176192):1.989258988,t195:3.610003588):2.677289623,((((t196:0.7537887302,t197:0.6810815061):0.7984531754,t198:1.277247604):0.2210258578,(t199:1.100728775,t200:1.019048191):0.3193777497):2.766110189,(t201:1.349320499,t202:1.345940629):2.729651192):1.638079971):0.2019700968,t203:5.721723748):2.805971741,t204:8.463660206):1.599679253):1.041491252,(((t205:3.076283857,(t206:1.406418376,t207:1.400228973):1.531714756):0.6474835528,((t208:2.972382262,(t209:2.737733747,t210:2.657586751):0.1929945807):0.5644184725,t211:3.267351968):0.0103844885):5.602173258,t212:8.839975359):1.67632089):0.1431690512,((t213:0.118860928,t214:0.03834311439):5.826522214,(((t215:3.487758988,(t216:2.583710657,t217:2.473948435):0.6716601633):0.3020635973,t218:3.422712873):1.608018159,(t219:3.65633361,(t220:1.891460025,(t221:0.4586810341,t222:0.3983937504):1.20771711):1.724532517):1.322938047):0.4418472213):4.658976436):0.4393564719):3.91126243,((((((t223:0.9137476143,t224:0.8832080872):3.379708237,(t225:3.210801824,t226:3.189329854):1.042988424):1.653628596,(t227:4.658374074,(t228:2.257765051,t229:2.240735011):2.293535728):1.209978695):2.117799087,((t230:6.624016088,(t231:2.563545867,((t232:1.901031031,(t233:1.50133214,t234:1.250839863):0.3301630897):0.4340071593,t235:1.921890669):0.1318092775):4.043980341):0.9776184389,t236:6.687157371):0.2133362492):0.720903808,(t237:5.709584921,(t238:1.26367954,t239:0.988164095):4.325121602):1.907321924):4.036456572,(((((t240:4.673639777,((t241:0.1629043808,t242:0.0549897109):2.85653397,t243:2.887743348):1.639935604):0.3299599564,(t244:0.4219667514,t245:0.2900742803):4.263167534):3.942770529,t246:8.372215851):1.498005771,((((t247:0.1015716251,t248:0.0687888828):0.6868588071,t249:0.4773772823):4.660453532,(((t250:1.781895985,t251:1.581676508):2.412156124,((t252:1.474160739,t253:1.469146155):1.288882018,t254:2.716941135):0.7424126686):0.3065514108,(t255:1.341137262,t256:1.112784625):2.367885486):0.4758767124):4.006191307,((t257:4.149927755,(t258:1.019874621,t259:0.8914710739):3.035838241):0.8394510485,t260:4.765304769):2.721043771):0.2298764859):0.7419472403,(t261:3.285508044,t262:3.261862161):4.944179485):0.01352852159):1.26799766):1.879483578):6.758850715):1.036911312):5.178460191):3.105289424,((((((((t263:5.774449074,t264:5.751987642):4.528562051,((((t265:2.450297587,(t266:1.188185277,t267:1.084574618):1.045358753):0.6482828332,t268:2.418009035):1.315636376,t269:3.669852276):3.92740853,(t270:6.69613486,((t271:2.883830753,t272:2.706508528):3.252068587,t273:5.920906885):0.5187686682):0.7786076115):1.783920457):0.7580046851,(t274:2.528153949,t275:2.441812223):7.228006356):6.232725409,t276:15.83200554):1.331625025,((t277:4.675250843,((((t278:0.4291073004,t279:0.3893113709):0.6350870796,t280:0.9122170096):0.8167031737,((t281:0.6793737136,t282:0.6748623549):0.6670006205,t283:1.308467249):0.2604794226):2.581383602,(t284:2.006795453,(t285:0.9579905223,(t286:0.8149571476,t287:0.7853064971):0.07259475778):0.9976160059):2.033696489):0.2083928434):3.165680827,t288:7.235166525):9.287350401):0.4926442019,(((t289:3.264741502,t290:3.234000667):1.363964141,(t291:0.1189680328,t292:0.08266412048):4.440149904):2.167033999,(t293:4.892708101,t294:4.824079161):1.775555195):10.13401184):0.7207695509,((((((t295:2.828704618,t296:2.813066538):6.338419607,(t297:7.363298804,(t298:0.945623805,t300:0.7176710658):6.405223022):1.598002436):1.151817376,(((t301:2.868680071,t302:2.792032593):3.471960969,((t303:1.955863236,t304:1.800025414):3.691871664,(((t305:0.6087495165,t306:0.5494962127):0.4567420344,t308:0.8070137685):0.7470685593,t309:1.511825837):3.635517816):0.5699323656):1.766097368,(t310:3.897958782,(t311:2.95972383,t312:2.932446824):0.7113330518):3.569513778):1.757445766):1.754798914,((t313:8.142497737,t314:8.060291446):1.393368467,(((t315:3.931175088,(t316:2.834059559,t317:2.78779294):0.985759721):2.126009911,t318:5.689928771):0.5132245897,((t319:2.738364345,(t320:0.7997142802,t321:0.7917397273):1.846003946):2.196873982,((t322:2.415285161,(t323:1.415267251,t324:1.360078442):0.9493668008):1.249544399,(t325:0.9672469655,t326:0.9634291581):2.428244431):1.147361299):1.184025411):2.541770879):1.137773668):0.8910435688,((t327:8.339397134,((t328:7.443345897,(((t329:0.1761510935,t330:0.09240196173):5.107931737,(t331:4.634017349,t332:4.628015621):0.4670294842):0.5592513654,t333:5.55653373):1.548718002):0.247905338,((t334:0.1887748912,t335:0.1882405975):3.038244371,(t336:0.7283089858,t337:0.705226093):2.478093091):4.002441417):0.4216275306):0.8476314436,(t338:1.355770314,t339:1.243826339):7.061479284):1.008324209):4.084437946,((((t340:6.76856015,((t341:1.585293346,(t342:0.3053499706,t343:0.302838045):1.257048421):5.056949287,((((t344:1.684088398,t345:1.600315718):0.8883501197,t346:2.214936598):1.516138993,t347:3.590915672):1.68306399,(t348:4.131904681,((t349:1.325734276,t350:1.049202372):1.290595039,(t351:0.5063140705,t352:0.4186987398):1.796231688):1.386589791):0.8148531258):0.7894984036):0.1140657964):0.6420471256,t353:5.911536994):0.4426896027,t354:6.103199293):2.817050741,((t355:1.290829038,t356:1.247668429):6.569695282,(((t357:3.639627222,t358:3.523930452):2.202998472,(t359:1.331759281,t360:0.877937093):4.373394611):1.561718036,(t361:5.103160511,(((((t362:1.515064943,(t363:1.396928032,(t364:0.3869805427,t365:0.3511276332):0.5976605077):0.1091521156):0.436737873,t366:1.393499705):0.06222851962,t367:1.378043532):0.2218132693,t368:1.505311866):0.1561780962,(t369:0.5857233,t370:0.5154556371):1.013127139):2.513640747):1.311915303):0.3435669819):0.9792222795):2.524724793):0.1450911808):3.987222391,(t371:0.9702607164,t372:0.9182907914):12.36125166):3.608205186):3.323341543):12.01068427,((((t373:0.8021620877,t374:0.7310270953):0.03933421524,t375:0.6531365553):7.864233658,(((t376:3.224996389,(t377:2.854738477,(t378:2.455977353,(t379:0.7256112209,t380:0.6071097673):1.632575778):0.3602741072):0.2823409844):2.097197922,(t381:3.836414857,t382:3.819610659):1.122322019):2.85366333,(((t383:0.4357026869,t384:0.433252482):2.081876722,t386:2.297230152):4.397921179,(t387:1.131870204,t388:1.122990163):5.324000364):0.8141482406):0.3377299137):5.307866784,((t389:4.367445559,((t390:0.3856047521,t391:0.3284074807):2.456835702,t392:2.784057255):1.471163151):0.09164263017,t393:4.33239226):8.302279064):18.14417147):22.34193414,(((t394:0.8796589666,t395:0.5463018518):2.354149296,((t396:0.8530412081,t397:0.7241276291):1.445625242,(t398:1.517455083,t399:1.418187333):0.6028461556):0.5801620451):5.779268571,(t400:1.006390099,t401:0.9858885502):7.342343943):43.89901756):26.25956225,(((t402:0.07445870651,t403:0.01937273782):3.823735717,(t404:1.920479802,(t405:1.403229406,t406:1.008513896):0.4759114913):1.821096026):31.49538678,(((t407:7.299128759,((((t408:1.523198821,t409:1.518388849):2.732228058,(t410:3.454830933,(t411:2.566342572,t412:2.517242286):0.7455328327):0.7957313906):0.5821117251,(((t413:0.1939793546,t414:0.1794061922):2.535411982,t415:2.528641839):1.456059959,(t416:2.40821674,(t417:1.714806236,t418:1.690824689):0.5279885449):1.527610481):0.4093355671):0.8905421357,t419:5.025475556):1.437804664):1.329561601,(t420:0.1245142979,t421:0.1140830083):7.623606995):7.196868907,((((t422:3.677882135,(t423:2.730162606,((t424:0.1859596335,t425:0.09390661774):2.230672439,t426:2.312425071):0.2943065367):0.7745921918):5.354472431,(t427:7.262066286,(((t428:0.4269818819,t429:0.1199991192):2.980626367,(t430:2.152083094,t431:2.141466105):0.4764491528):0.9382606411,(t432:1.35438346,t433:1.327146855):2.189887608):2.753026149):1.227321977):1.274453314,(t434:3.638213304,(t435:1.92271223,t436:1.920199267):1.705178069):5.01000818):1.295542675,((t437:8.186188412,(((t438:0.5586629875,t439:0.4701619267):1.188954009,t440:1.511611833):2.456330254,t441:3.967203188):3.969024177):1.015872528,((t442:1.001362471,t443:0.9794318903):3.075541721,t444:4.012368215):4.80205183):0.7200134072):3.288020776):18.88347889):42.96946664):13.65460735):9.698016547);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T21.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
