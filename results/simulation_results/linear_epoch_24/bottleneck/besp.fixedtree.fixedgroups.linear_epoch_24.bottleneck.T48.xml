<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t490:14.45917589,(t491:3.527540491,t492:3.433830753):10.74349106):4.216417182,(t493:7.852266248,(t494:3.265908,(((t458:0.1721094931,(((t422:0.0511189765,(t412:0.03684862342,(t345:0.03793171212,((t171:0.3893039186,(t169:0.06471868369,((((t156:0.01226700042,(((t133:0.02280866025,(((t124:0.1600635682,((t121:0.1065415145,(t84:0.04673596963,(t67:0.1336134981,(t1:5.250463545,((t2:0.7422154352,t3:0.7293076843):1.631505422,t4:2.3169638):2.823863932):0.2389967388):1.627601381):3.390548903):0.3610526482,((t5:10.60521199,((t6:3.128036322,t7:3.112576552):0.4186149596,t8:3.222451315):7.047969416):0.08632233496,(((((t9:2.745296415,t10:2.65534077):3.547851641,t11:6.08381206):2.231032562,t12:8.294309646):1.440194717,(((t13:4.713188799,(t14:2.444204619,t15:2.398662363):2.018614048):2.899654961,((t16:2.338913229,t17:2.187612299):0.8784252014,t18:2.984152233):4.09262411):0.4479734423,t19:7.477599312):1.545331846):0.06687229918,(((t20:4.371267275,(t21:2.033423933,t22:1.957524945):2.30698247):2.741996817,t23:6.829688708):1.850823863,((((t24:1.479284582,t25:1.44831749):4.263316664,t26:5.558896299):1.211376666,((t27:0.7463491291,t28:0.5177988645):2.844248175,(t29:1.451675573,t30:1.435874728):1.901707882):3.036914186):1.337923738,(((t31:2.949625016,(t32:2.052069089,((t33:0.2766068106,t34:0.2468461104):1.272256081,t35:1.436970996):0.4876637484):0.8551464321):1.743197369,(t36:2.72934574,(t37:1.796545044,(t38:0.9555349737,t39:0.9331541905):0.7671955353):0.7829575214):1.709197352):2.284295142,((t40:3.765454698,(t41:0.4083176578,(t42:0.3135019383,t43:0.0131753116):0.0162227257):3.340648662):0.03559981384,t44:3.352105221):2.581927342):0.692190497):0.3609669532):0.1099918673):0.3207766668):0.01535624272):0.120689305):0.2189993564,t45:7.713449895):0.06142821567,(((t46:6.741586968,((t47:6.687987561,((t48:6.327319901,((t49:0.05953795509,t50:0.01149718975):0.03042498221,t51:0.03354580969):6.167388957):0.1563966381,(t52:1.308044903,t53:1.305236471):4.92101836):0.1382504658):0.03494956474,(t54:4.434403677,((t55:0.6225941113,t56:0.5527709352):2.754953035,t57:3.227258928):0.7512460874):1.947393939):0.001298596284):0.1268227662,((t58:5.616759012,t59:5.457090641):0.2338666515,((((t60:1.373345587,t61:1.352853806):1.277388701,t62:2.578635407):2.637520212,(t63:0.1549277967,t64:0.008752643629):4.882886238):0.2676978171,(((t65:4.211626096,t66:4.070850162):0.7505207086,(((t68:2.245916879,t69:2.097344556):0.6321065578,t70:2.58021066):1.25487643,(t71:3.372510054,(t72:0.2817149859,t73:0.1560875944):3.019075937):0.397688768):0.2202658644):0.04412603183,t74:3.76578206):0.05733123215):0.1250150853):0.1158516891):0.7757707596,(((t75:0.3487134811,t76:0.2798323587):1.904280763,t77:2.060755291):1.541388015,t78:3.567935296):1.032817349):0.0344472608):0.4170879825):0.09724980644,((t79:1.57830723,t80:1.558746738):1.861335977,(((t81:0.8454497157,t82:0.8342788698):2.240719473,((t83:2.964504789,(t85:1.636641024,(t86:1.352090556,t87:1.227391145):0.2766745396):0.9430429319):0.06451062181,t88:2.496006318):0.01740015533):0.02425701011,t89:2.04075982):0.1006436575):1.700325253):1.238011073,((((t90:3.195243603,t91:3.161924422):0.7197999267,(((((t92:0.9418634064,t93:0.9031662387):0.2944250953,t94:1.141443718):1.04688089,t95:2.088641652):0.194153298,(t96:2.037326905,(t97:1.412209491,t98:1.368641969):0.597417461):0.1168495549):0.8428473637,t99:2.777420461):0.527164338):0.5678037305,((t100:1.216851094,t101:1.116980351):0.3182384825,t102:1.316779695):2.311877844):0.06653164155,((((((t103:1.066131703,t104:0.9195148382):0.4951046545,t105:1.371066757):0.1955120993,t106:1.518241165):0.3888606984,(t107:1.058291939,((t108:0.2445837745,t109:0.1621091102):0.2278365422,(t110:0.3326375022,t111:0.09523753902):0.03147550366):0.5452709448):0.8449761999):0.4204670519,((((t112:0.629873111,(t113:0.3759482492,t114:0.05801206807):0.2170195037):0.03697656276,t115:0.1731240386):0.1851942771,(t116:0.2067356246,t117:0.1485552435):0.09432641676):0.1957895591,t118:0.3979689648):0.8402011489):0.8956296974,(((t119:0.1903419198,t120:0.1641427573):0.8832546654,(t122:0.3101499655,t123:0.2848486967):0.2644292205):0.2560720828,t125:0.5590096338):0.803686302):0.1993581966):0.4665276018):1.047131222):0.01446215962,(t126:2.754087228,(t127:0.9206374354,t128:0.8353028122):1.792152262):0.2538951172):0.05190177281,(t129:0.3229311071,t130:0.2611176623):2.38483917):0.9764391752,((t131:0.873050818,t132:0.8527977497):1.190066535,(t134:0.575296506,(t135:0.05650872643,t136:0.03851671003):0.4110000782):1.131235976):1.487966701):0.2391653761):0.5268336708):8.857096828,((((((((t137:0.8497582071,(t138:0.3294274866,t139:0.3252811044):0.473906577):0.6287109682,(t140:0.8307684576,(t141:0.6019952255,t142:0.4664761382):0.200389897):0.3162981328):0.228065202,(t143:0.3004775573,t144:0.2925749742):0.7124468778):1.011078344,t145:2.005265474):0.008592352618,t146:1.969978339):1.996729088,((((t147:0.2529428043,t148:0.2229306494):0.136556545,t149:0.141260735):1.228002178,((t150:0.9422939466,t151:0.8768469635):0.147270702,(t152:0.692308448,(t153:0.4918206759,t154:0.2549605906):0.1177699036):0.2578234351):0.072070227):0.5196253184,t155:1.170909596):1.593492607):0.2254317506,t157:2.893518248):0.6766099094,((t158:0.0555202042,t159:0.003989648849):1.779342312,t160:1.744285027):1.629582779):7.051769903):7.571240489):7.264278744):1.090938728):0.8845663024,((((((((t161:0.3204943159,t162:0.2866792533):0.3729868327,((t163:0.1735196364,t164:0.1412941072):0.1708334668,t165:0.05400429817):0.2130490255):3.828937492,((((t166:0.2225315722,t167:0.09597728566):1.985852399,t168:1.835137939):1.705768023,(((((((t170:0.6418766422,t172:0.03674725865):0.4117394531,t173:0.4185834522):0.1731874061,(t174:0.09608167254,t175:0.07764600713):0.4183826632):0.4863475108,t176:0.8524968863):0.210121471,(t177:0.5377219879,t178:0.4015323031):0.4701462049):0.3237651817,((t179:0.0539415452,t180:0.02119857551):0.6845222424,(t181:0.4125461456,t182:0.3031685868):0.08869290205):0.3375606641):1.031522431,(t183:0.5540200521,((t184:0.08729653077,t185:0.07028021354):0.2857445111,t186:0.3140388464):0.149303015):1.155004013):0.05193803751):0.0003220203418,((t187:1.079424402,(t188:0.9041482566,t189:0.6070501387):0.08367738071):0.3437670026,t190:1.029963992):0.2355087134):0.09526787897):4.970140977,((t191:1.122565501,t192:1.062517693):0.6843835314,t193:1.587124317):4.420518274):3.317264816,(((t194:1.146447159,(t195:0.4807980182,t196:0.4706276129):0.6035525063):0.5605845343,t197:1.515584431):6.031962145,((t198:3.104168792,(t199:0.9210060643,t200:0.8640784676):2.048972208):3.878074602,(t201:4.315861034,((t202:0.9165839324,t203:0.730549965):0.1440874992,t204:0.8719634411):3.244662912):2.429688307):0.4212345737):1.485281818):5.413078339,(t205:0.08066234336,t206:0.0728931764):13.72140467):3.695950857,(((t207:2.050922757,t208:1.93227508):7.618326284,t209:9.459738881):5.643923187,((((t210:0.2373518775,t211:0.1065881745):0.4813266153,t212:0.4664681207):10.54654855,(t213:7.66368023,((t214:4.819741357,(t215:4.646283702,(t216:3.296443549,(t217:1.097017185,t218:0.971693617):2.119642364):1.287636004):0.1503444115):0.7665325302,(t219:2.150005987,t220:1.939831018):2.985724627):1.594925119):3.285063023):2.112139059,t221:11.89470582):1.704713154):2.130248668):4.704507651,(t222:3.497320915,t223:3.409965552):16.85717715):0.5759080992):1.167656765,((((t224:4.279525186,(t225:2.008761532,t226:2.008181137):2.117425193):3.214343893,(((t227:0.6344863194,t228:0.6080737961):4.777393153,t229:5.340502637):0.5177729891,(((t230:2.343674543,((t231:0.6751703689,t232:0.5464589283):0.8073648238,t233:1.304854292):0.790870055):2.178907666,(t234:4.234085107,t235:4.062916577):0.02549904312):0.839948692,t236:4.875474578):0.4891512866):1.397729241):3.034001495,(((t237:1.793920101,t238:1.698391743):6.539368014,t239:8.039080843):1.020339465,((t240:5.34884905,t241:5.227179758):1.8252423,((t242:2.496740229,t243:2.28954336):2.728755914,(t244:1.386104024,t245:1.356874478):3.626380204):1.744299152):1.837242098):0.4329264515):9.380790654,((t246:11.55261622,(t247:3.281904337,(t248:1.5263656,t249:1.285888201):1.718659798):8.185717613):5.606315233,(((((t250:2.496521819,t251:2.433723133):3.685356837,((t252:1.130207261,t253:1.103794851):3.682803397,(t254:1.895488443,t255:1.710470341):2.573467233):1.277734094):4.418905992,(t256:3.447835793,(t257:2.134899736,t258:2.018537683):1.286978105):6.505165931):3.424022443,((((((t259:1.495241868,t260:1.267762556):4.906892101,t261:5.951076974):3.857640148,(((((t262:2.703590804,t263:2.480397504):0.4673897547,t264:2.705036632):1.221347574,(t265:2.379296464,(t266:1.908910319,t267:1.886940902):0.4525190122):1.404152053):1.038053552,t268:4.683643778):1.782550119,((((t269:0.1985700412,t270:0.1631560244):1.259403876,(t271:0.7963232169,t272:0.7134170643):0.5835090326):2.119482415,t273:3.088389376):0.328978359,(t274:1.539573232,t275:1.367189532):1.852828961):2.50367853):2.47349808):0.1169487502,(((t276:6.210058247,t277:6.202646119):0.7217724578,(t278:2.302307346,(t279:1.064572013,t280:1.023192715):1.009555713):4.301258006):1.00954365,(t281:5.25416441,(t282:3.380308342,((t283:1.144796048,t284:0.7198036456):1.272400249,t285:1.786361998):0.9308876103):1.735299487):2.088297106):0.2865822989):0.7521488149,(t286:4.351842603,(t287:1.745441579,(t288:0.4746851456,t289:0.4633066384):1.090788809):2.586597823):3.119668413):1.722885821,((t290:7.436453981,((t291:3.188801062,t292:3.171603139):3.062026845,(t293:1.600007293,t294:1.563532212):4.582986674):1.164872473):0.02218772572,(t295:0.4622700579,t296:0.2372492283):6.711788743):1.491070393):0.3499543351):2.255356588,(t297:2.43099414,(t298:1.640370006,t299:1.634298132):0.7401614602):8.59618199):0.007873391521):1.092315468):2.026104111):1.026653215):0.9939635067,(t300:3.835267323,((t301:1.436687219,t302:1.435727439):1.789582162,(t303:2.484308489,(t304:0.9334865337,((t305:0.2305159237,t306:0.05983821522):0.3533018135,t307:0.0377562777):0.314817809):1.441229628):0.6251351886):0.5534577319):12.04605201):4.784300535,((t308:0.9133169156,t309:0.7853424068):1.940859736,(t310:1.75475994,(t311:0.3859295563,t312:0.3843908904):1.366968476):0.9078255664):16.87988781):1.392050332):4.506528041):10.5381402):58.28487816,((((((t313:2.76343158,(t314:0.2860904563,t315:0.2115751783):2.437622014):5.184665134,((t316:3.289773423,t317:3.164942966):3.494309202,(t318:5.121036856,(t319:4.84225406,(t320:0.9735746956,t321:0.9610620792):3.850941178):0.2081907998):1.510419077):0.9665367925):10.56501816,(((((t322:0.6962100742,t323:0.6431956063):2.084991215,t324:2.525697485):3.460267643,(t325:0.3640105478,t326:0.3064367534):5.591528105):1.902504711,(t327:2.290042278,((t328:1.303983755,(t329:0.9240946915,(t330:0.604044775,t331:0.5548466732):0.2776441026):0.3750091472):0.2760548798,(((t332:0.5752433634,t333:0.3466490691):0.04125410457,t334:0.3436573569):0.09812463626,t335:0.2831385296):0.7463603059):0.5586080093):5.498232064):0.4304746435,((((t336:1.708174913,t337:1.675082468):2.77874676,t338:4.387807491):1.942611484,(t339:4.802465014,(t340:0.1175435244,t341:0.08010841883):4.664223216):1.479575624):0.7509116693,((t342:2.57850206,(t343:1.686753424,t344:1.666751636):0.826266468):0.5646574093,t346:2.746690308):3.826106031):0.2750958112):9.290448269):3.147754137,(((((t347:1.657753093,t348:1.620900351):0.8390694842,((t349:0.9040832193,t350:0.858901604):0.6478941137,t351:1.458905462):0.8025002248):4.471499208,(t352:1.25543289,t353:1.202112005):5.247347371):2.463386479,(t354:4.252280212,t355:4.241290171):4.258073414):0.220119904,t356:8.691381358):9.581807934):21.779759,(((t357:7.86307306,((t358:2.927948908,(t359:2.389847603,t360:2.275438808):0.4482532944):0.1975804262,(t361:1.624408401,t362:1.592302596):1.288363057):4.731326386):4.115273186,((t363:2.470864088,(t364:0.5560370361,t365:0.4316717306):1.811610976):8.210932162,t366:10.20053536):0.9943825019):20.06315461,((((t367:5.40838238,(t368:4.053383588,(((t369:1.019201781,t370:0.9109671293):2.251341423,t371:3.103448223):0.1738380218,(t372:1.00873806,t373:0.9815689246):1.943996498):0.4738825231):1.246079833):6.240830202,((t374:7.916757715,((t375:3.921201976,t376:3.80818787):2.441253405,t377:6.190148302):1.412600478):2.424860602,((t378:3.73130624,t379:3.521216499):3.486274844,(((t380:2.50072471,t381:2.415788836):2.473168076,((t382:0.3555807423,t383:0.3522332188):3.265384779,t384:3.348416938):1.129862908):0.9039196084,(t385:2.346397011,t386:2.095299974):3.027145669):0.9374066638):2.769914776):0.5121628304):0.1420098176,(((((t387:0.2201458753,t388:0.1790086969):0.6820846161,t389:0.6528067738):3.028680065,t390:3.585258082):2.104837781,t391:5.592950217):1.950285302,(((((t392:1.156109557,t393:1.147476933):0.3349190742,t394:1.357573356):2.962550897,((t395:1.209550036,(t396:0.7589443876,t397:0.7466702904):0.4249294197):0.7801266318,t398:1.901295141):2.228464537):0.7576617326,t399:4.838783386):1.220032423,(t400:3.014497576,(t401:1.885792025,(t402:0.8008968531,((t403:0.2365444349,t404:0.1363084232):0.3867198433,t405:0.2269949348):0.1687935875):1.048662099):1.117281822):2.952004328):0.9985963563):1.450168683):2.474998237,((t406:1.295544605,t407:1.188509613):7.381962794,(t408:4.167139234,t409:4.151396311):4.388379806):1.349602657):16.67527013):7.888679864):3.894470056,(((((t410:1.158646377,t411:0.9334362799):4.775391084,t413:5.601271606):1.458921727,(t414:3.877646623,t415:3.796216653):3.124972093):0.1655497432,((t416:1.501051249,t417:1.383120341):0.6833307031,(t418:1.546888843,(t419:1.283096218,t420:1.26185778):0.1251445007):0.2096510143):4.842710013):8.814465827,(((t421:3.096638011,t423:2.855533056):0.4763524826,(t424:0.6570503636,t425:0.6388261359):2.673612759):0.2966670618,t426:3.605309):11.214604):21.75635296):46.82788568):8.4485507,((t427:5.478880826,((t428:1.625422207,t429:1.564810407):2.375848426,t430:3.875312463):1.462317432):62.10358183,((((((t431:1.50732691,t432:1.458028637):0.3471452354,(t433:1.618719453,t434:1.539914355):0.04693129887):5.821773106,(((t435:5.689255163,((t436:3.513625806,(t437:1.059063054,(t438:0.282108138,t439:0.1969671782):0.7564023337):2.145614446):1.588133347,((t440:0.5272341405,t441:0.5114022993):2.764300982,(t442:1.464971669,t443:1.441215914):1.697949389):1.315744004):0.5634619028):0.5243762843,(t444:4.528934747,t445:4.404188236):0.8474719828):0.07645190466,((t446:0.768987222,t447:0.7525925715):0.3255285156,t448:1.046309115):4.229901973):0.967221722):0.5966919233,(t449:0.4821333464,t450:0.3929687122):6.325643641):2.801493593,(t451:2.719487607,(t452:1.776623452,t453:1.746959323):0.7446284642):6.794308376):26.73142147,(((((t454:3.25624322,t455:3.095934805):2.637358929,t456:5.640682745):3.208697517,(((t457:4.295037946,t459:3.883006807):0.3012244933,t460:4.095747358):1.523993205,(t461:4.487117849,(t462:2.403272201,t463:2.181913682):1.913852398):1.111618562):2.698859804):13.31002162,((((t464:0.3678510826,t465:0.2994832712):1.64245405,t466:1.72479494):4.820687092,t467:6.509067558):2.817300393,((t468:1.581900072,(t469:0.239610833,t470:0.1653940155):1.16864463):0.5010882228,(t471:0.3359130097,t472:0.2115484674):1.486442958):7.197613776):11.44872021):12.1837561,((((t473:7.154556417,t474:7.030415021):0.1726909656,(t475:1.755010076,(t476:1.260886985,(t477:1.077400995,t478:1.058638918):0.03360659259):0.4658808966):5.36623601):2.271762235,(t479:2.004186324,t480:1.886687055):6.951724984):8.765660085,((t481:4.588659139,(t482:2.545131838,(t483:0.9927335659,t484:0.629184718):1.519659555):2.035631374):2.410385486,(t485:3.39390468,(((t486:0.9686774708,t487:0.8754569123):1.306005422,t488:2.109555243):0.9348028959,t489:3.036861442):0.06745192667):3.085525517):10.51420367):13.8267605):1.416900434):29.41759562):24.13070897);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T48.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
