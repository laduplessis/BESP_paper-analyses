<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t426:0.2309517365,t427:0.09067707861):0.7125898573,t428:0.4981115139):16.12805017,((t429:1.152564497,t430:1.046820759):2.406299184,(t431:0.8468732975,(t433:0.3572900298,t434:0.3416878798):0.4208590858):2.498780016):13.03534574):7.664032333,(t435:9.890446142,((t436:0.2921095316,t437:0.08854925098):5.93686111,(t438:5.43725397,(((t439:1.409257142,t441:1.219107182):3.563876176,(t442:2.407162935,t443:2.338824731):2.327175823):0.1863146831,t444:4.850817479):0.1013163788):0.5865059821):3.554979247):14.04453945):9.051113037,(((t445:2.071056574,((t446:0.04478554647,t447:0.02869683909):1.88127737,(t448:1.235749558,t449:0.9207883113):0.6087350562):0.09655161854):0.4453119209,t450:2.040844267):1.491838386,(t451:1.080121846,t452:0.8801013336):2.330062417):27.96183192):35.30530728,((((((t453:0.5762050678,t454:0.4579562731):1.046453035,t455:1.446590902):0.9056620042,t456:2.349310015):4.099170707,(t457:2.23814118,t458:2.19616803):4.194866811):1.955584889,t459:8.303622108):0.2657279738,t460:8.524502854):57.6262508):44.03407048,(t461:0.5273019784,t462:0.4404128791):109.6389424):231.9164494,(((((t463:1.228391063,t464:1.101368779):0.06347639639,(t465:0.8359024272,t466:0.7880711531):0.2552389119):21.26124741,((((t467:1.346384372,(t468:0.4564674263,(t469:0.3824662283,t470:0.265221518):0.07062112522):0.8427987699):3.897609474,(t471:4.884949506,t472:4.467266003):0.1147680607):4.949209062,(t473:2.6954286,t474:2.437437255):6.656360328):5.975949352,(t475:0.7582189239,t477:0.4051631464):14.26564977):6.071570992):28.37971234,(((t478:3.96242573,t479:3.954358205):4.474294533,((t480:1.955779272,t481:1.940438343):0.3783222712,t482:2.206956299):5.964541369):3.46930945,(t476:0.2585870918,((((t440:0.06019217337,(t432:0.006102352947,((t411:0.4610420555,(t412:0.22428282,(t388:0.1651308213,(t376:0.1767539668,(t349:0.02292805457,(t342:0.01764147479,((t313:0.006581853956,(((t274:0.003769224767,(t249:0.05058191097,(t243:0.04195700487,(t212:0.1041511012,(t196:0.08110036316,((t169:0.1526310927,(t161:0.02885369531,((((((((t113:0.2202167012,(t111:0.140497111,((t100:0.6545814279,t101:0.2314254282):0.004996037635,(t102:0.1272210882,((t1:8.14567647,(((t2:1.972893428,t3:1.688044546):0.5162301219,t4:2.155535516):2.444349972,t5:4.593766723):3.045031325):1.560796039,((t6:4.396858005,t7:4.263844998):3.265996013,t8:7.245312709):1.535495762):0.3495855338):0.07371231044):0.647244178):0.387780612):0.07501939831,(t9:9.794017892,((t10:9.080132945,t11:9.055748843):0.3905178951,(((t12:4.949620871,t13:4.672630956):0.59950801,(t14:2.293769494,(t15:0.4128164185,t16:0.4026183101):1.832760837):2.858072463):0.0118462208,(t17:0.9747908973,t18:0.9095184948):4.024814464):3.84081322):0.3175894121):0.4780697665):0.2596020013,(((t19:0.543921681,t20:0.5068885761):1.76727411,(t21:1.699708117,t22:1.604177396):0.4670609043):6.377658645,(((t23:1.670443559,t24:1.632082527):6.054755425,((t25:5.978099346,t26:5.91032843):0.4419450944,(t27:2.496292785,t28:2.468749903):3.801087849):1.263979708):0.07264268253,(t29:0.7979454407,t30:0.6696159639):6.500759931):0.6185246159):0.7853853005):0.07114796406,((t31:7.007948991,(((t32:0.7778192659,t33:0.6991967278):0.5370470541,t34:1.233836373):4.322492651,(t35:0.4054504229,t36:0.3222912347):5.085723921):1.038415208):1.034783821,(t37:4.706544258,(t38:2.271583107,(t39:1.255197794,t40:1.221178852):0.9560903587):2.409106315):2.46506601):0.5482739745):0.1931867954,(((t41:1.807041848,t42:1.596736687):4.514249914,((((t43:4.519985408,t44:4.37664808):0.7559286617,((((t45:1.470421851,(t46:0.3573714016,t47:0.3438201133):0.9883308636):2.160887938,t48:3.45226399):0.8822258051,t49:4.328226083):0.5902442213,t50:4.899549198):0.02677562236):0.520237509,((t51:1.793984617,t52:1.757598382):0.8429196191,(t53:1.167177141,t54:0.9620669714):1.355715715):2.801321717):0.09658613898,((t55:0.9121218959,t56:0.8299824555):3.998491636,((t57:1.105868164,(t58:0.6793185436,t59:0.6361414051):0.3854163391):1.949200415,((t60:1.039701193,t61:0.8622682387):0.9373618109,(t62:1.084222487,(t63:0.9790217223,t64:0.9690135771):0.08825213841):0.6579548019):0.7712156661):1.767952255):0.02057096459):0.1915537044):1.050790183,(t65:4.078807907,(t66:2.990259502,t67:2.85832734):1.054265938):1.374017136):0.3875771688):0.2361679351,(((((t68:1.947305014,t69:1.919251385):1.921795327,t70:3.718365379):0.4348418994,(t71:4.070526155,(t72:2.102477884,t73:2.092224475):1.566415312):0.08042594105):1.09717173,((t74:4.506171524,(t75:2.878079821,t76:2.839235962):1.539678569):0.2933100745,(t77:0.7190919012,t78:0.6973037991):3.7601488):0.007059980608):0.2467917414,(((((t79:0.7175935447,t80:0.6882955209):2.5948324,(t81:2.563469666,t82:2.555346841):0.5794914298):0.1358715486,(t83:1.52966837,(t84:1.07223812,t85:1.0555015):0.2277143195):1.689272452):0.5851642068,((((((((t86:0.3151412188,t87:0.1479773932):0.1060980426,t88:0.1508495955):0.6573170959,t89:0.8053788491):0.2230209998,(t90:0.8605328913,t91:0.7604167241):0.1042143765):0.5950899897,t92:1.443341688):0.1142650136,(t93:1.035122258,t94:0.9901374479):0.1574562581):0.2372782087,(t95:1.254751584,t96:1.204052674):0.08675458083):0.8545061805,(t97:1.193205146,t98:0.9732390148):0.8009934246):0.396505216):0.1010883647,t99:2.04588604):0.3896353794):0.1772263893):0.1206838797,t103:1.850750427):1.813865765,(((t104:3.19452686,((t105:0.1633048006,t106:0.09939036698):0.367785024,t107:0.4350950983):2.624530594):0.1437763102,(t108:1.442941386,(t109:0.6949529005,t110:0.6365253785):0.7136312882):1.699147158):0.1472703765,((t112:0.9221802086,t114:0.3307757729):0.3030049289,t115:0.6143795702):1.817165227):0.1119653053):1.864989952):0.3735185116):2.314427161,(((((t116:0.8695323053,t117:0.8142819628):2.899373948,(t118:1.607621016,t119:1.339714644):2.010191281):0.5559739587,(t120:2.459248524,((t121:0.5300588586,t122:0.5260911627):1.139841401,t123:1.464264618):0.7393654808):1.412632609):2.024384112,(((((t124:0.5276965533,t125:0.4190791735):0.438834374,(((t126:0.1021960281,t127:0.0479045386):0.1782516374,t128:0.1084429127):0.1147755307,t129:0.06407032873):0.3532823201):0.05789379291,t130:0.4545170238):0.6090948192,t131:0.9539157495):0.9829788357,t132:1.622763776):2.8754501):0.6946442523,(t133:0.4433877177,t134:0.3937678675):4.675575541):0.05075105998):0.6850927347):2.11996619):2.74961806):0.2487896587):2.260152093):0.3773681672,((((((((t135:0.4879729226,(t136:0.1095803022,t137:0.09715715059):0.2891323123):0.3655305485,t138:0.6772493225):0.3640473981,t139:1.033410757):1.129427329,((((t140:0.32726072,t141:0.1870127747):0.2396210607,(t142:0.1190466961,t143:0.06568615427):0.3030326698):0.1396268528,(t144:0.1312077114,t145:0.07865965256):0.1354488908):0.1258354968,t146:0.229444198):1.266487757):0.533801387,((t147:0.5810880417,t148:0.5296264833):0.6399251484,t149:0.9547217943):0.7059293602):0.3053907997,(t150:1.278936157,(((t151:0.5391629293,t152:0.4623365669):0.02018863039,t153:0.4781516757):0.4620994043,t154:0.9143739656):0.1728582745):0.5548958894):0.5786713918,t155:2.028398689):3.643478506,t156:5.646771934):6.055494744):0.5911878321,((((t157:1.451101064,(t158:1.33576865,t159:1.296494865):0.0941780831):1.416627971,(t160:1.137021199,t162:1.051653773):1.530426915):0.4380046393,(((t163:0.2285951106,t164:0.1805653288):0.6560438078,((t165:0.1999194082,t166:0.184617356):0.1380135053,t167:0.2641914942):0.4894837103):1.012906611,t168:1.754567265):1.072518796):7.714079788,((((t170:0.2640211244,t171:0.07171270826):1.124284323,t172:1.127036425):0.0933616047,((t173:0.1594658561,t174:0.05956553217):0.03718443577,t175:0.02395140104):0.7249325381):8.239885657,((((t176:0.854782688,t177:0.8347863611):0.4075291319,((t178:0.2840090323,t179:0.04647897868):0.4666468382,t180:0.3022322385):0.4870063765):0.2971165486,t181:0.9499721125):1.164766377,t182:1.984383992):6.177166114):0.4813074929):0.9662033929):3.028885364):0.9029167556,(((t183:0.7109571729,t184:0.6318059309):0.226029838,t185:0.8347231612):10.19586288,((((t186:0.581779172,(t187:0.4333127355,t188:0.2269903491):0.08649220534):0.2527678355,t189:0.4309226234):0.462532841,t190:0.7889004526):7.839273553,(t191:0.6452632555,t192:0.6349656278):7.816845819):1.794635776):2.407467745):2.90047708):0.735744105):2.461474864):1.301452863):2.799085598):0.1182089447):1.162204374,((((((((t193:0.8876928227,((t194:0.1759509539,t195:0.1655669884):0.4405092504,t197:0.3644932249):0.0470879799):0.04288491096,t198:0.3657067605):9.223131162,((t199:2.915223383,t200:2.672926752):4.877927846,(t201:2.940732555,t202:2.822041396):4.590109564):1.729192617):2.81982154,((((t203:2.254777077,t204:2.211399678):1.641831195,(t205:1.82501539,(t206:0.7622228988,t207:0.742832706):0.9826310419):1.8466614):0.906882092,t208:4.415529124):6.61018577,(((t209:1.688502362,t210:1.555551464):6.445705168,((t211:0.5160324721,t213:0.3236189711):5.674358103,t214:5.972110012):1.572240858):0.5961932976,((t215:2.936475943,t216:2.811407625):1.059085345,t217:3.816190677):4.135977047):2.227605716):0.02890493659):1.503524405,(((t218:0.4853773137,t219:0.369646716):5.544350144,(t220:4.158621592,t221:4.095816924):1.597395719):3.604514165,((((t222:3.011650632,t223:2.976379173):3.239761778,t224:6.156522129):1.053813171,((t225:0.7689794578,t226:0.7294939311):3.145242765,t227:3.828446532):3.177447154):1.304373894,(t228:3.736860097,((t229:0.3881924861,t230:0.264420461):1.656004483,t231:1.837454109):1.643969085):4.333759738):0.5586476583):2.068758546):5.975357266,(((t232:1.461883348,t233:1.251291457):12.7568769,((((((((t234:1.013769564,t235:0.9314039393):1.647110685,((((t236:0.720377037,t237:0.7090282307):0.9195377888,(t238:0.1134179229,t239:0.08182030532):1.380760413):0.1066429591,(t240:1.235075448,t241:1.166055748):0.3119128375):0.1266535129,t242:1.601517981):0.5317275847):0.1803566437,t244:2.226803655):1.989565758,t245:4.137578278):1.788296458,((t246:4.539209121,((t247:2.251932611,(t248:0.2752129641,t250:0.1835789043):1.92450953):0.4654008556,t251:2.44111867):1.818184922):1.161059918,(t252:4.539318032,((t253:0.816861286,(t254:0.5575937837,t255:0.5483499331):0.2347158057):0.2536237898,t256:0.9776525194):3.433557821):0.7548157431):0.1968978601):1.314891767,(((t257:1.939677005,t258:1.866067555):1.57828915,t259:3.385835505):2.27387773,(t260:2.167065596,t261:2.087358625):3.396603795):0.7334276953):0.3930294614,((t262:2.889293942,(t263:2.623000983,(t264:2.232321213,t265:2.215874932):0.04523784535):0.1687202511):0.5993881929,(t266:0.7844852757,t267:0.6816888641):1.94109691):2.914803512):1.590549424,(t268:4.947625879,t269:4.946308598):2.09484121):3.867806698):0.150703172,((t270:2.162837163,t271:2.141096638):3.73414944,((t272:3.143197265,t273:3.089583666):1.293806573,t275:4.090544426):1.379670667):5.096984997):1.899735155):2.127550181,((t276:11.11561457,(((t277:7.67659727,(t278:3.159250866,t279:3.099185411):4.471843517):0.9019711106,(((t280:3.689733338,(t281:1.172200839,t282:1.105722269):2.462436112):2.261239875,t283:5.715639482):0.9292034409,(((t284:2.961351273,(t285:2.025736428,t286:1.909591044):0.9347881614):2.190893604,(((t287:1.312893903,(t288:0.09093990943,t289:0.008275377309):1.153959758):1.356624124,t290:2.192764643):1.674284248,t291:3.849273048):0.6907554441):0.4086965856,(t292:0.2517265399,t293:0.07652922866):4.665089953):0.894780778):1.434331629):1.802694165,((t294:4.022995043,((t295:2.733677578,(t296:0.9144517507,t297:0.7374562694):1.660354804):0.5383343773,t298:2.792942866):0.6716401242):3.864727986,(t299:7.040710253,((t300:2.532093699,t301:2.519640719):2.581878143,(t302:3.085596234,t303:2.814828145):1.955273921):1.916629538):0.1400958836):0.8975881387):0.5679659401):1.673002955,t304:9.954087092):1.791299323):0.7789371589,((t305:3.160206833,(t306:0.6226316071,t307:0.5578484912):2.51856172):4.534286262,t308:7.546841942):4.58830195):0.747254155):0.3895436466):0.6387364673):0.7690491518,((((t309:0.5219187253,t310:0.372684307):6.551462425,t311:6.870047347):0.1628188842,t312:6.955675829):6.60837028,t314:13.36971757):0.7270626347):0.6050132716,t315:14.38227525):1.204378292,(((((t316:2.375499635,(t317:0.8076566239,t318:0.7483185688):1.459406822):3.745697935,(t319:2.720219438,(t320:2.069983835,t321:1.686486044):0.4723624877):3.197857984):5.066584616,((t322:4.429246918,t323:4.283505665):3.192395754,((((t324:1.506267676,(t325:1.345328826,t326:1.153135882):0.1266133358):0.03151009665,t327:0.8980884261):0.9535376967,(t328:0.4106024675,t329:0.4050984293):1.4300714):3.967291432,(t330:4.231223636,t331:4.12001143):1.44737589):0.9334144174):2.777949824):1.894079147,((t332:4.621433034,t333:4.54734011):1.912889556,((t334:2.299356673,t335:2.172021182):2.936056949,(t336:4.344765621,(t337:0.9213173117,(t338:0.4711792544,t339:0.2753951671):0.3915097901):3.291280728):0.6593506702):1.037141767):4.444618797):1.142068037,(t340:1.862736028,t341:1.81068841):9.329179375):1.106391242):1.101757455):11.94046343):37.20853396):65.93818768,(((t343:8.789533139,(t344:7.369595477,(t345:1.479801142,t346:1.460096702):5.723930115):1.412753212):3.804649106,((((t347:0.2619926693,t348:0.2229619703):7.148335835,t350:7.098889892):0.8177303092,(((t351:1.469466198,(t352:0.7766988611,t353:0.6659628035):0.6795350121):3.567402011,((((t354:2.003415974,(t355:1.653150791,t356:1.645615539):0.2446739719):0.7708181963,(t357:0.4022143841,t358:0.2701425859):2.183935277):0.2042925579,(t359:1.824677701,t360:1.557146014):0.7943439026):1.123354712,(t361:0.4429702785,t362:0.3573648016):2.681398778):0.7988535786):0.3602887183,t363:4.142682713):2.313027781):3.23528872,((t364:2.113664723,t365:2.08264463):2.343422662,t366:4.4152969):5.09770651):0.820118475):60.28349442,(((((t367:2.607937821,(t368:0.6183338392,t369:0.6172236063):1.988148759):5.083902778,(t370:4.282807731,t371:4.171717798):3.384701334):4.680344084,(((t372:2.193800238,t373:2.162319014):0.6892248291,t374:2.831538191):1.355617226,((t375:0.4300351,t377:0.1127471045):0.6003814388,t378:0.5854957657):2.98976879):7.955333357):2.174510192,((t379:7.38037092,((t380:5.155216553,((t381:0.9188521673,t382:0.8888429908):2.741677752,(t383:3.046931111,t384:2.977016788):0.4754643243):1.247731346):1.3811212,((t385:2.559664899,t386:2.481270593):1.762425582,(t387:4.121121537,t389:3.88473878):0.09214440694):1.595266688):0.7702316029):5.089888532,(((t390:1.260211791,t391:1.188096527):3.493717263,(t392:3.611331232,t393:3.554338764):0.9024456705):5.297558083,((t394:3.83173321,t395:3.79608741):3.979489544,(((t396:1.287982169,t397:1.165833157):0.9143638218,t398:2.038900558):4.041866916,t399:6.059329358):1.270231736):1.821533937):1.250809704):1.121294032):10.81037586,(((((t400:1.782199624,t401:1.706110633):6.093711585,(t402:1.258856852,t403:0.9919934034):6.495672504):0.5767821991,((t404:3.088090808,(t405:0.7651936273,t406:0.7629190819):2.270668206):0.6102978081,((t407:0.3823521491,t408:0.2932449565):0.9509436353,t409:1.103100667):2.297593826):4.293180578):4.100590465,(((t410:1.131688013,t413:0.5674817588):3.475625932,(t414:2.008504435,((t415:0.5298050212,t416:0.441620007):0.8375339071,(t417:0.574874334,t418:0.5206219763):0.6668698862):0.6263730697):1.953459683):3.891015276,((t419:1.07634264,t420:1.061543071):3.744219323,(t421:2.253890369,t422:2.233075457):2.537637475):2.827358214):3.141150364):1.071016866,(t423:5.061848664,(t424:3.799881426,t425:3.726800313):1.211382106):6.416472728):8.315274507):45.19979059):55.27877927):224.903021);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T17.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
