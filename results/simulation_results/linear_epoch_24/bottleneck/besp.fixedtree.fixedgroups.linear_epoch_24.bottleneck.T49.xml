<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t477:0.9010475092,t478:0.7238562731):0.7015636256,t479:1.314747411):5.88569472,t480:7.111475087):16.74320561,(t481:12.15684464,(t482:10.34535815,((t484:5.942210371,t485:5.898840462):2.094340905,((t486:2.468497484,((t487:0.6112248222,t488:0.4820933509):0.209307305,t489:0.6691540586):1.345333911):1.39134157,(t490:0.7557050404,t491:0.724004989):2.526581947):4.12594431):2.060465618):1.748758992):11.66362511):27.29507229,((((t492:6.298459206,(t493:1.384973936,t494:1.330292269):4.900936932):2.566751363,(((((t495:1.424766296,t496:1.260494881):2.175020998,t497:3.400952971):0.1111215055,t498:3.432563513):2.641717822,(t499:0.1270900006,(t483:0.2075225602,((t467:0.2181269781,(t450:0.1326304849,(((((t313:0.04336411053,((t220:0.03946833512,(t206:0.015556902,(t188:0.1723064101,(t189:0.05051307835,(((t172:0.06381606672,((t150:0.004931746031,(t145:0.006060610014,((((((t42:0.1660081452,((t1:1.544031412,t2:1.531761479):0.8737195854,t3:2.236291416):1.074331734):7.100709184,(((t4:5.034478438,t5:4.926876697):1.139162837,t6:5.899305147):0.9853135956,t7:6.728835265):3.132450856):0.1592258612,(t8:7.931565402,((t9:2.703711244,t10:2.66111544):2.85376383,t11:5.503777691):2.371480129):1.795225984):1.146945356,((((t12:6.786557228,(t13:1.64152115,t14:1.428883038):5.08452761):2.467269521,t15:8.810659803):0.1925654896,(((t16:2.646576997,t17:2.640941784):4.155657043,t18:6.7350761):1.86408983,((t19:6.676180837,((t20:3.035228705,t21:2.958282268):0.1493742228,(t22:0.1312115412,t23:0.1016501873):2.952548197):3.410348516):1.466326778,(t24:1.536333408,t25:1.496366707):6.331279727):0.436093382):0.2259693923):0.4555724493,(((t26:8.295049063,(((t27:1.473183776,t28:1.466813242):3.067485513,(t29:0.460263986,t30:0.2932021924):4.01792516):3.348459897,(((((t31:0.6090787304,t32:0.4752241922):2.658450652,(t33:1.223062309,t34:1.053253763):1.908777939):0.9271277974,t35:3.802114563):3.31225342,(t36:6.66477181,t37:6.617802654):0.4245465122):0.04962649628,(t38:4.155167911,t39:4.137908197):2.814705742):0.01234869259):0.3219234869):0.3745720263,((t40:5.293028763,((t41:0.98037742,t43:0.5736717965):1.867466036,(t44:1.59840104,t45:1.578890891):0.8353176028):2.42907337):2.172181677,t46:6.987490054):0.1446636142):0.1461387348,(((t47:2.885168308,(t48:2.527940542,t49:2.441349555):0.3314684935):1.028055695,(t50:1.765068072,t51:1.619036796):1.962949023):2.596229987,(((t52:2.934716415,t53:2.869405772):0.2464048837,(t54:2.816476926,(t55:1.928471302,t56:1.778943506):0.797003979):0.1601059551):0.1204200381,t57:2.65865558):2.769046499):0.6802253181):0.05422659906):0.9022905794):0.6491916824,((t58:4.250886629,(((t59:0.07297818212,t60:0.007313568499):3.439429677,(t61:2.070949516,t62:2.02983262):0.6994868259):0.2743501449,t63:2.913060803):0.4040274904):1.550679927,(((t64:0.7628461508,t65:0.7401603035):3.309032589,(t66:0.8413355447,t67:0.817394513):3.038067231):0.3428532738,(((t68:1.400371156,t69:1.272536676):0.06603463293,(t70:1.071319503,t71:1.042491993):0.1860006919):2.626977294,((t72:2.640220729,(t73:2.294084845,(t74:1.061891541,t75:1.011752849):0.9022563044):0.1969854442):0.4341239743,((t76:1.540782626,t77:1.394462844):0.7993721738,(t78:1.851351623,(t79:0.1284346668,t80:0.08616858061):1.479597187):0.3411569303):0.1608624431):0.6961354174):0.08101594008):0.3381656196):1.732712381):0.06670397347,((t81:1.454201901,(t82:0.8055171778,t83:0.7039674606):0.6443621506):3.30463026,((t84:2.388371857,((t85:0.4274680447,t86:0.3982892944):1.864043824,((t87:1.993983602,t88:1.982701785):0.1444614993,(t89:0.4449729264,t90:0.4090803751):1.577116793):0.0238159687):0.0619165902):1.53688944,((((t91:1.888336204,(t92:1.806890383,t93:1.586021529):0.0546977383):0.5495286914,t94:2.185308991):0.4807605665,((t95:1.726002981,t96:1.710011382):0.130904078,(t97:1.161753337,t98:1.148249229):0.6297323165):0.7775832635):0.2417145996,(t99:2.064522567,(t100:1.908322981,t101:1.900028074):0.05672226745):0.5529047925):0.4471899699):0.6018224151):0.2125131561):0.02800430956):0.4775307989):1.131540441,(((((t102:1.265931293,t103:1.118312521):0.9570845051,t104:2.000866683):0.9436373033,(((t105:0.8519859681,t106:0.7971221822):0.1371525425,t107:0.8621659275):1.295388326,((t108:0.5040027666,t109:0.3521063499):1.213835725,(t110:1.432147815,(t111:0.7374039108,t112:0.6402951048):0.4538317457):0.04583796667):0.4016171472):0.5829779363):0.93091417,(((((t113:0.7586428305,(t114:0.4546051582,t115:0.4249465361):0.2643949564):0.3566548536,t116:0.8585981439):0.5207035803,((t117:0.2022185333,t118:0.1840472284):0.47416741,t119:0.6175833652):0.5303053746):0.3099098513,(t120:0.4018935996,t121:0.3655386686):0.9742401074):0.8796350296,((t122:0.1085937733,t123:0.1053889884):0.3453689449,t124:0.2947647842):1.718338958):0.1672276698):0.5704846457,(t125:0.2623192391,t126:0.2450971098):2.214094729):0.6727913499):1.388036392):0.4327743416,((t127:1.608258552,(t128:1.216657984,(t129:0.1722718009,t130:0.1578289202):1.033593606):0.3710403071):1.379158097,(t131:1.438508853,(t132:0.1223895338,t133:0.01417557592):1.151674602):1.457491529):1.842571858):0.6763385444,(t134:3.479622204,(((t135:0.9006070453,t136:0.8570593205):0.1099324977,(t137:0.3929077628,t138:0.3474948582):0.5409419339):1.773224373,((t139:0.4031708836,t140:0.2087351195):1.217693296,t141:1.370941202):1.014913977):0.6383733043):1.520146976):0.5879600539):0.08734260188):1.472533621):0.9413482047):1.682362302,((t142:3.88492733,((((t143:0.3136191768,t144:0.2917691185):1.391233665,((t146:0.1290668049,t147:0.1011844449):0.452516065,t148:0.498168468):0.6853976184):0.4766357211,t149:1.56248793):1.564682818,t151:2.666509786):0.06654886753):2.846579083,(((t152:0.4525181322,t153:0.4477096942):0.04692222285,t154:0.4843096778):0.8502835824,(t155:1.277846509,t156:1.24185296):0.05309131162):4.019741419):2.551738283):7.510336931):5.544327039,(((((((t157:0.7451394733,(t158:0.1084541203,t159:0.02422867336):0.5974555404):0.2472125366,t160:0.8401204102):2.070218854,(t161:1.269112131,t162:0.9471448527):1.481937947):1.26445139,(((((t163:0.2281331901,t164:0.117800145):0.976163892,t165:1.092220853):1.159507727,(t166:0.9320530265,t167:0.5847173214):1.092797545):0.3137346032,(t168:0.2550362584,t169:0.09791564641):1.726892423):0.6267659272,((t170:0.3389539142,t171:0.253357648):2.05582836,(t173:1.404893015,(t174:1.170963787,(t175:0.07752303561,t176:0.04644556824):0.9538867014):0.2223129734):0.3145838082):0.04469720548):0.3603383839):0.8926573391,(((((t177:0.2403237768,t178:0.128880103):0.2471440195,(t179:0.0814996133,t180:0.08145619876):0.2792395635):1.034517979,t181:1.390312413):0.8777508501,(((t182:0.1771705866,t183:0.02630557893):1.119606521,(t184:0.7676722556,(t185:0.644011524,(t186:0.553843959,t187:0.4550229671):0.03120707182):0.07799293621):0.1355724183):0.136152587,((((t190:0.1357526035,t191:0.1305570264):0.1426570794,t192:0.2162326055):0.02173790953,t193:0.2250629592):0.03231008122,t194:0.1397351068):0.2042541237):0.6948000652):0.1872561649,t195:1.140131795):0.1680766221):0.3158568362,(t196:1.419538361,((t197:0.5400450847,(t198:0.1123455442,t199:0.01491075573):0.2720313922):0.2203762108,t200:0.4543540388):0.5983364971):0.1919361169):0.5084246576,t201:1.555526023):14.72416956):3.628329883,t202:19.84861385):0.2467163669,(((((t203:6.569639117,(((t204:0.4395576712,t205:0.2867640798):3.205507737,(t207:2.122107073,(t208:0.1468216307,t209:0.108201671):1.936244692):1.179371744):0.5821801419,(t210:2.671255783,((t211:0.09169129019,t212:0.05086823383):1.536738839,t213:1.564463926):1.041027366):1.078066839):2.213230617):1.162440931,(t214:6.597581882,(((t215:0.07139345549,t216:0.001007120698):4.125264809,t217:4.033255069):1.899384912,t218:5.762698617):0.4925779246):0.4523210451):1.009470888,((t219:0.1944959278,t221:0.0553554662):6.435099681,(t222:2.995045203,t223:2.946818875):3.46122905):0.9043360767):0.8965594876,t224:8.004218291):6.484039986,((t225:9.199349849,(((t226:5.201842265,(t227:3.09141165,(t228:2.20182201,t229:2.053791408):0.7878061347):2.069052447):3.31072647,((t230:2.915020711,t231:2.896165689):3.656277859,(t232:4.326962533,t233:4.107537549):2.105811414):1.532954639):0.60223877,(t234:6.478986726,(t235:0.6289910308,t236:0.5561029321):5.837549551):1.753551635):0.05919196236):0.2590597954,((t237:2.588270501,t238:2.556789012):4.744337424,(t239:4.526173987,(t240:0.9304909852,t241:0.9181297367):3.52299169):2.600968017):0.5319089882):4.953382292):3.821221189):3.498252896,(((((t242:3.841029919,((t243:0.2494170829,t244:0.1390277403):2.637501115,t245:2.743183974):0.8749264898):0.36956525,t246:3.945274632):3.474033565,(t247:3.044579924,t248:2.828096832):4.369855016):2.095868155,(t249:4.458975022,(t250:0.4680612531,t251:0.151858729):3.979349217):4.756071928):5.855972995,((t252:7.666954027,(((((t253:0.8922922611,t254:0.8371932949):0.6666311025,t255:1.419690714):2.83787782,(t256:3.980596034,t257:3.976611605):0.08390916814):0.04972327489,(t258:1.332591169,t259:1.220425089):2.437817433):2.977107193,(t260:0.6379323454,t261:0.4437087584):5.951452849):0.2109994218):0.1293491667,t262:6.70894663):6.836302996):4.168709724):1.336742901):1.489301874):0.3341563737,((((t263:0.5845236865,t264:0.5413356067):7.599370495,t265:8.138711104):6.513381611,(t266:12.66434983,(((t267:4.656150042,(t268:2.834914184,(((t269:0.454920584,t270:0.229659259):1.46264338,t271:1.571632243):0.1256234868,((t272:1.132116674,((t273:0.4603869101,(t274:0.2639038294,t275:0.1344193575):0.02173303021):0.4163404493,t276:0.4327198649):0.2395659663):0.2393892554,t277:0.6742205655):0.3173854601):0.740393831):1.813824239):3.282471307,(t278:3.657544828,(t279:1.103245427,t280:1.061011791):2.453124796):2.996822207):1.413848738,(t281:4.256238149,t282:4.178807742):3.648864002):3.299502002):1.844388141):0.2458733319,((((t283:0.3969741103,t284:0.3430588709):1.957633964,(t285:1.621102352,t286:1.619728214):0.5959647541):2.814599244,t287:4.977757136):4.570139087,(t288:7.277200466,(t289:2.028444317,(t290:1.793291077,(t291:1.022445057,t292:0.8689238098):0.7318825633):0.1590163365):5.137543602):2.169464327):3.253894017):5.82640118):1.789602014):1.197512631):5.9287891):1.377298046,((((((((t293:3.757977159,(((t294:0.1755770301,t295:0.1706727012):2.194497102,t296:2.100520195):0.6990025833,((t297:2.378631087,(t298:0.7034007332,t299:0.5977767229):1.60032735):0.2408422147,t300:2.361789036):0.0548298432):0.603021829):1.980435108,(t301:3.601816747,(t302:0.5176237584,t303:0.3754302645):2.959708499):1.22189178):2.118919563,(((((t304:2.360881499,t305:2.216124177):0.9096576932,(t306:2.298102679,t307:2.295267428):0.6788643538):0.3594943207,t308:3.172772189):2.626229679,((t309:0.5682734462,(t310:0.1769367356,t311:0.1397803982):0.2928809258):3.723425711,t312:4.14447449):1.471287126):0.3419629153,((t314:1.071525031,t315:1.006515081):3.252335618,t316:4.228478236):1.453932961):0.05582459228):0.08847653454,(((t317:1.11640496,(t318:0.908450166,(t319:0.06495930544,t320:0.03213051018):0.8247231959):0.1614974223):1.563411764,t321:2.475796095):1.090183244,(t322:2.366702121,t323:2.339853466):1.17213752):2.049641766):6.426597649,(((t324:7.604542751,t325:7.352150398):0.1996080456,((t326:1.990678084,((t327:0.8816235059,t328:0.7944984737):0.1487336286,t329:0.915860604):0.833668233):4.270876195,t330:5.888093428):1.287748794):0.1313322197,((t331:1.28536204,t332:1.106372007):5.824990838,(((((((t333:1.678972493,t334:1.652354205):1.349216413,(t335:1.746331572,t336:1.714269003):1.245198251):1.018525174,t337:3.874344241):0.4889568835,((t338:0.7788543751,t339:0.7513831322):0.2856263946,t340:1.019105251):3.202931094):0.06507501914,t341:4.256698429):1.150254623,(t342:0.2276587021,t343:0.1949169589):5.171863136):0.476114594,(((t344:0.7865042203,t345:0.7672531732):0.9535170692,(t346:1.400405338,(t347:0.7762748547,t348:0.6917797317):0.2551539211):0.06048017524):0.08515566236,t349:1.060946732):4.007844544):0.5601210081):0.1355153825):3.996270953):0.730390121,(t350:0.7109321128,t351:0.5870189248):9.7703821):7.005180494,(((t352:1.296526124,t353:1.232755772):13.3583942,(((t354:4.748259342,t355:4.663956503):6.405557005,((t356:3.352160332,t357:3.249228002):1.544691921,((t358:4.101243638,((t359:0.9745759978,t360:0.9475811515):0.9561061701,t361:1.879711262):2.129026793):0.5340931257,t362:4.016733):0.00581747445):5.960899912):2.476371325,((t363:1.358861751,(t364:0.619999481,t365:0.5519545638):0.6946505479):8.345837307,t366:9.580648525):2.567659201):0.8819955237):1.414173859,((((t367:2.389963702,t368:2.316446327):6.692222027,t369:8.795148787):1.897560112,((t370:9.042881096,t371:8.864633847):1.197111374,(((((t372:1.242225704,t373:1.204171781):0.008074051053,t374:0.9640406391):1.24766537,(t375:0.5794622716,t376:0.5573799717):1.621142225):0.2031041505,t377:2.176070208):6.474102208,t378:8.631508246):0.8659034229):0.3796411168):2.068528031,((((t379:1.115575761,t380:0.9318039958):4.082794307,t381:5.010394752):3.288004874,t382:8.283317862):3.232286775,((((((t383:0.4141306865,t384:0.005351168253):3.910749466,t385:3.86448993):2.040784474,(((((t386:1.712062791,t387:1.518121829):0.2702936026,t388:1.585456209):1.141119855,t389:2.545908029):1.82558527,(((((t390:0.7715461577,t391:0.4234708214):1.484585729,t392:1.771807883):0.3668140947,t393:2.10901072):0.7694068777,(t394:1.384017782,t395:1.294947193):1.426216023):0.6301160745,t396:3.325012374):0.2806948255):0.2023634336,t397:3.798439106):0.3682068301):1.013646351,((t398:3.685928158,t399:3.624536597):0.2122074231,t400:3.813392489):0.6591470838):1.631281547,(((t401:1.454079458,((t402:0.3679224775,t403:0.2245407049):0.2833736623,t404:0.4700445068):0.3323648914):1.832325395,t405:2.547498258):1.785051956,t406:4.301318431):0.4509326712):0.7388331049,(t407:2.335353951,(t408:0.6459149696,t409:0.5822759514):1.60254709):3.152656064):1.689155646):0.1929021699):1.296185179):1.291524089):2.169674932,(t410:2.456669753,t411:2.245644219):9.42905552):4.113894707):1.043694616):9.600249555,((((t412:0.0321314368,t413:0.001941135209):5.089310557,t414:5.020019707):7.706269922,((((t415:5.050487476,(t416:0.5863836224,t417:0.220569663):4.349097417):1.342469268,(t418:4.459611295,t419:4.456572756):1.267441903):2.872153426,((((t420:1.291558133,t421:1.290357832):1.009546952,(t422:0.6647773239,t423:0.551203185):1.532560179):3.642366494,t424:5.555845786):0.4798242583,(t425:0.6776854311,t426:0.5228051798):5.325356922):2.055056265):2.867303813,(t427:0.1957220407,t428:0.1493113409):10.5164075):0.5922466048):0.3285713378,(t429:1.048876209,t430:0.9579470951):10.53655659):13.239193):3.99565252,(((t431:1.91443657,t432:1.871082841):2.599429612,t433:4.371996959):4.638937026,(t434:3.305746386,((t435:1.032778791,t436:1.023019184):0.4739440886,t437:0.991916542):1.725794632):5.70480573):19.40326882):27.6780836):311.1309125,(((((t438:3.224142452,(t439:2.268209952,t440:2.216074435):0.8940971975):3.153598591,((t441:0.8384841413,t442:0.7010230979):3.582175204,(t443:0.6091317024,t444:0.5348747118):3.627036145):1.751652114):2.978885705,((t445:3.69630681,((t446:1.240631214,t447:1.152572156):1.633033357,(t448:1.043246663,t449:1.041931293):1.632960474):0.7595284107):1.824923538,(t451:1.30990641,t452:1.241214182):3.72863356):3.215007587):14.18285672,(((t453:4.18699805,(t454:0.8476389483,t455:0.6442018411):3.322068086):15.47570833,(t456:1.649381971,t457:1.554842346):17.76469795):1.646035988,(((t458:6.679863682,((t459:1.830219353,(t460:1.096297236,t461:1.04848798):0.7239079888):1.917834906,t462:3.635402205):2.878046466):8.086295306,((t463:3.378343894,(t464:2.990997834,(t465:2.424311606,t466:2.320422982):0.4776091369):0.3788630946):2.688457529,t468:4.997924304):8.523960018):0.4986467559,((t469:1.619322299,(t470:0.9748106063,t471:0.8160992441):0.4988324447):5.951251985,t472:7.215540035):6.449134985):5.584320632):0.9474204757):76.74903412,((t473:0.9579099378,t474:0.7156100583):14.11903702,(t475:1.457543073,t476:1.337251135):13.23334301):81.81226671):266.3073051);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T49.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
