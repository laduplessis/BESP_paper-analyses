<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t463:18.06340824,((t464:1.024846874,t465:1.021741649):2.889125553,t466:3.901472292):13.91029544):23.41322258,((t467:10.07771716,t468:10.02505088):23.93331582,((t469:1.144137709,t470:1.020187547):12.2409351,t471:13.21969372):20.53707041):7.142080477):8.652544056,(t472:0.02952963547,(t447:0.08764493855,((t358:0.001611203259,(t346:0.01402582578,((t311:0.0296321856,(t249:0.1776643339,((((((t164:0.1728782038,(t156:0.3935486947,((t150:0.02402908592,(t149:0.06350304394,(((t143:0.1105929184,t144:0.02470245717):0.06255967448,(((t128:0.1676557871,((t115:0.002367784866,((t89:0.002015894709,(t58:0.04500143522,(t32:0.07985186079,(t23:0.06328751954,t1:1.951937886):0.8810430267):2.082132135):3.244382058):2.735193752,(((((t2:6.617199034,(((t3:1.295353531,t4:1.236515719):0.3901480686,t5:1.536347054):0.4679147335,t6:1.955342723):4.37327194):3.353996875,(((t7:3.06263559,(t8:2.005835084,t9:1.963658964):0.9274145938):1.058961325,t10:3.907171901):3.780306003,(((t11:5.679886507,(t12:1.841275025,t13:1.77064693):3.654870977):1.179548165,((t14:1.665640586,t15:1.606202526):2.844956232,t16:4.374784361):2.042295296):0.7899887969,t17:6.962458601):0.03508898491):1.64859672):0.0609929735,((t18:4.604845124,(t19:3.775546255,(t20:1.817777963,t21:1.810428514):1.898961555):0.5789956275):0.484734536,t22:4.722268232):3.573498):0.5759532091,(((t24:2.464969691,t25:2.328650662):5.562035561,((t26:6.824765941,(t27:1.602460408,t28:1.5964528):5.196159045):1.036441479,(t29:0.4583085474,t30:0.2313069958):7.278263279):0.005352671575):0.442627856,(t31:2.645218547,t33:2.39141389):5.217296117):0.2769781457):0.01348158378,((t34:7.614928504,(((t35:4.2596814,((t36:1.828620341,t37:1.755175527):1.462962982,t38:3.207136014):0.8573044534):1.524618449,(t39:0.3433623434,t40:0.1830099033):5.198665539):1.304657377,(t41:3.779757071,(t42:1.891535877,((t43:0.9522650327,t44:0.9417606706):0.005984648281,t45:0.8242722515):0.734870375):1.887832416):2.849829126):0.4877650314):0.05332475973,(t46:4.556483547,t47:4.556208638):2.259940538):0.1228886799):0.1532327681):0.8753259771):0.2340192617,((t48:4.877277778,t49:4.788057911):0.5586209713,(t50:3.041457199,t51:2.749359307):2.291820478):2.703841726):1.178252927):0.4240144871,(t52:5.751574936,(t53:2.45409854,(t54:1.492376604,t55:1.414360191):0.9372675117):3.275464675):3.428479862):0.2968105685,(((((t56:4.292494603,t57:4.207002258):1.013802676,t59:4.571662382):0.6001802706,((((t60:0.3418966254,t61:0.1318908992):1.315874397,t62:1.387794043):2.834773881,((t63:0.05480276872,t64:0.05084573323):1.980963065,(t65:0.9352932788,t66:0.7622403728):1.085967534):2.003071699):0.2054038573,(t67:3.945084342,t68:3.788539813):0.08349364313):0.4069165706):0.1133793853,((t69:2.451508248,t70:2.217346572):1.433446194,(((t71:2.616686181,(t72:0.3574841581,t73:0.3203389527):2.133707015):0.7502027954,t74:3.117594769):0.01229922065,(t75:2.913561645,((t76:1.708491206,(t77:0.1214665383,t78:0.09266597302):1.579386956):0.365023867,t79:1.972878375):0.7825330306):0.1219681758):0.1876089979):0.3935927844):2.329546373,(((((((t80:0.3500027596,t81:0.2989643482):0.8110645663,t82:1.061763523):1.572804367,(t83:2.422921537,(t84:1.006043333,t85:0.9592561284):1.363054055):0.1506823469):0.1424829287,t86:2.434335951):1.269742724,(((t87:2.796356264,t88:2.567104191):0.01638030106,(t90:2.024866535,t91:1.653142518):0.2570167643):0.2386789367,(((t92:1.504340314,t93:1.377867921):0.4572266327,t94:1.825827851):0.05980071531,t95:1.715900625):0.01865595671):0.5642126788):0.5269749293,(t96:1.519685168,(t97:1.013089527,t98:0.839857125):0.4401763414):1.142843241):0.3849531072,((((t99:0.6180245813,t100:0.2841401163):0.8973328107,t101:1.117095597):0.8860043385,(t102:1.493925057,(t103:0.6694935049,t104:0.4736907334):0.2369469268):0.3904905633):0.2657426564,(t105:1.133885468,(t106:0.259466742,t107:0.2453694812):0.8586078483):0.08788401425):0.1075276962):0.7115445617):0.8724691054):0.7278989832):0.2751587312,(t108:3.149244302,(t109:2.609868411,((t110:1.423360099,(t111:0.4701573681,t112:0.3398291035):0.7689635359):1.015841609,((t113:1.26737233,t114:1.236298506):0.05939188925,t116:1.163975864):0.7141353387):0.1260339281):0.3287298011):0.7154080271):0.179382448):0.1739261936):0.6009152179,((t117:2.36583282,(((t118:0.3597741369,t119:0.1268873201):0.106741747,t120:0.1095753826):0.01901668461,t121:0.02015862267):1.826260204):1.244129565,((t122:0.2072199115,t123:0.1307749517):1.728507516,t124:1.85860461):0.9821322088):0.3890236514):0.3626869955):1.229420005):0.7735712775,(((((((((((t125:0.5446861017,t126:0.2193406553):0.08199391811,(t127:0.2305874782,t129:0.007293423128):0.04464765548):0.1137730114,t130:0.1467657767):0.5587101785,((t131:0.3686384382,(t132:0.3186214852,t133:0.02292848161):0.03015563999):0.2635285662,t134:0.2933463006):0.001988972953):0.2382373111,t135:0.3969066928):0.5374652351,(t136:0.5176657413,t137:0.4869111444):0.3309639263):0.01986678184,t138:0.7903113983):0.3122146098,t139:0.959407322):0.1417521527,t140:0.9975065286):2.763203172,(((t141:0.7047151676,t142:0.5088304607):0.6061522873,t145:0.8569248133):0.3869562353,t146:1.23653868):2.018559881):0.04716075935,(t147:2.272535979,(t148:0.41882804,t151:0.1501093066):1.682355784):0.8842501627):0.2355195076):5.170297171,((((t152:1.179568879,(t153:0.404122421,t154:0.2190683838):0.7582864851):2.084184091,t155:2.856927268):0.515706127,(t157:0.801265294,t158:0.7040168338):1.844709513):1.436355836,(((t159:0.5398079146,(t160:0.1359731881,t161:0.08693952765):0.3647842904):1.7141076,(t162:0.5769488677,t163:0.3859348004):1.447576684):0.1418181304,(t165:1.089620992,(t166:0.4360893914,t167:0.4088534941):0.5801853092):0.5421727373):1.393510697):2.887951831):0.8728384234,(t168:1.782461272,t169:1.632604437):4.742316359):0.2194528396,(((t170:0.5041267533,t171:0.2607496517):0.4285905585,(t172:0.4773776301,t173:0.4773640938):0.1395236029):0.3970386545,(t174:0.2376767532,t175:0.1403081692):0.4702327695):4.939565167):1.51639521,t176:7.01049945):0.5661100156):5.970190111):1.847195034,(((t177:0.7134803947,t178:0.3958218022):7.231043961,(t179:2.652997626,t180:2.585698042):4.945645736):6.842129641,(t181:8.130678575,t182:8.061603119):6.147359124):0.59333846):1.698561991):1.067153801):1.60760529,(((t183:4.882053798,t184:4.581983448):5.767946741,t185:10.27915996):7.142624186,(((((((t186:0.4156621233,t187:0.2602397054):1.43192945,t188:1.6319446):2.898860904,t189:4.333661257):3.300590178,t190:7.466401099):2.027753893,((t191:6.246003717,(t192:5.947397763,t193:5.809578372):0.1100919245):1.803231367,(t194:5.995277023,((t195:2.350801635,(t196:0.4791018853,t197:0.4659334726):1.791779319):1.669507633,((t198:1.249176697,t199:1.216315853):2.472400634,(t200:3.118586728,t201:2.965634034):0.534660192):0.09040052256):1.667715726):1.414784412):1.440238363):2.885227176,(((t202:1.975643087,t203:1.959662767):2.100596911,((t204:1.394707054,t205:1.392196949):0.1415395097,t206:1.284869948):2.313040641):1.750733088,(((t207:1.869400412,t208:1.836012905):0.4373382193,t209:2.226707781):0.7832522874,(t210:2.050854477,t211:2.033380836):0.8270630511):1.907567333):5.066371241):3.002126495,((t212:9.143558792,(t213:4.978270464,(((t214:2.561201168,(t215:0.2940355426,t216:0.219337297):2.261677532):1.674110532,t217:4.116202432):0.1145308149,t218:4.129817177):0.5516149205):4.080859213):3.107277068,(((((t219:2.726188353,t220:2.688868439):3.507082456,((t221:0.4995260183,(t222:0.1550943402,t223:0.1162472854):0.1105980117):2.552883917,t224:2.720201275):3.11988172):2.620731247,(((t225:1.683942432,t226:1.595354097):0.4712243634,t227:2.027781369):5.685381503,((t228:2.934086942,(t229:1.063531377,t230:0.7662657079):1.819098811):2.961065126,((t231:0.3304519376,t232:0.3141374865):4.585574142,t233:4.895919836):0.4309451795):1.79112762):0.5702847309):0.4088515804,t234:7.831409887):0.6359396796,((t235:4.793845367,(t236:4.723527661,((t237:2.081774884,t238:1.684146071):0.3705673959,t239:2.050347031):2.257712383):0.02827781721):2.582234208,(((t240:0.388214667,t241:0.3616065519):1.848704633,(t242:1.698831186,(t243:0.3228797688,t244:0.2780568635):1.348664673):0.4681235162):2.012441596,t245:4.069585498):2.497402993):1.073876428):1.886050339):0.4159155665):1.307283598):1.277800335):6.75057459):2.321236494):49.40080966):4.97464877,(((((((((((t246:8.415193254,(t247:5.584898409,(t248:5.073883684,(t250:2.012889354,t251:1.988461613):2.552762854):0.5088332278):2.74209458):0.896572664,((t252:4.402305186,((t253:3.084645942,(t254:1.827438581,(t255:0.9423524772,t256:0.7886271586):0.8462442051):1.176931038):1.206457815,t257:3.780315614):0.02311267044):3.981237042,((t258:0.5928739992,t259:0.5190750382):1.928268755,t260:2.23264304):5.162856407):0.08413577632):1.292187974,(t261:5.543662372,(((t262:1.89700871,(t263:0.8112837847,t264:0.7895381449):1.07268979):1.320138901,t265:3.151494604):1.666678593,(t266:1.166347197,t267:1.082556361):3.578211301):0.563988971):3.225950096):2.990008188,(((t268:2.432528368,(t269:0.4646010982,t270:0.1714120434):1.884593902):6.040181063,(((t271:1.399862102,(t272:0.04543086977,t273:0.02564109673):1.265969693):0.9940806587,t274:2.245353066):1.799030841,t275:3.821733946):3.901851264):1.806402315,((t276:0.7176764236,t277:0.5401358815):5.986607032,((t278:3.961472795,(t279:1.069129057,t280:0.9175543574):2.633151779):1.147029019,(t281:3.397145116,t282:3.19263137):1.243174892):1.409419134):2.766691491):1.134893626):1.288409671,(((t283:1.705809599,(t284:0.9476065415,t285:0.9010180922):0.7388218528):0.6464164887,t286:2.246326825):4.937355663,(((t287:0.331428781,t288:0.05139807687):2.247827373,t289:2.168657746):3.10571156,t290:5.232829433):1.486750625):3.698206925):0.3580912423,((t291:3.195963382,((t292:0.8213178672,t293:0.779236628):0.2448391428,t294:0.8441157486):1.879026775):6.032712527,(((t295:0.6077189234,t296:0.5820563467):3.47261184,t297:4.000674497):1.912574843,(((((t298:0.1741935763,t299:0.1428796369):1.778712586,t300:1.897655317):0.09152956991,(t301:0.6656876853,t302:0.5664473427):1.320178394):1.21222982,t303:2.977278302):0.396823497,(t304:2.218939022,(t305:1.540758295,(t306:1.22769744,t307:1.216774154):0.2093301421):0.5214074499):1.082809492):2.23611628):2.650109393):1.470213967):0.1923803402,(t308:3.27403665,t309:3.179229988):6.156734724):1.783500301,((((t310:0.41469768,t312:0.1962685174):7.947209469,t313:8.13121282):1.438711782,(t314:8.935747337,t315:8.878653138):0.5394362208):0.288873601,(t316:4.452522888,((((t317:0.8890234976,t318:0.8851423859):0.829025947,t319:1.625124459):0.09856986182,(t320:1.334663855,t321:1.278042909):0.325919732):0.56602415,t322:2.139099779):1.920934775):5.23368764):0.9951253357):0.03312055781,(((t323:3.255460765,t324:3.155323406):4.126686054,(((t325:1.123785965,(t326:0.5766653073,t327:0.4254111884):0.5166262383):4.171929934,t328:4.957344497):1.609450119,(((((t329:0.3022611347,t330:0.2288497795):0.5450714667,t331:0.6395583423):1.086694192,t332:1.645375974):2.310003244,(t333:0.1761466935,t334:0.0406060316):3.585252178):0.9446922707,t335:4.255282265):1.204053253):0.3244437654):0.11590634,(((((t336:0.6169185273,t337:0.6071726776):1.197190438,(t338:1.360831778,t339:1.282736944):0.3945794934):0.1170563728,((t340:0.2184869809,t341:0.12712538):0.5138891667,t342:0.3746050904):0.7160483892):1.251561801,((t343:0.495079311,t344:0.3857518457):1.729561921,((t345:1.468793727,(t347:0.6674080252,t348:0.6181630253):0.6056160044):0.505404932,t349:1.381142416):0.1293625408):0.06238387866):2.608654981,(t350:3.251147632,(t351:0.3582324834,t352:0.2248159369):2.805574847):0.8188335729):0.07199937599):2.694632049):2.54799795,t353:8.982984722):33.38465436,(((((t354:5.790635753,t355:5.787302676):11.51687074,(((t356:6.69784835,(t357:1.204432129,t359:1.084682626):5.470975551):8.14511937,(((((t360:0.4182379839,t361:0.3146264034):7.065185299,(((t362:2.388374393,(t363:1.274645485,t364:1.188864718):1.101662658):2.395064948,(t365:1.737400661,((t366:0.09320714033,t367:0.05173504853):0.8881518339,t368:0.907774875):0.5061796883):2.874185891):0.4073748565,t369:4.532503774):2.154063082):1.844424906,(t370:4.777482223,((t371:4.138843657,(((t372:0.7900433033,t373:0.7869318691):2.418525812,t374:3.203170072):0.6091974485,t375:3.749347753):0.176267773):0.1820247552,(t376:2.013968756,t377:1.861654518):2.017422203):0.2030516639):3.51182354):0.4820421949,((t378:5.816432931,(t379:4.922876519,((t380:1.58535063,t381:1.413818479):0.5126778944,t382:1.697737593):2.733403842):0.6800906004):1.870437563,(t383:0.885391853,t384:0.8760360914):6.057477461):0.3533839587):2.204797565,(t385:2.954248755,(t386:1.166769592,t387:1.108704172):1.619603271):6.53021734):2.605740106):1.365464709,(((t388:1.006593445,t389:0.932570575):3.019742602,t390:3.867546867):8.136011083,(((t391:3.444047343,t392:3.425540742):0.696931303,(t393:3.125336056,t394:2.925082133):0.9955974437):1.449537971,t395:5.039736975):6.366294602):1.032380666):1.090619963):1.332024739,((((((t396:0.7084678794,t397:0.693670149):2.155301052,(t398:1.202894068,t399:1.133346247):1.571369573):2.59763063,((t400:0.8696635844,t401:0.8033150489):0.3245780775,t402:1.094982322):4.040162788):0.7819712977,(((t403:1.791206161,t404:1.713133555):0.03186862275,t405:1.70338054):4.060537371,((t406:0.6878438421,t407:0.6348746262):4.863002063,(t408:1.304132082,t409:1.289883745):3.959743501):0.2015294377):0.0004426682949):0.3454975089,t410:5.783288768):5.711637931,(((t411:6.656332342,t412:6.453988233):1.991335761,((((t413:0.9667718792,t414:0.9480096502):0.6085970213,(t415:0.832147773,t416:0.8277260196):0.4997129773):0.5389586648,(t417:0.3230906227,t418:0.2699381239):1.49883792):5.668814217,((t419:0.9283644312,t420:0.830603861):1.339929051,((t421:0.755467895,t422:0.7383331671):0.4432877679,t423:1.122835382):0.8884036388):5.157841684):0.4058562175):0.00159668226,t424:7.535428915):2.704912451):2.498380366):8.87180579,(t425:13.4752221,t426:13.39287117):8.123345772):7.031504963,((t427:6.022772978,t428:6.002537244):18.72460948,(((((t429:2.653739962,((t430:0.2401871382,t431:0.1989773302):1.701582986,t432:1.784105151):0.6975928455):2.7501645,((t433:1.256306689,t434:1.194919942):0.2481533522,t435:1.235306105):3.422323695):0.979562083,(((t436:0.256033371,t437:0.08359723709):1.845270064,t438:1.905962588):0.0434271951,t439:1.860543639):3.291384424):3.160765719,t440:8.198462037):2.088600527,(t441:0.9130450017,t442:0.8012150522):9.196865064):13.0599774):3.688719443):7.758118677):22.78952769):52.69327506,((((t443:1.760854992,t444:1.62494955):14.51246903,((t445:1.958117639,t446:1.836720672):9.246262229,((t448:4.923721616,((t449:0.6762770708,t450:0.6371884835):1.979135286,(t451:2.261123089,t452:2.259301024):0.3396879458):2.231132618):4.092895529,((t453:2.15761928,t454:1.989664189):1.768235383,(t455:1.211603596,t456:0.8154393874):2.278747147):4.960393785):1.822055436):4.823739819):6.122621723,(t457:2.921197547,(t458:0.1547687337,t459:0.02986984553):2.733913588):17.76380798):16.14285507,(t460:11.62523479,(t461:1.036397716,t462:0.9832821223):10.4965411):24.96671052):71.39757033);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T28.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
