<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t486:0.2530221492,t487:0.2419624147):1.327739129,(t488:0.8061860434,t489:0.697719204):0.7023212082):10.82672487,((t490:4.140991431,(t491:3.864052065,(t492:1.465160362,t493:1.415553048):2.269698723):0.2241058848):3.880109536,t494:7.606305184):4.190576063):89.7409306,((((((((t469:0.0566826369,(((t426:0.08266910911,((t393:0.1875492105,(t356:0.1218825871,(t283:0.1900907451,((t254:0.05430975815,(t234:9.775232314e-05,(t221:0.01977048557,((((((t179:0.05047149755,(t177:0.1699966025,(t156:0.0004296964892,((((t99:0.31092698,((t93:0.003732243011,(t79:0.03367148773,((t1:6.128107522,t2:5.994667775):1.343797818,t3:6.821806535):0.5862702011):1.956422323):0.2240301528,(((t4:1.235692125,t5:1.21267568):0.284650364,t6:1.42744262):3.62838382,t7:5.02563288):4.371592336):0.3740707257):0.52052534,(t8:9.138251641,(t9:8.968935705,t10:8.96757753):0.0661465142):1.046367605):0.265975633,((t11:4.574241155,(t12:3.130055846,t13:2.832565846):1.438303829):4.212937327,(((t14:2.791128664,t15:2.690855374):0.3842309381,(t16:1.638578987,t17:1.515601495):1.403830611):4.97739848,(t18:2.727711249,t19:2.110438818):5.139865177):0.2919337408):1.361994442):0.5479351581,(((((((t20:0.812037191,t21:0.6493260932):6.71982678,(t22:5.677265994,((t23:1.538642835,t24:1.528753678):3.589279069,t25:5.0061239):0.4975244838):1.556271699):0.3056320198,t26:7.256837432):0.009444557496,(((t27:4.676701343,(t28:3.808870422,t29:3.638748194):0.8354330529):2.182375447,t30:6.637350807):0.07985513817,t31:6.691620345):0.2617772297):0.142958102,(((t32:0.7804274013,t33:0.7172694615):1.881088759,t34:2.567651745):3.244993136,((t35:0.9700219515,(t36:0.3557798797,t37:0.3165482366):0.4071549825):4.357680656,(t38:3.042592448,t39:3.018741824):1.890718252):0.4590135988):0.8386643436):0.5257568123,((t40:5.897006004,((((t41:3.263537919,t42:3.147324612):1.580522286,t43:4.63765347):0.4394407418,t44:5.068700312):0.3582582211,(t45:3.33004155,(((t46:1.046310245,t47:1.003141101):0.9709051122,t48:1.89856719):1.276448771,(t49:0.7574990699,t50:0.7116524587):2.383660044):0.02636723006):1.694857922):0.0927666324):0.5788638938,((t51:3.326090933,t52:3.280233849):1.817231838,((t53:4.76303074,(((((((t54:1.580517926,t55:1.456942862):0.1941387344,t56:1.422847676):0.3231759707,(t57:1.034981365,t58:1.028423138):0.5908479361):2.166158046,(t59:0.3057149978,t60:0.2824903069):3.456292014):0.05232738019,((t61:3.667755942,(t62:2.844199323,t63:2.81699579):0.7354488076):0.0959397795,t64:3.503717666):0.008864525439):0.1044230397,((t65:0.5246666037,t66:0.3402266046):2.804324459,t67:3.05371731):0.2644048555):0.0338212043,(t68:0.6688428943,t69:0.5792957314):2.658744548):0.09002999451):0.1473358177,t70:3.436519897):0.1713391657):0.259779018):0.1278039506):0.05610683983,((t71:1.965393176,t72:1.665214868):1.530818226,t73:3.180896409):0.4802593883):0.8407870309):2.027539768):2.661841176):0.2502957613):0.2938592188,((((((((t74:1.187024614,(t75:0.3517453942,t76:0.2703977289):0.7698492005):1.3503698,(t77:0.8973179333,t78:0.6654680314):1.402620233):2.73753958,(((t80:1.917793082,(t81:1.864551728,t82:1.788754792):0.05091720821):1.68269925,((t83:1.86197011,t84:1.778045774):0.57106582,(t85:1.762595253,t86:1.693637044):0.5763815966):1.00408106):0.06622312085,t87:3.31780606):1.022425519):0.2745434824,(((t88:1.222350748,t89:1.115968787):1.063655042,t90:1.911419513):0.4812988567,(t91:0.4381697377,t92:0.1826229849):1.269438362):1.759601986):1.695963196,(((((((t94:0.1836346435,t95:0.1695377925):0.585406898,t96:0.7294134181):0.8481705406,(t97:0.9769100635,t98:0.864224574):0.577726616):1.049506776,((((t100:0.7017819136,t101:0.6243374114):0.1673187019,t102:0.666636562):0.05787316396,t103:0.6686853503):0.3295729244,t104:0.8949430116):0.7632913832):0.01359830453,(t105:0.2856607442,t106:0.2232072522):1.383410369):0.2939812644,(t107:1.016452387,t108:0.8486298512):0.8577347134):0.5970682011,((t109:0.1117550351,t110:0.1007545881):0.3110983406,t111:0.4068906246):1.806978098):1.130432901):0.1331118262,(((t112:1.32195524,(t113:0.8698272814,(t114:0.818778917,(t115:0.4068554971,t116:0.3715781584):0.3478058574):0.01566270915):0.4088108651):1.329220194,t117:2.423698221):0.6083266538,(((t118:0.3488557829,t119:0.3093851373):1.736491559,((t120:0.8594586906,((t121:0.07445599259,t122:0.03252249332):0.4454684201,t123:0.4314566858):0.3016665064):0.08263026021,(t124:0.5846167619,((t125:0.1732182129,t126:0.169845648):0.08507361213,t127:0.1797517504):0.2615852746):0.1696940891):0.9275437548):0.5719693578,((t128:0.07198102143,t129:0.05048702121):1.669371876,((t130:0.1398789935,t131:0.07033613478):0.2466535851,t132:0.3079947568):1.303425024):0.2264988999):0.3584523824):0.1556786694):0.7575675066,((t133:2.420692505,((t134:0.9645320306,(t135:0.8720990148,(t136:0.5785486093,(t137:0.1790160092,t138:0.1751331675):0.3743399831):0.2807779563):0.06032238616):0.8366473524,(((t139:0.1429210983,t140:0.09503359657):0.2770753568,t141:0.3040438218):0.7442507133,((t142:0.4480389611,t143:0.3570293796):0.3481585273,t144:0.6967048226):0.002297248915):0.557472355):0.5108388969):0.1515557946,((t145:0.3248171799,t146:0.2831518703):0.1540984712,(t147:0.1340676123,t148:0.1036794684):0.1948789914):1.354132292):0.5074792299):0.8834901799,((t149:2.759818432,(t150:0.6671717388,t151:0.6110549948):2.017788731):0.2198495352,(((((t152:0.4304808617,t153:0.321880235):0.7769353685,(t154:0.9878666174,t155:0.9516685723):0.06728600075):0.02862066294,t157:0.7692317773):0.0264503315,t158:0.770656065):1.282713829,((t159:0.176676926,t160:0.1663928161):0.4993889083,(t161:0.3505150388,t162:0.1409221847):0.2811893984):1.162320524):0.2424450097):0.05645673014):0.6503837121):0.1593666399,(((t163:0.7317124766,t164:0.6387689954):1.643902128,(t165:1.232883958,((t166:0.4713537696,t167:0.3850776877):0.3184502003,t168:0.4456767298):0.4093288027):1.004775532):0.0510542604,t169:1.876164333):0.233689435):1.158685914,((t170:0.3788410314,(t171:0.1069292213,t172:0.009146239694):0.2524650558):2.197186018,(t173:0.9644160441,t174:0.5241816572):1.331935761):0.4045697987):0.3047939361,((t175:0.3862901435,t176:0.3660857573):1.268082594,t178:1.346527062):0.8095854875):0.9873326013,(t180:0.2321528398,t181:0.1644120451):2.667700234):1.344662337):1.115718554):1.646998842):0.4556492666,t182:7.278129305):2.53871115):7.920733015):3.543300625):1.649851156,(((t183:1.324823383,(t184:0.3594878219,t185:0.08367570961):0.888723372):11.11912694,((t186:0.7861582338,t187:0.775493794):0.996895739,((t188:0.9932794683,(t189:0.6715567486,(t190:0.5445715173,(t191:0.1050990583,t192:0.04391755173):0.4224929187):0.1157333724):0.2827748395):0.1523905527,t193:0.9112189911):0.4033029228):10.21530006):7.544824219,t194:19.04395039):2.922448793):1.491820872):0.05401532536,(((((t195:1.020326158,t196:0.8518731484):0.2017686024,((t197:0.4666579704,t198:0.3574088713):0.2413248599,t199:0.5441274379):0.3067374739):1.607357319,((t200:1.271005272,t201:1.153616441):0.5829074761,(t202:0.5307503552,t203:0.3136416138):1.119973623):0.555503924):4.50744037,((((t204:0.5863727049,t205:0.5775202995):0.07910151997,t206:0.6094703386):0.2163489859,t207:0.7275088023):3.82535617,(t208:2.626296403,t209:2.293634564):1.682045789):1.753686114):1.427550543,t210:7.068282355):14.7003229):0.3181607742,(((((((((t211:0.2375000464,t212:0.2032530732):1.794820106,t213:1.817717877):3.546653596,(((t214:1.087684747,(t215:0.9771073497,t216:0.971640062):0.05492558344):0.5477587258,t217:1.360160746):0.7151108789,t218:1.871907652):2.615090007):2.851893512,((t219:4.408621487,t220:4.357877248):0.9284918433,t222:5.065073735):1.993024622):0.6187744568,(t223:0.7829485898,t224:0.7774001178):6.682518426):2.342026604,t225:9.585232467):4.566868858,((((t226:1.595426059,(t227:1.510934336,t228:1.416762639):0.06768794987):4.031462685,t229:5.489906047):1.270872101,((t230:3.126538512,t231:3.064642851):2.191647026,((t232:1.632656254,(t233:1.466370408,t235:1.290575584):0.1527592574):0.008121807362,t236:1.437734192):3.431436145):1.385806781):2.849201434,((((((t237:3.428472703,t238:3.419950561):2.524693167,(t239:1.222330533,t240:1.196444757):4.554423035):0.2784002264,(t241:4.9605627,((t242:0.9210352909,t243:0.9062346786):0.5997436998,t244:1.413711206):3.353354057):0.9696877757):0.742622829,(t245:1.999942692,(t246:0.9990995587,t247:0.8292456861):0.9908192554):4.467021748):1.192383755,(t248:4.372461762,t249:4.154740535):2.997558481):0.1573190073,t250:7.299916395):0.7453234118):4.368234992):1.214204835,(t251:13.01944706,((((t252:3.007671814,((t253:0.1759619006,t255:0.007770298152):1.834493186,(t256:0.7531999908,t257:0.5158237456):0.8924319629):0.7139242729):4.300508843,t258:6.414065265):0.3490138449,t259:6.571057728):3.104629142,(t260:8.266190695,((t261:1.365284305,t262:1.225529931):5.510467021,((t263:3.119856616,(t264:2.610880839,t265:2.545595446):0.4643443785):3.029485176,(((t266:0.04917491807,t267:0.01986632889):0.7919534499,t268:0.7950471119):2.161770472,t269:2.859059767):2.990545708):0.5826663592):1.347988506):1.054971962):2.22779991):0.4817326545):4.518289079,((((((t270:3.218315432,((t271:2.651772835,t272:2.615664102):0.1181861783,(t273:0.6958877704,t274:0.6719668912):2.016248239):0.3587209706):0.6235737144,t275:3.61797549):1.923310195,t276:5.517083274):2.607474763,(t277:5.061345595,(t278:0.8817583373,t279:0.6622845405):4.019534442):2.995454779):1.507110528,(((t280:1.097393949,t281:1.044208457):1.049896903,t282:1.873685503):0.01689315775,t284:1.458202786):6.99356682):3.130250718,((t285:5.298579701,t286:5.288174819):3.066265999,((t287:0.1347264844,t288:0.02561877677):4.505995534,((t289:0.8658596722,(t290:0.2216270829,t291:0.01435431204):0.4262334803):1.66829506,t292:2.028770558):1.745655889):3.672761158):3.055491905):3.052357561):0.3375665766):3.637146508):0.9223728369,((((((t293:2.524442505,t294:2.474895001):3.975932296,(((((t295:0.8277997044,(t296:0.08108641843,t297:0.0437063792):0.5432202762):2.034126936,(t298:1.868280845,t299:1.68186704):0.751940313):2.798288308,(t300:4.419078041,(t301:2.660520097,t302:2.301017351):1.700972029):0.6392820528):0.01889390347,t303:4.623686399):0.1343357339,t304:4.662158825):0.5969412447):0.2227012069,(t305:1.915662064,t306:1.882809758):3.474639036):5.290107377,((((t307:5.42322771,(t308:3.151086404,(t309:2.857739606,(t310:0.691781152,t311:0.6129692746):2.154741236):0.2548656726):2.260540993):0.7531938674,((t312:0.7187299585,t313:0.6665378246):2.476459314,t314:2.868182751):2.525625509):0.0130482139,(t315:4.876628807,((t316:0.4563393469,t317:0.3909648114):4.33287775,t318:4.633760841):0.02631305763):0.4619812572):0.206983076,(t319:0.7057614548,t320:0.6993876042):4.484991966):4.134454179):2.776384685,(((t321:4.859558813,((t322:0.2381948229,t323:0.2303319951):1.792143748,t324:1.983893346):2.74047415):1.458865874,((t325:4.561221749,(t326:1.454968197,t327:1.311246926):2.968521707):0.7616795569,(t328:1.040707103,t329:0.8408712879):3.822006734):0.7733288609):2.373816668,(t330:5.432794264,(t331:4.391046196,(t332:3.483336455,((t333:0.2101096725,t334:0.1900565):0.5550075914,t335:0.670864285):2.296160761):0.8188871201):0.9000154339):2.357128082):3.377267367):1.197185622,(t336:9.828745256,(((t337:1.86842893,(t338:0.6154831273,t339:0.5092889184):1.250072068):6.820629239,((((t340:4.887352367,(t341:2.641705775,t342:1.898979508):2.087478195):2.16738557,t343:6.090026114):0.1107128172,(t344:4.945899211,(((t345:1.663661996,t346:1.563081396):1.780702427,t347:3.244726095):0.3008407784,t348:3.531391729):1.017838728):1.220524652):0.8755692229,t349:6.608890748):0.5124281518):0.6071166454,(t350:0.4678237671,t351:0.427345945):7.211412511):0.5042790666):1.764395689):2.44459256):0.1767500244,(t352:5.819330502,((t353:0.1202261779,t354:0.06733496536):2.540304485,((t355:1.013305235,t357:0.4623004848):0.5708556372,(t358:0.7139333281,t359:0.5999465794):0.2823013668):0.8808794692):3.023095273):6.52802757):0.1998489715,(t360:0.6872048982,t361:0.6662690643):10.78336074):2.247767766,(((t362:3.653681104,((t363:1.070331803,t364:0.917633564):1.21458721,t365:2.01282952):1.237279933):1.06773179,t366:4.101658426):6.736267163,((((t367:2.453930315,(t368:1.417585063,(t369:0.07317762162,t370:0.04873397845):1.032680042):1.024259097):4.606868237,(((((t371:0.6049439759,t372:0.5974043153):0.006302419272,t373:0.5508409453):3.845756854,(((t374:1.811131013,(t375:0.4408808224,t376:0.3377963672):1.310638745):0.7831184263,t377:2.389618618):0.2977763122,t378:2.535197297):1.463125404):0.02636382646,((t379:0.9299304164,t380:0.8831516714):0.8574717642,(t381:0.4505074806,t382:0.4193181577):1.133753164):2.178225808):1.109623927,t383:4.774229807):1.08850431):0.2962713493,(t384:2.228923664,t385:2.093569791):3.889502889):0.3612676908,(t386:5.443533856,((t387:1.171803869,t388:0.9927399438):1.504406523,t389:2.445894268):2.670100145):0.8788591883):3.032101262):2.114015286):20.71656941,(t390:24.31307632,(t391:12.43475472,((t392:3.412190066,(t394:1.111118358,(t395:0.9105858155,t396:0.8470512954):0.170244743):1.850496153):5.976496173,((((t397:3.442285184,t398:3.386012644):2.250228731,(t399:4.694003046,(t400:1.274657904,t401:1.264895389):3.396911182):0.7918602305):1.353245254,(((t402:1.075045041,(t403:0.8253401245,t404:0.7244632688):0.1878199251):1.283676659,t405:2.058859045):0.8508982657,t406:2.850243128):3.358692851):1.189412335,((((t407:0.5843048555,t408:0.5745007189):2.814971876,((t409:3.08042609,t410:3.068396542):0.01142359655,(t411:1.768741927,((t412:0.9649590403,t413:0.9549492682):0.02959895782,t414:0.9370814506):0.707580789):1.137905267):0.1027871941):2.614260735,((t415:2.128738148,t416:2.072172394):1.085065979,t417:2.738013448):2.207137577):0.1805405974,(t418:3.07179703,t419:2.930146706):1.960059297):1.072250513):0.5573172503):3.037016982):11.72350062):7.501888153):20.64529572,(((t420:1.860959093,t421:1.839582871):15.15766307,(t422:4.525002228,(t423:3.666802796,(t424:0.07085784911,t425:0.02964667291):3.471953696):0.7959453887):12.38385355):0.5591786633,(t427:6.245840169,t428:6.244227287):10.67218869):31.78959437):51.49311608,((((t429:8.476150581,((t430:2.547961274,t431:2.540029352):3.028445749,(t432:2.833512495,((t433:0.3862979896,t434:0.3752037273):1.157440711,t435:1.529432664):1.25009576):2.621592625):2.782670923):11.05454295,((((t436:1.653965918,t437:1.577882397):1.449185621,t438:2.97227666):0.5082307013,(t439:3.32605206,(t440:1.128927829,t441:1.000067542):1.945935137):0.1140815822):1.987015335,(((t442:1.131070153,((t443:0.6805244517,t444:0.6293425495):0.03151965355,t445:0.4032028297):0.327377944):0.08750807257,t446:0.7497889489):1.711875544,(t447:1.070213048,t448:1.04496586):1.378764325):1.792937502):13.57374293):10.79098155,((((((t449:0.1567618625,t450:0.1313682126):3.820750086,t451:3.840241669):1.987694955,t452:5.75616238):3.312593406,((t453:4.533680374,t454:4.466247467):1.084693273,t455:5.545601901):3.355689811):7.913784025,((((t456:1.857418569,(t457:1.200790659,t458:1.116283197):0.499739664):1.248645612,((t459:0.06281232919,t460:0.0366929643):1.439230336,(t461:1.459386226,t462:1.358410682):0.00727950299):1.269907489):3.670556418,(((t463:0.8816353042,t464:0.6569693867):2.932965897,t465:3.357085924):0.4285491299,t466:3.597077857):1.998574209):0.2392063735,(t467:0.9424448223,t468:0.8475249316):4.82688696):9.731752713):4.482124413,((((((t470:0.6215188337,t471:0.5373733836):1.0005168,t472:1.379805751):1.890070224,t473:3.266530929):3.810238585,t474:6.911691259):2.968320256,((t475:0.5344400548,(t476:0.4120409692,t477:0.3348340292):0.07316912943):6.312001203,((t478:1.73270512,t479:1.729165602):1.047479922,t480:2.690575377):3.791309502):2.677776027):2.237053061,t481:11.28462725):7.249848401):6.846348237):41.01566236,(t482:7.36450901,(t483:1.250863326,(t484:1.079539667,t485:0.9515434116):0.1106240792):6.099998151):58.94896975):28.70873385):7.513948696);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T5.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
