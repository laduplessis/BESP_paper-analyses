<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t494:0.151324535,t495:0.1202883713):2.777191837,(t496:1.888100718,(t497:0.6558458587,(t498:0.4613802098,t499:0.4481934519):0.15633287):1.217770429):1.00433883):30.17399763,(t500:16.04490431,(t501:1.263503572,t502:1.203397374):14.76029282):16.75122974):67.27118014,(t503:37.13603729,((t504:5.701100939,((((t487:0.01907956119,(t454:0.04882202052,((t360:0.0147565154,((t341:0.1798289825,(t298:0.0187858953,(t294:0.2060010919,(t291:0.0835242238,((t274:0.2632985067,((((((t190:0.04355898692,(((t164:0.007604744738,(t161:0.06189458747,((t148:0.07636071538,((t141:0.2282612931,t142:0.1191205719):0.004063695644,(t128:0.08516013846,(t116:0.01902968875,(((t94:0.04938998896,t1:9.809348019):0.7810299811,(((t2:3.747603597,t3:3.573645118):6.540119726,t4:10.07952076):0.1660756623,((t5:8.796490936,(t6:3.832422638,t7:3.727768606):4.875704066):1.312242608,((((t8:3.622085026,t9:3.51899849):3.195686156,((t10:0.1934864967,t11:0.04580848981):5.602798712,t12:5.592473933):0.8403115849):0.6739418525,(t13:6.323147374,(((t14:2.857278501,(t15:2.789143263,(t16:1.751316999,t17:1.686714746):0.9628856917):0.03715712865):0.4956467109,t18:3.037421553):1.045616146,t19:4.041025235):1.90539277):0.6967941371):1.614657954,((((t20:3.105779242,t21:3.074413454):0.5141651038,t22:3.437889373):4.467353912,((t23:3.295306438,t24:3.205892156):1.72052133,t25:4.871754224):2.773387378):0.006930412248,(t26:3.111451788,t27:2.860159216):4.373407711):0.07158382417):0.6187010921):0.09083719836):0.01227764951):0.3186440546,(((t28:1.953932298,t29:1.932088581):2.92390473,((t30:2.245364745,(t31:0.7111345653,t32:0.6210908227):1.408694431):0.2726022566,t33:2.301888317):2.330308134):0.6914404248,((t34:4.042275823,t35:3.875887024):1.19709896,t36:5.068514418):0.04863162221):2.768584105):0.1772108315):1.361684973):1.231592323):0.4141457669):0.338533479,(((((((t37:1.160030436,t38:0.8687182331):5.089175916,((t39:1.508803606,t40:1.476293888):2.962637098,t41:4.413991556):1.463221603):1.292494994,(((t42:3.679596308,(t43:0.3114398259,t44:0.2880662822):3.309878731):2.772852394,(((t45:0.3138105369,t46:0.197006218):1.832872152,t47:1.890042961):4.02896366,((t48:3.219961282,t49:3.16709046):1.806639586,((t50:0.7502391041,t51:0.6910258342):2.603099675,(t52:1.946528489,t53:1.78271731):0.8709339152):1.597907581):0.8426420176):0.03140231537):0.494844055,((((t54:0.3137287863,t55:0.1959178306):0.5671200749,t56:0.5427378843):1.856217379,t57:2.211847487):2.729797785,(t58:2.678569127,t59:2.378705689):2.189718304):0.07813532505):0.1890848585):0.062146802,(((t60:2.504386986,t61:2.443379329):0.9589891525,t62:3.328013223):0.4033114979,(t63:3.336651661,(t64:0.6906363365,t65:0.4032908139):2.512873051):0.2422640276):0.7245005552):0.6147154006,((((t66:1.349189795,t67:1.31109921):2.034984818,(t68:2.511121429,t69:2.481396539):0.4791392375):0.4377849099,(t70:3.182392303,(t71:2.423058262,((t72:1.179223906,t73:1.033611917):0.7917535359,t74:1.786581571):0.3507753854):0.5503583978):0.006710708574):0.2106446494,(t75:2.09171367,(t76:0.4189282686,t77:0.3350669544):1.664192173):0.8071059866):0.4308429114):1.036099866,(((t78:0.2156038497,t79:0.09790685714):2.916174397,t80:2.996783343):0.1191932445,t81:3.081982464):0.8358712315):1.493891348,(((t82:2.651985142,t83:2.455682258):1.056422951,(((t84:1.459356463,(t85:1.233854369,t86:0.7933041484):0.1995617478):0.8355809239,(t87:1.288300685,t88:1.107187931):0.4539090201):0.08690492535,((((t89:0.3065311721,t90:0.2203767699):0.3355074408,(t91:0.4266356817,t92:0.4099429241):0.07340202456):0.626245584,((t93:0.1588128657,t95:0.02261145935):0.2235527113,t96:0.2360785926):0.655284643):0.1221289709,((t97:0.3249356946,t98:0.3181959268):0.1201988519,(t99:0.1864251226,t100:0.08163291186):0.2158532903):0.5547667547):0.1488811942):1.122992762):1.164389347,(t101:2.821607738,t102:2.597689681):0.3633526964):0.5359776631):0.575897114):0.9524593146):0.1667361434):1.477079637,(((((((t103:0.2651039932,t104:0.1386211223):0.3417664591,t105:0.4672983032):0.5977686915,(((t106:0.4764425029,t107:0.3779436039):0.2005915063,t108:0.4703377676):0.1608773137,t109:0.6187861513):0.1474750055):0.9080604037,(t110:0.2953756932,t111:0.2873935188):1.360007486):0.4937133635,(((t112:0.188748276,t113:0.1525596657):0.2992740769,t114:0.3952398825):1.3933611,((t115:0.2810887964,t117:0.2304380778):0.05278531933,t118:0.2804092318):1.408382851):0.2346135598):3.183532068,((((t119:0.428953616,t120:0.243852024):0.4974492858,t121:0.5072810794):2.699996073,((t122:0.1967368599,t123:0.1941266431):1.446750313,t124:1.603294771):1.330384796):1.137957161,((((t125:0.08662423093,t126:0.06177972278):1.088172382,(t127:0.9101630802,(t129:0.5009841006,t130:0.4097685036):0.1030325447):0.09635386185):0.5818831435,t131:1.172134598):2.005208071,((t132:0.1837299067,t133:0.1499814648):2.418887668,((t134:1.753399759,(((t135:0.2849741344,t136:0.2721742916):0.4119645743,t137:0.6552484117):0.2321846607,t138:0.7049991879):0.7462612523):0.0759820463,t139:1.415907659):0.6885339349):0.5151550036):0.2831599123):0.05659222027):0.3415214642,((t140:0.5761436983,t143:0.2684281855):1.505954593,(t144:0.122683667,t145:0.1114152278):1.611846585):1.051965746):0.4833183136):0.0593335448,((t146:1.995331021,(t147:1.476752922,t149:1.237712738):0.3852263141):0.1189996592,t150:1.407612309):1.181120817):0.5919188457):0.5563533071,((t151:1.003085207,((t152:0.2681047168,t153:0.187730604):0.401186043,t154:0.5843859228):0.2571709589):2.372119159,((t155:0.6221662712,t156:0.5869884597):1.828548898,t157:2.394265523):0.6657454924):0.3008032443):0.03604218064,((t158:2.254952119,((t159:0.3910153739,(t160:0.2514289957,t162:0.001741250046):0.06454642376):1.053373848,(t163:0.5630690156,t165:0.4071690262):0.5219235872):0.7461572997):0.8417005909,((t166:0.8287992451,t167:0.6910788847):0.506938516,(((t168:0.1879247767,t169:0.1868658559):0.08045555886,t170:0.1916962625):0.3807446704,(t171:0.1513457247,t172:0.1018202156):0.2724126362):0.5423639106):0.9502525852):0.0920830072):0.522013671,t173:2.414436581):0.1607024742,((t174:1.464454916,((t175:0.839266977,t176:0.7370164298):0.1274013045,(t177:0.3083068225,t178:0.2307242118):0.4009941842):0.4653257033):0.7121200936,t179:1.664833775):0.32465773):1.841635232,(t180:0.5035900597,t181:0.4810731674):3.289257116):4.910826806):1.605328941,((((t182:0.1032642559,t183:0.09186918847):0.4946733239,(t184:0.1066417979,t185:0.09444922034):0.4469720302):5.833540846,(((t186:1.585977324,t187:1.547464933):0.9638475655,t188:2.452121696):3.545804339,((t189:1.529997738,(t191:0.05730808321,t192:0.03819975704):1.113512599):0.5772251559,((t193:0.357776317,t194:0.2362532417):0.3487374413,t195:0.4327067388):1.005019705):3.759701844):0.2649424495):0.559823565,((t196:1.074537938,t197:0.9951543003):0.4073153224,t198:1.284222701):4.446114782):3.230258027):0.1251146608):0.4122192788):0.3998729422):4.653725485):0.7851743875,((t199:8.2421035,((((t200:0.2473029053,t201:0.234900437):1.021535779,(t202:0.2459228053,t203:0.2366755852):0.8724905108):2.06349758,t204:2.963135773):4.154019032,t205:6.96362993):0.7361708989):6.260206861,((t206:2.808694811,t207:2.650310675):4.227955833,t208:6.662065182):6.89170803):0.8121209329):1.404978692):8.690207457,(((t209:12.95520704,(t210:7.538004393,(((t211:0.06795999017,t212:0.001874869046):0.08020372803,t213:0.02265232665):0.5208028793,t214:0.4560998027):6.749624467):5.347291775):5.321394745,(((t215:9.410464821,(((t216:3.023160166,(t217:1.397801965,(t218:0.6725715465,t219:0.5497830194):0.6289453407):1.474733689):0.1515071305,t220:2.792508343):0.8844194176,t221:3.628442714):5.336351152):5.238042047,((t222:6.713919217,(t223:3.509061527,(t224:1.395116898,t225:1.381205161):1.755544879):3.175426682):2.27088193,(t226:3.781046224,((t227:1.008252824,t228:0.9188624095):1.208193148,(t229:1.322697584,t230:1.234234292):0.6539456832):1.140742838):4.725834441):5.107114467):1.173408006,((t231:2.264443778,(t232:1.594683549,t233:1.57695738):0.4317118181):5.846810561,((t234:6.492581863,(t235:4.729703113,t236:4.677032767):1.609126115):0.06593028526,(t237:3.764134331,(((t238:1.107794578,t239:1.082275683):0.2389841389,t240:1.273902576):1.730731104,t241:2.951492871):0.6669362168):2.556028748):1.190460552):5.676034836):1.859573648):5.20701412,(((t242:4.325375477,(t243:3.202560721,((t244:0.2719196045,t245:0.2343738285):0.9571103347,t246:0.8295264437):1.897113866):1.069568821):1.229164579,t247:4.891537891):8.115219993,(((t248:1.950137675,t249:1.869153786):6.911998354,(t250:0.3175453003,t251:0.1914074616):8.392956991):2.47175606,(t252:5.527061534,(((t253:0.3001677796,t254:0.2274295703):0.6933236209,t255:0.8371831737):0.1115570936,t256:0.7801049563):4.359963557):5.452293191):1.657540384):6.40211648):0.9342799099):0.2721618844):2.360824685):3.044339356,((((((t257:1.820809605,t258:1.520263853):3.300038164,(((t259:1.203203267,t260:1.098785136):2.276274652,(t261:0.390719679,t262:0.288130264):2.954546231):0.0990987158,((t263:0.6399344372,t264:0.5244830454):1.013975959,(t265:0.5293559939,t266:0.4660204379):0.98280401):1.604947577):1.192810614):0.4385199492,(t267:4.44279566,(((t268:0.1483260995,t269:0.1355721541):1.662717898,t270:1.79556624):1.74320668,t271:3.456888082):0.8753692909):0.2393989255):4.487300726,((t272:3.576223983,(t273:1.586718144,t275:1.004838735):1.93014447):0.6622184828,t276:3.580299323):4.798039049):1.6846075,((t277:8.030206304,((t278:1.196578728,t279:0.8216591877):4.642099497,(t280:2.266610093,t281:2.198414131):3.178510088):2.162444376):1.006484015,(t282:7.670677598,((t283:1.184971118,((t284:0.3234626142,t285:0.2299842223):0.2434343865,t286:0.4626606633):0.5741819692):2.711779365,((t287:1.363516884,t288:1.237288007):0.9860084107,t289:2.036577734):1.395009395):3.510611593):0.8090616644):0.9525734322):3.52551838,((t290:3.400492221,t292:3.172891579):5.084851887,(t293:4.124230785,(t295:3.605722746,t296:3.521856022):0.1822896082):4.069649193):3.665880541):9.997390972):0.702839276,((((((t297:5.578847954,((t299:0.9291119617,t300:0.6548983529):4.250097174,(((((t301:1.506576979,t302:1.460950101):0.9738778086,t303:2.363269138):0.9669754632,t304:3.297262019):1.229375792,(t305:0.6878476537,t306:0.6587943438):3.798951119):0.1375218174,((((t307:1.393684616,t308:1.390788457):2.150715582,(t309:3.04658981,(t310:2.242370388,(t311:1.863698145,t312:1.771648618):0.03508749711):0.7883906458):0.4352248846):0.7233713499,(t313:3.271913887,t314:3.002506919):0.3443260348):0.2888035403,t315:3.596893275):0.02065991196):0.0552169487):0.2861436206):2.554026783,((t316:3.925445646,t317:3.858562117):1.006729606,(t318:0.3583147962,t319:0.3366549516):4.31498863):1.16296765):2.069232711,((t320:5.286136944,t321:4.665892355):0.2852939505,(((t322:0.2014203604,t323:0.12424977):1.698442958,(t324:0.6708149346,t325:0.5701475087):0.9987565409):0.6803754508,(t326:0.5287862753,t327:0.4445036964):1.712689116):2.213058471):2.304981341):1.946438807,(t328:3.740390896,(t329:0.1294173588,t330:0.125489681):3.565515569):4.749545252):5.270895157,((t331:4.854435394,t332:4.826496607):1.276571076,(t333:3.383937237,t334:3.296091166):2.662141443):7.527330246):3.473746192,(((t335:4.87352221,t336:4.733850855):4.343737182,((t337:6.503273417,(t338:3.234039617,(t339:3.046990142,(t340:0.6151577996,t342:0.2850332505):2.409929398):0.1559905228):3.015467235):1.148930976,(((t343:1.44297456,(t344:0.9646818519,t345:0.9273935279):0.319074391):0.870024591,(t346:1.204947752,((t347:1.032170243,t348:0.7573144717):0.0433282802,t349:0.7945661058):0.06238749058):0.8090562209):3.052293179,t350:4.495362395):1.547071858):1.304607317):5.768098056,((((((t351:3.251316557,t352:3.194516131):0.3559828877,(t353:0.6021597121,t354:0.5951423552):2.805160639):1.426045702,(t355:0.5000799703,t356:0.3835686081):4.225272522):3.368751461,((((t357:1.822940981,((t358:0.1346909201,t359:0.033229301):0.3967275267,t361:0.292833507):1.082978511):1.60452367,t362:2.853816408):0.3801188197,((t363:1.22784925,t364:0.9837676131):1.869659769,(t365:0.4072945093,t366:0.2122594727):2.438362263):0.04229473225):3.179790009,t367:5.7750909):0.7257600629):1.740538213,((t368:1.271197266,t369:1.185439329):3.872194069,((t370:0.8174242304,t371:0.5743247533):2.547274461,(t372:1.283227743,t373:1.214266902):1.718363485):1.273635938):3.04258788):0.1528115879,t374:7.264197396):2.801885922):1.970134971):1.109510485):0.4668652007,((t375:1.152844886,t376:1.09899792):7.648533319,t377:8.678258696):4.794074574):2.690433489):6.86841386,(((((t378:2.833554105,t379:2.77018661):2.688183464,t380:5.426746022):0.1072657481,t381:5.446934723):5.28851166,(((t382:0.971973729,(t383:0.03740436863,t384:0.02400313784):0.9064328584):0.6016298187,(t385:0.3319848432,t386:0.05731479873):1.074334908):7.457306577,((t387:3.565826307,(t388:0.3508221106,t389:0.3052908619):3.169039786):1.461376194,(t390:3.465078901,((t391:1.081870176,(t392:0.3472697271,t393:0.3409461982):0.6936467588):2.110296974,((t394:2.379029898,t395:2.328267918):0.3843105595,(t396:1.121434086,t397:1.082140591):1.4621862):0.3027730293):0.2640894036):1.413166813):3.340312106):1.646626809):10.97793322,(((((t398:0.6137563644,t399:0.559196382):4.680035724,(((t400:3.278341284,((t401:0.3278668395,t402:0.2758640407):1.565554076,(t403:1.379749458,t404:1.136064899):0.3705080126):1.35827102):0.2464698839,t405:2.996111689):1.017021729,t406:3.90509333):0.651858359):1.402007018,t407:5.850123931):5.061696314,(((t408:0.9002022476,t409:0.7901925079):2.320706242,(t410:0.7028374461,t411:0.5196542053):2.233472874):6.113597991,(((t412:1.876075274,(t413:1.753193539,t414:1.718204454):0.112513936):1.431597024,t415:3.252651719):2.201107233,((t416:1.804050175,t417:1.581518989):2.597553294,(t418:1.926977656,t419:1.926727102):2.208930364):0.9538857266):3.269771824):1.56026189):0.09555535183,((t420:4.689377578,t421:4.342457131):4.660661484,(((t422:2.363178641,t423:2.227876093):2.541980195,(t424:4.292030009,t425:4.137694226):0.4521158832):1.568465333,t426:6.061260522):2.496628184):0.6414557819):8.616735078):1.000290947):24.48079252):62.74623665):186.054839,(((((((((t427:0.5635958133,t428:0.5597066758):5.454911867,t429:5.878392151):0.4165101199,t430:6.192513906):5.328086219,((((t431:2.286710337,t432:2.222564796):3.364329615,(t433:4.605842779,(t434:3.462813803,(t435:2.410498947,t436:2.391127077):1.012982789):1.126805137):0.8960016057):1.630902014,t437:7.035768617):0.9472188044,((t438:2.945368597,(t439:0.5151354107,(t440:0.09460565119,t441:0.08214359588):0.2764996844):2.237185122):3.101175748,((t442:4.850562577,(t443:1.151854993,(t444:0.3018681889,t445:0.2146069727):0.6662525955):3.638401486):0.1931280049,(t446:0.8200617974,t447:0.7834170569):3.7823333):0.5757467977):1.925011603):3.282847891):1.690555452,((t448:1.959670727,t449:1.881217783):5.400016638,((t450:4.868884727,((t451:0.6160495144,t452:0.3751745301):3.98194488,(t453:0.7730391802,t455:0.363731739):3.424405654):0.1801377279):2.033681245,((t456:0.9318173872,((t457:0.2606073715,t458:0.1919493888):0.003498839551,(t459:0.01722858744,t460:0.01317619524):0.1259516527):0.5680996019):2.523752487,(t461:0.5831648203,t462:0.5029172528):2.643658356):2.514995072):0.2169442219):4.459694672):8.497100434,(t463:6.727575877,t464:6.5971839):12.05744991):12.39334293,(t465:11.24009435,((t466:2.351975732,t467:2.305201528):1.861667961,(t468:3.338587523,t469:3.31032796):0.8096119957):6.910570397):19.79293164):5.298060462,(((((t470:0.9121363245,t471:0.7614269549):0.05669064955,t472:0.7775735774):3.44818655,(t473:1.897744935,(t474:1.344446092,t475:1.293065828):0.5329579422):2.282979154):0.7676709899,t476:4.864841409):19.54721225,t477:24.38491072):11.33601869):16.03733858,((t478:11.80810005,t479:11.71602516):5.469804126,(((((((t480:1.105724877,t481:1.031134358):1.294250273,((t482:0.6768498331,t483:0.5908447456):0.1591761374,t484:0.6278660129):1.484262247):1.171470118,t485:2.930475822):0.7352327759,t486:3.594782115):0.1302577574,(t488:1.612791083,(t489:1.245384521,(t490:0.7404655374,t491:0.3953728199):0.4947789555):0.3487210272):2.038708324):2.139373144,t492:5.351808237):4.80811054,t493:10.01922543):5.667548734):34.37442928):236.411613);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T71.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
