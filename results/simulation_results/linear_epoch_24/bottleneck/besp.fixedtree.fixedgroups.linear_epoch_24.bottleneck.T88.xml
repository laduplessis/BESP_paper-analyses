<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t463:0.1049647417,t464:0.08345230129):105.0928004,(((t465:10.13629683,(t466:2.655368661,t467:2.58107807):7.459560256):37.53588125,((t468:14.40741698,((((t470:4.134891889,t472:4.028088277):0.9463825192,t473:4.944523064):1.622774299,(t474:0.5890510658,t475:0.4708016518):5.920666033):6.374254679,((((t476:0.1442384625,t477:0.08809028364):0.8747946882,t478:0.8243468776):4.076186676,t479:4.865093896):5.156042445,((t471:0.0002297952013,(t469:0.1535586722,(t462:0.3308894257,(t418:0.05337410453,((t317:0.04130496107,(t315:0.1641925423,((t291:0.1889637988,(t158:0.01798523092,(t151:0.1907132992,(((t124:0.0793752227,((t113:0.1138831201,(t111:0.1532199407,(t112:0.03076949482,(t94:0.3952155962,(((t95:0.185527068,t96:0.1147605831):0.01574890005,(t1:2.616804095,t2:2.610031253):7.824992017):0.03505689496,((((t3:7.195671913,t4:7.132841371):1.363611185,(t5:1.419810709,t6:1.140665272):6.724449829):1.747413449,((((t7:2.387931568,t8:2.32423494):2.283292387,(t9:3.341887628,(t10:2.318814517,t11:2.246809062):0.9406741916):1.217737706):0.06263637816,t12:4.395641336):2.152763732,(t13:3.23963208,t14:3.230148401):3.163813885):2.687441385):0.04145291455,(t15:6.234051656,t16:6.233088937):2.808513578):0.09556365535):0.04799637507):2.173391261):0.0001783064976):0.1301851817):0.9276977592,(((((t17:0.7084910571,t18:0.6208750326):3.117905046,t19:3.490815028):0.73409937,t20:4.133985186):3.706471556,(t21:3.424361981,t22:3.309793166):4.347692528):1.208498312,t23:8.761602157):2.386953491):0.8170264482):0.2899678828,(((t24:2.699264189,((t25:0.4707667343,t26:0.3968234443):0.04398898237,t27:0.1287649526):2.145530999):4.763417826,(t28:6.282952018,t29:6.170054007):0.7496402032):0.4368307513,(t30:2.033112968,(t31:1.315388844,(t32:1.207495765,t33:0.6160846957):0.07832598095):0.6879367219):5.265059958):4.310469468):0.7628554799,((((t34:7.206059299,(((t35:3.712824763,((t36:1.725399293,t37:1.670437394):1.005167178,t38:2.541688512):0.9505434413):2.401059435,((t39:5.371793183,((t40:1.305541156,t41:1.285482956):2.883889123,t42:4.168532453):1.175891754):0.2568905954,(((t43:2.456323046,t44:2.439681584):0.8314539546,(t45:2.269606698,(t46:1.794998368,(t47:1.046248634,t48:0.9025998077):0.7364826334):0.09996603299):0.839092097):0.5075855753,t49:3.040830067):1.777800541):0.2250513203):0.6150597289,(t50:0.7893929475,t51:0.6767017653):4.650359313):0.3473066679):0.310402264,(((t52:4.520066808,(t53:4.434742152,(t54:4.171664398,(t55:4.099896891,t56:4.08852093):0.02278060752):0.09889553195):0.02197800748):0.2252318007,(t57:3.936223032,t58:3.819761256):0.2971730317):0.1336692479,(t59:3.984997951,(t60:3.215100022,(t61:1.503015089,(t62:0.277632285,t63:0.2671187708):1.084680794):1.551720357):0.7280306816):0.1756761193):0.9903826719):0.7309242707,(((((t64:2.720878366,(t65:0.5598430809,t66:0.5579276004):2.034895667):0.6464612623,t67:3.222625617):0.3614971662,((t68:2.812356416,t69:2.762112352):0.3685840475,t70:3.071395125):0.325933911):0.05855313278,((t71:2.819077313,t72:2.630536917):0.03758214905,t73:2.193811106):0.4533895263):0.07129655364,(t74:2.639256132,t75:2.606077125):0.02575796247):1.660473385):0.002133540646,(((t76:1.548762594,t77:1.463942981):0.7364608464,((t78:0.4472542341,t79:0.3228880042):1.328775262,t80:1.443952138):0.3976683368):1.075975703,(t81:1.904095273,(((t82:0.2191589542,t83:0.1268107013):0.7285863074,t84:0.722833182):0.2401575548,(t85:0.2833983413,t86:0.2255548099):0.6728345531):0.5356221989):0.6443341744):0.7041209134):3.403237677):1.080830103):0.5626062461):13.22983134):0.8400021313,((((((((((((t87:1.346959295,(((t88:0.2869204783,t89:0.240938463):0.1491453139,(t90:0.1839948128,t91:0.1259536686):0.08015228183):0.7694329349,t92:0.8790960374):0.04002808397):0.03947199111,(t93:0.8289875518,t97:0.2032909295):0.04175805281):1.303963583,(t98:0.9066727857,t99:0.7617330879):0.5874232621):0.1378694623,t100:1.146316919):0.4457515283,t101:1.561737184):1.896267557,(t102:1.13775771,((t103:0.6482820169,(t104:0.3637659468,t105:0.3365949925):0.1340901746):0.2474801055,t106:0.6434902918):0.005025430583):2.229007517):1.80053479,(t107:4.200083864,((t108:1.853621925,(((t109:0.4946186091,t110:0.467832103):0.2213138325,t114:0.05905016252):0.6562451347,(t115:0.2373919478,t116:0.112680764):0.2096504914):0.3380365892):0.5810325258,(t117:0.5662315585,t118:0.3772383597):0.5885415232):1.476443926):0.3251277079):0.203151276,((t119:1.306164375,t120:1.196615092):1.562444411,(t121:2.085929188,(t122:0.836639729,(t123:0.2375684231,t125:0.1034831293):0.4031334712):1.117367342):0.4873974624):0.06235970784):1.073912632,(t126:2.375382181,t127:2.252398049):0.8483426499):0.9792634174,((t128:1.212719284,t129:1.198894416):1.69044911,((((t130:0.4705469589,t131:0.4455825117):0.2331532962,t132:0.620570667):1.377530939,(t133:1.710317066,t134:1.517867836):0.1558120158):0.1168853877,((t135:0.1418500618,t136:0.1193526374):0.665266451,((t137:0.008426943722,t138:0.00813784024):0.6574791446,t139:0.4552357787):0.09116676661):0.9801839932):0.5848689433):1.16670132):0.337573356,(((t140:1.776320956,t141:1.773935989):0.7899242033,t142:2.47483387):0.5005806024,(t143:0.3276615529,t144:0.3224489414):2.576639335):0.4834021358):5.214579244,((((((t145:0.3576655259,t146:0.3568425911):0.6173969914,((t147:0.22907831,t148:0.003592047803):0.5562018863,t149:0.4715152186):0.1424446841):0.8647950307,((t150:0.8653683119,(t152:0.3582838741,t153:0.2513247654):0.09013036044):0.2430361885,t154:0.5117135182):0.1492298106):1.939508545,t155:2.412554741):0.3281543379,(((t156:0.04052998644,t157:0.02660722478):0.2527727653,t159:0.2044729606):0.8619777132,(t160:0.8623904652,t161:0.3928762596):0.1367976624):1.578493908):4.049704714,((t162:1.231482127,(t163:0.4829335945,t164:0.4621432891):0.6583530355):4.682460852,(((t165:0.3206628757,t166:0.3135028492):0.7145521907,t167:0.9505389274):0.5709434475,t168:1.468963152):4.144230972):0.1988868555):0.3823474436):6.950381077):1.333607515):0.138257021):3.576261118,((((t169:9.489312387,((((t170:0.5642806346,t171:0.4695859862):0.2949476205,(t172:0.5656194849,t173:0.4992393482):0.1183539224):0.2871241149,t174:0.8348325045):4.537753678,(((t175:0.2309019382,t176:0.05292178623):0.535673708,t177:0.5538376938):0.9823325766,t178:1.53005769):3.615991784):3.720397824):4.31612359,(t179:7.574142689,((t180:0.2673869021,t181:0.06631369932):4.311862092,t182:4.336037915):2.911829849):5.440531795):2.312137169,(((((t183:0.1840168162,t184:0.107435719):0.06621590331,t185:0.1724673772):4.443308102,t186:4.557465183):1.468948134,((t187:1.726862407,t188:1.687701118):1.676005937,t189:3.095792187):2.564605526):3.204537594,t190:8.839088877):5.513277003):0.2065996657,((t191:5.006522601,t192:4.926692057):2.044671823,((t193:3.421677287,(t194:0.7977800958,t195:0.733340366):2.582905963):0.5498401356,t196:3.69532525):2.898297927):7.507642933):1.705775259):6.419190458):3.518834706):0.5362510745):0.2878624312):2.451775851,((((((t197:8.378923717,(t198:6.897617795,(t199:6.25144423,t200:6.183872641):0.6122757505):1.331344552):5.067373134,((t201:2.185036395,t202:2.14433963):10.01165939,((t203:5.697607682,((t204:4.184581442,(t205:0.9887645426,t206:0.9404966798):3.081538439):0.516129114,(((t207:1.24193077,t208:1.129147674):1.589136251,t209:2.648388793):1.170834539,t210:3.71830392):0.5189934484):0.7821327195):1.434878542,t211:6.409563121):4.49919335):0.8055428866):3.588721546,(t212:3.964006407,((t213:0.1616647629,t214:0.1083644921):1.645829533,t215:1.742769908):2.077728952):11.20167672):6.262184063,(((((((t216:1.975435963,(t217:1.365298186,(t218:0.5267277786,t219:0.3983712339):0.7155865438):0.3729685504):8.155540394,t220:9.564485739):1.650918975,((((t221:3.751292846,((t222:2.461135916,t223:1.885431674):0.107657073,t224:1.96068605):1.057270723):2.194251138,t225:5.160948013):1.427323955,((t226:3.502945997,(t227:1.196622621,t228:1.164241149):1.967382984):0.2941291652,t229:3.236284181):2.704801677):2.663341,((((((t230:0.7093954656,t231:0.6683681511):2.306150462,((t232:0.670201225,t233:0.4671479368):0.8858984894,(t234:0.3942932608,t235:0.2029401804):0.8819216203):1.376658711):1.256654607,(t236:1.837319097,t237:1.699391058):1.848847636):0.3743661404,(t238:0.6413956202,t239:0.512911792):3.215542862):2.611328565,((((t240:0.675140014,t241:0.6744283281):1.471168617,t242:2.060280135):1.872855014,t243:3.879071345):0.5603582127,t244:4.36979161):1.737384792):0.4115340121,(t245:2.526956972,(t246:0.7993196665,t247:0.7173846174):1.592414052):3.905030072):0.8953677026):1.061246883):0.04182456652,((t248:5.980061427,(t249:4.617535708,t250:4.525637991):1.350149967):1.361437536,((t251:3.713706553,((t252:2.610515643,t253:2.169863778):0.926296074,((((t254:0.6063016582,t255:0.5010378541):0.7655274741,(t256:0.6195329011,t257:0.5296158816):0.6239213631):0.1594171751,t258:1.038534195):1.304748874,(t259:2.233578766,t260:2.095608334):0.09075766892):0.2357512101):0.1439414293):1.188932365,t261:3.672684605):2.329769331):0.7675342615):0.5367722031,(((t262:0.6707093077,t263:0.3493916443):2.146204914,t264:2.49117739):2.717180928,(t265:1.368527568,t266:1.332243636):3.668232026):1.73843822):1.581889201,(t267:5.887722984,(((t268:3.16719992,t269:3.140580135):0.5394303569,t270:3.513773082):1.273529768,(((t271:0.5884559487,t272:0.5855425728):1.958348047,t273:2.483749843):0.1510803986,(t274:1.548090997,t275:1.494461564):1.079904983):2.069231994):0.8531074822):2.225705607):6.259230972,(t276:5.765235491,t277:5.670312947):8.192636884):0.7250869577):5.465847676,((((t278:7.3846068,((((t279:0.9365765467,t280:0.9121016507):2.605019603,t281:3.45655261):1.373965739,t282:4.768018088):0.8136730431,(t283:5.079526218,((t284:0.1571280035,t285:0.0638467903):0.5612955766,t286:0.5927528672):4.35749406):0.4643280945):1.611440792):2.672049893,(((t287:4.382016208,(t288:0.9062565008,t289:0.8413229424):3.450425102):0.5431575858,t290:4.718790688):4.575900769,(((t292:4.659773636,(t293:3.623570366,t294:3.588852806):0.8769730902):2.116142358,(t295:0.3517445562,t296:0.3225995469):6.109255298):1.087778805,t297:7.336309096):0.9616887774):0.1417422751):3.50332627,(t298:10.15426333,(((t299:1.829624858,t300:1.79338613):2.553082354,t301:4.275502925):4.885142228,((t302:4.327265798,((((t303:1.311896492,((t304:0.586412263,t305:0.5460702152):0.472595088,t306:0.8744708068):0.120495607):0.7666872131,t307:1.75851924):1.075241887,t308:2.747063875):0.8798039022,(t309:2.212421719,t310:2.167437233):1.139539651):0.2702344132):2.597406113,((t311:1.092519167,t312:1.080026058):2.564454113,(t313:2.592866422,t314:2.491098901):0.9992630335):2.517212488):2.229156149):0.8753797128):1.627582684):3.922713062,((t316:6.027462215,t318:5.71859602):0.9348381534,((((t319:2.33910516,t320:2.249813537):0.2641555157,t321:2.280124936):0.6539390834,t322:2.897393792):0.1421701059,t323:2.966605464):3.241662301):7.274731717):2.417537108):0.1557332517,((t324:5.235359742,(t325:3.86509757,(t326:2.451928526,t327:2.335546081):0.9890615749):1.335422788):2.437803421,t328:7.000230904):8.380042961):0.07310237681):8.254188898):2.281941559):0.8062797114):1.083323181,((((t329:2.552528484,(t330:1.031052015,t331:0.6907789346):1.504066465):8.335203798,(t332:5.94574127,(t333:0.9374482714,t334:0.786836203):4.941399096):4.57154679):3.872800262,((((t335:2.460138547,t336:2.382712982):1.109614237,t337:3.272439589):9.049633257,((t338:9.635586837,(((t339:3.824969988,t340:3.805556695):2.269840729,t341:6.064349308):1.067603644,((((((t342:1.130016825,t343:1.052181503):0.9792429548,t344:2.025560327):1.559616111,(t345:2.545174062,((t346:1.169817183,t347:1.11808362):0.9878281767,(t348:1.394030368,t349:1.161361926):0.5494762962):0.3496770685):0.7580997277):0.2185371746,(t350:1.375168615,t351:1.289245711):1.651125752):0.2139009308,t352:3.090177467):2.809611831,(((t353:2.784282872,(t354:0.2118854038,t355:0.0982753746):2.571221869):0.5095720769,t356:2.942622815):1.881929585,t357:4.757185766):0.4029358399):0.2084493477):2.455342005):0.06103982172,(t358:3.110545725,t359:2.68149559):4.694346672):2.574287425):1.297674159,(t360:9.460435424,((t361:3.330911684,t362:3.308272171):0.2611677996,t363:3.530079223):5.759942964):1.574507631):0.231292772):6.007406395,((t364:10.94760903,((((t365:1.792307451,t366:1.754664734):0.5446857132,((t367:1.505201894,(t368:0.1459730948,t369:0.005413225924):1.350143139):0.229938917,t370:1.463351016):0.353389078):3.39966536,(t371:0.5407266621,t372:0.3089268947):4.346679719):0.1760729791,(t373:2.484528851,t374:2.471507193):2.25775109):4.883356663):2.017311838,((((t375:2.691920488,(t376:1.719402002,t377:1.693360152):0.9530872):4.272882065,t378:6.842731401):0.2637569831,((t379:2.144303115,t380:2.140471793):3.166169064,t381:5.174618483):1.530680082):3.169061421,t382:9.803024775):1.177174951):4.075588868):6.974618362):32.06355266):3.327427922,(((((t383:0.4904234908,t384:0.4687489011):0.3202897084,t385:0.7461273435):4.832721053,(((t386:0.2593596163,t387:0.07461750781):0.8214363216,t388:0.8316134346):0.6762478633,t389:1.471824381):3.767874433):2.220295208,((((t390:0.6108745463,(t391:0.2242120238,t392:0.1682305936):0.3262596085):0.308250053,t393:0.7935856024):1.405421439,t394:2.1565249):3.55081764,(((((t395:0.9885346733,(t396:0.7498487317,t397:0.7198756355):0.1852389176):0.2887822517,t398:1.178447685):0.7338499499,(t399:1.013075167,t400:0.9812590211):0.8766592606):0.6479725165,t401:2.423021236):0.4098267395,t402:2.671575269):2.564832607):1.295247907):5.039783547,((((t403:0.5068741022,t404:0.4780495549):1.420785702,t405:1.880573649):0.5504263209,(t406:0.4923435132,t407:0.468371367):1.92756911):2.144635721,t408:4.442567273):6.583584018):44.3895297):54.12681329):57.2821623,((((((((t409:3.826028057,t410:3.67691422):0.1335249841,(t411:3.087132767,t412:3.034972913):0.6470785546):5.496641666,t413:9.118897337):4.041571954,(t414:10.92205259,(((((((t415:0.1338004061,t416:0.05847568352):0.1372758341,t417:0.1406550343):0.3948604307,t419:0.3721505013):0.7829280965,t420:0.9450034145):0.5693673983,t421:1.49737178):1.019501756,(t422:0.859145744,t423:0.7386627376):1.48225571):2.220050506,(t424:2.657660611,(t425:1.90554801,t426:1.881877848):0.6639835622):1.782124252):5.512822459):2.218774862):0.572291046,(((t427:4.85675269,((t428:3.156125594,((t429:0.9669968155,t430:0.9005349316):0.06028382616,t431:0.9605869176):2.054836308):0.4352562068,t432:3.259192832):1.237052822):0.9921366026,t433:5.471791924):0.1384195981,t434:5.594056317):6.569928083):15.00613322,((t435:4.871696378,t436:4.666094846):13.37352488,(((((t437:2.382693586,t438:2.328534839):0.237400632,((t439:0.3364443692,t440:0.3068898559):1.846411811,t441:1.991609163):0.2806603966):1.396074723,(t442:0.3658133297,t443:0.3248971951):3.268528791):0.841142732,t444:4.415536072):0.9390166228,((t445:0.2201116275,t446:0.2087640086):1.739988953,(((t447:0.4896506375,t448:0.3169168495):0.5239365496,t449:0.8213681099):0.7166403097,t450:1.500281432):0.09445345361):3.386047718):12.1878476):8.85330387):5.03006321,((t451:5.058419671,((t452:0.7432219549,t453:0.7088856176):2.901337699,(t454:2.041875515,t455:1.943787704):1.479157371):1.381777779):7.206597158,(((t456:0.8182690434,t457:0.7592320425):2.100569497,t458:2.716822572):7.274194959,(t459:0.8615389534,t460:0.8593693834):8.986532209):1.760648374):18.6361099):2.744193987,t461:32.94831438):129.9318692);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T88.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
