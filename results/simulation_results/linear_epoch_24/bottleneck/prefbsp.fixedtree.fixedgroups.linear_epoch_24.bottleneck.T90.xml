<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t459:25.48949316,(((t460:0.8525001042,t461:0.6339380386):2.009404351,(t462:0.2591613666,t463:0.1521046357):2.266467734):11.5463134,t464:13.78900146):11.07051873):11.61739633,((((t465:0.8621649573,t466:0.740541566):9.786239993,t467:10.44615818):8.752793088,t468:19.19872808):6.305021306,(((t408:0.04376521666,(t381:0.02623319581,(t365:0.1361470328,(((t352:0.05487352413,((t315:0.01787325803,(t285:0.1133395485,(t276:0.01171290523,(t229:0.2494287243,(t220:0.1025458592,(t208:0.05194525792,(t194:0.01908688903,((t192:0.05881598576,(((t162:0.1148553612,(t151:0.009779593971,(t146:0.01744278932,(((t133:0.04535430395,(t129:0.06679094918,(t122:0.02549334708,(t115:0.0753132923,(((t103:0.05864687418,(((((t18:0.06498721423,t1:1.820098674):3.494823331,t2:5.258210373):0.4562849826,t3:5.670517121):4.336083853,(t4:5.077874944,(t5:2.243117565,t6:2.217524915):2.751568432):4.389150571):0.1289062301,(((t7:6.911785453,(t8:3.958551764,t9:3.954613069):2.678994903):0.4170094984,((t10:3.643900079,t11:3.60472535):1.381233237,(t12:1.388198476,t13:1.238604479):3.592419155):2.024460821):2.115632581,(((t14:3.36225771,t15:3.165228439):5.258711748,t16:8.398409034):0.2440699357,((t17:7.165865847,(t19:1.663424706,(t20:0.5731031578,t21:0.346265785):0.8956043961):5.294917793):0.004477753183,t22:6.441274916):1.346078192):0.01196018643):0.04258144713):0.02560984859):0.05200642501,((t23:3.568579533,t24:3.378946887):2.347883812,t25:5.610839328):1.962827723):0.12557968,(t26:7.149716872,((t27:3.663708283,t28:3.609499209):1.514049892,(((t29:3.025066915,(t30:1.218194911,t31:1.13849226):1.801128221):1.388337332,(t32:3.49638682,(t33:2.620411639,(t34:2.524442851,(t35:2.200373704,(t36:1.401941793,t37:1.263072508):0.7806732119):0.1889766769):0.08015918993):0.8619087422):0.7831187819):0.05236568467,((t38:1.986187873,(t39:1.740364808,t40:1.681175881):0.2308050088):1.868238146,t41:3.706625503):0.08324400021):0.4740319061):1.845860435):0.4774589901):0.8969029509):0.5479901914):0.9128206541):0.319800836):0.06524521198,((((((t42:0.9637887679,t43:0.7634041254):2.776073071,t44:3.456558544):2.702823489,(((t45:0.1297100447,t46:0.07631961816):1.235706835,t47:1.303135589):4.114055972,(t48:5.193044654,t49:5.170923868):0.202138648):0.330452862):0.7368244528,(((t50:2.257872306,(t51:0.900219933,(t52:0.1703688411,t53:0.1508589282):0.6343888418):1.235323499):0.4374563136,t54:2.395854756):3.065375875,((((t55:0.2113405296,t56:0.1801858206):2.531616091,t57:2.651907474):1.991313211,((t58:1.336359338,t59:1.278503242):1.271720742,(t60:0.774827289,t61:0.7364909417):1.648746587):1.946410442):0.09702123937,(t62:4.356368273,t63:4.327046587):0.07082208819):0.538492227):0.4491189443):0.7378211473,(((((((t64:4.254631328,(t65:2.777193671,t66:2.773569309):1.326520732):0.0112725658,(t67:3.563994467,((t68:2.195810425,t69:2.142832994):0.3885363287,t70:2.475426435):0.88280618):0.4290546144):0.5483245248,(t71:4.018320019,(t72:3.694555606,(t73:3.648202182,(((t74:1.066256591,t75:0.8723830029):1.374991772,t76:1.920412128):0.5875058719,(t77:2.007915719,(t78:1.364162063,t79:0.9694463757):0.6208642107):0.449272833):0.4150756907):0.0172942923):0.2570926962):0.0774484174):0.3180593639,t80:2.893017423):0.5716270388,(t81:0.5402122074,t82:0.5366153321):2.91103483):0.07998493206,(t83:2.966585682,(t84:1.86447946,t85:1.388113594):0.9903676176):0.5225818736):0.01013185992,t86:2.870439932):0.2941962871):1.34462589,((((t87:1.00426369,t88:0.9866204741):1.218328843,(((t89:1.001822995,t90:0.9897028586):0.1800381945,t91:0.7950673279):0.8420973824,(t92:1.253994587,((t93:1.057856277,((t94:0.5436927083,t95:0.490821265):0.4789259344,(t96:0.6792723745,t97:0.5482102534):0.2310129956):0.0150512896):0.1033139345,(((t98:0.427800687,t99:0.4203862119):0.2903931186,(((t100:0.06929376874,t101:0.01517997974):0.02943618245,t102:0.03572566888):0.2085835532,t104:0.0629890591):0.3801935674):0.02656772808,t105:0.4503656939):0.1097474248):0.06107577073):0.2403017168):0.1440863731):0.2450594632,t106:1.097554191):0.6886810258,(((t107:0.5726312656,t108:0.4994219086):0.02521463742,t109:0.4127637803):0.7724064215,t110:1.078675777):0.1756086982):0.9084652729):0.04896490198):0.7730562571,t111:2.948916162):0.3357835295):0.5912933561):1.069966819):0.631882763,((t112:2.868123339,(t113:2.715567442,t114:2.695847887):0.1323279732):1.775600897,(((t116:0.4715138817,(t117:0.3572590672,t118:0.2763450471):0.02040524265):2.313162387,(t119:0.1304257203,t120:0.04309315687):2.337225415):0.6414451397,(((t121:1.653646531,t123:1.498981519):0.2243551332,(t124:0.8125947555,t125:0.5353754456):0.8109871995):1.070441954,((t126:0.2774505881,t127:0.2284820867):0.943051477,t128:1.000522866):1.133871424):0.02839253645):0.8946565284):0.8966889048):0.3085497998,((((t130:0.7549566951,t131:0.7397244655):0.9830137722,t132:1.71512667):1.40721252,(t134:1.036719936,(t135:0.7474756469,t136:0.6923814737):0.2516804203):1.680473991):0.6779477025,(t137:2.503258554,(t138:1.604337596,t139:1.468082672):0.8459066148):0.7970855564):0.2499398179):2.401566594):0.1856865941,((((t140:1.420992507,t141:1.263680673):1.030931915,(t142:1.725846936,t143:1.72217446):0.4088238496):1.105258557,(((((t144:0.4085384993,t145:0.3122674496):0.07242858728,t147:0.08898892238):1.136734595,t148:1.206990349):0.4706994276,(t149:0.4619508196,t150:0.1388208886):1.040234721):0.02811526296,(t152:0.320517785,t153:0.06259686184):0.7831907924):1.09531331):1.114575819,t154:3.023215179):1.233790284):0.261508807):2.040544671):1.338066304):1.334778971):3.576652859):0.6657690186):3.291184235):1.440751185,((((t155:2.326902779,((t156:0.9598661021,(t157:0.1686708403,t158:0.1190740929):0.7225274398):0.9979437048,t159:1.769987669):0.298948675):0.05849938366,(t160:0.8397979818,(t161:0.4201472075,t163:0.2087799547):0.1788531363):1.256320609):1.284944289,(t164:2.720637032,((t165:0.4054128687,t166:0.2784565679):1.461108544,(((t167:0.2713519397,t168:0.05954042842):0.4835567116,t169:0.5203265647):0.6105011617,t170:1.100690055):0.3314395178):0.6401094651):0.05424905746):6.887778297,((t171:1.527300829,(t172:0.3849648295,t173:0.376056601):1.11342083):0.277301867,(t174:0.3329205221,t175:0.3109151345):1.240452627):7.179771777):7.607211849):2.225722631):0.3163463151,(((((((t176:0.8894423874,t177:0.6467771376):2.249014389,(((t178:0.738325516,t179:0.7114115891):0.04135252435,t180:0.6428816767):0.3156611641,(t181:0.8578071973,((t182:0.0808545362,t183:0.009016142863):0.7061866938,t184:0.597726771):0.02723274357):0.08390617337):1.651264064):4.056458422,((t185:0.7009771318,t186:0.6602402107):3.050825273,t187:3.685331845):2.37306454):1.2732281,(t188:6.598660667,((t189:0.7623973416,(t190:0.3776348514,t191:0.2875768409):0.3182643801):4.609358903,(t193:2.683283581,t195:2.251644553):2.207518964):0.9728266081):0.6838499684):2.093397031,t196:7.903065319):1.626238116,(t197:2.984266265,t198:2.835337968):6.490913554):3.921884429,(t199:9.159593262,(t200:4.791484954,(t201:3.622857692,t202:3.531678024):1.148713363):3.786434767):4.053271598):2.454126386):0.06142108438,((((((((t203:5.340224061,t204:5.146371259):0.724814211,((t205:2.294293244,t206:2.226169074):0.5427017183,t207:2.41062815):3.013467957):0.6868451773,t209:5.943894436):1.198611733,(t210:4.893371397,t211:4.878215449):2.026866948):0.3553947767,t212:7.228723118):0.3517045374,((t213:2.91466423,t214:2.858416092):2.794131032,(t215:4.26914548,((t216:2.535468752,t217:2.220385044):0.7153152098,t218:2.736551331):0.9228294812):1.340181629):1.720068865):6.223233876,((((((t219:1.552098356,t221:1.289886035):0.5940632723,(t222:1.418815998,t223:1.356101485):0.4321268909):0.9775980081,(t224:0.4761118537,t225:0.3345939138):2.277127357):1.435473418,((t226:2.157946885,t227:2.03080601):1.368966931,(t228:3.183641097,t230:2.234517172):0.2075497489):0.4494997537):3.043920388,(((t231:0.2071318727,t232:0.1445172683):1.238856784,(t233:0.2339859184,t234:0.08147751574):1.048684019):1.747580516,((t235:1.405990788,t236:1.343855146):0.7346382631,t237:2.055261442):0.7060510096):2.735106299):4.996243988,(t238:9.166282215,(t239:5.980612588,t240:5.923807327):3.183705068):1.310948377):0.3365561872):0.1407558132,((t241:5.987496972,((t242:1.86858537,(t243:0.7066248853,t244:0.4474385555):1.126335731):1.872424779,t245:3.441085025):1.93560946):1.508390206,(t246:6.390162518,(t247:1.244213555,t248:1.221936381):5.077851584):0.4821720259):3.272879911):0.008160004699):1.2633029):2.053399465):2.247199976):12.99892219,(((t249:6.390617821,t250:6.378840135):7.991869814,(((t251:1.31398181,t252:1.294026953):2.868201932,((t253:0.7017152996,t254:0.6725975603):1.873120553,(t255:1.433140282,t256:1.345660889):1.081541004):1.579331992):7.725569304,(t257:10.07160323,(((((t258:0.4481628783,t259:0.3783977333):3.47480481,((t260:1.729023662,t261:1.615374898):0.6865024523,(t262:0.452722357,t263:0.3923035277):1.813804668):1.38341218):1.762202395,(t264:1.388569177,t265:1.110251784):3.882899823):1.370261049,(((t266:0.639479312,t267:0.4537937714):0.8387804404,t268:1.255975166):4.711713979,(t269:2.893725765,t270:2.692111532):3.066712184):0.1372640796):0.754527065,(t271:4.194024034,(t272:2.614861185,t273:2.512607118):1.516997191):2.35448136):2.001491025):1.657265415):2.434982425):10.53372591,(((((((t274:1.641848723,t275:1.577193429):2.080239914,(((t277:0.114326569,t278:0.01975759137):1.601965993,t279:1.448468674):0.6082691082,t280:2.019356962):1.267885242):4.730899669,(((((t281:0.06736845759,t282:0.06204504383):0.8291193282,t283:0.8248696549):0.4305779785,t284:1.225923822):2.596319729,t286:3.508953365):2.833675906,(t287:2.492100301,t288:2.032079422):3.815432528):1.248690344):0.9312270207,(t289:2.601411627,(t290:0.3047049286,t291:0.2185992564):2.235511508):5.417211565):1.936642519,(((((((t292:0.9873187882,t293:0.9608913371):2.489313854,t294:3.354090201):1.16589984,(t295:2.215732679,(t296:1.721983426,t297:1.698755725):0.4732951449):2.157600457):0.3282931986,(((t298:2.651492625,t299:2.196016134):0.6280108434,t300:2.750148751):0.5039087777,t301:3.067485694):0.8396934594):0.4019156764,t302:4.123782845):0.5568271396,t303:4.508558217):0.1363084518,t304:4.635593083):3.496386256):3.93305893,(((t305:3.467470584,t306:3.250438152):3.151918938,(t307:5.190284815,(t308:4.613619044,(t309:0.6391752689,t310:0.5088246354):3.805757123):0.554590917):1.067910027):5.196776538,(((((t311:0.3802481363,t312:0.3566860859):1.514312909,t313:1.870215145):2.366107614,((t314:0.1659890046,t316:0.01164614417):0.6995279123,t317:0.6920198655):3.341468997):1.32767061,(t318:0.4557142139,t319:0.4083470285):4.886089238):4.35059135,(t320:2.536449361,t321:2.3895672):6.754625664):1.168725371):0.2136958037):5.088077101,((t322:8.165931327,(t323:7.755360463,t324:7.750256225):0.1223706131):7.096763382,((t325:4.532751844,((t326:2.041486272,t327:2.022491215):0.175184852,t328:2.178051062):2.273451601):0.6579807908,(t329:4.927191385,(t330:4.723565647,(t331:0.9196050926,t332:0.8165724454):3.729249287):0.08861291151):0.141851562):9.755243063):0.2359697398):2.623999168):3.676692568):8.072486951,(((((t333:7.92071497,(t334:0.9434071818,t335:0.9245541405):6.533244416):0.5209810645,((t336:2.760556001,t337:2.689011006):5.002546623,(t338:2.413261464,(((t339:0.7617442955,t340:0.7029010721):1.290510858,t341:1.847962759):0.09111975824,t342:1.850434833):0.202849728):5.064832337):0.1717860814):10.52088167,(t343:10.91641301,((((t344:0.5992709133,t345:0.5922063957):2.306359376,t346:2.750389384):1.598924805,t347:4.193677014):4.554078069,(((t348:4.025544029,(t349:0.3663951206,t350:0.2788769687):3.551132389):0.02653853168,t351:3.844364624):1.35373205,(((t353:1.513000531,t354:1.511268829):0.390529004,(t355:0.1701938441,t356:0.09600359162):1.624420957):2.180154769,t357:3.757679394):0.8951561329):3.252921723):1.828834578):6.852187322):1.014792871,((t358:9.956315954,(t359:1.480155243,t360:1.32968209):8.372233035):2.643142646,(((t361:4.535957899,t362:4.46513442):2.0655346,t363:6.488792526):0.3860499546,((t364:1.612676219,t366:1.036625297):0.3576066433,t367:1.353504863):4.869901227):5.330095013):4.523989189):1.276427888,(((t368:3.650031971,t369:3.636926238):3.997054548,((t370:1.271120455,t371:1.109211423):4.461981693,(t372:2.529237087,(t373:0.3736922546,t374:0.2610866191):2.123774437):3.039701102):1.716949391):7.155320098,(((((t375:1.833902276,((t376:0.8233017593,t377:0.5253224133):0.4196756444,t378:0.8085658314):0.4939267126):1.47828782,t379:2.404895003):3.913755812,((t380:1.45130371,(t382:0.3494434037,t383:0.2597162376):0.8180269904):4.59926771,((t384:3.337231666,t385:3.236156027):1.51570426,t386:4.727096777):0.7230357937):0.2043556277):0.6761639474,(t387:5.868775981,(((t388:0.73002564,t389:0.7191080314):0.6386749567,t390:1.218416707):0.8734064523,t391:1.944129042):3.42644022):0.4393172071):2.581549112,(((((t392:1.209398654,t393:1.194425235):0.3451835943,(t394:0.4824470286,t395:0.4774733009):0.969180539):2.662801028,(t396:0.3397441289,t397:0.3365618751):3.623836407):2.104390207,((t398:0.5392548608,(t399:0.1271797435,t400:0.1229226563):0.4108382865):0.7186046228,t401:1.102679591):4.732988793):0.9492187895,(t402:4.986629603,(((t403:0.07045684044,t404:0.06861563434):0.3960164492,t405:0.2387429116):3.52083979,(t406:3.118068669,(t407:2.180171892,t409:1.955413574):0.7678009389):0.620624399):0.9169894791):1.62462604):1.037743424):3.758492918):2.550259857):7.701272572):10.69139875):10.76106699):7.443567253,(((((((((t410:0.6388402711,t411:0.5639119883):2.523693783,t412:3.03741053):0.514100523,(t413:2.798292738,t414:2.732493336):0.2726736379):3.030033523,(t415:4.22114758,((t416:0.692655804,t417:0.5194810274):0.7607776171,t418:1.135781754):2.730331445):1.813528095):0.2956932652,t419:5.754923776):1.5580294,(t420:3.259885423,t421:3.241493858):3.988505648):0.236498863,t422:7.403604214):5.391385357,(t423:3.348355432,t424:3.07587635):9.38283005):33.0979105,(((t425:1.217605198,t426:1.196085244):20.89732815,((t427:4.474190242,((t428:1.484595673,t429:1.296509908):0.02389731816,t430:0.8441667416):2.95493332):1.058318102,t431:4.429779543):16.4185428):23.14278897,(((((t432:3.203418728,t433:3.143072729):0.5589347131,t434:3.636180162):0.3731318466,t435:3.935138812):5.272687318,(((t436:0.4186889122,t437:0.3752066175):2.963906347,(t438:2.2556637,t439:2.201984926):1.053783699):4.103860059,((t440:2.645792878,t441:2.635356373):2.041526152,((((t442:1.298304056,(((t443:0.2966861072,t444:0.1794998174):0.03079752381,t445:0.1398403158):0.4592171206,t446:0.5601225443):0.3809976261):0.872139835,t447:1.784198418):0.5859687503,t448:2.227627284):1.685035513,t449:3.814653015):0.2117529943):2.468241028):1.698178788):6.750479113,((t450:1.208418632,t451:1.12638431):11.84834671,((t452:0.9573631128,t453:0.8888371005):6.193218009,(t454:5.655740556,t455:5.544434234):1.368518847):5.787793022):1.788379643):27.7013432):0.2409122136):2.455423644):3.279029626,(t456:3.10683124,(t457:0.1830365556,t458:0.1028290881):2.915487436):44.94073007);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T90.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
