<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t442:4.192618068,((t443:0.3860918464,t444:0.2704221419):2.944553388,t445:2.965692589):0.6778202868):23.52502942,(((((t446:1.400378403,t447:1.267423709):0.7999662045,t448:2.041527968):0.5708527024,(t449:0.08554798659,t450:0.07811375862):2.406742708):6.98466976,t451:9.452107629):16.23597494,((((t452:1.335926392,t453:1.282335163):0.3739798888,(t454:0.4473804908,t455:0.3386084416):1.186186318):5.223448009,t456:6.64374211):11.76207319,((((t457:0.6307270829,t458:0.606943922):0.6505354558,t459:1.077471556):2.45508476,(t460:1.336496058,(t461:0.4619990159,t462:0.3148231511):0.6991858755):2.174474102):5.354623623,(t463:0.3311542228,t464:0.2813545859):8.168274214):9.289163694):6.96862661):1.156299193):9.245867295,((((t465:1.904413081,t466:1.646270394):1.659220811,(t467:1.901384028,(t468:0.3426917551,t469:0.2034525347):1.452766888):1.396196224):6.066863281,((t470:2.46340524,(t471:1.394398729,(t472:0.7943055696,t473:0.7292175015):0.3613467231):0.9205269098):4.91826777,((t474:0.7211249327,t475:0.6606660495):2.115070169,t476:2.67045117):4.075989117):1.7332694):17.41830829,(t477:8.771323329,(((t478:2.43579291,t479:2.327828925):2.216392909,(t480:0.8312866073,t481:0.7873845128):3.332345069):1.296922315,(t482:2.116105608,t483:1.801059973):3.265186983):2.739688749):16.96110228):7.890033341):21.13490856,(t484:0.8636413215,t485:0.8323425212):52.8871303):6.146295888,((((t486:14.97736288,(t487:2.970890488,t488:2.849811257):11.91520296):3.463792151,(t489:0.2608152819,t490:0.08873709111):17.88640567):3.574282339,((t491:2.02654326,t492:1.953051621):9.561086283,(t493:6.347654739,t494:6.345496989):4.87753913):9.883034566):24.89752238,((((((t404:0.1192034867,(((((t235:0.186753528,(((t195:0.3334860104,((t187:0.01438246347,(t186:0.09784273795,((t148:0.09011177558,(t135:0.04409864297,((t129:0.1079602542,((t108:0.04061559003,(t77:0.2036681617,(t52:0.007569755171,(t1:4.3082022,t2:4.259101641):0.04223314838):2.655779183):2.565790073):1.037469235,(((t3:0.8687405332,t4:0.8252657663):5.811787736,(t5:2.342998012,t6:2.124944634):4.136933647):2.865831526,(t7:5.213872171,(t8:2.504337628,t9:2.402569199):2.640555498):3.867775644):1.012055612):0.3684787146):0.6669184158,t10:10.83625841):0.1176869477):0.9735583485):2.881945858,(((((((t11:2.756750181,t12:2.589877291):1.073310531,t13:3.619776866):3.462836646,(t14:2.505653262,t15:2.498845803):4.542334636):2.787402406,((t16:8.802139176,((((t17:2.517068494,t18:2.281324514):0.8771480141,(t19:2.026010611,t20:1.935329813):1.070814945):0.862179892,(t21:1.935596587,t22:1.814522099):1.825563039):2.380473341,((t23:1.809011515,(t24:0.127067978,t25:0.1087046443):1.652542866):2.476657307,t26:4.163977565):1.719383355):2.076284513):0.03404676264,((t27:1.280423264,t28:1.080019281):4.349350689,((t29:1.924066312,t30:1.739048801):2.522932647,t31:4.235819211):0.905456201):2.245375228):0.8995556713):3.556502478,(t32:11.19448419,(((t33:7.051742923,(t34:5.906458367,((t35:5.41916046,t36:5.379886803):0.08969661743,t37:5.418924855):0.3467355539):1.085798371):0.2759717128,t38:7.117689785):1.713842932,((((((t39:0.6534610668,t40:0.584131717):2.73993492,t41:3.250605492):3.588879682,(t42:2.453280718,(((t43:0.1318343505,t44:0.09125282245):0.8766167515,t45:0.8902830209):0.07986758013,(t46:0.4364496625,t47:0.3565138491):0.4925367136):1.353020518):4.267837046):0.5727332741,((((t48:2.824044368,t49:2.722764433):0.3378857877,t50:2.731061132):2.174561722,t51:4.889376325):1.165830543,((t53:5.543094231,((t54:1.470338399,t55:1.397481601):1.940475016,t56:3.141853478):2.104942423):0.3207005154,(((((t57:3.768927602,t58:3.734118009):1.529907115,(t59:5.180245915,(t60:4.282721041,t61:4.198988415):0.8779950983):0.07706958359):0.07992474443,(t62:0.5441358095,t63:0.4878479117):4.214605534):0.01247233543,(((t64:4.510483285,((t65:0.7436541781,(t66:0.4296164476,(t67:0.3027951101,t68:0.2529457512):0.04508875469):0.2564854511):0.9170744488,t69:1.04754577):2.663857201):0.04685043015,t70:3.710100983):0.1119536052,(t71:1.533066852,t72:1.523287931):2.269314425):0.04477666393):0.02030533478,t73:3.822620956):0.08858752615):0.04906767662):0.4540855408):0.194784745,((t74:0.8867444919,t75:0.8685078469):2.581183896,(t76:2.944102445,t78:2.618316036):0.3927123771):0.8933865644):0.1087046947,((((t79:2.639967691,(t80:1.447343514,(t81:1.355931045,t82:1.151160509):0.09035927233):1.126814435):0.3787355322,((t83:2.55809588,t84:2.554820795):0.05149964813,t85:2.393403473):0.03150470711):0.550993643,((t86:2.268513529,(t87:1.790303838,(t88:0.4143987754,t89:0.3878842946):1.365247146):0.3947699108):0.005100777344,((t90:0.8413046545,(t91:0.7785396658,t92:0.6051282546):0.05068612698):1.201113344,t93:1.81064435):0.06825826266):0.6549599513):0.240846395,(t94:1.849169706,t95:1.726376697):0.8969822993):0.134599544):0.8035076016):1.993464473):0.6426322617):0.7485073422,((((t96:1.448695408,((t97:0.5743653513,t98:0.5340368612):0.1806320271,t99:0.537463641):0.6874206496):1.197549527,(((t100:2.264983735,((t101:1.006885723,t102:0.7953765316):0.01516190681,t103:0.7857703565):0.9093362858):0.0775496007,t104:1.688573035):0.01324331369,((t105:0.5165336576,t106:0.4694386108):0.3227714293,t107:0.7893763887):0.8369460818):0.04823893957):1.434043978,(((((t109:0.9998304193,(t110:0.631618963,t111:0.6045897974):0.3577601484):0.6423074949,(t112:1.036306734,t113:0.8432218889):0.4147044911):0.4186343873,(((t114:0.567576027,(t115:0.1516346354,t116:0.1370510808):0.3520448836):0.2604705283,t117:0.7148850217):0.7317071161,(((t118:0.506167539,(t119:0.1179155071,t120:0.05337890532):0.3534411443):0.31305681,t121:0.6810125786):0.5692211297,((t122:0.04770858827,t123:0.01990600497):0.4500334813,(t124:0.3617941429,t125:0.3548072273):0.07192616335):0.7002911192):0.001578728034):0.1086002614):0.3461376985,(t126:1.187141147,(t127:0.4342769264,t128:0.3846389555):0.6446902043):0.2192166839):0.2552311077,t130:1.179042229):0.3252460754):0.9090364263,((t131:0.1956973871,t132:0.07914830728):0.8965166301,t133:0.7924711378):1.309831596):1.7326644):0.0552831145,(t134:0.6680255584,t136:0.3270431627):3.142734726):0.3481799772):0.4612531281):0.023776665):0.6557280242,((t137:2.292862579,t138:2.077154028):1.507480767,((((t139:1.195696697,(t140:0.7034468673,(t141:0.3387083077,(t142:0.03203001365,t143:0.02707816779):0.2975436145):0.3532780695):0.4387973225):0.5270377166,(t144:0.8080752989,t145:0.7411373922):0.7902021981):0.04692120402,((t146:0.3639933628,t147:0.2978598665):0.6778437877,t149:0.3837141206):0.4966860272):0.1234243478,(t150:0.2422508398,(t151:0.2018027711,t152:0.193220722):0.03613280748):0.3925496567):1.617804957):1.03497663):0.6323020335):0.1656759492,(t153:3.030859822,t154:3.026294138):1.012808952):0.5938716423,((((((t155:0.2336974744,t156:0.05809758554):0.6316189147,t157:0.658900396):0.04001713503,t158:0.697339722):1.0742403,((t159:0.1181931137,(t160:0.06823499959,t161:0.04016488178):0.02604899888):1.307627453,t162:0.9181450546):0.3013302569):2.444473999,(((t163:1.049261553,t164:1.04577859):0.5401266903,((((t165:0.5406313664,t166:0.4404805814):0.163375456,t167:0.5123489462):0.4122653159,t168:0.8665730071):0.3001329421,(t169:0.1485442722,t170:0.1330440326):0.9445697738):0.1547068259):0.577022258,(t171:0.735322127,((t172:0.1321242784,t173:0.1166872757):0.3366058563,t174:0.2633069863):0.1765679895):1.061541063):0.9748693032):0.1490489708,t175:2.594618481):0.02050157306):3.112232144):10.49450815,(((((((t176:1.361201569,t177:1.301161741):0.03959808883,(t178:0.6748723494,t179:0.6619404503):0.6178182541):5.173753483,((((t180:0.198693932,t181:0.1686652531):2.260956408,t182:2.424688521):1.322352895,((((t183:2.466772955,(t184:1.366441807,((t185:0.6288016039,t188:0.2690582467):0.4164151433,t189:0.4971829072):0.2880729079):1.083621636):0.4743266229,t190:2.196423347):0.1924356104,t191:2.279779271):0.2936856283,((t192:0.2299127587,t193:0.1458143503):0.5516646481,t194:0.6143182543):1.700207502):0.2821905544):0.1292345301,(t196:0.2249769717,t197:0.1413516457):2.063145977):2.470215987):0.3673909546,(((t198:0.8427283385,(t199:0.4217472698,t200:0.3934996577):0.2968167784):0.1337182508,t201:0.7944211334):3.957540427,(t202:0.6616344368,(t203:0.4674898615,t204:0.3599739216):0.07939474269):3.87984531):0.08374624115):0.1606933238,t205:4.558990247):3.517414115,(t206:0.9978713756,t207:0.8061898676):6.767581498):1.161334977,t208:8.645972079):4.364079237):0.3927605515,((t209:7.418077807,(t210:0.3556416562,t211:0.03849328837):6.852064091):3.934612077,((t212:3.478634771,((t213:3.36195982,(t214:1.926122759,(t215:1.396261038,t216:1.369705339):0.4084977525):1.270184025):0.04905388196,t217:3.048741647):0.04416924257):4.929896019,(t218:3.184206968,t219:3.181250964):4.837213573):2.289607811):1.962677211):3.536848607,(((((t220:7.493616044,((((t221:3.509597513,t222:3.478765225):2.268169587,t223:5.715733975):0.5084616761,t224:6.148993134):0.4618394745,(t225:3.609473693,t226:3.575805115):2.991764966):0.7312285049):0.03096454656,(t227:1.79625205,t228:1.727147351):5.356860397):0.8005192211,(t229:0.5132037605,t230:0.3716699033):7.331083884):0.0470350143,((t231:0.3859051411,t232:0.3316052487):4.571056334,((t233:0.813718647,t234:0.6105652267):2.805148586,(t236:1.271367343,t237:1.091241128):1.35040228):1.260176752):2.757588843):3.402947328,((((t238:2.609154514,(t239:1.825981562,t240:1.710207272):0.5224666687):0.7827279363,t241:2.996633849):0.1992857627,t242:3.157742951):5.293697879,((t243:1.398628521,t244:1.340623307):0.5918147378,(t245:0.3315417545,t246:0.2723572861):1.58055415):6.170818715):0.8864177307):3.874177791):2.3616871,(((((t247:2.618831422,(t248:0.7226976566,t249:0.6657862431):1.889049304):3.735691112,(t250:5.627316174,t251:5.607498717):0.6065734881):2.204089934,((t252:3.278634336,((t253:1.389657039,(t254:0.2712553951,t255:0.2021137617):1.108279684):1.763035201,((t256:1.281294639,t257:1.243198546):0.9268075688,t258:2.117534041):0.8152552175):0.0379675797):0.9913070797,((t259:1.564563856,t260:1.511366418):1.205747756,t261:2.633820686):1.079263587):3.879671119):1.926038743,((t262:2.972109778,t263:2.966735441):5.571278331,t264:8.527396076):0.6629286137):2.114379629,(((((((t265:0.9563979726,t266:0.412025664):3.68655375,((t267:0.9545619122,t268:0.9015365063):1.30587551,t269:2.165160298):1.80094842):0.2640358626,t270:3.986522449):1.017906198,(t271:2.354202189,(t272:0.5827380775,t273:0.4758943215):1.758455864):2.553440193):1.802406995,t274:6.576272618):0.1841960074,t275:6.676686276):2.393970041,((((t276:3.579166249,(t277:3.250615409,t278:2.999939161):0.2928812034):1.208031315,(t279:4.26423104,t280:4.216885679):0.2087865819):3.493826052,(((t281:0.9184481891,t282:0.7096674878):1.996340085,(((t283:1.763193918,(t284:0.1408151242,t285:0.08461412026):1.323268827):0.01213792131,(t286:0.4913444856,t287:0.1637666609):0.9238503453):0.4326085428,t288:1.466542615):0.4386599534):2.735521878,((t289:2.487965638,t290:2.290763012):1.152139123,t291:3.116417655):0.8242993076):2.246221602):0.5533162344,((t292:2.0326897,((t293:1.009646295,t294:0.9762820278):0.3777019629,(t295:0.6266598971,t296:0.5930685126):0.6615408983):0.4991872863):3.947923658,t297:5.596321568):0.7119918756):0.1301547149):0.9060057261):2.540156082):0.1107235493):0.9909771769,((t298:2.367927919,t299:2.326838906):4.160039034,t300:6.240226046):4.369704786):3.341290235,((((((t301:5.907187266,(t302:5.750032291,((t303:0.8711646938,t304:0.8114505329):4.128264152,t305:4.932476088):0.7056323922):0.1362578899):0.5697644013,(t306:2.669776749,t307:2.522440239):3.573746595):1.782195288,(t308:4.61744293,(t309:1.099552427,(t310:1.001298184,t311:0.9852264241):0.0964194573):3.468041564):2.991375441):2.520035107,((((((t312:1.165874698,t313:1.152338163):0.8880818579,(t314:1.764425251,(t315:0.4540050546,t316:0.2972774408):1.248366049):0.1899451019):2.734636034,t317:4.126632234):0.27681196,(t318:4.021650104,(t319:3.822743158,((t320:1.811012779,(t321:1.05779258,t322:0.8680885924):0.5437944105):0.9626680336,t323:2.372776353):1.006522763):0.05298603744):0.2489303245):0.9117906039,(((t324:1.005083142,t325:0.9841914635):0.3236864506,t326:1.221761582):1.940648198,t327:3.097975237):1.237976697):3.395583752,((t328:2.020287583,t329:1.99188511):4.995195054,(t330:1.903606407,t331:1.878096543):4.954984335):0.7120502111):0.657368916):1.28309548,(t332:5.920643811,(t333:3.104750198,t334:2.960355987):2.779829487):3.464609004):0.05405107588,((t335:8.801124903,((t336:3.610664503,t337:3.528340984):0.8180863624,(t338:3.071556361,(t339:1.214607551,t340:1.181928394):1.756180613):1.156409361):4.364978824):0.002678554271,(t341:5.022859389,t342:4.954011937):3.411942649):0.4427241664):1.732988889):0.8341684862,((t343:5.542991752,((t344:0.5881463692,t345:0.5011922282):1.667050329,t346:2.156607597):3.232048399):4.287087867,(t347:7.457731844,t348:7.22988623):2.184834267):1.532411268):2.212399382,(((t349:4.987875974,t350:4.960608295):1.859248745,((t351:2.406042703,((t352:0.2410517604,t353:0.2337041044):1.249266117,t354:1.438025928):0.9106284768):1.912573607,((t355:0.5970070021,t356:0.5896738161):2.771399995,(t357:0.3396861409,t358:0.3317232053):2.940447675):0.8487063298):2.417760257):1.114861839,((((t359:3.218714504,t360:3.141675661):1.611696557,(t361:2.16887783,t362:1.958156003):2.391866827):1.775205414,t363:6.075148716):0.8520392095,(t364:2.479034811,((t365:1.507760939,t366:1.479845139):0.2239394498,t367:1.659268947):0.5455101008):4.276319285):0.07879981821):5.168484173):28.69617056,(((((((t368:9.920853581,((t369:0.1729766923,t370:0.1272332069):4.304085874,(t371:1.438364677,(t372:0.3851403544,t373:0.3662337597):0.918049658):2.902870326):5.364706991):0.2938239875,(t374:4.027494908,(t375:0.7933619838,t376:0.7006032849):3.222015061):5.730334065):2.778196828,(((t377:2.86404031,(t378:0.4083358495,t379:0.2891325801):2.402717297):7.367665076,t380:9.834265142):0.5479435036,((t381:0.2010856301,t382:0.1153656484):0.4348008642,t383:0.5300360907):9.736126468):1.613019324):1.345568117,((t384:3.074051672,(t385:0.7482189773,t386:0.6155158765):1.935156251):6.039826227,((t387:4.47395931,(t388:3.57743473,t389:3.504492518):0.7150749734):2.101192399,t390:6.249058081):1.931154441):3.699671273):4.456169279,((((t391:8.207127133,((t392:0.631725535,t393:0.5802200736):0.4608747802,t394:1.036887011):6.876504729):0.2207448718,((t395:1.61421322,t396:1.601472908):2.914429327,(t397:1.092941232,(t398:1.048217933,t399:0.9731568143):0.02598876416):3.216998989):3.470022904):3.178806269,(t400:5.062368036,t401:4.771348057):5.695003662):0.602534193,(t402:2.382467177,(t403:1.779444561,t405:1.567553848):0.4698399567):8.551332272):3.980111529):0.432677625,((((t406:2.670409953,t407:2.593043918):2.858217797,t408:5.393108691):1.140594968,(t409:0.9444976525,t410:0.9040677772):5.584424331):6.820477004,(((t411:1.733238628,((t412:0.2959730135,t413:0.1742815579):0.944904703,t414:1.002031865):0.336909564):2.756812033,(t415:1.262234729,t416:1.095585083):2.816026551):0.9844294871,t417:4.649781959):7.657167247):1.393004058):7.078637055,(t418:13.1984492,((t419:8.469653279,t420:8.428074719):3.625656015,(t421:9.593512629,((t422:3.644599804,t423:3.489713036):3.277671873,(t424:1.029533575,t425:1.020571024):5.647930343):2.582628303):2.375984968):0.9266249143):7.381874184):13.96940394):19.6203665):12.91011245):43.33596174,(((t426:0.7200944478,t427:0.6162542094):3.524280024,(t428:2.486117507,(t429:1.242099931,(t430:0.63725483,t431:0.472047234):0.5764090351):1.188201428):1.590787376):22.28939366,(((t432:0.3562454808,t433:0.3191718285):6.741252611,(t434:4.901988089,(t435:1.573263427,(t436:0.7508088891,t437:0.5687523793):0.5947589397):3.22172736):2.108074184):0.1225085306,(t438:2.525784096,((t439:1.323688982,t440:1.247928606):0.3458803172,t441:1.490025538):0.731095539):3.952902901):18.27058554):83.17808817);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T22.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
