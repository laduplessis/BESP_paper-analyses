<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((t384:0.4828678477,t385:0.4439392146):0.1363004659,t386:0.568188901):2.37339144,(t387:0.1023514397,t388:0.08891019323):2.64859998):5.25246227,((((t389:2.827585861,t390:2.712083402):1.766797913,((t391:1.112181156,t392:1.094087938):0.6554727423,(t393:0.3360568227,t394:0.1416578658):1.3683852):2.603350604):0.9650334172,t395:5.067771858):2.226709288,(((t396:0.7293646114,t397:0.6826052514):1.77747295,t398:2.430018228):0.01755295525,t399:2.268472961):4.734847946):0.1249558774):1.108871409,(((((t400:1.739557993,t401:1.632527367):1.348626691,(t402:0.3340629196,t403:0.2864583807):2.577927731):0.5738466253,(t404:3.074275583,t405:2.977320866):0.3638531182):0.8735887201,(t406:1.942179989,(t407:0.08750958771,t408:0.01863605886):1.786200823):2.246632619):1.920198642,(t409:4.225481632,t410:4.03300833):1.712762117):1.709924843):1.451362639,((t411:2.326299752,t412:2.326128336):3.388745441,t413:5.686325934):3.066094322):0.6950675871,((t414:0.3451429639,t415:0.2651026771):2.241302704,(t416:1.142599276,t417:1.134761559):1.197091864):6.79709802):57.78439,((t418:5.670902468,((t419:0.9748102549,t420:0.8593736507):1.849081675,(t421:1.47188749,t422:1.366484946):1.159829129):2.670323857):10.43976114,((t423:0.7510857144,t424:0.7508029285):2.674774778,(t425:2.022040105,t426:1.906845281):1.391988239):12.05872876):50.79814809):126.4573029,(((((t427:0.8278491522,t428:0.7543619849):8.794018957,(((t429:5.69816369,((t430:0.3378459971,t431:0.09351418692):0.9376723342,t432:1.018786486):4.285228979):0.6871813212,(((t433:1.816627798,(t434:1.08350226,t435:1.083150839):0.6519621651):1.986215485,t436:3.65612643):0.732070692,t437:4.342253549):1.442547333):1.025289823,(t438:3.585194908,((t439:0.8748882362,t440:0.8480260154):1.54624529,t441:2.183783918):1.112023766):3.098235619):1.907669992):20.28306769,((((t442:0.7293506677,t443:0.6783058153):1.115814071,t444:1.729409326):0.6394049913,(t445:0.03851862202,t446:0.02885114491):2.078042154):7.824563854,(t447:3.269768239,t448:3.106852748):6.653703981):18.23178446):6.735597294,((t449:18.11718635,t450:18.0839293):1.197207872,t451:19.20144255):15.25435289):126.7529352,((t452:30.00007989,((((t453:3.713954189,(t454:1.394749325,t455:1.216811068):2.285171153):5.730070664,(t456:8.687724936,((t457:1.457588722,t458:1.419078852):4.460228837,(((t459:0.9732082976,t460:0.9688181492):0.3879791812,(t461:1.006620509,t462:0.9651693691):0.2803633907):2.62083315,((t463:2.489483724,t464:2.428795937):0.08409407406,t465:2.135249132):1.214542603):1.861440763):2.73521907):0.5213458737):3.359478388,(((t466:1.93985031,t467:1.804955986):2.313817629,(t468:0.956150273,(t469:0.4777653985,t470:0.01282877333):0.2279374061):3.153232789):5.79062847,(((t471:1.122625453,t472:1.047800613):0.2324220461,(t473:0.4212093597,t474:0.01319053323):0.8011088778):6.572121363,(t475:0.8884698277,t476:0.8875151098):6.492554118):1.141004058):1.715119056):0.8876890137,((t477:3.247906289,((t478:1.339513443,(t479:0.6334922177,(t480:0.2528307239,t481:0.1578624762):0.3689663854):0.6763165737):1.000955424,t482:2.145009841):0.8856573741):7.787250556,(t483:8.540278087,(((t484:2.275935263,t485:2.249681551):1.430115544,t486:3.642450729):0.6179068493,((t487:1.127595534,t488:1.108411714):1.090284202,t489:2.086785468):2.01991515):4.214144024):1.961702772):0.07383162096):16.24903384):114.9560472,(((((t490:1.39494896,(t491:0.3383973144,(((((((t325:0.05229723832,((((((t238:0.01373049993,((((t203:0.106673817,((t193:0.03422816917,((t179:0.1226736139,(t180:0.0361553229,(t175:0.01377119865,(t169:0.08668765545,((((t137:0.006702341012,(t135:0.1172741032,(t129:0.01010312756,(t125:0.1077530387,(t94:0.07254958736,t1:8.970874113):2.598194532):0.3017408301):0.6321490797):0.2066490118):0.7886857336,((((((((t2:7.445153552,((t3:4.678795419,(((t4:0.1030815135,t5:0.0395667924):2.334612108,t6:2.002518655):0.3821301006,t7:2.333232003):1.856475162):0.396865495,(t8:2.724206165,t9:2.543388232):1.703547641):2.323731704):2.421005079,(t10:6.263139152,(t11:2.933638733,t12:2.817176744):3.234977165):2.696395802):0.06228219138,(t13:3.559021389,t14:3.5072353):5.239361242):0.01861744794,(((t15:1.853560168,(t16:0.5996452967,t17:0.5186253):1.235729296):4.277978551,(t18:0.6639374642,t19:0.5048323892):5.197254488):2.456756609,((t20:6.791651353,t21:6.644570702):0.04043134241,t22:6.49255881):1.272019057):0.02776340965):0.5744844486,(((t23:3.83473161,t24:3.786246322):3.791779293,t25:7.46651293):0.1680032429,(t26:7.436418426,t27:7.352107418):0.1370404617):0.53077409):0.4573259203,(((((((t28:2.362002243,(t29:1.774213616,t30:1.543738563):0.4001027965):0.9499199715,(t31:2.026289403,t32:2.025804792):0.7852146045):4.212428469,((t33:2.634559236,(t34:1.346583957,t35:1.267860456):1.183592715):0.936684792,t36:3.380646323):3.200370151):0.3371933786,((((t37:2.834867576,(t38:2.139483711,t39:1.975698797):0.6448005141):0.8327947104,t40:3.452653819):1.341450576,(t41:3.057319528,((t42:1.80731077,(t43:1.37091978,(t44:1.211513619,t45:1.151075671):0.081113522):0.1878692936):0.8098055153,t46:2.189731246):0.04173271878):1.716597955):0.8384909944,((t47:0.2732524769,t48:0.1818576837):1.938359631,t49:2.017275908):2.287663166):0.9623009881):0.04581069262,t50:5.262498485):0.0235890511,(((t51:1.167697762,t52:1.106571526):3.423363083,((t53:1.554992479,t54:1.552965415):0.4823846102,t55:1.715986792):2.444969038):0.3267572269,((t56:3.82789902,(t57:0.8738905543,t58:0.8071369196):2.869904983):0.5850751989,t59:4.185929833):0.06211341116):0.3187934588):0.07622093248,((t60:3.613122248,t61:3.481609301):0.235793756,(t62:3.537830095,((t63:1.829955337,t64:1.76580244):1.581295752,t65:3.170916268):0.1037058505):0.105192143):0.6412016813):0.3644162141):0.1418927945,(t66:3.785194076,((t67:3.412115929,t68:3.38559596):0.02393943108,t69:3.405381453):0.342840924):0.636604324):0.2119641636,(((((t70:3.58882569,(((t71:1.766026137,t72:1.626343836):1.357171692,(t73:2.078562717,t74:1.983158602):0.9016481197):0.1646896239,t75:2.944474755):0.2859955113):0.25852713,(t76:3.045513217,(t77:2.693938901,(((t78:1.321314411,t79:1.265633535):0.602701113,t80:1.727830819):0.7276982328,(t81:0.7382548525,t82:0.5994323626):1.648264714):0.01785714914):0.1327371791):0.4161782857):0.431140789,(t83:2.949387559,(t84:2.137412798,(t85:0.836234397,t86:0.7871280092):1.272883725):0.7951155848):0.1467543349):0.1198118847,(t87:1.743523252,(t88:0.5904644549,t89:0.3499093837):1.127934821):1.246046893):0.0929106205,((((((t90:1.627419807,t91:1.37272039):0.03812134015,(t92:1.192584093,(t93:0.6009671563,t95:0.2707292745):0.5731060265):0.213143864):0.07149508091,(t96:0.8557141603,(t97:0.1119704637,t98:0.0165842575):0.6927381767):0.126921337):0.185081787,((t99:0.04279558709,t100:0.0217917452):0.7212949178,((t101:0.3018489812,t102:0.221577163):0.3337077323,(((t103:0.1157223008,t104:0.03143380518):0.09678942017,t105:0.1188256604):0.01425084574,t106:0.09044151936):0.2125130169):0.07290342551):0.1049153184):0.1823186549,t107:0.6434533446):0.2590449233,(t108:0.2742207206,t109:0.2623677633):0.5464278549):0.4274469827):0.08782329009):2.115316012):0.422059327,(t110:0.5137767456,t111:0.5076620201):3.326258457):0.9363180957,t112:4.721237162):1.185041764):0.5492978289):0.5395874254):0.03885334136):0.3847771856,(((t113:5.023182793,(((t114:1.725778996,(t115:0.8611593195,t116:0.7179555422):0.7839762571):0.3219359948,(t117:0.9842362093,(t118:0.3321243586,t119:0.2448720798):0.5784648713):0.6581653174):0.309391676,t120:1.508110987):2.539406129):0.8900143308,(t121:4.231207575,(((((t122:0.5934144792,t123:0.5477455219):0.1629608903,t124:0.7016123876):2.339872537,((((t126:0.2031112863,t127:0.1593888179):0.0820278219,t128:0.134958713):0.2990650268,t130:0.3279973343):0.931125239,((t131:0.2935922375,(t132:0.08433031798,t133:0.005021907805):0.1640744322):0.5029986647,t134:0.6230409739):0.17463855):1.295919762):0.02543284722,(t136:1.449719326,t138:1.125444054):0.448348526):0.1300413601,((t139:0.9674481804,t140:0.9619947671):0.1685432183,t141:1.020338736):0.3431196657):0.8351052436):0.6976650374):0.2355272896,(((t142:0.1484015304,t143:0.1057137539):1.094069563,((t144:0.8912604742,t145:0.5895549042):0.06797434385,t146:0.6437543818):0.1926034444):0.8738633965,((t147:0.6651924845,(t148:0.2263463545,t149:0.1989670857):0.4233274922):0.8548058997,(t150:0.4704067264,t151:0.4098441637):0.9292585064):0.009435596545):0.6806923773):1.204183606):0.6060290418):0.3169524237,(t152:3.610327428,(t153:2.918061671,((t154:0.9578525604,(t155:0.7408526042,(t156:0.2282432498,t157:0.1443304916):0.4329534464):0.1739443227):1.595448595,((t158:1.79535443,t159:1.753524212):0.1168688878,t160:1.711129006):0.3431846549):0.3394819188):0.6429642342):0.5335056369):0.1494673034):0.7139936385,((t161:3.154397009,(t162:2.635080156,t163:2.548549131):0.5077372123):1.178136882,((t164:2.565822954,t165:2.498288276):0.7821975721,(((t166:0.6641164277,(t167:0.4230518314,t168:0.02583278403):0.1118771442):0.1722553108,t170:0.0918556969):2.137928823,((t171:0.7221330286,(t172:0.6232265651,t173:0.5879515081):0.09271269902):1.190378056,(t174:0.4419542165,t176:0.1485304349):1.380063899):0.1033536014):0.1636154512):0.7614642126):0.05208354725):0.1270284747,((t177:0.06439583991,t178:0.03911311143):1.823274621,t181:1.658090998):0.5717722024):0.07441496238,(t182:1.29544476,t183:1.275640298):1.005074774):3.680272643):3.906489011,(((((t184:0.335288815,t185:0.05474734895):0.3644296402,t186:0.3096159276):0.01820704725,t187:0.2577853464):0.4515384376,t188:0.5379772429):0.4473096169,t189:0.8957997742):8.235573029):1.069898091,(((t190:0.3739778524,(t191:0.2596963091,t192:0.250737934):0.05401080825):1.308892661,(t194:0.371082498,t195:0.3556799072):1.115875548):0.04679963795,t196:1.501101838):8.416322412):0.3233239899,(((t197:0.2506345807,t198:0.1335687147):0.131361353,(t199:0.1657678506,(t200:0.07554709157,t201:0.07103422834):0.07124535028):0.009789409489):0.7385513694,t202:0.8875964057):9.114651263):0.8391328822,t204:10.52591957):0.7986516675,((t205:5.35091935,((t206:0.06380826925,t207:0.01081710347):0.6126655518,t208:0.5819203742):4.417496546):4.868892848,((((t209:3.974865888,(t210:3.256800174,t211:3.210024084):0.5832996122):1.25859477,(t212:3.626519587,t213:3.395068447):1.388787529):0.1331166348,(((t214:2.653056115,t215:2.635429259):1.182233727,t216:3.782272375):0.838886089,(((t217:2.246609852,t218:2.043207281):0.1672366199,t219:1.838776824):1.228676824,t220:2.686860119):0.7353392221):0.1675413112):1.916055321,t221:5.413934356):2.578653253):1.042280263):1.814704482):0.6052794309,(((t222:2.947852955,(t223:0.7197037148,t224:0.6685059476):2.094141256):1.991871936,(t225:2.00466868,t226:1.871212566):2.712516012):5.408991043,(t227:8.488293363,t228:8.483680675):1.248017046):0.5406820137):2.473968757,t229:12.62308419):1.096290238,(((t230:4.769109285,t231:4.701893768):0.8405485753,(t232:1.158925401,(t233:0.8266500983,t234:0.8074183094):0.3207441417):4.364174133):2.18737945,t235:7.614980336):5.852329224):4.808376892,((t236:2.021729189,(t237:1.458034002,t239:1.045375332):0.3753283646):10.87948922,((((t240:0.0737326401,t241:0.07301784444):7.751274105,(t242:3.56743044,t243:3.444165212):4.227306196):0.6617871355,(t244:2.723435261,t245:2.694962638):5.514482008):1.101438109,(t246:0.3576093624,t247:0.3450905458):8.644752958):2.583059683):5.246810409):0.9740518387,((t248:3.988765768,(t249:1.125056335,t250:1.104689162):2.825094128):7.497933486,((((t251:0.08570973516,t252:0.07287521276):1.849584212,t253:1.903557294):3.882862845,t254:5.503544561):2.509400566,t255:7.676038369):2.873063815):6.215435371):4.402026929,(((((t256:0.3256326749,t257:0.279779049):5.795771747,(t258:3.367599921,(t259:0.7973523228,(t260:0.4242628332,t261:0.3102798093):0.2817517268):2.495249384):2.687668126):0.2264717819,(t262:3.119379053,t263:3.086946928):2.823566252):7.858492366,((((t264:2.33254151,t265:2.318094573):0.2802247267,((t266:0.566745961,t267:0.3989725223):1.573023741,(t268:1.606303585,t269:1.168723768):0.3558449023):0.4448283878):1.532815819,t270:3.401594871):6.848666487,(((t271:1.526937354,t272:1.512161314):3.550514907,t273:4.892319943):0.3477121972,(((t274:1.117629143,t275:1.038695259):1.527823598,t276:2.459253979):0.1834696927,t277:2.560675675):2.389396937):4.726852643):2.565242626):5.880724681,(((((((t278:1.501217757,t279:1.223506645):3.744188481,(t280:0.4901617782,t281:0.3459327438):4.405324337):1.751785197,((t282:4.353104627,(((t283:0.0527238042,t284:0.04137285769):0.3335369144,t285:0.3575348919):0.5902069784,t286:0.9294199966):3.358502163):0.4159939356,(t287:0.3782018312,t288:0.3533153847):3.853593191):1.723821643):1.800500253,(t289:0.3533535767,t290:0.3451116182):6.983203794):1.08255174,((t291:0.1951659682,t292:0.1204706609):1.743802115,t293:1.745863813):6.408184305):4.740451941,((t294:2.129965992,t295:1.740735708):2.641509937,((t296:0.4303025947,t297:0.3725352133):2.905300719,t298:3.185750197):0.9833971157):8.060293364):2.604065998,((t299:10.82678744,(((t300:5.62606405,t301:5.589965302):1.544793456,(t302:0.9915191637,t303:0.9771133194):6.090284932):0.1677451804,(t304:2.539863815,t305:2.200696668):4.676214648):3.452525567):0.2111278499,(((t306:4.089562952,t307:3.999063496):2.66319691,t308:6.640624567):2.749558553,((((t309:0.1459235609,t310:0.1341328546):4.59218438,((t311:2.137061212,((t312:1.669560072,(t313:1.006392384,t314:0.8836231834):0.6468580073):0.2498021509,t315:1.691841749):0.1562442726):0.7518764354,t316:2.51950515):1.785462032):3.321968367,(t317:5.463061243,t318:5.330788701):2.128912572):1.033181983,((t319:2.565685295,t320:2.535156634):3.847632887,(t321:4.926895074,(((t322:2.137912121,(t323:0.7357727973,t324:0.7277917297):1.381522063):0.6862580456,t326:2.244022705):0.687594322,(t327:0.7567608455,t328:0.7087672786):2.162102676):1.407281609):1.18830531):2.015566275):0.2016922243):0.9212839121):3.637827924):0.7595646644):1.023851447):1.695370574):1.031902154):0.5639921806,(t329:5.46586597,t330:5.439860933):11.71746082):8.592245559,(((((t331:0.4395979836,t332:0.2363731285):0.9659151676,t333:0.9329320566):4.411995018,t334:5.317394602):3.308563337,((t335:3.88871881,t336:3.817710087):3.691359545,t337:7.236689727):0.5184828442):4.241189127,(t338:8.996604799,t339:8.96682506):2.854434043):12.10632796):11.5572803,((((t340:2.001006595,t341:1.996605914):2.582596844,(t342:2.324910999,((t343:1.389722989,t344:1.338469252):0.1705034873,(t345:0.7275624497,t346:0.7182680967):0.707490005):0.6072369426):2.199872055):5.620682236,t347:9.667688423):1.552053211,((((t348:0.4610448641,t349:0.3337763044):0.7831901759,t350:0.9927289084):1.589297577,t351:2.552622103):2.148510476,t352:4.485109767):5.978768021):23.5928965):11.7754068,(((((t353:1.668374064,(t354:1.02032834,t355:0.9313712759):0.6367318458):2.518486261,t356:4.032140939):0.6324891951,((t357:1.157111565,t358:1.140692982):2.53400609,(t359:1.427684141,t360:1.396833531):2.113381587):0.855301571):7.534317653,((t361:5.173197384,t362:5.027405616):1.374771797,t363:6.319237067):5.015225001):22.77595491,((((((t364:1.799629822,t365:1.793737349):1.20607148,(t366:1.702093865,t367:1.613193008):1.019083703):3.815792442,t368:6.27914462):1.821184524,((((t369:0.5634264703,t370:0.4284768187):0.2201983744,t371:0.5371880779):3.086927304,t372:3.622207446):1.414679144,((t373:1.372085743,t374:1.285243323):2.955927512,(t375:3.925208462,(t376:2.132441076,(t377:1.292442235,t378:1.109826977):0.6016943442):1.765915986):0.1997608437):0.6797523605):2.678897437):1.646778315,t379:8.655687526):1.108892214,((t380:2.143948066,(t381:1.151198567,t382:1.12495792):0.9708463023):6.170116184,t383:8.202953423):1.405313658):22.68188765):10.636786):107.6601782):15.9594871):29.1972402);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T58.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
