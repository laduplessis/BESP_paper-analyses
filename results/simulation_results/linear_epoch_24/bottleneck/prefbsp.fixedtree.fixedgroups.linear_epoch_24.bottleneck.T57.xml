<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t478:7.679567563,(t479:1.865921387,t480:1.654869739):5.786467208):111.3682023,(((t481:22.0704947,(t482:3.716211231,t483:3.692873687):18.27594646):32.45210785,(((t484:1.60805339,t485:1.569582033):15.26204543,(t486:0.4780662991,t487:0.3318380606):16.21884731):32.23800388,(t488:47.90531743,(t489:12.17839331,((t490:0.1515429946,t491:0.06527316797):1.410665876,(t492:1.223477973,((t465:0.5372209654,(t450:0.2385687357,((t431:0.04480649502,(t406:0.1423850054,(t397:0.188928563,(t353:0.0682121334,((((t252:0.1418876609,(((t148:0.0460962007,((((t127:0.06877232056,((((((((t105:0.008471639883,((t96:0.4121117702,(((((t76:0.0004139305413,(t58:0.01093852266,((t1:3.196355751,t2:3.180266405):1.566172407,t3:4.699770107):2.093975026):1.002863725):1.088294132,t4:8.567544158):0.7266593065,(t5:5.101573228,t6:5.0784972):3.764054914):0.02284940147,t7:8.836032797):0.02557662956,((((t8:1.252764649,t9:0.956975741):3.354215396,t10:4.239900015):2.01782384,(t11:4.56251703,(t12:0.4294345207,t13:0.3571948102):4.116933276):1.532596667):1.386498896,(t14:7.259118023,t15:7.077484472):0.1289046721):0.7833093067):0.1495400413):0.1083794478,((t16:5.872896707,((t17:1.880631726,t18:1.880566977):2.829632548,t19:4.707246796):0.7711069334):1.707655881,((t20:5.948051292,((t21:0.8825139489,t22:0.8607359163):0.4185358623,(t23:0.5253032075,t24:0.3576996464):0.4772122812):4.624956029):0.444957742,t25:5.857702215):0.5660128714):0.4878543891):0.3681601554):0.04024069555,((t26:4.012848998,((t27:0.7759800052,t28:0.6850695132):0.117281616,t29:0.7446393319):3.076133331):0.8544513908,((t30:0.5619742845,t31:0.5296708935):3.790473018,t32:4.177555024):0.05683814893):2.193210973):0.08240811414,((t33:4.172868688,(t34:3.743881172,t35:3.723904119):0.2119924607):1.759337484,(t36:5.081499823,((t37:0.1794033102,t38:0.1544768522):0.9922902689,t39:1.040616351):3.744407325):0.5711193705):0.3989586712):0.3866494759,(t40:4.638439985,(((t41:2.360325237,(t42:0.9066722237,t43:0.8499550165):1.436058549):1.756596777,t44:4.016168194):0.3410601594,(t45:2.720774644,t46:2.681122291):1.265623145):0.07489035299):1.184265726):0.08739756496,(t47:4.403564772,((t48:3.634023854,t49:3.53492888):0.2926702648,t50:3.669534768):0.3691466913):0.6624657547):0.1218278264,(((t51:2.182049195,t52:2.145321816):1.342460517,(t53:2.635631826,(t54:0.3391974336,t55:0.260739524):2.246674339):0.778756203):0.7445727205,(t56:3.271908311,(t57:2.877165676,t59:2.791678191):0.2385342683):0.6630617518):0.5175240769):0.07043715061,(t60:2.590121038,t61:2.549876151):1.498971133):0.9802268683,(((t62:2.648321963,(((t63:2.464749716,(((t64:0.2428695301,t65:0.1805576992):0.3964174897,t66:0.5668333622):0.9662461271,t67:1.513794427):0.807168742):0.08995973154,t68:2.38590109):0.01878285885,(t69:0.4576334284,t70:0.4277084638):1.822318224):0.06755743894):0.7591503478,t71:3.070987453):0.7001128735,(t72:0.8833591323,t73:0.7706443262):2.877447071):0.9180339425):0.2120978389):0.799108285,(t74:4.618467983,((t75:0.789034198,t77:0.7041909578):3.040802792,((t78:2.297434964,(((t79:1.066668144,t80:0.9632589644):0.6024484492,t81:1.51299693):0.3471530229,t82:1.835181253):0.2708757527):0.2841702989,((t83:0.5803846896,t84:0.4903644074):0.8612308411,t85:1.344716809):0.8659255101):1.072328141):0.7330537266):0.7675353748):0.4391782962,(((t86:1.803814268,((((t87:0.3431178983,t88:0.2799747171):0.8038376931,(t89:0.9090121589,t90:0.8808970652):0.1376748268):0.02791973355,t91:0.8754163178):0.4789986369,t92:1.189001473):0.09433387064):0.01576124152,((t93:0.358010673,t94:0.33636424):0.03277939647,t95:0.3042595624):0.5380772962):0.6144002453,t97:0.9359308733):2.729602298):0.4921461868,(((t98:0.2367535418,t99:0.1503866816):1.820656616,(t100:1.024989967,(t101:0.6804204836,(t102:0.473192983,(t103:0.4232417135,t104:0.3810031856):0.03446557487):0.05433486734):0.3159723066):0.9436224359):0.132004868,(t106:1.061646812,(t107:0.9115133507,t108:0.7187133708):0.07809332018):0.6967125329):1.917595377):0.4333223449):0.7200146558,(((t109:1.078194455,t110:0.889716658):0.5577160903,t111:1.383860682):2.492144461,(t112:3.506631733,(((((t113:0.05643779519,t114:0.04802543078):0.04915254406,t115:0.07013500617):0.2381365154,(t116:0.1670139879,t117:0.1651661135):0.1003735125):1.952008415,((t118:0.2194896634,t119:0.2175693205):0.09096469685,t120:0.275404817):1.346520509):0.9654056931,((t121:1.101918418,t122:1.006060838):0.950920923,(t123:0.3705094769,t124:0.3227353097):1.568272863):0.3785060087):0.2103133549):0.2733947416):0.346401014):0.415682235,(((t125:1.520549576,t126:1.51144228):0.4654927519,(t128:1.220459573,(t129:0.432406974,t130:0.1468263976):0.7517545787):0.1729079293):0.8413891443,((((t131:0.2117839066,t132:0.1239972521):0.4637822149,t133:0.4876106028):0.09988445082,(t134:0.2420099434,t135:0.07585198067):0.3222735942):1.000999523,(((t136:0.2277840078,t137:0.198004879):0.02713980786,t138:0.208945425):0.8647682693,(t139:0.4787527317,(t140:0.1747819757,t141:0.1711229253):0.1672470597):0.5533140606):0.2500344508):0.01644051168):0.5697304111):8.877874167):4.644442534,(((t142:2.400203423,(((t143:1.408197104,t144:1.244951128):0.3271769467,t145:1.501630052):0.06536079012,(t146:0.5712213769,(t147:0.1966923759,t149:0.02366247958):0.2916853886):0.9643111733):0.5391103046):2.286711014,(t150:3.135444232,((t151:1.703593872,(t152:1.391352745,((t153:0.1389289449,t154:0.1038288867):1.05714353,t155:1.000457774):0.1566825796):0.2964678852):1.285900218,(t156:0.3057857492,t157:0.2712059459):2.372964487):0.1307058195):0.879100676):4.977818253,(((t158:0.553863353,t159:0.3309018057):1.181949905,(t160:0.9479574014,(t161:0.362710133,t162:0.2884722779):0.5734206615):0.2405625221):5.335060803,((((t163:0.6450181713,t164:0.4922659167):2.110369873,((t165:1.218052802,(t166:0.1914571023,t167:0.07614825547):0.8557028746):1.291615468,(t168:0.2293478167,t169:0.1639968581):1.930648139):0.03175781233):1.879464104,((((t170:0.3199114361,t171:0.2750822575):0.9188141084,t172:0.9416209264):0.08525455231,t173:1.022969999):0.8861080369,(t174:1.043336003,t175:1.011292136):0.7730020425):1.741556745):1.120031592,(((t176:0.5849337465,t177:0.3980813472):0.2032271984,t178:0.3010693948):0.5041521541,(t179:0.4566762317,t180:0.1298348275):0.3482305968):3.302738022):0.5732032592):1.475830528):5.55032717):0.5895336052,((t181:1.271210588,t182:1.133747834):7.791714607,((t183:1.167690166,(t184:0.8280967932,t185:0.8011868589):0.131476265):7.360256853,(((t186:4.761032239,(t187:4.28387869,(t188:0.3980863207,t189:0.3835338015):3.873336843):0.09349994115):1.350335435,((t190:3.162592563,t191:3.08736181):0.06196553603,(t192:3.034564532,t193:3.019790231):0.07570250331):2.405488129):0.0690573075,t194:5.526892324):2.016507448):0.3579251554):2.553272812):1.608195888,((t195:4.504162302,t196:4.42215566):7.284482236,((t197:7.629603155,((t198:4.335578983,(((t199:0.122915018,t200:0.04950701134):2.404005594,(t201:1.387140967,(t202:1.016602331,(t203:0.176510002,t204:0.02905963083):0.7329059146):0.1718652435):0.8375392586):1.452817673,t205:3.133153019):0.2758305905):0.7837488454,t206:4.180999903):2.418781797):0.1428844499,((t207:2.465036345,t208:2.350058234):3.346878431,t209:5.65361477):0.8709747055):3.893648084):0.1523861342):2.435557925):4.467043455):1.033568472):2.004245166):1.865693994,((t210:16.27540677,((((t211:2.25223189,(t212:1.766075258,t213:1.762361439):0.3934344495):0.6924808879,t214:2.81207204):0.6513057317,(t215:2.758428757,t216:2.734975612):0.6300099182):0.7667021514,t217:3.954223666):11.90429087):2.419318168,(((t218:5.615637065,((t219:1.618833894,t220:1.463950671):2.700888008,t221:4.115542745):1.112673273):8.032486029,((t222:8.962223592,(t223:7.149888258,(t224:0.5519401314,t225:0.5437825131):6.569656426):1.740213237):4.026896672,((((t226:2.246944625,t227:2.215064374):2.185038966,(t228:3.728977335,t229:3.641449261):0.6393541239):0.3468931328,(t230:4.43772593,(((t231:0.3071615895,t232:0.1460124015):0.7249715115,t233:0.8419726114):3.177750976,(t234:1.900108784,t235:1.766817543):2.079206001):0.1328051406):0.07093910347):2.084665397,t236:6.043656567):5.817368):0.2699601818):4.4043626,(((((t237:1.942607894,t238:1.908687604):0.7823431759,(t239:0.3706870991,t240:0.2362617445):2.116428935):3.559636777,(t241:4.916029526,(((t242:0.1048230879,t243:0.05524606916):0.0441615876,t244:0.02984595223):3.760302956,t245:3.765738447):0.9601402498):0.9344034882):1.965006669,(t246:4.130049496,(t247:4.022969082,(t248:0.8491870735,t249:0.7534527138):2.946707013):0.08859662067):3.346275082):5.164228181,(((t250:3.078799742,((t251:0.2868731053,t253:0.1131346806):1.559691207,t254:1.651774334):1.170227889):1.435109413,((t255:3.476235781,((t256:0.2532532087,t257:0.1347020895):3.032153718,t258:3.122610623):0.1856117388):0.3669617374,t259:3.505526592):0.263393314):7.345390889,(t260:0.301475039,t261:0.2562978987):10.65514393):0.2421119832):3.114579522):0.1608741744):3.498946961):0.3125199964):1.594564968):2.375113203,((((t262:4.647877171,(t263:3.011637154,t264:3.006962504):1.573994367):10.44421674,(((((((t265:0.6889863961,t266:0.6578633531):1.52070206,t267:2.155380014):1.041595761,t268:3.162126113):0.6068498995,(t269:1.389259945,t270:1.382271092):2.252352218):8.473429479,((t271:2.9856392,t272:2.837428194):5.219543872,(t273:1.304400514,t274:1.261537956):6.746719372):3.847286476):0.7796656929,(((((t275:0.4639154195,t276:0.4009797967):7.536535651,(t277:5.194717177,(t278:2.447593947,(t279:0.0940672579,t280:0.08008210182):2.324459468):2.678668405):2.682613005):0.1752910521,((t281:1.631949417,(t282:0.1199722084,t283:0.09429106334):1.474148013):4.259743952,(t284:4.247223021,t285:4.128279507):1.452475507):1.628041873):2.520797022,(((t286:5.791021122,(((t287:2.251330116,t288:2.075488936):0.3721182386,(((t289:0.8159958453,t290:0.6838653408):1.099016499,t291:1.741811394):0.1898590852,t292:1.878261153):0.2951417798):0.123391627,t293:2.184225237):2.930392048):1.377664725,((t294:3.47862382,t295:3.462551008):2.550775172,((t296:1.173538105,t297:1.156949944):3.966828509,((((t298:0.3235337934,t299:0.1172272647):1.954758369,t300:2.043651128):1.424859518,(t301:2.988074121,(t302:1.265236117,t303:1.244223835):1.500619007):0.4341783781):0.1516389953,(t304:3.002547957,t305:2.829681336):0.2127052423):1.208411682):0.7120083752):0.2332890379):1.916306812,(t306:0.4311127819,t307:0.3339029288):6.663344899):0.2988326091):0.1967250671,((t308:3.910248934,((((t309:0.3458170563,t310:0.3073947535):0.05085191471,t311:0.03534185928):2.46470389,(t312:1.47159439,t313:1.320643282):0.9563322619):0.4002808319,t314:2.642794297):0.4975806283):0.3094974031,(t315:2.249376651,t316:2.240624661):1.112262752):3.148906756):1.690474843):1.026910023,(((t317:2.825749858,(t318:0.2764765441,t319:0.1511155546):2.521314296):1.150131967,t320:3.822148351):1.589034392,((((t321:2.742020715,t322:2.734636018):0.3409628698,(t323:2.634943198,t324:2.613669309):0.3951147796):0.1781568204,t325:3.13536065):0.7031194691,t326:3.668692285):1.387168843):3.646929686):0.7624835998):0.3606383847,(((t327:0.3755118226,t328:0.2648576659):6.919501323,t329:7.147368249):0.5091756877,(t330:5.322744008,((t331:0.9292820435,t332:0.8905007517):0.7813543849,t333:1.636836746):3.463329901):2.27809733):1.9682752):6.372685276,(t334:8.934840601,t335:8.77709976):6.715957428):0.285296505):1.306735224):0.2437228555):10.57151287):35.52937169):0.8368487005):5.21647873):10.64439843,((((((t336:1.782437805,t337:1.495080577):2.913849936,t338:4.277031482):3.695339286,t339:7.849169591):6.909071212,(((((t340:4.391937843,t341:4.337010625):1.321271886,((t342:1.422115582,t343:1.330745799):2.889510241,(t344:3.163861277,(t345:0.1739358557,t346:0.158080474):2.925839991):1.0532838):1.290804407):4.955500124,t347:9.836656508):2.802180508,((((((t348:0.4123461871,t349:0.3156198143):0.6356757057,(t350:0.2961684992,t351:0.2744524898):0.6019222692):1.330709728,t352:2.076624349):4.082035832,(t354:1.302034934,t355:1.272218147):4.645141448):2.353308052,(((((t356:0.6888118111,t357:0.6117766415):1.245424437,t358:1.831916537):0.4947138135,t359:2.315089188):2.31496449,(t360:1.036953771,t361:0.8138736929):3.269790141):2.387470706,(t362:2.893849527,((t363:1.134403821,t364:1.121939574):0.5074915562,t365:1.602782672):1.186006409):3.53011518):0.8083224203):1.115567232,((t366:5.185720372,(((t367:1.160554226,t368:1.119177346):2.053007721,(((t369:2.211503428,t370:1.953491841):0.03311668477,t371:1.981486867):0.7030020878,(t372:0.7429246778,t373:0.7306841445):1.908692876):0.2186252566):0.5514428719,t374:3.402714846):1.135622651):2.728094111,((t375:3.42038308,t376:3.410894088):0.8212478838,((t377:0.8842205917,t378:0.8724354705):0.9917294165,t379:1.517508277):2.305103868):2.951140357):0.3160396797):2.577974972):1.145241333,((t380:3.852409391,t381:3.774024857):6.030448904,((((t382:2.205727924,(t383:1.840887239,t384:1.637366027):0.3107041539):0.8217645911,t385:2.624337847):3.055902201,t386:5.558851275):1.596251289,t387:7.006962557):2.056088693):0.9188816263):0.09415179319):16.05622658,((((t388:0.3747264855,t389:0.2670590897):3.924912955,t390:4.086085713):6.608318679,((((t391:0.7940311931,t392:0.7699886375):1.198015396,t393:1.895079568):6.779038029,(t394:5.119733885,t395:4.871079863):3.477067252):0.532677171,t396:8.743655846):1.252498624):8.535719674,(t398:15.26561265,((((((t399:0.4204432955,t400:0.349384883):0.4351219583,t401:0.4796396775):0.05477335775,t402:0.4946153912):2.744580235,t403:3.174073474):6.297219763,(((((t404:0.2220192629,t405:0.1985406701):3.522073753,t407:3.44646356):1.423319759,(t408:3.179996266,t409:3.17083749):1.583475527):0.439618646,t410:5.003445503):2.89897907,(t411:0.9043936504,t412:0.7792016275):6.784630251):0.9410333269):0.04966304634,(t413:1.920473369,t414:1.912171057):6.588890258):5.133417046):2.942940331):6.508508243):15.42198557,((((((t415:6.020647973,((t416:3.830946414,t417:3.745249311):0.3474497471,(((((t418:0.2562727152,t419:0.1163593994):0.2529718965,t420:0.3685221344):0.3870818262,t421:0.7303352219):1.399384996,t422:1.91701097):0.9991145528,t423:2.794819295):0.7263468703):1.794931319):5.504056794,((t424:4.658437141,((t425:0.7885388226,t426:0.7790214799):2.858626356,t427:3.623553945):0.7816890012):5.94313506,(t428:6.530819241,((t429:3.686189574,t430:3.681617756):2.061858585,t432:5.562978433):0.7177323423):3.727924889):0.2173583972):0.7247978561,(((t433:0.315814932,t434:0.2890023972):1.999967836,t435:2.032710735):2.609187811,(t436:1.505140248,t437:1.455014709):3.10593342):5.897486227):0.521863512,(t438:1.083050358,t439:0.8966156094):9.737776092):5.545865497,(t440:0.5912436829,t441:0.5478702621):15.51103798):1.726216572,((t442:8.071060571,(t443:5.516452439,((t444:2.940607565,(t445:0.2545958458,t446:0.1343158105):2.654025462):0.7867130841,(t447:0.5513025418,t448:0.4277423315):2.999954152):1.776588675):2.554082943):1.846334798,(t449:5.131508012,((t451:0.188808085,t452:0.1875811975):1.79905458,t453:1.985725188):2.620365089):4.259533957):7.611489974):18.45014748):33.28470735):53.59090981):90.48864388,(t454:19.64515964,(((t455:2.642959176,t456:2.606916772):7.904156045,(((((t457:0.6763668926,t458:0.6120443321):1.339666843,(t459:1.565481866,(t460:0.7206275274,t461:0.6975259247):0.7344342044):0.1265149397):1.74708409,(t462:2.127226949,(t463:0.8362299249,t464:0.7397644817):1.215378463):1.169555456):1.285832274,(t466:3.176166721,t467:3.1066452):0.4620964388):4.569024209,t468:7.985483608):0.7640537261):5.138371021,(((t469:3.01840042,t470:2.928816681):0.6913612653,((t471:0.2649337667,t472:0.1014858902):2.986079755,((t473:0.1722040343,t474:0.141533248):1.940066031,(t475:0.7479068264,t476:0.6501204301):1.176058397):0.8516070426):0.3161538834):4.472066177,t477:7.381548258):5.643856055):3.949713717):192.6323945);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T57.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
