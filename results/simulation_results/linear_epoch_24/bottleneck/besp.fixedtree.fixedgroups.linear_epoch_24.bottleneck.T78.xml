<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t484:0.7056742266,t485:0.6168414846):42.79609461,((((((t399:0.01942058413,(t388:0.009816377526,(t357:0.02520261507,(t353:0.006392393213,((((t284:0.007715827439,((t245:0.06229741068,(((t199:0.1841094563,((((t177:0.0295180557,(((t157:0.06433968875,((t149:0.02222545361,((t143:0.02483212658,((((t44:0.1514030081,((t28:0.4858851532,t1:2.473429132):1.282805177,(t2:3.198402354,t3:3.179729826):0.5252952113):0.1074000534):5.960017311,(t4:7.090275155,t5:6.789785768):2.643875698):1.011429835,((((t6:5.538303881,(t7:2.016081248,t8:1.953262843):3.400770888):3.258655658,(t9:6.338433611,((t10:3.105153091,t11:3.094219989):1.824293419,(t12:3.820588506,t13:3.651130892):1.003056871):1.407785172):2.201603918):0.6175303438,(((t14:4.557070995,t15:4.412385728):1.055215116,t16:5.456509307):0.05273636892,((t17:2.316992487,(t18:1.152720257,t19:1.152198288):1.088593553):0.3777250777,t20:2.610618154):2.559903294):3.163464109):0.1477591452,t21:8.466879935):0.8502145816):1.027000344,(((((t22:1.678277542,t23:1.552247374):5.066029181,(t24:0.9684688393,t25:0.943484935):5.635236289):1.736497374,(((((t26:3.136897307,t27:3.08642125):3.055828839,(t29:2.222624674,t30:2.210556392):3.287378823):1.747766267,((t31:4.100929725,((t32:0.129765524,t33:0.08146506073):3.865017519,(t34:3.25096909,(t35:2.291532746,t36:2.251364503):0.7955386874):0.6173466661):0.08469402956):0.4106582419,((t37:2.245292376,t38:2.206511316):0.0336185762,t39:2.200879281):1.864845268):2.68780571):0.02715521962,t40:6.63605809):0.1716198283,((t41:6.590582759,(t42:4.220777207,t43:4.079081096):2.242369433):0.01737047271,(t45:1.588320588,(t46:0.07833024768,t47:0.02389708908):1.444072885):4.412592754):0.1782143875):0.1490997724):0.3416226142,((t48:5.883157396,t49:5.857624733):0.1245867256,(t50:5.532666729,((t51:1.163251042,t52:1.163146709):1.577055843,t53:2.698827991):2.733289642):0.164736257):0.5185235736):0.3202001597,((t54:1.791661604,t55:1.759727009):4.220520919,((t56:5.299410661,((t57:1.980772494,(t58:1.649496368,(t59:1.531227826,(t60:1.303609283,t61:1.234618754):0.1539013165):0.1001397714):0.3275596925):2.053309419,(t62:1.654719343,t63:1.448281348):2.160963014):1.258780026):0.122111639,((t64:1.590756748,t65:1.578778664):1.709132648,(t66:1.418078396,t67:1.284379273):1.785658407):1.529873147):0.508335786):0.3472430705):1.002954605):0.3854170727):0.2985113634,(((t68:4.889978279,(t69:4.393348964,((t70:0.1338456738,t71:0.1035636617):1.278150109,t72:1.365759575):2.92509887):0.4665874638):0.3774888219,(((t73:4.277981928,(t74:3.433061037,(t75:1.058412032,(t76:0.1559884806,t77:0.1525387933):0.6213335358):2.246592095):0.7670585464):0.2639652485,(t78:0.8508777996,t79:0.8403550825):3.122745992):0.3873038045,((t80:3.851615055,(((t81:0.8807594954,t82:0.5008868139):0.7082679592,(t83:0.1203682007,t84:0.08980486251):1.075035777):2.043940909,((t85:0.4960029943,t86:0.350632191):0.6489314797,t87:0.8275984554):2.037745353):0.1964078119):0.3702089463,(t88:2.304046371,t89:2.288533565):1.091312674):0.1017989887):0.1965473072):1.551963657,((t90:1.203472056,t91:1.050645887):2.273499703,t92:3.238677043):1.675997256):0.2848992821):0.08719095388):0.7791805342,(((t93:4.186890161,(((t94:2.297283142,(t95:2.049214219,t96:1.844010093):0.111143895):0.1354670896,t97:2.07134873):0.5326407192,t98:2.559457687):0.9474594307):0.2453592868,(t99:0.4068101615,t100:0.2723122117):3.313276525):0.62725218,(t101:4.019275695,((t102:1.455429509,(t103:1.093798312,(t104:0.3144653029,t105:0.2809643349):0.7393285523):0.3587037843):2.315600631,(t106:2.480911313,(((((t107:1.460009668,(t108:1.248081611,t109:1.076400773):0.04399694824):0.285450503,(((t110:0.8233197579,(t111:0.2121802024,t112:0.2075445321):0.5258964938):0.2088906428,t113:0.9406522479):0.1292272789,t114:0.9764750708):0.2436514528):0.08776424016,t115:1.283402224):0.140899265,t116:1.396684769):0.4831986029,(t117:0.682997969,t118:0.6705544861):1.138063462):0.01727328147):1.060644585):0.04207727522):0.191636215):0.9894416889):0.5204127306):1.368692943,((((t119:0.3240325153,t120:0.1951247622):0.5475050962,(t121:0.397363638,t122:0.009135988999):0.2947726331):0.2598314707,((t123:0.2608959264,t124:0.1901308377):0.2342539275,t125:0.3820393801):0.04055072614):0.6832051313,t126:1.077552005):4.015682816):0.1410597435,((((t127:0.6877905834,(t128:0.5107957479,t129:0.4835877335):0.147998508):2.094206571,((t130:0.5546855921,t131:0.228280506):0.9628372469,t132:1.153976372):0.9026321083):0.8189441496,(t133:1.808268641,((t134:0.2677823915,t135:0.1702885981):0.2935553077,(t136:0.2334670201,t137:0.2305393791):0.2068958706):1.22291949):0.7975837903):0.3251341573,(((t138:0.2263595631,t139:0.04436617311):0.6579672035,(t140:0.3557530164,(t141:0.1709706702,t142:0.1685793579):0.1729463656):0.150136382):0.5449419727,t144:0.7397544162):1.234752918):1.132474821):0.5072603749):0.3015369744,(t145:1.644034738,t146:1.601987398):2.223107044):1.003784991,((t147:1.110506182,((t148:0.926113042,(t150:0.4754065819,t151:0.3716605812):0.3150791443):0.0350979955,(t152:0.5007057368,t153:0.001676060818):0.2025958184):0.1348012446):0.8394936401,t154:1.162722679):2.748765455):0.3277790448,((t155:1.894586403,(t156:1.129787689,t158:0.4337279996):0.5076437612):0.6918473463,(t159:0.9906266454,(t160:0.5451057302,t161:0.4958864804):0.3788971842):0.624216738):1.635907341):0.4281122348):0.9580610313,(t162:3.166150843,(((t163:0.9451049882,(t164:0.6100401091,((t165:0.1902157813,t166:0.1529041277):0.3743041191,((t167:0.193859971,t168:0.09657675666):0.100167685,t169:0.190627):0.1517456928):0.03215873884):0.2130419015):0.2043645062,t170:0.7429933367):1.434245093,t171:2.156700529):0.4805153397):1.315334396):0.0686882366,((t172:2.431106797,(t173:0.6750619442,t174:0.2984947513):1.373064146):0.1965806596,t175:1.864055087):1.359032853):4.271087):1.928903604,(t176:2.006215531,((t178:0.4201067894,(t179:0.1528081368,t180:0.0983258747):0.1378478541):0.461993416,t181:0.5672305515):0.9977967844):7.329982697):1.745344586):1.237221847,(((t182:0.8061713944,t183:0.6732291132):0.6423837111,((t184:0.7652879373,(t185:0.3339527699,(t186:0.1831708316,t187:0.1492721158):0.09258830908):0.3841743832):0.230034479,t188:0.8216227841):0.02428189883):1.510279971,(t189:1.143430468,t190:1.094939217):1.174367614):8.881347235):3.419931123,(((((((t191:0.5360033545,t192:0.5188901401):0.1191794999,(t193:0.3932794416,t194:0.3144739824):0.104523271):0.4637188995,t195:0.8799287999):0.01035334057,t196:0.852761757):0.05770446756,t197:0.7192165262):0.1124687551,t198:0.6486180806):4.968113824,(((t200:0.6158886787,t201:0.5711782754):0.6046478294,(t202:0.990312376,t203:0.5979184839):0.1530201412):0.2361943738,t204:0.9694567083):3.717881142):8.241923472):1.904832659,(((t205:5.355910311,(t206:2.979485538,t207:2.834759629):2.275201335):4.921894981,((((t208:0.4928455034,t209:0.4540237284):0.4860592323,(t210:0.2128494129,t211:0.1188933671):0.7085524067):3.134077859,(t212:0.2993889112,t213:0.2730655229):3.565249035):3.109873206,((t214:3.381956532,t215:3.274408271):1.828842682,((t216:2.713874676,(t217:2.280682412,t218:2.242801642):0.326647972):2.081204244,(t219:4.105555633,t220:4.085988739):0.4818214507):0.1535895414):1.305554564):2.758571619):0.5081902107,t221:9.226840269):3.999043373):0.02908714254):0.7685534925):2.817755228):1.10654336):1.838972668,(((((((t222:2.813662854,t223:2.669171477):1.38555987,t224:3.847593549):8.905379925,(t225:9.463190319,t226:8.997183657):3.234774831):0.306322679,(((t227:2.655633917,t228:2.651640127):1.694380801,t229:4.174276083):7.712926551,((t230:2.703452509,t231:2.680607961):5.109066002,t232:7.765532874):3.613314837):0.4671621522):0.2412677162,(((t233:4.868642902,(t234:3.630021487,t235:3.519776477):1.050173857):1.216793885,t236:5.772863816):3.763051813,(t237:7.440133586,t238:7.370484432):2.05621731):2.11257142):0.7243346091,(((t239:1.764762932,t240:1.714167183):0.2773568248,t241:1.737787779):2.199854747,t242:3.700796226):8.013839893):1.018200576,(((t243:1.013977669,t244:0.9209733924):8.53565287,((t246:7.954918559,(t247:7.425789447,((t248:3.171116045,t249:3.031955373):0.09549923365,(t250:1.090710817,(t251:0.4730018622,t252:0.4247554943):0.4438100048):1.925914756):4.107223505):0.4848032646):0.9253736589,(t253:4.521308286,t254:4.339414449):3.785372025):0.25627442):2.263288683,((((t255:2.038924449,t256:1.909995226):0.2107956193,t257:2.047971682):1.416854081,((t258:1.676357959,t259:1.584202105):1.38756052,t260:2.772129734):0.3741682073):1.360137902,(t261:3.515054856,t262:3.386695205):0.9052604195):5.59378548):0.9157426838):4.357328129):3.17255101,(((((((t263:0.3588543125,t264:0.2632873352):2.825271293,(t265:1.633451585,t266:1.625887774):1.345168724):0.5260056866,((t267:2.380609627,t268:2.299620232):0.7007256964,t269:2.977917565):0.3765882192):0.6991485523,((t270:1.767767362,t271:1.713739882):1.012085531,(t272:0.9400944409,(t273:0.6498474884,t274:0.577513027):0.2369499595):1.607727406):1.234512185):2.993388613,(t275:4.501273063,t276:4.432439996):1.93166159):5.826542296,((((t277:4.565186223,t278:4.518161233):0.2430905578,(t279:0.904379949,t280:0.8749463535):3.820876944):1.668584793,(t281:4.070073673,(t282:1.671067038,t283:1.617440966):2.222705694):2.223493546):4.658377746,((t285:3.746276556,(t286:2.955337128,t287:2.950275733):0.7886196731):3.953582759,(t288:6.144073048,((t289:1.149174673,t290:0.89496714):3.92360487,t291:4.770021072):0.931427023):1.233586697):2.875116171):0.7282159492):1.234157109,((((t292:5.450224626,(((t293:0.6294205603,t294:0.6243271534):2.43849444,t295:2.900584624):0.2908634244,t296:3.084759102):2.026227503):3.845577987,((((t297:2.262788269,t298:2.254700409):3.898942093,(((t299:2.833804513,t300:2.820172767):0.2766364714,t301:3.091331955):0.9431762802,t302:3.932840161):1.920779613):1.170245703,((t303:2.595015922,(t304:2.326801414,t305:2.283022067):0.2194301211):3.465226795,(t306:4.244827098,((t307:2.042116931,t308:2.031853705):0.5188111488,(t309:2.227780184,t310:2.212122905):0.1201598518):1.498632594):1.642954109):0.9420519824):1.245509105,((t311:2.602317004,t312:2.327898744):1.987885764,(t313:3.009889996,t314:2.982772735):1.277771412):2.966998925):0.3650879385):0.6725821785,(t315:7.499819724,(t316:2.94919854,t317:2.771902907):4.347593464):0.6869898557):0.07250750305,((t318:0.9951753614,t319:0.9888084328):0.7376437256,t320:1.592979897):6.121711499):1.66817865):3.689092548):12.42457051,(((t321:10.18864618,((t322:2.327643642,(t323:1.951017629,t324:1.904066219):0.2167716296):7.09146536,t325:9.188583271):0.7111975699):1.96772754,(t326:10.96860431,(((t327:0.5652310611,(t328:0.1648619256,t329:0.08467166843):0.1485609466):5.188750459,t330:4.993030351):3.161944594,(t331:0.4819085304,t332:0.4727704595):7.358117529):1.990259152):0.8794504885):6.773509704,((t333:1.741748139,t334:1.543518521):7.940336636,(t335:0.5959226536,t336:0.5383702862):8.726865299):7.768861604):6.467753348):8.267126776,((t337:0.4879037087,t338:0.4626771175):4.247883327,t339:4.649625885):26.82544972):10.24355601,((((((t340:1.989005928,t341:1.977729777):1.197969286,t342:2.986278487):6.626198354,((t343:2.981445761,t344:2.924363343):1.375050811,((t345:0.6568361092,t346:0.6323522227):1.233079033,(t347:1.607196775,(t348:0.2599341083,t349:0.2288854653):1.140314219):0.06925579671):2.310143422):5.204569017):0.633451422,((((t350:0.6121044027,t351:0.5879387072):1.831636973,t352:2.306777007):5.510312807,(t354:2.923870323,((t355:1.869203176,t356:1.738601483):0.795214503,(t358:1.929160981,(t359:0.2727110407,t360:0.1982720199):1.631871369):0.1158829811):0.07964627292):4.844990307):0.5324474088,(t361:3.004700019,t362:2.919992933):4.223676448):1.085048265):3.341982188,((t363:4.905881874,t364:4.866873112):2.361741085,t365:7.185844983):4.291391299):15.63198395,(((((t366:3.282210194,(t367:0.3382477388,t368:0.02833071587):2.857488454):2.018408159,((t369:0.580786081,t370:0.3702033772):2.837126131,t371:3.197122235):1.094565297):8.979757834,((((((t372:0.4496112425,t373:0.2783019553):0.2262698426,t374:0.4848363591):1.407481416,t375:1.841302048):2.037889676,(t376:0.4380458055,t377:0.3525747798):3.432821822):1.154366694,((t378:2.343719677,t379:2.263519283):1.089991549,t380:3.212204916):1.397283773):5.839394671,(((t381:0.6761488522,t382:0.674549518):7.944986393,t383:8.475300812):0.5250162543,t384:8.969222706):1.124163821):2.129031504):1.080586738,(((t385:1.695805731,t386:1.616325641):1.738222467,t387:3.280736495):0.4523173472,((t389:1.539640576,(t390:0.7349616208,t391:0.7342400014):0.7790838912):0.4241702141,t392:1.925147977):1.448368757):9.398869666):3.309788053,((t393:9.594185563,((((t394:2.01840569,t395:1.650387193):5.3900085,((t396:0.4446330362,t397:0.2876274663):0.8037641681,t398:1.058410823):5.719323754):0.06835122332,((t400:1.772661975,t401:1.761331541):1.904439588,(t402:2.637861134,t403:2.481196559):0.9481348663):2.955866321):0.4077621273,t404:6.562188387):1.677304476):2.515235122,((t405:10.04098795,(t406:6.647483506,t407:6.221279761):3.370289994):0.3846712626,((((t408:4.861409848,t409:4.762441034):2.639261124,t410:7.135321642):0.9602272791,(((t411:5.737636305,(t412:1.091654155,t413:1.043135637):4.489959487):0.1652287628,((t414:0.1275294807,t415:0.1113843855):2.079339227,(t416:0.9134835514,t417:0.4748238252):1.004834969):3.473372114):1.245379408,((t418:3.019414274,t419:2.942669423):1.565044026,t420:4.472619882):1.57416165):0.8961401645):0.952566074,(t421:3.629801862,t422:3.563093531):4.221215874):0.5104154291):0.2290758593):3.932086454):8.382280244):12.2734737):16.9899805):6.937394329,((((t423:1.419628277,t424:1.392981642):3.226541773,((t425:0.364002782,(t426:0.1286900071,t427:0.06559503072):0.08895685863):1.469260369,(t428:0.3420607239,t429:0.2413497885):1.267114235):2.626957516):28.54374543,((((t430:0.4162162286,t431:0.3664710279):5.748365249,((t432:0.5673723911,t433:0.5187151582):0.557252024,t434:0.8476529129):4.878327021):5.123643705,((t435:4.025333588,(t436:3.447846402,(t437:0.8115236761,t438:0.6344284533):2.617213353):0.5365169977):6.539087287,((((((t439:3.532174888,t440:3.119855936):0.4916594451,t441:3.476362526):0.269123634,((t442:0.6652271162,t443:0.5911498476):0.8816734335,t444:1.349528127):2.1146052):0.5592064731,t445:3.756522001):3.07860774,t446:6.823889163):0.9223238326,(t447:0.5038825513,t448:0.3010478087):7.210807805):1.443272392):0.1539278441):2.006837255,(((t449:3.959947257,(t450:3.504217854,t451:3.496817793):0.3678132003):3.419081687,(t452:2.642063096,t453:2.559534082):4.529759956):0.665157953,(t454:0.9229258456,t455:0.7283873357):6.76970588):3.070439378):19.25444375):7.508291693,(t456:18.17124694,((t457:3.692716883,t458:3.616369945):0.7291865665,((t459:2.368526833,((t460:0.1729573636,t461:0.03423281164):1.694508209,t462:1.642202476):0.3692498403):0.4645300583,t463:2.254438584):1.309198339):13.72053858):19.10690467):16.0848567):150.4897239,((((t464:8.353108921,t465:8.344326138):1.426839135,((t466:0.04940068638,t467:0.03959647529):3.542472608,t468:3.533323389):6.06569493):15.44098614,(t469:1.670984274,t470:1.667552365):23.29370731):14.0910542,(((t471:30.96340657,(((t472:0.2015186105,t473:0.0826054545):1.430889786,t474:1.346823399):10.34895603,t475:11.6574731):18.95394117):3.432254152,((t476:1.364067309,t477:1.206966703):2.94162983,(t478:2.555327761,t479:2.421476275):1.584712446):29.69118946):2.873147778,(t480:2.268076008,(t481:0.8245697814,(t482:0.3504541423,t483:0.1762084076):0.4451698085):1.307174562):34.03880343):1.745953298):163.3809809);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T78.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
