<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t452:1.442200927,(t453:0.2967674355,t454:0.2165667699):1.080962992):2.613950879,t455:3.865324848):4.481383997,((t456:0.7451593226,t457:0.5709580776):5.820502482,(t458:1.521985524,((t459:0.4108973773,t460:0.4061308572):0.4938422309,t461:0.8769801498):0.5146163619):4.70171854):1.697577802):292.8315085,((((((t462:0.4187040624,t463:0.3765461037):0.9690458337,(t449:0.03757542931,(t418:0.137337997,(((t313:0.173906746,((((t174:0.1129927486,(t170:0.1235986315,(((t154:0.06914919265,(((t135:0.06033245168,(t126:0.03043398571,(((((t92:0.003086976777,(t90:0.23205847,(t75:0.2092617411,(t1:3.856176557,t2:3.77841527):4.030553057):1.115070037):0.2137692219):0.9369248222,((((t3:4.78280626,t4:4.769227139):0.2496772616,t5:4.554948297):1.502877484,t6:6.044669291):3.39745081,((t7:2.832017332,(t8:1.452768146,t9:1.44722599):1.313635649):0.909582023,t10:3.495634685):5.654631099):0.1382050521):0.08020119412,t11:8.914089061):0.5682151516,(t12:3.739155843,(t13:3.488690327,t14:3.404235756):0.1429681089):5.667916073):2.020257163,((t15:8.224125202,t16:8.151882277):0.1094799958,((((t17:5.922133226,(t18:5.527820291,(((t19:3.109569749,t20:3.020675749):0.511885846,t21:3.066440106):0.8341015858,(t22:1.451666039,t23:1.328083617):2.309813219):1.033521344):0.3754355216):1.421144619,t24:6.461842289):0.7600816702,((((t25:1.731580435,t26:1.721414969):2.57084692,t27:4.20704076):2.290292732,(t28:1.762681487,t29:1.656308532):4.684637993):0.10662968,t30:6.372483388):0.4164338685):0.08229855372,(t31:6.635993009,t32:6.583134127):0.1625002961):0.02479595745):2.711504108):0.6306690218):0.8799871717):0.3363262686,(((((t33:0.7202210242,t34:0.5942398102):7.468800125,(((t35:3.868856444,(t36:0.3096782204,t37:0.2056364186):3.499600141):0.5218526486,(t38:3.153851434,t39:3.111300168):0.7952030312):0.1808700288,(t40:2.671514455,(t41:2.254454432,((t42:1.654096573,(t43:1.251534303,t44:1.239322684):0.3538153293):0.07176608276,t45:1.631540403):0.4606420109):0.3411964412):1.406534496):3.321082581):0.02226589796,((t46:3.832039472,(t47:3.705116548,t48:3.645273664):0.074201947):1.745723638,(t49:4.994855558,t50:4.698201988):0.430334087):1.069049693):0.9977068073,(((((t51:1.448707068,((t52:0.3694934822,t53:0.3210747252):0.809868539,t54:1.093704521):0.2460018625):1.403881914,t55:2.678073982):2.135243322,(t56:2.2971469,t57:2.101322021):2.357272939):0.04704987108,((t58:1.573307208,t59:1.461710673):2.546898122,t60:3.899351527):0.3485880212):1.736636354,((t61:1.462087256,t62:1.339758285):2.477210091,(((t63:0.7014988306,t64:0.6603787676):2.812785275,t65:3.364506613):0.2167601969,t66:3.57030185):0.01360494073):1.99423288):0.411834753):1.545979222,(((t67:0.8121341701,t68:0.7556849231):2.316608329,t69:2.779930823):0.5047406861,((t70:2.695954049,((t71:0.7172649024,(t72:0.657640755,t73:0.5705885262):0.006112072831):0.7806584806,t74:1.346946137):1.157472697):0.2270479699,((t76:0.5674067148,t77:0.5629121162):0.8304826397,t78:1.297758469):1.066936336):0.2318261371):3.51757812):0.5597827497):1.455143055,((t79:4.644312827,((((t80:2.111636459,(t81:0.2175817152,t82:0.1322869214):1.843842807):0.1289246727,t83:1.966689033):0.1914789435,(t84:1.765404564,t85:1.748730319):0.3871124629):0.9405810079,(((t86:2.190470789,(t87:1.306742884,t88:1.284228321):0.8607988437):0.06696130235,(t89:1.836481832,t91:1.377352567):0.3257027625):0.2187395429,(t93:1.581882518,((t94:0.7704833937,((t95:0.6147849019,t96:0.2713635265):0.04490017116,t97:0.119678435):0.09645224776):0.6358519927,(t98:0.3608721228,(t99:0.09577437253,t100:0.09268402769):0.1709070605):0.4441858741):0.1226216209):0.08804520207):0.5573884052):1.099888039):0.8103936109,((((t101:0.9992056812,(t102:0.6474690389,t103:0.589486589):0.3443895876):0.007560078663,t104:0.7974058207):0.4670853666,t105:1.021260124):1.580882807,(t106:1.785181068,(t107:0.08784767782,t108:0.05556969606):1.591197926):0.5558898686):0.1035320917):2.627195863):0.138534814):0.4531605712,(t109:0.9934015402,t110:0.5456334811):4.472112503):0.8936247651,(((t111:1.07860732,(t112:0.5578143784,(t113:0.214246662,t114:0.2000730072):0.3401979305):0.4785738244):0.8539477883,(t115:1.141503617,((t116:0.6902091485,(t117:0.5983566518,(t118:0.1394592819,t119:0.1114596428):0.2147157514):0.07755297081):0.1575270938,t120:0.5491423603):0.1267645666):0.6711210954):0.5723586298,((t121:1.322982686,t122:1.14182684):0.1209123623,t123:1.198704357):0.2160609764):3.154357298):0.6204617458):0.3226082907):0.3380601354,((((t124:0.2933261983,t125:0.1131353375):2.031607006,((t127:0.4845569026,t128:0.2348281829):0.6582253289,(t129:0.09853354503,t130:0.06762798584):0.7319112162):0.9074053183):2.181550035,((t131:2.68663846,(t132:1.853811549,((t133:1.055882157,t134:1.053486952):0.4309717436,t136:1.108632835):0.3164034627):0.7975597478):0.6750724725,t137:2.736304254):0.3856850439):0.2566451901,((((t138:1.318233258,(t139:0.7175646453,t140:0.6835457525):0.5140507518):0.0706068675,(((t141:0.3927584356,t142:0.3794762222):0.1574649562,t143:0.4601793273):0.2108572817,(t144:0.3587097867,t145:0.2167656488):0.2159005016):0.3961588336):0.9854041948,(t146:1.043228255,t147:0.9845018138):0.7211552029):0.01138597039,(((((t148:0.4494283579,t149:0.4462592265):0.009962016337,t150:0.3597944774):0.644535778,(t151:0.7827792261,t152:0.7254933748):0.1133676463):0.1441138417,t153:0.885509119):0.04860343784,t155:0.5254644217):0.3777540002):0.590821311):0.9339553262):0.7027947641,((t156:0.5158072528,t157:0.5011756643):2.3487475,(t158:2.728289219,(t159:1.973735863,(t160:1.098212568,t161:1.016645934):0.7387389021):0.7010718677):0.04221736361):0.1566878242):2.057382044,((((t162:0.3198097239,t163:0.3093069292):1.191806201,t164:1.413632431):0.135153632,t165:1.013431658):0.7151766159,((t166:0.3676034307,t167:0.3481487503):1.061808489,t168:1.234623238):0.2363596595):2.237050547):12.33542207):5.203641003,(t169:8.449974487,t171:8.295889566):12.65501536):0.3257870141,(((t172:0.8285818193,t173:0.7182871779):0.7574555597,(t175:0.7782821924,t176:0.5828666662):0.334421196):18.95299905,(((t177:0.6465662012,t178:0.462245248):1.660198035,(t179:1.725901422,t180:1.656263175):0.3498806341):4.583595877,(t181:3.92198613,t182:3.847575288):2.576880689):12.86530619):0.6524564023):3.62142944):3.593812573):2.402278546):18.43230763,((((((t183:4.412530519,t184:4.404042685):5.690727399,((t185:3.613925121,t186:3.531896874):6.153017426,((t187:2.745458515,t188:2.679313572):6.719629763,(t189:2.334901954,t190:2.296579568):7.045497183):0.01403580355):0.009406201339):1.342411173,((t191:8.375331709,(((t192:0.2990800032,t193:0.266753406):2.254719793,t194:2.518099796):4.04438914,t195:6.515380026):1.737963183):1.029997531,((((t196:0.2417432085,t197:0.2305687579):1.835165278,t198:2.059506402):0.4071703967,t199:2.346468679):2.025663199,(t200:1.303178725,t201:0.9281654352):3.064572629):4.737322142):1.110587412):7.353058589,(t202:0.09926179652,t203:0.01332776151):17.06153817):9.162604914,(t204:21.10989285,(((t205:6.467898284,(t206:2.759781001,t207:2.667572595):3.701542508):4.138765952,((t208:0.2389827851,t209:0.2094329364):2.343042744,t210:2.500308679):7.801528089):7.756720262,((((((t211:7.359616765,(t212:0.5219726219,t213:0.4738415336):6.791227932):2.667570543,(t214:4.161182684,((t215:1.392842951,t216:1.306083913):2.126484839,t217:3.372212251):0.6039872175):5.707802366):1.434208287,(((t218:3.858947946,t219:3.824156783):0.6817309592,(t220:4.287922579,(((t221:1.467966418,t222:1.465712406):0.6417088178,t223:2.000873115):1.322409934,t224:3.251570775):0.8435420197):0.0931614613):4.138646013,((t225:1.343069997,t226:1.140603945):2.699320639,t227:3.69006332):4.283569574):2.256204286):3.175928375,(((t228:8.067238789,((((t229:0.2382365807,t230:0.2284875248):0.03308533102,t231:0.1854874025):0.9834354408,t232:1.010759743):5.425278379,t233:6.389376268):1.104439896):1.931764797,((t234:2.68147906,t235:2.649196234):0.4277843398,t236:3.037727848):6.297076496):0.6592254927,((((t237:2.04679343,t238:1.976172114):0.6583707145,t239:2.533665308):4.157753096,t240:6.665430426):0.4092044993,(((t241:2.302456467,t242:1.710985955):0.5121694569,t243:2.173961443):0.5129876803,t244:2.636440848):3.71046713):2.561367326):2.728555424):1.395813074,((t245:1.863676641,t246:1.702931872):2.348087417,((t247:0.9730721562,t248:0.8104670368):2.682843974,(t249:0.9981374451,t250:0.98476412):2.424827214):0.2558889475):8.813523474):0.8578969761,((((t251:0.6975416338,(t252:0.5750385816,t253:0.5719857131):0.02901099417):8.726006184,(((((t254:0.3444486419,t255:0.221319431):3.134888835,(t256:3.225952482,t257:3.195097333):0.09390485719):1.475016401,t258:4.469605844):1.212227697,(t259:0.3029932683,(t260:0.2353069393,t261:0.2349109167):0.05368845527):5.254410984):2.493261237,(((t262:1.171562708,t263:0.9336515021):2.917703329,(t264:0.3573528715,t265:0.3434557492):3.025639628):3.775653815,((((t266:0.1586255606,t267:0.04691661688):0.5984892028,t268:0.6092046481):4.177512019,t269:4.604664932):0.298019081,(t270:0.9667867426,t271:0.8267389637):3.664858578):1.909776184):0.1282120953):0.2886491885):0.1807082838,t272:6.93337218):2.506276574,(((t273:3.658339151,t274:3.474412833):1.183264778,((t275:1.188070426,t276:1.162839461):0.4297305938,(t277:1.250097729,t278:1.001458581):0.2991647531):2.964061063):0.1228979944,(t279:3.255733132,((t280:1.906049452,t281:1.833298781):0.684437286,t282:2.512092617):0.6408310189):0.9964834251):4.369477972):1.108282773):1.074556663):2.732923298):5.018708474):3.648319654,(((t283:3.803932187,t284:3.788424142):11.12784526,(((((t285:0.3711513314,t286:0.2834768431):1.761787724,((t287:1.065077219,t288:0.7382163876):0.4977015385,t289:0.9360044765):0.2082623811):3.031501975,t290:3.910426666):4.17523946,(t291:0.946196213,t292:0.9363656166):6.949160143):4.143404016,(t293:5.696131904,t294:5.676307225):6.310135253):1.415307985):2.468638728,(((((((((t295:4.120367536,((t296:0.7699776424,t297:0.5455426128):1.553396498,t298:1.962262363):1.705566819):0.4725002254,(t299:2.460561256,t300:2.261638337):1.281795733):0.5677988663,t301:4.092702949):3.392190245,((t302:5.363271494,t303:5.249532232):0.7349336508,(t304:1.306051592,t305:1.296196883):4.518619431):0.956113019):0.3394579476,t306:7.093830459):1.35048884,(((t307:1.249542907,t308:0.9592794038):2.64493399,t309:3.554044261):0.3257308177,(t310:2.39436311,(((t311:1.055875582,(t312:0.5346809316,t314:0.07540257157):0.1365004007):0.04700975199,t315:0.1948533983):1.030017324,t316:0.9253499192):0.2183115931):1.326224778):4.16740936):2.29508956,t317:8.794225271):1.813960311,((t318:2.522445004,(t319:2.109966956,t320:2.073373605):0.202285721):0.9639006586,((t321:2.185819354,(t322:0.4357121365,t323:0.4059366017):1.704136588):0.5072989063,(t324:1.483051465,t325:1.454982869):1.132242691):0.5184126184):7.100167477):0.5363310123,((((t326:1.353417214,(t327:0.9947836585,(t328:0.2001255489,t329:0.1610448588):0.7930712743):0.3183688507):1.736718966,t330:2.939415954):6.243872815,((t331:2.910483637,t332:2.868452608):3.193775529,(t333:0.1327818782,t334:0.04497018327):5.868409393):2.954533083):0.1665215327,((((t335:1.090935126,(t336:0.6716759708,t337:0.5369841247):0.418355433):1.293442273,t338:2.030566715):2.584010515,(t339:3.476523432,(t340:0.06277767994,t341:0.007779788291):3.283078568):1.120388838):3.222942668,(t342:4.29563915,t343:4.178125218):3.218484982):0.710881453):1.160340526):0.8553799853):4.542475792):16.37778382):21.82185823,(((((((t344:0.1360102145,t345:0.1002249715):2.509133665,(t346:2.463643493,((t347:0.2727472572,t348:0.2698571528):1.920774361,t349:2.169715863):0.2260961448):0.1136817351):5.861558186,((t350:3.964526423,(t351:1.66867482,(t352:0.8796291663,t353:0.6559186899):0.7297854169):1.971248784):0.5567267109,t354:3.825973897):3.761041883):2.494473374,(t355:2.869816494,t356:2.827660245):7.091513561):1.037423405,(t357:8.115449837,(((t358:3.207993085,(t359:0.268341355,t360:0.238279506):2.926927762):2.960277617,(t361:0.5348760588,(t362:0.2875678012,t363:0.04479248854):0.03884935667):5.576208839):1.420119559,(((t364:1.847325581,t365:1.764870056):1.355754234,t366:3.044588832):0.07892627975,t367:3.018981222):3.663633593):0.4920573343):2.814485633):1.44423155,(t368:4.065242505,t369:3.925378494):7.170395677):9.829546668,((((((t370:3.851874585,((t371:2.842191848,(t372:0.464649402,(t373:0.2438823786,t374:0.2168389708):0.1536117656):2.323973046):0.9788214687,t375:3.582106179):0.01056627527):1.689524404,(t376:1.086069295,t377:1.035660014):4.168003704):1.620721565,t378:6.519104801):1.748472552,(((t379:1.237179112,t380:1.198976567):0.1927081857,(t381:0.5210980924,t382:0.5041466297):0.5572964478):5.639453219,t383:6.515613147):1.159978161):4.661819452,(((t384:3.402064751,(((((t385:0.6318112247,t386:0.6293146651):0.0775520649,t387:0.4810480075):0.2085634578,(t388:0.3978021331,t389:0.3674712106):0.2103611726):0.341861324,(t390:0.6417572379,t391:0.5015361441):0.2552461587):1.706824917,(t392:2.193459468,t393:2.049473032):0.1517401164):0.3682737804):1.085920478,t394:3.62472004):0.7488016545,t395:4.222454557):7.089775452):3.167618924,((((t396:5.799086927,((t397:0.8067661142,t398:0.7970122015):0.4396617928,((t399:0.6299037986,t400:0.6287921348):0.2323495696,t401:0.860294498):0.2860902654):4.204342915):0.9479888269,(t402:5.200163968,(t403:1.616941238,t404:1.548533626):3.529297852):0.9720554272):1.061461062,t405:7.10183321):1.431061157,(t406:4.980116915,((t407:0.9256632686,t408:0.9178457469):1.924834349,t409:2.730254483):2.049560982):3.540049434):4.960496481):4.159511659):29.55126276):14.56058851,((((((((t410:1.538054369,t411:1.457840215):1.398214042,t412:2.720666508):0.06209953325,t413:2.763647267):10.70302714,((t414:8.387492078,((t415:2.768879105,t416:2.76630859):5.464178037,(t417:1.066743769,(t419:0.5548292292,t420:0.505407475):0.01651696903):7.150742026):0.052448161):3.560034049,(t421:1.038508747,t422:0.8227161996):10.17245121):1.476452827):9.119737329,(((t423:0.8062896948,t424:0.6688341849):0.6286693943,t425:1.259025146):2.488477824,t426:3.676130786):17.16773328):10.72692814,(t427:0.966038923,t428:0.8753921252):30.44472526):4.701395145,(((t429:5.03607076,(t430:1.375068629,t431:1.304047484):3.621181123):5.342030853,((t432:0.5821804518,t433:0.4749778567):1.458004315,t434:1.706954917):8.075280192):20.17391655,t435:29.87819527):5.349409953):0.7967049587,(((((t436:2.781560557,((t437:0.8301140011,t438:0.6732014531):1.3255942,(t439:1.679803627,(t440:1.588441443,t441:1.523296144):0.03398530535):0.2964242739):0.4187971156):2.874706051,t442:5.146742127):4.221656409,t443:9.30535657):1.772040053,((t444:0.2279820681,t445:0.1085039495):9.077209403,(t446:4.18485445,t447:4.099530774):4.795117087):1.752697611):6.878323606,(t448:0.4296425432,t450:0.3212146704):16.93614832):17.47583384):22.46752585):8.217955697,t451:65.36601507):236.1126423);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T91.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
