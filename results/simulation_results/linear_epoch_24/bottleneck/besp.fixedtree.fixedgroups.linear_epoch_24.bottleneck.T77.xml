<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t423:1.009755167,t424:0.937399643):0.9957619713,((t425:0.8473128262,(t426:0.501948562,t427:0.4993201266):0.2847045041):0.8301537765,(t428:1.4987515,((t429:0.4729459319,t430:0.3593822663):0.221143276,t431:0.2725761618):0.5548097181):0.1103502157):0.2142867438):1.464323964,t432:2.558845225):3.40828834,((t433:0.507266752,t434:0.4950697441):1.645488861,t435:2.070161644):3.757896532):6.15660795,(t436:3.58639479,t437:3.568394885):8.275058046):26.24331271,((((t438:7.832164051,(t439:3.641773119,(t440:0.5004826537,t441:0.4565915018):3.132878773):4.115525844):0.7495159806,(t442:4.536746217,(t443:0.2442594704,t444:0.2288858632):4.066136708):3.883562717):1.267495898,(t445:5.078542296,(t446:3.60504778,((t447:1.058267263,t448:1.035168143):1.947038143,(t449:2.697797669,t450:2.405417524):0.283315077):0.5319257898):1.396370797):4.333187747):17.9359259,((t451:0.9195587272,t452:0.9029057925):0.861678788,t453:1.697547399):25.06534119):10.22851703):140.1732779,((((((t454:4.375456971,t455:4.35995851):6.701035025,((t456:2.164680201,t457:2.147092946):1.018222802,((t458:0.2218356144,t459:0.1880547872):1.331560094,t460:1.498360336):1.507613314):7.766067654):23.14277857,(t461:1.963665278,t462:1.952822547):31.88638522):1.651550466,((t463:3.42827375,((t464:0.6710610065,t465:0.4766471885):2.278236312,(t466:0.497769792,t467:0.1399309261):2.067796478):0.3817444273):2.554379552,(t468:3.793359426,t469:3.771697285):1.234344273):29.48464208):5.301895773,(((((t470:1.458324078,(t471:1.058204255,t472:0.838147971):0.3932536561):0.8309974259,t473:1.98400087):2.182727406,t474:4.14814034):7.4393279,t475:11.58054517):7.934493609,((((t476:1.186504799,(t477:1.069075248,t478:0.9156285435):0.00267399262):1.604366959,t479:2.260440505):3.513671495,t480:5.677046825):3.150196999,(((t481:1.547224249,t482:1.279761014):2.728571387,t483:3.977818048):0.1441072098,(t484:0.7281823298,t485:0.6454847665):3.362308197):4.397869221):9.961100417):19.93269894):50.42319647,((((((t486:1.291768394,t487:1.047040897):5.249550795,(t488:1.236395258,t489:0.9762605708):4.941682712):2.1627397,(t490:7.334404695,((((t349:0.05054928094,(((t285:0.02038604391,(t261:0.1491286377,(t258:0.01484374508,((t233:0.1095034001,(t214:0.05618854569,(t206:0.04143347091,(((t193:0.07054372351,t194:0.02814608938):0.06110082288,(t173:0.2533415432,(t174:0.00358167801,(t168:0.003487013843,(((t136:0.07932969929,(t131:0.007957993262,((t113:0.03699445023,((((t102:0.1736921612,((t73:0.03984804616,((t65:0.05946273333,(t1:4.33794268,t2:4.251177804):2.614415952):0.305799196,(t3:5.016909521,(t4:4.797528595,(t5:2.060615251,t6:1.838859969):2.685413534):0.2055538229):1.896232337):0.5693554394):2.427150851,(t7:3.486630283,(t8:2.441229138,t9:2.340267882):1.03460237):5.920030626):0.290006589):0.1641493038,((t10:5.431394637,(t11:1.877361978,t12:1.718609884):3.52381733):3.592703393,((t13:6.701112195,t14:6.648633774):1.634883113,(t15:6.906527127,t16:6.840278042):1.330704398):0.4111480141):0.6863458969):0.1131991314,(((t17:8.891381769,(t18:8.433132672,(t19:4.144322903,(t20:1.837367118,t21:1.785873669):2.219331566):3.742808097):0.4110125262):0.08197460408,t22:8.146321728):0.06070237749,(t23:2.999971667,((t24:1.125508661,t25:1.078529512):0.1243180331,(t26:0.0915047756,t27:0.06929590242):0.9607752852):1.744381937):5.142023471):0.2917762866):0.1671339453,(((t28:7.195922106,t29:6.69304):0.09824097061,t30:6.730412474):0.1364552573,((t31:3.547147795,t32:3.483922188):1.08080698,(t33:2.481687735,t34:2.465225305):1.950534636):2.184415662):0.727810771):0.6669840679):0.3417947281,(t35:7.53806677,((t36:2.792488915,((t37:0.3833595775,t38:0.348727311):2.281660538,t39:2.42093832):0.05829816331):3.158270435,(t40:3.3142787,t41:3.273980362):2.322020709):1.411828292):0.580453093):0.8717719013):0.588390319):0.6309345776,(((((t42:4.229956309,((t43:2.76907323,t44:2.726238582):0.956766451,(t45:1.225376792,t46:1.224628949):2.387637214):0.4960283006):1.240102317,((t47:2.363961816,t48:2.328390664):0.08131869906,t49:2.385511717):2.751637717):0.9634685261,((t50:4.119631162,(t51:3.444033713,t52:3.385238436):0.1630388866):1.116042992,(t53:3.755906101,(t54:0.3961198808,t55:0.3680390676):3.348242518):0.8311619139):0.8047082995):0.06644281963,((((t56:4.077019387,(t57:1.250694137,t58:1.105796602):2.803633614):0.199153751,(((t59:0.577658244,t60:0.3461792898):0.5552467091,t61:0.7637795142):1.152803072,t62:1.765373496):1.675735012):0.3652835593,((t63:2.531205379,(t64:1.324622968,t66:1.210153284):1.188788189):0.3503252312,(((t67:0.2969346163,t68:0.1907927389):0.01280533044,t69:0.114389967):1.568869996,t70:1.570701942):0.8182961385):0.7326233391):0.3028684146,(t71:2.471264025,t72:2.465721533):0.7218728432):0.2330895338):2.255562568,((t74:2.147655791,(t75:0.5442143005,t76:0.522802483):1.511757378):2.821740113,(((((t77:0.7009021074,t78:0.4551853065):1.555286525,t79:1.946488444):0.9977141561,(((t80:1.555893323,t81:1.381177235):0.169931387,((t82:0.5512262204,t83:0.4881463082):0.8124000486,t84:1.217556439):0.1653290852):0.3388221916,((t85:1.36247753,t86:1.275697277):0.2332452853,t87:1.323761197):0.04962483333):0.8180410882):0.3629298287,(((((t88:0.9583915634,(t89:0.8809126495,t90:0.8752150084):0.06579209336):0.184711809,(t91:1.015991725,(t92:0.641213686,t93:0.4964541158):0.3436200999):0.07944819597):0.1977582295,t94:1.089031978):0.5412541597,t95:1.526638687):0.1476704633,(t96:0.6491236311,t97:0.5677659727):0.9782073449):0.330968106):0.04015161362,t98:1.858868104):1.069443931):0.4626808878):0.8088995345):0.1064241803,((t99:1.630280935,t100:1.528097576):2.086394991,t101:3.564969892):0.5323007387):1.586188679):0.3044666069):0.1649743926):1.561288181):0.5894184452,(((((t103:0.2774610368,t104:0.2387946204):0.9377675169,t105:1.092163349):1.135596634,((t106:0.803035913,(t107:0.246964183,t108:0.220228385):0.4073719496):0.07278435561,(t109:0.2087436208,t110:0.06668787693):0.3598621889):1.297413661):4.073787656,((t111:4.36088751,(((t112:1.028674811,((t114:0.2614873771,t115:0.2510767353):0.1953163211,t116:0.4157768531):0.2809222765):1.366574221,t117:2.019484146):0.1087210714,(t118:1.018799818,t119:1.018394479):1.086258061):1.716935225):1.275455263,(((t120:0.02995872317,t121:0.01605161471):0.4320482642,t122:0.4253736151):2.905895808,(((t123:1.059471237,t124:0.8153387609):1.403795583,((((t125:0.2205714093,t126:0.1564489495):0.7221632299,(t127:0.4549045227,t128:0.2707153498):0.342630723):0.697518876,(t129:0.8569018101,t130:0.7583978833):0.4101912851):0.08167222487,((t132:0.2365037715,t133:0.1370036825):0.4508124151,t134:0.3989710592):0.4669595566):0.4629689517):0.4572543411,t135:1.784300697):0.3405630497):1.593964626):0.1295095168):1.047931991,(((((t137:0.6448859111,t138:0.5925475093):0.4478297767,t139:0.9224088999):1.122118717,(t140:1.499997372,((t141:0.7287358775,(t142:0.0579573216,t143:0.04384139712):0.4699911095):0.4963798526,t144:0.8797800235):0.2109473499):0.5195556324):0.1647063339,((t145:0.2711935876,t146:0.1974873351):0.8858059843,(t147:0.2530388126,(t148:0.04625105356,t149:0.03169360395):0.2033850747):0.7717105987):0.5508013141):1.303121282,((((t150:0.9902734136,t151:0.8387500452):0.6835189993,((t152:0.100313627,t153:0.07068241792):0.7483619442,t154:0.5826971273):0.5634970588):0.4056934078,(t155:0.4042764967,t156:0.3303894288):1.099293071):0.08671536371,(((t157:0.08963730213,t158:0.04311222889):0.7504938,t159:0.7402536249):0.4839017264,t160:1.112443849):0.1574981744):0.6754489154):0.7592943446):0.3030104711):0.374986464):1.208784929):2.314946029):1.862947388,(((t161:1.847506922,(t162:0.3585907076,t163:0.3006360433):1.484276582):1.192655961,(((((t164:0.4819176941,(t165:0.1736265555,t166:0.1550889787):0.2823540518):1.478257469,(((t167:0.1803747072,t169:0.09707555275):0.6495671145,(t170:0.1633795747,t171:0.1440000968):0.5318625177):0.1889007764,t172:0.8486269826):0.8264527938):0.3123864941,t175:1.476150645):0.09378227994,(t176:0.1776176901,t177:0.09793067591):1.312290636):0.1500987094,(t178:1.138527027,t179:1.008598931):0.4164308327):0.3702600721):0.4669526245,(t180:1.151954673,t181:0.9293623513):1.10975664):5.21106023):0.6201159876):0.5024638982):2.417351211):1.11921601,((((t182:0.3009450533,t183:0.02913723132):0.3163858549,t184:0.3212254833):8.853791075,((t185:0.2595386284,t186:0.2593310287):0.588354287,t187:0.8185276105):8.304569773):1.934669466,((((((t188:0.6175397074,(t189:0.2314916061,t190:0.1734063172):0.1866673422):1.516866152,((t191:0.3402721744,t192:0.3162738878):1.294635573,t195:1.451354184):0.1351772899):0.07478357243,t196:1.496905697):4.084584418,(t197:5.526704559,((t198:0.4296798053,t199:0.3176944566):1.506698705,(t200:1.335275794,t201:1.234476943):0.4746615974):3.513205473):0.05064363817):3.254892081,((t202:0.513388378,t203:0.4515421292):0.9497775416,(t204:1.232839521,((t205:0.5980990486,t207:0.1573466453):0.2245525215,t208:0.2747535099):0.2027061899):0.06212903828):7.039821509):0.9194583815,((t209:0.2643408189,t210:0.1248932774):8.032662732,(t211:0.3108487336,t212:0.1914450072):7.828489614):0.0664934182):0.573087294):0.4961829372):3.965884069,((t213:3.453891118,t215:3.074523112):2.123463642,t216:5.175103754):7.42677224):1.040158107):5.2170188,((((((t217:7.951246181,((t218:2.039994792,t219:2.007344995):1.29089067,t220:3.149177081):4.548504293):2.193479672,(((t221:1.794967371,t222:1.694973115):1.141733655,t223:2.645617061):5.05795043,t224:7.317426843):1.529152504):1.541177047,(((t225:4.323496477,((t226:2.0299888,((t227:1.002460499,t228:0.9620182926):0.5000120173,t229:1.451578467):0.492159423):2.193231155,t230:4.06696182):0.04943358048):2.937871932,t231:7.025310079):1.110434033,t232:8.072044797):1.972843872):0.9514417229,(t234:0.3901708623,t235:0.04869229475):10.38617334):1.065399129,((t236:6.63526935,((t237:4.307073442,((t238:2.763983189,((t239:0.6634728304,t240:0.5590793668):1.841707503,t241:2.190080597):0.2370935296):1.15166826,t242:3.574699969):0.328377753):0.3989487207,t243:4.28038966):1.865865875):2.675766649,(t244:3.782599873,(t245:0.4709295003,t246:0.2102933602):3.220314793):4.980963746):2.152572903):0.666411641,(((t247:0.4567139865,t248:0.4549544336):0.4501486975,t249:0.4058884111):4.670168374,t250:5.070887125):5.591958986):4.208616453):1.921669288,((t251:13.81560743,((t252:9.667658469,(((t253:6.776727386,(t254:2.264450798,t255:2.190277906):4.367217601):2.061947148,(((t256:3.611275383,t257:3.573520782):1.109954822,(t259:0.5260163726,t260:0.3985369554):3.87709268):0.5673719276,t262:4.672378303):3.280613906):0.6337240615,(((((t263:1.905452381,(t264:1.014086809,t265:0.9736467705):0.8855280126):0.9676304428,t266:2.823335905):1.93755163,((t267:3.257631317,(((t268:1.231106758,t269:1.176026403):1.06774067,t270:1.786295234):0.3481193763,((t271:1.470926179,t272:1.385011332):0.5268785151,(t273:1.207545507,t274:1.167848173):0.3750424337):0.06776017037):0.5363140655):1.165402132,t275:3.205146698):0.2268387251):2.643878809,t276:5.599008978):0.3931113279,((t277:0.2733804786,t278:0.2335674332):1.267578734,t279:1.482215934):4.399470673):0.6114335644):0.1120197934):1.201481519,((t280:3.105788867,(t281:2.644671562,t282:2.631812563):0.43023683):3.545338248,t283:6.519593978):1.079597837):2.886018432):1.962505423,((t284:3.095321022,t286:2.861806139):1.434610196,(t287:1.864200842,t288:1.860522569):2.254753767):7.873055814):0.912957569):2.376839326,(((t289:6.56197013,t290:6.55036342):5.568905609,((((t291:4.935238769,((t292:0.3387481326,t293:0.2885764966):4.058762211,t294:4.276420798):0.4147046755):1.020669205,(t295:1.373930434,t296:1.315992691):4.337614524):3.611185907,((t297:5.975889265,t298:5.945988571):0.6438449651,((t299:2.450998078,t300:2.412584901):1.372437867,(t301:1.269353541,t302:1.212855847):2.282050715):2.718664984):2.620300268):0.004478125683,((t303:3.204773036,t304:3.167873924):2.713412064,(t305:3.955732943,t306:3.910322569):1.679750407):2.866447557):2.483674294):2.11709867,(t307:1.921384944,(t308:0.6067526991,t309:0.4279742198):1.296652183):10.91846246):1.010087306):11.67367271):0.723134539):5.811156646,(((((t310:7.331942283,((t311:0.9826792232,(t312:0.03555653203,t313:0.001387455089):0.9328516484):0.3540633975,t314:1.183021926):5.620724201):1.90390222,((((t315:1.612340387,t316:1.571393862):0.006986576642,t317:1.489687333):1.380061454,t318:2.74486641):2.093631424,(t319:4.68125226,(t320:2.7095588,t321:2.492702592):1.655108181):0.0314740551):3.540349195):2.220733183,(t322:6.462013419,(t323:6.154738143,t324:6.095443584):0.1572155993):3.466376175):8.535299494,(((t325:8.344280984,(t326:4.179001655,(t327:0.5965029003,t328:0.5145576254):3.456857971):4.065719542):3.924680867,(((t329:0.311780659,t330:0.2646226659):0.5489222545,t331:0.5149000793):0.5682741157,t332:1.038625347):10.23393661):3.410961289,((t333:7.453421926,(t334:3.686185634,((t335:0.4587516515,t336:0.4311696133):2.761747594,((t337:0.5293803526,t338:0.5225434116):0.4973177816,t339:0.9500716965):2.091680209):0.4654580869):3.758516752):1.940893892,(t340:7.808059982,((t341:4.493551047,((((t342:0.7581183841,(t343:0.6146125863,t344:0.6026850604):0.138897609):1.316760205,(t345:0.4640785807,t346:0.4032057428):1.56481504):1.154971441,t347:3.079640047):0.08112527314,(t348:0.9192470642,t350:0.6847030166):2.211280172):1.086481656):1.088409109,(t351:0.5914790565,t352:0.532664563):4.209789073):2.217162706):1.244888347):5.058828623):2.38104885):6.965317153,(((t353:7.612810808,((t354:0.4114116303,t355:0.3227281401):6.84140344,(t356:1.97521349,t357:1.444789882):5.145727592):0.3563755711):2.911533482,(t358:7.695341018,(t359:3.596025787,t360:3.545004118):4.074666232):2.134643451):6.634713958,((((((((((t361:0.726630844,t362:0.577445004):0.3980646944,t363:0.7445149542):0.9259745707,t364:1.619349653):0.2283301525,t365:1.824955867):1.016287713,(t366:1.263786725,t367:0.7700183329):1.530150041):3.090326782,(t368:4.915919422,t369:4.892244118):0.2086589328):0.4233493653,(t370:1.006328908,t371:0.9740646805):4.428684827):1.513258412,((t372:2.368988578,(t373:0.8480781646,t374:0.7498888167):1.36316541):2.35126064,(t375:2.594499561,t376:2.555527438):1.760739718):2.171801094):2.046188923,t377:8.518528489):3.380680782,((t378:4.46852961,(t379:2.874407545,(t380:1.824066259,(t381:1.669157934,t382:1.649348396):0.06868671226):1.033385614):1.593615159):0.6900023452,((t383:0.2269606958,t384:0.206382587):4.315095623,t385:4.453147431):0.4473618453):6.734302692):2.603938297):5.331171898):4.643769782):3.125365389,(t386:10.50573624,(t387:1.112076274,t388:0.9544824849):9.374766706):16.56770855):6.155384184,((((((t389:1.888862091,t390:1.691450276):0.1760600431,t391:1.696925123):3.634477184,t392:5.146040316):0.8162359031,((((t393:0.8002922362,t394:0.7837930214):0.6121820274,t395:1.338011097):2.660038563,t396:3.938177671):0.5976240635,t397:4.450412733):1.169116617):6.725120892,(((t398:3.216038766,((t399:1.204173987,t400:1.087123058):0.9676574768,t401:2.01526743):0.8301484561):0.8025861701,t402:3.503945491):7.158547989,(((t403:0.1767516544,t404:0.1080418195):2.516606746,(t405:0.7777668585,(t406:0.4161041748,t407:0.396349663):0.3306391027):1.705771953):6.362206058,(t408:8.693525063,(((((t409:0.07557936511,t410:0.02821744871):2.184140092,(t411:1.533601501,(t412:1.045349792,t413:0.8469717802):0.417352523):0.6422130776):3.336216439,((t414:0.2230686089,t415:0.1658205516):3.224578075,t416:3.240887826):1.79472299):0.3691094096,(t417:0.8070611551,t418:0.5633663105):4.525697863):0.008356443291,((t419:0.5547794726,t420:0.3087169312):2.168618665,t421:2.460663059):2.157312325):2.283059931):0.09830506384):1.553082293):1.138540713):7.978145152,t422:17.57754294):11.78800736):64.89757844):85.50932935);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T77.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
