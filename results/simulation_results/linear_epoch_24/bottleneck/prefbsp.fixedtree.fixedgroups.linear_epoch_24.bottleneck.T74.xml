<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t424:7.6359202,(((t425:0.5034200099,t426:0.4416541798):0.0379936344,t427:0.2950060553):4.730789868,(t428:4.623706977,t429:4.323046202):0.3628877532):2.284285299):3.930091202,(((t430:0.9490183565,t431:0.8534568522):2.510150041,t432:3.281156652):1.212724799,t433:4.476252042):6.067769964):91.1015837,(((((t434:1.913766385,(t435:1.495837657,t436:1.359566984):0.3895293629):1.310194169,(t437:1.450181122,t438:1.358733379):1.596452855):27.56004718,((((t439:0.8001467848,t440:0.7412145102):0.4894877397,t441:1.151197629):0.02078453562,t442:1.122581559):20.13630178,(((t443:1.608802801,(t444:0.1691011286,t445:0.1442448937):1.279862728):8.442352848,((((t446:3.665440027,t447:3.554636126):0.6310766957,(t448:1.16076947,t449:1.027896151):2.924880997):1.717142462,t450:5.482109429):2.419743216,(t451:0.9088699061,t453:0.6533144729):6.799700869):1.234826878):8.68637619,((t454:0.1417948527,t455:0.138684741):4.286000538,(t456:3.310126167,t457:3.202070423):1.03964506):12.90927169):2.443419464):9.024587072):4.300987516,t458:32.85759964):8.909680457,(((((t459:2.586657303,t460:2.369882423):1.026136623,(t461:2.547105805,t462:2.480288619):0.7584697721):0.4121751302,t463:3.552545661):7.467633009,((t464:3.599937392,t465:3.531822814):3.228213927,(t466:3.573300819,(t467:0.4892969069,t468:0.3297463705):2.815756932):3.167290229):4.139838864):23.67112209,((((t469:3.366851477,t470:3.300970604):6.597491267,t471:9.610182463):4.124852658,(t472:4.218272989,(t473:3.887954751,(t474:1.516091714,t475:1.499025495):2.32325566):0.07961693432):9.48374062):0.6775588664,((t476:1.089046748,t477:0.865008396):6.81504234,((t478:2.97371963,t479:2.889210327):1.733532759,(t480:1.4584739,t481:1.44582952):3.153511945):2.70291574):6.141099689):19.20799919):6.538889707):57.60150906):104.1845339,(((t482:8.357893941,t483:7.961075905):3.72152611,((t484:0.6962078719,t485:0.6943382442):7.555067588,(t486:0.2033142,t487:0.1981617123):7.965095032):3.425033204):42.08569007,((((t488:1.369655236,t489:1.199191889):2.868780731,(t490:1.085865135,t491:1.04790858):2.889784726):7.820541349,((t492:1.074218363,t493:1.044996993):7.125577356,((((t494:0.1893287304,t495:0.1291740348):2.533630461,(t496:1.701957514,((((t452:0.02824879228,(t419:0.02608403775,(t380:0.02876615009,((((t267:0.0403637185,(t238:0.1344544163,(t234:0.07296139037,(t231:0.0209205999,(t174:0.02145931555,(t168:0.009798681049,(t163:0.1816056902,(t154:0.01991741207,(((((t95:0.1777501617,(t1:10.1139179,(t2:9.030387976,((t3:7.313272241,(t4:7.014446365,((((t5:0.8011618242,t6:0.7934771412):1.200601014,t7:1.757346281):2.541750567,((t8:1.645569693,t9:1.599799857):1.588536993,t10:3.08155108):0.9392557796):1.616254,(t11:4.611892351,t12:4.540555498):0.8338880604):0.7221449044):0.0961777427):0.4669788481,t13:6.447409326):1.170206102):1.019933749):0.1435025598):0.05232710723,((t14:2.704913006,t15:2.584784579):5.881858167,(((t16:2.007958813,t17:1.636050693):2.955211463,(t18:1.229158663,t19:1.121991426):2.872930317):3.383176422,(t20:3.342068287,t21:3.237642307):3.884514679):0.02287718191):0.1971262498):0.3883783834,((t22:6.296907529,t23:6.248299691):1.40052734,((t24:3.016166706,t25:2.797752692):3.799001003,(t26:3.593032735,(t27:1.419922716,t28:0.885886143):2.117336171):2.885931849):0.5558777239):0.00508476254):2.90361247,((((t29:4.350456844,(t30:0.9957160767,t31:0.7824024114):3.145747514):1.028881844,t32:4.911664407):1.806206366,((((t33:4.445921189,t34:4.393533822):0.1012477962,t35:4.46657787):0.6867889081,(t36:3.243772317,t37:3.201475922):1.835135292):0.6422754253,((t38:4.83441645,((t39:1.441149552,(t40:0.3032285342,t41:0.2396689192):1.045162468):2.795717741,(t42:3.775554163,(t43:2.926897969,(t44:0.2712331014,t45:0.2240149766):2.626930474):0.6872281768):0.2728293349):0.4159365978):0.1168947958,t46:4.331962513):0.6902582054):0.6795508435):1.835191612,(((((t47:3.423586646,(t48:1.294340052,t49:1.256822555):1.954341059):0.7420951265,((t50:2.027243153,t51:1.915749392):1.433432244,((((t52:0.4968359409,t53:0.434960822):0.1190192811,t54:0.5048627228):1.170224662,((t55:0.5616622708,t56:0.5006129384):0.2792085286,(t57:0.6426618967,t58:0.545884025):0.02158031262):0.6909352653):0.5020587704,t59:1.673574138):1.028979468):0.4716222097):0.01310520596,(((t60:1.228201312,t61:1.213733664):0.8404430849,t62:1.865433485):1.050064,t63:2.845172405):0.04046961441):1.110354757,(t64:3.604979154,((t65:3.008014252,(t66:1.154635984,t67:1.115730261):1.834673916):0.4743516213,(t68:2.640155494,t69:2.616604574):0.7791230782):0.1035526848):0.3907213891):0.2504861261,(t70:2.650740652,t71:2.626786558):1.416393491):1.99327936):0.1534360682):1.530453883,(((((t72:2.606734416,(t73:2.239366009,t74:2.17863219):0.2032718634):0.5023853037,((((t75:0.6343686287,t76:0.616549558):1.427346266,t77:1.982187893):0.3166623027,t78:2.267401007):0.2255327328,t79:2.394527279):0.2738360062):1.390481749,t80:3.997495348):0.9956253228,((t81:2.631979693,(t82:1.799933619,(t83:1.738619067,t84:1.725451116):0.05519383391):0.59523539):1.223970041,(((t85:2.835466831,((((t86:1.124676181,t87:1.040200729):0.1023397015,t88:1.132592169):0.4127860004,(t89:1.197811057,(t90:0.7685654987,t91:0.4936627861):0.08236229565):0.1742526426):0.06714174377,(t92:0.5941478261,(t93:0.2822700831,t94:0.1416667768):0.189275439):0.1325601895):1.040489367):0.03041527159,t96:1.287447021):0.03863161601,(((t97:0.4243399094,t98:0.408925406):0.09952119934,t99:0.4717297348):0.2606472701,t100:0.3665426901):0.2252673856):0.4326775959):0.9474031958):1.400286991,(t101:0.2005489779,t102:0.1718145179):3.030139305):0.7035933222):0.3737597683):1.86472426):0.4907733115):0.7166902865):4.715100774):0.8467158152):0.4601033635):2.451633643):0.05034523448,(((((t103:0.8358233962,t104:0.7985874656):1.439098766,((t105:0.2813170069,t106:0.263226687):1.808106316,((((t107:0.9280418877,t108:0.8674538296):0.6015167723,t109:1.442799287):0.0451970356,(t110:0.14991675,t111:0.08501948941):1.31226278):0.02904167052,(t112:0.8626666421,t113:0.7980503173):0.457785916):0.3876270595):0.07565601336):1.710352781,(((t114:0.7818941959,(t115:0.626251328,t116:0.4164522804):0.00777956413):0.6920429114,((t117:0.06075593567,t118:0.004763823643):0.2479010017,t119:0.2077971002):0.7354379372):1.520861966,(t120:2.004491063,((t121:0.3425539009,t122:0.209601019):0.9683431714,t123:1.085492454):0.69240333):0.4252486069):0.2980104379):2.765197205,(t124:0.3099955051,t125:0.2005859545):4.880685824):8.990959559,(((((((((((t126:1.423683329,t127:1.42277503):1.743494817,((((t128:0.470361614,t129:0.2361823151):1.13687073,((t130:0.3034204012,t131:0.2949438412):0.7055932957,t132:0.9301369487):0.3057264181):0.5551457516,t133:1.592074579):0.8525649692,(((((t134:0.6999657493,t135:0.3619115007):0.08164068781,t136:0.4340543434):0.3953615851,t137:0.7792111378):0.205212709,t138:0.835522184):0.7779827671,(((t139:0.1545029974,t140:0.1483664813):0.09985346113,t141:0.1872734248):1.14375911,(t142:0.0570008076,t143:0.02194167778):1.208261679):0.1032535971):0.2579316169):0.1313080926):0.2095265855,t144:1.854149464):0.7406910129,((t145:0.3623858774,t146:0.3058439116):1.06449747,((t147:0.8165360923,t148:0.8147224622):0.1666923194,(t149:0.1567373071,t150:0.1258717193):0.7135041568):0.3003979197):1.151530507):0.8594279882,t151:2.926242459):0.7154276547,((((t152:0.1449636778,t153:0.1440011484):0.8152050021,t155:0.6055440038):0.5865951098,(t156:0.7183882688,(t157:0.4310662827,t158:0.3948698138):0.1095356513):0.3220320179):1.915065376,((t159:1.401254263,(t160:0.267499131,t161:0.2247660628):1.018880353):0.8789308939,((t162:1.585122485,t164:0.7447640567):0.1742429397,(t165:0.1380937776,t166:0.09214094997):0.7061540474):0.1628285231):0.2738230108):0.09005948463):0.4088144992,(t167:1.524307768,(t169:0.6853879268,t170:0.2963327427):0.6835395009):0.09234032051):0.1923434683,((t171:0.4893666689,t172:0.4175850951):0.4436000678,t173:0.8334699284):0.3307227587):0.1782119337,(t175:1.155673257,t176:1.093616928):0.03233303344):0.06660573305,(t177:0.2757200284,t178:0.1938967557):0.7027424156):1.299861653,t179:2.139777253):5.880513094):0.07916146569):5.832223513,((t180:0.6120578595,(t181:0.2605436919,t182:0.1981376051):0.3380526048):10.97735772,((t183:6.346735094,(t184:6.253297879,(t185:0.4966946917,(t186:0.14636461,t187:0.1382022098):0.2913557011):5.622628714):0.08275697388):1.293126771,(t188:4.61082197,(t189:2.536626714,(t190:0.6147467432,t191:0.5893271159):1.916480457):2.044596968):2.810746489):3.780345399):2.267596235):1.075852589,(((((t192:1.475927222,t193:1.447178217):5.862789814,(t194:6.883724662,(t195:1.345829534,t196:1.223521008):5.509484845):0.3897251621):3.292823422,(((t197:1.631598397,(t198:0.4039903861,t199:0.3736860683):1.208435245):3.531567125,t200:4.841098645):0.02487539607,(t201:1.215847385,t202:1.159554116):3.544403259):5.137480132):2.09343854,(((t203:2.907521035,((t204:0.4002178379,t205:0.3773014534):1.62447579,t206:1.994415727):0.8824357871):4.261010983,(t207:1.396011388,t208:1.342487168):5.654772217):0.6305025999,t209:7.461006611):4.052070502):1.55013886,(((t210:7.612091356,(t211:4.025906899,((t212:0.6044947685,t213:0.4742180443):3.332029554,t214:3.6982519):0.08111799842):3.545633823):1.492259762,(((t215:3.62376509,t216:3.444365709):1.378576969,t217:4.814419383):1.262108372,(t218:2.811547827,t219:2.691244086):3.189284239):2.364334925):1.504702093,((t220:2.125145654,t221:2.030786063):3.495753733,(((t222:1.475385336,t223:1.298798618):0.1853426213,t224:1.414672113):2.131986646,(t225:0.9474023271,t226:0.8851740079):2.295550777):1.73064591):4.079025138):2.339233825):0.03056382423):2.817926046):3.453413246):3.546846828):0.07959806679,((((t227:1.90766863,((t228:0.4299906824,t229:0.3841964208):0.984314688,t230:1.350247533):0.4294465549):0.849138381,t232:2.292794797):0.5140196904,((t233:1.341677752,t235:0.7363243368):1.137495502,(t236:0.8505401196,t237:0.7658970811):0.8038482867):0.2325528663):3.8277534,t239:5.306789232):13.81558879):2.320844223,(((((t240:5.193853717,(t241:4.995838576,(t242:4.898823909,((t243:4.142500805,((t244:0.7617256324,t245:0.6263868016):3.146105704,(t246:0.5403539007,t247:0.4941496104):3.172470309):0.1275775147):0.06490549035,(t248:3.507869899,t249:3.482730831):0.2877652437):0.6317015413):0.03706140213):0.1634640107):6.054077164,t250:10.62715351):3.001614539,(((t251:1.887787661,t252:1.868138739):4.329711664,(((t253:3.606584941,t254:3.302253784):0.8120639705,t255:4.091808634):0.6015412973,t256:4.554728538):1.012274779):1.266623733,t257:6.830290523):6.044091429):0.6922253268,(t258:5.142736775,t259:5.05024378):8.237463696):2.66735247,((((((t260:0.6492739486,t261:0.6377966282):1.669490677,t262:2.224046268):0.02161370779,t263:2.219421058):2.064516541,t264:4.274361478):6.485783415,((t265:6.014341975,(t266:4.397854925,t268:4.06285034):1.599922959):0.6723374514,(t269:1.468762423,t270:1.406282377):4.853075939):4.036599436):4.827910417,(((t271:5.575495169,t272:5.495987129):3.43049583,(((t273:3.103666052,t274:3.017065256):0.5087069574,((t275:2.395233958,t276:2.364527198):0.9373284776,(t277:0.3375563342,t278:0.10623453):2.91536353):0.1546398574):1.996793373,(t279:0.5667331609,t280:0.5138797671):4.483739432):3.154001859):2.440341292,(((t281:0.2934701631,t282:0.07676662101):2.87559286,((t283:0.08676158293,t284:0.06560218969):2.406099903,t285:2.263383661):0.3690432463):4.407316496,(t286:0.2678687171,t287:0.2536857146):6.765702176):2.909125764):3.576369041):0.2232707246):3.729613304):0.874541159,(((t288:1.942794352,t289:1.833045403):3.336089277,t290:4.986755187):4.230606662,(((((t291:0.7707433011,t292:0.7582644116):0.9160012427,t293:1.667204523):0.5292278736,t294:2.096690539):0.4083164958,t295:2.450897804):0.7957506669,((t296:0.7613338928,t297:0.7058509689):0.6653761024,t298:1.337504574):1.667816239):5.68763818):8.741066073):2.508206361):0.8685692704):3.241962396,((((t299:2.288203685,t300:2.273116832):4.739855372,t301:6.692349232):3.834435323,((t302:2.209859275,t303:2.074755809):1.601856582,(t304:0.4511344666,t305:0.4081921499):3.169221902):6.708668117):3.299799254,((((t306:2.070635149,(t307:1.117836947,(t308:0.3914220216,t309:0.3650826108):0.6632249438):0.8605235143):1.83941657,((t310:2.269413162,t311:2.25065061):0.1169855399,t312:2.318565228):1.265244146):0.8790024565,t313:4.396476336):3.90177943,t314:8.263208598):4.818100552):9.780719887):1.031900665,(((((t315:0.8708260642,(t316:0.6083394914,t317:0.3060291806):0.1436652229):6.805188474,((((t318:0.4791137501,t319:0.470615799):0.3349439076,t320:0.7310974316):5.683112619,((t321:4.108393465,(t322:1.943025989,t323:1.915587346):2.026327396):0.3424541065,t324:4.272224692):1.765912323):0.5586822566,(((t325:2.660182077,t326:2.656952398):2.938875663,(((((t327:1.046785067,t328:1.039261676):0.893297622,t329:1.80574533):0.7004287848,t330:2.423470473):2.356703256,((t331:2.19571217,t332:1.965774674):1.651419919,t333:3.310034943):0.7695152938):0.2138110671,(t334:0.6395741641,t335:0.5533631128):3.540143628):0.3617519105):0.8981402591,((t336:3.837960593,(t337:1.730535689,t338:1.649452429):2.076461731):0.517604603,((t339:2.446207508,t340:2.226987621):1.055873249,t341:3.229160667):0.6255194582):0.992320952):0.0760486006):0.1735082545):5.493382929,(((t342:0.5754057707,t343:0.5634905):4.487023854,(t344:0.8787563423,t345:0.8460154257):4.135920527):3.54996002,((t346:0.1007505216,t347:0.05191839935):2.08569685,t348:2.095393597):6.307058041):1.804899182):9.878774511,(((((t349:1.739863164,t350:1.475775092):1.874178153,t351:3.316469961):0.04723557006,t352:3.359891382):0.583089315,((t353:0.4551930855,t354:0.44515575):0.2374697575,t355:0.6561208395):3.24658679):6.451223844,((t356:3.403551093,(t357:2.341027247,t358:2.307168428):0.9871207458):6.524903868,((((t359:1.808710534,t360:1.431996102):0.8155678071,(t361:0.8162083433,t362:0.812399302):1.251992042):2.467505611,t363:4.256770745):3.194378435,(((t364:0.7844378371,t365:0.7365247179):1.841619005,(t366:1.335141991,t367:1.306939717):0.9790920712):4.42548284,(t368:6.197374456,t369:6.057016229):0.5126869415):0.3340201192):1.422502706):0.4234327108):9.37029794):0.3047472998,((((t370:0.6221625134,t371:0.6139840465):8.104306859,(((t372:2.902398736,t373:2.677802558):1.517270463,(t374:1.664261246,(t375:1.114500878,t376:0.8763474824):0.4900440667):2.384512817):3.637854765,((t377:1.495685527,t378:1.345209262):3.616244107,t379:4.926357715):2.268757187):0.6229283304):6.06520431,(t381:10.5454047,(t382:6.885513288,((t383:3.040574104,((t384:0.8852327374,(t385:0.2222634119,t386:0.1315138692):0.5608086627):0.8426569763,t387:1.529697906):1.09491434):0.3260529828,((t388:2.116472633,t389:2.102008276):0.5131791697,t390:2.595135186):0.1313204754):3.516728561):3.58905619):3.098805919):2.262724556,t391:14.98374251):1.296541355):0.5144684129):1.152468391):3.542675697):9.455814602,((t392:3.365401216,((t393:1.335746185,t394:1.289095375):1.075881214,(t395:0.9584411916,t396:0.8712465132):1.20135441):0.7713765302):5.025935189,((t397:2.931217599,(t398:2.072801336,t399:2.009184249):0.8550264439):2.567543819,(t400:3.122231935,t401:3.01373582):2.210662016):2.192798224):22.52451579):32.05750082):146.7921914):53.85390795,(((t402:1.403968846,t403:1.344158378):6.295553224,((((t404:3.134977716,((t405:0.9889526268,t406:0.9180854338):1.704130722,(t407:2.142124469,(t408:2.034512242,t409:2.011726784):0.0251749435):0.3999204311):0.3576921748):0.7509971778,(t410:1.286879491,t411:1.174791067):2.17488698):0.01385579664,(t412:3.204822555,(t413:3.109850097,(t414:0.8080837476,t415:0.790859087):2.203952681):0.08209875587):0.09058780327):0.8206065131,t416:3.926235885):2.853669968):7.463789897,(((t417:1.891138069,t418:1.85449064):4.032826658,(t420:2.822927805,t421:2.614256693):2.916415128):0.8978769718,(t422:1.548905511,t423:1.474221216):4.790760417):7.25389204):247.3307826);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T74.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
