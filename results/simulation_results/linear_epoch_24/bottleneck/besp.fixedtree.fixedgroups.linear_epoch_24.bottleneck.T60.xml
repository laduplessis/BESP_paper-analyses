<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t445:4.691807692,t446:4.669866646):10.6789035,(t448:5.72794089,(t449:3.022705604,(t450:2.174469569,((t451:0.3888604196,t452:0.3392906349):1.139925385,t453:1.31680813):0.6383706047):0.6502688488):2.690358258):9.229809517):119.178589,(((t454:5.532785253,(t455:1.817692883,t456:1.757128746):3.546679098):39.99778077,((t457:14.93115206,((t458:7.711650888,((t459:3.777740253,(t460:2.782857259,t461:2.70590058):0.777567773):0.3878623802,(t462:1.064658079,t463:1.011806725):2.801961525):3.421718):2.767216255,(t464:4.250141636,t465:4.186269496):5.475819261):4.432092678):10.75795345,(((t466:2.00394551,t467:1.954781022):13.16514415,(((t468:2.880577075,t469:2.709193723):0.2260493561,((t470:0.2462686252,t471:0.202098647):1.216112726,t472:1.382449533):1.313500152):1.44245493,t473:3.997379108):10.53244103):1.551305472,((t474:4.192509171,(t475:0.8626981647,t476:0.8329408638):3.293523448):0.9325302792,((t477:0.4139841457,t478:0.164365614):2.343946379,t479:2.357176514):2.124033114):10.89860608):8.093594848):19.53659571):43.87974308,((((t480:2.970584365,t481:2.95719627):1.233364952,(t482:1.547601404,t483:1.526224805):2.638360454):0.001568248625,(t484:0.9598734928,t485:0.6982121798):3.112246841):21.2395386,(((t486:3.347358607,((t487:0.4485833123,(t488:0.1981396672,t489:0.1331610467):0.1309391519):2.315244965,(t490:0.7041959384,t491:0.4614078662):1.782560891):0.5502949743):12.51887253,((((t447:0.07163310336,(t416:0.04613314607,(t415:0.01640941522,((t379:0.03371117586,(((t314:0.1347753765,(t315:0.04888106503,(t307:0.0660939929,((((t171:0.2564821742,((((t140:0.2057929214,(((((t121:0.04373727167,t122:0.03536133594):0.05844677584,(t116:0.2330018875,(t113:0.01176996442,(t54:0.02273703244,t1:5.451083159):4.703463416):0.5338507915):0.3898677028):0.3211481653,(((((t2:5.410595495,t3:5.212085427):1.860121714,((t4:4.561945079,t5:4.481248777):0.216682537,t6:4.666683933):2.155321446):2.349360827,t7:9.151677882):0.1529421259,t8:9.244509201):0.9593827246,((((t9:5.692301865,(t10:3.94483526,(t11:1.227160461,t12:1.185800851):2.67217002):1.285040065):0.7061267342,t13:5.704396529):2.255410698,t14:7.917697071):0.7120914207,(((t15:5.679050931,t16:5.657619851):2.249827887,((t17:1.543378023,t18:1.507495268):0.01229837374,t19:1.43328569):6.228185141):0.5988538785,((((t20:1.840936935,t21:1.739007181):1.126949367,t22:2.441027746):4.945694536,(((t23:4.100067769,(t24:3.866254823,(t25:2.558592673,t26:2.424793467):1.142284929):0.02739652609):0.6576517452,t27:4.243119758):0.2523875257,t28:4.490332922):2.249691639):0.03659046965,((t29:3.251728669,(((t30:1.891504488,t31:1.838584407):0.3976528872,t32:2.222330291):0.06654505189,t33:2.253440062):0.5941555703):1.440477043,t34:4.221113997):2.08150312):0.2200697302):0.06217089972):0.8307278566):0.5180575671):1.779677253,(((((t35:0.6673182979,t36:0.5214377133):0.5242396076,t37:0.8342939242):3.065489515,t38:3.88887877):2.335168792,(t39:5.728038463,t40:5.667114625):0.3184606324):0.3435115334,((((((t41:1.180741803,(t42:0.8570274836,t43:0.7933349265):0.2199854961):1.530988612,t44:2.445832398):1.098011067,t45:3.491505082):1.459481054,(t46:2.436621736,t47:2.333564428):2.167444753):0.2638158421,(t48:3.860107166,(t49:0.7069500709,t50:0.6554240925):3.129436017):0.7166914404):0.02599837526,t51:4.515219735):0.7004185308):2.73224537):0.1191079404,((((((t52:1.412087704,t53:1.29102483):1.915178464,t55:2.978061009):1.773463859,((((((t56:1.503319249,t57:1.432703672):0.5919695883,t58:1.648369098):0.824917571,t59:2.461409753):0.1554634182,t60:2.463944187):1.308003456,((t61:2.483962078,((t62:0.2441793166,t63:0.2068960036):0.4376955729,t64:0.5843575635):1.772994404):1.072914957,t65:3.332555608):0.2107581172):0.07328574224,(t66:2.926034001,t67:2.758285683):0.6376427923):0.2013984994):0.988948561,((((t68:0.73761835,t69:0.6658248702):2.225365932,(t70:2.260308455,t71:2.183512532):0.6134818381):0.1277598417,(t72:2.912302547,(t73:2.035488338,t74:1.997774971):0.8752147788):0.0008849525717):0.4446550439,t75:3.314583326):0.9544846928):1.254382766,(((((t76:2.400076573,(t77:2.089886112,t78:2.058671254):0.1329289702):0.1031057421,t79:2.293106154):0.05507253874,((t80:2.056913237,t81:1.881650661):0.0006794053029,(t82:0.732163608,t83:0.7314684255):1.127775804):0.1371982729):0.5336639951,((t84:2.320903727,((t85:1.736144243,t86:1.652422925):0.1613040576,((t87:1.480502936,t88:1.30231631):0.1540917721,t89:1.455643272):0.0375123216):0.2940460091):0.06437111867,((t90:1.460045422,(t91:1.020014573,t92:0.6604233381):0.3350695371):0.04809011785,t93:1.030453728):0.1481662388):0.1434305988):0.5613013953,((((t94:0.4430031576,t95:0.4358233981):0.1595980608,t96:0.5036793625):0.03543661709,t97:0.5325309487):0.6889793645,t98:1.177803225):0.4403324392):1.604864795):0.2090120734,(((((t99:0.3725628758,t100:0.1554338208):0.646583936,(t101:0.1047212098,t102:0.06458396353):0.594781102):0.8874346095,t103:1.535688322):0.3070652861,t104:1.772625167):0.3198553285,((t105:0.3523065427,t106:0.3187800541):0.3027490357,((t107:0.2794561499,t108:0.2479854655):0.1050767129,t109:0.2536876494):0.1755707265):1.43458584):0.8666634314):0.512661024):0.0727125487):0.2131437555,(t110:2.602411253,(((t111:0.5971684847,t112:0.5899671903):0.09534473345,t114:0.5391383739):1.134161613,(t115:1.150916608,(t117:0.2903481149,t118:0.2521580202):0.4171683663):0.4758277036):0.7738220455):0.9092852143):0.7603650821,t119:3.538271233):1.10420669,((t120:1.253753611,t123:1.075422381):3.216411981,(((t124:1.276391726,(t125:0.5845760025,(t126:0.08875782412,t127:0.06786877193):0.1483171077):0.6408398292):1.674527901,((t128:0.4602403084,t129:0.3180307939):0.2681526877,t130:0.397140918):1.703843398):0.4429349336,t131:2.331087818):0.7915865224):0.04746371543):0.745221303):0.2544666974,((t132:3.189250918,t133:2.99290533):0.799038717,((t134:0.2611949506,(t135:0.1119961831,t136:0.0949207525):0.02057301419):3.043736238,(t137:2.174435048,((t138:0.9115116778,t139:0.8540703277):0.3456068607,(t141:0.05367560313,t142:0.03018568876):0.7556468458):0.7307890611):0.9626598076):0.3776918542):0.1058461785):1.414952417,(((((t143:0.5414199845,t144:0.2115397054):1.004021757,(t145:0.6956997876,t146:0.6916152922):0.4579726203):0.2751071333,(t147:1.211786196,((t148:0.4350783369,((t149:0.2151943586,t150:0.02659366895):0.02990790782,t151:0.04431370469):0.1594660048):0.2802946087,t152:0.3490591095):0.3311656604):0.1399292196):1.586229353,t153:2.397891039):0.05424121942,((t154:1.504468031,(t155:1.133606279,t156:1.006814183):0.359734539):0.003732271823,(t157:0.2824135131,t158:0.2818942659):1.056235522):0.817931154):0.8824656425):0.7349377844,(t159:2.114781836,((t160:0.3264205219,t161:0.1820698335):0.5936823418,t162:0.772960845):1.175550671):1.179396699):11.23204045):1.488815371):0.0002231464135):2.179546361,((((((((t163:1.047060893,t164:1.043175767):1.275732825,t165:2.289936091):0.7619275449,((t166:0.9543543266,((t167:0.1727441774,t168:0.1601199411):0.02444106035,t169:0.04431216451):0.7152075973):1.557687571,(t170:1.493492659,(((t172:0.1967081467,t173:0.1909395789):0.4956245729,t174:0.6683863399):0.02515669273,t175:0.6158266839):0.3804961073):0.609539172):0.5354008207):0.7749237273,(t176:1.119178984,t177:1.092002519):1.757488344):4.714157649,(((t178:2.339323966,(((t179:0.3733218551,t180:0.1590519949):0.5898994886,(t181:0.1958128425,t182:0.1290147157):0.3627653022):0.3373528167,t183:0.5730975216):0.9952897766):0.7199221764,((((((t184:0.3332561829,t185:0.3067129238):0.07469043862,t186:0.3525871812):0.08304229439,t187:0.3586261134):0.3641668481,(t188:0.1719350007,t189:0.01879648333):0.5279990272):0.3678924738,(t190:0.1557361337,t191:0.1266461832):0.7422638447):0.3491599838,t192:1.136580016):0.5745505807):3.254031678,((t193:0.4063074776,t194:0.3955842942):2.731016366,t195:3.019915845):1.635142283):0.839985454):0.7338877694,(t196:0.6192678215,t197:0.6120180992):5.601787272):0.6751017654,t198:6.827000585):4.593809224,(t199:3.405317851,(t200:0.5072222489,t201:0.3941518447):2.809298309):8.003606785):3.43943766):1.919282233,((((t202:8.043106905,(((t203:0.2799033009,t204:0.1762799898):0.08868043714,t205:0.1794026705):6.515188415,(t206:6.2598236,(t207:3.366607564,((t208:3.134834559,(t209:2.717343114,t210:2.593567186):0.4031290157):0.03673726237,t211:2.869480088):0.1464760322):2.877651567):0.00698442666):1.02443484):1.158840565,t212:8.051529239):1.189600791,(((t213:3.018983235,((t214:0.5581562254,t215:0.4950292767):1.283080433,t216:1.592779709):1.027053394):1.857316073,((t217:2.466227463,t218:2.034408583):1.865568251,t219:3.730775944):0.09781068113):0.2942600417,t220:3.975027118):4.028286592):1.210199643,(((t221:0.6773362241,t222:0.6559903568):1.789124853,t223:2.393783225):1.891182648,t224:4.249631774):4.754358401):4.918304401):2.105666516):2.074626383,(((((t225:1.823647193,t226:1.801468189):0.7532834984,(t227:1.881336249,t228:1.794070982):0.634297545):10.140641,(t229:2.700882487,t230:2.688016893):9.848047988):0.9190719744,((((t231:5.912530938,t232:5.870917043):3.659550487,(t233:0.2335450456,t234:0.186322091):9.061181154):1.405769876,((t235:8.453235334,(((t236:2.809269856,t237:2.76540168):1.505793177,t238:4.086737501):0.8349828066,(((t239:0.3223668237,t240:0.2584164913):1.823654688,t241:1.954710699):1.710359764,(t242:3.238275941,(t243:1.120854076,t244:0.9173608231):2.114568702):0.4151124814):1.040242234):3.185437501):0.09235666535,((t245:2.259759794,(t246:1.409469486,(t247:1.323383308,t248:1.303495036):0.05742661709):0.7570209984):1.47165521,(t249:2.814559934,((t250:2.216987873,t251:2.191984388):0.3030700777,t252:2.420832643):0.005193540157):0.6609004135):3.86697492):1.923754061):1.994129075,t253:10.61552108):0.3444474948):1.570711075,(t254:3.036054374,((t255:0.06179353677,t256:0.03352453874):0.4448062822,t257:0.4588257411):2.357368724):9.387296254):2.64612755):1.052232921):0.1241770708):2.575108079):9.537508371,((((((((t258:1.778243714,t259:1.74967699):3.642541266,(t260:2.364541614,((t261:1.07501992,t262:0.7361670816):0.2334651339,(t263:0.349322334,t264:0.2551618657):0.6136674109):1.052727866):2.911027516):5.546117039,((((t265:1.980193522,(t266:1.206489325,t267:1.122686894):0.6250835384):2.619523608,((t268:1.358777306,t269:1.286391387):2.314871776,((t270:0.8889182641,t271:0.7849509779):1.381641192,(t272:0.1462032942,t273:0.1087731606):1.918440877):1.115562231):0.4994089635):0.8869012148,t274:4.403532047):0.5602408395,(t275:3.748248059,t276:3.745931207):1.172909212):4.276669113):2.6972225,(((t277:0.3516150388,t278:0.2933422985):2.910082679,t279:3.112196592):1.717467039,t280:4.823629009):6.896968721):4.22610162,((((t281:6.227268387,(((t282:0.8011675168,(t283:0.1230670536,t284:0.06346467333):0.5716637995):0.5940829288,t285:1.220728029):1.663019755,t286:2.867894094):3.131118595):5.904441796,((t287:4.463322402,((t288:1.438435881,t289:1.338273908):0.6456074089,(t290:0.6111679242,t291:0.6061293885):1.326698249):2.185992443):5.15398484,(t292:4.862451573,(t293:0.7215854509,t294:0.6520170958):4.090136994):4.34922558):2.205013148):0.403695741,(t295:2.731902657,t296:2.495543446):8.897548039):3.122699591,(((t297:3.54743718,t298:3.211671435):2.154507456,t299:5.139355685):0.3504640197,t300:5.301214189):8.403282081):0.1292925045):1.597437797,((((t301:0.3021506631,t302:0.2330469597):2.769710502,(t303:0.4489766793,(t304:0.05404875682,t305:0.04118538995):0.3491116844):2.550419229):3.755165403,(t306:1.831950426,t308:1.27039185):4.763173673):4.059098325,(t309:7.6362676,(t310:6.325520324,t311:6.067665239):0.9354067726):2.437668246):4.445883762):2.343937544,(((t312:4.726507948,t313:4.633230866):5.203752991,(((t316:1.227215243,t317:1.177297906):0.2015260733,t318:1.257718096):7.78394899,(t319:5.553728142,((t320:3.291336475,((t321:2.044609404,t322:1.910291879):0.3909669722,t323:2.059589051):0.6983423402):2.031935873,((((t324:1.596132379,(t325:0.2760904928,t326:0.2466681258):1.256334306):0.02422388725,t327:1.494509896):2.941926533,((t328:0.4615630728,t329:0.2720615674):2.796302815,t330:2.773258257):1.14602342):0.1312827598,t331:3.923833704):0.0480244758):0.1695388098):3.104552134):0.04166940762):4.644366732,((((t332:0.6063044248,t333:0.5402377769):6.105169551,t334:6.611243534):2.325067329,(t335:8.248785199,(((t336:3.839314831,t337:3.618040152):2.595306388,t338:5.979194999):1.266540765,(t339:0.440028684,t340:0.2983072221):6.596734011):0.5274398321):0.6044546913):0.238410621,(((t341:2.407798663,(t342:0.9270332851,t343:0.889014881):1.443616761):2.184181662,t344:4.491088178):1.031357483,(t345:0.6077312993,(t346:0.2971466651,t347:0.2043786516):0.2733103704):4.911600354):2.597215716):2.471748135):1.527803936):2.2546902,(((((t348:3.623327463,t349:3.619772439):4.030127738,(t350:4.731419773,(t351:3.108759587,t352:3.042581993):1.358123637):2.865364801):0.9374752986,((t353:0.8993641484,(t354:0.2999896716,t355:0.2357966114):0.527158558):2.397603432,t356:3.05292963):4.815491012):2.29961007,((((t357:2.182285441,(t358:1.341863054,t359:1.333078785):0.7936019973):2.222584003,(t360:0.893941624,t361:0.7319459467):3.256077375):2.862924657,((t362:1.443383527,(t363:0.373241836,(t364:0.2025104227,t365:0.1092257911):0.1497193958):1.025799074):3.44027098,(t366:1.560075798,(t367:0.4904390085,t368:0.3985877917):0.9258859466):3.15535854):1.843601811):0.6680004515,((t369:2.392156269,(t370:1.729631592,t371:1.716767566):0.6551837137):0.4984317167,t372:2.814179664):3.809416067):2.158431841):1.910993277,(((((t373:1.55895943,(t374:1.326595753,t375:1.323338061):0.2266566284):3.840832469,t376:5.196501907):3.538364905,(t377:3.166383457,(t378:2.273195302,t380:2.091811167):0.8608500987):5.42854892):1.130990984,(t381:6.04572412,t382:6.03112557):3.035228944):0.2190876044,(((((t383:4.201315604,t384:4.108385792):0.6862122396,((t385:2.232998337,t386:2.121707003):1.11891891,(t387:1.850092628,(t388:0.9366093163,t389:0.8205257595):0.8082403112):1.366829584):1.38073085):0.6782219097,(t390:2.266774958,t391:2.226412959):2.786996872):0.7600356326,(t392:0.3203136814,t393:0.01883280976):5.341482808):0.4226073993,t394:5.742795725):2.312462416):0.3584926591):1.384987698):3.833947093):0.4998172,(((t395:1.073142404,t396:0.9719757286):1.505863153,(t397:1.778993805,t398:1.738294105):0.6891792856):5.049969006,((t399:3.332202691,(t400:1.093391119,t401:1.080405725):1.977756226):1.793583613,(((t402:0.4676689804,t403:0.3527365779):0.6598751934,(t404:0.5156537562,t405:0.4589838099):0.4595279709):2.574223251,t406:3.491771826):1.05232385):2.249442607):6.501991631):3.972651184,(((((t407:1.409605737,t408:1.378640675):1.731113368,(((t409:0.5501710185,t410:0.5457900138):0.7631184532,(t411:0.6454772334,t412:0.5725942598):0.4841431858):0.2967781421,t413:1.265814119):1.485346407):0.6195502897,t414:3.305516368):0.9165776179,t417:3.906437578):8.811225131,((t418:5.901214824,t419:5.834838822):1.782742494,(t420:3.774253934,(t421:2.861297575,t422:2.831194708):0.7872739946):3.688823127):4.885849262):3.695623776):5.548525558):0.6475122155,((t423:4.395944317,(t424:0.1967173887,t425:0.1836354437):4.188583067):1.817926571,(((t426:3.367589981,(t427:1.163199371,t428:1.071249245):1.991018936):1.544079383,(t429:2.385462249,t430:2.385064373):2.211326607):1.164829695,(t431:0.3347530137,t432:0.3024555948):5.412434007):0.0424924261):15.86269706):8.47908932):61.36172388):44.16189032):37.5977227,((t433:8.401632102,(t434:8.25997049,(t435:1.659683709,t436:1.569979421):6.533978454):0.1247422749):41.36327311,(((t437:3.330616397,t438:3.295561621):1.407238532,(t439:2.825592702,(t440:1.585503351,((t441:0.6167061969,t442:0.611628067):0.7138093402,t443:1.303940845):0.2537806693):0.9139256297):1.484841696):4.606146946,t444:8.552138688):40.22365288):123.4253233);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T60.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
