<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t463:0.4412212811,t464:0.3620412412):22.53440386,((t465:2.547356251,(t466:2.152995474,t467:2.150481421):0.3147585268):4.528977899,((t468:2.151820602,t469:2.102603378):0.002685148458,t470:2.080300332):4.784268317):15.57132433):6.572934169,((((t471:5.18186999,(((t444:0.007025432142,(t443:0.01755130538,((t411:0.1293516799,(t385:0.2506384532,((((t303:0.0460432609,(t291:0.03190537706,(t290:0.02326648068,((t284:0.2319782282,(t282:0.03333338425,((t217:0.06835397046,((t199:0.04136187081,((((t184:0.06141386472,((t170:0.2302457247,((t166:0.03676767274,(t161:0.07933785162,((t151:0.07447063943,(((((t97:0.08909470173,(((t1:7.315251953,t2:6.852248681):0.1223109105,((t3:3.00459474,t4:2.966298836):2.123019583,t5:5.085482887):1.77664914):1.378248618,(((t6:2.022101916,(t7:0.6322303713,t8:0.6315902053):1.372099759):3.252676206,(t9:0.7126850153,t10:0.5775082165):4.538843251):0.7898317277,((t11:2.348378685,t12:2.282278502):1.651287183,t13:3.839543234):1.90135169):2.058137058):1.112989488):0.8954284364,(((((t14:4.231496456,(t15:4.061709629,(t16:2.944231769,t17:2.858516564):1.109697394):0.1261496545):4.594395624,(((t18:2.585831543,t19:2.493703651):3.395258282,t20:5.824902925):0.4907300729,(t21:4.473842662,t22:4.186372555):1.77281428):2.13146027):0.1910042283,((t23:2.033340023,t24:1.83552277):3.964673507,(t25:2.584469284,t26:2.500092266):2.994739327):2.281353743):0.06114768123,(t27:4.594652046,(t28:3.582788688,t29:3.395228614):0.9698555751):3.000300315):0.1621883145,((t30:5.911146027,(t31:3.899183517,(t32:0.4970873232,t33:0.4180995795):2.857288653):1.95369818):0.7207769676,(t34:3.783448512,t35:3.719710232):2.089653691):0.6776037185):0.5037121984):0.6371695306,((t36:6.534164868,(t37:4.020719947,t38:3.951904443):2.483616469):0.9935220757,((t39:3.24444991,((t40:3.001831796,(t41:1.919300198,t42:1.846334429):1.009041567):0.09000954787,((t43:0.8304339955,t44:0.6775142286):0.417067472,t45:1.000360611):1.425646467):0.07511750467):3.78182743,((((t46:2.61301873,((t47:0.8518843024,t48:0.7274171358):1.612464952,(t49:0.7326839913,t50:0.6871534201):1.60078021):0.08194087561):1.062931672,t51:3.407343653):0.8213439926,t52:4.172012682):1.574505199,t53:5.744790199):0.09390033251):0.3381496092):0.092565062):1.14821867,((((t54:4.60695009,(((t55:0.3911872299,t56:0.3847314206):1.032999432,t57:1.370027466):0.6899483506,t58:2.027574553):2.398599254):0.23299016,t59:4.642418233):2.308324844,(t60:6.392423805,((((((t61:1.659955797,t62:1.538977163):1.698087745,t63:3.219162483):1.824851848,t64:4.938734089):0.1240750118,((((t65:0.1859919178,t66:0.154183948):3.888673186,((t67:3.095839449,(t68:1.743431825,t69:1.495183652):1.336536153):0.511460281,(t70:3.291385164,t71:3.245886731):0.01180045873):0.4243571397):0.5870754064,t72:4.241770362):0.3570482124,((((t73:2.355029383,t74:2.337483998):1.627286048,(t75:2.94957156,((t76:1.451016404,(t77:0.6876014795,t78:0.6450157946):0.5331753985):1.326115439,t79:2.493760699):0.1441655044):0.6522719777):0.01625259073,(t80:2.494279308,t81:2.463562913):0.7946735765):0.1856710209,t82:3.082947604):0.3753092065):0.03555947204):0.3205890415,(t83:2.808294944,(((t84:0.9999169578,t85:0.69512777):1.176135243,(t86:1.596040193,t87:1.538494761):0.2397304478):0.183674406,t88:1.646574528):0.1394353925):0.8205712222):0.01585310617,t89:2.576417427):0.6243811257):0.5348876758):0.1162484675,((t90:0.7000036973,(t91:0.5047495189,t92:0.497084966):0.1938302174):0.8616105851,t93:1.393734868):2.264480453):0.02363708588):1.073042007,((((t94:0.6377706788,t95:0.1744222436):0.5832104592,t96:0.7118128177):0.4626449672,t98:0.4641642633):0.1954942038,(t99:0.5138024734,t100:0.3747433359):0.0782816579):2.838562908):1.42187187):0.5481861731,((((((((t101:1.517030863,(t102:1.202256987,t103:1.048398855):0.1586390993):0.3709012112,t104:1.561955577):0.585944173,t105:2.099737539):0.462510772,t106:2.44081455):0.3024214936,((t107:0.5226394181,t108:0.3699799898):1.21722586,((t109:0.1283519116,t110:0.1221664498):0.7569852824,((t111:0.1432074754,t112:0.1339589007):0.4441976739,(t113:0.3024160719,t114:0.2318120428):0.1131097136):0.1553012348):0.6915133437):0.7677492217):0.1434210788,t115:2.034406055):0.2554061948,t116:2.261125608):1.430738846,((((t117:0.803527648,t118:0.7639736244):0.06995969962,t119:0.7004671901):0.3124133257,t120:0.8872484146):1.359504126,(t121:2.211143238,(t122:0.5621966108,(t123:0.3396387013,t124:0.3130110163):0.1710297808):1.450295184):0.02859598517):1.057549511):0.1405445175):0.1720631248):0.3149722139):0.2272293859,((t125:0.9781464723,(t126:0.685091754,(t127:0.4395608789,t128:0.4224711273):0.03845211597):0.2659654746):1.575510752,(((t129:1.168175819,(t130:1.070801647,(t131:0.8794145722,t132:0.8648373227):0.1759876862):0.01124353263):0.7022321668,t133:1.46460278):0.1743146746,(t134:0.7480960642,(t135:0.3769844436,t136:0.2869208274):0.2118654157):0.635763744):0.2278117969):1.312529164):0.5800791207):0.04455650193,((((t137:0.221836677,t138:0.02801853997):1.184455051,t139:1.071161623):0.4596993859,((t140:0.2348599711,t141:0.2207372554):0.3817598037,(t142:0.4711441898,t143:0.4434790976):0.105660947):0.893439704):0.0129629941,t144:1.325599184):1.138049498):1.01838732):0.6922232987,((((t145:0.7137920367,t146:0.5116440691):0.507109213,t147:1.010211831):0.3420754725,t148:1.142726905):1.226204498,t149:2.341731833):1.38013057):0.01470839432,((((t150:0.5192652815,t152:0.3841041019):0.606144903,(t153:0.3023331238,t154:0.2698145493):0.6046924237):1.229741926,t155:1.913535021):0.7464413637,(t156:2.3212328,(t157:1.624367193,(t158:0.8605215978,(t159:0.4053410072,t160:0.3874215595):0.4434694634):0.723534911):0.645994107):0.3130862031):0.6134318551):0.1805740437,((t162:0.8662165371,(t163:0.681750839,t164:0.6599395567):0.0775310892):1.560537895,((t165:1.313454559,t167:1.131809102):0.575837526,(t168:0.7325958152,t169:0.4720815941):0.833583331):0.3013041204):0.6219808169):0.8154538286):0.0115164804,(t171:0.2655999871,(t172:0.2129989488,t173:0.003614631283):0.004146319638):2.44099786):2.150892145):0.5428543611,((t174:0.7705765422,t175:0.5324702137):1.269003863,((t176:0.1002891572,t177:0.05810537663):1.627017535,(((t178:0.6284619174,(t179:0.3022156022,t180:0.2926465803):0.2801293242):0.1838914801,(t181:0.4174465255,t182:0.4147752307):0.1005677959):0.77305942,t183:1.25504406):0.07995588926):0.03972685573):3.09542873):5.644806521):0.2713459926):0.1572142578,((t185:3.291421041,((t186:0.6644099533,t187:0.6505330295):1.019743244,t188:1.575400116):1.519965746):2.878484477,t189:5.900372632):4.223432335):0.3378249198):0.06463090689):1.537436909):2.546163281,(((t190:0.633007667,(t191:0.323290203,t192:0.3013084305):0.005042009664):0.9044765421,(t193:0.03118821822,t194:0.002048510892):1.140816474):3.466404534,(t195:0.7064774072,t196:0.5119371128):3.570898012):9.532827072):2.124766323,(((t197:3.846576912,t198:3.77560613):5.940608124,t200:9.548957444):2.533565801,(t201:10.89344184,(((t202:5.281382012,t203:5.189059323):2.149357615,(t204:6.523781504,(t205:5.546297117,((t206:1.18757826,t207:1.03883519):1.235852849,t208:2.267005295):2.999593283):0.8217640874):0.788260907):1.894263743,(t209:4.665779747,((t210:1.957029902,t211:1.833352394):1.118682684,t212:2.84055719):1.162173753):4.090680272):1.557428478):1.169754716):3.220547935):2.757966396,((((t213:7.003673178,t214:6.415227342):4.248906223,t215:10.62307695):2.880340342,((((t216:2.481995877,t218:2.258070121):1.633767629,(t219:1.69668015,(t220:1.098814182,t221:0.9637307026):0.5493479797):2.148276972):3.051238872,((t222:5.559811422,(t223:1.537566762,(t224:0.8299039976,t225:0.7648549188):0.5443976239):3.874698613):0.9293606477,((t226:3.984483451,((t227:1.953289737,t228:1.827218813):1.794355067,(t229:1.596279927,t230:1.580966095):1.951143525):0.1701660202):1.505678221,(t231:4.502819255,t232:4.502636399):0.6842520087):0.4592063582):0.04571698785):5.418654617,((((((t233:1.026050348,t234:0.9865168815):0.4543828316,t235:1.419101371):0.1523841934,t236:1.458597596):0.03285287857,t237:1.450530075):2.623410605,(t238:1.235638781,t239:1.196014057):2.828965027):3.136440016,t240:6.999755876):3.57368376):0.90722101):1.049993322,((((((t241:0.3627016979,t242:0.0207382312):1.08211401,t243:1.024008268):0.4871176764,t244:1.424826736):4.190475805,((t245:4.166418499,((t246:3.593496027,t247:3.416542821):0.009074228037,(t248:2.46496477,(t249:0.1508936185,t250:0.1215087572):2.2215012):0.8526057121):0.5258975564):0.3020940076,t251:3.65282856):0.945505756):0.04810658056,(((t252:0.6809127316,(t253:0.223744117,t254:0.1445291818):0.3933991359):0.7700074849,t255:1.281099219):1.092260114,(t256:1.73826912,(t257:1.573807617,t258:1.535272484):0.01396861756):0.4603126949):1.978928055):4.815186214,t259:8.579795338):1.395642323):1.58868941):1.068370857):2.932957843):1.004830222,((((t260:1.50802642,(t261:0.2001666269,t262:0.1755261268):1.257242936):2.363060218,(((t263:0.05815524344,t264:0.002309796095):0.4884756852,t265:0.4236572687):1.264721427,t266:1.514298339):1.969454243):1.406429828,t267:4.848440032):7.994986991,((((t268:5.142135772,(t269:1.244387398,t270:1.124188048):3.864082536):4.460345516,((t271:8.550622703,(t272:6.387061726,t273:6.315612987):2.154790451):0.2633951987,((t274:0.9558312092,(t275:0.6210667914,t276:0.4052703631):0.2363575273):4.245647129,t277:4.880665274):3.454904308):0.5153950628):2.882373001,((t278:3.884212499,(t279:2.649125853,t280:2.555790912):1.136212608):7.070924634,((((t281:2.838703802,t283:2.79515745):2.339905287,((((t285:1.327688457,t286:1.231899782):0.1650265727,(t287:0.2527294493,t288:0.2042895177):1.025627072):0.7659754645,t289:1.911286516):1.044202005,(t292:0.7864265596,t293:0.7261097245):1.679965494):1.509416275):0.4178512655,(t294:0.9353851415,t295:0.9233536315):3.283908924):3.781510813,((((t296:2.379706891,t297:2.370554718):2.090745836,t298:4.200922181):0.5007230516,(t299:0.2525322918,t300:0.1559914608):4.201086086):2.635656014,(((t301:0.9748433624,t302:0.9131712308):3.422036087,t304:4.006101281):1.451349726,((t305:0.2656153967,t306:0.2040142142):2.018590524,t307:2.189935282):3.109423282):1.089850332):0.2560177631):1.331315141):0.657736518):0.1424460498,(((t308:1.510086328,t309:1.449786128):0.1322788754,t310:1.480187863):0.02255227267,t311:1.450382736):7.10742426):0.1453973385):3.187857052):1.565899729):0.008845350865):2.185065999,(((((t312:8.415482407,(t313:4.204711439,((t314:0.3486805958,t315:0.2624884526):3.439862048,((t316:1.090513945,t317:0.9778775544):0.07405201685,t318:0.9799751202):2.225354035):0.3317839078):4.206404516):0.6239727721,(t319:1.086632796,t320:0.9321516321):7.245810584):1.117842956,t321:9.206979452):1.843452635,(((t322:6.928187791,t323:6.806163446):0.3685264364,t324:7.064989742):1.656215892,t325:8.560670838):1.876437439):1.016545782,(((t326:2.226029033,(t327:1.890595779,t328:1.755608321):0.1451908551):7.622742706,((t329:6.257821169,(t330:3.609495801,(t331:0.1713597264,t332:0.1566380794):3.434092871):2.432403349):2.126394275,((t333:0.4237270881,t334:0.325197556):6.169091363,((t335:1.373140039,t336:1.210433989):3.073716892,t337:4.253233574):2.009294972):1.49919161):1.112830616):0.6496067811,(((t338:0.4174598566,(t339:0.2652860276,t340:0.2526400873):0.0855632185):0.1828139747,t341:0.3762511933):5.319849413,((t342:4.495342802,(t343:2.137993905,(t344:0.05527462739,t345:0.02062650605):1.995923418):2.274309917):0.04892073318,((t346:0.157860704,t347:0.1303844598):2.817773491,t348:2.751807083):1.352252953):1.083288793):3.591042987):0.8854795567):2.536887348):2.012592147,(((t349:0.7759511388,t350:0.7598606712):8.420058939,(t351:3.648600948,t352:3.516772662):5.525995864):3.590387652,(((t353:5.357558685,((t354:4.142154012,t355:4.088434241):0.3356414864,(t356:3.205348485,t357:3.092425332):0.4833738721):0.7551991928):4.108335434,(((t358:3.753901389,(t359:1.726519338,t360:1.548398461):1.768811363):1.596056381,t361:4.858826929):0.8390588841,((t362:0.4257849304,(t363:0.265701411,t364:0.03194142149):0.1111151866):0.7979993721,t365:0.8862671723):4.465735946):2.242266743):1.801058262,(((t366:2.443365933,t367:2.335864404):1.569363879,(t368:2.216165024,(t369:0.2317596671,t370:0.2207419259):1.963262473):1.604978667):3.337489802,(t371:2.643947113,t372:2.621635645):4.431913471):2.033045676):1.153616532):1.08605039):4.422379381):1.867676529,(((((t373:3.489978674,((t374:0.2765214971,t375:0.1198232054):0.6917838831,t376:0.6873281483):2.352673619):1.07338006,(t377:1.123433673,t378:1.007503861):2.872119989):0.6798648007,(t379:1.564653196,t380:1.557037447):2.989294891):4.294860609,(t381:4.573598667,t382:4.45244209):4.046400438):2.612355665,((t383:1.029008977,t384:1.004238103):5.294718865,((t386:1.824299776,t387:1.824095272):3.957217726,t388:5.522248283):0.01029647105):4.668064285):5.340693851):8.972212234,(((((t389:2.626776536,t390:2.568669933):1.566012921,(((t391:3.158923934,(t392:2.24792931,t393:2.189236388):0.8830466682):0.4588787736,t394:3.319520589):0.1616415895,t395:3.132034091):0.08546176787):0.4944586046,((t396:2.229694446,t397:2.162707793):1.452218506,t398:3.471168118):0.01107200867):3.401131656,(((t399:0.10962277,t400:0.06521014544):2.461721761,t401:2.489258277):0.7704822672,(t402:0.6521024409,t403:0.5534958405):2.455403525):3.398604256):1.337743711,t404:7.741276475):15.04304876):4.673625606,((((t405:3.655422578,(t406:1.53374681,t407:1.417571635):1.978927445):3.932764562,((t408:0.3997568903,t409:0.3310476244):1.946885068,t410:2.173984542):4.969371076):1.429061745,(t412:4.427677844,t413:4.421677408):3.887024403):11.64619623,((((((t414:6.725895272,(t415:5.800569917,t416:5.750169542):0.5795237499):0.8600617984,t417:7.147294468):3.061808229,(((t418:6.111656552,((t419:0.7356170708,t420:0.7150507274):2.516878735,t421:3.21472683):2.833363182):0.7304517757,((t422:2.908744003,(t423:2.206945637,t424:2.200776866):0.6859646697):1.451145718,(t425:4.30511976,(t426:2.972299762,t427:2.877241301):1.315506363):0.03043555149):2.311445571):1.189333946,(t428:1.474087926,t429:1.366316785):6.123413284):2.051816404):3.307294537,(((t430:1.12678863,(t431:0.4577114934,t432:0.3794463303):0.602789561):1.224389464,(t433:0.09223457018,t434:0.06468230683):2.109018642):5.57252829,t435:7.647809039):4.832966095):0.5687819705,(t436:4.274731241,(((t437:3.301785925,((t438:1.371115247,(t439:0.7006688677,t440:0.6983045782):0.5894917558):1.325328678,t441:2.164608829):0.4688370465):0.5052743238,t442:3.088628657):0.1005812553,((t445:1.862635517,t446:1.780250368):0.05715092387,t447:1.741071031):0.899213889):0.3208751171):8.692873357):2.28613098,(t448:8.239560708,(t449:0.4287843177,t450:0.4228815384):7.794202243):5.663031053):3.067201215):6.67678024):8.266250658):197.1689836,(((t451:4.249215573,(t452:2.464291409,t453:2.135331192):1.312331293):1.055240872,(t454:0.5817225109,t455:0.5100224898):3.779173023):77.16943907,(((t456:1.299318197,t457:1.146088644):1.13423718,t458:1.850190236):20.21880155,(((t459:1.320756608,t460:1.266493804):1.14464459,t461:2.409483832):0.7089927245,t462:3.068254587):18.79150718):58.34566188):146.5141366);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T30.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
