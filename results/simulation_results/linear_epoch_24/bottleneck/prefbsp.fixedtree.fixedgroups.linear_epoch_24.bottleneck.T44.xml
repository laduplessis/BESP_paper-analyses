<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(t456:116.7777486,((((t457:1.97226577,(t458:0.7111074256,t459:0.7062830964):1.24838185):9.268909056,((t460:1.407735106,t461:1.099611796):0.9426968712,t462:1.984228092):8.73731847):33.12207707,((((t463:2.396070704,(t464:1.957510435,t465:1.949804808):0.4296044002):14.8233752,(((t466:1.14633218,t467:1.125701288):3.331835553,((t468:2.09985075,(t469:0.6660421068,t470:0.07204152515):1.391593148):0.1006280705,t471:1.443064957):2.068810557):9.579959515,t472:13.08859285):2.960549303):12.81999693,((((t473:2.784964641,((((t424:0.00175958014,(t412:0.01881871069,(t382:0.1212617855,(((((((t256:0.0292066012,((((t170:0.08311900996,(t169:0.0682797861,(((((((t144:0.01670437742,(t142:0.03532931078,((((((((t91:0.07476716617,(((t32:0.1286913353,t1:3.407785191):3.553286887,(t2:4.192391626,t3:3.969179806):2.721593365):3.235642971,(((t4:3.705382891,(t5:3.186633218,t6:2.993053412):0.3706571449):4.338521483,(((t7:2.221238639,((t8:1.342656181,t9:1.25419932):0.3902941405,t10:1.594413212):0.1610040424):1.033825974,t11:2.699606631):0.2572066392,t12:2.950106227):4.07202435):1.680926963,(t13:0.475051903,t14:0.4080090805):8.223098317):0.1338570826):0.5126179482):0.182490514,(((((((t15:5.58170223,(t16:4.707265216,t17:4.646000278):0.6522017676):2.749957134,(t18:2.526929456,t19:2.296200838):5.434170428):0.0210851518,t20:7.736562725):0.05184800572,(((t21:5.043801421,(t22:0.1831174488,t23:0.1729129231):4.694049421):0.003797968752,(t24:4.686136786,((t25:3.353729353,t26:3.315693425):0.790713733,t27:4.034089141):0.5328189939):0.1155836095):2.43391647,t28:6.787237778):0.1833978888):0.01198935975,(t29:1.251939885,t30:1.230781891):5.541846709):0.09984399905,((t31:2.061969706,t33:1.90407973):4.486519528,t34:6.350639716):0.2700170702):0.4509452995,(t35:4.593390788,t36:4.337375614):2.394675212):0.3612917539):0.234486307,((t37:6.011968361,(t38:4.278350564,t39:4.128675219):1.690513591):0.1433586141,t40:5.934137014):1.063040857):0.4777706076,((t41:4.637169997,(t42:0.3869656246,t43:0.2841952868):3.95210216):0.3028598766,(t44:0.1551064919,t45:0.08311283827):3.7876589):2.494855247):0.3301482089,((t46:1.003415056,t47:0.5025094866):2.063794284,t48:2.555596987):3.576825362):2.036347542,(((t49:3.73218329,(t50:3.114014373,t51:3.089028241):0.4676405771):0.5777275553,t52:3.983745004):2.062757199,((((t53:3.366605548,t54:3.175667994):0.1603383615,(t55:0.9737930027,t56:0.9227818665):2.344694763):0.5012069437,t57:3.736098903):0.02909737106,(t58:3.084570504,t59:3.064535193):0.6111401174):1.982991632):1.503920706):0.8066890936,(((((((t60:0.3172363308,t61:0.01385105488):0.373559188,t62:0.2985918446):2.012016093,(t63:0.3144571434,t64:0.2579322245):1.827559753):0.4984311734,t65:2.525272082):1.099269425,(t66:2.285226432,t67:2.186616646):1.178016502):0.3255516952,((t68:2.651307601,(((t69:1.980112171,t70:1.9525518):0.1618638418,t71:2.082397866):0.1780853121,(t72:0.9560809481,t73:0.9555752665):1.262080908):0.2989878548):0.2766641113,(((t74:0.4537041616,t75:0.1902660807):1.329893704,t76:1.175373136):0.01134329367,((t77:0.4812738914,t78:0.1415163283):0.5775042152,(t79:0.1018608714,t80:0.09795444954):0.3343211707):0.09541748457):0.8531399231):0.7558830716):2.090465857,(((((t81:0.7036322783,(t82:0.4600159389,t83:0.4184337834):0.156260261):0.9203329524,((t84:0.5918830119,t85:0.582467051):0.8411980447,t86:1.116874003):0.0263108819):0.3445662484,t87:1.117918254):0.1468962129,(t88:1.051327216,((t89:0.2871877597,t90:0.2698441719):0.6344336737,t92:0.2633049273):0.1286908704):0.131236694):0.4334083783,(t93:0.6619806779,t94:0.6616041493):0.247927767):1.569968065):1.216950277):0.1056979161,((((t95:1.120691506,(t96:0.7642682739,t97:0.7578665455):0.1403930642):0.1748983375,t98:1.05983018):1.356861345,((t99:0.1242725629,t100:0.1191363235):1.42742837,t101:1.44794454):0.7300892344):0.8712357393,(t102:2.994528807,t103:2.982704827):0.03905741842):0.277009637):0.8996340112):0.2644092968):0.05240738519,(((t104:2.94556291,(t105:1.287830963,t106:1.10623313):1.172817941):0.7060988478,((((t107:0.4778221957,(t108:0.1102243981,t109:0.003777910308):0.3349791613):0.3979837784,t110:0.6718148008):0.1571850599,(t111:0.56721604,t112:0.3577100373):0.0755319889):1.256124877,(t113:1.417445978,t114:1.160433483):0.2050650558):0.3532049529):0.3772993146,((t115:0.9067122067,(t116:0.2584910501,t117:0.2558114977):0.6388296136):0.148133139,t118:0.8098535854):0.8750321832):0.3382903483):1.994241654,((t119:2.259919515,(t120:1.731288977,((t121:0.2454378478,t122:0.09501560674):0.4604528618,t123:0.352306244):1.01608029):0.494749606):1.492180533,(((t124:1.833377552,((t125:0.6079618317,(t126:0.06445055557,t127:0.03189235189):0.4160174266):0.7492482914,(t128:0.08991586076,t129:0.08930845311):1.098357014):0.3709682215):0.3152351125,(t130:0.2578896747,t131:0.2230742008):1.412557168):1.090036171,(t132:0.4309515499,(t133:0.2104949675,t134:0.1791210672):0.1115018859):2.242107589):0.07119033735):0.2470364626):0.09520664333,(t135:2.002669198,t136:1.997525752):0.7609743524):0.4491268603,((t137:0.03584780926,t138:0.002859531067):2.213417755,t139:2.1099087):0.8918383879):0.2724408498,(((t140:1.723911541,(t141:0.5248346329,t143:0.3767661066):1.15627526):0.461179952,t145:1.420311044):0.4028483639,((t146:0.9913447635,(t147:0.5119922538,t148:0.3211326017):0.1903567865):0.237352338,t149:0.5720306653):0.1826110402):0.6708200899):0.2311154655,(t150:1.509692938,(t151:1.112086223,((t152:0.244854341,t153:0.202820107):0.1357561388,t154:0.3021097176):0.7076162041):0.376100779):0.1363561408):0.3424652674):0.1555519437):2.674039059,t155:4.512823298):3.071690222,(((t156:0.302252372,t157:0.2487371132):0.5541916217,t158:0.6973034557):0.6571982997,t159:1.327337399):5.828325742):1.203393052,(t160:6.55971621,(t161:0.1051414384,t162:0.09179875845):6.454065007):1.724051903):0.9925134693):0.4791838068,((t163:6.7098345,(((t164:2.417940732,(t165:0.6005005276,t166:0.5794556326):1.644169702):2.843230714,(t167:2.470638074,t168:2.081263562):2.592269519):0.3075048403,((t171:2.172963474,t172:2.130413664):1.915097271,(t173:0.2291682354,t174:0.1753706485):3.550866228):0.3694307442):0.8107768302):0.7775823561,((((t175:2.12357515,t176:1.792043005):0.3001939183,t177:2.073356687):0.477511673,t178:2.463344908):1.206816863,t179:3.61062569):1.522834703):2.093331382):0.5225243584,((t180:2.76169527,t181:2.724368614):3.590439222,(t182:3.591515068,t183:3.479753111):2.714410271):1.279713918):0.3544462283,((t184:2.520909433,(t185:0.9746900525,t186:0.9615510742):1.470914685):1.083505968,(t187:2.168091981,t188:2.161330359):1.322457358):4.150435824):0.9390529671,t189:8.554375589):4.904471647,(t190:0.2611012391,t191:0.260566496):13.01979622):0.06986557811,((((t192:4.947368866,t193:4.83946582):6.147750182,((((t194:1.829000329,t195:1.479092881):1.825088953,t196:3.299576471):5.003441346,((t197:0.6538624811,t198:0.4839025788):0.3174380217,t199:0.4524266413):7.284540375):0.5071704703,((t200:4.780761019,(t201:3.019801758,t202:2.995975238):1.710748552):1.291888212,t203:5.97292463):2.078123537):1.812341624):1.071527305,(((t204:4.615490567,t205:4.575882307):0.6285520464,(((t206:2.584112118,(t207:2.023763875,t208:1.992132153):0.4528498723):2.262274294,t209:4.676695033):0.2498728221,(t210:1.17813296,t211:1.119758687):3.712226169):0.04101863261):0.3760985329,(t212:4.17209101,t213:4.102098445):0.9980800105):5.314260728):0.3239470004,t214:10.72807723):0.7360325566):4.041896775):2.337504611):1.249117113):2.48792683,(((((((t215:0.7899007139,t216:0.6553652177):3.962165818,(t217:4.225263058,(t218:1.276813736,(t219:0.91719925,t220:0.7545551273):0.1761059135):2.719459659):0.3696627082):2.17645853,(t221:1.07605714,t222:1.029899334):5.048916108):5.823217771,(t223:0.1849643722,t224:0.1022228448):11.5706011):1.232129418,(((t225:2.031578964,(t226:0.9268675935,t227:0.8266189829):1.072144883):0.2052240797,t228:2.098081749):3.543184925,(((t229:1.027637418,t230:1.005329811):3.225884916,t231:4.166834994):0.269254787,((t232:2.795880404,t233:2.757109513):0.8012764566,t234:3.50453679):0.4857212823):1.115202106):7.100810114):1.863479102,((((((((t235:0.8499109242,t236:0.8491730611):4.243793545,(t237:4.453152157,((t238:2.716833101,((t239:0.6242259949,(t240:0.5547934513,t241:0.5098626766):0.04288793031):0.07201818188,t242:0.5299689936):1.954367393):0.4866208366,((t243:1.677119103,t244:1.671817955):0.2360048838,t245:1.773153137):0.8917352354):0.8246502661):0.5352876668):1.275008568,((t246:1.969621461,(t247:1.581845877,t248:1.424250578):0.1150596893):2.17159378,(t249:3.428040347,(t250:1.820534715,t251:1.749466116):1.50119204):0.2338031308):1.066030172):3.983811666,((t252:0.4403500335,(t253:0.3129146315,t254:0.2718367196):0.06181417171):3.163248474,t255:3.285923944):4.755054412):0.659668483,((t257:1.785300918,t258:1.684895243):1.555906219,t259:2.875340987):5.305252335):0.7680965739,((t260:1.903761492,t261:1.856245479):2.209405081,((t262:1.704039353,t263:1.674099285):2.141134326,(t264:2.808424544,t265:2.797702171):0.9843631347):0.04015903328):4.77148662):0.4909328326,t266:8.960347624):1.706874984,(((t267:0.3315653216,t268:0.3086995294):7.075097683,(t269:6.209927065,t270:6.001519849):0.9193945403):2.774733037,t271:9.637860712):0.4417922939):0.05510870795):4.883833956,(((t272:3.694880937,(t273:2.046065352,t274:2.043677138):1.638094462):5.1395968,(t275:1.507558266,t276:1.422631983):7.196236351):2.733093841,(t277:10.04891714,(t278:7.999215561,(t279:7.941551468,((t280:0.6928629307,t281:0.5874245651):7.004393371,((t282:1.10233426,(t283:0.5545662448,t284:0.5465283526):0.5227785346):3.605789617,(t285:1.552768641,(t286:0.6643477229,t287:0.508646807):0.8458222199):2.952473965):2.860398398):0.2029084652):0.03052664346):1.94471466):1.296423376):3.29433751):0.8214336381):2.392157285,t288:16.952314):1.506304103,((((((((t289:0.07433552566,t290:0.07002060666):2.982526824,((t291:0.6062895159,t292:0.5830539909):0.9460287895,t293:1.502602022):1.232270234):1.590027627,t294:4.146457224):1.838941285,t295:5.734845596):5.431745692,((((((t296:0.3422801005,t297:0.1239859763):3.441414504,t298:3.463373343):3.903489355,(((t299:1.647118129,(t300:1.054103244,(t301:0.5567341012,t302:0.506266327):0.3448916259):0.5572294594):4.551872164,(t303:0.8537490129,t304:0.7082025831):5.083355545):0.2443062316,(((t305:1.167663176,t306:0.9076098599):1.710918649,t307:2.586791517):2.926619967,(t308:3.884039603,(t309:3.342210693,t310:2.978630919):0.5209943319):1.546376001):0.2292284123):0.7846161658):0.5772340523,((t311:0.2777957993,t312:0.09782790978):2.41744148,(t313:1.019483822,t314:0.9820426562):1.428041229):3.764552072):0.2596179868,(t315:1.64941044,t316:1.541303216):4.602294765):1.035374588,(t317:3.785993272,(t318:3.283599478,t319:3.043778628):0.4153915469):3.368727354):1.551434091):0.563934904,t320:8.794260599):3.276769728,(((t321:0.1531687261,t322:0.1392417022):0.879080647,t323:0.7886245806):3.859592402,(t324:3.591678875,(t325:2.731493702,(t326:1.78420044,t327:1.783338281):0.9021940727):0.7064657756):0.984819275):7.168007383):1.455036818,(((t328:1.583419219,t329:1.551078248):1.539501915,(t330:2.702728962,(t331:2.600943643,t332:2.507068972):0.003967410366):0.2818581153):5.226034599,(((t333:1.75484336,t334:1.707149811):3.880768706,((t335:0.2938563863,t336:0.1368048058):3.371678005,((t337:1.642940383,t338:1.582673706):1.12741891,(t339:1.866424457,t340:1.829663974):0.6582182704):0.714827446):1.706969386):0.7400200734,(((t341:1.343727776,t342:1.256671935):1.349286138,t343:2.595954559):1.262872725,t344:3.815108481):1.652186946):1.588809153):4.581101532):1.046271992):1.633282852):3.621292656,((t345:9.855353699,(t346:6.64927643,((t347:2.599041134,t348:2.574127619):0.1570205165,(t349:2.079406691,((t350:0.6978477712,t351:0.6901711209):1.055361944,t352:1.695919389):0.2933499894):0.5329520791):3.788404931):2.962808504):1.247759272,((t353:7.78960709,t354:7.768304405):2.194971169,(((t355:1.276634212,t356:1.151293181):1.011422583,(t357:0.4847424129,t358:0.3397408115):1.65380322):4.113722462,(t359:3.749570844,t360:3.741650779):2.327498355):3.55923645):0.4992075857):6.808848198):8.318526782,((((t361:1.440148546,t362:1.321548491):6.981624546,((t363:2.326474973,((t364:0.1617193867,t365:0.08776072949):1.257527012,t366:1.160393735):0.8887504985):5.379017066,t367:7.309272235):0.5195798454):1.183849046,((t368:3.260463289,(t369:1.950142589,t370:1.947384308):1.261067238):0.7202082915,t371:3.809698644):5.031814729):3.258586456,(t372:0.1919088235,t373:0.1243782646):11.90045599):12.2996458):7.082337049,((((t374:1.452248703,t375:1.433002539):2.763965825,t376:4.173402422):2.945202517,(((t377:0.3835019825,(t378:0.3281720016,t379:0.1482169633):0.03200082633):2.625641986,((t380:1.188677976,t381:1.141237165):0.6563448138,t383:1.556029246):0.9221920611):3.867689887,(((t384:3.642617263,(t385:0.4455193144,t386:0.3334436294):3.088553992):0.9980472673,(t387:1.735927885,((t388:1.548497648,t389:1.287907905):0.04914284293,(t390:0.7719874866,(t391:0.2588788645,t392:0.2349573268):0.5094252861):0.5033424512):0.0998241248):2.659541807):1.44773545,((t393:1.792529727,t394:1.75534117):1.273452266,(t395:2.374783535,t396:2.348349994):0.6496665222):2.273140239):0.2240913474):0.2280940371):22.80714518,((t397:1.126427795,t398:1.053666138):3.716619892,(t399:1.585453044,t400:1.40810932):3.13583322):23.6550151):1.224305396):6.97479302):12.84829018,((((t401:2.01050233,t402:1.846634511):4.714723389,(t403:5.612495134,t404:5.569745957):0.8109175753):4.10139366,(t405:10.01864254,((t406:2.199771185,((t407:0.9883441631,t408:0.9513700501):0.7533915538,t409:1.561178305):0.1998310769):0.20388901,(t410:0.5824371041,(t411:0.3801909782,t413:0.1654509515):0.1934782938):1.190839573):7.594186565):0.4552521362):21.64748164,(((t414:1.690897462,t415:1.543708095):15.04306915,(((t416:0.3377431023,t417:0.1829736626):7.237569042,((t418:1.114078389,t419:1.092726715):6.171353002,t420:6.947218203):0.1079841115):7.613055067,((t421:0.8451018039,(t422:0.4625957297,t423:0.300916168):0.2317632947):8.638344994,(((t425:1.692474314,(t426:0.6601594834,t427:0.503202521):0.9830706012):2.500411872,t428:3.905419195):4.24901532,t429:8.144993356):0.6102651229):5.176286061):1.344952814):10.48969646,(t430:10.82059861,((((t431:0.7869705111,t432:0.6730850046):0.5789909783,(t433:0.5197656123,t434:0.5135048862):0.524381571):2.902738634,(t435:3.509336833,t436:3.38778268):0.3474951756):3.537784475,t437:7.028276467):2.922189082):14.94313956):3.989581226):16.71030535):0.8948167449):6.971577095,(((t438:1.179618446,t439:1.103922086):15.16006968,((t440:0.3427139919,t441:0.3280326438):8.363559608,(((t442:0.6788385479,t443:0.6618442034):3.254425521,t444:3.789166523):1.122970742,(t445:2.350227212,(t446:1.522131601,(t447:1.286400422,t448:1.246371534):0.1027157338):0.7840798193):2.228643628):3.571108703):7.526348453):1.371524765,((((t449:1.301269569,t450:0.9008709798):0.4944458703,t451:1.385583886):2.790015204,(t452:0.8704306072,t453:0.8085209847):3.156865556):1.38427417,(t454:0.5880457609,t455:0.5292863375):4.760599209):10.85335849):35.51240017):65.26573021);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T44.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
