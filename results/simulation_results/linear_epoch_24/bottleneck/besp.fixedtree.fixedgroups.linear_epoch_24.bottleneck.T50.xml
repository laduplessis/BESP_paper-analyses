<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t431:17.1945019,((t432:7.220057231,(t433:5.224695325,(t434:4.936889518,(t435:4.016796652,t436:3.786864669):0.8601537215):0.2255749249):1.653312285):6.149451464,((t437:0.8775175848,t438:0.8603619352):9.55936427,((t439:0.09309798226,t440:0.07209433642):5.243425837,((t441:0.08661432193,t442:0.05896423991):4.717008936,((t443:2.417752702,t444:2.412068704):1.801825385,t445:4.114318121):0.503584178):0.5041905392):5.064942449):2.194146204):3.718191706):1.917831484,(t446:1.174164754,t447:1.056281769):16.83367828):3.716238984,(((t448:6.180865217,t449:6.064782833):10.15227556,(((t450:0.3257401396,t451:0.2885037825):2.565131253,((t452:0.6903576432,t453:0.6870224294):1.177099353,t454:1.818064318):0.8756755136):5.384429629,t455:8.058917115):7.767786977):3.964279894,(((t456:1.331756174,t457:1.296430727):1.173632622,t458:2.395733901):6.477026645,((t459:1.694974144,t460:1.477716505):1.053833473,t461:2.290231871):6.099447522):10.77926905):1.12935823):5.651430682,((((((t462:0.9445048433,t463:0.9153557724):3.02377976,t464:3.938027173):1.164068625,(t466:2.015735339,t467:1.929790259):2.834742889):1.209639235,((t468:1.517270175,(t469:0.06910449498,t470:0.06365336662):1.436284811):0.1464864469,t471:1.568028955):4.287226816):0.9449366268,((t472:0.4968623726,t473:0.3903664064):3.829330408,(t474:1.789713772,(t475:0.1718672739,t476:0.03749919421):1.568111235):2.429788677):2.433533895):0.2750445174,((t477:0.4545256896,t478:0.4420451764):1.278807526,t479:1.463074992):4.907381157):18.31678381):53.76926667,((((t480:9.008774438,t481:8.965870564):6.479124324,(t482:1.063644416,(t483:0.3731712573,t484:0.3291252353):0.5982322291):13.81097963):28.233436,(((((t485:1.911670898,t486:1.725653784):4.603638065,(t487:1.062239205,t488:1.052572698):5.251927128):10.64060564,(((t489:4.758440109,(t490:4.255993377,((t491:0.04660745844,(t465:0.1814760897,(((((((t291:0.2316397806,t292:0.1869807844):0.05021457205,(((t255:0.02419286353,((t253:0.3801764044,(((t172:0.02476452966,((t149:0.003554127473,(t139:0.01000629133,((((t94:0.06308652797,((t91:0.02802928205,((t82:0.04327662456,(t1:5.15625111,t2:4.96090641):3.823320667):0.3001657758,((t3:7.061318646,(t4:2.283542269,t5:2.252069797):4.742421039):1.578533122,((((t6:1.085249371,t7:0.9784645587):2.71772821,t8:3.431320482):0.2634227763,t9:3.654873093):1.461264316,(t10:3.418481492,t11:3.416029745):1.467490365):2.921050252):0.3250115645):1.247229482):0.386118705,((((t12:2.816860602,t13:2.762470262):0.9543414427,t14:3.543749052):5.467077892,((t15:4.599483269,t16:4.011565516):3.653020732,t17:7.653668583):0.7542102631):0.2643787152,(t18:3.984698845,t19:3.971694479):4.656000951):0.2189509838):0.04062836909):1.074581384,(t20:9.734775684,(((t21:0.4852418332,t22:0.05424831072):0.7037493281,t23:0.5520321757):6.624136439,(((t24:4.221747031,t25:4.094492463):2.844348422,(t26:2.97338266,t27:2.970146219):3.879280167):0.03057948573,((t28:1.599199133,t29:1.550293102):2.786115413,(t30:3.061889345,t31:2.886679273):1.144105234):2.463752826):0.04412412488):1.758408784):0.1581281288):1.501841319,((((t32:6.214078414,t33:6.142297825):0.2966757917,t34:6.417486808):0.2423008019,((((t35:1.320061195,t36:1.306738555):1.37591511,((t37:1.139956445,t38:0.9154696674):0.5004044431,t39:1.402870193):0.8607209466):0.1205577836,t40:2.314470028):2.016413444,(t41:2.358749997,(t42:1.361933273,t43:1.275922275):0.9841042925):1.961364595):1.614431943):2.412225241,((t44:4.657147978,t45:4.620820983):0.5510973356,t46:5.083469335):3.032316988):0.4858958784):0.7832258626,((((((((t47:2.380341487,t48:2.305043421):1.709572351,(t49:2.986049525,t50:2.9083458):0.9198680258):0.4151004876,(t51:0.3353559818,(t52:0.1947317669,t53:0.02683921487):0.007687433166):3.88421877):1.033169874,(t54:1.461537003,t55:1.456564935):3.488673152):1.39993109,(((((t56:1.834078638,t57:1.568095341):1.696482029,(t58:1.842456033,t59:1.670800779):0.759162826):0.003905975777,(t60:0.6884215293,t61:0.2688781373):1.562276279):1.530383194,((((t62:2.071365839,(t63:1.484917455,t64:1.220434503):0.5715574291):0.9019849638,(t65:1.809751631,t66:1.573921299):0.8762460891):0.02701286551,(t67:0.8240840179,(t68:0.6200709913,t69:0.491089551):0.1459303315):1.625453195):0.1996170832,t70:2.359838816):0.1512983008):0.9053928324,((t71:1.780499626,t72:1.765774255):0.05461788566,t73:1.673813319):1.536479125):0.2930203964):0.8722213645,(((t74:1.594420094,t75:1.52888924):0.3494791929,t76:1.797205666):1.736295797,(((t77:2.695942969,(t78:0.81041397,t79:0.7944160722):1.792975011):0.3987050057,(((t80:1.380854545,t81:1.322362519):0.8604014268,(t83:1.257939685,((t84:0.911747226,((t85:0.560532084,t86:0.558804353):0.1659986988,t87:0.6436084075):0.09007824034):0.08752448893,t88:0.5298104466):0.01544819397):0.7220520548):0.7216389924,t89:1.496788639):0.007201347363):0.02063782239,t90:1.474791645):0.3634882328):0.6364764146):0.8248953461,(((t92:0.5044451685,(t93:0.3549711189,t95:0.05889487143):0.1228041669):1.007946318,(t96:0.5647990336,(t97:0.1574337821,t98:0.07026019537):0.2937899676):0.5989257784):0.6428601835,((t99:0.1129710635,t100:0.04031124783):0.6013664838,(t101:0.5537987826,t102:0.5167869254):0.05372635145):0.6933248554):0.5874038551):0.3294816891,(t103:0.7425658347,t104:0.7150534273):1.405947744):0.3855388816):0.329823366):1.187400994):2.158995133,(((((t105:0.07128073933,t106:0.04646315431):0.5360471574,t107:0.3039265001):1.745094736,(t108:0.367454395,t109:0.2535001149):1.664841137):2.056936311,t110:3.888280345):1.480009081,((((t111:1.293684423,t112:1.252187374):1.869928163,(t113:1.075768627,t114:0.970679179):1.902839655):1.123857091,(((((t115:0.05735873709,t116:0.02603240309):0.9845012697,(t117:0.7456691572,t118:0.6968292026):0.1919811317):0.9013295984,(t119:1.442267123,t120:1.275090429):0.2447456409):0.2864821673,(((t121:0.7753718598,((t122:0.245515971,t123:0.2145874076):0.4000990614,(t124:0.2024191461,t125:0.1951572864):0.3892127167):0.05310591175):0.1672373847,t126:0.745466773):0.57821803,(t127:0.2328850104,t128:0.1833135629):1.079842893):0.2455657578):0.08212419389,(t129:1.074282364,(t130:0.5342159997,t131:0.5111618041):0.4265731454):0.3199970099):1.639897071):0.6023243536,(t132:0.8982511942,((t133:0.2123835481,t134:0.1836176909):0.4113869127,t135:0.3095116274):0.2130572361):2.519159585):0.4321740676):0.2157757417):0.3162982346):0.1214147866,(((((t136:0.4344519317,t137:0.4009789024):1.445238087,(t138:1.377960505,t140:1.124579692):0.3601661516):0.2909604349,(t141:1.629673042,((t142:0.3522320609,t143:0.2243841091):0.1597837924,t144:0.3812713411):1.048355892):0.1355096307):0.3163978939,t145:1.85118208):1.337413206,t146:3.109839772):0.25280478):0.005829822936,(t147:0.30796608,t148:0.1911798315):3.013922216):7.256440252):0.3298871276,((t150:0.5959922477,(t151:0.1052253601,t152:0.06077242369):0.4043931594):3.756415014,((t153:2.862418021,((t154:0.1063047979,t155:0.06760251807):2.17081156,(t156:1.021261947,(t157:0.4631340946,t158:0.4126391266):0.5280788777):1.051859282):0.5399962404):0.2481502963,t159:2.518632253):0.6961841807):5.794227704):0.01187533364):1.480497734,((((t160:0.6169453975,t161:0.5748717617):0.0752865519,t162:0.5321798027):0.327403023,((t163:0.1994499939,t164:0.148055868):0.5746109673,t165:0.4895039461):0.01648009959):9.196736612,(((t166:1.717668922,t167:1.57001677):0.2362344211,(((t168:0.6698520931,t169:0.6656947827):0.3019324598,t170:0.6699813105):0.268286796,t171:0.9298413406):0.5655655172):6.882673958,(((t173:0.7653433875,t174:0.7622200282):0.1537810552,(((t175:0.5041753215,t176:0.3635581096):0.1406106875,t177:0.4464027591):0.1525581824,t178:0.5983228449):0.10389015):1.022520524,(((t179:0.04261533182,t180:0.03302405553):0.1342157253,t181:0.1431258557):0.6523460073,(t182:0.4239100146,t183:0.3139969509):0.2410050209):0.7424508606):6.28854689):0.80185957):0.1528070373):1.112708164,(t184:0.09146282246,t185:0.08938884532):9.483335084):1.024677858):6.33257827,(((t186:0.735596338,t187:0.7322414431):14.21853611,(((t188:4.948624233,(t189:0.2142437026,t190:0.2104916283):4.658707342):1.23626968,t191:6.0242727):3.576076836,((t192:0.2969106657,t193:0.2830349503):8.39624858,(t194:7.347428122,t195:7.152843171):1.04739868):0.8411970302):5.185389952):0.7517693541,((t196:2.675721924,t197:2.499517893):4.530098439,t198:6.770162469):7.750915664):1.157380775):1.858147764,t199:17.51080392):1.470480322,(((((t200:0.8442562614,t201:0.7711016378):5.30552948,t202:5.937450015):0.00859020326,t203:5.926428493):0.4146870447,(t204:2.767168575,t205:2.643971973):3.46952575):11.90465255,(((((t206:4.574538417,t207:4.568694634):4.430171772,((t208:1.926732589,t209:1.650822309):2.449455557,t210:4.045276857):4.595280355):1.498745029,(((t211:1.032410136,t212:1.018296016):1.577218904,t213:2.587299553):2.810953099,(t214:2.513916484,(t215:0.1301890565,t216:0.10838289):2.296287581):2.719012074):4.504237421):3.260550944,((t217:2.1342912,t218:2.126758353):0.2652121375,((t219:1.17643057,(t220:0.9321040397,t221:0.6495008741):0.2158180704):0.018743811,t222:0.8372354429):1.135194885):10.21337929):1.163546749,(((t223:2.548064505,t224:2.489748952):9.846026634,(((t225:4.223895843,(t226:1.397798373,t227:1.237534702):2.811950939):6.235520871,((t228:8.880697448,t229:8.815470551):1.03289306,((((t230:0.2338805775,t231:0.01896722464):2.224992263,t232:2.215052357):5.736510167,(((t233:1.505340886,t234:1.417883663):3.919785288,(t235:1.69933707,t236:1.405175145):3.49401736):0.5440811233,t237:5.428599215):1.808970161):1.282426121,t238:8.475955786):0.2699299408):0.3634724249):0.7626052439,((t239:6.516567862,(t240:5.608871347,((t241:0.45859907,t242:0.3277159528):1.972090931,(t243:0.7900885367,t244:0.5862576315):1.356961323):3.133894683):0.8273528769):3.344821458,(t245:6.392641626,((t246:2.302961771,(t247:1.002409206,t248:0.977496707):1.141679846):0.1252707336,(t249:2.10646113,(t250:0.324997751,t251:0.29358018):1.763414241):0.1233018682):3.926888938):2.799467699):0.001279622239):0.9502849317):0.173577009,((t252:2.012999889,(t254:0.2769225227,t256:0.1405909183):0.9354024152):0.7695938453,t257:1.802451322):7.191732562):0.7047289083):3.042369155):0.4272799008):1.569186901,((t258:13.07806407,((((t259:4.519018946,((t260:0.9819234203,t261:0.905199373):1.371640536,t262:2.014158523):2.10563431):1.433568278,t263:5.450789205):1.815883244,(t264:3.801050148,(t265:0.6437348482,t266:0.4596786849):3.144541879):3.276998717):1.109374316,(((t267:1.792467617,t268:1.649477055):2.604530196,(t269:4.0981888,(t270:2.626890944,t271:2.587249149):1.434336303):0.1377393487):2.478435403,(((t272:3.794511276,(t273:3.497555966,((t274:0.07238778951,t275:0.06921295416):2.812882809,(t276:1.639337091,t277:1.565024927):0.9202019099):0.6085336895):0.2700406661):1.521466006,(t278:2.091059711,((t279:1.020178684,(t280:0.671161787,t281:0.6350763923):0.1293932206):0.1589471011,t282:0.9061723392):0.8552475515):2.766119445):0.05061548601,((t283:3.182964639,(t284:2.79594226,t285:2.622419018):0.2198245592):0.125974941,t286:2.948656082):1.158202032):1.202616132):1.067524652):4.127826885):1.523719189,((t287:6.929762359,(t288:6.029828342,(((t289:0.7509545409,t290:0.5815014634):0.2855440699,t293:0.3866025716):1.472879873,(t294:0.429613675,t295:0.2318300172):1.25340715):3.251418847):0.8932523946):0.2883576684,((((t296:0.2155056076,t297:0.18922597):0.5252392616,t298:0.6757357916):0.881078035,t299:1.544650326):1.915488408,(t300:3.11992456,t301:3.011813852):0.2957394452):2.310385582):4.698853558):0.1334831855):4.358462294,((((t302:0.1356359632,t303:0.09675652537):6.760969097,(((t304:0.04838382406,t305:0.01280874107):2.846448459,t306:2.772834537):3.426809314,((t307:0.7572635906,t308:0.4290622645):2.504174773,t309:2.60861104):2.930407317):0.3809053649):2.424045242,((t310:2.503840819,t311:2.477208131):3.445791665,(((t312:0.728237702,t313:0.5102014271):0.862185529,t314:1.274036628):3.81568017,(t315:1.173693787,t316:1.096086857):3.875551974):0.3455198611):2.359259727):4.263448138,(t317:10.36902791,((t318:1.211175484,t319:1.193201166):6.770685665,t320:7.912810736):2.34140765):1.434194999):1.100583091):0.4899507884):2.136888145):1.480302192,(t321:16.39043506,((((t322:5.676589968,(((t323:2.223775379,t324:2.054074981):1.175832909,t325:3.061331308):1.434510081,t326:4.364942797):0.7708250696):3.644518242,((t327:3.500872798,t328:3.479625036):0.2598267834,(t329:2.050912081,(((t330:0.4111562214,t331:0.2932015733):0.0618194584,t332:0.1860242356):0.04481751707,t333:0.2170324592):1.49635309):1.660692896):4.866832835):1.537302924,t334:9.587638241):2.991931319,((t335:2.189501526,t336:2.079780765):4.597610947,(t337:2.686233285,((t338:0.6464125657,t339:0.6001369388):1.203374732,t340:1.757733228):0.7545281358):3.893643329):5.706828502):2.527938694):0.5041029691):2.64060154):0.4868626564):0.6970871238,(((t341:7.424096209,((t342:2.072506803,(t343:0.4585043806,t344:0.436993374):1.553257174):4.117974792,(t345:2.158043149,t346:1.983107587):3.910080644):0.816637607):1.771050398,((t347:5.185858425,(t348:0.2853693114,t349:0.1552821518):4.884531061):0.7327725243,(t350:1.123835776,t351:1.116732933):4.586391995):2.514715347):2.381050077,(t352:7.632583713,(((((t353:0.6532534812,t354:0.6292108413):2.238225737,((t355:0.6203785087,t356:0.5724848234):1.420995017,t357:1.865478342):0.8105185712):0.3393226021,t358:3.001658829):2.050346298,(t359:4.43763815,t360:4.206183692):0.6053100482):1.783700842,(t361:4.820706922,(t362:1.17700471,t363:1.053909979):3.584529543):1.744281583):0.5040859148):2.895146253):7.377503904):2.633645192,((t364:1.734913042,t365:1.710853277):0.216488338,t366:1.848599106):17.82509393):8.840914963):1.793844592,(((t367:1.061733326,t368:0.7595085971):11.81000269,(((((t369:1.985805457,t370:1.934415166):2.767064489,(t371:4.425008098,t372:4.362693457):0.2014601132):2.152613285,((t373:2.055458942,(t374:1.712502587,t375:1.596422508):0.3317408881):2.342613849,(t376:0.2462902563,t377:0.1351114242):3.943059399):2.151907605):2.938381833,((t378:1.017602155,(t379:0.9713987802,t380:0.812192224):0.04293687436):6.210234526,(t381:1.363107406,t382:1.2191789):5.611714643):1.931325188):0.9943302676,(((t383:1.560503202,t384:1.295832655):4.150705974,(t385:1.708080806,t386:1.373833022):3.732639562):2.148406551,(t387:1.972780474,t388:1.957662142):5.196252997):1.880795106):1.489419736):3.686899933,((t389:7.183601333,((((t390:1.309246231,t391:1.294942309):2.59279632,(t392:0.9699921956,t393:0.8917741663):2.687756014):2.58432508,((t394:2.105403528,t395:2.001251426):0.7852830565,t396:2.69860075):3.072081142):0.2920404406,((t397:2.056163444,((t398:0.1663370933,t399:0.1440154327):1.244837797,t400:1.29071574):0.4061486113):2.997203999,t401:4.556133978):0.8449503931):0.4005343323):5.180950709,((t402:3.642853361,(t403:0.5197005192,t404:0.4571664272):3.110064752):2.920749242,t405:6.286448697):4.40910906):1.797382202):13.70809012):6.351532499,(((t406:5.237262626,((((t407:1.066025423,t408:0.942056196):1.554165858,t409:2.473647239):0.9856126347,((t410:0.1959847632,t411:0.1175854328):0.9420449927,(t412:0.4847610172,t413:0.4402452011):0.5500315498):2.280130506):0.1019845324,(t414:3.364396033,t415:3.319257999):0.001468380533):1.493397812):0.9962791036,(t416:3.155667311,t417:3.144083348):2.424852848):1.783262921,((t418:3.218335323,t419:3.211220496):1.808707456,((t420:2.212790049,t421:2.050111338):2.408067795,((t422:1.431993426,t423:1.42473618):1.955632212,t424:3.363790429):0.9310384736):0.3520697544):2.086097398):24.38457965):17.62271654):23.36258549,((t425:3.03405736,t426:2.937530041):7.020082449,t427:9.451101169):61.97268471):11.35648959):88.89278422,(t428:12.29837863,(t429:3.352232106,t430:3.260682565):8.868978166):159.0832795);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T50.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
