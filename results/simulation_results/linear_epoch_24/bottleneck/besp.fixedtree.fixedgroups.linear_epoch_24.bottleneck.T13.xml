<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t334:4.206719781,(t335:1.850475243,t336:1.665391931):2.297213483):7.264745279,(t337:1.008591141,t338:0.8472687493):10.12258786):0.9804319711,(t339:4.717595018,(t340:3.860849033,(t341:0.9782991883,t342:0.5653032655):2.871204117):0.8371465776):7.230327399):1.112869558,(((((t343:1.749892542,t344:1.73493894):1.44004109,(t345:2.990352174,t346:2.958135287):0.1266535573):2.923347048,((t347:0.419571076,t348:0.3186795431):4.722699141,(t349:0.5381498961,t350:0.5356043032):4.386512194):0.8276526743):0.227384216,(((t351:0.7990551364,t352:0.7415211104):2.450977704,(t353:1.987488106,(t354:0.2945589943,t355:0.2656604437):1.67994727):1.105534573):2.120802183,t356:4.736902364):0.6043910703):3.329611687,((t357:1.068744544,t358:1.025264335):3.85666687,(t359:2.227116142,(t360:1.852580624,(t361:1.374463202,t362:1.115006947):0.169072691):0.2986613798):2.640203436):3.681043146):2.843947346):206.6010815,((((((((t363:5.400330483,(t364:1.696548614,((t365:0.4734933086,t366:0.3551117688):0.8120526482,t367:0.8912828472):0.3580375474):3.66234925):0.8469274326,(((((t368:0.957100767,t369:0.8701463098):0.2305555315,t370:0.8423665546):0.6119278522,t371:1.453378559):0.1977680527,((t372:0.4177373709,t373:0.3922531517):0.8262478612,t374:1.14554494):0.3277737955):2.191719957,t375:3.650643421):1.419511439):0.2511920611,((((t376:1.870622519,(t377:1.136026047,t378:1.069399389):0.7067488274):0.0910433421,(t379:0.8128466266,t380:0.802284895):0.8445373395):0.5272003637,t381:2.116120002):1.749954883,((t383:1.569800788,t384:1.502968225):0.3729906569,t385:1.833544986):1.779737373):1.013413336):1.045484961,(t386:3.528321554,t387:3.522139113):2.082245507):4.297879023,(t388:7.526289231,t389:7.486546999):2.288000111):36.76044407,((((((t390:5.645084503,(((t391:1.258219733,t393:1.164039518):0.6399143913,(t394:0.1441386718,t395:0.08854639473):1.631863072):0.0631338198,t396:1.694983496):3.615668196):0.2411406386,((t397:4.423330636,t398:4.347763468):0.3466941769,t399:4.689012363):0.7713481163):2.153403391,t400:7.405133386):1.654396931,((t401:4.478095202,t402:4.342118517):1.732398859,(t403:2.271214341,t404:2.099018028):3.667515435):2.820201625):4.056122338,((((t405:0.9046733141,(t406:0.1247026586,t407:0.1155645295):0.4216021069):1.440213094,t408:1.738404431):3.425387075,(t409:1.680912252,((t410:0.7330086366,t411:0.6482585761):0.4183755168,t412:0.80996026):0.4529788312):3.368487667):2.523625128,((t413:2.824312581,(t414:1.735100268,t415:1.413424584):1.069042237):2.537533242,(t416:0.4645094159,t418:0.3044487359):4.53582445):1.772515859):4.221928218):4.85626345,((t419:6.006866627,t420:5.914819743):1.730295159,(((t421:1.026406111,t422:0.9436850988):3.519273091,((t423:0.8777902777,(t424:0.1528152232,t425:0.09923384334):0.5248948056):2.067425397,t426:2.623133301):1.170486398):0.6064242481,t427:4.371553895):2.384908709):7.921147163):27.88696311):24.07790962,(((((((((t428:3.35041531,(t429:2.344287521,t430:2.131683784):0.9807557466):2.868169905,((t431:1.081124057,(t432:0.8717898357,t433:0.5955556816):0.07918092944):1.04964014,(t434:1.164428483,(t435:0.6765097212,t436:0.6688060201):0.4221063664):0.537583227):3.737461304):12.47371299,((((t437:0.2839462924,t438:0.06859738136):3.003743466,t439:2.668333921):0.6063697775,(t440:1.313447008,t441:1.155413756):1.936006391):3.351165486,(t442:1.14179763,t443:1.091941616):5.281837961):10.56794367):0.5440743554,(((((t444:0.3013076347,t445:0.2958047085):2.272079062,(t446:2.236364194,t447:2.168832101):0.2162211876):1.47606948,(t448:3.522913887,(t449:2.959070936,t450:2.925903525):0.3763449388):0.3326914745):5.213414333,(t451:0.8005891781,t452:0.6407933495):8.031323685):6.735108734,t454:15.05869854):1.471984502):2.987752451,t455:19.3529697):1.946190494,((t456:1.854541467,t458:1.596240947):0.06201427803,t459:1.613580562):19.25662764):0.4098884047,t460:20.97302892):6.067899063,((((t461:0.6670590646,t462:0.5294529863):7.797513095,t463:8.31498776):3.586724074,((t464:0.8725392125,t465:0.8014895502):3.851937625,t466:4.508462502):7.114230096):4.51576046,((t467:1.71700729,t468:1.670772916):6.268012751,t469:7.887457302):8.147243926):10.43201463):8.918627353,((t470:7.777261362,((t471:5.687010601,((t472:2.904645359,(t473:1.252404512,t476:0.716759112):1.641743919):1.289222079,t477:3.261324161):1.372707947):0.3410878536,t478:4.974664343):1.671641356):7.6832578,t479:14.32588166):19.92270549):26.90382708):142.4811488,((((t480:2.356291669,t481:2.289748908):2.892537293,t482:5.16850728):5.839259896,(t483:6.769844255,(((t474:0.3170934325,(t475:0.2058587305,(t457:0.04611263529,(t453:0.08150547227,(t417:0.09715284876,(t392:0.002803080788,(t382:0.1284529508,(t261:0.05417410156,(t257:0.09084657893,(t256:0.006987650758,(t229:0.01837602577,((t185:0.01189277081,((t154:0.08336718761,(t146:0.02697732552,((t140:0.1050535076,((t123:0.04039602585,((((t1:4.001399429,t2:3.818724419):6.024023015,t3:9.838066942):0.04890075282,(((t4:2.946309781,t5:2.801282386):3.683678078,(t6:4.543339094,(t7:4.188746851,(t8:1.940797362,t9:1.883853473):2.158744057):0.1179317959):1.866896975):2.030846607,((t10:1.95136535,(t11:1.115408929,t12:0.8614210718):0.7805981181):4.504159681,(((t13:3.444524077,(t14:3.321050611,t15:3.224790809):0.03939744908):0.9280368474,(t16:0.1789214437,t17:0.1162983028):3.995505871):0.6714232676,t18:4.539203636):0.9295346644):1.484546956):1.022332869):1.499262538,((t19:7.441852318,t20:7.397789981):0.5320045819,t21:7.845735776):1.492779963):0.2102977642):0.9105317682,t22:10.22994589):0.1932527183):0.3121181775,((((t23:6.946107444,t24:6.787645055):0.5148458168,((t25:2.786126908,(t26:1.635419095,t27:1.629108629):0.9501877235):3.89430865,t28:6.31706763):0.5357136264):0.06253899144,t29:6.833071246):2.516584369,((((t30:2.579024708,(t31:0.9216991657,t32:0.7764669096):1.611715423):3.787884628,((t33:0.3487568439,t34:0.1615542412):4.488626404,((t35:3.678437213,t36:3.646068214):0.7403200486,t37:4.359932407):0.2201203899):1.240526346):0.9280022013,(t38:5.858186637,t39:5.798197548):0.8862130266):0.2842125512,((t40:3.327714575,((t41:1.566695284,t42:1.507531642):0.8648552045,t43:2.351850267):0.8616927868):2.418372487,((t44:0.8803980846,t45:0.8240041702):3.622276596,t46:4.241276817):0.9859660236):1.163758648):1.436254882):0.5623293422):0.3293495371):0.5995708503):1.048637729,(((t47:6.018616038,((((t48:3.45309433,(t49:3.06590924,t50:2.235576316):0.3381145503):1.749526053,((t51:0.5096468637,t52:0.4253519601):0.437806562,t53:0.7248307838):3.373371787):0.4094967072,(t54:3.187528677,t55:3.150884958):1.30796569):0.2567157469,(((t56:2.289004055,t57:2.242082968):0.6933651296,(t58:2.749079696,t59:2.523934053):0.1770559555):0.648714183,t60:3.202378986):0.7813493519):0.09115068175):0.6692232015,((((t61:2.320585398,((t62:2.102075923,t63:2.079533332):0.00491864127,(t64:1.462322315,(t65:0.01705394633,t66:0.01632273331):1.380872799):0.5150580542):0.1333307198):0.8659080933,(((t67:0.6992327132,t68:0.6183327011):0.8587718792,t69:1.436016518):0.2040393879,t70:1.463342997):0.8392584373):0.2686190943,t71:2.47385382):0.02755903737,((t72:2.221090977,t73:2.191331633):0.1915793502,t74:2.306007083):0.04924852655):1.204414702):2.838688618,(((t75:3.772049683,(((t76:2.061574849,((t77:1.635468988,t78:1.621954789):0.4153854742,((t79:0.8429333786,t80:0.7630783985):0.2804782024,t81:1.029254072):0.8583834023):0.005041766612):0.7413326853,((((t82:0.7677943223,t83:0.4531723508):0.2309872419,t84:0.5578988977):1.154270148,(t85:1.567175807,t86:1.513127517):0.09784401541):0.2977940539,t87:1.906082371):0.1760503377):0.8563830688,(((t88:0.02710754314,t89:0.003468098883):1.437664585,(t90:1.396443375,t91:1.367759905):0.01058739557):0.890877715,((t92:0.8928815996,t93:0.6187854673):0.1461983374,t94:0.6879617487):1.026167801):0.5051369718):0.09144428408):0.8693503372,t95:3.02376123):0.6247810234,(((t96:1.35146681,t97:1.027118034):1.225473708,((t98:1.264742007,(t99:0.3852538755,t100:0.3791760522):0.8257195857):0.2593409874,(t101:1.126936795,((t102:0.273213106,t103:0.2464424533):0.5237681127,t104:0.6779731498):0.3077339351):0.2987303493):0.59651609):0.07807971693,t105:1.842045492):0.9837869132):1.111166383):0.806558275):2.191602796):2.073128334,((((((((((((t106:0.02517751911,t107:0.0193663042):0.4025185824,(t108:0.05823880241,t109:0.0418912181):0.08511912933):0.3566353314,t110:0.4277402356):1.510957418,(t111:0.198658757,t112:0.07350142683):1.657676182):0.5868745475,(((t113:0.708154345,t114:0.4783689664):0.9275436839,((((t115:0.5557000972,t116:0.4566238885):0.1917654745,(t117:0.584922292,(t118:0.3310021886,t119:0.2764012826):0.2431716373):0.01109758959):0.2906434177,((t120:0.2871896389,t121:0.1944693757):0.4303803945,t122:0.5529558379):0.08569270536):0.2653070645,t124:0.8445090633):0.08980117187):0.5594986104,((t125:0.7045310535,t126:0.6648597433):0.2406243551,(t127:0.2674288571,(t128:0.04695633271,t129:0.0185679056):0.1074731098):0.5428018632):0.5473427616):0.04648013631):0.2855011882,((t130:0.1075680419,t131:0.09259961731):0.7409446542,(t132:0.2495474752,t133:0.1965094835):0.409382459):0.6104777479):0.7408217722,((t134:0.2138992073,t135:0.1593046481):1.701357095,(((((t136:0.02615997941,t137:0.01510725823):0.5903301512,t138:0.4540999334):0.4656995994,t139:0.9033339197):0.2338342964,(t141:0.2881349606,t142:0.1369432124):0.6238154502):0.1443694827,t143:0.8463526911):0.3271739242):0.01734111368):0.5183651244,t144:1.426237761):0.7183324975,t145:2.126074123):0.018397096,t147:2.001801335):1.722365654,(t148:3.547066676,((((((t149:1.238663333,((t150:0.01946028973,t151:0.01542622968):0.5672997869,(t152:0.2695055185,t153:0.2408561339):0.2791956468):0.5265134879):0.5569370347,t155:1.433005515):0.02603743778,((t156:0.4969232077,(t157:0.1356457986,t158:0.1252926329):0.2141710322):0.497300833,t159:0.827120604):0.3190002295):0.4188270625,((t160:1.371074291,t161:1.224071058):0.06028375073,t162:1.122837644):0.06082517573):0.4049770487,t163:1.541632148):0.695582008,t164:2.209462619):0.07390591409):0.07995737498):0.01167088382,t165:2.165523419):2.089474576):1.995264097):3.635638981):0.1008393383):0.6559568129):11.87118125):0.4533999934):2.749945991):3.696455254):0.8010547121):1.489778694):0.07193857087):1.210006873,(((((((((((t166:1.767066008,t167:1.71762554):0.02510514466,(t168:1.656154399,(t169:0.4640675538,t170:0.3979788318):1.172718004):0.05834544961):0.6596679885,(((t171:0.8676798824,t172:0.738000197):0.5311569726,t173:0.9863708138):0.3595331234,t174:1.160650333):0.4421606375):3.002495577,((t175:0.3334546816,t176:0.2469344959):0.04806334088,t177:0.1420476538):4.192323159):2.824856538,((((t178:0.8557157947,t179:0.6342589307):1.284482941,(t180:1.446120755,(t181:0.3445056664,(t182:0.1051563266,t183:0.08979912889):0.1872755472):0.9174075794):0.40486824):0.2707423406,(t184:0.9984167077,((t186:0.3144693293,t187:0.2789569629):0.4480199543,t188:0.6301516831):0.06376842147):0.6905859732):0.4434188626,t189:1.594919779):4.119193673):3.081513354,(((t190:0.6004039101,(t191:0.1368246683,t192:0.10885819):0.3043621724):0.4595901587,(t193:0.6512243642,t194:0.1434500182):0.06602572622):4.892360514,(t195:0.4794412426,t196:0.4337866751):4.53448948):2.820229072):7.189251328,((((t197:0.09462085342,t198:0.08115219067):3.609956006,t199:3.659019884):5.182290959,((t200:2.806990941,((((t201:0.05653561962,t202:0.02479239631):0.4344852949,t203:0.2240670737):0.2041336063,t204:0.08717603536):0.2839688504,t205:0.2836365082):1.808642279):3.186674721,((t206:1.725389378,t207:1.722104598):0.7875481298,t208:2.249953483):2.601739735):2.828142745):4.829328618,((t209:7.878002883,t210:7.875222796):1.025292091,(t211:1.812186696,t212:1.79715849):6.940916224):3.587480885):1.238942715):4.12873563,(((((((((((t213:0.1234860176,t214:0.08333477312):6.627770932,(t215:5.43451316,(((t216:0.6475409333,t217:0.6010474771):0.4973118113,t218:1.026431947):3.408596068,t219:4.426836724):0.7957850168):1.215180829):0.1606624654,t220:6.541331353):1.16641625,(t221:5.194997046,t222:5.071909768):2.497405539):0.5690621035,((((t223:5.407726082,((((t224:0.3445519255,t225:0.2473897398):0.529607527,t226:0.6086401641):0.2121907839,t227:0.820576499):3.312898841,(t228:2.316637252,(t230:0.08006537062,t231:0.07212975722):1.774497237):1.7226098):0.9639430624):0.8358058588,(t232:1.873834217,t233:1.828427409):3.432574961):0.5538374639,t234:5.798217575):0.6231012118,t235:6.173134187):0.6461034901):1.545721605,(((t236:0.8038148378,t237:0.5106364224):2.027580036,(t238:1.302431274,t239:1.28649439):0.9822440652):1.496567908,((t240:0.9364933262,t241:0.7573003645):0.7275898105,t242:1.011068268):1.674415084):4.004732988):4.374589116,((t243:7.887715284,(t244:6.65596252,(t245:3.863245082,(t246:2.01300085,t247:1.983389137):1.750597865):2.752646617):1.136113081):1.167251672,(t248:4.691111639,(t249:2.557217604,(t250:0.3435147408,t251:0.3340121795):2.029373857):1.952722445):4.059441893):1.916908447):0.06071157682,(t252:9.03439374,((t253:7.033914627,((t254:1.660289806,t255:1.578321156):4.783374033,((t258:3.470145012,t259:3.375025634):1.858552898,(t260:0.584700042,t262:0.2972188672):4.52328759):0.7210653708):0.552626795):1.531946897,((t263:1.076791199,t264:1.030516985):5.410828112,((t265:0.4103427951,t266:0.3003382196):2.729495339,t267:2.993486404):3.278260522):0.9528990123):0.2943318338):1.279410876):1.770616967,((((t268:1.839647547,t269:1.539098708):3.57057049,(t270:4.75364355,(t271:2.491652549,t272:2.392158955):2.20404019):0.3317261384):2.809436042,(t273:6.887972969,t274:6.73012442):0.7218854269):2.044115694,(((t275:4.742353515,(t276:2.794879605,((t277:0.6533826032,t278:0.5529140319):0.798837823,t279:1.312448993):1.289578159):1.894001039):0.1149120312,(t280:1.702787569,((t281:0.2800868127,t282:0.179502708):0.3403243349,t283:0.4418286959):0.9739628847):2.843858045):3.640354857,(((t284:2.216374473,t285:1.887768266):1.005320895,t286:2.865203595):3.571117405,(t287:3.2335122,(t288:1.899028001,(t289:0.6588612721,t290:0.626939416):1.08677509):0.9379543215):3.006646198):0.3968273586):0.9590275745):0.283365559):0.9085659407,(((t291:0.425307317,t292:0.4222309103):0.6631038431,t293:1.053695959):4.598129728,t294:5.648314095):2.461496817):0.09978083506,(t295:6.897977845,(t296:0.856914682,(t297:0.1488049082,t298:0.1385907582):0.5892091157):5.951750794):1.246919684):0.09345654247):2.248400515,(((t299:0.1346568571,t300:0.1144349518):3.804951636,((t301:1.280466682,t302:1.237800671):0.7438831905,t303:1.75447881):1.884960935):0.5968652434,(t304:3.288164155,((t305:0.4604273889,t306:0.4375726664):2.127586528,t307:2.562739454):0.6155646632):0.7043675):5.681377751):2.048999041,t308:11.54645464):2.173414751,((t309:1.618292336,((t310:0.1133941676,t311:0.03998072613):0.5206304877,t312:0.4552749119):0.8875834234):0.4279011654,t313:1.743471976):11.63893336):3.777419693):4.608886118,((t314:11.52968482,((t315:2.865014306,((t316:0.8798086837,(t317:0.4236481489,(t318:0.08183833995,t319:0.07097110517):0.3247615474):0.2230023501):1.746041867,t320:2.287746832):0.08306584379):3.148733061,t321:5.479006973):5.485871958):0.1025809225,t322:11.04893752):10.12682571):1.897339084):3.90870761):16.17963124,((((t323:6.899748464,t324:6.861562888):0.3071784957,t325:6.861908691):7.669909768,(t326:2.024410611,((t327:0.3351494857,t328:0.254895879):1.303454346,(t329:0.9025010375,t330:0.7443425941):0.4914976251):0.3061971392):12.50538288):1.840513831,(t331:3.124133549,(t332:2.104647074,t333:1.940634169):0.986223958):12.74086385):26.3599623):176.3345275):1.991896729);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T13.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
