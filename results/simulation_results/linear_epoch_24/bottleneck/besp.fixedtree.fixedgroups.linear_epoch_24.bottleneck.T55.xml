<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t475:4.111774146,t476:4.076156528):19.17117072,((t477:2.083774159,(t479:0.5334099018,(t478:0.128733983,(t472:0.1061035166,(((((t434:0.02894310075,t435:0.009170279178):0.0929647486,(t418:0.0992724667,((t402:0.241574564,(((t277:0.08280006961,(t275:0.01404898356,((t245:0.02830865656,(t241:0.1453038854,(t235:0.01949121065,((t212:0.06492854691,(t189:0.1181598615,((t153:0.04966300009,(((t112:0.02705511128,((t104:0.1803558806,(t102:0.03541897564,(((t1:8.153141098,((t2:4.476614087,t3:4.442103184):0.08728346798,((t4:1.505883442,t5:1.410372089):2.860852657,t6:4.246001426):0.0960663307):3.505308437):0.1275729739,t7:7.91155002):1.82206793,((t8:4.495310762,t9:4.36720795):0.9846268424,((t10:1.31320189,t11:1.054381002):2.828344048,t12:3.571990235):1.186545924):4.236222945):1.491605355):0.4957440824):0.2752491446,(t13:7.21715076,t14:7.099399702):4.027036377):0.237273174):0.09622658065,((((t15:8.693118878,(t16:2.788058518,t17:2.745258218):5.893274742):0.05220526217,((t18:0.2072523407,t19:0.1798162445):6.940554003,((t20:3.314772904,(t21:0.1766750529,t22:0.1662569996):3.099851569):2.757937206,(t23:4.606473589,t24:4.419280107):0.8708717191):0.9319406144):1.502138284):0.01809075245,((((((t25:0.4330457271,t26:0.3747501423):3.846398923,t27:4.138885976):0.3912456035,(t28:0.4286192655,t29:0.3454237729):4.003080088):0.3854898536,t30:4.727491274):1.419172304,((t31:2.107854235,t32:1.987091594):2.274197318,(t33:2.571534094,t34:2.30336462):1.658191274):1.56352521):1.050267429,((t35:3.231844518,t36:3.228396198):2.823811479,t37:5.734750488):0.4936777859):0.1154084675):1.515903755,(t38:6.978153958,((t39:4.774430161,t40:4.702523497):1.703616438,((t41:2.927913579,t42:2.702299541):2.678400084,((((t43:0.3983430069,t44:0.3982059093):1.18704216,t45:1.547881766):0.6210530225,(t46:1.758078571,(t47:1.382774796,t48:1.326097519):0.3738417471):0.3983639033):2.92548508,t49:4.903671442):0.1044984275):0.2670979625):0.3496650574):0.8626917099):0.9869661361):2.061188142,(t50:8.794686018,((((t51:1.094611926,t52:0.7803541193):3.632493298,((t53:2.479184036,(t54:0.1474830516,t55:0.1168764316):2.279585661):0.7395847908,t56:2.86851413):1.119251331):1.158654128,(((((t57:2.596336576,t58:2.553671377):1.571463466,(t59:3.868858569,t60:3.859194345):0.1962535933):0.002168206102,(t61:1.204239419,t62:1.088641404):2.746422625):0.3037476302,(t63:1.169078074,t64:0.9775874323):2.840735702):0.2637011645,t65:4.052289451):0.3946552582):0.7482414062,(((t66:2.606957787,t67:2.529789681):0.6651379213,t68:2.984109393):0.8779229014,t69:3.84526286):1.031862919):2.108984531):0.7212876858):1.297680204):0.9847968474,((((((((t70:2.744645737,((t71:0.6206231559,t72:0.5120586445):0.9766352017,t73:1.426589563):0.8940416827):3.438935916,((t74:3.138340761,(t75:2.642481428,(t76:1.280467069,t77:1.105694593):1.208996027):0.01235064623):0.3000816142,(t78:1.892271122,(t79:1.340577758,t80:1.292294989):0.3462438795):0.7114361166):2.205915697):0.9265952299,((t81:0.4002191792,t82:0.2723308834):0.7949996572,t83:0.9065022446):4.075475695):0.06799220815,(((t84:1.387812362,((t85:0.2216064625,t86:0.1099559025):0.3434224605,(t87:0.09172477291,t88:0.05259305887):0.3511239429):0.5599890772):0.3474543677,t89:1.289830004):0.1089319885,t90:1.360661777):2.979236011):0.2323148995,((((((((t91:0.2295345616,t92:0.224796995):0.672755599,t93:0.8907134276):1.557109277,(((t94:1.047955874,t95:0.9134524957):0.286491792,(t96:1.058891882,((t97:0.1659402568,t98:0.1263349699):0.3040429745,t99:0.1097541666):0.1630081936):0.09186019745):0.8965930684,t100:1.206327648):0.20162369):0.1895556984,(t101:1.098023781,t103:0.8008859597):0.3242635732):0.3498507219,(t105:0.05993545503,t106:0.0433033214):0.9440177429):0.1255065933,t107:1.079980231):0.05376657567,t108:0.9888986382):1.090536943,((t109:0.05650864779,t110:0.005433803006):1.634985596,(t111:1.217985675,t113:1.075839575):0.4006211676):0.3655881789):0.12596197):0.622009143,((t114:0.6357545199,t115:0.603499377):1.890210324,t116:2.445800002):0.009593304257):0.9510307351,((((t117:0.573496114,t118:0.3616392781):0.2478242287,(t119:0.3286894319,t120:0.1557894127):0.2422492488):1.357625059,(t121:1.289906335,((t122:0.1687684348,t123:0.1522301217):0.3860741635,t124:0.4726743359):0.4636449049):0.4363571009):0.5330997271,t125:1.418702292):0.6932429661):0.6934851319,(t126:2.583023045,(t127:1.58913048,(t128:0.7377669774,t129:0.6558998404):0.8452401683):0.9398571594):0.2154525084):0.1402666443):2.594045828):1.997924114):0.0724110932,(((((t130:1.183200534,(t131:0.1428221926,t132:0.08897988735):0.8664150432):0.8852393703,((t133:0.1542101557,t134:0.1302266069):0.5401536503,t135:0.6655919092):1.069207881):0.6927050953,(((t136:0.610538463,t137:0.465074011):0.4523952943,t138:0.6765034318):1.036974806,(t139:0.1699132353,t140:0.07490488528):1.507807506):0.3034714876):0.1159849345,((((t141:0.4402360892,t142:0.4133204081):0.6230121771,(((t143:0.5153628256,(t144:0.1919520418,t145:0.1801804076):0.1405377075):0.2406839737,t146:0.4468467425):0.04039721881,t147:0.3685613933):0.1996790404):0.2376224126,t148:0.7857404696):0.3154109949,(t149:0.05649359901,t150:0.01778077292):0.9269511904):0.3623439619):0.06934721964,(t151:0.9765412133,t152:0.8724840336):0.3534950541):4.476040118):2.255631063):0.7104976945):0.3560381509):0.8523237874,((t154:3.168391873,(t155:2.949576815,((t156:0.2438348409,t157:0.2111195934):0.09756322723,t158:0.2710909894):2.586813819):0.1683898921):2.461296339,(((t159:0.1721213325,t160:0.09680565452):1.90194179,(t161:0.9532530843,((t162:0.07104052557,t163:0.01148018613):0.3464127386,t164:0.2346286101):0.4440464314):0.9590801605):1.273669041,(t165:2.600644507,((t166:1.387250264,t167:1.209787962):0.9711252361,(t168:1.078241741,(t169:0.2765927064,t170:0.2744957539):0.7549494274):0.9676216334):0.06304294204):0.07849340098):2.126873626):4.166577163):2.445186802):0.1746951901):5.17926426,((((t171:0.601174354,t172:0.5760978678):0.4125273421,t173:0.9837205239):0.4485197394,(((t174:0.1340022883,t175:0.1230412791):0.140207591,t176:0.2548166895):0.8469624763,t177:0.873505205):0.07144668056):13.8824005,((t178:1.353183283,((t179:0.5741732673,(t180:0.3687776671,t181:0.3537859138):0.1986292898):0.7028415538,(t182:1.137243512,t183:1.049820286):0.04911233473):0.05938826016):9.581448908,((t184:6.015518637,t185:5.90670237):1.68206211,((((t186:0.3588499861,t187:0.2657065393):0.08376659592,t188:0.3023167696):2.71980586,(t190:0.576076484,t191:0.52747313):2.247396148):3.03264335,(t192:1.469134176,t193:1.457018509):4.320907319):1.287862353):2.665095488):3.823267038):0.3799115897):4.200838416,((t194:13.15710849,(t195:10.85710346,(((t196:1.658100502,(t197:1.025263603,t198:0.8827144184):0.5763950037):1.966306904,t199:3.424398536):3.056365175,((t200:2.917265155,t201:2.737499907):1.28962826,t202:3.875123394):2.196042733):4.146296066):2.299789086):3.525568055,(((t203:9.152915899,(t204:1.349458686,t205:1.257820311):7.764998):3.33727515,(t206:0.9590405654,t207:0.9525141316):11.26270883):2.370009634,(t208:3.420690774,t209:3.390207494):10.99898378):1.122628615):1.366937976):2.520236457):0.0458464219,((t210:6.488556341,t211:6.272984382):8.924223298,(t213:13.33880478,((((t214:5.401335269,(t215:2.799446746,(t216:1.683020831,t217:1.657969956):1.116039053):2.476087555):6.149259787,(((((t218:0.5981923666,t219:0.5498846856):0.985084979,((t220:1.001740189,t221:0.9297563809):0.4611689753,t222:1.384431757):0.03303125625):3.338889442,(t223:4.140548684,(t224:2.983580062,(t225:0.832688184,(t226:0.364724404,t227:0.3222202186):0.4336133359):1.890015184):1.107252291):0.5048181322):2.582028003,t228:6.769687941):0.2832455123,(t229:6.289268334,((t230:0.1875032372,t231:0.137335882):3.342223564,(((t232:2.679855572,t233:2.526612044):0.2997902174,(t234:2.185413069,t236:2.079398809):0.5694208383):0.257808653,t237:2.652069938):0.03671273871):2.629540757):0.5273385695):3.167583759):0.00397199244,(((t238:0.7143515784,t239:0.6914752184):0.3327243929,t240:0.9819877951):4.034290173,t242:4.63872181):3.855580901):0.8485806986,t243:9.25465052):0.8980932691):1.637458507):3.803934827):1.056500202):1.72266408):0.8602301116,(t244:3.149635286,t246:3.024171112):15.95034751):0.4554366126,(((((t247:1.742673832,t248:1.668458399):2.67010322,(t249:1.178602306,(t250:0.2170562774,t251:0.2134931458):0.8402684973):2.95767503):2.003301853,t252:5.892346661):10.35793309,((((((t253:6.147786183,t254:5.982512735):0.6080576781,(((t255:0.319772098,t256:0.3151544088):1.100955201,t257:1.336941632):3.320009562,((t258:1.073129423,t259:1.040784559):2.134278895,(t260:2.94520995,t261:2.936670492):0.03436614652):1.385074352):1.847872675):0.2899656111,(((((t262:0.7786062144,t263:0.5337081713):1.325074157,(t264:1.350529531,(t265:0.597427739,t266:0.3994699537):0.7430180566):0.2456002758):1.062436544,t267:2.330257771):0.1733248015,t268:2.476197728):1.186034035,(t269:0.2727792261,t270:0.1222629387):3.380804706):1.857886565):4.746979286,(t271:9.609754083,(t272:3.76762611,t273:3.516118018):5.726824349):0.4680750064):2.52860238,t274:11.75772329):0.3009517478,((((((((t276:0.6464716722,t278:0.4561872701):1.619958598,t279:2.01929882):1.677541143,(t280:0.3944191988,t281:0.2711392621):3.239980507):2.649841209,t282:6.159350257):0.6911645203,(t283:4.862094268,(t284:0.8814086228,t285:0.8667455598):3.813270959):1.965063661):1.349054273,(((t286:1.880042003,t287:1.646625475):0.7965876718,t288:2.2708409):2.337879376,t289:4.487810537):2.947165732):0.08045773957,((((t290:1.856763671,t291:1.65127192):0.2909808007,t292:1.823728902):0.0422912622,(t293:0.6688642756,t294:0.6558363874):0.9025538993):1.108253278,t295:2.565229933):4.173058227):1.109070932,((t296:6.616341888,t297:6.425957685):0.752999321,t298:6.963433665):0.4694863136):2.10755451):1.594364914):0.440087623,((((t299:0.4015021793,t300:0.3349471873):4.349497934,((t301:0.253003219,t302:0.2101899514):0.8125233222,t303:0.9876770139):3.312293789):5.691793578,((((t304:1.010128805,t305:1.001304333):0.04873375302,(t306:0.5893064574,t307:0.5180681752):0.3156467493):3.992905864,(t308:2.007829979,t309:1.798594911):2.796672784):0.1005603025,t310:4.685724779):4.82169303):0.1146415134,(((t311:4.171164532,t312:4.123318728):2.429679395,(t313:0.4006409112,t314:0.3387803974):6.147684475):2.130324794,(((t315:2.61295935,t316:2.409798489):0.7686801735,(t317:0.4170896754,t318:0.3286873338):2.728013165):0.4391343887,((t319:0.7649620897,t320:0.4435798745):1.411879343,(t321:0.6139885201,t322:0.3877105033):1.19819396):1.295637663):4.684033641):0.8081807593):0.9805989819):2.193247876):0.3327919039,(((t323:3.289359193,(((t324:0.1662113436,t325:0.1262795159):0.4180643395,t326:0.4527594492):1.916530703,t327:2.32954017):0.4715269368):0.3863980319,((t328:0.06585875068,t329:0.05231210829):0.1429202125,t330:0.0147167218):2.900767494):0.1910933047,(t331:1.087337917,t332:0.9961236162):1.956756286):7.900538582):2.429497882):0.3645827256):0.5435498875):1.275394727):11.6652523,(t333:14.66948219,((((((t334:1.488249625,t335:1.433864723):0.4251702851,t336:1.792469945):2.451721357,((t337:2.630751234,(t338:1.504326186,t339:1.498479577):0.9179756739):1.353010118,((t340:2.184606715,t341:2.176415817):0.6059934641,((t342:0.5188668842,t343:0.4685263533):0.2979778867,t344:0.4857634145):1.814075551):0.8271531269):0.1757249324):3.525755761,(t345:2.004385502,t346:1.973431624):4.792065156):4.337452875,t347:11.00244872):0.5632454394,((t348:2.154121687,t349:2.118337351):4.341184021,(t350:3.317204205,((t351:0.440602373,t352:0.3607757601):0.1409743625,t353:0.4506462601):2.673900393):3.067261752):5.03779218):1.830304119):12.40162392):9.493004057):8.836980834,(((((((t354:6.367660512,(t355:3.575718018,(t356:0.9681527747,(t357:0.6531595373,t358:0.616593237):0.2513683688):2.484217311):2.659852863):0.140079636,t359:6.14859719):8.042809708,(((((t360:0.1797335932,t361:0.161250895):1.258639641,t362:1.382304036):0.8152826336,(t363:1.367524402,t364:1.356297251):0.8277756339):1.386902567,t365:3.416954479):6.839619828,((t366:0.9331376218,t367:0.8804957667):5.228781029,(t368:4.016793717,t369:3.962852909):1.932592376):3.971931101):3.68487575):8.464348572,(t370:9.70916123,(t371:8.648121923,t372:8.644277107):0.9461377495):12.22577408):1.143007228,((((t373:1.520261982,t374:1.414401483):2.131114327,(t375:1.738042064,t376:1.604092398):1.7606433):1.124146588,t377:4.119774372):7.227102666,t378:11.22519546):10.93720465):4.205742911,(((((t379:3.551808597,(t380:2.116774624,t381:2.06044807):1.347821201):3.017112025,t382:6.410456245):6.081980911,((t383:7.394825977,((t384:2.035087655,t385:1.68414073):3.531406394,t386:5.070181168):1.818427043):4.909696761,(((((t387:0.2360469323,t388:0.1543986925):3.497565522,(t389:0.7581425728,t390:0.6422934229):2.838007883):3.355408941,((t391:0.2293146078,t392:0.1127785433):3.90230915,((t393:2.515802778,t394:2.481136552):1.00463986,(((t395:1.251936062,t396:1.251847367):0.4480310853,((t397:0.7767827407,(t398:0.178247133,t399:0.1760847929):0.4844735936):0.5401644963,(t400:0.5419043494,t401:0.4708183478):0.58871792):0.2673299335):1.544670456,(t403:1.475918518,t404:1.440112102):0.6346805367):0.198412414):0.4578532292):2.286772945):2.57509174,((t405:0.6290507106,t406:0.5543544287):3.950463928,(t407:4.126405632,t408:4.123409524):0.248994452):2.848959199):0.2775415568,(t409:3.645824921,(t410:2.638523221,t411:2.628325437):1.006652629):3.814864923):1.85619782):0.1558603814):2.269698722,(((t412:2.104999552,(t413:1.480848166,t414:1.472611797):0.5338143843):2.040872371,(t415:2.472398196,(t416:1.942473913,t417:1.921045607):0.3531957144):1.518934785):4.270654679,(t419:0.6228391586,t420:0.6160556173):6.963777043):3.29261753):8.204303626,((((t421:4.429316982,(t422:3.44167534,(t423:0.1334177982,t424:0.05258010796):2.783834324):0.852804484):0.3445034929,t425:4.027358814):6.681176017,((t426:0.4830885476,t427:0.4800374389):3.407063433,t428:3.821796092):6.814705152):4.39540462,(((t429:6.453363525,(t430:2.523092931,t431:2.501038275):3.879432631):0.1253398377,(((((t432:0.1384519356,t433:0.0814365958):3.645256656,t436:3.063142546):1.078715496,(t437:4.020760448,(t438:3.845787159,(t439:2.390535374,((t440:1.144394865,t441:1.102291377):0.9752302366,t442:2.07317372):0.1817978899):1.385502984):0.07168554477):0.03570881717):0.5856480135,(t443:0.4545891027,t444:0.2253587025):3.711910575):0.7347651924,(t445:3.059325337,t446:3.027485382):1.577400588):0.2380234086):1.434706033,((t447:1.479374381,((t448:0.4461683735,t449:0.2722651699):0.5969048351,t450:0.6851136191):0.3765952343):0.4565660209,(t451:0.4224429871,t452:0.2480327208):0.9458442096):4.302521452):6.954098568):3.20134939):3.187294144):1.939451994,t453:20.57871308):13.41087663):102.1427131,(((((t454:0.1411900427,t455:0.0008826866062):4.424781027,(t456:2.812429461,(t457:0.06763358497,t458:0.002527341611):2.643192953):1.565061069):0.598502494,t459:4.800903997):7.663915793,(((t460:1.243710073,t461:1.192258519):0.7142749374,t462:1.702543968):3.077204567,(((t463:1.41520852,t464:1.351473592):1.583182311,(t465:1.494316348,t466:1.327889245):1.380492363):0.1229931888,t467:2.797597978):1.495322356):7.409141685):31.96262467,(((t468:5.309309484,t469:5.181040481):10.98426682,t470:15.97440011):5.233728409,(t471:6.261272795,t473:6.045810525):14.88758657):22.08384528):91.29753278):154.5812161,t474:288.8929644);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T55.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
