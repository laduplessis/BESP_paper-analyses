<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t406:4.558066208,(t407:3.348622833,(t408:2.513264615,(t409:1.581334129,(t410:0.9768395332,t411:0.9373230195):0.5288253802):0.9268226671):0.5644297591):1.125763951):27.98451659,(t412:2.187173924,t413:2.099073945):29.69661936):41.23881736,((((t414:1.242057482,t415:1.18041193):0.03974013441,t416:1.118095108):1.761322583,t417:2.78598514):42.27974822,((((t418:4.998509352,t419:4.983135269):2.598465251,((((t420:0.161139582,t421:0.1444208917):1.815278418,(((t422:0.7585974743,t423:0.7133153163):0.2333111779,t424:0.8848233181):0.0699224018,t425:0.8046670977):0.7522339945):2.34008885,(t426:1.494332688,t427:1.469596514):2.393305071):2.00206916,((t428:3.19235516,t429:3.124732564):0.2308850129,t430:3.320930928):2.034368551):1.218024843):4.404280943,((t431:7.460971154,t432:7.418533013):3.175917356,(t433:5.505084357,(((t434:0.827473879,t435:0.8237828032):0.3385239761,t436:1.036464066):0.814513806,(t437:0.3901969922,t438:0.2979262472):1.441165379):3.519430972):5.06494111):0.1469474177):31.2887191,((((t439:6.825487008,(t440:6.297138597,(t441:3.899841852,t442:3.590218504):2.115070944):0.3681336657):4.043858089,t443:9.715417748):5.277465138,((((t444:3.295456529,t445:3.19477178):1.32158542,t446:4.336423396):0.09392438098,t447:4.405537582):1.343856508,t448:5.733563489):8.85796525):3.707884485,((((t449:2.62981852,t450:2.628869018):0.462376699,((t451:0.881122009,(t452:0.3231930858,(t453:0.279212071,t454:0.22535764):0.02075099997):0.5220310153):1.919433451,(((t455:0.446380063,t456:0.3999390798):1.623783005,t457:2.014874491):0.03093786785,t458:2.045171285):0.5550884069):0.17574776):4.337839941,((t459:0.7949566199,(t460:0.5060680922,t461:0.4307492747):0.2304601736):1.879170674,(t462:1.774099047,t463:1.744674577):0.6446822938):4.417014448):6.110514538,(t464:4.885062639,(((t465:0.4131813572,t466:0.3830945283):1.415202454,t467:1.780402352):0.1378720054,t468:1.818172284):2.77247872):8.023676158):4.593320468):21.76792765):1.739146718):27.42556494):14.08923406,((t469:12.4797026,((((t470:1.752381104,((t471:1.015816103,(t472:0.6573602725,t473:0.6026011095):0.3259658007):0.2931430931,t474:1.064376205):0.2987315099):2.502236534,(t475:1.874888238,t476:1.696631368):1.958736825):2.77440543,((t477:0.9664817157,t478:0.9137959808):3.236220238,(t479:1.649130528,((t480:1.017310196,t481:1.011672994):0.1940580314,t482:1.188061131):0.4299881274):2.471317053):2.189008375):5.380342293,(((t483:3.409505927,(t484:2.028569104,(t485:0.7547684803,t486:0.7025917384):1.207017654):1.2972038):0.1534685417,t487:3.313755045):0.08111784876,(t488:1.126942975,t489:1.055843573):2.043509746):7.895249912):0.02618474789):1.837744894,((t491:1.038114878,t492:0.9341796158):11.06656175,((t493:2.273321293,(t494:1.654183984,(t490:0.09540930591,(((t252:0.2800418107,(t253:0.2172759703,(t196:0.0164882462,(t167:0.06237962806,((t161:0.02675038511,(((((t103:0.1588586629,t104:0.1130734626):0.09203524065,t105:0.1196793943):0.1426631067,(t106:0.09852541505,((t73:0.1470849476,(t1:5.088533462,t2:4.866860974):2.239379165):0.3283468225,t3:7.361168549):3.169299587):0.0746164901):2.824817056,((((((t4:6.46314963,t5:6.445931359):0.4095164301,t6:6.619608116):2.160882495,(((t7:3.762937859,t8:3.714075771):4.018581507,(t9:6.211902985,(t10:0.04382401735,t11:0.02774139524):6.132464734):1.35544533):0.310981475,((t12:0.9308995685,t13:0.8700239632):5.155943382,((((t14:1.480074267,t15:1.452347901):0.9708781971,t16:2.355027392):1.213793449,t17:3.526633295):0.2885061366,t18:3.786636922):1.79014091):1.623415423):0.4028034962):1.195572221,(((((t19:5.531589516,(((t20:2.332765996,t21:2.243379398):2.372659311,t22:4.562089258):0.3076701753,t23:4.841050018):0.1700693085):2.70261005,(t24:7.317469306,t25:7.203281):0.3528859201):0.05204036703,(t26:1.07230219,t27:1.020811925):6.327690988):0.1151008295,((((t28:0.3261393303,t29:0.1542932255):0.9511806704,t30:0.6594636738):0.8406774601,t31:1.456031797):1.624441123,t32:2.99988309):3.659748939):0.158512273,((t33:1.91469597,(t34:1.099036008,t35:0.9104038129):0.700102943):1.64499312,(t36:1.08362081,t37:1.071219903):2.009478655):3.21567919):0.2278123788):0.8574942099,((((t38:2.927761987,t39:2.895651565):2.075805181,t40:4.685409612):1.438495363,((t41:5.789623038,(t42:5.228063728,(((t43:3.454050053,t44:3.444200707):0.3954475284,(t45:0.8690524957,t46:0.7950958143):2.958357031):0.1732576982,t47:3.717874269):1.056103218):0.5605218339):0.2938151267,((t48:4.888873061,t49:4.818751421):0.5659804926,(t50:4.407081778,(t51:3.113900015,t52:3.076623516):1.116095134):0.8919511216):0.08527208113):0.006666582496):0.1971433924,(t53:4.681137113,t54:4.673910318):0.6397901112):0.7135927149):0.7049890699,(((((t55:3.830725701,t56:3.666704309):0.6138886046,((t57:0.1738294071,t58:0.1645342453):0.4218656806,t59:0.5212015449):3.640620973):0.007477930808,((t60:0.2112033842,t61:0.1081280163):3.88446652,t62:3.91783901):0.01957437703):0.8089108978,((t63:1.769520841,(t64:0.6415328122,t65:0.6075734859):1.123498935):2.722825292,(((t66:4.029005677,t67:3.884624973):0.20142629,(t68:2.388204653,(t69:0.9104693159,t70:0.8478821604):1.214629971):1.64555706):0.01712126192,((t71:2.901813598,(t72:1.02556161,t74:0.7410221564):1.810246376):0.4637956279,t75:2.769292083):0.1245170547):0.0715329812):0.134609988):0.2048069664,((((t76:0.2869007428,t77:0.244674336):2.491092987,((t78:2.197029966,t79:2.14782846):0.4394754242,(((t80:1.152914895,(t81:1.085107145,t82:1.083444347):0.02592769575):0.7986484123,t83:1.560702264):0.2070023637,((t84:0.151326537,t85:0.1431882459):1.430324886,t86:1.535742225):0.102699888):0.3293621638):0.08986364191):0.07817653616,t87:1.964039076):0.006966442621,(t88:1.04800607,t89:1.023026011):0.5434137163):0.3070584489):1.165544859):1.611493495):0.5798926852,t90:5.225213368):1.680380864):0.05186130926,((((((((((t91:0.8032159375,t92:0.630952651):3.265208992,((t93:1.079834998,t94:1.024218328):1.429594366,(((t95:0.6941579023,((t96:0.03392265006,t97:0.01315507866):0.2555591852,t98:0.2659501455):0.2999255884):0.3213277896,(t99:0.5082724353,t100:0.4820486091):0.1823418115):1.050761538,t101:1.303684142):0.2140080835):1.360834134):0.4037798087,(((t102:0.7814152191,t107:0.01088800254):0.8703582784,t108:0.8410526254):0.8192727673,(t109:1.450827601,t110:1.430390964):0.1572489714):0.7563756136):0.4191622828,((t111:1.058259173,t112:0.7243489502):0.4890366269,(t113:1.012991016,t114:0.8939504418):0.0592506154):1.155479304):0.09792004363,t115:2.196161486):0.25038758,((t116:0.5946880569,(t117:0.475709193,t118:0.4284646861):0.09467401659):1.324914421,(t119:1.500020424,t120:1.466361441):0.2945667491):0.07095865137):0.04682518396,(((t121:1.253350429,(t122:0.1606680877,t123:0.03858451918):0.9556726305):0.04229799742,(t124:0.5738095321,t125:0.2798349952):0.4232084324):0.2163827417,((t126:0.5847340364,t127:0.5185059023):0.1393077052,((t128:0.4331115664,t129:0.3951963124):0.08608024138,(t130:0.1534491807,t131:0.02978173518):0.2909099814):0.09523473226):0.189983451):0.338186545):0.05334341597,(t132:0.9047258705,t133:0.8831955379):0.06755427604):0.1093810916,t134:0.9362028924):0.9296602128,(t135:0.2283263616,t136:0.1534099378):1.593753226):0.5301104577):0.778435282):2.157512231):6.307883253):0.01277232996):0.8433690543,(((((((t137:1.110269105,(t138:0.6094966918,(t139:0.3928079173,t140:0.3817738887):0.1075006402):0.4605675412):0.3958339179,t141:1.222826945):0.3397454807,((t142:0.5866379023,t143:0.5632548483):0.3711332177,t144:0.9065297035):0.6011220707):0.2261911187,t145:1.668950789):0.4901738158,(t146:1.32666515,(t147:0.2426012885,t148:0.06078906688):1.060749055):0.8231192841):2.15347176,(t149:1.263967207,t150:1.229690289):2.806157088):4.898084303,(t151:2.323089893,(((t152:0.121897632,t153:0.07376737723):0.4468803782,t154:0.4637360084):1.467356648,((t155:1.679404575,t156:1.402898471):0.1990927821,t157:1.589160948):0.01997365232):0.0534302993):6.178189623):2.763370301):6.267046342,(((((t158:2.800351255,(((((t159:0.5031222047,t160:0.4730667749):0.08717247106,t162:0.4833180284):0.04598617718,t163:0.3867126593):1.488567671,t164:1.677094015):0.3599757841,(t165:1.850183399,(((t166:0.5722631994,t168:0.4859355027):0.2456325209,(t169:0.1164053197,t170:0.09651387748):0.4361877597):0.2081260248,((t171:0.1717037298,t172:0.151365656):0.3264970004,t173:0.3559600597):0.1585549436):0.5619983852):0.0681345143):0.03243402802):1.094870786,((t174:1.291843105,(t175:0.8163828268,t176:0.7693499346):0.4557710685):0.6097697012,(t177:0.5088443512,(t178:0.2233506712,t179:0.1920302553):0.2694694864):1.160742768):0.3470898933):2.450926458,t180:4.377800866):8.192144688,((((((t181:0.3654680958,t182:0.3633763681):0.005048262063,(t183:0.1668927323,t184:0.06879269224):0.1967601632):0.4427321584,(t185:0.1266847992,t186:0.02675674187):0.4704563332):0.2807898457,((t187:0.2933456895,t188:0.152876836):0.1696129454,t189:0.2191638715):0.2587954832):1.065934888,t190:1.468331531):1.449583472,(t191:0.3087409798,t192:0.2958120972):2.427094011):8.906822977):0.9264135947,((((t193:0.6362413545,(t194:0.304699093,t195:0.2851338208):0.3290230894):0.1498228837,(t197:0.4006777194,t198:0.3747026359):0.08696457066):2.698492618,(t199:0.4939496168,t200:0.2902026065):2.588887164):3.978787415,(t201:0.1389565312,t202:0.1022205816):6.650817982):4.819631943):1.306472168):14.87665592):2.168867701):0.2891054377):5.00132543,((((((((((t203:6.82992706,t204:6.816409538):0.8863745915,(t205:5.58521645,(t206:0.5424510787,t207:0.4170301283):4.963261403):2.010414582):3.121061824,(t208:9.264220292,((((t209:0.3334034919,t210:0.2435020022):0.6279228395,t211:0.7880368391):3.486349209,t212:4.106662877):3.131858307,t213:7.212157035):1.581277166):1.171215662):1.346995145,(((t214:2.777248366,t215:2.749917132):4.14044162,(t216:3.822072382,t217:3.788964189):2.984953398):1.253204158,((t218:1.816245566,t219:1.742470619):3.863293658,t220:5.3923293):2.223252549):2.987900007):0.8501684753,(t221:6.086411397,(t222:5.18054719,t223:5.167724682):0.8808936699):5.194096931):0.9565674071,((t224:8.434386939,((((((t225:0.6006573542,t226:0.5824637251):0.1303811858,t227:0.4863087408):2.229051654,t228:2.626623077):2.67035051,t229:5.247168692):0.1744139183,((t230:1.453865751,(t231:0.2694565989,t232:0.2616814929):0.7630429168):2.06529045,(t233:0.5654081173,t234:0.5516318867):2.339968347):1.793162125):0.319047344,(t235:1.224282334,t236:1.206163893):3.567094536):2.264317387):0.6049213335,(((((t237:0.9442696846,((t238:0.3321215454,t239:0.2580093108):0.01209002595,t240:0.00426234677):0.5172402039):2.55157109,t241:3.043797409):0.4826040328,t242:3.479677674):1.379844625,t243:4.770147842):1.486637516,((((t244:2.189282258,((t245:1.039146071,t246:1.000359441):0.2707040056,t247:0.7793656859):0.7037834373):0.3905645603,((t248:0.9468509766,t249:0.7232871188):0.384088886,t250:1.095598954):0.3714450611):1.844652653,t251:3.262358142):1.479895713,t254:4.395271255):0.1129781318):0.7034118047):2.979746399):1.214667031,t255:9.315143119):5.835676291,(((((t256:1.016197437,(t257:0.2414539915,t258:0.1355836958):0.6052116865):1.604597395,(t259:0.5870377209,t260:0.5556743203):1.686831619):1.76874259,t261:4.009829784):8.111992267,(t262:9.850582071,(t263:7.986715447,t264:7.927915328):1.855271522):2.255400458):1.643667689,(((t265:4.088007458,t266:4.008717043):4.260872511,((t267:0.9132984662,t268:0.8880102713):2.770806011,(t269:1.024227062,t270:0.9587380165):2.411773368):4.526484325):3.297775275,((((t271:0.7038967083,t272:0.6847242992):2.324326601,t273:2.911669043):0.1840056445,(t274:2.328775389,t275:2.17927798):0.7103900123):6.174756939,((((t276:2.701875459,(t277:0.4771860943,t278:0.4610658924):2.194281328):1.91704283,(((t279:0.5109196057,t280:0.2620211996):1.031388281,t281:1.231870058):1.186853162,((t282:1.318027525,t283:1.245958656):0.03053605148,t284:1.11235831):1.056332589):1.796098061):0.5179193535,t285:4.458949394):2.599494084,(t286:2.218219725,t287:2.026436744):4.703818901):1.173072933):1.716545672):1.802935806):0.9372595268):0.7965327893,(((((t288:1.435361672,(t289:0.6273813993,t290:0.5399674774):0.7038000204):5.677078513,t291:6.777308229):0.6312163412,((t292:3.304534246,t293:3.297970042):2.548763748,((t294:0.4169954382,t295:0.4048832966):2.795379503,t296:3.172555188):2.239994166):1.481921446):0.2475121298,(((t297:3.399702634,t298:3.34624026):1.502405835,(t299:0.8505923489,t300:0.7538122206):3.928347086):0.3857778685,(t301:3.848851878,(t302:2.577374707,t303:2.360040259):1.119880496):1.191225844):1.831211154):1.054091383,((t304:1.276777312,t305:0.9320476933):3.398985169,((t306:2.67006146,t307:2.41271104):0.1268865311,t308:2.450412361):1.470423201):2.719041772):3.833046692):6.566776184,t309:16.86459061):6.805644535):4.645379947):0.3904179302):67.85636943):43.80044723,(((((((t310:8.582860244,(t311:0.5958629798,t312:0.5834769698):7.881956525):0.5976804974,((((t313:3.456789767,(t314:0.6940902816,t315:0.5452043163):2.742059017):3.34948372,(t316:3.521162205,t317:3.231961772):3.055390267):0.4774278664,(t318:0.07634952739,t319:0.04935981175):6.658371084):0.5408966621,(t320:1.959165635,t321:1.890088932):5.272421479):1.149476714):1.697398194,((((((t322:0.5725746849,(t323:0.3919262531,t324:0.3564300978):0.0762067877):1.610170347,(t325:0.6477401801,(t326:0.1512478439,t327:0.1491877533):0.4962607065):1.091844642):0.09161820504,t328:1.805877842):0.4101022212,t329:2.164671394):0.6001056711,t330:2.72597061):1.3331534,(t331:1.025182193,t332:0.9471599577):2.846006168):5.351219006):0.5994944894,((t333:2.726482292,((t334:1.711924319,t335:1.552240784):0.4607146493,t336:2.009301101):0.4703045933):4.130532325,((t337:3.0437898,t338:2.955910697):1.357647596,(t339:3.448689462,t340:3.277395276):0.8581930911):2.153701869):2.70771848):1.309013623,((t341:0.5301017066,t342:0.412445172):6.262579042,t343:6.49240446):3.253436581):2.574081657,(((((((t344:1.838717283,t345:1.835479125):1.84635188,t346:3.681201852):0.06699853467,(t347:3.572123602,t348:3.552072117):0.104517685):4.801848341,t349:8.276662577):0.08039793817,(t350:5.801173031,(t351:3.555406502,t352:3.35642349):2.17718055):2.52221814):1.62872225,t353:9.610306534):1.461050827,((((t354:1.015888387,t355:1.007289893):3.99715055,((t356:2.760233735,t357:2.688661696):0.3269323225,(t358:1.970851017,t359:1.353562479):1.037933256):1.814762671):5.160290428,(((t360:4.552896641,t361:4.444107909):1.342895451,(t362:1.969988691,t363:1.825787817):3.762095652):0.869717212,((t364:3.030805752,t365:3.009879217):1.91166123,(t366:2.175618923,(t367:1.836963803,t368:1.735096088):0.2771750513):2.704549239):1.454576717):2.437247074):0.8125794304,((t369:0.07067887949,t370:0.06509793781):5.626323632,t371:5.642505115):3.693221376):0.03755742685):0.5251819869):0.5274437794,((((((t372:4.066005976,t373:3.973871647):1.791052272,((t374:1.847322474,t375:1.780991175):2.890647855,t376:4.607429572):0.7117038187):0.1613301867,((t377:2.895304841,(t378:0.1385167087,t379:0.08547633742):2.740208093):2.323558392,(((t380:0.1660035296,t381:0.149266401):0.7530028596,t382:0.8231979944):2.53358206,t383:3.06455346):1.66453502):0.1514774189):1.75002678,(((t384:1.379067485,t385:1.36437619):1.419333723,(t386:0.1604175747,t387:0.07821840726):2.604982591):2.809748237,(t388:1.001918052,t389:0.9865738528):4.462560019):1.012518367):0.9496278944,(t390:6.144406679,((((t391:1.019390477,t392:0.7607108818):3.625466977,((t393:0.9277213073,t394:0.5906478904):1.411816848,t395:1.819725036):1.945804909):0.1058083787,(t396:2.397313454,(t397:0.2961485973,t398:0.1263609906):1.947471498):1.434118257):0.6768306855,(t399:3.141150844,(t400:1.821153331,(t401:0.935291,t402:0.902368503):0.8596780808):1.165370374):0.9687185176):0.6817148328):1.124474469):1.42506821,((t403:0.4536208968,t404:0.429686228):4.999165932,t405:5.34092848):1.614523774):0.2813001085):124.4744077);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T70.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
