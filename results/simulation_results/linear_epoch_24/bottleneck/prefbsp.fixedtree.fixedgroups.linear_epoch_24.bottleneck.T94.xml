<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t427:1.738708479,t428:1.673900715):3.240553845,(t429:3.919372971,(t430:0.8937938645,t431:0.8268928112):3.015211359):0.9869702637):9.681183989,(t432:3.512166058,((t433:0.6194605251,t434:0.4418889616):0.01308179596,t435:0.4539551414):2.68779612):10.92638291):17.706768,((t436:8.06205396,t437:8.008734302):14.79535526,((t438:6.479692174,t439:6.404294174):1.097331251,(t440:3.722223716,t441:3.496429305):3.668356254):14.88990718):8.818640311):26.057709,(((((((t442:1.882611634,t443:1.730081635):4.867132825,t444:6.44645401):2.424530306,t445:8.811580114):1.782427421,((t446:1.898637588,t448:1.64792522):0.2604850091,t449:1.898283216):8.14320282):0.5613252359,(((t450:0.9208763491,t451:0.68680274):0.6358622507,t452:1.251218453):2.947011527,t453:4.118093447):6.043384067):3.352286038,(((((t454:2.63444984,t455:2.525772476):0.2383889246,t456:2.592269374):3.880603859,(t457:5.463913709,((((t458:2.965645137,t459:2.934371767):0.1798298481,(t460:1.461274328,(t461:0.4041575835,t462:0.1923286001):0.9658240368):1.605240157):1.114108702,t463:3.796368676):0.894591097,(t447:0.06945455993,(t422:0.06477746654,(t391:0.04944277885,(t384:0.1385967119,(t368:0.003229704347,(t353:0.192624403,(t344:0.003726370472,(t339:0.3208193186,(t331:0.01050787361,(t316:0.1063303565,((t233:0.06429049624,(((((t168:0.08158966331,(t167:0.06973945433,(t145:0.5131946051,(t146:0.07478343171,((t128:0.08250532691,(t126:0.04044695686,(t116:0.009366180765,(t113:0.07697116348,(t110:0.00779669607,(((t1:5.138482405,t2:5.002053775):4.344161526,(t3:4.749915648,(t4:0.7894910595,t5:0.6924933756):3.821813769):4.322122639):0.4220975875,(((t6:4.236182921,t7:4.229110445):1.047139447,t8:5.255611109):2.656894176,t9:7.893413906):1.307656292):0.2204464538):0.5720940575):0.2140696478):0.7877218148):0.1577153504):0.8002819774,((t10:9.029092291,(t11:1.934040837,t12:1.80910753):7.015482365):0.2029571922,(t13:0.4408675013,t14:0.4186526122):8.565160789):2.513516709):1.151660763):0.3299056627):1.914742374):0.1825048132):1.250377188,((((((t15:8.744784708,((t16:7.044453796,((t17:3.466147863,t18:3.432293028):1.19669971,t19:4.616903729):2.287757098):1.651205135,((t20:2.156660424,(t21:2.039074495,(t22:0.1679164852,t23:0.1074843873):1.440708252):0.1007302337):4.156632177,(t24:2.151988109,((t25:0.9389227188,t26:0.7861165755):1.015132821,((t27:1.048518588,t28:1.011819556):0.5211064708,t29:1.053162726):0.1735877776):0.1241064688):3.409731125):2.182366827):0.03561028827):0.1030175901,(t30:4.772811357,(t31:4.351697836,t32:4.349476032):0.4193327177):2.277708021):0.2348236786,(t33:7.106298265,(t34:6.959896477,t35:6.864316192):0.03992220221):0.01318132009):4.686095142,(((t36:7.949811873,(((((t37:2.49460689,(t38:2.029439231,t39:2.016248525):0.3950613931):4.086056841,(t40:3.794129013,((t41:1.840599078,t42:1.710646588):1.046182231,t43:2.741078686):0.9038095078):2.656943813):0.008702652382,(t44:0.4908567105,t45:0.3807205768):5.779741339):0.3823895148,((t46:1.516282789,t47:1.309289899):4.763745511,((((t48:3.063684851,t49:3.05051694):2.437921666,(t50:4.154274674,t51:3.718342362):1.287825305):0.2811056998,(t52:0.7993859999,(t53:0.6088675591,t54:0.5299363276):0.02578122368):4.372158241):0.1667436245,((t55:1.836765378,t56:1.809553388):0.5227016684,(t57:0.8788129107,(t58:0.3208989569,t59:0.2905184336):0.5425624651):1.445899668):2.647641216):0.002768397518):0.2592625534):0.004319629518,((t60:3.039604964,((t61:1.005677505,(t62:0.2373529045,t63:0.1349184892):0.765308481):0.1746317893,t64:1.015474634):1.813240144):1.988726802,t65:4.780292639):0.1041320017):0.9458179748):0.3910041497,t66:6.214555465):1.552967507,((((((t67:3.068432677,(((t68:1.777361492,(t69:0.8721448468,t70:0.7972986583):0.8420489373):0.9418653231,t71:2.566763532):0.0388081757,t72:2.310287448):0.2277886395):1.388216376,((t73:1.617406242,t74:1.157349293):1.950258935,(t75:0.6115652573,t76:0.3836973741):2.492536694):0.09593070545):0.1453270189,((t77:2.839766029,((t78:1.827964403,t79:1.826623678):0.102392956,(t80:0.1287186942,t81:0.1149384626):1.659006738):0.8446640329):0.127685262,(t82:1.164771888,(t83:0.5504872903,t84:0.5441272432):0.57613067):1.563144313):0.05051406052):0.9908517304,t85:3.657763824):0.1524115947,(t86:1.454088691,(t87:0.8958324509,t88:0.8869605011):0.410226232):2.080273231):1.975190268,(((t89:2.082781203,t90:2.081580447):0.3161747827,(t91:1.89061235,(t92:0.9131800985,t93:0.8613265074):0.896140287):0.4186359365):0.5874014422,((t94:0.4514089332,t95:0.403812941):1.345267941,(t96:1.496393006,t97:1.386890103):0.2298966258):0.9527584565):2.262415229):0.03382297258):1.680291207):1.682717436,(((((((t98:0.97422325,t99:0.8686537714):0.331784877,t100:1.046036076):0.2286927404,(t101:1.095937692,t102:0.5349836375):0.001863137712):1.877790228,(t103:2.178000833,(t104:0.7394376801,(t105:0.4586478241,t106:0.1764213677):0.2017443214):1.426875283):0.2332052019):0.7636714703,(((t107:1.401679847,((t108:0.6866839826,t109:0.6142821294):0.4845301075,(t111:0.5004743337,t112:0.4717048402):0.1586208088):0.2249577857):0.3379713257,(t114:0.7969201697,(t115:0.30150213,t117:0.209323104):0.3839045894):0.1829987901):0.6630389159,((t118:0.3533842983,t119:0.2141619809):0.7660422934,t120:0.8842979389):0.2329972603):0.3011483835):1.791975754,(((((t121:0.5481447552,t122:0.3623237826):0.4177816736,(t123:0.249900811,t124:0.2474818627):0.5240667135):0.5884967051,(t125:0.6406340525,t127:0.5718444907):0.5621695318):0.2138570786,t129:1.14260278):1.237129922,((((t130:0.243097638,t131:0.2353393796):0.5760141568,t132:0.6705632895):0.5241597058,(t133:0.588529644,(t134:0.3563631812,t135:0.2213757059):0.1198106047):0.4499453299):0.1654633649,t136:0.9545038043):0.7313084032):0.1784312369):1.886545541,t137:3.528811296):0.2831076663):0.5730234292,(t138:2.305003011,t139:2.30118683):1.987829356):0.2733863604):1.053331571,((t140:3.227430662,((t141:0.6207202371,((t142:0.2251035171,t143:0.1214111048):0.2052031072,t144:0.07979034414):0.1402346626):0.8204956261,t147:0.3059724134):1.742685238):0.9565757071,((t148:2.121384822,t149:1.920551785):0.5591979491,(t150:1.494094551,t151:1.471208092):0.8266188225):0.2248371403):1.235758948):0.34065814,(t152:3.210957368,((t153:0.4945359454,t154:0.4138193037):2.451996867,((t155:0.6261173327,t156:0.5821554697):0.1351233876,(t157:0.1868385226,(t158:0.05592892191,t159:0.05438881472):0.06209427807):0.4654686265):2.059406271):0.2221564337):0.7746401131):0.3704078022,((t160:0.8934226384,t161:0.7594219607):0.7696097069,t162:1.40460455):2.217933323):4.325212434):7.843891593,(((t163:2.337081084,((t164:0.7722759964,(t165:0.3249183823,t166:0.2702811299):0.3531620373):0.1568892531,(t169:0.1864311654,t170:0.1067238106):0.2058425748):1.393991295):0.1696650757,(t171:1.539543837,t172:1.28446007):0.1967345618):7.904031462,((t173:0.7516088491,t174:0.6042566509):3.300470673,(((t175:0.5737237199,t176:0.2812922294):1.342258637,t177:1.415198847):0.7841558012,(t178:0.07878366951,t179:0.005212677179):1.698785912):1.173765194):5.110372192):5.209227785):1.070500541):1.46974175):0.6237856061):0.8342269337):0.8238376393):1.280844554):1.339044016):0.9971738581):3.393594334):3.209641114):6.145970504):0.2019312428):0.9526823824):0.5753481612,(((((((((t180:2.201125837,t181:2.197824216):2.949861088,(t182:0.3635747658,t183:0.362679572):4.401853611):4.677238461,((((t184:0.3520163162,t185:0.3063739226):0.1442095966,t186:0.09603711797):7.456803114,(((t187:5.673122249,((t188:4.882155748,(t189:2.746295718,(t190:1.717921924,t191:1.684888249):0.9434014033):2.114070682):0.5206512437,t192:5.169269457):0.2571116157):0.3321058477,((t193:0.2555331287,(t194:0.0852854206,t195:0.06102770062):0.1528580814):3.35109717,t196:3.520524618):2.139224815):0.8672635491,(t197:0.2690425101,t198:0.2115437556):6.147354619):0.5800395469):1.104396892,(t199:6.863431994,((t200:1.289078837,t201:1.188794966):1.08261003,t202:2.256068316):4.477589196):1.155864365):0.3524631227):0.3048228969,((t203:0.1507901699,t204:0.1196594081):2.730322331,t205:2.576468573):5.650166696):2.490823206,(((t206:4.252497947,t207:4.243191435):3.688911983,(t208:2.251131638,(t209:2.068612449,t210:2.061068119):0.03213945203):5.620749222):0.3226464979,t211:8.025531011):2.415462297):1.240926952,((t212:5.359343829,(t213:3.911998299,t214:3.857619995):1.387187884):2.105668075,(((t215:0.8178568008,t216:0.7796806712):4.414326985,(t217:1.445474073,t218:1.374824631):3.41690331):2.053690178,((t219:1.933400076,t220:1.9233999):3.570260503,(t221:2.216800362,t222:2.064827149):2.730584):1.302605488):0.006115456164):3.941416218):3.681311444,(((t223:2.260150044,t224:2.248621317):4.078701393,t225:6.216598231):4.022887932,(t226:3.266122493,((t227:1.874870531,t228:1.837860247):0.8982300645,(t229:1.413471068,t230:1.357535168):1.005690275):0.2573541806):6.745285743):3.193216442):7.374276636,((((((t231:5.14784482,t232:5.115645784):0.5942033336,t234:5.613725327):1.02833234,t235:6.460823469):2.560954475,((t236:2.32237411,t237:2.291128462):1.802325185,(t238:3.442049128,((t239:0.982038246,t240:0.8213852015):0.6354441188,(t241:0.4644231879,t242:0.4534756265):0.840640425):1.824553837):0.5520345608):4.831273429):4.986780843,(((t243:0.320201337,t244:0.2785297992):6.805686443,((t245:2.963098121,t246:2.824627914):3.495575382,((t247:3.303530932,t248:3.129369528):1.889291221,(t249:4.348164613,(((t250:0.2437408476,t251:0.2056386995):0.8153221077,t252:0.9300114772):3.009373886,t253:3.92815175):0.2187536225):0.4659952205):1.090367282):0.5244727211):3.712646288,(t254:0.4393491603,t255:0.05211671467):9.496843253):2.632749833):1.268232731,((t256:5.73064495,(t257:3.82883386,t258:3.579638303):1.887469359):4.099245402,((t259:1.071013836,t260:0.7791254952):7.838936189,t261:8.239311587):0.4538091436):3.506230088):4.238504985):6.220617128,((((t262:2.846581452,(t263:0.1843102379,t264:0.04192980198):2.320130675):7.308371872,(t265:7.09118751,((t266:4.486719904,(t267:2.355178128,((t268:0.481722546,t269:0.4724625551):1.333130742,t270:1.778326566):0.4984916432):2.093927593):0.1641695115,(t271:3.826864278,t272:3.700570052):0.6651719535):2.200220746):2.487436084):9.419813236,((((t273:3.719753508,(t274:1.784766525,(t275:1.597469964,t276:1.509496004):0.1701998287):1.779278213):5.731701656,((((t277:3.043603423,t278:2.97578814):0.9207896671,((t279:0.6210546031,t280:0.6093815205):0.7074698478,t281:1.270709462):2.374972783):0.730486254,t282:4.332618002):3.441289826,((((t283:1.029523961,t284:1.012058856):3.733970945,(t285:1.429608173,t286:1.362716804):3.286790161):0.484348009,t287:5.131278695):2.303257593,(t288:2.776032269,t289:2.719865323):4.553236847):0.1584026999):0.8107937183):1.916221572,(t290:7.621590347,((((t291:0.2610149938,t292:0.002809567453):1.832472525,t293:1.687452335):2.188583163,t294:3.873035218):2.853070597,(t295:1.833570233,t296:1.584382039):4.788475796):0.261007353):2.463046173):4.224186658,((t297:9.135558943,t298:9.032858327):0.6449108052,(t299:3.767860681,t300:3.647769568):5.747115714):3.364779109):2.759913774):1.149290449,((t301:10.50086205,((t302:1.330987138,(t303:0.6238170037,t304:0.5595544477):0.5903644915):6.276298132,t305:7.410322905):2.469784257):0.0910017004,t306:9.957368406):6.048241491):1.913436597):4.828257424):2.431199734,(((((t307:4.941793592,(t308:0.4474780508,t309:0.3883682252):4.450068327):6.003087183,((t310:0.1773738774,t311:0.04661587223):9.934837412,(t312:3.102635164,(t313:1.891757297,t314:1.843685152):1.197382212):6.828499741):0.6851158544):0.07288283612,((t315:0.4460251726,t317:0.05243565738):4.511161055,((t318:0.5965248542,t319:0.5422906624):0.3885260963,t320:0.6702575635):3.475885162):5.603031222):2.430863225,((((((((t321:0.2023972274,t322:0.06574409368):0.7797308403,t323:0.7557007933):0.02225388312,t324:0.6880822594):3.228274989,t325:3.859027419):1.89279086,t326:5.718511459):1.879857456,(((((t327:0.4999005557,t328:0.4676879751):0.6828842964,t329:0.8416804299):0.6686921101,(t330:0.6024775127,t332:0.5049118157):0.8140412248):0.2069901021,t333:1.460364786):4.979336014,((t334:1.930757693,t335:1.926792824):1.864600909,t336:3.784146915):2.639229069):0.4610965873):0.3788800568,t337:7.259268626):2.967487035,(((((t338:3.757066582,(t340:1.69821261,t341:1.433510129):1.490974354):0.8950303954,(t342:2.515999794,t343:2.088062204):1.286887688):1.719983582,t345:4.943920822):2.247755786,(t346:3.553565636,t347:3.420983102):3.630078935):1.217876191,(((t348:0.224019813,t349:0.2082115664):2.532522126,((t350:0.1930574175,t351:0.03066137765):1.060007677,t352:1.084697696):1.375064151):4.478644222,((t354:0.6662643939,(t355:0.5619642319,t356:0.5475486329):0.09598809778):4.395952915,(t357:1.547618844,(t358:0.9866679636,t359:0.9008968621):0.4455105396):3.447940743):1.622924972):0.9800689443):0.3601301183):0.7942931812):0.3233292502,((((t360:1.5100183,(t361:0.8776520995,t362:0.8617802283):0.5129102482):1.781765674,t363:3.145723745):2.890905018,(t364:2.968035812,((t365:1.784361991,(t366:0.2983879561,t367:0.190964794):1.479871437):0.525113188,(t369:1.096699276,(t370:0.6503110952,t371:0.6476599611):0.438300566):0.7605585339):0.5682985812):3.025468572):0.7274924124,((t372:2.522307594,t373:2.353628105):2.242378398,t374:4.589930873):1.398574079):1.621183505):11.35539209):3.702477478):2.303242923,((((t375:0.1273536078,t376:0.08682073018):4.973516327,(t377:1.674470094,t378:1.595004165):3.362837061):0.03813683601,(t379:1.618159468,(t380:1.131039268,(t381:0.7505946642,t382:0.7035604491):0.1205560124):0.4008894882):3.369697336):5.93972343,(t383:10.2203725,(t385:5.026376425,t386:4.75243463):4.813045668):0.2088540942):13.86256839):39.55552459):7.301057417,((t387:14.97470783,t388:14.75836646):18.79212512,(((t389:14.77889445,(((t390:5.567652291,((t392:3.157720877,((t393:0.4314765878,t394:0.2808277648):0.6242104017,t395:0.8018199244):2.087967871):1.802277228,((t396:1.040714717,t397:0.8861920442):1.2401447,t398:2.073865628):2.294914762):0.04492194908):1.286945178,(t399:5.089131742,((t400:1.375855056,t401:1.088986798):3.64869998,t402:4.690936945):0.04240761184):0.3296648901):0.128989205,((t403:1.974290893,t404:1.948333793):1.508598926,((((t405:0.7127495808,(t406:0.5041262705,t407:0.4915103314):0.1999737594):0.001325279014,t408:0.6221602339):0.1278280482,t409:0.7093413119):2.194151636,t410:2.7803736):0.300105049):1.167858237):7.472032991):14.17559837,((((t411:0.5484942458,(t412:0.2164355363,t413:0.1469523851):0.1977281989):4.077346161,t414:4.338001088):0.7604683838,((t415:4.023298686,t416:3.921056186):0.006703855705,(t417:0.7372147147,t418:0.7120456876):3.16993338):0.9229041411):18.12313017,(t419:4.498141117,((t420:1.025921812,t421:0.9734360508):0.8764648086,t423:1.641109394):2.583668444):18.42973556):2.372931569):0.8714993072,((t424:4.638804097,t425:4.455365372):0.2758252407,t426:4.506101107):20.83794486):3.687609294):36.72318491);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T94.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
