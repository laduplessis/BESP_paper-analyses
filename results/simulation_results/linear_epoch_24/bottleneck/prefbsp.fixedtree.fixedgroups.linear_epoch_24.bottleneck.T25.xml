<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t416:1.141486645,t417:1.079300865):0.09279707964,t418:1.150465372):0.18467808,((t419:0.6045184248,t420:0.5445733882):0.2799198956,t421:0.8240521908):0.3576971937):5.81998869,(t422:1.456856355,t423:1.450843016):5.53457618):3.461430285,((t424:5.239100711,t425:5.185754165):2.647425043,(t426:5.885084598,((t427:3.369945325,(t428:1.195883741,(t429:0.4168602455,t430:0.4094093283):0.6856565426):2.154760718):0.2090466671,t431:3.259360232):2.29297046):1.933787781):2.55789266):18.56365669,((((t432:0.9520607098,t434:0.7108771127):2.691294896,t435:3.26680653):0.3132824703,t436:3.501136427):4.653201525,t437:8.11429647):19.90451997):41.27770375,((t438:3.978729306,t439:3.911545478):9.043824461,((t440:1.932975582,t441:1.722173374):3.928124811,(((t442:0.3318841274,t443:0.3184756589):2.814426537,(t444:1.709257265,t445:1.636143961):1.35910353):1.327886865,(t446:3.896172421,t447:3.760532971):0.3602008674):0.9898262784):7.079964353):56.14156404):382.3038485,(((t448:5.147936834,((t449:1.792193181,t450:1.594434115):2.472017614,((t451:0.1795919149,t452:0.1135889652):3.43270254,t453:3.505767899):0.4448103983):0.5152252019):0.594544875,((t454:2.858030653,((t455:1.765198085,((t456:1.218099851,t457:1.147453862):0.04346703488,(t458:0.7965001594,t459:0.7725507281):0.1851279801):0.4357733766):0.08769588745,t460:1.373638417):0.9066319199):0.7263337504,((t461:2.259762019,t462:2.221461419):0.4892270395,t463:2.701534797):0.1177659552):1.386859643):355.7436025,((((t464:1.085599305,t465:1.068363298):0.4754973651,t466:1.518399837):25.92150354,(t467:12.9143476,(((t468:1.204332734,t469:1.170010494):0.5777709969,(t470:0.5830755466,(t471:0.321368641,t472:0.1811474862):0.160222031):1.149498857):10.92779689,(((t473:0.8705558292,t474:0.8184589798):0.2785384829,t475:0.9818131398):1.601064342,t476:2.479242072):9.577181328):0.0511538818):14.42008749):99.02636354,((t477:17.68459278,(((t478:2.334849952,t479:2.217391502):10.54023584,(t480:1.357334201,t481:1.164180576):11.28726094):3.494269969,(((t433:0.07466978626,((t376:0.06027983622,(t355:0.004792154688,((t346:0.02420139605,(t320:0.1360121242,((t299:0.07819422443,(((((t266:0.0148469574,((t255:0.02338395075,((t214:0.000463425461,(t187:0.07280445334,(t178:0.03192502124,(t171:0.04579269912,(((t162:0.08831756873,(t161:0.1572007253,(t138:0.02905194055,((t133:0.01599109308,(((t100:0.08301792448,(t98:0.09573902022,((t96:0.00900470427,t1:9.861785372):0.1577162621,t2:9.898000396):0.1149307733):0.3185208132):3.296210161,(((((t3:6.283895618,t4:6.192054822):0.09715063856,t5:6.217691018):2.311234432,t6:8.503040917):1.566143257,(((((t7:1.553462609,t8:1.431272938):0.6688649073,(t9:2.031595547,t10:1.704948551):0.004780136813):3.467229298,t11:5.125822758):0.06916465057,(t12:1.22646654,t13:1.109472996):3.929307009):3.741656438,((t14:4.396055522,(t15:2.28619945,t16:1.988151034):1.983332349):1.629301661,t17:5.554419137):2.339710506):0.4764516865):0.6082750924,((t18:4.978789699,(t19:0.2300202168,t20:0.1318964475):4.741508489):1.636598558,((t21:3.919282649,(t22:0.3272076684,t23:0.3104780896):3.427328362):2.194771401,(t24:3.139954764,t25:2.78278721):2.69868822):0.3664577727):2.313533793):2.743156063):0.8243026256,((((((t26:4.410581406,t27:4.022942573):0.976039745,t28:4.749853933):1.313491301,(((t29:2.021797447,t30:1.938779978):0.6921029884,t31:2.364271099):2.8778957,(((t32:3.370049514,t33:3.285225223):1.390474753,((t34:1.939710383,t35:1.934848854):2.024833734,t36:3.863542001):0.6463140336):0.1683933929,t37:4.666185439):0.1491625867):0.4043872645):0.5867878676,((t38:1.926963403,t39:1.882012758):3.647602505,(t40:0.7780366771,t41:0.7475618359):4.691926079):0.2228128868):0.8299651475,((t42:3.600570206,t43:3.391685971):1.256610531,(t44:1.821244366,(t45:0.2768741862,t46:0.183352161):1.516940004):2.674251135):1.614968993):2.95020614,(t47:6.097141332,(((t48:2.919482246,(t49:2.311885652,t50:2.301934909):0.5872731324):2.635141513,(t51:5.136001343,((t52:2.766958317,t53:2.578697031):0.9131771092,(t54:0.7800420744,t55:0.7133724539):2.578140666):1.366410465):0.3717861796):0.407507417,(((t56:0.4874363946,t57:0.3301742319):1.740486383,t58:2.030362758):1.511091608,(t59:2.69678808,t60:2.689863339):0.8420461866):1.628835672):0.05413443087):2.834072726):0.6048923184):0.09529552654):0.3636504599,((((((((t61:2.099276331,(t62:1.226341284,t63:0.9098519643):0.7823936804):2.133545628,(t64:1.250721146,t65:1.23534191):2.556383567):0.9494961412,(((((t66:1.56756044,t67:1.451738071):1.773154652,t68:3.044103835):0.3061895005,(t69:2.791828501,t70:2.667795252):0.235241069):0.1241143269,(t71:2.689168575,(((t72:0.7973242814,t73:0.5479817565):1.640632589,t74:2.052318616):0.1064030294,((t75:1.028404356,t76:0.8415826527):0.09971937649,t77:0.8580732026):0.8767604071):0.0469028554):0.2574133172):0.002147491693,(((t78:0.04545087564,t79:0.01488318118):0.8021738412,t80:0.8032329069):0.7093928515,(t81:1.329178316,t82:1.226757454):0.000448215745):0.4573468571):0.8745108777):0.009027225416,((t83:1.197807131,t84:1.163953792):0.4504786503,((t85:1.261197981,t86:1.213147976):0.003475992155,(t87:0.6734629903,t88:0.4478057041):0.4408980484):0.1514267505):0.8863464266):0.6109025525,t89:2.532865797):1.712423948,((((t90:0.508381942,(t91:0.3436814937,t92:0.2953208432):0.1478723988):0.9546644657,((t93:0.3626106614,t94:0.3460311578):0.9204775883,(((t95:0.2365444088,t97:0.02413654697):0.5353324738,t99:0.2314436187):0.3290818785,t101:0.2279531824):0.05920690147):0.08263342472):1.024355476,(t102:0.6189405039,t103:0.5629426591):0.6091212037):1.493846674,((((t104:0.3307958271,t105:0.0784950142):0.5586321015,t106:0.634241896):0.3438939663,t107:0.8710059453):1.057149392,(t108:1.757161353,t109:1.738531159):0.170344338):0.2310020634):0.075565205):0.100430875,(t110:0.9908272207,(t111:0.7490680552,t112:0.4166180086):0.05364106533):0.8706583034):0.9679563613,(t113:1.557475468,t114:1.416774557):0.6179736873):0.3854730652):0.3567420939):2.399281756):0.1592676242):0.6211940091,(((((t115:3.404547233,(t116:2.869695081,(((t117:0.6340639341,t118:0.5411571098):0.9024280095,t119:1.296196031):0.5158518017,t120:1.810098052):0.7776281284):0.4892438295):0.03087266732,(((t121:0.6114431594,t122:0.4180271008):0.1560805188,(t123:0.4232384218,t124:0.2273681773):0.1375607226):1.66971653,t125:1.624958876):0.6266307615):0.1527870046,((t126:0.5431842574,t127:0.3406908925):1.484255589,(((t128:0.07040879639,t129:0.04208378909):0.2965141376,t130:0.1316739497):1.181797594,t131:1.271253568):0.2394062898):0.2017207204):1.322914321,(t132:1.855872412,t134:1.685196291):1.128217598):0.2458579262,(((t135:0.2562399924,t136:0.07971550552):0.1281381288,t137:0.06252356565):1.933350959,t139:1.794987525):0.4271532468):0.7977940935):0.2734394318,((((t140:0.257038727,t141:0.2007848118):0.8848222357,(t142:0.6289495267,t143:0.4981932347):0.4090623178):0.01461572598,(t144:0.5889613483,t145:0.4508490743):0.3312601151):1.326421163,t146:2.096408183):0.689259282):0.006993243722):0.9223227038):1.680217512):2.545668954):0.2965129867,((((t147:0.149805046,t148:0.07585579378):0.5618998589,t149:0.5913979726):6.012718286,((((t150:0.2935083086,t151:0.2718843144):0.5327537177,t152:0.7088746808):1.617977639,(((t153:0.581926549,t154:0.486767966):0.08181506324,t155:0.4509109034):1.566738836,(t156:0.1555074106,t157:0.134919685):1.678936901):0.0612678534):0.7451455384,(t158:0.55792238,t159:0.3571434938):1.950961135):3.180218359):0.8210256389,t160:6.140640009):0.6907070733):2.653005984):0.1158426801,(t163:1.665830849,t164:1.594473135):7.289318918):0.9157412038):0.2053202496,(t165:0.9122995025,t166:0.7324126785):8.909677266):1.085854843,((t167:0.8366184689,t168:0.801664246):3.517593831,(t169:0.1307054897,t170:0.1236937856):4.178749491):6.263338225):0.2225718125,(t172:6.46241009,(t173:0.427043469,t174:0.1911468407):5.944675629):4.054053676):0.8699444228,(t175:10.59430114,t176:10.46059518):0.2714438421):0.4357751738):0.3774469892,t177:11.50922663):1.680636562):2.154741495):0.1395440298,((t179:2.010526969,t180:1.819866327):4.024727478,t181:5.638833176):9.332159871):0.6243548749):2.462983174):2.832944241,((((((t182:4.397423049,(((t183:2.798443262,((t184:1.729427085,t185:1.307007862):0.4754087587,t186:1.616799639):0.4119545188):0.4919937654,t188:2.109178935):0.243312296,t189:2.225064113):0.6279276005):2.241352575,t190:5.018987931):7.124724779,(((t191:5.101796178,t192:5.066252204):0.5990163938,((t193:0.4734268093,t194:0.3913578832):0.8274229526,t195:1.199050822):4.355747784):1.536216814,(t196:3.709583186,t197:3.649657449):2.987547031):4.880896337):0.02056579428,((t198:6.723920279,(t199:2.275907659,((t200:1.710981244,t201:1.661278043):0.4071429508,t202:1.997507132):0.06224856876):4.172437208):0.5005341858,t203:6.559690613):4.123346525):4.222471281,((t204:2.579426845,t205:2.311370865):0.702337069,t206:2.984034083):11.61891568):2.407174861,(((t207:11.70897574,(((t208:5.641534788,((t209:1.65717347,t210:1.509301012):1.07463663,((t211:0.245741507,t212:0.1216423344):0.9278642253,t213:1.042613018):1.398203274):2.85018009):1.024441707,((((t215:0.3052683493,t216:0.2793207343):1.8691275,((t217:0.1944070498,t218:0.1443982951):1.036654658,t219:1.134321238):0.8133540828):1.371376264,(t220:2.486560014,t221:2.450380948):0.6941877162):2.458455727,t222:5.488576803):0.1890350282):4.922067747,(t223:7.324523115,(t224:1.208825093,t225:1.14043315):6.112102733):3.18915256):0.120186985):1.24813491,(((((t226:2.061053648,(t227:1.803829043,t228:1.728193937):0.2385237977):1.074394072,(t229:1.236670889,t230:1.223780196):1.751994087):0.8866329701,t231:3.616956132):0.4085909365,((t232:0.8582913514,t233:0.841331532):0.005803537555,t234:0.7772570809):3.000180807):1.943573469,t235:5.717753176):5.399110751):2.680039771,t236:13.57915735):1.366141601):0.4340161984):1.900476947):13.83426329,((((((t237:2.322940871,(t238:0.9081925764,t239:0.8858010374):1.338841193):2.857246071,((t240:0.6509167852,t241:0.6415626576):3.273766153,t242:3.836914229):1.099438367):3.297877888,(((t243:4.506721588,((t244:0.9999648621,t245:0.9923750404):2.960653767,t246:3.8868873):0.3996493):1.587706729,t247:5.833154369):1.806768829,((t248:4.221512093,t249:4.162989571):3.129672048,(((t250:3.531480418,t251:3.459529038):2.513443909,t252:5.935060004):0.3419448645,t253:6.201517732):0.7980857204):0.2659645486):0.2223566073):7.250444011,(((t254:1.911556063,t256:1.711085897):1.722393403,(t257:0.9623831987,t258:0.9181361126):2.353336106):3.41946931,((t259:1.210073846,(t260:0.282300372,t261:0.1490438472):0.7892036365):3.598339979,((t262:2.353566317,t263:2.342791786):1.294017408,(t264:2.160519105,t265:1.847421991):1.461741684):0.8657257981):1.862802489):7.486137716):3.904803973,(((((((((t267:1.514093145,t268:1.501071411):7.815993436,(t269:1.75264381,t270:1.715928878):7.516079473):1.034819388,t271:9.881406836):1.294308627,(((t272:0.5463645496,t273:0.537784224):5.464488037,((t274:0.7780047197,t275:0.671284742):3.108103027,(t276:3.235540435,((t277:0.0934018775,t278:0.01354266081):0.5612237638,(t279:0.2679423735,t280:0.2535655483):0.2329455612):2.539564251):0.2365578676):2.09480596):4.077119083,(t281:6.146639121,(t282:0.4781027659,t283:0.3098535086):5.61886433):3.259841147):0.9833323246):0.4959580505,(t284:5.568994875,t285:5.477496134):4.894910803):0.2586507934,((((((t286:0.679574311,t287:0.6591945609):0.5800508897,t288:1.125612809):1.310344595,t289:2.420402161):4.050049746,(t290:4.598386602,(t291:1.116082482,t292:1.051290144):3.414819558):1.791571577):0.5502911385,t293:6.630571857):0.3951046757,(((t294:1.950810483,t295:1.91012844):0.2532859045,(t296:1.51377662,t297:1.474516157):0.6350875438):1.472008063,t298:3.552450813):3.201489165):3.051601176):0.5698881817,(t300:6.932981221,(t301:3.166426685,((t302:1.016059264,t303:1.009230708):0.7450562759,t304:1.745808922):1.38637698):3.696675266):3.079783199):2.436440015,(((t305:2.662208594,(t306:0.1612268522,t307:0.09658379053):2.378487889):1.141662313,t308:3.552001595):2.890088297,((t309:1.329046552,t310:1.223335186):4.120477822,(t311:5.12412061,(t312:0.4377996358,t313:0.2983549339):4.678891629):0.02471129972):0.9460633341):5.63974663):0.8343509284,(t314:5.195800345,(t315:0.7361187594,t316:0.5959379882):4.39863284):7.0240495):1.104204083):0.1745818322,(((t317:2.748740777,(t318:0.5491363136,t319:0.3877196894):2.084036488):6.95568285,t321:9.070216354):2.413689544,t322:11.4551006):1.003091335):11.26639451):1.235843399,((((((t323:0.4698808051,t324:0.4486195345):2.331705668,t325:2.778882344):1.836397857,t326:4.463351487):6.257487359,((((t327:1.457944577,t328:1.342483362):0.2592319581,t329:1.395029939):0.5886768291,t330:1.868941027):0.2709327205,(t331:1.272449443,t332:1.074992479):0.8250144554):8.091070116):0.546605421,(((t333:2.129615935,t334:2.120604394):0.1381794447,(t335:2.096845293,t336:2.017627723):0.1122548744):0.477209983,t337:2.579728943):7.788365576):3.951917018,((t338:10.76017595,(((((((t339:1.087359634,t340:0.7423598632):0.4775666526,(t341:0.2180220787,t342:0.17309685):0.9754389858):0.03773495293,t343:1.070466847):0.3071857662,(t344:0.2828442872,t345:0.2273308056):1.054097006):0.4760298783,t347:1.636198319):1.598670536,(t348:0.3155628637,t349:0.2260830923):2.866620384):0.1582447526,t350:3.172647342):6.541241687):0.2326236834,((t351:3.941680513,(t352:1.450230567,(t353:0.3561596851,t354:0.1934780478):1.092996343):2.447592324):2.514846484,t356:5.984974404):3.294131238):3.298294975):9.524890497):5.649665046):1.273591038):29.29118996,((((((((t357:7.165856098,(t358:6.719547005,(t359:1.709519988,(t360:0.9713967278,t361:0.896826519):0.6424310873):4.937347988):0.3208439074):2.875759797,t362:9.293665623):0.03913078097,t363:9.272399599):0.6832784579,(((((t364:3.437767581,(t365:2.340051296,t366:2.234176403):1.046583009):0.4165762626,((t367:2.124327384,(t368:1.735606235,t369:1.691706979):0.3799518809):1.024084439,t370:3.088406866):0.4094616269):0.2104568844,(t371:1.511914272,(t372:0.1461144522,t373:0.01991648821):1.28697344):2.064135727):0.03078125226,t374:3.350230545):5.295569622,((((t375:4.484603842,((((t377:0.4009747965,(t378:0.2457040023,t379:0.2083863826):0.1509307179):0.1204603836,t380:0.2920985538):0.874723416,t381:1.089143616):0.472200793,t382:1.450370473):2.238423371):0.6486750918,((t383:1.702642657,t384:1.663575898):0.06956374099,t385:1.572112385):2.516997507):0.9029923817,(((t386:0.0373913524,t387:0.0245807268):2.754959884,(t388:1.28250101,t389:1.227356075):1.428531582):0.3626005681,(t390:1.937578558,(t391:0.9109986817,((t392:0.09095142276,t393:0.08904427623):0.6923490792,t394:0.7707104317):0.1097614201):1.002012231):1.0305001):1.673891533):0.09967198598,(t395:3.592861354,(t396:0.6951293553,t397:0.4755233153):2.790763569):0.9649708786):2.227679468):0.3977691141):0.6057088844,(t398:4.521507987,t399:4.358705157):2.819756557):4.358345309,((t400:3.925171931,t401:3.703529916):4.555318972,((((t402:4.445374829,(t403:0.7289121991,t404:0.7028330748):3.367409308):1.800132617,(t405:2.490463154,t406:2.358883593):3.332608132):0.4235536043,((t407:1.646577536,t408:1.604003427):2.652555926,(t409:1.494465534,t410:1.46056869):2.747192922):1.637685905):1.064120096,t411:6.779511284):0.3547110589):3.024252909):0.2876395387,t412:10.43540413):28.14794149,(t413:1.904478682,(t414:1.100402313,t415:1.01697425):0.4629790844):36.54335989):14.15291777):78.35432474):233.2907172):89.05499428);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T25.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
