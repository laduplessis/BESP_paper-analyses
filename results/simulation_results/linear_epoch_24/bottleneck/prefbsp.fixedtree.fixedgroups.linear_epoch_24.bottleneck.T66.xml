<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t482:25.55487438,((t483:0.7180863835,t484:0.6245180994):12.91316261,t485:13.38294964):11.91738737):22.99396211,(((t450:0.08982751678,(((t169:0.04275436269,(t166:0.01941167855,(t164:0.07334101903,((t138:0.004199096011,(t126:0.1239792906,((((t108:0.0247816464,(((t99:0.4578651983,((t100:0.1676335821,t101:0.06110083656):0.06671040624,t102:0.09347350613):0.05256167025):0.09081312296,(t57:0.004456664808,(t1:2.769414978,(t2:2.538652593,t3:2.429355163):0.2176944992):2.695480805):4.795275631):0.5497110608,(((((t4:6.678563008,t5:6.635068811):3.395796883,(((((t6:3.68340771,(t7:3.445541634,t8:3.277782675):0.1332733613):1.147605126,t9:4.555272082):1.100280584,((t10:0.5122680964,t11:0.3873753508):0.1906740387,t12:0.5511742009):4.918769995):3.646400633,(t13:3.250176307,t14:2.965969896):5.830787941):0.2040163674,(t15:7.113324142,t16:6.844211629):1.761410963):0.08313247889):0.01858791327,((t17:3.66805512,((t18:2.041013404,(t19:1.084688965,t20:0.9214740881):0.8875106225):0.4371884456,t21:2.207532735):1.124943298):4.868923661,(((t22:0.9463399222,t23:0.9159669039):0.8222206081,t24:1.654862942):5.474918493,t25:7.059202094):0.9508947195):0.1456377023):0.3893394084,((t26:2.699838702,(t27:0.7080273758,t28:0.6105292612):1.841387345):5.695586109,t29:8.10483422):0.1462579596):0.0009695826282,t30:8.035340271):0.1348039482):0.06300521426):0.3472915856,(t31:8.477168368,(t32:0.5338560346,t33:0.5018025346):7.742258117):0.05111177243):0.2597669447,(t34:8.143199183,(((((t35:0.893482333,t36:0.8459995435):5.316251105,t37:6.121112412):0.793007128,((t38:3.325007769,(((t39:2.463426996,(t40:0.1362473116,t41:0.08141702865):2.206667409):0.2551933057,t42:2.313221231):0.5008194739,t43:2.624803168):0.08651591576):2.764546434,(t44:1.310253193,t45:1.161203196):4.037167689):0.8122552916):0.01770063397,(t46:1.683857234,(t47:0.36698978,t48:0.3425158041):1.238388219):4.329657888):0.1437624224,(((t49:0.8440190955,t50:0.843307742):1.662334979,t51:2.338814406):3.232686263,(t52:5.262980911,((t53:0.2464821541,t54:0.12309485):4.166573529,t55:4.286837489):0.6886159871):0.2066216357):0.1274482951):0.9663249294):0.3733948419):0.8105426176,((t56:5.336977174,(t58:4.774525127,((((t59:1.893145463,t60:1.799235199):2.02802736,t61:3.743455208):0.5054369425,t62:4.192810256):0.1089624089,((t63:0.4090273251,(t64:0.3206193604,t65:0.2828815592):0.02740116997):3.665859866,((t66:0.2091217949,t67:0.1769036521):1.607055837,t68:1.730839252):1.867777668):0.174265158):0.097027349):0.1629524521):1.714750452,((t69:4.330550306,t70:3.90905816):1.264258795,((t71:2.10979438,t72:1.940094747):2.319270782,((((((t73:0.07728339898,t74:0.07147466279):2.988623692,t75:2.761507263):0.6243458787,(t76:3.001074457,(t77:2.978905975,t78:2.747813526):0.01287406553):0.3249162473):0.0554444734,((((t79:1.399242412,t80:1.355640842):0.6184932663,t81:1.79966475):0.4719486867,(t82:1.244362307,t83:1.108738473):0.9485693661):0.05041288319,t84:2.080111013):0.5050339516):0.1510132372,((t85:1.652444465,t86:1.354746952):0.1152755401,t87:1.376336234):0.9590860514):0.09808376318,(((((t88:0.4268417113,t89:0.4094297133):0.9570654931,t90:1.350804268):0.2454397659,(t91:0.6019323866,t92:0.5444061931):0.9621499676):0.0838146953,(t93:1.185152053,(t94:0.4817213681,t95:0.4605727852):0.569899169):0.2365598571):0.2456599958,t96:1.511556294):0.4404405957):0.2517041056):0.5628165341):0.1484017783):0.0593702585):0.9337700542):1.42688511):2.049823012,((((t97:1.330421946,t98:1.32913644):3.1049538,(t103:2.827234394,((t104:0.09001191594,t105:0.08224669826):0.1727401158,t106:0.1904887751):2.523897):0.6278772432):0.9986990645,((t107:3.521736259,(((t109:0.4015159387,t110:0.1352731994):1.770448687,(t111:1.219963091,t112:1.067310493):0.5690920449):0.1763014301,t113:1.682881805):0.658686486):0.6267748969,((((t114:0.1300583759,t115:0.08664420603):0.3884816443,t116:0.4673911256):0.4167493659,t117:0.7307607387):1.441644479,(((t118:0.319771042,t119:0.3036346994):0.8259868239,(t120:0.87897911,t121:0.7950284247):0.2143834923):0.536958627,t122:1.398123868):0.2049266375):0.314791249):0.08256983132):1.33745727,((t123:2.219159772,((((t124:0.2776702338,t125:0.2198193113):0.1916745437,t127:0.1831596675):1.337147519,t128:1.306206816):0.0617503491,(t129:1.074923434,(t130:0.3914442934,t131:0.2820443605):0.5658605474):0.2663985503):0.3336604244):0.1679914059,t132:1.555750172):0.8912827752):0.4659349633):0.7024727934):0.08135810782):0.2622402746):19.66333756,(((((((t133:3.941959497,((t134:1.41886653,t135:1.377770246):1.19982943,(t136:2.007044655,t137:1.895995965):0.3615025564):1.005434887):0.1420858349,((t139:2.843531147,t140:2.748728421):0.2565360227,(((((t141:0.2193169174,t142:0.2032823493):0.2808803588,t143:0.4630262449):0.2904834124,t144:0.651373715):0.4176403717,((t145:0.297306254,t146:0.0509747699):0.1434103822,t147:0.1867930472):0.4876906994):1.030512284,t148:1.311445804):0.7656169064):0.1252828613):1.979587022,(((t149:0.9064949453,t150:0.8594400384):0.05958057789,t151:0.7385080967):1.348830082,t152:1.858825092):1.853250795):4.98046006,((((t153:0.2084013476,t154:0.09221253974):0.7061036571,t155:0.7974642001):0.8298448388,t156:1.486245513):1.180289153,(((t157:1.051266057,t158:1.044356609):0.02987545861,((t159:0.237783341,t160:0.1119931175):0.2134392355,t161:0.05214393589):0.6021257067):1.089891651,((t162:1.431674138,(t163:1.166013614,t165:0.9439012304):0.2330022645):0.1668319639,t167:1.213284145):0.05950608331):0.468954374):5.555541717):4.927740889,(((t168:1.292712639,t170:0.9631160415):1.884861868,(((((t171:0.5926339975,t172:0.5660836724):0.378949502,(t173:0.7493462383,t174:0.7368960564):0.1652495108):0.05971434641,((t175:0.09433589435,t176:0.07232225712):0.07628044467,t177:0.1406388386):0.6543697813):0.7917572315,(t178:1.282648266,(t179:0.5545423275,t180:0.4303239548):0.6374220976):0.220362934):0.1633925068,(((t181:0.6531224733,(t182:0.3336659399,(t183:0.2516726116,t184:0.2166081094):0.037474255):0.1999246486):0.1908659051,t185:0.5619741798):0.0007025048807,t186:0.404068798):0.5666295529):0.850301046):5.797322328,t187:7.487247776):3.201762845):1.820902724,(t188:4.73368715,t189:4.304602702):7.680009781):0.2452212343,(((t190:2.780564748,t191:2.762588051):3.050296401,((t192:1.039905751,t193:1.022156615):1.099235766,t194:1.730493488):3.508888655):2.449700546,t195:7.64999788):3.874689068):5.551595286):2.460737207,(((((((t196:2.69115915,t197:2.682110904):3.954090719,((((t198:0.8390640177,t199:0.6861209691):0.1150477463,t200:0.7259506734):3.750948348,t201:4.462105564):0.6192307549,((t202:0.9504727172,t203:0.9068311188):3.360436934,t204:4.178706523):0.6146313673):1.130784338):0.9869207718,(t205:0.899725847,t206:0.8959786911):5.985250264):0.5154805909,((((t207:0.2737934868,t208:0.1297306305):1.983603826,(t209:1.433263458,t210:1.368950437):0.6647971978):0.3400886892,t211:2.236781112):3.562532028,t212:5.714556945):0.857839896):2.735646447,((t213:7.048040567,(t214:5.144469574,t215:5.060666792):1.892893936):1.658015298,(t216:5.008351731,(t217:4.077839048,(t218:0.8650631206,t219:0.5575743816):3.210074818):0.5355350924):3.346589129):0.4867796345):1.909046948,(((t220:0.7470323877,t221:0.3671514896):5.721954133,(t222:1.737396794,t223:1.728360268):4.232515758):0.7058000646,((t224:2.556408507,t225:2.534010478):0.2685630666,t226:2.582075487):3.712615263):2.811398437):1.115719935,(((((t227:5.449830458,(t228:2.260942985,t229:2.117483875):3.133527343):3.125073205,(t230:4.31364499,t231:4.101494516):4.033501104):0.3757068234,(t232:3.729526587,(t233:3.145070245,(t234:1.928210525,t235:1.591849401):1.213964832):0.4358710586):4.699062139):0.4919171479,((((((t236:2.104406064,t237:2.037532604):1.136426679,t238:2.991431569):1.278045843,t239:3.925979018):0.5849442407,t240:4.439856112):0.07078372829,t241:4.244198448):0.3596509757,(t242:3.476746975,t243:3.407699862):1.101886207):2.898207026):0.6188797633,(((t244:4.380063477,t245:4.375843251):1.472131684,t246:5.787881029):1.721941041,(((t247:5.006832231,t248:4.625537996):0.03036354462,((t249:3.832510496,t250:3.810050955):0.619980259,((t251:1.014040648,t252:0.9785195705):0.9356673204,t253:1.812539181):2.366429667):0.1949610175):2.270335363,((t254:1.410033619,(t255:0.7705601432,t256:0.7019937171):0.3098384284):0.7801806504,t257:1.780754299):4.341068025):0.1876777304):0.3932197828):0.0569171015):5.618625415):5.405764464):1.777407766,(((((t258:4.21926566,(t259:0.6468162735,t260:0.5846785874):3.558169014):7.317406449,((t261:3.707044645,t262:3.519130613):1.260648606,((t263:0.895497373,t264:0.8667857602):2.201306718,t265:3.001760035):1.648842697):6.153758062):1.685125529,(((((t266:0.6966906685,t267:0.1872630218):0.6675728914,t268:0.8367025463):4.74860756,((t269:0.08819834197,t270:0.07583470045):4.523186895,(t271:0.7168859227,t272:0.5930529779):3.623641101):0.9491732774):0.3137094945,(t273:1.31397632,t274:1.193149801):4.162008969):2.645521799,(t275:7.473585131,((t276:5.816113276,((t277:2.373902582,(t278:1.138388949,t279:1.128958751):1.226377862):3.396613348,((((t280:1.953146916,t281:1.838104873):1.14399795,(t282:2.076731961,t283:1.878194261):0.3200062677):0.4536044078,t284:2.643596013):0.210176514,(t285:1.10271216,t286:0.9873865745):1.673515798):1.876534236):0.04524287801):1.511715455,((t287:4.131119573,t288:4.11131572):0.2829274349,(((t289:0.7182794776,t290:0.6880620484):1.863942699,(t291:1.083239702,t292:1.065653217):1.285851293):0.8427178964,(t293:1.026328895,(t294:0.7432341906,(t295:0.5515430474,t296:0.3664839009):0.1711360386):0.1681557328):2.14120658):0.928367733):1.664529182):0.1234187976):0.5267187675):3.384194721):4.173286898,(t297:1.077041962,t298:0.8921468992):12.41693915):1.566950083,(t299:12.84805622,((((t300:4.528575131,(t301:2.056856472,t302:1.888857538):2.267424884):4.118406797,(((t303:2.493139537,t304:2.357675863):4.577034094,(((t305:0.4060740841,t306:0.3949932081):0.6702176119,t307:0.95765752):1.880604167,(t308:2.677694635,t309:2.574292319):0.05554362896):3.88360056):0.5527621131,(t310:4.920522419,t311:4.783555799):2.059172775):0.6360429949):1.604869927,(t312:2.413079556,(t313:2.336288753,t314:2.328575467):0.0270556602):6.629277875):1.058594822,(t315:2.208170244,(t316:1.322298423,t317:1.182351344):0.8380441028):7.796840328):1.505488153):1.960273434):0.5981016429):14.11869486,((((t318:0.4617477767,t319:0.2431073617):6.311585585,t320:6.540035639):5.931026301,(((((t321:4.710203094,(t322:2.386269608,t323:2.267363705):2.302801311):0.9735635779,((((t324:0.5523010762,t325:0.02389642359):0.8712886993,t326:0.8712949973):0.8771978618,t327:1.655689891):2.401131777,(((t328:2.621260505,t329:2.5349898):0.1709206286,t330:2.408744382):1.052186678,t331:3.415060996):0.205828185):0.8034698388):3.897265852,((t332:1.657562904,(t333:1.396373692,t334:1.346153277):0.1137934119):2.184749711,t335:3.620342828):4.434741032):2.077323714,(((t336:1.184812157,(t337:0.7879908934,t338:0.7657103387):0.323434031):3.126944936,t339:4.174922668):2.276807309,((t340:3.947608827,t341:3.891495477):1.35144692,(((t342:0.6951264372,t343:0.6335375329):2.744440203,((t344:0.2267591942,t345:0.1619871546):1.6690384,t346:1.619192437):1.416165486):0.1569761554,(t347:2.715960574,t348:2.597421408):0.3723955457):1.611734621):1.033729476):3.507113135):0.3760091522,t349:9.475549492):0.1670928984):13.60583279,(((t350:2.246159925,(t351:0.9037527261,t352:0.7013982069):0.9890078505):0.83628217,(t353:2.380709273,t354:2.300411615):0.09217133098):0.1641332211,(t355:1.908547506,t356:1.896387952):0.6094014584):19.81001875):1.647795649):35.05429083):94.41215524,((((((((((t357:0.6688975298,t358:0.5566283197):0.5239919982,t359:1.030978845):2.88847647,((((t360:1.145963371,t361:1.101986767):0.03805165451,t362:1.136702128):1.138485781,((t363:0.773291386,t364:0.7727824583):1.337417191,t365:2.105158957):0.1622994137):1.119771051,(t366:2.963614458,t367:2.919419807):0.2996162902):0.3331321482):0.9255325414,t368:4.256538111):2.416096804,t369:6.425758623):0.1442643355,((t370:2.914192905,t371:2.829880723):0.9417117995,t372:3.760704772):2.705017397):1.326381251,((t373:3.004842733,t374:2.884085583):1.189649204,((t375:1.572722585,t376:1.534285958):0.9488639003,t377:2.399525164):1.521468552):3.504063658):40.65331751,(((((t378:1.741195771,((t379:1.376682931,t380:1.200649493):0.2241376931,t381:1.355551204):0.07719520298):0.9051707144,t382:2.143152634):4.809173816,t383:6.897997411):1.827729671,((t384:2.107575626,(t385:1.974911737,(t386:0.157443704,t387:0.05224665381):1.808659137):0.06110313439):5.356076977,(t388:5.399541621,t389:5.37248849):1.71218578):1.214829954):25.57775257,(t390:11.34943082,(((t391:0.6066234748,t392:0.5869020156):6.412571701,t393:6.801541532):0.6986587851,((t394:3.264831445,(t395:2.591477009,t396:2.589050131):0.4119441811):1.456870758,(((t397:0.3485132103,t398:0.06958628415):1.139825364,(t399:0.8889395016,t400:0.828834772):0.2568498107):0.7526369337,(t401:0.5055157612,t402:0.3993059639):1.284161056):2.199575653):2.773923908):3.337786342):22.52078592):13.02209673):10.23214847,(((((((t403:1.664266343,t404:1.659153362):1.67079919,t405:3.312698582):0.7136854939,(t406:1.844382051,(t407:1.286047643,t408:1.241383729):0.5186189537):2.173205701):2.637574771,((t409:1.942348604,t410:1.899485121):1.519235543,t411:3.14031127):3.040755555):3.021843715,(((((t412:0.6988489211,t413:0.6591139605):0.3996977952,t414:1.020101378):0.729455141,t415:1.730148969):0.5840589257,(t416:0.3507411059,t417:0.3100957491):1.931375961):2.894206974,t418:5.039831867):3.654466397):20.00518178,(((t419:2.997660113,t420:2.976148735):1.266729603,t421:4.179179157):4.70026702,(t422:1.885212151,t423:1.811833106):6.988206047):19.67259674):14.67088492,(((((t424:1.575516338,t425:1.571525401):6.510152214,t426:8.07953911):7.953368466,(t427:6.315999838,(t428:0.3106378365,t429:0.1554230076):5.963284284):9.659874116):8.053227526,((t430:0.8657221208,t431:0.8312373697):5.155918789,t432:5.982930564):17.74243507):14.13420572,((t433:20.64911392,((((t434:6.939602447,(t435:4.222767853,(t436:3.061840699,((t437:0.6875489053,t438:0.4932460954):1.655848601,(t439:0.6979561537,(t440:0.02472161782,t441:0.0005656085107):0.6124898294):1.368891943):0.6842458527):0.891081455):2.708235974):0.6715565409,((t442:2.871035872,t443:2.757501727):2.955938562,(t444:1.014949621,t445:0.9977008195):4.680349304):0.8113995984):2.621163984,((t446:3.693696253,(t447:2.742332967,(t448:2.107441563,(t449:1.617019431,((t451:0.1888586873,t452:0.1378818968):0.4376981538,t453:0.5277905585):0.7130885828):0.3286783427):0.5920911345):0.7891729578):4.495572462,(t454:0.8705837152,t455:0.6928564299):6.425605098):0.8020415229):7.915417259,(t456:5.669667369,(t457:1.128998976,t458:1.076979997):4.522949003):9.91529437):2.439965695):11.39945709,(t459:11.05124448,((((t460:0.2929127102,t461:0.2185966449):2.39113554,(t462:1.426554635,((t463:0.5976899354,t464:0.5607441011):0.1858602052,t465:0.5620580075):0.4609299345):1.166714749):2.082580415,(t466:2.734488218,((t467:1.718871328,t468:1.649973611):0.5830278969,((t469:0.09878790791,t470:0.05674380384):1.43742557,(t471:0.4863190837,t472:0.3369988626):0.9235234787):0.6141299349):0.3670964776):1.528142086):2.53404659,(((t473:0.2207199209,t474:0.05388598981):3.639039344,t475:3.670986411):1.328720806,(t476:2.617700092,t477:2.456725552):2.371353473):1.107033491):3.682774945):18.2889989):5.690439625):4.909459603):11.21420284):91.738091,((t478:1.960339341,t479:1.940668016):2.569021231,(t480:1.28962654,t481:1.287364502):3.209942393):136.9239571):1.593855727);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T66.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
