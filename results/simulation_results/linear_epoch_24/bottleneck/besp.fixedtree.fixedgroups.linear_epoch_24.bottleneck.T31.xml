<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t456:4.660151668,((t457:1.419921306,t458:1.253465696):1.742479506,(t460:2.258550708,(t461:0.9098488417,t462:0.89020944):1.250126926):0.4650374324):1.396528485):38.71575596,((t463:2.653290971,t464:2.454096533):12.68603305,(((t466:3.016360351,t467:3.014123903):0.833427232,t468:3.791663252):0.9891948618,((((t469:0.1082602617,t470:0.1071586859):1.073036386,t471:1.130311615):0.4464273686,t472:1.298078199):0.88804518,((t473:2.022282187,t474:1.952114067):0.05616899696,(t475:0.733619085,t476:0.5946160355):1.218857713):0.06528765006):2.206341133):10.10600117):27.36200028):54.48123104,(((t477:1.545873788,t478:1.529622236):29.03241095,((t479:12.97752029,t480:12.94065777):13.24910793,(((t481:2.466456815,(t482:1.995729825,t483:1.814197979):0.4391867242):1.628301289,t484:3.777707282):1.591233015,t485:5.223208184):20.48361328):4.20508878):8.092244827,(t486:0.4800429934,t487:0.452515147):37.52115117):57.36095926):8.218059423,(((((t488:3.15372671,t489:3.011656788):0.1111093351,(t490:0.8631653799,t491:0.7369610211):2.237254317):20.32415407,(((t492:0.3587881212,t493:0.2367071591):1.69681364,t494:1.861573546):8.70736964,(t495:0.6864769876,t496:0.6394927118):9.640205612):12.50546148):7.490560994,(((t497:4.170946485,(t498:2.671196761,(t499:0.5217708485,((t465:0.03380803203,(t459:0.2213298761,((t429:0.0436300818,(((((t356:0.001839139938,(t330:0.02144780377,(t329:0.0587800793,((t274:0.04443226621,(t249:0.06570226046,(t212:0.01568983807,((t199:0.0465315426,(((t161:0.01432549617,(t160:0.01552073848,(((t140:0.05250760784,((t126:0.009080162563,((t114:0.04649503369,((t108:0.03829535439,(t106:0.03735218055,(t97:0.1311416914,t1:8.222093639):1.215493335):0.2153337772):0.39918776,((t2:7.902911257,((t3:4.128884756,(t4:2.922342283,t5:2.913577795):1.133327604):1.499041295,(t6:5.106938694,(t7:4.432344464,t8:4.329839803):0.655386985):0.247707288):2.268998688):0.1330664298,t9:7.571883365):1.984117979):0.01946497526):0.8755034084,(((t10:3.775562725,(t11:3.04960081,((t12:0.4336865841,t13:0.432945032):0.5203549952,t14:0.9466377776):1.989355884):0.646532005):0.5158299295,(t15:3.04873113,t16:2.917687692):0.9228474234):5.536274379,(((t17:0.6257005087,t18:0.5421847505):4.337067223,(t19:0.5457892306,t20:0.4652927886):4.239537942):2.91598067,(t21:2.417012229,t22:2.279138029):5.148622675):1.475824284):0.5975132741):0.1646821447):1.052009697,((((t23:8.946080232,(t24:3.850442426,t25:3.839824027):5.007285786):1.167936376,(((((t26:5.888393388,t27:5.791961659):0.8310239608,t28:6.585848258):1.738477428,(t29:0.4056661559,t30:0.3821358599):7.890608767):0.7036175817,((((((t31:0.8700589843,t32:0.703888105):3.878359063,(t33:1.14752086,t34:0.9739106588):3.255033935):0.7969087216,(t35:3.951012952,t36:3.886542428):0.9328641607):0.6423152275,(t37:2.197436105,t38:2.14870472):3.262560278):2.039700546,((t39:1.924333013,(t40:0.7571823381,t41:0.5852698496):1.166521051):5.105780259,(t42:3.047784994,t43:2.973549641):3.733937363):0.3358448303):0.6582706019,(((t44:0.7982369316,t45:0.6783309187):3.356915752,((t46:1.12091899,t47:0.9319306056):0.7789220516,t48:1.684405286):2.046253079):2.594596336,(t49:5.664305337,t50:5.560790343):0.6608339666):0.8623203969):0.04676711952):0.386302419,((t51:5.013401053,(t52:0.2904654666,t53:0.2195316766):4.658281477):2.427772131,t54:7.301939635):0.04764789185):0.4557172343):0.203739343,(((((t55:4.336985076,((t56:0.1103650508,t57:0.06563839825):1.07271553,t58:1.094894384):3.07677863):2.184546186,t59:6.273735591):0.06867845544,((((t60:3.037890439,t61:2.98554713):0.7919857369,t62:3.681644325):1.973144423,t63:5.641634643):0.3500688337,((t64:0.4881624191,t65:0.4693168707):0.5429378106,t66:0.8395451302):4.929772462):0.02414277284):0.7784672539,(((t67:0.5275608278,t68:0.4078968633):2.425618553,t69:2.689087512):3.06086513,(((((t70:0.2746404143,t71:0.1484331161):1.616054223,t72:1.640629574):2.172300543,t73:3.627799841):1.081147393,(((t74:0.4242482852,t75:0.1324435193):0.966262168,t76:0.8054829452):3.099127438,(((t77:0.4583727935,t78:0.255210563):0.4684902083,(t79:0.401119722,t80:0.2924565933):0.1695787257):1.554404273,t81:1.98428004):1.408363861):0.04715767533):0.05846844616,(t82:2.087849819,t83:2.033114144):1.356488015):0.5034268596):0.4562804151):0.3283044376,(t84:2.962895312,(t85:0.4903177744,t86:0.2961923749):2.208460304):1.600883665):0.2896403156):0.01998168673,(t87:2.708038031,t88:2.671906433):1.673902116):0.3744618423):0.1835068698):0.1039590101,((t89:2.6665072,(t90:1.222385449,t91:1.036316966):1.350274873):0.821125258,(t92:2.147046293,((t93:0.8254700961,t94:0.7523230813):1.254089629,(t95:1.940586448,t96:1.915101034):0.036862901):0.01943645503):1.034153508):1.402948479):0.3802041056,(((t98:1.763691328,(t99:0.2082545925,t100:0.1879414413):1.363781953):0.4701590371,(((t101:0.5129048698,t102:0.4127641511):0.610400038,t103:0.9418931716):0.5648346925,t104:1.249688065):0.272865109):0.1564657311,(t105:0.3356503945,t107:0.01142793128):1.282116203):2.007617676):1.04371448):0.05845035412):0.3482713858,((t109:1.543141981,t110:1.523789086):0.2590944958,((t111:0.4387170003,t112:0.404374594):0.5074064162,(t113:0.8304155797,t115:0.7103683658):0.07804790948):0.6982298697):2.656631261):2.648284367,(((((((t116:0.2787002516,t117:0.194180714):0.9052890275,(t118:0.4577082411,t119:0.403028248):0.5437323423):0.5243869453,t120:1.209847942):0.6397004091,t121:1.798045792):1.875214722,((t122:0.6354017455,t123:0.5588548455):1.954451119,(((((t124:1.176630882,t125:1.080095242):0.09387801283,t127:0.9540346815):0.1578462556,t128:1.107718445):0.9926973206,((t129:0.2718177327,t130:0.07632086343):0.6357508655,t131:0.3653648003):1.006132091):0.07097176973,(((t132:0.3641628284,t133:0.3398329421):0.06667456154,t134:0.3786472956):0.3950894424,t135:0.758606242):0.5674120013):0.01223973214):1.075669917):0.7147430776,((t136:0.2740708093,t137:0.2574267021):1.170383821,(t138:0.6002788953,t139:0.5971070644):0.7894882447):1.661401841):0.1452041092,((t141:0.4152334986,(t142:0.2615265141,t143:0.2510980263):0.04264298171):2.129554976,(t144:1.532961128,(t145:0.190203852,t146:0.1052775271):1.327258529):0.7920943223):0.4203853931):1.485587212):1.459309714):0.6684758102,(((((t147:0.6891257161,t148:0.6452260528):1.251099078,((t149:1.035542081,t150:0.8933900077):0.1727329125,t151:1.047545553):0.4647031435):0.8324607468,t152:2.243495825):2.759474456,((((((t153:0.4813981934,t154:0.4573226615):0.3884224794,t155:0.8390146687):0.7898123763,(t156:0.3182953937,t157:0.3028942707):1.293383951):2.303963284,((t158:0.6435594769,(t159:0.3993616513,t162:0.1197461927):0.240821019):0.5921243427,t163:0.6590123781):2.421813058):0.7085624824,(((t164:2.617070532,((t165:0.9609036234,(t166:0.7003709437,((t167:0.6393542452,t168:0.6031572679):0.0112433624,(t169:0.2181530256,t170:0.2164279405):0.3883802214):0.04221213116):0.2113997881):1.422270593,t171:2.222598846):0.1577535334):0.1866509353,(t172:2.265994843,t173:2.032462784):0.1479442112):0.263837208,((t174:1.274904704,((t175:0.4901480738,t176:0.3324487249):0.2828264271,t177:0.4951560693):0.3485634616):0.004554499876,t178:0.8178319932):1.044750242):0.4225344674):0.1639113171,((t179:0.7828385837,(t180:0.08007619983,t181:0.04143257241):0.7009326764):1.411282983,(t182:1.235148988,(t183:0.8187373458,t184:0.6282163282):0.2780806643):0.758725139):0.111835249):0.1533641251):0.3401659975,((t185:0.6954972033,t186:0.4455959198):0.3690434368,t187:0.7717585551):0.5478492968):0.2739644495):0.8703325663):2.977522949):2.259036222):3.706896615,((((t188:1.724869952,(t189:0.1527297004,t190:0.1498016977):1.461032712):0.6163550827,((t191:1.092165959,t192:0.9929547804):1.015794411,((t193:0.3299756511,t194:0.2431669538):0.2501888823,t195:0.3033706665):1.4073558):0.1096617235):1.688973183,(t196:0.6417949982,(t197:0.1789949802,t198:0.09591589036):0.4329247865):2.76032247):0.08509506045,t200:3.153853442):7.247342078):2.265009367):0.05402806995):2.278136699):1.517370931,((((t201:0.8716449481,t202:0.8676275973):3.560010683,(t203:0.5505340072,t204:0.2379194811):3.545535811):2.099077654,(t205:0.4219660393,t206:0.2562081644):5.414414128):2.870286233,((t207:3.098505724,(t208:0.4169760883,t209:0.3676378398):2.573389936):4.988300732,((t210:4.102899573,t211:3.904784402):0.2001649457,(t213:3.255871574,t214:3.230782676):0.6921159225):3.547890426):0.4179736311):7.096484371):2.507338091,((((t215:2.51774094,(t216:1.979265326,t217:1.945916576):0.4506426852):2.621079172,t218:5.016157872):1.730891178,((t219:0.242258033,t220:0.01810887852):2.197691589,t221:2.144316959):4.296310251):7.72437855,((t222:5.38755268,t223:5.17418643):0.4349633744,(t224:4.080049964,t225:4.054486856):1.427682848):8.326321983):2.667677033):3.288745138,((t226:2.589953802,t227:2.534538794):8.305092446,((t228:0.2809453223,t229:0.2024150946):6.169897727,t230:6.319625887):4.312633495):8.852293814):0.07618684377,((((t231:3.898119088,t232:3.767679935):6.046451743,(((t233:4.282172304,t234:4.264727133):2.707248926,(t235:1.11864331,t236:1.11440945):5.819250991):1.570775493,t237:8.39060359):1.176828273):3.173110984,((((t238:4.566244312,(t239:2.036337237,t240:1.968608879):2.497303272):4.156647266,((t241:3.390395428,((t242:0.7340293622,t243:0.7039402321):1.319771448,(t244:1.553576464,t245:1.503893164):0.3033621499):1.259624901):1.991843988,(t246:4.218439606,(t247:0.9867713018,t248:0.7751979571):3.035195572):0.6754900881):3.224890218):0.4796658031,((t250:4.609008754,((t251:2.101923017,t252:2.083773846):1.352414326,(t253:0.5051362117,t254:0.4825903763):2.770820909):1.084884198):3.32837663,t255:7.588884553):0.1121267802):3.460998686,(t256:3.909572612,(t257:2.124928745,t258:2.094869864):1.175331184):7.252195434):0.02308526756):6.141192541,((t259:13.17826524,((((((((t260:0.1180569937,t261:0.06187152418):2.963223716,t262:2.977901597):2.710832571,(((t263:0.4573960899,t264:0.4248224114):0.367574556,t265:0.6002309249):1.498237667,(t266:1.734215911,t267:1.727091884):0.2962597141):3.363121516):0.7595197664,t268:6.142349351):1.536620958,(t269:1.276193026,t270:1.221483651):6.344981037):0.07558995361,t271:7.55363831):4.198359428,(((t272:0.5811285911,t273:0.5701084778):2.105492134,t275:2.405341362):6.331489572,(((((t276:4.246175482,t277:4.026320841):0.1973964762,((t278:1.106015734,t279:0.7685140036):0.6074609466,t280:1.256394573):2.509424424):0.4807261905,(((t281:1.063956358,t282:1.038103889):2.454022178,((t283:1.059120991,t284:0.9508151525):0.1635550641,t285:0.8285210235):2.215372885):0.4345444112,t286:3.402663949):0.2277446412):0.5538462684,t287:4.175907683):2.114565576,((t288:2.736310157,t289:2.627124316):1.180420317,((t290:2.764712784,t291:2.71312765):0.8453867335,(t292:1.179984447,t293:1.173188559):2.226015545):0.1744009119):2.324308868):0.9416975125):2.714214518):0.4189589274,(t294:6.14569749,(t295:2.610907924,t296:2.52286025):3.450929426):3.803082558):0.1544556407):2.98150495,(t297:9.574602426,(((t298:1.60508681,(t299:0.6405571876,t300:0.5438892418):0.4505965619):2.137171336,(t301:1.117763298,t302:1.095312857):1.914989932):2.109255616,((t303:3.060056831,(t304:0.6197154491,t305:0.6171024104):2.386373559):1.820775309,(t306:1.162356515,t307:0.9878399808):3.54687141):0.2343580143):3.709615029):3.290384578):0.385195462):0.2399651826):0.2346885509):3.337280561,(((((t308:1.771489226,t309:1.572539719):3.960745896,t310:5.501955747):2.556893148,(((t311:1.661398327,t312:1.376352042):1.484116389,t313:2.80220751):2.576561885,(t314:4.467908923,((t315:0.541483465,t316:0.3352908985):2.834927503,t317:3.161608092):1.062006184):0.7671061172):2.248851885):0.581567837,t318:7.755801126):3.503469551,(t319:10.31059266,(((t320:3.758227381,t321:3.561140863):1.043023834,t322:4.463027714):1.356087446,((t323:0.4119267571,t324:0.1885740646):2.509132008,(t325:1.417865036,t326:1.308900161):1.227768481):2.886071215):4.147475529):0.7960763301):3.39037872):0.05487868421):0.4721863108):1.502925914,((((((((t327:1.76714168,t328:1.69292962):1.179153103,t331:2.550108782):2.137148095,(((t332:0.6656418268,t333:0.5468658085):0.1262733104,t334:0.122379416):3.432796512,t335:3.488202523):0.4564173693):4.823663235,((t336:0.3161959542,t337:0.2652435736):8.080095367,(((t338:1.266553425,t339:1.223757607):1.891714175,t340:3.106814858):3.577267728,(((t341:2.845692093,((t342:1.31469416,t343:1.145897937):1.346265141,t344:2.307383936):0.1776696755):1.867810873,t345:4.227840993):0.7587849563,t346:4.981753202):1.174416709):1.596546779):0.350775089):2.843654893,(((t347:7.431901301,(t348:4.159175212,((t349:1.941055936,t350:1.891996636):0.2248651057,(t351:1.167311771,t352:0.9486864517):0.9219614685):1.968286432):3.268892239):1.087564387,(((t353:0.4093570599,t354:0.2505720171):1.399510841,(t355:1.206958074,(t357:0.4214124446,t358:0.2854211609):0.7215415905):0.2869729188):2.948472497,t359:4.109991555):3.420982004):2.072241494,(((((t360:1.239902207,t361:1.208664202):2.560456502,t362:3.454022704):0.09757992563,(t363:2.807067307,(t364:2.113715095,t365:1.901899):0.6803325068):0.7004548837):2.317061732,t366:5.320686562):0.3825272387,t367:5.693574291):2.778107265):0.2372477681):1.164943939,((t368:1.068297908,t369:1.062116846):7.584221633,((t370:4.731716147,(t371:4.037559469,t372:3.724926478):0.4526338838):3.800415991,t373:7.950397374):0.065859687):1.12306867):0.7533287815,((t374:2.302307236,(t375:0.8651559994,t376:0.8161036566):1.429192155):4.47561848,(t377:1.299449255,t378:1.230062967):5.216166478):3.080407166):0.8832167521,(t379:0.5599410442,t380:0.5400725297):9.649373238):0.06296795582):1.771778335):2.108914983):1.395812415):0.527913657,(((((t381:2.595696433,t382:2.563253212):4.072679794,(t383:1.16568121,(t384:0.7463678156,t385:0.7141295804):0.398514066):5.426548776):0.1127728176,((t386:1.540678056,(t387:0.5172292016,t388:0.5053863524):1.000496845):2.255726489,t389:3.500000248):2.722298993):4.42675805,((t390:4.497010947,t391:4.200630212):1.784480086,(((t392:1.764071908,t393:1.718610217):1.623282947,t394:3.078081255):1.171337432,(t395:3.497931619,t396:3.23460949):0.6535629908):1.420714902):4.319070172):0.6942542411,(((t397:0.6136444217,t398:0.5847677874):4.542706586,(t399:3.395318763,t400:3.190824257):1.57350996):1.32477541,t401:5.791536985):3.769291865):4.054938408):10.54404551,((((t402:0.7897647497,t403:0.7012608907):0.3569270753,t404:0.9142226924):6.34011159,(((t405:4.737918223,t406:4.491181167):0.5301852964,(t407:4.421256929,(t408:2.212171651,t409:2.178406992):2.197791726):0.5705178488):1.405699432,((t410:2.000458835,t411:1.987011927):2.258392804,((t412:0.6216505841,t413:0.3709888431):2.925809619,(t414:1.579464622,(t415:0.09011648754,t416:0.07950015152):1.41675067):1.706063095):0.6438576976):2.04502705):0.3133192868):12.37857593,(((t417:1.749408492,t418:1.726581687):6.573904708,t419:8.155701529):3.745268629,t420:11.66563264):6.409857347):4.185348866):14.99409324):10.74870124,((((((t421:1.036679247,t422:0.9747128915):2.546392367,((t423:0.03483485909,t424:0.02658172151):2.425735574,t425:2.419370632):1.000880396):1.975861238,(t426:1.496778984,(t427:0.3011753213,t428:0.2335309949):1.161624803):3.869523292):12.957676,((t430:6.638279756,(t431:4.944620771,t432:4.885958431):1.631501865):3.178754675,((t433:1.270980525,t434:1.26480212):3.296976366,t435:4.518340264):5.062432899):8.108031361):1.608226516,(((t436:3.180552302,((t437:1.4465709,t438:1.257377):0.3782352798,t439:1.592033375):1.210914481):1.234009918,((t440:2.366897951,t441:2.34789313):0.2944071489,(((t442:1.411172319,t443:1.358213136):0.1374436987,t444:1.445993501):0.5671941345,t445:1.882639298):0.3658076767):0.7533913869):1.595760483,((t446:1.850914773,t447:1.818406872):2.230829067,t448:4.047093688):0.4961602651):13.2849801):7.387906659,(((t449:4.811013246,t450:4.586384397):6.270211362,((t451:0.8672555751,t452:0.76240857):7.083451361,(t453:5.315690312,t454:5.056757655):2.505318398):2.727824005):1.866136254,t455:12.11620725):12.17773205):20.39855302):61.48895777);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T31.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
