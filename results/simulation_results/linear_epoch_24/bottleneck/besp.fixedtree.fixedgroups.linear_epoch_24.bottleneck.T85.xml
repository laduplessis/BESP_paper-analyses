<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t460:17.07988357,((((t461:1.023066125,t462:0.8727501557):0.7215911602,t463:1.538513356):0.739895045,t464:2.158675955):5.016699186,(((t465:0.6687607574,(t466:0.2223626998,t467:0.09300380463):0.1168632709):1.238389158,t468:1.218983833):4.712221564,(t469:3.610146849,t470:3.391851027):2.130559285):0.4687976619):9.500147572):11.87393228,(t471:16.79555025,(((t472:1.304837326,t473:1.284435801):0.5213978155,(t474:0.1639977732,t475:0.1208198924):1.526253993):7.101919965,(t476:3.777666421,(t477:2.956556123,(t478:2.611783596,t479:2.448963224):0.2388251619):0.6769818594):4.939684467):7.808867744):10.54838933):4.466971966,(t480:24.40638964,((t481:1.278013998,t482:1.250090711):15.80204714,(t483:9.514412537,((t484:0.392531975,t485:0.3784120161):4.300944136,t486:4.642792535):4.775264381):7.519250401):7.206852376):6.636707673):21.11640184,(((t487:2.33089071,(t488:1.191725045,t489:1.067815555):0.7894586319):1.808441378,t490:3.538743749):6.910376678,(((t449:0.2100024861,(((t376:0.2923200329,t377:0.1655265292):0.1065413404,((((t247:0.1204758616,(t219:0.05774817572,((((t179:0.01852376754,(t164:0.05446954608,((t135:0.08788132565,(((t127:0.06952471326,(t114:0.0613899134,((t108:0.04485370928,(t101:0.1614825383,(t1:2.538379493,t2:2.438635026):7.436689294):0.5508074326):0.3738235699,((((t3:4.014636231,(t4:3.274705396,(t5:2.550494818,t6:2.26484616):0.5445322789):0.6826046828):1.545183039,t7:4.974270836):0.2998794213,t8:5.203023482):3.988611603,(t9:2.001491959,t10:1.996092222):6.946353787):0.8605724061):0.04688342072):1.661669194):0.4401109455,(((t11:8.870643291,((t12:6.560577004,t13:6.55774271):0.9149747361,((t14:2.159118067,t15:2.057741541):1.159217973,t16:3.082606781):4.013218555):1.194846744):0.390246613,(((t17:3.825136731,(t18:1.184571075,t19:1.165664564):2.574390424):0.3962718115,t20:3.986381872):3.560374279,(t21:2.247101205,t22:2.198713017):5.288932135):0.7151085732):0.1389795315,(((t23:7.142393272,(t24:3.373982928,t25:3.254485082):3.746917634):0.8261434338,(t26:0.8381252031,t27:0.5543316378):6.969021861):0.1819068386,(t28:7.476305938,((t29:2.30203083,(t30:0.2560113101,t31:0.1485048272):1.967173478):4.83467489,t32:6.913185162):0.2825655857):0.1120947059):0.09820269283):2.539189246):0.0445619845,((((t33:6.837055804,((t34:1.908883089,t35:1.849848758):4.850557218,(t36:0.239643075,t37:0.09260888995):6.418082898):0.01494351325):1.526120354,(((((t38:0.1012094848,t39:0.08178715483):6.416322975,((t40:3.795041462,t41:3.566199324):0.70510951,(t42:3.27769171,(t43:0.840322031,t44:0.8129243258):2.409098351):0.7639067249):1.887982807):0.1091544748,((t45:3.170038571,(t46:0.7259168677,t47:0.4461025126):2.406129311):0.6600896006,(t48:2.409480304,(t49:0.3768863717,t50:0.1013028158):1.941925391):1.073196907):2.031058464):0.08630692012,((t51:3.918040472,(t52:0.8301947303,t53:0.527251577):2.986745177):1.242444496,(((t54:0.2415036833,t55:0.2412882227):2.156754751,t56:2.317463928):1.370991502,(t57:2.616291583,t58:2.411442618):0.9507094558):0.9752823169):0.02387195163):0.38981096,(((t59:3.803200892,(t60:0.3159890982,t61:0.06289658849):3.353346967):0.5449815512,(t62:3.751339308,t63:3.646991977):0.04502042613):0.3827144935,(t64:0.6227538888,t65:0.4612567):3.247340653):0.009769105043):0.9086508326):1.310933742,(((t66:1.594444792,t67:1.239182415):0.1273406455,t68:1.353483782):2.883896385,(((t69:2.49420728,t70:2.274508):0.4342153309,((t71:0.5652842035,t72:0.4329108775):1.921529879,(((t73:2.228690131,t74:2.181434859):0.02445005776,(t75:2.175336969,t76:2.170951399):0.02196955237):0.04226655834,t77:2.164511136):0.0477359437):0.215477672):0.1252826211,(t78:0.4369963873,t79:0.2862430992):2.103143457):0.8787030076):1.306136617):0.1634863918,((t80:3.824068555,(((t81:0.3543470582,t82:0.2887241436):1.893312189,(t83:1.707659981,t84:1.676600214):0.25352017):0.8244882373,((t85:0.09069454421,t86:0.002914110036):1.15104328,t87:1.095875782):1.447577519):0.7511812527):0.1397984377,((((t88:0.8838944155,t89:0.833849484):1.306890949,(((t90:0.09814817438,t91:0.05872383973):0.8487542351,(t92:0.6892379598,t93:0.6164218533):0.004702544045):0.607682565,((t94:0.8105854948,t95:0.800259711):0.02457020128,((t96:0.504112006,t97:0.4023761631):0.06633786128,t98:0.3626698721):0.1005740203):0.3909210294):0.5643620483):0.006330100725,(((((((t99:0.157655932,t100:0.1074198186):0.179316148,t102:0.04499680156):0.07609584052,t103:0.07862726122):0.3254135254,t104:0.3866493308):0.3139882598,t105:0.6781181702):0.1695041619,(t106:0.7537294233,(t107:0.4918582249,(t109:0.1851740168,t110:0.1356508136):0.006613460846):0.1603000111):0.0641078419):0.1026999907,t111:0.3992937708):0.06505500008):0.2616916866,(t112:0.3344139736,t113:0.3144268831):0.3541467116):0.8808262783):0.6870961774):0.1299007597):0.3481582805):2.013396916,((t115:0.6096250956,(t116:0.3094989179,t117:0.1876365586):0.1905962377):1.043142593,((t118:1.092694009,(t119:0.5214689579,t120:0.1854624264):0.4720351602):0.0101353246,t121:0.5572963747):0.2132329161):2.576118611):0.5141326596):0.8807050159):0.3581838242,((t122:4.17884158,((t123:1.724357246,(((t124:0.2983474886,t125:0.08575402771):1.327656807,(((t126:0.1133727744,t128:0.02221387999):0.2487129315,t129:0.1939151555):0.5827678408,(t130:0.2433063542,t131:0.166266644):0.3149382467):0.3870598552):0.02391797607,t132:0.8180415241):0.0006191475791):1.994402859,((((t133:0.3890837028,t134:0.1998549459):0.5749922609,(t136:0.4306141525,(t137:0.1644797296,t138:0.1271235066):0.04395602795):0.07670374188):0.8656675227,t139:1.064038792):0.02051521393,t140:1.034733083):0.8914734314):0.4158618783):0.846899561,((((t141:0.2554583698,t142:0.2157787298):1.459536394,t143:1.651766):0.7105528235,((t144:0.7698919781,t145:0.7648206836):0.981972774,t146:1.64382706):0.4267646366):0.6985925846,((t147:0.08589830836,t148:0.07230959953):1.234037478,t149:1.284078857):1.438430709):0.01906396537):0.06031514191):1.540397604,(((t150:0.8261205175,t151:0.7764242615):0.2956985975,t152:0.8815938301):2.018349156,(t153:1.558198688,(((t154:0.2385753549,t155:0.07010506393):0.4270414657,(t156:0.4649038298,(t157:0.2004625711,t158:0.1494930957):0.2210170495):0.0321279669):0.3812123027,((t159:0.3266801978,t160:0.04917857276):0.00218629183,t161:0.008494116272):0.430954804):0.4368519803):1.250356254):0.9131728401):0.473612806,(t162:2.719354303,((t163:2.159770401,(t165:0.1980470652,t166:0.1634481834):1.706708026):0.3961055128,(t167:0.915818629,((t168:0.2072679172,t169:0.174873298):0.3544380649,t170:0.4691911588):0.3322130642):1.34378441):0.1367522711):0.6628900703):2.167920124):3.063545647):1.952707049,((((((((t171:0.5323168509,t172:0.5136768212):0.03338296122,t173:0.4479899156):1.000476375,((t174:1.094877263,(t175:0.4721431643,(t176:0.2897543921,t177:0.1725148894):0.1777207749):0.499251123):0.2495330181,t178:1.089007896):0.008164703209):0.6074936897,t180:1.604203292):1.132135483,(t181:1.703316367,(t182:1.34194622,(t183:0.9016281348,(t184:0.3403416689,t185:0.3328865081):0.3630441433):0.294609714):0.1830140207):0.8270343734):2.227849671,(t186:4.004820411,((t187:1.384794024,t188:1.384009591):1.674116167,t189:2.768552139):0.7474742431):0.1305672547):3.282848088,((t190:1.142309687,t191:0.7668583926):4.310703572,t192:4.971912855):1.351904944):0.07436251411,(t193:4.888094645,(((t194:0.4452994957,t195:0.3118228039):0.1020854927,t196:0.3907154667):1.857704298,(t197:1.576297762,t198:1.40985393):0.5604726129):2.177620358):1.49223155):1.197795769):6.996955848,t199:13.82581821):0.7006635379,((t200:11.43988808,(t201:8.957221922,(((((t202:2.215557928,t203:2.136125568):3.422918402,t204:5.456069426):0.7192131829,(t205:2.691492875,(t206:1.258042219,t207:1.199333469):1.430978471):3.15780452):0.2402610246,((t208:0.7220938392,t209:0.6477441262):3.257937453,t210:3.812508651):1.935718726):0.4498906678,(t211:2.406055654,t212:2.266864624):3.707628704):1.779053185):2.445032798):0.6881256525,((((t213:3.134308987,(t214:2.972581071,t215:2.965976386):0.08714738011):3.572174481,((t216:4.309036853,t217:4.2424401):1.234945981,t218:5.462919394):1.061154549):1.482112337,((((t220:0.07545798206,t221:0.06818717):4.49550933,(t222:2.210501286,(t223:1.373545877,t224:1.346633926):0.4696587835):2.32760254):1.568750245,t225:5.626199243):0.9768817359,((((t226:0.6715782767,t227:0.6366179071):1.017536912,t228:1.652142765):3.255915662,t229:4.765099647):0.140583971,t230:4.755946836):1.475397187):0.6879905413):1.710093501,((((((((t231:1.248360487,t232:1.184101658):0.554798084,t233:1.589376942):0.9065393751,t234:2.370740323):0.3394910106,(t235:0.6363887826,t236:0.5879679985):1.870222212):0.3208051126,t237:2.772555437):2.820532463,(t238:0.1465355318,t239:0.1350058757):5.227915978):0.4597194447,t240:5.548084804):0.1462027948,t241:5.589861284):1.779013822):0.7374343642):2.37376199):2.078112318):7.233754875,((((((t242:5.161147047,t243:5.101712992):1.286640651,t244:6.159118982):1.416990743,(t245:7.234382568,t246:7.213923283):0.1813454711):0.9382613815,(t248:1.283374171,t249:0.9356028088):6.695581125):0.1648153802,(((t250:0.6266383311,t251:0.5708697849):1.445958051,t252:1.900102739):0.8326337868,t253:2.73236661):4.824801715):7.412525724,(t254:7.807885947,(((t255:2.06580187,(t256:0.3509039736,t257:0.3433418187):1.630246272):1.881619839,t258:3.805319161):1.106501054,t259:4.863386236):2.742525334):7.148305622):3.389869496):0.6417308799):5.403977656,(((((t260:3.906620297,(((t261:0.2193247239,t262:0.1306229491):0.328913895,t263:0.2000963582):2.742164671,(t264:0.6121377572,t265:0.6015734663):2.071751866):0.6156139885):2.451922096,t266:5.655511755):0.3932977219,t267:6.048397938):1.741845698,t268:7.771536597):13.00159342,(((((t269:4.344656031,t270:4.319238091):1.138273223,t271:5.435940984):1.731546919,((((t272:1.83820473,(t273:1.298973797,t274:1.203139807):0.4881213461):0.9070477579,((((t275:0.60702232,t276:0.3004798382):1.204608463,t277:1.483017782):0.06135489959,t278:1.43136331):0.05832587779,(t279:0.3470081716,t280:0.3327919046):1.121259077):0.6567644273):0.1598898179,(t281:1.549009292,t282:1.392184813):0.6569112037):2.340213144,(t283:4.03291503,(t284:0.5369438111,t285:0.5217173851):3.450832004):0.1069736867):1.88433715):1.799520829,(((t286:1.250931681,t287:1.222038664):6.07884924,((t288:2.536142026,t289:2.409660185):4.506341464,t290:6.861561136):0.06323917387):0.1976432602,((t291:1.043288713,t292:0.7773871787):2.81189668,t293:3.582029534):3.222627394):0.008006301403):10.48180786,((t294:1.88600508,(t295:1.587269201,t296:1.374366872):0.2619703216):7.535363176,(((t297:2.095680387,(t298:0.9895693729,t299:0.8846150604):1.1011612):4.508957777,t300:6.394447901):1.768369618,t301:8.053160116):0.616313129):7.74309033):1.223828243):2.524051164):2.702502624,(((((((((t302:3.895678268,t303:3.854041355):0.8526559947,t304:4.588705897):4.336602521,(((t305:1.974302486,t306:1.839071303):0.8014224904,t307:2.598305529):1.520455997,(t308:1.459017234,t309:1.422208414):2.653289901):4.424388366):0.7904304597,((t310:3.951433418,(t311:0.639062438,t312:0.6383641798):3.272757506):4.460356506,(t313:5.49215655,t314:5.195119591):2.841266369):0.8754787102):0.6810752663,(t315:0.4456376229,t316:0.4139507223):9.116622825):1.365940939,((t317:2.389411652,t318:2.323599186):3.846254687,((((t319:4.518979871,t320:4.416286704):0.3652159206,t321:4.73723767):0.01231316729,t322:4.713100437):0.3639882007,t323:5.045705038):0.7753745332):4.647521672):3.954494303,((((t324:2.862859724,t325:2.862806501):3.424251742,((t326:3.044170333,(t327:2.438588751,t328:2.417386664):0.2517400831):2.436615729,((t329:1.175982511,t330:1.144504623):2.193912989,t331:3.319429188):1.688715498):0.7801645556):4.461013224,(t332:2.600789085,((t333:0.1138956014,t334:0.02410119616):0.8349980863,t335:0.8410882456):1.63927071):7.581765002):0.9661496656,((t336:9.841744347,((t337:0.6439882833,t338:0.6231305645):4.127026625,((t339:0.3061955595,t340:0.1803611037):3.316652599,((t341:1.206666675,t342:1.137743141):0.8873647277,(t343:0.7300235392,t344:0.5556878691):1.157730584):1.35331162):1.11092159):4.996049959):0.6332909249,(((t345:3.128461835,t346:2.505982765):1.758521268,t347:4.194096736):1.665713756,(((t348:1.555419682,t349:1.443722862):0.8272092844,t350:2.222013939):3.411384022,((t351:2.440192459,t352:2.427297011):2.224884601,t353:4.529149887):0.9514307391):0.06419962836):3.085704025):0.5386679533):2.425355631):1.704092203,((t354:5.601311543,((t355:2.534234038,t356:2.495131034):0.4124749697,((t357:1.194258336,t358:1.177733555):0.5327714942,t359:1.623520585):1.031363538):2.638280966):2.0794137,((((t360:4.893649562,t361:4.840682762):1.116232225,((t362:2.024436345,t363:1.959388885):0.83913653,t364:2.717611394):3.048500689):1.240332199,((t365:2.046915914,(t366:0.5108197441,t367:0.2981416865):1.246646406):1.924794715,t368:3.442893137):2.866831894):0.003150836339,(t369:2.50163281,t370:2.489688928):3.686472877):0.1103806864):5.598903813):1.481313579,(((t371:2.731616454,t372:2.547216834):6.118721477,((t373:2.540748819,(t374:0.8159082456,t375:0.7625924399):1.666742831):1.143292324,((t378:1.146208218,t379:1.104523486):0.8680146512,t380:1.894617137):1.094309713):4.892970541):2.997646796,(t381:1.801753463,t382:1.73563515):9.062431901):1.356954227):3.613004295):6.214042944):40.82584244):40.21391141,(((t383:1.114304812,t384:1.099890571):11.85313676,((((t385:1.551691585,t386:1.312801076):0.4471873539,t387:1.395843076):2.959963437,t388:4.261055647):6.800894033,((t389:0.7052751822,t390:0.5943009151):1.032220887,t391:1.600479938):9.100170989):1.160976043):52.27229619,((((t392:0.4853887774,t393:0.3980335465):5.338574798,(t394:3.32573622,t395:3.207533547):2.401354596):5.020528485,((t396:6.58119824,t397:6.568118211):1.748181473,t398:8.136667065):1.822023073):8.908587819,((t399:15.4631281,((((t400:2.783091555,t401:2.778342686):3.065609974,t402:5.829207612):2.553374051,((t403:4.255870791,((t404:1.112039521,t405:0.9516895626):2.423302683,t406:3.364756352):0.6039622897):3.57014355,(t407:4.589970211,(t408:1.368880674,(t409:1.345087382,t410:1.342913726):0.008271455291):2.926524989):2.895921523):0.3999629992):4.890381183,(t411:3.390850006,(t412:0.448681876,t413:0.2735428912):2.815039607):9.01923944):2.169466616):0.5210968152,(t414:2.196887527,(((t415:1.023570193,t416:0.6972512971):0.1809777318,t417:0.8442865218):0.2902815634,(t418:0.6752840081,t419:0.4225468376):0.3750703761):0.6407126184):12.58304852):2.676902958):44.34521498):37.68715009):30.63399619,(((t420:2.160640217,t421:2.144039829):1.22538293,t422:3.332664651):15.95948241,(((t423:9.285465915,(((t424:0.3579105852,t425:0.2527330127):0.5255291838,t426:0.7450970434):1.890034388,(t427:2.233905191,t428:1.894464952):0.3855182777):6.473397814):2.554883236,(((t429:5.47805322,(t430:5.28408831,(t431:2.803364141,((t432:1.597011972,t433:1.531429468):0.1656351099,t434:1.648512473):0.7367963922):2.391444491):0.1599508059):2.659439312,t435:7.449073821):0.1607786399,((((t436:0.1623174803,t437:0.08342978118):2.08512128,(t438:1.470230721,(t439:0.935488408,t440:0.8882454685):0.5029410556):0.6808169175):1.744473715,(t441:3.53042119,t442:3.39734576):0.2859735205):2.815613294,(t443:4.744703647,(((t444:1.609081284,t445:1.533337184):0.1792128296,t446:1.425994858):0.9700012436,(t447:0.9694839073,t448:0.8818121236):1.355939723):1.978409154):1.391819636):0.7602654671):2.590087463):1.701457835,(((((t450:0.2894996616,t451:0.279660966):3.001186114,t452:3.184857668):1.54986091,(t453:1.372011895,t454:1.340214261):3.355448512):0.1833539566,(((t455:1.010520022,t456:0.9774108205):1.427272244,t457:2.285869687):2.237519967,t458:4.474534595):0.157432244):2.164864635,t459:6.763684217):3.061734784):5.72724083):109.9815446);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T85.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
