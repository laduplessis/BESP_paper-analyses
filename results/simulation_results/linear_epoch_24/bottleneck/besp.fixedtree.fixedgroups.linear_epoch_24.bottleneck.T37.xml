<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t458:4.719180108,t459:4.640591084):7.298966561,((t460:6.658993775,t461:6.619479837):2.252697689,((t462:2.421709799,t463:2.225747014):0.5200443678,t464:2.414684202):5.815559726):3.025753177):169.1691769,((((t465:15.38682015,(((t466:0.7347412177,t467:0.1945508609):7.692153671,t468:7.803908338):4.316242637,(((t469:1.49086926,(t470:0.388806288,t471:0.3864887807):1.090257851):3.363797196,t472:4.823896624):3.120085066,((t473:0.1375595674,t474:0.03469012846):1.878500717,(t475:0.06012224916,t476:0.02375938275):1.727750627):5.561404684):4.083851344):2.612493692):36.16081233,((t477:2.612115494,t478:2.424962597):0.1318674535,t479:2.515468937):47.37348707):12.38272036,((((((((((t480:0.3352981855,t481:0.3165036215):0.2270347807,t482:0.5063794249):0.9533269527,t483:1.397456208):1.751271456,(t484:1.306706344,((((t347:0.1336247356,t348:0.08223088857):0.07359301188,(((((t236:0.01111519895,(((t210:0.002205622336,(t207:0.04249575844,(t203:0.02435423275,(t199:0.115117507,(t200:0.01439965806,((((t163:0.07997132101,((t142:0.2333175409,((((t115:0.03477378393,(((t1:2.297574221,(t2:1.868822042,(t3:1.563250835,t4:1.52071907):0.2224973882):0.3645935937):0.770825466,t5:2.796598432):6.951105867,(t6:5.976167493,(((t7:4.664939328,(t8:2.513472852,t9:2.482116269):2.09888684):0.4755184664,(t10:4.105712869,(t11:0.4452798148,t12:0.4430168509):3.466513024):0.945107927):0.3970740675,t13:5.079597458):0.3929108155):3.701442683):0.1581826113):2.363589135,((t14:9.306403185,(t15:3.475286528,t16:3.361506064):5.797748752):0.5899970855,((t17:0.1065498487,t18:0.09447972277):9.090753273,(t19:6.696895416,t20:6.533543472):2.361575768):0.545670757):1.787457846):0.5417772483,((t21:4.886603714,t22:4.785817529):5.392229561,((((t23:1.718762856,t24:1.662833963):4.65754932,(t25:3.034471385,t26:3.008379561):3.03391707):2.273970494,(t27:7.737947172,((t28:5.69981631,(t29:4.085818368,(t30:3.735902748,((t31:1.041481384,t32:1.009136912):0.1749190325,(t33:0.2712381156,t34:0.2490244293):0.7184603825):2.517986963):0.2262935333):1.462519268):1.672027416,((t35:3.687478415,t36:3.473514257):2.284113905,(t37:2.253555197,t38:2.220611039):3.188693962):0.7404839398):0.3653244334):0.3605088793):1.189152142,(((((t39:0.9340599437,t40:0.9077872813):0.3543990038,t41:1.244841781):5.425808904,t42:6.6139983):0.5332446325,(t43:6.710211038,(t44:4.855232588,((t45:0.9267182383,t46:0.8765427177):0.6457977409,t47:1.521694611):3.278625159):1.650861848):0.3896134624):0.7445135625,((t48:4.000372734,t49:3.984092283):3.146371019,(((t50:6.325994952,((t51:3.141406751,t52:3.084990916):0.914361165,(t53:3.588026402,t54:3.505498952):0.3450555643):2.181135786):0.01489386445,(((t55:1.994178674,t56:1.926782059):0.6813345538,t57:2.296914913):0.3055276388,t58:2.601887826):3.053537326):0.1798765375,t59:5.433329603):0.6012828297):0.3868608403):0.05301875048):0.2309355666):1.483433142):0.01942345647,((((t60:2.128974268,(t61:1.132683347,t62:1.131230196):0.8492044236):3.80897515,(t63:5.467814248,t64:5.28771885):0.2363076422):0.09084228511,(t65:4.347896201,((((t66:2.242703347,t67:2.230669658):0.01460159058,t68:2.104666754):1.73074259,(((t69:2.046278844,(t70:0.7144103359,(t71:0.6209717914,t72:0.5376574448):0.02984617803):1.310070519):0.7564053938,(t73:1.29000962,(t74:1.02410421,t75:0.93081509):0.2213308795):1.33207551):0.1732263046,(((t76:0.5834692871,t77:0.4188757707):0.1684117289,t78:0.58515633):1.642670808,t79:2.207339378):0.2200619378):0.8507015971):0.04857576993,(t80:0.3956112346,t81:0.2755662521):2.821027281):0.1299367643):1.163541355):1.226615052,(t82:3.127846373,t83:3.047767284):2.471648887):0.5016577105):0.7493624681):1.28784534,(((((((t84:0.3139392014,t85:0.2513199353):3.255264817,((t86:1.344532431,t87:1.31531042):1.8406356,(t88:0.3154089028,t89:0.301023481):2.676061031):0.3170719686):0.5874999498,(t90:2.282048847,t91:2.231951336):1.533468611):0.324426348,(((t92:2.436136781,(t93:1.261828767,(t94:0.4341757632,t95:0.2192252016):0.7110123601):1.167884799):1.148836986,((((t96:0.1105504859,t97:0.06316419497):1.442148116,t98:1.479610872):0.2960411377,(t99:1.406631534,t100:1.204553226):0.02993142749):0.4951416434,t101:1.065966863):0.7801582756):0.1718232397,((t102:0.5592943581,t103:0.49216487):0.2568560926,t104:0.7466704427):1.193372074):0.02673527493):0.3061052131,(((t105:0.6352750235,t106:0.5904059242):0.4122922585,t107:0.9763767813):0.1100619287,(t108:0.3536291467,t109:0.2820278373):0.7323629746):1.114928079):0.2203478815,t110:2.261001269):2.708769109,(((((t111:0.1834100597,t112:0.1039168635):0.0733049194,t113:0.1609859634):0.04917077113,t114:0.197980822):0.4932645696,(t116:0.4097673271,t117:0.1632047647):0.02094253134):1.407364352,(((t118:0.2555032016,t119:0.2537431793):0.0250396552,(t120:0.02646226955,t121:0.01402211009):0.04698057674):0.2443585234,t122:0.304390583):0.8825981987):2.743177663):0.3403077577):0.1209665908):1.036463479,(((t123:1.14993885,((t124:0.4896368818,t125:0.3206911162):0.5187058307,(t126:0.2698588397,t127:0.2458723153):0.5689041387):0.02524473465):0.2208078079,t128:0.9763849762):1.89958927,((t129:0.4564168297,t130:0.3634595608):1.028917866,t131:1.255191874):1.321605804):2.021991568):0.2305942788,(((((t132:1.59818719,(t133:0.5452453485,t134:0.357374508):1.01517541):0.9196847443,(t135:1.32836195,(t136:0.5111979476,t137:0.1432262256):0.8144279893):0.7724795053):0.1169164394,(t138:0.3170288299,t139:0.2869180437):1.231177752):1.250115846,(t140:2.289155757,t141:1.900024367):0.3524363775):0.3334359861,((t143:0.7678457712,t144:0.6828874782):0.6677471466,(t145:0.1735276382,t146:0.1003162342):1.134612077):0.6843244152):0.5262692834):0.9593260109,(t147:2.497821798,((t148:1.667937191,t149:1.606053437):0.07625203625,t150:1.65115075):0.6629308938):0.8958660846):0.6559386925):0.08141101598):0.3780245435):0.2138173556):0.09988372006):0.2482987655,((t151:1.046344888,((t152:0.3297102972,t153:0.1765617043):0.3842093502,(t154:0.5007764555,(t155:0.09220560357,t156:0.0003201658517):0.3699196072):0.006610150192):0.3299451155):0.3996585164,(t157:0.6566596875,t158:0.6037013299):0.294754315):3.420942584):0.8327205059,((t159:1.527998574,((t160:0.3596474921,t161:0.3166422096):0.9980868961,t162:1.264927959):0.1649463423):1.697745809,((((t164:0.1107827565,t165:0.02931790425):0.6638379791,t166:0.630658126):0.6251089202,t167:1.140206229):0.5814711644,(t168:0.731833034,(t169:0.3248358762,t170:0.2996299776):0.2479928942):0.8275713716):0.7054533526):1.856010934):2.061561582):4.071890665,(((t171:2.093079171,((t172:1.161806026,((t173:0.76123822,((t174:0.6308560479,t175:0.5665606707):0.05346999151,t176:0.5869587187):0.01718792146):0.1567775495,t177:0.7374029749):0.1674565343):0.4926051817,t178:1.291896497):0.3216337903):0.09348051607,t179:1.673982663):1.215825651,((t180:0.2059278378,t181:0.160353773):0.8988811617,(t182:0.76192,(t183:0.6430881613,t184:0.5223793888):0.04023254544):0.2010651285):1.767559816):6.656079465):3.63399938,(((((((t185:0.820644191,(t186:0.3530383617,t187:0.3192759332):0.3846657566):0.9099806029,(t188:0.4761213827,t189:0.4410042538):1.11161137):0.5900212376,(t190:1.208827032,(t191:0.3602669468,t192:0.3010508759):0.6993767503):0.8513573064):0.4474902016,(t193:1.910920391,((t194:0.2284145381,t195:0.198363818):0.4485426195,t196:0.6345506448):1.210810124):0.3717695548):0.1094636965,t197:2.174931017):1.655778,((t198:1.193323713,t201:0.8817463063):0.0466699691,t202:0.7775120116):2.378514001):2.691084361,t204:5.628827871):5.511954608):3.962713537,(t205:1.273882926,t206:1.266684584):13.75751905):0.471288692,(t208:0.7569918301,(t209:0.06426535238,t211:0.0189968922):0.6777520014):14.54846591):0.003040518818):3.100040685,(((((((((t212:0.1027092218,t213:0.05980219243):2.429431936,(t214:0.9069792805,t215:0.8754046591):1.475816139):0.9308322217,(t216:0.1773848905,t217:0.1144793428):2.770227452):1.074018419,t218:3.682338124):5.957523918,(((((t219:1.295877241,t220:0.9749941374):2.388484113,(t221:0.367519124,t222:0.3194511407):2.872472633):3.574259517,t223:6.709672115):1.839234994,(((t224:2.140933475,(t225:1.227167409,t226:1.200214):0.7461093704):2.471289595,((t227:2.739505227,t228:2.64579116):0.4244942321,t229:2.969801999):1.092310426):0.6441395017,(t230:1.998292839,(t231:1.081017243,t232:0.9914841631):0.8964399104):2.60836915):3.118797883):0.3108623953,(t233:5.444036542,((t234:3.181690845,t235:3.079622635):0.1824103806,(t237:2.09319924,t238:2.016771377):0.9209375951):1.859002577):2.455637234):0.05456446557):2.167925852,((t239:2.269329204,t240:2.263432464):1.202549425,t241:3.456167102):5.818106438):0.7528865032,((t242:0.3684258588,t243:0.2786944966):1.021048874,t244:1.171201967):8.581176872):3.547405556,(((((t245:2.492174462,t246:2.465092634):4.101875653,(t247:0.9645144374,t248:0.7743553792):5.045237239):3.515759959,((t249:0.7241511668,t250:0.539567156):3.441166239,(t251:2.549944533,t252:2.526584575):1.416563548):5.127042515):0.2017171471,(t253:8.824831483,(t254:0.2313260956,t255:0.1336970696):8.341006295):0.4093751417):1.883256222,t256:10.73080886):0.7008286605):0.3773065073,(((t257:1.332842852,t258:1.103889582):2.322331156,t259:3.321108713):3.114640965,(t260:6.22380432,(t261:2.193995626,t262:2.167179891):3.970946115):0.02497748716):4.975849003):0.9739022932):1.348586418,(((((t263:1.446693726,(t264:1.162841893,t265:1.131132679):0.2450911156):8.496429409,((t266:2.031677758,t267:1.756733817):1.287483065,(t268:1.752021402,t269:1.579988858):0.7107520552):6.36427141):0.527541489,((t270:4.414150515,(t271:1.625963064,(t272:1.305404905,t273:1.119364815):0.1945107183):2.525103693):4.319669128,(t274:7.957313922,((t275:0.8389240544,t276:0.5338176841):4.988754117,(t277:1.663238771,((t278:1.328534533,t279:1.25499442):0.07735698107,t280:1.311122118):0.2377061302):3.813612351):1.936474459):0.03754988628):0.3943676228):0.8304316659,(t281:1.895142585,t282:1.819528617):6.651069934):0.1401618647,((t283:3.824241125,t284:3.583162555):2.391690053,(((t285:3.397010087,t286:3.28517748):1.474215942,(t287:1.375571566,t288:0.6857739003):3.218424913):0.9253686343,t289:4.764442345):0.1544950655):2.347706509):2.004401999):10.57708943):1.811310558):3.37116068,((((t290:4.65609615,((t291:2.830950607,(t292:1.263571001,t293:1.24031477):1.478877435):1.390781332,t294:4.064224499):0.333771407):1.274934494,t295:5.344747744):8.218301366,(((t296:7.034342859,t297:6.94456217):3.456913698,((t298:0.4667680773,t299:0.4369992877):4.496391815,(((t300:1.526856515,(t301:0.8772233121,(t302:0.4192626449,t303:0.4000655455):0.2874105486):0.5241363976):0.3873281533,t304:1.334929585):1.456798248,t305:2.78910729):1.534565985):5.389435558):1.748661289,((t306:2.323008828,(t307:1.206127037,(t308:0.6187828285,t309:0.4687836309):0.5019747283):1.05595345):0.4759979913,(t310:1.384247355,t311:1.245056877):1.089432396):8.539523159):1.148992087):0.3093179068,((t312:0.0862176076,t313:0.05030639865):8.312758035,((t314:1.560852524,t315:1.534743822):6.476014671,((t316:0.9494614156,t317:0.8101966979):5.906690072,(((t318:4.346677999,t319:4.160850317):0.3650617851,(t320:4.017166958,t321:3.986319588):0.424170295):1.690448816,t322:6.021708205):0.3011283464):1.153729901):0.2588740496):3.822409476):10.41847081):0.2634222507,(((t323:0.2181459518,t324:0.08376563679):1.84757552,t325:1.775913683):19.95795952,(t326:9.032022237,(t327:2.651235781,(t328:0.3143160846,t329:0.3033713894):2.24820131):6.354709924):12.6898309):0.1088686152):13.39947072,(((t330:5.030648646,((t331:1.604641477,t332:1.575175111):0.4675889415,t333:2.00421638):2.896212274):3.687349883,(t334:3.374590414,((t335:0.3469126261,t336:0.3323360592):0.1735065726,t337:0.3794864198):2.822907314):4.991207185):1.428289745,((t338:7.682650751,(t339:5.32068276,((t340:1.429570607,t341:1.382184588):1.377729707,(t342:1.748963322,t343:1.733360251):1.008044224):2.421959924):2.303386002):1.132898025,(((t344:1.185685648,t345:1.11223357):1.873457001,t346:2.955999877):5.078359052,((t349:1.969140458,(t350:0.7851868863,t351:0.7709544999):0.9995124219):5.113226663,((t352:3.345865552,((t353:1.046170486,t354:0.7838610317):1.332453338,t355:2.035384342):0.9456692071):0.3910621975,t356:3.331734132):3.090401286):0.4030080335):0.4477952937):0.7371335028):24.8981269):3.237897587,(t357:11.95536534,((((t358:0.2213909452,t359:0.2110282511):0.3907712305,t360:0.4666093402):3.384351815,(t361:1.965307835,(t362:1.91915895,t363:1.892960729):0.03475202941):1.830062178):6.533497103,(((t364:4.578220817,t365:4.524472631):1.028379297,t366:5.435271987):3.55534309,((t367:2.879021981,(t368:1.539304267,((t369:0.6579744756,(t370:0.2746555098,t371:0.2047821149):0.1142920027):0.1103018269,(t372:0.1657632806,t373:0.1360317294):0.244429588):0.5901608402):1.328626977):3.798853965,(t374:0.1455718635,t375:0.01462092972):5.921170318):2.221842207):0.9218988414):1.414223827):24.18662743):1.533096159,((t376:7.152915991,(t377:1.25072477,t378:1.199726145):5.858264201):2.935720153,(((((t379:0.3299098278,t380:0.285042057):1.450265556,((t381:0.6554819425,t382:0.6497246568):0.739593115,t383:1.242848618):0.2883019816):3.041722339,t384:4.285459873):0.13178359,t385:4.145339405):1.571412738,((t386:1.967197965,t387:1.911155225):1.021965597,t388:2.762065335):2.59435693):3.439671242):25.86833434):9.002411459,(((t389:4.300442823,(t390:2.009296072,t391:1.596919941):2.223679814):6.524217615,t392:10.1586112):5.168977964,(t393:5.645357359,((t394:2.017636947,((t395:0.6489249202,t396:0.5572332791):0.3217241677,t397:0.846654234):0.9857799238):1.356106428,(t398:0.4294914345,t399:0.3693162438):2.662503067):2.229366409):9.662257284):27.6607395):28.10738232):3.767914298,(((((t400:1.766329813,(((t401:0.3377545597,t402:0.2921467172):0.595794535,t403:0.8344386292):0.1971276431,(t404:0.266704935,t405:0.2102409702):0.7570921927):0.5914475763):7.629340658,((t406:3.883424911,(t407:0.3205823472,t408:0.2386983221):3.453543429):0.03733929,t409:3.644859888):5.143849685):1.926734249,(((t410:1.028452171,(t411:0.8293342544,t412:0.6760236686):0.135472674):3.550888208,t413:4.317684745):5.216383758,(((t414:2.817580853,(t415:2.164512161,(t416:1.917631025,(t417:1.507115966,t418:1.377778956):0.1100625728):0.1927254781):0.27193234):0.6924385941,t419:2.615888051):2.089673307,(t420:1.026202117,t421:1.007229603):3.669282374):3.614210494):0.8135260384):11.43022703,(t422:19.9891742,(t423:4.373121646,t424:4.335644658):15.58564446):0.5423326491):17.75886925,(((((((((t425:0.346219152,t426:0.0908277242):2.350821338,((t427:0.5603248284,t428:0.4815325409):0.5562417002,t429:0.7056740028):1.273121201):2.101199568,t430:3.99051987):0.9289014813,((t431:3.1868963,t432:3.000234117):1.182605743,(t433:2.926968958,(t434:1.864947035,t435:1.808594453):1.052835428):1.053156977):0.430110251):1.615824753,t436:5.849532681):0.2451502349,(t437:4.877339263,t438:4.727385976):1.193772931):0.7780216482,t439:6.504533326):2.359822819,((t440:1.126843287,t441:0.8181179181):4.10929706,((((t442:0.8580372558,t443:0.8193639262):1.347590746,t444:1.969193533):0.3283635016,((t445:0.3307363061,t446:0.2983571194):0.0297235457,t447:0.1878765735):1.926443396):0.2697410543,t448:2.332483274):2.031493599):3.442590546):15.24490453,(t449:10.04186181,((t450:7.215183278,(((t451:2.132333789,t452:2.074756639):0.4753994907,t453:2.430346841):1.069141783,((t454:0.1825221263,t455:0.150115155):1.842750493,t456:1.92126645):1.449701789):3.511486899):2.398860362,t457:9.253348161):0.2819632369):12.97432189):12.21827549):33.93414316):112.6888244);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T37.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
