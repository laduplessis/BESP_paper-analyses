<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t418:15.62208717,((t419:6.861878539,((t420:0.5778827663,t421:0.5461538528):4.01358636,t423:4.176570095):2.109301876):1.101594576,(t424:6.971663504,((t425:0.5686951484,t426:0.2259062822):0.6974349239,t427:0.913526519):5.600410945):0.2934699544):7.544793977):0.5824629414,(t428:2.990418599,t429:2.727704245):11.92392086):1.032519813,((((((t430:3.270328307,(t431:1.463316655,t432:1.363136717):1.8025509):0.3817754661,t433:3.392575681):2.300957597,(t434:4.434768851,(t435:1.178286507,t436:1.036814347):3.130594338):1.222720947):0.4266654852,((t437:5.269200505,(t438:4.324829981,t439:4.304995785):0.9096859529):0.4319441817,t441:5.577753323):0.09371268309):3.391567569,(t442:5.867387036,((t443:1.448633234,t445:0.3778823992):2.106170404,t446:2.447555266):2.046288245):3.064972677):3.238268996,(((t447:0.3600049947,t448:0.2983744146):0.9769925726,t449:1.231023836):4.113421604,(t450:2.441685292,(t451:1.456979778,t452:0.9163196348):0.8935353883):2.787975721):5.329419787):2.60123308):184.7574514,(((((((t453:2.19320376,(t454:1.01312272,t455:0.9710401577):1.119084587):2.172643312,(t456:1.993214406,(t457:0.60985287,t458:0.5751614874):1.352304063):1.947338707):6.679629189,(t459:0.6781718837,t460:0.5421304506):9.782184657):4.448451636,(((t461:2.645540949,t462:2.605947176):2.200128742,t463:4.790675456):7.898414601,((t464:7.259936934,(t465:6.114764454,((t466:0.3124337767,t467:0.213538979):5.51323469,((t468:1.574624547,(t469:1.08863591,t470:1.086190539):0.2521089495):1.401644987,t471:2.574918064):2.653375656):0.1449796055):1.09379473):0.4278554065,(t472:0.269858468,t473:0.08295397611):6.584004395):4.902914737):1.956183652):17.15297565,((t474:4.060730651,(t475:1.934703015,t476:1.890567406):2.11113814):4.665615135,(t477:6.973006335,t478:6.963950091):1.596184452):21.70289375):0.6427197151,(t479:18.66498303,((t480:1.278044263,(t444:0.1662850195,(t440:0.02471711568,((t422:0.1176394572,(t409:0.1118629009,((t357:0.3012587888,(t356:0.03451384818,(t346:0.08467620956,(((t229:0.05212426335,((t206:0.05796799871,(t198:0.08063874223,(((t178:0.09222265977,(((t160:0.04628805186,((t129:0.005130328971,(t117:0.04012745555,(t110:0.1248901213,(t104:0.1655623725,(t89:0.01897544741,(t38:0.1635367548,t1:4.492435903):3.984547827):1.695141062):0.4656545509):0.8693886596):0.6517534619):2.71267262,((((((t2:3.224484448,t3:3.142239966):3.981187055,((t4:4.122790861,t5:4.089233771):1.842369259,((t6:3.593950611,(t7:1.30874584,(t8:0.1769078089,t9:0.08130969522):0.9519004544):2.280703591):1.673271348,t10:4.966215133):0.5459216077):1.098894659):1.068639849,(t11:5.923633927,t12:5.858952168):1.745541206):1.17635901,(t13:7.14691794,t14:7.005975153):1.460411135):0.9035586632,((t15:4.96627932,t16:4.941438928):3.816799739,(t17:3.122974229,t18:3.000921575):5.529733903):0.4039777793):3.72429071,(((((t19:1.947264524,(t20:1.451647792,(t21:0.4621627917,t22:0.3171985014):0.8935935018):0.4268392978):4.664864612,t23:6.031171184):0.3622115224,t24:6.277788074):2.525000552,((((t25:1.996329189,t26:1.99040197):1.637993283,t27:3.517795326):0.9217371085,t28:4.369105093):2.570660342,((t29:4.892460595,t30:4.659694222):1.182193232,t31:5.69773301):0.8636333465):1.594352859):2.352858688,(((((t32:4.519421603,t33:4.346008626):2.866444426,((((t34:5.996363813,(t35:4.089210202,(t36:3.940445329,((t37:3.184686701,t39:2.913632807):0.02127199691,(t40:1.854438652,t41:1.7614796):1.07452095):0.556205265):0.04424892176):1.817228603):0.2254728622,(t42:3.781180196,(t43:2.43191877,(t44:1.462751107,t45:1.380846253):0.8207483718):1.274346579):1.693925841):0.2342497725,((t46:2.398118589,t47:2.318176131):0.7245870172,(t48:1.343393219,t49:1.266095537):1.565500211):2.190122788):0.3313639716,(((t50:0.2731088485,t51:0.1824065676):0.8473595085,t52:0.8247754457):3.362634279,t53:4.165294021):0.835379026):0.3263205613):0.2810460568,(((t54:1.149904852,t55:0.963509086):1.733530727,((t56:0.601014529,t57:0.5605454563):0.7649546897,(t58:0.6139253086,t59:0.6000473216):0.6568667025):1.286613941):2.258236698,((t60:3.963880087,(t61:2.08950019,t62:1.931681767):1.619758321):0.8274618096,((((t63:2.707840739,t64:2.58729152):0.623455456,t65:3.160932443):0.07161326304,(((t66:2.397425343,t67:2.363400358):0.09692100278,(t68:1.265761558,t69:1.229047699):1.175604596):0.1077410993,t70:2.473612302):0.4295292593):0.3231249926,t71:3.13990718):0.5557530241):0.007367668807):0.4151307319):0.574196164,((t72:0.08719727289,t73:0.04217918621):3.742268318,(t74:2.751370864,((t75:1.932815623,t76:1.90003669):0.4104680139,(t77:1.351709914,t78:1.24604593):0.9573675089):0.2605720648):0.6777747956):0.8566530029):1.455445506,((((((((t79:2.149510004,t80:2.05653735):0.5274915356,(t81:2.010917346,((t82:1.612356192,t83:1.44382975):0.1399784214,t84:1.573915683):0.2077652352):0.5692616417):0.3363939901,((t85:1.764870144,(t86:1.603894421,(t87:0.2540446718,t88:0.2172986243):1.239838045):0.1226046448):0.08323480417,(((t90:1.41937122,t91:1.366933508):0.07227186821,((t92:0.1311818016,t93:0.05587922962):0.6167897661,t94:0.6337522244):0.3162983474):0.01529427024,(t95:0.8561371742,t96:0.8222991098):0.08380028608):0.07125986895):0.7993059312):0.2010029046,t97:1.888131351):1.541739274,(t98:1.072501241,(t99:0.1943325423,t100:0.1537217311):0.5571516907):2.308691857):0.151623711,((((((t101:0.3943997601,t102:0.3215604986):0.2301035241,t103:0.5494651105):0.2759002691,t105:0.4952617279):0.5935298269,t106:1.000088262):0.6690824429,((((t107:0.4873378692,(t108:0.2873920315,t109:0.1799872831):0.1820208621):0.6467001492,t111:0.7603589411):0.2378107354,(t112:0.2795089616,t113:0.1796164166):0.6270966845):0.001638951416,(t114:0.1869286329,t115:0.1627115288):0.2659362536):0.2678237216):0.3749131512,t116:0.8779447791):0.4299636454):0.07586478907,(t118:0.8165030536,t119:0.8066246221):0.4955591203):0.09684996618,(t120:0.1832523543,(t121:0.1015382257,t122:0.08444146361):0.04221416497):1.172876939):0.3705042226):0.5677499285):0.7798345769):0.2093881293):0.008384093794):0.8476987386,((((t123:0.1987657347,t124:0.07742050153):1.102568208,((t125:0.5659028327,t126:0.4277916139):0.05898467757,t127:0.3509042692):0.5548334513):0.4963791383,t128:1.354022151):0.3673083315,(t130:0.1770367067,t131:0.1436298032):1.372937484):1.897832285):0.2765643519,((((t132:1.352033002,(t133:0.1904808353,t134:0.1800771287):0.8780427696):0.0129669923,(t135:0.3559752721,t136:0.2998317647):0.5468233969):1.384207141,(((t137:0.5964663484,t138:0.5064853787):0.3050497677,(t139:0.4807311073,(t140:0.2638228685,t141:0.2411015942):0.1284122015):0.3064992357):0.9136782963,t142:1.526227629):0.3082394696):0.1694757138,t143:1.912257035):0.5574212108):0.4092457869):1.265691778,((((t144:1.10743124,(t145:0.509489716,t146:0.385435205):0.5629365224):0.7272238116,(((t147:0.07506828145,t148:0.04472394608):0.3612855814,t149:0.3245088669):0.004550003715,t150:0.1930052446):1.196238149):0.1079680365,((t151:0.7885044871,t152:0.7241708657):0.1700240387,t153:0.7567422443):0.4085626654):1.325127637,((t154:0.04879216178,t155:0.03919650688):1.829461772,(t156:1.527689506,(((t157:0.6924448687,t158:0.6222649765):0.3777153516,t159:0.9282229407):0.3234700269,t161:0.7966899444):0.04140353998):0.2972036765):0.5917133284):0.7309284024):0.1190166938,(t162:2.477239409,(t163:0.7943238761,(((t164:0.2705652385,t165:0.1514968059):0.1780493844,t166:0.3053258946):0.09604416741,t167:0.3245971115):0.2483044239):1.672268319):0.07554389898):0.08275626265):0.610751803):0.7841994184,((((((t168:0.2984270563,t169:0.2381823415):0.4208516379,t170:0.5315016365):1.014226938,t171:1.337345391):0.9955106331,((((t172:1.040354652,t173:1.032164137):0.2403136398,((t174:0.2551005251,t175:0.1184955441):0.1459950307,t176:0.1063470829):0.8631751911):0.5880244516,(t177:0.7430195107,t179:0.5856267798):0.7991947828):0.1262863434,t180:1.423945363):0.2774939199):0.3352470211,(t181:0.07339555601,t182:0.05416115158):1.755713001):0.5243421114,(t183:0.7364814629,t184:0.6443987045):1.439162481):0.1557599103):2.127076117):0.4721613396,(((t185:0.4702786086,(t186:0.1641364697,t187:0.08175457581):0.2180517969):1.666890666,((t188:0.2212066267,t189:0.2018437035):1.445004217,((t190:0.2767172225,t191:0.2716739431):0.241945535,t192:0.4525968947):1.035198911):0.295340173):0.3126853506,(t193:1.292554196,(t194:0.2872893222,t195:0.2565537201):0.8774359201):0.783502341):2.350241697):9.242218927,((((((((t196:0.197751036,t197:0.1533225646):0.869066386,(t199:0.7902030568,t200:0.7073604246):0.07850822485):0.6142921242,t201:1.382223579):0.4038424263,(t202:1.30669479,t203:1.262776436):0.3244850163):1.068270573,(t204:1.420433203,t205:1.351306886):1.184674007):2.761448043,t207:4.999549522):6.53109294,(t208:10.25082832,((((t209:0.217467531,t210:0.0669394852):0.315651179,((t211:0.1755140543,t212:0.07260034264):0.09887091759,t213:0.153650481):0.003842502307):2.604304925,t214:2.621857812):5.609256081,((t215:0.05785188711,t216:0.03585821324):4.559267705,(t217:2.690229543,(t218:2.149988822,t219:1.695396149):0.361748921):1.633445105):3.540045988):1.429903643):1.020774201):0.8875094896,(t220:5.560656861,(t221:0.916173361,t222:0.7259982147):4.472640735):4.854737275):0.05840231983):1.529328479):1.343470023):0.3308020342):1.311259554,((((t223:3.123199457,t224:3.031732054):0.1259629147,t225:3.157356422):1.32179694,(t226:2.776186892,t227:2.693529877):1.575927528):2.421535108,(((t228:3.240582735,t230:2.930442132):0.4157742978,t231:3.312057522):0.01226526901,t232:3.251175865):2.992841416):7.629442012):3.958970475):1.28333443):1.560177137,(((((t233:0.5459771384,t234:0.5065562236):4.571307005,((((t235:0.5938007036,t236:0.4788668436):0.9659983468,t237:1.195636493):2.055020175,t238:3.250239214):1.235734583,t239:4.281659648):0.09830489147):0.3841598982,t240:4.743693074):10.14555378,((((t241:1.936277788,t242:1.819099054):5.433259857,t243:6.96527745):1.290771546,(t244:6.83629029,t245:6.766093131):1.398356907):4.333087835,((((t246:4.844011659,t247:4.481191365):0.9856326815,t248:5.459966689):3.298937693,(((t249:4.404559041,((t250:2.304940256,(t251:1.985472844,(t252:1.71338784,(t253:1.201609681,t254:0.9682307847):0.5003770906):0.1206894961):0.1534762576):1.360380394,(t255:2.797678771,t256:2.745036932):0.2287416919):0.723947607):0.3062641411,t257:3.845417433):0.9058553953,t258:4.655140708):3.032408836):2.730381401,(t259:2.985494803,(t260:1.264499924,t261:1.029654777):1.650112144):7.316421268):0.5370885334):1.895062687):3.875650488,(((t262:2.365408378,(t263:2.042651361,((t264:1.409453112,(t265:0.9355245633,t266:0.9136529849):0.3604741264):0.5489574579,t267:1.798591109):0.06001589331):0.2491623377):0.5330373694,(t268:0.08424432122,t269:0.03307982407):2.484087888):1.214086149,((t270:1.165978731,t271:1.029493937):1.986564504,t272:2.94723959):0.5414058542):12.12067153):1.147980467):0.3064215794):0.5929257114):5.67618388):14.23098952,(((((((((t273:1.224044255,t274:1.142772078):5.061933136,t275:6.019335497):3.173983603,(t276:7.704582264,(((t277:0.05276831523,t278:0.03603316289):2.050840387,t279:1.999681117):0.5575660748,(t280:1.604758649,t281:1.560100179):0.9022937045):4.812577703):1.266125857):1.211450339,((((t282:1.242879806,t283:1.226654486):0.4787828657,t284:1.611836416):3.374015222,t285:4.937645344):3.004236969,(t286:3.991141092,t287:3.792659347):3.837252658):1.613646855):0.1531463226,(((t288:2.103268191,t289:2.050130411):4.742993791,t290:6.712949445):0.2994823941,(t291:2.105788928,(t292:1.836978769,((t293:0.1353585625,t294:0.1239838388):0.3559227586,t295:0.2281853344):1.328727142):0.2667175372):4.842524724):2.215864936):4.049206476,(((t296:3.626723641,t297:3.62142735):2.701766128,t298:6.242964064):1.144018858,(t299:2.944011387,t300:2.810730261):4.184065583):5.381329808):7.980641169,(((((t301:1.818906676,t302:1.800190056):1.602422719,(t303:3.242642214,(t304:2.950541699,(t305:2.28424922,t306:2.272094114):0.6162701883):0.2178484872):0.1220252416):11.67882072,((((t307:3.625725128,(t308:3.122752753,(t309:0.6821007348,(t310:0.2679703598,t311:0.1490222844):0.4054699388):2.412321322):0.4797346007):4.900295967,(t312:7.875480679,t313:7.83752785):0.4220543799):1.51969152,((t314:3.04924026,(t315:1.73527491,t316:1.679609312):1.173347282):5.852008234,(t317:7.648388163,(t318:6.126617896,((t319:3.042973606,t320:3.014410906):1.261021046,t321:4.218195316):1.625376362):1.401819765):0.9457848918):0.7183098429):1.713511253,((((t322:2.054042372,t323:1.961027319):1.402880266,((t324:0.7723313162,t325:0.7701086823):2.032375484,t326:2.652662935):0.2876017364):1.957957213,(t327:4.033754632,((((t328:1.444646405,t329:1.311175562):0.4865084083,t330:1.7694251):1.060950737,((t331:1.685798129,((t332:0.3606659377,t333:0.1565513987):1.123551166,t334:1.167454614):0.190901607):0.1398723154,t335:1.448018427):0.8861678517):0.0737903518,(t336:2.211939461,t337:2.083044235):0.1391715035):0.9152112065):0.6137788328):2.063240784,t338:5.305212366):3.097712707):2.939577169):2.434168618,t339:13.58514046):1.049607714,t340:14.5756928):1.761737547):6.385030424,(t341:4.917720079,(t342:4.785692257,((t343:2.645696098,t344:2.630836862):1.80531814,t345:4.41414423):0.1952046721):0.04681529168):17.77466157):7.184170127,((((t347:3.520881308,((t348:1.543048634,t349:1.405672664):1.82194885,t350:2.832338415):0.06827236993):6.130608937,(t351:7.184005092,t352:7.056341623):1.679768939):13.41104654,(((t353:11.90642393,(((((((t354:2.636481334,(t355:2.416415306,t358:1.922285023):0.07424774879):2.388272702,t359:4.327735688):1.131129908,t360:5.432350281):0.8166499363,((t361:3.531548327,t362:3.492907356):1.600888964,((t363:1.470609127,t364:1.292783077):2.932508204,(t365:1.416159178,t366:1.348119266):2.74037039):0.584529383):1.107028496):0.2318339962,((t367:3.341626795,(t368:2.414414839,t369:2.38275033):0.9197235583):0.2785557776,t370:3.489968891):2.239637049):0.9725473977,((t371:2.137908416,t372:1.947571935):0.8562679063,t373:2.555582388):3.706527484):3.01565649,((((t374:0.5329762521,t375:0.4319225355):2.317155347,t376:2.531957056):3.229355662,(t377:2.337925493,t378:2.323477884):3.384575016):0.9504955381,((t379:0.8592039277,t380:0.8052049191):1.640231524,(t381:1.302256948,t382:1.267500441):1.114810294):4.056845667):1.991949712):0.692442683):6.472294649,(((((t383:0.3515460369,t384:0.349566921):3.873249862,t385:4.167572991):4.445500135,(t386:2.913006896,t387:2.771919397):5.431064345):2.857901728,(t388:9.841107261,((t389:2.728278982,t390:2.676743604):0.998269308,t391:3.428825844):6.039455975):1.173516949):2.359968883,(((t392:1.973424047,(t393:1.525120946,t394:1.215299338):0.4186090055):8.681797633,(((t395:0.5130290992,t396:0.1982724366):2.301851711,(t397:1.895062288,t398:1.714173166):0.57789311):0.9154133579,t399:3.123615167):6.467916063):2.014430047,((t400:0.3422960416,t401:0.1699837172):3.657664776,t402:3.749676444):7.535105177):0.1337772211):1.682751681):0.7233416273,(t403:7.726036595,t404:7.703919052):5.968634897):2.937011318):0.1258642817,(t405:5.767172232,(((t406:0.3259539684,t407:0.2983376059):1.763946376,t408:2.054624162):2.709606116,(t410:4.218072725,(t411:0.9632238412,t412:0.942750991):3.191616318):0.2832976552):0.9434566359):10.84426536):6.210418101):1.138558729):3.046913864):12.22548982):10.74411511,((t413:0.1913461967,t414:0.1696617354):11.74435569,(t415:2.982737513,(t416:2.438270817,t417:2.372423531):0.3048552191):8.926377009):37.45149418):153.1552887);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T11.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
