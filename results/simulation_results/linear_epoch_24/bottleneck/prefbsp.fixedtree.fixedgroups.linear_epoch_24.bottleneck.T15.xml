<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t381:5.375497073,((t382:1.361645039,t383:1.346529314):3.493445392,(t384:4.171717322,(t385:2.818294829,(t386:0.3364417274,t387:0.3228710886):2.453127378):0.99844791):0.6634109822):0.5043514708):3.175466379,t388:8.112623417):2.752972117,(((((t389:2.152279483,(t390:1.093144213,t391:0.9251863685):1.013164702):3.96427926,(t392:5.331085401,(t393:1.656978245,(t394:1.160240439,t395:1.044117285):0.3883698521):3.642831963):0.5102257299):1.193911696,t396:6.716559498):2.42831366,((((t397:1.902654454,t398:1.821521917):2.390137692,(t399:0.2991114465,t400:0.2867962691):3.842039104):1.168565917,((t401:2.601738467,t402:2.528497324):1.717817771,(t403:2.047751961,t404:2.027166503):2.101425066):0.905908162):1.2116357,(t405:0.1628357185,t406:0.1584972291):5.84681568):2.190575944):0.5222245036,(((t407:3.987499643,((t408:0.3790198764,t410:0.2383810444):1.342544327,(t411:0.9982268521,t412:0.8120376663):0.512317129):2.191488278):1.79348627,(t413:4.382260977,(t414:0.3379528817,t415:0.3178282213):3.981750077):0.917485301):0.5686493407,((t416:0.2261913658,t417:0.1922743569):0.371473812,(t418:0.1331396592,t419:0.09176307548):0.1437069225):5.169229923):2.342534135):0.5834148165):103.2413108,(((((((t420:1.579789055,t421:1.475920461):12.99045921,t422:14.3844223):2.588707947,(t423:5.137863823,(t424:4.23549243,t425:4.17813468):0.7347778037):11.80489013):3.232435577,((((t426:1.44369825,t427:1.37670306):5.350657112,((t428:5.030609533,((t429:2.919782222,t430:2.864837086):2.050811805,((((t431:1.742491273,(t432:0.3406470304,t433:0.2929273805):1.206780576):0.2892373457,(t434:0.9801514025,t435:0.6899679473):0.7104515337):0.1853228675,t436:1.420402121):1.587928838,(t437:0.4778313584,t438:0.2565998699):2.519568275):1.003176709):0.05382214084):0.2126623998,t439:3.950416037):1.425523037):8.330623028,(((t440:1.917800781,t441:1.843290723):0.6203557842,t442:2.446825658):5.49556438,t443:7.900086815):5.605117321):0.4945622697,((t444:1.907947297,t445:1.876973186):7.018014626,(t446:5.7808837,((t447:0.3178328415,t448:0.2490734983):5.02081167,(t449:2.796461244,(t450:2.415961664,t451:2.379026475):0.3789152704):2.339196156):0.347710287):3.008063204):5.048212704):4.216385172):50.42111147,(((t452:0.9753487794,t453:0.9345904635):0.3856039238,t454:0.8787461994):6.156639698,((t455:1.632845144,t456:1.607226454):2.026528151,(t457:0.8023951596,(t458:0.4533711408,t459:0.2608171275):0.29467435):2.623529745):3.252031253):60.61495631):15.41931263,((((t460:25.90953484,((t461:4.219154514,(t462:2.088882605,(t463:0.5221849396,t464:0.5065742782):1.562745845):2.075351394):2.195193812,t465:6.246840936):19.38478267):2.713624626,((t466:4.145568166,t467:3.91794211):1.854213968,(t468:4.242800976,t469:4.197581326):1.512043998):22.26433342):10.33332077,t470:38.25852968):5.128801437,(((t471:0.3248138363,t473:0.02545685235):4.235366312,t474:4.147193522):15.05339042,(((t475:0.4586578608,t476:0.4490603693):7.370649643,(t477:2.630991526,((t472:0.03600928837,(t409:0.002015035015,(((t362:0.0331683384,(t319:0.06155482824,(t308:0.01103634976,(t267:0.03512462278,(t264:0.2308483603,((((t191:0.03818475783,((t171:0.4758861699,(t172:0.2965154203,(t173:0.08800962731,(((t152:0.1971352221,((t143:0.05592721033,((t124:0.02138699483,(t122:0.03767389321,((((t102:0.1092217845,((t67:0.01820115799,t1:7.147850023):2.967481044,(t2:8.378517046,(((((t3:4.210959332,t4:4.112857737):0.4306126922,(t5:3.77729721,(t6:2.6528662,t7:2.64616441):0.998916154):0.7575601402):1.964079209,t8:6.309984478):0.5625018583,((t9:4.911113846,t10:4.878646592):1.280675225,(t11:5.100542755,(t12:2.638830619,t13:2.599463993):2.210915444):0.7382397999):0.5170346891):1.060024532,(t14:5.941252623,t15:5.710300313):1.171764643):0.1418083652):1.520524345):0.4097035175):0.8710120601,t16:9.729760918):0.03415544173,(((((t17:1.094577089,t18:1.032546007):2.611346883,t19:3.477637533):4.68481809,(t20:4.866518443,t21:4.833709443):3.295176521):0.6653659801,((((t22:2.156233045,(t23:0.5182857673,t24:0.4742406967):1.562802393):1.297508153,((t25:1.185840503,t26:0.9861334054):1.944403972,t27:2.799534083):0.1080154424):4.114653541,t28:6.715574682):0.2676021683,((((t29:4.278956602,(t30:4.164851077,t31:4.135065257):0.08620371337):2.307421812,t32:6.48561939):0.04080065238,((t33:2.033580585,t34:1.978532423):3.756050048,(t35:5.568124292,t36:5.365208183):0.05490311062):0.6821063077):0.1095155352,(t37:4.366614214,(t38:2.22270113,t39:2.199319305):1.974395361):1.778738306):0.1690380423):0.4511331137):0.04401598994,((((t40:2.880867604,t41:2.658888342):0.4388693958,t42:3.03505552):0.2422447399,t43:3.205012935):2.40814778,((t44:0.159228014,t45:0.1205835335):1.286187974,t46:0.992311839):3.699750849):0.5848800227):0.6615414482):0.2506231004,(t47:2.377807378,t48:2.34126899):3.795216259):0.2295410925):0.07158534557):0.4256308343,((((t49:2.986598941,t50:2.910195579):1.766214978,t51:4.637980166):0.2008886571,((t52:1.582248102,t53:1.459045458):0.01650094648,(t54:0.07208793694,t55:0.03616489926):1.234796137):3.198289024):0.4230537087,(t56:1.724517596,t57:1.572363032):3.008455153):1.462936326):1.399038477):0.4163178857,(((((((t58:0.6713606954,t59:0.6094688281):0.7835749878,((t60:0.8600419427,t61:0.6847478028):0.166456899,t62:0.801997135):0.2551556404):2.102871912,t63:3.040081656):0.5687716173,(t64:3.131745587,(t65:1.518095087,t66:1.510043175):1.604802196):0.3955335939):0.1548946351,((t68:1.61224807,t69:1.592211019):1.12548066,((t70:0.8185294873,t71:0.7579577017):1.617673768,(t72:1.675789117,t73:1.628586909):0.5332366842):0.2288087534):0.7403857183):2.258742317,(((t74:1.810117236,t75:1.769825794):1.112423216,(t76:2.386818561,(t77:0.3119065274,t78:0.1519924855):2.062429736):0.4828445643):0.5008704393,(t79:1.677759938,t80:1.522826399):1.452572051):1.930379945):0.9506376192,(((((t81:2.67787582,(((t82:2.011663543,(t83:1.77018256,t84:1.590782565):0.2045550772):0.4797936852,((t85:1.648444613,(t86:1.324599862,t87:1.266958262):0.08980119968):0.2169259286,t88:1.538095111):0.2510296411):0.02245876873,(t89:1.217458562,t90:1.091138114):0.551687072):0.1312788226):0.613540381,t91:2.379141082):0.2143975081,(t92:0.9922947042,(t93:0.9140626992,(t94:0.685832932,t95:0.5192573293):0.08019865308):0.07040821038):1.497403189):0.557648277,(((t96:0.9779864092,(t97:0.5783179302,t98:0.1620638368):0.3449610962):1.502035088,(t99:0.1143132323,t100:0.03651088945):1.862926205):0.02776940162,(t101:0.8576604631,t103:0.4015661353):1.013229349):0.2007865724):0.6157022909,(((t104:1.43892621,(t105:0.1190745806,t106:0.01769174115):1.166282999):0.1146132557,t107:1.147232319):0.4960983773,(t108:0.653534455,(t109:0.0315361873,t110:0.01878651956):0.5698829525):0.857773784):0.1762188867):1.132918059):0.3284061939):0.7085503914):1.21016003,(((t111:2.083909749,t112:2.071473235):0.5133176477,(t113:1.622458214,((t114:0.3985955772,t115:0.196965024):0.8600737339,((t116:0.08543536178,t117:0.055522646):0.8883005044,t118:0.8305799873):0.08215988193):0.3417644645):0.9039469347):0.9584616321,(t119:0.2926659308,t120:0.2434614188):2.765800832):1.375610709):0.4436784263,(((t121:0.2048804843,t123:0.08227206902):1.446194433,t125:1.330089027):0.8765843858,(((t126:0.4172075639,t127:0.3990476831):0.3681177169,t128:0.3913682661):0.4091590766,(t129:0.4852023313,t130:0.3439886968):0.2988141541):0.88031548):2.24307311):0.0359393725):0.1837550397):0.1538209345):0.5996121181,(t131:0.4792765783,t132:0.4306258986):4.234127578):1.389645398):2.522268944,((((((t133:1.040551917,t134:0.9982568742):0.3409891934,t135:1.273990134):0.9531672451,((t136:0.3882099246,t137:0.1765824618):0.07426349579,(t138:0.03856459134,t139:0.01780138411):0.1161652975):1.674007602):2.805097117,((t140:0.2558877768,t141:0.1983710916):2.087643032,(((t142:0.6445327665,(t144:0.0981842713,t145:0.06536549614):0.1849906572):1.209610947,(t146:1.107087947,t147:1.017361881):0.2663644267):0.1395066338,t148:1.196825792):0.2821269381):2.163287054):0.3517253258,(t149:3.93240989,((((t150:1.969625225,(((t151:0.8850181411,((t153:0.3320901434,(t154:0.181146599,t155:0.09685659933):0.1258790286):0.0479685397,t156:0.1078673342):0.2538812816):0.3237831635,t157:0.6680769102):0.4836480194,t158:1.086482512):0.2645788276):0.2303912032,((t159:0.3033495143,t160:0.2903786378):0.1034709684,t161:0.3872776395):1.129807184):0.2884768582,((t162:0.3973618258,(t163:0.23386414,(t164:0.1719136943,t165:0.1428097763):0.0402015197):0.06214923858):0.1256032797,t166:0.2411389092):1.149010924):0.8992133111,(t167:1.757796039,t168:1.603124346):0.2518336241):0.3809801929):0.02156053843):0.04789737116,(t169:0.05340619208,t170:0.007756297562):2.101433963):2.943372977):2.35783602,(t174:2.835800622,(t175:1.98696258,((t176:1.447813459,t177:1.438864293):0.174659687,(((t178:0.3808222567,(t179:0.3532119469,t180:0.3360411256):0.02237208875):0.6367530895,t181:0.6568136003):0.046161478,(t182:0.3784746797,t183:0.1905539347):0.1352596366):0.5410830495):0.1525811894):0.8391821354):4.029180649):2.958314907,((((((t184:1.76474965,t185:1.739587123):0.7582682259,t186:2.414149636):0.3261821483,(((t187:1.124446414,t188:0.9540881717):0.1262306531,t189:1.01190864):0.241629721,t190:0.9502226895):1.152658321):2.937516553,(t192:3.113874361,((t193:0.5468712836,t194:0.4292947236):0.3732283258,t195:0.754085786):2.133365833):1.443148862):1.417328407,(((t196:1.265381505,t197:1.224451111):3.222258249,((t198:0.5164933233,t199:0.4249481685):3.393733027,((t200:0.1372715056,t201:0.08825485854):2.129522389,t202:2.210825628):1.497817606):0.4310208782):0.8904495369,t203:4.926257245):0.2942261717):0.7550969634,((t204:0.763350948,t205:0.7563897881):2.814743618,(t206:0.1691837493,t207:0.1558120372):3.379383188):2.367498282):0.7365757224):0.0904707108):0.5837140075):5.798554553):1.058106862):3.391529019):1.518559676,(((((t208:5.974775739,((t209:4.357655565,t210:4.222555273):1.055771309,t211:5.202423986):0.5578637893):5.80602345,((t212:8.272187491,(t213:0.7146231496,(t214:0.5447954977,t215:0.4822481064):0.05236341776):7.431204606):2.536975486,(((t216:3.16865834,t217:3.072303486):4.471111388,(t218:2.970117224,((t219:1.74261772,t220:1.739948487):0.9933510212,t221:2.719548622):0.2122492475):4.504833469):1.247908366,(((t222:1.364023302,t223:0.9977695618):5.883544348,t224:6.786478874):0.4304491676,(t225:2.035987208,t226:1.630286069):5.161461683):0.9255823963):1.513171877):0.5895502514):0.8323610084,(t227:10.27746854,(t228:6.494696437,(t229:4.123285905,(t230:0.3704251153,t231:0.3378028967):3.636443187):2.34548812):3.3736242):0.3194893133):2.768830951,(t232:8.031373427,t233:8.015213677):4.642986477):1.233405294,(((((t234:0.31881437,(t235:0.1301059064,t236:0.006952868987):0.0467011416):3.556754401,(t237:3.412744868,t238:2.967571556):0.1395480614):3.127456769,t239:6.161166475):0.5754069965,((t240:2.272249856,t241:2.254414283):1.937166064,t242:4.029606312):2.489727558):5.837751888,(t243:0.7887232649,t244:0.6189762545):11.47684591):0.3637239423):2.419114663):2.635530688,(((((((((t245:0.6948491255,t246:0.6564365183):1.172301556,(t247:0.826028622,(t248:0.5096608602,t249:0.4447080094):0.2097335808):0.8139211653):1.154551694,t250:2.58764703):4.033489508,t251:6.582577337):0.5494383527,t252:7.09447557):0.6865513146,t253:7.705964882):1.637743789,(t254:2.746334995,t255:2.293968424):6.481537917):2.069027805,t256:10.76901848):2.614545535,(t257:13.32276666,(((t258:4.426097996,(t259:2.74602366,t260:2.739939327):1.441556605):5.875102371,((t261:0.9658393183,t262:0.4962113489):6.235913235,t263:6.715462523):2.843190494):0.172149173,(t265:6.599349519,(t266:5.967915833,t268:5.428862748):0.5999212388):2.675936026):2.79237114):0.03431073823):2.777447431):0.007173234722):5.853928533):0.3246758401,((((((t269:1.623161586,t270:1.588888272):7.089731111,((t271:0.3381736829,t272:0.3349403647):3.695927812,(t273:0.5730211492,t274:0.536723251):3.164141354):4.611295716):2.47892837,(t275:1.910410808,(t276:1.37911254,t277:1.320619216):0.4873179125):8.838090853):0.2509262891,(((t278:0.4613163235,t279:0.2345562993):3.832809866,t280:3.900465365):0.497906368,(t281:3.219122745,t282:2.513374592):1.145843232):5.94206526):5.120487233,((((t283:0.6749458429,t284:0.2708885064):3.559581902,((t285:0.2755827517,t286:0.1798036713):0.3172450844,t287:0.4255745924):3.163460935):1.133073515,t288:4.469915007):7.112560308,(t289:11.21591756,(((t290:7.944190375,(t291:6.617494839,(((t292:1.142484997,t293:0.9274840029):1.017232259,(t294:0.8121292329,t295:0.7421239129):1.086505648):2.75155206,t296:4.274875077):1.616520595):1.29389021):0.5601769491,((t297:0.6276087939,t298:0.4844426109):3.604464529,t299:4.078883625):3.395338421):0.4115843237,(t300:3.895619984,t301:3.777812494):3.987140814):2.228799977):0.05818189252):2.178871661):0.1646590822,((t302:1.675216195,(t303:0.8610165923,t304:0.5711330365):0.7158581582):7.768201263,(t305:8.415636611,t306:8.142983584):0.451425887):2.644075006):3.732413224):2.500810136):5.15382758):8.321017308,(((((t307:3.00693947,((t309:1.864130217,((t310:0.4549066456,t311:0.3120466791):0.6267584834,t312:0.8589515887):0.7015099461):0.110770602,t313:1.623916651):0.9986073319):8.138244437,((t314:4.300239862,t315:4.251100282):2.084895378,(t316:3.114489387,t317:3.091638805):3.168973956):4.117535854):1.004388686,(t318:6.346264906,(((t320:3.059202981,t321:2.978204131):1.813191068,t322:4.755970092):0.8902306539,((t323:4.005558937,(t324:0.7342143568,t325:0.7244481907):3.190078963):0.6347829414,t326:4.534868404):0.9553088296):0.3997878315):4.866715395):0.8449915236,((((t327:1.857485882,t328:1.718910086):4.289971704,((t329:1.118128592,((t330:0.4758964067,t331:0.4551832283):0.3010934797,t332:0.7396332918):0.3239568259):1.372813695,(t333:1.881390799,t334:1.815816664):0.4826628347):3.459439384):3.567204121,((t335:4.687001396,((t336:3.548544017,(t337:2.277088225,t338:2.224549878):1.224598285):0.1286946562,(t339:1.504040175,((t340:0.8636670571,t341:0.7860653304):0.4859770383,t342:1.193210007):0.07484361486):1.804225174):0.9574207737):0.7366334426,((t343:0.881884491,t344:0.6863473671):0.2121347746,t345:0.8611345642):3.650772177):3.774949659):0.4354838609,(t346:7.707749056,t347:7.619045899):0.9402798559):1.373528814):16.69205834,(((t348:0.2054262472,t349:0.1884995376):6.043932727,((t350:1.687714467,t351:1.638840688):0.921370941,t352:2.396713338):3.608048242):5.360235266,(t353:3.671347233,(t354:0.6408691004,t355:0.5802870605):3.006148043):7.67270353):14.90039838):1.103772934):3.039300643):23.67061196):38.23216902):6.371610317,(((((((t356:0.6376002092,t357:0.264145238):0.6677178138,t358:0.817123278):1.738638463,t359:2.311096985):1.779705149,t360:4.057724681):1.208785278,(t361:1.103372184,(t363:0.6338268042,t364:0.6013458123):0.3258632547):4.043262611):7.360315898,(((t365:4.423333485,(t366:0.621942899,t367:0.5318305756):3.669617499):3.292274214,((t368:0.9615847671,t369:0.7311812088):2.025970919,(t370:2.564568572,t371:2.557383497):0.03662022014):4.45408012):1.805116066,(t372:1.064341427,t373:0.9242360938):7.559955902):2.710796498):3.930153631,t374:15.05723574):81.25267931):18.92580261):49.00059131,((t375:3.665727191,t376:3.590194489):2.311238885,(t377:1.295639514,(t378:0.5685425729,(t379:0.4630229337,t380:0.2464513135):0.07391645651):0.7254174549):4.362559417):158.249773);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T15.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
