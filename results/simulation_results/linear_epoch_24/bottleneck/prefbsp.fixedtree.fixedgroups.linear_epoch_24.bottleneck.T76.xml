<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t440:22.48946169,(t441:16.94070684,(t442:11.65681032,t443:11.37572341):5.251494552):5.239191019):85.20891104,(((t444:3.553544053,(t445:1.440348713,(t446:0.9826107331,t447:0.8450988539):0.410929801):1.89259067):7.81635487,(((t448:0.3515910181,t449:0.3081314974):1.258445511,t450:1.48531588):5.368514126,t451:6.778851017):3.714183143):5.374029365,((((t452:0.9013848317,t453:0.8692665955):1.378579059,(t454:0.3536253936,t455:0.3520948227):1.879795381):10.83417643,(t456:5.0641074,(t421:0.03974745047,((t379:0.05506559319,(t378:0.09451191443,(((t314:0.008044557375,(((((t197:0.1195768085,(((t179:0.1977707619,(t158:0.026828158,(((t130:0.05075777971,(t126:0.08634440752,((((t116:0.1673995807,t117:0.03825006361):0.004106430262,((t94:0.4747816879,t95:0.447060803):0.09362181334,(t96:0.4313791414,((t63:0.06608849472,(t1:5.045618428,(t2:2.545488201,t3:2.261014152):2.372853743):1.823674484):3.111576774,(t4:7.919090101,((t5:2.10065012,t6:1.840207158):3.849428339,(t7:3.743814055,t8:3.706204405):1.853150542):1.963152767):1.635805412):0.06675005748):0.1052692152):1.256181692):0.005498777755,((((t9:1.915874273,t10:1.904328989):1.439848339,t11:3.23940393):5.822476402,((t12:3.224710668,(t13:1.515520607,t14:1.226370257):1.621578108):0.8315491674,t15:3.6462281):4.896762417):0.3979402495,(t16:4.431786416,(t17:1.712868117,t18:1.639117718):2.710990847):4.380338372):0.9452208387):0.847382166,(t19:9.400636164,((t20:7.973281617,(t21:5.233135415,(((t22:1.41548759,(t23:1.380860945,t24:1.351117092):0.006634244562):2.280682383,t25:3.416983622):0.538467278,((t26:0.8456478787,t27:0.7980333522):2.240002413,t28:2.921463134):0.7984263883):0.9771505522):2.535504245):1.111241244,(((((t29:2.534641928,t30:2.533428391):4.784553963,((t31:1.485868281,t32:1.476119982):1.063212369,(t33:2.046293093,t34:2.013357684):0.3842101448):4.539466443):0.01170480645,((t35:1.376298798,t36:1.346173849):5.172187556,((t37:0.8404507661,t38:0.7372358945):1.262111802,t39:1.884702525):4.374697708):0.255949765):0.1787921229,(t40:6.152898728,((t41:1.627100818,t42:1.547865408):4.492706287,((t43:4.072260023,t44:4.038058345):0.599357747,t45:4.554690533):1.125312616):0.01687891661):0.4793978186):0.5134908299,t46:6.536226876):0.2589685044):0.2876521099):0.6817369803):0.4680193769):0.4028279673):0.8030169775,(((t47:6.252176612,(((((t48:2.823754416,((t49:0.5405004781,t50:0.2975957577):2.018647397,t51:2.178199408):0.1836368785):0.5181892448,(t52:0.801380324,t53:0.7688282512):2.05268432):1.899762888,(t54:1.36026165,t55:1.255254932):3.255898955):0.2962016657,((((t56:1.780619053,t57:1.737272547):2.267959241,(t58:2.795070874,(t59:1.121206806,t60:0.7672680679):1.632066296):1.045850306):0.2812136743,t61:3.652281463):0.336216449,t62:3.609627921):0.0542599181):0.3872132736,(((t64:0.6928745505,t65:0.6802392585):2.163316895,((t66:2.811237106,((t67:0.9851928391,t68:0.9783500168):0.3225925702,t69:1.249859644):1.404296728):0.001335515511,(t70:2.371042093,(t71:0.1318630566,t72:0.07677195401):2.205448379):0.1734440108):0.01810702873):0.1075028622,t73:2.530721936):0.6895785064):0.2509410716):0.7824627859,((((t74:2.486930199,((t75:2.180286603,t76:2.17963035):0.100630515,((t77:1.050232001,(t78:0.1070479906,t79:0.1016563845):0.8667310994):1.09636424,t80:2.030801397):0.1195585191):0.03012952417):0.8607633114,(t81:0.7036663373,t82:0.4869718538):2.327626286):0.2551725625,(((t83:0.947988325,t84:0.8782719418):0.1324221211,t85:0.9647922711):0.9705064205,(t86:1.664570583,(t87:0.5702989265,t88:0.2410443445):0.6323631428):0.2423857229):1.011382865):0.09783801681,t89:2.180532688):0.5354924717):0.9883156071,(((t90:0.7665401095,t91:0.7146701947):2.03322433,(((t92:1.053735352,t93:0.8546518):1.146980895,(t97:0.05467662262,t98:0.003318477893):1.229808387):0.4276200899,(t99:0.3317163895,t100:0.1987593259):1.324429247):0.09321785092):0.5074983686,(t101:1.446930291,t102:1.435661118):0.6577924934):0.3152927369):1.109277646):1.685602375,((((t103:0.2466068891,t104:0.2291989186):0.209973446,t105:0.2535174055):0.6916595007,((t106:0.1366841393,t107:0.07160848383):0.6336046315,((t108:0.1026602702,t109:0.01142160575):0.2457579011,t110:0.1994772733):0.3562555905):0.06231050422):0.8487869471,t111:1.447712228):3.145176275):0.6596271488):3.023223687):0.2395910379,((((t112:0.6467252396,((t113:0.06966583625,t114:0.01454511293):0.04181588438,t115:0.02978679217):0.4866582875):2.789941464,(t118:2.553280367,t119:2.53404402):0.5273035058):1.605242299,((((t120:1.985578828,(t121:1.204025991,t122:1.200897185):0.5248925991):0.1139589525,(t123:1.040337641,(t124:0.2420441344,t125:0.1687530502):0.3870959608):0.7259563727):2.408926188,(t127:1.972773334,((t128:0.03887853148,t129:0.03102285862):0.7632436676,t131:0.3452850255):1.168608657):1.272937174):0.01131934174,((t132:0.3119452162,t133:0.2286233766):1.575919028,((t134:0.7375385915,t135:0.7070705299):0.4786839476,t136:1.185026051):0.4042124283):0.5316457774):0.1076752756):2.636636519,((t137:1.327038918,t138:1.305096333):2.962091015,(t139:2.433517182,t140:2.418589203):1.747237593):0.4447822533):0.8068685711):0.05875562987,(((t141:2.288534998,(t142:0.3999026183,t143:0.3360974637):1.745622386):1.146778934,((t144:1.374845672,(t145:0.1261798687,t146:0.05640086053):1.219317925):1.653665233,(t147:1.017500705,(t148:0.6075420779,t149:0.4033624846):0.2236512377):1.749207091):0.02881852998):0.78678906,((((t150:0.8958710599,(t151:0.2797042252,(t152:0.1878147422,t153:0.1445025167):0.007046290234):0.3116032425):1.044259726,(t154:1.170933133,(t155:0.3046608735,t156:0.2792018829):0.8157431017):0.2761212615):0.05905681228,t157:1.119879836):0.4071048457,t159:1.184663094):0.7513026114):1.127019018):1.236012517):1.141051012,(t160:0.2885133063,t161:0.1633052442):5.026420431):2.493444466,(t162:0.3726439321,t163:0.1980806625):7.137078445):2.35908547,(((t164:1.062127647,t165:0.8566425509):0.3189373805,(t166:0.7540738993,(t167:0.5280085952,t168:0.4796991251):0.09473837544):0.1749709925):2.942493905,(t169:1.674089908,(t170:1.013202061,t171:0.9683389064):0.347827733):1.909619973):5.272437427):1.506418339,((((t172:0.7889435262,t173:0.6199339752):3.175929218,t174:3.782381652):1.353940908,((t175:3.208701534,t176:3.020763722):1.495422006,(t177:3.374707266,t178:3.271666524):0.9637293277):0.3773722573):1.691668966,(t180:4.174673086,(t181:1.173067116,(t182:0.1570303557,t183:0.1133409744):0.7889236636):2.980075403):1.682034073):2.97689252):5.378068893):0.395591177,((t184:7.018365836,t185:6.984225795):5.032715811,((t186:4.495205617,(t187:0.4086018367,t188:0.379015556):4.025713089):5.174101062,((t189:2.913859233,(t190:1.74132363,t191:1.528936079):1.110995484):3.229264749,t192:5.863837569):3.415542843):2.344731851):2.263725835):5.438195143,(((t193:11.5973534,((((t194:5.749096922,((((t195:0.5788484482,t196:0.5377139362):0.8586525318,t198:1.183822302):1.51435626,t199:2.563419741):0.9288393406,t200:3.487526145):1.647942306):0.9778864075,(((t201:1.601693016,t202:1.544102679):1.476701317,t203:3.010557328):2.585056829,(t204:3.489102942,t205:3.478390168):2.078187701):0.3523639038):0.1182813016,t206:5.964247397):0.09883290863,(t207:2.962994685,t208:2.906028581):3.089437143):4.62524553):5.163167395,t209:15.51809298):1.442457359,(((((t210:6.099551976,t211:6.040195199):2.556125311,(((t212:1.063972832,t213:0.9292850406):1.425208968,((t214:0.7002657541,t215:0.6455820902):0.6273803629,t216:1.207931796):0.9540539366):0.9092352192,((t217:1.08829893,t218:0.9739593716):1.848818647,t219:2.777856213):0.04034040737):5.029661707):0.5801171739,(((((t220:2.25720308,t221:2.075186906):0.07177677266,t222:2.067644005):3.174294337,(t223:1.041140195,t224:0.8697352023):4.012169544):0.1408293341,t225:4.900274636):1.394617432,(t226:2.8479103,t227:2.844732371):2.941751651):0.9393707855):1.256810121,((t228:4.670896102,t229:4.608277471):2.867261028,(t230:2.300075284,t231:2.260265024):5.125342665):0.4054751381):0.144505911,(t232:7.446772861,((t233:0.5882636405,(t234:0.1913557737,t235:0.1751056132):0.3959660142):0.4495249473,t236:0.9944913855):6.396369176):0.3862088189):6.130122037):0.9326344345):0.1151257759):0.1293639718):1.261323676,((((((t237:2.985355817,t238:2.901003199):1.961068617,(t239:0.5444213736,t240:0.4732366113):4.155885972):3.29590807,((t241:3.41491796,t242:3.394569001):1.501406557,((t243:3.660266335,(t244:2.87805655,((t245:0.07746796204,t246:0.05272897692):1.134265132,t247:1.124659286):1.625616279):0.6313323609):0.8088010948,t248:4.063299909):0.4232056097):2.970021311):1.067567883,t249:8.246010029):0.09533102343,(t250:3.502792409,(t251:2.919304063,t252:2.816512717):0.5786381401):4.774016546):4.651389476,(((t253:1.851200827,t254:1.81730519):2.112456936,((t255:0.7692120821,t256:0.7383525074):1.707297956,(t257:0.1524721465,t258:0.08124013686):2.28805773):1.406644327):4.070926721,((t259:0.7854846302,t260:0.5844376697):0.991790483,t261:1.534178504):6.068243084):4.77054821):2.288753473):3.078112548):8.866210052):7.969103755):1.862616281,(((((((((t262:0.8511806304,t263:0.8101177115):5.687335483,(t264:5.528418171,t265:5.081155099):0.9364424719):2.568913833,((t266:3.358208755,((t267:1.200073946,t268:1.14954732):0.3346445424,t269:1.394951876):1.514951022):3.847597507,(t270:1.99418094,(t271:1.701531251,t272:1.538655264):0.2423900897):4.741568791):1.372674161):1.099767943,(t273:5.879469481,(t274:3.461604866,(t275:0.8080256559,t276:0.7888341784):2.396035085):2.263105238):2.909570725):1.114086063,((t277:4.880398532,t278:4.760110892):2.077419289,(t279:3.81056995,(t280:2.06986778,(t281:1.239724707,t282:1.215233686):0.4579600627):1.681761481):3.010752127):2.494513166):4.365142168,(((t283:10.50421299,t284:10.40260866):1.27607623,(t285:7.444491358,t286:7.326725852):4.115421068):0.6256035545,t287:11.88255251):0.7335955546):4.166549682,(((((t288:0.2680843569,t289:0.2524776793):0.7376868911,t290:0.4592204236):0.04485584852,t291:0.3466976782):11.15520094,(((((t292:1.260048325,t293:0.8255506311):6.479876679,((t294:6.776778585,t295:6.675787565):0.4394362304,t296:7.1124749):0.0378625039):1.606864002,(t297:2.414599133,t298:2.247623168):6.125879487):0.657285992,(((t299:0.2598790087,t300:0.07823709662):0.9794475482,t301:1.03773479):1.650990019,t302:2.665281882):5.96089193):0.3848802727,(t303:7.162793688,(((t304:0.3741244453,t305:0.35676885):1.284248204,t306:1.58408917):3.382397643,t307:4.647192974):2.094528354):1.795221826):1.021944262):0.7467083409,((t308:3.465704117,t309:3.228931193):1.10426104,(t310:3.769102461,(t311:0.7158169791,t312:0.6396701455):2.770822921):0.1233785682):5.663313877):3.519706081):0.2952601098,(t313:7.714504089,(t315:3.429780719,(t316:2.61529394,((((t317:1.523697569,t318:1.414743754):0.3827642079,t319:1.509112173):0.483632424,(t320:0.1735865338,t321:0.1311898254):1.806489174):0.1336003259,t322:1.985753753):0.04135845284):0.809168832):4.113003379):5.263579617):6.211384547,((((((t323:1.424058926,(t324:0.1995833369,t325:0.1386657192):1.220399106):0.646677921,t326:1.888886546):1.113363991,t327:2.73147581):2.200918755,((t328:1.17287756,(t329:0.6357778844,t330:0.5450193875):0.4931422876):1.275108316,t331:2.192385549):2.455155103):0.7806693783,(t332:3.540894102,((t333:0.08540875016,t334:0.04077323124):2.867041442,t335:2.629443701):0.4978944776):1.859053723):7.112976553,(((t336:2.416061797,(t337:0.4505577106,(t338:0.3455571533,t339:0.2636686261):0.104046944):1.887521756):0.9257424748,t340:3.099238976):3.336024176,((t341:4.328015218,((t342:1.299401724,t343:1.253509278):2.010402027,((t344:2.679756677,(t345:0.7394615446,t346:0.6716604742):1.900620339):0.3157636907,(t347:0.7667216748,t348:0.7251170582):1.947622103):0.1524135327):0.9237369527):1.24238133,(t349:2.443814502,t350:2.32224394):2.509153543):0.8551513188):4.961118051):5.139252426):10.00768537):0.7917495514):90.25502895):164.401859,(((((t351:4.196838086,t352:4.188769385):19.39828954,(t353:18.99089085,(((((t354:1.031723635,t355:0.9146473834):3.194411022,t356:3.857226678):0.8772892076,(t357:4.442932605,(t358:1.755603494,t359:1.538935724):2.647444511):0.2723428282):0.4522166089,t360:4.80694185):11.21332865,(((((t361:1.97812381,t362:1.947731834):4.663465002,(t363:5.707189365,(((t364:0.845245787,t365:0.8107817047):1.123339316,t366:1.713827031):1.258049429,t367:2.588963944):2.304011703):0.8937931911):0.9859001766,(((t368:0.3395269794,t369:0.124413157):2.569985878,t370:2.634399527):0.3810080012,t371:2.977901726):3.461490703):2.1398244,(((t372:3.959424789,(t373:2.171413727,t374:2.159944672):1.779760792):1.648940036,t375:5.486850355):1.559407685,((t376:1.420275799,t377:1.334836579):1.439341227,t380:2.21285211):4.160257958):1.364006612):5.181380638,(((((t381:3.596110827,t382:3.213032336):0.4073380111,t383:3.521845455):0.2239242139,(t384:2.781638042,t385:2.68077295):0.846131041):3.673232361,((t386:2.942202157,t387:2.868698238):1.981182719,(t388:3.210517234,t389:3.148038953):1.551129392):2.155572862):3.64674463,(((t390:1.607897044,t391:1.535461103):4.12082269,t392:5.649360377):3.828360184,(t393:2.721279732,(t394:1.179825353,(t395:0.597501699,t396:0.4650780173):0.5347519069):1.509480596):6.706743736):0.7784010127):1.278234427):0.9494553119):2.16831751):4.554386804):6.721510108,(((((t397:3.378566142,t398:3.363760133):1.252730219,(t399:0.6101146537,t400:0.5386215971):3.999632243):2.22603978,((t401:0.4736942296,t402:0.3855101891):2.065652201,((t403:0.2012411485,t404:0.1350257157):0.6539931248,t405:0.7247973447):1.583109997):4.196124809):1.490063863,((t406:4.730848477,t407:4.722706744):1.920391354,((t408:3.318798124,t409:3.290848666):0.6345365927,(t410:3.459024297,t411:3.366224214):0.4402367264):2.664326519):1.239117003):12.42940159,(((((((t412:1.80727241,t413:1.796518366):0.9945849586,(t414:1.7486395,t415:1.581792787):0.8531764018):5.718778263,(((t416:1.513484095,t417:1.328021435):0.9558084224,(t418:1.67058026,t419:1.377877218):0.3918897893):2.06452661,(t420:3.083644699,(t422:2.063201455,(t423:0.6397732634,t424:0.5469953305):1.356698524):0.7737506993):0.5834556819):3.393434496):0.6856429894,t425:7.238668097):1.8862533,(((t426:0.1606430757,t427:0.1293490958):2.660573999,(t428:0.3377715121,t429:0.3214744245):2.385937511):0.6614978522,((t430:0.6157333964,t431:0.5244821139):1.240722708,t432:1.443574595):1.34576589):5.565707905):3.67969859,t433:11.79768357):1.858180048,(t434:13.13102706,(t435:3.089664485,t436:2.84839789):9.872729507):0.438063793):3.441279025):4.873401488):17.70996939,(t437:0.5069954246,t438:0.4058159081):38.58584704):18.41892433,t439:57.34423311):214.764025);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T76.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
