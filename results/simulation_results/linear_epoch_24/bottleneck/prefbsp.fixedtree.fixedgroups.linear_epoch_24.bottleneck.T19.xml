<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t443:1.413459744,t444:1.387751396):2.615636814,t445:4.001906409):0.9976616752,t446:4.621992184):62.39905525,((t447:30.32897697,(((t448:4.230553069,(t449:2.882192454,(t450:1.336458739,(t451:0.30366079,t452:0.1819918543):0.9954621764):1.525516671):1.232594473):3.955587851,((t453:1.153366028,t454:1.02427015):0.9526486606,t455:1.970357633):5.649259549):4.822180086,((t456:6.072444782,((t457:2.535945606,t458:2.402516203):0.3319783064,t459:2.722611196):3.028213597):4.26220579,(t460:3.004688429,t461:2.61487165):6.937892503):1.904723555):17.24956437):16.45200821,(((((((t462:2.849510039,t463:2.815491015):0.09357004483,t464:2.674980159):5.904798447,(t465:6.417374459,t466:6.356841552):2.153811521):6.700221786,(((t467:5.104022554,(t468:1.426970425,t469:1.423294061):3.6432466):1.271182798,((t470:0.6442948522,(t471:0.2653676572,t472:0.2527959819):0.3210966732):4.124072305,(t473:0.6471555488,t474:0.6048309387):4.02294907):1.401113098):6.124230029,(t475:6.03446587,(t476:4.998650659,t477:4.889586647):0.8612361504):6.10290314):2.67954005):2.17161048,((t478:1.398874735,t479:1.389281312):3.339219861,t480:4.521201142):11.95867029):2.160133037,((t481:10.01098971,((t482:2.349489676,(t483:1.340516686,t484:1.275205568):0.985802539):4.34637403,(t485:1.61543231,t486:1.576318946):4.96221247):3.274451239):3.538584951,(t487:0.8159991731,(t489:0.2355303559,t490:0.2321968469):0.2442971157):12.49025338):4.929313387):21.72093082,(t491:1.659029801,(t492:0.5123085594,t493:0.2921489398):1.097938122):37.81972468):3.52866784):20.09004021):31.08047469,((((t488:0.0671949165,(t434:0.1972710559,(t422:0.04301308952,(t406:0.03874437802,(((t374:0.239232433,(t359:0.08115809436,(t319:0.1038410455,((t288:0.4027242328,((t257:0.2278982479,(((t190:0.003332370354,(t185:0.004926326512,(t184:0.07391804674,(((((t155:0.008893791363,((t140:0.1286434126,t141:0.01702366767):0.2513315525,(((t133:0.06590026113,((t123:0.063155193,(t117:0.09749866241,((t113:0.00922847298,(t1:10.04739617,(((t2:2.882349139,t3:2.857283795):6.222765007,(t4:7.981771489,(t5:0.8500376871,t6:0.5303063812):7.111979457):1.018331872):0.2620481793,(((t7:1.741990023,t8:1.640752097):5.81195907,(t9:5.230879791,t10:5.168141302):2.174750088):0.6801029296,((t11:3.448932643,t12:3.332282022):1.732381848,t13:4.728938075):2.691414):0.4936209471):0.5304494482):1.032565184):0.05762875724,(((((t14:3.3277031,(t15:0.8626203534,t16:0.8468446808):2.163056471):1.322307275,t17:4.092948013):2.19487307,(((t18:1.059413072,t19:0.9978063759):0.978939645,t20:1.90906531):1.762994594,t21:3.579420399):2.323155218):1.650629073,(t22:6.42198445,t23:6.379569169):0.959735683):0.4213442802,(t24:3.550034422,t25:3.516747081):4.155868286):0.3212394615):0.6434013096):0.6455601757):0.5476789977,(((((((((t26:3.93699461,((t27:0.3068259523,t28:0.2998921127):2.690741666,(t29:2.60108376,(t30:0.2667037474,t31:0.2110401608):2.31383322):0.3113493368):0.9295772699):1.23407638,(t32:3.390334682,t33:3.325930316):1.523257714):0.4245719424,t34:5.139498431):1.478548574,(((t35:4.904504247,(t36:3.653868616,(((t37:0.5925229632,t38:0.5840139298):1.018294093,t39:1.368583166):0.8128094893,t40:2.169725473):1.117680144):1.209486385):1.382420087,((t41:1.210786708,t42:0.9755289056):2.429251175,t43:3.358682119):2.120413061):0.1544807156,(t44:5.367999939,t45:5.353372216):0.1319010206):0.1322349898):0.01897727489,(t46:0.4530290799,t47:0.3983986276):5.146550935):1.386782118,(((t48:4.074149542,t49:3.888200872):0.9506111181,(t50:1.729303496,(t51:1.142315307,t52:0.8248634308):0.4784805759):3.041306132):0.8708829278,(t53:4.352387143,(t54:4.199895565,(t55:1.355327183,t56:1.236628227):2.793899125):0.1208174074):0.7619797241):0.898283022):0.9539093675,(((t57:1.814697659,(t58:1.019486102,(t59:0.3336466165,t60:0.3158991733):0.6108275185):0.7283258983):2.238229375,t61:3.871093159):0.5118164175,((t62:3.301809696,t63:3.293135948):0.05962126519,(t64:0.570136121,t65:0.5097931972):2.587649313):0.7497412445):2.017325216):0.0536999393,((((t66:2.422832769,t67:2.394710018):1.328180526,((t68:3.442608222,(t69:2.815242204,t70:2.71969127):0.5186546271):0.04007461938,(((t71:1.835528217,t72:1.777513619):0.8015697651,(t73:1.543086866,t74:1.464961494):1.007820035):0.03103763486,(((t75:0.1906272768,t76:0.1072054388):0.9251662652,t77:0.9710997171):1.181077154,t78:2.035620954):0.003936241414):0.3137819965):0.1868799975):0.1802686556,((((t79:0.3566297004,t80:0.2633774006):1.355121245,t81:1.59246932):0.271904497,(((t82:0.7722252392,t83:0.734445848):0.1590232407,t84:0.888895526):0.7031690804,t85:1.505680933):0.226104075):0.410702624,((t86:1.214245805,(t87:1.202479629,(t88:1.153841481,t89:1.140335587):0.01048281812):0.003846263256):0.6050218325,t90:1.613306377):0.243438646):0.3132713127):0.1280236087,(t91:1.023270895,(t92:0.2828957135,t93:0.1152734346):0.6552201833):1.232931135):1.538649917):0.06557176332,(((t94:0.611106932,t95:0.4690373664):0.3864609218,(t96:0.3096110647,t97:0.1875238263):0.3032236821):1.527125893,(t98:1.918877307,(t99:1.356177428,((t100:0.07838245877,t101:0.001600988906):0.1567706346,t102:0.08978290196):1.095006426):0.3695710031):0.09635518046):0.9814289643):0.02150665652):0.2415842106):0.1622211347,(((t103:1.386580283,(t104:0.5953710597,t105:0.5297514089):0.7438882832):0.990283657,t106:2.245400619):0.1819244735,t107:2.298950672):0.3580946288):0.7767512003,(((((t108:0.1163901525,t109:0.1069617868):0.8773212734,t110:0.8863467192):0.9303997143,((t111:0.2434158549,t112:0.2203828688):1.28695675,t114:1.180087714):0.2375847227):0.9550980979,t115:2.005113951):0.1126310169,(t116:0.8886924869,((t118:0.2696648914,t119:0.1882444503):0.2111618304,t120:0.203199033):0.2233250202):1.205423175):0.4117879605):0.266034086):1.396686743):0.7825724987,(((((t121:0.1424005809,t122:0.1068868474):0.5322048955,t124:0.5320868965):1.713120684,((t125:0.4886222088,(t126:0.4176828041,t127:0.337174417):0.05725645572):1.587881419,((t128:0.3831529357,t129:0.3671842707):0.1058414572,t130:0.3705221981):1.402312635):0.01881708878):1.191000717,t131:2.929183471):0.48633637,(t132:1.149583287,t134:1.051793319):2.094519138):0.2238453649):0.8063916212,t135:4.105379244):0.1131608304,(((((t136:0.1096418789,t137:0.0117854141):0.5806631242,(t138:0.5101601892,t139:0.1623364915):0.03674628126):1.287448346,(t142:0.3880797506,t143:0.2557640372):0.4554345419):1.251041163,(t144:1.439091783,(t145:0.517610864,t146:0.4784568774):0.8564015015):0.4781518831):0.6411014722,(((t147:0.1854711697,t148:0.03064834565):1.302947203,t149:1.24169929):0.3081080336,t150:1.462378155):0.4556885838):0.2954263099):0.8008054082,t151:2.916696402):0.3997856538):0.03451918437):0.4639121803):0.6879864697,(((t152:0.08873128304,t153:0.01384069789):0.5330631697,t154:0.5370730542):2.065489008,((t156:0.5863110899,t157:0.5342674843):1.089216727,(t158:1.460308769,(t159:0.5478359656,t160:0.5096337208):0.791577471):0.1091560394):0.5936170878):1.581812264):2.573169308,(((t161:0.4316706013,t162:0.3866554762):1.182149923,(t163:0.2991419508,(t164:0.2459712744,t165:0.2433384096):0.03972701832):1.208316748):0.4874063091,(t166:0.2249287369,t167:0.05641624304):1.357204741):3.957142596):2.218958427):0.5334316069,(t168:5.009128216,(((t169:1.192660502,t170:1.02526934):1.826471233,(((t171:0.7917407143,t172:0.7877061169):0.8569616819,t173:1.521294723):0.01285335868,((((t174:0.3789671343,t175:0.2353284419):0.1159799798,(t176:0.2617283146,(t177:0.02478247677,t178:0.01600098779):0.1390510025):0.0550768139):0.5524899715,t179:0.7334401134):0.0227007892,(t180:0.1588725991,t181:0.1500764963):0.5207892159):0.4232741621):0.9710629639):0.3291122179,t182:2.390219251):1.514647566):2.783993936):3.381787818):0.2405891478,((t183:9.345724595,(((t186:0.6016263539,t187:0.3935766947):2.79037667,((((t188:0.618295,((t189:0.5764357118,t191:0.3798776256):0.0201485766,t192:0.3068777392):0.007679333554):0.2173605405,t193:0.3677593114):1.720711596,(t194:1.388834282,t195:1.247508176):0.6582340597):0.2573064761,(t196:1.571143014,t197:1.544302595):0.5417408245):0.3042666761):4.686687036,t198:6.985836982):1.075455267):0.1207144562,(t199:3.055578481,t200:2.977232857):5.016916332):0.7793879458):3.018448734):3.708595341):1.155509059):1.183769041,((t201:11.09179398,((((t202:2.501249777,t203:2.436934344):4.242333372,t204:6.641456798):2.48429585,(t205:1.087146066,t206:1.031796819):8.028909839):0.3922386598,(((t207:0.9623273397,t208:0.8952184371):0.06304972526,t209:0.7609527666):3.686688727,((t210:1.616907494,t211:1.548800764):0.6206552095,(t212:1.94956755,t213:1.902130574):0.05321310766):2.110916012):4.702247909):1.387375282):4.942241689,(((((t214:2.355532383,(t215:2.010052204,t216:1.960216356):0.2049382842):1.423603701,t217:3.574038644):0.5274085549,t218:4.078140868):3.623380749,t219:7.651231089):3.147312519,(t220:9.980349168,((((t221:0.4255899229,t222:0.4251203277):0.4056911305,t223:0.7994966013):0.5003650236,t224:1.23155379):0.1406961149,t225:1.138510805):8.477648838):0.4833436323):3.973791906):1.748204342):0.2263124289,((((t226:2.107735698,((t227:1.050793384,t228:1.02553952):0.1638854844,t229:0.9008983965):0.8241114929):1.566174593,(t230:2.037130781,t231:1.996311251):1.092564863):3.599345427,(t232:2.013171913,t233:1.999999031):4.645467983):4.541804536,((t234:0.9930756898,t235:0.9744622852):7.328276882,(((t236:2.875486012,(t237:1.415544445,t238:1.334125893):1.454294463):0.5107740843,t239:3.288341534):2.414546266,(t240:1.730290945,t241:1.697393771):3.970725155):2.440089256):2.811718627):4.140592919):1.370804082):1.522913097):1.473358377):4.681207091):0.8443222654,((((((((t242:0.3189890971,t243:0.3180344794):6.509582223,((t244:1.895288411,(t245:0.7001142097,t246:0.6095975619):1.176605255):2.723997399,(t247:0.64015647,t248:0.5859665687):3.665372822):2.144444887):6.459591961,((t249:5.853338087,(t250:2.318763,(t251:0.9275992557,t252:0.9194655495):1.13789433):3.53327986):3.577398967,(((((t253:1.746834975,t254:1.740493258):2.194923585,t255:3.899125189):1.806426398,((t256:2.69757514,t258:2.252796013):1.564636099,(t259:2.244541311,t260:2.15053051):1.289293364):1.417991845):0.6111877579,t261:5.360649925):0.3759664853,(t262:1.696232651,(t263:1.479499351,t264:1.203771278):0.1781746479):4.001197114):2.252711831):3.125236271):6.144344574,((t265:4.243784559,t266:4.132063995):9.375346067,((t267:6.617681021,(t268:4.824067324,(t269:0.7525103881,t270:0.6810657067):4.065868381):1.260285612):0.4821185496,(t271:3.061110848,(t272:0.3313341939,t273:0.2709597598):2.716191042):3.403451092):6.22125937):3.102578286):0.6636602212,(((((t274:11.12867802,((((t275:1.712819234,t276:1.574016469):7.209835004,((((t277:2.406377796,t278:2.369407573):1.194081891,((t279:1.661824789,(t280:0.1896381816,t281:0.08877439799):1.375624497):0.002412671333,t282:1.406384582):1.672151042):1.393854894,(t283:0.6443680108,t284:0.4515637036):3.783078413):1.23852603,((t285:0.7478740625,t286:0.7080577718):2.944443453,(t287:3.452411057,(t289:1.168137297,t290:1.158412439):1.618829731):0.1884685622):1.758058855):2.51249818):0.3557836317,((((((t291:5.511361441,((t292:0.7052322555,t293:0.6602249079):0.6307142173,t294:1.245056514):4.128607804):0.1638551497,(t295:3.211850192,((t296:0.377978571,t297:0.3399492104):0.8778232618,t298:1.208581822):1.703356464):2.2829694):0.04267111834,((t299:4.265367771,t300:3.972566439):0.7622162449,t301:4.44698288):0.194927865):0.7888274187,(t302:4.414545895,t303:4.335904088):0.9635483316):0.5201498569,(t304:4.849845491,(t305:2.33401846,t306:2.293406386):2.324315866):0.9663878327):0.2978936736,(t307:1.619914523,(t308:1.30288799,t309:1.212352681):0.2641844178):4.254574883):0.1276198085):1.373133061,((((t310:0.09672733479,t311:0.02450980049):0.8333312844,t312:0.8514652981):1.649976051,t313:2.356752761):3.406531807,t314:5.435202947):1.237003418):0.2846286349):0.7325794611,((((t315:1.09188252,((t316:0.8453718354,t317:0.8039840288):0.02846272186,t318:0.5409870212):0.2158799671):0.8630251874,(t320:0.5389576275,t321:0.5088332445):0.7396825994):2.671367112,t322:3.718532214):1.970786056,t323:5.681567042):0.963387875):1.180244064,((t324:4.389699806,t325:4.247827071):1.58369804,t326:5.82500333):1.720053281):0.09973518966,(t327:7.194984592,(t328:6.450024889,((t329:3.052923927,(t330:1.033740496,(t331:0.8310874685,t332:0.790980209):0.1404371031):1.995401184):0.3283857489,t333:3.226271891):2.934633224):0.6193120914):0.442394388):0.4544322201,t334:7.592904202):2.645973405):1.475221837,(((t335:0.3851753727,t336:0.3079342672):7.220037586,((t337:4.383661471,(t338:1.266042021,t339:1.233785898):3.060854717):0.7538637978,(t340:1.728346703,t341:1.325303834):3.281579223):2.35179237):1.683417011,(t342:4.584293342,(((t343:1.830471046,t344:1.755968322):0.5810116236,(t345:1.768573742,t346:1.735832027):0.5674951783):1.028346563,(t347:2.355359981,t348:2.350349524):0.9113075105):0.9590071088):4.002564326):2.386899133):0.8415797711,(t349:3.513067781,(t350:3.151437442,(t351:2.16649713,t352:2.10752291):0.925779745):0.1379578979):7.694108661):0.3372105723,(t353:7.402123408,((t354:2.944519199,t355:2.783096633):1.053680435,(t356:1.038540561,t357:0.6743857262):2.762070677):3.349923101):3.793043499):2.148131869):18.31642038,(((t358:2.860592895,t360:2.642394483):10.92756122,((((t361:1.609848171,t362:1.483146669):2.531502714,t363:3.843586214):2.220501671,(t364:0.5479197051,(t365:0.2087287037,t366:0.1368049421):0.2691222881):5.510920644):7.03040782,(t367:0.8372939307,t368:0.8371234539):11.97450363):0.1303454579):2.08913335,((t369:5.577658643,(t370:3.305275379,((t371:0.1498793765,t372:0.1074438711):2.579395165,t373:2.631828794):0.5485726328):2.264197312):7.377124067,(((t375:1.450612398,t376:1.440252075):1.321997425,t377:2.721098724):0.8646761002,t378:3.517359105):8.875120222):1.994379043):15.09513701):30.18572367,((((t379:0.4053545874,t380:0.353790172):2.941188207,(t381:1.138029491,t382:1.067162515):2.14032044):4.606399605,(((t383:2.41643696,(t384:1.839408495,t385:1.572837966):0.4524397424):0.7528503618,(t386:2.353341912,(t387:0.09666852154,t388:0.008120640312):2.159144032):0.4075985106):4.227109298,((t389:0.5951274041,t390:0.4706067632):4.919900404,(t391:5.017452377,t392:4.82237445):0.3518425912):1.185892956):0.4144178862):5.419059817,((((t393:1.585870489,t394:1.469129363):0.09654078306,t395:1.549692558):3.27894405,(t396:2.967801424,(t397:2.623887613,t398:2.608134484):0.3239840592):1.669891641):2.139061124,((t399:1.374991384,t400:1.302905083):2.921963111,t401:3.893974594):2.406983629):5.009207038):46.10444761):45.21848964):30.61060073,(((((t402:1.214355836,t403:1.026213648):2.922617973,t404:3.911927207):2.674977287,((((t405:0.4804736344,t407:0.2708198541):0.5165312418,t408:0.7266139838):2.165147336,t409:2.774025301):1.440913649,(t410:2.176662281,t411:2.141770405):1.987825693):1.934681998):3.513101329,(((((t412:0.4996773693,t413:0.3935011764):0.7907008283,t414:1.170324311):5.00570075,(t415:0.1890506975,t416:0.1680830799):5.986117744):0.6833990166,t417:6.799395042):1.370200612,(t418:2.886233892,t419:2.738621664):5.186635647):1.222967096):8.394547214,(((((t420:2.450109703,t421:2.090005537):2.552868726,t423:4.13268698):3.544168177,(((t424:1.991798154,t425:1.753253736):1.391790732,(t426:2.992200621,((t427:2.361806836,t428:2.318349081):0.3910526816,(t429:2.59674253,((t430:0.5321730085,t431:0.4815742167):0.2977311311,t432:0.7401710205):1.425341893):0.07150713085):0.1789133451):0.113372513):1.235046168,t433:3.694636577):3.044330981):1.851003389,((t435:1.472769286,t436:1.42592035):3.620231865,((t437:0.4108866147,t438:0.3278918966):4.17457628,(t439:0.4783964069,t440:0.432053966):3.841844402):0.4058118538):3.049467097):0.1314866049,(t441:3.305937813,t442:3.223025786):4.471980578):6.941340301):114.4909916);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T19.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
