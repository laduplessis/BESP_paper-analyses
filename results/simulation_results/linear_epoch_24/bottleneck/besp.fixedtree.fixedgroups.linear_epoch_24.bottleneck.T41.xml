<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t461:0.491792513,t462:0.3739805133):5.346978405,(t463:5.483984227,(t464:0.936873207,t465:0.7573406139):4.52494321):0.2347763512):2.451282118,(((t467:0.5113377353,t468:0.487105134):0.1604183175,t469:0.5802344125):3.375896482,(t470:2.879554744,(t471:0.8779513746,t472:0.866063082):1.815798199):1.033812708):3.779946922):13.65623282,(((((t473:2.388909505,(t474:1.39376778,t475:1.068466612):0.9558903355):0.3878159818,t476:2.382258762):3.545697861,t477:5.836213513):4.594765964,(t478:0.9701454392,t479:0.9206069148):9.412334079):9.01225517,((t480:11.6246629,(t481:8.647091008,(((t482:1.710669166,t483:1.502360751):3.961830245,t485:4.949529045):2.875828403,((t486:3.68768829,((t487:1.093079962,t488:0.8139001109):1.945650753,t489:2.398760735):0.6405309766):0.3584365851,(t490:0.797383914,t491:0.7616063052):2.575842958):3.74411347):0.0004919961297):2.867504413):0.7870551909,(t492:2.934856293,t493:2.819650621):7.758009968):6.829211859):1.115990229):5.636328115,(t494:0.6997788914,(t484:0.04550208749,(t466:0.03957280521,((((t384:0.1741958106,(t385:0.01529094899,((t334:0.0148043903,(t331:0.1106353167,(t318:0.01839947319,((t275:0.07952905336,(t271:0.03039449077,(((t188:0.3855169642,((t170:0.06462380665,(t167:0.003626026111,((t159:0.03160637306,((t133:0.2898477825,((((t104:0.2118156761,(t101:0.06954142374,(((t96:0.03573310858,t97:0.002634601375):0.09350003524,(t90:0.06148157866,(t55:0.00233616025,t1:5.463200708):3.434757796):1.137813753):0.2019498834,(t2:2.897524235,t3:2.507007674):7.315337964):0.1912054592):0.473610271):0.445547924,(t4:10.26284332,t5:10.13514243):0.6656315211):0.1036010843,(((t6:1.669081174,t7:1.603003948):6.387324142,((t8:1.721711893,t9:1.712510245):2.25216143,(((t10:0.8222450024,t11:0.7778253747):1.587838529,(t12:0.2441650733,t13:0.2381384486):1.844209668):0.2090038746,t14:2.290905723):0.7681204301):4.007281879):1.836005674,((t15:5.572812308,(t16:4.498174128,t17:4.296130432):1.068672746):2.692542743,((t18:3.348272988,t19:3.331062467):0.06958625486,(t20:3.245631797,t21:3.050456306):0.02328125855):4.525925707):0.6235246026):0.7687342161):0.9698441788,((((t22:0.8732820676,t23:0.8290691885):6.227138948,(t24:0.05445704257,t25:0.003860552999):6.882492124):1.152369111,((((((t26:1.751814784,t27:1.75113771):2.141752546,(t28:1.598307888,t29:1.593237671):1.92328087):0.9157077281,(t30:3.87593367,(t31:0.7852151982,t32:0.5931595486):3.059492495):0.4293298638):1.91773699,(t33:2.88926396,t34:2.844017671):3.00097161):0.1918901657,t35:5.91195441):0.5786872942,(t36:5.876706586,(((t37:3.545353689,(t38:3.480591971,t39:3.47004802):0.03259313515):2.252433184,t40:5.537012591):0.0299538444,((t41:0.9118264288,t42:0.895211439):1.996244558,(((t43:1.447224958,(t44:0.9226701494,(t45:0.06794760936,t46:0.01906194352):0.8050966302):0.3967413207):0.698048008,t47:1.880685829):0.4870617822,((((t48:0.6163145987,t49:0.5874202003):0.02146620469,t50:0.5099065561):0.329348533,t51:0.8174900461):1.166913565,(t52:1.635495654,t53:1.582693465):0.2358553688):0.2006222067):0.1579004138):2.59098806):0.007663469829):0.6079879934):0.3840830017):0.1292630776,(t54:5.416860316,((((t56:1.151596873,t57:1.131522245):2.238301851,t58:3.255169588):0.1519556888,((t59:1.262966619,t60:1.205288515):1.055414283,(t61:0.5846586997,t62:0.5198606292):1.560238479):0.6867976153):1.529014487,((t63:2.031377181,(t64:0.8893774988,t65:0.5604774997):1.067471691):1.73513692,(t66:3.247340448,t67:3.228189338):0.1011395328):0.5250608283):0.06068615058):0.3984508221):1.179815674):1.239452872):2.982824225,(((t68:3.138560652,t69:3.122285763):4.304065192,(((t70:3.447938036,(t71:2.712635874,(t72:1.996493797,t73:1.971767514):0.6795921709):0.5791073623):2.872481887,((t74:4.392557117,(t75:2.960893272,(t76:2.042352936,(((t77:0.5775622943,t78:0.4710075793):0.02748876311,t79:0.4617810137):0.9137245318,t80:1.330801568):0.284178853):0.8659762597):1.400256566):1.427781248,t81:5.298977601):0.2550939187):1.063535021,((t82:3.266279009,(t83:2.146189644,t84:2.102988569):1.06400257):2.859767929,((((((t85:0.4783045881,t86:0.391873794):1.898962408,((((t87:1.466333134,(t88:0.4226018291,t89:0.407664079):0.9813280493):0.3674989673,(t91:1.083464744,t92:0.9441780853):0.1448679304):0.004851136124,((t93:0.5691984099,t94:0.4845777502):0.1783644127,t95:0.4820758013):0.1058213235):0.1237419299,(t98:0.356692282,t99:0.3490854623):0.02420776723):0.07000299978):1.643180398,(((t100:0.735146587,(t102:0.1091620914,t103:0.08795125566):0.2254729225):0.06884637662,t105:0.0718986227):0.8126285085,t106:0.6388772546):0.332680344):0.01161791908,t107:0.8253296038):0.5338174558,t108:1.33431022):0.4466908737,((((t109:0.3587381943,t110:0.3475456983):0.04600087531,t111:0.2896628499):0.291301514,t112:0.5406779603):0.8179595448,(t113:0.2329716551,t114:0.228632965):1.057568807):0.1705151432):0.9285695751):0.4412715991):0.01376480521):0.7356064425,((t115:0.9957968271,(t116:0.5997069818,((t117:0.2078730893,t118:0.1454475755):0.187448097,t119:0.2120396836):0.1876680841):0.3636448811):2.499045413,(((t120:0.3891421255,t121:0.3767921316):0.05328725227,t122:0.07543750162):1.010962701,(t123:0.4696126777,t124:0.4488280263):0.5260638906):1.424672955):0.0677378901):1.350519383):0.6125262748):0.5460988282,(((t125:1.844216985,t126:1.775436574):1.845470559,(t127:3.048104232,(t128:1.380387284,t129:1.331888147):1.602548992):0.5369667683):0.03089880313,((t130:2.259564818,(t131:0.623313939,t132:0.5214177499):1.605343374):0.429813828,(t134:0.4574163775,t135:0.3878132524):1.587097094):0.7788838021):1.188573928):0.2198349078):0.1504814281):1.205606311,((((((t136:0.5259183569,t137:0.2694180481):0.3089739735,t138:0.4884761383):0.04664184593,(t139:0.2551114894,t140:0.1973569439):0.2229277789):2.21816802,(t141:1.168800739,(((t142:0.5594495586,t143:0.462520712):0.0261093329,t144:0.4252017696):0.2453642669,t145:0.4336140544):0.1655289434):1.153665926):1.029023904,(((t146:0.6557622674,t147:0.5479205201):0.1829662055,t148:0.5461969035):0.2010622738,t149:0.6934184217):1.575524567):0.2993185141,(((t150:0.4849675625,t151:0.4157820643):0.6704598499,t152:0.9100471877):0.08687646223,t153:0.9025955277):1.077366661):1.013746948):0.5190603337):5.451493467,((t154:1.952750555,((t155:0.5664520012,t156:0.1693703788):1.158190902,t157:1.278670291):0.2105009338):2.398839742,(t158:3.01614619,(t160:1.893253512,(t161:1.748483674,((t162:0.3672452855,(t163:0.2168548426,t164:0.1294689711):0.06851660923):0.6216809203,t165:0.7373281024):0.6642495719):0.12335282):0.8096691155):0.8514926952):4.399192695):0.8352408728,(((((t166:0.2335180792,t168:0.1068900952):1.434413948,t169:1.522310916):0.04878817686,t171:1.442387737):0.2401038595,t172:1.467181656):4.931156863,(((t173:0.5487100406,t174:0.4870258578):0.7642601784,(t175:0.5011702657,t176:0.3584843098):0.6930942015):3.970007497,(t177:0.5432815828,t178:0.5134341164):4.407588878):1.088139265):1.333698702):0.617917766):0.2409570379):0.8108830864,((t179:0.4720612613,t180:0.3816800632):6.755214748,(t181:0.1065340292,t182:0.08796096065):7.008293864):1.743939077):2.847050907):1.36304414):0.1855766031):0.8996658432,(((t183:0.1326440122,t184:0.103095857):7.239978249,(((t185:1.34987611,t186:1.349684755):0.6706368403,t187:1.999485908):3.234010364,(t189:3.286176357,t190:3.10445207):1.323539079):2.057426383):3.802514031,((t191:4.34318967,t192:4.294399843):0.8608819734,(t193:1.908799242,t194:1.8521499):3.18808949):5.000691955):2.639604756):3.578354359):0.1361392904):6.249374381,((((t195:7.813857796,(t196:0.914552127,t197:0.7981118644):6.898442298):1.549236699,((t198:0.6822347809,t199:0.4795987439):7.006547562,t200:7.462640741):1.54813664):0.8434020684,(t201:7.292091461,(t202:4.351157935,t203:4.28616207):2.790305991):2.431880698):0.1071218286,(t204:0.8369284271,t205:0.7791170845):8.610405845):12.27362832):0.6239609493,(t206:1.970012261,t207:1.953622641):20.31548445):0.6674687773,((((t208:4.157119256,(t209:2.948600531,t210:2.800569096):1.17509233):0.6141477281,((t211:1.677789513,t212:1.38942017):1.168902951,t213:2.556566921):1.630590252):4.934002354,((t214:0.6937302073,t215:0.6344241008):5.637534728,((t216:4.706499503,t217:4.545333689):1.370375971,((t218:2.338171697,t219:2.33278231):0.7200567225,t220:3.042272684):2.597982916):0.1318310004):2.739398183):12.89531802,((((((t221:2.087568757,((t222:0.5858845712,t223:0.4393012776):1.192341938,t224:1.623541975):0.2963279128):1.200570494,t225:2.913683964):7.09212948,(((t226:2.488446285,t227:2.468069196):0.4304105356,(t228:1.705435788,t229:1.658016732):0.9781554729):5.487441192,(t230:5.715608753,t231:5.626572931):2.242280419):1.498600027):1.041817901,((t232:5.384475829,t233:5.337046438):4.777662427,(t234:4.889527373,(t235:3.244963291,(t236:2.757143534,t237:2.722433175):0.3843802101):1.607928448):5.219163108):0.2437801904):5.842459446,(((t238:5.207607542,t239:5.150772381):0.8223501223,(((t240:3.572676805,t241:3.530273549):0.1969852297,t242:3.653533192):0.2181029143,(t243:1.03171941,t244:0.9895731887):2.837717585):1.902598831):1.276313152,((t245:3.853687811,(t246:1.302608844,t247:1.239842973):2.277245788):1.385115441,((((t248:0.2019861204,t249:0.08118806206):3.594113331,(t250:1.088472646,t251:1.077032289):2.441807731):0.6410850089,((t252:0.3231950115,t253:0.1527642427):2.721374693,((t254:0.4137812153,t255:0.2721040504):1.745126392,(t256:0.9753145625,(t257:0.7737925742,t258:0.7398145608):0.1476231919):0.7697432513):0.7041362661):1.085694682):0.3997286901,((t259:0.7967834101,t260:0.7639446334):1.696872307,t261:2.389050051):1.247232234):0.0629702445):1.73186562):8.68210386):2.112170128,((t262:3.353187771,t263:3.266367334):7.719470698,((t264:1.193957105,((t265:0.6407065027,t266:0.5816546379):0.03815006738,t267:0.5944148616):0.3896971644):7.517729249,(t268:3.431132523,t269:3.2832608):4.926804334):2.220121569):5.14834775):2.016414985):0.2122388419):0.1838811032):1.636783378):2.209683069):23.31588221):26.06997819,(((((((t270:6.91723311,(((t272:4.348556037,t273:4.281147165):1.373360443,(t274:1.976102742,t276:1.835582698):3.64394681):0.3972316093,(((((t277:1.327665442,t278:1.259967297):0.6195989053,(t279:1.439443464,t280:1.284388204):0.2162772092):2.033100111,t281:3.513256531):0.1862190716,(((t282:0.6930981646,t283:0.6860060492):0.9590137889,t284:1.619346342):0.8512832837,t285:2.406914774):1.127588251):0.7124249439,t286:4.223273227):0.9202333886):0.6138098255):0.9959840118,(((t287:2.440980787,t288:2.389793301):2.966070513,(t289:3.168120068,((t290:1.228609223,t291:1.190724138):1.407191639,((t292:0.5283370693,t293:0.4938837914):0.4977766452,t294:0.9207302048):1.554528121):0.4384683035):2.123124445):0.4531329026,(t295:1.476008026,t296:1.339374914):3.898164138):0.8928569855):0.5731944719,t297:6.634918301):3.281169961,(((t298:2.711906067,t299:2.687426582):1.899029332,t300:4.492620036):0.4293964893,(t301:3.523138975,((t302:2.16864851,(((((t303:0.7215659832,t304:0.6071619074):0.2773799491,t305:0.7994082272):0.09689505382,t306:0.7736966561):0.05499632263,t307:0.8031340107):0.8767997917,t308:1.490501787):0.05379818575):0.5771592934,t309:2.007278558):0.7685748629):1.382572493):4.810042584):2.83675052,((t310:2.328823933,t311:2.226331882):7.211223222,((((((t312:1.579157331,t313:1.276871698):1.907375163,t314:2.94904161):0.07389167642,((t315:0.4773509973,t316:0.2699376098):1.206207452,t317:1.421687954):1.321225266):1.579481981,(t319:0.9469672097,t320:0.8822664311):2.82755397):1.300422546,(t321:2.548146047,t322:2.471560811):2.452636952):0.09484197575,t323:4.890242896):2.748357863):2.262580903):4.082624173,((((t324:5.010604094,(t325:1.651585775,(t326:0.5883114328,t327:0.5554100391):0.999215321):3.355006595):1.340053305,(t328:0.275496581,t329:0.2706196708):5.885984708):1.121587132,((t330:1.288888596,(t332:0.289323685,t333:0.1761677766):0.58088007):0.7579271972,(t335:0.3845056605,t336:0.3019959146):0.8367943476):5.122480658):0.8283250167,t337:6.884825541):5.624755377):20.01519235,((t338:8.563220077,((t339:1.522399828,t340:1.510310587):0.3353635318,t341:1.723977847):6.574594722):10.05419347,((((((((t342:4.399510867,((t343:0.122658421,t344:0.02161677196):3.693151024,(t345:1.733585398,t346:1.716393518):1.766136435):0.4747791401):0.4232038677,t347:4.347342207):1.019456113,(t348:0.03781528048,t349:0.03351186517):5.292376836):3.98096625,((((t350:2.703493706,t351:2.703035466):2.533701546,(t352:1.209626104,t353:0.8687635305):4.011262114):2.70585803,((((t354:1.171368236,t355:1.146730856):2.916449429,(t356:1.810169922,t357:1.759803319):2.076668965):0.09899534936,((t358:2.156728402,t359:2.132262771):0.1534001251,t360:2.280754868):1.558353975):2.323508608,(t361:1.913850073,t362:1.748500418):4.138065033):1.051099248):0.4267022619,(((t363:1.02685774,(t364:0.7003390025,(t365:0.4376849438,t366:0.3105589071):0.2166390406):0.1917781933):2.676894924,t367:3.371641111):0.3307599964,(((t368:1.651166945,t369:1.58615592):0.6525699115,(t370:1.119514186,(t371:0.3075531501,(t372:0.06267004617,t373:0.05459825106):0.181190151):0.8053742202):1.068498999):0.5155575685,t374:2.579459909):0.7743789393):2.955910594):0.8470275907):2.043306995,(t375:6.837560118,t376:6.66707105):2.307249945):0.8346659942,t377:9.738959264):3.769196655,(((t378:5.564261474,(((t379:3.47797327,t380:3.307856894):1.239752887,t381:4.341138836):0.06272274312,t382:4.387765582):0.7781841405):1.60159499,(((t383:1.285186476,t386:0.9420029123):1.046050993,(t387:0.9363762386,(t388:0.2818024778,t389:0.144149235):0.5733515875):0.9719363378):0.4389894435,(((t390:0.2273408953,t391:0.1798546981):0.2424109369,t392:0.1888061573):0.1078277518,t393:0.08565888565):1.393755832):3.961468237):4.806103341,(((((t394:0.7846117702,t395:0.6439922557):0.1861930425,t396:0.8294246759):4.577790848,t397:5.342055654):1.62646893,((t398:5.174906965,t399:5.149573795):0.9444985336,((((t400:1.508827361,t401:1.508570024):0.270621404,t402:1.707169055):1.796236263,t403:3.394745836):1.265932093,(t404:0.536645828,t405:0.2535544971):4.096848169):1.189230737):0.7766755658):1.167912905,((t406:5.249245449,((t407:3.034076481,t408:2.8730068):1.224974549,((t409:0.5326776502,t410:0.3072211693):2.667434087,t411:2.955571039):0.8889106197):0.4868336823):1.438668705,t412:5.574144249):0.7760679324):1.873931227):1.530562643):0.2560629421,((t413:1.494328674,t414:1.468484366):2.564384631,((t415:1.592430137,t416:1.369807275):1.840633296,(t417:3.004893661,((t418:1.212956586,t419:1.068073716):1.001399189,((t420:0.6103300782,t421:0.539526904):1.055061235,(t422:0.5077398376,t423:0.4999810456):1.009146293):0.2859989166):0.6445944173):0.06230528747):0.4628876817):5.888311786):1.616200619):13.79729582):32.49143721):5.939106217,((((t424:1.591505344,t425:1.436480615):4.369109574,((t426:0.6403359256,t427:0.5184388428):3.986787533,(t428:3.752208448,t429:3.641543299):0.5871613132):1.152768383):28.85276858,(((t430:2.573108964,t431:2.566047626):1.895058975,(((t432:0.7624553373,t433:0.5412310177):1.974524301,t434:2.488199614):0.1191412843,(t435:1.449303799,t436:1.388176295):1.068612202):1.587979393):16.62049744,t437:20.6181443):13.06875112):20.86659912,((((t438:0.6908886746,t439:0.5981161088):6.282965501,((t440:1.806867124,t441:1.773178473):1.373054669,(t442:3.078709299,((t443:0.5783445077,(t444:0.08483667197,t445:0.01730438406):0.1295019189):2.115445178,t446:2.216273621):0.3533315029):0.05550423386):3.670381217):0.05903011298,((t447:2.270845064,t448:2.199092571):0.2207576559,(t449:1.649905348,(t450:0.6269766327,t451:0.6117498946):0.8367417928):0.7344567157):3.765656279):37.72731573,(t452:19.76523796,(((t453:3.033222716,(t454:1.368246893,t455:1.348197778):1.517119317):1.547279723,t456:4.347165845):9.497075525,((t457:2.607120052,t458:2.258501184):2.993824899,(t459:1.069471625,t460:1.017433681):4.134418838):8.228080488):5.584051702):23.89529377):9.791737679):6.967974769);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T41.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
