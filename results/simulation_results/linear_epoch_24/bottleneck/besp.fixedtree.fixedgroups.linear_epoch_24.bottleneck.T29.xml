<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t481:1.144291265,t482:1.019932718):0.9423429032,t483:1.95176332):1.148170676,(t484:1.091385736,t485:0.7271829105):1.942576521):19.02858946,(((t486:1.571220989,t487:1.495034287):4.269746032,t488:5.579258797):4.452533806,(t489:7.097217553,(t490:2.741777166,((t429:0.05632542247,(t412:0.05074058497,((t407:0.2193792069,(t356:0.07712795832,((((t298:0.0104296441,(t297:0.006059110774,((((t198:0.07499102349,(t174:0.2682019854,(((t155:0.03483641575,((t144:0.06590405384,((t134:0.08113469513,((t132:0.2020610511,t133:0.03893941091):0.1392347408,(t128:0.2356670392,(t129:0.1236969683,(((t94:0.02103888817,(t76:0.2438353367,(t1:3.216305264,(t2:2.931491597,t3:2.725266259):0.1949777282):3.097396142):1.312017623):2.61988435,(((t4:5.682476144,((t5:0.8525964061,t6:0.8299391253):4.101711747,(((t7:2.52772846,t8:2.487447663):2.154505417,t9:4.630438388):0.02363641455,(t10:3.030956026,t11:2.930477703):1.603309807):0.1984361597):0.4850079949):1.381549482,(t12:3.861553825,(t13:2.188227085,t14:2.184588085):1.410395797):2.710545625):2.739019776,(((t15:4.479636225,t16:4.426110236):4.323966149,(((t17:3.812589574,(((t18:0.3198121659,t19:0.2516200927):0.6386264557,(t20:0.0777296639,t21:0.0160429269):0.767226494):1.285495256,t22:1.919900895):1.503377736):0.4747595189,t23:3.70830455):2.449021474,t24:6.142690134):1.912105659):0.07575168919,((((t25:3.85160256,(t26:2.15151751,t27:2.099338155):1.668562863):1.860492362,t28:5.595276591):2.30629856,(t29:3.532101197,t30:3.481854491):4.353937197):0.06493522188,(((t31:2.446134449,t32:2.330207565):3.365116401,(t33:3.709969585,t34:3.678697273):1.963554428):1.987560541,(((t35:0.09656089213,t36:0.080950031):2.886708426,(t37:1.464482652,t38:1.416048618):1.390287796):4.529968526,(t39:4.064378934,t40:4.050422986):3.184260582):0.01450183691):0.08879897465):0.004775086466):0.05556549478):0.1266254496):0.2546945802,((t41:7.31346554,t42:7.26842171):0.1905068413,(((t43:2.43366513,t44:2.357023155):4.647385551,(t45:5.928249776,(t46:2.426225417,t47:2.423362121):3.352751243):1.02542893):0.1357080352,((t48:0.2596619505,t49:0.1374458437):2.365140998,t50:2.399872258):4.26911403):0.2395695328):0.1324372148):0.03357210668):0.03669518289):0.6552646837):0.2358901248):0.554505805,((t51:5.155185033,(((t52:0.849522312,(t53:0.4672221933,t54:0.327459299):0.3457983888):2.292600137,(t55:0.2131730604,t56:0.1237096732):2.636982466):0.1534384722,(t57:0.9683721645,t58:0.8588508607):1.899656417):1.595357344):1.583385221,((((t59:0.5537718945,t60:0.3858716116):4.799801643,(t61:3.22448398,t62:3.182519206):1.830871383):0.1006615971,t63:5.085120543):0.09015818395,(t64:3.90140781,t65:3.889793343):1.096521096):0.1620243432):1.71784729):0.2075805645):0.3506643909,(((t66:1.575681727,t67:1.483912753):3.121063273,t68:4.368340772):0.9846748343,(t69:4.295486141,(((t70:1.220167707,t71:1.202103286):1.859638634,t72:3.054295453):0.6195342081,t73:3.549548769):0.5710953673):1.00139902):1.649594726):0.2849589828):1.488510681,(((t74:4.781971884,(t75:3.976581729,t77:3.542909398):0.7206111967):0.2916883867,(t78:3.877455755,((t79:0.2528996865,t80:0.2137669411):3.278935044,(((t81:1.335652461,(t82:1.001451918,t83:0.9861989105):0.2869305455):0.8719536884,t84:2.049745295):1.181733229,t85:3.205709544):0.08741394466):0.332063081):0.6170772548):2.694926115,(((t86:3.223435641,(((t87:1.249211447,t88:1.134500543):0.2189360332,t89:1.320080219):1.666647091,((t90:0.3836109105,t91:0.106562562):0.2674299792,t92:0.353635494):2.233734447):0.01531209769):1.712588642,(((t93:0.2831823151,t95:0.09596501298):2.020024231,t96:2.081170334):0.8251250608,(t97:2.287783444,t98:2.123797516):0.6074917949):1.141554396):0.3470327428,t99:4.059844085):1.598041962):0.678729982):0.75604973,(t100:6.237737124,(((((t101:2.328510936,((t102:0.7708470228,t103:0.7630233339):0.1792901377,t104:0.6254305278):1.290999916):0.07551749159,(((t105:1.299862964,t106:1.128850896):0.2374619509,t107:1.343754111):0.3249774316,((t108:1.130129997,(t109:0.6436348933,t110:0.5238039999):0.4636702748):0.2342848203,((t111:0.8373753348,t112:0.8346350518):0.07459946186,t113:0.7488940173):0.2081657471):0.2560748633):0.07203355685):0.3560828625,(t114:1.117404118,t115:1.023245177):0.461297013):0.352517989,(t116:1.016689337,((t117:0.3899095861,(t118:0.0645775402,t119:0.04640605981):0.2532583391):0.1736047898,((t120:0.1686869145,t121:0.1186864411):0.02464006417,t122:0.08864180763):0.1900544341):0.2573268922):0.7516656052):1.677267017,t123:2.841008556):1.318884444):0.8540224473):0.4747528489):2.902058979):0.1506480771,(((t124:0.6315534669,t125:0.5279809302):0.08642772456,((t126:0.227815624,t127:0.190641917):0.2698297576,t130:0.1085363978):0.08701226805):0.08581369143,t131:0.08233680827):7.713895469):3.726370605,((((t135:2.212803332,((t136:1.303209496,(t137:0.5466021085,(t138:0.3079406756,t139:0.2194666021):0.1669281575):0.717532011):0.04488532374,t140:0.995593982):0.8175048038):0.2927029879,(t141:0.4070325137,((t142:0.1830127971,t143:0.1350356397):0.03319658024,t145:0.02987630449):0.1735649369):1.590062639):3.326197844,(((((((((t146:0.2606515541,t147:0.2240487585):0.6091693538,(t148:0.08423638774,t149:0.04847868031):0.6488113553):1.207710078,t150:1.844957732):0.1320599988,((t151:0.2652071866,t152:0.1911353392):0.4058389459,t153:0.5411988848):1.267993013):0.2424738598,((t154:0.1993840412,t156:0.09625867901):1.525396051,(t157:0.79310845,t158:0.6599809008):0.6565546545):0.1873663195):0.6385017587,((t159:0.6497803726,t160:0.5897410195):0.2751098293,t161:0.569858266):1.133806168):1.112044946,(t162:0.643150402,(t163:0.3384402879,t164:0.2192248521):0.2044587711):2.01477413):0.4396986392,(((t165:0.5519260244,t166:0.3205292659):1.222730016,(t167:1.077486809,t168:0.8055439487):0.3502048142):0.298181777,t169:1.431410461):0.5369986044):0.1061965774,(t170:1.641984825,(t171:0.4209704973,(t172:0.1054316547,t173:0.07551271396):0.152417254):1.17863509):0.4182081486):0.346083076):4.949367311,(((((t175:1.469911344,(t176:0.6038468298,t177:0.6000074451):0.7637956868):0.2403272632,(t178:0.5230031399,(t179:0.3303690954,t180:0.01919822027):0.1874382224):1.027257534):0.1071525604,(t181:0.1802941326,t182:0.1625562793):0.8068261394):1.726356966,(((t183:0.9008708202,t184:0.7156898437):0.5711465265,(t185:0.8524833064,t186:0.7428718487):0.2911191695):0.6973238799,(((t187:0.4498816824,t188:0.3877462277):0.01935748752,t189:0.3108646006):0.9638664377,((t190:0.3450180745,t191:0.3091595509):0.163510246,t192:0.3640147698):0.5986320631):0.1615343121):0.2096713701):0.04331524053,(t193:0.8590461168,t194:0.7568761747):0.4346533236):3.091424855):0.03849064806):0.3666330235,(((t195:0.3979635562,t196:0.1159479885):0.2308483548,t197:0.3080418675):0.3602092317,t199:0.3633546523):3.677361178):5.442029074):0.1234208568):1.244846824,(t200:1.0471312,t201:1.038053009):9.703767595):2.103310819,((((t202:0.2798599677,t203:0.2085223629):3.795915809,t204:3.979544559):2.03848439,t205:5.691674618):5.584166002,((((((t206:2.595147771,(t207:0.4987359756,t208:0.4982749295):2.071912626):0.4227195112,(t209:1.84672215,((t210:0.3900657179,t211:0.363245882):0.5053889467,t212:0.8257245765):0.8354400746):1.090395413):2.072169094,t213:4.801459179):0.7803462623,(t214:3.920079026,(t215:1.569098281,t216:1.464187036):2.349571098):1.47316995):1.670973803,(((t217:3.057729445,t218:3.057139866):1.36732152,t219:4.319674555):0.3230415841,t220:4.324285044):2.085590887):1.783353073,(t221:0.8762628901,t222:0.8234297474):7.29979021):1.928499326):1.051948702):0.2342435734,(((t223:1.170936234,t224:1.099953497):3.519302034,t225:4.608917867):0.1510398574,t226:4.559073896):6.421208547):3.47856835):4.37841241):0.2050632658,((((t227:0.6094710127,t228:0.5482863801):0.7078274149,t229:0.9158999304):0.5561034392,t230:1.45095079):2.872686886,((t231:0.8683635542,t232:0.8011623645):0.1222203336,t233:0.6238866337):3.303323734):14.29421895):0.9233622551):1.889517718):3.326429677,((((((t234:5.520507369,(t235:4.442240953,t236:4.238541258):0.9473943724):0.1674074432,t237:5.30093852):3.105325943,((t238:4.137344654,(t239:1.648816498,t240:1.548227139):2.449112488):2.24667833,t241:6.002704083):1.990769081):2.165427462,(((t242:1.736188504,t243:1.732135155):4.54647362,t244:6.233825713):0.9655228596,(t245:6.054944182,t246:5.967056036):1.068463937):2.711947022):1.247176124,((t247:7.698933461,(t248:4.589574011,(t249:3.707869641,((t250:1.622160254,(((t251:0.1615279275,t252:0.08844912895):0.4799032527,t253:0.5445632203):0.5950304625,t254:1.097939488):0.3051023458):0.4361278949,t255:1.716146695):1.604172872):0.6016445664):3.017979833):1.067567701,t256:7.933431997):2.12003702):0.135614339,t257:10.1395587):11.98445202):4.551999012):4.142579966):2.929752959):11.276222):52.62642514,(((((((((t258:1.772051085,t259:1.760939992):5.349945968,(t260:2.070439742,t261:1.945934706):4.99694259):8.611698883,(t262:10.69531859,(t263:7.839142281,(t264:4.290647402,((t265:3.574139497,(t266:1.884440181,(t267:0.7001541104,t268:0.3686647062):0.8202750088):1.44101588):0.3483343538,((t269:1.417086604,t270:1.297304975):0.5244924607,t271:1.813261497):1.035880478):0.1307359307):3.536836126):2.813328107):4.793751346):6.795297305,(((t272:1.974539394,t273:1.946975855):3.199328742,(t274:3.579222714,t275:3.570136968):1.29296321):5.842671962,((((t276:1.094516041,t277:1.081035819):0.4125625517,t278:1.443011066):5.788951552,(t279:2.874858497,(((t280:0.09753868922,t281:0.057836928):1.254368548,t282:1.20687488):0.1426978782,t283:1.070693108):1.247402816):4.073354947):3.08209018,((((t284:2.407172182,t285:2.335929692):0.8083748697,((t286:0.7340658319,t287:0.6804999078):2.181257888,t288:2.853687577):0.224139387):1.471904214,t289:4.40030024):4.563542458,((t290:3.77018753,t291:3.587243357):4.014213982,(t292:7.163145987,(t293:0.2529159315,t294:0.2342105244):6.778723786):0.3686719937):1.113233985):0.1971879793):0.3167500331):9.828297472):4.447997429,((((t295:9.101329112,t296:8.891226953):5.172971353,(t299:4.183014714,(t300:0.9903563838,t301:0.9007608425):3.186195357):9.618306574):0.6959800884,t302:14.21035849):2.685540404,(t303:7.872698124,((t304:2.909708698,(t305:2.80773817,t306:2.80255193):0.0195883206):1.69417827,(t307:0.601539569,t308:0.590602418):3.911081674):3.194406946):8.886017472):5.532999135):0.4485935366,((t309:14.85070234,((t310:1.09841882,t311:0.8765470533):11.22370597,(((((t312:0.2953182224,t313:0.2293278964):2.061476306,t314:2.21049897):0.1892928658,t315:2.221078535):2.059280007,((t316:1.812854278,t317:1.511289329):1.520317175,(t318:0.630556596,t319:0.489561886):2.263205586):0.9187470907):6.419128763,((t320:4.567522346,(t321:3.125689636,(t322:2.560110943,t323:2.35552429):0.5055261742):1.167448319):0.587224194,t324:4.614913971):4.615307902):0.8365435438):2.252386838):5.095956904,((((((((t325:0.5847545883,t326:0.1027640819):2.408556053,t327:2.405259765):1.056399767,((t328:0.9713547804,t329:0.9184050188):1.309220259,t330:2.114440294):0.9287504796):3.278953078,((((t331:0.2439760106,t332:0.07271918625):1.509786434,t333:1.536922176):1.720734834,(t334:1.190410111,t335:0.8575192957):1.917264075):0.3501805552,t336:3.096750182):2.479037499):0.5125212193,((t337:3.519131238,t338:3.445034416):2.383440392,t339:5.77825842):0.1221204097):8.406867061,((((t340:5.64113117,((t341:0.08924546248,t342:0.003725143776):2.283161342,(t343:1.859483692,t344:1.852319512):0.2287062198):3.160143216):2.847784444,t345:7.99388936):0.2163429438,((t346:4.510511636,((t347:1.457183216,t348:1.425210444):2.569343579,(t349:2.443036682,((t350:0.2162063179,t351:0.02426079398):0.5702285324,t352:0.5295961654):1.630866152):1.404239022):0.4694296499):1.033403391,(((t353:0.2270656507,t354:0.1292702123):1.35581436,t355:1.40920578):1.359572518,(t357:1.790459545,(t358:1.207961366,t359:1.187787572):0.5780020231):0.7552981401):1.927885029):2.643244692):0.7109162136,((t360:2.546346816,t361:2.477872907):0.04993212428,(t362:2.233824666,t363:2.191926934):0.2267984438):5.154717821):4.813423431):0.1337197897,(((t364:3.246302439,t365:3.122432471):1.151663192,t366:4.265940185):0.1864042196,t367:4.419851683):7.846856491):0.4684087659,(((t368:0.9943383685,t369:0.9837116203):8.796469832,(t370:1.807706575,(t371:1.602555208,t372:1.489212817):0.1904335529):7.869906256):0.657098704,((((((t373:0.5826012369,t374:0.5229550444):0.7187054103,t375:1.200424119):0.0041527849,t376:1.093666375):1.762357742,(t377:0.7022172726,t378:0.5571142119):1.930941733):4.145166638,(t379:3.395146128,t380:3.278283407):3.083789259):2.05643834,(t381:5.18514097,(((t382:1.404653598,t383:1.363989605):1.458554287,t384:2.799898514):1.598965685,((t385:0.8058534746,t386:0.7047369892):1.075673293,(t387:1.287152318,(t388:0.09725995384,t389:0.08771766186):1.054810554):0.2152915951):2.440957999):0.6656638235):3.218725704):0.8654943939):2.218584088):0.3924374579):2.407983156):5.419382613,(((((t390:3.565470403,(t391:2.780940618,t392:2.683405004):0.6120599815):2.829687405,(t393:0.8704751933,t394:0.7849247677):5.138858004):0.1146873132,((t395:1.045660366,t396:1.044570757):1.426386988,t397:2.348661635):3.338998189):0.5960815056,(t398:4.225313265,t399:4.198553077):2.027871899):10.91794162,((t400:2.825266977,(t401:0.8430966726,t402:0.7369143758):1.959764242):2.706349257,(t403:2.796784926,t404:2.645271467):2.575434068):11.58769603):0.7065594808):15.75358315,((t405:1.679195962,(t406:0.3340410611,t408:0.03546825817):1.286938366):0.958783186,t409:1.894736784):30.59792149):1.18104866,(t410:6.568944067,((t411:0.3125130603,t413:0.2287015733):1.345238815,t414:1.53756773):4.558624556):26.81295561):47.76718879):67.69678079,(((((t415:4.445849591,(((t416:0.1628565437,t417:0.08498723692):2.808836663,t418:2.680513817):0.2225561678,t419:2.811226427):1.080312881):3.103718527,((t420:0.4630850937,t421:0.4555479974):3.011477509,t422:3.187680636):3.512025278):1.884890109,(t423:3.359517318,(t424:0.8709017862,t425:0.8393850615):2.20109153):5.197665925):4.294359941,((t426:3.952926825,t427:3.902708484):3.206726786,(t428:4.404145794,(((t430:2.537127687,t431:2.486501226):0.6679565603,t432:3.089931435):0.6992523673,((t433:1.974704705,t434:1.952243362):0.1644797677,t435:2.052629504):1.511818792):0.2097038525):2.450311363):5.290675467):17.36426037,t436:28.86104477):117.1574344):66.77544675,((((((t437:5.884444512,((t438:0.5217276161,(t439:0.4160663269,t440:0.3539790053):0.03909132332):4.120922783,(t441:0.3305914569,t442:0.287519379):4.150663179):0.9794381983):2.673619981,((t443:1.438443608,(t444:0.7606199446,t445:0.7335877108):0.6683409735):1.0446668,((t446:0.966790985,t447:0.9613898254):1.121048511,(t448:0.2227077366,t449:0.2137715182):1.786322494):0.352669158):5.607889273):2.285083296,((t450:4.827653898,(((t451:0.6978872064,t452:0.2311471929):1.225533349,t453:1.441538008):2.466237208,(t454:0.6455697217,t455:0.560645218):3.093073763):0.3990955505):4.017352282,(t456:2.877710249,(t457:1.059697977,(t458:0.9092294904,t459:0.7052804231):0.1359795542):1.790634723):4.938104014):1.389875814):14.4963966,t460:23.43188847):8.469883648,((((((t461:0.6056154869,t462:0.5388325606):3.036688214,t463:3.563219016):0.164288422,(t464:2.629898487,(t465:1.783904918,t466:1.728908058):0.7370182031):1.023821134):2.622556973,t467:6.018016477):4.439365444,((t468:0.2738281889,t469:0.2661759835):4.678158493,t470:4.891636011):5.485455034):8.777667512,(t471:1.235148357,t472:0.8647848581):17.83438102):12.25265657):35.48507437,(t473:33.84274276,((t474:14.67960759,((t475:3.142792967,((t476:0.1136861292,t477:0.04950475952):0.7716024651,t478:0.8080424942):2.191970601):10.36661558,t479:13.3601331):1.1567981):6.731843394,t480:21.14125862):12.34202302):32.48562245):143.4064254);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T29.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
