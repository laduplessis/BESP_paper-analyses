<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t487:1.500786447,t488:1.388423158):54.23651894,(((((t489:0.5658118671,t490:0.513027766):3.476037497,(t491:2.324752373,t492:2.237067589):1.656325783):4.185392612,(t493:6.077051483,((t494:0.399253352,t495:0.3684809692):0.9563970166,(t496:0.154451756,t497:0.1336901148):1.148822126):4.610502416):1.982193983):13.9258537,(((((t396:0.04820526262,((t357:0.03502369323,((((t325:0.2483758561,t326:0.02730725315):0.06710616262,(t269:0.1417055075,(t249:0.04433697876,(t228:0.06333070894,(t212:0.05168672074,(t205:0.04567066732,(((t194:0.02587212084,(t181:0.01185683231,(((((t158:0.0949460234,(((t137:0.02389967876,(t136:0.1067934427,(t133:0.001375314164,(((t122:0.005761310503,(t117:0.1359257939,(t110:0.1655248216,(((t92:0.09359216616,(t1:4.132236424,t2:4.111454908):4.347187888):2.008746066,((((t3:2.690982694,(t4:2.407565014,t5:2.387739017):0.1451908301):3.001590296,((t6:4.757739644,t7:4.722585532):0.6816073322,(t8:2.166681223,(t9:1.389988861,(t10:0.4982698515,t11:0.4295146234):0.761938416):0.7634761041):3.156570894):0.07402144807):0.5110836951,(t12:5.319750409,t13:5.220485635):0.0585347612):3.694782466,((((t14:3.537395068,(t15:3.057898779,t16:3.015337994):0.2578594887):0.3452419136,t17:3.40359808):3.636321626,(t18:6.343986415,((t19:4.661016501,(t20:4.54723093,t21:4.348858105):0.09319632888):0.05626273131,t22:4.023835151):1.605258005):0.5229681885):0.6175019002,t23:6.764442421):0.717378612):0.376417245):0.0608640573,((t24:0.8195059709,t25:0.7656053798):3.607480728,t26:4.371335271):3.472684856):0.1137188506):0.5640243268):0.3800743671):1.117355616,((t27:7.411827787,t28:6.793107):0.7402587799,(t29:1.71379413,t30:1.591615381):5.815954425):1.780281645):0.005706151332,((((t31:6.486474082,((t32:1.660277133,(t33:1.421002309,t34:1.39802904):0.1891234885):4.511542946,t35:5.951217764):0.2250466115):0.1765215513,((t36:3.716671057,t37:3.437436106):2.391022021,(((t38:1.724371907,t39:1.612785096):3.913447401,((t40:3.829041486,(t41:0.9862417163,t42:0.9510270729):2.836228877):1.137031391,(t43:1.179486629,t44:1.176852309):3.739243948):0.5482090936):0.03311705286,(t45:3.458679874,t46:3.450155424):1.98871394):0.1159458007):0.2357519512):1.462844488,(((((t47:1.512604578,t48:1.399966183):1.11415623,t49:2.46071178):1.739090074,((t50:2.011116213,t51:1.948536214):0.03037682217,t52:1.972800485):2.065840063):1.150313149,(t53:2.956148488,((t54:1.548280675,t55:1.5432111):0.715343462,(t56:1.213064682,t57:1.188754119):0.9936352939):0.5705299426):2.102796585):1.248656888,((((t58:1.291776733,t59:1.205730415):3.360010176,t60:4.554258427):0.1117625482,(t61:1.569770444,(t62:0.7904065688,t63:0.7727582221):0.5103460014):2.941056267):0.140632218,((t64:0.3132075478,t65:0.2791605142):1.266357425,t66:1.350510033):2.768212183):0.9837264409):0.4790777337):0.1892509567,(((((t67:1.602060678,t68:1.598178512):2.683533154,((t69:0.5109610208,t70:0.4098634672):3.636889172,(t71:3.652216322,((t72:0.1638607521,t73:0.04733003336):1.692639529,(t74:0.8451856405,t75:0.8432182397):0.883299089):1.751900534):0.3684126972):0.07457881754):0.1305958891,((t76:3.467987678,((((t77:1.778315654,(t78:1.367533692,t79:1.237176721):0.2762126646):0.5317347501,t80:1.877627734):0.5227244121,t81:2.110783255):0.3230982879,(t82:2.363447938,t83:2.353667411):0.04809736915):0.167276835):0.0958653715,t84:2.331864368):0.3003830685):0.3860159472,(t85:1.302882139,t86:1.241796853):1.581313397):0.07963914712,(t87:2.400522569,(t88:1.779866407,t89:1.773729058):0.5967739189):0.4726729157):0.8507261396):0.7070548127):0.00615230529):0.1568592825):0.2476888413):0.290331381,(((t90:1.813905098,(t91:1.667368059,t93:1.499508316):0.1394350583):0.3323043431,t94:1.406996188):0.7283545111,(t95:1.081614275,(t96:0.440871646,t97:0.1465341592):0.6355426645):1.012794102):2.212847931):0.4235708121,(((t98:2.329945635,((t99:0.2904098491,t100:0.2709916924):0.001229885864,t101:0.1975912786):1.671373106):0.2231899333,(((t102:0.1361977928,t103:0.03264020944):0.1616757277,t104:0.1904118674):0.7364824789,t105:0.7363800565):1.035867759):1.672832394,(t106:2.746441588,((((t107:0.8266845542,((t108:0.06464390247,t109:0.04285141988):0.551861809,t111:0.3410390975):0.07701878297):0.3995095278,(t112:0.5054256649,t113:0.3539330767):0.3092688232):1.444272897,((t114:0.06034796348,t115:0.01122619713):1.949036567,t116:1.89640552):0.09200016432):0.004768638351,t118:1.647841015):0.02774497768):0.6854517867):0.1919955718):1.126730211):0.2891345126,(t119:0.6032754297,(t120:0.06947281404,t121:0.06325483608):0.3185078186):3.344044901):0.7846378649,((((((t123:1.061883634,t124:1.044026641):0.2829938271,(t125:0.2550574151,t126:0.1119215378):0.8644379055):0.1160396161,((t127:0.2577795461,t128:0.1549589695):0.369739581,t129:0.4458161603):0.330095693):0.5006903976,(t130:0.4106632196,t131:0.2991506955):0.8282083003):0.6323542238,t132:1.570864261):1.366835221,t134:2.82092127):0.4827203113):0.7911020755,(((t135:1.979061064,(t138:1.357384422,t139:1.268818588):0.06915073595):0.02852952401,(((t140:0.1532929917,t141:0.1060531363):0.1644847573,t142:0.1003762203):0.8163633706,t143:0.9010312958):0.227355395):1.40203862,((t144:0.4300872951,t145:0.2347387766):1.248796213,(t146:1.007171362,t147:0.930130073):0.4527942436):0.7299870604):0.6624604991):0.3811693596,(t148:1.190123439,t149:1.056772828):1.946123787):0.3341906385):1.175241817):0.1794141833,(((((t150:0.2539598442,t151:0.2011444516):1.001125822,(t152:0.3738843184,t153:0.3055853657):0.7183592444):1.852631705,((t154:1.865236522,t155:1.838852246):0.9487591779,(t156:0.7361950978,t157:0.6508040164):1.86194488):0.0512984173):0.9154428148,t159:3.323397578):0.5120961608,(((t160:1.838027683,(t161:0.1660965537,t162:0.002573083694):1.574681193):0.340858102,(t163:0.7594646865,t164:0.5665885846):1.113111526):1.447579875,(((t165:0.8331134022,t166:0.7138790419):0.5169082473,t167:1.220240818):0.116027361,((t168:0.3408882956,t169:0.1183705501):0.572996466,t170:0.6218152459):0.0603934422):1.629174966):0.01650699259):0.09793385966):0.101064243,(t171:0.5733879792,t172:0.4958862389):1.871093914):0.7524343178):0.9570217078):1.588420119):1.664434483):2.011870461):4.522615898):0.2531285947,(((((((t173:0.3525364271,t174:0.3243971967):0.776743349,t175:0.9926941619):1.383661348,(((t176:0.2321348549,t177:0.1118083471):1.263793054,(t178:0.1478710409,t179:0.1126098332):1.207415726):0.05292718715,((t180:0.4732042356,t182:0.3096062104):0.7177242904,(t183:0.3631604679,t184:0.1801396341):0.5039190771):0.154656793):0.4584098431):0.3078582399,t185:1.549029364):4.91314034,(((t186:0.9236901917,((t187:0.4744121906,t188:0.4735139821):0.385648028,(t189:0.5933084313,t190:0.4659858325):0.02258450963):0.01945059371):2.209691299,(t191:1.306252529,t192:1.281319566):1.315823725):1.77453058,(t193:0.9223510808,t195:0.7549149057):3.325595552):1.53361853):1.07593783,t196:6.669236822):0.8355949311,(t197:6.289123121,t198:5.869133203):1.151663078):4.39951381):0.3061759904,(((t199:9.100403108,(((((((t200:2.99638928,t201:2.992361296):0.6006333016,(t202:0.3665724674,t203:0.2877615954):3.201826139):0.2671670915,t204:3.719712649):1.379323012,t206:4.870092703):1.08511361,t207:5.765006752):0.7522214614,((t208:1.663655083,t209:1.574997896):0.9895673616,t210:2.472274847):3.827961618):1.961862847,(((((t211:2.049722913,t213:1.590134408):2.450763074,t214:4.030509842):0.3230504524,(t215:0.6402802117,t216:0.6358920642):3.699421414):0.009243418854,(((t217:0.2875824141,t218:0.2332229073):0.04935927189,t219:0.2418383062):3.2346505,((t220:2.224150681,t221:2.193503751):0.6156246021,(t222:0.1729475201,t223:0.1623057325):2.629144581):0.5559578493):0.6264183445):1.089900008,(t224:3.419538846,t225:3.278219381):0.9715276155):2.26837175):0.03604583887):1.633116835,(((t226:2.860461034,(t227:1.941755674,t229:1.702191685):0.8617208218):1.418699793,(t230:1.684360558,t231:1.644181389):2.247809598):1.237369611,(t232:1.006276047,t233:0.9145706184):3.927466824):2.647876422):0.3071915156,(t234:5.481626955,(((t235:0.2287722347,t236:0.1287119403):2.815005402,t237:2.886841319):2.222088291,(((t238:0.2230419732,t239:0.2225077419):4.302361302,t240:4.308679594):0.4208085749,(t241:2.780135851,t242:2.693697817):1.878841451):0.126958382):0.1593304341):2.232497235):0.5645092451):2.681810767):1.726027972,((t243:11.152771,(t244:5.068559334,((t245:1.033606321,t246:1.024117748):2.01407663,t247:2.930757081):1.919250875):6.042302533):0.6576494007,(t248:10.51108426,(t250:4.211520027,(((t251:0.611690036,t252:0.491558529):0.4659115399,t253:0.9378714014):2.431692298,(t254:2.118034385,t255:2.0070116):1.153907437):0.6996534217):5.95945762):1.03487974):0.2161468752):2.512265765):2.203683672,((((((t256:0.0829405423,t257:0.04074259165):1.159449151,t258:1.011482849):0.3407723882,t259:1.27541618):8.88074361,(((t260:2.672637137,t261:2.65429433):4.248938103,(t262:0.6300519914,t263:0.3538757152):6.231747738):0.5313078569,t264:6.993310621):2.645137362):0.9520359083,(t265:4.64616748,((t266:1.253268665,(t267:1.01426939,t268:0.8025303436):0.1712119142):1.500019459,((t270:1.267760895,t271:1.104168011):0.77982727,t272:1.759229508):0.2507443021):1.876053308):5.923518344):2.609940397,(t273:7.883765994,(((t274:1.097506295,t275:1.028123782):0.3060768273,t276:1.212834718):1.251158378,(t277:1.507334935,t278:1.469763485):0.9256835731):5.074888926):4.53319068):1.470003161):4.731531649,(((((t279:6.210346168,(t280:4.315553288,t281:4.280093733):1.871021012):2.989566146,(((t282:2.065772181,t283:2.058227931):6.16732063,(((t284:0.9290325421,t285:0.7568029801):3.05563665,t286:3.809305841):0.6186179893,((t287:2.342009461,t288:2.246160463):0.835963865,(t289:0.04894477008,t290:0.01964959381):3.031837652):1.218951111):3.559908502):0.2401794938,((t291:7.028785583,(t292:0.8185665949,(t293:0.3355700021,t294:0.2809249839):0.3806498014):6.159628829):0.5796000341,((t295:2.62091069,t296:2.54740341):2.028469927,t297:4.555166847):2.648770288):0.3256682819):0.5983068711):3.077632108,(((t298:5.686624124,t299:5.660922647):0.5248187822,t300:6.153415295):1.097533012,(t301:6.481048947,(t302:1.938640818,t303:1.912217506):4.530869752):0.7249538166):3.839792046):2.608108642,(((t304:2.912168433,(t305:1.892757625,t306:1.821401986):0.9513927939):2.287317969,(t307:4.301723892,(t308:2.7345472,((t309:0.8743059331,t310:0.8350905346):1.376268191,t311:2.132294275):0.4433370648):1.502576156):0.7474123227):2.252317517,(((t312:0.9371973849,t313:0.9221028923):2.722114633,t314:3.609084369):2.0517933,(t315:1.612262617,(t316:1.522235735,t317:1.216636256):0.04394661102):4.020464605):1.236305905):6.062594155):2.422152451,((((t318:1.861119937,t319:1.841278175):1.626562229,t320:3.409528655):7.024623567,((t321:1.412348177,t322:1.160781039):7.912503825,(((t323:5.025079235,((t324:3.411349897,t327:2.960586044):0.8777389492,(t328:1.550465554,t329:1.493263636):2.05437599):0.6933971393):2.934764114,t330:7.086937758):0.4460219195,t331:7.130925969):0.6399106986):0.8210912037):1.53361339,((t332:0.9252555676,t333:0.8631672839):7.455798233,((t334:1.640297811,t335:1.63917928):1.86272438,t336:3.139103595):4.71592896):1.720728659):2.923191978):0.5309716815):1.284490283,((t337:3.706413689,((t338:0.3267127351,t339:0.3211020414):0.3436278439,t340:0.6179156103):2.746068157):7.394061813,(t341:1.82768957,t342:1.789335027):8.921651828):3.201769986):3.259788186,((((t343:1.23525972,t344:1.11697631):4.033889887,t345:5.03427402):9.902831467,(t346:12.60401537,(((t347:3.732603428,t348:3.709328352):0.9914805533,t349:4.669381665):6.233475739,(((t350:2.048829664,t351:2.028415966):3.186551142,(t352:1.92859633,(t353:0.629530609,t354:0.5838508503):1.11103617):3.156647261):0.4434695336,t355:5.283008001):5.137896718):1.494878842):2.321663049):0.9207892719,(((((((t356:0.8021981447,t358:0.1631219676):1.85127938,(t359:1.237379117,t360:1.108116242):0.695554051):0.3941264021,t361:2.124959855):4.234657959,t362:6.251912241):1.722530706,((t363:0.6008289115,t364:0.5288031668):3.955443085,(((t365:1.296748907,(t366:0.4725442943,(t367:0.3130799391,t368:0.3115910178):0.1075158917):0.5974864836):2.685595346,t369:3.699991293):0.08484611322,(t370:3.097340693,t371:3.090386764):0.5371957991):0.3050406821):3.17245056):3.375862215,(((t372:7.693886452,(t373:1.948931466,(t374:0.9306453347,t375:0.9058974498):0.9466780235):5.671206865):0.02670955645,(t376:4.948590726,((t377:2.871655701,(t378:2.623531915,t379:2.503377817):0.1370177009):0.7381076735,(t380:0.5203290325,t381:0.2478953055):2.641594984):1.120926298):2.468602169):0.6893436988,((t382:4.08033489,(t383:3.563586964,(t384:2.971624108,(t385:0.2688135764,t386:0.1996155915):2.59487938):0.4287585364):0.4700022929):0.7392008487,t387:4.32540139):2.198286987):1.92909188):2.111211822,(t388:2.816674255,t389:2.692404819):7.668281045):0.6506041405):0.9879828491):20.24192794):8.410927882,(((((t390:1.814007175,(t391:0.9024512115,(t392:0.4489460232,t393:0.3790068649):0.3979816702):0.8651023126):0.2472074683,(t394:1.678853591,t395:1.531549598):0.1489774418):3.873800205,t397:5.44410144):2.96133807,(((t398:3.817870356,t399:3.735525899):0.7773315849,t400:4.28381736):0.6951663025,((t401:2.173889231,((t402:1.517463856,t403:1.423841645):0.4573015852,t404:1.713459424):0.122911941):1.222810126,(t405:1.933975692,t406:1.563646336):1.121890859):1.394444883):3.007184462):16.97654755,t407:23.91676479):14.73970866):25.00631484):23.73517551,(((t408:7.533143283,((t409:0.2722221656,t410:0.2676000555):6.692777418,((t411:2.432476802,t412:2.406388202):3.506701333,t413:5.772041922):0.9895491789):0.5259585669):1.389629661,t414:8.438773129):13.23654362,(((((t415:1.248573688,t416:1.162275237):3.245445035,t417:4.278872585):6.251104702,(((t418:1.624130412,t419:1.475246633):6.030705917,(t420:5.240161335,((t421:1.71614175,t422:1.53272377):2.649708885,t423:4.093367112):0.6719758361):2.038678309):1.49242061,(t424:5.227988918,((t425:0.9809020525,t426:0.899411798):2.216311401,t427:3.037652781):1.934189835):2.995270089):1.320672991):1.732313359,(t428:2.914868749,t429:2.879677863):8.094190486):8.7444068,(((t430:0.6248141331,t431:0.1723014354):0.7691079984,t432:0.9256801861):9.438003937,((t433:2.020088044,t434:2.005186273):1.510347373,t435:3.498243347):6.614471928):8.773913213):0.4201081749):65.17205602):14.91274937,((((t436:2.023931139,t437:1.919780102):5.513926151,((t438:2.871633504,t439:2.816064975):3.199489554,(((t440:2.3311505,t441:2.224405954):0.7581713,t442:2.929330629):1.324567293,(t443:2.089278402,(t444:2.038038907,t445:1.864392831):0.035803724):1.998942906):1.578292918):1.075818818):29.08940931,((((t446:5.38637188,((t447:2.012674072,(t448:1.60520627,(t449:1.129357878,t450:1.128467722):0.4135134114):0.3804350805):1.841493156,(t451:1.49117889,t452:1.320014513):2.234531863):1.502055811):17.89829236,((((t453:3.238411874,t454:3.195391895):4.008909731,((((t455:0.3674782729,t456:0.3293964812):0.6786826856,t457:0.8482251831):1.272153798,t458:2.082965763):2.101865439,t459:4.035750236):2.708122671):3.298759665,((t460:0.4546807318,t461:0.3227054223):2.127388055,t462:2.444999282):7.381507296):3.078129575,(t463:2.306380315,(t464:2.29838537,t465:2.12704432):0.003989146878):10.36826272):9.167821799):4.787553752,t466:26.43889989):0.3954247343,(t467:8.573087734,(t468:2.381496371,t469:2.263285228):5.928343637):18.19582744):7.153858637):9.487864795,((t470:4.715431367,t471:4.678189076):25.18809073,((((t472:0.6796223019,(t473:0.3855691443,t474:0.3448263884):0.2479791918):1.557762137,t475:1.824172223):6.720217589,(t476:5.097072404,((t477:1.547101944,t478:1.502409499):0.008913185199,t479:1.345540485):3.210171381):3.318735995):6.708292022,((t480:1.622650026,(t481:0.8151809816,t482:0.7789601396):0.7787997296):2.755586978,((t483:0.4436503824,t484:0.403734485):1.282977574,(t485:0.8257054027,t486:0.8070266826):0.5781177635):2.474819892):10.18014076):14.12884344):13.10126928):53.25403806);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T99.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
