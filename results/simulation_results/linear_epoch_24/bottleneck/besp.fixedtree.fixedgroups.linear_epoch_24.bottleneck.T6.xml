<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t420:7.640299368,(((t421:2.392572287,(t422:1.0177884,t423:0.9862012566):1.277435439):3.92994278,((t424:3.899894311,(t425:0.83404756,(t426:0.2781044051,t427:0.2458571751):0.5436801498):2.989830456):1.544079742,((t428:4.15468906,((t429:0.673106898,t430:0.6706830859):2.448233264,t431:3.079381813):0.9393224728):0.7470114428,(((t432:1.641829797,t433:1.640976656):0.9951046859,t434:2.407271196):0.5402544188,t435:2.750402139):1.55026182):0.2969267374):0.7118900646):1.017353638,t436:6.238485619):0.294995529):8.919778538,((t437:0.5163420793,t438:0.4854839845):0.2656379864,t439:0.670220141):14.63892355):26.98204067,((t440:4.31027049,(t441:3.818473392,(t442:2.95553895,t443:2.887522508):0.6097379096):0.3590943796):26.63586023,(t444:5.367954208,((t445:2.283796812,(t446:1.951669222,t447:1.911232039):0.3270902394):0.2121540917,((t448:1.317602304,t449:1.317506388):0.3933287974,t450:1.628884768):0.7064486387):2.852835679):25.01565613):11.25049466):521.0127266,(((((((t451:0.8240801461,t452:0.7112640973):4.374804982,((t453:1.107288433,t454:1.059774821):1.786737312,(t455:0.1355356913,t456:0.003772821604):2.608993985):2.134861709):11.03294516,(((t457:1.747757333,((t458:1.11746362,t459:0.9487698953):0.5322654257,(t460:0.4745750849,t461:0.3483214889):0.9892931228):0.0531357614):5.026805905,((t462:4.743205841,(t463:2.64830524,(t464:2.136595755,(((t465:0.9832500886,t466:0.8125317852):0.1134430862,t467:0.6003904696):0.5523362426,t469:0.7000542609):0.2518315541):0.5064627448):1.972162392):0.3277116374,t470:3.640601317):1.258957096):6.65147614,t471:11.38565321):2.259694626):1.467051056,(((t472:2.908935545,t473:2.786249795):3.541949021,((t474:1.083788286,(t475:0.1618141019,t476:0.003675090071):0.8902269775):2.868866377,t477:3.636996979):2.236654296):2.667702803,((t478:0.3047999572,t479:0.2766597551):7.041695695,t480:6.983460595):1.080138636):5.940660516):3.461543256,(((t481:6.871603424,((t482:1.744108661,t483:1.643191952):2.715438509,t484:4.270041536):2.381798065):0.4697299614,(t485:4.112115234,(t486:0.8938879224,t487:0.8202932171):3.123387479):2.697655136):5.143994527,(t488:0.4569299536,t489:0.4514717356):11.29274952):4.980201757):65.61435275,((t468:0.2424097079,(((t409:0.3126375225,(t362:0.06828779751,((((t313:0.1491494672,(t297:0.008502542523,(t295:0.07235929645,((t253:0.02929336231,(((t184:0.188091103,(((t160:0.06492559434,(t159:0.0704247698,(t155:0.1544249814,(((t131:0.1046052657,((t123:0.006014879326,(((t110:0.09544088725,(t107:0.1542958132,(t104:0.1460559472,(t82:0.003849351153,(t69:0.005013798131,t1:6.727727827):1.450676455):1.842355951):0.4378091649):0.2697243075):0.06904461117,(t2:9.167713471,t3:9.130879702):1.586502577):0.3049170192,(t4:9.758971043,t5:9.718308195):1.003840245):0.9268963873):0.3323702343,(((((((t6:1.17727401,t7:1.023252067):0.7834164553,t8:1.789350888):3.441620561,t9:5.056982497):0.7915888755,t10:5.808094649):1.822967639,t11:7.59914329):3.295966883,(((t12:9.193851663,(t13:8.580129386,t14:8.397875452):0.5456667872):0.06571028622,((((t15:3.700794806,t16:3.628727571):1.49244437,((t17:0.610084067,t18:0.5952374697):1.043256615,t19:1.437172401):3.407222372):0.4249534985,t20:5.255554105):0.726880917,((((t21:0.05882243607,t22:0.006886064821):1.189432699,t23:1.022602604):4.318887476,t24:5.275509357):0.0781720055,(t25:5.08167852,((t26:0.2848555374,t27:0.1844281702):3.518544653,t28:3.551734213):1.24890812):0.2646223998):0.2842193822):2.629533229):0.8933101833,(((t29:8.047345111,t30:7.843388353):0.498864557,((((t31:4.268697674,t32:4.168484143):0.01261391772,t33:4.111216123):1.117733766,t34:5.000070373):2.133145051,((t35:6.260688486,(t36:0.8707736153,t37:0.8603172065):5.117212074):0.2045238177,(t38:4.980447969,t39:4.918119575):1.098785929):0.6426963168):0.6965620758):0.06970485314,((t40:2.016115745,t41:1.973806026):4.240858355,t42:6.035274041):0.8793833834):0.1088094427):0.7081577465):0.3882999885,((((((t43:2.765067423,(t44:2.179263104,t45:2.038213285):0.4083338664):0.6159571355,((t46:1.003873306,t47:0.8181121423):0.1387743008,t48:0.9158250836):1.808312711):2.651714723,t49:5.303141454):0.200225257,(t50:5.139776171,((t51:4.351065384,t52:4.279766625):0.6380629818,((t53:1.462967576,(t54:0.7414235009,t55:0.6892618912):0.5521143168):3.138904715,(t56:2.212011528,(t57:1.694804685,t58:1.614961038):0.3687889375):2.112340553):0.1344196474):0.01595572217):0.2281003743):0.1270687267,(t59:4.561109065,(t60:4.366097185,((t61:0.5791737239,t62:0.5388034453):1.905618852,(t63:1.390192801,t64:1.189854294):0.9140996643):1.781842592):0.1208484428):0.02232510677):1.061225822,(((((t65:0.5067467951,(t66:0.4033847782,t67:0.3458841326):0.09251507058):0.2688789566,t68:0.4717800416):0.7135976363,t70:0.8931672163):2.013140676,t71:2.673318712):0.8212407537,(t72:3.123574643,((t73:2.456486479,(t74:2.422325658,(t75:1.87192584,t76:1.835565458):0.4462204915):0.0255637252):0.0897492834,(t77:1.770373316,(t78:0.8795008871,t79:0.8191742741):0.7927071459):0.557870745):0.4923691877):0.024298034):0.7200266592):0.6890562318):0.2675034547):0.2731162926):0.6704733868,(((t80:2.711066384,(((t81:1.174987601,t83:1.018464121):0.9371316862,t84:1.859993875):0.3840513085,((t85:0.5258665421,(t86:0.266450014,t87:0.1944163074):0.1638550042):1.502754557,t88:1.829797448):0.2054199214):0.1247876826):1.779463353,((t89:0.2794672933,t90:0.2780582815):1.618728023,(t91:0.1461125074,t92:0.03207347563):1.74038169):1.992753679):0.03239113803,((t93:1.529685457,(t94:1.392193466,t95:1.327735528):0.08463982063):0.01440778192,(t96:1.04581809,t97:0.8054235619):0.3133388445):2.204408108):0.7591188661):0.1889165141,((((t98:2.06596094,((t99:0.742514504,(t100:0.268942751,t101:0.248692554):0.1566998342):0.8067056125,(t102:0.346125035,t103:0.3357062418):0.8472732824):0.3417470167):0.1311785515,((t105:0.02406840994,t106:0.005481475864):0.9896245255,t108:0.562005322):0.3723471311):0.7902726791,(t109:1.615025086,(t111:0.4963918489,t112:0.468941136):0.8101824002):0.03555674648):0.07966634346,((t113:0.7699154345,t114:0.6177531322):0.1680322386,(t115:0.5149410552,t116:0.447303601):0.1486259703):0.4550166594):1.139865013):1.692339341):0.2880246864):0.06874662434):1.105781729,((((t117:1.674224217,t118:1.576530036):0.001477810274,t119:1.48168313):0.7406795309,t120:2.20077584):1.464525501,(((t121:1.081464685,((t122:0.6501073825,(t124:0.1872876071,t125:0.04477056616):0.1084527846):0.0893278295,t126:0.195190557):0.3183252996):1.998106736,(((t127:0.4259547952,t128:0.3888120556):0.104734854,t129:0.4631315544):1.619411158,(t130:1.29691396,t132:1.154203579):0.6688257093):0.2629402071):0.4695285172,(((((t133:0.02860918209,t134:0.009385183319):0.9103086268,t135:0.896651766):0.6400995119,(t136:1.024575927,t137:0.4838546608):0.3983480317):0.1733002882,(t138:0.3021994198,t139:0.07899737145):0.72472869):0.02439900143,t140:0.7971806861):0.6594533941):0.07114433243):1.375723057):0.4424535431,((t141:1.457260555,(t142:0.9894793406,t143:0.9515037444):0.3958849224):0.3799868245,t144:1.647543623):1.468566976):0.5933129161):0.202811534,(t145:1.930712677,t146:1.823025543):1.960635407):4.857282672,((((t147:2.961709363,t148:2.799537927):1.72903615,(((t149:2.306998211,t150:2.268650868):1.06328751,t151:3.177997882):0.4562876231,(t152:0.1206913365,t153:0.003798804936):3.378734311):0.6035887788):0.2063804383,((((t154:0.2141908233,t156:0.005873780085):0.1544692252,t157:0.02796293787):1.258799606,t158:1.265289342):0.6097022001,t161:1.618507569):1.808275001):2.785321472,((((t162:0.5173861504,t163:0.3007339424):0.1192840362,(t164:0.02921078414,t165:0.01165863419):0.3514413454):0.147579788,((t166:0.1453955097,t167:0.09355159737):0.1580320045,t168:0.05664368119):0.1122797626):3.293722152,((t169:1.259841171,(((t170:0.557751682,(t171:0.3297882692,t172:0.2345952822):0.2152124491):0.3828007184,((t173:0.2709650476,t174:0.269017579):0.04548299034,t175:0.2001130963):0.5055881874):0.1255649783,t176:0.8264045202):0.1397046795):0.928198551,t177:1.855575133):1.255219294):2.111499636):0.9054986473):1.972260528):3.034662423,(t178:0.8549871355,(t179:0.3442887428,t180:0.2189012977):0.4839201176):10.22164907):0.881221203):0.09596405976):1.273162223):1.992352999,(((t181:2.85390457,((t182:0.0669525884,t183:0.05815708673):1.1053174,t185:0.7677118608):1.416377208):5.309519828,((((t186:0.356669861,t187:0.1987613836):0.07658906277,t188:0.2148070061):0.567671635,((t189:0.206119849,t190:0.1223614655):0.1509638425,t191:0.1382459907):0.4026527984):0.1169835312,t192:0.3981993348):6.363216733):5.214674351,(((t193:0.2809640862,t194:0.1281065646):0.194755528,t195:0.2587293258):0.3896668446,t196:0.5931198389):10.95473906):1.50845729):0.8956067529,(((t197:4.522800172,t198:4.314374181):1.429715616,(t199:3.324507594,t200:3.198989308):2.383148354):3.418914618,(t201:1.531912817,t202:1.473316127):7.450194295):4.479203947):1.203641066,(t203:9.363669536,(((t204:2.754618013,t205:2.678093111):1.619125858,(t206:1.704406788,t207:1.689222867):2.301541403):3.800381083,((t208:2.818860331,t209:2.689551609):3.905162847,t210:6.531434577):0.8173382187):1.108120039):4.8866657):0.613688055):5.348591187):0.338547612,(((((t211:3.191247343,t212:3.143588547):6.007379703,((t213:5.406740737,(t214:1.926015242,t215:1.884547847):3.408218541):0.4493464642,(t216:4.401784895,(t217:3.765549156,t218:3.753749489):0.610533435):1.044872771):3.247165037):6.209348138,((t219:2.461562281,(t220:0.6129487543,t221:0.5232499847):1.78856886):9.456656526,((t222:7.760804997,t223:7.630524676):0.29293239,(t224:2.100039756,t225:2.050759133):5.815287115):3.538134815):2.845054394):0.05181678579,(((((t226:1.17590686,t227:1.151990585):2.805599989,t228:3.929824974):1.202701331,(t229:4.719286163,((t230:2.827793434,t231:2.380871088):1.176906723,t232:3.538122617):0.5319017209):0.3784817967):6.094783455,((((((t233:0.9660285619,t234:0.785087532):1.609032438,t235:2.098322683):1.830786775,t236:3.873127412):2.169294793,(t237:2.144776241,t238:2.140121949):3.846891572):0.5858340076,(t239:2.270622443,t240:2.207529614):4.200118067):3.06801313,(((t241:3.259617858,t242:3.195851414):3.036047945,((t243:0.197821722,t244:0.1284581415):2.038199762,t245:2.126977517):3.919663392):2.071717646,(t246:6.346045381,(t247:1.606209789,(((t248:0.8721536137,t249:0.5886096242):0.2271572136,t250:0.5941423167):0.4277568903,t251:0.924269949):0.05076211118):4.658138759):1.770210604):1.052598109):0.3040051338):0.1114254508,(t252:4.943081606,t254:4.893081718):3.925205913):2.810530608):1.694584444,((((t255:3.694782265,(t256:3.268203193,((t257:0.3708078888,t258:0.3604684313):1.413233143,(t259:0.2751283375,t260:0.1449095005):1.494734922):1.411835087):0.2816920636):3.455230472,(t261:1.506194224,t262:1.021761785):5.268516888):1.186318476,t263:7.365976712):4.842960302,((((t264:6.901068161,t265:6.832668458):0.2834805366,(((t266:4.44590485,(t267:0.7224620397,t268:0.4295944029):3.642555438):0.5411837057,(((t269:0.2233529135,t270:0.1349711956):0.5657177229,t271:0.5811556464):0.3599999152,t272:0.8777398756):3.420208228):1.376945075,(t273:3.632463885,t274:3.572975238):2.003818531):0.7095123046):2.587652213,(((((t275:0.8951496531,(t276:0.7904674261,(t277:0.3198404111,t278:0.2432440448):0.3359489349):0.03434361829):0.7567620708,t279:1.157614622):1.634749895,((t280:1.080243609,t281:0.9103564113):1.5869461,(t282:2.208597077,t283:2.092300382):0.2049907484):0.09171235577):2.610319686,t284:4.932970573):2.937532092,(t285:5.382255125,((t286:0.4472351862,t287:0.3821783947):2.414815305,t288:2.718763538):2.484939683):2.379007997):0.02111662668):1.25958411,t289:8.738878066):1.163474273):0.07237712223):2.348601895):2.098631494,((t290:10.39748236,((t291:1.09503034,t292:1.02213602):7.927510429,((t293:3.358958532,t294:3.306832821):0.03390691382,t296:3.179295566):5.431549737):1.176622648):3.231980378,((t298:1.454654918,(t299:0.02358610689,t300:0.01310846249):1.426524852):4.127134307,((((t301:0.6632077612,t302:0.6326862994):0.7447954081,t303:1.303138928):1.056896802,(t304:0.8897763305,t305:0.7496734746):1.451059286):1.689753802,(t306:2.044733208,t307:1.98312603):1.724993903):1.353573354):7.368099558):0.782678671):3.23201703):1.978418629,((((t308:2.909176954,t309:2.863147568):2.636233824,(t310:2.655259587,t311:2.627318131):2.674067505):10.36494784,((((t312:8.586348415,((t314:6.620152249,((t315:0.8944239309,t316:0.7822313807):4.492753374,t317:5.167568364):1.155175516):1.444980479,((t318:0.1065283401,t319:0.1014788665):5.466679832,(t320:2.48934101,t321:2.446113534):3.035838027):1.96158706):0.2237558653):0.1441830525,(((t322:2.404928967,(t323:0.9014703208,t324:0.8180081849):1.061542517):3.472549594,t325:5.32394998):0.8301515733,((t326:1.314510635,(t327:0.7830038613,t328:0.7823206468):0.4763223213):3.179231542,t329:4.359205535):1.644481819):1.100096117):0.3427694386,((((t330:1.911581623,t331:1.851795621):1.16836576,t332:2.973865177):3.765157618,(((t333:1.43565387,t334:1.300969741):0.4706853644,t335:1.722330865):3.654992179,(t336:0.6544844535,t337:0.6328821577):4.35260904):1.137430183):0.1600065016,((t338:4.990621409,t339:4.743801995):0.3986709326,(((t340:0.8626410339,t341:0.7621390951):0.05607235314,t342:0.7782677136):0.1215687428,t343:0.8994236706):3.767895399):0.7761639362):0.3216089441):2.364698485,t344:8.081026572):4.024958863):2.249813427,((t345:0.6370354089,t346:0.6318150231):5.498256939,t347:5.901817302):8.1136836):0.2119652411):82.51243116):71.71130845,(((t348:2.243724242,t349:2.205264603):15.5871765,(((((t350:9.38741333,((((t351:1.444299621,t352:1.358258392):1.395708289,t353:2.588644101):2.826809689,(t354:3.677255947,t355:3.562541392):1.633251502):2.35772199,((t356:1.670520042,t357:1.651057807):5.031469989,t358:6.658882442):0.7421014985):1.357043864):0.5580884984,((((t359:0.08955332212,t360:0.04938050866):1.935090319,(t361:0.2907280195,t363:0.04713630719):1.600752017):3.671705778,(((t364:2.658301551,(t365:1.39656128,t366:1.319993002):1.191743067):0.3502407452,((t367:1.595497201,t368:1.581798873):0.03462124441,(t369:0.6773543853,t370:0.5772587142):0.8695776065):1.189258577):1.180174557,t371:3.671843771):0.6740535034):0.954263384,t372:5.292819683):2.595909823):5.20931568,((t373:9.466006406,((t374:5.877460704,(t375:1.350106681,t376:1.339118282):4.517204831):0.8763432344,t377:6.392416983):2.587124228):0.2392765315,t378:9.157619361):3.303606292):0.1794519973,(t379:8.424223364,t380:8.385291932):4.137325191):2.032005911,(((((t381:0.3991074748,t382:0.2173297037):0.06070689766,t383:0.1463331487):0.2248184327,t384:0.2006596978):6.405667801,((t385:3.289880025,(t386:0.2318991399,t387:0.2146055675):3.020031675):2.9622284,t388:6.034843281):0.3350887125):3.363699802,(t389:3.589555782,t390:3.228715131):6.10644523):4.053944656):0.3706106936):14.86489305,((((t391:2.356962142,t392:2.32159158):0.9219972517,t393:3.202640207):15.25919003,((t394:6.824696569,t395:6.740410868):4.968552673,(((t396:1.664363472,t397:1.292275533):3.749303603,(t398:4.102131556,(t399:0.06734527749,t400:0.00257789073):3.995289585):0.8772029433):2.430260133,(t401:6.75979642,t402:6.641358898):0.5431130947):3.664655271):6.442860051):3.060942714,((t403:7.001887972,((t404:3.596213032,(t405:2.572034004,(t406:1.556398408,t407:1.530369034):0.9297026326):0.9647485879):2.507655368,((((t408:0.7419266457,t410:0.1415491941):2.180058903,t411:2.193906462):1.707287034,(t412:2.295445957,t413:2.158285062):1.491579815):0.1734215842,t414:3.756682079):1.043762301):0.7597135408):6.539894548,(((t415:2.191843518,(t416:1.905046728,t417:1.895285471):0.1355995176):0.2701779577,t418:2.180454518):8.163301278,t419:10.24159707):1.454168734):6.590619365):6.938997356):135.6329796):403.8027069);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T6.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
