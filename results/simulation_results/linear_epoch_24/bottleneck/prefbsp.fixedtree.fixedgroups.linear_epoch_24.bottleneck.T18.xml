<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t461:2.57847399,(t462:0.08125887968,t463:0.009134198245):2.483360212):0.7598778693,((((t464:0.3998120414,t465:0.3527375833):1.87461293,t466:2.103671747):0.3931795018,(t467:1.994393644,t468:1.989858257):0.4554375917):0.412752145,((t469:0.7952092615,t470:0.7708911797):1.696119518,(t471:1.663089885,(t472:1.023015021,t473:0.8612539215):0.6325621807):0.6960483287):0.2544100702):0.03656580214):16.38892468,(t474:1.099291338,t475:0.9425536523):17.65862105):56.33782878,((((t476:3.587011955,(t477:0.9776363459,t478:0.9246785136):2.463946168):12.56690141,(((((((t479:0.5246792595,t480:0.3939727755):1.538302464,t481:1.896735555):0.3892432513,t482:2.272079461):1.750719092,((t483:1.151162202,t484:1.15027262):0.1704389953,t485:1.204829349):2.515221703):3.122596614,(t486:1.731003874,t487:1.714784913):4.88596766):4.540469828,(t488:0.6442784282,(t489:0.430471023,t491:0.3866058601):0.1073406942):10.25643342):0.6426214287,(t492:3.227846453,t493:3.223189736):8.112111879):3.434713561):10.49116224,(t494:9.002010381,(((t495:0.06005978417,t496:0.04036552106):3.731770029,t497:3.770057573):0.6782565774,(t498:3.119102579,(t499:0.3895264256,t500:0.346070375):2.713810632):1.224951597):4.372781088):16.2364992):11.26073878,(t501:12.03436586,((t502:2.763841957,((t503:0.4734172203,(t490:0.002782311366,(t447:0.02021790051,(t408:0.05217957141,(t389:0.1506833529,(t346:0.01066716256,(t323:0.05157965495,(((t244:0.2327069458,(t230:0.2006076513,((t200:0.1006757834,(t185:0.1818886952,((t174:0.150763192,((t166:0.02782485249,((t159:0.1619455334,t160:0.03628657656):0.05724746542,(t155:0.04367463972,(t152:0.0347332601,((t147:0.1385923252,((((t119:0.6706454878,t120:0.161450846):0.1164825603,(t113:0.1445524538,(t57:0.002229761145,(t1:4.223520638,t2:4.192300678):0.1293355693):4.684529716):1.06542939):0.6613690274,((((((t3:3.421874912,((t4:2.736616309,t5:2.599109851):0.1575005135,(t6:1.622611858,t7:1.60310831):1.133296047):0.5028535072):2.521821855,t8:5.738333042):1.589258831,t9:7.307017679):2.674940262,((t10:2.042053405,t11:1.822440527):0.7850323483,(t12:1.444966393,(t13:0.9814292667,t14:0.9411013889):0.3565568421):0.9760224311):7.071789536):0.2300764952,(t15:1.753269288,t16:1.730218681):7.553663883):0.1708461737,(t17:6.218320046,(t18:5.578512275,((t19:4.667565987,((t20:1.873215707,t21:1.702122427):1.636966808,t22:3.287503588):1.059016612):0.4467232303,t23:4.749478652):0.3010165572):0.4239092159):3.116661445):0.1168304117):0.0001512963641,((((t24:4.734913107,(t25:2.050663278,t26:2.044125952):2.655464812):2.352613958,(((t27:1.682792748,t28:1.601081412):3.613610766,t29:5.135783037):0.8600054692,((((t30:1.387420621,(t31:0.4105301741,t32:0.4055808451):0.9113075202):1.607481651,t33:2.782405422):0.4310774866,(t34:1.120755561,t35:1.100924507):2.071749339):1.763004666,t36:4.928765706):0.7988733038):0.8936073582):0.7523977726,(t37:2.703709477,t38:2.694172765):4.667094284):0.374112095,(t39:6.535558575,t40:6.518014097):1.121978751):0.3989331463):2.924871749):0.3666077186,((((((t41:7.18222118,(t42:1.730204193,(t43:0.5907545649,t44:0.4155039122):1.114074053):5.194848898):0.04977871518,((t45:2.910986637,(t46:0.9458516575,t47:0.8613896789):1.935565608):2.343606734,(t48:2.683411969,t49:2.651097406):2.335463946):1.431393703):0.05462284884,(((t50:1.388808874,t51:1.117596562):1.084570658,t52:2.185921386):3.870138773,t53:6.048237178):0.1161505842):0.2334503386,((((t54:1.564941284,(t55:0.4323440998,t56:0.3142310095):1.114958048):2.071634254,(t58:0.4591869739,t59:0.1857693623):2.881054283):1.032070901,((t60:0.6024340072,t61:0.5040479863):2.801996391,t62:3.296057683):0.6836333183):1.448644748,(t63:4.506287471,t64:4.466125881):0.8132283304):0.1506747101):0.1146129171,t65:5.431202119):2.913974294,(((((t66:2.014071377,t67:1.66057306):0.8583919693,t68:2.517840751):2.231532604,(((t69:2.37011329,t70:2.367531345):0.39500794,t71:2.748070864):1.81658358,((t72:0.9634375324,t73:0.8817416503):2.551877575,((t74:1.822115211,(t75:0.5398752196,t76:0.2724379781):1.27788229):0.6724803892,t77:2.145266929):0.8661733052):1.031935112):0.1068819645):0.4687824701,((t78:0.8120965396,t79:0.7203529739):0.5670693204,t80:1.166314887):3.065109537):0.3081330195,(t81:0.9565824472,((t82:0.5578585799,(t83:0.4773326334,(t84:0.106542028,t85:0.05235012289):0.3445882522):0.06940256216):0.258720922,t86:0.7087295752):0.1204316569):3.440019758):2.392449263):0.6965333922):0.07960641286):0.1368215589):0.7618048983):0.3671492324):1.020617206,(((t87:4.013674177,((t88:2.51312953,t89:2.503668303):0.7885978096,((t90:1.571113519,t91:1.562266692):1.650383485,t92:3.051141159):0.05661789175):0.6804419728):0.2869286671,(t93:3.082059175,((t94:1.023771701,t95:0.8882459144):1.247545097,t96:2.132158509):0.7305691446):0.9057478215):3.82064991,((((t97:3.408968694,t98:3.39981398):0.8591944318,t99:4.085794725):0.6928337604,(((t100:3.166712768,(t101:2.230621572,t102:2.211470174):0.7340570012):0.02744384245,(t103:0.1198867691,t104:0.09236774796):2.764872915):1.133413271,((t105:2.204520982,t106:2.133806511):1.183640353,(((t107:0.1997285913,t108:0.1102511612):2.864433568,((t109:1.761964014,(t110:1.495211942,t111:1.378605081):0.1969014459):0.7275189893,(t112:1.857379003,t114:1.565226578):0.3090772978):0.3391668134):0.01359055109,((t115:1.214929901,t116:1.138079813):0.122961964,t117:1.252887051):0.8859052475):0.08920257188):0.5190967607):0.3525753734):0.168084663,t118:3.142266994):2.424797337):1.595495673):0.176615865):0.923202504,((t121:3.177967495,((((t122:0.1375502959,t123:0.1280729591):0.2085036286,t124:0.03916813909):2.154578078,(t125:0.9202794744,(t126:0.7138793541,t127:0.1688129667):0.1797646867):1.114851634):0.03098544158,(t128:0.6999072314,t129:0.6755269214):0.4935690948):0.6216003567):1.534732395,(t130:3.230504636,(t131:1.87477475,(t132:1.225123074,(t133:0.1136298137,t134:0.08329456939):1.109212538):0.2516106381):1.340981238):0.04101257885):2.6750002):0.5723293298):1.614564875):0.9673206022,((((((t135:0.09773476875,t136:0.08055248704):0.5370717147,t137:0.3882338208):0.8612137987,(t138:0.3018077683,t139:0.2748839479):0.8079245829):1.140867823,(t140:0.8806246015,(t141:0.1297023158,t142:0.002208121721):0.542706453):1.178576236):3.001049755,((t143:0.2657875555,t144:0.1723620861):2.270874954,(t145:0.9624283139,t146:0.766220723):1.314366805):2.123252309):1.280395969,(t148:0.7018606353,(t149:0.2977828863,t150:0.2861798592):0.314099176):4.397259733):1.695445703):2.534625662):1.270344535):0.5904287189,((((((t151:0.202523872,t153:0.09723830663):1.818530503,(t154:1.019137327,t156:0.5982071734):0.8905690127):1.539768154,(t157:0.9188943469,(t158:0.3383940447,t161:0.004802643603):0.454690736):2.10597822):0.4584031349,((t162:1.296925895,(((t163:0.2556284778,t164:0.2352729831):0.5560017221,t165:0.7206597661):0.1286233492,t167:0.7026606513):0.2884227655):0.6562766637,((t168:0.4235491046,t169:0.3574588603):0.3389709549,t170:0.3267992372):0.5918454893):0.9258853955):0.1377617907,t171:1.877025182):0.3267516012,(((t172:0.8375133016,t173:0.7450261671):0.7013784223,(t175:0.7242695853,t176:0.5963826059):0.4070482366):0.4864779818,t177:1.375304975):0.153165647):6.544172511):0.875966811,(((t178:0.4319168635,t179:0.4180285734):0.9572080546,t180:1.368464365):4.688677418,((t181:2.173745805,(t182:0.779413918,(t183:0.129847687,t184:0.09450862766):0.3268032495):1.361916131):1.383749916,(t186:2.467880456,t187:2.382805845):0.1835953665):2.347416982):2.842182254):6.541657345):2.227074247):3.057870828):1.74432973):3.76228607):3.756629828):1.333985199):1.428392269,(((((t188:10.96857518,((((t189:1.072740523,(t190:0.5029492836,t191:0.2314590911):0.5388028141):3.624339019,(t192:0.2156108374,t193:0.2004173974):4.140526459):2.872078482,(t194:3.763885317,t195:3.588457226):3.280503565):2.97611492,(((t196:0.5494657374,(t197:0.2246901303,t198:0.03696586408):0.141324072):1.536980378,t199:1.668494241):1.502308554,t201:2.96512413):6.200787706):0.391186377):2.750104837,(t202:0.05025394999,t203:0.04607498872):12.17369337):0.08315887444,((t204:6.833695364,t205:6.798290603):1.859894549,t206:8.561806712):3.298585301):2.808368552,(((t207:5.667290991,(((t208:1.188063286,t209:1.139041048):1.09985788,t210:2.219621006):2.92181576,((t211:2.964257748,(t212:0.4258496208,t213:0.4200785711):2.305223083):1.568332464,t214:4.235633952):0.2890570176):0.1759316888):3.729066334,((t215:6.523473388,(t216:4.566753102,t217:4.543662091):1.931695629):1.271429436,(t218:2.042905282,t219:1.870069144):5.595156854):0.6211442751):0.2184285229,(t220:0.08165811442,t221:0.03968782371):8.160508407):4.963979555):8.438822312,((((((((t222:5.429339368,((((t223:1.917186012,t224:1.648251609):0.983980544,t225:2.504792209):0.4743329114,t226:2.930798572):1.103124345,t227:3.987156149):0.8049030105):1.379860249,((t228:2.764084109,t229:2.498881701):0.6722414942,(t231:1.264321119,t232:1.253806044):1.605560189):2.585607535):1.197725586,(t233:0.3823600661,t234:0.2902281836):6.023046156):1.851009876,((t235:0.8333663912,t236:0.7047897777):2.561331944,t237:3.131763607):4.728715391):1.39327894,((t238:2.838507767,t239:2.819513692):0.2548353136,(t240:0.1279341425,t241:0.1015432994):2.842751277):6.160344985):4.167153364,(((t242:0.8105604775,t243:0.8034282034):0.6660937328,t245:1.067941159):8.259781828,((t246:5.594862376,(t247:3.433676569,t248:3.388055843):1.995834708):3.368735019,(t249:4.493276113,(t250:1.257833901,t251:1.170450311):3.135089661):4.21895895):0.1899353955):3.501890482):2.538909636,((((t252:2.346107036,t253:2.24767643):0.7932769253,t254:2.931311088):2.250893663,(t255:2.235183882,t256:2.164486056):2.854087212):9.307543499,((((t257:2.284644929,t258:2.221240129):4.760122667,(t259:4.962756354,t260:4.863638056):1.668497002):4.229032527,((((t261:1.053546174,t262:0.9552638114):1.377265125,t263:2.328341719):2.893683186,((((t264:1.486706098,t265:1.381862712):0.1487447022,t266:1.387589714):1.796288966,t267:3.119367123):1.035093705,t268:3.932135221):0.5154119797):4.119375488,((t269:5.968238884,t270:5.925180084):2.195785515,(((t271:2.147336907,t272:2.045869322):1.245342331,(t273:2.638392048,(t274:0.6485306409,t275:0.6168665916):1.96791598):0.6335085627):4.374284513,((t276:5.696874532,((t277:3.863388314,((t278:2.278657794,t279:2.275762634):1.155926112,t280:3.32510895):0.2863405608):0.7221945479,t281:4.229844342):1.00523276):1.608049343,t282:6.811973098):0.2419177085):0.1339407391):0.2893146151):1.177010175):2.88456691,(t283:6.910367382,(t284:4.114688467,t285:4.028994142):2.648668719):4.450673325):0.1497083675):0.03180603693):1.986492709,((t286:2.186421078,t287:1.905047321):6.495570339,(t288:5.54006753,t289:5.530894522):2.660180433):4.595983204):1.460299382):6.44215318):0.828048697):5.513298219,(((((t290:1.221179021,t291:0.9809342348):2.381179736,t292:2.923880413):8.536273331,(t293:3.457042719,t294:3.433520311):7.931708388):2.617315595,(((((t295:0.649388827,t296:0.6493860889):3.40138629,(t297:3.25800173,t298:3.11784714):0.7591296758):2.860361561,(((t299:1.139775193,t300:0.9841959902):1.011606682,((t301:0.8047377938,t302:0.6242381479):0.2162439553,t303:0.8314462696):0.9291906185):3.883172428,((((t304:0.7627720631,t305:0.7222592829):0.8446694367,t306:1.416775473):1.422868339,t307:2.824919435):1.232690595,t308:4.051672966):0.9445386443):0.6699940905):2.701399227,t309:8.261988367):2.661482575,((t310:1.302502658,(t311:0.221811312,t312:0.1576263632):1.073743743):5.956223718,(((t313:0.748853518,t314:0.7472611697):4.180735864,(((t315:2.195425924,t316:2.171421194):0.4529007025,((t317:0.2327113274,t318:0.07301953867):1.673215587,t319:1.714783496):0.6931578757):0.7002801017,t320:3.0794299):1.441131367):0.1698203838,((t321:1.643559939,t322:1.569025518):2.997421802,t324:4.20667766):0.01535534182):1.830199298):3.663028598):1.421409591):3.976004318,(((t325:0.4485682377,t326:0.4193654584):2.13913236,(t327:0.6726469972,t328:0.6319586679):1.670424908):0.5274112829,t329:2.79895095):11.78344928):8.293218233):3.709854103):23.78026545):36.92594286):12.09784965,(((((t330:1.562335201,t331:1.519121989):11.62450763,((t332:2.220226912,t333:2.036228275):7.315160316,(t334:8.15111606,(t335:7.410579339,t336:7.284067662):0.7355326021):0.8779615338):3.557292298):3.713994082,((((t337:0.8011829057,t338:0.7008891315):7.641999644,((t339:0.1942305843,t340:0.1786282988):6.854862281,((t341:3.489744553,(t342:2.619345,t343:2.522751051):0.8483230882):2.880410754,((((t344:0.296880639,t345:0.1649648601):0.1116155264,t347:0.1574558846):0.3765951823,t348:0.5103206594):0.5929156358,t349:1.081634334):4.852951887):0.6629648633):1.204761985):5.483663077,(((t350:0.3506902302,t351:0.2916951752):2.107981333,t352:2.35658533):10.37020484,(((t353:5.360083908,(t354:3.026583322,(t355:1.955636441,t356:1.703745426):1.059886699):2.317552289):2.611155687,(t357:4.822591594,((((t358:2.003688266,t359:1.900136197):1.660376246,t360:3.422971533):0.7699744186,(t361:1.906937512,(t362:0.8175770558,t363:0.6520078561):1.019405375):2.279268122):0.3316618121,t364:4.202622349):0.03832623416):2.794497791):3.375717777,(((((t365:1.815802657,(t366:0.5846764809,t367:0.5706023178):1.187156739):0.03133758409,t368:1.788588977):5.469540655,((((t369:0.628682818,(t370:0.2467110147,t371:0.1539645111):0.1926086901):4.34763938,(t372:2.525459844,(t373:0.7359482696,(t374:0.5732257307,t375:0.5587240342):0.09171750746):1.723757033):2.112226512):1.25765311,((t376:2.70970463,t377:2.700823784):1.253550488,(t378:2.397086408,((t379:0.7428969163,t380:0.7125902455):1.184239573,(t381:0.6979221231,t382:0.6940282681):1.166245176):0.4657681228):1.421075034):1.660879118):0.3054512161,((t383:1.496772766,(t384:0.7143356558,t385:0.6789557738):0.6233640901):0.8531384821,(t386:1.03080634,t387:0.860159587):1.001517928):3.269886887):0.6815927088):1.171717416,t388:6.938348892):0.9736133356,((t390:3.498239317,t391:3.283518342):2.975251734,t392:6.253413839):1.186103052):0.8061561923):1.332484552):0.4555872887):0.06901712299,((((t393:3.386005501,t394:3.358105629):1.544036151,(((t395:0.9780425194,(t396:0.6332173388,t397:0.4373355786):0.3331469739):0.05259546383,t398:0.7879932625):0.4024183844,(t399:0.0318908567,t400:0.01272175242):0.7459480353):3.402426453):1.005879097,(t401:1.655992704,(t402:0.1969223815,t403:0.1715047132):1.412056894):3.465548436):0.6660141402,(t404:0.5337264596,t405:0.5151347543):4.828203248):3.413279584):2.084468002):11.53212668,(((t406:2.276606894,t407:2.236541441):7.345384311,(t409:1.963352863,t410:1.938103964):7.438210735):3.389922485,(((t411:4.282818196,t412:4.141893061):0.3202960044,(t413:0.6969644631,t414:0.6728475744):3.721004201):4.379565677,((t415:1.718214612,t416:1.684236818):3.567109294,(((t417:0.8673027452,(t418:0.5280425055,t419:0.4255037383):0.2850797852):1.245330058,(t420:0.4487130636,t421:0.3790159345):1.368368426):1.917360179,(t422:0.6365046146,t423:0.5797367998):2.938417284):1.21706979):3.453937013):3.728045292):9.310072289):21.27563548,((((t424:4.061398883,(t425:3.841356693,t426:3.817917576):0.2130125365):10.81112448,(((((t427:1.614360091,t428:1.224444047):0.5009531785,t429:1.627444425):4.374791444,(t430:5.803111029,(((t431:0.5943195212,t432:0.5424219111):1.842970917,t433:2.268789534):0.1257024254,t434:2.263706225):3.185007037):0.1743222512):0.6949436593,((t435:1.310983111,t436:1.018090373):0.9296264211,t437:1.91707902):4.052380662):3.01998297,t438:8.826496433):4.396911888):0.9113520392,(t439:9.246500784,((t440:1.318377329,t441:1.191023523):0.6079317627,t442:1.664223598):6.933816623):4.769884807):23.36027521,(((t443:3.811834049,t444:3.77408588):8.389395386,(((t445:4.035193144,t446:3.891076249):0.2469964811,t448:4.006880312):2.97058409,(t449:2.460614382,(t450:0.9599161725,t451:0.8400509581):1.394752421):4.438253932):4.903686609):2.851592985,t452:14.40333359):21.58462626):3.3121696):49.64581193):112.0120395,(t453:64.95273048,(((t454:3.107334265,t455:2.976720887):1.219935916,t456:4.031820494):0.03588753922,(t457:2.081829651,((t458:0.2391705283,t459:0.2184899633):1.666722248,t460:1.809966215):0.1515366939):1.824161754):60.56332495):135.8899678);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T18.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
