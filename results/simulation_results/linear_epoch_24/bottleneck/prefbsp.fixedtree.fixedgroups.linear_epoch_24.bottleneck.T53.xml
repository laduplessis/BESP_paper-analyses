<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t483:37.70539641,(t484:17.85181383,((t485:0.7765329397,t486:0.6816513417):5.929854208,t487:6.522857348):11.07012358):19.76135816):96.46741098,(((t488:12.37655694,(t489:5.478303579,((t490:0.4876438809,t491:0.2902889151):0.4176370065,(t492:0.4217803079,t493:0.1524659104):0.190117377):4.530548624):6.80984788):18.46387217,(t494:14.25386804,(t495:11.35221944,(((t474:0.02465427361,(((((t395:0.009149785291,(((t326:0.2816236074,(t311:0.09285599622,((t226:0.06730225065,(t198:0.003565725809,((t173:0.04996019176,((t170:0.01807901649,(t161:0.1993903998,(t159:0.0109690214,((t148:0.009667280479,(t144:0.02270770038,(t133:0.02920902351,((t126:0.1373479905,(((t38:0.07458267694,t1:3.616750604):1.226607576,(t2:1.008100926,t3:0.7114568324):3.828490463):6.001187064,(((t4:9.062545997,(t5:5.803505363,(t6:3.654638174,t7:3.497318474):1.977732577):3.19709751):0.8818106854,(t8:8.584757673,(t9:3.250191934,t10:3.049646303):5.3110593):0.9090563035):0.05612721328,((((t11:4.309916527,t12:4.269429782):0.3098617562,(t13:3.596423411,(t14:0.9327580128,t15:0.8185555553):2.458829029):0.743011713):0.48382211,t16:4.475246141):0.5033263771,(t17:3.483790021,((t18:0.1919408865,t19:0.1703501381):1.574635226,(t20:0.06171075079,t21:0.005667050475):1.577808609):1.651796825):1.488092951):3.660850763):0.4689476923):2.02544077):1.029097843,((((t22:6.621421805,((((t23:2.469209153,(t24:1.655729685,t25:1.64166666):0.7900521866):1.088920227,t26:3.36210131):0.6868256254,t27:3.922848382):1.612883931,((t28:2.035011428,t29:2.01711231):2.967881505,t30:4.979571945):0.4528397458):0.4065620889):0.4830138362,(t31:4.79370642,t32:4.776874977):1.405719804):2.517654163,((t33:3.671483966,t34:3.601141941):3.939217836,((((((t35:0.7465564421,t36:0.4507703426):1.741889096,t37:2.075519822):1.486866707,(t39:1.348491385,t40:1.234104854):2.020074222):1.653264391,(t41:1.847183182,t42:1.832102146):2.74574457):1.572940174,((t43:2.462093497,(t44:1.665542518,t45:1.657574377):0.7647447648):3.532934803,(((t46:5.488368883,((t47:4.165627387,t48:4.129403712):0.2348897607,(t49:0.4648680747,t50:0.36609824):3.695829308):0.9921863458):0.3953679606,(((t51:4.492709282,((t52:1.733399413,((t53:0.09364716987,t54:0.06027023213):0.4326924319,t55:0.4632907594):1.042563509):2.168528401,t56:3.444891318):0.4480896326):0.8630325401,((((t57:2.46615114,t58:2.454062697):1.98267032,((t59:3.817862678,t60:3.606622469):0.2150222469,t61:3.662766794):0.2709608206):0.07311078862,t62:3.93702453):0.003576372444,(((t63:2.35186249,(t64:1.92153462,t65:1.796699904):0.3775490103):0.8422989877,t66:2.96766599):0.3969523719,t67:3.336662098):0.2900032906):0.02215300084):0.03862308198,(t68:3.324473481,(t69:3.234702821,t70:3.195944795):0.02747274841):0.1865301359):0.03519127052):0.05944356062,t71:3.474089514):0.00531066338):0.002623033802):0.1247658752,((t72:0.9599920421,t73:0.855776951):1.152746424,t74:1.919728874):1.322083856):0.1937787743):1.08688945):0.244050232,((((t75:2.469065265,((t76:1.111206818,(t77:0.1825168514,t78:0.1490438174):0.3588774625):1.087166234,(t79:0.1554798315,t80:0.05847765585):1.312574651):0.2209673596):1.219872298,((t81:1.443543109,t82:1.358677492):0.3574821919,t83:1.540309849):1.001031087):0.3456534126,(t84:1.088481342,t85:1.033953176):1.66240822):0.3140102162,((((t86:1.587180029,t87:1.583545993):0.01727779475,t88:1.578039772):0.1533593414,(t89:0.8180816416,t90:0.7997852508):0.8133767176):0.122983213,(t91:1.049754815,t92:1.042352157):0.6601779574):1.120625895):0.0252646891):1.941964202):0.04262080795):0.9963719365):0.1692893945):0.2621847663,(((((t93:1.430534823,(t94:0.5766344813,t95:0.07053554821):0.5692769659):2.238184778,((t96:2.012775235,t97:1.842215734):0.6423209079,t98:2.34461012):0.2121549243):1.236940727,(((((t99:0.1511810525,t100:0.05553245922):0.6307243082,((t101:0.3971535794,t102:0.375297684):0.2554248022,t103:0.5761914801):0.00907760755):0.5390035736,((t104:0.1226786463,t105:0.08180597138):0.7628645731,t106:0.8434155123):0.1889346161):1.013328278,(t107:1.51204766,((t108:0.6570658068,t109:0.4974001235):0.7619436689,t110:1.049989706):0.01848360865):0.4107869084):0.1025821898,(((t111:0.7142022016,t112:0.4573057821):0.2115404001,t113:0.5019523913):0.168038917,t114:0.6695547309):0.4546367101):1.238357254):0.03331900432,(((t115:0.9734614131,t116:0.6185391739):0.8557082487,t117:1.370228321):0.05145414223,t118:1.370221631):0.4162953717):0.521374318,(t119:1.825125734,(t120:1.549017884,(((t121:0.4005170323,t122:0.3172603378):0.3143423105,(t123:0.4711895161,t124:0.4708222849):0.1552519078):0.259999777,(t125:0.5419696038,t127:0.3190439296):0.277831975):0.5390746685):0.1588051364):0.4492492238):0.7467441927):0.5679658949):0.2758009033):0.5939705456):0.08123898291,((((t128:1.948303625,t129:1.919308024):0.3381655224,t130:2.21887191):0.483955342,(t131:2.383086745,t132:1.989897138):0.08842409918):0.3233199902,t134:2.025747704):0.8423984977):0.1734967857):1.770691935,((t135:0.5038573868,t136:0.4920890774):3.47800181,((t137:2.115918802,t138:2.011500041):0.4749209809,(t139:1.380608976,(t140:0.4825889288,t141:0.3686210254):0.8062717668):1.080712129):1.329577022):0.5895119797):0.7851785299):2.147769703):2.098800676,(((((((((t142:0.1815700237,t143:0.1460492209):2.064503803,(t145:2.094249346,((t146:0.3448294044,t147:0.3052340813):0.03447594315,t149:0.2609047296):1.702154207):0.04827611222):0.8701617767,(t150:0.189572007,t151:0.1063264786):2.621668809):0.1127987315,(t152:0.09377838358,t153:0.08291342309):2.708509269):0.08102915515,((t154:0.4331212707,((t155:0.1863875651,t156:0.09174121464):0.2070006,t157:0.2932748905):0.008533092503):0.4793939484,t158:0.5885875908):1.848426654):0.2333260365,((t160:0.6073435945,t162:0.2728549432):0.4373419166,t163:0.6835461428):1.372670714):0.1935774168,(t164:0.5569846214,(t165:0.1747488283,t166:0.1145171166):0.2899029764):1.649267282):4.304799864,(((t167:0.2212581235,t168:0.1698628343):0.3178850063,t169:0.4331796421):0.1336057579,t171:0.3617537457):5.574236886):0.1827430116,((((t172:1.102162775,(((t174:0.2688674156,t175:0.2494185034):0.428814665,(t176:0.1302258657,t177:0.07838541464):0.3617363807):0.2240726128,(t178:0.2921328016,t179:0.1211276681):0.370499541):0.05130372572):1.54183991,((t180:0.5407330239,t181:0.4069229633):0.3877770699,(t182:0.6682540968,(t183:0.4899281919,t184:0.3998279999):0.05893954857):0.01790311922):1.153810671):1.688227245,(t185:0.866924067,t186:0.7765357312):2.396326327):0.4596262296,((t187:0.5216268562,t188:0.5068619689):0.3058868462,(t189:0.627314309,t190:0.5429389778):0.1510046835):2.75181747):1.306693197):0.7668772839):5.413696607):1.323590829):1.654582636,(((t191:7.546308893,((t192:2.765845804,t193:2.347032117):2.275450791,((t194:3.260816492,(t195:2.273929262,t196:2.259108091):0.8846494366):0.02663595153,t197:3.014481497):1.149434545):2.369315511):3.92498666,(((t199:6.945316235,t200:6.837894748):0.588989268,t201:7.245575244):0.06496569953,((t202:4.511845935,t203:4.43513742):1.831315117,((t204:1.342173528,t205:1.251329743):3.404663491,((t206:1.97936227,t207:1.93894606):2.20501856,(t208:3.255240846,t209:3.248695749):0.827444383):0.4327992552):1.494034774):0.9516589468):2.660518918):1.614930889,(((((t210:3.341961586,t211:3.327862744):0.3313136205,t212:3.581276581):1.61177048,((((t213:0.2062118335,t214:0.1928997732):1.282893545,(t215:0.3976320446,t216:0.3301222296):0.9586462742):1.241648017,((t217:1.805907726,t218:1.805165197):0.2978669652,t219:2.066277726):0.2780482736):1.524700749,(t220:3.511299834,(t221:2.601089799,t222:2.551516487):0.9027378264):0.2425059699):0.915742654):2.467874466,t223:6.959911753):0.7248886715,(t224:0.3715869063,t225:0.3560538372):7.312449952):2.704010469):0.5747984455):0.7303317351,(((t227:4.310239479,(t228:4.089897096,(t229:3.649039107,t230:3.634026481):0.3892997531):0.05833953136):3.195426663,((t231:3.030843593,((t232:0.682559384,t233:0.6080166939):0.5593832652,t234:1.098360427):1.707871743):0.3198548906,t235:3.115017825):3.860896679):0.280222758,(t236:1.597282252,t237:1.570488578):5.349186185):3.312622869):4.322405461):2.507718333,(((t238:4.83192861,(t239:4.097419031,(t240:2.511424938,(t241:0.9099072413,t242:0.8917114785):1.565350716):1.566480621):0.7333340466):3.167379647,(t243:0.4859789569,t244:0.4027182922):7.253535522):7.990277648,((((t245:2.680876603,t246:2.615495301):1.93696514,(t247:2.995134597,t248:2.627452947):1.530969741):2.050042754,t249:6.185223875):1.690267029,((t250:4.589391763,((t251:2.422601375,(t252:0.3808599076,t253:0.2759180719):1.764794826):1.711095725,(t254:3.043485266,(t255:2.989539935,t256:2.968170566):0.02631772436):0.6892694672):0.3918043936):0.143971767,(t257:0.2611342506,t258:0.2610143726):3.851384501):2.943591287):7.229281225):1.061627586):2.74128844,((((t259:2.582429182,t260:2.135650569):0.1274192025,(t261:0.1485591744,t262:0.1473290542):2.059139095):12.16073931,((((t263:0.7157706728,t264:0.3915737585):9.106460153,(((t265:4.004213682,(t266:1.410504479,t267:1.15541234):2.58244084):1.798180842,((((t268:2.95523843,t269:2.881041378):0.02532151338,t270:2.85453483):1.097621443,(t271:0.3845237798,t272:0.3656537973):3.441953214):1.338182996,(t273:2.893542456,t274:2.659197638):2.1862805):0.0588401718):3.09704549,t275:7.966746072):0.5544616315):3.295868506,(((t276:8.930366776,(((((t277:1.365337109,(t278:0.8717035599,t279:0.6917151827):0.4615753886):3.690465635,(t280:2.189681655,(t281:1.911729627,t282:1.821396299):0.2335306259):2.635805671):0.1161551863,t283:4.787866747):0.3685329822,t284:5.132725993):0.004560585209,(t285:4.829705999,(t286:0.460653186,t287:0.4273559537):4.256911441):0.1033200824):3.381467335):0.8166772133,((t288:6.169374115,t289:5.941212787):2.477728398,(((t290:2.908380067,t291:2.878369899):3.81941586,(t292:5.388885094,t293:5.370861264):1.295801466):0.8368460179,(t294:4.303738156,(t295:3.004752023,t296:2.848027752):1.292242369):3.177549382):0.7001427986):0.3207870452):1.071951863,t297:9.353874609):0.8705729895):1.054361838,((t298:0.05618376359,t299:0.01978207686):1.046212569,t300:1.031609565):9.918839974):0.09189419988):0.3616960242,(((t301:3.879621457,(t302:1.756501579,(t303:1.395878393,t304:1.358612167):0.2322873278):2.081920137):5.514819512,(((t305:2.191625523,t306:2.176546739):2.735490584,(t307:0.3892514245,t308:0.1821744237):4.513157431):3.883432803,(t309:5.409983119,(t310:3.632613893,(((t312:1.160629281,t313:0.8879498773):0.4360546073,t314:1.320330814):1.42760077,((t315:2.044337978,t316:2.023781369):0.2995770143,t317:2.244634907):0.3080211032):0.4467191433):1.512595149):3.146845098):0.3506501879):0.1660438531,((t318:5.048008822,(t319:0.6205152785,(t320:0.4082338703,t321:0.3831469487):0.1741269743):4.408753931):0.2727184809,(t322:0.6211316923,t323:0.4864356748):4.586811456):2.767128838):1.80915929):2.820441492):1.077684243,(((t324:0.5106779781,t325:0.3880442271):3.028084832,t327:2.908395178):6.666966037,((t328:3.07771125,t329:3.07599519):3.292102207,(((t330:3.725246453,(t331:1.58704057,t332:1.311656134):2.008016217):0.4238807797,t333:3.701027642):2.101896712,t334:5.693504793):0.08009738316):3.189311711):3.299232123):1.491972385,((((t335:2.867290119,t336:2.426109941):6.353491369,((t337:1.923925316,(t338:0.9474194284,t339:0.9003718432):0.9626930443):4.748069574,((t340:3.215606027,(t341:1.10868966,t342:0.6494480479):2.100837512):1.589191758,(t343:4.049628707,((t344:1.320853766,t345:1.279341413):1.222446466,t346:2.470613072):1.480285091):0.2375437474):1.755081487):2.088183852):3.39431142,t347:11.40933864):0.7142524786,((t348:4.513781565,t349:4.468005607):0.2065844752,(t350:2.711426145,t351:2.656479251):1.942337807):7.374551198):0.108852645):0.2611555413):7.95693146,((((t352:3.283059147,t353:2.996942013):4.455363517,(t354:5.251545832,t355:5.236000064):1.755803595):1.500692432,t356:8.238657616):3.083140003,((t357:1.101151892,t358:1.095690568):6.713090427,(t359:3.572792377,t360:3.563731228):4.224334681):3.459977118):7.873831753):4.711047108,(((((((((t361:0.5052989174,t362:0.4997216987):4.206599394,t363:4.668076625):0.9441570367,t364:5.546210944):0.09404711276,t365:5.551004174):1.527988021,(((t366:1.394450447,(t367:0.2153497856,t368:0.2067598254):1.02082265):2.0942575,(t369:2.857694994,t370:2.7035067):0.3195798884):3.391249771,(((((t371:2.033507259,t372:2.031463489):1.35949893,t373:3.36078256):0.1887102345,t374:3.424972873):0.6066793731,((t375:0.5114746157,t376:0.4976265242):2.093244202,(t377:0.7164676686,t378:0.5912159037):1.68508482):1.278894843):0.6263648504,((t379:1.187237006,(t380:0.8020017502,t381:0.742871571):0.2999686125):0.4977304679,((t382:0.4047271071,t383:0.234958227):0.6644469933,t384:0.8844182317):0.4229676294):2.391633323):1.486371141):0.1268602293):0.2495179953,(t385:1.980846287,(t386:1.573435579,t387:1.534723481):0.3814836781):3.575024335):3.900874921,((t388:2.79239984,t389:2.709895712):5.907834196,(t390:6.169476176,t391:6.111768949):2.376549242):0.6474852498):1.759451632,(t392:7.983940086,(t393:5.335261791,(t394:4.431887389,t396:4.372879855):0.6395705426):2.570535636):2.784131345):8.962005901,(((((t397:1.261091591,(t398:1.120783138,t399:1.102783795):0.1004022407):8.266569082,t400:9.425835456):1.266876499,(t401:2.499410692,t402:2.473619505):8.189798662):5.531193094,(((((t403:1.111668297,t404:0.5988885915):4.0370027,((t405:0.7279680684,t406:0.0213318286):2.258833614,t407:2.212461076):1.623909793):0.2870033496,t408:3.992040569):2.558512,t409:6.548285045):2.709225449,t410:9.209426578):5.444624012):2.221601167,(((t411:4.597050417,t412:4.465968392):0.224177203,((((t413:1.654145744,t414:1.493311513):0.3177157713,t415:1.430476367):0.292002979,t416:1.520870291):2.301444613,((t417:2.618966115,t418:2.489433798):1.123124951,(t419:3.210780258,((t420:0.6185836868,t421:0.4901441556):0.4963304448,(t422:0.820695188,t423:0.7711871468):0.109302987):1.738109926):0.3827166618):0.007519401286):0.03744092921):0.4735301715,t424:3.518312251):11.46775192):0.7120843058):1.398973971):0.8805184597):2.894829174):15.75160058):11.30732471,((((((t425:1.445627136,(t426:0.231939045,t427:0.1424913939):1.167124867):2.033641385,(t428:3.162863383,t429:3.121604952):0.01721466801):0.004645186316,t430:3.100887136):13.67894412,(((t431:3.967313082,(((t432:1.060773538,(t433:0.5927069775,t434:0.5830177144):0.4433217234):2.148250534,t435:2.969624296):0.2383665365,t436:3.008303899):0.4296917969):3.223589948,(t437:2.679633019,((t438:1.727797674,t439:1.500141266):0.7829565562,t440:2.071874247):0.06332709203):3.742527634):7.235243109,((t441:6.611644726,(t442:5.913345642,t443:5.854080832):0.6340137833):3.688597347,((t444:2.397757305,t445:2.325714725):1.788278958,t446:4.005239274):5.860851001):2.710715671):2.347402279):1.933548448,((t447:3.15034344,t448:3.125391417):10.10347933,((t449:2.325561204,t450:2.202223689):4.241402251,(t451:1.34203194,t452:1.179711831):5.018178407):6.483660057):3.43761646):10.69926764,(t453:6.117330074,(t454:1.538964034,(t455:1.006267494,t456:0.8800103382):0.5114114732):4.523881098):20.67103029):18.03555692):91.66602558):342.3211293,((((((((t457:0.4781024512,(t458:0.3019298895,(t459:0.1036472955,t460:0.07601974079):0.1060474745):0.1006010596):1.823831699,t461:2.083672142):1.302360858,t462:3.374246773):1.395448798,((t463:0.5511739013,t464:0.419661054):0.09377178979,t465:0.5093164083):4.120197868):5.82350295,((((t466:2.411013205,(t467:2.237887124,t468:2.182304733):0.1167884321):0.8738722411,(t469:1.306513297,(t470:0.3596137551,t471:0.28834157):0.7916615984):1.837202693):0.8077225268,(t472:2.420545253,t473:2.380676312):1.289281175):5.771919766,t475:9.215653723):0.5094252903):3.919496034,(((t476:1.380021853,t477:1.178482801):1.082324846,t478:2.174483886):5.689019142,(t479:1.31601961,t480:1.236141536):6.514190905):5.492271667):24.94713511,t481:37.94253422):32.1080766,t482:69.7692662):406.7382942);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.bottleneck.T53.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
