<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t201:0.3345525244,((t202:0.07767935659,t203:0.07119701198):0.1972177034,t204:0.2669859355):0.03181813692):2.377427427,(((((t205:0.556773045,t206:0.556768132):0.3316496533,(t207:0.8082891405,(((t208:0.1016837606,t209:0.1004455878):0.4409279257,t210:0.5342042665):0.236738238,(t211:0.7290592355,t212:0.7184889612):0.04085552697):0.02276296651):0.07963910824):1.309821969,t213:2.164605595):0.005403947754,(t214:2.065296239,(((t215:0.4101941832,t216:0.4100217459):1.108237632,(t217:1.402424025,((t218:0.1860366255,t219:0.1836330596):0.701121542,(((t220:0.6945135734,(t221:0.5982661953,t222:0.5867230987):0.09089102155):0.006129487519,((t223:0.1916515872,t224:0.1846760112):0.3702346237,t225:0.554184979):0.1210875352):0.04350351708,t226:0.711502114):0.1240514406):0.5134314577):0.1074609396):0.5031355794,((t227:0.01166495508,t228:0.01073007395):1.307824275,((t229:0.596867844,t230:0.5964275921):0.07342330925,(t231:0.3039583426,(t232:0.2662141928,(t233:0.1960030678,(t234:0.02928790033,t235:0.02680053078):0.1575336426):0.06888681395):0.03554124064):0.3658029321):0.6479196588):0.6389184527):0.03606541471):0.09449184052):0.1286818958,(((t236:1.523362685,(t237:1.237358637,(t238:0.3212144113,t239:0.3127909201):0.9156162913):0.281527171):0.3819897777,((t240:1.322534675,(t241:0.9270804822,(t242:0.4167403997,(t243:0.2781310092,t244:0.2666648556):0.1370830179):0.5067506997):0.3889203671):0.253339554,(t245:0.6828163353,(t246:0.3348574211,t247:0.3209646486):0.334010008):0.8693389233):0.3053894997):0.1394431986,(((((t248:1.065968976,t249:1.065352988):0.2279411026,t250:1.282629116):0.3493357991,(t251:1.270452577,((((t252:0.6227814684,(t253:0.5233200324,t254:0.5151420214):0.09785238902):0.3111733426,((((t255:0.2432443766,t256:0.2371122514):0.4600773429,((t257:0.0593452701,t258:0.0584460643):0.4179978326,t259:0.465982224):0.2039054929):0.004869363329,(t260:0.08769482009,(t261:0.01514987222,t262:0.01453305387):0.07114836427):0.5869266245):0.05979913981,(t263:0.6933145425,t264:0.6885724329):0.03246400707):0.1392860026):0.06462856456,(t265:0.8030403943,(t266:0.2104103105,t267:0.2023899344):0.5896498691):0.1190881537):0.03865287979,(t268:0.02048217861,t269:0.01829189409):0.9247621247):0.2066285938):0.3297866915):0.1994952892,(t270:0.4680669956,t271:0.4665656901):1.208388772):0.07226924886,(((((t272:0.8498332392,(t273:0.09810458198,(t274:0.05626367673,t275:0.05047886315):0.04177344114):0.7488163718):0.1893796697,(t276:0.3289643271,t277:0.3266602455):0.7004715929):0.007468390898,t278:1.032722873):0.1725099661,(((((t279:0.08594672631,t280:0.08451920115):0.2255932068,t281:0.3084913656):0.03751769012,(t282:0.3095656705,t283:0.3071198298):0.02350478187):0.4351237159,(t284:0.2224597464,t285:0.2213595546):0.5128391131):0.2691633071,((t286:0.09148869622,t287:0.07047446971):0.6032226557,t288:0.6459596082):0.303977099):0.1407172531):0.5210635028,(((t289:0.70711085,((t290:0.1029734161,t291:0.09165782183):0.4147183278,t292:0.5002527348):0.1783472791):0.05281882004,t293:0.730534142):0.1275646535,t294:0.8530263102):0.7129459701):0.005891228068):0.04648980468):0.1451731101):0.3313626939):1.790340665,((((t295:0.6903305796,(t296:0.6221084206,(t297:0.5835913303,t298:0.5828730657):0.01741800636):0.06407503214):1.234696873,(((((t299:0.7791418038,((t300:0.1022701572,t301:0.09729000345):0.5074503668,(t302:0.2551559245,(t303:0.2199330446,t304:0.1937826786):0.02585214921):0.345602202):0.1614631597):0.2951307144,(((t305:0.1722745379,t306:0.1684184635):0.4964281058,(t307:0.6375400218,t308:0.62930761):0.02523612259):0.19975633,((t309:0.457336424,(t310:0.2027210209,t311:0.2012911424):0.2458934647):0.05972575446,t312:0.506547069):0.3355387658):0.149206282):0.1490977132,(t313:0.2913057275,t314:0.2839884047):0.8459923741):0.2716088125,(t315:1.211684148,((t316:0.08988057069,(t317:0.004441550413,t318:0.001123769533):0.07422280131):1.038330504,(t319:0.2697750852,t320:0.2593454081):0.8432396902):0.08276060603):0.175231789):0.3982681763,(((t321:0.4573667637,(t322:0.3285499168,t323:0.3200877493):0.1223227078):0.2585599171,(t324:0.5762925582,((t325:0.17394267,t326:0.1654024374):0.1161880664,t327:0.2790477175):0.2830165547):0.122736029):0.1794592239,t328:0.8627683293):0.8619373426):0.001515450074):0.2319423828,(t329:0.5785845337,(t330:0.4035735351,t331:0.3936803161):0.1742242951):1.378817154):1.193279771,((((((((t332:0.1990615898,(t333:0.05981960057,t334:0.05683029766):0.1388139682):0.6318015664,(t335:0.3979436982,t336:0.3622273893):0.428500862):0.1219538578,t337:0.9100065642):0.7562496035,(((t338:0.7297208459,t339:0.7079578246):0.111762089,t340:0.8115803916):0.1373923256,(t341:0.5393639896,t343:0.5320499793):0.4095429245):0.6871501866):0.1759858787,(((t344:0.6155737802,((t345:0.209197213,t346:0.190669101):0.2315632615,t347:0.4185785364):0.1735441802):0.1644781258,t348:0.7448666162):0.6110903388,(((t349:0.172557543,t350:0.157574675):0.5191349259,(t351:0.2553686661,t352:0.2347326276):0.4089690785):0.03162993328,((t353:0.1923671792,(t354:0.09676491308,t355:0.09425701421):0.09288104804):0.3538713093,t356:0.5349417499):0.1211966667):0.6269710034):0.4071640889):0.6346544623,((t357:0.9373711563,((t358:0.5558238608,t359:0.5488642977):0.3340991951,((t360:0.01209330823,t361:0.006824651316):0.1690656735,(t362:0.07671800804,t363:0.07041707057):0.09106319273):0.6960571905):0.04240399049):0.2667851576,(((t364:0.4353456502,(t365:0.2069293531,t366:0.197331723):0.2232523023):0.1506136807,((t367:0.01297330813,t368:0.009938340171):0.1297393618,(t369:0.03197793526,t370:0.02928326483):0.09995054448):0.4283492484):0.5033728785,(t371:0.5939404759,(((t372:0.3460042933,t373:0.3273437807):0.08522102723,t374:0.4049092609):0.1400495646,((t375:0.4971141898,(t376:0.3220710047,(t377:0.2759151975,(t378:0.04092688819,t379:0.03551591262):0.2229919155):0.04295480736):0.1747545858):0.001512402365,((t380:0.2546326418,t381:0.2539980828):0.1763784723,(t382:0.3521437658,(t383:0.09668536378,t384:0.09260497558):0.2550286094):0.07731586826):0.038949095):0.04485857943):0.0212299491):0.4657128483):0.07671661756):1.115894526):0.03659852659,(((t385:0.842671287,(((((t386:0.1165002594,((t387:0.0721897411,t388:0.07061455955):0.01517590719,t389:0.08378608788):0.0241197024):0.1822059595,t390:0.2860389694):0.02559192487,((t391:0.08135079974,t392:0.06645042962):0.1624482864,t393:0.2146651058):0.06581087518):0.2880950751,(t394:0.2711542425,(t395:0.2287030734,((t396:0.04955458054,t397:0.03953033122):0.06475138525,t398:0.1015042657):0.111200951):0.04008821303):0.2956539606):0.1448547512,t399:0.6908410159):0.08296835048):0.6423949128,(t400:0.1443691628,(t401:0.03091544973,t402:0.0233653095):0.1119672443):1.271291389):0.417945915,(((t403:0.597334879,(t404:0.2512805366,(t405:0.1106596217,t406:0.09359956409):0.135888494):0.3457950319):0.3282839926,(t407:0.464757411,((t408:0.2897274419,t409:0.2876316627):0.1215505187,(t410:0.3308687119,(t411:0.05730755604,t412:0.05308940561):0.259917332):0.0677290715):0.0473130544):0.4195136179):0.7104328283,((t413:0.0684264287,t414:0.06642778094):0.9200098505,(t415:0.2407200343,(t416:0.07729968621,t417:0.07386781465):0.162258921):0.7351723525):0.5693015758):0.181867492):0.320256275):0.1515044401,t418:2.187991198):0.4274643296):0.53206932):0.1838467337,((((t419:0.5894674431,(((t420:0.09628974801,t421:0.07838973319):0.2547639958,(t422:0.3164202786,t424:0.3111647307):0.01423642153):0.01484804797,(((t425:0.03636834762,t426:0.03178250697):0.1744016945,t427:0.1920383375):0.07942992037,t428:0.2698438477):0.04630113261):0.2039448747):0.7814808742,((((t429:0.1590126897,t430:0.158798415):0.6035556676,(t431:0.1063971211,(t432:0.03130571529,t433:0.02282793254):0.07100042014):0.6510654117):0.06900569642,((t434:0.675622192,(t435:0.5079620941,(t436:0.1484293123,t437:0.1459490953):0.3554809114):0.1660851725):0.08824170834,(t438:0.7389550537,(t439:0.6740240618,(t440:0.4826839381,t441:0.4809203777):0.1897317806):0.0552565553):0.00984741359):0.03494844052):0.1527510929,(((t442:0.05247333132,t443:0.05156446526):0.05771104011,t444:0.09648720919):0.1292796106,(t445:0.1910359147,t446:0.1899279647):0.0340931627):0.6805823094):0.3167832047):0.5947685018,((((t447:0.4386040783,(t448:0.1026603651,t449:0.1002938465):0.3347373041):0.4141272269,((((t450:0.1454322651,t451:0.1418927876):0.04357031152,t452:0.1783317917):0.1313397841,t453:0.308476796):0.3874704993,((t454:0.1838061583,t455:0.1690399974):0.01482820171,(t456:0.1107873033,t457:0.1088406727):0.06810349818):0.4962524284):0.1411507869):0.2755265191,(t458:0.9863721088,t459:0.9756321028):0.09823805493):0.03505086486,((t460:0.1798486842,t461:0.1763629046):0.6298590289,(t462:0.3957602981,t463:0.3911040985):0.4058845071):0.2900482462):0.6355186197):0.3109709091,((t464:1.05493979,t465:1.052927339):0.8627071955,(((t423:0.0001637041081,((t342:0.002915003465,((t142:0.003788241038,t1:0.9429783866):1.295469025,t2:2.234827148):0.04170468962):0.4333034795,((t3:1.832901941,(t4:1.766236156,((t5:1.712548204,t6:1.691423604):0.03067520632,(t7:1.642755742,(t8:1.347325691,t9:1.341937725):0.2880132403):0.07695137398):0.02146964555):0.06156918352):0.784381213,(t10:2.220639623,((t11:1.636031918,t12:1.632184793):0.159567156,t13:1.782535114):0.4192726168):0.3522421935):0.09050141608):0.05049494857):1.437719224,t14:4.13028785):0.209901739,(((((t15:0.8679192483,t16:0.865513206):0.7748802268,(t17:1.312073809,t18:1.310408557):0.3138334409):0.3671891069,t19:1.969344023):0.5228198634,t20:2.491627769):1.017606456,t21:3.506873002):0.7662847455):0.4844142728):0.1041487371):1.051837162):1.274034975,((((t22:2.142056093,((t23:0.4836794865,t24:0.47777418):1.302328215,(t25:0.7786084141,t26:0.7605295853):0.997895464):0.3474542068):1.02689909,((((t27:0.7923136904,(t28:0.2475281419,t29:0.2244244899):0.5441364376):0.07889719641,t30:0.8451876441):1.200935346,t31:2.04590784):0.2072645941,(((t32:0.4323179697,t33:0.4173353559):0.1812329139,t34:0.5930713898):1.282889493,t35:1.870407602):0.3426561841):0.852734679):1.542849341,((((t36:2.958377432,(((((((t37:0.1838079049,t38:0.1816751218):1.345243937,((t39:0.09272308626,t40:0.0903604302):0.8060446463,t41:0.891851316):0.6054184824):0.7211297696,(((t42:1.086366525,(t43:0.4355966952,t44:0.4225117923):0.6484528402):0.636185206,t45:1.695777466):0.4535716383,t46:2.148145333):0.04208004823):0.07294162715,(((t47:0.7193944504,t48:0.6938396204):0.5894904778,(((t49:0.6453215879,t50:0.6415739509):0.2056211426,t51:0.8325951555):0.3242123573,t52:1.151397508):0.09118646889):0.6646070679,(t53:1.896797626,(t54:1.622858449,(((t55:0.3088796306,(t56:0.1068492088,t57:0.1067827796):0.2002954673):0.2561289276,(t58:0.04284737118,(t59:0.009239647481,t60:0.007610741394):0.03339654575):0.502963205):0.681649411,t61:1.222595654):0.3631605758):0.2678055356):0.003104024434):0.2845338646):0.01344896903,t62:2.14673197):0.02955574176,(t63:2.074526797,((t64:0.8157552676,t65:0.8140437294):0.9999212427,(((t66:1.100709374,(t67:0.900044952,t68:0.8960209258):0.1896259252):0.1070887814,t69:1.186976631):0.3114314778,(t70:1.076103723,t71:1.075807802):0.4194052382):0.2941795185):0.2556880742):0.08893179973):0.133217065,(t72:1.802379078,(t73:0.3265207008,t74:0.324793188):1.475538511):0.4635474965):0.4571686138):0.3517074822,(((((t75:1.106710877,t76:1.104607551):0.7199595314,t77:1.821655129):0.06514056601,((t78:1.319494455,(t79:0.8932037691,t80:0.8898234077):0.4248183262):0.4579054934,((t81:0.7010214449,t82:0.7000976735):0.4227580431,t83:1.121477029):0.6332895043):0.1039748661):0.279914986,(t84:1.897438083,(t85:1.682070909,t86:1.668191561):0.2106135493):0.2314876876):0.8781905507,(((t87:0.9645016742,t88:0.9591151537):1.346282417,((((t89:0.8340270629,t90:0.8281155375):0.7366794972,(((t91:0.2761356521,t92:0.2705917792):0.6705389312,(t93:0.4259055912,t94:0.425666812):0.505617306):0.1737711404,t95:1.101927394):0.4337566048):0.5441114516,(t96:1.570037575,((t97:1.002584901,(t98:0.1440226489,t99:0.1351007876):0.8480746662):0.01648679751,(t100:0.5225129762,t101:0.5179259759):0.4721187768):0.5480350278):0.504886581):0.08164211509,(((t102:0.8822496623,t103:0.8798383954):0.793045247,t104:1.665679851):0.2429282434,(t105:1.562134152,t106:1.552915731):0.3276803826):0.2049968455):0.1084624213):0.09105485278,(((t107:0.8612796519,t108:0.860886865):0.8301611817,(t109:1.150908884,t110:1.149051258):0.5379274937):0.4130592797,((t111:1.602787537,t112:1.59901307):0.1083885351,t113:1.702193776):0.3849215444):0.1634871352):0.5836291453):0.004237527352):0.2715846212,((t114:1.999436964,((t115:0.9922506259,t116:0.9837722105):0.9201943506,(t117:1.794059256,(((t118:0.5613422581,(t119:0.5319118671,t120:0.5293605711):0.02569527231):0.7736778686,(t121:1.27816679,t122:1.266201423):0.04365216871):0.4182605938,((((t123:0.5847190951,t124:0.5835122127):0.5174997695,(t125:0.1112807679,t126:0.1022131366):0.9752662286):0.3653347259,t127:1.417115476):0.009733678842,t128:1.424467899):0.2453031006):0.03102224134):0.1072660839):0.08426160145):0.2603661757,(((((t129:0.7253297581,(t130:0.04663161421,t131:0.04316794692):0.6735136931):0.8282935199,((t132:0.6203781305,(((t133:0.07294044929,t134:0.068989411):0.1465348152,t135:0.2097562297):0.3745967824,t136:0.5806845098):0.02285905559):0.8086724562,t137:1.403495665):0.09284470779):0.2468758274,((t138:1.672523183,t139:1.67245034):0.03067106641,(t140:0.1415587297,t141:0.1378164528):1.559602458):0.04002087908):0.1991914132,((((t143:1.109748305,t144:1.106457378):0.3128372951,(((t145:0.3567217417,t146:0.3559891363):0.5697605117,(t147:0.4824034408,t148:0.479801572):0.4226169271):0.01973035638,t149:0.9116511226):0.4706551575):0.3102701465,(t150:1.520966613,((((t151:0.04425897061,t152:0.02186440794):0.6475511408,t153:0.6549921104):0.2428497608,t154:0.8959521362):0.2517250448,t155:1.144611044):0.3279861043):0.1712767696):0.04982990054,((t156:0.3885576864,t157:0.3776103824):0.5991625107,t158:0.9762580606):0.6881625212):0.1322088994):0.04861483441,((t159:0.2752268143,t160:0.2739460676):1.471332664,(((t161:0.9470955156,(t162:0.2449449533,(t163:0.1804369149,t164:0.1749958429):0.06100415716):0.6909495737):0.02782088372,(t165:0.6228584542,t166:0.6204016604):0.3218126208):0.7295314456,(t167:0.4564489879,(t168:0.01289699782,t169:0.01123829229):0.4343176623):1.206610245):0.02892986016):0.0956869499):0.0811826666):0.8487823329):0.2246819238,(((((t170:0.8078555356,t171:0.8009815598):0.7554166628,(t172:1.369244674,((t173:0.5006283613,((t174:0.2852263924,t175:0.2835707723):0.001359373595,t176:0.2713547835):0.2102077048):0.01601610624,t177:0.4869918358):0.8497268278):0.1756875945):0.185986284,t178:1.692593875):0.1610875493,(t179:1.015974729,t180:1.015695938):0.8276477361):0.779067546,(t181:0.6826429883,((t182:0.4483420832,t183:0.4448585037):0.1397924435,((t184:0.02717842899,t185:0.01027836838):0.5251343526,t186:0.5298894998):0.02990110226):0.07938017311):1.939216639):0.2383908533):0.785570574):0.6304036881,(((t187:0.7128427325,t188:0.708495737):0.2537728757,((t189:0.3773706907,t190:0.3737946116):0.4488877543,(t191:0.437919987,t192:0.4368363057):0.3774368428):0.1148842146):1.926524781,((t193:1.032312501,(t194:0.9026734174,t195:0.9004459412):0.1251067949):0.2782425052,(t196:0.8241809736,((t197:0.6041069397,(t198:0.3812565278,t199:0.3671702573):0.2207559884):0.1571696484,t200:0.7137694514):0.05932733241):0.4751034399):1.539674915):1.335629528):1.843153403);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T17.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
