<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t454:0.5736167979,(t455:0.1201615137,t456:0.1161064668):0.4466978454):0.578844757,((t457:0.206407171,t458:0.199687943):0.4132468308,t459:0.609651351):0.5200381617):2.288139554,(((((t460:0.1410486958,t461:0.1358230338):0.3534780322,(t462:0.3290576715,((t463:0.04766421678,t464:0.0403682534):0.04559109628,t465:0.07966854683):0.2329037089):0.1475060297):0.2674597764,((t467:0.1927249975,t468:0.1787895132):0.2506138494,t469:0.4144889436):0.2583837115):0.1422333206,(((((t470:0.02844832683,t471:0.003787073738):0.3254198779,t472:0.3283019236):0.08871789732,((t473:0.2570670667,t474:0.2514919686):0.05167520566,((t466:0.004068230884,((t427:0.005635650539,(t330:0.006327104142,(t155:0.008132224538,t1:1.0508653):1.060772141):0.6248722571):0.01707675324,(((t2:1.886411109,((t3:1.230136839,t4:1.225938303):0.1242596432,(t5:1.32737278,(t6:1.20995796,t7:1.203088213):0.1136509292):0.01932487411):0.52434192):0.3155255361,t8:2.173770815):0.488282734,(t9:2.464765849,((t10:1.576685336,((t11:0.675488772,t12:0.6718477655):0.6594091015,t13:1.318042693):0.2204709551):0.3599912796,(t14:1.769616537,t15:1.769499325):0.128519723):0.5137798598):0.1877664391):0.06331790973):0.1601166198):0.1446971837,(((t16:2.331029652,(t17:0.2856681502,t18:0.2577057312):2.026420352):0.1479223292,((((t19:0.4914726011,t20:0.4767698215):1.153204046,t21:1.622808491):0.1524783316,(((t22:0.6727250427,t23:0.6713170445):0.1668673589,t24:0.8365058476):0.6972144456,(t25:0.8831347898,t26:0.8669147199):0.634977502):0.2281952118):0.2748852755,(t27:1.838698097,((t28:1.170426418,t29:1.163912885):0.2248330225,t30:1.383616636):0.4299938823):0.141334919):0.3587245502):0.1044945378,(t31:1.8825131,(t32:0.704974913,t33:0.695253605):1.165172263):0.5242152227):0.3817068114):0.2398284742):0.1076389709):0.0900039947,((((t34:1.744984177,(t35:1.593418507,(t36:1.170666276,(t37:0.2789734072,t38:0.2741771473):0.873377305):0.4220681133):0.1515636864):0.2224843762,(t39:1.540472917,(t40:0.9245648532,t41:0.922686539):0.6129164642):0.3971915626):1.095971555,(((t42:1.424908443,(t43:1.340262076,((t44:0.4852564603,t45:0.4806579889):0.03204782267,t46:0.5096356246):0.8116222616):0.08335854722):0.7322421785,(((((t47:1.30495817,t48:1.295104023):0.1601041987,(((t49:1.172743319,(t50:1.042394246,t51:1.041647169):0.1302455153):0.2055583751,t52:1.373552581):0.07654982809,t53:1.431008371):0.0001982437051):0.3118220767,(t54:0.4047828818,t55:0.4011709607):1.302431715):0.006563301387,((t56:0.3552151986,t57:0.3550442629):1.228133269,(t58:1.470047609,(t59:0.5458642386,t60:0.5334845351):0.9152225101):0.1107127096):0.125816915):0.01087269193,(t61:1.299472667,(t62:0.280515203,t63:0.2707937487):1.017461522):0.3875204187):0.3415620909):0.02739560846,(t64:1.630030658,t65:1.621236596):0.4137191533):0.8434976386):0.001522121988,(((t66:1.525220323,((((t67:0.1371519144,t68:0.124720738):0.885979578,t69:1.000226442):0.0500474259,t70:1.038092607):0.016610507,t71:1.043297548):0.4350979609):0.5671652171,(t72:0.801810041,t73:0.7992505939):1.242411419):0.5526081644,((t74:1.036161224,t75:1.030283263):1.136418606,(((t76:0.2850703307,t77:0.2763919798):0.3519607973,t78:0.628209752):0.5864230202,t79:1.21336365):0.9430554713):0.4184614253):0.2349529145):0.1381235007):0.1802897967,(((t80:2.024997193,(t81:1.722099474,t82:1.714579577):0.2875841514):0.03729078674,((t83:1.675798704,t84:1.671988905):0.2588503067,((t85:0.281544701,t86:0.2654558205):1.36309629,t87:1.626674345):0.2808279933):0.1039882404):0.09823726556,(((t88:0.7296092324,t89:0.728134227):0.1347857569,(t90:0.6930454819,t91:0.6792269111):0.1661199396):0.7349065635,((t92:1.04135971,t93:1.035971985):0.1862364424,t94:1.21412048):0.351509341):0.5064568907):0.9671302309):0.09461488821):2.284374616,((((((((((t95:1.476656753,((t96:0.05540396609,t97:0.04758105615):0.3191642166,t98:0.3593326542):1.092314686):0.3135790165,(t99:0.9647706488,t100:0.9517836833):0.790430402):0.2282451783,((((t101:0.6282839424,t102:0.620150597):0.7206525995,(t103:1.259911769,((t104:0.7988001438,(t105:0.5400227582,t106:0.5321094653):0.2584998817):0.4458329562,t107:1.227707639):0.01310334778):0.07993250156):0.2887749541,(((t108:0.5438704499,t109:0.5368113455):0.1100075407,t110:0.638495914):0.6090622276,((t111:0.4168520788,t112:0.4032945419):0.08139154065,t113:0.4840557212):0.7441723286):0.3327950329):0.03232968843,t114:1.592867196):0.2957065468):0.01146847203,(t115:0.9069486854,((t116:0.4257519866,(t117:0.4008954527,t118:0.3928121902):0.01385323902):0.2330970088,t119:0.6310209388):0.2459179557):0.9893459721):0.234681452,(((t120:0.8715893974,t121:0.865208683):0.1098976236,(t122:0.5499163116,t123:0.5441662538):0.4202283068):0.7521590042,((t124:1.53936519,((t125:0.1421015377,t126:0.1414561551):1.195684155,((t127:0.5953122549,t128:0.5880591864):0.4082146454,t129:0.9937197213):0.3271289091):0.1978466924):0.03065713699,t130:1.539295866):0.1424016331):0.3646235506):0.002693090976,(t131:1.506993049,((t132:0.8221336757,t133:0.794767265):0.4443532562,(t134:0.4975657338,(t135:0.4379022775,t136:0.4374328316):0.05746744951):0.7386813871):0.2276752774):0.5385784728):0.02644391904,(t137:1.1582677,(t138:0.3606286062,t139:0.3460457856):0.7956668323):0.8607667099):0.1192985351,((t140:0.3523655627,t141:0.3399094873):1.361655554,(t142:0.1568701409,t143:0.1522485108):1.536275533):0.4012788815):0.4258774945,(((t144:1.436899006,((t145:1.360165913,(t146:0.504926303,t147:0.4950545391):0.8546901955):0.03038578041,(t148:1.03545791,t149:1.034309132):0.3432044404):0.03040806461):0.4888505746,t150:1.896444125):0.4746550874,((t151:0.1419431152,t152:0.1355016838):0.5952144292,t153:0.7260743625):1.622571918):0.1016516955):1.666156933,(((((t154:0.9060132827,t156:0.88060772):0.3988023739,(t157:0.6338330317,t158:0.6313270949):0.6426514526):0.4279453317,((t159:1.474954037,((t160:0.5355938236,t161:0.5234403732):0.3353355941,t162:0.8564964735):0.590737154):0.1347868282,((t163:0.7666500576,(t164:0.7390864403,((t165:0.1272497588,t166:0.1201132615):0.5070119858,t167:0.6258097276):0.1022267335):0.01668818092):0.7750189189,((t168:0.607832218,t169:0.5946556053):0.279716491,(t170:0.6424566806,(t171:0.575940445,(t172:0.2590836564,t173:0.2545879426):0.3119363165):0.06213300895):0.2296630575):0.6308132539):0.0403250232):0.08903643085):0.7886486611,(((t174:1.74794666,(((((t175:0.9520420355,t176:0.9459795317):0.1388541808,(t177:0.3843689731,t178:0.3785891213):0.6983042622):0.1452964379,t179:1.212703294):0.2047091862,(t180:0.4814228749,t181:0.4800655629):0.912588561):0.09344979747,(t182:1.47376784,(t183:1.28455272,(t184:1.092352393,(t185:0.337550307,t186:0.3311280792):0.7534644861):0.1900087798):0.1879382211):0.006267702843):0.2079437883):0.1547636196,(t187:0.7834707736,((t188:0.3325781461,(t189:0.06277103264,t190:0.05569761286):0.2667459061):0.07488706451,t191:0.3928642629):0.3753944806):1.040624694):0.2938219656,((((t192:0.6018696659,(t193:0.4900004798,(t194:0.0180196478,t195:0.01749206684):0.4710957658):0.1076199786):0.4056751607,t196:0.9853944054):0.4480428108,(t197:0.9398655424,(t198:0.6869740332,(t199:0.598102227,((t200:0.03082438451,t201:0.02528870199):0.3863735454,t202:0.4074756778):0.1651331024):0.06801893097):0.2509275494):0.4807636248):0.253617068,(t203:0.204911778,t204:0.1909105707):1.416607317):0.3803135764):0.2018699007):1.090280935,(((((((t205:0.810987103,(t206:0.3307013993,t207:0.3302084925):0.4768513935):0.144703168,(t208:0.5423883111,t209:0.53707774):0.4010573349):0.3440273788,((t210:0.6862987663,t211:0.676803853):0.5269434084,((t212:0.1763955108,t213:0.1737030829):0.4677277041,t214:0.6356828042):0.555720413):0.06482165378):0.1428426088,t215:1.398496883):0.8588889344,(t216:0.1906745501,t217:0.1818694843):2.066315235):0.3282494219,(((t218:0.3890983204,t219:0.3799086472):0.02983416533,(t220:0.3301105691,t221:0.3283210218):0.07149048378):0.3535034095,t222:0.7304876797):1.797275652):0.562302747,(((((t223:1.430363779,(t224:0.8611905708,(t225:0.5901707693,(t226:0.06246093128,t227:0.05852916345):0.5269145848):0.2649251137):0.5565022532):0.1825600069,t228:1.589419379):1.047824863,((t229:0.07221856262,t230:0.04757513303):1.342460605,(t231:0.0285652846,t232:0.0215669681):1.355080158):1.220258462):0.07087484349,((((t233:0.4188947139,t234:0.4052074571):1.488257408,((((t235:0.2868077015,t236:0.2796858626):0.2938546005,((((t237:0.02087864568,t238:0.02004550438):0.03258419602,t239:0.039851868):0.1530935759,(t240:0.08497567966,t241:0.08382874736):0.1009856158):0.3329228177,t242:0.4965219149):0.02904002746):0.2769906094,t243:0.7980479063):0.1000989012,(t244:0.8713519232,t245:0.8698842709):0.02339887825):0.9269543955):0.3943293418,((((t246:0.1970863186,(t247:0.0684004801,t248:0.06710575019):0.1268190631):0.257253759,t249:0.4493836233):0.4578455877,t250:0.9057933092):1.221515451,(((((t251:0.2033776528,t252:0.1913760471):0.2276565173,t253:0.4179723537):0.7377686367,t254:1.152033976):0.2234492911,(((t255:0.1358477102,t256:0.1347428587):1.131347179,t257:1.261491492):0.04337519495,(t258:0.4909607336,t259:0.4899663783):0.8126932032):0.06249187789):0.1974011782,(((t260:0.8211118424,(t261:0.7063649937,((t262:0.4289004275,(t263:0.07631735704,t264:0.05599529316):0.351728162):0.08907219682,t265:0.4886680325):0.1874422314):0.1051307717):0.05311191219,(t266:0.6087310443,t267:0.5891662438):0.222311749):0.6634208035,((((t268:0.3140704232,t269:0.310984261):0.3758315165,((t270:0.1877016172,t271:0.1831175041):0.2646639543,t272:0.4354481906):0.2343442408):0.05535449067,(t273:0.6218528943,t274:0.6036379015):0.09682187089):0.1443140282,(((t275:0.1271472422,t276:0.1252312974):0.6400697898,t277:0.765017611):0.07447983024,t278:0.8387319481):0.001503110679):0.5820191849):0.01958688607):0.5362059557):0.08017817871):0.2852851586,((((t279:0.03211276352,t280:0.01362680236):0.5264034031,t281:0.5329075772):0.1764104718,(t282:0.5891659123,(t283:0.3098993152,(t284:0.2679718384,t285:0.255835835):0.04086199466):0.2783650002):0.1182348832):0.6861128145,(((t286:0.2265288035,(t287:0.01055184882,t288:0.009066924443):0.2138375457):0.4698014696,(((t289:0.3028597784,t290:0.2880750113):0.3216016629,t291:0.600281036):0.06345426068,(t292:0.3994403891,t293:0.3872509622):0.2548804396):0.0008661637347):0.1230695545,(t294:0.05923970134,(t295:0.04332752058,t296:0.04324383825):0.01203864128):0.7034377773):0.5571807978):0.9209228818):0.0756215535):0.1791701579,(((t297:1.000924323,((((t298:0.04043429201,t299:0.02690798145):0.2651642794,t300:0.2888520487):0.1703195696,((t301:0.202758315,t302:0.2016718204):0.1070661883,t303:0.305425461):0.1490450988):0.04606946216,(t304:0.2629136405,t305:0.2624209823):0.2334005007):0.478592704):0.2881118358,(((t306:0.3377632185,t307:0.3208218654):0.08280422723,(t308:0.3648078396,(t309:0.1680312698,t310:0.1516015989):0.1950196408):0.0289730004):0.3981607782,(t311:0.1821615987,t312:0.180633989):0.575746061):0.4345665204):0.5248094314,((((t313:0.8113292824,t314:0.7947656876):0.02346333215,t315:0.8168579953):0.2754605235,(t316:0.6436964964,(t317:0.2970695211,t318:0.2970065898):0.3456115527):0.4414219804):0.5061823755,((t319:0.394207276,t320:0.3924908087):0.606887711,((t321:0.8128612723,t322:0.8069578193):0.1451793196,t323:0.9477140976):0.03952674946):0.5809475969):0.09374593907):0.6686893891):0.174920746):0.07983385485):0.50352139):0.8982263349):0.2270532372):0.5928326015,((((((t324:0.9460245161,((t325:0.1392326306,t326:0.1387710373):0.7633770482,(t327:0.4478893409,((t328:0.2742688608,t329:0.2703875069):0.1218641746,t331:0.3788886013):0.04706668539):0.4383781433):0.03857353612):1.091113166,(((t332:0.5904134665,t333:0.5879144618):0.7889393984,((t334:0.4496216153,t335:0.4197783748):0.2698628175,t336:0.66905817):0.6568786737):0.2041229308,(t337:0.432164132,t338:0.4307618351):1.097341894):0.4066900479):0.4955403933,(((t339:0.8245704166,t340:0.8138227411):0.2631789896,t341:1.074984475):0.6966240348,t342:1.764871814):0.6427126786):0.2169500382,((t343:0.4616225448,(t344:0.3286413362,(((t345:0.2332440506,t346:0.2323061202):0.01364256082,(t347:0.130301652,(t348:0.03786136621,t349:0.03767201937):0.07909323134):0.08687261062):0.06228052246,t350:0.26589852):0.01942710996):0.1221479647):0.08864041166,((t351:0.02309002146,t352:0.0190461246):0.2650807636,(t353:0.2708483224,t354:0.2695112497):0.0112017979):0.2042698114):2.052689438):0.4372589225,(((((t355:0.1659373093,(t356:0.01230239016,t357:0.0101260676):0.1514074205):0.3073751927,(t358:0.2322105254,t359:0.2277604281):0.2345648207):0.2925895583,(t360:0.6509566515,((t361:0.5303802873,(t362:0.05388637213,t363:0.03642020441):0.4668745633):0.08316762448,t364:0.5857607762):0.03378058411):0.0794747942):0.980245815,((((((t365:0.01261071677,t366:0.006592432965):0.1669601861,t367:0.1664972313):0.3008282443,(t368:0.2244096884,((t369:0.1752373849,(t370:0.1740092842,t371:0.1664813124):0.001032640146):0.004287010645,t372:0.1580146132):0.04004837605):0.2380238797):0.2224155978,t373:0.6581646197):0.4577461924,((t374:0.5636011277,t375:0.5629612723):0.02675084862,(t376:0.1367809831,t377:0.130851951):0.4493148531):0.5185370781):0.4792175552,((((((t378:0.198577904,t379:0.1983335104):0.1758632709,(t380:0.1991455419,t381:0.1912795942):0.1713281274):0.06642666488,t382:0.4215034112):0.0170945019,t383:0.4315441044):0.2474152303,(t384:0.2178608694,(t385:0.209625712,(t386:0.1698684373,t387:0.16256905):0.03363516233):0.003155379315):0.4418106571):0.5224975737,(((((t388:0.01328084129,t389:0.009249484254):0.08691409035,t390:0.0947556573):0.3364728129,((t391:0.2822740093,(t392:0.042443687,t393:0.02855405138):0.234504355):0.04517611927,((t394:0.164056963,t395:0.1458905069):0.1186464557,t396:0.2567062138):0.02434545762):0.09768801245):0.3884779033,(((t397:0.3061156491,(t398:0.2369644851,t399:0.2366458878):0.06694444278):0.0494430232,(t400:0.06825893074,t401:0.0678103296):0.2819018343):0.2123712722,(t402:0.1616325146,t403:0.1570004986):0.3885115668):0.1925693932):0.1898960551,((t404:0.1081240313,t405:0.1040714186):0.1774010987,t406:0.2712154462):0.6399649255):0.1439659066):0.3421569499):0.03126549202):0.8583556071,(t407:0.855172789,(((t408:0.2747702002,((t409:0.04165254826,t410:0.03550766614):0.1602233401,(t411:0.02820638905,t412:0.01352103486):0.1650437386):0.06985335197):0.2504802391,((t413:0.1200786236,t414:0.1167776641):0.1874354489,t415:0.2990579786):0.1908303713):0.07711213168,(t416:0.4954665034,t417:0.4937874289):0.06217329511):0.2284035109):1.428727779):0.369666496):0.4074212608,((((t418:0.7366130745,(t419:0.5765487562,t420:0.5648019058):0.1591325362):0.6493554619,((t421:0.6670378724,(t422:0.3923836039,(t423:0.2326822642,t424:0.2311501934):0.1594953661):0.2558281908):0.07240931379,t425:0.7145773118):0.6222256725):0.9424682419,(((((t426:0.2815981372,t428:0.2727748816):0.04836107969,((t429:0.03157307703,t430:0.03154092547):0.1869823597,t431:0.2111572714):0.09910450008):0.2688692544,(t432:0.2322505923,(t433:0.1870007879,(t434:0.1802995082,(t435:0.1655119107,(t436:0.0744504548,t437:0.07326874082):0.08954213801):0.01204101526):0.005406431511):0.04093531456):0.3462461812):0.1985967215,t438:0.7509780798):1.125785991,(t439:0.5325854674,(((t440:0.06918493287,t441:0.06253299825):0.007879573716,(t442:0.04344701897,t443:0.04118562241):0.02523933328):0.08821758548,t444:0.1517137208):0.3628314731):1.334333937):0.3536632068):0.03692902678,((t445:0.5445823262,(t446:0.4731036703,(((t447:0.1695375026,t448:0.1690541592):0.06616333949,t449:0.233984436):0.1302118847,t450:0.3618450345):0.08798479478):0.06967305258):0.5820146177,(t451:0.4854290854,(t452:0.375727287,t453:0.3727418143):0.1081985004):0.6160007597):1.106792985):0.6225779683):1.208792648);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T64.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
