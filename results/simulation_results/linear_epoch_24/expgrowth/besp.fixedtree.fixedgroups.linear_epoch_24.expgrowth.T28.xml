<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t478:0.2318480709,t479:0.2167676622):3.559554206,(((t480:0.7457300426,((t419:0.007291791142,(t1:1.927206497,t2:1.925592447):0.6974407742):0.8552469268,(((((t3:1.276079328,(t4:0.8293543202,t5:0.8286003595):0.4442839009):0.02800033978,t6:1.297191288):1.13389862,((t7:2.051752611,(t8:1.028560273,t9:1.027291189):1.021995878):0.3751112578,t10:2.423588522):0.003773850099):0.4499951145,((((t11:2.058553906,((t12:1.528677269,t13:1.52158614):0.4632225172,t14:1.983016026):0.06622397216):0.3098080485,(t15:0.8304023845,t16:0.8199685369):1.522248959):0.2218530429,(((t17:2.31639469,((t18:1.441278863,t19:1.432109064):0.1744850918,(t20:1.601506327,t21:1.597666946):0.004295098683):0.6777574474):0.1351403058,(t22:2.317778345,((t23:1.654763354,t24:1.653147098):0.0195543239,(t25:1.529697298,(t26:1.111762791,t27:1.099373335):0.415390381):0.1219830014):0.6341994838):0.08498567121):0.006119009599,(((t28:1.227484871,t29:1.220673537):0.5479387589,t30:1.768299445):0.1028101253,(t31:1.309755171,((t32:0.6918274662,t33:0.6884823635):0.1841927794,(t34:0.6473024349,t35:0.6322766097):0.1930800573):0.4187783552):0.560860503):0.4742898322):0.1021152584):0.007095399024,(t36:2.023596803,(t37:1.937553302,(t38:1.309059161,t39:1.307982844):0.6284530377):0.08124665816):0.3639458692):0.2744836899):0.08986116175,(((t40:0.7958125986,t41:0.7953802702):1.061570679,(t42:1.849315209,((t43:0.7794214009,t44:0.7658559519):0.7705604559,t45:1.532415987):0.2974005527):0.0004151747219):0.5371049787,(t46:2.339780817,t47:2.330001976):0.01649886075):0.3292017939):0.4992805483):0.2580600297):0.7254848526,((t48:1.811006303,((t49:0.5419863848,t50:0.5307029972):0.5205482223,t51:1.049764718):0.7478830446):0.8755180991,((t52:0.7078698796,t53:0.7035478103):1.842923806,(t54:2.122947399,t55:2.110848189):0.4203360575):0.1027462946):1.469195752):0.7886839808,(((((t56:1.531487388,t57:1.529829482):1.050454629,((t58:1.491531385,(t59:0.3683643577,t60:0.3628379354):1.115363502):0.7440732898,(((t61:0.7298829457,t62:0.7297572317):0.6131004907,t63:1.338205631):0.4463217255,t64:1.783247286):0.4318620274):0.3268761743):0.6390374315,((((t65:0.9585632956,((t66:0.01429291168,t67:0.01188704403):0.5986539746,t68:0.6099108154):0.343420332):0.8714145954,((t69:0.8092035996,t70:0.8083628828):0.9593674179,((t71:1.668792679,(t72:0.9991196794,t73:0.9859328162):0.6666865129):0.08791874709,(t74:0.3373059924,t75:0.3318403943):1.399667803):0.006729776632):0.05395256284):0.7202411223,(((t76:0.8140302045,t77:0.8134743384):1.281235608,t78:2.094615256):0.3282097987,(t79:0.941483749,((t80:0.4243401255,t81:0.4138616991):0.3149588045,t82:0.7259475968):0.1960447069):1.478631088):0.08248218592):0.1497850361,(((t83:1.331755667,t84:1.329019495):0.8247651384,(((t85:1.159944509,((t86:0.6937420489,t87:0.6877776188):0.07138899828,t88:0.7589742601):0.3927333738):0.10757272,t89:1.259130571):0.3820115665,t90:1.627884652):0.4903662598):0.04996060564,(t91:1.446645414,(t92:0.9434801171,t93:0.9432763758):0.5027249176):0.7197104048):0.4206071931):0.4790203014):0.4312393075,(((((t94:1.292948532,t95:1.287632835):0.2305081837,t96:1.517836514):0.5674142061,(t97:1.931932119,(t98:1.639312978,(t99:0.2288467304,t100:0.2282012827):1.401963807):0.2837982272):0.1434315584):0.5109204715,((((((t101:1.583719486,((t102:1.308521377,t103:1.302876111):0.2298686266,t104:1.53193327):0.02470021553):0.3054158799,((t105:1.319223224,((t106:1.092512233,(t107:0.8950212298,(t108:0.832533628,t109:0.8282927069):0.05987324656):0.1942413038):0.165930574,t110:1.245881504):0.05810399433):0.242928118,t111:1.545160896):0.2957305555):0.2801204442,(((((t112:0.446571375,t113:0.4442772995):0.748129715,(t114:0.8509495055,(t115:0.5775486316,t116:0.5692260333):0.2710034074):0.3316079965):0.4862770931,((((((t117:0.3221533838,t118:0.3209853145):0.6498015512,t119:0.9682643538):0.1121296309,((t120:0.3278418316,t121:0.3213070453):0.5009558372,(t122:0.6461309833,t123:0.6443592375):0.1644423659):0.2413072575):0.2677918436,t124:1.314444375):0.01299333935,(((t125:0.8133205868,(t126:0.3440542133,t127:0.3427282501):0.4621437115):0.2190740463,t128:1.023101845):0.2611247172,t129:1.283674563):0.02511258736):0.1419383123,t130:1.444244906):0.132856692):0.1418141215,(t131:1.500653774,(t132:1.474955152,(t133:1.360831172,t134:1.356615972):0.1128764424):0.02331037074):0.2106091831):0.2142870861,((((t135:0.7901904325,t136:0.7851713538):0.004944207131,t137:0.7662956059):0.1733525339,t138:0.9364742951):0.6887131318,(t139:0.171485669,t140:0.147933565):1.451947117):0.2568779054):0.0832800731):0.06240331877,(((t141:0.912137154,(t142:0.785865743,t143:0.7827499279):0.114623592):0.9800931206,((t144:1.366582032,(t145:1.08686385,(t146:0.5066648649,t147:0.5054168423):0.5712511049):0.2774861403):0.04778974289,((t148:1.089797814,t149:1.077243612):0.002457748895,(t150:1.048076831,(t151:0.5328071583,t152:0.5315482987):0.506962756):0.02179792131):0.3041796001):0.4607510553):0.0851366169,(((((t153:0.6649207856,t154:0.6621234489):0.110608617,(t155:0.2442204925,t156:0.2383227181):0.5247726078):0.7032973622,(((t157:0.7241266915,t158:0.7220390317):0.2403070961,t159:0.9498397664):0.3237930389,(t160:0.258798162,t161:0.2472486677):0.9772088551):0.1766417159):0.2967929871,((t162:0.1686904988,t163:0.1636865495):1.416184967,(t164:0.5726696749,t165:0.5708616506):0.9994761885):0.1074520092):0.1045954082,(((t166:0.9358323614,t167:0.905749104):0.2650078959,t168:1.153121663):0.03399999179,(t169:1.129354472,((t170:0.5884576779,t171:0.586688563):0.1608732603,t172:0.7449021189):0.3776744919):0.05523484444):0.5386482766):0.02983467829):0.01052828406):0.2042590217,((((((((t173:0.2789185914,t174:0.2606408188):0.08288521847,(t175:0.1806992713,t176:0.1742999299):0.1621266422):0.3629234429,(t177:0.4531247457,t178:0.4357075726):0.2337671282):0.3763165681,t179:1.045746243):0.1037775462,t180:1.136966109):0.4239756823,t181:1.554075289):0.02482339541,(t182:0.3904623524,t183:0.3872010083):1.188339073):0.2135139772,((t184:0.8321699265,t185:0.8296293983):0.3278565528,((t186:0.9342492689,t187:0.9197035649):0.1293428313,(((t188:0.1730581708,t189:0.1712741587):0.2351458678,t190:0.395484809):0.3243168883,(t191:0.5837506601,(t192:0.3505531265,t193:0.3453414121):0.2316487971):0.1298014122):0.284452198):0.09236186679):0.6201684493):0.09142124829):0.01117979611,(((t194:0.997240021,(t195:0.4087963393,(t196:0.3353315282,t197:0.3300489432):0.0673562158):0.5881444786):0.1160942896,((t198:1.002055322,((t199:0.1691636026,t200:0.1485565705):0.4843011422,t201:0.6160178703):0.344762657):0.06932885321,((t202:0.7575357785,(((t203:0.151125668,t204:0.1395489073):0.0180373698,t205:0.1567194223):0.5040405601,(t206:0.345575659,t207:0.3397320286):0.3024333313):0.07606254163):0.001287828218,((t208:0.4429158082,t209:0.4381219575):0.1348574574,(t210:0.321236434,t211:0.3201737777):0.2495929791):0.1334685206):0.2691803397):0.0218097142):0.04366837341,(t212:0.1053201749,t213:0.1012073117):0.9267990954):0.6351535889):0.120982207):0.09411908575,((((((t214:0.2740606712,t215:0.2683844737):0.008947603636,t216:0.270508696):0.1452756127,t217:0.402205218):0.6435289004,(((t218:0.05511972509,t219:0.04524942912):0.5441446872,t220:0.5803244569):0.1015369962,t221:0.6813789829):0.3433809983):0.6198020997,(((((((t222:0.6766920682,t223:0.6724302289):0.01896036284,t224:0.6737126844):0.1114544236,(t225:0.01162233586,t226:0.00868210832):0.759178583):0.0392467723,(t227:0.5212381735,(t228:0.02259240021,t229:0.007118087707):0.4767652618):0.2831109465):0.08737105635,t230:0.8522524832):0.4673503608,t231:1.306094377):0.215294063,((t232:0.3681920957,(t233:0.05405496361,t234:0.04869424377):0.3049560279):0.4012657887,(t235:0.5398456162,((t236:0.4422797559,t237:0.442206548):0.004377626133,t238:0.4465423624):0.09085914463):0.2108859654):0.748929247):0.02572096748):0.03266096396,((t239:1.518998489,(((t240:0.4105615604,t241:0.3977067164):0.588783626,(t242:0.09024401737,t243:0.08135455964):0.8894677405):0.0140373398,t244:0.9821986158):0.502360403):0.0208069071,((t245:0.8035256756,((((t246:0.3893193766,t247:0.3863417723):0.05705714839,t248:0.4412867861):0.1022004251,t249:0.5317379348):0.06158518819,((t250:0.3366868537,t251:0.3347767245):0.1157953391,t252:0.442216249):0.1301100923):0.1915096782):0.6521607197,((t253:0.03854966706,t254:0.02273724742):0.6582122496,(t255:0.05614519457,t256:0.05286955915):0.6186809163):0.7169701911):0.04551148173):0.01392370506):0.1538620878):0.791109897):0.4062769241,(((t257:0.9676050294,(t258:0.7800047117,(t259:0.6986838698,t260:0.6900493405):0.07822559744):0.1753841463):0.1277540791,t261:1.067922601):0.3359022531,(t262:0.3036146274,t263:0.2948078792):1.077716681):1.366173809):0.8303510125):1.510070774):1.002319883,((((((t264:1.531695427,(((t265:0.060895877,t266:0.05774490484):0.4537614629,t267:0.5103185635):0.5354354478,t268:1.045299966):0.4769907144):0.01417035112,((t269:1.258224991,t270:1.253359141):0.1417381137,((t271:0.9956278428,((t272:0.5079458121,((t273:0.2260527349,t274:0.223561989):0.2295782949,(t275:0.2057454009,t276:0.2004668183):0.2466653182):0.04328754008):0.0572121431,(t277:0.3881870901,t278:0.3786357578):0.1536355631):0.4280611185):0.3054394547,(t279:0.4542655401,t280:0.4522260448):0.8034674595):0.08844094778):0.1364256965):0.6029755087,(((t281:0.352495761,(t282:0.3145035487,(t283:0.2506122696,t284:0.2312862486):0.06056592715):0.03718607285):0.2176878876,(t285:0.1848177214,t286:0.182174567):0.3565767494):0.0959708422,t287:0.6283955025):1.406689929):1.531515229,((((((((t288:0.3344645107,(t289:0.2252499277,t290:0.2198004615):0.1025366544):0.8891738585,t291:1.204445679):0.9904615547,((t292:1.671837963,t293:1.664996176):0.2033052689,((t294:0.2123517166,t295:0.2045602479):1.141849041,(t296:0.8765789034,((t297:0.3091478694,t298:0.3089965498):0.3643510505,((t299:0.1121454671,t300:0.1044654541):0.4032111381,((t301:0.1611584969,t302:0.1608582656):0.0482808191,t303:0.2041299759):0.2949652561):0.1509734387):0.1828804395):0.4494958687):0.5135275452):0.3181980453):0.4052459548,((((((t304:0.1161129462,t305:0.1068127224):0.5356335963,t306:0.6306474862):0.2484774721,(t307:0.3182877882,(t308:0.05114187877,t309:0.03091727352):0.2509339513):0.5525628707):0.1811419487,(t310:0.4398729877,t311:0.4384293191):0.5728483127):1.048373137,((t312:0.2808413712,t313:0.2782385306):0.06759960718,t314:0.3427109659):1.702225163):0.05830606553,(((t315:0.870195067,((t316:0.03957183133,t317:0.03713820267):0.4146621183,t318:0.4500678654):0.4112568586):0.05269696433,t319:0.8991615686):0.09303926158,(((t320:0.2018965905,t321:0.201270417):0.1858344038,((((t322:0.1542361607,(t323:0.05820431568,t324:0.05720085321):0.08162588488):0.05091624792,t325:0.1889791327):0.03903189203,t326:0.2276661624):0.0703534246,t327:0.2839793624):0.07067810241):0.4320532674,(t328:0.5410390503,(t329:0.3967751292,(t330:0.1614466573,t331:0.1607266566):0.234389413):0.135707679):0.239334631):0.1681078978):1.084127512):0.3106387881):0.3617836951,(((((t332:0.4578219867,((t333:0.3751791873,(t334:0.06196391734,(t335:0.01877796044,t336:0.003101406642):0.04265196742):0.305407305):0.06288618905,t337:0.4008094587):0.017692666):0.3003595809,t338:0.7179316393):0.1611413373,((t339:0.2346740214,t340:0.2326299638):0.175994095,(t341:0.1814316363,t342:0.1788764751):0.2259358395):0.4589428457):0.4510586925,((((t343:0.2585494433,(t344:0.2440973812,t345:0.24291686):0.007736291915):0.1611375115,t346:0.4116662573):0.2788386684,t347:0.690268455):0.405551222,((t348:0.9342554241,(t349:0.09223877731,t350:0.06660663135):0.8418484723):0.0362976952,(t351:0.7062951059,((t352:0.4603011867,(t353:0.2819940275,t354:0.276019032):0.1523112797):0.01530927659,t355:0.4352337304):0.227206348):0.2384425595):0.1143718738):0.2085414143):0.08721888229,t356:1.298077917):1.225482683):0.3320050348,((t357:0.06586072809,t358:0.062722845):2.550301905,(((((t359:0.02728127535,t360:0.02423230682):0.2840745896,(t361:0.1465797632,t362:0.1343971605):0.1615511092):0.8330334049,((((t363:0.2333435677,t364:0.2285746056):0.5691958302,(t365:0.05726627865,t366:0.05182404061):0.7401166193):0.240379502,(((t367:0.2688511583,t368:0.2605303092):0.06251824133,(t369:0.2235587707,t370:0.214244375):0.0867944334):0.6163546315,((t371:0.4865368906,t372:0.4688587988):0.1158297922,((t373:0.4416671611,t374:0.4383497856):0.003907531931,t375:0.4376037392):0.1379470054):0.3127300503):0.07991935577):0.07806051248,(t376:0.6561365059,((t377:0.09628664442,(t378:0.04513760486,t379:0.04401610266):0.04752485047):0.374851173,t380:0.462055664):0.1821631673):0.379575707):0.005187471015):0.3511309854,((t381:0.6833923453,(t382:0.4740830853,t383:0.4598539136):0.2030628723):0.09871627967,(t384:0.5907074712,((t385:0.1467038806,t386:0.1439420584):0.1623829504,((t387:0.122140875,t388:0.1212713605):0.05177397435,t389:0.1710429192):0.1280545001):0.2803883833):0.161856092):0.5921116635):0.2806485405,((t390:0.9252682871,(t391:0.7544059712,(t392:0.1365247838,(t393:0.02903407057,t394:0.02764625698):0.1026243191):0.604034666):0.1699526023):0.5937530677,(t395:0.06020967534,t396:0.06019569942):1.437681666):0.09153397893):0.8360360301):0.2303204531):0.04601306995,((((t397:0.4785608215,(t398:0.2208743669,t399:0.2145475888):0.2439654084):0.3039554379,(t400:0.5590726363,(t401:0.3507063681,t402:0.3435709695):0.2057856338):0.1952338734):1.001274931,(t403:0.2066955596,t404:0.189505009):1.537625556):0.1365824317,((t405:1.719754054,((((t406:0.550904824,t407:0.5474405434):0.05438522711,(((t408:0.1145858497,((t409:0.007631994896,t410:0.00435972644):0.07398751996,t411:0.07800159185):0.02752362406):0.1103710176,t412:0.2081625653):0.01938996759,((t413:0.05410073206,t414:0.05309565002):0.05838780244,t415:0.1019364346):0.1112881174):0.3305363287):0.123994384,(t416:0.5756611948,(t417:0.1197481211,t418:0.1169148349):0.4512005788):0.08944139461):0.004294722274,t420:0.6367243962):0.9779263863):0.06988210848,((t421:0.1606813105,t422:0.1556944913):1.357286181,(((t423:0.3788745669,t424:0.3653370207):0.446484547,(t425:0.1783987226,t426:0.1780897489):0.6149822367):0.2850861911,t427:1.072842524):0.3936365117):0.1619610327):0.07118207591):0.7810683402):0.1094047386,(((t428:0.1535858849,t429:0.1303723322):1.170823782,((((t430:0.07865475503,t431:0.07312667865):0.03677319288,t432:0.1098575177):0.2359352282,t433:0.3452975412):0.6723778675,(t434:0.6656203407,(t435:0.2586378063,t436:0.2558791843):0.4029444162):0.3499118568):0.2752061231):1.008051108,((t437:0.2001971466,t438:0.2000117167):1.931046222,((((t439:0.1212348221,t440:0.1106184913):0.02022323733,t441:0.1279800508):1.180178155,(((t442:0.6007398255,(t443:0.3358327398,(t444:0.1068578915,t445:0.09975236059):0.2262617018):0.2432858979):0.2966363921,t446:0.8630890997):0.06869904951,((t447:0.7905035743,((t448:0.1127588014,t449:0.1082999148):0.09515466125,t450:0.2031999853):0.5729871341):0.002279451446,((t451:0.1219875744,t452:0.1217717281):0.4682213109,(t453:0.2955847901,t454:0.2899448468):0.2927885548):0.1871550855):0.1338287654):0.3390157332):0.5935057572,((t455:0.2100963005,(t456:0.1396807944,t457:0.1351279033):0.06529130839):1.320888726,((((t458:0.03490061399,t459:0.03291473475):0.08704228888,t460:0.110082645):0.400907308,(t461:0.2352878595,(t462:0.09253125909,t463:0.09062783301):0.1368082682):0.2699146275):0.2268817518,t464:0.7231446943):0.7697578723):0.3000187864):0.2141310731):0.1556506367):0.2559568953):0.09565660098):0.4734502348,(t465:0.7627411147,(((t466:0.07534199024,t467:0.05042495138):0.571230205,(t468:0.2101820921,(t469:0.04950962865,t470:0.04720974295):0.1581785689):0.4046062551):0.005025090313,(t471:0.323519668,(t472:0.1461793386,(t473:0.05676361474,t474:0.04963198456):0.05919524907):0.1703765336):0.288479087):0.1017433673):2.224909398):0.5579595754,(t475:0.7847530919,(t476:0.7290163986,t477:0.7224085829):0.0529195143):2.666414764):1.361564489);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T28.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
