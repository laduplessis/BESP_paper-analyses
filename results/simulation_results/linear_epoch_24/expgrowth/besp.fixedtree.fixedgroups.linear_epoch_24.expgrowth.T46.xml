<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((t72:1.518388896,(t73:0.5791400167,t74:0.5500207705):0.9354595633):0.2393493833,t75:1.724594846):0.8830678508,((t76:0.6620385275,t77:0.6613029469):1.826407686,((t78:0.8242712241,t79:0.8220734129):0.03060273152,t80:0.8520524363):1.623479555):0.116369412):0.3172787194,((((((t81:0.1202047042,t82:0.1110501758):0.7144033527,t83:0.8247711406):0.1283233995,t84:0.9517966934):0.9568920174,(t85:0.7065310158,t86:0.7009303883):1.200771334):0.6328216311,((t87:1.193438931,t88:1.185563915):0.3770839352,t89:1.559989833):0.959550013):0.1983809836,(((t90:0.7375935073,t91:0.7334466568):0.9012886343,(t92:1.330135278,(t93:1.093726226,(t94:0.9246506398,t95:0.9171020377):0.1566741387):0.2344596286):0.3036700065):0.9577420897,(((((t96:0.002641209729,t97:0.00189660761):1.246205142,t98:1.243527692):0.5141824706,(((t99:1.24385372,t100:1.235281584):0.3540180256,((t101:1.229984724,t102:1.225596272):0.2746412165,(t103:0.3354810352,t104:0.3249598941):1.158996443):0.08233620711):0.1036397138,(t105:0.7074975017,t106:0.7068129107):0.961858338):0.04931483284):0.07404932943,t107:1.788928407):0.351964459,((t108:0.2531513471,t109:0.2524259544):0.6200600844,t110:0.8699002868):1.26743165):0.3727909556):0.1204768553):0.1516719315):0.4322179267,((((t111:1.381729903,t112:1.377796924):0.2633809275,((((t113:0.7979893816,t114:0.7977632813):0.2767194138,t115:1.065260114):0.06715314442,(t116:1.081202018,t117:1.075404987):0.04660199335):0.06671021916,t118:1.184871045):0.4317909172):0.2517193714,((t119:0.194749418,t120:0.1809885099):1.255559264,t121:1.43394829):0.4098258008):0.6957620621,((t122:1.222396857,t123:1.219407196):0.5140249221,t124:1.732780213):0.8021016834):0.6176414736):0.2956519382,(((t125:1.855045088,(t126:1.490529367,((t127:0.9785612938,t128:0.9729996872):0.05830427735,(t129:0.9930761911,t130:0.9873116196):0.01114384231):0.4446304085):0.3634314212):0.2080946374,(((t131:0.8478876322,t132:0.8469132516):0.8363546178,(t133:1.155979769,(t134:0.712359931,t135:0.7092617199):0.4409714239):0.5261097917):0.1692120516,t136:1.843568516):0.1584261346):0.2391735275,((t137:1.292356231,t138:1.244634286):0.2468553472,((t139:0.9648597737,t140:0.9508490991):0.2249644912,t141:1.174316898):0.2903043781):0.6971137335):1.142200205):1.26501661,((((((t142:1.695461114,(((t143:0.7277663117,t144:0.7227938416):0.9400152533,(((t145:1.366266348,(((t146:0.3735835515,t147:0.371279802):0.6841595375,(t148:0.6351819581,t149:0.632726117):0.3980053968):0.1779611929,t150:1.174518241):0.1237010811):0.1510555795,t151:1.442642705):0.03499730274,((t152:0.9705229755,t153:0.969415418):0.231845217,t154:1.182854802):0.2740468187):0.1100128788):0.002065391433,(t155:0.6116578275,(t156:0.4345814557,(t157:0.1101969895,t158:0.1079427142):0.3220669826):0.175597836):0.9538734279):0.0241755887):0.1612982304,(t159:1.130614542,t160:1.129787648):0.6126717591):0.06925261388,(((((t161:0.3407441288,t162:0.3375062671):0.8469246585,t163:1.170641708):0.02185220859,((t164:0.4324973951,(t165:0.09980139542,t166:0.09793703745):0.3315521135):0.2045517096,(t167:0.08265110708,t168:0.07810085028):0.5465141865):0.5531629114):0.3583445983,t169:1.534055965):0.1786227241,t170:1.710143521):0.06374936795):0.1060822205,(t171:1.187645374,t172:1.176275299):0.692008041):0.08574290083,t173:1.94914401):1.2337223,t174:3.181068554):1.210789469):0.509672655,((((((t175:0.879469808,t176:0.8666688872):0.4037496758,(t177:1.041137648,(t178:0.8966123646,(t179:0.6980151342,(t180:0.4153719175,t181:0.3985205846):0.2807108473):0.190883816):0.1401500271):0.2098149692):0.8843638838,(t182:2.071569409,((t183:1.218026914,(t184:0.5524483832,((t185:0.2623069452,(t186:0.1945771006,t187:0.1918962821):0.05543946802):0.1645823862,t188:0.4090239079):0.1198352615):0.6627115179):0.1584272697,(((t189:0.3933989605,t190:0.3875466135):0.03828370202,t191:0.4115351254):0.02765117606,t192:0.4287165308):0.886981014):0.6938255231):0.02788875998):1.181851542,(((t193:1.913197644,((t194:1.537020069,((t195:0.9905144376,(t196:0.5169412327,((t197:0.460893589,t198:0.4579177433):0.03351900663,(t199:0.2473231324,t200:0.224989584):0.237676787):0.01974498819):0.4699834411):0.3080685298,(t201:0.2040333986,(t202:0.0924552869,t203:0.08847499329):0.1109333718):1.02802498):0.2363200499):0.2429957297,(((t204:0.1840569554,t205:0.1650963307):0.3063271356,(t206:0.3930127581,t207:0.3841190135):0.07759301708):0.4329018558,t208:0.8901716823):0.7822798466):0.1192749323):0.5852824674,((t209:0.4966502522,t210:0.4958108593):1.074872087,((t211:0.175447849,(t212:0.1127608096,t213:0.1125340534):0.05249842749):0.5407250963,t214:0.6932440058):0.8492795027):0.8052133698):0.01745947311,((((((t215:0.4077265551,t216:0.4058676272):0.8155969203,(t217:0.04399608622,t218:0.03944645579):1.176187965):0.1771007121,((t219:0.1160498235,t220:0.1144068322):0.4830711753,(t221:0.1709566314,t222:0.1663890921):0.42469204):0.7790938032):0.343551487,((t223:1.083150672,(t224:0.8156167798,t225:0.8062044878):0.2670699113):0.2144983921,((t226:0.4581841146,t227:0.42304716):0.5728708678,((t228:0.6027209896,t229:0.6013181108):0.1424556933,t230:0.7428707514):0.2501688128):0.2509756261):0.4141927979):0.02749512929,(((t231:0.1886513366,t232:0.1857523229):1.284298287,((t233:1.181603693,(t234:0.3047113314,t235:0.3006737016):0.8764454441):0.2714960369,(t236:0.5912331363,t237:0.5631738211):0.8571491601):0.002194301254):0.02836158075,(t238:1.041752207,t239:1.041573096):0.4071359526):0.1820811562):0.4647275453,((((t240:0.4562514544,t241:0.4538089563):1.19868207,((((t242:0.2709077974,t243:0.2663631663):0.3908235504,(t244:0.477137199,t245:0.473918277):0.1798666587):0.3220027493,((t246:0.07374640096,t247:0.07165053919):0.7386331625,t248:0.8045106279):0.1616712446):0.544557153,((t249:0.3946848477,(t250:0.3599900063,t251:0.3474856469):0.03336879515):0.2315015133,t252:0.6033872574):0.8821929713):0.1216386718):0.04105178185,t253:1.644464929):0.07966403935,(t254:1.469479824,(((t255:0.80309004,(((t256:0.3175473002,t257:0.299267935):0.08654030987,t258:0.3812352684):0.04748654756,((t259:0.03623960335,t260:0.03453441179):0.148970316,(t261:0.05732857724,(t262:0.03446582337,t263:0.0300714225):0.01587253962):0.1184328887):0.2414290083):0.3495667573):0.3661922454,(t264:0.855792977,t265:0.8527592687):0.2510344778):0.1583226861,((t266:0.3773212016,t267:0.371732321):0.1641945508,t268:0.5280171196):0.7028789343):0.1362398394):0.2542334446):0.3125069658):0.1286791008):0.7018521434):0.5959926395,((((t269:1.291198186,(((t270:0.2718732381,(t272:0.08463905338,t273:0.08304734958):0.1823566106):0.7710074633,t274:1.028931414):0.1127434366,((t275:0.2993080063,t276:0.292844138):0.6822025205,(((t277:0.03073694311,t278:0.02986309077):0.7814225544,(t279:0.4866716948,((t280:0.3640385175,(t281:0.240864959,t282:0.2393852251):0.1217673393):0.08412478725,t283:0.4274660859):0.03516143465):0.3234908185):0.1245171305,(t284:0.2248043136,t285:0.2091167848):0.6829651003):0.03235692763):0.1595425145):0.1347764966):0.6200269429,(t286:0.2018051707,t287:0.1955127753):1.626534608):0.4860656383,((((t288:0.1515937215,t289:0.1437920273):0.2474226094,t290:0.3803517201):0.04008511694,t291:0.4148321252):1.288969246,(((t292:0.1202525749,t293:0.1189499294):0.2439594102,((t295:0.2309969177,t296:0.2234305134):0.03960545325,((t297:0.1535388453,t298:0.1392542257):0.07398988788,((t299:0.05143752148,t300:0.04918300268):0.09984434445,t301:0.1466722805):0.05888513545):0.03074204245):0.06762255709):1.171216889,(((t302:0.3232822523,t303:0.312256246):0.04962462168,t304:0.352498135):0.5572621809,t305:0.9025252529):0.5349095358):0.1609879298):0.5703285588):0.5800302326,((t306:1.209925241,t307:1.207589607):0.7502609724,((t308:1.148447149,t309:1.139476411):0.177842327,((((t310:0.3786219111,(t311:0.2646120885,t312:0.2567955835):0.1136433344):0.07091695008,t313:0.4380705604):0.1490730879,(t314:0.1047892206,t315:0.1032247952):0.4698649678):0.2772848555,((t316:0.07477577897,t317:0.06769472391):0.07604403453,t318:0.1423184132):0.6988400186):0.4379627372):0.6191063808):0.7846374969):0.3771180112):0.5733193478,(((t319:1.552568445,((((t320:0.2547944224,t321:0.2547888298):0.2832024344,t322:0.5313966299):0.7339932387,((((t323:0.6595873519,(((t324:0.3255778581,t325:0.3212728336):0.1229495685,(t326:0.2632328281,t327:0.2567778192):0.1777206148):0.2092493052,(t328:0.5157805092,(t329:0.04483344127,t330:0.04392108534):0.4683305769):0.1138597051):0.0002580209013):0.02556529732,((t331:0.09230141256,t332:0.09054805547):0.2601994308,t333:0.3430451799):0.2952518866):0.140752307,(t334:0.5948632151,t335:0.5927461944):0.1714369204):0.1736638552,t336:0.9347200854):0.263217763):0.1694271391,((t337:0.8179216946,((t338:0.385125805,(t340:0.2443590969,t341:0.2396950663):0.1089766083):0.1622348254,(t342:0.06165483029,t343:0.06075280497):0.4490472683):0.2639710448):0.1476343453,(((t344:0.3649126365,t345:0.3529947165):0.09085408734,t347:0.432712672):0.04307643104,t348:0.4539454482):0.4142798217):0.3973597443):0.1090500631):0.6182217548,(((((t349:0.1734844393,t350:0.149487805):0.6467436791,((t351:0.1055273242,t352:0.09471433698):0.6488758495,((t353:0.02603776535,t354:0.01544070151):0.5971064942,(((t355:0.0241575188,t356:0.02376040009):0.2764978122,((t357:0.1050601471,t358:0.1017126734):0.1138779194,t359:0.2155411753):0.07684705497):0.1421335986,(t360:0.3947027854,t361:0.3913369059):0.03836453879):0.1593301871):0.1160223709):0.03811454186):0.311797203,((t362:0.4599021323,t363:0.4461318228):0.1041626913,t364:0.5455160865):0.4828416647):0.3994846275,((t365:0.02662362173,t366:0.01776102034):0.1587896141,t367:0.1637691355):1.232644607):0.2696881103,((t368:0.5408816967,((t369:0.2862274816,(t370:0.1514367306,t371:0.1351857959):0.1298937301):0.2167380227,(((t372:0.1659928411,t373:0.1659251006):0.2412980292,(t374:0.1616731113,(t375:0.09190635201,t376:0.06724154727):0.06666252027):0.2291261705):0.02181808098,(t377:0.1256420416,t378:0.1189506969):0.2580697497):0.04424737928):0.03660253706):0.05037973176,t379:0.5063480176):1.069911639):0.1894330067):0.5628609775,((t380:0.8922868594,((t381:0.09777224609,t382:0.09314680944):0.4227325837,((t383:0.3741893799,t384:0.3667984499):0.06537594099,((t385:0.3787885148,t386:0.36805893):0.03251916925,(t387:0.1142608054,t388:0.1077643637):0.2789931112):0.01927309801):0.0707267019):0.3680360201):0.4635852315,(t389:0.4360740742,t390:0.4316101241):0.8628732534):0.9708238082):0.8996174679):0.368254772):0.0320613387,((((((t391:1.049745492,t392:1.049278114):0.3247186893,(t393:0.2933462424,t394:0.291085147):1.07489573):0.1973106549,(((t395:0.2548060065,t396:0.2523225559):0.1989289279,(t397:0.1439067075,t398:0.1413833359):0.3057471132):0.4099359234,t399:0.8542102729):0.670513341):0.157023238,((t400:0.4626766019,(t401:0.06248109847,t402:0.05395195582):0.3967681224):0.5609375232,(t403:0.8079137855,((t404:0.256308079,t405:0.2343340449):0.08399455387,t406:0.317419715):0.4544505028):0.1956367297):0.6528192428):0.5242139815,(((t407:0.1880977939,t408:0.1847506179):1.472865156,(((((t409:0.01189690259,t410:0.007762967735):0.1212863187,((t411:0.09441617368,t412:0.09167057591):0.02100099488,(t413:0.01214114436,t414:0.007702707533):0.08868365557):0.004738558569):0.5624676167,t415:0.663575645):0.7319085036,((((t416:0.1462326962,t417:0.145258443):0.1931425188,(t418:0.2725158725,(((t419:0.152891973,t420:0.1413176376):0.002245946432,t421:0.140504567):0.02518233216,t422:0.1520692014):0.09207020561):0.04625003547):0.5019826412,((t423:0.4017975668,(t424:0.3799589758,((t425:0.1478575852,(t426:0.1334508337,t427:0.1276682236):0.01243241431):0.1292991695,t428:0.2634655714):0.09799740798):0.01765248636):0.02402248742,((t429:0.2783598111,(t430:0.238810552,t431:0.2338934524):0.01848511017):0.03758109722,t432:0.2799720059):0.075832724):0.3664479591):0.1952441943,(((t433:0.4327854501,t434:0.4315644179):0.05076291099,(((t435:0.2826336141,t436:0.2814721203):0.0182489094,(t437:0.2252601788,t438:0.2219690993):0.05941026678):0.01578212192,((t439:0.11174401,t440:0.1102697051):0.0699858353,((t441:0.0621563617,t442:0.05396515864):0.05253670154,(t443:0.09149135888,(t444:0.01712634321,t445:0.01298339496):0.07127844848):0.00785625559):0.05453322791):0.1098405305):0.1628092143):0.1703670743,t446:0.5882213348):0.2445945824):0.3425632783):0.1497859194,(t447:0.7860520807,(t448:0.7289435137,(t449:0.6158478178,t450:0.6080022279):0.1077931622):0.05597635077):0.532343788):0.06329192797):0.1584800736,((t451:0.2922442511,(t452:0.09553413221,t453:0.08679582656):0.1948039963):1.040445269,((t454:0.5320835995,t455:0.5304212679):0.07576340746,(t456:0.4967520485,((t457:0.1752195296,t458:0.171563591):0.02422948422,t459:0.1916501437):0.295950966):0.107993954):0.7103352777):0.1911850264):0.3245624537):0.7913504784,((((((t460:0.2000561632,(t461:0.1633323582,(t462:0.08739270084,t463:0.08572689848):0.07112594179):0.03197772106):0.1128783111,t464:0.3003307621):0.4778951815,((t465:0.2270086529,t466:0.2119350318):0.5223394017,t467:0.7328526854):0.02723717143):0.07945204289,(t468:0.2075313626,t469:0.2065451551):0.6228154211):0.4751952968,(((t470:0.09009133569,(t471:0.03375320163,t472:0.03255578085):0.02965599282):0.1652424118,t473:0.2221543998):0.955838618,(t474:0.1527434537,t475:0.1442972807):1.022141245):0.08853186947):0.7705815416,((((t476:0.1893785356,t477:0.1785045336):0.1365677774,(t478:0.1247499414,(t479:0.08365219171,t480:0.0780099119):0.03093768718):0.1696401445):0.0792501368,t481:0.3555164913):0.8965146485,((t346:0.006197457433,(t339:0.01924081553,(t294:0.0044552359,(t271:0.001142893086,(t1:1.446299794,t2:1.43641312):0.1880572348):0.1519935288):0.2560596789):0.03592666926):1.8629652,(((((t3:1.624240446,t4:1.616567476):0.8180524471,t5:2.433174081):0.1998917816,((t6:1.353632247,(t7:1.306347084,t8:1.303057836):0.02353643338):1.229440109,((t9:1.025487144,t10:1.015044049):1.331342504,((t11:1.997354316,(t12:1.551919794,t13:1.55128846):0.4407089205):0.2231981919,(t14:1.544626989,(t15:1.401461459,(t16:1.270369247,t17:1.265504232):0.1248135625):0.1333498138):0.6593816047):0.1243132862):0.1973756791):0.04955736067):0.2942615275,((t18:1.922516835,(((t19:1.448583582,t20:1.446722985):0.09666622612,t21:1.543215786):0.08211177559,(t22:1.004098463,(t23:0.4506889625,t24:0.4451270721):0.5465063036):0.6143789674):0.2927814439):0.2640312281,(t25:1.711540904,t26:1.700896272):0.4462031044):0.6574658522):0.9784728572,(((((t27:1.706059662,(t28:0.6439894624,t29:0.6385670694):1.060965391):0.2416084371,(((t30:0.8012982499,(t31:0.5966309206,t32:0.5945179072):0.1975176085):0.7520933058,t33:1.530732708):0.1929405574,(((t34:0.9718619656,(t35:0.4167718226,t36:0.39928589):0.5543499752):0.2184076867,t37:1.159246189):0.1794891422,((t38:0.934732709,(t39:0.7161182493,t40:0.7094951449):0.2176614312):0.2599098832,t41:1.173927219):0.1280148369):0.3528551979):0.1917188199):0.08805567481,(t42:1.592922601,((t43:1.35912948,(t44:0.9847891499,t45:0.980373193):0.3724264038):0.1165434982,t46:1.466700209):0.1017883106):0.3209305541):0.6670950677,(t47:1.855372442,t48:1.854628943):0.693897474):0.1323420394,((((t49:0.9600272206,t50:0.9596209628):1.029915492,t51:1.988548186):0.3116723569,((t52:1.100163973,t53:1.080393141):0.302889471,((t54:1.13617272,t55:1.130905125):0.1327887543,t56:1.258712901):0.1067228451):0.8945063575):0.3033274869,((t57:1.35951381,(t58:0.4858756295,t59:0.4816270424):0.8573193207):1.105630903,((t60:0.1487677686,t61:0.1438697823):1.835599304,(((t62:0.3574653814,t63:0.3572537372):0.3561741589,t64:0.7105153035):0.7892239329,((((t65:0.3137019885,t66:0.311190285):0.7353771269,t67:1.043904497):0.1313147317,t68:1.168367746):0.1779420922,(t69:0.9925915375,(t70:0.4581245302,t71:0.4354499533):0.5343648556):0.3516091537):0.132803739):0.4694896578):0.4587793855):0.09639190893):0.0713884371):0.9271862873):0.009514207363):0.297553786):0.7125719727):0.4899899846):0.5169044939);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T46.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
