<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t171:1.674574788,((t172:0.8261620752,t173:0.8239984532):0.4366291622,(t174:1.021399971,(t175:0.1120076376,t176:0.1082898147):0.9061826329):0.2390504336):0.4101035133):0.484296689,((((t177:0.1888659011,(t178:0.02339830688,t179:0.01950703589):0.1622690921):0.3269487441,t180:0.5068698517):1.340286805,((((t181:0.4175207581,t182:0.4148016797):0.7560627666,t183:1.161434828):0.3713585056,((t184:0.08010408483,t185:0.07994675452):1.164341572,(t186:0.7802138815,(t187:0.6605352552,t188:0.6525648225):0.11526919):0.4605567757):0.2869242733):0.3000209841,(t189:0.6549076568,(t190:0.5149787164,t191:0.5036306543):0.1335050746):1.159281098):0.001469789759):0.06215852716,((((t192:0.4640358055,(t193:0.3582419303,t194:0.3581889642):0.101935526):0.3566550335,t195:0.8164810972):0.4648162972,t196:1.278544413):0.05687435833,t197:1.315578773):0.5113353687):0.2254805869):0.2919980056,t198:2.340921741):0.1380703549,(t199:2.196330704,((((((t200:0.6162869323,t201:0.6093511848):0.2775206913,t202:0.8860422926):0.3715879419,(t203:0.925904931,((t204:0.1548687834,t205:0.1530882058):0.7211546501,(t206:0.2065134199,t207:0.2047498438):0.6584344759):0.01681291382):0.330842264):0.3937191072,(((t208:0.1791491583,t209:0.1699020475):0.3870154166,t210:0.5528026828):0.2371546678,t211:0.7786259244):0.7979717555):0.3218749466,(t212:0.2201428493,t213:0.2173287025):1.673879216):0.005402656729,(((t214:0.3977480513,t215:0.3925709152):0.4371989064,t216:0.8271509171):0.09489210707,(t217:0.827034457,(t218:0.1252878996,t219:0.1144795251):0.6920940784):0.09432578288):0.9666259601):0.2096030408):0.2826357853):0.4684247664,(((((t220:0.6233585972,(t221:0.5777822385,(t222:0.1562695251,t223:0.1383941373):0.4183161101):0.0439427892):0.9074446631,t224:1.500856702):0.205900579,((t225:0.5687381116,(t226:0.3493970398,(t227:0.3133026195,t228:0.3049962944):0.02386438274):0.2148666355):1.064090332,t229:1.605294015):0.07254969294):0.771251913,((t230:0.9862405201,(((t231:0.3705955504,(t232:0.2545797422,t233:0.2457388685):0.1140004469):0.361555599,t234:0.7185513322):0.2423733303,t235:0.955298183):0.004854952281):0.2239185246,(t236:1.022242226,((t237:0.1116549027,t238:0.1084042988):0.3515748568,t239:0.448257335):0.558114221):0.1577063678):1.23742496):0.26595699,((((t240:0.9700095082,t241:0.965864267):0.5051633946,(t242:1.102776485,(t243:0.2887195209,t244:0.2811197004):0.8114623679):0.3682328329):0.8141017112,((((t245:0.1986263437,t246:0.1983758755):0.2526392807,t247:0.4382244703):0.1969794977,t248:0.6278772856):0.2332624682,t249:0.8576998426):1.361894821):0.1871029221,((t250:0.663124262,(t251:0.5397152527,(t252:0.2556745806,t253:0.2522220458):0.2777104443):0.1219954499):0.8881165865,t254:1.528235764):0.8512670486):0.1904210597):0.03857567845):1.945755223,((((t255:1.077275487,(((t256:0.3664177965,t257:0.3641511779):0.1257029189,t258:0.4861485027):0.3212538508,t259:0.8007989264):0.2612602721):1.563624297,(((((t260:1.089112792,t261:1.086368107):0.1477573262,(t262:0.3610750193,(t263:0.211319488,t264:0.2067266624):0.1429260589):0.8624725258):0.6046253779,((t265:1.389891387,((((t266:0.8401749937,t267:0.821185842):0.1841104182,((t268:0.1147152898,t269:0.09903179561):0.09505779741,t270:0.1923277409):0.766148057):0.2787819398,((t271:0.6498454965,t272:0.6487584179):0.05947232333,t273:0.6977295315):0.5240543002):0.01284669819,t274:1.2290888):0.06414138649):0.2846414519,((t275:0.6118749537,(t276:0.1626528397,t277:0.1601897066):0.4275972837):0.1675194435,((t278:0.013291246,t279:0.008953074611):0.709793552,(t280:0.4351676529,t281:0.4284375363):0.2818890509):0.03004304782):0.7944335248):0.1326181234):0.01404003449,((((t282:0.2187580116,((t283:0.06178364465,t284:0.02883599826):0.02890848289,(t285:0.003434437542,t286:0.002555513329):0.05025244099):0.1225389319):0.6170905249,(((((t287:0.433513901,t288:0.430782668):0.2493413686,t289:0.6786353128):0.02925290372,t290:0.7058758307):0.012950262,((t291:0.1403309886,t292:0.1358218576):0.4087147199,t293:0.5314696917):0.1547052364):0.0154852165,(t294:0.3346123684,t295:0.3318296878):0.3664163143):0.04271950294):0.3218618611,(t297:0.09899226637,t298:0.09224236614):0.9374624924):0.2140086673,(((t299:0.7845190956,t300:0.7835525594):0.2124749025,(t301:0.05452350996,t302:0.03907961564):0.9284460213):0.09070884275,((t303:0.3093500353,t304:0.3072593301):0.3922899254,(t305:0.5510560495,t306:0.5498866826):0.139225379):0.3466882368):0.1408246766):0.3067558782):0.6242966164,(((t307:0.9402751074,((t308:0.0816122903,t309:0.07733064059):0.6563909319,((((t310:0.1552779227,t311:0.1514014825):0.2689415931,t312:0.4158731643):0.1771277757,(t313:0.198968164,t314:0.1987029191):0.3846868921):0.1117007297,(t315:0.3029443567,t316:0.295724525):0.3919748811):0.01951963381):0.2011469243):0.008351819239,(t317:0.0504618565,t318:0.03626422537):0.8529336951):0.1442470897,((t319:0.2855280415,(t320:0.2485776002,(t321:0.2061167842,(t322:0.1364332251,t323:0.1314518957):0.06925486271):0.04237958682):0.02287414531):0.2430606504,(((t324:0.1699719814,t325:0.1561272503):0.06644990166,(t326:0.1911776907,t327:0.1851354452):0.01849978263):0.1876684989,((t328:0.2830961861,(t329:0.07188198054,t330:0.06794217118):0.2102774626):0.05220510085,t331:0.3285321141):0.0559059853):0.07907227286):0.502178126):1.008928861):0.1397178414):0.4469453078,((((t332:0.3689019209,(t333:0.01689336855,t334:0.003876121786):0.3444437538):0.3040185694,((t335:0.0674563765,t336:0.06554270625):0.3964914103,t337:0.4477772871):0.185811726):0.1954581772,((t338:0.6266616987,(t339:0.3510392302,(t340:0.254506786,(t341:0.07428380583,(t343:0.02812862437,(t344:0.01620150081,t345:0.007198690262):0.00959448365):0.02267045898):0.1712990538):0.08620955905):0.2722609181):0.07364298984,(t346:0.4032507657,(t347:0.2591685162,t348:0.2591187244):0.1394758858):0.2306834793):0.1247285303):1.186769575,(t349:1.375895425,(((t350:0.4664028822,t351:0.4578381015):0.0007899596473,(t352:0.3480225293,((t353:0.08624647774,t354:0.07919114942):0.1553933094,t355:0.2266607386):0.08243118816):0.09320121054):0.5778271763,(t356:0.511466542,t357:0.507010615):0.4443966214):0.3227764989):0.559424697):0.4942144794):0.2940791879,(((((t358:0.38575148,((t359:0.09642373184,t360:0.09473123319):0.25396767,(t361:0.3130312265,t362:0.3048950555):0.03415202563):0.02127480984):0.3936883774,(((t363:0.1944461442,t364:0.1671904822):0.04761191779,t365:0.2032265995):0.2409942597,(t366:0.1479679912,t367:0.1443018739):0.2952766063):0.2679536094):0.3817047634,((t368:0.3605831264,((t369:0.1090784217,t370:0.08727473646):0.1520895139,t371:0.2369119863):0.09605824015):0.3051332547,t372:0.6264430431):0.4234428053):0.6452348094,((((t373:0.03737302113,t374:0.03382032647):0.5081950188,t375:0.5417081034):0.1138706553,t376:0.6539845804):0.6543153325,((((t377:0.4453576877,((t378:0.005570307148,t379:0.000999575313):0.3429975936,t380:0.3432812796):0.09469176955):0.1217377856,(((t381:0.2802487056,t382:0.2614880938):0.1743237047,t383:0.4313481082):0.02830240158,(t384:0.4087156279,(t385:0.09002872355,t386:0.08920431005):0.3050593427):0.04538022579):0.06836674194):0.008515275126,(((t387:0.1816267665,(t388:0.07661497614,(t389:0.02809982172,t390:0.006023929641):0.0437408419):0.1035626768):0.03844368822,t391:0.1752134021):0.04138588136,(t392:0.07057652209,t393:0.0657220321):0.142159646):0.2516504522):0.5606190387,(((t394:0.1360632997,t395:0.1358842195):0.2168185445,((((t396:0.03758827984,t397:0.03460861882):0.005915373722,t398:0.03642112169):0.1164632718,t399:0.1507245985):0.1601210574,((t400:0.2442910483,(t401:0.1428791129,t402:0.1369280565):0.09624373167):0.03225234882,t403:0.2504401663):0.03371858545):0.03097421205):0.5373755196,(t404:0.7333174694,t405:0.7278570489):0.1026941979):0.1252733615):0.1687898224):0.3711622836):0.05426730088,(((t406:0.1095971141,(t407:0.0939053728,t408:0.08438932415):0.01399564009):0.3294124866,t409:0.4240724066):0.222799882,t410:0.6386034196):0.8849423819):0.7604112822):1.167868047):1.656065288,(((((((((t411:0.1841815187,t412:0.167911294):0.08712416941,t413:0.2498094109):0.143973105,(t414:0.02269394037,t415:0.01814134447):0.3666552242):0.7396166086,((t416:0.6545807881,(t417:0.06667715269,t418:0.05932281491):0.5808133143):0.2275304745,((t419:0.1321713062,t420:0.1216556791):0.1665635491,t421:0.2851452217):0.566905339):0.2375125283):0.3918863484,((t422:0.4056161663,(t423:0.06598131252,(t424:0.01713053607,t425:0.01662035178):0.04099097003):0.3343536443):0.1092977261,(t426:0.2810261755,(t427:0.03120031615,t428:0.03008467002):0.244201762):0.2164154933):0.9625362047):0.006779148291,(t429:1.395526363,(t430:0.2982436538,(t431:0.255432251,t432:0.2531679131):0.03926852545):1.076237012):0.05539341895):0.435523529,(((t433:0.01446775228,t434:0.006621225655):0.7588001122,(t435:0.4141800176,(t436:0.4099260792,t437:0.4005735087):0.0005442951278):0.3506041226):0.1017331938,t438:0.8451853093):0.9797895164):0.6547140432,t439:2.479129586):1.662844204,(((((t440:0.04806433688,t441:0.02892723622):0.01390780265,(t442:0.04058902914,t443:0.02790910268):0.00137686876):0.1533786654,t444:0.1596655303):2.29595307,((t445:1.53159376,(t446:0.6752391783,(t447:0.3445582187,t448:0.3402942814):0.3247598397):0.8504228037):0.5013269328,(t449:0.6274488232,((t450:0.2833823269,((t451:0.06019304367,t452:0.05617137929):0.03046919904,t453:0.07547420663):0.1889324869):0.09983118515,t454:0.3636346825):0.2208682207):1.380568732):0.4203264377):0.5385265895,(((((t455:0.1359072053,t456:0.12835757):0.1502695587,(t457:0.2605401092,(t458:0.07107649681,t459:0.05982313714):0.1871290763):0.01086896889):1.071881144,t460:1.328222652):0.3099725025,((t461:0.4690734313,((t462:0.2648038511,t463:0.2555693972):0.2008979702,(((t342:0.02079057689,(t296:0.01161013055,t1:1.826711965):0.3186870018):0.6020406165,((t2:0.5219591072,t3:0.5041928741):1.017613744,(t4:1.381232497,(t5:1.329165546,((t6:0.6219776897,t7:0.6090922895):0.6371508195,t8:1.244360045):0.06970245714):0.04842099653):0.1403689349):1.206880368):0.2206124886,((((t9:1.58235559,t10:1.57919087):0.2893009605,t11:1.862790118):0.2052215926,((t12:1.047117179,t13:1.012933563):0.8129866373,(t14:1.58066065,(t15:1.520318188,(t16:0.3557149674,t17:0.3532773699):1.156910744):0.05648174808):0.2384810106):0.2028261068):0.4739683178,(t18:2.288658484,((((t19:1.042546101,t20:1.042433966):0.3980238569,(t21:1.23517331,((t22:0.8375820849,t23:0.8236796438):0.1511298868,t24:0.9702634763):0.2332259723):0.2006113169):0.02338337073,t25:1.426214289):0.267990895,t26:1.68401061):0.5560303659):0.1777495905):0.3783681756):0.4830948872):0.001168490464):0.6886363951,(((t27:2.365194806,(t28:2.041354081,t29:2.036567142):0.3129819201):0.1571879739,t30:2.4946119):1.005321484,(((((((t31:1.606123353,(t32:1.264967088,t33:1.261951707):0.3389474485):0.4375932249,t34:2.033569078):0.5344834099,(t35:1.212388264,t36:1.208100892):1.355427555):0.3756442941,(((t37:0.140259647,t38:0.1368133238):2.127056414,((t39:2.122045596,((t40:1.273525862,(t41:0.4869756193,t42:0.4858981979):0.786491553):0.5241829953,(t43:0.6447658279,t44:0.6441293237):1.144750785):0.3221906851):0.1218860317,(((t45:1.409509491,(t46:1.235643974,t47:1.226200102):0.171389967):0.007398560514,t48:1.39484682):0.6863178692,(((t49:1.032506315,(t50:0.8853242176,t51:0.8835431746):0.1344390966):0.156405345,t52:1.174195242):0.2467931591,(t53:0.2868796611,t54:0.2832964126):1.127619468):0.6432263364):0.1152398618):0.0149191813):0.08153385895,((t55:1.796315023,t56:1.787598667):0.07491363536,t57:1.86215633):0.3896406819):0.5782910482):0.06860492399,t58:2.888204665):0.2464984989,((t59:2.350686672,(t60:2.256993242,((t61:2.142669945,(((t62:0.1433161139,t63:0.1212549974):1.631621446,t64:1.739984072):0.125856894,(t65:1.755073549,t66:1.753207125):0.1045761578):0.2416957441):0.09067208769,((((t67:1.057315963,(t68:0.6549447646,t69:0.6513769035):0.3978965296):0.06359502446,t70:1.10166648):0.3828742466,(t71:0.9057828047,t72:0.896435454):0.5772446665):0.6541272537,(t73:1.78312424,(t74:0.8279461789,(t75:0.7920212572,t76:0.767155958):0.03175396149):0.951185169):0.3430746464):0.02575888472):0.01735562527):0.09088467188):0.05200454075,((t77:0.6465733266,(t78:0.5734616997,t79:0.5720917805):0.05834768527):0.9530121075,((t80:0.5143755661,(t81:0.3504454885,t82:0.3418643327):0.1635642685):0.9526102846,((t83:0.9350119546,(t84:0.8171759618,(t85:0.1227316881,t86:0.1221237835):0.6914092431):0.1167520375):0.2739819883,t87:1.201689374):0.2480202097):0.1101147144):0.6665145141):0.7312687863):0.008935114527,(((t88:2.018869338,t89:2.009597312):0.1703565339,t90:2.171852403):0.07871140115,((((t91:0.2866684818,t92:0.2754599326):1.55341857,(t93:1.670182284,(t94:1.541155045,t95:1.525084714):0.1273335288):0.1557125091):0.1465414052,((t96:1.523158064,(((t97:0.4252919903,t98:0.4201406806):0.6914526418,((((t99:0.4100110646,t100:0.4031102586):0.4008712141,t101:0.7979933025):0.2462999947,t102:1.035486249):0.009573820403,t103:1.025155535):0.04347873184):0.277865781,(t104:1.199447262,t105:1.179198439):0.1341962177):0.1234834015):0.09017252896,((t106:0.05711907321,t107:0.05331435172):1.244895645,t108:1.288643053):0.2247612632):0.3345972522):0.2295407243,((t109:0.9251504931,t110:0.9182474451):0.4646107504,((t111:0.3994222576,t112:0.3988997078):0.6447440743,(t113:0.8533336007,t114:0.8307098023):0.1868492374):0.3328898357):0.6820176765):0.03354265328):0.6951463886):0.2202873661):0.4385634993):0.4737045934):0.02788101854,(((t115:0.1795310206,t116:0.1667913587):2.018736589,(((((t117:0.3618750074,t118:0.3609457391):0.4863589488,t119:0.8374026268):0.2987289446,t120:1.13560341):0.326500133,((t121:0.4971759292,t122:0.4924498825):0.04580346346,t123:0.5262317869):0.9172916327):0.3472547006,t124:1.789817235):0.3605863836):1.258899648,(((((t125:0.8972257992,t126:0.8941583959):0.4185193107,t127:1.311710213):0.8796215146,(((t128:1.559652569,t129:1.558662118):0.1544331671,(t130:1.56187958,(t131:1.015550993,(((t132:0.2683836537,t133:0.2671300157):0.1022266093,t134:0.3649309655):0.4210909101,((t135:0.531246521,t136:0.5273212978):0.04469300084,t137:0.5575352158):0.2097591879):0.2197255883):0.5438114374):0.1486359397):0.318388974,((t138:1.727052703,((t139:0.878816629,t140:0.8758332637):0.4048795467,(((t141:0.3796161748,t142:0.3672550082):0.2765856806,t143:0.6384115879):0.5530222388,t144:1.190572158):0.05075421063):0.4424369857):0.1944648294,(((((t145:0.6484588161,t146:0.6440473971):0.05073539176,((t147:0.3450863368,t148:0.3389311467):0.1675941164,t149:0.5030285566):0.1804402764):0.7813750007,(t150:0.3175790519,t151:0.3106345335):1.140392367):0.3163631172,(t152:0.8914062396,t153:0.8802661066):0.875751706):0.003464017085,t154:1.745383654):0.07422819247):0.07382863923):0.1542770944):0.1828158497,t155:2.21669413):0.5192794554,(((((t156:0.9701182686,t157:0.9674594945):0.1778177013,t158:1.144882663):0.04726955951,(t159:0.8630305689,t160:0.858684656):0.3231656915):0.8654717039,(((t161:0.5123969935,(t162:0.3070319201,t163:0.3026026818):0.1945063942):0.4192599842,(t164:0.7095517502,t165:0.7056086766):0.1829550015):0.3136281007,t166:1.201424174):0.8005147776):0.04214402311,(t167:1.21981355,(t168:0.4829302674,(t169:0.419976013,t170:0.3947052084):0.05591246761):0.7301995751):0.8175329004):0.6292628939):0.4969233507):0.4558667823):1.222984413):1.084035416):0.7748078571);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T86.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
