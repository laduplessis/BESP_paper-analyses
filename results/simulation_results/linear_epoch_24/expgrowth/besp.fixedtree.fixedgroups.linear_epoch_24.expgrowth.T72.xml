<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((t156:0.582565805,t157:0.5717095433):0.5600853509,((t158:0.2111080364,t159:0.2107232746):0.847905197,(t160:0.6708069473,t161:0.6678387792):0.3839372505):0.07223920357):0.02884244544,((t162:0.7558290875,t163:0.7537766493):0.1776333296,((t164:0.2375235796,t165:0.221540542):0.1324533068,t166:0.3370240863):0.5595039107):0.2164348372):0.1726929692,((((t167:0.8854671293,(t168:0.6716808795,t169:0.6671195271):0.2036269408):0.2450311036,(t170:0.4942041411,t171:0.4918348981):0.6181910135):0.09655816945,(t172:0.7256058373,(t173:0.2129061995,t174:0.2086021331):0.5087610634):0.4767575015):0.02568204167,(((t175:0.5448776855,t176:0.5279816702):0.1011825671,(t177:0.5386712687,t178:0.5241904405):0.0852695794):0.1517676673,(t179:0.6045194198,t180:0.5972792863):0.150107706):0.4185076928):0.03247701407):0.6333786906,((t181:1.583456602,t182:1.579723843):0.1727631619,(t183:1.200399913,(t184:0.8099771069,((t185:0.2263816251,t186:0.2179740827):0.05491774771,t187:0.2634116306):0.5247223151):0.3673899685):0.5349533984):0.07403091429):0.4054153421,(((t188:0.160896234,t189:0.1546838792):1.12409158,(t190:0.962688121,((t191:0.1885123443,t192:0.1879034032):0.430803035,(t193:0.118543172,t194:0.1153164675):0.4934658645):0.3408424279):0.3051472004):0.5112803661,(t195:1.635993539,((t196:0.9975602358,(t197:0.879096471,((((t198:0.2605594504,t199:0.259875651):0.2521869132,(t200:0.1553447283,(t201:0.03087566188,t202:0.02802466889):0.1220735694):0.3565172044):0.09527526235,((t203:0.2424044788,(t204:0.128448918,t205:0.1180859585):0.1078217898):0.007782458499,(t206:0.071511644,t207:0.06984040435):0.1582614307):0.3449818527):0.04106606924,t208:0.6100002056):0.229350408):0.1097609531):0.4642905366,t209:1.40192662):0.1689031695):0.1134001848):0.3704037854):0.4526071889,(((((((((t210:0.6582355641,t211:0.6503647854):0.1127085959,t212:0.7567462932):0.1344272229,((t213:0.05701450189,t214:0.05135209326):0.7528170794,t215:0.8035257983):0.06740782113):0.1302560801,(((t216:0.2137190493,t217:0.2130163603):0.01106126121,(t218:0.1914797802,t219:0.1888551377):0.02645474263):0.1979172534,(t220:0.1344766563,t221:0.1233012653):0.2543055704):0.5716629785):0.05047633775,t222:0.9995227174):0.08170406562,(t223:0.1753974581,t224:0.1719718039):0.8986705473):0.3526873115,(((t225:0.2799354455,(t226:0.00815811398,t227:0.006867396061):0.2710431366):0.2375562275,t228:0.5152192161):0.1811437603,t229:0.6939373751):0.7012895555):0.1232238968,((t230:0.9888609956,t231:0.9689604842):0.3551865123,((((t232:0.100920843,t233:0.09984391054):0.1371988458,t234:0.2187180415):0.2293740348,(t235:0.3915335388,((t236:0.2742180044,t237:0.268737628):0.06875410675,t238:0.3351515221):0.04815084684):0.0487403037):0.4977394119,t239:0.9284754816):0.3567987568):0.1684615195):0.3766644321,((((t240:1.251458642,((t241:0.9389203964,t242:0.9322877009):0.116306635,((((t243:0.5452923739,t244:0.5440543113):0.1755546265,t245:0.7151333561):0.0782010888,t246:0.7910445474):0.00725363078,t247:0.7951930859):0.240508398):0.1826955815):0.07286975305,((t248:0.9119613246,t249:0.9099574212):0.2588832293,((t250:0.06313662727,t251:0.06232197316):0.4347367732,(t252:0.2228233197,(t253:0.06137981301,t254:0.05551792484):0.1581666307):0.261899144):0.6697208027):0.1190059277):0.3607877322,((((t255:0.1804296144,t256:0.1794508508):0.003153350911,t257:0.173910659):0.7195508173,t258:0.8928925884):0.3549237439,(t259:0.8831934155,((t260:0.08850240897,t261:0.08175544613):0.1367202343,(t262:0.1407756788,t263:0.1374418102):0.04679668841):0.6561588497):0.355541158):0.362861544):0.1389469153,(((t264:0.1288811068,t265:0.1265213505):0.6098009781,(t266:0.5427939311,t267:0.5408401245):0.1927113479):0.3648807501,(t268:0.8526061008,(t269:0.1573725039,t270:0.1558579548):0.6850134859):0.2434977948):0.5789230729):0.005592891437):0.4807362977):0.8760372979,((((t271:0.6808318984,(t272:0.3097634075,t273:0.3031980345):0.3685713181):0.7176732658,(((t274:0.1111353696,t275:0.09466934056):1.052150785,((t276:0.3749508901,t277:0.3746147676):0.6728504255,(((t278:0.2259619165,t279:0.2152727791):0.2937440487,(t280:0.285762794,t281:0.2848661853):0.2128518827):0.3816102912,t282:0.8781067426):0.1409903381):0.09074837139):0.00634528367,t283:1.110732438):0.2141779936):0.09001327968,((t284:0.2256229522,t285:0.2234918782):0.07646772561,t286:0.2966313663):1.105298215):0.85459492,((((t287:0.2751738836,t288:0.272647982):0.2162900971,(t289:0.4231253809,t290:0.4139119955):0.06341306187):0.2411436521,((t291:0.1840715957,t292:0.1823029615):0.2775172843,(t293:0.1514153923,t294:0.1501908178):0.3063930477):0.2312431127):0.9753970598,t295:1.651231648):0.5424487748):0.6812207654):1.952279384,((((t296:0.8073821757,(((t297:0.5319978901,t298:0.5238793609):0.1387187078,(t299:0.03084246149,t300:0.03029773804):0.6270150242):0.1047430144,t301:0.7613545728):0.02426152613):0.2188253187,((((t302:0.1860663625,t303:0.1828219071):0.3769152064,t304:0.5564665366):0.1779869211,(t305:0.4120091865,(t306:0.02770570896,t307:0.02194837097):0.3654429039):0.3139089984):0.04700092563,((t308:0.3715504426,t309:0.3547474259):0.1756872305,(t310:0.4734488719,(t311:0.3401283538,t312:0.3302506002):0.1308221174):0.05509750079):0.1883267231):0.216057305):2.142094765,((((((t313:0.410889201,(t314:0.3017493994,t315:0.2991561116):0.09490790661):0.6553850134,(((t316:0.05572394522,t317:0.04999965815):0.8279578016,t318:0.8776522052):0.1330531577,t319:1.006154586):0.03208721734):0.1113324187,t320:1.141330448):0.06287204626,t321:1.18487243):0.2547549843,((((t322:0.111160419,t323:0.107631766):0.07421781169,t324:0.1775807552):0.1716052746,t325:0.3444433946):0.8889269957,((((t326:0.3778666244,t327:0.3764926876):0.3431918663,t328:0.7047090989):0.1128010003,(((t329:0.08763345804,t330:0.08372530145):0.3961676467,(t331:0.352140362,(t332:0.1273915915,t333:0.1244735137):0.2182827716):0.125944978):0.2488759173,t334:0.6851977215):0.07935545304):0.002073440917,((t335:0.6452865635,((t336:0.5142592174,(t337:0.4502412852,t338:0.44618933):0.05985154007):0.09437689933,t339:0.584174575):0.02991077071):0.04422636092,((t340:0.3047657582,t341:0.3005141215):0.106277717,t342:0.3992429399):0.2457555376):0.06925930859):0.3946561):0.1902049896):1.407733198,((((((t343:0.2014590565,t344:0.2010057879):0.01632776433,t345:0.2102015011):0.5440604191,(t346:0.7261147421,((t347:0.2567476918,t348:0.2505735255):0.3142667036,((t349:0.02200113043,t350:0.02146170633):0.3960488137,t351:0.40880391):0.1457758532):0.1426362945):0.01684719927):1.03619764,(((t352:0.216050341,(t353:0.154298832,t354:0.1504243418):0.04916250669):0.3491689059,((t355:0.147309442,t356:0.1433190372):0.1771188776,t357:0.3198048623):0.2241270365):0.5487829361,t358:1.091389149):0.6349048663):0.3941488625,((t359:1.024306414,(t360:0.6030132386,t361:0.5973877348):0.4166256672):0.4669692876,((((t362:0.1070570933,t363:0.1020302343):0.09526606063,t364:0.1963936635):0.3552837187,(((t365:0.2479034551,(t366:0.09839094654,t367:0.09141350983):0.146986186):0.08073717684,t368:0.3177612868):0.1068922083,(((t369:0.1906031533,((t370:0.03619396793,t371:0.02697491616):0.03945749756,t372:0.05852397253):0.1058783192):0.06903570926,t373:0.2331495514):0.132235725,t374:0.3547749584):0.03242118124):0.1118780677):0.6572616961,(((t375:0.05048823165,t376:0.03745290315):0.03908271416,t377:0.07273068467):0.8917681385,t378:0.9594569502):0.1677776338):0.2651333728):0.6279867312):0.006896607699,(t379:0.7318400373,((t380:0.07204413236,t381:0.0661855989):0.2359983459,t382:0.2925963182):0.4173342408):1.259243133):0.506260703):0.1574516517):1.010131134,(((((((t383:0.2270375685,t384:0.2266441104):0.3037155002,t385:0.5259602114):0.5420191257,(t386:0.879158782,(((t387:0.2192563072,t388:0.2178910482):0.06372061363,t389:0.2815038575):0.387804659,t390:0.6664715625):0.1918379763):0.1696650453):0.04068023261,((t391:0.4125354726,(t392:0.1970674096,t393:0.1881638973):0.2072904595):0.400068379,t394:0.7876549488):0.254592509):1.545630411,(((t395:0.3553227074,t396:0.3482622784):0.2777248076,((t397:0.1382522988,t398:0.1334174752):0.4218097158,(t399:0.08558667908,t400:0.08471004062):0.4693796203):0.06526307004):1.338196891,((t401:0.5718022911,((t402:0.05946903386,t403:0.04982280855):0.4354263525,(((t404:0.1610512079,t405:0.1549874839):0.04580840705,(t406:0.1636875779,(t407:0.0296221248,t408:0.02277558055):0.1292953645):0.03077330036):0.08228644137,t409:0.2609425285):0.1835396266):0.06894489169):0.8293848114,((t410:0.4496296276,((((t411:0.2822507284,(t412:0.2633934463,t413:0.2627922105):0.01319562551):0.09021477325,t414:0.3588421509):0.004084974079,t415:0.3612759223):0.008426340307,(t416:0.2287372336,t417:0.2266591159):0.1314691446):0.05805415486):0.53200703,(((t418:0.254217529,t419:0.2445675859):0.1719308641,t420:0.4120458241):0.2131823911,(t421:0.08930637436,t422:0.07765834231):0.5264134214):0.3004015508):0.3588845965):0.5553182767):0.6043188423):0.4277300864,(((((t423:0.5093867942,((t424:0.2329516781,t425:0.2290466691):0.2210779749,t426:0.4443308841):0.04777628415):0.00681131546,t427:0.4831459582):0.2175642203,(t428:0.315075745,t429:0.3147615671):0.3803819483):0.545200727,((t430:0.4957736363,(t431:0.453584749,((t432:0.02406428653,t433:0.01898147542):0.01216211207,t434:0.02998695085):0.4155409885):0.04202255675):0.4147211968,t435:0.8919787629):0.3245906882):1.141818999,(t436:0.05397806487,t437:0.04131096774):2.290696977):0.4285151201):0.4762767776,(((t438:1.841256718,(((t439:0.6671253674,((t440:0.4986792864,t441:0.4919458003):0.0886326014,(t442:0.4571408639,(t443:0.08176838717,t444:0.07910268934):0.3730785):0.1228927503):0.07145163539):0.366916121,((t446:0.5813704243,(t447:0.3971984887,(t448:0.1011887679,t449:0.0997005748):0.2917051248):0.1830366354):0.2736444653,t450:0.8441416271):0.146418563):0.405725247,t451:1.390911271):0.3940004936):0.06318051228,(((t452:0.1526172645,(t453:0.03980869581,t454:0.03562580677):0.1060705626):1.083737581,t455:1.221097501):0.3430144871,(t456:1.225916487,(t457:0.7036181662,t458:0.7022917179):0.5191881574):0.2809033154):0.2583990816):1.031220954,((((t459:0.215047319,t460:0.2045094318):1.318498809,t461:1.507378004):0.5049432913,(((t462:0.4399322662,(t463:0.1866829571,t464:0.1839682872):0.2491200007):0.8449342904,((t465:0.09050144425,t466:0.08619728223):0.1897660314,t467:0.2713339808):0.9930754088):0.3493956693,(t468:0.5291848767,((t469:0.2767240189,t470:0.2719960184):0.04364079529,t471:0.3144237538):0.207797659):1.078778961):0.370129099):0.180012649,(((((t472:0.4231608183,t473:0.4211037183):0.08512935434,(t474:0.3643123276,((((t445:0.005252939105,(((t1:0.9513465436,t2:0.9375759534):0.7293806603,t3:1.665625564):0.6521959827,(t4:1.558353213,t5:1.556258291):0.7542536697):0.4431052323):0.2266756423,(t6:2.825575699,((((t7:1.341344605,t8:1.329186909):0.6160444571,(t9:1.772625887,(((t10:1.028001119,t11:1.020153034):0.2997528019,t12:1.315358713):0.356004875,(t13:1.635045406,t14:1.630118784):0.03463045109):0.08612943954):0.1687564301):0.4011703168,(t15:2.256569626,((t16:1.812674271,(t17:1.454568536,t18:1.441783144):0.3555367152):0.412322852,((t19:0.5106049118,t20:0.4984954861):1.264608376,(t21:1.450488204,((t22:0.4327782071,t23:0.4285251845):0.7752312682,t24:1.196606198):0.232679348):0.3097956128):0.4249463324):0.02867721993):0.05145441668):0.2140949644,t25:2.452610047):0.2340470673):0.1491509863):0.1991148236,(((t26:0.8427168731,(t27:0.1160018355,t28:0.1159005256):0.7184422341):0.2128805894,(t29:0.7937628131,t30:0.776910172):0.2436838631):1.617710071,(t31:0.703146418,t32:0.7031074129):1.934791651):0.3473878112):0.1105064794,(((t33:2.305529587,t34:2.301504931):0.003172116388,(((t35:1.524000834,((t36:1.321024267,t37:1.301962483):0.1121697326,(t38:0.01542318295,t39:0.003876084639):1.392420303):0.08104477136):0.295303531,t40:1.772008287):0.3647440316,((t41:1.736182262,t42:1.727321914):0.2968063101,((((((t43:0.9574409157,((t44:0.3600343532,t45:0.3586365017):0.201048098,t46:0.5571188044):0.3930249878):0.3843170237,(t47:0.7527100596,t48:0.7202186693):0.5775520766):0.1135361945,((t49:0.9020265324,t50:0.8977040703):0.4509962023,(((t51:0.6984952321,t52:0.6893709134):0.4800914911,t53:1.166430806):0.1308088355,t54:1.285945363):0.0346383398):0.05055717448):0.159433419,(((t55:1.312334809,t56:1.308570146):0.0918959109,t57:1.390457952):0.1029099282,t58:1.47713773):0.01969290528):0.2015658974,t59:1.688410808):0.1091330221,(t60:1.600277839,t61:1.598409004):0.1940465617):0.08855282677):0.1006617939):0.1110009546):0.6462064507,((((t62:1.778740854,((t63:0.5219964585,t64:0.5219261203):0.4019803366,(t65:0.7370642709,t66:0.7273665294):0.1819072644):0.8518436061):0.4398494627,(t67:1.250434727,(t68:0.1061189634,t69:0.1048044331):1.139963998):0.9406851236):0.0204538855,t70:2.205507779):0.1178087701,(t71:0.128521017,t72:0.1266612163):2.192469264):0.3259761191):0.1056623434):0.04195229884):0.1364141587):0.07389492891,((t73:1.644931782,t74:1.639703321):0.7810752636,(((t75:0.9877358679,t76:0.9834791243):0.7442762685,(t77:1.342948089,((t78:0.7039516986,t79:0.7017428196):0.5780222036,((t80:1.015136421,t81:1.001722603):0.1408190354,t82:1.141736487):0.1220614573):0.06045173785):0.3774213693):0.4893223755,(((t83:0.8049903506,t84:0.7866271859):0.6557190406,t85:1.422068323):0.5140213253,((t86:1.782613107,(t87:0.3137196571,t88:0.3130192626):1.465488778):0.1164790306,t89:1.892345884):0.03363482351):0.2105810225):0.1989494834):0.5740256515):0.1246893466,((((((((t90:0.8314436004,((t91:0.2428418166,t92:0.2280957127):0.3370059158,t93:0.5582724945):0.2477877423):0.1105698152,(t94:0.7392514465,t95:0.7353395878):0.1702198205):0.0135599145,t96:0.917543271):0.2492132804,(t97:0.7598532654,t98:0.7560275436):0.396541542):0.7682751771,(((t99:0.7646265242,t100:0.7583932841):0.6673882714,(t101:0.9318380103,t102:0.9194534609):0.4807675685):0.05807602296,(t103:0.7240223893,t104:0.7227962097):0.7244693329):0.4237929006):0.1226546048,t105:1.982434286):0.1569300376,(((t106:1.104387936,(t107:0.8124746346,(t108:0.693603597,t109:0.693193689):0.1176856413):0.2912471046):0.3711738342,(t110:0.8620733867,(t111:0.4406074786,t112:0.4327888393):0.4129664955):0.60899759):0.2646653148,(((t113:1.097354607,t114:1.092523307):0.2108607549,(t115:0.2352550513,t116:0.21678909):1.066362734):0.4105482535,((t117:0.4663174021,t118:0.4577025347):0.03469442426,t119:0.490018755):1.191846968):0.0002408449908):0.3972977344):0.29504227,((((t120:1.730757675,((t121:0.6579614289,(t122:0.2480584536,t123:0.2477917997):0.3857940135):0.4881594213,((t124:0.5699532158,t125:0.5499488011):0.1516744186,t126:0.7015663671):0.3849149681):0.5846200383):0.3322501325,t127:1.997336778):0.220529196,((t128:0.5667978469,t129:0.5600958928):0.9736613111,t130:1.529615168):0.6749583098):0.03650368301,t131:2.237505395):0.05180305579):0.4837777415):0.5279950396,((t132:2.126992512,t133:2.124560937):0.3499750806,(((((t134:0.5151246663,t135:0.5148697635):0.1244722611,t136:0.6364690274):0.5141499298,((((t137:0.1710929878,t138:0.1661549593):0.7706667479,t139:0.9314414023):0.08350335957,t140:1.00764135):0.04890481862,t141:1.054589479):0.07131212297):0.3184638467,t142:1.4388642):0.3735145436,(t143:1.65816139,((t144:1.11548944,((t145:0.7072020809,(t146:0.3658327908,t147:0.3581665478):0.3227379231):0.2444007639,t148:0.9239432809):0.1565527431):0.2251492226,((((t149:0.5202565787,t150:0.517234828):0.09218483713,t151:0.6048567599):0.3527640163,(t152:0.9334509963,t153:0.9262266397):0.02086570398):0.3236980207,(t154:0.4305921001,t155:0.4286247741):0.8391557145):0.01121472752):0.3171633271):0.1534335824):0.6190796615):0.8211018646):0.8979052743):0.5630485667):0.2992173705):0.07824263668):0.6483022614);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T72.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
