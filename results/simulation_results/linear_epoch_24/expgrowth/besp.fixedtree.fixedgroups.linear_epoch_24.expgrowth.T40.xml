<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t419:0.7297447055,t420:0.7265759973):0.1685291308,(t421:0.6796063818,((t422:0.09939614914,t423:0.08987092832):0.07500821464,(t424:0.04534926259,t425:0.04474308492):0.09949796696):0.5037616306):0.2146538063):0.2874531672,((((t426:0.1424221615,(t427:0.07612718306,t428:0.07202082106):0.04957985796):0.3118721091,t429:0.4304674529):0.4610224991,((((t430:0.2637421602,(t431:0.1094252325,t432:0.1007071306):0.1483751139):0.104773933,(t433:0.09087239393,t434:0.08901115205):0.2608900772):0.3520216626,(t435:0.03619834174,t436:0.03256524879):0.6618832412):0.1373850973,(t437:0.3527169875,t438:0.3459299359):0.4788931369):0.02826514101):0.1791562951,t439:1.021289954):0.04777463383):0.01527409914,(t440:0.930183153,t441:0.9161733732):0.1329314205):0.4646346699,((((t442:0.5888270943,((t443:0.3866799322,t444:0.3839930922):0.1483499829,(t445:0.466316168,t446:0.4531827358):0.06581468745):0.04811631703):0.1621661325,((t447:0.2377605466,t448:0.2350971497):0.1068409208,t449:0.3400206669):0.3775309421):0.1864470169,t450:0.9029793002):0.2008035377,t451:1.103221043):0.3565161636):0.1523529668,((((t452:0.1733838039,t453:0.1690009679):0.08311454792,t454:0.237074104):0.5399833799,t455:0.7760832633):0.546689202,(((t405:0.005543418117,((t352:0.009939736546,(t347:0.005036256658,(t324:0.005018742461,(t1:1.896523938,(t2:1.855199045,((t3:0.2610633559,t4:0.2609768286):0.7145190692,t5:0.9546866626):0.8727726075):0.03570232551):0.2652301535):0.1585669124):0.0360625764):0.1904457079,(t6:1.202826566,t7:1.20122251):1.309542847):0.08731535491):0.1644817423,((t8:2.06150051,t9:2.061407759):0.294349069,t10:2.353444564):0.3992266006):0.5092232334,(((((((t11:0.0843695531,t12:0.08321839375):1.064566325,(t13:0.1117442333,t14:0.1007878347):1.033898801):0.5667422892,t15:1.697041942):0.2637894915,(((t16:0.7451324405,t17:0.744905921):0.7002334391,t18:1.441036932):0.2743814005,t19:1.708031938):0.2278852077):0.4858507524,(t20:2.361243047,((t21:1.67261634,((t22:1.584844292,t23:1.582642675):0.03643931738,(t24:0.3972752562,t25:0.3941561686):1.211278543):0.04043733659):0.5376052405,(t26:0.2747985535,t27:0.2672477033):1.907719981):0.1287498086):0.04492662582):0.05466256346,t28:2.399484605):0.4377594986,(((((t29:0.8918635498,t30:0.8858647839):0.3778549387,(t31:0.5743880381,t32:0.569244106):0.6892387938):0.3988711097,(t33:0.6316170424,t34:0.6145012547):1.013797933):0.961607877,((t35:2.053095749,(t36:1.211375275,(t37:1.084942151,t38:1.062257357):0.1194177308):0.8208204895):0.001570455504,t39:2.001699698):0.5216801054):0.04064605184,((((t40:0.8878148421,t41:0.8870298903):0.2420982959,t42:1.127913654):0.3881204312,(t43:0.2107249471,t44:0.2027086908):1.299416785):0.5730960916,((t45:1.738844422,t46:1.722776462):0.1982350955,t47:1.910809509):0.1330545207):0.4583561879):0.1621484283):0.3036857277):0.9868449545):0.2642508261):0.7377688129,(((((((((t48:1.940157553,t49:1.937609401):0.01239877647,((t50:1.393783473,(t51:1.05464579,((t52:0.333757569,t53:0.3274806348):0.5083397855,t54:0.8336139293):0.2110222361):0.3329135536):0.3302372902,(t55:1.682854332,(t56:0.8133714849,t57:0.8125200888):0.867006834):0.01754370831):0.2231920301):0.02242731108,(t58:1.653091945,(t59:1.338828678,((t60:0.57187864,t61:0.5565584927):0.5935006533,t62:1.142848307):0.1649727806):0.3127260087):0.2863637789):0.3058864991,((t63:1.031047299,(t64:0.2865886064,t65:0.2835450421):0.736426548):0.4099934423,(t66:1.39181757,((t67:0.7190741646,(t68:0.6589430262,t69:0.65403967):0.05657244006):0.327383198,(t70:0.6527420461,t71:0.6482052403):0.3829807761):0.3364570237):0.03791865267):0.7662173022):0.1086701046,(t72:0.3933303957,t73:0.3908649632):1.885461931):0.3482490226,((t74:1.251544911,t75:1.249187004):0.2666075758,(t76:1.23436501,(t77:1.095826309,(t78:0.3382992948,t79:0.3259546492):0.7557187212):0.1385003971):0.2783822565):1.103609971):0.5794567065,((((t80:1.962254785,((((t81:1.345926655,(t82:0.3516303027,t83:0.3439488357):0.9905585524):0.2298512799,((t84:0.971542581,t85:0.9632874695):0.4507530681,(t86:1.109672693,(t87:0.7325328394,t88:0.7079136633):0.376303676):0.2963565621):0.1418951621):0.08277819855,(t89:1.333804383,(t90:0.9306231298,(t91:0.7418328132,t92:0.7203341249):0.1763469791):0.3878448387):0.2610972553):0.04855652537,t93:1.579784497):0.2521728692):0.1074270843,t94:1.936976968):0.8391338629,(((((t95:0.5712429048,t96:0.5663783604):0.616045914,(t97:1.034056863,t98:1.031944354):0.1442388146):0.1608343897,t99:1.333919781):0.6537694267,((t100:1.540794459,(t101:1.322572645,(t102:0.3364381616,t103:0.336272394):0.9860771067):0.1926476079):0.4008340469,(((t104:0.5229319945,(t105:0.3362207652,t106:0.328915238):0.1798668025):1.021230722,t107:1.52958393):0.3216628103,t108:1.850454296):0.04679151401):0.04499786712):0.7546852608,((((t109:1.006650295,t110:0.9858085692):1.230341202,(t111:0.1684487804,t112:0.1577483596):2.041093213):0.1720105874,(((t113:1.159838766,(t114:0.1056906267,t115:0.1030960201):1.049788976):0.6432140325,(t116:1.493738576,(t117:1.222841538,t118:1.215010326):0.2665908688):0.2912394583):0.06066002845,t119:1.828310441):0.5040113084):0.03058800878,(t120:1.007941592,t121:0.9986156846):1.354152357):0.2540825634):0.01777973716):0.09653674864,((t122:1.157838733,((t123:0.3573181649,t124:0.3435306629):0.6785132431,t125:1.019486626):0.09141934371):1.471417046,(((((t126:0.9636325427,(t127:0.9369976925,t128:0.9314657757):0.02611059381):0.9387133358,((t129:0.962931145,t130:0.9611303266):0.4610550101,(t131:0.6384041403,(t132:0.07553287078,(t133:0.06467666053,t134:0.05153671822):0.009237763284):0.5565184837):0.7759649804):0.4531955842):0.03157393097,((t135:0.5713019936,t136:0.5711140076):0.8960252579,((t137:1.097374447,(t138:0.03580422469,t139:0.02663393653):1.053542208):0.2233572949,t140:1.286357685):0.1440298029):0.3940294873):0.1237822598,(((t141:0.8039730122,(t142:0.4630506268,t143:0.4627508725):0.3360446097):1.027453677,((t144:1.620207853,t145:1.611384865):0.1804644576,(t146:1.587908593,((((t147:0.09949724235,t148:0.09907097466):0.2009385171,t149:0.2916622999):0.3449552415,t150:0.634236512):0.8444714047,(((t151:0.8466048183,t152:0.8381812377):0.08486154906,(((t153:0.1158734901,t154:0.1137135708):0.5089215422,t155:0.6187645602):0.1664917162,t156:0.7791215897):0.1219780516):0.2094934129,t157:1.107493386):0.3219099599):0.09785764026):0.1862822053):0.02523472373):0.07440491159,t158:1.799232582):0.03524815513):0.1135132547,((t159:0.850372875,t160:0.8440640843):0.9964270925,((t161:0.8998230546,t162:0.8916100426):0.4538570794,(((t163:0.7242125838,(t164:0.6391229375,t165:0.6369828647):0.08014405242):0.4315437096,(t166:0.6092307323,(t167:0.3344916596,t168:0.332799935):0.2726653346):0.5360558647):0.05450368639,((t169:0.4952967617,t170:0.4941871266):0.6564227293,(t171:0.5949486623,(t172:0.5535423609,(t173:0.2670855667,t174:0.2669957708):0.2851045705):0.03764876754):0.5514751485):0.04198990186):0.1343515444):0.4854077695):0.1008779219):0.4049371027):0.08125375244):0.1604555343):0.642375366,(((t175:1.710648856,t176:1.70537412):0.1434464469,((t177:0.6587717625,t178:0.6563061321):0.9209265949,((t179:0.6646519314,t180:0.6634078878):0.8969304239,(((t181:0.742488525,(t182:0.6759010354,((t183:0.3012072898,t184:0.294714675):0.2659316046,(t185:0.251971725,t186:0.2463181058):0.3048628765):0.1059532747):0.06395823733):0.4157894805,(t187:1.09210303,((t188:0.5379249747,t189:0.5298513853):0.111296791,((t190:0.3025841542,t191:0.3016397026):0.3332865189,t192:0.6311702852):0.0007627513277):0.4398662184):0.04094074736):0.1816669653,(t193:0.5253573496,(t194:0.4781999145,(t195:0.01134439169,t196:0.003154353892):0.4592631191):0.02662439122):0.7490110116):0.2147722292):0.01049576391):0.2684952631):0.9808026635,((((t197:0.8878633413,((t198:0.2631616251,t199:0.2405918255):0.02293891835,t200:0.2625894869):0.5973996201):0.07821964926,t201:0.9349165489):0.7019439587,((((t202:0.4398388851,t203:0.4228178925):0.05543163552,t204:0.4725450089):0.6606234987,t205:1.131845464):0.3879979512,(t206:0.5206238286,t207:0.5129852086):0.9906923411):0.09217002727):0.1531656577,t208:1.738369534):0.8860110373):0.3570312888):0.847708864,((((((((((t209:0.06455842172,t210:0.05815469939):0.7009256077,(t211:0.7123657667,(t212:0.5425017862,t213:0.5139508898):0.1620839451):0.04399771019):0.07700876988,t214:0.7957572138):0.5541292318,t215:1.348974595):0.0382041357,((t216:0.3658416981,t217:0.3563393549):0.9430015029,(((t218:0.275667457,t219:0.2617273679):0.8405692168,((t220:0.4599254947,(t221:0.2961412328,t222:0.2867657761):0.1628893958):0.5647569306,(t223:0.7061084243,(t224:0.4630148178,t225:0.4535663035):0.2345884169):0.3004720229):0.07555958325):0.09958178371,(t226:1.131268113,((t227:0.4060922851,t228:0.4050044692):0.625599406,((t229:0.3911383947,t230:0.3846422732):0.001407589531,(t231:0.2009683449,t232:0.1998087651):0.1811897075):0.628143072):0.08760607315):0.02819469318):0.07856178373):0.07002514324):0.2689706331,((t233:0.752911895,t234:0.7515103208):0.3491456746,(t235:1.07311865,(t236:0.8251799924,((t237:0.04935391774,(t238:0.03346182016,t239:0.02789486046):0.01133781881):0.5971352333,t240:0.6302211536):0.1784116204):0.2385988506):0.01827359003):0.4197604046):0.3805782125,(t241:1.04582378,t242:1.045120026):0.8191570312):0.4141053761,(((t243:0.7439115256,((t244:0.5578540141,t245:0.5500471277):0.05353842446,t246:0.6026967783):0.1311973237):0.7489497867,(((((t247:0.2356219688,t248:0.2270425523):0.4377533989,t249:0.6629207307):0.07088219629,(t250:0.1663191835,t251:0.1605939021):0.5603805878):0.5287597563,t252:1.249265265):0.08476312147,((((t253:0.1985223711,t254:0.1981250984):0.1322401331,t255:0.3256657883):0.4652819108,((t256:0.4277471503,t257:0.4266530621):0.04533065865,t258:0.4564957971):0.3173322934):0.4057123633,(((t259:0.1466332539,t260:0.1382337309):0.05640606045,t261:0.191965616):0.5414891949,t262:0.7274460657):0.4271674164):0.1218765083):0.0934992039):0.05639699232,((t263:0.9974663836,t264:0.9961417475):0.02601744576,((((t265:0.04457084579,t266:0.04347291357):0.09950672373,t267:0.14155313):0.09197319728,t268:0.2247760409):0.3995175752,t269:0.5995460009):0.3860941007):0.3844202056):0.7264828522):0.03353887992,((t270:1.387977174,(t271:1.009611314,(t272:0.9208300124,((t273:0.6701002253,t274:0.6291693191):0.1473563089,((t275:0.3865483983,t276:0.3794169397):0.3714424215,t277:0.7493086366):0.01596773889):0.09760653775):0.08499240144):0.3770851807):0.5413245164,((((t278:0.7140537523,t279:0.7088726692):0.03392640572,t280:0.7387539722):0.1824556712,((t281:0.6821967183,(t282:0.2042739756,t283:0.192768648):0.4682961415):0.06884493487,(t284:0.5176196702,((t285:0.02154236639,t286:0.01752714408):0.4604888587,t287:0.4755629159):0.02925684455):0.1897352933):0.168205256):0.6223172828,(t288:1.259958199,(((t289:0.4828156994,t290:0.4818505087):0.4924743701,(t291:0.928945064,(t292:0.4572771695,t293:0.4535640583):0.4590323202):0.04364341421):0.1101964011,(t294:1.019514877,(t295:0.5443976502,(t296:0.3641998608,(t297:0.2656383733,t298:0.2594149553):0.09540152608):0.1711546688):0.4687146231):0.03953534262):0.1721454836):0.2203496025):0.3081960809):0.1906775132):1.281284463,(((((t299:0.2063629332,t300:0.1949661567):0.2362360278,t301:0.411867665):0.3421098537,(t302:0.3735785252,t303:0.3455985365):0.3771823147):0.2472593498,((t304:0.04939989699,t305:0.04710663092):0.7549044485,t306:0.795838195):0.1604239923):0.2333650972,((t307:0.1065480465,t308:0.09430033125):0.6090013009,t309:0.7031802271):0.4655323083):1.936374722):0.01352482021):0.1450398908):2.226691944,((((((((t310:0.7104293428,((t311:0.006987691018,t312:0.001554453459):0.4097208541,t313:0.4061137593):0.2857044102):0.03567120405,(((t314:0.1424722815,(t315:0.1284262168,t316:0.1274480547):0.003499289776):0.09739860142,t317:0.217135977):0.365065903,(((t318:0.04488243176,t319:0.04213704922):0.2106350918,t320:0.2508796561):0.3186065144,t321:0.5663148207):0.00779773037):0.1152628086):0.9870876114,((t322:0.5165428271,t323:0.4624704257):0.5604842946,((((t325:0.1188197707,t326:0.1117086233):0.2202586096,(t327:0.1858020898,t328:0.1792403598):0.14065191):0.02744139254,t329:0.3317478964):0.02798131207,((t330:0.1736473832,t331:0.1640016813):0.06939072585,t332:0.233244405):0.1114138767):0.619501759):0.5897951885):0.1762644943,(t333:0.7260502316,((t334:0.1814119519,t335:0.177453353):0.3823598973,t336:0.5560224569):0.1538686448):1.00158815):0.1826532658,t337:1.882884164):0.7594951049,((((((t338:0.1486167612,t339:0.1413500398):0.2210984136,t340:0.3602284028):0.2241288524,(t341:0.2635955852,t342:0.2626603934):0.3041613576):0.0311552024,(t343:0.4992381812,t344:0.4817469938):0.09791712328):0.2604338376,((t345:0.3908775062,(t346:0.3486138087,(t348:0.2936411351,t349:0.2934027219):0.04296520436):0.02237083905):0.3262909537,t350:0.683995339):0.1209003946):1.518484934,(t351:1.206740657,(t353:0.04039861094,t354:0.03946241455):1.134655369):1.116420353):0.2379216563):1.263071104,((((((((t355:0.1568512099,t356:0.1529488485):0.004603912502,t357:0.1555431197):0.3435690883,(((t358:0.0527434803,t359:0.0498917192):0.274354062,((t360:0.06971788298,t361:0.05747022616):0.2195841161,(t362:0.1338911341,t363:0.1290920706):0.1375244512):0.03390869576):0.1338762566,t364:0.4241099751):0.03598992171):0.2180319844,(((t365:0.02277562332,t366:0.009964022389):0.1678369568,t367:0.1771598518):0.151963831,t368:0.3288848377):0.3233295443):0.2469829472,(((t369:0.2600520133,t370:0.2581815189):0.3334993243,t371:0.5902549177):0.07938716559,(t372:0.4401112044,(t373:0.04322105801,t374:0.03690678825):0.3865916795):0.2275385891):0.2181168959):0.07358813591,((t375:0.02944390368,t376:0.02439010606):0.2193129969,t377:0.2382051183):0.6908656353):0.1195979788,((t378:0.9069388905,(t379:0.07156171602,t380:0.07061377737):0.8274332872):0.04529857502,((t381:0.2201469244,t382:0.2193244518):0.3922973826,t383:0.6037698093):0.3301539565):0.09300555797):2.161011829,((((t384:0.2359390676,(t385:0.2207716462,t386:0.2152108975):0.005323894401):1.202868506,((t387:0.2754926588,t388:0.2745916929):0.381924622,((t389:0.3708712547,t390:0.3478991182):0.2220973238,((t391:0.1144242038,(t392:0.02266526245,t393:0.01722406359):0.09035183298):0.4412781523,(t394:0.4747270418,((t395:0.1283899388,(t396:0.0204858899,t397:0.01754369654):0.1059195683):0.1158351333,t398:0.2373527632):0.2216625122):0.07207731951):0.004701340448):0.06029103642):0.7643362486):0.1471278445,((((t399:0.1594988542,(t400:0.1196533096,t401:0.1108625734):0.032099078):0.172893834,t402:0.3132287098):0.1841058306,t403:0.4872008536):0.754572292,t404:1.238976907):0.231934344):0.2968198,(t406:0.02360010923,t407:0.01463989502):1.708616853):1.295533553):0.4646240471):0.2528872985,((((t408:0.04571368293,(t409:0.01814692255,t410:0.0116805597):0.02123075374):0.08593188889,(t411:0.01838063601,t412:0.01458650738):0.09497149907):0.06939947395,t413:0.1635055155):1.934981134,(t414:1.257783343,(t415:0.1758999342,((t416:0.04976599328,t417:0.0473435868):0.1025894446,t418:0.1440641367):0.02053866967):1.076184134):0.8334802309):1.597604124):1.120320426);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T40.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
