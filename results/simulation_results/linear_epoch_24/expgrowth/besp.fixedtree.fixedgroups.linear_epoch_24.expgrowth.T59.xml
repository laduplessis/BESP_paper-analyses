<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t279:1.460060774,((t280:0.7544821826,((t281:0.5879146675,((t282:0.03766336543,t283:0.03505617925):0.1896292271,t284:0.1999914156):0.3423832102):0.1106944558,t285:0.6512766143):0.0515419749):0.3120641337,((t286:0.5734534097,t287:0.573045125):0.210273998,((t288:0.1527807729,t289:0.1448197578):0.03478077327,t290:0.1640932645):0.5851220751):0.2265533963):0.3919623579):0.5751979177,(t291:1.860568888,((t292:0.8208781953,((t293:0.1696975387,t294:0.1664608771):0.02812312892,t295:0.185282838):0.6196246504):0.7984594874,t296:1.603291677):0.2367639947):0.07271616646):0.5712756547,(((((t297:1.009289364,t298:1.003398372):0.1547063828,(t299:0.5347240307,t300:0.5168628047):0.6207833723):0.04890520279,(t301:0.6604226979,t302:0.649927332):0.5113784059):0.04210216063,(((((t303:0.6640820033,t304:0.6610909):0.0948515287,(((t305:0.06689642356,t306:0.06681476956):0.3567557375,t307:0.4223680069):0.01347186967,(t308:0.2612897782,t309:0.2534008212):0.1732641754):0.3165167318):0.139141036,(t310:0.5792993734,(t311:0.4097551096,t312:0.4096751171):0.1647784699):0.2995391586):0.02032731947,(t313:0.5815735302,t314:0.5722823715):0.304170266):0.2380408924,t315:1.108690737):0.04630222345):0.1914348684,(((t316:0.4044723091,(t317:0.2597543207,(t318:0.1266287276,t319:0.1221793586):0.1304683967):0.1419211219):0.05320440803,(t320:0.3864522774,t321:0.3863966288):0.04478662806):0.444619334,((t322:0.8146278264,(((t323:0.3744376777,t324:0.371957511):0.1169829808,t325:0.4881331255):0.1100240203,(t326:0.4935330741,((t327:0.04264397552,t328:0.03684901856):0.1102342357,t329:0.1372234287):0.3400738477):0.1010787581):0.2122343045):0.00944520601,t330:0.7777792002):0.05034481525):0.4433739291):1.03507824):0.3709451569,((((t331:0.5925610765,t332:0.5887296413):0.3292215292,(((t333:0.3470059676,t334:0.3345981286):0.09048445428,t335:0.423052138):0.4486026061,t336:0.8615622536):0.02946825213):1.229588284,(((((t337:0.2861802371,t338:0.2849075355):0.1573609288,(t339:0.411641793,(t340:0.2488605189,t341:0.2479693195):0.1614585516):0.02629801647):0.5897710555,t342:1.021543246):0.8180282964,(((t343:0.5901969164,(t344:0.4058856653,(((t345:0.01408682292,t346:0.009018624633):0.1531008695,t347:0.1554677995):0.04092222179,t348:0.1960606703):0.1950193616):0.1809056599):0.6237449882,(t349:0.08464667005,t350:0.08011880533):1.093144053):0.5037231856,((t351:0.9838493638,(((t352:0.2118426149,(t353:0.09552936203,t354:0.09366375661):0.108440768):0.0758407511,(t355:0.2641719426,(t356:0.25930456,t357:0.2581101724):0.003999383365):0.01005189449):0.6321822953,t358:0.9027020077):0.06137755908):0.4835765511,(t359:0.3495934229,t360:0.3422049238):1.094786972):0.1987452746):0.1202812579):0.04778925335,((((t361:0.4551497079,t362:0.4491665979):0.6430224023,(t363:0.8733906058,(t364:0.5892541442,(t365:0.4873997856,(t366:0.399439821,t367:0.3971681923):0.0870411213):0.09659581885):0.2753229252):0.2159335896):0.01556096016,((t368:0.2915110319,t369:0.2780152689):0.6800111778,t370:0.9377663161):0.1138156543):0.2372737243,((t371:0.6639835466,(t372:0.5397030791,(t373:0.015267283,t374:0.01232146663):0.5222131409):0.1090010925):0.2745937168,((t375:0.3655665351,((t376:0.2317815705,t377:0.2309713249):0.1022501028,(t378:0.07789426644,t379:0.07056045187):0.2542032165):0.02808308556):0.5009964232,(t380:0.229396429,t381:0.2287880274):0.6182478452):0.04750889451):0.34547438):0.4465139409):0.2178699758):0.3019402182,((t382:0.761406754,(t383:0.3037669063,((t384:0.1351123906,(t385:0.07246267444,t386:0.06861538702):0.04158923154):0.05135458537,t387:0.1417426055):0.1163851785):0.4535582493):1.068883993,((((((t388:0.5264013677,((t389:0.03463861484,t390:0.03303039505):0.1436254512,t391:0.1750628262):0.3424695962):0.1553106175,(t392:0.4446571063,(t393:0.1099884763,t394:0.09420403979):0.3292469596):0.2241193074):0.4346828456,(((((t395:0.1230376582,(t396:0.1056055364,t397:0.09986912124):0.01619742615):0.0575243399,t398:0.1699672361):0.2762593852,t399:0.4426577637):0.135748949,((t400:0.3366738738,t401:0.3197264753):0.01267178891,(t402:0.1600154618,t403:0.1480425986):0.1505699574):0.2114026567):0.2503877956,(t404:0.4562421615,(t405:0.2540033547,t406:0.2523489186):0.1946978929):0.3012403694):0.225386285):0.1384593384,(((t407:0.04952806835,t408:0.04842709335):0.2813528122,(t409:0.2692676679,t410:0.2559693997):0.05754100826):0.1706942801,(t411:0.222203088,t412:0.2217304642):0.252431321):0.6078077952):0.2632589342,t413:1.343956167):0.02402462507,(((t414:0.1616907335,t415:0.1590760493):0.9673208332,((((t416:0.3103864541,t417:0.3061462594):0.2335244079,((t418:0.1829689704,(t419:0.07378877161,t420:0.06714355579):0.1055387491):0.1734574963,t421:0.3367405791):0.1830443651):0.3625442882,(((t422:0.06911778462,t423:0.06909533174):0.3744460479,(t424:0.1135305493,t425:0.08607028131):0.3210181944):0.0784689872,t427:0.4718126252):0.3343920861):0.2095987433,(t428:0.4592491566,t429:0.4590506109):0.5473469452):0.002408633109):0.2082577878,(t430:0.880666083,((t431:0.3160380096,(t432:0.04475279943,t433:0.04403869704):0.2696207135):0.1630343008,t434:0.475078363):0.394924516):0.3230984096):0.02441862307):0.2353557803):0.3758190652):0.2048552987):2.717924528,(((((t435:0.1887018827,t436:0.1840152583):0.993818453,(t437:0.3101543092,t438:0.3054806326):0.8651318037):0.7620910348,((t439:0.6231152389,((t440:0.1430223864,t441:0.1398077536):0.0612937434,t442:0.1970308837):0.4145694438):0.914252629,(((t443:0.5595275275,(t444:0.4090668973,(t445:0.223985807,((t446:0.155352562,t447:0.1466667406):0.03935664465,(t448:0.17781565,t449:0.1739900325):0.0005244801471):0.0156156035):0.1693120669):0.1469596106):0.1985444104,t450:0.7017449182):0.1149551483,t451:0.8147790302):0.6517997542):0.3844583435):0.5976260489,(((((t452:0.3846595245,t453:0.3786300194):0.1617338138,(t454:0.05907859916,(t455:0.0206866207,t456:0.01991473616):0.0373071863):0.4745803984):0.8321779127,((t457:0.05326213851,(t458:0.01544357998,t459:0.01231467438):0.03673889466):0.1477833044,t460:0.1966723742):1.16149556):0.1830902666,((t461:0.5920222284,(t462:0.2044021356,t463:0.2038511879):0.3716387183):0.4058950876,(t464:0.2235303401,t465:0.2209639147):0.751907445):0.5429193487):0.08947487261,((((t466:0.4073716139,t467:0.4041747738):0.08173939393,t468:0.4751176902):0.5067582218,(((t469:0.02956797018,t470:0.01583138564):0.6126752271,t471:0.6176077857):0.1877822887,(t472:0.2631910224,(t473:0.170965834,((t474:0.08648958103,t475:0.08460483953):0.01899452972,t476:0.1030274028):0.06069737132):0.09171066902):0.5402290245):0.1384181354):0.1418070077,((t477:0.1077357635,(t426:0.0001973804319,((t242:0.0242790501,(t223:0.002244927932,(t133:0.0005713814745,(t1:0.8214445074,t2:0.8171186962):0.01677703593):0.4923440305):0.1795214358):0.765990751,(t3:1.256632258,t4:1.251770219):1.013411119):0.4501250597):0.378222409):0.8728652807,(((((t5:2.593487462,((((t6:1.335109058,t7:1.328133707):0.247119383,t8:1.569394302):0.1518493506,t9:1.709341103):0.3661458103,((t10:1.679461583,t11:1.664690676):0.3653673193,((t12:1.131844379,t13:1.130489786):0.06986464545,t14:1.197264996):0.824213117):0.02786831907):0.4825162601):0.1601636032,(t15:1.965778201,(t16:0.9549788337,t17:0.9397029919):1.007016341):0.7251540668):0.001104626768,(t18:2.185137283,((t19:1.401444699,t20:1.398195778):0.1259973386,t21:1.505776508):0.6541169517):0.4850623591):0.3856445623,((t22:1.585350667,t23:1.580908588):1.04259,(t24:2.410501096,((t25:2.262109932,(t26:1.242791489,t27:1.235672395):1.00984599):0.1436265346,((t28:0.9800658685,t29:0.9460033333):1.349530775,(t30:0.7079350201,t31:0.6793074816):1.579904475):0.05358326588):0.001857698879):0.2086790804):0.4018446226):0.5332549848,(((t32:0.7933490028,(t33:0.7686480259,t34:0.7681181156):0.01406104347):1.318941827,((t35:0.3780531067,t36:0.3694283134):1.223066202,t37:1.591830456):0.4903114673):0.2289709146,(t38:1.900142859,t39:1.900075647):0.4102482179):1.113454353):0.2926975798):0.08683718275):0.4600280551):0.7966231123):0.664751783,((((t40:2.024786183,((t41:1.676226459,t42:1.675309093):0.147892446,t43:1.808352808):0.1940673945):0.1164410116,((((t44:1.07973175,t45:1.077703823):0.6810919716,t46:1.75856486):0.04296394972,((t47:0.6432920553,t48:0.635006105):0.1767384469,(t49:0.02083202334,t50:0.01003230303):0.7810722486):0.9793585158):0.02524001351,((t51:0.7549021534,t52:0.7459810761):0.0788890411,t53:0.8225257484):0.9559822778):0.2877692766):1.530623833,((((((t54:0.8924916415,t55:0.8737942748):1.114233336,(t56:1.032206459,t57:1.026761208):0.9483409607):0.5813203597,((t58:2.205666992,(((t59:1.306670057,t60:1.301278107):0.6863297009,(t61:1.12974467,t62:1.124595156):0.8551305895):0.07904232744,t63:2.053705065):0.1138426393):0.03474196569,(t64:0.3172986262,t65:0.3167449521):1.884285102):0.312016595):0.1681547228,((t66:1.273077701,t67:1.266868799):0.09482859277,((t68:1.057743679,t69:1.047595437):0.1030782502,t70:1.148343197):0.1970649395):1.295502876):0.02354703863,((((t71:0.8638793005,t72:0.8514643702):0.7435687956,(t73:0.5634696945,t74:0.5559808505):1.010038771):0.05423287301,((t75:1.146072782,(t76:1.020799426,(t77:0.7651726389,t78:0.7621215049):0.2541494055):0.1232074389):0.4278678475,(t79:1.344803684,(((t80:0.2556626142,t81:0.24935855):0.4938964886,t82:0.7348934407):0.4801243596,((t83:1.101921266,t84:1.098170889):0.04000214117,t85:1.13629802):0.0727798014):0.1131903705):0.2176942748):0.04617544574):0.07068034655,(t86:0.7991588685,t87:0.7902840262):0.8520374608):0.9295219152):0.3858949165,(((((t88:0.7255194417,t89:0.7089208146):1.128016323,(t90:0.7627376881,t91:0.7525615003):1.072713867):0.4170628178,((t92:0.8622336922,(t93:0.6840920198,(t94:0.4425632118,t95:0.4363008992):0.240994738):0.1677155727):1.076266278,(t96:1.491620293,(t97:0.7732006587,t98:0.7730509004):0.7154692771):0.4293657492):0.30380042):0.3863084759,((((t99:1.265516764,(t100:0.4526157584,t101:0.4388868855):0.7948515685):0.8467669791,(((t102:0.8392859655,(t103:0.7861359635,t104:0.7857740574):0.04427031552):0.3375631075,t105:1.165454614):0.5799119752,t106:1.74129245):0.3150783299):0.1546001081,(((t107:0.9510524744,(t108:0.9174342282,(t109:0.7163362328,t110:0.7154140873):0.1989423233):0.03360500481):0.7032410668,(((t111:0.2972967096,t112:0.2965561791):0.1735979697,(t113:0.1737855447,t114:0.1644956943):0.2942121111):0.1498564052,(t115:0.5407946656,t116:0.5358223307):0.06726911823):0.9957779601):0.2978156814,((t117:0.6114119548,t118:0.6064915007):0.9252221022,(t119:0.8992562027,t120:0.8883561179):0.6304157817):0.358822729):0.2496138746):0.2723550749,((t121:2.065363489,(((((t122:0.3291810214,t123:0.3233455181):0.07552525373,t124:0.3736525645):1.019633849,(((t125:0.6506374503,(t126:0.2094733606,t127:0.2071487062):0.4276277148):0.4593825334,(t128:0.4316363584,t129:0.4250837444):0.6586072778):0.1022173519,(((((t130:0.5634495341,t131:0.562545185):0.01315274238,t132:0.56406065):0.02713009463,(t134:0.5655489031,t135:0.5572568897):0.01730547905):0.4035810399,(t136:0.6806917306,t137:0.6785014035):0.2949250315):0.08632794379,(t138:0.857207061,t139:0.8567960063):0.1957021422):0.09025005398):0.1770111752):0.4785476994,((t140:0.7805853774,t141:0.7785733791):0.1777154698,t142:0.9540361361):0.8338036055):0.07379716774,((((t143:0.2945368784,t144:0.288181844):0.4597513465,t145:0.7430948781):0.109518012,(t146:0.6158888942,(t147:0.4874863084,(t148:0.2574414935,t149:0.2513406587):0.2275434019):0.1112217765):0.1766882434):0.5294797316,(t150:1.085815816,t151:1.073597519):0.2104009842):0.4674545281):0.0858575391):0.1742984963,(t152:1.37367588,((t153:0.1214966699,t154:0.1189003504):1.232063637,(t155:1.27646631,(t156:0.573438775,t157:0.55827778):0.6984725016):0.06506160715):0.01865189603):0.6344834875):0.1578996232):0.06683778162):0.1536434819,((((t158:0.3746551321,t159:0.3724494347):0.6945881579,t160:1.065009056):0.8143558267,(t161:1.737882996,((t162:0.2698920181,t163:0.266624915):1.239778164,(t164:0.4432791741,(t165:0.3175569937,t166:0.3096678274):0.1253237967):1.054604585):0.2275069201):0.137966934):0.1177246572,(t167:1.743892617,(((t168:0.8603340293,(t169:0.1211638909,t170:0.1090496934):0.7338401949):0.5525915817,((((t171:0.2942317438,t172:0.2761405236):0.5386398267,(t173:0.1495635827,t174:0.1488452926):0.6599923132):0.1561421359,(t175:0.7029818343,(t176:0.2176667185,t177:0.2170611832):0.4800899052):0.2596504951):0.3355289485,(t178:1.178859345,t179:1.172186836):0.1133205934):0.06742550663):0.03204328666,((t180:0.885002198,t181:0.8832944223):0.1911241778,((t182:0.2763874369,t183:0.2752305681):0.3293034796,t184:0.5998913525):0.4668436194):0.308765729):0.2972807927):0.225670917):0.344645514):0.1414882841):0.4196734217):1.899676834,(((t185:0.7425660285,t186:0.7348766454):1.487547565,t187:2.218053235):1.52948981,(((((t188:1.060819807,t189:1.058842096):0.9485544265,((t190:1.714963986,(((t191:0.2470212109,t192:0.2431569668):1.152644744,(((t193:0.9098806549,t194:0.9067453557):0.3062863635,(t195:0.5639845063,(t196:0.415282056,t197:0.3972088126):0.1396272734):0.6480905157):0.008033162538,(t198:0.133891749,t199:0.1326161515):1.054982794):0.1521334553):0.1321414083,(t200:1.145423452,((t201:0.6799432536,(t202:0.556925305,t203:0.5541185131):0.1226684165):0.3841370914,t204:1.06044367):0.07200911407):0.3155869617):0.1782125902):0.2365874122,((t205:0.8526270252,(t206:0.1427524389,t207:0.1390414684):0.7048502733):0.6732481804,(t208:0.5752469931,(t209:0.2910663416,t210:0.2897698396):0.2820256558):0.9411625758):0.3312228515):0.04943552534):0.06381818957,((t211:0.6342273114,t212:0.6302272204):1.055691358,(((((t213:0.1187104985,t214:0.117861853):0.6115163863,t215:0.7154643079):0.5673361037,t216:1.273417374):0.09043858853,t217:1.363266339):0.2500607063,((((t218:0.1729594927,t219:0.1692202172):0.8589714725,(t220:0.8222999483,((((t221:0.1944961757,(t222:0.1883756564,t224:0.1683119458):0.00245029951):0.09524109107,t225:0.2588897042):0.09823317841,t226:0.3554552626):0.0755672413,t227:0.4267263513):0.3579360344):0.1962441229):0.4076692223,(t228:1.138005985,t229:1.127711178):0.2463551295):0.07538681832,((t230:0.184159931,t231:0.1670622847):0.8682884146,(t232:0.9050591451,t233:0.8987548715):0.1116672785):0.3888241476):0.08764578603):0.04630777185):0.2669741444):0.03732507063,((((((t234:0.09881438077,t235:0.09407489631):0.1285253505,t236:0.2156918995):0.160251353,t237:0.3719562934):1.194211272,((((t238:0.6954591199,t239:0.69373041):0.1990630703,((t240:0.8459614394,(t241:0.3474644745,t243:0.3078624472):0.4980387326):0.02905600651,((t244:0.4600620971,t245:0.4525491047):0.2392815866,(t246:0.3655145105,t247:0.356902891):0.3222009029):0.1287767923):0.007102798903):0.2686443598,(t248:1.05155434,t249:1.051026449):0.01887727942):0.2100542046,t250:1.276868407):0.1739999456):0.06873849804,((t251:0.6388255884,t252:0.622707439):0.3043101128,((t253:0.5631742476,t254:0.5375947851):0.1067023887,t255:0.6375691866):0.2255573749):0.5694709963):0.09660490639,(t256:0.1835466648,t257:0.1585649368):1.336528503):0.08692115938):0.5613028014,((((t258:0.7821023259,(t259:0.6187590441,(t260:0.4925606476,((t261:0.2513246043,t262:0.2493854352):0.1475718688,((t263:0.03604498532,t264:0.03220311948):0.2729972319,t265:0.3047658914):0.08427703343):0.08649312948):0.1237778534):0.1615797024):0.2677314482,t266:1.002736712):0.7364410042,(t267:0.5730159701,t268:0.5550246043):1.161222132):0.0462373126,((((t269:0.4751027586,t270:0.4671519606):0.1185486797,(((t271:0.04187574165,t272:0.0377264582):0.330685126,t273:0.3654339142):0.1488808747,t274:0.5096398916):0.0395317058):0.2371529012,t275:0.7792941983):0.1840116988,((t276:0.04820180868,t277:0.04732016914):0.277141133,t278:0.3191885696):0.6348949222):0.7467279447):0.3047189418):1.070515658):0.9404782515):0.1502949764):1.536953288);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T59.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
