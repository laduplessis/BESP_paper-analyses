<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t408:0.1770509392,t409:0.1690546985):1.997878282,(((((t410:0.08467299623,t411:0.07990745781):0.174923376,t412:0.2527957032):0.01365960312,(t413:0.1706062165,t414:0.15928247):0.09460164031):0.8183997966,((t415:0.1361021068,t416:0.1346909542):0.8050821022,t417:0.938821428):0.1294567743):0.7999473711,(t418:0.1201748088,t419:0.1134232437):1.744678032):0.2678645868):0.6043022721,(((((t420:0.7271176383,(t421:0.1727384827,t422:0.1679387531):0.5490955733):0.04391100063,t423:0.7359001171):0.04552887266,(t424:0.3034688848,t425:0.2996966304):0.4702707455):1.06495668,t426:1.832667811):0.003506450057,(t427:0.1966721515,((t428:0.1020185459,t429:0.09338729232):0.03584307313,t430:0.1203226259):0.04192843865):1.626721509):0.8445927314):0.3076891097,(((t431:0.1892266767,t432:0.1817148445):0.4354454881,(t433:0.3808355283,t434:0.322602953):0.2264301691):1.3947254,((((t435:0.2760246314,t436:0.2753261802):0.3588588968,(t437:0.4414693963,t438:0.4400809295):0.1785334231):0.3207344989,t439:0.924852156):0.697532056,(((t440:0.09209495399,t441:0.08492542018):0.3404924488,(t442:0.2368307004,(t443:0.04673499269,t444:0.03500061297):0.1873190348):0.1819195854):0.4147635687,t445:0.8043878686):0.774348072):0.2902668201):0.9214438869):0.6047711604,(((((t446:0.3434074221,t447:0.3321599983):0.03281447845,t448:0.3608497619):0.1680172315,t449:0.5281054492):0.09491796952,t450:0.613695122):0.6568964818,((((t451:0.0229544558,t452:0.02050156207):0.1960440881,t454:0.1897768205):0.2548388861,t455:0.4424085867):0.4403524141,(t456:0.6705255219,(t457:0.4066569973,t458:0.4015343653):0.2562462262):0.2080483909):0.3558461304):2.092202102):0.7276160859,(((t459:0.230251789,t460:0.2221460244):1.694940244,(t461:1.061901225,(t462:0.2523841015,t463:0.2397534132):0.7996312991):0.8507530429):1.028637807,(((t464:0.8891445942,(t465:0.1088213303,t466:0.09797241511):0.777161865):0.1428106597,(t467:0.0503105133,t468:0.04835827227):0.9556251092):1.756893146,((t469:0.3051092949,(t470:0.1652962424,(t471:0.09575190473,t472:0.0822182293):0.06350829726):0.135404753):2.15989531,(((t473:1.081680751,((t474:0.007906497386,t475:0.006298437673):0.1596920587,t476:0.1637453317):0.9121070103):0.5124562842,((((t477:0.4861081497,((((t478:0.02684849068,t479:0.02449605505):0.1286261082,(t480:0.04597483151,(((t453:0.01215650051,((((t396:0.0005255204656,((t382:0.02532086963,(t364:0.001951101439,((t309:0.007290210126,(t1:1.258682979,t2:1.246824061):0.6688292222):0.196674595,((t3:1.669709672,t4:1.665080742):0.1544080955,t5:1.810543015):0.28130846):0.125035623):0.1029665862):0.05170124007,(t6:2.053947361,(t7:0.9438313325,(t8:0.7451919988,t9:0.7439492281):0.1976509476):1.10344097):0.3136751676):0.0563705498):0.1084805683,((((t10:1.542991358,t11:1.524775531):0.01009458262,t12:1.528921972):0.3513251866,t13:1.875345586):0.3860740398,((t14:1.197409431,t15:1.184968665):0.8873112579,((t16:1.23748324,t17:1.230579279):0.8115505645,(t18:1.152208922,t19:1.145803396):0.8747892188):0.01953145563):0.1763620943):0.2308629342):0.181069588,((t20:1.254122508,t21:1.252330282):0.2415835241,(t22:0.9050355244,t23:0.900129197):0.5730419468):1.127175861):0.01317978292,((t24:1.772241337,(((t25:1.02726912,t26:1.027161126):0.4365547883,t27:1.46350437):0.1620272331,t28:1.617577027):0.1455519032):0.3244744376,(t29:1.945535406,((t30:1.148681142,t31:1.143374404):0.4561126195,(t32:1.281391523,t33:1.275609762):0.3171461625):0.3387807957):0.1362072738):0.5158695011):0.08033598893):0.1779430284,(((t34:2.147488882,(t35:2.000072577,t36:1.999547141):0.1455626286):0.004286817456,(((t37:0.114216175,t38:0.1086976805):1.845297336,t39:1.939877681):0.1728342169,((t40:1.472693855,(t41:1.362346159,t42:1.349542985):0.08906264969):0.09892355456,(t43:1.159008477,((t44:0.8672781952,t45:0.8661893274):0.08430376778,t46:0.9440649793):0.2058325978):0.3635666253):0.5294946812):0.01576829551):0.3688542926,((((t47:0.9709406248,t48:0.9701405325):0.3581640829,t49:1.328086152):0.06992907596,((t50:1.153714884,t51:1.131950029):0.1162524429,t52:1.24740512):0.1263808557):0.4746881454,t53:1.838441114):0.5400512495):0.3197332735):0.01677404912,(((((t54:1.109497507,t55:1.102557973):0.2543002163,t56:1.351818238):0.2495391291,t57:1.597914178):0.6905107993,(((t58:1.200504638,(t59:0.1523017228,t60:0.11815519):1.046727872):0.1617674835,t61:1.320611616):0.007861399764,t62:1.32627556):0.9036671039):0.02763387662,(((t63:0.85958737,t64:0.8560529009):0.70814819,t65:1.557933222):0.4763298723,t66:2.027713694):0.2104372184):0.3695203957):0.005523508348):0.09375104413):0.08895598383,(((t67:1.551757106,t68:1.550062972):0.4580922032,((t69:1.590320407,t70:1.589089962):0.07893867815,(t71:1.649012228,t72:1.648330764):0.01876459096):0.334559111):0.7559268733,(t73:1.379615675,t74:1.369212523):1.374063578):0.02978966836):0.1734552876,(t75:1.326031832,t76:1.321134523):1.619041095):0.06704714691):0.110222882,(((((t77:1.919281417,(t78:1.473269139,(t79:0.9985669269,(t80:0.6241442059,t81:0.6134990357):0.370462686):0.4608789657):0.4415653722):0.06345876453,(t82:1.606498991,(t83:1.212068739,(t84:0.3598325647,t85:0.3189378402):0.8521942011):0.3783640474):0.3424845256):0.234446406,((t86:0.45893679,t87:0.4577961456):0.8778881268,t88:1.329220853):0.7885584124):0.06935681259,(((((t89:0.6476957852,(t90:0.4367697819,t91:0.4352056614):0.2094991603):0.3380808853,t92:0.9792900751):0.1712435843,t93:1.145396387):0.03763015433,t94:1.178098394):0.7264921176,(t95:1.705694183,t96:1.704649766):0.197369904):0.2640662876):0.1235499174,((t97:0.7394095201,t98:0.7236843263):1.384499792,((((t99:0.5906641024,t100:0.5862335187):0.4937843902,t101:1.078648427):0.06091210492,(t102:0.572855109,t103:0.5696125138):0.5651440043):0.402133506,t104:1.531638923):0.5461936862):0.1602358714):0.6989135421):0.2863563635,((t105:1.550990168,t106:1.547536414):0.7059513297,(t107:0.7965670916,t108:0.7932251293):1.455051907):0.9532334008):0.4561859338,(((((t109:0.1921089567,t110:0.1797387547):1.302595584,(t111:1.455773339,((t112:0.7619599768,t113:0.7583477644):0.3749697205,t114:1.127606463):0.3062624337):0.02385977485):0.3296484708,(t115:0.9786498894,(t116:0.9273838704,(t117:0.9141001208,t118:0.9032584983):0.002932195536):0.03382321249):0.8082460405):0.8631532709,(((t119:0.6117527855,((t120:0.4172999878,(t121:0.004152308834,t122:0.002900156866):0.4075692949):0.154414007,t123:0.5540024727):0.03337557295):0.6966647112,t124:1.273995502):0.8176423929,((t125:0.6695426402,(t126:0.6351788557,t127:0.6342104895):0.03124433573):1.051742959,((t128:0.3341986612,t129:0.3207826192):1.091429142,((t130:0.8997722852,t131:0.8899162126):0.37892027,(t132:0.7479622441,(t133:0.2683336582,t134:0.2367647716):0.4746489467):0.5153967546):0.1297534923):0.2806949916):0.3617581972):0.4782576171):0.1389208221,((((t135:0.6838607289,t136:0.6767908544):0.3869018414,t137:1.05508706):0.2194794681,t138:1.270225549):1.11997144,t139:2.386302759):0.2054538294):0.8270500729):0.2471008314):0.1608100557,(((((((((t140:1.510299091,(((t141:0.1983449118,t142:0.1788894762):0.05073407227,t143:0.2182552673):0.2038143514,t144:0.4160363182):1.045863008):0.2210159074,((t145:0.7930624245,(t146:0.6274349831,(t147:0.5859604257,t148:0.5795980446):0.03983566925):0.1602090746):0.7217649227,t149:1.496338041):0.1617040631):0.2970699311,(((((t150:0.641371207,t151:0.633983436):0.2191116959,((t152:0.3543462867,(t153:0.2607994552,t154:0.2592294583):0.0899962979):0.1325795221,t155:0.4802604404):0.3629338065):0.09298515607,t156:0.9036920486):0.1522704647,(t157:0.04787409689,t158:0.04542062815):1.007270343):0.8152698154,(t159:1.722978556,(((t160:0.4222859641,t161:0.4010776339):0.9314900289,(t162:0.957559222,t163:0.9575348121):0.3639041123):0.1676045216,(t164:1.437040115,t165:1.433061185):0.04479041106):0.1994181307):0.1362279627):0.02499580164):0.112763138,(t166:1.722535635,(t167:0.4060769616,t168:0.3992128034):1.313469456):0.2143079189):0.2408988041,((((t169:0.1322736527,t170:0.1271482109):0.9976355083,t171:1.123036801):0.0579591215,(((t172:0.05362238801,t173:0.05134749822):0.4857572161,t174:0.5358316963):0.09474684609,t175:0.6229452884):0.5448472662):0.8027343748,(((((t176:0.2751587242,t177:0.2685981658):1.006473563,(t178:0.01812006299,t179:0.01767510541):1.237972707):0.2906262699,t180:1.544245974):0.0179952703,t181:1.557659453):0.3484725295,(((t182:0.6764869713,t183:0.675901856):1.046699445,((t184:1.005274331,t185:0.9851822049):0.6181732457,((((t186:0.4315089024,t187:0.4253526939):0.4898009228,t188:0.9131732071):0.238689533,((t189:0.06351230678,t190:0.05448697868):0.172967781,t191:0.2052534002):0.9082302439):0.1305579362,t192:1.239365833):0.3055734007):0.09776161354):0.1160637774,(((t193:0.8711352522,((t194:0.6716414601,t195:0.6662077572):0.1335362285,(t196:0.5228562383,t197:0.5183821036):0.2636962846):0.05989006329):0.2479684978,(t198:0.04600297548,t199:0.03532364809):1.03877219):0.5394088745,(((t200:0.2313028348,t201:0.2305010995):0.3245275066,t202:0.5500342949):0.5033729552,t203:1.050296923):0.552211694):0.1001342543):0.0645199231):0.02939611485):0.1715204576):0.06847711879,(t204:1.765129796,((((t205:0.6982381816,(t206:0.06141320005,t207:0.05820058467):0.6355620879):0.4100493369,t208:1.102105584):0.3562276139,(t209:0.9198645753,t210:0.9088849931):0.5246135338):0.2597769843,((t211:1.226544261,(t212:0.5212615291,((t213:0.4528046384,t214:0.4456594239):0.0600901144,t215:0.5047474239):0.004593000872):0.7032400901):0.3402903965,((t216:0.4943977491,(((t217:0.2376529034,t218:0.232426357):0.2268060595,((t219:0.2654593098,t220:0.2643903076):0.0900824486,t221:0.3542109853):0.1032305607):0.002198202643,t222:0.4588123679):0.02368797):1.026564767,((t223:0.7627098247,(t224:0.09172711662,t225:0.0912545299):0.6704069127):0.2433564285,t226:1.004742315):0.5023042313):0.0308772696):0.1212303337):0.02318515671):0.2713010633):0.6911347569,(((((((t227:0.2107029297,t228:0.2071559479):0.7966152035,(t229:0.4678023685,(t230:0.0742186434,t231:0.06573135054):0.3928136805):0.5252491108):0.1487743897,((t232:0.07892813354,t233:0.07222787359):0.1637913412,t234:0.2136512877):0.8895499059):0.1237357834,t235:1.225045806):0.5952204369,((t236:0.9576180009,(((t237:0.1639423776,t238:0.158358486):0.3467607034,t239:0.5018545332):0.2870171776,t240:0.7754615643):0.1582446821):0.3080357912,(((t241:0.6122587743,(t242:0.2739620699,t243:0.2695305849):0.3330628664):0.1144561514,t244:0.7065545159):0.02490506913,(t245:0.3164827843,t246:0.3156934634):0.4099949778):0.4873618894):0.5458764413):0.1189789164,((t247:1.304875306,((t248:0.1328026824,t249:0.1312271615):0.624016668,((t250:0.276831179,(t251:0.096859085,t252:0.09433262665):0.1789596255):0.433603112,t253:0.7036413281):0.03929340634):0.547115339):0.1409507893,(((((t254:0.3792086734,t255:0.3728620053):0.2252105865,t256:0.5979245977):0.006754818951,t257:0.5990204248):0.3878923529,(t258:0.3827089714,(t259:0.3281875082,t260:0.3274795365):0.05193131695):0.5874048547):0.1750645563,(t261:0.2507379028,(t262:0.1864051082,t263:0.1863717121):0.06242235843):0.8822496942):0.2443431828):0.4314540949):0.4221278614,(((t264:0.7670932358,((t265:0.04667676692,t266:0.03780865484):0.6919214782,(t267:0.05297129823,t268:0.04782367542):0.6726852282):0.01460697006):0.441778301,((t269:0.1628070647,t270:0.1508356603):0.238071548,t271:0.3685538898):0.7700324028):0.1294611711,((t272:0.155722808,t273:0.1537568707):0.4383798008,t274:0.5851835575):0.6496154288):0.8848326447):0.2226239257):0.1289719414,(((t275:0.2179123766,t276:0.2088518081):0.364374919,t277:0.5643897197):0.8954346718,(((t278:0.4381256247,t279:0.4320347538):0.1181039013,t280:0.5491566763):0.2286615052,((t281:0.4379917416,(t282:0.1532705984,t283:0.1491265664):0.2771292722):0.1287726382,(t284:0.4393143474,t285:0.4387745764):0.09912786438):0.2062624067):0.668104643):0.9903435282):0.3541729071,((((((t286:0.09230955634,t287:0.08621973905):1.077273226,((t288:0.243174407,t289:0.242597299):0.6239002509,((t290:0.09170628476,t291:0.06287132541):0.6745312966,((t292:0.1204257756,t293:0.1162024047):0.5000312805,(t294:0.3516429141,(((t295:0.08665427673,t296:0.08464591973):0.08251912566,t297:0.1630942775):0.1527877951,t298:0.310736706):0.01874305728):0.2608759796):0.1119169096):0.09312127392):0.296006103):0.4311371964,((((((t299:0.3016252025,(t300:0.1594411721,t301:0.1412712627):0.1420415182):0.4989868162,(t302:0.252070438,t303:0.2491849108):0.5225396817):0.1322930504,(((t304:0.3407577094,t305:0.3379744027):0.04797370015,t306:0.3846457179):0.1120791923,t307:0.4954725543):0.3937119132):0.07039061813,(((t308:0.1035680266,t310:0.07667574368):0.4751686615,t311:0.5507007901):0.1642110544,((t312:0.2403304425,t313:0.2247164127):0.4126687849,t314:0.6328996498):0.04779030773):0.2056845161):0.2983517836,(t315:0.1677667621,t316:0.15590002):1.011566546):0.1476249223,t317:1.312926563):0.06980669093):0.4298367794,(((t318:0.3905302848,(t319:0.1567645696,t320:0.1544048395):0.2324201842):0.7435468149,(t321:0.6003132356,(t322:0.1175322796,((t323:0.08886092703,t324:0.08290380097):0.004112537853,t325:0.0812240822):0.01422115804):0.4798910953):0.529083901):0.2097207063,((t326:0.08640114121,t327:0.07927473785):0.5220628683,(t328:0.3364209114,(t329:0.2762714912,(t330:0.1075485881,t331:0.1028771107):0.1664983388):0.05707465962):0.2559146019):0.6901713019):0.4684180651):0.2529704757,(((t332:0.2546846999,t333:0.2528130032):0.6833673227,(((t334:0.3643091078,(t335:0.05709653027,t336:0.05190395455):0.2943217153):0.2160234762,((t337:0.1457659472,t338:0.142181129):0.09135572242,t339:0.2334081512):0.3177808693):0.2812314601,((t340:0.3665025609,t341:0.3574416847):0.1788994955,t342:0.5246763147):0.2858869562):0.06969878916):0.891340279,(((((t343:0.02345569733,t344:0.02260955212):0.835510955,t345:0.8574471205):0.3605214744,((t346:0.1665933674,t347:0.1586190814):0.8300637535,((t348:0.4945868911,t349:0.4939292795):0.4422808528,(((t350:0.3698089136,(t351:0.3059868826,t352:0.2990636985):0.06286267079):0.0970742216,t353:0.4548364473):0.1920690723,((t354:0.4293262073,((t355:0.284424103,t356:0.2774109943):0.08875315643,t357:0.3609044137):0.0547147163):0.1636963411,t358:0.5564792666):0.04867632073):0.2723762163):0.04852715925):0.2208014025):0.2967853355,((((t359:0.1385940849,t360:0.1318760627):0.2157510806,((t361:0.01973590715,t362:0.01924847896):0.1418934685,t363:0.1603213145):0.1763780098):0.6990794027,(t365:0.8528940006,(t366:0.7259774719,(t367:0.4380016217,t368:0.4299953484):0.2849251038):0.1250917511):0.1611375973):0.1766477523,((t369:0.6180206922,t370:0.6106156323):0.3650724981,(t371:0.1267916245,t372:0.1250948006):0.8459316322):0.1918668924):0.2067869607):0.0783357354,((t373:0.1136513541,t374:0.1103495459):0.836050276,((t375:0.3714987435,t376:0.3685558555):0.5565568341,(t377:0.4287001578,t378:0.4285236725):0.4899271109):0.01255755428):0.4955933638):0.1767806842):0.1592974988):0.1784960923,((t379:1.043603339,(((t380:0.2479813398,t381:0.2383273174):0.5054182742,(t383:0.4807499405,(t384:0.4309227437,(t385:0.1576508119,t386:0.1536850262):0.2707604204):0.02775038265):0.2263165737):0.06069874943,((t387:0.03728563808,t388:0.02559327067):0.3454630595,(t389:0.03463093546,t390:0.03264328246):0.3359622396):0.3332247741):0.2204976571):0.8397154052,((t391:1.032815846,(t392:0.8689735682,(((t393:0.4966886688,(t394:0.08109336861,t395:0.07332437634):0.4110017068):0.0998425821,((t397:0.1048340603,(t398:0.09300443384,t399:0.08436876159):0.005226268309):0.09539907379,(t400:0.02535087199,t401:0.02439933698):0.1577351119):0.3799211205):0.1014718205,(t402:0.185824622,(t403:0.02737019691,t404:0.02470852972):0.156892297):0.4749727107):0.1675619712):0.1600628751):0.1285769405,(t405:0.628624019,(t406:0.1105571966,t407:0.1082973653):0.517400238):0.4824476268):0.5913774639):0.05308021644):0.2942704662):0.1904941923):0.6844313505):0.2839979414):0.1293321917):1.086276947);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T56.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
