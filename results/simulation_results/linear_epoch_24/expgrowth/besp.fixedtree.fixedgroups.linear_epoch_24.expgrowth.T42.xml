<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t440:0.9092831538,(((t441:0.1411844434,t442:0.1407113669):0.2233221263,(t443:0.2597776378,(t444:0.1842969668,t445:0.1723560904):0.07213475537):0.100095871):0.1621742028,(t446:0.4231366872,((t447:0.08596272747,t448:0.08458214309):0.1411197236,(t449:0.1384489841,t450:0.1251636107):0.0812635272):0.1916418426):0.07776797579):0.3717118159):0.2731689082,((t451:0.07214500418,t452:0.07092216931):0.5564356346,(t453:0.03627993321,t454:0.03549361596):0.5907587432):0.4776594888):0.08155934698,(t455:0.7466917759,(t456:0.2530675184,t457:0.2505394087):0.4825740574):0.4270431668):0.3220419831,(((t458:0.481308206,(t460:0.2720873988,(t461:0.06520466648,t462:0.06334733019):0.2045098914):0.1850222297):0.04801918267,(t463:0.1462929076,t464:0.1377121348):0.3488077996):0.3914555812,t465:0.8778549131):0.5613614507):2.103948446,(((((((t466:0.4046169721,((t467:0.1771055317,(t468:0.1589710555,t469:0.1400727554):0.0170767754):0.0672126068,(t470:0.07646475739,t472:0.04760805495):0.1115747978):0.1591492562):1.125956147,t473:1.442233004):0.0610180813,((t474:0.2782051742,(t475:0.05272343584,t476:0.05207404757):0.2234735865):1.1814756,((t471:0.01207993267,(t459:0.01643251754,((t370:0.004661637224,(((t302:0.003587286609,(t204:0.006106711836,t1:1.286378354):0.5453512017):0.1361269849,t2:1.959625667):0.3513690009,t3:2.310791511):0.01524255126):0.4522056342,(t4:1.53274281,(t5:0.9808827777,t6:0.9798533094):0.5436296909):1.24063919):0.07404852656):0.1093337097):0.4066344192,(((t7:1.630956978,t8:1.628634034):0.2881240708,(t9:1.279586335,t10:1.268892757):0.630715082):0.9699722804,(t11:1.189376915,t12:1.16832933):1.679959034):0.4550547628):1.065673818):0.04126584663):0.6807171346,(((((((t13:2.479255418,(((t14:0.7732232921,t15:0.7718503056):1.345069376,(t16:1.591699376,(t17:1.059386888,t18:1.055247907):0.5130602149):0.5188559433):0.3242510831,(((t19:1.69828494,((t20:1.541503428,t21:1.53738559):0.04675624223,(t22:1.036103502,t23:1.032685892):0.54611932):0.105530926):0.2424052559,(t24:1.213358728,t25:1.207201463):0.7130088563):0.1852072215,t26:2.102919022):0.2806993389):0.02681180123):0.005461956574,(t27:1.840510992,((t28:0.8538735889,t29:0.8442858558):0.4633640164,(t30:0.9940901766,t31:0.9912822157):0.309178023):0.5194911533):0.5675410854):0.07080517783,(((((t32:1.005995265,t33:1.000883981):0.9282840507,t34:1.922083425):0.07822942186,(t35:1.033842686,t36:1.026139509):0.9580280433):0.1011950982,(((t37:0.1138399087,t38:0.1123674191):1.655005895,(((t39:1.113273928,(t40:1.009150935,t41:1.001073726):0.09547972239):0.1118756359,t42:1.191823097):0.1044016549,t43:1.28720906):0.4375500404):0.21548342,((t44:1.065476115,t45:1.063386905):0.3636727235,t46:1.417971869):0.4983555917):0.09634453633):0.1605080423,(((t47:0.6371098356,t48:0.6292621458):0.1894057843,t49:0.8112261727):1.022842036,t50:1.828753973):0.3140858396):0.1769461053):0.1183777887,(t51:1.992148698,((t52:0.8956072547,t53:0.8756112871):0.2988984781,t54:1.159624844):0.7948549684):0.4429783126):0.005610919492,(((t55:1.645215008,(t56:0.2074405372,t57:0.2033022493):1.436675892):0.6399864948,(((t58:1.421986609,(t59:1.314609791,t60:1.311311445):0.1041116245):0.4616553539,((t61:1.236284557,(t62:1.035931957,t63:1.028086996):0.1974055167):0.03387866951,t64:1.259019172):0.6023370795):0.2488325678,t65:2.107750557):0.1242757631):0.05998261997,(((t66:0.7146528529,t67:0.7088497587):1.282576532,(t68:1.875070563,(t69:1.54237903,t70:1.539200786):0.3221579732):0.1113340068):0.01389500793,((t71:0.6674523028,t72:0.6662906458):1.083282219,(((t73:0.4207060311,t74:0.4106778555):0.9283918796,t75:1.334687714):0.0286040583,t76:1.359796898):0.3692478457):0.2340774877):0.2760950903):0.05413569748):0.3435742342,((((t77:1.064629387,t78:1.058789811):0.07101293459,t79:1.123833303):0.8105793091,(((t80:0.9855868859,t81:0.981575221):0.2145344315,(t82:0.524765257,t83:0.4991433366):0.6690284572):0.4495525427,(t84:1.297422027,t85:1.284600637):0.3189922646):0.2840236473):0.2124638399,(t86:1.921035109,((t87:1.255780079,t88:1.255507206):0.3028917231,(t89:0.2169573784,t90:0.215961234):1.327117769):0.3565972499):0.1713881081):0.4733549062):0.7602908462,(((t91:1.486682149,(((t92:0.9641362501,t93:0.9623889843):0.166875328,((t94:0.5743594065,t95:0.5678412272):0.2258328923,t96:0.7918987995):0.3265916):0.1164212524,t97:1.231391498):0.2384621676):0.5826736084,t98:2.036573786):0.2473178273,(t99:2.2455849,(((t100:0.4745947493,t101:0.4738533032):0.6169340648,(t102:0.2684087845,t103:0.2608345618):0.8168329007):1.111910176,(((t104:0.1159094008,t105:0.1158268475):0.7426673702,t106:0.8541818039):0.8695002798,(t107:1.650094994,(t108:1.261833465,t109:1.260827623):0.3719118189):0.07187154543):0.446167223):0.03788937619):0.03462204314):0.9809919165):1.29630403):0.4768216857,((((((t110:1.224978884,(t111:0.6727229869,(t112:0.6410460865,(t113:0.4276824706,t114:0.4235647657):0.2126247923):0.0273778164):0.547041104):1.174866506,(t115:1.53638048,t116:1.534627544):0.8472810419):0.6500027415,(t117:1.004135114,(t118:0.4686270426,t119:0.4670952327):0.5351258808):2.011917002):0.4628985644,(((((t120:0.8284690171,t121:0.82620379):0.4361932321,(t122:0.6902182327,(t123:0.6628120185,t124:0.662662446):0.02018643973):0.5710126912):0.4928400733,((t125:0.5216365016,t126:0.5183006881):1.195945302,t127:1.712500819):0.02717746891):0.1124031868,(((t128:0.2593911504,t129:0.2566339947):0.3578621408,t130:0.6067908302):0.661249507,t131:1.2673963):0.5702155008):0.07792022462,((t132:0.5682378773,t133:0.561523673):0.7695444603,t134:1.330349618):0.5712584214):1.520590444):0.5644039031,(((t135:0.8324967597,t136:0.8226308863):1.192091176,((t137:1.384491922,(((t138:0.1599810788,t139:0.1554907607):1.114712124,((t140:0.09133420286,t141:0.09077775945):0.5401771487,t142:0.6225617255):0.6373415199):0.07749244667,(t143:0.4939000499,t144:0.4894374504):0.8394972594):0.03195382038):0.580597007,(((t145:0.714281904,(t146:0.6296202635,t147:0.6232498505):0.08258696356):0.8526904257,t148:1.498872279):0.08974081047,((t149:0.1490289343,t150:0.1421360928):0.9348405954,t151:1.064477996):0.4959078273):0.2790247018):0.04626305589):1.947563231,((((t152:0.2844480901,t153:0.269719493):2.261772057,((((t154:1.586113826,(t155:0.778520155,(t156:0.7435921256,t157:0.7320035908):0.02563283925):0.7857207231):0.4302933365,t158:1.970267588):0.05046413513,(t159:1.49661409,((((t160:0.123430189,t161:0.1135385682):1.003759759,((t162:0.3748501646,t163:0.3470133802):0.6685306567,(t164:0.9949690275,t165:0.9942548123):0.01691798653):0.07126405617):0.02237873131,(t166:1.041270844,t167:1.04017854):0.0335572827):0.2553685836,((t168:0.6073323592,t169:0.6017446018):0.2579637911,(t170:0.8142037236,(t171:0.395149178,t172:0.3927803243):0.4059758084):0.04503984401):0.4599759797):0.08424261877):0.5151499224):0.3706745788,(((((t173:0.7000879445,t174:0.6990219061):0.05786710084,t175:0.756368575):0.3236959912,(t176:0.8232213455,(t177:0.2466453665,t178:0.2433779762):0.5526955839):0.2523652328):0.5379995848,(((t179:1.152561499,t180:1.151682247):0.1441796133,t181:1.289525264):0.2041359672,((t182:0.8144288732,t183:0.8120488727):0.1420791957,(t184:0.511334119,t185:0.505609414):0.4296734232):0.5362620791):0.08391625915):0.1757324899,((t186:0.4263200231,t187:0.4134858832):0.5757577587,(t188:0.04426716745,t189:0.03572604283):0.9407130621):0.7274285907):0.4735661472):0.09037069311):0.01454439345,(((((((((t190:1.090002732,(t191:0.78698243,t192:0.7864530986):0.2959929238):0.2017598506,t193:1.280836522):0.01599078169,((t194:0.4189313303,t195:0.4102864576):0.2908173057,t196:0.6748559979):0.5851455903):0.153773429,((t197:0.7461989696,t198:0.7427856086):0.2899098369,(((t199:0.3569419935,t200:0.3427689287):0.1420420985,(((t201:0.01951225225,t202:0.01763791915):0.08928865038,t203:0.09762693847):0.3603833096,t205:0.4387531127):0.01089592656):0.05116776312,(t206:0.4673011627,t207:0.465028653):0.03069379779):0.4803921881):0.3698436807):0.02803758272,t208:1.370253002):0.3979455207,((t209:1.261785035,t210:1.259964154):0.3601269002,((t211:0.7133547418,(t212:0.2660688412,t213:0.2529413994):0.4461210276):0.7199442468,(t214:0.08291473124,t215:0.07818080619):1.333986744):0.1770320946):0.1334069869):0.03393234486,((t216:0.2637575268,t217:0.2616236044):1.303591797,((t218:0.6608852202,(t219:0.4212808548,t220:0.4075581677):0.2364533231):0.8248532345,t221:1.465969532):0.07636794253):0.1871654124):0.0995409924,(((t222:1.479893208,((t223:0.03117483516,t224:0.02900961396):1.135665273,((t225:0.6834560241,t226:0.6805045958):0.2508866922,((t227:0.4942348152,t228:0.4930855379):0.3142503838,(((t229:0.06334285603,t230:0.04432184804):0.2187466604,t231:0.2614649988):0.3521145748,((t232:0.2937856361,t233:0.2830083171):0.002206738661,(t234:0.2713214626,t235:0.2664810905):0.01387808626):0.317347709):0.1694469683):0.1209459705):0.2272738711):0.3055160612):0.1142620994,((t236:0.8761930481,t237:0.8738922009):0.4525682284,((t238:0.5585251934,(t239:0.01767288286,t240:0.01577281028):0.539248413):0.6864369002,t241:1.238774915):0.0760351946):0.205885714):0.06030598069,(((t242:0.816204802,t243:0.8098957986):0.02374381076,(t244:0.7647778318,((t245:0.2853667971,t246:0.278294084):0.1874284544,(t247:0.06845232138,t248:0.06475522155):0.3958280578):0.2907423424):0.06710727365):0.6129089409,(t249:0.6605965794,t250:0.6557386427):0.7585869438):0.1267301471):0.1724790343):0.1523623252,((t251:0.674644506,(t252:0.4365344205,t253:0.4329545137):0.2269369395):0.7916423577,((t254:0.8570640372,(t255:0.418075279,((t256:0.1157201916,t257:0.103428455):0.1644474259,(t258:0.2503098144,t259:0.2470728771):0.004940543389):0.1125447435):0.4284448991):0.4936129517,((t260:0.6248223641,((t261:0.1786919777,(t262:0.1279672332,t263:0.12779073):0.03377937449):0.378494826,(t264:0.04877706052,t265:0.04536603586):0.490980872):0.04359963465):0.5269015621,t266:1.106428102):0.1278988047):0.09741426319):0.3919528923):0.1089041678):0.2660500144,(t267:1.625103501,((((t268:0.8530720361,(((t269:0.2574746316,(t270:0.09998553679,t271:0.09652009472):0.155123981):0.3187317292,(t272:0.0238247987,t273:0.0221476198):0.5462774955):0.01023283774,t274:0.5672206154):0.2593787198):0.06055350798,(t275:0.2793918334,(t276:0.2660328837,t277:0.2533847083):0.00835940163):0.6070714451):0.3038259199,((t278:0.2270760782,t279:0.2270127415):0.1478490993,(t280:0.0363483473,t281:0.03497241218):0.3356952956):0.7934475013):0.108477166,((t282:0.7910830811,(((t283:0.1483037485,(t284:0.09315819497,t285:0.09133363446):0.04861209455):0.02093329363,t286:0.1578874626):0.436522679,t287:0.5870162692):0.1842669361):0.4365348812,((t288:0.05305352879,t289:0.03917390136):0.1857641903,t290:0.2234295043):0.9628784268):0.04229919914):0.2930636002):0.467622912):0.9982073478):0.0140843231):0.5885185061,(((((t291:0.4446753527,(t292:0.3325531307,t293:0.3313586565):0.0894289437):0.3057285723,(t294:0.2319170023,t295:0.2242561724):0.4827990581):0.4425630952,t296:1.141760485):1.045270825,((((((t297:0.6140810741,((t298:0.06244364397,t299:0.05050862452):0.5026512298,(t300:0.2846985142,t301:0.2831167208):0.2657986916):0.03646261305):0.8543088363,((t303:0.4830719711,t304:0.4778016371):0.9180040839,((t305:0.8084928492,((t306:0.210627775,t307:0.1830482279):0.2561669678,(t308:0.15707764,t309:0.1549186443):0.2604035726):0.3231830769):0.2508192756,t310:0.9877440881):0.3237757257):0.02989667696):0.07975222857,((t311:1.111616544,((t312:0.7316898283,(((t313:0.4068580605,(t314:0.2458420911,t315:0.2374052554):0.1591336296):0.01342191402,(t316:0.3442228403,t317:0.3436210191):0.05857717856):0.07680976244,(t318:0.1823591676,t319:0.1702705262):0.2885729077):0.2131327294):0.355004984,((t320:0.6359631557,(t321:0.2008142961,(t322:0.06637017289,t323:0.05993468117):0.1269886016):0.4321603898):0.2931817587,t324:0.9050022349):0.09181596219):0.02112582766):0.1315712519,(t325:0.9759167716,(((t326:0.1950721287,(t327:0.09367549691,t328:0.08975140947):0.09068809465):0.3093836877,(((t329:0.2122655134,t330:0.2106501054):0.1853872901,t331:0.3845002495):0.00237961317,t332:0.3746363211):0.08948141496):0.2796596968,t333:0.7391394246):0.1748153289):0.1705798789):0.1669835884):0.2005378428,((((t334:0.1313646316,t335:0.1271850208):0.1054367345,(t336:0.02566574555,t337:0.02240184901):0.1923774633):0.004324852895,(t338:0.1958745836,(t339:0.1375017564,t340:0.1225383506):0.04735474669):0.02046253492):0.5429892174,(t341:0.2946566745,(t342:0.2753630897,t343:0.2681476541):0.01348549452):0.438193691):0.6676772502):0.03285130469,((t344:0.5106894133,(t345:0.1895719602,t346:0.1863580507):0.3186440992):0.0341222835,((t347:0.02162795589,t348:0.01745422816):0.3685670833,t349:0.384818213):0.1405361317):0.87047385):0.1409004648,((t350:0.5389319174,(((t351:0.01234642352,t352:0.007824694188):0.05533730413,t353:0.0596509481):0.2092245939,t354:0.2684075827):0.2414644284):0.8468422545,(((t355:0.1181854165,t356:0.1156026107):0.2255832141,t357:0.3392619336):0.1419675325,t358:0.4752591875):0.8623925603):0.1488928761):0.2635339086):0.6904098438,(((t359:0.5596120329,t360:0.5593918993):0.0406647817,(t361:0.4198050643,t362:0.4104075792):0.1697956118):1.616913835,((((t363:0.3767722351,t364:0.3524040753):0.3168202336,t365:0.6664285659):0.2455511746,(t366:0.1049018765,t367:0.1009947454):0.8022526332):0.9394067243,(((((((t368:0.02363036129,t369:0.01500901191):0.4691593266,(t371:0.3671916128,t372:0.3610380115):0.1000206454):0.5796448337,(((t373:0.2375272611,(t374:0.1650716208,t375:0.160941712):0.06877495942):0.0824468086,((t376:0.01189692111,t377:0.01101786115):0.2934844046,(t378:0.03092542557,t379:0.02977534735):0.2670115549):0.002534695657):0.7134447857,(((t380:0.3903632172,(t381:0.3145663576,t382:0.3129356611):0.07481553721):0.171215934,((t383:0.1718158762,t384:0.1625508423):0.2318131529,t385:0.3922094545):0.1534048867):0.04458920487,((t386:0.01563651159,t387:0.01180003797):0.3735104883,t388:0.3622744286):0.1981673365):0.3881667016):0.003632713867):0.1410449967,(((t389:0.2347451685,(t390:0.2207367977,t391:0.218721052):0.008474896222):0.1903215197,t392:0.4155134886):0.536504388,(t393:0.2588471173,t394:0.2559719521):0.6923530249):0.1314559363):0.007721093813,(t395:0.5942119712,t396:0.5938260427):0.4926256464):0.1727910704,((t397:0.2984132818,t398:0.2866630889):0.2711977599,t399:0.5478911159):0.6770571407):0.3047009181,(((t400:0.02765310861,t401:0.02594279707):0.04212967952,t402:0.06694683705):0.4431663764,(t403:0.4598735918,((t404:0.08391880835,t405:0.06463029891):0.3056528681,t406:0.3683863871):0.06884988661):0.0456473695):1.001245135):0.1251551695):0.3157630178):0.2204747928):0.6572784095):0.3117089923):0.3641477536,(((t407:1.199159814,((t408:0.5823115801,((((t409:0.1844985553,t410:0.1836872056):0.1957272491,t411:0.3776488441):0.06929261588,t412:0.4452030905):0.1260074433,t413:0.5645345814):0.0003497713751):0.2662085122,(((t414:0.08445347456,t415:0.08332443473):0.04630162509,t416:0.1251642445):0.4136329409,(t417:0.5136289771,((t418:0.02103608928,t419:0.01648912809):0.4430912346,t420:0.4410509048):0.04791323094):0.01480137224):0.2743727245):0.3496923057):0.2917868426,(t421:1.039629738,t422:1.035972472):0.3683116414):1.035424471,((((t423:0.02133004868,t424:0.01587861005):0.5190023012,(t425:0.1574016067,t426:0.1502688764):0.3717776912):0.752064642,((((t427:0.1640849783,t428:0.1579419031):0.6812713757,(t429:0.5037831638,t430:0.4905189903):0.3252182812):0.05961490392,(t431:0.3720847716,(t432:0.0822612455,t433:0.07792830084):0.2835732848):0.4875485762):0.3421381647,(t434:0.2746868388,t435:0.2674690148):0.8970355386):0.02582719461):0.01622800241,(t436:0.7930180138,(t437:0.4458926622,t438:0.4451135124):0.346282306):0.4088213965):1.129981801):0.9506960458):0.2524011327,t439:3.526222386):0.1705932425);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T42.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
