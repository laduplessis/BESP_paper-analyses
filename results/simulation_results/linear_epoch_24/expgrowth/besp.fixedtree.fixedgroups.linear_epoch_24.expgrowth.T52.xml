<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t325:1.586586533,((((t326:0.7468530162,(t327:0.7238047647,(((((t328:0.009558145827,t329:0.009338208878):0.1076466536,t330:0.1165792228):0.1631342757,t331:0.2795454972):0.06083213187,(t332:0.2371249534,(t333:0.2004231601,(t334:0.1672661415,t335:0.1671057641):0.02449525474):0.03521692479):0.1011865437):0.1364070049,(t336:0.111346345,t337:0.09562421249):0.3489196778):0.2438857838):0.01896204666):0.2582050903,((((t338:0.05991414595,(t339:0.02666749901,t340:0.02499713487):0.01021706424):0.03767994716,t341:0.06400351909):0.03532340435,t342:0.09297625881):0.3738362599,t343:0.4658931574):0.4429302573):0.1984856861,t344:1.105656372):0.3053689448,(((t345:0.1335313696,t346:0.1327025194):0.3804660183,(t347:0.463475662,t348:0.4617109794):0.04802481935):0.1059390388,(t349:0.3486465438,(t350:0.2255372165,((t351:0.02752735598,t352:0.02328436855):0.1559339724,t353:0.173873143):0.03804475476):0.1206433928):0.2646517363):0.7873102739):0.07172966):0.525822352,((((t354:0.8009988939,((t355:0.2843290559,t356:0.2807936073):0.2849445567,(t357:0.2646729023,t358:0.2512515173):0.2938488921):0.2179320481):0.06939265245,(t360:0.1349291533,t361:0.1247739902):0.6722787235):0.1675828984,(t362:0.6601473866,((t363:0.3327456295,(t364:0.2985409295,t365:0.2984391972):0.005106875511):0.3043476913,((t367:0.1476105914,t368:0.1448641715):0.2786477244,(t369:0.3780490352,(t370:0.1343832726,t371:0.1187253958):0.2409797884):0.04178397485):0.1483020865):0.008342210784):0.2889392932):0.1628146855,t372:1.007932892):0.7724896269):0.8209608593,((((t373:0.1981484312,t374:0.1909969329):1.01789017,((((t375:0.1576257357,t376:0.1434110954):0.3375407353,(t377:0.2844007154,t378:0.2827857545):0.1909911552):0.1953601072,(((t379:0.5070168683,((((t380:0.05067557501,t381:0.05052863672):0.2227043275,t382:0.2717582032):0.04877026515,t383:0.2985318724):0.09890939881,t384:0.393455169):0.08126035746):0.05142525305,((t385:0.2664689684,(t386:0.2521198139,t387:0.2237500238):0.01046909844):0.1136894679,((t388:0.03006897691,t389:0.02418301815):0.136959848,t390:0.1573292653):0.1771151249):0.1455558897):0.02446178141,t391:0.5022079084):0.07851147305):0.2500755502,(((t392:0.04159902499,t393:0.04037538307):0.05431479448,t394:0.08622450259):0.2703532963,(t395:0.252681886,t396:0.2235501249):0.09268546999):0.4556150832):0.2648880344):0.2518850217,(t397:0.6711403967,t398:0.6694227217):0.6116947003):0.4830721709,((t399:0.4539324028,(t400:0.3070495551,t401:0.3033022235):0.1412898791):0.01873238185,((t402:0.03540723981,t403:0.02798576372):0.1669891549,(t404:0.1897936948,(t405:0.1412157909,t406:0.139952198):0.0478488074):0.004192092402):0.2564096329):1.283027375):0.6339219168):0.8921602605,((((((t407:0.5276473028,((t408:0.2892455811,t409:0.2810336668):0.05872430006,(t410:0.3269170377,t411:0.3192867814):0.006751597453):0.1656447906):0.1093907215,(t412:0.5867230467,t413:0.5862235763):0.01318067219):0.1137390773,(t414:0.2973109908,(t415:0.2692120649,t416:0.2622555383):0.01473524757):0.4139631885):0.05670184306,t417:0.7403211245):0.8269508926,(t418:0.503316488,((t419:0.3694785701,(t420:0.2142799612,(t421:0.05599518227,t422:0.04346822539):0.1533195676):0.1468979317):0.08488579742,(t423:0.05800984475,t424:0.04934740711):0.3702434639):0.0440151697):1.058350344):0.9297280677,((((((t425:0.1047648501,t426:0.1037240869):0.4083724003,(t427:0.2983028786,t428:0.2980788449):0.2125886582):0.3343687249,((t429:0.01447479261,t430:0.01394274904):0.6730323373,t431:0.683224692):0.1541344269):0.7308269194,(((((t432:0.2834845685,(t433:0.01447375856,t434:0.01300903126):0.2552150079):0.04665102556,(t435:0.1783763434,t436:0.1690850894):0.1227867286):0.01454462215,t437:0.3022071634):0.4271564565,(((((t438:0.00469237299,t439:0.003818280624):0.1206673202,t440:0.110756522):0.1790993547,t441:0.2760659136):0.1292997429,t442:0.4045234878):0.2627866274,(t443:0.4533006354,((t444:0.2018513184,t445:0.2007645331):0.02312728974,t446:0.222412672):0.2258140063):0.203469044):0.02707572132):0.5140216045,((t447:0.1239532479,(t448:0.05900677463,(t449:0.01688254021,t450:0.01609921029):0.02888623254):0.06482633009):0.4617613635,t451:0.5684338503):0.587372444):0.2717158107):0.2686544847,(t452:0.4726370346,((t453:0.1613278373,t454:0.1587097447):0.137681914,(t455:0.1386084852,(t456:0.08549972582,t457:0.06883321143):0.04705241628):0.1554223502):0.1717078529):1.22073575):0.3932260217,(t458:1.530674515,t459:1.53025692):0.5232639211):0.2086791898):0.6871557182):0.7140868006,((t460:2.277395187,((((t461:0.07029647884,t462:0.06514998613):0.1046060909,((((t366:0.01581453922,((t359:0.01229432273,(t1:1.822352128,(t2:1.768539411,(t3:1.5258382,(t4:1.13816376,t5:1.13591113):0.3824841866):0.2366947352):0.02665413355):0.4603919417):0.06782915902,t6:2.308164569):0.03859295728):0.11823735,((t7:1.706013846,t8:1.703674034):0.1786180124,(t9:1.124852859,(t10:0.8419988148,t11:0.840849424):0.2828187049):0.7562288233):0.5750740152):0.4843525982,((t12:0.5509389854,t13:0.5454643168):2.303113406,((t14:1.833556591,t15:1.831097205):0.7641366242,((t16:1.730799506,(t17:1.028085939,t18:1.014697713):0.6862909752):0.6042819343,(((t19:1.40361758,t20:1.39993426):0.654320451,(t21:0.5025418773,(t22:0.3986021116,t23:0.3961719138):0.1006578789):1.542530341):0.064622563,((t24:1.391000083,(t25:1.38443442,(t26:0.3159036307,t27:0.3151149565):1.058305355):0.006303025616):0.1023274165,(t28:0.1115983023,t29:0.1063210728):1.369824479):0.6008958833):0.1513455976):0.2512352741):0.2404969002):0.08327591584):0.1523147865,((t30:0.9873328736,t31:0.9859068978):1.684654251,((t32:0.473921941,t33:0.4636807918):1.695928484,((t34:1.365324733,t35:1.340014326):0.6362133706,(t36:1.032655349,t37:1.031004558):0.939854972):0.1539324827):0.4975304336):0.2790861384):0.006489762448):0.2711066658,((t38:1.393623699,(t39:0.2869349569,t40:0.2864063437):1.089109758):1.205320893,((((t41:1.469471837,(t42:1.371530006,((t43:1.100666832,t44:1.098209917):0.1620646341,t45:1.256097915):0.1057944886):0.07272697041):0.2520553655,(t46:1.022585795,t47:1.009910552):0.6530112213):0.2938421179,(t48:1.543253129,t49:1.542904549):0.4121934884):0.5414013827,(t50:1.860726685,t51:1.85870877):0.6289023367):0.02115405005):0.5790392109):1.586621641,(((((t52:0.8073183737,t53:0.8071612148):1.113942603,(t54:1.770898389,t55:1.769561528):0.1348764474):0.273244646,(((t56:1.220800861,t57:1.201575285):0.7766224807,((t58:1.788296336,(t59:1.44362732,t60:1.44124637):0.3341799809):0.1457146317,t61:1.920314005):0.03606366337):0.01862683324,t62:1.971287076):0.1475831628):1.16963346,(((((t63:1.87361956,(((t64:1.20796993,(t65:1.161565871,(t66:0.07751004456,t67:0.07328022216):1.073849189):0.0395980775):0.003255576143,t68:1.187506482):0.2838369392,t69:1.454582793):0.3645789122):0.2029579901,(t70:1.605475547,t71:1.604266905):0.4021719102):0.1166746041,(t72:1.199609753,t73:1.193884434):0.9147544811):0.6107036168,((((t74:1.641318466,(t75:1.602750947,t76:1.598602719):0.02130364228):0.3441199765,((t77:1.337814985,t78:1.335331308):0.2175903205,(t79:0.9403792239,t80:0.9358564269):0.6101595463):0.3989210309):0.08317258662,((((t81:0.4713443717,t82:0.4640143851):1.011060389,t83:1.471549762):0.3570093115,t84:1.827532619):0.06593484196,(t85:1.134959519,(t86:0.4281186766,t87:0.4215977139):0.7026415014):0.7368623589):0.1136071409):0.1434982469,((((t88:0.6216375498,t89:0.6131772553):1.060968402,t90:1.673972309):0.2333389416,((t91:0.9025530946,(t92:0.06927739537,t93:0.06184139922):0.8310992003):0.6555676979,t94:1.546679317):0.3441679936):0.1391771784,(t95:1.271914733,(((t96:0.5728166816,t97:0.5727306693):0.5371639013,t98:1.094616419):0.1101570466,(t99:0.6954536026,t100:0.6907735266):0.5085416092):0.03803209197):0.7485603214):0.05560465565):0.4892683452):0.4447386927,(((((t101:0.9848326344,t102:0.9800486441):0.4055206189,(t103:1.30143883,t104:1.296400726):0.08300004943):1.287180598,(t105:0.644946333,t106:0.6384213505):2.010933068):0.04060280964,(((((t107:0.764557399,t108:0.7480317988):0.6471198524,t109:1.390152438):0.3661376947,t110:1.748764269):0.4413557681,(((t111:0.8835809304,t112:0.88291574):0.1703210116,((t113:0.2357913437,t114:0.2307209005):0.7121690739,t115:0.924365987):0.09549975891):0.7827329855,(((t116:0.5844469591,t117:0.5730044806):0.5874614662,t118:1.15306827):0.3038511167,(t119:1.30235741,((t120:0.2687924278,t121:0.2663987823):0.9027185519,((t122:0.1982191975,t123:0.194100065):0.206150595,t124:0.3960022626):0.7644002228):0.1298027298):0.1472162227):0.3213325224):0.3399957802):0.2645740623,((((t125:1.328033319,(((t126:0.3972084976,t127:0.3962777952):0.6147417893,t128:1.0106549):0.03770530959,t129:1.046031746):0.2721776816):0.2760640172,t130:1.593251364):0.1591461257,(((t131:0.1942049453,t132:0.1921503086):0.7294437978,t133:0.9177788847):0.09319001893,t134:0.9843838246):0.727467099):0.3957390641,((t135:1.262136238,(t136:0.8096933479,(t137:0.3724266762,t138:0.3684702566):0.4370890719):0.4505782071):0.2332001124,((t139:1.241336562,(t140:0.8226884714,t141:0.8225559814):0.4099177153):0.1558446684,((t142:0.6681015455,t143:0.6579306136):0.4880114496,(t144:0.842088555,(((t145:0.2151686342,t146:0.2107711055):0.02147183682,t147:0.2308216374):0.4490272282,(t148:0.5538255244,t149:0.5532723909):0.1217079018):0.1547465958):0.3005643786):0.2167996147):0.07882323424):0.6107384739):0.1924433112):0.1944550534):0.1405005605,((((t150:1.304471936,t151:1.296290537):0.7743110086,(t152:1.156305859,t153:1.148524616):0.9027414158):0.1075393893,((t154:1.926077188,((t155:0.1477859558,t156:0.1403385126):1.670967788,(t157:1.413907093,(((t158:0.020011308,t159:0.01243434163):0.1813574535,t160:0.1853544322):0.08236769523,t161:0.2670194246):1.130080238):0.3892905555):0.1009641869):0.1870550111,(((((t162:0.8943833476,t163:0.8936019571):0.01157109308,((t164:0.5554981253,t165:0.5518408244):0.3369053466,t166:0.8776452493):0.01186033639):0.3074713474,((t167:0.7517765528,t168:0.7212740992):0.1192293708,(t169:0.1720522802,t170:0.1625856848):0.6681557535):0.322233635):0.4605946072,(t171:0.7518670208,t172:0.7415741147):0.8603956735):0.3230018659,t173:1.910850188):0.07540339401):0.04094941291):0.302223698,((t174:1.712374611,(((((t175:0.6999559225,t176:0.6910333689):0.04201163475,(t177:0.2445044279,t178:0.2381530059):0.4816180153):0.0267127891,t179:0.7419772175):0.03718063123,((t180:0.6165276469,t181:0.6158251797):0.1188614903,(t182:0.0536647878,t183:0.04981504766):0.6793202773):0.03885373116):0.468634823,(((t184:0.6019434591,t185:0.595483276):0.4225546862,((t186:0.03412726422,t187:0.03161732034):0.3216967276,t188:0.3486086339):0.6604452178):0.00611201073,(t189:0.7930546732,t190:0.7810484841):0.2138299184):0.2041445315):0.4060341608):0.5933968033,((((t191:0.7166775968,((t192:0.09161383549,t193:0.08675352578):0.03335971496,t194:0.1144311902):0.5871231747):0.3256562745,(t195:0.5688031206,(t196:0.4685694864,t197:0.4666100855):0.0948406782):0.448555824):0.6090300361,t198:1.603787766):0.169229926,(t199:0.7356395519,t200:0.7309605328):1.029196257):0.3766988329):0.02207697567):0.07361135593):0.112198598):0.03706315432):0.8455761087,(((((t201:0.436300325,(t202:0.3936089845,(t203:0.1485829774,t204:0.1441676574):0.2412196311):0.04252226238):0.7503877805,(t205:0.7753437827,((t206:0.1650264344,t207:0.1620396975):0.3405219424,((t208:0.1195399895,t209:0.1182808846):0.3518262424,t210:0.468274351):0.01283953703):0.2630029131):0.397286497):0.3064459716,(t211:0.3348412338,t212:0.3338817507):1.112584046):0.7114701733,(((((t213:0.5139590487,t214:0.5137357012):0.6146397907,(t215:0.2461045273,t216:0.2404307104):0.8805141741):0.3074973799,t217:1.428137335):0.002175166927,t218:1.424639464):0.2599252444,((t219:0.5704524075,(t220:0.3032768391,t221:0.3012351771):0.2643436192):0.5389942577,(t222:0.6708416117,(t223:0.3105157963,t224:0.3097766258):0.3496656667):0.4208201716):0.57182493):0.4594359644):0.759403863,(((t225:0.8158591922,((t226:0.5993178701,t227:0.5967582524):0.02132107579,t228:0.6172891386):0.180702626):0.4636407847,t229:1.253363273):0.480686406,((((t230:1.070236787,((((t231:0.01936364126,t232:0.01211683937):0.03054726394,t233:0.0353080714):0.8528855315,t234:0.8873361981):0.09074668155,t235:0.9774963807):0.07345252287):0.4869599957,((t236:0.2427037276,t237:0.241986062):1.294934951,(((((((t238:0.005040585137,t239:0.0002167734352):0.1142452024,t240:0.1050928688):0.02367124176,t241:0.1220844853):0.2605423182,t242:0.3672403304):0.07678893988,(t243:0.4144962054,(t244:0.1294302007,t245:0.1273235275):0.2847625011):0.02897965249):0.03509460421,t246:0.4746542932):0.2305156609,t247:0.6974595187):0.7897001311):2.176282387e-05):0.1304301575,(((t248:0.4664547717,t249:0.4614824786):0.07232512448,t250:0.5310259665):0.1603757877,t251:0.6867791435):0.9029507566):0.02870396751,((t252:0.2725627421,t253:0.260682687):0.3389068636,t254:0.5925993103):0.9911764971):0.007201023228):1.102095805):0.2504815859):0.4638482156):0.2430824101):0.867201568,((((t255:0.4829123223,(t256:0.3532392349,t257:0.3526862307):0.1265193755):0.1578730474,t258:0.6354277769):0.5760913041,t259:1.19936007):2.237994592,((((t260:1.873835488,(t261:1.031073986,((((t262:0.4758870017,t263:0.4714860337):0.05598260352,t264:0.523425536):0.2858648537,t265:0.806627913):0.05298750462,(t266:0.7495426105,t267:0.7489531298):0.1081297075):0.1435911996):0.8357763572):0.5455579562,((t268:0.5094849309,(t269:0.1427254588,t270:0.1396146318):0.3655433182):1.156839478,(((t271:0.9478285049,t272:0.9333666093):0.2346626842,((t273:0.1866765459,t274:0.1800228633):0.6178962447,(t275:0.5311057404,t276:0.526502486):0.2638550375):0.3569697553):0.1430707335,((t277:0.09621788949,t278:0.08200052172):0.2477837937,t279:0.3241960131):0.9380518587):0.3323182256):0.7086142674):0.3347699067,((t280:0.8428254675,((t281:0.7975896034,(t282:0.1644476258,t283:0.1535587295):0.6322032451):0.0211030835,t284:0.8063413926):0.01111323942):0.8683809927,((t285:0.3925977073,t286:0.3890401035):0.1338501322,((t287:0.1442840162,t288:0.1383701278):0.1102414728,t289:0.2465449338):0.261168174):1.151873208):0.9265322921):0.5384454868,((((((t290:0.6779921566,(t291:0.3735525722,(t292:0.1034547776,t293:0.09347253552):0.2559986185):0.3042627045):0.04995686196,(t294:0.1981997044,t295:0.1971328304):0.5051371857):0.3668176452,(t296:0.7739864461,(t297:0.7313167136,(t298:0.2832677068,t299:0.2761447448):0.4449867702):0.01582177434):0.2826308357):1.076830347,((((t300:1.026843626,(((t301:0.2156196867,(t302:0.01227792985,t303:0.005921221236):0.2027529996):0.3252289211,t304:0.5302139494):0.3331062358,(t305:0.7153609599,(t306:0.007540446633,t307:0.006561615024):0.7002252931):0.1429219007):0.1183548691):0.0252292489,(t308:0.3990867635,t309:0.397705015):0.5732701117):0.2831568816,(((t310:0.123077256,t311:0.1227231329):0.1132804847,t312:0.2238026599):0.4575487433,t313:0.6801184924):0.5591618156):0.5307487428,(t314:1.110781455,((t315:0.02004323366,t316:0.01947340898):0.252779177,t317:0.2693241248):0.8324791115):0.6531088145):0.2140413631):0.006938327165,(t318:0.9781538023,t319:0.9766880924):0.9957385857):0.380681909,(t320:0.5893179419,((t321:0.4168676376,t322:0.4068943624):0.1211963229,(t323:0.4054292048,t324:0.4041882202):0.116655112):0.02882241238):1.759372204):0.5380439966):0.1392493187):1.057960021):0.5052527599);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T52.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
