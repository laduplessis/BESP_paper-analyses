<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t249:0.5728788405,((t250:0.4213094837,t251:0.4143988209):0.05355671535,((t252:0.2339809209,(t253:0.1862362574,t254:0.1822683993):0.0389288919):0.05030110495,t255:0.2611328083):0.1777238698):0.09639332194):0.4580224783,(t256:0.1316775193,t257:0.1299630231):0.8505200338):1.579640554,(((((((t258:0.1525651929,t259:0.1512869641):0.01266224766,t260:0.1602620797):0.002008507213,t261:0.1579130083):0.9414719223,((t262:0.6284354839,((t263:0.09329474128,t264:0.09264937764):0.3844225555,(t265:0.02685422035,t266:0.02466526194):0.443968594):0.1456421277):0.02572912015,(t267:0.5392753294,t268:0.5383503121):0.08851555678):0.4441391021):0.4649271928,((((t269:0.1183644681,t270:0.1148930883):0.3848270509,t271:0.4972581649):0.1450737037,(((t272:0.1104738707,t273:0.1090902977):0.1373744203,t274:0.2432894494):0.327358471,t275:0.5621937528):0.05667015163):0.7992872516,((t276:0.1144740521,t277:0.1025089389):0.4876291107,((t278:0.1701842037,t279:0.1678254243):0.1070935349,(t280:0.08739292475,t281:0.08664629377):0.1767853504):0.3102931999):0.800775046):0.08224366584):0.3878783893,(((t282:0.07905443977,t283:0.06929807526):0.6781958848,(t284:0.07635062711,t285:0.07379664081):0.6709241577):0.05792494929,(t286:0.2288396576,t287:0.2125182452):0.5694879371):1.024138527):0.5920449682,((t288:1.514340028,(t289:0.9103558168,(t290:0.2521787502,t291:0.2520635591):0.655624704):0.5984814585):0.5624574032,(((((t292:0.1124810152,t293:0.1109652652):0.7515074452,(t294:0.3995822604,(t295:0.1152955387,t296:0.110460175):0.2709376998):0.4492397339):0.04357360122,((t297:0.3230145928,t298:0.3228128667):0.4307121204,(t299:0.7247493833,t300:0.7093286517):0.02455498341):0.1194919022):0.4600493804,(t301:1.000485353,(((t304:0.01791431405,t305:0.004080299103):0.1835599127,t306:0.1659492515):0.5992355283,(t307:0.1830837252,t308:0.178576989):0.5716746791):0.1423351447):0.3122286912):0.0832403551,((((t309:0.1128148931,t310:0.1121284681):1.025930682,(t311:0.8214665918,(t312:0.0593950655,t313:0.05514610401):0.7610872293):0.2984931087):0.01904559983,((t314:0.4112532262,t315:0.4086085482):0.1738918967,(((t316:0.02932446175,t317:0.0268448241):0.05196013109,t318:0.06190637316):0.260881342,t319:0.3197415749):0.2304522454):0.5483117293):0.09149857752,(t320:0.6349570553,(((t321:0.1581045453,t322:0.1469489539):0.2869364546,t323:0.4307980852):0.08569494078,((t324:0.1305894823,t325:0.1221398938):0.1179646397,t326:0.2388601797):0.265812145):0.1014281161):0.5449856386):0.03029482486):0.6058041625):0.3181487505):0.004428720093):0.423867634,(((((t327:0.8304311702,((t328:0.3968133119,(t329:0.3408355579,t330:0.3381044279):0.03608446894):0.0914430147,t331:0.4489420422):0.3388651296):0.1896251297,(t332:0.3589594223,(t333:0.1258242474,t334:0.1240860148):0.2309383615):0.5963005876):0.05390508191,((t335:0.2282929336,(t336:0.1576584058,t337:0.1526549135):0.06710751679):0.2355385536,t338:0.4534018822):0.5406540662):0.7069246208,((((t339:0.1716261877,t340:0.1712299896):1.131145045,(t341:0.7709538419,((((t342:0.04586366466,(t343:0.01530098708,t344:0.01499943828):0.0286099942):0.3856405989,t345:0.4191745488):0.02466305561,(t346:0.4327089264,t347:0.4239677347):0.004983332819):0.1754024247,(t348:0.159748827,t350:0.1450896881):0.4389670965):0.1346094588):0.5099401226):0.1095567907,((t351:0.4368910141,(t352:0.05281965108,t353:0.05225235325):0.3780183164):0.8066218047,((((t354:0.04215423495,t355:0.03725750168):0.2766827121,(t356:0.2742080744,t357:0.271938317):0.03946087371):0.007048872358,t358:0.3117008924):0.1844341095,(t359:0.4410959901,t360:0.4269224623):0.04226661724):0.7198680937):0.0815218625):0.09008221603,((((t361:0.2979285126,t362:0.286664945):0.01909339616,t363:0.2904677515):0.1468227214,((t364:0.2128463982,(t365:0.01468036568,t366:0.01119993353):0.1895446939):0.03320614714,t367:0.2158057209):0.1825447164):0.3648686526,t368:0.7594711518):0.5214325543):0.1949143376):0.434208351,t369:1.906206627):0.316871188):0.9803725989,(((((t370:0.920154796,((t371:0.08366947493,t372:0.08291183674):0.3785253834,((t373:0.1203437185,t374:0.1012944304):0.1879271285,(t375:0.1646788249,t376:0.1589890894):0.1094324674):0.1395943853):0.4579027744):0.1032515373,((t377:0.4199457547,t378:0.4197362441):0.02888819282,t379:0.4351108424):0.5143683562):0.8716275879,((((((t380:0.1387755074,t381:0.1386829825):0.3416210658,(((t382:0.04131536703,(t383:0.01179273261,t384:0.003460326473):0.01514241208):0.1185811251,t385:0.1316510714):0.2023409725,t386:0.3331594694):0.1010862361):0.04149892893,t387:0.4705008665):0.4201131576,t388:0.8889589004):0.1008029947,(t389:0.2371325056,t390:0.2306759602):0.7425114249):0.1609955811,t391:1.120660224):0.6096832115):0.2562542658,(t392:1.798709239,(((t393:0.2378648615,t394:0.2222201608):0.1303382,t395:0.3313312848):0.792958167,((((((t396:0.2429853039,t397:0.2374940499):0.2121817041,(t398:0.1457998621,t399:0.1322275019):0.3000861961):0.006449879089,t400:0.4315363062):0.0134571561,(t401:0.1280521929,t402:0.1036886395):0.3144969938):0.1857070851,((t403:0.4177504675,(t404:0.2165972634,t405:0.2137467353):0.1832570047):0.1019297636,t406:0.4965093178):0.07257692325):0.2084313302,(((t407:0.06264362043,t408:0.05760580946):0.06040135824,t409:0.1116613866):0.2695775734,t410:0.3725472392):0.3798059119):0.2463292085):0.6252139934):0.1869318192):1.04817703,((((t412:0.07940664514,t413:0.05611132914):0.6356884857,(t414:0.1554077525,t415:0.1538964337):0.5295234462):1.378231962,(t416:1.083034877,((t417:0.3042534035,t418:0.3037978397):0.2522869191,(t419:0.2719251888,(t420:0.0328654925,t421:0.007083425406):0.233508247):0.277350667):0.5177801185):0.9676085961):0.07025786649,((((t422:0.4104001846,t423:0.4035093644):0.1396769776,t424:0.5279204777):0.294550652,(t425:0.3958924788,(t426:0.009314215655,t427:0.006663207139):0.3836346496):0.3971748616):0.2418702239,t428:1.02155015):0.9686130156):0.6721202703):0.003650670871):0.6862867157,(((((t411:0.002373494547,(t349:0.01166558875,(t302:0.02088736165,(t303:0.01152765885,t1:1.941139109):0.00607577311):0.3482340495):0.5084891649):0.1837668138,(((((t2:0.5535665456,t3:0.546068362):0.9890557623,((((t4:0.02185549832,t5:0.01826818716):0.8456756696,t6:0.8586017341):0.2394773265,t7:1.09625764):0.07393676663,t8:1.162585403):0.3470120899):0.270016048,(t9:0.4501374114,t10:0.4447421859):1.329058103):0.760157844,(t11:2.383899615,((t12:0.9161117855,t13:0.9101085649):1.327428687,t14:2.235024406):0.1269633352):0.1483395028):0.4031932926,((t15:1.04841955,t16:1.047145467):1.264176078,((t17:1.068115493,t18:1.053519629):0.1616222319,t19:1.215084982):1.066794373):0.598297379):0.00600164688):0.4527635787,(((t20:1.641705351,t21:1.614916585):0.6599482396,((t22:1.156422202,(t23:1.086102845,(t24:0.260635672,t25:0.2582127111):0.8166580654):0.06541346835):0.7533875835,(t26:1.701480166,(t27:1.53363444,((t28:0.3278860452,t29:0.3228343725):1.047095947,t30:1.36523083):0.1526566582):0.1673163345):0.1914229272):0.3628893233):0.603095132,((t31:0.8457754539,t32:0.8191107097):1.306839401,(t33:1.780447547,(t34:1.600647961,((t35:0.660198583,t36:0.6543802519):0.7591573401,t37:1.407248359):0.1679505382):0.1740749366):0.3383359811):0.6861754561):0.4211412957):0.303602938,t38:3.484285097):1.671187105,((((((t39:0.9942655453,t40:0.9878484528):1.035016176,((t41:0.685625558,t42:0.6849952111):0.3302106331,t43:1.014715724):1.00402987):0.1099999566,t44:2.122391442):0.3888783746,((((t45:1.132398101,(t46:0.1655191639,t47:0.1482918584):0.9534889159):0.2717474308,t48:1.362570373):0.07249650839,(t49:0.770893192,t50:0.7660449406):0.6586796134):0.005300677374,t51:1.429733086):1.025148708):0.4605559923,(((t52:0.4395860075,t53:0.4299959486):0.8006112718,(t54:0.9173822302,t55:0.9078315808):0.3074833756):0.3775190333,(t56:0.9301334847,t57:0.9292939332):0.6591645813):1.295929874):0.5014777364,((t58:2.282267128,((t59:1.990334317,(((t60:1.115854999,t61:1.112493454):0.4892311364,((t62:0.7981303939,t63:0.790537562):0.001858162647,t64:0.789398518):0.7845221337):0.3371831895,t65:1.904308943):0.02822461356):0.1234097254,((t66:1.283320916,t67:1.277059386):0.1569222913,(t68:1.227694555,((t69:0.366835693,t70:0.3586057685):0.6412840899,(t71:0.6717234992,t72:0.6612588006):0.3281272054):0.2184614944):0.1927402624):0.6068194567):0.1674573627):0.3251163761,(t73:2.084919739,(((t74:0.9253420787,t75:0.918167007):0.1282578142,t76:1.046072242):0.2832720211,t77:1.324193518):0.7478878867):0.4012448255):0.7733042945):1.661651372):0.9236573357):0.9095414562,((((((t78:1.132831879,t79:1.128512756):1.099745703,t80:2.222725674):0.411038327,((((t81:1.049683143,(t82:0.9152219071,(t83:0.7515246705,t84:0.7509504845):0.1586839493):0.129019895):0.7324636438,((t85:1.221110915,(t86:0.6294197525,t87:0.6222850591):0.5902786438):0.5072425551,t88:1.717621354):0.041399442):0.02912462225,t89:1.776458254):0.7680818515,(((t90:1.688247489,(((((t91:1.103948562,t92:1.085976047):0.4596897197,((t93:0.2463015374,t94:0.2353848448):0.9927475834,t95:1.224808036):0.2952123812):0.00334428027,((t96:0.5634913399,t97:0.5629305665):0.2853117557,t98:0.8388763428):0.6674760936):0.04596123787,t99:1.528257129):0.04746280215,t100:1.574501912):0.0210620671):0.002014645781,t101:1.595964533):0.08308799403,(t102:0.3235573994,(t103:0.3171555483,t104:0.3142972372):0.004315579416):1.355460422):0.7692432609):0.04323208534):0.1700686768,t105:2.656390224):2.278854411,(((t106:3.077199119,((t107:1.665706707,(t108:0.9980257471,((t109:0.4535675815,t110:0.4518083009):0.3851126179,t111:0.833631558):0.1586099541):0.6666708238):0.5585226613,(t112:1.875264211,(t113:1.704321624,t114:1.70288053):0.1695393973):0.3370713332):0.8484983372):0.2208412845,(((t115:1.75755268,(((t116:1.177718349,t117:1.163145003):0.1080241451,((t118:0.849672794,t119:0.8426481992):0.01614386633,t120:0.8513080654):0.3990564017):0.2384909283,t121:1.471465069):0.2322759618):0.4909118271,(t122:0.3808542043,t123:0.3767209553):1.813409853):0.1384423492,(t124:1.673182075,(((t125:0.5193580196,t126:0.5113948681):0.3270775631,t127:0.836647961):0.6733529094,((t128:0.2568548103,t129:0.2528139462):1.212858092,t130:1.456596829):0.03089294946):0.1507755425):0.6313939806):0.8910748866):0.4231264026,(((((t131:1.721187328,(t132:1.172573069,((t133:0.2220760982,t134:0.2195976028):0.6980277026,t135:0.8919758668):0.2428606982):0.5480427697):0.1690762817,(t136:1.588935855,t137:1.586876686):0.2606018694):0.9597372208,((((t138:1.438626843,t139:1.436600857):0.2715782825,((t140:0.8480410445,(t141:0.3235677001,t142:0.3175790322):0.5116202551):0.4646499167,t143:1.292179314):0.3788655219):0.4219148244,(((((t144:0.06171248946,t145:0.05898161692):0.180073841,(t146:0.1623244266,t147:0.1605208066):0.0699995051):0.6096257953,t148:0.8363955206):0.5253642537,((t149:0.4209697901,(t150:0.1582051329,t151:0.1502225771):0.2396711782):0.1031328715,t152:0.4911468103):0.8346170044):0.4462874216,(((t153:0.3283617534,((t154:0.2060062353,t155:0.198575259):0.103218509,t156:0.2994328081):0.008507889687):0.6139272855,t157:0.9214640374):0.5906388793,((t158:0.7811374192,((t159:0.1262180186,t160:0.1213648094):0.6333833947,t161:0.7340791557):0.02009067821):0.703704202,((t162:0.7963036091,(t163:0.7800523896,(t164:0.6333073983,(t165:0.1264705524,t166:0.1238436234):0.5037962957):0.1363471612):0.006168951381):0.1258272727,(t167:0.7104194723,t168:0.7046443213):0.1820309549):0.5344415509):0.02541312119):0.2373750524):0.2638563114):0.2416034531,((t169:1.013464221,t170:1.011533266):0.2669182128,((((t171:0.4527592933,(t172:0.09531983776,t173:0.09499627851):0.3541996277):0.6969898804,((t174:0.2039019819,t175:0.1923927886):0.3015628386,t176:0.4831296916):0.6372977897):0.06266885335,(t177:0.720601749,t178:0.7111665221):0.4622045011):0.002948825727,t179:1.172807567):0.05130643277):0.9013838189):0.4306716778):0.2732670719,(t180:2.689697728,((t181:1.642768711,((t182:0.7320962033,(t183:0.2433041349,t184:0.2327844394):0.4882093376):0.5724652277,(((t185:0.4463922622,t186:0.4452131293):0.1426400319,t187:0.5833611157):0.5227444957,(t188:0.3175849076,t189:0.3156458507):0.7816892575):0.1791514972):0.3296613725):0.7697577571,(((((t190:0.9533833352,(t191:0.1726926339,t192:0.1652277007):0.7706058506):0.5947946871,((t193:0.8987140599,t194:0.8921934389):0.4914185831,(t195:1.351059394,((t196:0.782481408,(t197:0.6728544795,t198:0.6539057598):0.09989804777):0.3389816554,t199:1.083776093):0.2252087177):0.03202115957):0.1345811431):0.3175044967,((t200:0.6805698154,t201:0.6694800478):0.6901968465,((t202:0.09586699833,t203:0.09411492795):0.7941237298,(((t204:0.3687756239,t205:0.3626687999):0.2492585574,(t206:0.4584168549,t207:0.456995589):0.1525271132):0.1568344395,t208:0.7543322985):0.1111837976):0.4624904587):0.4187967827):0.005809038013,((t209:0.334983732,(t210:0.1703873963,t211:0.1687263958):0.15330587):1.094961331,((t212:0.2264283485,t213:0.2178348266):0.6180422025,t214:0.8319826709):0.5434908357):0.3116795375):0.01453561135,(((((t215:0.5045694095,(t216:0.2030337733,t217:0.2021785572):0.3012256228):0.5636728571,t218:1.059624856):0.3695791358,t219:1.427855702):0.1164448302,((((t220:0.6456416909,t221:0.6398185225):0.2535826667,t222:0.8929759255):0.0006704475893,(t223:0.6823342866,(t224:0.4619242486,(t225:0.03605394145,t226:0.03038650866):0.4234863248):0.219610737):0.1961961528):0.05300875706,(t227:0.5218325416,t228:0.517526291):0.3947363453):0.5690496032):0.03283493144,(t229:1.149631694,((t230:0.4617088609,t231:0.4548588537):0.6546124535,t232:1.103327604):0.01674183713):0.3463832402):0.1068166909):0.4840203649):0.2765528035):0.1344931416):0.3036224116,(((t233:0.1716080574,t234:0.1617689066):0.07749673723,t235:0.2329781318):1.433863885,(t236:1.029833505,(t237:0.4468898975,(t238:0.2054142124,t239:0.204423261):0.2239867586):0.5792044632):0.6235602048):1.087399575):0.1494894258):1.212125417):1.035484946,(((t240:0.5302914036,t241:0.5169844945):0.4547753657,((t242:0.4488969251,t243:0.4378968323):0.3421629262,(t244:0.7323808468,(t245:0.03773043167,t246:0.03518332586):0.6582314342):0.03969316749):0.1734417495):0.6936178248,(t247:0.6548927991,t248:0.6465179035):0.9452431513):3.435102392):0.5892800538);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.125 0.250 0.375 0.500 0.625 0.750 0.875 1.000 1.125 1.250 1.375 1.500 1.625 1.750 1.875 2.000 2.125 2.250 2.375 2.500 2.625 2.750 2.875"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.expgrowth.T3.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
