<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t443:1.524123578,t444:1.481680799):1.529688263,(t445:2.299766084,t446:2.281950211):0.6934933062):0.04443030999,((t447:2.083600657,(t448:1.361109732,t449:1.351710833):0.6782256119):0.3496501605,(t450:0.9351888394,t451:0.8921858204):1.287291921):0.3227825801):11.79341268,((((t452:2.168993939,(t453:1.691334696,t454:1.625698996):0.4376790476):0.5697646301,(t455:0.8957816256,t456:0.8867784087):1.562752146):2.741424327,(((((t457:0.9980145613,t458:0.9810673086):1.608865451,((t459:0.4361098424,t460:0.1202529009):0.4018895611,t461:0.4188153814):1.491822363):0.04558060338,(t462:0.5985450065,t463:0.4419637309):1.126956302):0.05136575643,(t464:1.372914619,(t465:0.5833148371,t466:0.5768474221):0.7851149839):0.2050636766):0.5485926136,(((t468:0.1527383762,t469:0.08039178898):0.4385310107,(t470:0.3063998889,t471:0.3006762332):0.2050926861):0.0621324801,t472:0.4107088078):1.246097993):1.856049659):2.472128912,((t473:0.7021587189,(t474:0.07951954276,t475:0.01455578104):0.596181479):0.8626270092,((t476:0.4489316786,t477:0.2441395776):0.2415998082,t478:0.1438301337):0.6560731537):4.418320109):6.310104249):14.0581534,t479:25.50545386):94.35745959,((t480:11.71665499,(t481:0.8650164995,t482:0.7452235976):10.80758798):23.72075145,((t483:0.5807775563,t484:0.5270795488):0.3155734309,(((((t467:0.04077311856,(((t373:0.1604680896,(((t371:0.1137878601,(t361:0.02667078214,(((t251:0.03535949067,(((t241:0.3215799657,(((t230:0.005764791472,((t216:0.4204122567,t217:0.2998266605):0.02709830964,(t212:0.1023073173,(t213:0.07618510766,((((((t107:0.08379448689,t108:0.02298286156):0.0748951125,t1:10.27973707):1.540393737,(((t2:2.179525164,t3:2.104592603):0.0095238529,t4:1.9401271):1.702310417,(t5:0.142532062,t6:0.1315961603):3.497443108):7.820374053):0.640292245,((((t7:0.9956296923,t8:0.7451433877):7.198170723,((t9:0.2261336818,t10:0.1194928092):7.074496161,((t11:1.126407076,t12:0.9586065):2.159487352,t13:2.962255892):3.887872407):0.6126274931):0.9448717526,t14:8.324127088):2.181891935,(((((t15:2.337258058,t16:2.263181241):6.76257874,((t17:8.31670551,t18:8.21190969):0.1302330969,(((((t19:4.708142249,t20:4.476666745):0.5016301864,t21:4.975238535):0.1701350942,t22:5.078954085):1.368498409,(t23:1.909621003,t24:1.402811213):4.507203708):1.414106234,(t25:4.222304853,t26:4.027314455):3.053711727):0.1559433119):0.56101704):0.03204652609,((t27:5.580252583,((t28:2.250060903,t29:2.140053311):2.944742053,t30:4.928009709):0.2971255886):1.33671386,(t31:3.190683857,t32:3.0590212):3.339427831):0.8441068167):0.141434273,(t33:2.293501396,(t34:0.4153488844,t35:0.3738540925):1.86043331):5.052036482):0.7304477768,(((t36:5.980522532,t37:5.921032779):0.9505719547,(t38:5.292119963,t39:5.290050393):1.569632251):0.5121633485,((t40:5.90449468,t41:5.892114167):0.8394181964,(((t42:1.209156614,t43:1.190382901):1.697249122,t44:2.685555354):2.589717998,t45:5.226442002):1.102608725):0.5496285612):0.4858737278):0.4403094008):0.764386717):0.08909203254,(((t46:0.545256342,(t47:0.3087596878,t48:0.2213708989):0.1821191054):4.168793573,(t49:4.362414335,t50:4.271781164):0.1790507498):0.2552424149,(t51:2.994575418,t52:2.854408378):1.635322075):3.454938534):1.590189967,((((t53:1.302349003,t54:1.266763701):2.302734874,t55:3.49324741):0.1335484562,((t56:0.1442081113,t57:0.134012761):2.636963596,t58:2.634493748):0.3558892747):1.601435553,t59:4.532094849):4.168587432):6.737733953):0.02075062601):0.8752129472):0.3670233119):0.44760701,(((((((((t60:5.187559815,t61:5.150477907):0.4216308774,((t62:2.034734105,t63:1.978293799):1.581303919,t64:3.540029345):1.733559633):0.09858652999,(((t65:4.27436275,(t66:0.07068367381,t67:0.0315857924):4.110321746):0.04467833386,t68:4.157490072):0.1090641906,(t69:2.438753123,(t70:2.261355647,t71:2.256201994):0.1711885937):1.778059918):0.6739332328):0.1250748499,((((t72:2.399845586,t73:2.08457248):0.0513482634,(t74:1.485849702,(t75:0.6627909163,t76:0.5656168931):0.8118859795):0.5770322506):2.312321048,t77:4.0455412):0.05624224547,((t78:0.5666929796,t79:0.4366206495):3.162046203,(t80:1.465260084,t81:1.40851884):2.01606378):0.2391465232):0.1296517478):1.041819148,((t82:0.7720277468,t83:0.5988855064):2.783808591,((((t84:0.7425693816,t85:0.6474065261):1.090297289,t86:1.73636744):0.4460263343,t87:2.181655328):0.4390262682,((t88:1.111913512,t89:1.106572784):1.236021889,(t90:1.921051665,(t91:1.548916846,(t92:1.327035927,t93:1.061506718):0.1776269203):0.3560907265):0.4206194668):0.1227461996):0.5163077114):1.24810298):3.499584749,(((t94:1.851574137,(t95:1.453603486,t96:1.120260537):0.3961318226):0.6037664284,(t97:1.60679137,(((t98:0.2459950952,t99:0.1739569671):0.01025724722,t100:0.1339406432):0.9387550997,t101:0.9726051726):0.3460706049):0.4504958635):0.1997777058,t102:1.715029691):4.694677518):1.386073567,(((t103:1.265769253,(((t104:0.4099421551,t105:0.01643715648):0.1349228053,t106:0.03535301508):0.6615387446,t109:0.2106014757):0.0226188833):2.82884531,(t110:0.1396580251,t111:0.05294354413):2.86108431):1.098201805,(t112:0.124336587,t113:0.1111930327):3.859027408):2.46493765):1.229711454,(((t114:0.6757715066,t115:0.5563145239):1.477430592,((t116:0.2397625841,t117:0.2066885059):0.6347335887,(t118:0.612989429,t119:0.5835610494):0.0809640102):0.8041727759):0.04147007531,(t120:1.223955763,(t121:0.07098716134,t122:0.05828818828):0.9562841805):0.08118910555):5.453013041):3.452905615,t123:9.689761373):0.6740268684):0.1854548544,(((t124:0.3600400183,t125:0.351680309):6.845555699,(((t126:0.4696911118,t127:0.3693443156):1.104062049,(t128:0.2688889359,t129:0.2407239494):0.8221511975):5.223323213,t130:6.208720863):0.3249972745):2.109955856,t131:8.577210136):1.187789714):1.29599704):0.1165959515,((((t132:1.199715952,t133:1.192687739):0.2353141653,t134:1.309720422):3.397231321,(t135:0.07107058408,t136:0.04479520077):4.589015819):3.618462066,t137:8.24433801):2.466917627):0.7120051094,((((t138:4.873933445,((t139:2.14429105,(t140:1.250222105,t141:1.205495619):0.8188462497):0.4791913232,(t142:0.1142077864,t143:0.0814878618):2.389170144):2.20107271):1.53858002,t144:5.402348837):0.02306074748,(t145:3.809217756,t146:3.707656539):1.591834221):0.082965572,t147:5.37813475):4.818307224):0.2883594008):2.328930976,((t148:7.400623653,(((((t149:2.886306333,(t150:0.9008781518,t151:0.8396519054):1.983295732):1.949860748,(t152:0.6011508366,t153:0.1728646833):4.138721663):0.4722887624,t154:4.74995001):1.929351988,(t155:5.77880976,((t156:2.975917781,(t157:0.5612168301,t158:0.5104402316):2.388822046):2.317425925,t159:5.087538307):0.385621908):0.8287385158):0.1052285927,(t160:5.276851914,(t161:1.044046588,(t162:0.3292981741,t163:0.3128877777):0.6780904521):4.032364722):1.101456314):0.03934065956):0.1221644901,(t164:4.055495961,t165:4.030440506):2.220493852):5.145179362):5.607012709,(((((t166:5.194469667,t167:4.947026559):1.235731035,t168:5.998123499):0.9545048304,(((((t169:2.875310796,t170:2.747051253):0.9916164132,(t171:2.774282228,t172:2.555131835):0.9299569549):0.2503738044,(t173:2.551424765,t174:2.274924877):1.166046216):1.664419376,(t175:4.848230323,t176:4.739805887):0.2432614803):0.7018197017,((((((t177:1.41353092,t178:1.413234942):0.9989364515,t179:2.362839033):1.935772017,(t180:3.987989484,(t181:3.505880616,t182:3.180974668):0.4792194194):0.1895024594):0.4757087774,t183:4.262604429):0.01814577333,(t184:3.476694557,t185:3.35314792):0.7408472683):0.1876539302,(t186:3.10054786,t187:3.054432435):0.8199265051):0.5992692919):0.3211614157):0.1552472563,(t188:3.273262721,(t189:3.065515091,t190:3.061245283):0.1235659622):1.659915445):4.915857638,((t191:3.550658151,(t192:2.014919895,t193:2.007655632):1.471429553):1.229479527,((t194:2.711243988,t195:2.513877631):1.388437791,(t196:2.315629204,t197:2.153467539):1.584895403):0.5730849378):4.815132645):4.44519513):1.143270462):1.351963796):0.5009838051,((((((((((t198:1.888709384,t199:1.659048937):0.0345153934,t200:1.686030534):0.7812239619,(((t201:1.555047461,t202:1.416291562):0.4800160602,(t203:0.9576039008,t204:0.9455871494):0.8544491851):0.114290796,(t205:0.4863281273,t206:0.3492450006):1.368933813):0.1896964254):0.6368439899,((t207:1.674320718,(t208:0.8063984219,t209:0.8022943394):0.8603289996):0.2178471413,(t210:1.364545876,t211:1.285276654):0.3613865806):0.613170282):0.06624839618,(((t214:0.2108523752,t215:0.15959235):1.045495007,t218:0.467996278):0.7169829491,(t219:0.7085671283,t220:0.6822516115):0.4497321905):0.08164478653):0.2251924306,((t221:0.1641768605,t222:0.153384898):0.03102408467,t223:0.1691831597):1.239236476):0.09331400113,t224:1.487524506):2.200352704,((t225:1.854683573,((t226:0.2020860944,t227:0.1999188104):0.6515785821,t228:0.840073698):0.9159163067):0.7848917151,(t229:1.543197107,t231:1.48029248):0.9779423115):0.9472126017):2.642483523,t232:6.042802069):6.741266518,((((((((((t233:0.5931898768,t234:0.5697253964):1.148725906,((t235:0.4703418681,t236:0.1912449713):0.1704716526,t237:0.1661543576):0.8436878667):0.3919878448,(t238:0.1992626165,t239:0.1644472175):0.9404210351):0.1555999777,t240:0.8931080943):0.7265057066,t242:1.059079504):0.3618090933,(t243:0.7412483578,t244:0.7345359747):0.4605992532):8.545033966,((t245:1.191913801,(t246:0.2235134551,t247:0.1677394071):0.7402264066):8.233081723,(t248:6.827450332,((t249:0.3670912567,t250:0.1670002351):0.7256345926,t252:0.7172910586):5.707430196):2.303421971):0.09311291021):0.4079567567,((((((t253:0.7841307014,t254:0.7742527575):2.017412124,t255:2.60560879):1.635626692,t256:4.240621645):0.9276388566,t257:5.06540553):0.1407702204,(t258:3.973472465,t259:3.867075246):1.054328842):0.45994645,t260:5.37813759):3.253737751):0.009073799861,((((t261:0.543076824,t262:0.3624106041):3.26488701,(t263:1.382853956,t264:1.095531241):2.24275783):0.2468887352,t265:3.51917476):4.124252473,(t266:6.963443909,(t267:1.008862511,t268:0.9596698094):5.800902648):0.6394697112):0.1230288293):0.2171481289,((t269:2.000121553,t270:1.89227805):5.208660197,(t271:6.369732294,(t272:6.16542815,((t273:5.090166979,t274:5.073123581):0.3818893372,((t275:2.767804427,t276:2.716813026):2.628550986,t277:5.335129801):0.02086228551):0.5884624542):0.1217602365):0.7208688638):0.5263108934):0.2143279379):1.132279884):0.4040262162,(((t278:1.752934727,t279:1.74084656):5.54632647,(t280:6.457506115,t281:6.448915867):0.7488685068):0.03769505304,(t282:6.218329153,(t283:3.538010352,t284:3.495755397):2.5860028):0.9887652432):1.685339514):0.1887749106):0.1907616647,t285:9.082741185):8.622424423,((((((t286:6.166823615,(((t287:2.121197881,t288:1.739353423):1.410942324,t289:3.018384737):0.9891583133,(t290:2.378782556,t291:2.30618847):1.627333591):1.612599564):0.2941640273,((t292:4.711157603,(t293:2.096431519,(t294:0.8117495808,t295:0.761784079):1.214222186):2.593854311):0.3552019742,t296:4.816160101):0.7506902989):0.2514747337,(t297:5.252804997,(t298:4.326628605,(t299:1.040555027,t300:0.9719783456):3.076833243):0.8935170182):0.1714422742):0.3002596286,((t301:4.205696727,t302:4.179925018):1.168425824,t303:5.19644292):0.03871322098):0.1154257245,(((t304:1.945533144,t305:1.722793115):1.934429013,((t306:0.3803218061,t307:0.3277508698):0.08842950666,(t308:0.397271845,t309:0.1933727101):0.01223151445):3.176532154):1.188523465,(t310:3.545887316,(t311:2.615553999,((t312:1.466163515,t313:1.419638878):0.003305472794,t314:1.388607566):1.137049506):0.9033942031):0.941270502):0.255391464):0.2481712596,((t315:3.317775085,(t316:0.4505258874,t317:0.4269184676):2.745968334):0.7357182471,(t318:2.429546254,((t319:0.4126211837,(t320:0.1790678898,t321:0.1010513754):0.00981248245):0.2692418608,t322:0.04314060751):1.745934883):1.441442936):0.8096763016):10.32766208):0.5930933802):0.4817852195,((((((t323:1.810393727,t324:1.492939425):2.410959532,(t325:2.017149458,(t326:1.058053615,t327:0.9999975406):0.9366475913):1.562282339):0.1450764774,((((((((t328:0.8723148611,t329:0.8644736368):0.8243587111,((t330:0.0301745014,t331:0.02683203823):0.8758021301,(t332:0.0944495312,t333:0.0682782176):0.7935713705):0.7694405702):0.018188619,t334:1.619874256):0.5530398699,t335:2.148631508):0.2367162357,((t336:1.355890651,t337:1.133493013):0.38526004,(t338:0.3436043767,t339:0.2057440907):1.143625945):0.5799418711):0.03696855796,t340:1.894970986):0.08086982842,(t341:1.680808123,(t342:0.886021519,t343:0.849862574):0.7367505042):0.2351654653):0.6635226486,((t344:1.603371993,t345:1.288842649):0.7263608746,(((t346:1.002906672,((t347:0.1739604132,t348:0.1506889754):0.3408502303,t349:0.4002555551):0.2283920755):0.423734461,(t350:0.7667170395,t351:0.7609293675):0.1225914192):0.1371435981,(t352:0.3280419396,t353:0.3058733414):0.6576455983):0.2163434541):0.1051525435):0.3526938076):1.285549406,((t354:1.149967519,(t355:0.6251490556,t356:0.5962737205):0.5059098677):0.4288422543,((t357:1.079757099,(t358:0.6691440599,t359:0.6098538557):0.3376060296):0.1404373482,(t360:0.6488957784,t362:0.5031362695):0.4354997613):0.3025221228):1.219673247):7.198588376,((t363:4.482511746,(((t364:0.4514469231,(t365:0.1721395847,t366:0.154060513):0.08224915194):0.09478204409,t367:0.2358348337):0.3851025268,t368:0.5143755773):3.350893126):1.553724775,(t369:2.607762514,t370:2.578407298):2.697510066):3.336108026):2.103554773,(t372:8.435202538,(t374:7.264016899,((t375:1.357604938,t376:1.33220599):2.766210849,t377:4.059583554):2.911500957):0.5256668014):1.528207115):0.4798947755):0.9181690641,((((((((t378:1.286377796,t379:1.24869221):7.435031353,(((((t380:0.2142495421,t381:0.1462542369):0.5382638963,(t382:0.6085355503,t383:0.5833090825):0.03463228526):1.135818181,t384:1.66994364):6.146690595,(t385:1.342103226,t386:1.325199622):6.457879823):0.3234492001,(t387:5.939572495,((t388:1.402523166,t389:1.265773893):4.008485356,t390:5.076045731):0.4644180252):2.066064794):0.1280913147):0.2057597502,((t391:4.154348116,t392:3.866257095):3.382075703,((t393:0.5567174054,t394:0.3407960514):4.221290799,t395:4.354089738):2.451872824):0.3132392164):0.2509280955,(t396:4.780805355,t397:4.724719605):2.392556566):0.5138891037,t398:7.507258618):0.003997933741,(((t399:1.957528768,t400:1.936089433):2.950029395,t401:4.756162978):2.263754211,t402:6.963479365):0.2127289631):0.2774855081,(t403:3.919059701,(t404:3.483173885,(t405:0.597433502,t406:0.5970101437):2.882624353):0.4157136606):3.450796487):0.2871559769,(((t407:1.705590168,t408:1.545548944):3.858308736,((t409:2.384167996,t410:2.348902211):2.819734524,(t411:0.6522528734,t412:0.5962303896):4.45094519):0.1915378355):1.227989362,(((t413:0.1696752705,t414:0.1379576633):5.507265392,(t415:2.748214351,(t416:2.287190256,t417:1.891242889):0.3595100334):2.791467302):0.3852193833,t418:5.371510441):0.3778117244):0.7874085994):0.1210366537):0.8274709726,(((t419:5.421493608,t420:5.357938005):1.263055859,((t421:3.684534411,t422:3.681949846):2.015237604,(((t423:0.3630248439,t424:0.3437113534):0.09947190796,t425:0.4296884764):5.069614512,(t426:4.485545178,t427:4.439610683):0.9984961748):0.1259161407):0.7977882776):0.3452562989,((t428:5.403582821,((t429:0.3586004016,t430:0.3055680309):3.187670579,t431:3.376329254):1.6314413):0.849731664,((t432:3.912385638,(((t433:1.498626073,t434:1.304713458):1.701289658,t435:2.568677544):0.3644000179,t436:2.821792235):0.12853058):0.8180786182,((t437:2.818124242,t438:2.56471306):0.4519732283,((t439:0.9936852727,t440:0.9302935723):1.580857299,t441:2.342425295):0.318775567):0.3891340001):1.120294825):0.3338283911):0.2351966639):0.209970751,t442:4.892589642):0.09176974392):34.17080584):84.38321841);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T25.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
