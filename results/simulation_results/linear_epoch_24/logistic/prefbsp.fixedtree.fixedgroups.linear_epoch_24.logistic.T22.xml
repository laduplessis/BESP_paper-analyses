<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t424:0.3938019423,t425:0.3102636661):5.048585244,(((t426:4.611317474,(((t427:1.321583108,t428:1.303524956):0.05374207845,t429:1.315577728):0.2758614368,t430:1.564728282):2.945205169):0.1084320622,(t431:3.247711175,(t432:1.893182633,t433:1.575292116):1.323019862):1.333749692):0.4404451683,(t434:1.32666496,(t435:0.1518434167,t436:0.1499640902):1.168148964):3.319672976):0.1653127981):1.594124942,((((t437:0.716104741,t439:0.6379083607):2.629005908,t440:3.254104874):1.424020624,((((t441:1.560854987,(t442:1.002693431,t443:0.8113019793):0.5546445873):1.53755636,(t444:1.095157164,t445:1.071071949):1.699370548):0.6938872955,t446:3.242873865):0.5932925992,((t447:3.671409504,t448:3.588602204):0.1161384309,((t449:3.278899623,(t450:0.144291931,t451:0.1201758415):3.068672321):0.003103193066,t452:3.178179234):0.4209323082):0.02596774958):0.2740869361):0.8491781455,((t453:2.613100778,((t454:1.916249121,t455:1.837126529):0.5492819968,(t456:2.138490962,t457:2.100741327):0.2054012731):0.08187823297):0.4985340235,(t458:1.317362735,(t459:1.105396399,t460:1.081077405):0.1806023961):1.368292449):1.574501976):0.7614825841):34.22192438,(((((((t461:0.1733485887,t462:0.1239942026):1.466132609,t463:1.520224024):0.2621801472,t464:1.680568892):0.4889026031,(t465:0.7602335689,t466:0.7362220072):1.402739427):0.6649963228,t467:2.704070534):12.71871917,((((t468:2.305870736,(((t469:0.9913717649,t470:0.8454900092):0.3976242091,t471:1.042072454):0.5902675444,(t472:1.587015208,t473:1.371349483):0.04056178964):0.2024372383):2.385729064,(t474:1.208086949,t475:1.021009846):2.733760016):9.743487556,(((((t478:0.01058908606,t479:0.002345400937):0.1085306639,t480:0.08799890015):0.1553032501,t481:0.2259572992):1.603536051,(((t482:0.3900759063,t483:0.353966157):0.4914309351,t484:0.8139831896):0.4531210691,t485:1.0833834):0.3696056847):1.964268594,((((t486:0.6324685522,t487:0.4926244876):0.2904788583,(t488:0.3643495821,t489:0.2844402044):0.4049354229):0.7677509443,((t490:0.07168889642,t491:0.06370529198):0.9119945575,t492:0.9383085855):0.2471067046):0.1755021027,t493:1.309952624):1.536311515):8.751213797):0.288018573,t494:11.7362146):0.6476329966):23.08595886,((t495:0.9870186061,((t476:0.247849955,t477:0.1584419303):0.2315124663,(t438:0.02948194512,((t407:0.1658580729,((t363:0.1305309352,(t364:0.007235628906,(((((t241:0.08698086124,(t232:0.03516730573,((t226:0.0204236067,((t217:0.3380820188,((t170:0.02485636312,(t110:0.1789280152,((((t108:0.2430454879,t109:0.1645295475):0.01166641193,(((t1:3.989209129,t2:3.792794777):1.372667515,((t3:1.712622277,t4:1.401196302):0.3607446313,t5:1.719086382):2.97515052):5.226400083,(t6:3.694623705,t7:3.496241008):5.75936233):0.7751755048):0.1850850704,(((((t8:6.314277037,t9:6.223619588):0.6415802751,t10:6.762190337):1.148300575,(t11:6.843760348,t12:6.78205908):1.047691863):0.02837365709,(t13:7.346431786,((t14:2.267722229,(t15:0.5241186267,t16:0.4898371335):1.728268495):3.343590389,((t17:2.428269565,(t18:1.55881893,(t19:1.252415435,(t20:0.6086870166,t21:0.2388836015):0.5609626493):0.2627935189):0.8433094321):2.769498667,t22:4.592404063):0.350794548):1.586582356):0.4995506821):1.469893043,((t23:0.358063389,t24:0.278412593):2.88707982,(t25:0.5321343327,t26:0.5143852598):2.510881705):5.202938257):0.5367562597):0.2000980342,((t27:7.418340841,(((((t28:3.7979255,t29:3.769793587):0.08278497555,t30:3.827745993):1.55044994,(t31:0.6915363158,t32:0.6893724689):4.676430906):0.08321806517,(t33:4.065453512,((t34:1.30849967,t35:1.287222599):1.78111243,t36:3.062245659):0.8335647477):1.276064064):1.001802487,t37:6.059807871):0.7440715445):0.4975656424,t38:7.122545459):0.3948073054):0.06536890948):5.581131041):4.278602154,(((t39:6.345643678,t40:6.093790767):0.6959125268,((t41:5.943184999,t42:5.788255695):0.5646956808,t43:6.347420565):0.2681664519):9.696479994,((((((((t44:0.2852228718,t45:0.1407496236):0.05664084855,t46:0.1546048193):6.269303065,(((t47:4.43715025,(t48:3.603078246,(t49:2.655497775,t50:2.607796603):0.8727540674):0.8048565899):0.5487590608,(t51:4.583337218,t52:4.406754003):0.1652470518):1.158234209,((t53:1.360069409,t54:1.352613175):3.994520296,((((t55:4.497904538,t56:4.489970289):0.07033203305,t57:4.54733954):0.3610532329,(t58:2.18753971,t59:2.173666989):2.688977241):0.2132370744,((t60:2.975812483,t61:2.967160208):1.534313181,t62:4.444240778):0.3673588208):0.1908794348):0.1413877236):0.1895235653):0.9478353701,((((((t63:1.998413437,t64:1.953234152):1.09886832,t65:2.513211338):0.8295258272,t66:2.944089221):0.7323684334,(t67:1.958999484,t68:1.849970081):1.590231135):0.5028192274,((t69:1.871448458,t70:1.852988871):1.55831656,(((t71:1.157791901,t72:0.7667049383):1.128068,t73:1.88667914):0.08045013369,t74:1.858783505):1.034082667):0.4842835696):0.5618513435,t75:3.81960606):0.5549099157):3.615251681,((((t76:2.091804108,t77:1.976524427):0.287798849,(t78:0.3674841312,t79:0.3667006622):1.825466073):0.4731112581,(((t80:0.993300955,t81:0.9414957075):0.8343264895,t82:1.72116616):0.5131009919,t83:2.226361208):0.3110229072):0.8627960077,(t84:0.05986551074,t85:0.003816006427):3.300959639):4.257816195):1.047969186,((((((t86:1.517802416,(t87:1.070496411,t88:1.010462808):0.4250761604):0.9023386257,t89:2.300556315):3.918476631,((((t90:1.758298114,(t91:0.4999987123,t92:0.3998793599):1.213913618):0.1519280774,t93:1.746166665):1.384901251,(t94:2.806799817,(t95:0.06329728431,t96:0.04096121528):2.520279455):0.2635731452):2.596457927,t97:5.275786145):0.2873927509):0.2642632588,(((t98:1.683960649,(t99:1.420387963,t100:0.7507805599):0.09042933529):0.1703367497,t101:1.002414248):1.81432794,(((t102:1.061646182,(t103:0.6222657114,(t104:0.364820691,t105:0.05526110918):0.06694441225):0.4195371318):0.513820246,t106:0.7914055295):0.1530892826,t107:0.9154522966):1.000271678):1.937663467):0.2628645703,(t111:0.261891282,t112:0.1990533381):2.84987951):1.24569464,t113:3.695879768):0.4894542492):1.702333628,t114:5.399222721):2.219824994,(t115:2.787203549,(t116:0.4150345139,t117:0.3345669517):2.356758141):4.76972347):0.1379265234):0.7036222245):0.3700578258):0.1564120213,(t118:7.801783769,(t119:0.4230303013,t120:0.3788101397):7.286881619):0.6941481054):0.3441777292):0.1237661195,((((t121:0.8031894147,t122:0.7393301093):6.953385064,((t123:3.182874931,t124:3.162806221):1.35714157,(t125:3.838455231,t126:3.715517269):0.4902130744):2.691407048):0.6136715223,t127:7.340027999):0.1718928278,t128:7.491868179):0.2420334302):0.3403506664):1.483671537):0.3773308806,(((t129:0.6115152283,t130:0.6028524676):5.553740296,t131:6.002182591):2.564805159,(t132:6.108240895,(t133:4.030900122,t134:4.008848178):2.07659175):2.36922525):1.197023886):0.7041270885,(((t135:3.144150162,t136:2.93954721):2.012424905,t137:4.91834101):4.826760394,(((((t138:5.848064634,t139:5.838362683):0.1528264785,t140:5.985248136):0.3439441268,(t141:0.7640693306,t142:0.6616159097):5.54269757):0.8176061371,(t143:2.427167779,t144:2.423932429):4.475798077):0.2885687316,((((t145:3.714850119,t146:3.657926535):1.611597136,t147:5.266157151):0.6453566292,(t148:2.358385583,(t149:0.8769486864,(t150:0.1462043143,t151:0.1153934562):0.702457455):1.471996171):3.55240092):0.02080267368,t152:5.730659542):1.146138819):2.26286805):0.3387456378):1.210130033,(((t153:4.009172667,(t154:3.506623591,t155:3.380111235):0.3794261562):1.302238417,t156:5.009796275):3.672398886,(((t157:4.750091705,t158:4.607050117):1.195450325,((t159:0.6849817915,t160:0.4905048112):4.52994966,(t161:3.971588979,t162:3.950851361):0.8513382594):0.5677645984):0.9490640275,(t163:5.529906609,((t164:4.264170218,(t165:2.252505644,t166:2.199592769):2.000545368):1.05269285,(t167:2.923277086,t168:2.911110082):2.310087656):0.2114523104):0.7682613967):1.771854839):1.572351273):5.900987759,((((t169:5.961483848,((t171:1.72134045,t172:1.62830173):3.430872974,(((t173:2.870203066,t174:2.797841559):1.013357645,t175:3.76781886):0.6465683613,(((t176:1.488514326,(t177:1.030217876,t178:0.9655222485):0.4360974567):0.4727824107,t179:1.837125094):0.598305659,t180:2.423490375):1.795512574):0.4771998385):0.5934981153):1.414880778,(t181:4.0167432,t182:4.000208693):2.636179516):0.8837592927,(((((((((t183:1.152313088,t184:0.9797098681):0.4394157351,t185:1.308576263):1.883452204,(t186:0.5910571095,(t187:0.2624146947,t188:0.212420022):0.1520519558):2.598230187):0.5744795465,(t189:1.744102397,(t190:1.19721883,t191:1.128322164):0.4716584163):1.770544299):0.6467036479,(t192:2.686170862,(t193:2.439802999,t194:2.315751843):0.1912648575):1.235188753):0.6018175939,(((t195:2.509357207,(t196:1.156774669,t197:1.145952162):1.10234702):1.103398116,((t198:2.676542657,(t199:1.505716068,(t200:1.097897119,t201:0.8447931975):0.2426493993):1.115442506):0.123018568,((((t202:0.5263703943,(t203:0.1215215856,t204:0.007469334605):0.3731546023):1.580871863,(t205:0.6981048438,t206:0.4704737815):1.186740219):0.02314739006,t207:1.645055973):0.06215286629,(t208:1.038070837,t209:0.9640573583):0.6488793268):0.07690465007):0.4176865617):0.4258729496,((t210:0.4299390969,t211:0.244902786):0.2354357291,t212:0.2573374513):1.820998692):0.2913232706):0.2905213452,((t213:1.252046742,t214:1.163786204):0.8111946559,t215:1.631648551):0.5804223776):0.1943303428,t216:2.35097905):0.6609160108,t218:2.576613388):0.9331923986):2.329640097,(((((t219:0.5403497314,t220:0.5144084237):0.3468755052,t221:0.8555530438):0.5889433925,t222:1.432819324):0.8432484642,(t223:1.489138881,((t224:0.5930477405,t225:0.4971772265):0.3378729878,(t227:0.622518944,(t228:0.3781742468,t229:0.08572408744):0.2049805265):0.02683791699):0.5233679353):0.7256400376):3.431561149,(t230:0.7768877626,t231:0.755266811):4.167495831):0.02826322052):4.776169954):2.948129258):0.03031941048):0.4180778827,((t233:1.541485926,t234:1.451040081):8.752952551,(((t235:0.3646699675,t236:0.2354467628):0.4402793168,t237:0.5985503045):2.490479085,(t238:0.6179706263,t239:0.3919213195):2.417431777):6.731744232):2.728430399):4.451946774):1.655185246,(((((((((t240:6.869540174,(t242:0.1831826268,t243:0.09226963888):6.064120807):1.524728601,((t244:1.98676703,(t245:1.508108868,t246:1.420819342):0.3281313254):2.617376238,(t247:0.260878431,t248:0.2351640448):4.088043439):2.976007432):3.345372239,((t249:0.5828358834,t250:0.4678695654):4.548775156,((t251:0.3148797532,t252:0.2698454117):0.5081049309,t253:0.6903145484):3.911147465):5.270121372):0.1677936573,(((t254:8.785025556,((t255:7.798827462,((t256:0.5061687344,t257:0.491806828):3.766981662,t258:4.255651758):3.495754932):0.7967614621,t259:8.546655598):0.17341368):0.04155277046,(((t260:2.613193472,((t261:0.6101391322,t262:0.5711182064):1.25635464,t263:1.748470054):0.1456194676):0.5115504193,t264:2.371345235):5.304693209,t265:7.555876636):0.3160436771):0.05522750358,(t266:1.078655428,t267:1.026252237):6.701565532):1.130228712):1.044600384,(((t268:1.62795225,t269:1.594793846):6.90707706,(((t270:4.962715829,(t271:1.970724612,(t272:1.090192902,t273:0.9123002262):0.8674669219):2.982601666):0.9493304759,((t274:0.7672161506,t275:0.7132359645):3.10829084,t276:3.701194884):1.537833162):1.778200767,((t277:5.877848165,t278:5.839643622):0.32294684,(t279:5.231537285,t280:5.154678762):0.6381448172):0.7749575096):0.6407210583):0.9321311361,(t281:5.000089026,t282:4.988976853):3.124430249):0.3626177018):0.1299503398,((((((t283:4.950152618,(t284:0.8329048115,t285:0.715219689):4.047586418):0.424830903,(t286:4.89676715,((t287:2.473212472,t288:2.422885411):1.16754076,(t289:3.286954652,(t290:2.754663702,(t291:0.8866940744,t292:0.7652103433):1.713282743):0.4749432818):0.188073294):1.237361754):0.2422872884):0.1534651579,(t293:3.05912942,(t294:0.5198416797,t295:0.5052761145):2.440065604):1.705924574):0.1724845862,((t296:4.419105337,(t297:1.542641494,t298:1.488315932):2.856078662):0.08104806216,t299:4.229145597):0.2701246611):0.03768975846,(t300:2.850864555,t301:2.754340907):1.527119988):2.53807432,((((((((t302:1.33978754,t303:1.328296075):1.815993791,(t304:2.966053442,t305:2.710194084):0.0812589653):0.7765913285,(t306:3.374514441,((((t307:2.703143816,t308:2.435024464):0.2229340235,t309:2.282316211):0.1596459682,(t310:1.252090819,t311:1.209309386):1.064186882):0.05771220685,(t312:1.860649295,(t313:1.518550475,t314:1.499839798):0.1741639866):0.4256631443):0.1909157593):0.09903046067):0.4714796279,(((t315:0.6660307591,t316:0.6621358209):1.286469941,(t317:1.820780837,t318:1.801158352):0.1157805569):0.3242297135,((t319:1.804917685,(t320:1.712036118,(t321:0.3167592716,t322:0.2416768042):1.377217751):0.05373478923):0.307109956,t323:1.961927297):0.1122726656):0.428512584):0.3637825263,((t324:1.205327372,t325:1.108001433):1.432288794,t326:2.469571666):0.2125433949):0.04763572471,(t327:1.582766406,t328:1.524204094):1.141951881):0.1276493418,t329:2.746105899):0.4963091187,((t330:1.69766692,t331:1.602241727):0.6755040227,(t332:0.6635511802,t333:0.5252902369):1.577351376):0.8539931258):1.037567124):0.1305935049):1.061810663,(t334:1.517188544,(t335:0.745124037,t336:0.6718801102):0.7545900501):3.574416168):0.4910270883,((((((t337:1.628087142,(t338:1.0845987,t339:1.018220306):0.3964358844):0.0585007854,(t340:0.9221342804,t341:0.6990335785):0.4065703247):1.17710538,((t342:0.4963504274,((t343:0.07929685397,t344:0.05181732599):0.08338664531,t345:0.1222004902):0.02487108995):1.067437073,t346:1.139948555):0.6279076446):0.2797095274,(((t347:0.450212789,t348:0.4158296494):0.6695214749,t349:0.9289832752):0.5967039194,t350:1.384212165):0.2653156075):0.9613807763,t351:2.537594452):0.1991615256,(((t352:0.8083979812,(t353:0.6270133231,((t354:0.08977368758,t355:0.008561762561):0.3238854322,t356:0.3056002672):0.2067908243):0.1508487735):1.407528603,t357:2.060667753):0.3843838018,(t358:0.3948786503,t359:0.1506705472):2.006491203):0.08232219577):1.160319567):3.674863581,((t360:2.012456973,(t361:0.1068690033,t362:6.210806047e-05):1.746193045):0.5666036282,(t365:0.3656580036,t366:0.1878877522):1.538905705):4.389026774):0.004949768977):0.1596573636):3.56239726):2.234620463):0.2882762969,((t367:6.585219417,(t368:1.233102153,t369:1.204306465):5.230160586):3.221565306,(t370:9.084761603,(t371:0.2760350933,t372:0.2238656963):8.74250485):0.4797419525):1.977457579):34.19448612):0.25947862):108.1205571,((((t373:4.215758894,t374:4.17888301):5.133506813,t375:9.301259486):0.06076057736,(((t376:7.757124336,t377:7.541313304):1.044563239,(((t378:5.501123293,(t379:3.737888448,t380:3.66601576):1.67384896):0.598210412,(t381:1.422714154,t382:1.37973554):4.442533468):1.045629755,(t383:1.278778835,t384:1.241035109):5.561749505):1.413446169):0.2168829882,((((t385:0.9290380626,t386:0.9213857794):2.668389653,(t387:3.066744159,t388:3.050894242):0.4818392098):0.8205434346,t389:4.13223145):3.186586962,(t390:6.785043854,(t391:3.895344743,t392:3.712079224):2.498630068):0.1693118547):0.7859319645):0.3064758585):12.38611451,((t393:7.568956636,((t394:2.822688109,t395:2.703868905):4.563564256,((((t396:2.376615213,t397:2.344084861):3.13288402,((t398:0.9206174769,t399:0.8807005457):4.467599474,t400:5.308379071):0.07829292606):0.777541046,t401:6.084147467):0.1723833292,((t402:2.439701188,t403:2.366592887):1.569973527,t404:3.774096117):2.224643115):0.5482155976):0.01885587717):3.548617112,(((((t405:5.397921425,(t406:3.422909955,t408:2.981276164):1.971494626):0.3551052608,t409:5.259959207):0.07548659459,t410:5.247938825):0.07108069835,t411:5.302081969):0.9698814289,(((t412:4.587539406,((t413:3.414854488,((t414:0.6773317542,t415:0.5434394997):2.579725197,t416:3.066601843):0.0984907551):0.4259202882,t417:3.579333607):0.7143367628):0.1249864993,t418:4.4186481):1.281396372,(((t419:0.125963773,t420:0.06583663253):3.706280142,t421:3.725153506):1.330069211,(t422:4.08034372,t423:4.055518394):0.892398072):0.42072895):0.2258472009):3.128549098):8.704818556):132.0383314);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T22.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
