<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t462:1.470643488,t463:1.356006881):0.9929527326,t464:2.342840035):25.33212283,((((((((t465:1.005639351,t466:0.919618485):1.024552789,(((t468:0.1237054386,t469:0.1132002085):0.152275829,t470:0.2127935586):0.2607413776,t471:0.3896181878):1.043359429):0.6675775659,((((t472:0.7344926769,t473:0.6688070671):0.5393132181,(t474:0.7367880372,t475:0.6413882086):0.3383809721):0.07867119762,(t476:0.450748523,t477:0.3238438943):0.3938109792):0.5996686156,(t478:0.7307451089,((t479:0.1816111332,t480:0.1452977033):0.008701055339,t481:0.07929175437):0.4896860022):0.5563015439):0.07864948707):0.3461991581,t482:1.483748994):0.7890007254,((t483:0.4991891728,t484:0.4872382571):0.8342208721,(t485:0.7516502863,t486:0.749147349):0.5363567069):0.9312877255):0.1606614863,((t487:0.2546380483,t488:0.1024434771):0.9066720365,(((t489:0.3408224183,t490:0.1376320711):0.1464426311,t491:0.1156197059):0.08460323489,t492:0.1829099456):0.2460673233):1.008256262):13.3921677,(t493:2.076518931,((t494:0.1668201626,t495:0.1272619853):0.09986013485,(((((t467:0.2036560842,((t383:0.1832158467,(((t371:0.03234747656,(t369:0.1557244285,((t363:0.008271057255,(t362:0.04053474333,(t357:0.0626007774,((t274:0.09707876054,(t268:0.07270005615,((t256:0.06130658732,(t253:0.1142735,(t254:0.002551890993,(t250:0.03851569104,(t248:0.2219706784,(t244:0.1591328563,(t245:0.03018643125,((((t123:0.2063326418,t124:0.1967401474):0.07173510966,(t118:0.1086171394,((t111:0.006118958017,(t107:0.2996132507,(t108:0.01693356255,((((t1:1.177142057,t2:0.9898672495):0.8071625724,t3:1.685635854):6.074436212,t4:7.718156908):0.8330590148,t5:8.37809555):0.1103502637):0.1491820621):0.2170290829):0.3588778031,((t6:6.673217194,(((t7:0.5693108706,(t8:0.1837050192,t9:0.169795229):0.3841421108):4.903420051,((t10:1.195653302,(t11:0.6244401699,t12:0.522099854):0.5458059598):4.120329563,t13:5.130425112):0.1226200482):0.309183129,(t14:0.1924741631,t15:0.1794577273):5.072609772):0.8540028744):1.851746036,((t16:0.4056445401,t17:0.3762217554):5.830239564,(t18:3.293857613,t19:3.244338598):2.812471705):1.482661215):0.545787356):0.284129809):0.5305077549):1.649301778,((t20:8.439306104,(((t21:5.502051918,(t22:0.2370531285,t23:0.1627208749):5.252010859):1.182997756,(t24:3.370849311,t25:3.160890948):3.202515845):0.08044815797,t26:6.33545198):1.67250743):1.069665967,((((t27:2.671669869,t28:2.562871561):1.911294501,t29:4.313951853):1.54639831,t30:5.737400708):1.816119853,(t31:6.991569204,(t32:6.538576783,(t33:3.197236597,t34:3.189799786):3.278926504):0.4463542529):0.545090865):1.127722984):0.8890824932):1.123152211,(((t35:6.432808035,((t36:5.425520246,t37:5.366846035):0.9143984695,t38:6.034271369):0.01040662256):0.9399197753,(t39:6.435725212,(t40:5.389583458,t41:5.207119891):0.9240896383):0.5338683632):0.5767827765,(((t42:0.4385817019,t43:0.3308597594):4.4899367,t44:4.772509221):2.215518087,t45:6.92900589):0.03014533662):2.594559123):7.581799076):0.0724198098):0.420276892):0.6367382564):0.138031332):0.04826049158):0.2811847423):1.689383807,((((t46:1.397817237,(t47:1.039899562,t48:1.029963336):0.3108261243):3.721971673,((t49:1.04503416,t50:1.040549232):3.802666807,t51:4.825837334):0.2002209842):2.668327184,(t52:2.04562126,t53:1.912675116):5.616789188):6.308397509,(((((t54:1.268332356,t55:1.151539142):0.3912011347,t56:1.537511726):4.796164346,(t57:5.294494811,(t58:4.556661885,t59:4.402981071):0.2935007785):1.025776063):0.2208067443,((t60:3.497972831,(t61:3.097643504,((t62:0.605788162,t63:0.3608847871):1.871345994,t64:2.157820206):0.5887961068):0.1248575677):1.19225034,t65:4.027578426):1.224020278):3.424459373,(((((t66:1.416038421,t67:1.38484327):3.306518686,(((t68:0.3719995979,t69:0.2263084998):1.439128298,t70:1.638510118):1.69728664,(t71:2.058827483,t72:1.979135541):1.20214957):1.165088786):0.09427093087,(t73:2.502757283,t74:2.111381973):1.840769589):0.5945612647,(t75:4.33705226,(t76:2.466791984,((t77:0.4268952757,t78:0.4060634789):0.3433068243,t79:0.702455383):1.565274293):1.821514916):0.1853414143):0.7132450653,(((t80:0.6511538646,t81:0.5214900722):2.352211036,((t82:2.132778648,t83:2.132776693):0.622287502,t84:2.696154492):0.08331615803):1.334150504,((t85:2.131752025,(t86:1.438024397,t87:1.199458238):0.473085676):1.7792037,((t88:1.358482999,t89:1.231432129):0.3486966069,t90:1.536257986):1.646952999):0.105879031):0.6221200484):2.300952653):3.672714733):6.324045837):0.2386347064):0.5880646836):2.266001776,((((((((((((t91:0.4160500724,t92:0.3681201098):0.5505035192,t93:0.8717807279):1.319868971,(t94:1.499506119,t95:1.488649475):0.6473109012):0.4004436054,(t96:2.010429644,(((t97:0.7333056722,t98:0.705866965):0.8626646153,t99:1.526245095):0.3802590283,(t100:0.7375351227,t101:0.7267543617):1.142945228):0.02974439157):0.4500005786):1.104205498,((t102:1.691833831,((t103:0.3413570562,t104:0.1948722961):0.9264722847,t105:1.071435201):0.4237026642):1.544528972,(t106:2.068842534,(t109:0.1974878276,t110:0.09378377925):1.377325595):0.9394012653):0.05689450755):8.800904315,(((t112:0.3512924966,(t113:0.1289863033,t114:0.05929525388):0.2110925335):2.354849478,(((t115:1.148414544,(((((t116:0.07825787422,t117:0.00548808054):0.6283711554,t119:0.435098393):0.1257727537,t120:0.5422061431):0.007222269377,t121:0.5298682007):0.07442609946,t122:0.5335170529):0.1686508889):0.3289731994,t125:0.4701101843):0.8571640112,((t126:0.1021663885,t127:0.07867561036):0.3554352669,t128:0.4310757393):0.7728606254):0.2375748908):4.55282426,((t129:1.648346896,((t130:0.2851617897,t131:0.1915614127):0.7273665246,(t132:0.04360944304,t133:0.02546079542):0.6097769417):0.4565756158):0.4066946221,((t134:0.2516469011,t135:0.1872489011):0.3278318573,t136:0.3660939816):0.8804655497):3.886320961):3.828690057):0.5873720594,((((t137:1.585754371,((t138:0.5105207682,((t139:0.3170054099,t140:0.2536683506):0.003096237647,t141:0.07231679778):0.1685754955):0.8629774518,t142:0.8647608799):0.1443497925):0.03026573644,(t143:0.5331550235,t144:0.5041997879):0.4027482636):5.111741613,(((t145:2.662953157,(t146:2.180019625,t147:2.176670289):0.3554277324):1.966596887,(t148:1.663447888,t149:1.459403362):2.75024398):0.3977166143,t150:4.602120204):0.635983624):2.027337079,t151:7.212593113):0.4070910704):1.574655171,((t152:3.67662356,t153:3.628283665):4.808449558,((t154:4.193065366,(t155:0.3783557137,t156:0.267209435):3.755630243):2.199440002,t157:6.1879131):2.031379213):0.6685596315):0.1085033277,((((t158:5.451034836,(t159:2.625958644,(t160:0.5460296835,t161:0.3735313232):2.070764776):2.798170714):2.632367401,(t162:3.750504229,t163:3.748366511):3.875991738):0.06233940773,((((t164:2.366302498,t165:2.314666564):1.912840641,t166:4.210862597):2.462113431,t167:6.652145709):0.1880535462,(((t168:4.251519851,(t169:2.647525897,t170:2.553494736):1.521406615):0.8433358299,t171:4.867102431):1.441375537,t172:6.158764669):0.2504093698):0.4092991404):0.04860264117,(((t173:4.715372423,(t174:3.884006925,t175:3.802074439):0.7216289295):0.06476241484,((t176:3.188357146,t177:3.168018128):1.298810168,t178:4.462127548):0.06997195802):1.31855906,t179:5.844246958):0.6728944736):0.5379125002):0.2428085837,(t180:6.560137475,(((t181:0.5494158217,t182:0.4349129061):1.88874557,t183:2.298095264):3.134455493,t184:5.380874571):0.5435260487):0.6604475085):1.101749478,((t185:4.424764669,(t186:4.170508036,t187:4.140790316):0.1652897788):2.301447749,t188:6.596038302):0.9127040078):1.144984017,(((t189:5.503812911,(((t190:3.364522797,((t191:1.031465996,t192:1.003592746):1.020468066,t193:1.877226395):1.183720209):0.9412184662,t194:3.974542006):0.5372964728,((t195:0.710232913,t196:0.6942583075):3.383081298,(t197:1.187954069,t198:1.104072214):2.838933575):0.3138858378):0.6382679042):0.3241725096,t199:5.187601708):2.15754076,(t200:5.674802642,((((t201:3.997555687,(t202:2.828731819,t203:2.760057186):1.146707264):0.5088558454,(((t204:2.914127856,(t205:2.799594153,t206:2.478008014):0.08601108275):1.053060867,t207:3.54366007):0.09948813939,(t208:2.306923881,t209:2.296226854):1.326985492):0.3396687606):0.3979197577,t210:4.149404296):0.7218624198,(((t211:0.733407899,t212:0.7173179078):1.128727228,t213:1.705045348):0.1735357133,((t214:1.056158289,t215:0.8878629413):0.07754708114,t216:0.9504369343):0.7109657741):2.762010157):0.02690136261):1.39269123):0.6447958152):1.886777064):6.932927851):0.3358417897):0.01745265477):0.6851933105,((((((t217:0.2181869077,t218:0.1918138016):2.172844065,(t219:2.044929857,t220:2.030153831):0.2914958773):2.124044506,t221:4.404780364):11.0533554,(((((t222:2.009181232,(t223:0.9305377171,t224:0.5245567888):1.048498722):1.43486363,(((t225:0.8564402768,(t226:0.0650643959,t227:0.05767273216):0.619474049):1.328933238,(t228:1.239145915,(t229:0.9313678125,t230:0.9217738154):0.2140181655):0.6261121784):0.2819876287,(t231:1.589951554,t232:1.531744384):0.4397568492):0.4274052109):0.6090154074,t233:2.997980213):8.157345464,(((((t234:3.673815863,(((t235:1.34458632,t236:1.328373709):0.8091847043,t237:2.065751723):0.7457530811,((t238:1.908165993,(t239:0.7746721779,(t240:0.289712514,t241:0.2296107008):0.4748968832):1.102287267):0.8594886161,(t242:0.7224911829,t243:0.6972516892):1.924254487):0.00389465346):0.6500633434):0.3048541055,((t246:0.9868278589,t247:0.9362412325):0.566553605,t249:1.095028027):1.51141813):0.4770504559,t251:2.557898853):0.1425192205,(((t252:0.7408170795,t255:0.5571441512):0.4579614222,t257:0.754239662):0.09677729851,t258:0.8346320269):1.376646241):0.9283012876,((((t259:0.3092587188,t260:0.2148234344):1.007876754,t261:1.174630668):0.8944734065,((t262:1.117950487,((t263:0.3722902233,t264:0.2019310248):0.4854546193,t265:0.5141927705):0.1256321601):0.4629996162,(t266:0.5738423962,t267:0.08956856999):0.2478504332):0.1926198439):0.5998417538,t269:0.8062132088):0.2895776611):5.60063691):2.908313555,(t270:1.32879558,t271:1.281433335):8.274062092):0.3119793659):0.1018140666,((t272:7.148781841,(t273:3.417160597,t275:2.979272465):3.536640812):2.282620797,((t276:1.180863413,(t277:0.2254961332,t278:0.1590915917):0.925919171):3.543831164,t279:4.423776145):4.011418661):0.5179690172):0.1051881738,(t280:2.448939326,(t281:1.768483036,t282:1.723610049):0.6586589748):6.499881442):0.5458149475):0.02734093629):0.4214839582):0.3359647942,((((t283:6.929065454,(t284:4.408891133,t285:4.254878606):1.463054849):0.5498178405,t286:6.189584059):1.185191095,t287:7.287250565):0.1326845615,(((t288:0.1050589281,t289:0.02447855621):4.55081816,t290:4.551849341):1.563312985,(t291:5.618422233,t292:5.593208493):0.4521599494):1.17115352):1.390565635):0.5733842893,((((((((t293:1.403670385,t294:1.298528172):0.7032701304,t295:1.968561845):3.083883071,t296:4.949727735):2.045507362,t297:6.927979999):0.2954315849,((((t298:5.566323188,t299:5.452104264):0.5518317801,(t300:3.054561631,t301:2.955312972):2.699496319):0.05819783176,(t302:5.155947555,(t303:1.285657001,t304:1.281224448):3.705740626):0.5286100899):0.1757572937,t305:5.647624437):0.7965584682):0.1713462308,((((t306:0.9828130686,t307:0.9739012751):0.669215637,t308:1.607503813):1.334553785,(t309:2.465684668,t310:2.372489181):0.3870571699):2.238322363,(t311:4.461275902,(t312:3.911571216,t313:3.854790618):0.4375363724):0.4716045397):1.161624013):0.2030721072,((t314:4.797614678,((t315:1.966506746,t316:1.348839144):1.766615861,(t317:0.401063305,t318:0.2699651374):2.435575857):0.88556017):0.9482974445,((((t319:1.378970506,t320:1.351504479):2.81926723,t321:3.946067328):0.1032941147,(((((((t322:0.4632381326,t323:0.3802059865):1.884745508,t324:2.258614481):0.8007270228,(t325:0.4733086782,(t326:0.2076991818,t327:0.1891775279):0.0220683339):2.541254147):0.2610778476,t328:2.750380762):0.1109137972,(t329:1.716017026,t330:1.659994051):1.111600925):0.07067107446,((t331:1.507098363,t332:1.429825676):0.4713652154,t333:1.79093469):0.7483428403):0.2774725718,(t334:1.825313621,(t335:1.661044987,(t336:1.386195154,t337:1.324560024):0.2415312939):0.1555447337):0.9225647273):0.0572767696):0.0007857775256,(t338:1.976770676,t339:1.899598528):0.6892731419):0.235651877):0.1137715304):0.1848886891,t340:2.971007204):1.088514285):0.9179082926):0.437145077,(((((t341:0.8234933597,t342:0.7158925529):0.6895963081,t343:1.389671668):1.209634348,(((t344:0.942927926,t345:0.9104412171):0.6824438671,((t346:0.8602742017,t347:0.8249744321):0.5271814237,t348:1.233597092):0.1540828638):0.4330632428,(t349:1.074593175,(t350:0.4635991259,t351:0.4207904838):0.6106679777):0.6175061894):0.5206140629):0.09952672752,(t352:1.876359918,(t353:0.7011095769,t354:0.6880267397):0.519201914):0.2919153988):0.03708486969,t355:1.529979361):2.476361376):7.147567483):0.9295807191,((t356:8.426677275,(((t358:1.101282432,(t359:0.6019743355,t360:0.5910843774):0.4628106939):1.750672421,((t361:1.460294567,(t364:0.07908613648,t365:0.05030749825):1.225084):0.7718109896,(t366:1.987592916,t367:1.829011402):0.02442810092):0.5149696063):0.480538563,(t368:1.253887687,t370:0.5505113637):1.586744864):4.738637742):1.707799512,((t372:0.8557147567,t373:0.4016621259):0.7192547227,(t374:0.2021928042,t375:0.1402130549):0.7949019347):6.796066779):1.861816903):0.691925252,((t376:8.796983197,(((t377:0.396854991,t378:0.2086516925):0.9761343555,t379:1.123273724):3.182992188,((t380:1.771750802,t381:1.714632061):1.135817154,(t382:2.457174905,t384:2.209517652):0.3398431869):1.144350064):4.236234019):0.4434896951,(t385:8.014943666,t386:7.853749415):0.3359875448):0.8042791976):0.4144377208,(((t387:0.8037101194,t388:0.7391319485):7.758423231,(((t389:1.168121144,t390:0.994953251):4.029262196,(t391:3.483430891,t392:3.379898655):1.241928487):2.419236436,(t393:4.539869323,t394:4.531298598):2.289640624):0.6291961745):0.4818856624,((t395:2.727234135,(t396:2.490327501,t397:2.483567247):0.2169745521):4.484701761,((t398:5.721480597,(t399:3.11955075,t400:3.001863304):2.589852658):0.4926863454,(t401:2.463405672,t402:2.460247942):3.542434273):0.968511521):0.7162224702):0.2730468037):0.2926334936,t403:8.223389647):0.2534264692):1.735621884):12.70586674):5.349953224,(((((((t404:4.190274715,t405:4.189551687):0.3435416175,(t406:3.495948417,(t407:3.33690517,t408:3.245662193):0.1574648657):0.9780570023):3.891679435,t409:8.245955768):0.2190034902,((((t410:2.325537842,t411:2.23597848):2.608579431,(t412:4.145520734,t413:4.134775994):0.6973912998):0.5276727345,t414:5.355555734):1.94929126,(t415:7.107235024,((t416:5.535955538,t417:5.361475548):0.4523724415,(((t418:0.9904304868,t419:0.9122780873):2.525146389,t420:3.398283795):1.06402798,(t421:0.5361221078,t422:0.3666096012):3.74839967):1.192863174):1.113105951):0.09952960533):0.8623757824):0.1977183929,(((t423:2.015152558,t424:2.01401345):4.216902622,(((t425:0.9123541102,t426:0.7454819171):2.918087896,t427:3.516487872):1.724484096,(t428:2.845215562,t429:2.576648993):2.332561984):0.4379833635):1.257327336,(t430:5.282496505,(t431:4.59385235,((t432:0.7663974767,t433:0.6861617994):3.65100263,t434:4.314383164):0.06635562331):0.4624975074):1.096430912):0.03954366238):0.2411018631,(((t435:3.858901324,(t436:3.407698711,(((t437:2.356742892,t438:1.850175761):0.7711923171,t439:2.603024113):0.06219899164,t440:2.634524276):0.1553389973):0.4298519156):1.044244666,((t441:3.111133791,(t442:2.422468868,t443:2.354149592):0.6611586036):0.6281639358,((t444:2.499631924,((t445:1.83102807,(t446:1.554691978,t447:1.467866881):0.2285195229):0.3313736526,t448:1.964430638):0.1990708072):1.063813731,(t449:0.7475294538,t450:0.6556189919):2.422819318):0.05835491297):0.3886824427):0.7004294584,t451:4.191874404):0.5988215574):11.01448497,(((t452:0.9350542319,t453:0.8700450994):1.812074856,(t454:2.533003974,t455:2.521570254):0.04288461055):2.094288437,((t456:2.062839261,(t457:2.049248141,(t458:1.09819797,t459:1.060635283):0.9076563934):0.008695519402):0.07864329898,(t460:1.803660554,t461:1.795414788):0.1353992201):2.341395357):10.73429331):8.131352564):4.873499039);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T33.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
