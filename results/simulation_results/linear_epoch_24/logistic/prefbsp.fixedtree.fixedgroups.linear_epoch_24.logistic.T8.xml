<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t450:0.07545831513,t451:0.01715135241):97.78830142,((((((t452:1.962303846,((t453:1.421825229,t454:1.339256492):0.2350029419,t455:1.482809104):0.281356888):1.084770985,((t456:1.797360144,((t457:0.613344834,t458:0.5854076676):0.1732429968,t459:0.4695244428):0.9885644812):0.06382878902,(((t460:0.78137956,((t461:0.2719195299,t462:0.1468041693):0.2077337698,t463:0.1057882085):0.2593661682):0.0868240759,t464:0.3868751126):0.3251774438,t465:0.6700612374):0.2600220003):0.9547944699):1.223785455,((t466:0.3832194589,t467:0.2091196755):0.7746766185,t468:0.862109095):1.85060573):0.00675572623,((t469:1.805093249,t470:1.754042022):0.2108977309,(t471:0.7309428163,(t472:0.1815146634,t473:0.1649136089):0.490985897):1.072844437):0.7029076185):11.21765461,(t474:0.1086332816,t475:0.0411562994):13.45103964):35.59083563,((((t476:3.505580982,t477:3.501480265):7.789121733,(((t478:0.4356392722,t479:0.01378126606):1.379270545,((t480:0.3818404378,t481:0.2234703113):0.3702667837,((t482:0.3721167064,t483:0.358931372):0.006727539769,t484:0.2434139115):0.02722016716):0.6381239815):6.63562904,(((t371:0.2896106089,(((t341:0.05125460044,(t336:0.4201984454,(t337:0.0684901305,(t329:0.09493101974,(t304:0.02418020449,(((t231:0.04597439348,((t229:0.297106619,t230:0.2928014454):0.2829287491,(t213:0.2546280919,(t183:0.001374382504,(t133:0.1145948811,(((t102:0.0845182958,(((t66:0.01194810247,(t50:0.01623406446,(t14:0.007313641746,(t1:1.111145287,(t2:1.035401885,t3:1.009339036):0.03932629763):0.01966656458):2.702263703):2.31348735):1.120225581,(t4:0.6773657841,t5:0.5216404912):6.480799354):1.604416208,(((t6:1.935354388,t7:1.715223464):2.794702696,t8:4.447333262):1.754078914,t9:6.19804854):2.056612597):0.6537844415):1.244365681,(t10:4.643679158,((t11:0.25591835,t12:0.08869764525):0.302921987,t13:0.2595194855):3.964272081):5.482593167):0.4120806078,((t15:3.755773438,t16:3.710860438):5.503949103,(t17:9.037509921,(t18:6.874045461,(t19:5.954111402,t20:5.898060172):0.9173888846):2.155325227):0.1602983213):0.740635847):1.787280052):5.248374395):2.693618138):1.83178884):0.07263083057):1.723213461,(((((((((t21:8.536849978,(t22:3.590300405,t23:3.566384401):4.896642825):0.348135646,(t24:6.766154317,(t25:5.948218401,t26:5.9257846):0.7983162118):2.041663931):0.1410159528,((t27:7.434583765,(t28:3.145045634,(t29:1.954434708,t30:1.864429721):1.147288535):4.279340581):1.22081345,((t31:0.7974968012,t32:0.795868454):4.200270303,t33:4.993862008):3.507479712):0.1884676006):0.1947180021,(((((t34:1.115124447,t35:0.9349313556):0.18232756,t36:1.053856379):6.040386055,(t37:5.615148968,((t38:0.7401601801,t39:0.6419230558):4.112071057,t40:4.669835267):0.7070208098):1.343664994):0.3644042712,(((t41:5.125582929,t42:5.03595562):0.6281765753,(t43:3.040490404,(t44:1.209577713,t45:1.208061773):1.627919464):2.360936692):1.253549918,t46:6.329448952):0.0002126990567):0.4754553548,(t47:5.364661841,(t48:0.6033599037,t49:0.5681000259):4.760692433):1.439207672):0.06627817644):1.246482743,(((t51:1.815525634,t52:1.667133861):3.646002729,t53:5.137603067):2.097485337,((((((t54:5.143153652,(t55:0.5740987512,t56:0.3812101691):4.265345177):0.3443798819,((t57:3.240733066,t58:3.080655389):1.248371759,t59:4.0979039):0.2834191132):0.7252506737,((t60:2.970405667,(t61:1.815949909,t62:1.734115749):1.026399745):0.5718850313,((t63:0.4921919594,t64:0.3836532908):1.894663232,t65:2.251877638):0.7803320689):1.350075416):0.4637203565,((t67:1.533831905,t68:1.489207413):2.901249536,(t69:4.186227675,t70:3.965389043):0.04377905688):0.2665179098):0.04352476095,(t71:2.487311712,t72:2.452957991):1.80580596):0.4492320048,(t73:3.806633296,(t74:3.290375064,(t75:2.762585795,((t76:0.6177148445,t77:0.5913838123):2.003678128,((t78:0.8130672668,t79:0.8039445887):1.289555523,(t80:0.7583346973,t81:0.616586844):1.17075938):0.3393203412):0.1061342764):0.4051081251):0.5146582967):0.8216305926):0.06566168853):0.3985739704):6.511526199,(((t82:3.698505577,(t83:3.222934463,(t84:2.553974545,t85:2.483436532):0.5726872709):0.4152498092):1.180841572,(((t86:0.09077061659,t87:0.06213287024):3.833930883,(t88:2.132740242,t89:2.121114535):1.601361323):0.5375712129,((t90:1.943239245,t91:1.898543792):0.9267333745,((t92:2.104103453,t93:2.050412898):0.2441866911,t94:2.074298795):0.4575644329):1.259778315):0.1493930464):4.042564425,(((((t95:1.6129661,t96:1.545691059):0.4876043761,((((t97:0.857121797,t98:0.7814481139):0.08654918691,t99:0.8635117328):0.6938859863,(t100:1.192437726,(t101:0.6799783148,t103:0.06268266399):0.3319554914):0.1939873251):0.1915075602,((t104:0.4363580893,(t105:0.2365568371,t106:0.1761397154):0.1954650096):0.1719986269,t107:0.4729542794):0.04331833584):0.1300309122):0.7739598175,t108:1.280496109):0.1272158529,((t109:0.6137797307,t110:0.5638893127):0.09876122277,(t111:0.3623417425,t112:0.3530455623):0.2609602404):0.6266011846):0.5936268864,t113:1.798072598):4.343995858):1.991587571):3.457192282,((((((((t114:1.810536359,(t115:1.06034359,(t116:0.6652668583,(t117:0.3623655449,t118:0.1782702996):0.2542890913):0.3659394635):0.7343726493):0.03486886294,t119:1.350370087):0.3233004079,(t120:1.05887495,t121:0.6958418271):0.6046837643):0.1913368789,(t122:0.1848351747,t123:0.1632000088):1.233530324):0.3670227009,t124:1.73574717):2.56326475,(t125:1.551957421,(t126:0.5572797105,t127:0.55473852):0.6222230651):2.276167438):0.4636068084,t128:3.754542133):0.4653202652,(t129:1.428585544,t130:1.137052514):2.682731215):5.227722913):0.2271137784,(((((t131:0.3300960585,t132:0.2774956784):4.119916091,t134:4.142232275):1.351771732,(t135:3.261184802,t136:3.223912898):2.192890528):2.436640537,t137:7.704799598):0.01993943929,(t138:7.268850066,(((t139:0.523765965,t140:0.5185792261):1.107098089,t141:1.531732947):4.614217492,t142:6.071537764):0.9700593242):0.4493557726):0.9919957776):1.921997989,(((t143:6.91240557,(t144:5.512236189,(t145:2.192224515,t146:2.191004332):3.276760546):1.293798551):3.026064581,((t147:6.546390034,((t148:6.245013937,(t149:1.41902189,t150:1.331428745):4.798730816):0.05056258953,t151:6.050742327):0.1946290252):1.557595904,((t152:6.057832755,t153:6.037075611):0.6083661234,t154:6.568987761):0.8898933604):1.15984288):0.2714249586,(((t155:1.095207324,t156:1.030136352):6.053418775,t157:7.079182192):1.591000276,(((t158:4.240856369,(t159:1.295371985,t160:1.199725659):2.915213505):1.079211146,((t161:2.727584305,t162:2.61629343):0.09414274961,t163:2.547953676):2.181426986):1.598097673,t164:6.26806645):1.693427628):0.02697236734):0.1728374693):0.5810245792):2.924504486,(((((t165:1.614678707,t166:1.493439222):5.908960558,(t167:6.842526704,t168:6.838534342):0.3329099769):1.241050254,t169:8.304319348):0.9040473844,((t170:4.563582428,t171:4.545852543):4.052861677,(((t172:6.250843386,(((t173:5.067369956,(t174:3.381078439,t175:3.139764622):1.560333512):0.5820439741,((t176:3.31481571,((t177:1.447054884,t178:1.415812224):0.9570838166,t179:2.328068505):0.8070946939):1.729099625,(t180:4.268565288,(((t181:2.186136123,t182:1.737686144):0.1627867229,t184:1.867771123):0.8765945249,(t185:2.536426357,(t186:1.23743138,(t187:1.044529408,t188:0.9547926705):0.09179862681):0.9596472815):0.06854475627):0.9655165951):0.2192772246):0.08038588379):0.08739728445,(((t189:0.2451443507,t190:0.1297679551):0.2665970992,t191:0.2861701323):1.321946387,t192:1.592581896):1.587473381):0.4402658815):0.4918284106,(t193:3.949951067,((t194:1.771631054,t195:1.680853907):1.774577742,(((t196:0.3118181059,t197:0.07074675786):1.963730711,t198:2.027079425):1.045997415,t199:3.042656352):0.07491174427):0.3066356133):0.1243601155):1.23178392,((t200:3.695249294,((t201:2.628142988,((((t202:1.055665994,t203:1.047959733):0.07623477056,t204:1.11952713):0.3477517112,t205:1.447662944):0.8489356663,t206:2.177749456):0.1922653489):0.8079713509,(t207:2.777538711,(t208:2.135030849,((t209:1.061193727,t210:1.017818103):0.4694243696,t211:1.34679188):0.3444441342):0.5917877225):0.3617888405):0.2150614922):0.077612697,(((((t212:0.8989878709,t214:0.4606527865):0.3202982453,t215:0.7760568325):0.6745219071,t216:1.288502088):0.05145030272,(t217:0.5491089133,t218:0.09279088085):0.7754788286):0.3160148315,((((t219:0.2707941062,t220:0.2394184461):0.1099261927,t221:0.3065940432):0.1945309131,t222:0.4179278469):0.08809403851,t223:0.4575978859):0.5099045415):0.6347783407):0.9342176495):0.5551319537):0.468564772):1.744107031,((t224:0.8607945354,((t225:0.09787431097,t226:0.02777134132):0.1256264651,t227:0.1410165038):0.5995998643):1.438614883,t228:2.172172982):2.998682963):0.2118873912):2.947571548):2.264743721):0.6797290378):0.2291763561):0.4517354387):1.518979469,((((((((t232:0.3747711153,t233:0.2984556472):0.9914561481,t234:1.151410924):0.3294237855,(t235:0.06978451892,t236:0.04725964193):1.129405961):0.02092255623,(t237:0.7189912268,t238:0.5682060232):0.290568851):0.6424102258,t239:1.490909996):4.011283589,((t240:0.8748705008,(t241:0.5490067259,t242:0.5140494563):0.3081505266):0.2515825191,t243:0.8834995048):4.162809806):3.731901814,(t244:6.437408811,t245:6.131259025):2.219299379):1.240696794,((((t246:1.126190007,(t247:0.08189227226,t248:0.04120302553):0.795736812):2.346865091,t249:3.114791632):2.034282198,t250:5.115620228):3.442455595,((((t251:2.454225797,t252:2.283693664):3.228327452,(t253:0.7550521835,t254:0.68755243):4.642077869):2.12546206,t255:7.442893267):0.717157793,((((t256:0.9204050137,(t257:0.6876896234,t258:0.6814226001):0.1939364311):4.774635819,t259:5.647350882):1.806045787,(t260:1.182652225,t261:0.8917044535):6.103296122):0.220394807,(t262:1.794818573,t263:1.685565196):5.338802954):0.4141924384):0.0303861468):0.5151180942):1.307832363):0.01582155317,(((t264:7.218715133,t265:6.994588835):0.2815109825,((t266:5.835587095,(((t267:1.791045037,(t268:0.2712023625,t269:0.1893209977):1.487967006):2.220802315,((t270:0.8334782042,t271:0.8148280781):2.850157039,t272:3.655885681):0.1234453191):1.462226203,t273:5.162422378):0.2363632507):0.862327309,t274:6.155374068):0.4670533571):0.1836789522,(t275:2.729677422,t276:2.611703854):4.063210861):1.203558043):1.533276844):9.012486981,(((t277:2.217837584,t278:2.104813033):2.223231279,t279:4.272263138):6.611667822,((((t280:6.404660991,(((((t281:1.817495061,t282:1.688095036):3.266174213,(t283:1.481873565,t284:1.454151183):3.440716447):0.6257091208,((t285:2.364485942,t286:2.260689468):2.897315482,t287:5.069471557):0.1503003399):0.168697843,t288:5.088500148):0.1324321002,t289:5.194181226):0.3509753592):2.603088117,((t290:6.858229448,((t291:3.789977662,(t292:3.030208311,t293:2.81032629):0.7225534493):2.333458873,(((t294:1.80447029,t295:1.781963944):1.948590603,t296:3.678486879):0.1671404457,t297:3.794234551):1.935575054):0.7031374853):0.2351715167,((((t298:3.204302627,(t299:2.2109752,t300:2.135967111):0.7704002634):0.1827182787,(t301:2.705305669,t302:2.395796062):0.2688986992):2.333651788,(t303:3.978286059,(t305:1.935861501,t306:1.788505385):1.541785928):0.9807319212):0.05286439331,((t307:2.285076056,t308:2.278392997):1.110886908,t309:3.171816841):0.8613724062):0.8490324358):0.9920296395):0.6232298586,(((((((t310:0.455092504,t311:0.2632200609):2.382207466,(t312:0.8498011239,t313:0.7623184862):1.762858993):0.3263633413,t314:2.740719672):0.6512915739,(t315:3.071249669,((t316:1.639748296,t317:1.569172669):0.9225359093,((t318:0.2511781724,t319:0.2389844456):1.557464842,t320:1.750226445):0.6278013947):0.5073275384):0.2049157045):0.6241247109,(t321:1.323184686,t322:1.21504062):2.293438611):0.2434344337,((((t323:0.7534204575,t324:0.661633293):1.155576969,t325:1.815748768):0.9686808525,((((t326:1.28369148,t327:1.247759291):0.7028532249,t328:1.844220127):0.1021552867,((t330:1.311899607,(t331:0.9731272077,(t332:0.6882457464,t333:0.445754137):0.2466665412):0.259051661):0.2148283855,((t334:0.6093361555,t335:0.6035852307):0.3962235233,t338:0.3186666641):0.1381378136):0.2147496437):0.3672174374,t339:1.02329963):0.2939266589):0.6710609566,(t340:1.438980311,((((t342:0.2994386288,t343:0.2837335682):0.116291233,t344:0.2814856359):0.4064545321,t345:0.6621535759):0.07607532688,(t346:0.6194402538,t347:0.5972732612):0.1171369195):0.3889189765):0.4173241005):0.1449219908):0.3707896824,t348:1.881594781):1.391947537):0.3217261396,((t349:0.1049880749,(t350:0.08193628999,t351:0.04266205101):0.01863545003):2.291923405,(t352:0.6474569743,t353:0.4671738288):1.684109995):1.072934689):0.9029988587):7.18812097):2.998571953,((((t354:0.7645513606,t355:0.4681922728):1.638126915,t356:1.88766392):9.114550025,(t357:0.4980197541,(t358:0.4239700839,t359:0.2045842025):0.01151628831):10.47814338):0.2309008453,((((t360:0.4039478925,(t361:0.1332865739,t362:0.06415079247):0.07823413657):0.2620883787,t363:0.2619419253):1.245614453,t364:1.467239374):1.08060284,(t365:0.9590460901,(t366:0.7659481606,t367:0.7251988217):0.04738613125):1.225829582):7.928185262):2.565271691):6.108685227):2.769542526):13.01021313,((((t368:0.147197628,t369:0.103009997):7.875249461,(t370:5.010452383,t372:4.614870467):2.901240856):2.656413524,((((t373:1.022165017,t374:0.9444891308):1.068888305,t375:2.002576945):3.025371172,(t376:0.9032715816,(t377:0.8555923588,t378:0.790919254):0.02955154104):4.123109983):4.417731273,((t379:1.207160661,t380:1.123703647):5.901317588,(((t381:0.7073192155,(t382:0.3785292232,t383:0.3685317962):0.2783517861):2.775621342,t384:3.390280367):3.378323624,t385:6.754755723):0.08508399401):2.252557164):0.6155736139):0.2741219788,(((t386:0.5337505075,(t387:0.2361418241,t388:0.1996449795):0.2533627153):3.144018372,t389:3.523941651):6.099812238,(((t390:2.752671743,((t391:0.6294241131,t392:0.4742710071):0.5704151469,t393:1.038265809):1.33595236):5.810883754,((((((t394:0.972655614,t395:0.8756579613):1.661153883,t396:2.421069987):3.518339347,t397:5.872871578):1.043117392,t398:6.665806673):0.03437704719,t399:6.620884012):0.2037106514,((t400:2.261444621,t401:2.06744502):3.991323044,t402:5.971842888):0.4924349075):0.7431823774):0.7561709398,((t403:0.490734851,t404:0.4384348123):7.324841357,(t405:6.950300805,(t406:6.007078619,((t407:5.115199209,((((t408:2.888259423,t409:2.880740969):1.917188546,(t410:3.626024082,(t411:1.812274327,t412:1.592730291):1.737276162):1.108548914):0.1739743678,(t413:3.170680677,t414:3.064784345):1.409974737):0.1058513215,t415:4.511196672):0.02018446326):0.6511982312,(t416:3.889214765,(t417:1.970022295,(t418:0.2458561624,t419:0.1333764668):1.666885239):1.84460296):1.22875646):0.1751932956):0.692478466):0.8115354749):0.09053641698):0.01902685632):0.1629271509):23.38157564):0.2616451234,(((((t420:5.461417608,(t421:2.062971856,t422:1.816521221):3.346562347):0.2624593525,((t423:3.987076514,t424:3.972625456):0.6433632173,(((t425:2.952458565,t426:2.938094793):0.9477236787,(t427:3.7146874,t428:3.204403595):0.05167557948):0.2136408525,(((t429:0.1700455628,t430:0.05228705078):1.659767597,t431:1.673056755):0.8275654974,((t432:0.6250078761,t433:0.2469862513):0.3936834802,t434:0.493429266):1.477107424):0.7593118045):0.1429746777):0.5259488378):0.1253463633,t435:3.499296783):0.9379588792,((t436:1.099657527,t437:1.0762545):0.6145755334,t438:1.611776351):2.643654615):1.872573392,((t439:3.035275028,((t440:2.086741439,t441:2.053005249):0.5221704754,(t442:1.391740788,t443:1.314161764):1.131429842):0.1951851117):0.680469423,(t444:2.948686572,((t445:1.770151976,t446:1.685340503):0.9742764045,((t447:1.242081265,t448:1.122585286):0.5784746037,t449:1.354733056):0.8365572034):0.1954159855):0.306996075):2.380885675):21.73562547):24.51007719):46.59057956);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T8.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
