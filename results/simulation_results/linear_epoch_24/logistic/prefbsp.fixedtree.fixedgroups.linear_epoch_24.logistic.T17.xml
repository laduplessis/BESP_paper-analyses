<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(t466:145.5407648,(((t469:0.2216897735,t470:0.03167489429):1.410975998,(t471:0.4961898725,(t468:0.18623254,(t467:0.07549647143,(((t463:0.07897625668,(((t410:0.02351510357,(t349:0.0006165132029,(t341:0.09815645296,(t340:0.04388205856,((t335:0.3066889876,t336:0.1601762426):0.2777827209,((t327:0.4299800995,(((t257:0.007343988048,(t249:0.3220797491,(t236:0.05222266192,(t230:0.2569668,(t224:0.1273279335,(t172:0.135494445,(t134:0.02828497543,(t120:0.07111652089,(((t4:0.2564892772,t1:0.4950643366):10.2440907,((t2:1.103050362,t3:0.9834961025):9.402707281,((((((t5:3.576066796,t6:3.418607171):2.884544636,t7:5.858987972):2.340097006,((t8:1.023183375,t9:1.020473265):5.474579681,t10:6.484575529):1.626481106):0.5878848668,(t11:4.160812778,t12:4.137149203):4.1455434):0.1197800422,((t13:7.98119912,((t14:2.456769343,(t15:2.357734686,t16:2.354846692):0.07386411953):3.079363759,t17:5.472372556):2.437266412):0.01377739063,t18:7.907256867):0.3131625351):0.4082003558,(t19:4.620188856,t20:4.355198154):3.729263376):0.06467348635):0.138142994):0.09128965902,t21:8.130919471):0.6530378936):2.100859595):4.764880627):4.55699015):1.41727784):0.8988075472):1.010526828):0.5744005394):3.284927025,(((((((((((((t22:5.434634088,(t23:2.227738446,t24:1.978954382):3.137514608):1.116425668,t25:6.19187323):1.332931821,t26:7.43821804):1.673625141,(t27:1.221087348,t28:1.20876492):7.879338308):1.270065309,(((((t29:0.8243418128,t30:0.6561171526):3.848616814,((t31:4.118235555,t32:4.117240928):0.236634081,t33:4.348689975):0.1307461428):2.67362443,(t34:3.921720558,t35:3.87275693):3.227190897):0.8714455493,(((t36:5.565560747,(t37:3.914614113,t38:3.757708177):1.637824605):1.738678554,(t39:6.900717652,((((((t40:5.992970296,(((t41:2.036801632,t42:1.729298154):2.459866751,(t43:3.329290172,(t44:2.039507321,t45:2.022402088):1.242793707):0.8185607845):1.343336393,t46:5.362080648):0.03083250274):0.04477052205,(t47:4.396379574,(t48:4.290715583,t49:4.273778763):0.09951900277):0.970692183):0.2733731308,(t50:4.2725967,(t51:1.823897076,t52:1.728854386):2.322639209):1.258530448):0.2982674025,t53:5.513044911):0.008409394784,(t54:5.401506982,(t55:5.197847658,t56:5.099588562):0.2007798677):0.04887484604):0.04222680933,(((t57:1.18687146,t58:1.152803183):1.540194003,t59:2.677002067):0.6646996185,(t60:2.874767932,t61:2.863462364):0.4149855642):1.812593814):0.2109536599):0.1924958565):0.5629806562,((t62:1.407434146,t63:1.248284117):0.8481858609,t64:2.089358784):3.706683945):0.06878365341):0.2757728189,(((t65:4.428688818,((t66:2.50620554,t67:2.48444973):1.567952098,(t68:3.378885513,t69:3.227145409):0.5340211064):0.320224041):0.3758474661,((t70:0.2680781013,t71:0.2109226146):2.528066015,t72:2.323742832):1.573437526):0.158260887,((t73:1.660545825,t74:1.496240752):1.358689088,t75:2.762550065):0.8924715174):1.143097778):1.8062059):1.202202924,((((t76:0.5484199785,t77:0.5139866132):0.9802087737,t78:1.43264975):0.9269517926,t79:2.310397647):1.771242538,((t80:0.2492726776,t81:0.2261742666):2.055268696,t82:2.174022458):1.573931247):3.52503255):0.1732304078,((t83:1.530908837,((t84:0.211487301,t85:0.181468332):0.9996709576,t86:0.8427663354):0.206170604):0.3701845209,(t87:0.9503962947,(t88:0.7903649671,t89:0.7891431874):0.1433969634):0.4475189595):5.46124898):4.567755549,(((t90:1.735585104,t91:1.715875996):0.3686131871,((((t92:0.656653184,t93:0.6401713509):0.2603143905,(t94:0.8265343311,t95:0.811977194):0.03717177515):0.5634043726,t96:1.382678645):0.07914137774,t97:1.435984853):0.3976143931):0.7933639553,(((t98:1.213805221,t99:0.9458201846):0.7002064047,t100:1.364483724):0.2738577792,t101:1.437287642):0.3711057258):8.302656197):0.8523341059,((t102:3.492540242,(((((t103:1.127632813,t104:1.064791189):0.3220282793,t105:1.333603951):0.6711241844,((t106:0.5527661187,((t107:0.2733367698,t108:0.2156576815):0.227752514,t109:0.4074439021):0.04691543563):0.6060556692,(((t110:0.1622342381,t111:0.07126612746):0.5099200618,(t112:0.5165716761,t113:0.3853932617):0.0311913464):0.005506119721,t114:0.345893492):0.3358410013):0.5609846009):1.17474521,(t115:1.31993721,(t116:0.7745603811,((t117:0.2724510622,t118:0.1431481349):0.02024902008,t119:0.07579370283):0.3803647688):0.4528989252):0.9316888054):0.1002867129,t121:1.305193276):0.09314908518):1.21485932,t122:2.595999688):6.064324797):1.837529418,(((t123:0.8143514713,t124:0.4241478422):0.1347385367,t125:0.3568330783):0.5024057967,(t126:0.4569485536,t127:0.1183039648):0.2108600139):9.017322065):0.520538511,((t128:0.9188388313,t129:0.8438192272):3.578254663,t130:4.393051678):5.168889307):1.691623627,((((t131:2.087044884,t132:2.055957529):7.421192581,(t133:8.320041689,(t135:5.517616834,(t136:3.733793152,t137:3.662712903):1.692365551):2.404126014):1.143645402):0.6058174965,(((t138:6.046306819,t139:6.004813085):1.272182107,(t140:5.829915901,t141:5.76359631):1.439382616):1.566973616,t142:8.545845293):0.5984748443):0.6460272791,(((t143:0.5538491711,t144:0.2743992472):7.984715742,((t145:6.637224803,t146:6.604521996):0.07680557969,(t147:4.542950472,t148:4.362324746):2.088360233):1.188096466):0.2079901457,((t149:5.481451991,t150:5.303920381):1.524647507,(t151:5.823236674,t152:5.731880833):0.9827149168):0.7919070705):0.7756177922):0.4553585179):3.724019474,((((((t153:1.483614787,t154:1.437506151):0.5418745147,t155:1.810234052):4.876106102,((t156:5.799552274,((((t157:1.148090294,t158:0.6759447432):1.523726192,t159:2.017033074):0.7419173596,t160:2.505757333):2.163089727,t161:4.47697316):0.2179406498):0.7107617343,(t162:4.63398032,((t163:3.476520953,((t164:2.786252122,t165:2.275247861):0.3347662426,t166:2.588102602):0.1560511611):0.9916759018,(t167:2.10589108,t168:2.090428219):1.600905539):0.08372778023):0.7311449969):0.1477685028):0.7071182897,(t169:4.677417273,((t170:0.7008790005,t171:0.6612231512):2.658492723,t173:3.109564455):1.189021628):0.6287290062):0.3725135302,(((t174:3.508508998,t175:3.45064279):0.7107715575,(((t176:0.06116025836,t177:0.001422682657):2.398876685,t178:2.388075047):0.576188261,(t179:1.170640639,t180:1.166704298):1.381115566):1.123081146):0.1449091644,t181:3.697313814):0.915184524):0.7302007909,(t182:4.478195463,((((((t183:1.189897317,(t184:1.11799393,t185:1.062616379):0.01782531154):0.9464320148,t186:1.777884205):0.1745089196,(t187:1.299777298,(t188:1.254628544,t189:1.131402484):0.01485852499):0.5889996537):0.008482828692,(t190:0.9515326035,t191:0.9500383825):0.6892913633):0.3784820606,t192:1.915788198):0.5500038538,(t193:2.306661486,t194:2.302487334):0.1268603646):1.200625951):0.7026366584):3.720857284):1.986206904):3.427076136,((((t195:2.520478553,(t196:0.1408301213,t197:0.07835546115):2.249059949):0.9944199791,t198:3.13858074):1.608829748,((t199:1.814627299,t200:1.687655205):1.642093794,((((t201:0.2476659253,t202:0.2040924862):1.539953896,((t203:0.9974426668,t204:0.9735438836):0.368690339,((t205:0.5517092958,t206:0.5407072381):0.05811802304,t207:0.5721786936):0.6695595335):0.3111209683):0.3122394961,(t208:0.317922384,t209:0.06963453949):1.488780608):0.6403436493,(t210:0.4252197939,t211:0.2619540325):1.329814029):0.5840024772):1.126510075):7.997577218,(((((((t212:0.3949659013,t213:0.3552626686):0.3673686506,t214:0.663809316):0.4190746738,(t215:0.2750669963,(t216:0.1144456056,t217:0.1126720359):0.025201302):0.7925008265):0.3118760289,((t218:0.1555922125,t219:0.1088971683):1.039734633,t220:1.089268548):0.04436913177):1.628182366,((t221:0.471815425,t222:0.1304000379):2.05552982,(t223:1.026812056,((t225:0.09135222779,t226:0.07191288303):0.1112043019,t227:0.1009968637):0.6295302479):1.094232135):0.2288339935):2.294367686,(t228:4.055527257,((t229:2.566717043,(t231:1.097158505,t232:0.5104901189):0.5513138056):0.9187319935,t233:1.965553321):0.3894598477):0.07467956202):5.253167792,(t234:2.293091201,t235:2.17264422):5.356269847):0.5389123788):0.3253242758):0.1410390081):1.238033248,(t237:8.826378923,(t238:8.594536467,(t239:7.301083194,(t240:7.092612768,t241:7.059662206):0.07469994585):1.242883168):0.1006689167):0.841381027):0.08807907961):0.4250549519):0.3725008804):0.932150013):6.071902008):0.471895793,((((((t242:2.034892724,t243:2.015905907):5.891896121,t244:7.859162904):2.346963107,(t245:7.737474946,(t246:7.186791366,t247:7.146901639):0.5082339027):2.410060272):0.3582266648,(t248:7.997078004,(((t250:0.2310096242,t251:0.1673624802):0.7829701515,t252:0.9124416066):5.576171182,((t253:1.804114042,t254:1.709643569):1.836195985,t255:3.518979827):2.803619797):1.019435684):2.421576547):0.4294360466,((((((t256:3.302532016,t258:3.106341224):3.092076029,(((t259:0.2387709423,t260:0.2117051539):0.7001361625,(t261:0.2087079338,t262:0.1343600023):0.6892974622):4.763564508,(((t263:3.910821486,(t264:1.569777974,(t265:0.3138588144,t266:0.2056816652):1.177276864):2.313902543):1.15739343,(t267:0.1630150957,t268:0.1364336597):4.606683221):0.1721579923,t269:4.702062278):0.3039195075):0.42933135):0.8179966389,(t270:5.393522797,t271:5.375846447):0.7679233463):0.09415045812,(t272:5.470755675,t273:5.451648937):0.7138300774):1.26132539,(((((t274:3.922230401,t275:3.807811425):1.24462009,(t276:2.276512801,t277:2.194528851):2.748128545):1.271042442,((t278:0.1938384953,t279:0.09004452075):5.693239591,t280:5.772732076):0.1698921635):0.02700785733,(t281:5.038622411,(((t282:0.1443023408,t283:0.05469549598):4.626180004,t284:4.6554603):0.06558693104,(t285:0.5281223103,t286:0.4000285563):4.080141743):0.1117819031):0.9247413741):0.1170251711,(t287:3.356208833,t288:3.27775533):2.103066357):0.5693522168):0.2226735948,((t289:4.94074075,(t290:3.467762373,t291:3.423919263):1.412835657):0.5824718194,(t292:4.567331133,(t293:4.370972934,(t294:2.163917112,t295:2.131845888):2.20144129):0.006113155441):0.812752036):0.6485753083):1.168221363):0.3995052417,(((t296:3.677468958,(t297:3.515841254,t298:3.394084564):0.07308007213):1.494686011,((t299:3.60666096,(t300:3.413501566,t301:2.997499598):0.1172778777):0.08415985367,((((((t302:0.6039112562,t303:0.5827884919):0.4414275273,t304:0.9120077971):0.4593801736,t305:1.286183387):1.170373236,(t306:1.447996072,t307:1.322458163):0.8346312548):0.230350209,t308:2.023651169):0.2117194639,t309:2.205554318):0.024530062):1.242804644):1.405578337,((t310:2.617315845,t311:2.274889582):0.4489442317,((t312:2.461812102,(((t313:0.8237177902,t314:0.7994615235):0.9886806901,(t315:1.043658753,t316:1.042542162):0.6732756235):0.2084241127,t317:1.770038814):0.3558107099):0.1308184738,(t318:1.974886524,(t319:0.8812345008,(t320:0.8146939417,t321:0.8094377709):0.04868317138):1.069148221):0.2395078573):0.1138431906):1.587481765):0.7287594552):6.102582658):2.461768859,(((((((t322:1.903662899,t323:1.860444848):0.1926710786,t324:1.763149396):0.6260444524,(t325:1.61750663,t326:1.577300511):0.5803944309):0.735859942,t328:2.068727043):3.937191754,(((t329:0.9862614432,(t330:0.609914129,t331:0.6039775237):0.334063036):0.1151913613,t332:0.8699456136):0.1588553123,t333:0.9620116932):4.718897575):3.019459682,(((t334:1.698623872,(t337:0.4292503683,t338:0.399516398):0.4349139519):0.2816269953,t339:0.9575116532):4.968967472,t342:5.119098926):1.750075327):1.691069853,t343:8.514972573):1.029015456):0.8659092798):0.04375668553,(((((t344:1.788557599,t345:1.655912363):0.5520599971,t346:2.200900927):0.2685382887,t347:2.466184665):1.661961874,t348:3.995894917):0.9958883175,t350:4.836615139):4.981322172):0.469900119,(t351:9.864552567,(t352:8.880854877,((t353:8.245198131,((t354:1.932199128,((t355:0.1672505341,t356:0.1274829344):1.545537727,t357:1.635901474):0.1520106477):2.539118636,t358:4.200488604):3.66241438):0.08975287843,((t359:0.3498241145,(t360:0.03709748285,t361:0.0225701443):0.2684526368):7.116230338,((t362:5.835180852,t363:5.776313668):1.393142185,((((t364:0.6788362718,t365:0.5184548341):0.05094749379,t366:0.4683997409):2.200978224,t367:2.612979965):2.210125536,t368:4.49820086):1.855993345):0.1203411286):0.32237765):0.5046915541):0.9399802256):0.3180187958):0.210977869):0.2244407858):0.869304292):0.7649581189):34.6664474,(t369:33.25254393,((((((t370:8.206931945,t371:7.949042942):0.2473526172,(t372:6.754278849,t373:6.728830005):1.296339348):0.1494264533,((((t374:6.982975654,((t375:5.179751309,(t376:4.992237188,((t377:0.7710891367,t378:0.714331987):1.196377029,t379:1.718240289):2.949257515):0.09877615901):0.9042645886,(t380:1.158419847,t381:1.149469602):4.422980464):0.7233407539):0.2232906936,(t382:4.986451302,(t383:4.416048101,t384:4.3580095):0.5594510789):1.51399837):0.1214995015,(((t385:5.427516053,t386:5.386178585):0.3750843987,t387:5.519165272):0.160633659,(((t388:0.2628274276,t389:0.0026606401):1.352970316,t390:1.294317681):2.71511217,(t391:0.113146621,t392:0.08176798621):3.833386912):1.255661575):0.4770468467):0.07599946073,(t393:5.370585445,t394:5.342880106):0.3195221074):0.6290251511):0.02212710687,(t395:3.491725349,t396:2.979554616):2.799535382):1.444067011,(((((((t397:1.423762113,t398:1.370553517):0.8471946543,t399:2.192219066):3.002502104,((t400:3.615921272,t401:3.292516923):0.5066374863,(t402:0.7995403215,t403:0.733430152):2.935993319):1.067853039):0.003794608359,(((t404:3.592840231,((t405:2.21592099,(t406:0.4178458115,t407:0.2849509672):1.797297217):1.03139021,t408:3.002560592):0.2099615266):0.7241728537,((((t409:1.522569058,t411:1.392276778):2.025712925,(((t412:0.7935956898,(t413:0.3668977175,t414:0.349937519):0.267356671):1.85838589,t415:2.475133111):0.3451670261,t416:2.679387875):0.3832862773):0.2322703915,((t417:1.295361813,(t418:0.5980689028,t419:0.5435712645):0.6719322464):0.6960125279,t420:1.779682134):1.295684188):0.001391660253,((t421:0.7887770038,t422:0.7122284898):1.390987615,t423:1.897314904):0.7049910345):0.02306592184):0.3417199242,(((t424:0.5092319864,t425:0.5035994922):0.453640086,(t426:0.6972836129,t427:0.6926595237):0.2087235361):0.723247053,(t428:0.8442137831,t429:0.7445332942):0.7714679053):1.267701219):0.06484959522):0.06351268951,((t430:1.388512218,t431:1.359146196):0.6341925304,t432:1.955585299):0.8226577803):0.7739513879,((t433:0.8698073026,t434:0.8661657321):1.515218203,(t435:1.577861305,t436:1.565671072):0.7698807571):1.132054329):1.037146807,((t437:0.86858019,t438:0.8402570127):0.260214505,(t439:0.9018539985,t440:0.8755974814):0.1146535402):3.369719765):0.06655509441):12.1342412,((((t441:2.052128804,t442:2.003577106):0.7467497412,((t443:2.215202323,(t444:0.3893746818,t445:0.1219410701):1.75356384):0.00426452694,(t446:1.502898746,t447:1.375232179):0.05103950807):0.4547311854):1.288501617,((t448:0.1545200206,t449:0.03070414699):2.052196036,t450:1.900926647):0.8101640741):10.30202684,((((t451:1.195178704,((t452:0.0233932655,t453:0.0214423524):0.7533233304,((t454:0.2246604479,(t455:0.09449421885,t456:0.07038699035):0.124334518):0.1297442358,t457:0.2698907196):0.4007791448):0.4149400422):0.5570716249,((t458:0.1544514318,t459:0.1230592995):0.07344720365,t460:0.1773193442):1.386287687):0.3752405246,((t461:0.3669091869,t462:0.1697015553):0.3922305133,t464:0.07748804463):1.15345956):1.531860553,t465:2.752112941):9.325290619):2.063613945):11.00997227):11.79045095):108.8286568);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T17.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
