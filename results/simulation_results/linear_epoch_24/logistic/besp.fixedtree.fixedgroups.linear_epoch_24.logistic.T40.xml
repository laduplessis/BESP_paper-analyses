<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t409:2.43344436,t410:2.347508797):2.293465638,t411:4.631973805):1.690875926,(t412:6.131757513,(t413:5.474595078,(t414:4.87928571,(t415:3.185585048,(t416:0.04846828475,t417:0.03563429599):2.8757613):1.669209104):0.593862164):0.5810851678):0.04586525907):0.04539144065,t418:5.768248285):0.04732828389,(t419:4.120852191,t420:4.030308993):1.664612969):12.0941362,((((((t421:0.9291433979,t422:0.8848994526):2.890798607,((t423:0.1264702969,t424:0.06282259735):0.124893125,t425:0.1349393578):3.506424841):1.902983704,(t426:5.338771876,(((t427:3.655057807,t428:3.632115618):0.7876073436,((t429:1.387755895,t430:1.341581776):2.787015369,t431:4.028228694):0.2399174507):0.5123698766,((t432:0.2661310651,t433:0.1362685275):3.115428358,t434:3.178745562):1.326521774):0.2948840349):0.1928261013):0.2819609782,((t435:3.28606158,t436:3.224198026):1.606556272,t437:4.720148949):0.2863334691):0.08464776731,((t438:2.942426347,t439:2.849200661):0.294336943,(t440:2.176740548,((t441:2.052880023,t442:2.032000579):0.08075952904,(t443:1.159990387,t444:1.065295503):0.8196852856):0.03550857441):0.9297274326):1.764259869):0.4620897133,((t445:0.382823789,t446:0.3450565231):4.663250416,(((t447:3.628475386,((t448:1.231601284,t449:1.124944377):2.157698691,t450:3.176789758):0.1950949087):0.3261892656,((t451:0.8053575042,t452:0.7483314039):1.810038107,t453:2.199615749):0.8505065678):0.3008700793,(t454:3.005444043,t455:2.89734418):0.345069239):0.6848618562):0.009901760942):11.08428266):0.7695728114,(((((t456:0.5628553917,t457:0.5463772555):3.156404767,(((t458:0.3360746955,t459:0.2788527179):2.042878919,t460:2.237979272):0.9623790399,(t461:2.472199842,(t462:0.4921337702,t463:0.4280064269):1.897499397):0.5902407879):0.2775144):0.1673486664,((t464:1.523183322,((t465:0.6990681842,t466:0.6418497215):0.2995060699,(t467:0.1198798619,t468:0.07429611456):0.7633401458):0.3982993297):1.626673545,((((t469:0.817873128,t470:0.7980885182):0.3836971021,t471:0.9524917388):0.1859667818,(t472:0.662398577,t473:0.2038907705):0.3921681608):0.08831311944,t474:0.676893577):0.9077011943):0.2078218563):0.7115148855,((((t475:0.5149867868,((t476:0.1018657991,t477:0.09922520114):0.1876210172,t478:0.2751727157):0.1812053841):0.03327952401,t479:0.4840849313):0.02182497609,t480:0.4075473443):0.3987601919,(t482:0.3244614004,t483:0.2919558393):0.1969124919):1.465920756):9.954083421,(t484:11.80428164,((t485:2.771322642,t486:2.683935558):0.6326493677,((t487:1.024229577,(t488:0.2993272748,t489:0.2430695277):0.71922025):1.845863355,(t490:2.325296296,((t491:0.1392945733,t492:0.04998025735):0.7936296933,t493:0.6952595577):1.042696918):0.4787811376):0.4425844859):8.297080124):0.005570114118):1.19468064):59.37880067,((t494:0.2663826139,t495:0.2371673614):22.66880615,((t496:0.5362478055,t497:0.2800900981):1.287487332,(((((t481:0.05957751796,((((t387:0.06536792353,((t370:0.1542525238,((t358:0.1327434165,t359:0.03283372119):0.05117474972,(t354:0.2301971874,(t355:0.1083144525,(t352:0.02733595502,((t336:0.08431509045,((t333:0.003803919854,(t273:0.008493261385,((t241:0.1380667543,((t233:0.001832320172,(t163:0.1007702848,((t126:0.1184702588,(t125:0.09592577873,(t124:0.01612572966,(((t75:0.1455345129,(t1:0.9259766916,t2:0.6416505178):6.492825517):2.735871099,(t3:6.361662793,(((t4:0.8979976165,t5:0.8389772565):1.686001722,t6:2.454428596):1.874920277,((t7:2.822442809,t8:2.816753073):0.03557215604,t9:2.727099729):1.350935925):1.797491456):3.268586028):1.075785798,((t10:1.063888696,t11:1.022367884):0.2626250805,t12:1.205975523):8.88087918):0.3041208513):0.4452352358):0.1215815732):2.476722244,(((((((((t13:7.738307564,t14:7.714267871):0.5241346799,(t15:7.892236428,t16:7.834039343):0.2117143444):0.1695727045,((t17:0.0639917224,t18:0.06318459542):7.649930539,t19:7.624396819):0.3159027185):0.1407662164,t20:8.03233354):0.3656747172,(t21:1.861963049,t22:1.834954992):6.496891841):0.02887710589,((t23:6.028499627,t24:5.949770643):0.9190206783,t25:6.495760735):1.37324522):0.04619073142,(((t26:7.273634289,((t27:7.010791723,t28:6.995994286):0.168772299,t29:6.958349776):0.06414719994):0.1913591275,(t30:6.879520579,(t31:3.155000602,t32:3.092313924):3.524683521):0.1569779698):0.3443004443,(t33:7.008765985,(((t34:0.2081905372,t35:0.1895486179):4.139394602,t36:4.232671628):1.466835728,(t37:4.036155581,t38:3.932057252):1.551939144):1.172711273):0.06038436727):0.01603445166):2.533185445,((t39:5.689820032,(t40:3.378940557,(t41:0.7228796029,t42:0.6512050129):2.637621466):2.235893355):0.571864826,(t43:5.611973046,(t44:5.412158364,(t45:4.72707845,(t46:3.25755902,t47:3.22335546):1.348184019):0.6306723935):0.1829724838):0.3860747103):2.982375731):1.196067366,((((((t48:5.060330675,(((t49:2.403113492,t50:2.085521905):0.7961699507,t51:2.854502623):0.7577294456,t52:2.988996808):0.8642918768):0.1810169749,t53:4.03390807):0.8148536705,t54:4.846828148):0.6481791897,(t55:4.180323809,((t56:1.035028593,t57:0.7260886674):0.8096936673,t58:1.195140851):2.162136633):1.081458774):0.5897793283,t59:4.968711513):1.708916536,((((t60:3.213122191,t61:3.176174201):0.4940662431,((t62:0.2486489691,t63:0.155365429):3.13525327,(t64:0.3576281492,t65:0.2553506259):2.93116911):0.2850925382):0.1074028197,t66:3.49759182):1.84458167,(t67:5.242342019,(((((((t68:1.406943043,t69:1.40586876):0.0614320669,t70:1.465522492):1.556951641,(t71:2.818453732,(t72:2.275904279,t73:2.162552377):0.4740077168):0.2022007158):0.3206909139,((t74:2.505431777,t76:2.082372262):0.603478631,t77:2.539900691):0.03631384342):0.148182329,(t78:2.047628476,((t79:0.6167889894,t80:0.5142537737):1.279650184,((t81:0.9677790261,t82:0.9317118951):0.6936004186,(t83:0.6533225178,t84:0.5569238876):0.9636835534):0.003320994717):0.1330971341):0.4987037169):0.2159077878,(t85:1.817334022,(t86:0.7542751275,(t87:0.2867964984,t88:0.1900595867):0.4288951516):1.054573008):0.4697814092):0.9455746214,(t89:1.949706785,((t90:1.590134673,t91:1.539810374):0.001901065595,(t92:1.361765597,t93:1.308578599):0.1698510987):0.3516588056):1.066586659):0.5454207749):0.09907870969):1.009969471):0.8085692325):0.5368691005):2.779012598):5.900248093):0.2271700959,((((((t94:0.598277604,t95:0.508928303):1.224310852,t96:1.704252606):10.21306763,((t97:0.6111415725,t98:0.5708859272):1.647504688,(t99:0.1322684396,t100:0.06662149271):1.9598987):9.646129079):1.13449452,(((((((t101:1.519426879,(((t102:0.2861970785,t103:0.007238426832):1.046264184,t104:0.9027779804):0.1227103431,(t105:0.6936737015,(t106:0.05095606088,t107:0.03570498829):0.5378340532):0.03771474027):0.05636813828):0.3256555476,((t108:0.8410724274,t109:0.7992281334):0.05271480032,t110:0.8441173203):0.09176686849):1.417667701,(t111:0.8836419969,(t112:0.1567332634,t113:0.1057689759):0.61185168):1.436968489):0.1133348061,t114:2.207343663):0.0120925032,((t115:1.065038411,((t116:0.6692661159,t117:0.6497119693):0.1908937559,((t118:0.1468344835,t119:0.1460667896):0.2494137509,t120:0.07897858881):0.403341524):0.1363221263):0.008874839545,t121:0.5475323732):1.094039099):1.143331804,(((t122:0.5537077486,t123:0.2433871939):1.458558956,t127:0.5967401208):0.1119876323,t128:0.48922498):0.520305842):7.477143964,(((t129:0.3190118956,t130:0.2413314089):0.6403127294,t131:0.6817517519):3.520055577,t132:4.15275014):3.995361254):0.7594601079):0.3375425364,t133:8.948655712):0.8477307151,((t134:7.875418962,t135:7.837770176):1.301613401,(t136:7.239769157,((t137:1.486375192,t138:0.7425572676):5.092314994,t139:5.775812037):0.1143491229):1.851985948):0.3732721923):0.3632517916):1.445429565):0.08791670914,(t140:8.311738491,((t141:6.075165962,t142:6.052097065):1.083107502,t143:7.066314559):1.107935341):1.477584344):2.790505222):4.732296647):0.05508165449,((t144:8.409400006,(t145:6.202628996,(t146:1.451650239,t147:1.425199139):4.705657741):2.164236514):0.4286927889,((t148:6.650085048,(t149:5.813374971,((t150:4.074557572,t151:3.955775345):0.457519933,t152:4.184833952):1.000302569):0.710667889):1.441733689,((((((((t153:1.841219716,t154:1.7266478):1.417029497,t155:3.060325986):0.9625910139,(t156:1.891200786,t157:1.869938707):1.961290094):0.4659952466,(t158:2.367179363,t159:2.322161466):1.87524242):1.524974179,(((t160:2.135062723,(t161:0.7681811813,t162:0.6855200234):1.283013987):0.6885191592,(t164:1.960089915,t165:1.891895996):0.5418915872):2.363850042,((t166:4.513031202,t167:4.386047214):0.1065789974,(((t168:0.05171337369,t169:0.04622844065):0.35356313,t170:0.3810124712):2.115596924,t171:2.470452517):1.789768063):0.05947227446):0.516075576):0.4564644982,(((t172:3.998570586,t173:3.777591488):0.1619103424,t174:3.898718481):0.6655960784,((t175:2.862096636,(t176:2.650629367,(((t177:0.7832111351,t178:0.6609219231):0.3302976876,t179:0.6963211389):0.8000918744,t180:1.38004206):0.6116903732):0.1470244537):1.482799782,((t181:3.12237936,(t182:2.86132212,t183:2.79097774):0.1181746554):0.2408385986,(t184:2.053715199,(t185:1.910712967,(t186:1.149934139,t187:1.034958575):0.7406384492):0.1035437865):0.9500514181):0.1685498445):0.08433826642):0.1585310333):0.07651701911,(((t188:0.01759308775,t189:0.01642003062):2.175891648,(t190:1.495580279,t191:1.485413408):0.593165176):0.6556192816,t192:2.672173578):0.4560500111):0.2593302459,t193:3.357966826):0.1390167684):0.5364294866):8.36642149):0.1555670286):0.6027196036,((t194:2.070897931,(t195:1.520507124,t196:1.484137493):0.4674513886):0.4318443314,t197:2.371522337):10.58607054):1.078612783):0.3483175124):0.08932112492):0.6349652129):1.339196371):0.09993495258,((((((t198:2.779716107,(((t199:0.2746237798,t200:0.1726405455):1.171996425,(t201:1.03224157,(t202:0.6331228705,t203:0.5756936025):0.3753845566):0.2982897362):1.097513718,(t204:0.5620669841,t205:0.5331339336):1.757426134):0.1464255368):1.241833005,(((t206:0.5626596709,t207:0.4885377729):1.182522541,(t208:0.7049885863,t209:0.6055775798):0.8467621532):0.953887288,(t210:1.483553732,t211:1.376415139):0.8491178527):0.940517704):0.05841801909,(((t212:0.07171507152,t213:0.02417645297):2.461354337,((t214:0.9008160526,t215:0.7336430693):0.5426241876,((t216:0.175941818,t217:0.08196579299):0.6281263017,(t218:0.2520543487,t219:0.247174373):0.1738753923):0.4308873432):0.939536878):0.01247712618,t220:1.766194278):0.67574122):3.508273726,t221:5.876088689):2.822654884,(((((t222:0.6646146251,((t223:0.4206178563,t224:0.2100669381):0.1159587983,t225:0.3183525296):0.03800051802):0.6357364701,((t226:0.6897951235,t227:0.5120053069):0.003627462558,t228:0.512097238):0.2956236903):1.117583982,((t229:0.1818691998,t230:0.1020685759):0.4636013464,(t231:0.4106621134,t232:0.29080694):0.03154152952):1.275570759):5.797524642,((t234:2.154717514,t235:1.849624898):1.35274547,((t236:0.2249342307,t237:0.2015366243):1.241839806,t238:1.270551369):1.089575313):3.338679907):0.3982676103,(t239:0.5945598589,t240:0.5413641463):5.486138004):0.04570893494):3.268798519,(((t242:4.104466494,((t243:1.038291437,t244:1.003573787):0.5258240591,t245:1.507001067):2.375035784):4.357722249,((t246:5.769053848,t247:5.743768068):1.514553755,(((t248:0.2238789613,t249:0.1881371874):0.08243098201,t250:0.2291928318):0.13709118,t251:0.3432305645):6.686183263):0.9239750027):0.5720988141,(((t252:0.206654215,t253:0.1068095982):7.113763345,t254:7.09684525):0.3859054123,(t255:1.049369444,t256:0.79795836):6.239320879):0.6765728969):0.03994961785):2.811764392):1.840409325):0.8239457216,(((((t257:6.209813224,(t258:3.542220996,t259:3.318549849):2.527414515):1.482930774,((t260:3.352069195,t261:3.346348457):2.69249095,t262:5.999304402):1.193548688):0.3072100946,(t263:6.152173862,((t264:2.923862756,t265:2.817364811):2.813154417,t266:5.598129248):0.4084507947):1.242594028):0.1461115672,(((t267:5.415449475,(t268:4.045589336,t269:3.967762921):1.359071194):1.185108586,t270:6.329083825):0.7600757596,(((t271:5.074419549,(t272:4.030673027,(t274:2.072052854,t275:2.044629248):1.844914524):1.043165866):0.09879383233,t276:4.9928514):1.054648514,(t277:4.593392345,(t278:1.116352382,t279:1.008779849):3.456830254):1.349667044):0.5928107879):0.002826675413):1.301636553,((t280:5.47715828,t281:5.359449962):1.535537596,((t282:5.531758286,((t283:0.2064882465,t284:0.1785425902):2.606684952,t285:2.678426558):2.696299558):1.109590462,(((t286:4.028208937,t287:3.934512279):2.080720501,t288:5.725219814):0.0721111834,((((t289:4.249272481,t290:4.114607435):0.3865679702,t291:4.438399764):0.07635386857,(t292:0.3257807312,t293:0.2604018083):4.134203372):0.8366897946,(t294:2.723616894,t295:2.690309772):2.384878555):0.09748519127):0.2830258638):0.1586609546):0.6784781685):3.706080684):4.498308681,(((t296:3.592209141,t297:3.530649923):0.5593808212,((t298:0.2155964618,t299:0.1287507631):2.390836378,(t300:0.3329497693,t301:0.256403598):2.157502484):1.46711101):2.973895082,t302:6.596202939):7.350836138):1.675684337,((((((t303:3.031723163,t304:3.0262259):0.5997555994,((t305:2.705259,(t306:0.8496801386,t307:0.8088126023):1.837082653):0.682048076,(t308:2.20436546,((t309:1.841558959,t310:1.834306649):0.206056307,(t311:0.8175881345,t312:0.7461368733):1.063748545):0.03638279348):1.016476415):0.1097651656):2.045768372,((((t313:3.526495732,(t314:3.437239107,(t315:2.423892548,t316:2.264322589):0.9313741094):0.06659731216):0.2542351848,t317:3.328300912):0.4444062428,(t318:3.01136372,(t319:2.722010149,t320:2.716479713):0.2332552151):0.5956900492):0.4466656507,(t321:1.32414536,(t322:0.2682739543,t323:0.231875543):1.04566562):2.420383267):0.1988871313):0.7709077024,((t324:2.041331938,t325:2.022277223):0.6941468238,(t326:0.2024871819,t327:0.192980384):2.506799121):1.856777978):0.963620395,(t328:1.20055829,t329:1.084843271):4.295727555):4.44020562,((((t330:0.8034060772,t331:0.7856195454):1.429523077,t332:2.189298896):0.7888834222,((((t334:1.486796837,t335:1.449862803):0.4234421663,((t337:0.7274837467,t338:0.4538187758):0.3030288054,t339:0.7461395983):0.6800757224):0.180192832,t340:1.605310936):0.5471736539,((t341:1.533735804,t342:1.296138061):0.259215691,(t343:1.284744486,(t344:1.13782305,(t345:0.9939837311,t346:0.8802593332):0.1359371824):0.007977480518):0.2219094797):0.3321902459):0.2824567001):0.3044423949,(t347:0.5283317864,t348:0.2793555428):1.38731805):6.351773696):3.653282373):0.5948642423):0.2803782026,((t349:1.002743197,(t350:0.7604755862,t351:0.7323213285):0.2122589728):2.163357352,((t353:1.667984713,(t356:0.511837348,t357:0.309929155):0.7613694543):0.4172161134,(t360:0.4570123542,t361:0.321348633):0.4191842075):0.8067837174):9.278828019):0.3770062423,((t362:9.974307971,(t363:6.368623935,t364:6.168134603):3.575235303):0.7434284889,(t365:9.124612202,((t366:0.1644150174,t367:0.1165891874):1.368671887,(t368:1.229594991,((t369:0.5486150973,t371:0.1979596929):0.5153391014,t372:0.5986537755):0.03005222427):0.1767711732):7.548633502):1.202485465):0.4827298664):0.04520659698,((t373:9.177384429,(t374:1.212202451,(t375:0.1525930893,t376:0.019507722):0.9780584672):7.846242675):0.2793148914,((((t377:8.133331043,(((t378:3.183057992,t379:3.172428039):2.11711508,(t380:0.925713261,t381:0.8822644878):4.265428243):0.4434360977,(t382:1.760335105,t383:1.509047959):3.777243403):2.376701827):0.1048423705,(((t384:2.585883491,t385:2.295003503):0.8928720499,t386:3.153384846):4.078215762,t388:6.966395244):0.1020628678):0.09426300097,(((t389:1.585472651,(t390:0.4133473344,t391:0.3865344815):1.108808597):2.157325762,t392:3.646104216):1.856950526,(t393:1.539169004,t394:1.460149615):3.904201589):1.432413619):0.04924723094,t395:6.83209007):0.5441593876):0.4958967435):0.3729341411,((((t396:0.1560498718,t397:0.008132832997):6.077974122,t398:6.024092201):0.3444745208,((t399:1.059390162,(t400:0.9618394369,t401:0.9449119856):0.06864884345):4.961423465,((t402:3.39887994,t403:3.337828529):2.412496551,t404:5.682169543):0.1488605246):0.07922675463):0.7995062829,(t405:6.086621156,((t406:3.144586279,t407:3.144383843):1.532107757,t408:4.63661433):1.307023287):0.5455896731):0.8318998558):1.909139902):21.05954362):48.59782011);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T40.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
