<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t491:24.0305948,(((t492:0.5776693899,(((t367:0.1671543124,((t361:0.04579927512,((t271:0.02837666449,(((t261:0.01657928653,(t254:0.2161334515,(t255:0.001645934631,(((((t135:0.009550698697,(((t108:0.1034026625,((t45:0.07232715895,((t8:0.1018080874,t1:0.656525847):0.6101805943,t2:1.110244699):2.41197276):4.802167154,t3:8.308549524):0.7648728999):0.3041530086,((((t4:2.782603856,t5:2.780690289):4.193740034,t6:6.824920097):0.1042401153,t7:6.892784134):2.264337945,((t9:8.158771136,(t10:2.192150335,t11:2.189483539):5.810434056):0.4687972008,(t12:3.690501227,t13:3.679609363):4.750147297):0.1563157596):0.01462521948):0.08194919289,(((t14:4.155671751,t15:4.149322769):0.7172959198,t16:4.560586469):1.771751268,t17:6.26066511):1.871829241):1.442521281):4.399833568,(((t18:9.890400972,(((t19:5.277043844,(t20:1.110360427,t21:0.6064962594):4.052484096):2.52416037,t22:7.081452922):0.9221452088,(((t23:3.308705855,(t24:2.720004176,(t25:0.2459033789,t26:0.1906576619):2.434114368):0.5099408487):1.982491786,(t27:0.9082035515,t28:0.8775727032):4.18037844):2.327093526,((t29:6.590328683,t30:6.551000959):0.3774889158,(t31:6.790395311,((t32:3.661968845,t33:3.529387606):1.057823524,t34:4.584458673):2.004159688):0.05471306079):0.4146746604):0.359091103):1.130676842):0.0294249194,(t35:8.171793912,(((t36:1.121579511,t37:1.046907421):0.661585501,t38:1.547375218):5.822970347,(((t39:2.96208399,t40:2.941871082):3.230626952,((t41:4.879419407,t42:4.857226221):0.8070571854,(t43:3.742368161,((t44:0.2145044004,t46:0.03387852441):2.861309333,t47:2.732521763):0.625370682):1.833099226):0.4604921989):0.3536992085,((t48:0.9121143642,t49:0.8722193726):4.629824081,(t50:5.356363247,((((t51:2.336852048,t52:2.238181271):1.27089729,t53:3.380604761):0.9655082253,t54:4.288395736):0.3602285384,(((t55:1.80960801,t56:1.7778741):0.6509203013,t57:2.350279033):1.798893866,(t58:1.245173239,(t59:0.2635882034,t60:0.244706101):0.9742365495):2.874847328):0.2809684754):0.0555334107):0.06569447809):0.3078668251):0.7941610614):0.436977137):0.3352843255):1.915103663,((((t61:5.072780919,t62:5.067184864):0.9094012572,((((t63:1.248259691,t64:1.110983738):2.434482303,t65:3.455309474):0.06341933543,t66:3.496050135):0.1139014444,(((t67:1.499941912,t68:1.466711764):0.0674813417,t69:1.463800048):1.826920971,(t70:0.1797318507,t71:0.1546560341):3.031820613):0.1449018741):2.075217439):0.06479882926,(t72:4.992933086,((t73:1.162031857,t74:1.134503282):1.788048964,(t75:1.126521157,(t76:0.9077940245,(t77:0.3735046767,t78:0.3114204982):0.4394857491):0.1792090089):1.62175228):1.804904213):0.2995795805):0.2911653051,(t79:3.749590889,((t80:2.64270203,t81:2.597290058):1.001010523,(((t82:2.693653628,t83:2.599496796):0.5190805826,t84:3.113482785):0.3316386307,(((t85:0.130348287,t86:0.0005896361472):0.5484587488,t87:0.5429001198):2.559175162,((t88:2.17668924,t89:2.133334302):0.251252599,t90:2.266545895):0.5354445728):0.1262834979):0.05358327138):0.04594671836):1.133580192):1.854654782):2.049558244):1.335675906,(((((t91:3.185061127,(t92:1.626620064,t93:1.573700936):1.469025045):0.3599692421,((t94:3.315633619,t95:3.290997867):0.004305477708,((((((t96:1.683666711,t97:1.674965915):0.1673601602,(t98:0.385163734,t99:0.3773344157):1.27543435):0.1056947135,(t100:1.127512798,t101:1.106972492):0.3709231074):0.6258254046,t102:2.094958617):0.1859376044,((t103:0.5665399649,(t104:0.5355274797,t105:0.4860836233):0.01859633056):0.5734395612,t106:0.881721642):0.9629596642):0.01000551947,(t107:1.637021608,(t109:0.8105146932,t110:0.5161816734):0.1637132852):0.1892251816):0.485446893):0.06399850145):0.1216221823,t111:1.504124148):0.8359433212,((t112:1.640226185,(((t113:0.5180375047,(t114:0.0859134272,t115:0.04354389433):0.4126803719):0.01104003874,t116:0.4269015375):0.003295534721,t117:0.4269119096):1.093450597):0.3276647372,(t118:1.779031451,(t119:0.7774775064,(t120:0.4548419227,(t121:0.231384817,t122:0.196820646):0.1956106483):0.3152697968):0.9462889644):0.05779064753):0.1505208613):1.200740456,(((t123:0.9857223259,(t124:0.3801279179,t125:0.3237621513):0.5826229236):1.248245011,(((t126:0.3087565857,t127:0.2914758432):0.2881354446,((t128:0.1746229102,t129:0.174400347):0.3429520525,t130:0.5132116136):0.01460441271):0.1235597976,t131:0.5871557554):1.388430011):0.4345853163,t132:2.114418045):0.3292027664):3.681199304):4.322100715,((t133:1.374603283,t134:1.121217522):8.174693571,((((t136:1.655737792,((t137:0.1518768214,t138:0.1436193974):0.1105312173,t139:0.07785818692):1.166462863):0.1726111296,((t140:0.597615938,t141:0.5735151059):0.0636990588,t142:0.5347985471):0.7308174388):2.616107814,t143:3.692885019):3.260250281,(t144:0.8370257851,t145:0.5788952049):6.107849079):1.3027399):0.8617023943):0.6144787669,((t146:3.357484982,t147:3.354745137):5.065363137,((((t148:1.744187525,(t149:0.6484050539,t150:0.4392103322):0.999868071):2.611872056,t151:4.006473416):0.05387699939,t152:4.011726493):3.548892453,(t153:4.687195043,(t154:4.333194479,t155:4.311021038):0.3438255208):2.847347273):0.396961579):1.000061869):0.2979242373):0.2085449348):0.799245139):0.3269024262,((t156:8.594155628,t157:8.565798933):0.5101292846,((t158:7.346321725,t159:7.332354461):0.6114936804,t160:7.942277753):1.116783271):1.405053767):0.1863470682,t161:10.64861611):0.7155786528):0.4225267791,((((t162:7.516685193,t163:7.493538898):1.971116167,((((t164:3.091999687,t165:3.058132363):1.651474056,(t166:4.206305082,t167:3.940668365):0.4765676678):1.169111993,t168:5.058887943):3.460720933,((t169:8.023134546,((t170:1.069716778,t171:1.056910209):4.082854453,t172:5.136826359):2.825454671):0.2433184826,t173:8.173955372):0.1987100119):0.05446398012):0.448887154,((((((t174:1.731658987,t175:1.726245301):1.25485127,t176:2.869783372):3.65924218,t177:6.495514283):0.5601544425,(t178:3.431289627,t179:3.413277925):3.598583582):1.199396898,((((t180:2.217814772,t181:2.155268481):5.055039948,((((t182:6.38758162,t183:6.316380295):0.452048961,(((t184:1.013296076,(t185:0.7938964256,(t186:0.1211510292,t187:0.05275651725):0.5336264456):0.2165173406):5.56413465,t188:6.264186734):0.1066317936,t189:6.339857574):0.05481043337):0.02803649988,(t190:5.862815705,t191:5.626928809):0.2186884326):0.2766809991,(t192:0.7080033573,t193:0.5559700157):5.242720534):0.06459201965):0.04219704152,((t194:3.108380302,t195:2.981194023):2.413741304,t196:5.201092037):0.3195327735):0.4819286506,t197:5.501464907):0.3680751418):0.01047396318,((t198:4.95831329,((t199:1.746105305,t200:1.52170967):2.812540413,((t201:0.5339458757,t202:0.4986381084):3.576200299,((t203:3.589190948,((t204:0.4280404391,t205:0.3899400689):1.780336842,t206:2.168890064):1.33788125):0.4181452626,(((t207:2.527130789,t208:2.472747113):0.4538074171,(t209:2.703918725,(t210:2.510799873,((t211:0.2385929774,t212:0.2035615027):2.170255442,t213:2.217473659):0.09576915643):0.115176808):0.1060108921):0.5766963949,(t214:2.30179232,(t215:2.078215991,t216:2.039511532):0.1011528303):0.4984760709):0.3392156069):0.01323616682):0.09285913308):0.3772712571):0.5258011757,(t217:3.420358886,t218:3.346167123):0.4764055194):0.3624424866):0.2962825122):1.78169921,((t219:3.301791164,t220:3.094959475):0.04322780555,(t221:1.29163526,t222:1.208282249):1.733013133):2.884582564):0.007474667242):9.221240609):0.654984506,((((((t223:1.009391251,t224:0.8952061664):1.515076657,((t225:0.8819133764,t226:0.7873909626):1.372100204,t227:2.131697528):0.1412015031):0.5886042497,(t228:2.097501298,((t229:0.246311505,t230:0.198219258):1.136817717,t231:1.321985789):0.6738305887):0.7391861768):1.057419569,(((t232:0.165290514,t233:0.1308951201):0.1816877435,t234:0.298580622):2.436519891,t235:2.717749397):1.006076769):1.660648559,(((t236:1.695785529,t237:1.551219895):0.8987990878,(t238:2.136927865,(t239:0.4505217251,t240:0.4384050982):1.421998506):0.2365358706):1.046803769,((t241:0.4400289057,t242:0.2389897087):1.802359131,(t243:0.9182408688,t244:0.8688288571):1.04284034):0.8542855919):1.703125821):4.420096049,(((t245:0.8196550877,t246:0.3670840928):0.9688311282,t247:1.174686389):0.585905391,((t248:1.179225113,t249:1.05653233):0.421192165,(t250:0.7971811866,((t251:0.1352374986,t252:0.03254716276):0.2113006571,t253:0.2399497254):0.1799330036):0.649371086):0.03375204015):6.305111169):5.455531225):0.2208641706):2.144561061,((((((t256:0.2821259181,t257:0.1323681151):2.567469391,t258:2.582612777):2.979873981,(((t259:0.4565723041,t260:0.1530174046):0.1301011001,t262:0.01888421748):1.177693385,t263:1.18582091):3.797434974):7.130645721,((((t264:0.34449565,t265:0.196325861):1.035253933,(t266:0.370069125,t267:0.1838844309):0.7762581697):0.8231581827,t268:1.715638895):4.742702058,t269:6.249775886):4.93215259):0.5978782182,((t270:9.254058394,t272:8.999403019):2.052622669,((((t273:6.801919356,t274:6.773000327):2.572595654,(t275:8.545678379,(t276:0.6931120063,t277:0.6559380408):7.784929148):0.6918589747):0.07343647642,((t278:1.420455403,(t279:0.8039847739,t280:0.7361132224):0.5769973842):1.161438672,((t281:0.3511686588,t282:0.2083903753):1.530838456,t283:1.721298127):0.5057717686):6.614917693):0.552582851,(t284:7.919597939,((t285:1.396378959,t286:1.335373515):2.726830402,t287:3.974255984):3.769345906):1.047125934):0.9858326561):0.3939097898):0.01764642703,(((t288:8.31460449,(((t289:4.125841405,t290:4.120401137):1.273875647,t291:5.382328579):2.587192426,(((t292:2.851954251,t293:2.621283539):4.230814161,(t294:5.820866291,(t295:4.626051189,t296:4.515185686):1.126912502):0.9206089986):0.07033081263,(t297:4.936340738,(t298:3.893269127,t299:3.863323002):1.02410533):1.690104578):0.6059474855):0.07894664316):0.1373636305,((t300:1.689070053,(t301:1.064596381,t302:1.008990152):0.5071340036):4.432349616,((t303:4.699010578,(t304:4.367780504,(t305:3.692262004,t306:3.63192947):0.5182178473):0.2439965025):0.6928097817,(t307:1.33087749,(t308:0.8082689351,t309:0.5321264129):0.2577984034):3.724727685):0.4839337048):1.244479279):0.8206278789,((((t310:1.568387522,t311:1.454922507):1.29772163,(t312:1.129658403,t313:0.9023965072):1.550965754):1.953683765,t314:4.325320206):1.429068825,((t315:5.252807553,((t316:3.596177693,(t317:1.448597707,t318:1.431565576):2.139846732):0.8370080075,((t319:4.021643835,t320:3.865365241):0.1394535898,((t321:2.145610143,t322:2.063643529):0.9924617249,t323:3.035429076):0.8135477455):0.1348558364):0.465643992):0.3272355083,((t324:0.3872187298,t325:0.335687672):4.224437956,t326:4.43661375):0.1144385192):0.05166251297):0.7550836759):0.8136334905):1.028035435):9.959772864,((((t327:4.884327287,((t328:2.87880832,(t329:0.6559152595,t330:0.3184546825):2.152614288):0.6345537789,((t331:0.3525895792,t332:0.06859404719):2.215139742,((t333:1.149793219,t334:1.146238706):0.9003811115,t335:1.929210399):0.2257140804):0.1710459869):1.316031247):1.755542535,((((t336:0.6668507514,t337:0.2974702279):0.8496509525,t338:1.109893718):1.047435106,((t339:1.664818721,t340:1.522533317):0.1562704132,((t341:0.8208885593,t342:0.7169835143):0.1095066704,t343:0.4265407663):0.7223420033):0.2465273237):1.926797866,t344:3.286339917):0.6733900497):8.551150112,(((((((t345:0.9911668598,t346:0.9452442768):0.1743314039,(((t347:0.443329655,t348:0.2804165267):0.4035065171,t349:0.6742624473):0.006439271111,t350:0.6412935595):0.1941826066):0.01125975905,t351:0.8294692642):0.8286952437,t352:1.625041097):0.3834732779,(t353:1.96562444,(t354:1.372380438,(t355:1.093731213,((t356:0.3827286342,t357:0.3509466278):0.06221414237,(t358:0.03308983856,t359:0.03178918418):0.2234330353):0.5146223828):0.2394336129):0.4612116374):0.04239716337):5.30605325,(((((t360:0.6012294431,t362:0.1871456601):1.273650838,t363:1.368053791):0.1207487467,(t364:0.30237815,t365:0.08034069403):1.121208291):0.1216018472,t366:1.316892906):0.7077100751,(t368:0.7638140617,t369:0.491055243):0.8962281005):3.913519619):2.054104196,(t370:0.1638922784,t371:0.05712729918):7.141124249):2.400296273):0.4834031013,((t372:0.1091462804,t373:0.1005142869):7.591050579,(t374:5.601521718,t375:5.511494771):2.047058087):2.058357397):1.464873749):0.6813533943):11.53700698,(((t376:1.246172113,t377:1.094780806):7.958438285,(t378:6.134166251,((t379:0.2142636908,t380:0.1789025815):3.720554291,((t381:0.7971812073,(t382:0.5126039282,t383:0.0579345756):0.2719550456):0.4218510858,t384:0.6804741695):2.619882229):2.180555101):2.895760158):0.5611009928,(((t385:1.072751863,t386:1.067868946):3.126967377,t387:4.136349642):4.245595053,(t388:8.232609411,(t389:8.079802297,(t390:6.734059495,(t391:0.4760840771,t392:0.4671653596):6.252417318):1.139842488):0.1431341162):0.1395236449):0.4405093074):13.48214847):2.482838718,((t393:4.295740752,t394:4.26812731):14.61068654,(((t395:8.908132577,((t396:7.153220971,(t397:6.129938206,t398:6.070556052):0.5719077587):0.8510363602,((t399:2.900768425,t400:2.781024061):0.1757093194,t401:2.93588283):4.33099117):0.5688235445):0.03611057478,(((t402:5.432806401,t403:5.364504016):0.7249544853,t404:5.967197562):0.2788245765,t405:6.170099764):1.230065572):0.5297943934,((t406:2.245278092,t407:2.208653536):5.432000605,((((t408:3.947914233,t409:3.939724362):1.898326378,(t410:4.339743753,t411:4.288036607):1.428408409):0.6409410808,(t412:6.18268872,t413:6.129530531):0.160470145):0.4863911751,(t414:4.672236761,((t415:2.042965255,t416:1.924547311):1.072575965,(t417:0.4225657372,t418:0.2828478678):2.548248562):1.429182439):1.996838466):0.6632362594):0.2373175099):9.347359707):5.607924913):9.423553344):56.33734734,(((((((t419:1.357380354,t420:1.328081158):6.001877473,(t421:5.832810399,(t422:1.729471089,(t423:1.34263739,t424:1.337197545):0.1755657621):3.995776775):1.440961749):0.3047352347,(((((t425:5.604647045,t426:5.588566741):0.1026188147,(t427:0.2112158187,t428:0.1627246048):5.40104393):0.6479327338,(((t429:3.547834168,t430:3.243495405):1.820668917,((t431:3.857208118,(((t432:0.1481842908,t433:0.1399045356):0.1302369098,t434:0.1894625023):1.778480293,t435:1.870682253):1.5954519):0.6743575414,t436:4.100673156):0.14804271):0.03965028379,(t437:0.873284412,t438:0.8288365592):3.396631787):0.7263752722):0.6793437452,(((t439:1.190226355,t440:1.150315891):1.751588595,t441:2.678197722):0.4988402666,t442:3.125845591):2.109975101):0.01947274857,(((((t443:0.1184328272,t444:0.1023560403):2.807227057,t445:2.869530467):0.2787991977,t446:3.086167027):1.094154088,t447:3.625766236):0.09992479296,((((t448:1.145725763,(t449:0.1669572421,t450:0.08031931996):0.8261898095):1.389014935,(((t451:1.134474645,t452:1.123699127):0.3557942374,(t453:0.3303212561,t454:0.3239081824):0.9815499034):0.3996645569,t455:1.701752018):0.2794283369):0.5185173343,(t456:1.039948062,t457:1.005496365):1.408602895):0.3542276987,t458:2.742392294):0.2890077589):0.7569520197):0.0575589922):0.1590459213,(((((((t459:0.9217808021,t460:0.9206978742):1.041537284,t461:1.961297708):0.7108928272,(t462:2.495099601,(((t463:0.8246359773,t464:0.8128211689):1.319166543,((((t465:0.7717565103,t466:0.7619220299):0.2578550226,(t467:0.8981753585,t468:0.847038537):0.09009011149):0.46679897,t469:1.205439119):0.3890913483,(t470:0.4942176904,t471:0.3534912433):0.9442970259):0.08174958064):0.1144712348,t472:1.458068575):0.2260870894):0.1702825312):0.01889938021,t473:1.814414028):0.8543476526,(t474:0.8902073876,t475:0.7104427601):1.487084503):0.110205437,(t476:1.158559365,(t477:0.6708937323,t478:0.2955755785):0.4359386301):0.9438123978):0.2667469899,(((t479:0.3227760482,t480:0.3054598982):0.2321467114,t481:0.4048674261):0.7924715696,t482:1.111283632):0.2993865651):0.01988946696):0.2761508257,(t483:0.4358478692,t484:0.4212203054):1.141448577):1.192574353,(((t485:1.188763519,t486:0.9974780251):0.2979662415,t487:1.15088679):0.127365018,t488:1.081328967):0.9254712649):24.09227997,(t489:1.075102775,t490:1.027288563):24.96266756):54.42748272);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T35.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
