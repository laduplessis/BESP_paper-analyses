<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t489:1.470759012,((t490:0.8278114913,t491:0.7255330175):0.4151412084,(t493:0.4385039223,(t494:0.3852283021,t495:0.160229455):0.02035159388):0.2437311724):0.2203905166):24.6341632,((((((t496:0.9055112653,(t497:0.2557280393,t498:0.1599866188):0.5998243404):0.3954442149,t499:0.9774837384):0.05033155739,t500:1.007537859):4.383140091,t501:5.363063887):7.762937244,t502:12.93559582):8.646521883,t503:21.54040413):3.085507422):59.82655994,((((t492:0.04372502292,(((t487:0.09814165042,t488:0.03048860443):0.04577362434,(t478:0.1630856392,(t473:0.04618414325,(t373:0.08543800089,((t359:0.1590137755,((((t240:0.01166255342,(t206:0.01388172204,(t184:0.3745192823,((t126:0.1163767505,(t115:0.1667238752,(((t81:0.08319615231,(t38:0.03352463261,t1:3.606026806):3.563974605):2.05874838,(t2:1.438712783,(t3:0.2690414346,t4:0.2680782808):1.092926327):7.547863714):0.9772868003,(t5:2.178058541,t6:2.116971687):7.608717368):0.01709767508):0.9133371315):0.3588795249,((((t7:2.857463988,((t8:0.6687031447,t9:0.4521531508):0.9163162981,t10:1.282748179):1.250529217):4.717020785,((t11:0.3618828151,t12:0.201848947):0.001655806604,t13:0.1696704773):6.496181052):1.378934097,t14:8.029155186):1.694757054,(t15:0.2987070766,t16:0.2779013042):9.333867269):0.3305769863):5.348202186):2.32465359):3.090018018):1.423300588,(((t17:8.815352178,(t18:6.963550413,(t19:3.989385786,(t20:3.125862699,(t21:0.5532541349,t22:0.4941513607):2.520527835):0.8538248405):2.930475367):1.778719017):2.761155339,((((((t23:1.831388199,t24:1.290331731):4.023473043,t25:5.305772708):0.7089102275,(t26:4.790556477,t27:4.769344874):1.212709713):2.270246623,((t28:7.741860069,t29:7.589345167):0.08113356813,((t30:5.763056585,t31:5.506548829):0.560943805,t32:5.926057739):1.336905559):0.2779962825):0.4043001627,((((t33:1.862382951,t34:1.837081454):3.004137324,((t35:3.494651179,t36:3.482591227):0.5753324011,t37:3.916903853):0.7192295269):0.4167568712,(t39:4.581590741,t40:4.531019556):0.3337016171):1.331483761,t41:6.114328179):1.283103168):0.5124673983,((t42:4.745546026,t43:4.684499676):1.691346326,((t44:4.26712727,(t45:2.681410298,(t46:2.24321665,(t47:1.986244039,t48:1.9444526):0.1491506037):0.4316511776):1.581215328):1.444523146,t49:5.276672451):0.6397942815):1.458657325):1.50900921):0.05069548568,(((((t50:2.258318809,((t51:1.013859285,t52:0.9239047074):0.1306963182,t53:1.035572961):0.959085544):3.528714179,t54:5.511979019):1.089425048,((((t55:4.486558115,(t56:3.196029124,t57:3.112803152):1.225714187):1.408799094,((t58:3.584484006,t59:3.569186677):0.2967459392,t60:3.849650003):1.784568395):0.09347286225,((t61:2.767878636,t62:2.708250234):2.420962819,(((t63:0.6477770938,t64:0.3542504527):3.454171362,t65:3.737977313):0.5221490147,(t66:3.771123945,t67:3.768335541):0.474105566):0.4718179021):0.5143877131):0.309181394,(t68:3.819695156,(t69:2.82202331,(t70:1.670141848,t71:1.599646054):1.102270817):0.7826603198):1.707787217):0.1831400481):0.8080454307,((t72:3.523354219,t73:3.245416201):1.689823581,t74:4.923593076):0.9376079791):0.1212093232,((t75:3.379914875,(t76:3.008511759,t77:2.863260461):0.1570344256):0.432532642,(t78:2.383732433,t79:2.286868138):0.9935659602):2.080204828):0.8270900627):10.46890184):8.276828131,(((t80:2.091059489,t82:1.958199999):2.858011338,(t83:4.123249999,((((t84:0.3321549829,t85:0.297393921):2.859550618,((t86:2.643003978,(t87:1.679900287,(t88:0.1835097315,t89:0.1729866507):1.482040978):0.917927352):0.2280697005,t90:2.751482151):0.2436893495):0.08206655101,((t91:1.878784394,(t92:1.438907481,t93:1.353887482):0.2878888117):0.2504504351,t94:1.859101234):0.6307626394):0.2880949714,(((t95:1.218043731,t96:1.18197111):0.003812051636,t97:1.13745819):1.178621374,(t98:1.161003533,t99:1.158474427):1.110059199):0.2792539636):0.5335124762):0.6268472247):4.263929439,(((((t100:1.605985865,(t101:0.4901975076,t102:0.4644622066):1.111421486):1.019663125,t103:2.518835838):0.7352911309,(((t104:2.355843036,(((t105:1.198329742,t106:1.121738299):0.4703099352,t107:1.589607875):0.5027514364,t108:1.9220842):0.1635682765):0.5013210075,(t109:1.756089939,(t110:0.4244102038,t111:0.2523484643):1.189971227):0.7958037403):0.004932089448,((((t112:0.8722004127,t113:0.5786013408):0.1922932078,t114:0.7312025402):0.4376034211,(t116:0.06100001871,t117:0.05645520506):0.6653041737):0.411610476,t118:1.06527077):0.1834182745):0.01260898253):1.504756507,(((t119:0.6280395976,t120:0.5767663923):1.725235643,((t121:0.8367542189,((t122:0.106772933,t123:0.02594437949):0.1723072493,t124:0.1774150254):0.4193357287):1.154198391,t125:1.642062531):0.2477545186):0.1526510802,t127:1.871703174):0.2273010012):0.4936584707,t128:2.577916828):2.511475545):15.68024974):1.04199498,(((((((t129:0.1949594691,t130:0.158341235):11.36151126,(((t131:0.9689391284,t132:0.9555162159):0.05819664754,(t133:0.03929994994,t134:0.02061335549):0.6423077943):9.718319754,((t135:0.2301254236,t136:0.1841550834):9.586005908,((t137:1.302933279,t138:0.9565742034):6.573214164,t139:7.474468161):1.709785218):0.2525383838):0.6894397136):0.5384141769,(t140:9.764435222,(((t141:0.4667748545,t142:0.4397466203):5.472077778,(t143:4.881389982,((t144:0.7298976623,(t145:0.3371709711,t146:0.2849121834):0.08906481342):1.27201281,t147:1.547722983):2.846796729):0.9625988013):3.023276592,(t148:5.087850089,(t149:3.827411986,(t150:0.2811068366,t151:0.26061523):3.511965395):1.155175327):3.139004862):0.6587256486):0.8891848254):0.0001294261274,(((t152:6.675325634,t153:6.657130057):0.4592595821,(t154:2.191702087,t155:2.182097464):4.825298441):1.621959607,t156:8.624425594):0.7705695775):1.457546629,(((t157:1.585064057,t158:1.549405551):6.741795111,(((t159:4.669025786,(t160:4.396519485,t161:4.217063477):0.02138715307):2.001222517,(t162:2.869658654,t163:2.801670521):3.166996082):1.494555644,t164:7.4419096):0.04668240383):0.536994726,(((((t165:1.564166252,t166:1.545743381):3.46218972,(t167:3.162301598,t168:3.049417361):1.816819638):2.18847989,((((t169:5.863120143,(t170:1.26907523,t171:1.239367843):4.57671822):0.3333880345,t172:6.145274678):0.06807073707,((t173:3.569034643,t174:3.493483935):0.7717795774,((t175:2.375800158,t176:2.272503888):0.4288349151,(t177:2.231263405,t178:2.189169834):0.4587073644):1.42823517):1.684865191):0.2836088717,(t179:5.385774487,t180:5.175920329):0.6159316391):0.3933055777):0.343219554,(t181:6.125357257,t182:6.081018655):0.3025090856):0.4078598911,(t183:6.349849331,((t185:3.780235608,(t186:3.210923594,((t187:1.695232217,t188:1.664367096):0.2647529411,(t189:1.737338849,t190:1.633592035):0.07985447861):1.188959217):0.4697191837):1.661346603,t191:4.787453565):0.0430486843):0.2241566244):0.05892704641):1.847904294):0.6903149093,(t192:2.480476896,t193:2.448036994):5.047294156):0.2566400951,((t194:4.444929381,t195:4.418492497):0.6086119589,(((t196:3.348567761,t197:3.174559044):0.3901992702,((t198:1.700019,t199:1.676643384):0.145955417,(t200:0.6836348995,t201:0.6314806676):0.9217606314):1.687332146):0.5390512134,((t202:2.222651883,t203:2.213245564):0.2225001169,(t204:2.377801564,t205:2.376651821):0.04448570705):1.235399228):0.5292574642):2.615410339):7.277555582):1.819743401):1.632739308,(((((((t207:0.0248618744,t208:0.02313824963):3.00141681,(t209:1.084386004,t210:0.9817659373):1.897008669):1.919654444,((((t211:0.2483816415,t212:0.1046112546):3.410521718,(t213:2.255135682,(t214:0.6788847656,t215:0.6143053789):1.334707598):1.244862792):0.4545515318,((((t216:2.199883091,((t217:1.340188377,t218:1.328937879):0.2415367027,t219:1.468531373):0.5662869038):0.09976837924,t220:2.04830554):0.03918932577,t221:2.082090454):0.578157748,t222:2.622993826):0.7143598991):0.02184866698,((t223:1.785098293,(t224:1.228431727,t225:1.096497788):0.5227940655):0.3542127145,(t226:1.639785757,t227:1.591541169):0.2908540604):1.140356028):0.5420541636):0.3101030017,(t228:2.646902082,(((t229:0.2117506251,t230:0.2067941492):0.9452943685,t231:1.113386768):0.7483628156,(t232:1.182585446,t233:1.008377704):0.2105065541):0.6546559184):1.171216456):4.882522136,(((((t234:1.314590563,t235:1.299488465):0.8799329973,(((t236:0.1201259994,t237:0.06756944513):1.593301204,(((t238:0.3938704728,t239:0.03569208126):0.3469665401,t241:0.1399454321):0.1847193651,t242:0.3096950879):0.6079790065):0.2861171772,(t243:0.8262137901,t244:0.8088999847):0.3351494732):0.1586386803):0.202006348,(t245:1.134043991,(((t246:0.2649302407,t247:0.2370737533):0.4149943726,t248:0.5839516096):0.2108815967,(t249:0.3929884227,t250:0.3720598089):0.375813384):0.1900841358):0.3170804315):0.17605271,t251:1.173826662):0.2463567422,t252:0.9849667893):5.099092123):2.165249421,(((t253:2.415760341,((((t254:0.3583490494,t255:0.0195830338):0.5699784567,t256:0.5114449506):0.04224958295,t257:0.3777850936):0.5109968433,t258:0.5793729225):0.8057018771):0.02309209326,((t259:0.6955140125,t260:0.6179932378):0.630116627,t261:0.9364420407):0.01735324431):4.41359607,(((t262:0.6000981248,t263:0.5328385919):0.255302749,t264:0.7255217321):0.04214867601,t265:0.6754518125):4.358606847):1.30540286):3.601448053,(t266:9.520438536,t267:9.435342021):0.3865074342):1.287456396):0.3125195461):7.729148492):0.6344112824):1.034872927):0.1039576434,(((((t268:8.752736057,(((t269:1.872398801,t270:1.862171701):1.096504344,t271:2.859548757):5.390575963,t272:8.240287459):0.3825350257):0.7311091358,(((t273:1.352200362,t274:1.325388515):3.700168073,t275:4.975289935):2.701056982,t276:7.656416889):1.564299497):0.6050213245,((t277:0.5070321298,t278:0.167805373):7.707707996,t279:7.623908122):1.570540466):2.365191092,(((((t280:1.218358644,t281:0.9913805803):0.06575379142,t282:0.8869111026):3.89871233,t283:4.764486364):3.146232491,(t284:6.575928027,((((t285:4.432436676,(t286:1.583268243,t287:1.567741975):2.474437617):0.6150664326,t288:4.635591454):1.016985286,((t289:0.5838863104,t290:0.5602080346):1.584834557,t291:2.133820426):3.344087551):0.3508677386,t292:5.725398438):0.01945703715):1.239385624):0.4745783855,(t293:2.690182458,(t294:0.2433064487,t295:0.1571190926):2.441232481):4.615016449):2.44730958):7.788799587,(((((t296:5.222915716,(t297:4.248194159,((t298:3.189344578,t299:3.060681767):0.3520580023,t300:3.279691704):0.6619560665):0.7008024669):1.635374174,(((t301:5.823904894,((t302:5.261997609,(t303:4.22245704,t304:3.964441748):1.030317719):0.2616383149,(((t305:0.7726954505,t306:0.6214682017):2.915163621,(t307:2.026349667,(t308:0.1992392341,t309:0.03426286409):1.792671735):1.245030653):1.372549805,((((t310:3.17227845,t311:3.078845205):0.2164149475,t312:3.193606881):0.3429890924,t313:3.448546132):0.009501698315,t314:3.40954093):0.683201199):0.1692302319):0.1322236989):0.1236558039,((t315:2.082002966,t316:1.965090798):0.8636886335,((t317:1.747794378,t318:1.64818245):0.5832800717,((t319:0.1310082823,t320:0.1142197177):1.825724153,(t321:1.820582451,t322:1.756658929):0.09109950898):0.1800542204):0.4200078603):1.324460884):0.1810925672,((t323:2.48908632,t324:2.47834864):0.4034358349,t325:2.739820286):0.8863996445):0.07284862714):3.715822893,((((t326:2.059302706,t327:1.863738202):0.8582602747,(t328:1.848165837,t329:1.823312396):0.7334919275):1.460602305,((t330:1.9308389,(t331:0.9210123314,t332:0.9030233172):1.005966897):0.4287312198,(t333:2.02822382,t334:1.890227939):0.2941852939):1.622192842):0.4388148791,(t335:1.115324218,t336:1.03287746):3.126984068):2.511187659):6.68124505,(((((t337:2.88390817,((((t338:1.889101239,t339:1.830988379):0.0620561489,t340:1.803543236):0.6117549215,((t341:1.677167412,(((((t342:0.2470359536,t343:0.2005816986):0.07344411104,t344:0.1230526121):0.9963411935,t345:1.109127392):0.04701819614,t346:0.8964375452):0.2199826731,((t347:0.6307722257,t348:0.5147712525):0.2325702306,t349:0.2417280364):0.1287872687):0.05695597346):0.3350977522,((t350:0.3211294031,t351:0.3030076655):0.4103124869,t352:0.6906913995):0.01940595675):0.3189757694):0.05141050156,(t353:0.7565860309,t354:0.690568257):0.255378899):0.2592542595):1.104779482,t355:2.217731482):3.82216204,(((t356:0.2441065853,t357:0.2347309646):1.125301779,(t358:0.9165353072,(t360:0.2857211078,t361:0.2382934517):0.3573422376):0.0919550982):0.3226883424,(t362:0.3099774949,t363:0.192400622):0.3658305256):4.343456813):2.821060496,(t364:0.5527447215,(t365:0.4826402916,(t366:0.06057781141,t367:0.009073700492):0.400413919):0.01082187236):7.156086943):2.26700059,(t368:9.359509988,((t369:1.581523902,(t370:0.64180515,t371:0.3631062572):0.7859792628):0.02467717395,(t372:0.5029957046,t374:0.1525156562):0.3805430486):7.491175759):0.3924697413):0.4272380022):0.0475428868,t375:8.806526545):0.05210729677):0.4090664088):0.2991389684):6.927655173,((((t376:7.797116362,(t377:2.652264821,(t378:0.2663171188,t379:0.1915144426):2.382293157):5.140410839):1.767894378,t380:9.32345251):0.8993812012,(((t381:8.565288176,((((t382:0.03918450152,t383:0.03575563257):0.2498338141,t384:0.2030229861):7.646621819,(t385:2.010874756,(t386:0.1734433616,t387:0.1385913714):1.816008451):5.77216257):0.3187314992,t388:8.031379684):0.2118872757):1.405406181,(((t389:0.7446125654,(t390:0.3840749689,t391:0.3238578091):0.2908096109):3.381069444,t392:3.91259645):2.869658616,(((t393:0.07761565249,t394:0.008663912097):0.6795730609,t395:0.4758108782):2.105822632,t396:2.529141865):3.846113733):2.638171569):0.1747370162,(t397:6.259052601,t398:6.214040596):2.880559034):0.01155616485):0.7026309673,(((t399:0.2484074051,t400:0.08434276168):7.326646334,(t401:6.892537892,((t402:2.178242219,(t403:0.6048663603,t404:0.5428489874):1.481780053):2.622489516,t405:4.514636341):2.013834274):0.4781162298):0.5403083676,((t406:3.978783839,t407:3.802583363):2.146094043,t408:5.795051738):1.414462893):1.670694842):5.304064099):4.457950311,((((t409:0.9483728808,t410:0.8751566469):2.673948431,(t411:1.632065473,t412:1.628054257):1.839013417):4.570417557,(((t413:6.217593282,(((t414:3.798505905,((t415:2.189946122,t416:2.155333171):0.1780205636,t417:2.329730852):1.428921309):1.476961014,t418:5.208972155):0.8740778616,t419:6.051088695):0.06325371559):0.6671556845,(t420:0.6932150885,t421:0.4981239336):5.903400026):0.6347227241,((((t422:3.139071559,((t423:2.032497355,t424:1.965476018):0.6029461402,t425:2.560686227):0.4896491621):2.135461028,t426:4.867889812):0.5771563904,((t427:4.945173718,(t428:4.438662849,((t429:1.65168215,t430:1.555753548):2.582969343,t431:4.131439548):0.1538311276):0.2984842849):0.2330838012,t432:4.698565698):0.2600791271):0.716671016,(t433:3.751969205,t434:3.700612494):1.895014936):0.3571033508):0.3386097899):1.201708712,(((t435:0.4292140164,t436:0.3755159502):4.319188891,(t437:1.13575514,t438:1.097632116):3.493308764):1.886836997,(t439:6.25144591,(((t440:0.8235349155,t441:0.6855708196):5.095334941,(((t442:4.063679671,((t443:3.497485467,(t444:2.916726003,t445:2.880160906):0.3350954949):0.1069394793,(t446:2.890240777,t447:2.652647242):0.4065326255):0.3334329942):0.3376865885,t448:3.621239285):0.8126876566,(((t449:1.99479311,t450:1.947784693):2.037952885,((t451:2.609218045,t452:2.577486231):0.972620768,(t453:0.3676719395,t454:0.2719379476):3.163542495):0.3225224642):0.1113926002,t455:3.796763962):0.2377699314):0.5430136699):0.06529034941,(((t456:1.748187991,t457:1.648653043):1.445813396,t458:2.986815748):0.5040550549,t459:3.383000421):0.7554016354):0.06960379236):0.09804663226):0.7727995694):9.239310057):38.33936652,((((t460:0.3269576746,t461:0.3011148748):2.494828232,(((t462:1.710865493,t463:1.563750362):0.5795775365,(((t464:0.03843733134,t465:0.03246731988):1.00892585,(t466:0.3709156448,t467:0.3478741222):0.6598437932):0.5190775554,(t468:0.5461611779,t469:0.4668280616):0.9762711751):0.5300396291):0.2880712759,(t470:1.922207448,(((t471:0.458989152,t472:0.3996746636):0.7497233782,t474:0.8960996404):0.2207666431,t475:1.046399253):0.3796569473):0.3093763174):0.203923332):0.8430997573,((t476:0.285952993,t477:0.07224128607):1.114010514,t479:0.8308515983):1.350773725):0.7513459365,(((t480:1.166875569,t481:1.126733726):0.02914895961,((t482:0.5061558462,t483:0.1785101891):0.1771333092,(t484:0.25717599,t485:0.2143427926):0.09180511013):0.2421251149):0.3857483062,t486:0.8450972005):1.318575788):48.15890705):35.8392897);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T14.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
