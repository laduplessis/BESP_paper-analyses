<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t450:0.230265779,t451:0.2297827979):1.531407602,((t452:0.9724943533,t453:0.9555249402):0.05800367335,(((t454:0.3828281208,((t455:0.05386886856,t456:0.05323413405):0.2265167347,t457:0.2777086138):0.05166241262):0.06816358235,t458:0.1559873032):0.01480245773,t459:0.05436165717):0.471609317):0.6626489139):11.14217075,(((t460:1.094522572,t465:0.2188757867):0.2066113818,t466:0.3955629597):5.744051043,(t467:2.623259163,(t468:0.20310917,(t461:0.668726183,((t462:0.1726029211,t463:0.1323842764):0.4018459935,(t464:0.02117624711,(((((t446:0.0641471014,(t444:0.03686910229,(t355:0.2895550741,((t351:0.0009868947928,(t350:0.2225565286,(t333:0.2181659022,(t256:0.02606313101,((t251:0.01499032624,(t241:0.007974386368,(t238:0.1180493474,(t233:0.05524839264,(((t223:0.215869863,(t218:0.4005560431,(t216:0.2916809383,((t188:0.02837622643,((t141:0.02300109667,t142:0.005475632375):0.1270619215,((t124:0.0973831685,((t1:4.647223223,t2:4.618424116):6.570469285,((t3:8.367772046,t4:8.332910043):1.739834504,(t5:7.901541694,t6:7.899494536):1.801402728):0.2441863173):0.9427816254):1.108515073,((((((((((t7:0.8839528284,t8:0.7264349551):7.032869265,t9:7.489024926):0.04505020406,t10:7.473457229):1.255937287,t11:8.708317817):0.1420335955,(t12:1.491641384,t13:1.446356592):7.307081276):0.03931665477,(((t14:2.335832534,t15:2.29848753):5.741481381,((t16:1.050969334,t17:0.9520421713):5.316273723,t18:6.073111602):1.661939984):0.1904595749,t19:7.799938199):0.4923354339):0.462311219,t20:8.687794469):1.106747229,(((t21:5.226725482,t22:5.125508135):1.562378722,t23:6.680809525):1.634780843,((t24:3.601914252,(t25:1.305033699,t26:1.295812237):2.083559878):2.701695334,((t27:1.348910489,t28:1.214657244):3.162676665,(t29:2.086895553,t30:2.061192362):2.259952446):1.519085172):1.936813872):1.360188447):0.2063781431,((((((t31:5.745408606,t32:5.591373305):1.879264036,(((t33:2.029940231,(t34:0.7116371809,t35:0.6101663794):1.2102495):4.780284886,t36:6.596237937):0.5597439423,((((t37:5.370936741,(t38:0.2236933892,t39:0.1973472855):5.108852315):1.065028192,(t40:0.1480168853,t41:0.07152037596):6.157629633):0.2763727173,(((t42:3.102218285,t43:3.089799292):0.8634881551,t44:3.935522197):1.877186251,t45:5.667669509):0.6271781462):0.301073076,(t46:5.596257057,(t47:5.371946461,(t48:3.541222978,t49:3.537446534):1.805462357):0.1734563226):0.9819181878):0.08356205896):0.005405424485):0.366908816,((t50:2.221331546,t51:2.19363646):2.300582132,(t52:2.099953932,t53:1.793469701):2.080689319):2.037306072):0.06977212232,((t54:5.487753318,t55:5.396999953):0.07247243398,(t56:3.829412137,t57:3.736031306):0.9299696818):0.3923169316):0.09249868365,(t58:4.960493704,((t59:1.495763507,t60:1.327607285):1.143459475,t61:2.276049499):2.302010225):0.08561026689):0.2008660355,(t62:3.828966383,(t63:1.227058772,t64:1.211981693):2.464424863):1.022470288):0.9773226407):0.5193332421,(t65:3.377224947,(t66:2.871234905,t67:2.829430889):0.497658611):2.585709214):0.2871350194):0.7982160213):5.276455381):0.2125553594,((((t68:2.331672791,(t69:1.145633881,t70:0.9982308103):1.071679447):0.9566366769,(((t71:1.757715855,t72:1.579676643):0.01654550615,t73:1.591566597):0.5191491005,t74:2.054444167):0.3514228028):1.781745413,((t75:2.250893511,(t76:0.5773758424,t77:0.5319059441):1.601370463):1.799516936,((t78:3.491469238,(t79:0.6182835864,t80:0.5679284803):2.777265042):0.02043984905,(((t81:0.5425645609,(t82:0.2022492475,t83:0.1845923186):0.182374312):0.7058460795,t84:0.9832460468):0.1561016076,t85:1.048829818):1.858717235):0.4175545326):0.1010277984):0.6389384363,((((t86:1.399686184,(t87:0.8685365178,t88:0.8492183754):0.5128577832):0.2337352756,t89:1.532638531):0.6211075205,((t90:0.445083266,t91:0.4118165038):1.372991634,(t92:1.402312278,((t93:0.7612560491,t94:0.7021849944):0.04156446103,(t95:0.4427259846,t96:0.1909262559):0.01380564842):0.4869370224):0.2280470883):0.2703534285):1.640565556,((((t97:0.6625911744,(t98:0.400980301,t99:0.370487145):0.2525930222):0.2037085488,t100:0.7109807385):0.05767726209,(t101:0.4935699783,(t102:0.4638328244,t103:0.4465255904):0.00295799728):0.27346114):1.205901389,(((t104:0.538868051,t105:0.4242252181):0.1278840985,t106:0.5358984491):0.7874900773,((t107:0.4857435332,t108:0.3258324246):0.4042855114,t109:0.5770709978):0.3222578199):0.4536088295):0.5088406503):0.1458718406):6.749071652):1.705095492):0.5739768405):0.5182876234):0.508132879,(((((t110:0.3582278163,t111:0.2572874598):0.08922296937,t112:0.2777456248):5.637312784,((t113:2.441346399,(t114:0.09724146077,t115:0.08880652251):2.201976205):0.6719716074,(t116:0.8993513996,t117:0.8762747326):1.774675663):2.706704004):4.640513459,((t118:1.206363508,t119:1.060490726):7.488166655,((t120:0.08541754902,t121:0.04905070913):5.566873182,(t122:0.1248862237,t123:0.07620371421):5.453157412):2.770528194):1.177275169):0.6284769863,((t125:4.622515015,t126:4.519568709):5.148972049,((t127:0.7426091377,t128:0.5705761775):3.263790271,(t129:0.3307287045,t130:0.3090734318):3.37374943):5.565385756):0.1513828467):0.7035302739):0.08033420528,((t131:7.068660798,(t132:0.1924768276,(t133:0.09446991428,t134:0.09205937113):0.08951789454):6.850842965):2.74467891,((t135:7.689929646,t136:7.660338881):0.5343221754,((t137:0.2860023048,t138:0.09808709283):2.930203708,t139:2.995616793):4.586742539):1.39908759):0.2644222708):0.9728979478):0.5983165858):0.06646901328):0.7707003547):0.2880836326,(((((t140:8.043523958,(t143:2.838044997,t144:2.814199916):4.915694534):0.834020925,((((t145:2.813977887,t146:2.691548762):1.509008201,(t147:0.592301828,t148:0.4210847869):3.351030787):3.768181531,t149:7.321963443):0.3195794805,(((t150:6.257286802,(t151:4.789827308,t152:4.764126065):1.279070952):0.8253763902,t153:6.813803157):0.176981753,t154:6.902516152):0.220061678):0.08839964419):1.621485232,((t155:5.306243833,t156:4.992903026):1.568150176,(t157:4.946579847,(t158:4.192935794,t159:4.160110135):0.577847861):1.57116909):1.724784267):0.2888375778,(((t160:0.4203584683,t161:0.3722430514):5.698917808,(((t162:2.863546859,(t163:2.561771418,t164:2.531231911):0.1928932092):2.453857138,((t165:1.183620609,t166:0.5795371292):1.989496379,t167:2.542091697):1.85542308):0.1524563715,(t168:3.027064792,t169:2.863699971):1.334649807):0.4993789962):0.06585602802,(((t170:1.058900617,t171:0.9110607864):3.010001442,((t172:2.696652321,(t173:0.6917842866,t174:0.6904744033):1.827353309):0.1119424657,t175:2.59709151):1.091572389):0.03952504585,(t176:2.834417046,t177:2.692161412):0.8149689138):0.6323221177):2.12131869):0.2544615727,(t178:5.809447739,((t179:5.388474773,((t180:3.612319465,t181:3.454102074):1.547259048,((t182:2.717420448,t183:2.640787225):0.9188934038,((t184:0.1956705754,t185:0.194632107):3.001295559,(t186:2.034837226,t187:1.881439666):1.002743586):0.3220224269):1.249111683):0.138180519):0.0216683345,((t189:3.009623379,((t190:1.614858062,t191:1.559944701):0.8928106528,(t192:1.407023841,t193:1.321422076):0.9772053463):0.4834800261):1.015212725,(t194:1.503380578,t195:1.371571648):2.162521525):0.4857152789):0.3302132019):0.6692786547):0.7110695136):0.1086676042):7.518743827):2.894225187):0.040723515):0.3902246108,(((((((t196:1.263905585,t197:1.242939274):1.266268138,(t198:1.743739478,t199:1.701426728):0.6074771022):2.485008665,(((((t200:1.636069247,t201:1.605782983):0.8068576591,(((t202:2.031723674,t203:2.030170641):0.0808672223,(t204:1.008388054,t205:0.9699927432):1.084163037):0.1050780899,t206:2.130711349):0.151889885):0.3318050587,(t207:2.462274678,(t208:0.6939221201,((t209:0.1124619462,t210:0.1097126098):0.5459668709,t211:0.5558011919):0.02747363862):1.683532892):0.07139461848):0.1532587581,t212:2.457372467):0.3610920342,(((t213:2.156777378,t214:2.116660237):0.2410818736,((((t215:1.099910656,t217:0.5698484608):0.9350040343,(t219:0.1943231044,t220:0.1687067259):0.545239461):0.09078130957,t221:0.7972742155):0.1068321666,t222:0.8647440582):0.08770278956):0.1954735726,(t224:0.2208754601,t225:0.0787299805):0.5849760697):0.204080972):1.503222519):8.49320537,((t226:0.5981913978,t227:0.5149253337):4.985362491,t228:5.478612362):5.154456958):1.251073436,(((((t229:0.5394661069,t230:0.05707186987):1.241322797,(t231:0.3471184391,t232:0.2836523531):0.7266180051):0.9025656944,(t234:0.4394126749,t235:0.3873531045):1.04168306):0.5345200415,t236:1.696111809):0.5099810769,t237:2.201064624):8.152880008):0.3982860099,(((((((t239:0.0723306719,t240:0.07002874518):2.074565532,(t242:0.09058866533,t243:0.06788366684):1.796193759):0.2971509267,t244:2.078768321):2.234333661,(t245:3.209251796,(t246:2.68869793,t247:2.541516994):0.5058829989):0.9650303893):0.1090269423,((t248:0.3871872954,t249:0.3784087741):0.2560991254,t250:0.5481830624):3.462348588):1.58135643,t252:5.338403085):3.688161436,((t253:3.644078152,(t254:0.3018855666,t255:0.2502095759):3.304670039):2.800705618,t257:6.284830662):2.540756039):0.550108429):1.187432883,((((t258:7.13349333,((t259:1.074105846,t260:1.069147667):4.943542139,(t261:1.70406779,t262:1.696754088):4.307515925):1.089713702):1.491431101,t263:8.554691868):0.9995640103,((((t264:0.4548013731,t265:0.4165040319):4.41932753,(t266:1.05612504,t267:0.7038619719):3.479653869):1.6456978,(t268:4.119671093,t269:3.941229853):1.597783741):2.876423393,((t270:7.478271662,t271:7.22339856):0.515261436,(t272:1.6217865,t273:1.460837443):6.064022131):0.414047863):0.07414351254):0.2561091504,t274:8.23925807):0.6764421081):0.2796399487):0.3073227208):8.649195262):0.2285125447):0.1767823954,(((t275:4.978632101,((t276:2.653888494,t277:2.55767828):0.241042479,t278:2.707303579):1.867298212):1.778960236,((t279:5.993369194,((t280:4.224975967,t281:4.18003475):0.6431514244,(t282:4.438053026,(((t283:0.9060271707,t284:0.8008041386):0.1005225146,t285:0.8419255317):1.231919649,(t286:1.126214023,t287:0.9106564154):0.6475025454):2.192024102):0.371091527):1.106965276):0.1839621622,(t288:5.007226949,t289:4.92637287):0.1620311214):0.1459150184):9.486503985,(((t290:8.942489112,((t291:5.896542135,t292:5.666025054):1.860477602,(((t293:2.06823289,t294:2.024535401):3.024485074,(t295:4.727421653,((t296:3.539822986,t297:3.302127699):0.2549914219,t298:3.394769054):0.8768775075):0.2214490371):0.1432725819,((t299:3.526574782,t300:3.450561804):0.6903727361,t301:3.984655205):0.3870432097):2.179528337):1.072222781):1.923086494,(((t302:4.409205927,(t303:2.596799965,(t304:2.377733761,t305:2.2856675):0.1851136356):1.756879617):0.4194910811,((((t306:2.077922793,t307:1.928539859):0.2598900724,t308:2.119511736):1.522825887,(t309:1.913660418,(t310:1.747848248,t311:1.354661486):0.1207366251):1.487541163):0.4799959825,(t312:2.992197559,((t313:1.271930913,t314:1.24373481):0.548374829,t315:1.690964614):1.121687979):0.4134822847):0.2977020211):1.22799055,((t316:2.985341271,t317:2.858770329):0.4841465549,(((((((t318:1.490309412,t319:1.281941364):0.4540694941,t320:1.718363757):0.1511990478,(t321:1.022609485,t322:1.02145854):0.5682439242):0.1744483248,(t323:1.729706897,t324:1.694408451):0.002027183765):0.506336311,(t325:1.2180448,t326:1.194975092):0.9375899371):0.3436849932,(t327:1.266264889,t328:1.16531548):1.156450983):0.1778959114,t329:2.475022787):0.0185757291):1.150579858):3.463510033):0.2072269424,(((t330:1.662773064,(t331:1.185130153,(t332:0.9560524935,t334:0.6618188607):0.1544046315):0.2888544269):1.264798068,t335:2.238424047):3.481311339,((t336:0.9160246982,t337:0.8537957331):1.653843782,(t338:0.1356645088,t339:0.09629145372):2.365345106):2.543103011):0.8421957743):3.641649311):2.311241824):0.09453211687,((((t340:1.012512792,t341:0.9191466368):0.05055851921,(t342:0.3008149132,t343:0.2343145829):0.6059361239):1.210657139,(((t344:0.3654410643,t345:0.2021030243):0.1227034431,t346:0.1545352239):0.2064079889,t347:0.3041070334):1.246572441):6.060527377,(((t348:0.9211974921,t349:0.3004793035):0.9989850393,t352:0.4780760069):1.504742765,((((t353:0.6978587089,t354:0.6594379199):0.07174537186,t356:0.1128627927):0.2704959179,t357:0.3600848305):0.2056125623,t358:0.5086837345):0.7059634714):4.131715379):3.543596064):1.081786897,((((t359:0.4411687515,t360:0.390194164):2.814183194,t361:3.170811447):4.970170428,(t362:7.411386783,((t363:3.667640654,t364:3.519785733):3.103396083,t365:6.570150942):0.6183592051):0.5053822542):1.547913932,(((t366:4.774262449,t367:4.630399346):2.586198994,((t368:0.2462141348,t369:0.2138805722):5.788055926,t370:5.949519048):1.129333383):0.3983472364,(((t371:4.528576964,t372:4.222992447):1.353675809,(t373:4.257495103,(t374:1.919152582,t375:1.86148432):2.158921205):1.18866761):0.805655874,((t376:1.993177612,t377:1.968085902):0.2577678588,t378:2.176854465):3.61998134):0.4576128964):1.462125912):0.171967888):0.252481652,t379:8.109370112):0.1220535205):0.07178870603):0.04308632583):0.490340552):2.292459901):3.489082383):5.192544295):12.42832824,((((t380:7.004310632,(t381:4.668235545,(t382:1.947692934,t383:1.866708692):2.691737326):2.276949544):0.5101448267,(t384:6.192412611,((t385:4.460609309,t386:4.235152083):1.374257671,((t387:0.05920701909,t388:0.02192467747):1.877879375,t389:1.658151222):3.662411179):0.3294785537):1.024174371):13.80698702,(((((t390:1.843644472,(t391:0.5548434397,t392:0.5346546238):1.137695776):2.783866911,t393:4.336706781):1.652872992,(t394:5.385731696,t395:5.241511713):0.5129507759):2.091704516,((((t396:2.808747718,(t397:1.578826035,t398:1.571369527):1.224717763):1.301723495,t399:3.949741881):1.644312761,((t400:2.692212326,t401:2.605032827):2.859428758,t402:5.358288617):0.001229840168):1.133089802,(t403:6.415435314,(((t404:4.710104758,(t405:4.570351303,(t406:2.599458295,t407:2.385334932):1.936161535):0.1233811803):0.01332557225,t408:4.427712068):1.194693761,(t409:4.954235032,((t410:3.379883089,t411:3.245872257):0.7358670546,t412:3.839181116):0.6879777545):0.5916362434):0.3814946932):0.04120068609):0.9088158774):10.9710573,(((t413:4.44338608,(t414:0.5250319391,t415:0.498679215):3.797945884):0.5256803451,((t416:1.893517108,t417:1.823809846):2.707952727,(t418:4.477644041,t419:4.467484339):0.02444512458):0.06898424533):2.318208559,((t420:3.125423463,(((t421:1.367081368,t422:1.320519587):0.2880515594,t423:1.376777476):0.7440530583,t424:1.948925847):0.7158100842):1.008514075,((t425:2.180000114,((t426:1.661094097,t427:1.346459803):0.4104488991,(t428:0.564323323,t429:0.5281506592):1.163453272):0.07578165483):0.4964975663,(t430:1.438518335,t431:1.292532154):0.7338169873):0.8950549836):2.470256665):9.982617325):0.9072706264):10.33604087,(((((t432:0.8626334036,t433:0.8549740927):0.9113192182,(t434:0.8049018737,(t435:0.589435848,t436:0.5545502408):0.1262623941):0.8564619798):0.5675008017,(t437:1.62369504,(t438:1.612290302,t439:1.592699143):0.006892121156):0.4009864564):0.1142616625,(t440:1.269435823,(t441:0.5074879492,(t442:0.1118145528,t443:0.02006002272):0.09669358919):0.5969009479):0.8411208861):0.8354348145,((t445:0.6090191607,t447:0.37013548):0.398832209,(t448:0.2508892361,t449:0.1520818104):0.3711512796):1.021852644):23.32470122):0.5202413068);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T85.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
