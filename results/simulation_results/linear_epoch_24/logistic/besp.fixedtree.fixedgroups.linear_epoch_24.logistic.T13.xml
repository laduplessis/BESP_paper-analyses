<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((((t457:0.3023298105,t458:0.1154072468):2.288919549,t459:2.384100249):0.2801626876,(t460:1.130493994,t461:1.063913322):1.513898537):0.2662417128,(t462:0.9907326773,t463:0.8993098945):1.848903968):0.2228270476,((((t464:0.3726911947,t465:0.1224595212):0.7271503951,((t466:0.3036416919,t467:0.282337722):0.06091586004,t468:0.2823441553):0.4689202029):1.171428122,(t469:1.549855183,((t470:0.2797870508,t471:0.2636094892):0.6647802729,(t472:0.4008929078,t473:0.2793375985):0.0847816891):0.367415184):0.3283984971):0.4256166223,(t474:0.8093295044,t475:0.6091009805):0.5971428516):0.2026749412):0.388896297,(t476:0.801240913,t477:0.707822637):0.5044207675):0.02122066633,t478:1.18763812):1.448894009,t479:2.572724094):22.77615064,(((t480:0.3742937503,t481:0.3548151941):2.374505967,t482:2.726381333):0.8682468219,((t483:0.8118970097,(t484:0.6037675327,(t485:0.4500526354,t486:0.3697539793):0.1172453931):0.1501636652):0.6958413033,(t488:0.4209365963,t489:0.1842990804):0.4789166028):1.970643615):21.61965372):11.80039081,(((t490:10.08171833,((((t491:0.1016951343,t492:0.0651482195):0.02050088896,t493:0.07457551121):0.01775794258,t494:0.08385140364):0.8481597575,(t495:0.1731526481,t496:0.1299085032):0.6580592739):8.980901275):2.184285442,((t497:2.812077425,((((t487:0.2452672279,((((((t382:0.05827268633,(((((t262:0.4754610948,t263:0.2638868444):0.197398807,t264:0.302147378):0.01938717856,((t246:0.00222266855,((t242:0.05740904157,(t237:0.1958673221,(t198:0.03094040264,(t151:0.02825223243,(t128:0.00216076864,(((t1:6.312182174,(t2:4.699117978,(t3:0.635794449,t4:0.4401600015):3.331578761):1.513561381):3.880797188,(t5:8.687110335,t6:8.627265593):0.2853660317):0.5157072452,(t7:5.650709865,t8:5.572115184):3.709774333):0.7310557236):2.815783314):3.886524014):3.523077987):0.561812274):0.07465418304,((((((t9:1.23322907,t10:1.194365713):3.694031241,(t11:0.9223443468,t12:0.7776579129):3.804225857):3.145732455,(t13:4.722963034,t14:4.653577451):2.984170979):1.129846648,t15:8.519741634):1.18788546,(t16:6.353093383,((t17:2.331572557,t18:2.228472453):1.492134188,t19:3.505860181):2.489741174):3.348195787):10.04101731,(((t20:7.155977832,t21:7.116972554):0.2638468301,(t22:7.027413793,(t23:3.646689445,t24:3.462936699):3.356288012):0.0365364296):1.127659652,((t25:1.422797438,t26:1.328945268):6.311649949,t27:7.509440666):0.09080400676):10.78743871):0.4423476435):0.09160789708):0.2206222946,(((((((t28:7.773440331,((t29:4.245638054,t30:4.173501933):1.560908589,t31:5.730733647):1.837091877):1.560280337,((((t32:5.946488248,t33:5.91406429):1.453413732,((t34:1.796305778,t35:1.621977803):2.446068839,(t36:2.721113753,t37:2.599006708):1.218488622):3.122223938):0.8638463694,((((t38:1.614747566,t39:1.587015535):3.661077926,(((t40:2.652993455,t41:2.638281161):0.3773877958,t42:2.929956163):1.836592108,(t43:2.100283265,((t44:0.1025002654,t45:0.004392503258):0.9490970123,t46:0.8142481964):0.9161241551):2.656729576):0.1932989439):1.533466679,(t47:5.551345998,(((((t48:0.7106205295,t49:0.5769295404):3.009534216,t50:3.340268332):0.4910689361,t51:3.717577368):0.8411662889,(t52:4.417042416,t53:4.35372797):0.03588736321):0.3676459219,t54:4.746273014):0.1067312774):0.3735513201):0.01586518857,((((t55:1.926993349,t56:1.899872124):1.507225893,t57:3.369512286):1.291982571,(t58:3.592835214,(t59:2.880559604,(t60:0.4672413213,t61:0.442093799):2.258358813):0.6906521774):1.023408527):0.1137197868,t62:4.407354948):0.3160313303):0.9775929431):0.5187694068,t63:6.18946188):0.3084687578):3.482475691,(((t64:1.725336648,t65:1.670815564):0.4018606731,t66:2.045034462):1.768854335,((t67:3.436646332,t68:3.434582885):0.3228541634,(t69:2.592811469,(((t70:0.7427420537,t71:0.6773923626):1.19923511,t72:1.569806712):0.3785452762,t73:1.947872037):0.2014553388):1.132472476):0.001243512223):6.038309881):3.649430814,((t74:2.967885431,((t75:1.085604461,t76:1.057949025):1.779284678,(t77:2.545155762,(t78:2.271225587,(t79:1.982790834,(((t80:1.335678317,t81:1.232140426):0.0540474252,(t82:0.8169620322,t83:0.8161756067):0.3921210395):0.08622513934,t84:1.277394577):0.4698831038):0.06808627483):0.220067797):0.1643921113):0.05399279187):1.400679628,((t85:1.394356005,(t86:0.3108463619,t87:0.2664971381):1.012308759):1.064155071,(t88:2.17863541,(t89:0.8009884646,t90:0.7993360139):1.374503263):0.1610190106):1.189091165):8.420790334):1.817067373,((((t91:1.270011183,t92:1.176005148):0.8849580735,(t93:1.713786523,t94:1.681598819):0.2563317635):0.4309842802,t95:2.2050868):1.379047979,(t96:2.254219513,t97:2.194408198):1.197096336):9.750996421):0.3255665008,(((((((t98:1.573103755,t99:1.473049047):0.6863756231,(((t100:0.08533759289,t101:0.03374760146):0.3989667339,t102:0.4218519756):0.856240291,t103:1.213735147):0.7824169305):0.0915177904,((((t104:0.1595173196,t105:0.09986372823):0.1255207475,t106:0.1276688581):0.04851937697,t107:0.1761111989):1.462184635,((((t108:0.2426184947,t109:0.09039663152):0.1457833278,t110:0.2050273444):0.1287533981,t111:0.2614868169):0.0546130062,t112:0.3012514367):0.4172704676):0.2392525129):0.3436852937,t113:1.271956512):0.8726057874,(((t114:0.8237907286,((t115:0.4634087733,t116:0.4453529049):0.08894956286,(t117:0.2231761321,t118:0.1957500513):0.2987367629):0.08112219504):0.100767577,(t119:0.4879593686,t120:0.4675471484):0.04809779671):0.3872655595,(t121:0.3770684872,t122:0.2865887985):0.4897147341):0.6826694259):6.340869513,((t123:1.875070293,((t124:0.6246407019,t125:0.5420812537):0.7661404832,(t126:0.3795123895,t127:0.3068622102):0.8572398654):0.3508726317):1.226181343,t129:2.50031498):4.6080995):3.381171233,((((((t130:1.026035105,(((t131:0.05327614135,t132:0.05201263138):0.2777831848,t133:0.1195542782):0.3676342859,t134:0.1786546334):0.221057364):1.266616677,t135:1.34071637):0.9869182878,(t136:0.3660546844,t137:0.2067452059):1.948739587):5.755920229,((t138:3.936556522,t139:3.638570333):0.09041661986,t140:3.468159651):3.880021792):0.5621875897,(((t141:0.1369488587,t142:0.1022893953):4.063397025,t143:4.141282866):3.043926432,((t144:3.874112383,t145:3.8023737):0.8170850129,(t146:0.4721776162,t147:0.4515930534):4.080644501):2.31162107):0.6155577404):0.6021469016,((t148:0.3091844334,t149:0.2209811546):4.286428697,t150:4.333345546):3.384083119):0.1789890607):0.08342393548):0.2913664385,(t152:6.370307383,t153:6.359508946):1.764742712):0.2073918786):1.641255008):0.2187439256,(t154:5.618379593,(t155:4.191330879,t156:3.888482085):1.192165658):4.311553552):6.009844062,(((t157:0.9022119414,t158:0.9011874289):7.672142441,((t159:2.147623498,t160:2.097707293):3.861853736,(t161:4.026442835,(t162:2.315332247,t163:2.290686663):1.695164322):1.882754032):2.446247139):5.192634951,(((((t164:3.625657897,t165:3.595665313):2.994943805,(((t166:3.573574846,t167:3.505768461):1.768311334,t168:5.273170962):0.4484604287,t169:5.596224839):0.5722032035):0.6599562386,((t170:3.812071311,(t171:1.498041443,t172:1.461332557):2.283471843):2.222672585,t173:5.941515816):0.7787013601):0.3345388497,(t174:3.99148747,t175:3.777890359):2.771360092):1.229455183,((t176:6.678416642,((((t177:5.250152328,((t178:0.2886695917,t179:0.2625513216):3.97471892,(t180:1.52171285,t181:1.484190537):2.625644549):0.9343470027):0.1560066143,t182:5.095274022):1.11812346,(((t183:0.9884154945,(t184:0.4345564319,t185:0.2748977419):0.3996418115):1.774997321,(t186:2.277619244,(t187:1.152558114,t188:1.143869923):1.111906965):0.04500917329):2.296475919,t189:4.558682596):1.104356879):0.1115424909,t190:5.682245001):0.02999949518):0.43964942,((t191:1.097733498,t192:1.031271571):3.804071804,((t193:4.152549253,(t194:4.039046237,t195:3.922929648):0.003614839017):0.1734249615,t196:4.013127254):0.4119919024):1.227507555):0.6173698055):4.659148447):1.611026456):4.566233728):1.051220661,(((((((((((t197:3.358611111,t199:3.020279389):0.6378548698,t200:3.583106442):0.8577415597,(t201:1.255702338,t202:1.242121501):3.153918903):0.4472784297,((t203:3.460358682,((t204:1.604664629,t205:1.325368434):0.742546214,(t206:0.6998079655,t207:0.6118497959):1.249502854):1.07455817):0.4186413663,((t208:2.175575198,t209:2.164459869):0.433701296,t210:2.47307559):0.7248598038):0.907497364):2.137212182,t211:6.064848237):0.1194424771,(t212:4.149914876,(((t213:3.239660639,((t214:0.7191790516,t215:0.6679243014):0.07498386708,t216:0.6727820089):2.414631206):0.4904930647,(t217:1.811220261,(t218:1.368541712,t219:1.309068194):0.3736073713):1.698549104):0.1948457001,((t220:1.015843324,t221:0.9719717957):1.698103495,((t222:0.5610255059,t223:0.5353906733):1.499056709,t224:1.974584672):0.5674257281):0.8414155249):0.09732121119):1.944801114):4.310608491,((((((t225:1.316429575,t226:1.141182577):0.5512901214,((t227:0.5757537682,t228:0.4053284821):0.8170520696,t229:1.216778465):0.2670826614):0.9499469243,(t230:1.018481195,t231:0.8906854412):1.349651707):0.03012599413,(t232:0.5919994651,t233:0.5787820582):1.651792683):0.04119193408,t234:1.870330984):0.9587737227,t235:2.745570642):5.693229342):4.505663134,((((t236:1.257776678,t238:0.821314305):0.043958935,t239:0.6856688256):2.28303542,(t240:2.778660673,t241:2.729012277):0.1127747597):0.7878044789,((((t243:0.2334280041,t244:0.196359306):0.6381773656,((((t245:0.4228371691,t247:0.3478390641):0.2179223338,t248:0.5466087161):0.09835767236,(t249:0.5299207678,(t250:0.3577016333,t251:0.3560700158):0.07404534756):0.0952695674):0.04206386795,t252:0.5007807618):0.04714919611):0.6518446359,t253:1.117260732):0.3151387019,((t254:0.3793797902,t255:0.3453881777):0.3839096501,(t256:0.5612902984,(t257:0.4902595638,t258:0.4009636494):0.06014741174):0.1475451198):0.514062739):1.677887747):8.570405027):0.1380546166,((((t259:0.4604209492,t260:0.3879325584):0.05445507979,t261:0.4085176275):6.953828273,t265:5.879759626):3.716256418,(t266:8.38285128,((t267:1.425728475,((t268:0.6975008995,t269:0.2454250288):0.05758635694,t270:0.2951300782):0.5037452082):2.110950846,t271:2.843803953):4.784579261):1.16745316):0.1541602134):0.240358837,(((t272:3.470826463,t273:3.437343624):3.693343718,(t274:4.618349339,((t275:0.484271482,(t276:0.3719172456,t277:0.3601950828):0.03649503564):2.422282629,t278:2.794792404):1.69927083):2.383121286):1.828675575,(t279:8.573904206,(t280:5.59139401,t281:5.577468177):2.927708926):0.09625428587):0.1535999256):0.4896561545,(((t282:0.3632035392,t283:0.3127604008):1.987915971,t284:1.724109661):6.280063547,t285:7.968729946):0.4923998531):0.8671897975):0.5307609239,(((((t286:7.028863762,(t287:6.244145392,t288:6.198553965):0.7591433662):0.3239845814,((t289:5.414903271,((t290:3.209776374,(t291:3.098639295,t292:3.043586636):0.09473160975):1.731676073,(t293:3.390690816,(t294:1.143040593,t295:1.132750499):2.237589516):1.474176851):0.442421054):0.3254296825,(t296:4.573045777,(t297:1.534654422,(t298:0.4063348498,t299:0.3727287564):1.119929292):3.024784614):1.038870058):1.523921795):0.5150300374,t300:7.546482321):0.9945455259,(t301:5.091086839,((t302:0.1242053202,t303:0.1234611287):0.7697804751,t304:0.8885592804):4.030888814):3.226866979):0.0230179345,((((t305:4.800512945,(t306:3.485452653,t307:3.449774146):1.286524997):2.309338788,t308:7.043018545):0.2878109274,((((t309:0.5810052395,t310:0.570379479):0.07971494202,t311:0.3853047517):6.178308312,((t312:2.235822428,t313:2.225303267):2.653941303,(t314:4.515860502,(t315:1.510117096,t316:1.497450519):2.970541538):0.2907419434):1.580342565):0.1009128088,((((t317:2.855520408,(t318:1.003192544,t319:0.7692292423):1.748525899):1.887506184,((t320:3.233842763,t321:3.003978874):1.118183892,((t322:2.71488128,(t323:2.205790351,t324:2.162413283):0.2188917522):0.05871149252,t325:2.318294215):1.241489087):0.0146142926):1.507322814,((t326:4.359051926,t327:4.228289147):0.1265597806,t328:4.238989566):0.5375662055):0.03965815975,((((t329:0.9051034488,t330:0.879127786):0.954345647,t331:1.55587574):0.9828343899,t332:2.432283719):0.4130771419,t333:2.355047945):1.55752698):0.08728255842):0.3845650255):0.1556361262,((t334:2.772348658,t335:2.747653696):1.413843564,t336:4.064391848):0.3357615492):0.5177574155):0.6750224682):9.837394026,((((t337:2.446711325,t338:2.348610679):1.585061537,((t339:2.498194312,t340:2.470808923):0.8436129774,((t341:0.5685371967,t342:0.4735120834):2.187704816,t343:2.650674115):0.4687989549):0.5784379294):1.508247529,((((t344:3.044184427,(((t345:2.411725917,((t346:1.524601943,t347:1.427241144):0.5762280523,t348:1.975898314):0.2375279057):0.3566790193,((t349:1.916579924,t350:1.865462997):0.1083004811,(t351:1.152669959,t352:1.057006246):0.7434757646):0.4309409852):0.05619482796,t353:2.229141992):0.01271032297):0.4321293388,(t354:2.112328874,t355:1.931134865):0.5412384767):0.1272805679,((t356:0.7515736552,(t357:0.2832855828,t358:0.2075194757):0.4450228666):0.271043909,t359:0.8585786435):1.560115982):0.5469838575,(t360:1.292235545,t361:1.110598472):1.629029845):1.047088351):8.554955126,(((((t362:0.25667358,t363:0.2131260438):2.312047652,((t364:0.4735229881,t365:0.3372286302):1.346372035,(t366:1.136920825,t367:0.3909666364):0.4766223894):0.6989887048):2.954464943,(((t368:0.3790594154,t369:0.2796529561):0.09346459486,t370:0.3680552078):2.299889289,(t371:0.2849797034,(t372:0.1200825731,t373:0.08064904719):0.09685658522):2.354947183):1.729636268):4.12467419,((t374:1.753888837,((((((t375:0.2196545444,t376:0.1674930157):0.002062259563,t377:0.1395329503):0.01835622937,t378:0.04802868954):0.2777028492,(t379:0.04554810302,t380:0.02134476203):0.1421558278):0.8231211952,t381:0.8465159899):0.3480376275,(t383:0.1847471652,t384:0.008724812969):0.7944334689):0.02912438932):1.080926332,(t385:1.251151547,(t386:0.7417323393,t387:0.5813216441):0.4972488251):0.5821673519):5.500885966):0.04108729507,((((t388:0.01542707755,t389:0.005961142843):0.4081070444,t390:0.08808060331):0.3258596481,t391:0.404476896):1.06669233,t392:1.470642791):5.325824307):2.637474136):1.125918498):0.1547351224,(((t393:3.622286926,((t394:1.833830809,t395:1.756732052):0.6329876612,t396:1.967531751):1.015739563):6.369254465,t397:9.338269828):0.6103386526,((t398:1.671608799,t399:1.331758552):8.055355976,((t400:0.6268963404,t401:0.3731646808):8.600217247,((t402:7.336362989,(t403:0.7897934932,t404:0.7675619456):6.470811948):1.109541202,t405:8.336941809):0.2868654785):0.01253116638):0.1336414486):0.09274786409):0.04436986591,(t406:1.536513638,t407:1.521536786):7.270387035):0.3110148538):0.06157978294,((((t408:1.239165431,t409:1.185284455):1.125362254,t410:2.228511558):5.57167229,t411:7.678379369):0.2669487228,(t412:5.825130249,t413:5.820434423):2.085977031):0.4613639042):0.09808120209,((t414:6.595979226,t415:6.46759992):1.036024157,t416:7.322436212):0.816651611):0.4697796544,(((t417:6.9771268,(t418:1.095365368,t419:0.9229739897):5.859483625):1.052233108,((t420:6.029011688,(t421:0.7716727989,t422:0.7540460188):5.10998299):1.639407916,(t423:6.354280149,((t424:1.08829828,t425:1.045199405):4.863550477,t426:5.849978235):0.3083904976):1.082058495):0.08905195844):0.1400899283,(((t427:7.203826345,((t428:1.53150064,t429:1.346240853):4.811935972,(t430:4.640961464,(t431:1.320828705,t432:1.317871618):3.293444399):1.4145124):0.6934070898):0.07678701197,(t433:6.141213873,((t434:3.62673084,(t435:3.143619283,t436:3.092478509):0.3729783757):1.796605308,(t437:3.90531703,(t438:2.243228712,t439:1.954679033):1.639558469):1.21410319):0.4318530493):0.3752903409):0.07541136157,(t440:3.369216078,t441:3.03343893):2.159002926):0.1126066801):0.3724908774):3.114358171):8.845349726,(((t442:4.358086961,t443:4.261372197):0.04920309606,t444:4.250993252):1.060421971,((((t445:0.5256904155,t446:0.4940507269):2.671471311,t447:3.083852954):0.01740828736,t448:3.038615882):0.8873131462,((t449:1.354443954,(t450:1.072829371,t451:1.018051963):0.2447721689):1.122666666,t452:2.37727155):1.209690891):1.063098001):11.99249699):0.1539885552):22.83475148,((t453:1.694489224,(t454:1.277282091,t455:1.256187726):0.2999330845):1.785135574,t456:3.134703943):36.0695642):0.7676273613);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T13.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
