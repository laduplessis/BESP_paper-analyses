<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t356:4.124909726,(t357:1.094198981,t358:1.067158608):2.984348522):2.438491675,(t360:3.737809846,(t361:2.015265369,t362:1.950125165):1.699894517):2.705196082):1.932598914,((t363:5.978681843,(t364:5.41923621,((t365:3.210990241,t366:3.202672222):0.8874703754,t367:3.886948225):1.262196746):0.5049731475):0.2690051455,((t368:4.167021174,(t369:0.5554841842,t370:0.4673201881):3.57505587):0.9420161154,(t371:3.099237809,t372:3.073157925):1.719253884):0.7719685323):2.015431309):1.053086406,(t373:5.15566658,t374:5.114433476):3.473405563):10.95670651,((t375:6.181483203,t376:5.884928471):1.257838565,(t377:5.906890301,((t378:5.120069429,(t379:4.732775249,(t380:4.608563604,(t381:4.473756336,(t382:4.130798442,((t383:3.673956125,((t384:1.948143296,t385:1.918476246):0.4219045621,t386:2.282285804):1.218975507):0.007912627257,(t387:3.052604065,t388:3.029605833):0.3036520229):0.3996134502):0.3225910009):0.1222099834):0.07811490367):0.3132584266):0.6104290899,t389:4.944613955):0.1341289594):1.122431138):12.00049701):36.11275781,(((((t390:0.8600795952,t391:0.8174763423):0.1827132032,t392:0.9637904255):1.4040263,t393:2.323325332):4.588681126,((((t394:0.8644435016,t395:0.8625441125):3.910073007,(((t396:3.522587801,(t397:0.7393168239,t398:0.7256507846):2.730485284):1.075858212,(t399:4.289217047,t400:3.999403901):0.05586730764):0.02444284766,t401:3.949497362):0.1319529871):0.2019765397,t402:3.877992832):0.6942186828,(((t403:1.125976877,t404:1.093955617):1.894320417,t405:2.901926172):1.315823707,t406:4.191871259):0.1904795587):1.205727814):11.28910751,(((t407:2.847714726,t408:2.678822111):1.098986293,(t409:1.876570172,(t410:1.348167765,t411:1.248692574):0.2199526995):1.648659737):1.192943922,t412:4.300529064):11.63076195):35.97561498):29.32738664,((t413:1.512084064,t414:1.485974916):14.49990049,(((((t415:1.877512402,(t416:0.8259000426,t417:0.7398623085):0.9977998852):0.2992445978,t418:2.019418278):4.01550906,((((t419:2.916299505,(t420:2.540507719,t421:2.319583636):0.358820263):0.155362613,(((t422:1.479413633,t423:1.453616547):0.5572448868,t424:1.988362676):0.4143171481,(t426:1.780254609,(t427:0.8918756968,t428:0.832959128):0.8866310988):0.4214180556):0.2941028392):0.1846542422,(((t429:0.9338541112,t430:0.9013349965):0.8718084864,((t431:1.463636698,t432:1.359530142):0.02317521673,t433:1.367330249):0.1391577617):0.7003207924,(((t434:0.2408916852,t435:0.08722135563):1.43585175,((t436:0.65749527,t437:0.294986675):0.4208629717,(t438:0.1543237346,t439:0.0835195047):0.3983789105):0.2650199111):0.3787547753,(t440:0.9832629619,t441:0.946447524):0.07709737925):0.02079965897):0.1124102967):1.752874443,((t442:0.3451726212,t443:0.222086002):1.460304603,(t444:0.9736520632,(t445:0.09754021808,t446:0.09440374624):0.8371771035):0.6845993229):1.046171248):1.023232635):3.097086092,((((t447:0.629527827,t448:0.2750455753):0.2966827718,(t449:0.4629101287,((t450:0.2127791855,t451:0.1895902295):0.02402612311,t452:0.1872888455):0.2238553216):0.02164357847):1.431500019,t453:1.821488318):0.5308786871,t454:2.058155556):3.882112851):4.605000939,((t455:0.6435527325,t456:0.1278763435):0.5687308571,((((t425:0.04681327011,(t359:0.01892842151,((t340:0.05168301346,(t328:0.1968603038,((t324:0.1347354956,t325:0.07882747127):0.05207342995,((t229:0.2137294555,(t227:0.009769942472,(((t213:0.08246040576,t214:0.0615477194):0.06985067611,((t204:0.03107678864,(t181:0.09679543262,(t118:0.03265515045,(t107:0.01038070541,((t76:0.6362498964,t77:0.5922854979):0.06229582535,(t1:6.014042168,t2:5.69293223):3.871686296):2.260062707):0.6934654352):5.968275317):1.752774118):0.7916027666,(((((((((t3:4.763557101,t4:4.723961312):2.099781774,t5:6.621217214):1.451480201,t6:8.000479464):0.9071428192,(t7:0.8569759227,t8:0.5408288467):7.747925498):1.138033635,t9:9.263902429):1.395439155,((((((t10:2.789272616,t11:2.772219685):2.804546206,t12:5.511023563):1.768288518,t13:6.985469874):0.7916913845,((t14:2.423516236,t15:2.053804715):0.5735240186,t16:2.225431813):4.565014525):0.5770394714,t17:7.309393913):0.5004992515,((t18:2.476920205,t19:2.223401459):3.369838692,(t20:4.293252231,t21:4.180471085):1.292488651):1.871256316):1.399489744):6.954772075,(t22:8.298711286,((((t23:1.564855396,(t24:0.9246794805,t25:0.9156503994):0.4211931208):4.61701528,(t26:5.656154287,(t27:5.271936999,(t28:2.333601559,t29:2.281845675):2.906866246):0.3443314561):0.2321616461):0.8129456797,((t30:2.584690327,(t31:1.426569331,(t32:0.2346957629,t33:0.2259453023):1.067805008):1.122713425):3.335500243,((t34:1.438655209,t35:1.39378933):3.806949704,t36:5.122075007):0.2728714098):0.625938261):0.4828788236,((t37:5.519077431,(t38:4.900282482,t39:4.783389969):0.4580650242):0.7641316826,(((((t40:2.746182519,((t41:0.4939286511,t42:0.4853945689):0.1039369835,t43:0.5800077049):2.040658056):2.214585378,(t44:3.072370344,(t45:1.038278185,t46:0.8416827495):1.88503339):1.500166706):0.5242370591,(t47:4.314167051,t48:4.177746475):0.3660430226):0.08575479583,((t49:0.7573209294,t50:0.7354108119):2.898563099,(t51:2.194835549,t52:1.959002197):1.430652775):0.915557028):0.268900869,(t53:1.901796958,t54:1.879161865):2.232040869):0.02090217766):0.1178841097):0.7666390685):7.341039005):1.242443542,(((((((t55:3.111184377,(t56:1.37273345,(t57:0.9037462623,t58:0.8366391576):0.4181736257):1.655946774):0.7176122519,((t59:0.133560195,t60:0.116474253):3.267337117,((t61:1.47020071,t62:1.335609419):0.00258284309,t63:1.334008583):1.64354006):0.1969831447):1.372440195,(((t64:2.623073354,((t65:1.475651947,t66:1.426487819):0.5628480005,(t67:1.146238833,t68:1.012764946):0.7552544521):0.3857312193):1.720012326,(((t69:0.6923290804,t70:0.4906395823):0.1285586928,t71:0.6071046911):2.345733804,(((t72:1.196244326,t73:1.150505237):0.2480936675,t74:1.243230358):0.8200471958,((t75:1.134768792,t78:0.08941993358):0.04422634552,t79:0.0429460844):0.8289506785):0.5655331623):0.6973790469):0.01311384757,(((t80:0.6423252442,t81:0.6252784429):0.3247653444,(t82:0.3321325401,t83:0.1789275076):0.5786758547):0.2599670565,t84:0.9726166609):0.9038237879):0.1198478753):0.2095491313,((t85:0.1360272353,t86:0.1307345594):0.62541338,(t87:0.4893826286,t88:0.4156194314):0.2475104396):1.294286711):0.3436982369,(((t89:0.8176985269,t90:0.7741335348):0.2713149728,(t91:0.7069058689,t92:0.6983638616):0.2078928001):0.4943674304,(t93:1.346162412,t94:1.233896869):0.04684444376):0.6821908105):1.1384495,(((t95:0.7789002031,t96:0.3229787795):0.3016255918,(t97:0.3173227025,t98:0.2010811887):0.288822033):0.5375861784,t99:0.9775719798):1.481478125):5.421495899,t100:7.861192162):1.091577779):0.3194215659,(((((t101:0.8020613978,t102:0.7943156312):1.030864141,t103:1.675828277):1.711527986,((t104:0.4896854385,t105:0.4192987526):0.4168631832,t106:0.7964921781):2.436734516):1.484607838,((t108:0.2979971833,(t109:0.1534302241,t110:0.1494284739):0.1301386715):0.2299887457,t111:0.4337490457):3.777419515):2.443914597,t112:6.646692541):1.650465349):0.5538923355):0.5794760712):0.5928613242,(((t113:6.00144684,(t114:2.938422713,t115:2.803394436):3.062944462):2.165547192,(t116:7.124341633,(t117:1.124583539,t119:0.8116235999):5.993154208):0.8847120487):0.5496100039,t120:8.209393487):1.212677724):0.8380617065):0.7815261823):2.982336355,(((((t121:8.906690498,((t122:7.230454947,((t123:3.005487873,t124:2.893991311):0.9558473417,(t125:2.146012561,(t126:0.3444010991,t127:0.2726060514):1.768711593):1.693798853):3.262517634):0.4824800808,(((t128:0.7177726718,t129:0.6554267358):0.8076207059,t130:1.342420972):1.328123489,t131:2.659579537):4.61286152):1.170280225):0.2705357673,(t132:0.202829319,t133:0.1478782543):8.504452897):0.8205062953,(((t134:0.1388830411,t135:0.001357666091):5.428753763,(t136:1.290407488,t137:1.043235826):4.02602657):2.808847396,((t138:5.052219088,t139:5.049418974):1.466858756,(t140:1.658811303,t141:1.384902827):4.801636144):1.12404783):1.095996512):0.7353543725,((t142:8.331190366,(t143:8.225761975,((t144:4.230059702,((t145:0.7909347249,t146:0.6422813159):2.524124173,t147:3.04268287):0.876228974):2.242417119,t148:6.022882071):1.591294642):0.08937270528):0.5204119072,((t149:3.973289254,t150:3.956341924):2.009927556,(t151:5.543901729,t152:5.45551389):0.3506367349):2.185579825):0.2222010332):0.7901057339,(((t153:6.48671408,(t154:2.388580211,t155:2.312527138):4.090669883):1.072665692,((((((t156:2.266085664,t157:2.224717612):3.270774079,t158:5.383867578):0.1066520881,t159:5.03738864):0.6620182574,((t160:2.42957468,t161:2.348086063):1.273662803,(t162:1.179931372,t163:1.085605252):2.42557562):1.717391344):0.4528882108,(((t164:4.059504725,(t165:0.8954192527,t166:0.6443014858):3.153403434):0.4817582065,t167:4.249135838):0.3207012558,((t168:3.790739108,t169:3.635757429):0.5005004394,t170:4.129950953):0.2178548126):0.7851044945):0.4464985997,(t171:2.94188069,(t172:2.764833377,t173:2.744048954):0.07608157955):2.563066723):0.09430914659):0.3446971531,(t174:5.342660491,t175:5.323102664):0.4117880763):1.08190237):2.471079617):6.968887898):0.4231104755):1.356557688):2.675701272,(((((((((t176:4.464334535,(((t177:1.146617171,t178:0.7827147632):2.146239286,t179:2.685283716):0.6057831174,t180:3.189452793):0.4846286853):0.476565422,(t182:2.167367526,t183:2.070857713):1.765225098):0.05439997866,(((t184:1.881339083,(t185:1.735422344,t186:1.661451583):0.07144361372):0.6314655227,(t187:1.203775343,t188:1.131729204):0.9772378446):0.9067494466,(t189:2.514719345,t190:2.514380762):0.4632012463):0.1586864633):1.195835333,((t191:1.002686792,t192:0.9760346149):1.024931974,t193:1.669344543):2.298568823):0.6864870853,((t194:2.984517248,(t195:0.7985605506,t196:0.7914724919):2.141885269):0.7325766245,((t197:1.111482078,t198:1.039329237):2.366695717,((((t199:1.514495745,(t200:0.6443915969,t201:0.5510877195):0.8395131986):0.2068918675,t202:1.596493909):0.4362960028,((t203:0.6043555876,(t205:0.2225409639,(t206:0.1628139786,t207:0.09439015324):0.0209268901):0.2473974508):0.5742882496,t208:0.3923601221):0.7883195547):0.3753018308,(t209:0.1526049608,t210:0.09049859732):1.341017467):0.8528313749):0.1068405398):0.9126297856):6.420167907,(t211:3.191456452,(((t212:0.6005293694,t215:0.3091034484):0.0640679298,t216:0.2196109698):0.9557611097,(t217:1.107294109,(t218:0.3152668068,t219:0.2326504818):0.7444754236):0.06654858136):1.558373239):6.288797139):2.424734528,((t220:1.908551461,t221:1.858420877):0.8324546531,((((t222:0.5215507686,t223:0.4667929687):0.9028270888,(t224:0.2748621553,t225:0.01630256369):0.800469407):0.2778255875,t226:1.057870372):0.5275708145,t228:1.306760326):0.3306428675):8.520498898):0.6044664336,((t230:2.371270135,t231:2.2373753):1.839758968,(t232:1.301934635,t233:1.268208874):2.516001946):5.796170569):1.491227224,(((((t234:0.2962178101,t235:0.220834322):4.304187483,(t236:1.360855163,t237:1.304054923):2.963224675):4.189741088,t238:8.228328153):1.114259373,(t239:0.3056598539,(t240:0.2475944512,t241:0.2323720103):0.0215945341):8.951597862):0.7640433564,(((((t242:3.430472315,t243:3.22828391):3.559385679,(t244:1.481426165,(t245:0.3720047912,t246:0.2870143829):0.9641002576):5.17902225):1.462819344,t247:7.783130175):0.1058203881,(t248:7.321182379,(t249:2.542532007,t250:1.848272777):4.663135394):0.5109982195):1.27809374,(t251:4.593525849,t252:4.528157689):3.692809462):0.1006701276):0.3015754604):2.869087188):0.2525710972):5.647745937):1.566074116,(((((((((t253:5.311333535,(t254:4.637245293,t255:4.588044004):0.619017386):0.3471845907,t256:5.535980175):2.210353769,((t257:5.231210753,t258:4.973347157):2.003346041,(t259:6.08144438,(((t260:1.49671641,t261:1.492645342):2.879738216,t262:4.346961939):0.6113262891,(t263:3.753814265,((t264:0.891697081,t265:0.8872641197):1.898879658,t266:2.717065793):0.8986168463):1.160867255):1.022671103):0.8431008078):0.5074374627):0.1100306341,((t267:5.888785402,(t268:1.104628067,t269:1.034147431):4.770637787):1.294035891,((((t270:4.316895776,t271:4.213307172):0.8240354135,t272:4.922024655):0.8473863425,(((t273:1.799217301,t274:1.419091195):1.28212539,(t275:0.3850902901,t276:0.3632537416):2.2113785):0.4598603411,t277:3.026822702):2.21803783):0.6561415048,((t278:4.251396455,((t279:0.7018565382,t280:0.6277887449):2.553824664,(t281:2.012351932,t282:1.80788696):1.130009854):0.9656049901):1.539563015,t283:5.270147511):0.01531562422):0.2562216119):0.05340216837):2.401921192,((t284:4.118671241,t285:3.92349334):2.854750694,(((t286:3.628630922,(t287:3.318972877,((t288:1.09160043,t289:1.086244829):1.897973648,(t290:0.9821919606,(t291:0.448760489,t292:0.4418042619):0.09027125705):1.874107043):0.1493194886):0.07260860679):1.506333313,(t293:3.835522682,((t294:0.369899358,t295:0.2821609358):1.628288166,t296:1.613792706):1.788246405):0.2580933372):0.829228168,((t297:2.786324121,((((t298:0.757018648,t299:0.7146330736):0.2658051393,t300:0.7063437067):0.5920511162,t301:1.243874505):0.5191905612,(t302:1.689642802,t303:1.606795051):0.06271903865):0.5413663233):0.1260682505,(t304:1.942728381,t305:1.91305604):0.335290132):1.558052593):0.8033085361):0.8182623879):1.549316857,(((((t306:1.009006633,(t307:0.8537030994,t308:0.7870946509):0.07258554869):3.131802592,(((t309:2.591993274,t310:2.527125616):0.07694333289,(((t311:0.6441318131,t312:0.6034846519):0.2503392885,t313:0.8393379181):1.501346233,(t314:0.7065550391,t315:0.4696930693):1.478808379):0.1800173033):0.2858892423,(t316:1.240183042,t317:1.036513704):1.149915353):1.001511329):0.2289973578,(t318:0.7278638466,t319:0.4010631217):2.376596309):0.1659679153,(t320:2.327454773,(t321:1.152569588,(t322:0.2653865805,t323:0.1679415321):0.8770384334):1.104366201):0.6006913823):0.04212098009,((t326:0.2818156321,t327:0.145314215):0.6349238402,(t329:0.3020715135,t330:0.2105411271):0.1343363577):1.553599164):2.369844827):1.107870179,((t331:2.889962622,t332:2.836728832):1.623610568,(t333:0.586169135,t334:0.4918629934):3.784969415):0.8260796574):1.106981265,((t335:1.073427459,t336:0.8260595411):2.151278354,((t337:0.5019102366,(t338:0.2285785983,t339:0.1685532118):0.2107096863):2.031790271,(t341:1.034070975,t342:0.8848556785):1.145989656):0.3548918625):2.783623692):4.635594249,t343:9.799464763):0.1646467885):0.3235439784,(t344:8.662764947,((t345:4.359824248,(t346:3.738700166,(t347:1.157039559,t348:1.046221318):2.041781794):0.3206588796):0.5203757155,t349:3.846665671):3.411671845):1.599894192):1.289455947,(t350:8.529681557,((t351:5.26994364,t352:4.884697486):2.621827162,(t353:7.066835056,(t354:4.924168431,t355:4.892467439):2.081991004):0.3333467354):0.1716067882):1.489370678):0.7100992932):9.295619154):2.01267389):64.98634472);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T71.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
