<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t474:11.83155722,(((t473:0.2400226825,((((t462:0.7211799096,t463:0.7181631034):0.464107171,t465:0.8283561193):0.04852868214,((t466:0.2256627562,t467:0.1483265385):0.5227011853,((t468:0.399148365,t469:0.2083287742):0.1955419725,(t471:0.1168951937,((t470:0.02382721048,((t464:0.1774727047,(t461:0.2435280914,(t389:0.09542843063,(t376:0.5909840398,((t377:0.2112727978,(((t367:0.441050554,((t347:0.02639493373,(t268:0.2026334502,((((((t212:0.07459144326,((t138:0.3496777428,(t124:0.3106768694,((t117:0.1274920965,((((t101:0.04825773066,(t1:8.28820751,((t2:0.0410136785,t3:0.029336262):7.483079789,t4:7.319327539):0.697788237):0.1732812187):0.8180202699,t5:8.76077316):0.8044646727,(((t6:0.9803060339,t7:0.9399184486):2.781827275,(t8:0.4378099304,t9:0.254876306):3.280057203):0.6297719959,(t10:1.211032664,t11:1.123912589):2.904219151):5.055553523):0.387191156,((t12:1.85187405,t13:1.718435428):6.991905099,((t14:1.039493163,t15:0.8623966219):1.37352767,(t16:0.9046980627,t17:0.8609297565):1.331100264):6.291467161):0.4680714193):0.1749124547):0.9025754433,((((t18:5.777161354,t19:5.643632101):0.5825813186,(t20:1.855259945,(t21:1.591814638,t22:1.400633188):0.1211465087):4.227248077):1.864226868,(t23:4.714531533,((t24:2.52514318,(t25:1.450449498,t26:1.369617816):1.043464421):0.6142277282,t27:2.967703457):1.444782154):2.875500455):1.498641346,(((((t28:0.5986741936,t29:0.5933592264):1.387499433,t30:1.411746442):3.978995885,(t31:3.107355921,t32:2.98670219):2.177906881):1.575848557,(t33:6.385180048,t34:6.332763727):0.3345459769):0.7370300019,((((t35:4.537473363,((t36:0.9967674984,t37:0.9935661623):3.054871341,((t38:2.388094167,t39:2.341505117):1.460869933,(t40:2.111267125,t41:2.109115935):1.687933004):0.1892447042):0.484671291):0.4698817282,(t42:1.806896251,t43:1.805739183):3.109622816):1.38749378,t44:6.26140734):0.4313864095,(t45:5.185248308,(t46:3.194192873,(t47:0.9521359148,t48:0.9192666875):2.211300651):1.769655814):1.348928756):0.5312080233):0.4078436288):0.2953222933):0.5832299282):1.819303025):2.119381803,((((((t49:0.8110474136,t50:0.7861744242):2.78169296,(t51:3.108480803,t52:3.044858995):0.4232122969):1.743110994,(t53:4.002296914,t54:3.827807912):1.111331275):0.8321447679,(t55:0.4815336666,t56:0.4781038496):4.925021):0.01762840127,(t57:3.999635357,((t58:1.172260929,t59:1.140892102):0.1144628805,t60:1.070928027):2.589046475):1.355477857):4.626187705,(((t61:3.027702875,t62:2.796551911):2.459893223,((t63:3.115462058,t64:2.990945336):1.826187673,(t65:3.766129184,(t66:2.194001843,(t67:0.3522650234,t68:0.311927859):1.804056108):1.564441811):0.8667334603):0.1362225413):2.072826325,t69:6.690338162):1.840916422):1.183489845):3.886244089):0.5080589778,((((((((t70:1.976549154,(t71:0.8350440882,t72:0.8072665803):0.9893202265):0.7554405176,t73:2.452558677):0.5681458449,t74:3.000321987):1.508725726,(((t75:2.080012566,(t76:1.515145743,t77:1.313871342):0.2017549156):2.177197592,(t78:1.4561037,(t79:0.2808762796,t80:0.2244727432):1.174819095):2.231105611):0.02411483181,((t81:2.438964815,t82:2.284555158):1.06541905,((t83:2.842892614,((t84:2.34792206,(t85:1.694751143,t86:1.694481317):0.6452830192):0.4180781509,t87:2.727715794):0.04198272831):0.2516280818,(t88:0.1733131064,t89:0.1678854394):2.8289899):0.1423022001):0.1052861398):0.1743887946):1.155316061,(t90:2.724947685,(t91:2.07192509,((t92:0.8361774918,t93:0.8256688935):0.1768077093,(t94:0.7295284243,t95:0.7262935149):0.1978114528):0.9785722634):0.6396305655):1.810432557):4.395208628,(((((((t96:1.447236105,t97:1.358370052):0.3694799977,(t98:1.33093709,((t99:1.077554773,t100:0.9782862693):0.2214983705,t102:1.084287058):0.01389259822):0.3263822245):0.5538044845,t103:1.744792378):0.06690798114,(t104:0.9547449656,(t105:0.3264868192,t106:0.1339421866):0.414181599):0.3150308055):0.5028781579,((t107:0.07768363554,t108:0.05431706879):1.262469601,(t109:0.3349677915,t110:0.2799785942):0.9036178107):0.02250773539):1.350836256,(t111:0.04569168347,t112:0.0414043265):2.41889174):3.839416047,((t113:0.177888914,t114:0.1515389854):1.741994634,(((t115:0.6344145867,t116:0.3452317045):0.7169697434,t118:0.8328787135):0.3609151278,t119:1.013708242):0.1427450065):4.264721356):0.4944179892):2.55005951,t120:8.162925819):1.138346735,(t121:0.1456516801,t122:0.1069972414):9.093687221):0.02830848073):2.704916639,(((((((t123:1.610408274,t125:0.8332106202):0.5821805392,t126:1.257153869):7.653872657,((t127:0.3944937205,t128:0.3305149209):3.695706641,((t129:0.07825025262,t130:0.01720496591):2.495788529,(t131:0.6843034498,t132:0.6187539961):1.675809485):1.412181846):4.736035429):0.2194983236,(((t133:0.4498458572,(t134:0.1826744703,t135:0.1351678022):0.04647254364):0.6863560316,(t136:0.7518518462,t137:0.7008191717):0.08517886821):7.308757502,t139:7.6154843):0.01796745242):1.268554606,(((t140:3.239857703,t141:3.016129413):3.291699346,t142:6.248908131):1.397834831,(t143:6.863677083,(t144:3.206579124,t145:3.192666235):3.499804708):0.6472795581):0.8878004096):0.002662136727,(t146:7.439979494,t147:7.411304885):0.7721267177):0.1514391786,(((t148:4.813986395,(t149:4.290747598,t150:4.055244977):0.5169190646):1.796652345,(t151:5.864018927,(t152:5.331473342,t153:5.31637265):0.5270155091):0.5003335835):0.9438275198,(t154:6.044707647,(t155:1.120854752,t156:1.020648588):4.902480007):1.217172997):0.5555438327):0.06351770144):0.8207961514,(((t157:6.08628203,((t158:4.495823073,t159:4.486963146):0.14596244,t160:4.630609304):1.34459772):0.5146447538,(((t161:1.868443274,t162:1.686976521):3.664731293,t163:5.240708395):0.2699930199,((t164:2.090712005,t165:2.007500798):1.191490017,t166:2.932322013):2.220552154):0.5131012698):1.738824354,(((((t167:1.237629582,t168:1.014322181):3.281892446,t169:4.271109788):0.9014731007,(t170:1.905945794,t171:1.819319936):3.200736854):0.7580499158,((t172:3.533756114,t173:3.3778719):2.070878616,(t174:1.099853482,(t175:0.1699178702,t176:0.1112167443):0.8585702519):4.319404934):0.1693865691):0.4689867792,((t177:4.261496892,((t178:2.72146526,t179:2.712164059):1.214875376,((t180:1.960136776,t181:1.929725236):0.008028398524,(t182:1.293911939,t183:1.049346275):0.521937979):1.911222778):0.263321948):1.350501542,(((t184:3.48027366,t185:3.464795774):0.4356786679,t186:3.849900583):0.3951507109,(t187:4.128981932,(t188:3.260086864,(((t189:0.8325999364,t190:0.831521855):1.603604752,t191:2.315049504):0.6171337982,t192:2.79047355):0.1682035108):0.7423148367):0.08538847016):0.5499422549):0.2949663243):0.6613483237):0.2276262828):0.2694932634,((t193:3.062834453,t194:2.971311626):2.257040249,(t195:4.057455306,(((t196:0.3900635759,t197:0.3246757407):2.873213923,(t198:1.910467525,(t199:1.10842062,t200:1.022977283):0.7624073499):1.277345009):0.3862585325,(((t201:1.59075616,t202:1.50761423):1.302146625,(t203:1.814073522,(t204:0.5873314727,(t205:0.1659593912,t206:0.1521269627):0.2468638824):1.096211374):0.8016783362):0.5128506589,(t207:0.3529884788,t208:0.2138662976):2.428886769):0.007038611439):0.2680370312):1.13541496):0.4528514453):1.661132217,(((t209:0.8136281837,t210:0.8075264255):0.02780236774,t211:0.7640505685):3.479033558,((((t213:1.974006097,(t214:0.7608666429,(t215:0.5710486553,t216:0.5550810031):0.1426437052):1.17081635):0.7168045648,(t217:1.962503348,(t218:1.298955888,(t219:0.7063859455,t220:0.6947521731):0.5678348293):0.5836552757):0.5943028067):0.3864860351,(t221:2.44485696,(t222:2.119673499,((t223:1.464566136,(t224:0.6429425788,((t225:0.1754980056,t226:0.02571373539):0.09489815181,t227:0.06185087539):0.1342775538):0.4557153326):0.2094508263,t228:0.5430320837):0.3885449441):0.2786932843):0.325053492):0.5560384196,(t229:1.469168879,t230:1.39370721):0.5176020829):0.2744095957):1.839617052):0.06223481794):6.301751845):1.895773814,(((((t231:0.4218065992,(t232:0.2521865371,t233:0.2030924855):0.1527774286):0.03062980884,t234:0.1768866345):1.221293329,(((t235:0.7357920462,t236:0.7152545432):0.1549067652,(t237:0.165377893,(t238:0.07782524237,t239:0.0403804129):0.07545432939):0.6602420108):0.05845600145,((t240:0.2153799837,t241:0.1709370507):0.5112657247,t242:0.443885377):0.002859541408):0.4124467329):0.4777963382,t243:1.19328898):0.8542048211,(((t244:0.7613674397,t245:0.3063340433):0.2292400334,t246:0.4466169942):0.6327901725,t247:0.9933879986):0.2875030963):9.245036277):0.7521308525):0.250467216,(((t248:8.964484104,(t249:0.2885735006,t250:0.134194882):8.631977768):0.912482492,(t251:0.08155146441,t252:0.003299866934):9.556214037):0.4318740655,(t253:1.485338652,t254:1.324857848):7.888765773):1.148035577):0.5567127662,(t255:1.414191566,t256:1.401263345):9.343355552):0.3781560912):0.08589891916,((((((t257:1.649946468,t258:1.541798827):0.5781280163,t259:2.034485271):4.143055295,(((t260:2.446557628,t261:2.442058195):0.7487438777,t262:3.155593243):2.352203629,t263:5.492273728):0.559509192):1.244798355,((t264:2.062824861,t265:1.929772439):5.022310378,((t266:2.715451354,t267:2.690636533):2.394860653,t269:4.773031304):1.826901453):0.1312107739):1.268327373,t270:7.983717759):1.885173277,((((t271:2.773930195,t272:2.527692695):2.802486987,t273:5.242644236):1.799254682,(t274:4.172800504,(t275:0.2674940312,t276:0.2313712472):3.831515864):2.842773924):2.32596755,(((t277:4.94513516,((t278:4.417427257,(t279:2.196883583,t280:2.052259543):2.189335297):0.4203622634,t281:4.660303577):0.1065984555):2.242595416,(t282:3.131512584,t283:3.131361857):3.842153344):0.4079944336,((t284:3.625556477,t285:3.577958441):2.804972134,(t286:5.44364858,(t287:3.933093548,t288:3.696440568):1.446813844):0.6781754592):0.8945965933):1.605825084):0.06519794599):0.3230673295):0.05874372307):1.33280677):7.829463374):0.3335017162):0.4621060537,((((t289:6.85504975,(t290:0.9950638262,t291:0.956717389):5.831024239):1.583933593,((t292:1.904575719,t293:1.765276241):5.092343243,(t294:5.349584297,(t295:5.18510657,(t296:4.510272956,t297:4.504762641):0.6329389767):0.125660833):1.42314915):1.361358769):1.212169397,(((t298:3.089757973,t299:3.060729932):1.40528075,t300:4.453944346):0.698647797,((t301:3.061480006,t302:2.811250446):0.708197859,t303:3.399322481):1.275776997):3.939502648):8.586182351,((t304:1.014939982,t305:0.8100036312):5.570957849,(t306:6.125627369,(((t307:0.9565492506,t308:0.8601318823):0.438522058,t309:1.123266411):2.319566226,t310:3.346287014):2.366345064):0.1989158838):10.47166267):0.4115897908):0.03896590442):0.03895087579,(((((t311:2.092203665,t312:2.073393055):1.764807405,t313:3.809995271):1.173607731,(t314:0.494719815,(t315:0.067930584,t316:0.04043916303):0.3519065169):4.35481898):1.089975185,(((t317:2.194060931,(t318:1.345884161,t319:1.28921867):0.6218670569):0.4259448652,t320:2.31998973):1.41993942,t321:3.666612775):1.711101762):0.01827239388,(t322:3.870737925,((t323:0.7345773514,t324:0.5614583713):2.224057598,((t325:0.7073691344,t326:0.6973555895):1.968984824,t327:2.6620378):0.05967777773):0.9005473546):1.295919672):10.64251906):0.1340349127):0.2015771034):0.007947931426):0.0232145573):0.1857297078,((((((((t328:2.423880346,(t329:1.898611163,(t330:0.4888324276,t331:0.4153147502):1.315728106):0.3743728251):1.883083052,t332:3.910469331):1.253999654,((((t333:1.28110411,t334:1.172878581):0.2747860314,t335:1.408455229):0.7408542527,t336:1.976721435):0.9140303486,((((t337:1.214353484,t338:1.210451141):0.0200943787,t339:1.211686156):1.179030255,(t340:2.157906638,((((t341:0.6349340471,t342:0.5610213269):0.7052574295,t343:1.090177124):0.4800141395,t344:1.5655968):0.101957549,(t345:0.1902924741,t346:0.1595439065):1.430840662):0.1949487928):0.1781482379):0.1881799535,(t348:0.7898612831,t349:0.7359492241):1.22501837):0.13908335):1.851685887):1.898856274,(((((((t350:1.818771193,(t351:1.51259172,(t352:1.047843105,t353:0.8797459378):0.426476137):0.2721740665):0.1063888911,t354:1.070000197):0.6069700031,((t355:1.05192621,t356:0.977842298):0.02010939842,t357:0.9887049526):0.2366716203):0.6198882233,(t358:1.130533671,(t359:0.4572572625,t360:0.3413091605):0.6713401386):0.5851287744):0.01450705672,(((t361:0.3922545646,t362:0.2962366185):0.04782192505,t363:0.3067313634):0.4500224594,(t364:0.432262543,t365:0.386030753):0.3180795867):0.6973020742):1.618315308,t366:2.970785795):0.6192928849,(t368:0.1210056558,t369:0.04920391232):2.679015993):0.4163032659):3.988311126,t370:7.003022279):2.326997223,t371:9.200789842):1.361424255,t372:10.44540844):0.8177756713,((((((t373:0.6319562892,t374:0.6312179199):0.06843730748,t375:0.6668670704):0.22570811,t378:0.04415651206):1.049817265,t379:0.834828561):7.844964184,(((t380:0.1198371192,t381:0.09437615189):0.06842917006,t382:0.06872295295):0.2047181835,t383:0.2262400329):8.223295066):1.243054792,(((((t384:4.218879869,(t385:0.2705805822,t386:0.1971393348):3.763695923):3.944511129,t387:7.792997409):0.3503963814,(t388:4.151064247,t390:3.994921331):3.891669573):0.9341908616,((t391:3.48419129,t392:3.221577758):5.189517058,(t393:7.997453416,t394:7.971445322):0.07473121496):0.1092864933):0.03335048669,t395:8.01257057):0.1630045635):0.07037741386):0.1358039529):0.3333780379):0.2071021929,((((t396:3.276805249,(t397:2.458895094,t398:2.338492086):0.7922379368):0.2421122986,t399:2.987566874):2.718646436,(t400:4.346552793,(t401:3.243149955,t402:3.153127636):1.083206879):1.292207398):0.3820479616,(t403:4.263016121,(t404:2.702577044,t405:2.308700473):1.466597316):1.625436182):1.960200175):11.53711191,(((t406:4.484446541,t407:4.399477728):1.083628789,t408:5.423900162):1.931031827,((((t409:6.500733666,(((t410:4.673423009,t411:4.537864492):1.462411477,t412:5.983676686):0.008191880231,((t413:5.727128293,(t414:5.251741946,(((t415:0.277485705,t416:0.2478396636):2.761093896,(t417:0.7009975295,t418:0.5787492986):2.120970084):1.223920867,t419:3.912751569):0.7107831151):0.4147286776):0.1655216579,((t420:2.340214444,t421:2.333054586):1.060966074,t422:3.378456035):1.55382148):0.09002291226):0.3157683386):0.005618234567,t423:5.331219227):0.005574969462,((((t424:1.654352331,t425:1.591263554):1.216921304,t426:2.576357329):1.576935285,t427:3.935446808):0.6875180985,t428:4.58337608):0.1297363737):0.005785650594,t429:4.687999258):0.8134709952):11.36794751):0.3293437802):47.96431499,((t430:3.3052401,t431:3.302503093):3.567536295,((((t432:0.464115132,t433:0.3306076158):4.872816259,t434:5.183286832):0.05266490328,((t435:3.984842579,(t436:3.701712947,t437:3.505254049):0.1183838089):1.16533485,((t438:2.991606757,(t439:1.425227026,t440:1.18592361):1.533090373):0.8832493148,(t441:3.270374909,(t442:2.369299846,(t443:2.120537854,(t444:1.348160982,(t445:0.9302033125,t446:0.8964939824):0.4022273279):0.5585363333):0.05872296548):0.8350678621):0.2465783868):0.7889233198):0.005559516543):1.11536536,(((t447:1.734757836,((t448:1.073605877,t449:0.8885045294):0.1676956328,t450:1.037204101):0.3887293477):1.413426929,((((t451:0.8940450886,t452:0.8754797719):0.8995843313,(t453:1.474278053,t454:1.077621183):0.2570649771):0.222893913,(t455:0.6251121097,(t456:0.1347338286,t457:0.1328865116):0.4833709025):0.8005148295):0.3327587911,(t458:0.4063713432,t459:0.3320140166):1.246020253):0.3253592313):0.6764383077,(t460:1.782272239,t472:0.03169841246):0.724364595):0.9720937358):0.3165319734):58.27941267);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T48.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
