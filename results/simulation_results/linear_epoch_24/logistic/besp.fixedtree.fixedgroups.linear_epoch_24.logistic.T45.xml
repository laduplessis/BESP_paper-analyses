<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t412:3.699960034,(t413:3.006865005,(t414:1.778818077,t415:1.645597989):1.222702437):0.4765305391):0.5113431699,t416:3.850950481):1.343874889,(((t417:4.854394111,((((t418:1.789930052,t419:1.732946534):1.008406665,(t420:2.400637758,t421:2.291151342):0.281092682):0.7868054796,(t422:0.726563164,t423:0.6937060072):2.592275116):0.5666703425,(t424:2.215515138,(t425:0.1923932434,t426:0.1899332326):2.006678306):1.626967885):0.6339808121):0.1211540249,(((((t427:1.496536094,t428:1.478365671):2.144674556,(t429:1.318180456,t430:1.2428373):2.204404668):0.1382934477,(t431:2.407571382,(t432:0.7313812296,t433:0.6436667521):1.630430028):1.143743654):0.4737983529,(t434:2.23444395,t435:1.988552076):1.631422165):0.2602280949,(t436:2.880902244,t437:2.808372875):0.9806800876):0.06403509806):0.0290660955,((t438:2.27600498,t439:2.275641315):0.9542771096,(t440:2.906704583,((t441:1.771623005,t442:1.734584594):1.024253953,(t443:1.275443334,t444:1.196559628):1.356085528):0.06715707004):0.2593595261):0.6479398883):0.1509133085):1.506238943,((t445:1.965151903,(t446:0.9117078071,t447:0.7106531502):1.015344792):3.061882649,((t448:0.2652223265,t449:0.217391723):2.129809643,t450:2.344998601):2.359629038):0.102166945):23.17146171,((t451:1.555876313,t453:1.142728701):4.312963051,((t454:1.114407776,t455:0.874189187):0.1717373456,t457:0.59539229):4.099448936):22.09125101):10.35111177,((((t458:1.281768243,t459:0.8685752863):0.1133241249,((t460:0.2214552735,(t461:0.03212335326,t462:0.01369422062):0.1500912918):0.199812819,t463:0.3410552783):0.4677241916):13.05410898,((t464:1.230784561,(((t465:0.1678291053,t466:0.1146775173):0.5663705501,(t467:0.2869178004,t468:0.2740062353):0.2535088968):0.06484383804,t469:0.5840662094):0.3970613684):1.39874649,(t470:1.624917902,((t471:0.5704369548,t472:0.3975371544):0.9172673794,(t473:0.3533337166,(((((t456:0.2228230831,(t452:0.004251227815,(((((t352:0.1252474746,(((((((((t214:0.03098336981,(t212:0.004784296887,(t211:0.03708355853,(t183:0.1693565901,(t126:0.004604020241,((t107:0.05737340017,((((t39:0.0401542953,(t1:1.557178187,t2:1.461960036):2.800609883):4.532493746,t3:8.78039106):0.3951674054,((t4:0.3088705208,t5:0.02500700385):7.83482177,(t6:1.097462022,t7:1.092118855):6.750982989):0.9345043865):1.791304284,(((t8:6.908247353,(t9:0.3309654916,t10:0.1170163948):6.478863748):2.853505586,((((((t11:0.9365532569,t12:0.808660514):0.162060099,t13:0.8445365621):2.864289299,t14:3.70350031):0.707963779,t15:4.370624645):2.49935078,(t16:5.822593019,t17:5.783117014):0.8370130473):1.927981902,(t18:2.818175412,t19:2.81060669):5.646369818):0.2554730533):0.5193787281,(t20:8.10706009,(t21:5.850118616,(t22:5.148525038,t23:5.121934196):0.279501386):2.169677164):0.9956997362):0.05772625718):0.05510497715):0.2608400786,(((t24:7.450798132,t25:7.298275105):0.03197588767,(t26:6.985407445,t27:6.959604427):0.09998273685):0.3115219557,(((((t28:1.845268622,t29:1.827866971):0.8129670553,t30:2.622123164):0.7403588385,(t31:0.6017931469,t32:0.5111200556):2.67795391):0.6048119844,(t33:3.112769435,(t34:2.232004707,t35:2.192738126):0.8353162343):0.6479274443):2.085445427,t36:5.68228379):1.102837953):0.8778310227):1.817595765):6.339256917):2.332199886):0.006891636071):0.1473490897):0.02154020177,(((t37:5.893102607,(((t38:4.725466562,(t40:3.776406584,t41:3.725010686):0.6940726993):0.7593312589,t42:5.140555863):0.3053704773,t43:5.416156361):0.01424461407):0.57776376,(((t44:4.53147122,t45:4.500318553):0.8918764266,(t46:4.810329489,(t47:1.7398796,t48:1.713040059):3.064508904):0.5264934955):0.2891958443,(t49:3.291527338,(t50:1.296064818,t51:1.200214958):1.958525228):2.226163637):0.2898694342):1.889967494,(((((t52:1.192108415,t53:0.9449740248):4.632867504,(((t54:0.6334898949,t55:0.5955588643):3.217580522,t56:3.791921901):0.4548356855,(((t57:1.840954233,((t58:0.2257156889,t59:0.04346900575):1.068170811,t60:0.9007594564):0.4461663892):0.852695316,t61:2.190775742):0.9001098819,t62:3.029860472):0.4594078532):1.196833798):0.2589728213,((t63:0.7533312198,t64:0.5753292079):2.12119858,t65:2.502659942):1.949693173):0.5318691798,((t66:3.056481181,(t67:2.047564668,t68:2.010098319):0.9877360076):0.08864360488,((t69:0.6508491843,t70:0.2836593262):0.9542774746,t71:1.225134647):1.458679376):1.774610774):0.4489389503,((t72:4.033182826,t73:3.70363314):0.1268171442,(((t74:1.761143031,(t75:0.630952207,(t76:0.5625946696,t77:0.5392146447):0.03842099516):0.9979570103):1.316545082,t78:2.766651673):0.2993943738,((t79:1.821016886,t80:1.803532961):0.9074701203,(((t81:0.2424235806,t82:0.2134032497):1.616721252,(t83:1.494517326,t84:1.469586736):0.2989660463):0.6254627665,(t85:2.183041007,t86:2.178191731):0.1749375073):0.03087956199):0.3004309903):0.1371034287):0.6900529264):0.4752802781):9.661492194):0.4030088256,((((((t87:1.748716426,t88:1.436897378):1.244433412,t89:2.678007918):0.7688847386,((t90:2.019415509,t91:1.91560265):0.3941022416,(t92:1.731083049,(t93:1.522505941,t94:0.7243639922):0.06699824247):0.5106436006):1.018144965):5.692626382,(((((t95:0.9567428271,t96:0.9205066383):0.7095030432,(((t97:0.2027027934,t98:0.1217785232):0.3525510363,t99:0.3915762765):0.9249852234,(t100:0.6519732293,t101:0.6324808052):0.5562542419):0.06177781825):0.769825348,((t102:0.4595882978,t103:0.3523410402):0.9469470888,((t104:0.1708375102,t105:0.1572591064):0.4479728702,t106:0.3877740526):0.5520407204):0.4981397579):0.1172476203,t108:1.194578298):1.400379375,t109:2.589733355):3.899457017):1.312275301,(t110:1.204274836,t111:1.181582293):6.27665547):0.3982420876,((t112:0.5462469276,(t113:0.4390162864,t114:0.4276873144):0.07223092283):1.077387995,((t115:0.7656384859,t116:0.7003812793):0.5017696565,t117:1.193801992):0.2869035858):5.840617018):2.857612886):0.01892853072,((t118:8.293053882,((t119:1.484886505,t120:1.445591205):6.334794712,((t121:1.017626323,(t122:0.5407599751,t123:0.5338511025):0.4053908884):4.960843178,(t124:0.3177712612,t125:0.1217711592):5.452597211):1.666062589):0.1417819723):1.82243947,(t127:1.709347624,t128:1.636513987):7.298356085):0.08219403324):1.799719951,((((t129:0.207313542,t130:0.1313555634):8.12482797,(((t131:5.71147953,((t132:0.3240803573,t133:0.2692711441):3.735523553,t134:4.002388411):1.617058264):2.321580651,(t135:7.569499585,t136:7.552732401):0.28403571):0.1097601279,(t137:1.37294449,t138:1.105142182):5.796798016):0.02779486517):1.39051808,t139:8.167858069):0.5938547888,((t140:7.09227004,(t141:2.486944373,t142:2.48155274):4.354473003):0.8960388475,(t143:5.352994234,(t144:4.07717341,t145:4.009457036):1.163775378):2.327552471):0.7512000853):0.4930452927):0.42539565,(t146:6.398043569,((t147:5.242139083,(t148:3.43809578,t149:3.413066306):1.768547426):0.681481019,(t150:4.706889189,t151:4.654981223):1.09320554):0.3189879382):2.336159919):5.835501061,((t152:9.004978544,((((t153:1.761022495,t154:1.616555864):2.789695357,t155:4.261232787):2.427158037,((t156:5.39518507,t157:5.333465783):0.44470823,((t158:4.853212001,(t159:3.915284115,(t160:1.739083724,t161:1.692087373):2.103152316):0.8161404391):0.6525408005,(((t162:3.824263498,t163:3.820113374):0.3466435208,(t164:0.2064896755,t165:0.1671575348):3.936332924):0.5350309315,(t166:4.444053663,(t167:0.7867397082,t168:0.7251351865):3.559307612):0.08913719708):0.2646966249):0.2715622164):0.8346626551):0.5641483401,((((((t169:0.08935314884,t170:0.07649265324):2.937851362,(t171:2.745958485,(t172:1.691009716,t173:1.209354883):1.002555911):0.2143049513):0.1545547145,t174:2.436056728):0.04263047831,t175:2.435580787):1.428064641,((t176:1.755221657,(t177:1.560003114,t178:1.548522319):0.1722318917):1.674937053,(t179:2.433863009,t180:2.357129869):0.6189396628):0.353730342):0.6531860041,t181:3.931260751):0.8104683306):1.284185078):4.745416937,((((t182:2.791379633,t184:2.542076647):1.046865877,t185:3.514860221):2.959691743,((t186:3.743063058,(t187:3.031076351,t188:3.017490341):0.7068316794):0.08937234194,(((t189:0.5586037409,t190:0.5533436874):1.234751267,t191:1.7090047):0.131928192,t192:1.815279197):1.874410005):2.439047734):3.524235085,(((((((t193:0.5593014002,t194:0.4718843779):0.8720324259,((t195:1.066034554,t196:1.001722041):0.1074929793,t197:1.020225669):0.1529838893):1.14541616,(t198:1.068289532,((t199:0.1680248037,t200:0.09569071533):0.6100354027,t201:0.6059571172):0.1528028764):1.248576388):0.4513393973,((((t202:0.1938176229,t203:0.18175084):1.771615259,(t204:0.7880302423,t205:0.4975496276):1.137599373):0.07753977,(t206:0.9470873541,t207:0.7997843233):0.6437017191):0.07769678076,(t208:1.019599237,t209:0.9287194989):0.4870990239):0.1769577021):0.06443640171,(t210:0.674455231,t213:0.317566934):0.928899048):0.05893292057,(t215:1.067406437,(t216:0.2338961127,(t217:0.131599364,t218:0.08407739333):0.08793419273):0.7014620927):0.1191960266):1.464094041,(t219:0.4189529474,t220:0.2192011265):1.901157356):4.992626224):0.3798410176):0.4654004951):3.105782897,((((t221:0.7572483277,t222:0.7373452588):2.474594667,t223:3.191817819):5.670492417,(t224:2.008721247,(t225:0.8997831111,t226:0.8342878618):0.9685473462):6.569879083):1.297157312,(((t227:1.446413382,t228:1.180989697):0.6337587223,(t229:0.5485161701,t230:0.4300989108):1.106358767):0.07287201753,t231:1.575826066):7.464965437):0.5150362176):1.761263168,(((t232:0.0797114193,t233:0.03310935782):4.478143198,((((t234:0.3795621026,t235:0.2645478019):0.6480365669,t236:0.7858282334):1.109418169,(t237:0.314098834,t238:0.2172854463):1.454905813):0.3861134789,t239:2.051810846):1.824008511):5.803543026,((t240:7.341590799,t241:7.197174066):0.7645207983,t242:7.807797836):1.488928545):0.6440795194):1.691142426):1.760140597,(((((t243:0.7074460812,t244:0.6051804862):0.5078797064,t245:1.102209097):8.370579794,(t246:7.687559975,t247:7.654693058):1.653794704):1.247197503,(((t248:7.402583088,t249:7.250745569):2.287305429,(((((t250:1.449522918,(t251:0.9595059458,t252:0.6962947705):0.4546665895):6.084874961,t253:6.985913391):1.455300438,(((t254:0.180165932,t255:0.1412272984):1.280668207,t256:1.394800248):3.835804697,t257:5.2072333):2.947303038):0.2597480617,((t258:5.703085998,(t259:0.5247684717,t260:0.5232422761):5.109160703):1.72989009,(t261:1.487350996,t262:1.408274195):5.850048646):0.9767215438):0.04115565618,((t263:4.840723593,t264:4.729963212):3.207848634,(((((((t265:2.404175439,t266:2.371391495):3.27766026,t267:5.646978864):0.3199557712,t268:5.93968016):0.1312173317,(t269:5.263875266,t270:5.187187433):0.7162887311):0.9692896685,(t271:6.514109344,(t272:6.186854042,(t273:5.745205375,t274:5.659844782):0.4277225463):0.2998596364):0.3577879618):0.2365242603,((t275:3.238872606,t276:3.228409164):2.81932923,t277:5.896373133):0.8710299913):0.3748435638,(((t278:0.3240409322,t279:0.3179052091):5.124094223,(t280:3.953598153,(t281:3.671140676,t282:3.528833527):0.1790836334):1.413487956):0.7578400062,(t283:5.695527451,(t284:1.325361873,t285:1.21381436):4.335534171):0.08715790332):0.6914088738):0.1919532024):0.1745241471):0.1127946365):0.4648252239,((((t286:2.103593207,(t287:1.059590725,t288:0.9442271489):0.9660247985):2.732531121,(t289:4.541811021,(t290:3.705696232,((t291:0.1359469742,t292:0.1330312966):2.635019156,t293:2.684178137):0.8367267893):0.7002856244):0.08140205837):1.036099775,(t294:3.282400827,t295:2.981438093):1.639176953):0.02708666371,((t296:3.762920392,(t297:2.024084968,t298:2.009652314):1.61182092):0.7879138172,((t299:3.080586727,t300:3.080548383):0.8449529082,(((t301:1.914465035,t302:1.856959812):1.551983786,t303:3.162142299):0.2518021381,(((t304:2.39158797,t305:2.328379328):0.1046350528,t306:2.400821179):0.3497897756,(t307:2.121383409,((t308:0.6558425476,t309:0.5905840544):0.6950105328,t310:0.9523996469):0.7424394674):0.5080550814):0.4516572429):0.1510171923):0.4468254902):0.0461750583):1.285799875):0.1712020659):0.5664050021,((((t311:2.278322715,(t312:1.328050893,t313:1.271645255):0.9159354833):0.280870049,t314:2.44140425):1.40881128,(((t315:0.2794603689,t316:0.234904939):2.125741513,t317:2.300991732):0.07805636319,(t318:0.9534783997,t319:0.9472814166):1.420902322):1.350424122):0.1120983877,(t320:2.099837357,(t321:1.253589261,(t322:0.609872845,t323:0.6003576517):0.5805070052):0.7218233131):1.670250185):1.017550241):1.947980635):2.570551949,((((((t324:2.099013411,(((t325:0.9318942717,t326:0.7856346039):0.7581792074,t327:1.40207067):0.04037614074,t328:0.8167348841):0.2561008109):0.4792201036,t329:1.102349167):0.6268640523,(((t330:0.7338895798,(t331:0.528731286,(t332:0.1587970681,t333:0.105762003):0.3227808512):0.1961249994):0.08627300832,t334:0.337595946):0.6597486586,((t335:0.1646045379,(t336:0.05876452795,t337:0.02041364641):0.07820469634):0.3160936321,t338:0.1192077117):0.3157991651):0.1854454001):0.3314225798,t339:0.7146013495):0.02512956293,((t340:0.1988841782,t341:0.1328467799):0.2135220429,t342:0.2836069689):0.3132783474):2.924727902,(t343:0.4259953318,t344:0.4152860638):3.037995202):2.608473233):2.038516813,t345:7.309568329):0.8561165968,(t346:2.223123375,t347:2.195395545):5.941529933):0.2659026532):0.6564239478):0.1510318144,((t348:0.5030439834,t349:0.2779863438):7.390192662,((t350:1.191622898,t351:1.015961625):1.022074637,t353:1.573891899):5.310752032):1.309428706):1.290366351,((((t354:1.2088682,(t355:1.166103892,t356:1.096404058):0.009821951909):1.689328092,t357:2.753629571):4.429581856,((t358:0.9693170171,(t359:0.05746550673,t360:0.02605071572):0.8623372614):3.963274655,(t361:0.09510468387,t362:0.08353365793):4.751778535):2.22129518):0.9389379997,((t363:6.591342611,(t364:2.957083417,t365:2.940204155):3.495460575):1.022531425,t366:7.405915794):0.374973253):1.210956094):0.1033458959,(t367:3.15489374,t368:2.876912016):5.846528898):0.03538564049,(((t369:3.549083774,t370:3.440944426):3.736283093,(t371:5.850464883,((t372:4.104911619,t373:4.075800176):0.6169322731,(t374:1.835893442,t375:1.835850471):2.52184159):1.001635763):1.204617484):0.8294339997,(t376:3.439310748,t377:3.399931474):3.680245879):0.6398288464):1.089003191):0.05059358664):0.1004773034):0.735873554):11.10539104):10.01195668,((t378:6.507626191,(t379:6.289258762,((t380:0.1668856956,t381:0.1526415825):5.355960207,((t382:4.176562652,((t383:0.2387735698,t384:0.1000847801):1.072496821,t385:1.153092171):2.702199671):1.179444139,(t386:3.810582165,t387:3.747579099):0.8921080978):0.1081061472):0.729399259):0.208383397):0.5543194071,((t388:1.746933596,t389:1.715314686):4.04917083,(t390:4.483705362,t391:4.311107077):1.220814406):0.2799313142):23.65150705):12.63069032):51.03208913,(t392:7.481916466,((t393:6.753718756,(t394:4.230468599,(t395:3.212668395,t396:3.127582631):0.8894522282):2.492366295):0.4395803459,((((t397:4.224675274,t398:4.190703356):1.290960816,((t399:2.016006109,t400:1.966942575):2.869707389,t401:4.731140874):0.4725377195):0.5247104106,(t402:3.067145835,t403:3.031136585):2.581957231):0.6293575391,(((t404:2.175100652,t405:2.136274931):2.514172971,t406:4.575970454):0.7575769997,((t407:2.421099435,((t408:1.259865982,t409:1.187128773):0.1440946457,t410:1.207160423):0.9790991023):1.305996295,t411:3.473510156):1.583970702):0.5829744812):0.219286222):0.2805180828):85.6199361);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T45.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
