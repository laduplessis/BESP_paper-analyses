<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t444:9.579236211,(t445:0.6559133823,(t446:0.1026665937,(t440:0.1602949199,((t353:0.0468784024,(t347:0.06706598642,(t321:0.01077784105,(t320:0.0435064072,(t318:0.0882971831,(t309:0.004599707007,(t284:0.004323369948,(t228:0.164696094,((t217:0.01846483409,(t209:0.2551398581,(t166:0.0953928989,(t125:0.08009093423,((((t70:0.1088422873,((t65:0.1191716649,(t1:6.365854464,(t2:0.6062761806,t3:0.6050555693):5.713420432):0.369411642):0.08182630479,(((t4:1.098725296,(t5:0.3861970646,t6:0.3664962413):0.7118812223):0.5114474133,(t7:0.328707433,t8:0.2805691996):1.135406783):0.1123875901,t9:1.299806977):4.828894064):0.3445858303):3.801207744,(((((((t10:0.1667837279,t11:0.1625193732):8.466385261,(t12:0.4865785771,t13:0.4185731159):8.130091596):0.4503811711,((t14:3.805523087,t15:3.756051249):4.830643885,(t16:6.038450638,(t17:4.707369687,t18:4.504972787):1.312611498):2.546147087):0.2790444724):0.345844481,(t19:5.998764142,(t20:4.828504801,t21:4.695051282):1.160399417):2.787661228):0.04239936541,((t22:2.979782828,t23:2.142224976):4.832077419,(t24:5.421980519,(t25:1.502076053,t26:1.34257208):3.882689353):1.373744799):0.7381718626):0.1071174417,(t27:6.731122476,t28:6.714793831):0.5277548527):0.3980890104,t29:7.631874):0.1245447774):0.04849871433,((t30:4.38546207,t31:4.291170663):2.13397141,(t32:5.504246844,t33:5.398366482):0.8446770177):1.191559349):0.6115991153,((t34:7.409582407,((t35:6.322857531,((t36:4.422995907,(t37:2.817322196,t38:2.788524319):1.582999314):1.545492426,((t39:3.132458956,t40:2.948128166):2.368916821,t41:5.294888977):0.3300514863):0.3420345357):0.6600347833,(((t42:2.888282278,t43:2.659033079):1.187827933,(t44:0.7237501829,t45:0.6197814573):3.095445899):1.88884862,t46:5.527020368):0.5030383919):0.3893621831):0.2590526107,(t47:0.1353765578,t48:0.09520573834):6.505146703):0.3058119162):1.899160697):4.781346324):3.452113568):0.648584492):0.1023426362,(((((t49:0.7699059377,t50:0.6120092029):3.65711653,t51:4.165960487):0.8200843148,((t52:3.027697383,t53:2.87408688):1.113147671,t54:3.883774635):0.7412475806):12.05177079,(((t55:3.036335515,t56:2.96206285):2.211260445,((t57:2.453912222,t58:2.269766569):1.255634941,t59:3.411359278):1.265525952):4.511053,(((t60:3.106780518,t61:3.080413531):0.5884515607,(t62:3.300533621,(t63:1.314464308,t64:1.284997415):1.947156135):0.1194271461):3.535301781,((((t66:3.08484312,((t67:2.205503062,(t68:1.290269639,t69:1.271887713):0.834800799):0.3130186026,(t71:0.4164989205,t72:0.3898749292):1.67431874):0.4460815791):0.8239558937,(((t73:0.4579903971,t74:0.3377992976):1.600079477,t75:1.910925653):1.094576898,t76:2.9933241):0.1063369167):0.06585740978,t77:3.103221176):1.386772107,((((t78:1.394025694,t79:1.386656679):0.8418080501,t80:2.185655564):0.5954258718,t81:2.711927051):0.004397252108,t82:2.70873927):1.591347115):1.277076761):1.94813164):6.686441995):0.3205138618,((((t83:0.9467272701,t84:0.9186492994):2.3236483,((t85:2.238914191,t86:2.154266698):0.1867427896,((t87:0.841516487,t88:0.8040152268):0.8835098781,t89:1.317582202):0.3820557918):0.7802900413):0.3428514111,(t90:1.68340055,(((t91:0.4598773741,t92:0.3758812426):0.4486333837,t93:0.1654603912):0.5553284748,(t94:0.5927428331,t95:0.5553613462):0.1070484481):0.2131559713):0.7379245493):9.471992287,(((((t96:0.6142791086,(t97:0.2990922447,t98:0.298135761):0.2334789412):0.07214382989,(t99:0.1330254925,t100:0.1101161735):0.4111903958):0.2974387621,(t101:0.474837752,t102:0.3357200305):0.3289099033):1.065443483,(t103:1.474064494,((t104:0.2943533943,t105:0.2001751796):0.5724761922,t106:0.7090641965):0.5864009982):0.2516850705):8.74153996,(((t107:1.706919847,(t108:1.056987386,t109:0.5147160829):0.6483935498):0.4715628631,((t110:0.8283661864,((t111:0.5980971035,t112:0.528993809):0.06383642779,(t113:0.1186523357,t114:0.09830223104):0.3349493187):0.08661596213):0.3110491607,(t115:0.4362562211,t116:0.4359273506):0.3405950027):0.0478197148):4.858256257,t117:5.634299125):3.128258889):0.2253544781):1.389922028):0.1360374266):1.743414347):6.232855568):2.695387264):0.9404462438):0.266830945):0.05551026407):2.439744986):0.581680902):7.376332855,(((((((((t118:8.914905225,((t119:5.997298041,(t120:0.1177474471,t121:0.09205634715):5.773114471):0.6051642288,(t122:1.376857623,(t123:1.001580001,(t124:0.6273851887,t126:0.2240781807):0.2786044952):0.3407347865):5.013412546):1.980051308):1.137055827,((t127:8.674378279,((t128:8.197550936,((t129:1.462234712,t130:1.45181146):3.087506764,t131:4.41009961):3.641341523):0.2138744988,((((t132:5.699006254,((t133:2.268829071,(t134:1.90092648,(t135:1.460834562,(t136:0.9004934038,t137:0.7050065621):0.5468908335):0.3944311785):0.1153751781):1.849265897,t138:3.383595453):1.574369811):1.501907675,t139:6.455027415):0.01794155597,t140:6.374241683):0.3601527215,(t141:1.072503525,t142:0.9255881816):5.504801461):0.2457281492):0.1764072256):0.03237316298,(t143:6.535122239,(t144:2.401205619,(t145:1.759022359,t146:1.623813557):0.5618174024):3.916886941):0.3276130225):0.2261887489):0.800866234,(((t147:4.027795153,(t148:2.731081814,t149:2.656603768):1.292661472):0.5313634047,t150:4.436857418):2.58000682,((t151:5.291079726,((t152:2.495250634,t153:2.449975738):2.553633314,t154:4.94498795):0.1795032723):0.2454067527,t155:5.057464427):1.436882446):0.2522672849):0.5165038147,(t156:4.268247943,((t157:1.982768547,t158:1.953115629):1.534643481,(t159:2.430121073,t160:2.298794094):1.043949845):0.5638496836):2.762679725):11.73203578,((((((t161:16.46270472,((((t162:3.38422889,t163:3.174621695):2.488546403,(((t164:3.827513088,(t165:1.302768294,t167:1.140781432):2.380932804):1.152760152,((t168:1.945709077,t169:1.933474234):2.43239289,(t170:1.195783268,t171:1.158206241):3.148935422):0.2584372858):0.07534242399,(((t172:2.910566573,t173:2.840130295):1.167027973,((t174:1.207712347,t175:1.176439946):0.7647716485,t176:1.897548245):2.034115195):0.111117685,t177:4.014222972):0.219074704):0.3986198183):1.58551686,((((((t178:2.40152596,(t179:2.341269218,t180:1.990887185):0.04598860702):2.491327414,((t181:1.313737866,t182:1.286332032):0.584647471,t183:1.859187532):2.610937358):0.1172986726,((((t184:2.224589089,((t185:1.250911245,t186:1.144613709):0.7554312544,t187:1.764568159):0.2108227643):1.002436036,(t188:1.755141986,(t189:1.114771962,t190:1.037154926):0.500564585):1.157619886):0.7625330915,((t191:2.380203513,t192:2.379492834):0.3943755971,t193:2.769235039):0.6281239561):0.3267969454,((t194:0.8432282678,(t195:0.6099559641,t196:0.5048561012):0.1369882988):1.158121069,((t197:0.9481810145,t198:0.9231614261):0.4680429723,(t199:0.7675485584,t200:0.6077816139):0.5167057799):0.2891182292):1.708853463):0.2232438464):0.2997679365,(((t201:0.5476043378,(t202:0.09671464671,t203:0.08201797834):0.4362428383):2.009312327,(((t204:0.9511767876,(t205:0.4832524394,t206:0.3456765899):0.111877679):0.3944485633,t207:0.8052020255):0.05947785543,t208:0.8592659562):1.114573197):0.1695765843,(((t210:0.05020597063,t211:0.02933197979):0.320695826,t212:0.1509268225):0.551915568,t213:0.5569063931):0.7951490298):0.7811186273):0.004607676553,((((t214:0.05687664872,t215:0.03743661013):0.349469709,t216:0.3362575208):1.132003127,t218:1.393202543):0.1654874817,t219:1.360687394):0.3867116185):0.2634049841,(t220:0.1245625302,t221:0.08098662218):1.521458735):0.4007560752):7.552779471,((t222:0.6039181144,t223:0.3134014827):1.788747897,(((t224:1.013486155,t225:0.9216812546):0.8241850359,t226:1.651836336):0.02523327931,(t227:1.342189071,t229:0.9402849227):0.04944381595):0.2154171182):7.092053911):1.300383342):0.101049975,t230:9.449627193):0.07300888044,((((t231:0.652722558,t232:0.6000045658):4.587835279,(t233:1.76820838,t234:1.657169281):3.296278231):2.678397188,(((t235:0.4705890245,t236:0.4006453795):0.2515032335,t237:0.5316810038):6.097657804,(t238:3.84120641,t239:3.439618333):2.771917278):0.7169019544):1.237733511,(((t240:6.060708985,((t241:0.7634512986,t242:0.7407996644):1.000217545,t243:1.714149572):4.288771399):0.8583706672,t244:6.851994521):1.192963846,t245:8.028954587):0.03218801182):0.236261077):0.002768794018,t246:8.296771691):0.327945901,t247:8.52753591):0.2789484721,((t248:4.407602196,((t249:3.026948058,t250:2.914090091):0.4198582704,t251:3.325017687):0.3722783452):0.4815634513,t252:4.157601387):3.367693829):0.9353359281):0.2397806085,((t253:3.807634275,t254:3.768427937):3.447160838,(((t255:0.5799480006,t256:0.5301547591):0.1303289618,t257:0.6077459289):2.760182033,t258:3.260041347):3.507784759):1.342243986):1.170725177,(((t259:6.9374091,((t260:1.059251782,t261:1.049107016):0.7604515416,t262:1.497532269):5.102857072):0.007257705571,((t263:2.096063656,t264:2.04261681):3.765796359,(t265:4.486107811,t266:4.444090582):0.839334138):0.5988666787):0.9527494182,t267:6.580116671):1.375639756):0.2387530301,((t268:1.337259147,(t269:1.060966667,t270:0.9986754497):0.2474139862):5.714766157,((t271:4.536020271,((t272:2.127331725,(t273:0.9957868769,t274:0.9441934564):1.029045836):0.2554007253,t275:2.210977324):2.143144798):0.5436622242,(t276:4.339499016,t277:4.301777569):0.3560507726):1.878686017):1.122149737):1.265792861,((((t278:2.487175371,t279:2.348566451):0.9495032416,((t280:0.2195013353,t281:0.169621586):2.803695519,(t282:0.5368734152,t283:0.4514303953):2.419200404):0.05658551983):0.9382577815,(t285:2.411178627,t286:2.280728756):1.021574911):2.878070746,(t287:3.710293517,((t288:2.952571248,((t289:1.475864897,t290:1.434513867):0.9670335788,t291:2.358089697):0.4454784706):0.4356813128,(t292:2.465098675,(t293:0.7789334793,t294:0.7593000925):1.632657936):0.7486295644):0.2790341732):2.199863461):1.623657694):6.287532631):1.615887017):1.317322977):0.2860011202):8.837663308):2.236591499,((((((((t295:0.3950203621,t296:0.2885829267):2.331420486,((t297:2.068648251,t298:1.84617532):0.06279624351,t299:1.883413809):0.4590311538):1.150184657,(((t300:1.206772089,(t301:1.052687779,t302:0.9811092755):0.0949628013):1.832001562,(t303:2.737060283,(t304:2.440367561,(t305:1.260587445,t306:1.199484111):0.8021555129):0.09279983892):0.14378842):0.3956779974,((t307:1.502795581,((t308:0.5176818606,t310:0.01612531467):0.4780415202,t311:0.1763575591):0.4721714384):0.2812024735,(t312:0.2263027213,t313:0.08109089145):0.6783330583):0.7066413826):0.03697199191):0.888961029,(((t314:1.111274936,(t315:0.4017507011,t316:0.36729432):0.6926932334):0.08615785945,t317:1.07845144):0.393594828,(t319:1.061208347,t322:0.8696173724):0.1668169164):0.7246443151):0.6078501804,((t323:0.08331642418,t324:0.05489928999):1.671790485,t325:1.339149948):0.5632658104):0.3996631219,(((t326:0.6528260074,(t327:0.2803087572,t328:0.2708646089):0.2386008977):0.4379320337,t329:0.9388236566):0.07683756314,(t330:0.4180750912,t331:0.1337474692):0.5934684897):1.038860485):10.57861989,(((t332:6.557444639,((t333:0.6385272808,t334:0.3461177137):1.296489306,((t335:0.7092375117,t336:0.6943628914):0.7679477785,t337:1.437143698):0.1237727904):4.306658492):4.626595254,(t338:7.890367331,(t339:0.6764541567,t340:0.6280074362):7.151145457):2.478495994):0.8116162776,((((t341:0.2532242454,t342:0.2346448476):5.518673523,(t343:0.4829333259,t344:0.365725985):5.203362058):0.03026077599,((t345:0.06843445801,t346:0.02334496637):1.394212385,(t348:0.1368770664,t349:0.1049068863):1.084893177):4.131834034):4.483734344,((t350:5.18421881,(t351:2.338967041,t352:2.272317959):2.591221273):3.915422965,(((t354:6.961558811,t355:6.913526071):0.2279137787,t356:7.110593975):1.127137696,(((t357:7.042844318,(t358:6.590462167,t359:6.577874612):0.3761253076):0.1231478197,(t360:3.051478844,(t361:1.291075368,t362:1.27812941):1.641032274):3.868370181):0.9986325922,t363:7.725238108):0.0581814188):0.316019648):0.5640673976):0.7295513083):0.3348742938):3.197789388,((t364:3.698179627,(t365:0.6780653806,t366:0.6125918637):3.009323787):3.345979126,(t367:6.356901595,t368:6.269337162):0.5471960217):5.300839459):8.125737631):26.06008773,(((t369:7.318932056,t370:7.282556755):13.67238326,((((t371:5.738114016,((t372:2.249001567,t373:2.168794637):3.304832506,t374:5.457676339):0.1316460572):1.020939364,t375:6.43057506):3.521645585,((((t376:5.990099171,t377:5.957462394):1.350844434,(((t378:4.999946478,t379:4.974935915):1.998545432,t380:6.956661105):0.1495348339,(((t381:2.504875837,t382:2.493471456):0.2989312714,(t383:2.097922113,t384:2.025883131):0.5369798641):4.125976156,(t385:4.387889345,t386:4.329511008):2.277529113):0.0895144903):0.0973384221):0.3702115428,t387:7.12330111):0.1856470946,(((t388:3.230719349,(t389:2.023113154,(t390:1.427249249,t391:1.227504512):0.5632806665):0.9015987065):0.3144869795,(t392:0.9674820702,t393:0.6303832794):1.911339181):3.336023358,((t394:2.228560168,t395:2.141316079):3.072862277,((t396:0.7070453547,t397:0.5657151572):2.552745549,t398:3.08986186):1.878828658):0.33952615):0.3370283303):2.023383528):9.447144945,((((((t399:0.8739727978,t400:0.8712766166):2.034446533,t401:2.881561564):0.3234917935,t402:2.769335638):0.6916995257,(t403:0.9182829037,t404:0.8877164889):2.538598079):1.279266567,((t405:3.903869363,t406:3.585305264):0.2221135569,t407:3.548800969):0.5163560053):1.469940873,((((t408:3.308673342,(((((t409:0.3514647795,t410:0.1919120433):0.8672739508,t411:1.031354229):0.7001153197,t412:1.648743142):0.4706066647,(t413:1.123840067,t414:0.9505008009):0.9737367183):0.01087893718,((t415:1.762224807,(t416:0.8410246134,t417:0.8342659705):0.9123042779):0.05697377215,t418:1.790631183):0.05132568557):0.8502529672):0.311860506,(((t419:1.253074182,((t420:0.1675467669,t421:0.05595502595):0.3451588347,(t422:0.093896923,t423:0.03663336101):0.2917262599):0.6775238637):0.7384907743,t424:1.724118835):0.3113475581,t425:1.88931455):0.5858214254):0.5917136825,(t426:1.094026613,((t427:0.2139836392,t428:0.1091572769):0.03012616343,t429:0.1108201991):0.7378059291):1.824043429):0.07122620956,t430:2.685381804):1.059117827):10.3474306):1.187565483):23.65316911,(((((t431:1.595323901,t432:1.569273472):0.7783793525,((t433:0.2863450678,t434:0.232342449):1.65182645,(t435:1.048613207,t436:1.001844454):0.5090818511):0.1276505706):1.024549308,(t437:0.8797166183,t438:0.8432730178):1.241573261):11.07700491,((t439:1.178448423,t441:0.5906208267):0.7554535311,t442:1.081296716):11.21208273):0.01440408062,t443:12.07771775):24.35788284):1.616369394);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T94.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
