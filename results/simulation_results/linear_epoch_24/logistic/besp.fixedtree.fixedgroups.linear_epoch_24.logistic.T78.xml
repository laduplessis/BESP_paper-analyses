<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t457:2.490117252,(((t445:0.443745534,((t446:0.2428370982,t447:0.03441531563):0.1565966223,t448:0.03016562117):0.04037758608):0.02840460159,(((t432:0.2439793342,t433:0.1783738419):0.501716833,(t388:0.05988468123,(t361:0.07667833576,(t349:0.06190245422,(((t346:0.198405268,t347:0.08937332444):0.08827227815,(t342:0.2646872481,(t299:0.08466846263,(((((t237:0.04351952188,(((t223:0.1246660291,(t222:0.06262630382,(t214:0.06275024079,((t210:0.04699860271,((t200:0.08956710011,(t164:0.07652041092,(((t109:0.4822366219,t110:0.2955598394):0.2577181271,t112:0.2329991128):0.08273604026,(t111:0.1675369729,(((t104:0.1217213615,(((t92:0.5640272549,t93:0.5022701373):0.1909066194,(t95:0.3411787954,(t94:0.1942781454,(((t91:0.109030571,(t1:2.703324404,t2:2.6693819):6.539242375):0.1499255508,t3:9.250742645):0.08763414472,t4:9.142716179):0.07643519373):0.3765695205):0.08078776306):0.3617735125,t5:9.913752548):0.7405719352):0.9770982086,(((((t6:0.4851496653,t7:0.3165645804):5.647456616,t8:5.658943699):1.256997802,(t9:3.227840619,(t10:0.2872000485,t11:0.2441395292):2.8994889):3.603615939):1.727596986,t12:8.270490335):0.4651753824,(t13:3.520352022,t14:3.508364198):5.160395):1.690817807):0.4278953529,(((t15:6.604528217,(t16:5.818634326,(t17:2.109278965,t18:2.091766813):3.657860722):0.7533363834):1.919346804,(t19:3.381202105,t20:3.349962321):5.00797284):1.203705282,((t21:0.3632322611,t22:0.1248662128):8.217497875,(t23:7.159433073,(t24:1.688349078,t25:1.648583917):4.725022648):1.056360346):0.9751359051):1.015946826):0.2056954262):0.4667590161):4.102136523):3.483135311):1.2405663,((t26:5.572735685,((t27:1.057436704,t28:0.9044876886):1.454279445,t29:2.256897664):2.916669306):0.2760289645,t30:5.25777451):13.00533545):0.1733318331):0.08680814377,((((t31:5.341539554,(((t32:0.5805718826,t33:0.2914954714):0.1042160851,t34:0.1473997035):1.513714228,t35:1.656821655):3.058236723):1.24965027,(((t36:1.789735075,(t37:1.349969442,t38:1.33449416):0.4274250213):0.05829384625,(t39:1.677385134,t40:1.662551525):0.04405281155):1.974853966,t41:3.5030612):1.974575969):0.765874727,(t42:5.743205678,((t43:2.299785658,t44:2.2868356):0.7760888217,t45:3.016344615):2.654292871):0.4399972692):0.2843130137,(t46:4.772507861,((t47:1.969644824,t48:1.85495747):1.693275494,(t49:0.8311022325,t50:0.7059152238):2.665117689):1.023301752):1.253706585):10.88016118):0.1404289542):0.5684417153):0.2985531895):0.06909681209,(((((t51:3.766985401,t52:3.472407621):1.442810915,t53:4.793441617):10.17031556,(((((t54:2.921332347,(t55:0.7128443788,t56:0.4859222305):2.177632574):0.2814853118,t57:2.943705725):1.483322529,(((t58:1.760965966,t59:1.743152481):0.9357134954,(t60:0.5867761064,t61:0.4559069162):1.816228947):1.412320706,t62:3.421881732):0.2189676567):0.8112056246,t63:4.29140919):0.9298066902,((((t64:1.138858994,t65:0.9623832879):2.074942625,((t66:0.3505502423,t67:0.3244003202):1.093684471,t68:1.402494672):1.437727531):1.538290144,((((t69:1.099286806,t70:1.041003661):0.5055521427,(t71:1.370943249,(t72:1.348973222,t73:1.33137686):0.000552697796):0.1435920256):1.431218834,(t74:1.07063913,t75:0.9924676184):1.794840764):0.5236664472,((t76:2.407871799,(((t77:1.246994918,t78:1.214641287):0.4279773809,t79:1.637194466):0.6854431837,((t80:1.796255627,(t81:1.515706063,t82:1.50086842):0.2504824256):0.3030543893,t83:1.913009153):0.0246487912):0.03981883965):0.4271497534,((t84:1.007520415,t85:0.9941743189):0.6378294176,((t86:0.9240016317,t87:0.9130005779):0.5115926273,t88:1.379856263):0.1684535753):0.7543717622):0.3914937563):0.8097318536):0.2819155183,(t89:3.035594043,((t90:1.599991371,(t96:0.2889409081,t97:0.2587017437):0.1793536381):0.3934202665,(t98:0.5323800096,t99:0.4737354341):0.08249856543):0.8987763733):0.7039872):0.1293913051):8.326022909):0.9687095848,((((t100:0.2491751472,t101:0.1980458573):0.04437361804,t102:0.1158944956):0.316392317,t103:0.3693460763):0.3241196865,t105:0.5482672798):10.42592979):0.1646331577,((((t106:0.8214414225,(t107:0.3588345991,t108:0.1306767026):0.2188525505):7.097701457,(t113:1.365257028,t114:1.236285777):4.67923078):2.701020053,t115:8.597819879):0.00775226384,(t116:2.020033072,t117:1.828446518):6.564945778):0.318459149):1.088710713):1.056612588,(((((t118:5.442288927,(t119:4.901608298,(t120:0.3545995408,t121:0.3122663938):4.346337247):0.5143306765):0.9390892944,t122:6.088261327):1.15662748,t123:7.214545131):1.892254755,(t124:7.854400107,(((t125:1.400857151,t126:1.399882293):3.116883541,(t127:1.280468985,t128:1.245415917):3.13460628):3.242117294,(t129:5.29748782,t130:4.705620915):2.314577839):0.06640445869):1.234966447):1.003859148,((t131:7.561415125,((t132:0.6234574927,t133:0.6085530029):6.437107569,((t134:1.680675922,t135:1.651334458):2.89530165,t136:4.51562933):2.29861752):0.2850623906):1.672740076,(((t137:4.423954841,(t138:3.536999287,t139:3.450293572):0.8709266088):1.942857842,(t140:5.63892712,t141:5.568674091):0.553054168):0.8703500782,(((t142:4.708564529,(t143:0.3649358475,t144:0.3027424729):4.342946289):1.461461185,t145:6.036734084):0.119910835,(t146:0.6001850118,t147:0.5549307659):5.438379647):0.6537290536):1.470729513):0.07135284998):0.3852928033):0.03374875267):0.8654591265,(((((t148:6.004789216,(t149:1.850273817,t150:1.812102341):4.105064813):0.08126979281,(t151:4.473745673,t152:4.454174273):1.185755384):0.5695444968,(t153:6.015942249,t154:5.905670082):0.1441115234):1.667550702,((((((t155:0.8664930983,t156:0.836685995):4.389875234,((t157:1.738064282,t158:1.580372629):0.6814308761,t159:2.073407783):2.76607763):0.2052956318,t160:4.9697707):0.9535376742,((t161:0.7158064264,t162:0.6075634635):3.06212081,t163:3.638523658):2.078171522):0.4533604174,(((t165:4.518671427,((t166:1.916575177,t167:1.755193526):2.455732166,t168:4.177179677):0.1097104428):0.07559688844,(t169:3.634786718,(t170:0.4576548515,t171:0.4539366229):3.11097327):0.7218451229):0.4571355296,((t172:3.175131906,(t173:0.7551122163,t174:0.6016435665):2.074194195):0.0735794624,(t175:1.030332214,t176:0.9674498783):1.525616877):1.383833608):0.7773267339):0.3699513861,((((t177:2.633623361,((t178:0.5882702326,t179:0.5595154786):0.5405048528,t180:0.4123344454):1.453348696):0.8550893244,((t181:0.8770835772,t182:0.87182535):0.3768099429,t183:1.156700671):1.460046973):0.8698983651,((t184:2.755759678,(((t185:2.075415631,t186:2.043729616):0.1458417395,(t187:2.036475823,((t188:0.8698247677,t189:0.8692295222):0.9500453628,t190:1.800547274):0.0717169667):0.1515352238):0.1652971801,(t191:1.947406346,t192:1.872279415):0.1443657309):0.04936867894):0.5166399111,(t193:0.8933921939,t194:0.8761717927):1.66706555):0.1348356157):0.2010318462,((t195:1.341116717,t196:1.329581875):0.4490281688,t197:1.628677743):1.075790801):0.4369252747):0.4571097876):0.8403846412,((t198:1.731280971,(t199:1.53025484,t201:1.275864947):0.1564595069):0.764369496,(t202:0.2248692494,t203:0.1669355337):1.698753658):1.923303777):0.3041417657):0.005648112496,t204:3.896454688):1.903969869,(((t205:1.377631034,t206:0.9559148521):1.684650534,((t207:1.443864432,(t208:0.6376604301,(t209:0.2144355469,t211:0.08249933946):0.3978239191):0.6954956127):1.014600677,(t212:0.7369960202,(t213:0.6787795473,t215:0.5823188212):0.02475581108):1.398889266):0.02662828462):0.2461964926,(((t216:0.4095898779,t217:0.2958512675):0.249020805,t218:0.5251752817):0.1470386258,t219:0.6464573668):1.380317971):2.49170643):3.029997611,t220:7.533595283):0.5249209318):3.745267208):0.7835809954):0.05503912386,((((((((t221:0.9692929485,t224:0.4340418815):0.4280938583,(t225:0.2922811,t226:0.245435005):0.5564447547):0.6182770231,(t227:0.2835016521,t228:0.07414368404):0.9722216254):0.368549855,t229:1.400221702):2.71153318,(t230:0.1446954826,t231:0.1286492394):3.683381375):6.450572828,((((t232:0.9664356995,t233:0.9603784296):1.004070248,(t234:0.1465505732,t235:0.1126163968):1.772702461):7.162040799,t236:9.041281765):0.5277806293,(((t238:1.456894402,(t239:0.3483828872,t240:0.3410689814):1.002866395):0.08081885273,(t241:0.6579407107,(t242:0.2266414759,t243:0.1562661288):0.2647679979):0.4612240783):6.739976387,(t244:0.1663669061,t245:0.01360295082):7.342962807):1.073727664):0.5140082218):0.1145134082,(((t246:7.363361864,(t247:3.048475058,t248:2.928518714):4.270931619):0.1163751697,((t249:0.506906673,t250:0.4983629138):4.253126455,t251:4.573202698):2.486846719):0.9961396801,(t252:7.406017831,(((t253:0.7231136193,t254:0.6964922305):2.945184708,(t255:0.49891603,t256:0.3257117602):3.141513704):2.012667316,t257:4.608528022):1.709858332):0.6227855986):0.5582007104):0.0755409362,((((t258:2.313653507,t259:2.168599083):3.289333855,t260:5.294764672):1.306935271,(t261:1.414878197,t262:1.404487716):5.117018078):0.5649015176,t263:7.06680641):0.07382688301):0.7859159576):0.6261285613):1.391631308):2.882367779):5.122543163):1.065761935,(((((((t264:8.680756286,(((t265:5.46637112,((t266:1.028551462,(t267:0.05781124821,t268:0.02174050371):0.9537124529):2.765802167,(t269:3.442865587,(t270:0.3625231618,t271:0.3596670051):3.067446993):0.2850278589):1.609254944):0.584233088,((t272:5.646736543,t273:5.580863026):0.112025135,((t274:0.362512443,t275:0.1989948082):4.728436389,(t276:1.037551767,t277:1.024356541):3.847087092):0.4266422157):0.03064153558):1.057128099,(t278:2.152494633,t279:2.135375055):4.231729498):1.549909142):0.01196818318,((((t280:3.167245104,t281:3.155955051):2.915874979,t282:5.979548913):0.08671661691,(t283:5.257773416,t284:5.215827906):0.7484425202):1.086621362,(((t285:1.209273765,t286:0.9682330951):3.606069066,(t287:3.855891126,(t288:0.3757319339,t289:0.1209282522):3.406612708):0.6097429884):0.9236497955,((t290:3.632245959,t291:3.539612192):0.9318497411,t292:4.316249252):0.2018357935):1.296443289):0.5990529507):0.04767607585,((t293:1.87578978,t294:1.869486176):2.583979169,(t295:4.272824297,t296:4.035773669):0.1109455096):1.99936173):1.004057917,(((((t297:3.335352557,t298:3.078321826):0.5925891313,((t300:2.931977886,(t301:1.772303113,t302:1.635884202):0.9062684301):0.1894097638,t303:2.714828137):0.3033936968):0.1719439361,t304:3.172885493):1.943623346,(t305:3.708500983,(t306:3.396683918,(t307:3.068838544,(t308:1.386750114,(t309:1.272497234,t310:1.233204436):0.09346866975):1.64781584):0.2315906456):0.3109109899):1.388515552):0.8921878364,(((t311:0.9823291073,t312:0.9801558391):0.138789023,(t313:0.3659834381,t314:0.128521676):0.7356539605):0.8478575298,(t315:0.8668303389,(t316:0.02139677511,t317:0.01117224277):0.78743067):0.762624647):3.45850975):0.1537591655):7.060565182,(((t318:2.748686221,(((t319:1.40093557,(t320:0.6962871703,t321:0.6039073665):0.6845656542):0.7759206875,t322:2.035098775):0.01613008819,(t323:0.8614194256,t324:0.7165968527):1.147036537):0.4798729892):0.611504186,(t325:0.7372351437,t326:0.6065845037):2.184160036):1.212036258,(t327:1.856905069,(t328:1.48133031,t329:1.433567647):0.2240922651):2.134322584):7.588791697):0.6935645118,(((((t330:0.3378804289,t331:0.2549835146):1.686474956,(t332:0.8372119917,(t333:0.7168847868,t334:0.634394615):0.1113398424):1.072209141):2.441064827,(t335:0.320234424,t336:0.1066942053):3.646134378):3.420880599,t337:7.080498801):3.964091327,((t338:2.226174952,((t339:0.8510606934,(t340:0.3271739124,t341:0.2673248919):0.4625307859):0.09603942576,t343:0.2635537432):1.251188995):1.427563532,t344:2.921097765):7.347352857):0.1338569749):1.079499347,(((t345:2.040095119,(t348:0.8870088764,t350:0.3581587862):0.2691477205):0.2564268446,t351:0.8421521429):1.521106792,t352:2.105944222):7.623278013):0.1796949485):0.5688034025):0.8141697218,(((((t353:0.5437336549,(t354:0.5280808962,t355:0.5164056031):0.004205797985):0.7040409835,t356:0.980132635):3.540478772,(t357:0.490034644,t358:0.4532831097):3.999757692):3.796877131,(t359:1.569429534,t360:1.517434498):6.567516543):1.110458016,(t362:0.7837246272,t363:0.753257021):8.320258971):1.347564524):2.630101388):8.646858955,((((t364:7.667369146,t365:7.569022019):2.300257716,((t366:5.353315398,((t367:0.6624215326,t368:0.5669575475):3.390816819,t369:3.847882615):1.253374229):3.067204862,((t370:5.909072988,t371:5.171910841):1.736629255,((t372:6.406564882,t373:6.260562862):0.2013210946,t374:6.451569899):0.1235638003):0.5220431368):1.374747455):1.183090873,((((t375:1.355387119,t376:1.260874499):3.502613572,t377:4.71611307):0.6205416846,(t378:3.478104751,t379:3.474620839):1.625159356):1.992376254,(((t380:4.264741282,t381:4.094857779):1.683697112,t382:5.707878305):0.524032106,t383:6.213122732):0.5820163614):1.941446508):9.430500714,(((t384:5.043868667,(t385:4.642690594,t386:4.591861999):0.387477856):1.35401527,(((t387:1.842524289,((t389:1.096802449,t390:0.8384533561):0.01467016028,t391:0.75052528):0.3452188487):3.77295257,t392:4.398201117):0.3660655509,((t393:0.3725990491,t394:0.0718218289):3.250491723,t395:3.157016604):1.036269826):0.245940259):1.785237897,(((((t396:3.436757567,t397:3.271776632):1.764869278,((t398:4.754958011,t399:4.747457762):0.1155598303,(t400:4.111821814,(t401:1.040988274,t402:0.8797780308):2.968071535):0.5745354361):0.1406409936):0.4995994499,((t403:1.960564532,t404:1.813399882):0.9596049382,((t405:2.322706389,t406:2.32231826):0.2183503503,t407:2.257861856):0.214459518):1.791943036):0.2741220486,((t408:2.203480832,(t409:2.02005802,(t410:1.886825866,t411:1.685906856):0.09989065611):0.1474122545):0.7418332076,(t412:0.3241606669,t413:0.3144421217):2.342315626):1.448803772):0.1085746152,((t414:1.83311756,(t415:1.655925974,t416:1.65095949):0.175938674):1.179001614,((t417:2.226972446,((t418:0.9012631866,t419:0.8725103786):0.4668868174,t420:1.265388359):0.6262374496):0.1180131693,t421:1.965495135):0.6147863151):1.173610338):0.1164604387):9.966798782):1.096989881):84.96947084,((((t422:4.127219494,(((t423:1.445809074,(t424:0.6022041163,t425:0.5561422549):0.7722756781):0.5586710315,(t426:1.088207368,t427:1.082365221):0.7950773789):1.959862326,((((((t428:2.317821928,(t429:0.9970682078,t430:0.8828068656):1.29546617):0.2408396754,(t431:2.189784201,(t434:1.030950428,t435:0.9251564768):0.1559555958):0.2083472219):0.09817901027,t436:1.141891594):0.2453314423,t437:1.360300806):0.4920563115,t438:1.771489334):0.2892823067,t439:1.962782021):0.1352818606):0.1536333998):0.7768316307,((t440:1.154046774,(t441:0.6789424291,(t442:0.5570521742,(t443:0.2915344955,t444:0.2863721116):0.2572801096):0.02363163567):0.4608838867):1.20079475,(t449:1.031950461,(t450:0.486401206,(t451:0.3027942967,t452:0.1530410163):0.1185311407):0.4688793282):0.4408034434):0.558229874):2.613848269,(t453:0.6687903898,t454:0.4725586376):3.565892723):19.48355021,(t455:0.6169692916,t456:0.5759407258):22.84733283):72.88672668);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T78.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
