<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t444:1.834477873,(t445:1.23197581,(((t446:0.5200069293,t447:0.4351987459):0.05415142972,t448:0.4099297944):0.08013844418,t450:0.2961914688):0.3671325581):0.4614166322):13.93030159,((t451:0.370795205,t452:0.268462877):1.875660329,(((t453:0.08948729849,t454:0.02448898843):1.078848034,t455:1.065277918):0.19864859,t456:1.239882561):0.7555605291):12.77617169):10.91504687,(t457:0.8408003766,t458:0.5424920949):24.83375329):2.399741036,((((t459:2.169631681,((((t460:0.4988542858,t461:0.4222217493):0.3108317193,t462:0.6597528704):0.3774751215,(t463:0.7848323364,(t464:0.479652305,t465:0.2335181262):0.1761735777):0.01691813576):0.7189535299,(t466:0.4166242595,((t449:0.03479343436,(t349:0.3615370416,((((t248:0.1156415426,((t244:0.005758529011,(((t220:0.08094296997,(t150:0.01957527929,(t127:0.2195331444,(t122:0.1465776104,((t119:0.218200247,t120:0.1901689961):0.3621178485,((((t16:0.005991900342,(t1:0.9961845233,t2:0.8170137001):0.4730132911):3.887119918,t3:4.913133002):3.343403603,(t4:6.719815011,(t5:4.319663075,t6:4.13992364):2.047044753):1.455953787):0.3425250744,t7:7.946833421):1.630948265):0.1702108573):0.6569209575):2.991822683):6.715660453):1.177063495,((((((((((t8:0.09191788663,t9:0.08150877128):0.1339614014,t10:0.2060259932):8.529402224,t11:8.715696085):0.1077455767,(t12:7.227795572,t13:7.148780573):1.543377061):0.3824591146,t14:9.053032051):0.3272591371,t15:9.288257214):0.6342059939,(t17:6.615986158,t18:6.318770044):3.107617627):0.1074369295,((((t19:1.822991845,t20:1.793904503):0.5178356952,t21:2.10310778):5.787819111,(((t22:1.833056158,t23:1.812252348):2.191600548,t24:3.958091647):3.522560792,(((t25:5.148382513,(t26:1.706431412,t27:1.706044153):3.386091059):1.185528991,t28:6.242195622):0.2021675933,(t29:6.212416068,t30:6.196719927):0.03291812841):0.8124807937):0.2480980682):0.3700564597,(((t31:1.742834953,t32:1.73303746):0.3478795721,t33:1.986265488):4.940887469,((t34:5.801167678,(((t35:4.27461378,(t36:3.495006451,(t37:2.303997742,t38:2.188369681):1.082788184):0.7098920229):0.3220332211,t39:4.300534635):0.954789425,((t40:0.06075495753,t41:0.00297767289):3.817993297,t42:3.80458354):1.336365566):0.2124732733):0.7003965104,(((t43:3.875814656,t44:3.835060791):0.4982181661,(t45:2.540911792,t46:2.534977221):1.639850986):0.5645872265,(t47:0.702567207,t48:0.4862685411):3.985137378):1.059749533):0.4128634564):0.5118320969):0.651239713):0.2816934178,((t49:3.027248737,t50:2.793237818):3.966228158,(t51:4.936456177,((t52:3.306535264,((t53:0.4316194823,t54:0.3838944665):0.4135206559,t55:0.7702622042):2.448677069):0.6328531796,t56:3.562290755):0.8797232904):1.788674886):0.3451091079):1.464425226,(((((t57:4.787229886,(t58:2.650347811,(t59:1.795319623,t60:1.746519796):0.794177006):2.123146824):0.04116000281,((t61:4.360703532,t62:4.360432268):0.001657686739,t63:4.355017593):0.3227798042):0.6624184104,(((t64:4.451778421,t65:4.255474371):0.1902736294,(t66:0.4897801047,t67:0.202626396):3.72105759):0.6009024923,(t68:2.984548654,(t69:2.560756885,t70:2.533654787):0.306518111):1.291537056):0.0287138467):1.463772417,((((t71:3.758052502,((((t72:2.11387441,t73:2.111599225):0.3314134193,(t74:1.312783436,t75:1.239602342):1.09743165):0.1054160266,(t76:1.299139525,t77:1.274391351):1.107348401):1.024079005,(((t78:2.203461498,t79:2.141775257):0.5893374097,t80:2.729966888):0.4557520004,(t81:2.707702533,(t82:0.513212654,t83:0.4935080593):2.112886252):0.4777601496):0.08159886239):0.1186476294):0.1133878274,(t84:2.799618777,t85:2.55419456):0.5243505178):0.1613880229,(t86:2.743400831,(t87:0.4845257447,t88:0.3233204031):2.252081109):0.4647334915):0.5794190072,(t89:1.833466889,(t90:0.8133358417,t91:0.7948671995):0.9741009872):1.78149348):0.9287175659):0.05598922666,((t92:1.573239558,t93:1.474096125):1.75737982,((t94:2.068220672,(t95:1.104323479,(t96:0.4061386916,t97:0.3894837345):0.5937927229):0.7419227109):0.8155097881,((((t98:0.03745179559,t99:0.02892959706):0.1818823435,t100:0.1615565481):1.289265705,t101:1.428621653):0.111620985,(t102:1.111864912,(t103:0.2982354574,t104:0.2484016596):0.7956130482):0.3257224325):0.7753716719):0.3353907005):1.157184116):1.027532838):9.195228019):0.3816269862,((((((((((t105:1.285209952,t106:1.217072646):0.215332459,t107:1.117095416):0.4754166975,(t108:1.095189242,t109:1.038014626):0.4032238213):0.8109526508,((t110:0.3996276538,t111:0.3025520937):0.5140966039,t112:0.3379563123):1.21882883):0.4887560985,t113:2.034637738):0.3288557849,((((t114:0.2257108543,t115:0.2165602198):0.1134102077,t116:0.3247163185):1.095027834,(t117:1.238788498,t118:1.220248618):0.1542495729):0.01888008898,t121:0.6393175745):0.8871364389):2.992622141,(((t123:0.2514707385,t124:0.1991489254):0.474668003,(t125:0.2540707429,t126:0.1354830362):0.3791389567):1.912796019,((t128:0.7785842984,t129:0.6906710483):0.2528640654,t130:0.9305855553):0.9234411761):1.55722462):1.204242191,t131:4.420544463):3.982970263,t132:8.105155266):1.701223943,(t133:1.158467862,t134:1.157356156):8.596058054):0.6792704154):0.9855606355):0.2326053305,t135:11.46713754):0.7585573896):1.211257114,(((t136:0.3137758379,t137:0.2227364005):9.218029984,(((t138:0.9778749478,t139:0.9630795984):6.160697382,(((t140:0.5118822003,(t141:0.3831875977,t142:0.2784827935):0.1156326139):5.168670907,t143:5.214978259):0.890722247,(t144:0.02277853352,t145:0.01091353607):5.986222683):0.4692482308):1.352133509,t146:7.742054402):0.9394627437):0.3594890996,((t147:0.8923172235,(t148:0.7539573103,t149:0.5479740813):0.04347392038):7.094971788,(t151:7.216140603,((t152:2.941958916,t153:2.930702419):3.973848067,(t154:6.363123319,t155:6.26224567):0.4489107141):0.2676930365):0.3052968158):0.82115827):3.063245081):6.065406867,(t156:7.855314032,(((((t157:0.02041666963,t158:0.003305540503):4.26050371,(t159:3.522071154,(t160:3.391402684,t161:3.38237322):0.12623235):0.7324957209):2.642271138,(t162:2.196886369,t163:2.145649071):4.389152386):0.09296069143,t164:6.625993209):0.5828322116,(t165:6.945350591,(t166:6.75925914,(t167:6.295022983,(t168:5.592633507,(t169:4.769620545,((t170:1.327952148,t171:1.166931579):3.318129729,t172:4.455117603):0.1138755161):0.680253376):0.6665333971):0.4176998977):0.1511631648):0.2047300156):0.2204551316):9.361697637):2.261501026,((((((((t173:4.585644799,(t174:0.7205287799,t175:0.3498279633):3.623309765):1.098225577,t176:4.825722752):0.1262250971,(t177:4.232745776,t178:4.178834943):0.7134808816):1.003761491,(((((t179:1.142062606,t180:0.9564919623):1.103609645,t181:2.019147275):2.908788744,(t182:4.272852764,t183:4.198860633):0.5488991475):0.6612017042,t184:5.361651074):0.02056331314,((t185:3.621303449,t186:3.512592602):1.565368979,(t187:3.822559809,(t188:2.348655322,t189:2.177236207):1.42209947):1.238091759):0.1514555999):0.05797610665):1.741913234,((t190:3.835020887,(t191:2.640877073,(t192:0.8311298153,t193:0.8203034433):1.381270297):0.8037432114):0.4668027452,((t194:1.697709561,t195:1.576390164):1.447021353,(t196:2.798670342,(t197:2.703467694,(t198:0.4280949374,t199:0.3916044053):2.180344387):0.02249878141):0.119936077):0.3117062173):2.117214377):1.065326845,((t200:3.241468367,((t201:1.145064131,t202:1.104772503):1.895082607,(t203:2.462012279,t204:2.114594028):0.5142556841):0.1888188545):1.739229906,((t205:2.042217033,t206:1.734200724):0.03424245376,t207:1.733537646):2.352774566):1.13340532):8.325779713,(((t208:3.039238051,(t209:2.994362972,(((t210:1.266766009,t211:1.250660963):0.1932583594,t212:1.40748765):0.01532067951,(t213:1.152870934,t214:1.137211828):0.2630047084):1.408726074):0.01981275909):0.8733150116,(((((t215:1.716027782,((t216:0.4912990195,t217:0.478323832):0.9988929097,t218:1.459146923):0.1543158679):0.09786680022,t219:1.500287919):0.7559601946,t221:1.259520841):0.5536373007,((t222:0.05994588521,t223:0.03916802968):0.7840159144,(t224:0.2319002401,t225:0.2123593802):0.5554113494):0.8372040033):0.4055114178,((((t226:0.4233018664,t227:0.3696783116):0.8274903106,t228:1.163607415):0.1747758958,((t229:0.1668876188,t230:0.1588427841):0.3445445525,t231:0.1672873264):0.8034074653):0.02494423366,t232:0.8157277313):0.5368677567):0.0389220051):1.999807974,(((t233:0.6718328221,t234:0.5812408386):0.8641793229,(t235:0.2273180552,t236:0.1870154452):0.9927029996):1.027322976,(t237:2.204231178,(t238:0.578977402,(t239:0.4389276712,t240:0.3501017367):0.02900293685):1.575345085):0.0001502455678):0.6301898392):7.511698358):0.2662305716,(((((t241:0.5895111143,t242:0.5855615224):0.3199303301,t243:0.8173483692):1.381059034,t245:1.801286457):7.001341901,((t246:0.8844149335,t247:0.791747033):3.800821111,t249:4.086705442):3.690429876):0.09637976571,(t250:6.819850291,((t251:5.597001495,((t252:0.2819774296,t253:0.2503118544):3.42900571,((t254:0.02759437712,t255:0.004161190537):0.2091702963,t256:0.1246133626):3.438879473):1.716180982):0.9300175608,t257:6.173165886):0.2584719735):1.041125649):0.9724679954):0.3191655421):1.521835638):10.21012743):0.7911465618,(((((((t258:0.238745154,t259:0.1561986232):0.6880423272,t260:0.3857845422):0.355715104,t261:0.4281951204):6.882455909,(t262:3.716823043,(t263:3.432620506,t264:3.224115868):0.1362878827):3.584794349):10.39083623,((((((((t265:6.086985706,(t266:4.826035578,(t267:2.365161402,(t268:0.6219575529,(t269:0.5926105124,t270:0.5164230196):0.006746533124):1.717921702):2.141794431):1.196235649):0.01885142771,t271:5.531540469):0.4188244645,(t272:5.598621896,((t273:3.806629379,t274:3.714242905):0.6787189402,t275:4.368691844):1.102680651):0.3053058982):0.1879040461,((t276:0.1148967832,t277:0.09878402863):5.698822898,t278:5.790742295):0.1496607483):0.7371596065,(t279:6.656495895,((t280:2.807045205,t281:2.362475442):2.495959135,((t282:0.2088414154,t283:0.1000864103):3.424788063,(t284:3.030695996,t285:3.029615714):0.3533133662):1.206295389):1.21970386):0.008582686076):0.2586679539,((t286:3.671210398,t287:3.664390525):1.796328039,(t288:4.831950332,t289:4.808328331):0.6143303048):0.5070481464):2.003279521,(((t290:5.881500033,((t291:4.93433492,((t292:2.735422989,t293:2.613128373):1.86781932,((t294:2.271458952,t295:2.225653299):1.271372716,((t296:1.71626666,(t297:1.338005136,t298:1.114614625):0.3317764971):1.123139056,t299:2.497339208):0.4370392421):0.8808822982):0.2271622103):0.685950242,((t300:4.60202099,t301:4.574490288):0.09630066223,(t302:4.484671202,((t303:3.855282992,((t304:1.21354155,t305:1.133316127):2.406517824,(t306:3.513720316,t307:3.199500247):0.01302022619):0.1791160176):0.1775912053,(((t308:0.5444345675,t309:0.4853397916):2.452028173,(t310:2.542668111,t311:2.44585007):0.293987752):0.3693125139,((t312:1.197447699,t313:1.170199212):1.544974925,t314:2.616674189):0.3515185672):0.06292312727):0.3810554508):0.1220814629):0.01780526014):0.05046186138):0.7751114336,((t315:2.637300128,t316:2.580161467):1.450306001,t317:3.957538226):0.2848645162):0.226727629,(((t318:2.827759449,((t319:2.402929998,t320:2.226370867):0.2380304498,t321:2.365161691):0.01015684694):0.9400302885,(((t322:1.916390318,t323:1.88890396):0.5065664199,t324:2.356410007):0.03824506021,(((t325:0.9698665361,t326:0.8622832094):0.6205665809,t327:1.313454085):0.4176435436,t328:1.717815778):0.3578002882):0.7258392507):0.2985180597,((t329:0.4930885473,t330:0.2641521735):1.643440763,((((t331:0.1233555076,t332:0.1153327308):0.2397588842,t333:0.3065506676):0.9643811369,t334:1.189144242):0.1788550043,((t335:0.1700588992,t336:0.0925261938):0.6746709877,(t337:0.2403406501,t338:0.05621209367):0.229028422):0.3613135349):0.354021072):0.7670359339):0.2743927212):0.7702659703):0.8793233033,((t339:0.9218101172,t340:0.7894592784):0.6018851073,(t341:0.257321927,t342:0.155689338):1.025765034):2.130833772):6.727172692):1.632681585,((t343:0.8487176825,t344:0.7207188652):2.247927496,t345:2.456912306):8.554257323):0.6425041509,((((t346:0.4741609821,t347:0.4218326638):0.05468388697,t348:0.2882742792):0.451987426,t350:0.08276876949):1.63867129,t351:1.535784044):8.85057327):0.2031280385):1.268383994):0.7280021247):0.1918832902):1.167550937,(((t352:3.701062925,((t353:1.597570032,t354:1.454927437):0.5437094758,t355:1.902012984):1.376973692):6.012973208,((t356:0.5408104909,t357:0.1325481943):7.7267368,((t358:0.4607126644,(t359:0.1591691643,t360:0.01982314077):0.1837606526):0.2475931089,t361:0.3074118289):7.12349751):1.021979342):0.9662938976,(((t362:7.462412026,(t363:5.176627978,t364:5.065455118):2.283312671):1.457660583,(((t365:2.662905507,(t366:2.19017419,t367:2.13693264):0.4287199054):4.140579538,t368:6.702784577):1.424154114,(t369:6.602764643,t370:6.587323098):1.509280937):0.5776923044):0.09533844537,t371:7.991386716):0.3841957364):3.259828292):8.154214591,(t372:8.783050982,((((t373:3.82438752,((t374:0.4653757053,t375:0.4013463936):2.970866844,(t376:0.4198042137,t377:0.4079069441):2.948592678):0.06856647739):0.4634541413,t378:3.861836748):2.237800249,(t379:4.477946182,(t380:1.795431021,(t381:1.462524984,t382:1.440337075):0.2850277973):2.679835128):1.592068613):1.628183427,(t383:5.020271594,(t384:3.740542014,t385:3.526658589):1.226879099):2.597853198):0.5856555845):10.94388117):3.221526046,((((t386:7.403030056,(((t387:6.698979539,((t388:3.044971385,t389:3.035931284):2.192810285,t390:5.228584055):1.307939843):0.5374279322,(((((t391:4.563034641,t392:4.470898372):0.9316978953,(t393:4.645610862,t394:4.603581779):0.7274108329):0.3968150378,(t395:4.196104003,((t396:1.340291859,t397:1.120845133):1.755614038,t398:2.816639853):0.9626899304):1.274179206):0.0727275865,(t399:4.085162587,(t400:2.972372074,t401:2.640201576):1.082118639):0.9080300294):0.6870523675,t402:5.316775777):0.3776570823):0.1387465741,(((t403:1.912852227,t404:1.891082649):2.663689907,t405:4.477805722):1.11769846,(((t406:1.867096868,((t407:0.7931734487,t408:0.7312566262):0.7411175739,t409:1.45435299):0.3087964228):1.667058789,(t410:0.315604553,t411:0.1643354431):3.093878714):1.417608601,t412:4.637034892):0.5440942017):0.08230463049):0.02650459704):2.197398263,((((t413:1.440538121,t414:1.234214737):0.3818714701,t415:1.54775762):0.1260715584,t416:1.32318653):1.839580009,(t417:0.6823137266,t418:0.5770842725):2.469572906):3.697394084):0.2769794265,(t419:5.394465094,((t420:4.376611849,(((t421:2.505600061,t422:2.315965478):0.3986106183,(t423:0.9953086313,t424:0.8677578655):1.233812613):0.701701171,t425:2.770399701):0.5877731834):0.6314601006,t426:3.989357559):0.2579977588):1.465980187):1.661724901,(((t427:1.255624499,t428:1.210074489):2.234420343,((t429:2.440442553,t430:2.407191113):0.02915387293,(t431:1.728086498,(t432:1.174818155,(t433:0.8904909382,t434:0.7295946789):0.263052084):0.5472187489):0.5738679856):0.9339508383):0.4516276367,((t435:1.097602254,t436:0.9400134937):1.810307497,((t437:0.2742661342,t438:0.2482530863):2.033654549,(((t439:1.262336769,t440:0.9387927408):0.3180195932,t441:1.236293282):0.3991089973,(t442:0.5782637954,t443:0.2121279132):1.014687234):0.2989510232):0.3947543045):0.5295694302):3.267675272):10.49203375):13.00586967);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T4.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
