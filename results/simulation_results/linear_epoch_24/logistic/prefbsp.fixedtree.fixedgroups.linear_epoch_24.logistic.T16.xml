<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t469:1.684659945,t470:1.441005066):11.15000242,(t471:11.85997745,(((t472:0.3776569409,t473:0.2967729406):0.6784144482,(t474:0.2881974243,t475:0.04816611165):0.6147717629):2.434492718,t476:2.800207264):8.19368719):0.6345313772):24.01527883,(((((t458:0.1184863857,((t422:0.05484124517,(t378:0.021849055,((((t361:0.0315476647,(((t348:0.06268022155,(t340:0.02510587704,(t336:0.2769323387,(t263:0.05903206773,(t257:0.02380439512,(t254:0.09310401714,((t239:0.3507285348,(t240:0.1529910319,((t234:0.03775656248,(((t229:0.3209701671,t230:0.2045984415):0.05535927133,(t207:0.06232286904,((((t117:0.04754100187,(t91:0.1917745092,(t1:8.003343653,(t2:0.3635701813,t3:0.2219394279):7.513096386):0.4654305144):1.768132567):0.6708096655,((((t4:8.318855477,(t5:4.785825185,t6:4.755469141):3.444055527):1.186428726,((((t7:0.3675855898,t8:0.2255571263):2.634331909,(t9:0.9024923421,t10:0.6012953534):1.945591829):4.936242889,t11:7.460860635):1.01756813,t12:8.323679811):0.1707412621):0.1327284575,t13:8.624167921):0.8951326147,((t14:5.915249815,(t15:5.292221476,(t16:4.100575384,t17:4.000923863):1.154930137):0.5726428638):2.89509539,(t18:6.536494848,(t19:0.2182290427,t20:0.1885280337):6.219438623):2.07639761):0.6331044629):0.02810753392):0.3205956046,(t21:5.901728732,t22:5.764622931):3.325248097):1.38138176,(((t23:0.7547764759,t24:0.6403775769):8.833730578,((t25:6.441812741,t26:6.40519617):0.001064522783,t27:6.339395871):2.904625316):0.6626095775,t28:9.78163576):0.1495792275):6.09991536):2.79627931):0.3298499328,((((((((((t29:2.598973145,t30:2.486859119):2.171629805,((t31:1.401124486,t32:1.381882683):1.219776956,(t33:1.411746306,t34:1.344329854):1.167391198):1.960216098):2.257130561,(t35:5.46619954,t36:5.450935548):1.249583922):0.1724512779,t37:6.800394622):1.722490809,((((t38:4.271327253,(t39:0.3335983261,t40:0.07413442724):3.849019638):2.074118268,t41:5.964358299):0.2939654276,(t42:2.579651788,t43:2.5660657):3.611782546):1.585818741,(t44:6.616439025,((t45:0.4842200024,t46:0.2712913594):5.936697543,(t47:2.982940956,(t48:0.2034628093,t49:0.1934572328):2.274190207):3.066266005):0.08495669022):1.103846575):0.2691147423):0.176406854,((t50:5.62225557,((t51:2.307707525,(t52:1.935006098,t53:1.845485052):0.3633747344):2.727015331,((t54:0.6062888378,t55:0.3518506838):1.620804655,t56:1.941725601):2.57461762):0.494341933):0.2590887763,(((t57:4.213493517,(t58:2.48324806,(t59:0.6651708569,t60:0.5507526036):1.655387314):1.700666636):0.4660718507,((t61:2.268817493,t62:1.972789108):1.9229421,(((t63:1.375940979,(t64:1.119137165,t65:1.110979075):0.2494337793):1.000459153,t66:2.198436202):0.4701903781,(t67:1.357477994,t68:1.289862686):1.180265473):0.8395314037):0.1549304048):0.3901781361,t69:3.815303583):0.1731417177):1.232871094):0.8550604338,(((t70:3.174031561,(t71:2.379837915,t72:2.229870047):0.5795841067):0.1930935233,((t73:2.191790035,t74:2.180956067):0.2288917212,(t75:1.263549388,t76:1.254471989):1.078145502):0.4767294691):1.252941409,(((((t77:1.682285845,t78:1.679760293):1.096498075,(t79:0.1829632721,t80:0.09013352079):2.389685726):0.1721820539,(t81:2.555309868,(t82:1.393644765,t83:1.37630397):1.107572106):0.08658389215):0.02590484186,t84:2.530676061):0.8977384002,(((t85:1.445257159,t86:1.428955021):1.22794169,(((t87:1.154951764,t88:1.143168881):0.440413465,t89:1.537275562):0.9486070943,((t90:1.359866728,t92:1.023173495):0.5379074698,(t93:0.4243657493,(t94:0.09089656416,t95:0.03700113399):0.1828317476):1.134621957):0.4261212919):0.08243446083):0.4047568269,(t96:1.79674596,t97:1.728536626):0.4635860288):0.1869335701):0.1846710969):1.27888645):0.03224851227,(((t98:1.690483316,((t99:0.4665568,t100:0.4564318675):1.056173309,((t101:0.5458215276,(t102:0.3360108348,(t103:0.04854860413,t104:0.00599295111):0.1941642383):0.2061710591):0.3359953175,(t105:0.07500678975,t106:0.02201676997):0.5667080814):0.6302114524):0.1587134744):0.1867330733,(t107:0.7249653867,t108:0.6672812394):0.8111463839):0.8535183799,t109:1.660338047):1.128539106):8.167717702,((((((((t110:0.6921074768,(t111:0.5978797145,(t112:0.2249454115,t113:0.1761019537):0.3205757619):0.0774592923):0.08163002023,(t114:0.208823464,t115:0.1920508366):0.3501911989):0.2071357587,(t116:0.5381122764,(t118:0.224740088,t119:0.1923176455):0.1141074618):0.2107190048):0.1132982385,t120:0.5487180758):0.1520709417,(t121:0.4792400898,t122:0.3947964065):0.2207679518):0.1263807801,t123:0.6879010467):1.976813559,(((t124:0.2525575713,t125:0.1791084109):0.1934904394,t126:0.2305961061):1.548037817,t127:1.73933248):0.4444974048):2.678365264,(t128:0.9535063412,t129:0.3011913443):3.676293173):4.912862836):0.4309711485,((t130:1.829349034,(t131:0.5458283105,(t132:0.1457870838,t133:0.1256261912):0.3276335811):1.281074145):4.591205993,(t134:4.540860654,(t135:3.429787154,(t136:2.891895336,(t137:0.07667831452,t138:0.01279315194):2.79651308):0.3904145227):0.9887071165):1.70430383):2.492724774):0.5231347847):0.1894570525):0.5436464306,(t139:5.633831656,t140:5.613828754):3.897740298):0.08388285101):0.08158285682):1.456034014,((t141:9.07868212,(((t142:4.641539568,t143:4.602676875):2.293637485,t144:6.712500745):0.6755312325,t145:7.351147352):1.299186974):0.7418868344,(((t146:3.449562059,t147:3.420067826):2.209943489,((t148:3.270764458,t149:3.016319009):0.3302729946,t150:3.309386405):2.006614366):3.114339879,(((t151:5.327745831,(t152:1.168686499,t153:0.9772341584):3.96568059):0.5144590313,t154:5.375688065):1.414004996,(t155:2.516104123,(t156:1.736275073,(t157:1.223926713,t158:1.206286182):0.5101048851):0.7510184745):4.064506682):0.8515798306):0.5497742371):1.205473282):0.7553498658):0.3766411426):0.3064483776):7.497415184):0.6880368001):0.4282911515):0.6700414506,(((t159:5.991007302,(t160:0.5397048623,(t161:0.2760152733,t162:0.2590687508):0.2041285091):5.324637463):5.055355601,((((t163:6.801639933,((((((t164:2.15964787,t165:2.122369924):0.2885877675,t166:2.390662718):0.1341579803,t167:2.513949959):2.201328765,t168:4.662002631):1.754364422,(t169:1.945424223,t170:1.911651214):4.461891918):0.09755782667,(t171:6.370144118,t172:6.36289784):0.07759299411):0.1620179287):0.09036903971,(t173:5.311706626,t174:5.279390402):1.360925006):0.03323753475,(((t175:0.07884917752,t176:0.05952600128):2.839685544,t177:2.76559968):1.39891682,t178:3.998112697):2.196364309):2.269779243,(((t179:3.762718564,t180:3.587562071):2.779244581,((t181:6.122719927,(t182:5.787494165,(((t183:4.722895871,((t184:0.619972007,t185:0.4851908112):1.723439014,t186:1.965286523):2.356121042):0.5903363165,((((t187:1.856539623,(t188:1.179061119,(t189:0.2090800787,t190:0.1995581487):0.9696907015):0.4801966877):1.335738626,t191:2.914843359):0.241476495,t192:3.118681517):1.158919511,t193:4.178468411):0.179784746):0.4417698897,(((t194:2.484801196,t195:2.469206628):0.1780565085,t196:2.618484186):1.346382923,t197:3.910022375):0.7435351594):0.02546378745):0.2832484711):0.09812598854,(t198:4.388494679,t199:4.32417087):0.6257612335):0.06892604034):0.8940648155,((t200:4.365212579,t201:4.106137113):1.16272286,((((t202:2.417971702,(t203:2.106146804,(t204:0.3995388057,t205:0.2566083134):1.559634149):0.2964492307):0.3167943629,t206:2.395226877):1.404788974,(t208:2.126002459,t209:1.857217243):1.087879328):0.8684019825,(t210:0.5704709949,t211:0.4886709187):3.031525532):0.07093810561):0.3818438576):0.987329018):1.634511557):1.870487084,(((t212:5.269591789,(((((((t213:1.10294499,(t214:0.2350453514,t215:0.124781289):0.8484208008):0.5525073669,((((t216:0.2355492407,t217:0.1667637051):0.3568007107,t218:0.5122454356):0.372043928,t219:0.8797970016):0.03340212627,t220:0.8963910413):0.3414041141):0.5217354065,t221:1.683435119):0.3340371779,t222:1.998331413):0.4965065367,t223:2.43976474):0.149974933,t224:2.578101247):1.252496877,((((t225:0.812844329,t226:0.718945988):1.336391442,t227:1.859795475):0.273685077,t228:2.113664071):1.015711863,(t231:1.242919535,(t232:0.3189892106,t233:0.2723737352):0.909036676):0.8847029278):0.2921823234):0.8070094645):0.07930220038,(((((t235:0.1542404482,t236:0.1434830051):0.729664128,t237:0.7507799611):0.0243329313,t238:0.7199882422):0.06763684476,t241:0.1651087771):1.056098983,(t242:0.7270074092,(t243:0.5698215785,t244:0.5541908127):0.1250624186):0.3882564374):0.952481986):1.291296792,((t245:0.4665829127,t246:0.3407935749):1.162664026,(t247:0.2857444523,t248:0.2709340849):1.111513232):1.323586197):1.61574801):6.844535295):0.3418837742,(((t249:9.612606633,((t250:5.265801158,t251:5.040252165):1.720236917,(t252:5.792723704,(t253:3.637614418,t255:3.485019731):2.089237736):0.6606096439):2.202642604):0.6912704398,(t256:7.064937525,(t258:0.2836837023,t259:0.2260668878):6.643241446):1.757623584):0.3049183937,(t260:5.967984635,((t261:0.02137988484,t262:0.01438008067):4.646385398,((t264:0.2226012629,t265:0.2075077892):1.93530246,t266:2.138611556):2.304411287):1.264233191):2.904863749):0.8741203061):0.1447623666):0.5880413511,(((t267:0.1265471213,t268:0.01542133313):6.730919304,(t269:1.273131449,t270:1.141823705):4.873172585):1.893729471,(t271:4.370499906,t272:4.05664791):3.435887686):1.434590242):0.6713067444,((((t273:1.580940255,t274:1.558048513):5.49707119,(((t275:5.705778383,t276:5.641665315):0.6698614755,t277:6.275030683):0.1876577252,((t278:0.1207448234,t279:0.1089565888):3.934002936,t280:4.032252515):2.406664479):0.2268722036):0.8793930048,((((t281:0.4558953478,t282:0.4059604488):4.978856125,(t283:4.852075742,t284:4.838488591):0.4527276397):0.01544405817,t285:5.298406378):0.6095698925,(t286:0.3970092736,t287:0.3950962435):5.453946494):1.434157206):1.515870865,(((t288:6.007543187,(t289:5.569463505,(t290:5.26267433,(t291:2.038964345,t292:2.015562945):3.162572944):0.2076663754):0.2434950487):0.3887894642,t293:5.600498004):1.538968415,(((t294:3.914409403,t295:3.694851099):0.7235770185,(t296:3.048225263,t297:2.864587937):1.362073121):1.643900168,((t298:0.3636131459,t299:0.3158088159):3.763167212,((t300:1.988703027,(t301:1.550748824,t302:1.470448444):0.4315831677):1.480261279,(t303:2.93028962,t304:2.919870178):0.3344966552):0.5715888264):1.588527746):0.411146371):0.816871252):0.08296406501):0.07915947174,((((t305:3.404878036,(t306:1.342781183,t307:1.284219131):1.923046514):1.122340263,(t308:1.905682733,(t309:0.4290068888,t310:0.4243258697):1.346239931):2.242634292):0.0342750747,(t311:3.706566805,(t312:3.26740819,t313:3.254298443):0.4176209561):0.2469265026):0.3273180734,(t314:0.1539996854,t315:0.07260429775):3.974759814):1.723453877):0.9411978517):3.762469616):2.035840572,((((t316:2.437642248,t317:2.368512463):1.304066441,((t318:1.421847252,t319:1.216080477):1.655539254,(t320:0.7279452002,t321:0.4573858716):1.899996325):0.5326586467):1.365236294,t322:4.253065843):1.330515571,((((t323:2.128314876,(t324:1.948094095,t325:1.942704145):0.1238962632):0.1533570327,t326:2.086694767):0.1414770858,(t327:2.051937092,(t328:0.849626942,t329:0.8406259771):1.173983954):0.1524156807):2.192746109,((((t330:0.9351127427,t331:0.8186314651):0.2004773481,(t332:0.6203556207,t333:0.496625948):0.375717133):1.336630354,((t334:0.9517223206,t335:0.7678994368):1.016503213,t337:1.454809597):0.06960470066):0.5842785737,(((t338:0.6838749222,t339:0.5307481185):0.5088755794,t341:0.8721316868):0.09383155458,((t342:0.1585849147,t343:0.04339418753):0.07048148134,t344:0.1113767642):0.7170730758):0.4999135887):1.261618909):0.8760330094):6.056172635):1.266125101):1.259624434,(((((t345:0.1796352164,t346:0.1536011612):1.629089304,t347:1.647499168):0.4690824557,t349:1.971136108):6.629449552,(((((t350:0.6868635347,t351:0.6256996896):0.2884888885,t352:0.8849890789):0.1527816671,t353:1.03396586):0.3087988786,((t354:0.4850546673,t355:0.4824949347):0.5753749154,t356:1.029173561):0.1972347428):1.04995878,(t357:0.7284893288,t358:0.5444984405):1.447328623):6.050506525):1.27663839,(t359:3.739097891,(((t360:0.4350190845,(t362:0.04763338409,t363:0.02543863488):0.1459750594):0.7095078918,((t364:0.339372693,t365:0.1978496638):0.08143092726,t366:0.1384437813):0.4265593443):0.3765341184,t367:0.7505434591):2.028345146):5.418321912):1.810633245):0.5293654861,((((t368:1.477073782,t369:1.171877796):2.906221374,t370:4.04720562):3.744087665,((t371:1.079826853,(t372:0.3980865434,t373:0.3947112599):0.4828756047):0.696006531,t374:1.329078406):5.859076171):1.121157589,((t375:1.358397151,t376:1.284821945):5.75100623,t377:6.925092009):1.175665642):1.102031922):4.08418048,(((((t379:4.962790941,t380:4.926072722):3.394010241,(t381:2.788522109,(t382:2.68221073,t383:2.579879178):0.08028457445):5.502384195):1.361090958,((((((t384:7.67019478,((t385:0.3215220246,t386:0.3071683451):7.269580204,(t387:6.993944795,t388:6.959743846):0.5713941558):0.05033182786):0.2686281153,((t389:5.294636083,t390:5.205047626):0.8352437689,t391:5.895315993):1.303406432):0.3815821436,t392:7.302669479):0.1423187249,(t393:6.003412518,t394:5.991471312):1.407330503):0.1175630927,(t395:6.646579174,(t396:0.1607745444,t397:0.1162088732):6.437426635):0.8396391617):0.4625186206,t398:7.738305259):0.2389652793):0.2288834997,((t399:0.1858630119,t400:0.1669481386):7.878999586,(((t401:5.654738219,(t402:3.893785013,t403:3.833634904):1.75913436):1.334100435,(t404:0.8172046191,t405:0.5205452245):6.103645574):0.7878209117,(((((t406:0.7367655676,t407:0.6870452989):1.502664187,t408:2.144008589):2.757790333,((t409:0.7278704216,t410:0.6276506531):2.547832068,t411:2.932184857):1.517022386):0.5312244404,(t412:2.72290923,t413:2.583856634):2.177324004):0.421416427,((t414:3.920539321,(t415:2.783545315,t416:2.724297857):1.121496015):1.124727349,t417:4.922158981):0.1005476549):1.380379589):0.2630938257):0.007638766704):0.942235451,(((t418:2.906772745,(t419:2.113325029,t420:2.107453354):0.6088675001):1.317408478,t421:4.029719593):1.959137037,t423:5.664836794):1.292406451):2.04791101):21.89365836,(((((t424:5.388642017,(t425:3.944134985,((t426:0.6299149723,t427:0.4244841191):2.183367505,t428:2.437281736):1.039620756):1.386917338):0.9312006292,((t429:0.3972874164,t430:0.369142953):3.681173163,(t431:3.578900759,t432:3.470848544):0.1550385787):1.663778492):10.17916083,(((t433:3.039457356,t434:2.770273111):0.1560270391,t435:2.3966465):0.9652493548,(t436:1.212477645,t437:1.167517):2.137977776):11.23628392):0.996634689,(((((((t438:1.169816006,((t439:0.2228852391,t440:0.1921362915):0.4940473159,t441:0.6633632017):0.4184107062):0.9926434474,(t442:1.612086642,(t443:0.8230785933,t444:0.7597584711):0.7611506466):0.4219747485):0.5189555457,t445:2.377488599):0.5816875378,(t446:1.110589579,((t447:0.569427707,t448:0.5400034773):0.4226346246,(t449:0.561433621,t450:0.5217833326):0.2859289322):0.05330465993):1.810277931):0.1459759777,((t451:2.022653668,t452:1.994490982):0.2062590812,(t453:1.832504337,t454:1.766234175):0.3536147989):0.5816628699):0.4087838407,((t455:1.669608573,((t456:0.1079976522,t457:0.09362873952):0.3611147314,t459:0.2762973359):1.136466065):0.2212788642,((t460:1.284859441,t461:1.135769674):0.06968805503,(t462:0.2823972206,t463:0.07766672339):0.6390764129):0.2386108887):1.181349925):0.06724414182,t464:2.04502388):11.59049137):0.767082318,(t465:1.926853499,((t466:0.760939241,t467:0.6087785387):0.7594732856,t468:1.102329761):0.3921301016):12.24214256):12.52540387):10.83344714);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T16.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
