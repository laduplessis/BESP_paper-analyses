<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t481:0.2747806947,t482:0.07315908777):0.7107340042,t483:0.6405377173):7.961006927,t484:8.555578113):63.13567091,(t485:23.19738547,(((((t486:0.5908173107,t487:0.2245551081):0.8541341353,t488:1.059093981):0.6167211413,((((t398:0.1908417435,(((((((t244:0.5488481955,t245:0.006668195673):0.02548138337,((((t136:0.1522530856,(t132:0.1075690699,((t119:0.01308183599,(t112:0.05915133024,(((t11:0.1248814603,t1:1.100922591):4.008258456,((t2:1.326044959,(t3:1.030224843,t4:1.023365858):0.2735175386):0.09663144672,t5:1.377149809):3.456452134):1.720048032,t6:6.160335027):3.179255176):0.7115208341):0.1358957229,(((t7:9.196753325,((t8:0.3502622993,t9:0.2911524481):7.384414438,(t10:3.829584324,((t12:0.4245631844,t13:0.4087278438):0.01738576761,t14:0.3719872994):3.147560722):3.837123745):1.347680978):0.5926331461,(t15:9.008071812,t16:9.005691734):0.2263386657):0.2594622142,(t17:0.7220132803,(t18:0.3462943587,t19:0.3168616745):0.3056283884):8.766292499):0.06365652265):1.458218195):0.4254704188):0.1641067466,((((((t20:2.655377851,(t21:2.315022298,(t22:1.934393261,t23:1.923451094):0.3064860082):0.3090866598):5.916859471,t24:8.450770349):0.8801757485,(((t25:7.214091129,t26:7.15517859):0.5575567939,(t27:0.5179853975,t28:0.489091951):7.135618175):1.333220889,(t29:5.637569139,(t30:4.672699084,t31:4.655133013):0.9084755914):2.788763227):0.1569290364):0.4046337602,(t32:8.269610527,((t33:4.979081374,t34:4.963474514):2.836980064,(t35:0.7791731443,(t36:0.1974300461,t37:0.1532759008):0.5536724552):7.020005456):0.2533042812):0.5325864775):1.158764186,(((((t38:1.94368175,t39:1.925250026):0.3653506962,(t40:1.787738931,t41:1.747830501):0.3371544976):2.199017295,(t42:0.1978639897,t43:0.1908234835):4.076835586):4.029274046,(t44:6.146684093,(((t45:1.734644074,t46:1.689396885):2.017936215,t47:3.657728892):2.167710859,(t48:3.980522045,t49:3.787148026):1.762339561):0.04016864658):2.045668544):0.8505957782,((t50:5.76558143,((t51:4.76810161,t52:4.737490319):0.1435289534,(((t53:0.759289307,t54:0.7591164191):1.423243833,(t55:0.1439056663,t56:0.03866513224):1.580771204):0.7319745063,t57:2.318730128):1.925847443):0.8019761862):0.4362938514,t58:5.424958422):2.272006111):0.2289945326):0.2021156033,(((t59:5.273864204,t60:5.25183344):2.112048789,(((t61:4.516669933,(t62:1.456116762,t63:1.380633756):3.056682074):0.2929626167,(t64:1.087230901,t65:0.6764205968):3.47018243):0.3745549209,t66:4.274706355):2.10698939):0.1210208857,((((t67:3.643938189,(t68:0.8384799397,(t69:0.6661188552,t70:0.6580621661):0.1555917382):2.687863099):0.4125863789,t71:3.884869117):1.026005922,(((((t72:1.758986008,t73:1.640770382):0.6735555301,(t74:1.516295385,t75:1.391858792):0.6999525175):0.07025967182,t76:2.139848):0.6197279467,t77:2.483773534):0.3149695918,(t78:2.00505832,t79:1.82318146):0.4952397145):1.319131552):0.3883601209,(((t80:1.473767814,t81:1.1759539):1.773051109,(t82:2.383691309,((t83:1.648826463,(t84:1.184990952,t85:1.170813195):0.3293749125):0.1419487043,(t86:1.326356398,t87:1.306340832):0.3015477557):0.5711496497):0.5494133459):0.09326839572,(((((t88:1.147150635,t89:1.118969055):0.6088622246,(t90:1.1089452,t91:1.084103808):0.5482586978):0.2885757012,(t92:1.493773127,((t93:0.06103604241,t94:0.01999156503):0.947153295,((t95:0.2410379345,t96:0.2083566081):0.1639466926,t97:0.3240240907):0.5461621638):0.4292054658):0.4188658415):0.1317641509,t98:1.835409199):0.03240264765,(((t99:1.1380133,t100:1.019445195):0.2561665671,t101:1.231008697):0.3503277499,t102:1.476425744):0.004427456414):0.5221363597):0.3505897231):0.9353481483):0.4768654785):0.1898091753):2.041173496,(((t103:0.8179034636,t104:0.7322222277):0.4684724543,t105:1.029430253):1.332896446,(t106:1.782670533,(t107:1.022472909,(t108:0.8546175673,t109:0.8186850455):0.1633578972):0.6775417156):0.2156728175):3.314737461):4.766164223,(((((((t110:0.2015239201,t111:0.08492055073):0.7043139719,t113:0.6322356545):0.5843426619,((t114:0.3619496557,t115:0.1444564341):0.1303170189,t116:0.0113318233):0.7133138775):1.212557961,(t117:1.737017591,t118:1.733691576):0.1425445304):0.07814653426,(t120:1.674519468,t121:1.651746842):0.04667097834):0.2622933856,(((t122:0.3718330301,t123:0.3563039103):0.04683339048,t124:0.2299519485):0.3256696155,(t125:0.2133942776,t126:0.2056252434):0.3087736938):1.175244888):1.078544123,(((t127:0.07636300533,t128:0.07362832653):0.5605261086,t129:0.5700241345):1.014315375,t130:1.271100321):0.8102150851):5.767305447):3.595678383):0.3104599754,((((t131:3.607662436,(t133:3.254530211,t134:3.19213639):0.0154336328):5.396886518,t135:8.409971653):1.490204301,(((((t137:1.014893564,t138:1.005695811):2.638256736,(t139:2.513054567,t140:2.51115433):1.00733088):5.468390013,t141:8.372970719):0.3431874144,(((((t142:0.4182383768,t143:0.3869682956):1.029080746,t144:1.413115526):1.701369362,(t145:1.931420181,t146:1.873207563):0.9879747427):3.228536413,((t147:1.791885644,t148:1.039281824):2.421306757,t149:3.459559315):1.838407313):1.803991704,(t150:6.085070734,(t151:5.718571068,(t152:4.897025059,(t153:1.892935867,t154:1.797423905):2.885700248):0.6612473361):0.3476449819):0.81864834):0.5276168033):0.1826245385,(t155:3.621293133,t156:3.614353003):3.596946595):0.05100153136):0.1699540933,((t157:6.435242811,t158:6.277939903):0.4521552234,((((t159:2.191250551,t160:2.058969505):3.807389242,((t161:3.402229404,t162:3.365642512):1.807434276,(t163:2.858329345,t164:2.789241663):2.310235035):0.5407384289):0.01449693359,(t165:1.51017455,t166:1.484038453):4.113154763):0.06825743421,t167:5.626560694):0.6463039626):0.5386064469):0.9639899923):0.242462662,(((t168:3.997890797,t169:3.833411398):1.768333927,((t170:0.06578234804,t171:0.04216447554):2.918418197,(t172:1.059075557,t173:1.042161688):1.896954689):2.569842891):0.3017550484,(t174:4.293159825,t175:4.240923864):1.451030261):1.874652588):8.58758002,(((t176:6.154058636,(t177:5.699105877,(((t178:1.760661521,t179:1.747526599):1.545680493,t180:3.261597783):1.648956542,t181:4.903819215):0.5763735127):0.3881212224):0.6972486149,((t182:4.508571722,t183:4.489610519):0.3391430834,t184:4.79107008):1.593152847):1.025595587,((t185:1.395439025,t186:1.389591666):3.259261215,(t187:2.443497685,t188:2.385330783):2.123936625):2.625656768):8.241110472):2.828572384,((t189:4.850315692,(t190:0.7763373547,(t191:0.6162816021,t192:0.3890135508):0.1561523678):4.056560058):1.588479171,(t193:4.668260397,((t194:0.844592933,t195:0.8084966162):3.361338865,t196:4.026808687):0.183921231):1.502834363):11.63208808):1.451941291,((((((t197:4.412239494,(t198:4.165135386,t199:4.009872715):0.1539128192):1.685179935,((((t200:2.925573,t201:2.913542633):1.264649828,((t202:1.185454685,t203:1.140110715):2.181798783,(t204:0.4132676462,t205:0.2616981321):2.85949176):0.5871718772):0.5695210569,(((t206:0.4032562111,t207:0.3509750698):3.7401286,(((t208:2.833860257,t209:2.696575154):0.3119893902,(t210:0.7245443075,t211:0.5582214424):2.193729268):0.7565345697,t212:3.503293035):0.1766969823):0.06079144609,(t213:2.151480263,t214:2.052163055):1.435902743):0.0601326002):0.779979637,((t215:1.034308328,t216:0.9918959896):1.482920563,(t217:1.699438937,(t218:1.191556326,t219:0.9236482684):0.4461517571):0.7220549531):1.787627716):0.167090523):2.59458689,((((t220:3.038833215,((((t221:0.6826549787,t222:0.5524525521):0.1475016984,t223:0.459628929):1.720634663,t224:2.177841408):0.2577665541,((t225:0.6691298126,t226:0.452811867):1.328501227,(t227:0.8258277797,t228:0.7147646076):0.4890275844):0.383830016):0.05996366751):0.6017662782,t229:2.098895395):1.53940841,((((t230:0.1295406482,t231:0.09249093045):2.170030853,((t232:1.357473136,t233:1.328650685):0.1708622732,t234:1.491000526):0.7074870091):0.5410264007,((t235:0.279316175,t236:0.2766989565):0.1894767166,(t237:0.03721641173,t238:0.02630533866):0.3813128567):2.180172017):0.4395612526,(t239:1.688565226,(t240:0.3941337942,t241:0.3427667437):1.08759591):1.223513801):0.04291450323):0.3710081742,((t242:1.02211026,t243:0.922384412):1.487908322,t246:1.490404792):0.4614133649):1.043191551):1.19234832,t247:4.09547675):8.546077459,((t248:2.203936408,(t249:0.1157221889,t250:0.01982539351):1.688222384):0.8586099066,t251:2.234448747):9.45051037):0.006841578852,((t252:9.48801697,(t253:4.822538273,t254:4.794169285):4.546478394):0.3612341234,(((t255:8.553721713,((t256:2.303372083,(t257:0.1243050139,t258:0.054168945):2.102255282):3.315256725,(t259:3.924052626,t260:3.811192733):1.351637253):2.720010511):0.4003988234,((t261:0.6039570103,t262:0.5876223131):7.13918174,t263:7.59066856):0.5064057004):0.02801978301,(t264:8.001945516,t265:7.774196383):0.1227379888):0.6905968064):1.679281136):0.3418425115):1.606528692):8.617579295,((((((t266:0.4393368661,t267:0.3908710316):3.560054767,((t268:0.431343047,t269:0.4192202478):2.690930579,t270:3.057768823):0.5913474535):0.2250412741,((t271:0.1430674044,t272:0.1211708991):2.992513679,t273:3.090712522):0.7382781394):10.28740573,((((t274:6.975432804,t275:6.904699858):1.560357911,(((((t276:0.829669063,t277:0.7147151665):0.9776876316,t278:1.480815602):3.98017034,t279:5.348019905):1.61768286,(((t280:1.906122962,(t281:1.364302027,t282:1.350771714):0.4186160988):4.336143774,((t283:4.298745228,t284:4.297520845):1.291440993,t285:5.501821336):0.5025075095):0.4161509603,((((t286:2.22460845,((t287:0.02115743541,t288:0.002272814315):1.425842481,t289:1.412043869):0.7456833504):2.393461314,(t290:0.1961388675,t291:0.09369660571):4.348813702):0.7054909465,t292:5.130156084):0.7605142576,t293:5.878834914):0.3074616807):0.2982389486):0.9220140125,(t294:1.047281755,t295:0.9530455595):6.182541397):0.1103391329):0.9163032869,(((t296:4.177269725,t297:4.034559448):2.0405114,t298:6.062557971):0.7295104109,(t299:5.813754446,(t300:5.331475173,(t301:4.885599235,t302:4.753110541):0.3493144723):0.4131079471):0.8993918093):1.169476373):1.194164608,((((t303:0.5796449843,t304:0.5568793241):3.402236465,(t305:2.068981414,t306:2.067572177):1.875789368):1.09908029,(t307:3.804243178,(t308:1.70662057,(t309:0.9201885783,t310:0.8345425767):0.7415520986):1.96321653):1.198513666):2.983150913,(t311:5.03116591,((t312:0.1504662617,t313:0.1487472116):1.004064372,t314:0.5397278038):3.802642808):2.623617385):0.5536896748):3.362742903):0.7936872796,(((((((((t315:1.297299695,t316:1.289988335):2.353230001,(t317:0.2532409057,t318:0.1753938157):3.362957904):1.084804509,(t319:2.958018121,t320:2.921715897):1.319948674):0.07692036236,((((t321:0.2108889123,t322:0.1992310298):1.172242304,t323:1.35543053):1.983271718,(t324:3.275326384,(t325:2.942020146,(t326:2.415966846,((t327:0.9921639358,t328:0.884891037):0.228551122,t329:1.110345858):1.083120189):0.4256986702):0.1454290785):0.001397116373):0.8376563052,(t330:3.357796179,t331:3.331718663):0.2275775941):0.03371293363):0.1970815898,((t332:2.336894433,t333:2.287737314):1.127883499,(t334:0.2625633678,t335:0.2580782794):3.070547272):0.2870672874):0.02687092547,(((t336:0.8466668705,t337:0.6489962259):0.06819931779,t338:0.5839546264):1.043706221,(t339:0.7174450518,(t340:0.3242998128,t341:0.2941075475):0.2540094713):0.857879009):1.651689465):0.01111773277,(t342:2.765120984,(t343:1.63659583,t344:1.617849419):1.039535049):0.2349363602):0.2350480538,(t345:3.100723405,(((t346:0.474450557,t347:0.4398929565):1.506506399,t348:1.913934031):0.951086495,((t349:1.022765262,t350:0.812226692):1.416310084,(t351:1.293867886,(t352:1.063859644,t353:1.045690851):0.1901204122):0.8949717317):0.3241460945):0.1285440182):0.009479894957):2.278818729,(t354:2.670331003,((t355:1.926029248,t356:1.829664115):0.4484638262,(((t357:1.018985652,t358:0.8461530548):0.3481237073,(t359:0.5621247875,t360:0.5350640492):0.3984950513):0.2394736398,t361:0.8237330752):0.3385580398):0.2612383092):2.193257158):4.084026306):4.237555668,(((((t362:3.404201859,(((((t363:1.071200709,(t364:0.7608976137,(t365:0.554645763,t366:0.4823734311):0.07766691435):0.2996764675):0.01191199388,((t367:0.4538300249,t368:0.2281030144):0.1572254053,t369:0.3602240801):0.221677453):0.3302452897,(t370:0.2279483859,(t371:0.02897363145,t372:0.002231888827):0.1929698985):0.5506492038):1.241653318,t373:1.972969195):0.1438936554,((t374:0.4133413192,t375:0.2304453668):0.9402922062,t376:0.4830359375):0.4198832745):0.5806182477):0.2502023326,(t377:0.8558508455,((t378:0.2147684124,t379:0.1022699511):0.03524635209,t380:0.1236718891):0.4982623948):0.8597702328):1.190805491,(t381:0.5094255771,t382:0.2423263117):2.067643824):4.531832691,((t383:1.275098491,t384:1.238073773):4.60374173,t385:5.771414454):0.8141556814):1.148955856,(t386:7.344794063,t387:7.315590751):0.3360682686):1.396748766):1.10652743):0.9379909721,(((((t388:1.057867553,t389:1.038341191):0.4305066052,(t390:1.053994862,t391:0.8063449253):0.2644455704):2.569982911,t392:3.626070755):5.826602748,((((t393:2.391472118,t394:2.218894037):1.211548252,(t395:1.775250503,t396:1.692917864):1.520945667):4.547605643,t397:7.698991086):0.4226259329,(((t399:1.945310755,t400:1.877841221):0.1026968371,t401:1.87205187):2.001023632,t402:3.678897136):3.488057772):0.8687224933):0.8361928309,t403:8.797395418):0.2323638761):0.3864610885,(((t404:7.31327062,((t405:0.9051172913,t406:0.8213245517):3.877529289,(t407:2.241553985,(t408:1.106907451,t409:1.048083906):0.955808744):2.271326488):2.503515539):0.171395122,((t410:5.240483879,t411:5.075748107):0.4878269285,t412:5.520905855):1.212919593):1.413069317,((t413:5.953880389,t414:5.938836097):1.325426392,(t415:7.072179906,(((t416:4.814676175,((t417:1.24564923,t418:1.178924312):1.777019758,t419:2.909951221):1.082955085):0.580437998,t420:4.482337984):1.332683067,(t421:5.487032872,(t422:3.525638407,(t423:1.136463803,t424:1.106200252):2.084839331):1.895627882):0.2226373418):0.1860370167):0.1896573198):0.6504116046):0.4750997368):1.277396386):8.103334515,(((t425:1.183013187,t426:0.9065876328):4.572352572,(((t427:4.313701213,t428:4.304447218):0.891503065,((t429:4.663924216,((t430:2.838735773,t431:2.817037457):1.05419168,(((t432:2.127181917,t433:1.575838763):0.9662335187,t434:2.541102677):0.4246257727,t435:2.887049092):0.2907655409):0.7376192377):0.4204639744,((((t436:2.222996958,t437:2.074717022):0.8161473134,(t438:2.664143096,(t439:1.715301228,t440:1.581066172):0.8550331888):0.2077656815):0.2011493497,t441:2.802765674):0.7605282979,(t442:2.930437956,t443:2.893412981):0.4999880788):0.3213026022):0.02400627673):0.1530707148,(((((t444:2.52524144,t445:2.496162358):0.1436271008,t446:2.557761583):0.03823338396,(t447:1.753280415,t448:1.572601693):0.73699892):0.05281317556,((t449:1.672460693,(t450:0.5927488096,t451:0.5722214603):0.9720675293):0.3907509715,t452:1.879133701):0.2843712461):0.275295218,t453:2.430997301):0.851105021):0.1077391484):2.334529718,((((((t454:1.049094611,t455:0.9950543005):1.10732655,(t456:1.255093051,t457:1.198741621):0.7722130312):0.162699377,t458:2.075619337):0.3634119751,t459:2.39918808):0.1113495264,(t460:2.348109142,(t461:1.771764757,(t462:1.505673871,((t463:0.5325534073,(t464:0.4321229011,t465:0.3865355636):0.008940448352):0.5918873687,t466:0.9858454664):0.3012066463):0.2574756815):0.2951790084):0.1389442555):0.6219043881,(t467:2.29500456,(t468:0.774980572,t469:0.4724974097):1.426854923):0.1284259984):2.266985679):7.957257803):2.961542077,((t470:1.308907483,(t471:0.9392668068,(((t472:0.2859265857,t473:0.2688023687):0.3495980552,(t474:0.4460827432,t475:0.3875636378):0.1515158358):0.1439745135,(t476:0.5781313954,t477:0.3103241352):0.08719101689):0.09962948026):0.3313895266):0.4913852104,(t478:1.222432272,(t479:0.6968298179,t480:0.596925032):0.510424029):0.0837760425):12.80167352):9.806573955):48.34863811);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T7.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
