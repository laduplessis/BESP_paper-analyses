<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t471:26.11308704,((t472:11.49258844,(t473:0.5361988301,t474:0.4126732963):10.92800772):0.2003809,t475:11.4514396):14.39133086):80.6406248,((((t476:0.01523732666,t477:0.01333403859):1.189109299,t478:1.194680636):11.5913223,(t479:1.597645019,(t480:0.04851120909,t481:0.03401058692):1.513850756):10.84756757):11.33912528,((((((t461:0.0611657638,((((t424:0.05724867,(t414:0.05651542952,(t339:0.1175323495,((t332:0.01030807819,(t331:0.07103125274,(t316:0.1058069143,(t317:0.02459591394,((((t183:0.003132063828,(t132:0.2263950956,(((((t100:0.020137012,(((t1:6.195905188,((t2:0.6572534363,t3:0.6476345906):1.155790226,t4:1.631900177):4.108757373):2.042755761,t5:7.753458011):1.374789169,(((t6:0.1891364376,t7:0.1619137255):0.3597946607,t8:0.5024686295):5.586613687,(t9:3.374519819,t10:3.372530112):2.681135515):2.582965896):0.3058134425):0.03018900643,(t11:8.456083331,((t12:0.1055334832,t13:0.08182189778):0.2741677977,t14:0.3006756743):8.019656946):0.4749079913):0.3902780828,(t15:8.32243611,(t16:7.944098167,t17:7.930427312):0.3739748997):0.8035745274):0.03084825161,(t18:0.7755683084,t19:0.7506346643):8.358332029):0.2368213767,(t20:5.539899582,t21:5.523724688):3.791157842):4.03207268):5.298573531):3.039244898,((((((((((((t22:6.797886781,t23:6.704583901):0.01491825855,t24:6.615599145):1.971052976,((((t25:2.329711028,t26:1.94827033):0.1383595472,t27:1.940849816):0.6495573301,t28:2.580415266):4.295895989,(t29:6.747392319,((t30:3.927681442,((t31:2.704317213,t32:2.544477421):0.4908909762,t33:3.028823521):0.6358735671):0.2413736118,t34:3.887930729):2.508463521):0.1196283047):0.775277912):0.6736963175,t35:7.925604688):0.3265386182,((t36:1.391638804,(t37:0.2859057362,t38:0.2682645178):1.058829822):6.192083364,(t39:2.228295305,t40:2.213976761):5.245805145):0.5858121839):1.268813691,(((t41:1.200485081,t42:1.194860331):1.791902309,(t43:0.461404361,t44:0.3913087581):2.509900599):4.131111181,((t45:0.1706464643,t46:0.1200654673):6.165667076,(t47:0.5259913669,t48:0.5098896238):5.484119643):0.6920774899):2.103215837):3.470059439,((((t49:4.888738896,t50:4.862171501):0.06465229396,t51:4.881655695):1.01460995,(t52:5.399528402,t53:5.18348355):0.437602794):3.770311397,(((t54:4.910865045,t55:4.75811578):0.7506084696,(((t56:2.747248964,(t57:1.546033142,((t58:0.4852030225,t59:0.3239591446):0.5897448564,t60:0.8874717403):0.4047481313):1.149556967):1.495075423,(t61:2.176607611,t62:1.736617407):1.682187726):1.108820976,((t63:2.18733998,t64:2.144128312):1.506493605,(t65:2.711483108,t66:2.286140514):0.8284043832):0.6168083327):0.05627441457):0.1886573057,t67:3.921595135):3.477859664):2.427910861):4.31167744,((((t68:3.142629873,(t69:2.288431604,(t70:2.073851688,t71:2.027049941):0.1934748438):0.3205815381):1.891392299,(((t72:1.730508005,(t73:0.9169358791,t74:0.7754839638):0.804841938):1.927933142,(t75:3.43550723,((t76:1.543225484,(t77:0.7079756713,t78:0.6406519894):0.7940581582):1.294042784,t79:2.605730887):0.4251074577):0.03809173017):0.4722235741,t80:3.410035771):0.1339310885):0.1793481414,(t81:3.591200308,(((t82:1.425736613,t83:1.350093124):0.3119612223,t84:1.633949993):0.3437115168,t85:1.976869055):1.505456007):0.05861137859):8.022689964,(((t86:2.72951445,(((t87:1.883687409,t88:1.837165123):0.1432000453,t89:1.937113673):0.1123121333,t90:1.989844951):0.5836519538):0.8719252701,((t91:1.097223103,t92:0.5667461364):0.07855444924,t93:0.3421608092):1.693215248):3.663453772,(((((t94:0.1357568941,t95:0.07485504269):0.5904145944,t96:0.5891439538):0.01179554165,t97:0.5714235664):0.1355620413,(t98:0.1242270353,t99:0.04490139941):0.5501751247):0.4301922495,(t101:0.561314701,t102:0.5512612326):0.06004506032):4.386912222):4.23509644):0.8610762612):0.7239551391,(((t103:0.6555283671,t104:0.543883083):4.118966183,(((t105:1.625116028,t106:1.60730713):0.7571271832,(t107:0.3378787435,(t108:0.2139435476,t109:0.1408735947):0.03510767301):1.580547601):0.2422265219,(t110:1.165732905,t111:1.151601732):0.2505384879):1.91743348):4.950545036,(((t112:0.1150274562,t113:0.1111878083):3.764730467,(t114:0.6327137357,t115:0.2877354004):3.189683237):3.444730764,(t116:6.052358612,(t117:0.4196228421,t118:0.3139124782):5.602150392):0.6904737162):0.833600648):0.7951059095):0.6628236464,t119:8.785477464):0.008096306226,(t120:3.987869567,(t121:1.423260644,t122:1.409138851):2.543473306):4.632273196):0.9932622201,(((t123:7.884524052,((t124:1.83682409,t125:1.729363667):2.21650129,((t126:3.403227327,(t127:2.685963684,t128:2.326181023):0.6830365369):0.2511798093,t129:3.177737982):0.2551147356):3.787347563):0.1775184608,t130:7.280546649):0.7106493699,((t131:0.5554857148,t133:0.05677449058):3.447717641,t134:3.380009582):3.726478224):0.6929452638):0.4084110844):5.613281733,(((t135:8.323627188,t136:8.285768505):0.8074031954,(((((t137:5.558962637,t138:5.375534542):0.3397257148,t139:5.606508615):0.2484559879,(t140:5.717680425,(t141:2.040703666,t142:1.966292759):3.637481425):0.06108121691):0.05111721443,t143:5.69551786):1.275158371,(((((t144:5.475539527,((t145:4.266565923,t146:4.246050507):0.03774262696,((t147:1.6929219,t148:1.419974682):1.462426542,(t149:1.430507181,t150:1.342416248):1.235930594):1.047467944):0.9184210295):0.03659405012,t151:4.519979033):0.343254935,((t152:2.069240971,t153:1.995234825):2.60019712,(t154:2.882093096,t155:2.798987985):1.561444277):0.05421187388):0.1798335897,t156:4.590829428):0.5088673967,(t157:3.85781064,(t158:3.292890974,((t159:2.088303438,t160:2.04485918):0.2835751637,t161:2.266966668):0.6468007215):0.2902563602):1.117895548):0.1853063185):1.471948142):0.9654437378,(((t162:1.940976888,t163:1.853682058):3.157752388,t164:4.926897084):0.4524457226,(t165:4.064417954,(t166:1.830591757,t167:1.711068959):2.198518208):1.283616232):1.364312706):3.699805927):1.92103373,(((((t168:3.635021006,(t169:1.074937376,t170:0.898677323):2.549914316):0.489123401,(t171:2.89464502,t172:2.695008322):0.6617537183):1.005933101,((t173:2.347620869,((t174:0.7565053929,t175:0.6899655553):0.8348249042,(t176:1.256172761,t177:1.219929367):0.23507242):0.7412463859):0.2171676682,t178:2.411279265):1.50597032):0.08126795332,(((t179:1.396212648,(t180:0.3633266197,t181:0.351841248):0.9337050214):0.07180851227,t182:1.177431496):0.9555020433,t184:2.063473473):1.523047835):3.284413472,((t185:2.90772462,((t186:2.369653199,(t187:2.195039924,(t188:1.953082559,((t189:0.6882286562,t190:0.2721264671):1.021669934,t191:1.081283524):0.2002166605):0.03786526932):0.1626565743):0.1398513458,t192:1.593361631):0.3708003108):1.165002727,(((t193:1.521160646,((t194:0.4304420205,t195:0.08239462989):0.9340422682,((t196:0.1801712418,t197:0.1737557475):0.4981894054,((t198:0.1009671121,t199:0.05931756098):0.004566745688,t200:0.0064425864):0.5518468648):0.2982271526):0.07688861462):0.09726342187,(t201:0.1467365586,t202:0.01851072871):0.859812806):1.071261695,((t203:0.959282526,t204:0.7782311912):0.08387001018,((t205:0.1925055229,t206:0.1599812971):0.3854240431,t207:0.4658735705):0.2454036051):0.8800866579):0.4363777286):2.790683228):3.641304351):1.834432317):0.06034544173):1.416882388):0.04657198005):0.8436365975,(((((t208:0.8878278801,t209:0.741349365):1.290039812,t210:1.891153141):0.1929379536,((t211:2.041673007,((t212:0.6428055965,t213:0.6170498907):0.6639781406,(t214:1.015677008,(t215:0.5598691515,t216:0.5504859573):0.4289205337):0.1566053716):0.6229094785):0.002146549065,t217:1.502202302):0.01738713061):4.408373658,(((t218:2.100639091,t219:2.061060566):2.059087753,(t220:0.4780797708,((t221:0.115673204,t222:0.04170448711):0.1282547548,t223:0.01996119496):0.0841627025):3.545632035):1.109912816,t224:4.674102785):0.6149817252):5.849815955,(((((((t225:0.1316241244,t226:0.06793280123):0.5311454215,(t227:0.3772095399,t228:0.3413887815):0.1578533469):0.1012966736,t229:0.5121451953):1.228759803,t230:1.718855298):7.716064186,((t231:0.4359737413,t232:0.03815603551):1.56979594,t233:1.558431518):7.356775458):1.121634836,(t234:0.6178323676,t235:0.5484385289):9.258670219):0.1520305102,((t236:4.850066688,(((t237:0.2240943019,t238:0.21493936):0.8896070211,t239:0.9626336177):0.1146385502,t240:1.07538222):3.593099464):4.538537267,(((t241:0.278183316,t242:0.09700552807):0.3752165425,t243:0.4720177375):7.956370454,(t244:8.04287116,t245:8.042478703):0.3689868095):0.5734914943):0.5183156992):0.1500966389):0.01846566881):0.8677606081):5.845826728):1.135757411):2.287474456,((((((t246:3.365915984,t247:3.310718215):3.788045317,(t248:3.397583807,t249:3.351323292):3.695791096):1.40581065,t250:8.409682738):0.03200127516,((t251:4.625319245,t252:4.598486552):1.412759507,((t253:2.376035615,((t254:1.977340469,t255:1.851935585):0.2363344603,t256:1.894262771):0.1507713486):1.745314514,t257:3.670098848):1.840661818):2.303940287):6.740543402,((((t258:4.072457096,t259:3.877312653):4.23599228,((t260:6.713215197,((t261:4.518022271,t262:4.4713755):1.601767122,(t263:0.8630706344,t264:0.8341315726):5.208713766):0.4932175162):0.9443579299,(t265:3.055394507,(t266:0.2233014698,t267:0.2041382738):2.776177168):4.370178713):0.1401509817):2.671851291,((((t268:6.301883453,(t269:1.324500018,t270:1.087412576):4.797550352):0.4633073731,((t271:2.171188784,t272:2.131983648):0.609439103,t273:2.226187203):3.553975385):0.3386418944,((t274:3.942399243,(t275:3.245382809,t276:3.213322893):0.6698429634):1.486361876,(t277:5.100230655,t278:4.928440617):0.2103715972):0.5525140125):0.3938994359,((t279:4.830545669,t280:4.804943841):1.097390839,(((t281:1.016543349,t282:0.9526445839):3.369828269,((t283:3.374860509,(t284:1.675407433,t285:1.481578884):1.685394131):0.1410053219,(t286:1.63868646,t287:1.587869677):1.598766412):0.5216151754):1.152415649,(t288:0.5612111368,t289:0.5270040605):4.195863872):0.2841767298):0.02264483924):2.564780868):2.12565618,((((((t290:4.144539561,(t291:1.084359003,t292:0.04547556863):3.004248848):0.3925573615,((t293:1.18011078,(t294:0.8694508682,t295:0.7432308119):0.2222476077):1.805223851,(t296:1.986210917,t297:1.804765766):0.7738784752):0.4088118856):0.2113170083,((t298:2.507260618,t299:2.446956896):0.1154827649,t300:2.367063):0.559087603):1.364813904,((((t301:0.353586296,t302:0.2489744433):2.121844145,t303:2.290435313):1.144825215,(((t304:1.025117281,t305:1.000691729):1.747694358,t306:2.7100331):0.3227405784,(t307:2.357151945,(t308:1.319406893,t309:1.291081351):1.037092674):0.5837716389):0.3160170651):0.3884451053,((((t310:2.430437427,(t311:1.31212229,t312:1.276261717):1.038023456):0.1291867511,(((t313:1.873278911,t314:1.674402229):0.002535442328,t315:1.610682048):0.2346284886,((t318:0.4193088155,t319:0.3510835543):0.7727884591,t320:0.7564800596):0.5083849495):0.04458653897):0.5201095292,((t321:0.5728501294,t322:0.4643935122):0.8011230155,t323:1.115265354):0.4276931766):0.2031866087,t324:1.69568883):0.3309803119):0.2304066298):0.03895674161,((t325:1.13028373,t326:1.013859929):0.2286366422,((t327:0.2234028547,t328:0.1609258836):0.1203192887,t329:0.238323835):0.7821292671):0.7906930051):2.743569054,((t330:1.574905616,t333:1.337275815):1.302668414,t334:2.430110541):1.662650504):0.8192973844):1.332234204):1.449283836,((t335:2.030674608,(t336:1.468243263,t337:1.355866257):0.360279445):0.6292198677,(((t338:0.8753526868,t340:0.0169811561):0.1203931053,t341:0.00244330149):0.7888031522,t342:0.6057016761):0.4103271396):4.823606166):3.010400147):0.4277900076,(((t343:0.2883980649,t344:0.2094606904):3.936304922,(t345:0.4826716744,t346:0.4539654818):3.576008288):0.3264087879,t347:4.278437677):4.533802331):0.1236242682,(((t348:1.063714123,t349:0.9088732583):0.06993471575,t350:0.9749350379):5.496481349,t351:6.45656736):2.23923698):0.2176663565):0.7767321129,(t352:6.977133207,((t353:3.211771273,(t354:1.368382888,t355:1.337703617):1.836955259):1.753209952,(t356:3.765935039,(t357:0.04234933062,t358:0.0107966275):3.651172279):1.069215036):1.987974467):2.640779851):0.1252799588,(((t359:0.3591336364,(t360:0.2592240636,t361:0.149962895):0.02605384577):6.202509877,t362:6.329237591):0.3658838183,((t363:2.754638985,t364:2.735144792):0.02947003636,t365:2.560929825):3.909086123):2.516163129):10.96150985,((((((t366:5.787268234,(t367:5.192582433,t368:4.758813653):0.5154837487):1.491780499,t369:6.760315497):1.193817067,(t370:5.79882468,(t371:4.223268847,(t372:3.553533745,(t373:2.589220154,t374:2.547003903):0.8977985439):0.570335626):1.555555361):1.902566813):0.8747380876,(((t375:6.29030998,(t376:2.003645075,t377:1.981919386):4.274475891):0.7916424322,(t378:6.798538338,(t379:2.04001334,t380:1.983986355):4.619374727):0.18625799):0.619421589,((t381:3.736690582,t382:3.597645552):0.3783366062,((t383:0.2464825425,t384:0.2049937614):3.005511105,t385:3.192820821):0.5741151446):3.262752797):0.6276081405):0.4491343996,((t386:7.073015146,t387:7.062208693):0.4039891262,(((t388:6.143147191,(t389:1.69227788,(t390:0.5903080826,t391:0.5767857281):0.9158960592):4.37175817):0.5198337121,(((t392:2.509777112,t393:2.504251591):2.771658349,(t394:1.464919564,t395:1.405125207):3.766915959):0.9268273115,t396:5.945166763):0.1493293989):0.6917012556,(t397:4.620241483,(t398:4.4359792,t399:4.322761504):0.1541504683):2.029612641):0.08594508008):0.6279980534):1.128003524,((t400:4.657299449,t401:4.645303146):0.1823527989,((t402:1.075981038,t403:1.042499826):2.501123576,t404:3.531490639):1.240023362):3.493877237):8.921291817):0.8587646708,(((((((t405:5.032659785,(((t406:3.634264468,t407:3.614325725):0.6588806318,t408:4.256199253):0.02592764191,t409:4.23985306):0.6776679312):0.6918315721,(t410:4.887407397,(t411:3.185771702,((t412:2.022383316,t413:1.762218319):0.6625146512,t415:2.20171243):0.4544832379):1.356494042):0.6412224218):0.6513778854,((t416:0.2294808836,t417:0.1062540952):3.681285551,(t418:3.506164257,t419:3.501169085):0.2608005142):1.195381284):0.6830978927,(((t420:2.540584895,t421:2.391896596):1.450804272,(t422:3.555251578,t423:3.326101048):0.05799467468):0.6499950194,(t425:2.095614979,t426:2.03853003):1.78986067):0.9976842501):0.1955780312,((((t427:1.478540762,t428:1.04827866):2.360141147,t429:3.390641407):0.4610219587,(t430:2.678750882,(t431:1.680794038,t432:1.51740274):0.9075843887):0.9789160824):0.3515063303,(((t433:2.489901482,t434:2.482614734):0.6345079111,(((t435:0.8063596544,t436:0.5846092106):1.055414271,(t437:1.083791493,t438:1.042474335):0.5259152159):1.165269021,((t439:2.296062858,(t440:1.813762259,((t441:0.7336082975,t442:0.6528222304):0.645118626,(t443:1.082423858,(t444:0.6086590414,t445:0.5976520319):0.290552975):0.1067678997):0.247766238):0.4488205273):0.1452166032,((t446:0.0822170507,t447:0.03017627027):0.3401621223,t448:0.2885134309):1.41315463):0.1639588469):0.04280986077):0.5664219308,(((t449:0.2916717517,t450:0.2715655767):1.372437089,(t451:0.2881963206,t452:0.007350614683):1.332106239):0.3863151061,((t453:1.18108892,((t454:0.06475085673,t455:0.04725160405):0.4159616773,t456:0.4348331988):0.60807435):0.09228964446,(((t457:0.02711318687,t458:0.01516020692):0.4441851518,t459:0.3304423334):0.5327635018,t460:0.8584926943):0.1001031524):0.4217806374):0.3996129317):0.02917409254):0.3488372434):0.03286775537,((t462:0.5419836823,t463:0.468433032):0.08263312834,t464:0.5189274751):1.480371772):0.0615814065,((t465:0.1893382443,t466:0.01841389689):0.2624602626,t467:0.1739516588):1.439242302):10.5476801):4.091649842,(t468:2.008937523,(t469:0.6009666959,t470:0.3344702615):1.381409416):14.18587742):8.574532797):82.28392212);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T69.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
