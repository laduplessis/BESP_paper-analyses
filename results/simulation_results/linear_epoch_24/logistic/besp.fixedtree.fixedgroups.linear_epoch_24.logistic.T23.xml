<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((((((((((t311:0.3243080602,t312:0.2972570314):0.2742334384,t313:0.5089113619):0.9639939824,((t314:0.1923644668,t315:0.02649667719):0.4258146484,t316:0.3869619):0.6107055508):0.9151090717,(t317:1.144830636,t318:1.104761539):0.6230400897):0.5040209044,(((t319:0.4551919375,t320:0.3373098031):0.9546281668,t321:1.240221116):0.1822977592,(t322:0.9736649499,(t323:0.3213340379,t324:0.1792081999):0.3326308935):0.2498655995):0.6217745832):0.1358083432,((t325:0.4474176918,t326:0.4471110701):0.7106918407,(t327:0.9144217026,t329:0.4646053406):0.1958946334):0.3581116663):0.8920218084,(((t330:0.404577387,t331:0.1694967565):0.3517217656,(t332:0.2177164714,t333:0.1961334959):0.2979380483):0.4085428741,(t334:0.4194917192,t335:0.2512274052):0.2402047652):0.6870709502):0.8683734539,((t336:1.451457643,(((t337:0.6778772126,t338:0.5827498951):0.3959704504,t339:0.9242095611):0.1139234492,t340:1.034523311):0.2059883482):0.005042566646,t341:1.190027834):0.5325647145):5.870604852,t342:7.049579667):3.055534947,(((t343:0.9629066973,t344:0.9135284843):2.500688738,(t346:0.1676434299,t347:0.1598178178):2.97889488):4.887991533,t348:7.877023416):1.703767245):0.4610714199,(((t349:3.481887412,(((t351:0.04796436063,t352:0.0311404416):1.150826389,t353:1.154703974):0.2372507471,t354:0.9611560717):1.88115688):5.840964091,((((t355:0.8347731128,t356:0.8244195136):3.46952563,(((t357:1.442162137,t358:1.41211513):0.6241377852,t359:2.00307586):1.894115597,(t360:2.589679827,(((t361:0.3080880638,t362:0.295760057):0.7384252881,t363:0.9660424695):0.4808138326,t364:1.443585622):1.023689029):1.307447275):0.3265997405):2.300675283,(t365:0.2884831455,t366:0.2507043694):6.074874043):0.7540968584,t367:7.077457784):1.23454035):0.5142935317,(t368:8.778094943,((t369:0.1845430997,t370:0.0910511142):3.812185583,t371:3.896072964):4.667893391):0.02737383023):0.1269816743):0.2432549687,t372:8.922277):0.1940786068,(t373:5.947939678,(t374:5.722494547,t375:5.715543461):0.1150825853):2.801353718):0.5829607727,((((t376:6.785154718,t377:6.706824077):0.3490015114,((t378:2.017032293,t379:1.934399196):4.831804029,(t380:6.478130397,t381:6.388269053):0.2347710082):0.1367888556):0.6701880088,((t382:6.800120219,(t383:1.065979783,t384:0.9708570791):5.563743214):0.2379803093,(t385:5.408440577,t386:5.364317501):1.360890296):0.2985361349):0.03968135573,((t387:2.447614558,(t388:2.096892584,((t389:1.240114911,t390:1.215916346):0.160225722,t391:1.332518463):0.6703244019):0.3219599657):3.569102753,t392:5.837416045):0.904973644):1.26007841):0.2388702711,((t393:6.594272042,t394:6.534054539):0.7669552669,((t395:1.556675574,t396:1.546424292):5.486607839,(((t397:1.568398186,t398:1.519409441):1.825491558,t399:3.325291089):3.537419443,(t400:1.976286301,t401:1.960616103):4.794571494):0.09505156002):0.2268609481):0.8216852858):1.080267632,((((t402:4.528111178,(t403:1.683453953,t404:1.304450099):2.827726288):2.303747704,t405:6.226457749):0.05170072205,(t406:0.4391115952,t407:0.412633699):5.816067478):1.550489013,(((t408:5.000103563,t409:4.983950708):1.404905477,(((t410:1.362647006,t411:1.048978458):3.029304597,((t412:0.8253263621,t413:0.7967753996):1.853863954,t414:2.556392305):1.260805751):1.175170545,(t415:1.753630021,t416:1.684675214):3.211790754):0.7440414092):0.9137988603,(t417:3.25123888,(t418:1.479844802,t419:1.379904145):1.74654592):3.198259447):0.4231279902):0.5218721704):34.82251366,((((((t420:1.794955209,t421:1.701245658):2.205179907,(t422:3.235761062,t423:3.040246199):0.5796539845):0.4666632756,(((t424:2.573275379,((t425:0.418022395,t426:0.3019128724):1.105301208,t427:1.33201384):1.048914768):0.5062167094,t428:2.873838475):0.9552412341,((t429:0.834612225,t430:0.6905144465):2.274367963,(t431:2.868074543,t432:2.859492639):0.09108305559):0.714132301):0.03744109929):1.5466066,(((t433:1.037113447,t434:0.8989228478):2.519270019,(t435:0.4149426225,t436:0.383534354):2.873690441):0.8464650414,t437:4.033401081):0.819213654):12.54957843,(((((((t438:1.382334683,t439:1.318687901):1.995089756,(t440:1.108588968,t441:0.9382805078):2.164990716):0.7517429494,(t442:2.899443575,t443:2.817891082):0.7791894287):0.123181574,((((t444:0.6726296398,t445:0.4062146366):1.277508879,t446:1.55799207):1.053484542,t447:2.520719547):0.1767084255,t448:2.669933768):0.3951312946):2.25905568,((t449:1.120251801,t450:1.102611008):1.902248488,(t451:1.887308171,t452:1.721845295):0.9819456217):2.235508689):5.870151781,(((t453:2.115997268,(((t454:1.400946907,(t455:0.8512696358,t456:0.8264735122):0.5175619298):0.02978657713,t457:0.914611152):0.4740236487,(((t458:0.5288892639,t459:0.4888751501):0.3874354698,(t460:0.7521034995,(t461:0.5758776912,t462:0.1851813794):0.05538370347):0.08127411462):0.04196573174,t463:0.188306859):0.3267191448):0.2092452641):0.4729839531,((t464:0.7033876661,(t465:0.2079791923,t466:0.1294272782):0.4311168308):0.2010101187,(t467:0.6180237999,t468:0.5444045171):0.1291024796):0.2410576346):0.6398035545,(((t469:0.3619719955,t470:0.2986500074):0.05641682958,t471:0.3412795916):0.03342295508,t472:0.3601259579):1.086896986):7.509112643):3.177946031,(((t473:2.471394872,(((t475:0.2499681081,(t476:0.2081204529,t477:0.01902576322):0.03719032479):0.1505325518,t478:0.1874750174):0.9997117929,(t479:0.5987965044,t480:0.5921815968):0.5280877135):0.477311487):8.556593805,t481:9.899652336):0.7754124315,(t482:0.1970258882,t483:0.00436941263):10.26588761):0.3053153078):1.817872372):11.61244176,(t474:0.254883563,((t350:0.0881350184,((t345:0.05151389714,((((t328:0.1686004272,((t247:0.01535533792,(t234:0.004455829885,(((t216:0.02459454003,((t147:0.01852017156,(((t117:0.05747361394,(t104:0.06063380413,(((t91:0.2266757192,t92:0.1158149682):0.06201226193,t93:0.03256288165):0.1472159203,t1:10.03455675):0.6503910685):1.879949125):0.07030998164,(t2:11.95416417,((((t3:6.367394012,((t4:2.990506409,t5:2.842529776):1.667352442,t6:4.473014339):1.642552133):1.623746129,t7:7.738705878):1.310746171,(((t8:1.591616354,t9:1.587909691):6.313981866,t10:7.881513264):0.7666262251,((t11:7.03096985,t12:6.994648033):0.9149035325,((t13:1.217883252,(t14:1.149497814,t15:1.051296198):0.04724517867):1.403234434,(t16:1.161625654,t17:1.081458249):1.331785301):4.981469728):0.6136144609):0.3302287537):0.1419109216,((t18:4.447474035,(t19:4.411021191,t20:4.342710151):0.01340420196):1.632017646,t21:5.943644574):2.369099886):2.431030316):0.6455668761):0.5028450131,(((t22:9.460190347,(((((t23:7.569000857,(t24:6.562090459,(t25:6.124364435,t26:6.113435475):0.3422475342):0.9955885011):0.1318317605,((((t27:1.083643177,t28:0.9623077165):4.295245826,t29:5.255076411):0.714231319,t30:5.882857535):0.2556153163,((((t31:1.798661893,t32:1.769534728):1.919794384,t33:3.669966468):2.007686134,t34:5.649185081):0.0469608458,t35:5.544117445):0.3507514998):1.02253859):0.3206262184,((t36:6.160893642,t37:6.060824154):0.9805427275,(t38:6.500227326,(t39:6.076742575,t40:6.057269715):0.3998384814):0.3767788535):0.01473163838):0.6122826939,(((t41:1.189747425,t42:1.128699784):0.4635460025,t43:1.324598414):5.37520918,((t44:3.000500278,((t45:0.4423751512,t46:0.2900770928):1.462564348,(t47:0.2167770931,t48:0.1219561969):1.499173162):0.8928788935):1.985825336,t49:4.373786452):1.310716643):0.3612562558):0.7096396745,((((t50:1.092724502,t51:1.052805302):3.093959574,(t52:0.6415206212,t53:0.6327296225):3.429158732):1.229999846,((t54:2.026814997,t55:1.830482725):2.086624317,t56:3.647496861):1.033811081):0.3921167796,(t57:4.277321161,(t58:3.165358836,t59:2.914346477):0.7231203616):0.7775587225):0.9059068981):0.01818984185):0.7001945795,(((((((t60:1.523270396,t61:1.420601409):0.7379631495,(t62:0.1871768477,t63:0.1675364369):1.933198093):1.86002741,(t64:2.737725369,((t65:0.2218585884,t66:0.1762818465):2.074072311,(t67:1.222752165,t68:1.159022966):0.8045076955):0.420925418):1.214524234):0.130358699,(t69:3.126343278,t70:3.034014906):0.5554442015):0.284493687,(t71:0.3546151893,t72:0.1021736307):3.33487612):0.1345969583,((((t73:1.145265765,(t74:1.103609909,t75:1.070936409):0.01857247794):0.06897827217,t76:1.089840635):1.16937745,((t77:1.285720504,t78:1.111268256):0.4273407519,t79:1.439468536):0.4701812628):0.8152541017,(((t80:1.717903988,t81:1.471742877):0.5166441403,t82:1.92477796):0.3038319405,((t83:1.70368886,t84:1.645271717):0.06452248372,(t85:0.8965326213,t86:0.8488768228):0.6681694488):0.3698470598):0.1753073306):0.3713861157):1.013890387,((t87:0.7001853589,t88:0.5489163882):0.2578301624,t89:0.732357885):1.983742163):0.2756494566):0.4113763479,((((((t90:0.801897315,t94:0.3264512314):0.3677746334,t95:0.6929801962):0.2124131665,t96:0.8202162895):0.02885078244,(t97:0.6033353754,t98:0.593070168):0.09410326328):0.884217696,t99:1.491062641):0.7403784538,((t100:1.529982883,(t101:0.2095037634,t102:0.1734791016):1.287746834):0.2101373132,t103:1.554377537):0.4765274292):0.2460124584):0.2816811512):1.921926592):6.2712111,t105:10.36379061):0.2054009047):1.415246288,(((((t106:0.5033340876,t107:0.4632577875):1.514069083,(t108:1.43518224,t109:1.234046272):0.3753937902):8.540735567,(t110:9.843407631,(t111:1.076381233,(t112:0.4220142173,t113:0.3769057803):0.5818992758):8.674244198):0.2214015145):0.1312550551,(t114:9.702893355,((((t115:0.4797266003,t116:0.3898406707):0.4629009424,t118:0.5753956703):0.8763871325,t119:1.339748775):5.485528943,(t120:0.4768339674,t121:0.3588462122):6.334255449):2.230681554):0.1498703524):0.3769578733,t122:9.432297225):0.6839139942):0.07170407903,t123:10.10449794):1.126672362):1.0941279):3.041269832,((((t124:6.574224552,t125:6.524215145):2.143284526,(t126:8.017691284,((t127:1.788108636,t128:1.756110543):3.511000124,t129:5.26124518):2.683119429):0.5906849287):2.78351954,(((t130:6.794698643,(t131:1.743010752,t132:1.416676903):5.012987216):2.858654582,(((t133:7.604235937,(((t134:1.137296738,t135:1.080798716):2.257240104,t136:3.077809315):3.824995766,t137:6.798366165):0.1857125421):0.08627660304,(((t138:2.692540955,t139:2.62877475):2.175091902,((t140:1.107642639,t141:1.064982979):0.385257254,(t142:0.6763337696,t143:0.6514789004):0.6174856324):3.272222557):0.1353452069,((t144:1.325146605,t145:1.323069468):2.069792263,t146:3.249315475):1.162673755):2.003570657):0.5344828897,(((t148:3.428648405,t149:3.371925808):2.460983031,t150:5.674650989):0.2839971501,(t151:2.103660108,(t152:1.024319861,t153:0.975815733):0.9120815758):3.74078595):0.5009960196):1.05881721):0.09841173715,t154:7.229354419):1.421654861):0.2280729752,t155:8.810107524):3.630943155):5.513824602):0.9594867606,(((((((t156:0.8510644068,t157:0.6092421203):2.006128606,t158:2.549738804):0.6955658554,(t159:0.7853829404,t160:0.7575131933):2.435444192):4.375780428,t161:7.555333626):0.7042290239,((t162:1.57927478,((t163:0.4820537616,t164:0.3924876482):0.1425298826,t165:0.3904639709):0.8558261304):5.701779454,((t166:2.579166148,t167:2.373472868):4.01737498,(t168:3.930496217,((t169:0.2456078665,t170:0.2332954487):2.494401804,t171:2.642471756):1.138062572):2.383770498):0.2450825349):0.9168495766):2.325362845,(((t172:5.175706189,((t173:2.437649339,(t174:1.371863952,t175:1.310835844):1.05703971):0.7443836194,t176:3.098371469):1.875289531):0.09428379906,((((t177:3.891651489,((t178:0.7196205938,t179:0.4198818589):2.11346136,t180:2.497748373):1.032144161):0.8009402586,(t181:3.331321592,t182:3.175310818):0.9297839665):0.02943244928,(((t183:0.3796409403,t184:0.195437432):3.347230302,(t185:3.198518781,t186:3.031985185):0.2252044168):0.1652714654,(t187:0.5855064193,t188:0.5569116064):2.763347657):0.129364092):0.202901429,((t189:2.779128925,(t190:2.753861288,t191:2.702989926):0.01607244898):0.5440928465,(((((t192:1.815428606,t193:1.673255221):0.9538430406,(t194:2.253005593,(t195:1.936066505,(t196:0.3790661627,(t197:0.3453060515,(t198:0.1880565733,t199:0.08985790334):0.04199486088):0.02105784545):1.548891895):0.02168008029):0.3262032029):0.006805941991,t200:2.017991097):0.2740896551,((t201:0.8118360771,(t202:0.3982635401,t203:0.3292454528):0.4042849096):0.5011245227,(t204:0.3428272773,t205:0.2548485478):0.8179965726):0.6251295553):0.1446808425,((t206:1.231277262,t207:1.193613452):0.02202958002,t208:1.107942099):0.5299365818):0.03745723604):0.1942017705):0.1425864693):1.054265008,((t209:0.8319046749,t210:0.7725384245):1.987136833,(((t211:0.7492697885,(t212:0.4747095486,t213:0.4207260014):0.1163953368):0.8878710259,((t214:0.6137857505,t215:0.5490154334):0.6336013134,(t217:0.3871689759,t218:0.3103056428):0.6253296214):0.1323734246):0.001097483136,((t219:0.6108291257,(t220:0.1918716289,(t221:0.06943897512,t222:0.02166084694):0.02936567184):0.403054638):0.1111447325,t223:0.4774203853):0.247823811):0.8044704205):0.04670894146):3.318956427):2.739198413,(t224:1.887800249,((t225:0.3082968176,t226:0.2750396079):0.02227670028,t227:0.164000303):1.553610398):5.623730023):5.155537938):0.09999810431,((((((t228:0.6233663416,t229:0.3696192555):0.6602818119,t230:0.8348155839):9.567351391,(t231:8.92124935,((((t232:0.2414205159,t233:0.0980878482):2.330833843,(t235:0.318314881,t236:0.2782079605):1.072184474):4.7785331,t237:5.936757192):0.5919159977,(t238:0.257172939,t239:0.1457837542):6.259129228):0.9240473491):1.147539412):0.1805524636,(t240:8.294138415,(t241:4.943441205,(t242:1.201096507,t243:1.194739768):3.701598267):3.084548616):0.2540179381):0.9665766855,t244:9.18541567):0.3194162546,((t245:0.2461331082,t246:0.2359396932):8.37138707,(t248:5.342794506,t249:5.136182577):2.787923524):0.8557189057):0.2431862481):0.7014579011,((t250:3.441457025,(t251:0.245004666,t252:0.2011728598):3.192034859):5.679567337,t253:9.03584774):0.4822101989):0.1532290528):0.3875445285,((((t254:5.926159734,(t255:1.204606223,t256:1.090762243):4.518889866):1.63602115,(t257:1.371597699,t258:1.314597757):5.745620663):0.2581292515,t259:7.096942864):1.623592365,(((t260:4.290753082,t261:4.079477073):3.284283399,t262:7.314390245):0.1196015291,((t263:0.05144310614,t264:0.04081788112):6.203033202,(t265:5.54015707,t266:5.501733683):0.6974462187):1.090859514):0.983766676):0.6107099592):0.01291829079):8.574444673,((((t267:6.252071853,((t268:2.829805285,t269:2.685698415):3.338311073,t270:5.853659146):0.06603077178):0.4704788747,(t271:1.134741004,t272:0.9535203124):5.170301773):2.586728466,(((((t273:4.207840474,(t274:0.9772903553,t275:0.9331702876):3.151142536):1.431431356,(t276:1.856326983,t277:1.696519249):3.621254616):0.6356187189,t278:5.790966029):0.558885263,((((t279:0.2950293424,t280:0.1129931051):3.625867368,t281:3.478998792):0.8208385162,((t282:0.6747882065,t283:0.569309096):0.4579892907,t284:1.020814443):3.143128928):0.9022574129,t285:4.826128442):0.6937331564):1.313694974,((((t286:0.9296532248,(t287:0.3954777813,t288:0.1728673202):0.526890378):3.785075268,(t289:4.237622016,((t290:0.4277786974,t291:0.3807717774):3.054579918,(t292:3.140045217,(t293:2.392658355,t294:2.101176987):0.7361928131):0.280090756):0.6177182635):0.2250173692):0.04553241556,((t295:2.71034688,t296:2.608019921):0.9121147337,(t297:1.926160275,(t298:1.154216379,t299:1.107889712):0.3771213846):1.485730411):0.3021366261):0.4440937417,(t300:1.394950663,(t301:1.032701634,t302:0.8418928064):0.0210641657):2.317347422):1.56606538):0.5084084539):2.517098454,((t303:0.9981276433,t304:0.9418187331):3.310449563,((((t305:0.4909703162,t306:0.4887067935):0.8101084149,t307:1.160204511):0.2493969748,(t308:0.6165280971,t309:0.604713344):0.7379634181):0.2874957218,t310:1.62044613):2.366816082):3.409383784):5.605346564):1.599897395):25.02010654):11.830985);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T23.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
