<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t496:0.5668449712,t497:0.4399102077):26.7590017,(((t498:0.5039943905,t499:0.381253373):12.63964252,t500:12.98862499):9.738376164,((((t501:1.614478979,((t493:0.02269480899,(t479:0.05250732541,(t476:0.1671745589,(((((t359:0.06905913092,(t351:0.2823487758,(t283:0.1795221405,(((t251:0.03837202504,(t245:0.03224360497,((t241:0.1833620072,(t242:0.07202366445,(((((t187:0.007380621119,(t157:0.08349471779,(t135:0.0163573516,(t131:0.2995553853,(t115:0.1356870305,(t116:0.01236784205,((t37:0.04994231528,((t24:0.07863295853,(t16:0.03977975868,t1:1.717452213):0.348757567):0.0300154101,t2:1.714185886):1.373330959):4.700823475,(t3:3.846379998,((t4:1.10220052,t5:1.080811057):0.02153175428,t6:0.5879443913):2.648211871):3.591551452):2.392200737):0.05446402292):2.292107039):0.4713057365):2.345147061):2.47289913):4.181705298,(((t7:0.03228710178,t8:0.01797490246):0.8692327935,t9:0.8673104129):14.66465501,((t10:11.33775551,((((((t11:6.531211555,((t12:0.443596249,(t13:0.2492210877,t14:0.2471393927):0.1611128801):2.565614077,t15:2.94928488):3.420496285):2.29728699,(((t17:5.30751218,(t18:1.080830708,t19:1.017379369):4.224736463):0.7509115869,t20:5.982753473):2.501576908,(t21:7.921061638,t22:7.910573453):0.534293025):0.02688498576):0.1611315131,t23:8.626542355):0.4078567502,t25:8.80494172):1.398809726,(((t26:5.679611989,(((t27:0.3576015612,t28:0.07130650024):3.589943731,t29:3.628571908):1.565158276,t30:5.01404564):0.086080861):3.900629184,((((((t31:2.205888355,t32:2.188817647):2.128267724,((t33:3.392824353,t34:3.272543023):0.748427878,t35:3.935296175):0.1095508407):2.362068477,(t36:5.036025745,t38:4.836060665):1.29611103):1.041029893,(t39:3.055275833,t40:3.031971418):4.107589297):0.103841414,((t41:6.66578157,((t42:0.9204152042,t43:0.8398183489):3.996967496,t44:4.832294707):1.738154728):0.1184229542,(t45:4.149126066,(t46:2.237905795,t47:2.019008264):1.78790222):2.487963994):0.4168768487):0.6031549584,((t48:2.336299735,t49:2.14442279):3.120951644,(t50:4.133515965,(t51:3.130303686,t52:3.005936335):0.7204714535):0.745760917):1.692619148):0.3117230408):0.4687941328,(((t53:4.87081766,t54:4.852017292):0.5271808265,(t55:0.2953268485,t56:0.2724114535):4.876563039):0.6854946456,(t57:4.728178809,t58:4.726241833):1.074385656):0.8094851538):0.05410104439):0.2477550595,((t59:5.285111041,((t60:4.48541127,(t61:3.736193638,(t62:0.988472322,t63:0.9159952067):2.661320584):0.6933829627):0.5724163943,((t64:4.16276907,(t65:1.304099156,t66:1.1841828):2.555826101):0.3764007303,(t67:3.412108758,((t68:3.200350483,(t69:2.468854109,t70:2.397274571):0.6898345104):0.1007509856,t71:3.176514904):0.07575631488):0.4819003406):0.26409894):0.1923330497):0.5434440465,(t72:4.617233957,((t73:3.301886465,((((t74:0.3119625006,t75:0.2528283917):2.0193722,t76:2.105071596):0.6914624512,t77:2.735937264):0.02044987814,(((t78:0.6207532699,t79:0.5061150941):0.643935356,t80:1.036092107):0.6459456539,t81:1.680153065):0.7280902775):0.1651383683):0.9066324128,(((t82:1.485292433,t83:1.454612341):0.08828924214,t84:1.540250908):0.2006641346,(t85:0.4338434073,t86:0.427215571):1.143692453):1.566165853):0.1886482023):0.01987259504):0.9611320488):0.2834882303):0.08692074184,(((t87:0.9388091422,t88:0.9326921605):2.532540798,((t89:1.110367394,t90:1.104126673):1.893870454,t91:2.958632262):0.2840056907):0.6513369945,(t92:0.9880210514,t93:0.9262698762):2.894488896):0.3861876528):4.042542981):5.432031337):0.2251922454,(((((((t94:0.5967267107,(t95:0.5243739543,t96:0.475034359):0.001346842571):0.2574537417,t97:0.6959994407):0.2842775969,t98:0.547925718):1.000525694,(t99:0.5452357663,t100:0.2975092984):0.9615773921):8.044023015,(((t101:1.427475909,(((t102:0.4861626598,(t103:0.161646008,t104:0.1471864119):0.01636960979):0.3899471508,t105:0.5427296586):0.3389505274,t106:0.8602619479):0.1920263568):1.111972386,(t107:1.42339322,t108:1.406607559):0.6670902524):0.3687099353,t109:2.425053185):6.296712828):0.6026514567,(t110:1.331391755,(t111:0.6710790163,t112:0.662420196):0.6203590147):7.983642158):2.540407059,(((t113:0.5989985849,t114:0.444445206):0.6328918486,((t117:0.2967905781,t118:0.2811740499):0.2550944998,(t119:0.2229515882,t120:0.004614382056):0.2444091302):0.2873621614):1.177172471,t121:1.269762119):9.371432259):0.5556773945):0.347879488,((t122:0.1862947973,t123:0.1331132431):10.51368892,(((((t124:0.4191241505,t125:0.1713833458):0.7477968623,(t126:0.553005495,(t127:0.2634814857,t128:0.1291393131):0.07323238614):0.3549046999):0.928361227,(t129:0.2421357357,t130:0.09982212722):1.163788461):3.321346051,t132:4.046825374):5.062743695,(((t133:1.331210619,t134:1.170703343):6.242025304,(t136:0.2651423115,t137:0.2136243988):7.037718177):1.255687645,(((t138:2.719991618,t139:2.714328484):2.880561961,t140:5.585505702):2.312311981,(t141:6.903596956,t142:6.822992663):0.9699141782):0.2040852287):0.2219379432):0.01296634422):0.7583261413):0.2808310989,((t143:8.294213038,t144:8.223470667):0.6983963846,t145:8.518438472):0.2207659108):0.2598208026):0.006201690273):0.1610247864,t146:9.126163252):0.2493400088):0.6233191741):1.888416908,((t147:8.640616134,((t148:6.546705088,t149:6.396693562):1.396545161,t150:7.70198218):0.5064452343):1.293504686,((((t151:1.171793069,t152:1.134940326):3.132595968,t153:4.226106781):1.115081992,t154:5.271178363):2.913166243,(((t155:3.741536709,t156:3.43222455):3.133730734,((t158:0.3151345146,t159:0.1771292384):4.775456133,(t160:1.747643846,t161:1.723454349):3.185730277):1.304576505):0.3450208849,(t162:4.603919286,t163:4.599511722):1.948260084):0.9129721735):1.11550788):1.901870183):0.2018156467,((((t164:0.07775107318,t165:0.03148860078):5.594366012,((t166:0.5628400963,t167:0.4178515032):3.489142579,t168:3.820320029):1.496926258):2.171200134,t169:7.027458712):1.204455405,((t170:5.887868491,((t171:2.336416608,t172:2.249357798):3.233012059,t173:5.461779729):0.2780807682):1.798490035,((t174:5.322910286,(((((t175:2.97511614,t176:2.911678217):1.305934169,t177:4.193615581):0.2348879692,t178:4.317252459):0.2339152589,(((t179:0.9496727011,t180:0.9450938364):1.922902675,(t181:1.902281195,t182:1.753451023):0.9345443077):0.8237576726,(t183:1.512693098,t184:1.500560628):1.478320059):0.786448062):0.03395588552,t185:3.740374703):0.4989744628):0.4777057064,((t186:0.8845256195,t188:0.5025674179):1.075023189,(t189:0.9014807582,t190:0.856447734):0.6754746498):2.735744642):1.597560407):0.5339119327):1.628793589):0.6197735253):6.109946862):0.9074878792):1.303140037,(((((((t191:3.241545121,((t192:0.5165982963,t193:0.3373271254):1.267433185,t194:1.572452301):1.384606298):0.1789583346,t195:3.095746984):0.1932762838,((t196:2.278002535,t197:2.027895994):0.2603272544,((t198:0.3154284949,t199:0.2824683934):1.518073624,t200:1.656498481):0.4090951312):0.7281812902):2.642466484,(((((t201:1.046222877,t202:0.9188515583):1.260788248,t203:2.171236742):0.5316325426,(t204:1.071359281,t205:1.058968819):1.625796804):0.1754904354,(t206:1.291345076,t207:1.215159366):1.549837628):1.6421352,(t208:1.04566452,t209:1.040726614):3.146343956):0.7520776402):0.6588534273,(((t210:1.189342539,t211:1.080521399):1.501157013,(((t212:1.758087753,((t213:0.6834950052,t214:0.5154154129):0.5086124117,t215:1.017194072):0.550631715):0.01119085421,((t216:1.059471401,t217:1.010269888):0.273734363,t218:1.237093279):0.154576202):0.5669281461,((t219:1.225186256,(t220:0.6080851817,t221:0.5780699203):0.6129700323):0.4020644589,t222:1.453266872):0.1799295209):0.1485707172):1.02501507,(((t223:0.5429380312,t224:0.3995610465):1.367345062,(((t225:0.4646686391,t226:0.2441227907):0.4643511142,t227:0.7045383527):0.1388315393,(t228:0.4990008629,t229:0.4626902087):0.3039452773):0.6391912803):0.2545126196,(((t230:0.9331110133,(t231:0.1553203061,t232:0.05278495959):0.6685706583):0.3400272932,(t233:0.2806373598,t234:0.1808381263):0.7078222971):0.2786297953,((t235:0.2034864284,t236:0.1192068721):0.5521024177,t237:0.3002060771):0.2004971739):0.05051895485):0.5335113115):1.83114657):0.5493934509,((t238:1.378773785,t239:1.27354405):1.360446469,(t240:1.465549168,(t243:0.1484495944,t244:0.08620455052):0.901891004):1.158564535):0.718898482):7.319254166,((t246:0.956991831,t247:0.9070185187):8.073418118,(t248:1.272686085,t249:1.266293453):7.699286445):0.7342418516):1.58969428):0.3286313893,(((((t250:2.765955148,t252:2.489630953):5.155314387,(((t253:0.9411994389,(t254:0.3752259273,t255:0.2888642881):0.5183100357):4.672014569,t256:5.413040988):0.8885486219,((t257:4.079804347,(t258:2.222419539,((t259:0.273637495,t260:0.2487193997):1.830002447,t261:2.060690831):0.09472635608):1.792760859):0.9070774202,t262:4.800796285):1.199229077):0.9633980259):0.07470575415,(t263:2.026417762,(t264:1.290012875,t265:1.212377949):0.5629214318):4.840841278):1.776878913,t266:8.391615344):1.061506862,((t267:0.5066262746,t268:0.5047041826):8.216484069,(t269:7.461891768,((t270:1.965935402,t271:1.928784059):4.397593891,((t272:0.621632499,t273:0.3820968511):5.495248192,(t274:5.078816708,t275:5.037814219):0.7718112797):0.1221924491):1.086972229):1.251674384):0.7216712581):0.6345708135):0.5409388524,(t276:7.12596622,t277:6.976734257):2.862891397):0.6876011721,((t278:6.112068312,(t279:5.671382594,(t280:2.735119938,(t281:0.4870190648,t282:0.3388162544):2.216370762):2.793077549):0.3687004678):2.790757217,(((t284:1.465727223,t285:1.459170808):2.992969486,t286:4.418626504):2.986114791,(t287:3.29007613,t288:3.26388238):4.020465081):0.8343999296):1.597365725):8.046456523):0.2561943318):1.282492238):1.609276399,((((((((((((t289:4.348072726,t290:4.267327391):1.402667988,(t291:5.497800316,(t292:5.014396188,(t293:2.545906566,t294:2.545746526):2.466408264):0.3659830519):0.1391485704):0.3705306509,(t295:4.889224208,t296:4.837387288):0.7354294883):0.3819107828,(t297:5.410438848,t298:5.394283903):0.4711007331):1.296008808,((t299:5.413233097,t300:5.101798663):1.298898258,((t301:4.881496227,(t302:3.077837623,(t303:2.910234879,(t304:0.9377211295,t305:0.8753358675):1.765580347):0.1644274954):1.720036562):0.3162572805,(t306:4.554542672,(t307:2.828987393,t308:2.695779767):1.57156906):0.2791574446):0.9712679216):0.3074531143):0.3396878404,((((t309:2.230106545,t310:2.112807514):2.467760873,t311:4.522421569):0.4489023325,t312:4.784398198):0.2531967287,((t313:4.082660447,(t314:2.929920024,t315:2.611164357):1.14404471):0.5668264671,((t316:2.280630336,(t317:0.3426045256,t318:0.245412241):1.896864243):0.417378481,t319:2.44589548):1.568781833):0.3406957368):0.6525875071):0.7940681908,(((t320:4.014166289,(((t321:1.50952306,t322:1.341521679):1.529046319,t323:2.824358573):0.6950818633,((t324:0.1589063668,t325:0.1013380561):0.7130193201,t326:0.8079459891):2.585879161):0.1897997079):0.2025651703,(t327:2.984817803,t328:2.787471869):0.7936464323):0.8096693418,((t329:2.209549338,t330:2.200813625):1.395414784,(t331:1.799610816,t332:1.533702175):1.61426478):0.7816637677):0.6850775797):0.4204995856,(((((t333:1.161759404,(t334:0.7364038733,t335:0.6235978186):0.3911199518):0.6223999704,t336:1.621025426):1.09396743,t337:2.700694707):0.7529164886,((t338:2.183189319,t339:2.134229879):0.7517494575,((t340:2.092288693,(t341:0.9598523786,t342:0.9169284499):1.111739315):0.1121146039,t343:2.093170515):0.6798133193):0.4643296626):0.4760523744,((t344:2.598420092,t345:2.550692426):0.7223840079,(t346:2.311413616,t347:2.28859659):0.8884924914):0.3854911625):0.8989645837):0.9727448042,(((t348:2.501124428,((t349:1.11743721,t350:0.920913768):0.1177052704,t352:0.4743117343):1.043132323):1.46401488,(t353:1.055708153,t354:0.9118938782):1.896894345):0.6754451635,(((t355:1.821277497,(t356:0.5310262851,t357:0.3017304097):1.2895033):0.05673926819,(t358:0.4065770067,t360:0.2065524824):1.229679964):0.5927677604,t361:1.778583265):0.7806156522):0.6638872304):5.753847483,(((((t362:2.103475446,(t363:0.1887177379,t364:0.1677491876):1.106202008):0.8492688455,t365:2.028252123):0.8643232649,((t366:1.098782259,(t367:0.09470046808,t368:0.06531774236):0.982518896):0.5309620403,t369:1.483898347):1.169600572):1.871793982,t370:4.071678399):2.057302747,(t371:1.980394713,(((t372:0.5057519834,t373:0.4923436736):0.1383223109,t374:0.6196324933):0.4116894927,t375:0.8514534248):0.7010981202):4.118757858):1.153561696):2.658863339,(t376:1.006183499,t377:0.9566786831):8.396753882):0.3506015816,t378:9.646349533):1.719978266):1.230513688):0.2923983561,((((((((t379:0.3931757878,t380:0.3489986663):4.539880666,((t381:0.09903941015,t382:0.074113354):0.2283838655,t383:0.2039711244):4.494491197):3.109592191,(t384:6.924457425,(t385:6.585626169,(t386:6.284233616,(t387:3.026436892,t388:2.93281485):3.214419795):0.2424127268):0.308299961):0.7660808193):0.9116974879,(t389:0.6860880103,(t390:0.5048897728,(t391:0.3821096918,t392:0.3538634161):0.08087594733):0.02386696495):7.513340959):1.001671694,t393:8.806413712):0.2435509034,((t394:6.244372261,t395:6.105387389):1.759467444,((((t396:4.674390636,t397:4.479359483):1.779327803,((((t398:3.190434055,(t399:0.0716703643,t400:0.01186935156):3.086712695):1.79478609,((t401:0.5450455486,t402:0.4010361214):2.716667535,t403:3.107421127):1.514084618):0.1866656315,t404:4.716633336):0.2981564458,t405:4.975242128):0.7514541713):0.4127480091,(((t406:3.469338918,(t407:0.4737581995,t408:0.3717195539):2.991005094):0.8428407323,t409:4.203919704):0.01272690301,((t410:1.382967278,t411:1.359653199):1.297576554,t412:2.510220205):1.496793522):1.794446536):0.3012664684,t413:5.993626274):0.4212789457):0.6787610711):0.2035275163,(t414:5.859783731,((t415:3.750039512,t416:3.665415417):1.014187837,(t417:2.436822024,t418:2.321972812):2.132632176):1.018154101):1.371204202):0.4975235965,t419:7.307485456):1.96343484):9.557479129,((((t420:5.75284107,(t421:4.916027008,(t422:4.567892453,t423:4.390192267):0.3246291797):0.796609727):1.435198871,(((t424:4.081028906,((t425:1.601721813,(t426:0.2019396641,t427:0.1946287884):1.273511831):0.526471989,t428:1.944886961):1.937515429):1.168987186,t429:4.900330418):1.307846967,((((t430:2.741524886,t431:2.703673302):2.342316699,((t432:0.887087612,t433:0.8627927411):3.025219655,(t434:0.2715265785,t435:0.2611378405):3.564565719):1.090812514):0.4731209301,((t436:3.516281651,t437:3.320999687):1.840734769,(t438:3.09813926,t439:2.985414745):1.925262175):0.02865763572):0.4544922754,(((((((t440:0.883359733,(t441:0.3295229383,t442:0.303429113):0.5062277212):0.2842721472,t443:1.054035844):1.427423119,t444:2.360602109):1.541175025,((t445:1.793705671,t446:1.712577937):1.530475932,t447:3.173389441):0.4206614147):0.03209059141,t448:3.619010577):0.2459422234,t449:3.781472886):0.1084666529,((t450:2.474871711,t451:2.247423202):0.4803861264,t452:2.714730896):0.8981609597):0.7700005498):0.1031297464):0.0394545851):0.789707593,(t453:3.005340615,(t454:1.680750756,t455:1.626689745):1.123832218):2.297632543):1.258655801,(t456:2.646406517,t457:2.616102033):3.631085954):9.580577263):0.4116036075,(((((t458:0.1559806837,t459:0.1530566596):1.20438275,t460:0.9957306834):1.417682625,(t461:0.5958198704,t462:0.5262923841):1.738221388):2.215815034,(t463:2.1267701,(t464:1.152389716,t465:0.9823666181):0.886489184):2.31851232):0.6073154165,(((((((t466:0.8811213053,t467:0.8094094541):0.418409484,(t468:0.8281164887,t469:0.7520757886):0.2766005979):0.6506916997,t470:1.666801866):1.312635857,((((t471:0.6340962727,t472:0.6177897132):1.240041344,((t473:0.9581544994,t474:0.897217492):0.7409744428,(t475:1.295016298,(t477:0.2926130784,t478:0.1704319488):0.7467357082):0.2483123259):0.124185253):0.1192390298,((t480:0.4118101896,t481:0.3489286831):0.0538072448,t482:0.145106287):0.8017362358):0.1890147806,(t483:0.4433725667,t484:0.2549847639):0.6710551259):0.744850195):0.4815101049,((t485:0.6752311902,t486:0.5829879197):0.6815959709,t487:1.170573551):0.7829367834):0.2762369067,(t488:1.343266864,t489:1.332650105):0.8796578926):0.5271612533,(((t490:0.2619802303,t491:0.2306230052):0.4553285857,t492:0.6416598437):0.3778098593,(t494:0.3417462378,t495:0.258672598):0.279739821):1.32035392):0.2424759704):10.59770052):10.56962986):4.149402137);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T96.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
