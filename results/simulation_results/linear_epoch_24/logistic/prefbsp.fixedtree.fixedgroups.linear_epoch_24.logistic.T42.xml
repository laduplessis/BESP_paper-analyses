<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t432:4.54244602,(((t433:1.891284139,(((t434:0.5726662524,t435:0.494892104):0.7017487595,(t436:0.3785018646,t437:0.3764511789):0.7668449598):0.3349267907,t438:1.364264569):0.1683536506):1.977105739,((t440:1.739138664,t441:1.517494614):0.5885390356,t442:2.060182186):1.001643512):0.2908115568,t443:3.343755237):0.1298543462):0.4535909788,(t444:3.461491132,(t445:2.672397713,((t446:0.953069798,t447:0.6241287401):0.3667000699,t448:0.7500050093):1.334353332):0.7431075471):0.4259886495):0.4487417562,(((t449:0.6394933019,(t450:0.4003283235,t451:0.2811498001):0.134181929):2.241616719,(t452:2.460356916,t453:2.22969526):0.0996197347):0.2191638035,t454:2.510359118):0.5233319746):0.05474961937,((((t455:1.467510582,t456:1.416416225):0.5146686687,((t458:0.8817425788,t459:0.8104714661):0.3289239748,t460:1.073134118):0.6032183843):0.2009134702,((t461:0.2423525075,t462:0.2233301154):0.7154000988,t463:0.892898776):0.9037271711):0.8396653049,((t464:0.5535179193,t465:0.419669979):1.532170157,((t466:1.361693284,t467:1.347784413):0.120514116,t468:1.276028669):0.4404940943):0.5446599449):0.0494717277):24.05732454,(((((((t469:1.036532036,t470:0.9993974648):0.9876284098,t471:1.874860353):0.3696410366,((t472:1.210481456,t473:0.9013550882):0.4170780767,(t474:0.8217111207,((t475:0.2816282045,t476:0.2452178444):0.2442727012,t477:0.3728554428):0.09601939174):0.2440239347):0.5865173401):0.8127522541,(((t478:0.4363614693,t480:0.3203488718):0.3229549723,((t481:0.08302066615,t482:0.05448299228):0.2577902799,t483:0.2553186825):0.1664121753):0.6330405668,(t484:0.5951242764,t485:0.4874788309):0.4122186911):0.7100879097):4.911226694,(t486:1.459475858,((t487:0.3705573196,t488:0.3619186638):0.1362775264,(t489:0.1272063529,t490:0.05580638153):0.2394829268):0.9434017112):4.838704872):0.3679075413,(((t491:0.1820515195,t492:0.1685809331):0.918585764,(t493:0.3495596535,(((t479:0.02892322449,((t457:0.003594721971,((t439:0.06382532028,(((t362:0.3132513214,t364:0.06682726018):0.09747491114,t365:0.05922014603):0.27650557,(t363:0.04090768179,((t347:0.02653958674,((((t245:0.005797221967,((t235:0.1496342805,(t175:0.0511383994,(t171:0.04721123114,(t139:0.3364753818,((t121:0.003432198882,(t120:0.05284313606,(t112:0.1253024808,(((t2:0.1185035576,t1:0.2998773843):2.42468457,t3:2.375351802):7.323244308,((t4:0.2089534622,t5:0.1176028718):2.394550748,(t6:1.801964121,t7:1.594911023):0.5550881839):6.799744994):0.5722718707):0.7072045999):0.009871367074):1.873599356,(((t8:6.924551323,(t9:5.033472538,t10:4.876297361):1.693279056):1.236085499,(t11:6.132759915,(t12:4.873202396,t13:4.871052936):1.199225504):1.657829822):3.258543989,(((((t14:3.698718725,(t15:3.296373344,t16:3.205388094):0.3637995362):1.175035379,(t17:0.4427037999,t18:0.4136855319):4.280228803):0.9292129252,(t19:3.832802607,(t20:3.682112598,t21:3.658513299):0.0001280441393):1.751006221):1.185357312,(t22:4.017924727,t23:3.823153242):2.32249743):2.101681199,t24:8.159401477):1.84414127):0.6819936982):0.86553255):1.933748486):0.4018730631):4.913292439):0.9389309233,((((((t25:2.154613923,(((t26:0.1649220939,t27:0.1436201156):0.254164415,t28:0.177770046):0.988566363,(t29:0.2448791748,t30:0.2351130683):0.8418763577):0.6312155362):2.44953935,t31:3.97438859):1.925282537,(((t32:4.630749478,t33:4.584609909):0.3721540863,(t34:2.924181179,t35:2.913234994):2.005214046):0.6094765542,(t36:2.078220449,(t37:0.8059780711,t38:0.6050525934):1.234726763):3.449216305):0.2847233197):0.9853081942,(((t39:1.208481816,t40:1.035128693):3.952954708,((t41:0.4625690694,t42:0.4430363223):3.378277314,t43:3.722706168):1.068730016):0.9638550435,((t44:1.385050438,t45:0.9937605418):3.98779034,(t46:3.659437196,t47:3.588639797):1.304430024):0.2482350673):0.3222028255):0.009412867261,(t48:5.07578878,t49:5.024985353):0.344873386):1.274671596,((t50:5.589730677,t51:5.442906065):0.6381689309,(t52:5.264671898,t53:5.102245361):0.7685698542):0.3703949381):10.66323657):0.04972109684):2.21865051,(((((((((((t54:3.697471012,t55:3.486102706):0.05202392353,t56:3.527792523):0.2804291086,t57:3.742883148):1.163213093,((t58:0.3339139435,t59:0.2171301546):2.295605074,t60:2.507471402):2.269152065):2.812238412,(((((((t61:3.998053465,t62:3.931753572):0.1638591325,t63:4.035963239):1.903993882,((t64:4.882221163,(t65:4.827058089,(((t66:2.786055148,t67:2.760249251):0.876111661,(t68:1.206269274,t69:1.191819711):2.351201094):0.6339397355,(((t70:3.263997763,((t71:0.2108793537,t72:0.1103645743):2.89159033,(((t73:0.4392815644,t74:0.3228637932):0.904229629,(t75:0.744188576,t76:0.7011306249):0.3688071928):0.5253651851,t77:1.486306882):1.103089956):0.1136581093):0.3087909868,((t78:2.407997421,t79:2.269993434):0.2436209044,(t80:0.8466555338,t81:0.7743192498):1.607566676):0.1064415658):0.393445808,((t82:2.146787938,(t83:0.4793668149,t84:0.4177215274):1.532292455):0.3660213221,(((t85:1.130044457,(t86:0.5472499225,t87:0.545025541):0.5619295937):0.1977932621,t88:1.001649409):0.1680518399,(t89:1.06554327,t90:1.055027195):0.04713045565):0.697026931):0.2977031158):0.1134801362):0.1497738693):0.02132525347):0.3754479526,((((t91:0.8516424209,t92:0.7790386495):1.657227705,(t93:1.637714945,(t94:1.583342275,t95:1.457856026):0.03004436574):0.732172572):0.07773872542,t96:2.280390637):0.06014316252,(((t97:0.6426490476,t98:0.6111583068):0.3764013639,t99:0.7102331837):0.2896630602,((t100:0.1240067851,t101:0.0891237544):0.3755374393,t102:0.4330655426):0.1668755832):0.9316358584):0.03990070907):0.5211070079):0.3180525132,((((t103:0.8923743141,(((t104:0.748699078,t105:0.7409276111):0.1093693564,t106:0.8164716529):0.01347762331,(t107:0.504181515,t108:0.4830789218):0.250002144):0.01269698292):0.3910284259,(t109:0.8966190269,t110:0.7742574544):0.1575849146):0.5920929604,(t111:0.2702987096,t113:0.09040393727):1.0567829):0.5092655298,((t114:1.021052421,(t115:0.4849668644,t116:0.4608708122):0.5350688225):0.03238777144,t117:0.7935451802):0.5600089364):0.0225575096):0.1897002937,t118:1.559228099):0.7459453461,t119:1.995679888):0.1233563912,t122:1.619661794):0.04196252012):8.378182946,((((t123:1.169062152,t124:1.154554916):0.09211526847,t125:1.170911567):6.244882791,(t126:0.8861202864,t127:0.7325843364):6.520291107):1.668612128,((t128:0.5937938972,t129:0.3011584778):7.651525345,(t130:3.878186921,t131:3.758491205):3.797846976):0.6362169378):0.5030710864):0.2920353119,((t132:1.370273502,t133:1.293883791):6.899283905,((t134:8.027916757,(t135:1.335732982,t136:1.270087177):6.680981876):0.157932,(((t137:2.100519547,t138:1.894716914):2.489103725,t140:3.807649312):1.177567505,t141:4.911703933):2.335903849):0.002579432883):0.6341492363):0.5913613791,((t142:6.849246954,(t143:5.018603748,t144:4.801601819):1.795305153):1.140173354,(((t145:4.397278573,((t146:0.3287578658,t147:0.2678125351):4.010454189,(t148:1.143637043,t149:0.80387656):3.100500094):0.03906003543):1.10931546,t150:4.959035075):1.705942854,(t151:1.297771154,t152:1.262205706):5.278691934):0.5141106028):0.4814185316):0.5690012825,((t153:7.403866884,(((t154:5.46515811,(t155:2.215630265,t156:2.177011514):3.24301411):0.9022618696,(t157:5.165020339,t158:5.147965899):1.140236997):0.9528055528,((((t159:0.2867485655,t160:0.2607919124):3.461893406,t161:3.719565429):2.090609158,t162:5.761480924):1.245697734,(t163:0.2925954872,t164:0.2488865234):6.597512133):0.1176364731):0.07733293901):0.1782282445,((((t165:2.189204603,t166:2.055007488):0.860386801,(t167:0.1168311939,t168:0.08380862675):2.765954339):3.318203503,(t169:5.751325168,((t170:2.512828381,t172:2.400927723):1.408716352,t173:3.639807089):1.736806835):0.3806073738):0.4826308337,t174:6.116781693):0.3097972563):0.4634285939):0.09358772641,(((t176:6.225188698,(((t177:3.185026161,t178:3.170270111):0.459265475,t179:3.487475152):1.716993434,(t180:4.461638947,((t181:1.90412012,t182:1.866516102):0.4412754244,t183:2.280688367):2.068719631):0.5712514692):0.7562159316):0.164711209,(t184:5.576413364,((t185:4.368260515,t186:4.314683378):0.4812679995,(((t187:3.576847677,t188:3.537805334):0.1355273747,(t189:3.184250889,t190:3.100243064):0.1300076797):0.8231421496,(t191:3.395082729,t192:3.383506195):0.284517713):0.08970660265):0.7236234776):0.2218957832):0.2486610447,(t193:3.752926398,(t194:2.689962407,(t195:1.266839938,(t196:0.5758781721,t197:0.438163631):0.6669306629):1.357810554):0.7393327766):0.9004682911):0.2458832563):0.5992267607,((((t198:0.7630413985,t199:0.5221306258):1.316984143,(t200:1.500960293,t201:1.479715913):0.2359524423):2.027672284,(t202:2.77382546,(t203:2.475428781,(((t204:0.828034059,(t205:0.7868551837,t206:0.7691478265):0.02083354928):1.190413694,(t207:1.739717433,t208:1.738813008):0.1495924503):0.2854530055,(t209:1.473387767,(t210:0.833387842,t211:0.8284336781):0.6152545154):0.6245750011):0.09311612386):0.2124863857):0.9085143934):0.06092552037,t212:3.329105579):0.7693659924):0.6075840378):4.88521814,(((t213:2.673278473,(t214:2.274973474,(t215:1.229224222,(t216:0.1859766332,t217:0.1724843316):0.9214915778):1.008903836):0.3727690848):0.5478441156,(((t218:1.28321421,(t219:0.3111872884,t220:0.3065126758):0.9134336574):1.019557487,(t221:0.83697613,(t222:0.1327070193,(t223:0.007079798745,t224:0.001307939662):0.1077899839):0.6361712129):1.34958093):0.4864819021,t225:2.517977831):0.1638777659):2.113893421,((t226:0.7567204488,(t227:0.5340946263,t228:0.4861169077):0.009778077936):1.232011079,(t229:1.525633938,((t230:1.018144761,t231:0.9190763076):0.05579514227,(((t232:0.02345603062,t233:0.009950989955):0.5291588257,t234:0.4872009273):0.07571774946,t236:0.1212917927):0.3022201815):0.3473453178):0.1521111691):2.661427666):4.222015031):2.412139277,(((t237:3.246341861,(((t238:0.4525735436,t239:0.4072029429):0.3532310614,t240:0.6523929702):1.235666702,((t241:1.200018208,((t242:0.6806462604,(t243:0.5671254805,(t244:0.3602879483,t246:0.326391461):0.05600856119):0.05880339147):0.2937247495,t247:0.6389085734):0.1358665814):0.02202029396,t248:0.7236591466):0.6542986953):1.199900848):0.6108662228,((t249:0.2738329158,t250:0.2588993893):0.02662954796,t251:0.2642240192):2.801378997):0.9501517795,((t252:0.9060866613,(((t253:0.1786870938,t254:0.0612898064):0.1360418147,t255:0.1137670742):0.5076638954,t256:0.6149559805):0.0283594287):0.3040480477,(t257:0.5191304054,t258:0.5071788913):0.3126069786):2.800155704):5.205012457):1.95825622):1.004481516,((t259:0.6397530157,t260:0.3671183371):0.3374955387,(t261:0.0690631238,t262:0.02699717229):0.452465344):10.69400794):0.7744103851):0.6110555979):6.020903331):1.418912081,((((t263:11.04660185,((t264:4.404335659,(t265:2.410902564,t266:2.344191213):1.918185113):6.443741734,((((t267:1.356470417,t268:1.284400245):3.758908679,(t269:0.8794924375,(t270:0.1110728999,t271:0.1099226789):0.6392610267):4.045799717):4.277458478,((((((t272:1.334871023,((t273:0.520869322,t274:0.4431034712):0.3074832593,t275:0.2880590792):0.3659599644):0.7758974208,t276:1.34805713):2.100959565,t277:3.394649109):1.936420559,t278:5.289517691):0.5970139321,(t279:3.35469256,t280:3.174759061):2.437024587):1.85333893,(t281:4.434806573,t282:4.321024819):3.019947621):0.2521801489):1.181901682,((t283:7.460747752,t284:7.422658417):0.4696440583,((t285:4.886257362,t286:4.839109384):3.004748495,((t287:7.219394329,(((t288:0.5655478796,t289:0.2525078327):1.317891848,t290:1.396596956):1.963717912,t291:3.360040081):3.342717536):0.5481411892,((t292:0.9830071345,t293:0.6761849491):3.935414258,((t294:3.602941165,(t295:2.187364467,t296:2.025954699):1.169178455):0.9020859779,t297:4.077647735):0.07823469718):2.258592586):0.07011752503):0.001048381738):0.8217359085):0.1136746323):0.1799723154):1.669721431,(t298:3.813811802,t299:3.720077444):5.384531102):0.07367344126,((((t300:1.00250801,t301:0.8109658069):3.808377803,(t302:4.01124427,t303:3.837818666):0.591854363):0.5179750458,t304:4.85913743):1.522213914,t305:6.363189654):2.074968971):0.5368779308,(((t306:1.819508513,t307:1.641416332):2.169169493,t308:3.771693375):3.048001884,((((t309:2.457563467,t310:2.408319328):1.742069665,t311:3.767398433):0.8703715414,(t312:3.381082624,((t313:1.983433459,(t314:0.6600210665,t315:0.2174496123):1.300205031):0.3135914638,t316:1.702584293):0.8443464882):0.8980896587):0.3623837992,(t317:1.421084496,t318:1.355218082):2.299410774):1.224128891):1.547600255):6.601213573):0.4749921827):1.451409102,(((t319:1.26662424,t320:0.9950959833):3.208394938,(t321:3.509269109,t322:3.38938735):0.5915520237):0.5497664,(t323:2.859769029,t324:2.832902024):1.657125212):9.825341063):0.4031790412):0.2724749316,(t325:4.205351167,((t326:0.9804857496,t327:0.7969267048):0.1605371368,t328:0.7868430617):3.022030554):10.7525464):1.519297261,((((((t329:1.293335112,t330:1.233743253):0.1765907232,((t331:0.4289893242,t332:0.4093604781):0.3781676582,t333:0.744875087):0.5742772786):1.924153326,((t334:2.690143825,t335:2.679249767):0.1876602963,(t336:2.00347653,(t337:1.778076449,t338:1.699432902):0.1576956075):0.7904659808):0.3439582166):0.7381407106,((t339:3.372120237,t340:3.369104677):0.1409283978,(((t341:1.528328789,(t342:0.8642858486,t343:0.7450175174):0.5102706616):0.6156071607,((t344:1.039298862,t345:0.9021811584):0.03810593361,t346:0.2146084604):0.5051780798):0.8109606242,t348:1.455328145):0.5183019392):0.1192101827):9.940253637,(((((t349:0.1288139104,t350:0.1143005063):3.256979261,((t351:0.6743864,t352:0.5598862983):0.9568577688,(((t353:0.1624005367,t354:0.1574963583):0.1319710227,t355:0.0934674727):0.07256612364,t356:0.136572796):1.027608761):1.610041895):0.9199918041,((((t357:0.1726996455,t358:0.06264540214):0.324598898,t359:0.318155646):0.8360172151,t360:0.8917648584):1.167971912,t361:1.901234529):1.042771988):5.70892755,((t366:1.017780416,t367:0.918941534):1.119658501,t368:1.982210852):5.632667605):1.241300048,((t369:0.3819631356,t370:0.3250471777):1.822394084,t371:1.806075525):6.63919193):0.6276033715):1.675495445,((((t372:1.639435685,(t373:0.230999707,t374:0.2070080915):1.332703929):2.665021575,t375:4.052133139):0.226614456,t376:4.18828071):5.582213839,t377:9.621198495):0.4964782399):0.1958372233):0.06451657671):0.3968082232):0.1605618789,((((t378:3.55146879,t379:3.544252723):5.338032538,(((t380:2.557586883,t381:2.443723159):0.9721128435,t382:3.395612633):4.421116787,(((t383:5.009575505,(t384:1.151095581,t385:1.057947308):3.780277701):0.1242205143,t386:4.761974826):1.70486827,t387:6.201830304):0.9207981314):0.8777592937):1.652834192,(t388:7.054019338,((t389:5.130487493,t390:5.127327584):1.04980613,t391:6.152667425):0.6392137819):2.264518092):0.3256131626,(t392:7.273788826,t393:7.122003004):1.906894981):0.04594402037):4.89302484):6.463462567,((t394:6.206296842,t395:6.169291058):0.1889863253,t396:6.285601256):13.97276178):11.35811076):46.90479653,(((((t397:2.148242938,((t398:0.2982925021,t399:0.2532090417):0.9624375541,(t400:1.110474393,t401:1.101857851):0.08464219548):0.8497251135):2.078233986,t402:4.100823072):0.5809136838,t403:4.614695095):2.28509054,((t404:4.659374869,t405:4.647749257):0.6374328999,(t406:3.748654121,t407:3.626513148):1.522251387):1.568604054):1.552443384,((((t408:1.328539648,t409:1.285413517):5.373708507,(((((t410:1.897851772,(t411:1.488320455,t412:1.448300565):0.307166444):1.547027641,t413:3.284368745):0.6690018857,t414:3.734304543):2.392985676,t415:6.072236732):0.0732437567,(t416:1.868992213,(t417:1.128367452,t418:1.054378988):0.5730141305):4.202642033):0.01616102361):0.01085984102,(t419:3.412546214,t420:3.370179773):2.322843077):0.6302501586,(((t421:0.9103079521,t422:0.8942714132):4.149798388,(((((t423:1.369289333,t424:1.278106688):1.267788924,t425:2.50522715):0.5391211183,t426:2.956949052):0.1837507468,((t427:1.441238471,t428:1.354814611):1.16666765,t429:2.501481383):0.5255013139):0.8542264346,t430:3.845198208):0.8023479318):0.0189301181,t431:4.622875308):1.229667719):0.8775254554):69.74003522);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T42.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
