<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t486:0.9705745297,(t487:0.6566977362,t488:0.5695839926):0.2580445034):0.7448421474,t489:1.47642095):83.41937325,((((t490:0.3662014798,t491:0.296100865):2.11409648,((t492:0.5330294572,t493:0.204051159):0.4250961618,t494:0.4343442254):1.00335623):0.3180784845,t495:1.684572298):10.11008299,(((t479:0.1145406587,(t452:0.2557337,(t371:0.003495809857,((((t352:0.1064711448,(((((t254:0.2207275921,((t242:0.04465275885,(((((((t139:0.007004839347,(((t107:0.3075471174,(t1:8.543551053,t2:8.534725171):1.313063154):0.6882776784,(t3:10.04173319,((t4:1.296938975,t5:1.07356171):5.717794475,(t6:1.336824983,((t7:0.4415997487,t8:0.3525140934):0.6854462383,t9:1.025231648):0.1032187858):5.322066308):2.922320157):0.488866027):0.2981290855,((t10:0.828950375,t11:0.764332872):8.837755889,(t12:9.444824135,((((t13:0.7958373209,t14:0.6772082807):6.102744987,(t15:0.9821526357,(t16:0.2393115405,t17:0.2050302061):0.6887451322):5.767158243):1.820259002,((t18:0.8339260244,t19:0.6888127365):2.278417809,t20:2.788895872):5.107690736):0.07142847498,t21:7.935574735):0.6229846129):0.05273140079):0.4775032402):2.90155741):0.1717794818,(((((t22:5.151130542,(t23:3.378443133,t24:3.36600504):1.673993766):0.8712823001,t25:5.686004646):3.701337768,(((t26:2.003325552,((t27:0.4406812449,t28:0.3409636684):0.7571266764,t29:1.038506751):0.5947108627):3.017472421,t30:4.640485505):2.599561353,(t31:2.017192301,(t32:1.486455515,t33:1.315032893):0.4229089553):5.190310278):1.712153738):0.345095489,(((t34:5.925929251,t35:5.893384258):1.34109103,t36:7.191855401):0.522314082,((((t37:2.266282187,t38:2.185084482):2.498610716,t39:4.662355688):1.773240959,(t40:4.89900283,(t41:1.985578569,t42:1.396659586):2.90316694):1.501400234):1.149723428,(((t43:2.9501431,(t44:0.6253334792,t45:0.4894916588):2.322416598):2.509307967,(t46:5.079053277,t47:5.058878426):0.1667984667):1.213033878,t48:6.404536741):0.1977570034):0.008467842626):0.8827072727):0.4444746026,(((((t49:0.2799700258,t50:0.2133887146):4.695038537,((t51:0.7757187169,t52:0.6235590414):0.1967959867,t53:0.6554342832):3.473478654):0.1840364563,(t54:2.762945087,(t55:2.281333894,(t56:0.1362239478,t57:0.00156927218):2.130375681):0.3082422267):1.538976363):0.6627809006,t58:4.633218474):0.9718626118,((t59:4.292022845,(t60:3.574510247,t61:3.55784519):0.6754085315):0.9656794201,(((t62:2.607946953,t63:2.58263182):0.06874400534,t64:2.448410708):1.460585939,(t65:3.632283497,(t66:3.507454719,((t67:1.337682314,t68:1.270210632):2.01738495,((t69:1.922774347,t70:1.916140577):0.1992174156,t71:2.111972469):1.050599851):0.1283432267):0.04585932477):0.2066776248):1.03019298):0.2966645747):0.8636890389):1.434840016):0.8904438258,(((t72:1.961857908,t73:1.883499353):3.195550175,(((t74:2.511802166,(t75:1.004556514,t76:0.8769748734):1.499197139):0.6132323453,(t77:1.677024026,(t78:1.280636484,t79:1.22309455):0.1890004397):1.256705991):0.124465693,(t80:1.796623343,(t81:0.9447743313,t82:0.9442399807):0.8419914249):0.8904550294):1.787422737):1.758094496,((t83:2.361724052,(t84:2.16724886,((t85:1.274266838,(t86:0.8042214244,t87:0.764775883):0.3033002341):0.8118372026,t88:1.849984927):0.07609022883):0.07271039312):0.411397605,t89:2.374983423):3.43119154):0.9318948452):5.557534576,((((t90:1.564465051,t91:1.552479686):0.4679406902,(t92:0.6614476876,t93:0.6072265842):1.330627716):0.7076274356,t94:2.58886725):0.2428183993,((((t95:1.701956888,t96:1.611341485):0.5681846948,t97:2.107477244):0.2048172996,((t98:1.40974044,t99:1.298987677):0.262888087,(t100:0.4287718342,t101:0.3428368143):0.97581799):0.585643333):0.2687371863,((t102:1.039388731,t103:0.9757805475):1.011467922,(t104:1.408585104,(((t105:0.4696402931,t106:0.4206709507):0.2867898933,t108:0.2130429084):0.3133928523,t109:0.5198204624):0.1994698946):0.34312368):0.08257966074):0.08720952049):9.207604507):0.6998036575,(((t110:0.3642465102,t111:0.3446558093):0.3839737398,t112:0.7003504168):0.009949545871,t113:0.6628030655):10.3611742):0.8341726407,(t114:5.758765217,((t115:0.9861844783,((t116:0.5362777548,(t117:0.3345231235,t118:0.3166315997):0.1644957785):0.05115664178,t119:0.1738765426):0.390477296):0.7752938142,((t120:0.1080943884,t121:0.03978229337):0.4563199562,t122:0.4178589348):0.6605583969):3.955682484):5.940679818):0.2804640948,t123:10.73157562):0.979550795):0.0885430374,(((((t124:0.7983564514,(t125:0.6097763112,(t126:0.4056761592,t127:0.1310773903):0.0442256745):0.1077385328):0.6819672048,t128:0.5115917369):3.520134939,t129:3.790394366):1.383796202,(((t130:1.54676605,t131:1.53787407):1.150207934,t132:2.336186859):0.6778631894,((t133:0.4074684763,t134:0.3959415387):1.943971629,t135:2.19018909):0.6139650361):1.770515907):4.076926332,(t136:1.601367897,t137:1.541889726):7.020077312):1.132812033):1.514703355):1.401233867,(((t138:4.613208779,t140:4.51683666):4.343571632,((t141:6.75848078,(t142:3.551096928,(t143:2.140825158,(t144:0.859324286,t145:0.8211647959):0.8314089058):1.405833614):3.199969939):1.615808154,(t146:2.603320816,t147:2.47903953):4.884806584):0.4548136636):0.7613986263,((((t148:3.565399896,t149:3.471983297):1.474788318,t150:4.941611616):0.3879155738,((t151:2.011474493,t152:1.94378252):2.357608452,t153:4.199982524):0.9540007898):1.620714563,(t154:6.552200996,(t155:6.176558021,t156:6.141146257):0.3521646279):0.1911102656):1.499463474):2.724047567):3.724108379,(((t157:8.458147674,((((((((t158:1.785428036,(t159:0.7695304328,t160:0.7300128737):0.9512615995):1.010805002,t161:2.665568614):4.039456356,((t162:0.4726401893,t163:0.3950063572):4.463259355,t164:4.674108977):1.662924026):0.5409954856,t165:6.812706494):0.5825303985,((t166:6.427414033,(t167:5.880406734,(t168:5.612188016,(t169:2.373040151,(t170:1.847946328,t171:1.693971598):0.5114594019):3.143950687):0.1907171031):0.5010104309):0.8545162841,(t172:5.168600255,t173:5.129226217):1.689019357):0.08776030532):0.07793410655,(t174:6.039691761,((t175:4.443824952,t176:4.381934737):0.6317181048,t177:4.927466488):0.755292583):0.8898278964):0.007922171675,((((t178:2.15089044,t179:2.082591672):1.043371214,t180:3.091826913):1.537710671,t181:4.624442947):0.1112503239,((t182:1.389279314,t183:1.327607145):0.5418837632,t184:1.858361876):2.795428517):1.664497137):0.06829989094,((t185:5.788039562,(((t186:3.011946867,t187:2.902517331):1.897202626,(t188:1.214796546,t189:1.129526165):3.536118133):0.2257720933,(t190:4.659373975,t191:4.612324229):0.1793815041):0.6414532591):0.2430370558,((t192:2.556449494,(t193:0.768853862,t194:0.6596680956):1.605955601):1.31612924,(t195:2.572924573,t196:2.440933866):0.8886250469):1.588819436):0.2952391877):0.28243081):2.700022833,((((((t197:0.3484563923,t198:0.3435403581):0.9145024842,t199:1.244076936):2.161796798,(t200:3.11314483,t201:3.081145768):0.2540162689):0.3080150165,t202:3.193233951):0.7004839751,(t203:2.710573219,t204:2.634995938):1.125190538):2.315747178,((((t205:3.148521532,((t206:2.372621742,t207:2.280626906):0.6848693616,(t208:0.6290512655,t209:0.4532204598):2.329416014):0.06096544372):1.310911287,t210:3.97992717):0.2105338605,((t211:2.996123216,(t212:1.307270171,t213:1.193987457):1.603129457):0.04451375983,t214:2.736442806):1.04895517):1.370490569,t215:5.076462996):0.02128109191):1.323667161):1.168542994,((((t216:2.581036804,(t217:0.9939371807,t218:0.9821381889):1.444597529):0.8055752453,(((((t219:0.8248033321,(t220:0.3513312116,(t221:0.1823660751,t222:0.01325497369):0.1016911425):0.3251582368):1.40525706,(t223:0.1218533461,t224:0.1029669946):1.655409328):0.05126567103,(t225:0.7877585999,t226:0.3346458607):0.6506540998):0.1257833198,(t227:0.09096250941,t228:0.07461606783):0.5689524722):0.3915606139,(t229:0.92745344,((t230:0.4561643327,((t231:0.1223769363,t232:0.08307445589):0.2078322203,t233:0.2806563928):0.0613915269):0.3548144384,t234:0.6449484485):0.01445004522):0.06416613422):0.3970790117):0.8409059639,(t235:1.322676615,((t236:0.7585712576,t237:0.7133264293):0.006315392117,(t238:0.07789623821,t239:0.03695627386):0.3681571782):0.4896823671):0.6259363131):1.875740025,(t240:0.3336313999,t241:0.09517749017):3.048143629):1.449928708):2.303113737):0.9270839344,(((((t243:1.070981671,t244:0.9878821498):0.05281141806,t245:1.022075335):0.04288586551,t246:0.668826828):4.48273029,((t247:3.410984864,(t248:1.094291982,(t249:0.9101281853,(t250:0.06729776053,t251:0.04524751067):0.7126109457):0.08551591409):2.176797852):0.1647772295,(t252:0.2354209643,t253:0.2182741399):2.780590969):1.471884365):1.720618071,t255:5.823159506):0.09471105547):2.096812608,t256:7.887391008):1.333468433):0.6025127081,(t257:6.550748141,(((t258:0.2935566437,t259:0.249930007):0.2516410736,(t260:0.1848989454,t261:0.1789485671):0.2655519788):0.6723789362,t262:1.031509231):5.255621514):3.153752431):0.003420719687,(((t263:0.170135717,t264:0.1635016381):0.01771364052,t265:0.1005256109):7.432446505,(t266:3.824901068,(t267:2.890403482,t268:2.791478981):0.9269082129):3.656602009):1.771973192):0.4694443701,(t269:9.172925833,((t270:0.7567648428,t271:0.7319470799):6.487138789,((t272:0.4728039572,t273:0.4604755709):1.51040823,t274:1.257119226):5.136833972):1.901593945):0.3725510002):1.043851449):6.55805245):2.205756797):12.62283714,((((((((((t275:7.013861077,((t276:1.020414565,t277:0.9613235327):5.711548934,((t278:6.158742131,t279:6.145150003):0.02837454749,(((t280:0.6424858227,t281:0.3423107505):0.3044972989,t282:0.5687649228):2.636750019,(t283:1.471464071,t284:1.45212446):1.701916452):2.58340743):0.4808575289):0.2735564162):0.4177120327,(((t285:1.711465904,t286:1.550329448):1.482797843,t287:2.872936202):2.661665989,t288:5.428512252):1.009491616):0.9250953105,((((t289:1.62707909,t290:1.620820397):1.608326337,t291:3.200597886):3.447006015,t292:6.282019065):0.1197440758,(t293:1.408301127,t294:0.6703795716):4.966648857):0.5408918921):0.05340887785,(((t295:2.156154895,t296:1.846019088):3.119392488,(t297:2.713291576,(t298:0.7194219166,t299:0.6094011036):1.973529311):2.208885695):0.8414729215,((t300:4.138938472,(t301:3.872504015,(t302:2.475320329,t303:2.437878845):1.323201878):0.2574292626):0.005488257182,t304:4.014923365):1.465135018):0.1036826396):0.4243403485,t305:5.815178535):0.9426493523,((t306:3.489819454,t307:3.346278463):3.065617939,((t308:2.072216186,t309:1.92574952):1.861131298,t310:3.730552359):2.459345145):0.1770009402):9.124285081,((((((((t311:2.649261667,(t312:2.205163575,t313:2.045972305):0.4134814176):0.6070884205,(t314:1.753388445,t315:1.665560153):1.295106959):0.6426494162,t316:3.584249863):0.03283427251,(((t317:2.465173897,(t318:2.042708967,t319:1.805468326):0.4220388894):0.5342154038,t320:2.556826006):0.3776269775,(t321:1.298452898,t322:1.161432053):1.624444901):0.1765228498):1.931268976,t323:4.812394131):0.6220635086,(((t324:2.614565346,(t325:0.8449247972,t326:0.7886768886):1.741459975):0.2089964013,(t327:1.808642436,t328:1.735707717):0.8746120059):0.2191717325,(t329:1.101425299,t330:1.064891262):1.656024019):2.300227811):5.196879863,(((((t331:0.5342978095,t332:0.5091502024):3.180454485,(t333:1.332148691,t334:1.290282148):2.300001049):0.03743233784,((t335:1.083325876,t336:0.9444509295):2.486758478,t337:3.350006589):0.03833361828):0.4755774573,(((t338:1.685540787,t339:1.636444457):0.07363560092,t340:1.65400039):0.8241589602,t341:2.419938124):1.252860847):3.509953319,((t342:1.571934094,(t343:0.4079926637,t344:0.3927072305):1.011622276):1.00670162,((((t345:0.6361964346,t346:0.6232545153):0.8393011127,(t347:0.5808933977,t348:0.3781052133):0.8586899161):0.3923899305,((t349:0.7780199387,t350:0.5304480354):0.1150049574,t351:0.5255350087):0.01381053501):0.2108917282,t353:0.5836561623):0.2217323013):4.529386991):2.466211071):1.550491705,(((t354:1.739069228,((t355:0.4372884744,t356:0.3596760399):1.105469027,(t357:0.8307917506,t358:0.8301953754):0.6145827814):0.1686779088):0.5328227503,(t359:0.6820286582,t360:0.6442366596):1.391455131):1.412063782,(((t361:0.3158064799,t362:0.2866702292):1.884524359,(((((t363:0.2569336416,t364:0.2569152666):0.1274550593,t365:0.1138084879):0.5614517803,t366:0.3201077218):0.5301390351,t367:0.7797292775):0.01235582629,t368:0.4999874379):0.4049170596):0.2843979032,t369:1.094561037):0.9289026215):5.632159948):1.951485111):1.60310771,(((((((t370:0.7368448602,t372:0.3993968909):1.668521035,(t373:0.8568134737,(t374:0.22670381,t375:0.1969204391):0.5877052709):1.198785502):5.755687009,t376:7.514135065):0.3929732151,(((t377:1.017758232,t378:0.9635870617):1.077743226,(t379:0.0684277138,t380:0.01288359727):1.961849286):3.717804898,t381:5.340430389):2.009341695):1.047175566,((t382:3.89077404,t383:3.666982683):2.856798888,((t384:1.53731241,(t385:0.140996635,(t386:0.1212001678,t387:0.06763451751):0.00595236183):1.390596486):2.247019171,t388:3.684785322):2.731827045):1.538545248):0.4908057469,((((t389:0.305625621,(t390:0.03548104227,t391:0.01324465736):0.246421953):2.554255775,t392:2.731642594):2.229433153,t393:4.951568021):2.404193262,t394:7.345453445):0.9523859238):0.851388255,(t395:7.446590901,((t396:1.13604989,t397:1.061308109):5.757630389,t398:6.746269515):0.4864927094):1.153601414):0.1901317357):0.6099764102,(t399:8.078639392,((t400:4.613867603,(t401:3.147790634,(t402:0.5715935576,t403:0.5526246342):2.51106837):1.416204248):1.990525456,(t404:5.990904364,(t405:5.729813833,t406:5.717645763):0.2413943663):0.2910128721):1.279019886):0.8942054252):1.436360572,((((((t407:0.569374753,t408:0.5237554911):1.516864852,(((t409:1.539733146,t410:1.50103932):0.2849550584,t411:1.673770591):0.02938330246,t412:1.693574528):0.1639747969):5.400117202,((t413:6.297229264,((t414:1.398087324,t415:1.349363903):4.604726164,t416:5.946133791):0.2608341647):0.5980995507,(t417:6.427829917,(((t418:4.166092439,((t419:0.3049268694,t420:0.2960148518):3.476608163,t421:3.701007179):0.3706148519):0.7489618584,t422:4.707141814):1.457626642,((t423:6.010324239,t424:5.93507105):0.07917748704,(t425:0.3221315037,t426:0.1216619777):5.61391755):0.03339837151):0.03570162838):0.3266570381):0.2969472328):0.4569145293,(((t427:3.184932998,t428:3.162905416):2.582535748,(t429:5.683109035,((t430:3.848294977,((t431:1.491527259,t432:1.200263631):0.309473148,t433:1.433414298):1.976305707):0.8182473018,t434:4.186621934):0.9838716832):0.03702284296):0.7701839663,(((t435:5.223126222,((t436:0.3723808313,t437:0.03481544978):1.664119978,t438:1.679406857):3.026910614):0.5904671352,(t439:4.684842409,((t440:4.064996384,t441:3.983012049):0.4377471252,((t442:3.115647113,(t443:0.3352675078,t444:0.176441973):2.718098067):1.258683379,(t445:1.869590383,(t446:1.764065904,t447:1.74898379):0.03067941423):1.97866975):0.01469215543):0.09766960733):0.5762096683):0.03161342333,((t448:0.504009047,t449:0.4988022041):3.83427809,(t450:2.614274004,(t451:1.36259321,t453:0.819760555):1.244989864):1.696160689):0.0538722461):0.07330217797):0.3467850891):0.1282768628,((t454:3.137782995,((t455:2.656525847,(t456:2.282408005,t457:2.095150778):0.3526515835):0.2575079665,t458:2.696235876):0.2182857934):0.90816814,(((((t459:2.032560721,(t460:1.389205013,t461:1.364793633):0.2800296299):0.06764529186,t462:1.708184127):0.1959776435,t463:1.889674882):0.2186202534,(t464:0.9988910165,(t465:0.9029036084,(t466:0.5682497139,t467:0.4207128173):0.07750832763):0.007996038163):1.027106718):1.121216202,(t468:2.069957476,((t469:0.8577591672,(t470:0.6919911589,t471:0.6362753205):0.1528530131):1.165922795,(t472:1.460702986,t473:1.446381216):0.4537786281):0.02822899041):0.5703478712):0.04400387701):0.2444735967):1.371330197,((((t474:0.5366530947,t475:0.4979655326):0.9383722921,(t476:0.02764227025,t477:0.01158275891):1.352858679):0.5923647818,t478:1.862043257):0.1159265297,(t480:0.8429976672,t481:0.6573829244):0.8117502338):1.93613163):0.3866134531):8.530443911):1.162005537,(t482:12.76376614,(t483:1.903949517,(t484:0.9249424929,t485:0.8354728985):0.9208019306):10.67491439):0.3819897551):0.5987370569):71.74683452);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T59.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
