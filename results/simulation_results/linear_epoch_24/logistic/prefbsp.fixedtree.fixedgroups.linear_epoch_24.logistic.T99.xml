<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t471:0.406677419,t473:0.2187393147):0.3848116199,t474:0.5188436842):26.87969659,(t475:13.0095074,(t476:2.241427069,((t478:0.2338425984,(t477:0.07646078941,(t472:0.1497009743,((t443:0.06576995677,(((t339:0.05848445063,((t329:0.06197808587,((t323:0.2163259067,(t321:0.4333337422,((t313:0.007611971556,(t282:0.1417083667,(t252:0.08215065811,(((t235:0.07025570628,(t234:0.07125347263,(((t225:0.3749351692,t226:0.1801735791):0.06328914864,(t218:0.144584464,((t137:0.1517555898,(((t98:0.4485856744,(((t24:0.274666849,(t5:0.0026306576,t1:0.8651873647):1.889784409):4.791819128,((t2:2.133612372,t3:2.11089451):4.293456439,(t4:4.398749177,t6:3.95291788):1.707010411):0.7262537919):1.80313437,t7:8.101308196):0.2448406103):0.7974300241,(t8:4.562779245,t9:4.518622865):4.560698254):0.1633631607,(((((t10:0.4595456223,t11:0.4437065741):0.823414698,t12:1.24618573):6.403561548,(t13:5.348329646,(t14:1.76440984,t15:1.692335479):3.570323643):2.268082944):0.7296894194,(t16:0.2330493996,t17:0.2314766318):8.008091423):0.6661370197,((((t18:0.3291548151,t19:0.229082122):0.4940400072,t20:0.7213915092):3.443972418,((((t21:0.3841795269,t22:0.2079660673):1.414174384,t23:1.519138081):1.285121365,t25:2.469011866):0.3869535731,t26:2.839690177):0.1450614698):4.578103821,t27:7.426138406):0.05903967199):0.1464804274):2.968240234):7.821091409,(((((t28:6.552942236,((t29:0.2763080501,t30:0.2567835191):1.380327123,(t31:0.3730047929,t32:0.2480691375):1.262823027):4.774514984):1.125508516,(t33:7.01521253,(((((t34:0.2938998921,t35:0.09700714489):4.853893697,t36:4.917497413):1.540750122,(t37:1.775789104,(t38:0.08324256478,t39:0.0547146046):1.500911544):4.670621204):0.05515041646,(t40:5.659029814,t41:5.655367242):0.6107444457):0.1336549431,t42:5.978003844):0.09274011797):0.386273374):2.75146901,(t43:5.08217456,t44:5.036167283):4.104945469):5.359477692,t45:14.48392486):1.0482331,((t46:5.530678585,(t47:4.124176145,t48:3.910099774):1.212422114):1.254064337,((((((t49:3.305012796,(t50:2.104250053,t51:2.098518118):0.90506351):0.7528585278,(t52:3.383538267,t53:3.357851786):0.2697725816):0.243460169,(t54:2.22927201,t55:2.224754271):1.509694939):0.8291883572,t56:4.465940661):0.09400451402,t57:4.475718648):0.6001216749,(((t58:4.372271727,(t59:4.234524344,t60:4.173136317):0.07286172335):0.2391586476,(t61:2.453216835,t62:2.368437761):1.911023527):0.3159212712,((t63:3.709422185,t64:3.691585595):0.4096124156,(t65:3.881469222,t66:3.749199209):0.1080561936):0.4385196212):0.1214850097):0.4919479698):8.713532148):1.484658686):0.00961895988):0.9403197353):0.6216737819,(((((((t67:3.727279463,t68:3.703663936):0.1142658064,((t69:2.365885948,t70:2.277654503):0.813265758,(t71:2.739227225,t72:2.662127663):0.3169698541):0.5759608334):0.03848222382,t73:3.376238869):0.3457410021,(t74:2.141278567,t75:2.133323463):1.529359003):0.4796697973,((t76:1.957074264,t77:1.92434869):0.1017805784,t78:1.711732974):1.877398985):1.435218578,((t79:1.875230275,t80:1.825329737):1.00055538,(t81:2.415190663,(t82:2.393386801,((t83:1.134019571,t84:1.106901627):0.1418206733,t85:1.192059369):1.10924111):0.01782645236):0.1381216287):1.908608838):2.803978824,(((((t86:1.123504499,t87:0.992217969):0.9926939539,t88:1.959555909):0.3135166105,(t89:1.55550151,(t90:1.098585466,t91:1.091628555):0.4419011682):0.709121768):0.3485929712,t92:2.496914521):1.81703687,(((((t93:0.7673493842,t94:0.7295668623):0.4653542782,(t95:0.6212827962,t96:0.4856267989):0.4291727684):1.720012854,t97:2.631536062):0.2930964888,(t99:0.688261914,t100:0.6739307585):1.292297005):0.835259477,((((t101:1.108216019,(t102:0.2088472241,t103:0.1818640714):0.8663206152):0.6993222421,((t104:0.6585445953,((((t105:0.08985172299,t106:0.0296766124):0.009860091864,t107:0.009027615149):0.2544448019,t108:0.24567511):0.0273493929,t109:0.2270014558):0.2762257487):0.5865327192,(t110:0.3687917686,t111:0.2411001593):0.675136839):0.4727978664):0.3359893643,((t112:0.7186494664,t113:0.5763233787):0.5399293352,t114:1.032146144):0.3611563775):0.4581671646,((t115:1.017865697,t116:0.7756313532):0.4628932487,((t117:0.7097702323,t118:0.2413694131):0.4341233445,t119:0.1633080534):0.0511485594):0.2336259204):0.1574012804):0.01817724434):2.564930334):7.660612588):0.1658740983):0.1296651112):0.3984808445,(t120:0.8028058684,t121:0.793195452):10.59924017):0.1291142108,((((((t122:0.1712924316,t123:0.1304050595):1.231368252,t124:1.250301171):7.459982472,(t125:1.539397383,((t126:0.7503272382,t127:0.7294008828):0.5159528513,t128:1.158828089):0.08335188306):7.141499636):2.10649001,((((t129:1.310359168,t130:1.309318683):4.223969385,(t131:1.213834162,t132:1.137498856):4.310038236):4.287251592,((((t133:0.07810686938,t134:0.01247982531):8.121400245,(t135:7.862750263,(t136:7.214561987,((t138:2.600131736,t139:2.59080395):0.4480831938,t140:2.835212062):3.895958471):0.56319471):0.2424579048):1.218301962,(t141:3.399581992,t142:3.170016789):4.970000258):0.1490181186,(t143:3.580220316,((t144:1.264925634,t145:1.140399295):0.867385463,t146:1.98849994):1.290771779):4.617294141):0.02398526724):0.2222337238,(((t147:3.55427298,(t148:2.980946914,t149:2.673317922):0.531822611):1.541801291,t150:4.615536184):1.269924905,(t151:1.525834831,t152:1.485738884):4.308204549):1.398220669):0.2489419715):0.2497560603,t153:7.522686879):0.1760389522,(((((t154:4.213669963,(t155:3.150036403,t156:3.03182001):0.9236584568):0.1635935692,t157:4.113752243):1.035864365,(((t158:3.553436373,t159:3.529770854):0.3750439257,t160:3.832836528):0.4922964975,t161:4.213606967):0.7151563821):0.4993888248,t162:5.417492366):0.9534997912,t163:6.297882732):0.775567268):0.1109927091):1.527235315):3.252168336):3.549042687):0.005327095665,((((((t164:4.660556499,((((t165:0.4091132663,t166:0.3969160945):1.834556013,t167:2.197281043):0.1795546592,t168:2.316066408):1.848459583,t169:4.054833591):0.3047919651):1.203239655,((t170:5.089196166,t171:5.051065385):0.124928645,((t172:3.149887215,t173:2.986822588):1.518184954,t174:4.497300892):0.2388099504):0.3412928203):1.023011578,((t175:5.126684054,(t176:4.942829869,((t177:1.190840102,t178:1.130846856):2.476003868,(t179:1.095697071,t180:1.046452303):2.439610347):1.257432889):0.1131623417):0.3863380439,(t181:4.402285789,(((((t182:2.187912962,t183:2.103225473):0.1618666324,t184:2.196319332):0.8410769977,t185:3.0340523):1.116839135,t186:3.809382608):0.08274373007,((t187:3.623086027,((t188:2.750839419,t189:2.623370062):0.5068793212,t190:3.118127972):0.05322076364):0.02992643908,t191:3.039850366):0.1642640109):0.003067435006):0.8194010714):0.4456745021):0.05152138731,(((t192:1.709970359,t193:1.619380423):0.8058328188,(t194:0.8714781776,t195:0.8307027463):1.43803692):0.4998802481,(t196:1.896517555,t197:1.776446245):0.8503963352):1.498130233):0.01790631006,(((t198:1.759377207,(t199:1.051345858,t200:1.014702932):0.4521151959):0.7567504482,t201:2.163162516):0.3417153477,t202:2.394873952):1.272519092):7.405828918,((t203:2.633591397,(t204:2.578212889,(t205:1.167689879,t206:1.153407306):1.384694394):0.04767901264):1.7422656,(((t207:2.201637157,((t208:0.6196286848,t209:0.5263888153):0.1044882947,t210:0.6300904633):1.245941758):1.230770287,((t211:0.4639523924,t212:0.4007987995):2.268877818,((t213:1.437023661,t214:1.319206797):0.6449794037,t215:1.933352744):0.3256163205):0.2163982763):0.1990244324,((((t216:0.4063099863,t217:0.2618073503):0.2777542146,t219:0.3725741173):0.8545741401,(t220:1.12887194,t221:0.8987683031):0.0393249333):0.4192703736,(t222:1.13056221,((t223:0.335293938,t224:0.3147205925):0.3299541694,t227:0.129196258):0.310099794):0.2070276381):0.6652045633):0.6087053054):6.661194113):1.130884584):1.348587029):0.3039255998):0.1942821208,((t228:2.358625648,(((t229:0.4470140969,t230:0.4020098464):0.1129447174,t231:0.4126388804):1.267370917,t232:1.546209767):0.4838044096):2.287673872,(t233:1.331791686,((t236:0.1229586404,t237:0.1113830049):0.3095340553,t238:0.4113067839):0.4108491057):2.843291424):6.839879021):0.1822717437):0.1061902729,((t239:1.841335436,t240:1.716525589):8.503303902,((t241:0.6826188912,t242:0.5225604515):4.91598964,(t243:3.478064619,t244:3.307998303):1.947392907):4.311617444):0.3837564147):1.020753961):0.274101504,((t245:8.09922242,((t246:0.2952231215,t247:0.0806467542):0.06799578677,t248:0.02440884156):7.690240055):2.347216067,((t249:0.2462032834,t250:0.07606594786):1.044953116,t251:1.027736102):8.584617874):0.7155973955):2.250557608,((((((t253:0.2522322062,t254:0.2115918906):4.719638018,(t255:2.759443097,t256:2.749441623):2.042645207):4.724798074,(t257:8.61042435,(t258:4.760965038,t259:4.451028271):3.847828869):0.87607832):0.2470018678,((t260:7.076886547,((t261:6.121041994,t262:6.047221353):0.3389635599,(t263:5.759871713,(t264:0.7656460257,t265:0.6246265598):4.825039098):0.5835983781):0.6159528684):1.203019962,(t266:2.242576256,t267:2.006621743):5.516596682):0.8912791473):0.1155236194,(((t268:7.584471783,(t269:4.636922619,t270:4.574213758):2.94612086):0.2376698122,(t271:6.797523296,(t272:3.236734289,(t273:1.874098245,t274:1.624381763):1.169650605):3.50068445):0.9256759056):0.1554422992,(t275:1.069246378,t276:1.01598571):6.269053618):0.4949333577):1.691766643,(((t277:6.501669463,(((t278:4.888980355,t279:4.735444523):1.232193628,t280:5.813081471):0.1207339138,(((t281:4.361018238,t283:3.958581639):1.002379258,t284:4.592773049):0.4680955986,(t285:3.549965365,(t286:0.9914806224,t287:0.9889455591):2.55139906):1.458798564):0.02473333196):0.1832127815):0.3440511739,((t288:3.330476617,(t289:3.18462649,(t290:1.057034831,t291:1.035225237):1.904483536):0.1119860964):1.937135749,((t292:3.625864624,t293:3.539399551):0.7870477213,(t294:3.162103371,t295:3.096394211):0.8789284318):0.495088845):0.1633862658):0.671190695,((t296:4.182537289,((t297:2.469712596,t298:2.44735607):1.20812121,(t299:3.498740955,t300:3.380545656):0.127221246):0.4604814582):0.002558091928,t301:3.212666966):1.073225023):1.90850947):0.5614542114):6.658330855):1.529749059,((((t302:1.79433524,t303:1.673173762):3.605376911,(((t304:2.068338677,t305:2.035661435):0.7756215305,t306:2.730782154):0.9891361496,((t307:2.294827112,t308:2.280015484):0.3895804291,(t309:2.632333342,((t310:0.8962998106,t311:0.7996887709):1.035725214,((t312:0.9495139209,t314:0.6128116556):0.7824887629,t315:1.3457047):0.0126370979):0.6934840466):0.002200473476):1.014219735):1.160574779):0.4364491282,(t316:2.67490087,(t317:0.3281868263,t318:0.2571341306):2.186574329):1.855373777):4.481276504,(((t319:4.04244276,((t320:1.470103907,(t322:0.5163389348,t324:0.1649447406):0.2669601602):0.8313629448,((t325:0.1978148939,t326:0.1409335411):0.2578831847,t327:0.3709093068):0.7702182584):1.730031675):0.8770194025,t328:3.715427746):2.003646125,((((t330:0.2760297999,t331:0.2697900905):1.210652257,(t332:0.5620289508,(t333:0.2672946115,(t334:0.08903273345,t335:0.08840479805):0.08692334788):0.1418732252):0.7714786836):0.7613403367,((t336:0.6369221472,t337:0.6151354556):1.063032372,((t338:1.032430946,t340:0.7653132277):0.0668298529,(t341:0.6377926497,t342:0.5614546747):0.08135814976):0.1971957314):0.129218725):0.2557019017,t343:0.8126539811):2.973944446):1.747956162):4.465907129):1.238896573):0.236007897):0.3046990518):0.6766610656,((t344:10.01145692,(t345:9.501474738,t346:9.322305276):0.504548167):1.733896364,(t347:10.44419192,(((((t348:0.6031382948,t349:0.3676144865):7.699507939,((t350:0.3704248722,t351:0.3370418879):0.2582130702,t352:0.5948384171):7.343860226):1.278704547,(((t353:1.015930213,t354:1.015442755):6.060808025,(t355:5.604506876,t356:5.555184009):1.294972389):1.384683124,((t357:4.956501107,(t358:3.297990365,(t359:0.06911235006,t360:0.024679703):3.215375263):1.5841092):1.219805257,(t361:2.575997786,(t362:1.208545197,t363:1.073314316):1.28012113):3.409958565):1.751937261):0.6876030261):0.4824310299,((((t364:5.033659821,t365:4.912957606):2.169692916,((t366:2.860367062,t367:2.839786976):3.615766076,t368:6.412988902):0.5272070855):0.7989040774,(t369:3.073653765,t370:2.933210957):4.650608994):0.4213559679,(((t371:2.952131136,t372:2.78985568):3.353819227,(t373:1.488944768,t374:1.300734343):4.518783927):1.459898597,((t375:6.312933228,((t376:4.278354101,(t377:4.017541631,(t378:2.244884839,((t379:1.669215677,t380:1.447438249):0.5199423634,(t381:1.548823286,t382:1.429382606):0.3580818452):0.03250240232):1.738909952):0.2231041157):0.836269523,(t383:0.6065472904,t384:0.540832668):4.003750865):1.120139976):0.406987988,(t385:5.195937419,t386:5.194062395):0.4481218127):0.4329928721):0.1270997908):0.125215927):0.1622669424,(t387:5.225386824,(t388:3.647154233,t389:3.642872831):1.53693797):1.194286711):0.02783616648):1.085114795):0.6861234568):1.128829143):10.7569763):14.38615897):8.245901349,(((((((t390:4.61658959,t391:4.549358824):1.982510334,((((t392:2.738299373,t393:2.68702221):2.307722357,t394:4.888197663):1.023061627,(((t395:2.176214285,t396:2.164789786):2.280868677,(t397:1.286822423,t398:1.239470181):3.121814375):1.226992869,((t399:4.945572515,(t400:4.593185829,(((t401:1.576469314,t402:1.512378998):2.578710301,t403:4.079925341):0.1556567108,t404:4.153822876):0.2612456706):0.2454684868):0.5119260945,t405:4.952656685):0.06176800742):0.2130893769):0.1782615728,(((t406:0.0376206606,t407:0.03025623759):1.610397338,t408:1.596977382):0.3994704368,(t409:0.9251447148,(t410:0.6727366914,t411:0.6558515286):0.0821233838):1.06637325):3.164673039):0.2782537975):0.7867409725,(t412:5.475301551,(t413:5.17383194,((t414:2.08355872,t415:2.018389102):1.864056047,t416:3.812796809):1.124588288):0.2885562734):0.5541347198):0.3553334269,(((t417:4.254864632,(((t418:0.9542426088,t419:0.8926926887):2.297400211,(t420:2.531898935,t421:2.461643812):0.46209433):0.7607174489,(((t422:2.050872443,t423:1.987224044):1.054464804,(t424:2.212416442,(t425:1.584975265,t426:1.504552157):0.5763491118):0.7767878217):0.09329796904,t427:2.857452372):0.4711095809):0.06154595262):0.32165083,(t428:2.94629105,((((t429:1.026424006,(t430:0.9559112571,t431:0.8682931697):0.04333174163):0.9080205488,t432:1.810275069):0.6708568395,((t433:1.280541025,t434:1.254317714):0.9796340572,t435:2.110597517):0.08018912772):0.001512091775,(t436:1.142663212,t437:1.026848914):0.9140294494):0.2866050255):0.7356243565):0.9717468765,((t438:1.175968246,t439:1.034742964):2.052963533,((((t440:0.5731406847,t441:0.4960886442):0.2348211667,t442:0.6722185519):0.4498615692,t444:0.8612957204):1.022701205,t445:1.818230955):0.6221901832):0.5933757718):0.5261546868):0.2542203887,(((t446:0.9960232808,t447:0.9670545102):0.3889901434,t448:1.097662263):1.57148357,((((t449:0.7181689969,(t450:0.6514856008,((t451:0.347876836,t452:0.1117243514):0.08902451868,t453:0.1585567454):0.1387618532):0.04321880438):0.7718628567,(t454:0.620099435,t455:0.488707473):0.4815069724):0.3012792371,(t456:0.1129200073,t457:0.1110397583):1.154284181):0.07486725308,t458:1.308460789):0.1107574086):0.8315955073):9.541538074,(((t459:0.01822473829,t460:0.01581364333):0.7952661781,(t461:0.2154430621,t462:0.04420626715):0.5304123177):0.1722533685,(t463:0.4215613547,t464:0.4023428326):0.3221599404):10.78898506):13.88541714,((t465:2.118840772,t466:2.027795481):10.96816548,(t467:1.311065204,(t468:0.7598440422,(t469:0.6160512894,t470:0.4196746695):0.03338889659):0.5436059593):11.54537637):12.28145165):11.19433781);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T99.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
