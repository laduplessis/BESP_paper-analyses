<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t454:0.6223010156,t455:0.4903315386):0.7903768256,(t456:0.5518942252,t457:0.4826579448):0.4783737054):2.176038261,(t458:0.6566317934,t459:0.5957234628):2.473727039):8.863582148,(((t460:0.1935933886,t461:0.05781374845):0.8767740021,t462:0.7690851655):1.358075119,(t463:1.390115474,t464:1.331377908):0.6784632168):9.502398125):13.95936989,(((t465:0.5491617583,t466:0.3276404776):1.332983073,(t467:0.246040379,t468:0.1858482401):1.405375206):19.42460146,((((t469:0.4667245405,t470:0.4192290925):11.71694287,(t471:11.95370339,((t472:1.618849642,(((t453:0.05630996272,(t377:0.0907928258,(((t373:0.1198398285,(t371:0.2763433146,(t372:0.08419794527,(t367:0.001830968148,(t363:0.1014309674,(t355:0.06084547142,(t351:0.29619641,(((t298:0.05651907711,(t293:0.1586160461,(t280:0.07968167515,(t276:0.2499534229,((t261:0.02625127677,((((t114:0.04059660859,(t105:0.1599193818,(((t94:0.103993932,t95:0.09682984901):0.01920798315,(t88:0.07391727225,(t84:0.01998856405,(t82:0.0843993392,(t77:0.045464868,(t71:0.001426481465,(t19:0.01523010777,(t12:0.006120897449,t1:1.274173101):0.5364789363):6.500905466):0.2562020244):0.4228537489):0.3305592987):0.7757742764):0.341652979):0.3322246743,(t2:1.134830839,t3:1.00201008):9.595278353):0.4660298032):1.021097087):7.678993702,(((((((t4:9.077046679,(t5:1.014067068,t6:0.9362427374):7.978547381):2.024319163,(t7:10.77979586,((t8:5.893385347,(t9:3.111659887,t10:3.008821671):2.480071502):2.600043698,(t11:5.939370961,(t13:4.808072561,t14:4.684872296):0.9620703716):2.142839299):2.090167909):0.03858109851):0.8302571884,(t15:10.41527883,((t16:10.16457321,((((t17:4.970493853,((t18:0.3806717589,t20:0.07949939116):1.921175811,t21:1.691251713):2.656142369):4.18646047,((t22:7.599104792,((t23:2.979916549,t24:2.944006415):4.046217937,t25:6.607896465):0.1805011723):0.6505648306,(t26:5.811428811,t27:5.776978315):1.507374946):0.04888434827):0.4827197958,((t28:6.415091216,((t29:0.4778476409,t30:0.4070123016):4.178091931,t31:4.477863917):1.675622676):0.600148464,((t32:6.03030551,((t33:4.641410781,t34:4.542235424):1.149819827,t35:5.579929369):0.1405435977):0.06653533351,(t36:5.686219521,((t37:5.17410279,(((t38:1.426831944,t39:1.421272061):1.776429167,t40:3.188793065):0.8696243929,t41:3.935271392):0.8986433997):0.2209400551,(t42:4.087495965,t43:3.971614738):0.9580051717):0.2815245083):0.01125216504):0.4597217537):0.7708646814):0.3106832098,(((t44:2.786454315,t45:2.542364899):3.387040281,((t46:2.823587799,t47:2.777110687):1.548567779,(t48:4.184672067,t49:4.037742569):0.1237723926):1.519929441):0.4372661746,(((((t50:3.791303898,((t51:0.4802354586,t52:0.4332958318):1.24674424,t53:1.601585978):1.737304734):1.411679197,(t54:4.702449743,((t55:3.77613078,t56:3.656987669):0.5461965179,t57:4.022771447):0.05780886054):0.03593212176):0.1007156356,t58:4.18439865):0.1302467658,((t59:0.1604460692,t60:0.08297513889):3.385496526,(((t61:0.3540286301,t62:0.1720589493):2.27261027,t63:2.261562606):0.5502425105,t64:2.807216974):0.2476517414):0.5729935975):0.04719244903,((t65:0.1718048686,t66:0.007481093073):0.5133299677,t67:0.3764767776):2.566763457):0.5078418859):0.1301666555):0.2064357499):0.07771514083,(t68:2.738358337,t69:2.731307511):1.080041196):0.1327008597):0.2146638851):0.06463426819,((t70:1.076400211,t72:0.9699079943):1.241300075,t73:2.10435531):1.659365512):1.050359389,(t74:1.911447746,(t75:1.204393862,t76:1.20385261):0.6829145408):2.885858109):0.5998645134,((t78:0.9550489871,t79:0.9265644922):1.669662856,t80:2.572415273):2.66293103):0.4893820828,((((((t81:1.024862148,(t83:0.3738472513,t85:0.03129972004):0.3862890726):2.261677268,(t86:1.538300215,t87:1.477299256):1.130293702):0.5694640779,(((t89:0.2823671116,t90:0.1379320947):0.1940341278,t91:0.3269788309):0.2044097737,(t92:0.2351744904,t93:0.2188982365):0.2931759086):1.7815122):0.08733654262,((t96:0.589860984,(t97:0.08541134098,t98:0.06207291182):0.3295175864):1.039574795,(((t99:0.1947261682,t100:0.101977122):0.06303183978,t101:0.08665004754):0.9317573336,t102:0.9524294413):0.1605392392):0.6032282417):0.7364400827,(((t103:0.3507816179,t104:0.3218699407):0.5304772841,(t106:0.4329234833,t107:0.3257018524):0.2220691086):0.4241911123,t108:0.7986902883):1.082333024):0.4833032872,(((t109:0.1215775256,t110:0.05220869331):0.3125507131,t111:0.2581469425):1.387306312,t112:1.571182444):0.3899638593):0.474459222):5.569060551):2.323457313,(t113:2.016567623,t115:1.779921443):8.180710732):0.5274856124,t116:10.42644707):2.690283563):0.1731006199,(((t117:2.370031657,((t118:0.04958377515,t119:0.02199792971):2.096911208,t120:2.055335736):0.1930561586):6.591215857,(((((t121:0.5630847403,t122:0.5463972619):0.1190310709,t123:0.3561766854):2.110311192,t124:2.087027574):3.025715469,((t125:2.951052487,(t126:2.493945128,t127:2.458016342):0.3321429351):1.71368242,t128:4.411296722):0.3671991189):0.8334360779,((t129:1.393601182,(t130:0.540863874,t131:0.5148538432):0.8440783174):1.313290181,t132:2.666676755):2.890854724):2.187131071):0.6413333025,t133:8.27595349):3.555998587):1.071357358):0.2668132172):1.025285565):0.7399840106):1.113923163,((((t134:8.275177842,(t135:7.047434525,((t136:0.5534164983,t137:0.504565942):4.473162903,(t138:0.4816653359,t139:0.3260319138):4.466603302):1.937542446):0.7470907965):0.5163130116,(((t140:1.43650326,(t141:0.7458929998,t142:0.6908370723):0.6602993558):2.496502375,t143:3.797840522):3.274161373,(t144:1.635337353,t145:1.532659956):5.404773078):0.714811954):0.3570771438,(t146:7.787880489,((((t147:6.378151022,(t148:6.102007046,(t149:5.664079078,((t150:3.076948126,(t151:1.986175865,(t152:1.783230276,(t153:0.1966921416,t154:0.1922258347):1.518723623):0.1345919879):1.049573938):2.330174429,(t155:1.878144938,t156:1.8559976):3.210472595):0.2538797531):0.4002991358):0.1804794705):0.466687658,((t157:3.225542793,((t158:0.8200574461,t159:0.8105725473):0.3415705014,t160:1.024694679):1.992706755):2.230850105,((t161:0.8433262705,(t162:0.2017457516,t163:0.1843875626):0.6349448264):4.248727666,(t164:3.4367211,t165:3.404869938):1.624162229):0.03755994848):0.5043465209):0.1300709759,(t166:3.654073733,t167:3.633345184):1.954898806):0.1962949399,((t168:1.687990266,t169:1.663577841):1.960988538,t170:3.584784803):2.092774411):0.5579701808):0.1358340774):0.6619199344,((((t171:3.637872796,t172:3.637030901):1.740074223,t173:5.04004707):1.451769065,t174:6.381216748):0.02362231495,((t175:4.142782262,(((t176:0.9481850415,t177:0.8816780959):1.574298231,t178:2.375551702):0.9967849694,(t179:1.604791525,t180:1.516204422):1.664852325):0.5775139):1.587620158,((((t181:3.252730425,(t182:2.775248141,t183:2.649909506):0.3338710417):0.02482436555,t184:2.948976968):0.3597449553,t185:3.249407966):0.7753114333,t186:3.817782461):0.8388565796):0.5917150161):0.1419313957):5.81755321):2.631987353,((t187:4.572941978,((((t188:1.225998833,t189:1.084646617):1.360471596,t190:2.150453755):1.369894908,(t191:2.931872526,((t192:0.9246105697,t193:0.8793071458):1.967623107,(t194:1.879291697,(t195:1.536196894,t196:1.467040742):0.254306547):0.8693373403):0.01467154169):0.4063130172):0.4567366738,((((t197:2.502858779,t198:2.500128042):0.1600214706,t199:2.582377242):0.3274741719,((t200:1.792271936,t201:1.767462595):0.8112546325,(t202:2.202452386,t203:2.145782111):0.1446123806):0.2936915068):0.01864286403,((t204:1.847741493,t205:1.817974945):0.5385894377,(t206:1.373545371,t207:1.314671501):0.9456184866):0.2061756154):0.3975347241):0.1453023426):1.909610994,(((((t208:2.114044273,(t209:1.633583678,(t210:1.018582829,t211:0.9327552132):0.5954240046):0.315052142):0.3168736545,t212:1.36469581):1.006258541,((t213:0.2032458029,t214:0.1753833445):0.7552489075,t215:0.8627225107):1.088419658):0.3905236358,(((t216:0.1065107196,t217:0.06452618434):0.7902514425,(t218:0.6355627477,((t219:0.2838416423,t220:0.2270816562):0.3103168774,t221:0.4630705614):0.003598570124):0.1718724842):1.129315858,((t222:0.7345110006,t223:0.7336018002):0.8691274263,((t224:1.103756256,t225:1.068229115):0.01160726094,(t226:0.1711037983,t227:0.1502501433):0.7281734009):0.4561598564):0.03219647727):0.3049381476):0.5573694468,(t228:0.2143199691,(t229:0.1102571276,t230:0.02742593765):0.02655475187):1.679610475):0.3798063529):7.214676805):1.352258338):0.166690545):0.4909573938):0.3331196668):0.4765801176):0.1790235823):0.4647102197):0.02756869235,((((t231:1.451095542,(t232:0.1875391874,t233:0.07091441583):1.188242166):7.151824609,((t234:0.08800656823,t235:0.06055574128):0.6681062845,t236:0.6716269591):7.485701384):1.966932871,(t237:9.269317972,(((t238:0.7637169458,t239:0.7249987725):2.046017516,t240:2.713827754):6.016943316,((t241:5.214117392,t242:5.20353902):3.052415029,(t243:1.534960236,(((t244:0.194921362,t245:0.1737984464):0.5207441554,(t246:0.6805580927,t247:0.6553269841):0.007218032896):0.2622857539,t248:0.8233689171):0.4986050132):6.69422112):0.3853201219):0.3656890038):0.6761702072):0.3582727506,(((t249:1.13628429,t250:1.064757473):7.23718563,((t251:1.885957684,(t252:0.4007561815,t253:0.2850693355):1.464847791):5.928361962,((t254:0.6206944785,(t255:0.1450861698,t256:0.02237146542):0.2997324498):4.654270494,(((t257:0.1138106826,t258:0.1123853451):0.1336492421,t259:0.1721307117):0.7412031997,t260:0.8896464472):3.978392467):2.391586691):0.4556447009):0.2730586594,t262:7.817942583):1.152780196):1.492883627):0.7390569419,(((t263:8.14411103,((t264:0.2428772998,t265:0.1660961647):7.150627651,t266:7.280374583):0.7353355554):1.395648485,((t267:3.36976117,t268:3.360717656):3.002796085,((t269:0.2133868954,t270:0.1565060688):0.959607938,(t271:0.04965147983,t272:0.01462898871):1.055216575):5.185813173):2.966017912):0.8244111204,((t273:2.155727566,t274:1.885788619):2.932944893,t275:4.7038238):4.847212639):0.8130316307):0.3423550171):8.304351765):0.1880164644,((((((t277:7.215451612,t278:7.089234381):0.1635626066,(((t279:2.767253695,t281:2.621873298):2.83332874,t282:5.368855861):0.4342943275,(t283:3.764241298,t284:3.744875339):1.959750872):1.185864261):0.07341206205,((t285:0.1039849957,t286:0.07263126457):3.671334464,((t287:2.507008921,t288:2.451338768):1.00601822,(t289:2.655661394,t290:2.640760865):0.7344351893):0.1267237551):3.066177892):0.7109111774,((((((t291:2.924637073,(t292:1.923354816,t294:1.601851856):0.9000817157):0.5365055153,t295:2.947032277):2.512982885,(((t296:4.404678339,(t297:2.378224503,t299:1.942834625):2.007071045):0.187842292,t300:4.09353839):0.6521331934,(t301:4.37743104,(t302:0.430074558,t303:0.1788437398):3.880417586):0.3543502262):0.01687356922):1.130154636,((t304:1.72784064,t305:1.700610582):3.527326314,(t306:0.864184677,t307:0.8519631385):4.292334846):0.2016516711):0.07924971044,((t308:3.436807602,(t309:1.813228971,t310:1.690662782):1.27002405):1.93114154,(t311:4.198984105,(t312:4.02374753,t313:3.995435715):0.1070944524):0.5640863968):0.05226588419):0.005419976451,(t314:1.630642486,t315:1.583939676):3.01823341):0.05912452767):0.8864877973,(((t316:4.119201018,t317:4.091565002):0.1084288288,(t318:3.195130989,((t319:0.838820144,t320:0.4894500943):1.932257837,t321:2.330704726):0.4050413159):0.9669550656):0.7457926407,(t322:3.404317699,((t323:2.590764202,(t324:0.9560863293,t325:0.9175543651):1.594109537):0.02974454617,t326:2.369133757):0.6801952493):0.8758278104):0.4448746593):1.120946426,(((t327:1.918743931,t328:1.56931521):0.7538988739,(t329:1.20793778,t330:1.18744631):1.013168903):1.261179184,(t331:0.9162140969,t332:0.8796313364):2.488787827):1.516422761):8.661948949):2.331997564,((((t333:2.551588524,((t334:2.315081163,((t335:1.131549751,t336:0.9208790071):1.016515685,(t337:0.5408280384,t338:0.5288719474):1.380895525):0.1329666261):0.2300899185,(t339:2.104870099,(t340:1.535904303,(t341:0.8160766901,t342:0.6119842025):0.6231224124):0.5254911708):0.1675081739):0.002859276031):3.329290816,(t343:1.076269154,(t344:0.6738623108,t345:0.6416340566):0.240339486):4.133522863):7.769488176,((t346:1.047925398,t347:0.9288052181):9.834183984,((((t348:4.597142638,(t349:3.571888831,((t350:0.6531314391,t352:0.2623279828):1.773817388,t353:2.031788481):1.029980558):0.7226447882):3.712955579,(t354:0.2692030775,t356:0.1581767429):7.200897269):0.5558894461,((((t357:0.9968898186,(t358:0.2389042697,t359:0.1621251822):0.6868201474):1.964999255,(((t360:0.951419109,(t361:0.8403893551,(t362:0.1809560862,t364:0.07085635142):0.5684467787):0.06589050821):0.7062682217,t365:1.19637166):0.4663053981,((t366:0.3144103024,t368:0.1504404867):0.8216758064,(t369:0.584275441,t370:0.4366699246):0.2822591397):0.5074110263):0.6740108062):0.9976230389,t374:1.841356123):2.571516424,t375:4.250817476):1.328183649):1.001757302,((t376:1.471929688,t378:1.163668792):0.2606552064,(t379:0.2578409857,t380:0.0604625547):1.119987382):4.344512124):0.8882327948):1.890789307):1.789379704,(((((t381:0.8112560025,(t382:0.2968310131,t383:0.2034010286):0.495663837):1.832282822,((t384:0.9327382566,t385:0.9255585428):1.372250715,(t386:0.429142836,t387:0.3730343361):1.821701161):0.2118136613):6.420252387,(((t388:0.9879524088,t389:0.841183653):6.656288842,(t390:6.576168791,t391:6.484173422):0.503975953):0.7872970414,((t392:1.599616413,t393:1.583403991):1.317220165,(t394:1.945477609,t395:1.929178555):0.9424695813):4.590488581):0.3708675185):0.6142260903,(t396:8.268216815,(((t397:5.495385036,((t398:2.659527831,(t399:2.360417175,t400:2.358833832):0.2683896293):1.11770765,t401:3.48359502):1.320828197):1.617664605,t402:6.324384249):0.0431236359,t403:6.266310276):1.019437474):0.1595809965):0.02134410771,((t404:5.351859461,t405:5.294110455):1.316092234,t406:6.602377965):0.7675432898):0.3724357274):0.3628941658):1.410024571):0.0816280125,((t407:6.117512727,(t408:4.072287711,t409:3.890654117):1.99021655):2.273849518,((t410:1.16102176,(t411:1.086759818,t412:1.074136937):0.046458592):6.503218055,(t413:6.54300284,((t414:5.526579361,((t415:5.065903882,((t416:4.316054849,t417:4.184570059):0.5977773014,t418:4.727107589):0.09465885539):0.1236226857,(t419:1.846139598,t420:1.721714588):2.816316972):0.213346578):0.2684546571,(t421:4.590598115,t422:4.581633951):0.3700821421):0.517168526):0.9133102398):0.3861052696):1.20537112):9.889069198):0.1113056884):0.19245504,(((((t423:4.021917831,((t424:1.341856541,t425:0.9885607159):2.422643609,t426:3.403972487):0.09127597854):0.5682739193,(t427:3.981774173,(t428:3.714358553,t429:3.560400741):0.0164439001):0.003263165015):0.08088632544,t430:3.605209078):1.050870364,((((t431:3.591755052,t432:3.266693938):0.4779342169,(t433:2.84864353,(((t434:0.9496059504,t435:0.8340560987):1.179244656,(t436:1.850347544,t437:1.489974961):0.1428952154):0.3170601751,(t438:1.389206745,t439:1.313537897):0.4967005429):0.3005969283):0.7271063936):0.3668372027,(((t440:1.892977927,(t441:1.576051848,t442:1.509766993):0.3073607527):0.04848664969,t443:1.864588962):0.8898655512,t444:2.528143934):0.2114254113):0.08956446628,t445:2.798848515):0.1158370898):0.2951944429,(t446:1.183817969,t447:0.8813313008):1.851037162):11.92045346):4.01749308,(((t448:0.8868338623,t449:0.8205364955):0.3862478301,(t450:1.152381753,t451:1.077510583):0.04242622876):0.6944768948,t452:1.698888373):16.63020769):4.320134581):3.971230077);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T92.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
