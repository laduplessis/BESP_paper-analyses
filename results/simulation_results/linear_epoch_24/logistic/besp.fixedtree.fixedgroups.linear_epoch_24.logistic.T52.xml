<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t446:2.863154989,(t447:2.149027344,t448:1.914762647):0.631151412):38.85000447,(((((t449:0.3842495714,t450:0.2718410139):3.013202619,((t451:1.782124656,(t452:1.520424248,(t453:1.25206041,t454:1.242377842):0.2257607239):0.1637167735):0.3525864801,t455:1.791718028):0.992171819):1.742505601,((((t456:0.7758151479,t457:0.6698534898):1.433425347,t458:2.091962235):0.59386016,t459:2.583346702):0.1184186338,((((((t460:1.221172709,t461:0.9045362351):0.1538313753,t462:0.9722539866):0.3162987619,t463:1.153767257):0.07564850803,t464:1.100431012):0.2024546464,(t465:0.8366983891,t466:0.8071211087):0.2649536755):0.3818674044,(t467:0.406338999,t468:0.2974441568):1.020914826):0.296056972):1.43772209):11.16129187,((((t469:0.7809984242,((t470:0.1603328633,t471:0.1585699143):0.3330883523,t472:0.3329633996):0.266647155):0.09760690528,(t473:0.07463036287,t474:0.05708349538):0.5432725834):0.09408023756,t475:0.6871595121):0.9625563841,t476:1.619571161):12.27020656):0.2929604453,((((((t477:0.4165397515,t478:0.4094536258):1.018415491,(t479:0.5472527743,t480:0.5280247024):0.7220407455):0.05771792447,t481:1.202381076):0.1711066516,(t482:0.4146470708,t483:0.2307600934):0.733316473):2.991623183,(t486:0.491946649,t487:0.2726208057):2.959744756):5.97607186,(((t485:0.06318635879,(t484:0.06909513522,(((((((((((t353:0.03898428942,((t313:0.2116678568,((t245:0.09384830873,((((t217:0.1571469743,(t162:0.01594438585,(((t139:0.09930557489,t140:0.07861202454):0.03146517121,(t121:0.1935397156,((((t114:0.03180104196,(t70:0.07982234425,t1:6.465030227):3.904641632):0.5844100992,(((t2:5.034089347,(t3:2.514853563,(t4:0.8840101419,t5:0.8194877521):1.307633131):2.166884915):3.820055122,t6:8.087496978):0.9471511177,t7:8.745404668):1.014434122):0.1842215152,((((t8:9.014416859,((t9:7.095572643,(((((((t10:0.5059125568,t11:0.4895340927):0.2003414334,t12:0.6887641341):0.02719177496,t13:0.6832693636):0.1426211644,t14:0.8110383376):0.06133144963,t15:0.7561211521):1.855315101,t16:2.52995279):3.310051204,(t17:0.4798183711,t18:0.4687507707):5.296737607):0.99013905):1.729191151,(((t19:3.812360842,t20:3.684320421):0.5366223003,(t21:2.56872603,t22:2.508589151):1.405105641):3.807644883,(t23:5.662557955,t24:5.649326796):2.031673355):0.2740870374):0.101783251):0.1180766978,(t25:6.142919796,t26:5.879005495):1.979580141):0.2018386128,(((t27:6.148020969,(t28:2.602407383,(t29:1.118993616,t30:1.069540781):1.401207864):3.527258975):0.5725543118,t31:6.567304113):0.210915933,(t32:1.455284363,t33:1.184160968):5.318756922):0.8840900232):0.3645731523,(((t34:3.407095807,t35:3.320060544):2.572297452,((t36:0.3726083772,t37:0.3156952813):2.764353799,(t38:0.5556669981,t39:0.5033143862):2.490576553):2.624608583):0.8906693931,(t40:5.774528922,(t41:2.303514379,t42:2.298740292):3.387199017):0.6881994859):0.875438226):0.2094789684):0.3724900289,(t43:6.869366138,(t44:6.643894345,((t45:5.54494405,t46:5.521941643):0.08106471858,(t47:2.717618292,t48:2.717417012):2.8208374):1.007656104):0.1362187148):0.9436193381):0.1041092377):1.95920561):1.631809641,(((((t49:5.174872361,((t50:1.597317638,(t51:0.9220261043,(t52:0.08825323407,t53:0.02075439787):0.6945175258):0.4954726126):2.170785358,t54:3.375243672):1.305561507):0.3081733196,t55:4.97178907):1.262893456,((t56:4.387205601,t57:4.131432609):1.18539415,t58:5.309262702):0.5504831303):0.9982356596,(((t59:2.902037538,t60:2.680110941):2.424686547,(t61:4.389174221,t62:4.221803565):0.677289178):0.8605477536,t63:5.508802412):0.6039153065):0.2026828499,((((((t64:2.841562778,t65:2.682527394):0.561658292,t66:3.231668869):1.219800113,(t67:2.593586712,t68:2.56748089):1.815974793):0.1862678756,(t69:1.454778497,t71:1.236803844):2.647542627):1.058826235,(((((t72:0.7246145353,t73:0.6923787905):1.135427077,((t74:1.265793261,t75:1.214314774):0.4845357508,t76:1.393863581):0.04690990444):1.303795064,(t77:1.298119914,t78:1.189088525):1.389906041):1.14787421,((t79:2.770862598,t80:2.730310866):0.4935571899,t81:3.079967486):0.3687422513):0.3797695842,(((t82:1.241703817,t83:0.9978630976):0.5551748956,t84:1.501259019):0.1762966741,t85:1.645197209):1.756371504):0.2479419201):0.135649892,(((((t86:1.915097464,((t87:1.618916552,t88:1.505726256):0.02573409289,t89:1.47442307):0.25320107):0.6847107668,t90:2.345204828):0.005305874104,(((t91:0.2132321903,t92:0.1896602786):1.715791849,t93:1.84368617):0.2281128926,t94:2.06064661):0.1688700429):0.2476717293,((t95:1.847270396,(t96:1.599462021,(t97:0.187414326,t98:0.1871852695):1.383970431):0.1891207277):0.468060316,(t99:2.009742914,((t100:1.109301468,(t101:0.1288599275,t102:0.08012096504):0.2680995978):0.7566588975,t103:0.6649155742):0.1035679649):0.2075502849):0.052116803):0.6421115689,(t104:1.507076311,((t105:0.1510083058,t106:0.1366684625):0.8394540736,(t107:0.7869988383,(t108:0.5602490884,t109:0.4561118889):0.2031555498):0.09293317308):0.4724330893):0.1237616286):0.2626322238):0.2679211617):3.325616224):0.8109751785):4.783818672):1.780275144,(((t110:11.25488211,(t111:0.5127361843,t112:0.4769428557):10.73703127):0.7925114878,(((t113:2.419140981,(t115:1.697256971,(t116:1.520344198,t117:1.357752669):0.1153686048):0.4757058552):1.592339075,((((t118:1.073062197,(t119:0.6677673859,t120:0.374147185):0.393572127):1.143464708,t122:1.239038654):0.4009815587,(t123:0.06341533446,t124:0.05476846349):1.570846055):0.5036322467,(t125:0.6009420874,(t126:0.5695844161,(t127:0.08718652796,t128:0.04990105942):0.4656509043):0.01666702253):1.527214269):0.3806742844):4.076728782,(t129:0.2058196749,t130:0.1835566244):5.899428074):3.895855863):0.2752793058,((((t131:1.083926078,t132:0.9275870929):2.433112955,(t133:0.2918279758,t134:0.2590864632):2.890909401):5.49183958,(t135:8.237453881,t136:8.139651094):0.27016428):0.5039897079,(((t137:0.9107140212,t138:0.9057221433):5.937842289,(t141:3.456137456,t142:3.366747517):2.292708685):0.08235495374,(t143:3.959957061,t144:3.797576531):1.776931321):1.937905231):0.4127901563):0.08391473433):0.4597458492,((t145:6.265233321,t146:6.091051306):0.2022136558,t147:6.082393287):1.987353057):0.5119405491,((((t148:6.418069963,((t149:4.650343749,(t150:4.400930355,t151:4.36529882):0.1010961658):1.098221606,(((t152:0.7940323589,t153:0.7223428077):3.938634349,(t154:4.424680709,t155:4.401485222):0.2296994116):0.4729062334,t156:5.091673444):0.2884704692):0.5669258113):0.7166014328,((t157:6.351813208,t158:6.257531729):0.06257952206,t159:6.288605275):0.1769033166):0.5308746188,((t160:2.408590007,t161:2.37147321):3.921184119,(t163:4.026586377,t164:3.95145094):1.925203795):0.601777069):0.4901907767,(t165:5.703289774,t166:5.552606124):1.120687006):0.420662213):0.2826817):0.583670585,(((((t167:5.370467861,t168:5.360077415):0.05483941125,((((t169:1.030387496,t170:0.9381178004):0.8347653815,t171:1.459119424):1.342817596,t172:2.60004382):1.762541023,((t173:3.556763357,t174:3.50416863):0.4942289509,((t175:1.856353944,t176:1.541955581):0.6986365496,t177:2.092464449):1.435150227):0.3070396122):0.08346374907):0.5485590265,((t178:0.2386073093,t179:0.1812593513):3.415116418,(t180:2.855521158,(t181:1.812461686,t182:1.719436615):1.010098687):0.7000795981):0.773902525):0.4720501964,((t183:2.01170183,(t184:1.843177408,t185:1.553449549):0.1585192611):1.584972945,(t186:3.055361246,t187:2.872203879):0.09605625212):1.04675113):1.108900469,((t188:1.065479591,t189:0.9418929253):2.659114911,((t190:3.386169166,t191:3.340534348):0.1680144333,(t192:1.111792887,(t193:0.8009199814,t194:0.6869431783):0.2798912564):2.369785021):0.01087810105):1.333182787):0.3849112664):6.021118428):3.580182751,(((((((t195:2.799093941,((t196:2.528552301,(t197:1.737078958,t198:1.716068907):0.7834949211):0.08575591715,((t199:1.846705319,(t200:0.3071203284,t201:0.2841102258):1.390317137):0.4909252484,t202:2.122301147):0.1897085479):0.05596808512):0.2247336311,t203:2.580119958):0.1220696477,(((t204:1.181990271,t205:1.148548645):0.6633913608,(t206:1.383031843,t207:1.310785636):0.3641680966):0.3731751343,(t208:1.959496377,(t209:1.329954312,(t210:1.203117707,t211:1.135246395):0.09230390372):0.5931817592):0.07988209864):0.3856315768):0.6094990101,(t212:2.124015762,(t213:0.1469591256,t214:0.005708677302):1.976327629):0.702149848):0.3251652978,(t215:2.875597391,t216:2.800848374):0.09765364119):1.013601546,((t218:2.089558882,((t219:0.02946912561,t220:0.006418453236):0.3629213053,t221:0.3144306177):1.388722931):1.004407754,(((((t222:1.032390515,t223:0.769230152):0.676199288,t224:1.422734702):0.1474519707,((t225:0.4265582798,t226:0.3670848416):0.646862456,(t227:0.8859748509,((t228:0.5620764307,t229:0.5006128614):0.2768850682,(t230:0.3410264556,t231:0.3020934798):0.3910886185):0.002506539033):0.100766058):0.4641262805):0.7302618381,(t232:1.732788091,(t233:0.8956104581,(t234:0.0649427466,t235:0.05843863934):0.3998898745):0.8277074397):0.2338541843):0.001182374116,t236:1.400748836):0.02924818934):0.4303762054):8.991412112,(((((((t237:0.2134561933,t238:0.06372192399):0.2075036701,t239:0.1027121415):0.5555271554,t240:0.6462174363):2.269956303,t241:2.88545617):0.8106700763,(t242:3.501009601,((t243:1.348246309,(t244:0.3171860057,t246:0.05778643613):0.9573628388):0.5780999522,(t247:0.2620506598,t248:0.2307751103):1.313594643):1.408659069):0.02297547606):3.528611358,(t249:5.278842316,t250:5.212204904):1.18163196):2.415636261,t251:8.357911722):0.6992683347):0.4913920981):0.04502602608):0.012337818,(t252:8.033846159,t253:8.031023284):1.431925378):0.7533995243,((((t254:0.1727861179,t255:0.08220335276):8.66216411,(t256:8.377345064,(((t257:1.668470362,t258:1.386230336):0.04282506221,(t259:0.402548411,t260:0.3189755613):0.9611744473):5.664280705,(t261:0.7834452558,t262:0.6983096222):6.158111616):1.000250203):0.3453319656):0.7854591327,(((t263:4.702770611,(t264:3.250303967,t265:3.218573933):1.322351146):3.585207353,t266:8.123467922):0.6266106665,((((t267:6.7633537,t268:6.730876418):0.7865333622,((t269:0.5924282725,t270:0.590676708):4.442096123,(t271:3.598735951,(t272:2.892223633,t273:2.873786753):0.6562587017):1.430863604):2.479988863):0.5992432799,t274:7.723615974):0.1291075223,(t275:6.81765909,(t276:4.225150386,t277:4.135666911):2.454584764):0.6340454255):0.450475461):0.06554108998):0.2136747363,((t278:6.36033034,((t279:1.508512799,(t280:0.2188827574,t281:0.1218612047):1.270927314):3.284244788,t282:4.672623714):1.562706484):1.013846376,(t283:6.444043641,((((t284:3.296005659,t285:3.232272042):0.4141935094,(t286:2.887785845,(t287:1.903146364,t288:1.897836328):0.8890214581):0.6762128661):1.624778913,t289:5.039428142):0.5985066257,((t290:1.409690634,t291:1.392360607):2.001319541,(t292:1.882292271,t293:1.877401961):1.318501415):2.181141623):0.4071780871):0.6927562584):0.3570140181):0.1387754165):1.623238746,(((t294:6.188717489,t295:5.892042131):0.2911492038,((t296:1.853881638,t297:1.844597964):3.749641032,(t298:5.080746477,(t299:2.461784029,t300:2.325399463):2.609722847):0.3900240099):0.5209291561):1.421053074,(t301:5.487826909,t302:5.47521821):1.751193726):0.23263187):0.6468195168,(((((((((t303:2.567984084,t304:2.439581364):1.025321313,(t305:0.7548374303,t306:0.7316533031):2.627496805):0.135966062,(t307:0.2711526706,t308:0.111557562):2.97637018):0.4554468938,((t309:0.7457326252,t310:0.5860175059):0.8194216125,t311:1.363548537):1.866660014):0.1480510505,t312:3.360909391):0.1670318437,t314:3.09739136):0.2367311629,t315:3.296020441):0.3599532135,t316:3.530702081):0.734149033,((t317:3.158546966,(t318:0.5325592619,t319:0.3234471584):2.562373056):0.9580175082,((t320:3.028637452,t321:2.75086008):0.7354132345,(t322:3.447318245,(t323:2.494020256,(t324:2.330502321,t325:2.295626462):0.03906733897):0.8623884615):0.03229696874):0.02264035913):0.1245012043):2.200382145):4.589218881,(((t326:2.064661507,t327:2.044034003):0.8062413319,((t328:2.381291159,(t329:0.6639397041,t330:0.6187055339):1.54177062):0.2242782287,t331:2.381841755):0.1499051504):0.7576031204,(t332:1.899683964,(t333:1.575733788,(t334:0.8571864318,t335:0.8463496913):0.6542389201):0.2739912224):1.373091562):6.535152874):2.896130412,((((((t336:1.0506553,t337:1.018069116):0.7512023322,(t338:0.8235253753,t339:0.7855431401):0.8497026805):0.05239025612,((t340:0.6503293866,t341:0.6446256459):0.2125217858,t342:0.8222642441):0.8203391172):1.712355525,(t343:2.761189687,(t344:1.827727295,(t345:1.262418393,t346:1.103750959):0.4229129666):0.8999933515):0.5772392482):1.761458651,((t347:3.347669259,((t348:2.391218653,(((t349:0.3697911836,t350:0.06528457438):1.737949409,t351:1.294506435):0.002993036909,t352:1.25338537):0.2240532263):0.34840538,t354:1.317737481):0.5844282576):0.0005341624062,(((t355:0.4862332618,t356:0.4463447895):0.1909363436,t357:0.4996915122):1.18978869,t358:1.619896204):0.02245550253):1.311381405):7.152234903,(((t359:1.024458343,((t360:0.4987089933,t361:0.4565704154):0.2302891366,t362:0.5120625903):0.1661759111):0.437278552,t363:1.052396855):3.019408273,t364:4.038013362):5.610174085):0.07566278294):0.3962289497,((((((t365:0.1419443961,t366:0.1109036373):0.3531295251,t367:0.1671027645):0.271785574,t368:0.02136659216):1.179310634,t369:0.9500823661):0.3536842955,(t370:0.441574644,t371:0.422412519):0.8568436356):0.7350546726,(t372:1.628893187,(t373:0.6670520436,t374:0.4386840132):0.9461911553):0.2539779662):6.742269591):0.07833489426,t375:8.233123228):0.3587779675,((t376:0.1125744633,t377:0.07518398018):0.02626574256,t378:0.06248300321):8.352861886):0.7907234865,(t379:5.350328938,(t380:3.721983467,t381:3.626998234):1.560285984):3.595684809):0.8758254906):0.3516262761):0.9106960392,((t382:8.620260964,(t383:6.411368911,((t384:0.6296611283,t385:0.5376723035):4.267742162,t386:4.663835913):1.492592955):2.080581775):0.5811960247,((t387:0.2973773654,t388:0.2590997873):0.4411581158,t389:0.4656053988):8.042623539):1.648516545):0.3509341117,(((((t390:6.825529375,((t391:1.090076628,t392:0.8747340979):4.359470517,t393:4.866892548):1.306319581):1.005391669,((((t394:0.4477492411,t395:0.3720584059):0.9840101041,t396:1.292734233):3.21629655,((t397:3.292827391,t398:3.211556234):0.4996566092,t399:3.649251971):0.7070325282):1.167817249,t400:5.511303149):1.263619291):0.4548763819,(((((t401:2.670055636,(t402:2.292193352,t403:2.233074952):0.318743376):1.376956979,t404:3.807205146):1.334425795,t405:5.138521709):0.6031838349,(((t406:2.82013261,t407:2.565032412):1.308885582,(t408:1.846859587,t409:1.839094545):1.901272875):0.1511260608,((t410:0.8842872966,t411:0.8177030443):2.774066098,(t412:2.500876231,t413:2.379810914):0.9781034945):0.1807058984):1.353524391):0.2253951907,(t414:2.409308127,t415:2.382057262):2.692394152):1.019474302):0.02557218895,(((t416:2.4599795,t417:2.424230743):2.935737254,t418:5.138766378):0.4935532611,(t419:5.543738687,(t420:5.330374708,t421:5.266051932):0.0395944324):0.0395834516):0.1463134104):1.921580758,((t422:3.951457569,(t423:2.910824247,t424:2.869982094):0.9846922137):1.510165188,(t425:1.942966483,t426:1.783944605):3.225697827):1.797536053):0.2539963159):8.176711418):3.548722155):24.78283969):21.0428792,((t427:4.320813729,t428:4.190728334):2.520756129,(((t429:3.040921673,t430:2.984289671):0.3545516707,(t431:2.535261353,t432:2.480667224):0.7843375718):2.503756014,((t433:3.209001608,(t434:2.085218829,t435:1.966800129):1.071721578):1.317413388,((t436:4.044555888,((t437:0.2759206452,t438:0.2425343793):3.429686529,(t439:3.341587082,(t440:2.513526967,t441:2.484167339):0.7075924986):0.328762018):0.3361206938):0.1409209756,(((t442:2.422383859,t443:2.41202181):0.1878263214,t444:2.547807079):0.3697924623,t445:2.873864026):0.8136735255):0.1343931427):1.06579479):0.3776640986):57.75788364);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T52.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
