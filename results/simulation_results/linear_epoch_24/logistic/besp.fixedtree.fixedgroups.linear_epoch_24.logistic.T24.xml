<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t385:6.28726614,t386:6.232064436):1.669090524,(t387:7.414295296,t388:7.38062867):0.4025088742):1.762536773,(((t389:6.213154803,(t390:2.381795597,t391:2.235167807):3.705947179):2.589553388,(((t392:0.1746785131,t393:0.1568202863):0.5678600792,t394:0.6762980995):7.265979357,(t395:7.640258335,(t396:0.7730687324,t397:0.6979840559):6.836615813):0.2384066096):0.1925900396):0.1726379704,((t398:5.078841644,(t399:2.146868174,t400:2.105759941):2.833529487):1.337946173,(t401:6.176704249,(t402:5.038585587,t403:4.728265075):1.10513177):0.03782160319):1.685622942):0.4653468395):13.03767665,(((((t404:6.590686573,(t405:4.848515393,t406:4.7148583):1.595166995):0.159550377,t407:6.40667656):0.8036657909,((((t408:3.940567197,t410:3.819439677):2.01616833,(t411:0.7570637946,t412:0.6639803198):5.070840154):0.5374818389,t414:5.944731182):0.4781781497,(((t415:1.537640095,t416:1.447985152):2.429873326,(t417:0.6271578983,t418:0.5169463555):3.006732767):1.69784819,(t419:3.962519921,t420:3.760725354):1.240715527):0.4256759754):0.2038121951):0.5142757193,(((((((t421:1.901164827,t422:1.849892336):1.851066281,t423:3.655085995):1.083566777,(t424:3.873445541,((t425:1.466874654,t426:1.43656326):0.9753850583,t427:2.32747272):1.430816132):0.8286564457):0.007182421039,(((t428:2.614665501,t429:2.100561858):0.4675438982,t430:2.486405622):0.7988530377,((t431:1.525750658,t432:1.493616243):0.178357065,(t433:0.7902116528,t434:0.6824385323):0.8745330836):1.262034094):0.7068435993):0.5989802025,((t435:0.9693528445,t436:0.9115842309):2.785460286,t437:3.616116896):0.2412407204):0.1386520911,t438:3.648865707):0.2034566074,(t439:3.259423513,(t440:2.211219698,t441:2.154702736):0.8990679975):0.5209439298):0.2817452362):9.873516439,(((((t442:3.089036175,(t443:0.849012652,t444:0.8432950481):2.230596414):0.2610066885,(((t445:0.8560064693,t446:0.5605059501):1.550304076,t447:2.052865975):0.7369106385,((((t448:1.761832675,t449:1.71629012):0.1214088193,(t450:0.1307824775,t451:0.01933527124):1.682658915):0.7986485808,(t452:0.9118392902,t453:0.8840362241):1.542256827):0.03301299953,(((t454:1.149239318,t455:1.14732416):0.6439707372,(t456:0.7383304597,t457:0.6977954027):1.03266797):0.1842108131,(t458:0.9063363724,t459:0.857129208):0.8433590866):0.3853709258):0.06781750607):0.1695251757):0.1337496562,t461:1.589041355):2.250858541,(((t462:0.4473516262,t463:0.3865106972):0.1706743384,t464:0.5138070634):2.183550018,(((t465:0.2687939547,t466:0.1403676473):0.5660751495,(t467:0.4088213952,t468:0.1600803864):0.2289875249):0.7292548584,t469:1.031059175):1.018398379):0.8931504718):3.169925436,((t470:0.2055552437,t471:0.02964722395):1.892482943,((t460:0.3301639022,(t413:0.1432003717,(t409:0.09557156891,((t368:0.2291963107,t369:0.05692889231):0.4559517958,((t352:0.003315168338,(t270:0.3328816538,(((t256:0.01554273528,((t248:0.09513766327,(t246:0.01414893925,(t241:0.01352141161,((t208:0.03517448305,((t168:0.04300328854,((t120:0.5208894943,t122:0.3569750042):0.005783267252,(t123:0.1212087346,(t121:0.005765005651,(t111:0.008096048738,((t104:0.1202871432,t105:0.05905095352):0.05731919726,((t96:0.2054226924,(t1:1.320821994,t2:1.284439607):7.885164595):0.1689960058,((t3:2.401080018,t4:2.37729229):6.434103437,((t5:1.22103157,t6:1.155407093):3.571581179,((t7:0.3241093759,t8:0.1142536741):1.129481761,t9:1.236007406):3.212975552):3.99461006):0.2183431326):0.9746101163):0.6572248202):0.5857137111):0.2199052401):0.1496966317):4.019103691):0.07536418148,((t10:1.553324706,t11:1.372251778):7.626706647,(((t12:1.547477988,t13:1.509426662):0.7506304829,t14:2.244198648):3.872082695,(t15:5.135277471,t16:5.130381359):0.960975675):2.45092613):6.082952216):3.719431607):1.10557767,((((t17:7.845006638,(t18:6.871087752,((t19:5.083270406,(t20:1.283797585,t21:1.282631604):3.739572008):0.9415834548,(t22:0.1759737217,t23:0.1130943428):5.768700292):0.7998659239):0.9562244867):1.448259962,(t24:7.453581067,t25:7.220728912):1.161245474):0.06799546961,(((((t26:2.507646839,t27:2.503305211):0.3901782636,t28:2.703138204):0.8963089506,t29:3.322604028):3.787673508,(t30:3.014030546,t31:2.918818353):4.043798337):0.596880674,t32:7.420606294):0.1018681887):2.587225358,((((t33:5.251904919,(t34:4.815843631,(t35:1.237266192,t36:1.173568488):3.510436696):0.3563367926):0.5876131932,t37:5.59527381):2.241994868,((t38:6.683525577,(((t39:0.918997972,t40:0.8404140619):1.637051058,t41:2.424340655):1.544542774,t42:3.957032068):2.420002419):0.7363004831,((t43:6.075834645,(t44:6.029747664,t45:5.863272893):0.03258383102):0.7755994014,(((t46:1.557189285,t47:1.538201667):0.05034451976,t48:1.583350146):4.49220758,((t49:4.283993555,t50:4.25803455):1.348260709,t51:5.50130462):0.07003483295):0.5574888291):0.1263210627):0.3443183941):1.058238776,(t52:6.929986601,(((t53:3.851207509,t54:3.827552814):1.008146131,t55:4.775420036):0.07820204453,((t56:3.691438571,t57:3.669073493):0.6290648779,(((t58:3.011701018,(t59:1.493423785,t60:1.47734276):1.473800666):0.1702723526,t61:3.11583736):0.3130276511,(t62:1.767953552,t63:1.757354788):1.533160095):0.6486370882):0.4231325629):1.858922043):0.6324194346):0.9462381029):7.414621597):1.784417687):0.6123444956):0.3908092242):0.6629147997,((((t64:4.944614323,(t65:3.573943409,((t66:1.52034344,t67:1.490024883):0.04219599472,t68:1.396542256):1.893808081):1.201936125):0.8180373701,(((t69:1.818684349,(t70:1.516511814,t71:1.456001939):0.04608501892):1.293068693,(t72:2.547289861,t73:2.118261417):0.2068807426):2.003563443,((t74:2.771981071,t75:2.583810732):0.3672671336,((t76:1.582609086,t77:1.436183191):0.6672133315,t78:2.032988414):0.5592672573):1.079479175):0.1396708746):10.6850284,(((t79:2.361349191,(t80:2.258734711,t81:2.245296438):0.05506845053):0.5751839263,t82:2.770366508):11.26753369,(((t83:1.27917042,t84:1.271736146):1.573936761,t85:2.793680233):1.929014067,(((t86:3.132963489,((t87:2.378366887,(t88:1.693324993,t89:1.542032944):0.6367207401):0.1549756789,(((t90:1.289985178,((t91:0.8846368763,(t92:0.6358370393,t93:0.5710428914):0.1633323579):0.182390682,t94:0.8556707364):0.1258543184):0.05688623937,t95:0.8611008595):0.6190853644,t97:0.6142334658):0.2404048173):0.4536479988):0.2357306671,t98:1.517225252):0.4162890826,((t99:0.2232718729,(t100:0.1570148008,t101:0.08236495321):0.06472884349):1.346430132,(((((t102:0.1510058079,t103:0.09899838416):0.5927226624,t106:0.5070206157):0.09154935395,t107:0.4150992283):0.03236204479,t108:0.3079677457):0.1148581165,t109:0.3782776519):0.3651353182):0.3473415575):0.8787947819):9.215587327):0.2321134631):1.677285395,(((((t110:6.246201814,((t112:1.66204992,((t113:0.9403143382,t114:0.699155071):0.6520889356,((t115:0.4433502752,(t116:0.1640215943,t117:0.1238921716):0.2755818761):0.1728053594,t118:0.5459370589):0.733111501):0.02164352266):3.504710379,t119:4.801093032):0.9382344609):2.605237395,(t124:4.308473847,((t125:1.032413698,t126:0.676372775):1.894898266,t127:2.440718204):1.293052852):3.132298504):1.742925767,(t128:8.376657584,((t129:1.217988004,(t130:0.148260215,t131:0.007122372874):0.9769182544):5.756791276,t132:6.671292919):1.27935376):0.2159946302):0.1652418027,(t133:8.088367427,(t134:0.541062074,t135:0.4527938801):7.364508492):0.210441584):1.628107638,(((t136:0.3393787464,t137:0.3225477475):7.333921984,t138:7.641407038):0.9949726309,(t139:5.954896601,t140:5.879081015):2.624310621):0.9757380851):0.5155430532):0.514126677):0.4026979363):0.05429673412,((t141:1.700589103,t142:1.645893462):7.730909642,((t143:6.348373687,(t144:5.288973405,(((t145:1.320047154,t146:1.207620377):0.4281969534,t147:1.568656145):2.067039667,t148:3.549239433):1.466436078):0.9174646551):1.640533758,(((t149:4.771951073,t150:4.68545165):1.844578168,(((t151:0.9776707972,t152:0.9746279977):0.9164627031,t153:1.676241825):0.2715968522,t154:1.947739196):4.360907017):0.6167315501,((((t155:1.187527346,t156:1.173997661):1.702538053,t157:2.840918573):3.536878967,t158:6.365885012):0.4562025335,(((t159:2.887261145,t160:2.843010785):0.631494283,t161:3.461092059):2.646416369,(t162:1.060731267,t163:1.026618258):4.97399953):0.5639045829):0.0143105469):0.2712535025):1.147606326):1.132556239):0.5503114011,((((((t164:2.256631061,t165:2.081625296):3.357034688,t166:5.434950716):1.574471261,(t167:6.233132861,(((t169:4.367944577,t170:4.043042447):1.643459001,(t171:2.710612151,(t172:1.408859532,(t173:0.499417557,t174:0.491807974):0.8562567323):1.279452814):2.915253496):0.07260335794,((t175:0.7622539522,t176:0.7024141727):4.505974612,(t177:3.444464262,(t178:0.5963592918,(t179:0.375186418,t180:0.3302957307):0.1596165084):2.768475384):1.693206405):0.3326191877):0.01781512622):0.7504272266):0.2360527594,(((((t181:0.2039424124,t182:0.1066511361):3.013630786,t183:3.05594119):0.2158119453,t184:3.269979505):1.521797582,(t185:3.458730164,t186:3.438868731):1.308628069):1.002667525,(((t187:2.051578531,t188:1.988261624):0.3628450634,t189:2.239331843):3.042727592,(t190:4.91829521,((t191:2.412652383,t192:2.381935337):2.355170121,(t193:4.522213283,(t194:1.942943904,t195:1.880465666):2.575993121):0.1997545042):0.09226137883):0.08985236707):0.24105946):0.1630815876):0.07692564796,((t196:3.309747202,(t197:2.682130555,(t198:2.10276041,t199:2.074521295):0.4842891905):0.596950308):1.658732574,t200:4.74169823):0.2642576524):0.1785192295,((t201:0.5988474807,t202:0.3157432906):2.357508158,t203:2.496094382):2.053612916):1.976983989):0.6480361435):7.843109908):1.452740323,(((((((((t204:1.43905323,(t205:1.341199556,t206:0.7842925034):0.0198586932):2.185194839,(t207:2.628599274,((t209:1.282056214,t210:1.275609882):0.2891008195,t211:1.55405879):0.8016322746):0.2545924297):0.1927177285,(t212:1.594846125,t213:1.482629681):1.207611091):0.02955534111,(t214:2.081684162,t215:1.92205222):0.5175165314):0.1127603314,(((t216:1.341896552,t217:1.264046279):0.2575234752,((t218:0.7246354392,t219:0.696669229):0.3790352364,t220:1.028333305):0.09925890734):0.08568496945,(t221:0.6196267526,(t222:0.5486660318,t223:0.3717775831):0.02031478684):0.01638951846):0.7304141753):0.05100292894,t224:0.9921409765):0.2251797023,t225:1.208659292):3.760262334,((((t226:1.042649154,(t227:0.6692209361,(t228:0.3062688001,t229:0.2775111297):0.3392098369):0.3368579856):1.520814127,((t230:0.450105996,(t231:0.08184311187,t232:0.07695738201):0.3016986715):0.3241158469,t233:0.682999605):1.649009):0.06046078641,((t234:1.441671378,(t235:0.0698918316,t236:0.00350510352):1.335026682):0.2568797813,(t237:0.2426337493,(t238:0.1192456203,t239:0.05216325056):0.04471279843):1.281776919):0.6673997225):0.9212828435,(t240:2.769465497,(t242:0.07599952024,t243:0.07193378777):2.453763218):0.1291703635):1.423656193):6.37519533,t244:10.41056281):2.097196914):1.418888924):3.127119895):0.4078480383):5.139042551):2.353254558,(((((((((t245:0.5940992712,t247:0.06176343851):0.6304584405,t249:0.1400843999):10.98751558,(((t250:0.8378416656,t251:0.822962607):4.592697499,((t252:0.1824292442,t253:0.02561632165):3.430071271,(t254:1.068849542,t255:0.933109983):2.347508168):1.799709783):4.975290007,((t257:8.829689352,t258:8.788964295):0.5979793723,(((t259:0.4642507194,t260:0.4098595085):6.096842475,(((t261:1.495619725,(t262:1.430339295,t263:1.429057638):0.04886921067):0.133296953,t264:1.476505145):4.46244621,t265:5.931415319):0.2770900073):1.393218336,(((t266:0.2452585841,t267:0.2256203252):0.2128775313,t268:0.4280104229):2.565090096,t269:2.988115368):4.520930983):1.243354464):0.3906857862):0.4135476868):1.111103646,((((t271:6.572094691,(t272:5.05456695,(t273:0.5479053099,t274:0.5366124076):4.395959622):1.268250735):1.141856655,(t275:0.6265805079,t276:0.502056748):6.708248455):1.016109503,((t277:8.002587658,((t278:1.933821467,t279:1.85075665):4.277354263,t280:6.120612264):1.613682346):0.1779189099,(t281:5.966388528,(t282:1.40203772,(t283:1.277929467,t284:1.237369595):0.0607048478):4.555667461):1.874450343):0.02553093113):0.01271591677,((((((t285:2.823324429,((t286:2.044413624,t287:2.036651621):0.2840788221,t288:2.253981709):0.4376874394):0.2088381068,(t289:2.726960091,(t290:1.760339697,t291:1.694008876):0.8535311771):0.1606281093):0.2152085957,t292:2.911267178):3.656825811,(t293:3.428685853,t294:3.112970974):3.076818913):0.03241631235,((t295:0.5719262714,(t296:0.3467106611,t297:0.2214217559):0.1523373343):1.985050767,t298:2.309897266):3.585566338):0.3261785702,((t299:0.05035313264,t300:0.02203445368):4.969500566,t301:4.923216166):1.163855809):0.352805612):1.380846112):0.1700013679,((((((((((t302:5.403593023,((t303:4.375313278,(((t304:3.629313921,t305:3.551261873):0.2840755226,(t306:3.549484379,t307:3.290463908):0.2229599132):0.1860877545,t308:3.483442872):0.2096197148):0.3344227123,(t309:3.381119039,t310:3.369182857):0.5224618006):0.4713150003):0.1435751381,t311:4.421340117):0.03061752614,((t312:1.21014443,(t313:0.3481867296,t314:0.3022591161):0.845534346):0.8917862639,t315:2.039346782):2.295833805):0.03614532534,(t316:0.3047923542,t317:0.1330675482):4.049904583):0.03862388263,t318:4.08645103):0.9817687276,t319:4.850725655):0.04366957078,(((t320:2.38821626,t321:2.27304405):1.930007508,(t322:3.464605021,t323:3.384616):0.3580589832):0.4353679451,(t324:3.598626855,t325:3.496254621):0.5075321449):0.1401517346):0.4595906845,(t326:3.633011206,(t327:2.436871184,t328:2.358714347):1.189085546):0.9242887799):0.08848026252,(t329:2.240206158,t330:2.170163886):1.70781687):0.01489726656,((t331:2.598844669,t332:2.560725501):0.6850644536,((t333:0.7150745849,t334:0.6364650894):2.016754356,(t335:2.228862247,((t336:0.2904763449,t337:0.1456367228):0.3538027337,t338:0.403202563):1.51620385):0.3932683716):0.3935886504):0.5560165725):0.7479481264):1.452865111,((t339:3.167891644,((((t340:0.5540734569,t341:0.5309498107):1.859723178,(((t342:1.000380321,t343:0.9192987597):0.7389225153,t344:1.439855702):0.3228245879,(t345:0.982112285,(t346:0.6692814342,t347:0.586593206):0.1336095247):0.7285427581):0.2020632517):0.2223363154,(((t348:0.2616206329,t349:0.197463648):0.3822159649,(t350:0.09281824992,t351:0.01667329713):0.1383425373):0.4193296947,((t353:0.08326472535,t354:0.01243095293):0.1558151132,t355:0.09955221314):0.2637341322):0.7315954537):0.3627250508,(t356:0.966993374,t357:0.4121273101):0.2374143651):0.1624144099):0.2307544609,(t358:0.05270302627,t359:0.005773087088):0.9652858413):1.934298997):7.497498972,((((t360:1.267418683,t361:1.262446729):0.649217529,(t362:0.6383486073,t363:0.5336964311):1.272128901):1.616549834,(t364:0.8117843136,(t365:0.313197371,t366:0.2449692729):0.4147895735):2.249882176):0.2643930571,(t367:2.171251256,(t370:0.799459351,t371:0.780746096):0.5834040898):0.6816824374):6.456845243):0.7255159338,(t372:2.257781251,((t373:0.3308701193,t374:0.2971799936):1.428843435,t375:1.714996545):0.4665331483):6.914186794):0.2592548233,(((t376:0.7803588082,t377:0.7240851405):4.057192984,((((t378:0.4682735377,t379:0.4557021433):0.7961255282,t380:1.130761931):1.064837761,(t381:0.1572464054,t382:0.02901363624):1.983631179):0.9945208455,t383:2.947142663):1.409308752):0.2412124096,t384:4.561146456):4.233383053):1.447011891):1.321531474):3.612851905):4.622589095):3.025930879);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T24.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
