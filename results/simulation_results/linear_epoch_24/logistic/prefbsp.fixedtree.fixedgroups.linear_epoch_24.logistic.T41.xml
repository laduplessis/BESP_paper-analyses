<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t483:25.06928235,(((t484:1.084318889,(t485:0.9033420383,t486:0.6007308582):0.1544270351):1.517299094,(((t487:0.2521779889,t488:0.1652337269):0.05230537963,t489:0.005578643628):1.143607539,t490:1.143418199):0.7448805684):0.1768182309,((t491:0.8129283593,(t492:0.4161091253,t493:0.09843778535):0.3129839279):0.5857846312,(((t455:0.01669155774,(t376:0.0395768031,(t370:0.0174056347,(t364:0.1290123935,(((t331:0.04177844589,((t315:0.006628000519,(t295:0.08821113719,(t290:0.009897766236,(((((t217:0.1113067793,(t134:0.1521117681,(t132:0.009502705001,((((((t19:0.1386830212,t20:0.05708696376):0.1161473682,(t1:0.7860559073,(t2:0.3502077311,t3:0.2197606377):0.4208593677):0.9842672249):1.148424639,t4:2.723171312):7.405044606,(t5:0.3986303465,t6:0.3427285262):9.653808956):0.05006710346,((((t7:0.08383938303,t8:0.02717894041):5.970434792,t9:5.883814133):1.115618802,t10:6.722601954):1.062855176,(t11:5.035100128,(t12:2.905652617,t13:2.851259339):2.037171731):2.727397497):1.746070502):0.569999599,(t14:9.837153362,((t15:8.01322307,t16:7.982454988):0.3924317952,((t17:7.703740631,(t18:0.9056433894,t21:0.5600202394):6.790973601):0.09961076861,(((((t22:3.514601323,t23:3.40448028):0.193607325,t24:3.580625603):2.48506419,(t25:1.861009768,t26:1.834802725):3.837360522):0.1948357472,t27:5.494444962):0.4873875006,t28:5.965144717):0.3719190943):0.2989281657):1.314795163):0.02778063149):1.465753272):0.2987893336):7.674566042):2.03534161,(((t29:7.475082979,(t30:6.804230313,(t31:5.371526764,t32:5.316392011):1.386086368):0.6198653572):9.2837654,((((t33:7.661553455,((t34:4.81922309,t35:4.80655203):2.285530784,((t36:2.399193469,t37:2.386797022):3.543124946,t38:5.903508041):1.139495806):0.3706503279):1.485478216,((((((t39:1.249810887,t40:1.009720025):3.222505534,t41:4.199880655):0.2249034456,t42:4.408594676):1.782827666,((((t43:3.885773584,t44:3.8152305):0.5912641955,t45:4.397884678):1.1948628,(t46:2.232434888,t47:2.099716195):3.324313836):0.4059008622,((t48:3.250999178,(t49:2.375085195,t50:2.216097338):0.8584598361):2.139996889,t51:5.18280041):0.3715944899):0.1120134456):0.423822987,(((t52:4.951568576,((t53:3.967527042,((t54:2.476033137,t55:2.441078743):0.7477633218,(t56:3.086352504,t57:2.878158727):0.08992699737):0.6974461224):0.6279518037,(t58:2.452004681,t59:2.407443896):1.798942701):0.3230758138):0.272434969,t60:4.585925788):0.5990648397,t61:5.111802946):0.2342021152):0.8811861023,(((((t62:4.482234841,(t63:3.338389134,t64:3.064660074):0.853663383):0.1605147443,t65:4.076536969):0.6970143066,(t66:2.492764816,((t67:1.301652277,t68:1.198139684):0.3040684345,(t69:0.2754423372,t70:0.1451872937):1.194833768):0.7148003836):2.17950837):0.7516642577,(t71:3.941693432,(((t72:3.368810572,(t73:0.9691541431,t74:0.8901409309):2.360439135):0.2105871274,t75:3.414125252):0.05963480307,t76:3.415900418):0.2200608229):0.9876284653):0.06332311781,(t77:2.151854088,t78:2.129564572):2.466345623):0.009535758308):0.9379912627):1.171212468,(((t79:3.537392034,((t80:1.808171848,t81:1.597265869):0.8284435586,(t82:1.979190881,t83:1.907602516):0.3642176643):0.8506015383):0.2964084603,(((((t84:0.941374647,t85:0.9270845489):0.4451463922,t86:1.362467889):0.6051244412,t87:1.913666606):0.3507063308,(t88:0.6029656755,t89:0.5704021936):1.514568994):0.6292622837,((t90:0.4316019063,t91:0.4136752776):1.313203353,t92:1.71970287):0.9251212342):0.2020099184):0.4331167031,(((((t93:1.042951107,t94:1.040596866):0.1333319654,t95:1.155473943):0.7352032523,((t96:0.8685572959,t97:0.7801350878):0.8503775227,t98:1.619995965):0.1503700947):0.1649400108,(t99:1.272395125,t100:1.183806897):0.4788561305):0.3458365981,t101:1.876885386):0.802312384):2.079500136):5.703277132,(((((t102:1.124082981,(t103:0.7516200591,t104:0.07536444879):0.2341408841):0.5282514142,(t105:0.6137922663,(t106:0.1468917809,t107:0.06527859089):0.3732376716):0.09191476753):1.24838027,t108:1.740518168):0.6874082798,(t109:1.405417042,((t110:0.9242592283,(t111:0.3574615565,t112:0.3431742146):0.55321712):0.2856953046,((t113:0.2874645217,t114:0.2629778068):0.1372941179,(t115:0.3209601519,t116:0.1347067844):0.07118124339):0.7241675916):0.128911071):0.8550318506):4.224172134,(((t117:0.3442412859,t118:0.2922537189):0.78068325,t119:0.8483233373):0.4151402277,t120:0.9796978705):4.08511269):2.51502421):0.5657150815):0.6426186325,(t121:0.8152096034,t122:0.7708800561):7.949120698):2.027085099):0.4738051901,((((t123:0.6911660799,t124:0.6662153167):8.41208854,((t125:0.9522534868,t126:0.9474885337):5.16968233,((((t127:0.7850386565,t128:0.5268651675):0.4905294517,(t129:0.04072672346,t130:0.04050621422):0.9371134469):0.2120021686,t131:1.103737493):0.1761609554,t133:1.133226753):4.403045082):2.941553091):0.2338164586,t135:8.241985701):0.8241636564,(((t136:4.586669928,(t137:0.4195238426,t138:0.3885334158):4.053042136):0.805533815,(t139:0.7160137037,t140:0.6102757652):4.343628157):1.196475425,(t141:4.261088245,(t142:3.487415492,((t143:1.918265019,t144:1.875914942):1.150656534,(t145:0.2782661703,t146:0.1679353945):2.703934899):0.4091579959):0.6844471617):1.856116939):2.417059969):0.9393110995):1.376915162,(((((t147:3.766383164,t148:3.725133694):1.444007745,(t149:0.1910897481,t150:0.1351049106):4.313962633):0.5700341785,t151:4.979067177):0.6453267207,(t152:4.738744127,((t153:0.4676847865,t154:0.4034695064):1.766093628,t155:2.064500027):2.214220877):0.8660615385):2.775707044,((t156:6.020145766,t157:6.007495379):1.54571363,((t158:7.080080116,((((t159:2.469101883,t160:2.093491125):3.109926986,(t161:1.178560202,t162:1.17353263):4.016215946):1.272863502,(t163:4.16787114,t164:3.972634535):2.212377807):0.03835830485,(((t165:4.828048379,t166:4.59231936):0.3924083439,(t167:4.022966074,(t168:0.1624634867,t169:0.1507368326):3.839774851):0.7440735767):0.414874161,((t170:2.490907147,t171:2.201458012):2.337088556,(t172:4.193426465,(t173:3.193784942,(t174:0.1897617794,t175:0.07414152202):2.982050614):0.8070853806):0.3418148455):0.1856140384):0.5552568613):0.08090787368):0.37612584,t176:5.348034476):0.03981390316):0.2908545825):1.338469292):0.4905172406,(t177:3.332999602,(t178:1.522380888,t179:1.51052654):1.537205531):4.033370465):2.845866392):0.6542198251):2.005875439):1.258949659,(((((t180:4.682856916,t181:4.576256836):0.01084923084,(((t182:1.278642209,t183:1.249937792):1.17158075,(t184:2.17547174,t185:2.133589687):0.1628478923):1.472785582,((t186:2.243342084,((t187:0.2784373614,t188:0.1739640536):1.48431014,t189:1.44933014):0.2999256554):1.158106103,(t190:1.923613476,(t191:0.8883309939,t192:0.7893468884):0.947368112):0.7523889378):0.1020438298):0.5169497996):0.4923176317,t193:3.554775881):1.323943541,(t194:1.853524276,((t195:0.7790468701,t196:0.7289618564):0.9793720709,t197:1.6955619):0.04762413598):2.907671254):0.8769774193,((((t198:2.881273502,((t199:1.032530202,t200:1.019633443):1.519272216,(((t201:0.3937707743,t202:0.3072725492):1.347307013,(t203:0.6058319074,t204:0.5788669468):1.016238402):0.6723166012,t205:2.218729353):0.1041284167):0.3193006895):0.9856318981,(t206:2.836375525,t207:2.800098253):0.7756724037):0.8937898182,(((((t208:1.813107417,t209:1.811113179):0.1929675113,((t210:0.4932758731,(t211:0.1219279991,t212:0.08037181024):0.3376426474):0.0007274983174,t213:0.3928318783):1.455019486):1.156535288,(((((t214:1.426730045,(t215:1.066231053,t216:1.054030721):0.2713432092):1.023704005,(t218:1.000092077,t219:0.9542160263):1.174238892):0.3503497607,t220:2.439227022):0.05526439006,(t221:2.381830455,((t222:1.214663198,t223:0.995592485):0.6965241947,(t224:0.3922800683,t225:0.2634607619):1.105260809):0.2705463211):0.03903723276):0.05608393291,(t226:1.088295781,(t227:0.645303602,t228:0.61899143):0.1332468909):0.5865989961):0.04972000842):0.8530823618,(t229:1.839831926,(t230:0.3171551097,t231:0.2399683799):1.496503593):0.3173535359):0.107336128,(t232:1.16666005,t233:1.080434195):0.6790228236):0.3082284579):0.1701336266,((t234:0.1478155971,t235:0.09242633112):0.8266183671,((t236:0.2768712348,t237:0.1886550623):0.3168658661,(t238:0.202177604,t239:0.1523973167):0.2911173229):0.2799410768):1.244418451):0.5689025633):6.410276404):0.3637933414):0.8001696307,t240:9.954018117):0.9370146992,(t241:0.1399613527,t242:0.1023972809):10.47698179):0.7355711228):0.5107373187):0.6823814752):8.216085365):2.652083655,(((t243:11.84205134,((((((t244:0.4412861836,t245:0.4346772508):0.463323055,t246:0.8728969701):0.6674622035,(t247:1.192037336,t248:0.6867001577):0.2435749487):6.618576329,(((((t249:0.4598084675,t250:0.4443630316):0.2228719287,t251:0.5300629291):0.2699479755,t252:0.6118071395):0.2011611224,t253:0.7389443795):0.9998254275,(t254:0.4876578342,t255:0.3901840234):1.242325619):5.244699084):2.714752569,(t256:7.00171502,((t257:5.802401286,(((t258:0.06632737882,t259:0.06431332344):0.1593288457,t260:0.1556058434):3.100261579,t261:3.030514845):2.4264109):0.7421818633,(t262:1.076986107,t263:1.038406952):4.899050483):0.4310346696):2.557330469):0.6007020741,((t264:1.209897896,(t265:0.567001137,t266:0.5474300883):0.5688103997):1.074103038,t267:2.056709521):7.208688012):0.2927261013):0.8268766537,(t268:9.182828178,((t269:8.543749507,(((t270:4.81285508,(t271:2.943244995,t272:2.647899022):1.383694522):2.412957394,(t273:0.9370267806,t274:0.8344299807):5.405920875):0.7418436196,((t275:0.3240157127,t276:0.2779660243):1.108118527,t277:1.355586318):5.296868491):0.4702753132):0.4675764961,(t278:6.806566441,(t279:5.726166997,t280:5.71769459):1.06715064):0.7446081948):0.09438946285):1.189155623):3.452942948,((t281:1.999834624,(t282:0.7166107802,t283:0.6506428376):1.243392795):4.947626632,(t284:6.71605311,(t285:6.550899147,((t286:2.175672608,t287:2.160388197):3.690474261,t288:5.739623618):0.6176407703):0.1258557421):0.06544958739):5.314992836):7.171691577):0.9824151286,((((((t289:0.6215154036,t291:0.4846619345):4.93334672,((t292:1.82166585,t293:1.56479181):0.01113035704,t294:1.538210633):3.559387861):0.04363798562,(t296:1.866660288,(t297:1.106666265,t298:1.017689048):0.6636885615):2.817700241):0.0344084503,((t299:2.912383553,t300:2.900743142):1.025726587,t301:3.834429638):0.4969659373):13.62634982,((((((t302:5.49811515,(t303:1.981061558,t304:1.953331906):3.495802006):0.02613845872,(((t305:2.712612237,t306:2.614819601):0.9560802792,t307:3.542130168):0.4054385676,t308:3.524794669):1.380347649):0.01635701959,(t309:3.78787237,t310:3.779595065):0.7507165929):0.6285784954,((t311:1.092279976,t312:1.073839474):2.487135905,t313:3.460248449):1.50081976):0.4468834854,((t314:4.138818557,((t316:2.006306116,(t317:1.90773996,t318:1.877137215):0.01694259847):0.9707761848,(t319:2.660192139,t320:2.624397085):0.1767717127):0.8989394241):0.141388283,(t321:3.510168368,(t322:3.34459352,(t323:0.9224757914,t324:0.8072862097):2.347787733):0.01499239636):0.0352735761):1.066917624):0.08250459842,(t325:3.724446497,(((t326:2.291099373,(t327:1.931492295,(t328:1.532394088,(t329:1.067096559,t330:1.048886479):0.4457012397):0.3342572367):0.09939780834):0.1245311116,t332:1.95146534):0.1250151704,(t333:1.651984535,(t334:1.267293128,t335:1.261943261):0.3808903603):0.3539209363):1.147383394):0.4934509644):11.11198175):0.540596258,(((((t336:0.6666750887,t337:0.6374214303):0.5928144103,t338:1.230041773):1.109617602,(((t339:1.041208906,t340:1.021895774):1.076509861,((((t341:0.1015770537,t342:0.03844288498):0.7616531542,t343:0.7313944501):0.5489955692,(t344:0.4522376605,t345:0.3224764354):0.7925747506):0.6169386733,t346:1.359195499):0.05573165192):0.1672906894,t347:1.566169983):0.004840709901):3.162503018,(t348:0.1188700409,t349:0.115723866):4.331059478):8.129101265,(((((t350:1.555075619,t351:1.479728916):2.800066259,(t352:3.146150073,((t353:0.2220314956,(t354:0.05570284737,t355:0.03137744399):0.1260451881):0.9590219023,(t356:0.1245599175,t357:0.1016974668):0.9605916237):1.777943223):0.8055663646):7.332528396,(((t358:0.05298200685,t359:0.0422135379):0.8887108387,t360:0.8436287037):7.686461829,((((t361:0.6479492446,t362:0.5142590783):0.5139808336,(t363:0.4045705162,t365:0.1677596923):0.5979749905):0.8734760213,((t366:0.5034588462,t367:0.4743351189):0.7008012152,t368:1.128124763):0.2499330608):0.6835906624,(t369:1.208002023,t371:0.9406305789):0.8324661544):5.767705133):2.321831113):0.3326448082,(((t372:0.1458834454,t373:0.06103876681):0.09724575606,t374:0.1089706801):2.690974646,(t375:1.76765534,t377:1.101051888):0.9419716118):7.198339663):0.2504265842,(((t378:0.4163174529,t379:0.2338184665):0.150594081,t380:0.2393366252):0.2937771726,(t381:0.1164004737,t382:0.005132770091):0.1826611573):8.54249177):0.2362351838):1.613262067):0.1040063643):0.5608493315):0.5151409321):22.28144982):0.8647743581,((((t383:1.82573221,t384:1.730571895):7.619256924,((t385:0.4322974056,t386:0.4156376917):2.678582353,t387:3.045960494):6.01198972):1.446437782,(t388:9.143975136,((((t389:0.1991447315,t390:0.1820962203):0.1011211295,t391:0.2613609924):2.528138016,(t392:1.713477216,t393:1.665543536):0.9753583755):5.598161476,((t394:5.84706395,t395:5.694323678):2.254485015,((((t396:0.43703461,t397:0.2626940853):3.561463345,t398:3.815329168):3.165328785,(t399:4.610901306,t400:4.541020759):2.185417851):0.6383468654,((t401:4.388818145,t402:4.045386478):2.738162929,(t403:3.145650999,(t404:2.650291474,t405:2.494964082):0.4352947402):3.504482014):0.1558165755):0.1456516854):0.1218743371):0.580968423):1.352896995):13.44337684,(((((t406:5.095920575,((t407:0.6403484734,t408:0.6335119636):4.103999361,(t409:3.020600826,t410:2.965743998):1.696445383):0.3125735946):0.2775774573,(t411:4.948618711,t412:4.861184678):0.2226022694):0.7934904565,(t413:0.3940583752,t414:0.3879814479):5.443819514):0.1459359068,t415:5.976359654):1.144069643,(t416:6.182118486,((t417:0.981372545,t418:0.9580772854):4.232986219,(t419:2.582325327,t420:2.558699794):2.607834173):0.7429616133):0.8676823685):14.62614614):10.40739371):25.7419092,(((((((((t421:2.115134089,(t422:0.8378099228,t423:0.7409724013):1.22060881):0.8925832105,t424:2.847809978):2.750684911,t425:5.586486369):0.1395328987,((t426:5.049897781,(((t427:3.676095982,(t428:0.9771965349,t429:0.8733374502):2.646255307):0.243066549,(t430:1.76168549,t431:1.642373286):1.878627517):0.4550211205,t432:3.924717478):0.3776300422):0.3003897067,t433:4.555457194):0.2582770535):0.6380982421,(t434:4.85265076,(t435:4.128820117,(t436:3.653359372,((t437:1.38072591,t438:1.217742959):0.1948264519,t439:1.378144448):1.440852976):0.4303246345):0.6558630807):0.5785942852):1.65953439,((t440:3.762451998,t441:3.580724938):1.254307524,((t442:3.430408955,t443:3.414514087):0.6234225173,((t444:1.753544041,t445:1.680454116):1.756598772,(t446:1.7852291,t447:1.647984318):1.534236728):0.4237013325):0.6549702562):1.020511779):0.3766046244,(t448:4.838488065,(((t449:0.0899392746,t450:0.04101824552):2.256211834,t451:2.180201412):1.214372764,(t452:3.109747717,(t453:1.445106862,(t454:0.6627213813,t456:0.5054420524):0.70064441):1.440200049):0.1720819983):1.073180103):0.7194084315):13.49810601,(t457:3.022853865,(((t458:0.2471771695,t459:0.234521603):1.550056952,t460:1.781657163):0.5346759214,(((t461:0.5245435871,t462:0.4709367761):1.418225975,t463:1.830301363):0.2094469657,t464:2.028072986):0.1085463329):0.6654199557):15.08310403):33.25173345,((t465:1.291841932,(t466:1.121326536,t467:1.022690715):0.1498039855):13.54985962,((t468:1.805052309,(((t469:0.4018671652,t470:0.3620847002):0.6831665238,t471:0.9596558295):0.4737595973,(t472:1.150108878,t473:1.093131705):0.276757674):0.2128007797):3.202148203,((t474:1.828845405,((t475:0.3837800519,t476:0.3228182587):0.9527740401,t477:1.05521622):0.1716521678):0.5674562164,(((t478:0.552197665,(t479:0.1333843135,t480:0.004508666768):0.3856946583):0.1060643188,t481:0.4012922129):0.2026542445,t482:0.3235593338):0.9153175019):2.384018157):9.620781693):36.23698879):2.202493314);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T41.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
