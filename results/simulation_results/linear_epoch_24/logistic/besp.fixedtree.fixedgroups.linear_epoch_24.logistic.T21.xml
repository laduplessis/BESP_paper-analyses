<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t452:1.603118588,(t453:0.3420830734,t454:0.2290143722):1.223660219):14.53161288,(((((t455:1.312565108,t456:1.217804333):0.6483777536,t457:1.606657082):1.825005848,(((t459:1.082025276,t460:0.86001139):1.145232937,(((t461:0.7392350783,t462:0.7334267347):0.01422911109,t463:0.4556951654):1.163777485,((t464:0.800996031,(t465:0.7201139721,t466:0.6251530339):0.07735455825):0.05792872647,t467:0.7217485041):0.756715664):0.03440733568):0.4955735584,((t468:0.8929800213,(t469:0.254587933,t470:0.1327148052):0.6131725291):0.4713872652,(t471:1.071685754,(((t472:0.2904935594,t473:0.2692773866):0.3188364598,t474:0.5543462957):0.3107176459,((t475:0.1004804816,t476:0.05242766448):0.5067581603,t477:0.5451383213):0.0739513097):0.1229782297):0.1074763881):0.5076115724):0.5170632552):1.215068114,((t478:0.854774659,t479:0.845051364):0.03006571823,(t480:0.2320030219,t481:0.1733805914):0.4556642004):2.007529756):0.6505722169,t482:3.090402753):10.32592967):9.195998896,((t483:2.11552633,t484:1.964577396):4.473825933,(t485:0.9060239113,t486:0.6143297707):5.411898039):15.98067353):1.733227648,(((((t458:0.03812239494,(t423:0.3689165259,((t364:0.08373761806,((t360:0.0751446475,(((((t354:0.1252183245,t355:0.1040520175):0.09287744133,t356:0.1767983054):0.1137060408,t357:0.253697597):0.3147653492,(t359:0.1231577594,(t358:0.1062364452,((t344:0.3457501613,((t267:0.4302836305,t269:0.1898230289):0.1530869438,((t268:0.08462079594,((((((((t243:0.07680056706,((t240:0.03766939795,(t197:0.0418860759,(((t139:0.0368048808,(t136:0.09148517086,(t126:0.04246524782,(((t99:0.02772327323,t1:8.883184821):2.012110081,((t2:1.649713793,t3:1.631987336):7.121905952,((((t4:0.4772260862,t5:0.3098998859):4.893986696,t6:4.922373142):0.6336154074,((t7:5.346431427,((t8:0.5338211905,t9:0.1829847663):0.7509521316,t10:0.5918838687):3.966177997):0.1202346641,((t11:1.049988521,(t12:0.408210148,t13:0.2988105458):0.5024189226):3.49376426,t14:4.25617249):0.1053327606):0.02906401234):0.9634738826,(t15:4.766462215,t16:4.753226633):0.5594684321):1.771380178):2.009461957):1.015920114,(t17:8.916541054,((t18:0.4977835512,t19:0.4212259345):3.811455002,(t20:3.808522929,t21:3.804129579):0.009258799214):4.585239698):1.179955776):0.5561255707):0.7222126304):0.3013835341):1.993905167,(((((((((t22:3.774453557,t23:3.614038131):1.018221832,t24:4.306013895):2.906319358,(t25:6.772955981,(t26:1.27602603,t27:1.172903112):5.448993963):0.4066069696):0.1647533022,((t28:6.259702034,(t29:2.684790355,t30:2.615466526):3.48630354):0.6521591542,((t31:3.817002968,(t32:0.6918465476,(t33:0.5728012149,t34:0.4866004775):0.09968277683):3.022395673):2.15485152,t35:5.669262001):0.7125412658):0.2387704938):0.3237016551,(t36:4.545524506,t37:4.541754804):2.362744641):0.2968376659,(((t38:4.765837103,t39:4.642194104):0.96695066,(t40:0.916930114,t41:0.9008655223):4.629451577):1.152383833,((t42:2.949491876,t43:2.923837839):3.615679651,((((t44:0.04950655389,t45:0.00718717182):1.450468679,t46:1.39175076):2.370028147,t47:3.593895059):0.806340999,(t48:4.268699419,(t49:1.469709221,t50:1.437804152):2.659568569):0.0993375365):1.782579502):0.09811950375):0.2975933287):0.8357078345,(((t51:4.441781716,t52:4.310337846):0.7256363342,(t53:3.776234536,(t54:2.546728672,t55:2.517941248):1.189930716):1.251793899):1.173188002,(t56:2.749835209,((t57:0.4287243469,t58:0.4256418657):1.226127135,(t59:0.4025144739,t60:0.3976078815):1.235778151):1.051194816):3.251326073):0.8231769124):0.3697217578,(t61:3.267676042,t62:3.178580547):3.740955954):0.9007958781,(((((t63:3.26631115,t64:3.245563507):1.243559976,t65:4.469194279):0.6061595147,(((t66:3.633868173,t67:3.489782479):0.3186607662,t68:3.750889196):0.8468197832,((t69:2.416702172,(t70:0.5515043164,t71:0.3966821438):1.657544418):0.8943809577,t72:2.835911244):1.10232485):0.2388257549):0.1045833603,t73:4.249473853):1.186734051,t74:5.286975417):1.343006563):2.423724459):1.209630918,(((t75:2.667945791,t76:2.579311319):1.088716175,((t77:2.170841715,(t78:1.291982595,t79:1.26129921):0.5452404073):1.077769596,t80:2.76172392):0.22499912):2.330046443,(t81:4.678355744,(t82:0.08994628606,t83:0.04597404577):4.163831725):0.4057873998):4.141603808):2.166384012):4.032230943):0.1001734998,((t84:1.824311229,t85:1.816803102):0.0297344194,(t86:0.7247182717,t87:0.6167723466):1.095906345):13.1510133):0.2732303464):0.1362006084,(t88:14.75691523,(((((t89:0.7656002254,t90:0.6889511007):1.909002143,(t91:2.439090844,((t92:1.161597943,(t93:1.112374729,t94:1.079439329):0.0336436477):1.137689886,t95:2.229426064):0.1012478952):0.09948560537):0.5195748493,t96:2.848135648):1.55238219,(((((((t97:0.3687082881,t98:0.1490868552):0.8050485994,t100:0.8863756134):0.1676596395,((t101:0.1516899386,t102:0.002143852703):0.7331246331,t103:0.5898158002):0.07500485506):0.2472073871,((t104:0.3868729512,t105:0.2818157294):0.1716114604,(t106:0.07093815322,t107:0.04744294195):0.05187053815):0.05708327885):0.3275939586,t108:0.4705963329):0.469703531,(t109:0.4307473755,t110:0.2916100623):0.4615532838):1.104206526,(t111:0.562565556,t112:0.526092944):1.293852128):0.7990549565):5.405083487,(t113:0.2989620052,t114:0.1893174618):7.597044966):4.561571714):0.5157960324):0.2423488657,((t115:0.2989729507,t116:0.2851782524):1.341421433,((t117:0.1914575457,t118:0.12652511):0.6814291659,(t119:0.4967747255,t120:0.4277779357):0.01408491239):0.4298912476):11.39209935):0.04706321519,((((t121:0.40338962,t122:0.3221897165):2.874277354,((t123:2.052806384,((t124:0.4787878412,t125:0.2911918549):1.053174533,(t127:0.020861674,t128:0.006259648964):1.141835527):0.5093272775):0.04753280103,t129:1.541072761):0.6411517587):8.20978653,(((((t130:0.5174085564,t131:0.3544738154):0.3570933603,t132:0.6840566296):0.2671293307,((t133:0.01957439945,t134:0.003769992258):0.4922726049,t135:0.3923346731):0.4101557763):4.464844348,(t137:1.39977332,(t138:0.3470479554,t140:0.2211825937):0.8644167914):3.719774641):4.405600124,(t141:5.372575902,t142:5.372387912):3.822274072):0.3197611317):0.2501766266,((t143:0.5596199055,t144:0.5367691993):8.223607658,(t145:3.711958797,(t146:3.47427211,(t147:2.625009076,t148:2.613048245):0.8437591643):0.2367072161):5.016537787):0.9773713007):0.3849808568):0.8413763264,(((((((t149:1.54575436,t150:1.462627921):0.8577848559,t151:2.304917959):4.430532038,(t152:0.4502087096,t153:0.3961560992):6.251931124):0.5268050037,((t154:4.747915969,(t155:0.7047439185,t156:0.3087150688):3.87673311):1.515782347,t157:5.502724021):0.8710815056):1.575346766,(t158:7.330999384,(t159:6.296936658,(t160:5.1551211,t161:4.796696332):0.9617860896):0.7926051604):0.5096802912):0.5510812268,(t162:6.614403677,t163:6.566092662):0.9795304636):0.6508123584,((t164:2.801563175,t165:2.772102503):4.580714177,((t166:6.568924927,(t167:0.2220719102,t168:0.179604418):6.166115766):0.5045194626,(((t169:5.685110038,(t170:2.866034576,t171:2.840477773):2.739813194):0.0668667747,(t172:0.2634850561,t173:0.2400456171):5.228104698):0.76708297,t174:6.204611065):0.1816834113):0.2436520317):0.7931982006):0.7048334226):0.16835607,(t175:5.58258291,t176:5.535198548):2.573395453):0.1917425827,((t177:3.115825598,(t178:2.090519525,t179:1.879339858):1.006777697):1.766115277,t180:4.615823324):3.246165718):0.7915299015,(((t181:6.177265942,((((t182:2.392646953,t183:2.295419499):2.164455028,t184:4.226391515):0.4551606187,t185:4.656635477):0.5878200917,(((t186:1.726272629,t187:1.288124111):2.115566777,t188:3.382323055):1.321342766,((t189:1.028060362,t190:0.8275940439):2.937598556,(t191:2.881741071,(t192:2.434425642,t193:2.411930324):0.3243732065):0.8167997803):0.5536589459):0.005323577347):0.5025575592):1.994822281,(((((t194:0.4457570688,t195:0.4286386232):2.306541899,(t196:1.962926591,(t198:1.310652174,t199:1.17885482):0.4597446374):0.7429728513):1.950351018,(((t200:1.675103532,t201:1.522575676):0.9098119392,(t202:0.6190706274,t203:0.3741196563):1.783952656):0.04645403253,t204:2.191903379):1.68824066):1.168618376,(((((((t205:2.545870867,(((t206:1.264770043,(t207:0.8950357284,t208:0.851333805):0.1456987805):0.004484991324,t209:0.9875339728):0.4317169461,t210:1.412566205):0.7753179491):0.7094473938,((t211:0.6694736855,t212:0.6413392715):1.759090508,(t213:2.369770593,t214:2.355119373):0.006567562167):0.2899519545):0.2240349997,(((t215:1.981887013,t216:1.978248983):0.04178931588,(t217:1.407102724,t218:1.184205165):0.5158286272):0.5724175024,(t219:2.171608122,((t220:0.6198379085,t221:0.3020105249):0.3950502788,t222:0.2307642231):0.8885352551):0.06625683735):0.1219475952):0.1945055406,t223:1.292777869):0.01876523459,(t224:0.08106456043,t225:0.07911401426):1.194001717):0.2857994554,(t226:0.4624346236,t227:0.4141535868):1.075027759):0.3672409161,((t228:0.5950046178,t229:0.5616164674):0.130071813,(t230:0.05686877244,t231:0.03638187418):0.6207994804):1.130760073):0.6831605303):0.3276892572,t232:2.771326382):0.360836649):0.05103091627,((t233:0.9445223711,t234:0.7994420361):2.202329715,(((t235:0.8064852464,t236:0.6681714449):1.038012011,((t237:0.7171992277,(t238:0.3375309329,t239:0.2476215405):0.2973801935):0.5201441751,(t241:0.7692465787,t242:0.7586063417):0.1051441009):0.4301945121):0.1704836963,t244:1.076596972):0.8481831205):0.02420102698):0.3700821836):0.2966393761):0.1350368311,t245:2.706439764):0.3518676025):7.210690502):0.02989866233,(((t246:0.6098484182,t247:0.4801274533):7.734701914,(t248:7.998653462,t249:7.894385577):0.1214406653):1.403355991,((t250:1.402686029,t251:1.164318342):5.403415522,(t252:3.21008877,t253:3.131013159):3.062718341):2.182637103):0.5220449064):1.145547359):0.3051300238):0.028155162):0.1278632736,(t254:0.7741991973,t255:0.7178402792):9.367855464):0.008725544477):0.1121596897,(((((t256:2.88058439,t257:2.851919609):5.776654943,t258:8.580826296):0.3253095564,t259:8.852340021):0.279283489,(t260:8.224772989,(t261:7.208088286,(t262:7.072057635,(t263:6.85027815,t264:6.759370717):0.1850963053):0.1037544472):0.9436421522):0.8319140403):0.5779038895,(t265:8.735714813,(((t266:5.490042334,t270:4.533328706):2.035429836,(t271:2.919295385,(t272:2.740852157,t273:2.722765358):0.04555323915):3.566510025):0.9765575661,t274:7.040121989):0.2034412537):0.6634147402):0.3605146426):0.518612851):0.6707206474,(((t275:6.605291995,(t276:2.167016552,t277:2.038248702):4.423508342):1.003308622,((((t278:3.769853159,(t279:2.351933672,(t280:1.630424755,t281:1.604001012):0.6934871407):1.407168083):2.668529338,t282:6.352221763):0.3413553311,((t283:2.267719363,t284:2.158654632):2.673318636,t285:4.777009491):1.716482996):0.2834433017,((t286:1.214594041,((t287:1.126124068,t288:1.060535238):0.0400474025,t289:1.017697487):0.02039528897):1.142664616,t290:2.136832174):4.392566486):0.2188210007):0.1613731603,(t291:5.795984476,(t292:2.99383015,t293:2.940506096):2.643929346):1.000674542):1.661654427):5.937158532):2.687409309):0.9573511956,((((t294:4.956433584,t295:4.931723753):0.6297039935,t296:5.489038036):0.313951661,((t297:5.310281156,((t298:1.276418845,t299:1.02519647):3.74904615,t300:4.758679413):0.2550963493):0.3962758577,(((t301:3.06868879,t302:2.952414198):1.111605323,(t303:2.914759296,((t304:0.9507926115,t305:0.8683067038):0.9706370711,t306:1.769553711):0.9443613841):1.039211403):0.8550691391,t307:4.533537835):0.3717728205):0.09108184899):3.336814801,((((t308:2.174836291,(t309:1.112739838,t310:1.032094168):0.920584283):2.439321606,t311:4.005038157):1.101451196,(t312:3.072281421,t313:2.956724939):2.000814404):2.330469773,((((t314:3.482462493,t315:3.45670216):1.535742947,(t316:4.408475092,((((t317:0.3496209914,t318:0.2788591576):2.523682938,t319:2.764016317):0.7671733113,((((t320:1.568754936,t321:1.498695643):1.085026064,t322:2.527780311):0.5059831376,(t323:2.808696662,(t324:1.86724321,(t325:0.9101432213,t326:0.7840040173):0.9291222725):0.6520351115):0.1730543003):0.05007318796,t327:2.428033453):0.3212843998):0.2810652956,(t328:2.074656433,(t329:0.9971263415,t330:0.8794484624):1.069553698):0.9549837622):0.3982064471):0.2442018458):1.186366988,(t331:2.199683521,(t332:2.117967011,t333:2.013659126):0.03832863685):2.491188458):0.07084308727,(((((t334:0.1343473139,t335:0.04667071847):1.501633836,(t336:0.7698338568,t337:0.760006074):0.7018031801):0.6605444684,t338:2.100005145):1.08639039,(t339:1.628425419,t340:1.397017889):1.524615466):0.3817778443,((t341:1.683553612,((t342:0.6937975325,t343:0.6352308057):0.4360062132,t345:0.4227071229):0.478868994):0.4197418454,(t346:1.279366656,(t347:0.2686642529,t348:0.2480125547):0.9952408475):0.02456476262):0.9042961007):0.4830196456):0.9821164483):0.1826280254):8.363725734):0.3696097329,((((t349:0.3266923368,t350:0.3141779202):1.73285017,t351:2.045980154):1.381706883,(t352:1.881973775,t353:1.575192182):1.489410031):8.388084315,(((((t361:0.7644750344,t362:0.7507540266):0.4415366977,t363:1.148451586):5.961057785,t365:6.660715214):1.658395943,(t366:5.841267141,((t367:0.7876832172,t368:0.6683592097):2.268835114,(t369:0.7193402677,t370:0.5876160228):2.026455474):2.680411842):2.469046262):1.189430486,t371:8.390366783):0.4659997915):0.614372903):2.49898284,(t372:6.608702725,((t373:0.8422947878,t374:0.7459464034):5.235663013,(t375:0.3757484506,t376:0.3387166474):5.408852534):0.5156075021):5.049294404):8.380387543,(((((((t377:3.295560367,t378:3.227269666):3.353657151,((t379:2.335274484,t380:2.131373793):1.485249885,t381:3.557590458):2.755851047):0.0994363354,(t382:4.385741562,t383:4.150057686):1.902806798):2.465970988,(((t384:4.527265711,t385:4.19142304):0.6548847768,((t386:0.392284967,t387:0.2692754599):2.830129791,t388:3.077835841):1.412466239):1.35887863,t389:5.730582807):1.890175287):0.6171707603,((((t390:2.454092322,((t391:0.7303073832,t392:0.6819016609):1.387685842,(t393:1.598150255,(t394:0.8266254229,t395:0.8021960514):0.650006445):0.3882006629):0.2315342882):3.22360984,t396:5.293161626):1.195161522,(((t397:4.858707793,t398:4.630244139):0.01604834687,t399:4.618267086):0.7987251412,((t400:4.519784698,t401:4.505937978):0.7512167727,(t402:5.174367294,t403:5.15785984):0.0710132625):0.0829004193):0.8075098136):0.03232657972,(((t404:4.066548678,t405:3.944565465):1.640433501,t406:5.560022829):0.3060153133,((t407:0.8507774024,t408:0.7527233426):0.5155927565,t409:1.229919372):4.474310362):0.07524875453):1.328822204):0.09917279816,(((((t410:4.504492729,((t411:3.404562904,t412:3.29994935):0.7703876209,(t413:3.468541236,t414:3.366270256):0.3922610191):0.3080403362):1.389936848,(((t415:2.185700928,t416:1.924537103):2.202985001,((t417:0.1535617103,t418:0.1037620966):2.392298266,t419:2.2697708):1.404388027):0.3935654338,(t420:3.789736402,t421:3.78533247):0.239265884):0.6328627813):0.3344805236,((t422:4.14809961,t424:3.490854057):0.5717520641,(t425:1.336104841,t426:1.157590877):2.685311811):0.2557974188):0.37766499,(t427:3.985460844,t428:3.809803943):0.296785739):0.2798945219,(((t429:1.589531562,t430:1.483167679):1.467288348,(t431:2.666347617,t432:2.628809792):0.1794783282):1.23167625,(((t433:0.6845622284,(t434:0.5310659284,t435:0.4380750192):0.1462014654):2.204394575,((((t436:0.9735097923,t437:0.8375304565):0.2715176675,t438:1.068248269):1.030745983,(((t439:0.4729365793,t440:0.4559163919):1.376798124,(t441:1.421655652,t442:1.414435188):0.2839852981):0.1208191809,(t443:1.00589493,t444:0.9898703501):0.8085473782):0.1004302754):0.01661821857,t445:1.819068934):0.3160036657):0.5531329227,t446:2.635953439):0.5424703044):0.05041990531):0.224154143):0.6376087594,(t447:2.800302972,(t448:0.8987151685,(t449:0.8223320726,(t450:0.6422797797,t451:0.5682732274):0.05329484199):0.06452741122):1.868380412):1.284672298):9.051187998):14.2029861);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T21.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
