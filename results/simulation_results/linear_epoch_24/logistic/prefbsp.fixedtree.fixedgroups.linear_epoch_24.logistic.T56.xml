<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t406:2.10550656,t407:2.091211336):3.525912838,(t408:5.485528613,((t409:4.306250067,t411:4.018338906):0.9123471451,t412:4.911917181):0.2184813389):0.03200667448):0.7346394923,t413:5.862943043):0.6189814789,((((t414:1.118387713,t415:0.8922307081):1.760422679,t416:2.480208115):1.738857759,t417:4.190661165):0.7652373738,t418:4.945803604):1.091277986):0.4281982586,(t419:4.664637311,(t420:3.259003707,(t421:0.8842955505,t422:0.7681021973):2.362148935):1.361085373):1.750776658):23.0346462,(((t423:4.138404779,t424:4.1242009):2.13334289,t425:6.023457914):4.404607562,(((t426:5.748264443,(((t427:4.014203841,t428:3.961149247):0.1421426466,t429:4.098521484):1.082748077,(t430:4.683027024,((t431:2.660379399,t432:2.649656395):1.466418267,((t433:1.918572412,t434:1.778089959):0.4714063525,t435:2.20514523):1.693821776):0.5282716236):0.3457971465):0.3998218392):0.5596622994,((((t436:3.500570893,(t437:2.365977088,t438:2.327020717):1.082374745):0.2788983778,(((t439:3.147991536,t440:3.095902279):0.006487176755,(t441:2.439884869,(t442:2.33298472,t443:2.330332614):0.004237339947):0.562472059):0.2010256804,t444:2.997634192):0.2963375375):0.9543613613,((((t445:0.4972331491,t446:0.3794165882):0.4055255839,t447:0.638399853):0.9754224927,t448:1.448218507):1.167353368,(t449:2.018348408,t450:1.965030967):0.4948035092):1.167168216):0.140879971,(((t451:2.141695747,(t452:1.084025629,t453:1.019817942):0.9594493271):0.7555964659,t454:2.694555944):0.2264790366,(((t455:0.6268519955,t456:0.5351179117):1.505076662,t457:1.857606914):0.5954457762,(((t458:0.9537094995,t459:0.8938560892):0.6417538463,(t460:0.1481707928,t461:0.04781717234):1.308370034):0.2867308923,t462:1.636331608):0.5670674267):0.126111364):0.5768284581):0.563142683):0.5201106137,(t464:1.978111807,t465:1.869264484):1.77119837):3.549745254):18.58259181):61.55746479,(((((t466:0.7966566621,t467:0.7662330833):2.36412021,(t468:1.781956182,((t469:0.4022066008,t470:0.3357278729):0.1543114813,t471:0.327722914):0.883200897):1.198224469):1.01887443,(t472:3.107257313,((t480:0.9185426058,(t481:0.09938603761,t482:0.08704033149):0.4516511165):0.7193311019,t484:1.132060318):0.3298870708):0.2509852102):10.0628472,t485:11.55499602):5.476962682,((((t483:0.01864502326,(((t473:0.3588071158,(t474:0.115414798,t475:0.09958407586):0.2104789933):0.1811812521,t476:0.4008731456):0.4850841382,((t477:0.2409795978,t478:0.2281930879):0.4153192261,(t479:0.2621140112,((t463:0.02282806019,((t410:0.0176317158,((((((((t331:0.06477629361,((t243:0.4808817166,(t244:0.2975510292,t245:0.114581147):0.01969254835):0.2306946676,((t232:0.169678224,(t219:0.0501724557,(t154:0.04296703303,(t132:0.06683388354,(((((((t102:0.2194186744,(((t1:2.55978157,((t2:1.902391642,t3:1.806283675):0.4091179098,t4:2.149715164):0.05820827065):1.504733972,(t5:2.546448297,t6:2.189020079):0.9668088528):0.6995343061,t7:3.844697209):4.206920536):1.03073822,(((t8:0.5280309629,t9:0.4394787659):0.3512494417,(t10:0.3509890093,t11:0.08771458601):0.3341726697):2.92681201,t12:3.267940938):5.181664007):0.6467453338,(((t13:2.241104139,t14:2.201487216):0.9146392996,t15:3.061476753):5.694248759,((t16:7.02801803,((t17:1.580388941,t18:1.487227348):0.4413775737,t19:1.856261595):4.965010505):0.7777650813,((((t20:0.0949182483,t21:0.03301927779):2.040197394,t22:1.907123387):0.2479924231,t23:2.142172595):0.1134548257,t24:2.165385551):5.079196658):0.8962160394):0.2235223631):0.7597331081,t25:9.10129487):0.4869857796,((t26:6.418913846,t27:6.146425255):1.488262347,(((t28:0.6591013067,t29:0.4469588555):4.893828574,((t30:3.763224049,(t31:2.76636422,t32:2.717416028):0.9623156184):0.6211057276,t33:4.261157053):0.8047288179):1.195755002,((t34:1.813885244,t35:1.692413578):1.106630757,t36:2.716457264):3.322168908):0.6649852602):1.615951977):0.07884052248,(((t37:6.376428812,(t38:5.317811935,t39:5.295627224):1.037581953):1.030050896,(((t40:2.235916947,(t41:0.4979160991,t42:0.423367376):1.735933085):1.76450682,t43:3.90404235):1.523729569,t44:5.400291644):1.807009599):0.09765861653,((t45:4.498003217,((t46:2.04654517,((t47:0.2831674866,t48:0.275208477):0.9757332312,t49:1.204171251):0.7755828164):2.37604055,t50:4.239828846):0.05156536449):1.612223283,(t51:2.81982884,(t52:0.3945664322,t53:0.3565570215):2.410301664):2.997222631):0.7459233641):0.8638115935):0.08852442401,((t54:6.266083956,(((t55:3.063323237,t56:3.031522824):1.942818018,(((t57:0.3161602067,t58:0.2630999396):2.808982276,t59:3.053290525):1.629672843,t60:4.31948042):0.09194779488):0.625715015,((t61:1.517614575,(t62:0.5607151199,t63:0.4465400298):0.891458405):2.381505022,(t64:2.764050251,t65:2.75650972):0.8791312256):1.118899183):0.6052043939):0.7075622995,t66:6.032755607):0.3371773338):0.5718292373):1.33976753):6.334348153):1.396695689):0.5623841224,((((((((t67:2.873230735,(t68:0.8097222402,t69:0.7296442865):1.837763631):2.952106264,((((t70:4.770000646,t71:4.638912313):0.5249061133,(t72:1.658843896,t73:1.583904808):3.090930063):0.05622706482,((t74:2.876912913,(t75:1.201014043,t76:0.757756394):1.620907518):1.544231497,(t77:2.594103541,t78:2.589982653):1.222356636):0.2855690095):0.134470497,((t79:0.8191883103,t80:0.8030915833):2.562550673,(t81:3.156493195,((((t82:0.8722971115,t83:0.8699083017):0.3681183452,(t84:0.3697356143,t85:0.2677191048):0.8571683486):1.056778673,(t86:1.839484102,t87:1.75762803):0.2994240247):0.1674556779,t88:2.045453366):0.639348304):0.2017393175):0.8475068006):0.02661213487):0.7728368445,(t89:3.665691357,((((t90:2.127833086,((t91:0.8144884452,t92:0.8047484744):0.5002797808,(t93:0.4389143175,t94:0.3093586451):0.8648584059):0.7213620858):0.09417588025,t95:1.977723258):0.5738169505,((t96:0.4334846298,t97:0.3820590546):0.8946434752,t98:1.253131163):1.205793755):0.5362652667,(t99:1.785274029,t100:1.594311451):1.149870481):0.316881852):0.7468578967):0.590247887,((t101:1.789961971,t103:1.366941967):1.731822138,((t104:0.8990590831,t105:0.7766175538):0.01716709598,t106:0.6520893948):2.151385031):0.8435689037):0.5659141996,t107:4.202254666):2.216543144,((t108:1.67870753,(t109:0.8540661771,t110:0.5115949328):0.5944442565):0.5648343716,(((t111:0.6707007267,t112:0.664614129):0.0438801171,(t113:0.3610804613,t114:0.2424082943):0.3206421146):0.5189223372,t115:1.056173044):0.3939862555):3.951818572):3.53175882,((((t116:1.628154269,t117:1.623631566):0.2868715801,(((((t118:0.1984896181,t119:0.1881227438):0.4532658125,((t120:0.09244423333,t121:0.05282843971):0.1598029751,t122:0.02906900708):0.07203328296):0.1947201261,t123:0.1537763492):0.03975492156,t124:0.0004758790282):0.7724119404,t125:0.5632743272):0.08103426444):1.946945541,((t126:0.1645348733,t127:0.1621648892):0.9301500025,t128:1.078263534):1.396613559):3.854220753,(((t129:0.7174605075,t130:0.7113321861):1.020675519,(t131:0.165754386,t133:0.006673106226):1.156683979):0.5579401002,(t134:0.1371561077,t135:0.06074103367):1.578722804):3.601805375):1.202632755):2.667476445,t136:9.098872521):0.3635567786):1.126911691):8.902130691):2.598984103,((((((t137:1.060494015,t138:1.05095945):0.9463162791,t139:1.983970872):4.325674761,((t140:0.1076995973,t141:0.08201313391):0.3428093283,t142:0.2887159297):5.823746903):13.11947173,(((((t143:4.450215582,(t144:0.7342872309,(t145:0.309646365,t146:0.1073823508):0.3521278579):3.69597481):2.960282837,t147:6.985618977):1.449472373,(t148:1.536303799,t149:1.517092793):6.857070545):0.7366478077,(((t150:8.000512122,(t151:2.093493362,t152:2.092202002):5.906921263):0.7609523435,((t153:8.162383703,(t155:7.375691778,(t156:0.5364627676,t157:0.4208583758):6.703458065):0.01181841339):0.4905877404,((t158:1.182601524,t159:1.178165561):5.675884244,((t160:6.612038646,(t161:4.385430821,(t162:0.2595538782,(t163:0.09936704837,t164:0.08364101571):0.132840867):4.113844531):2.210550962):0.2067446682,((t165:2.19001887,t166:2.126879042):3.710639344,((t167:0.638708896,t168:0.5953579974):5.082618333,((t169:1.161599994,t170:1.082826075):2.50349433,(t171:0.06670006719,t172:0.04127100232):3.509161199):2.004593726):0.06967297873):0.7070639268):0.02307982196):0.244006434):0.08239278802):0.3387057778,(t173:5.42043874,(t174:1.202402571,t175:1.142343869):4.072372927):1.566097435):0.007042405434):0.5358037649,t176:7.179722187):8.838395257):0.1793683697,(t177:15.56314129,(((((t178:2.777480444,t179:2.755211263):3.526559745,(t180:4.790836072,t181:4.713274198):1.373578928):1.043878626,(((t182:2.635112106,(t183:0.140329818,t184:0.1313913602):2.486655336):2.896687717,(t185:5.055854846,(t186:4.581900883,t187:4.527069418):0.447766337):0.3519498639):0.8309016781,(((t188:4.149407739,t189:4.127981627):0.5881492384,(t190:4.151813754,t191:4.056847351):0.496609888):0.630422605,(t192:4.703109583,(((t193:1.547082743,(t194:0.7118493569,t195:0.6970598231):0.7826995787):1.449038388,(t196:1.586325131,(t197:1.071032935,t198:0.9839932028):0.4706044208):1.33880091):0.776627488,t199:3.324576577):0.9289938653):0.2645251734):0.7094344335):0.71129009):0.3693065269,t200:5.74860994):2.942269522,((((t201:2.848138427,((t202:0.03805950551,t203:0.02389158576):2.153907004,t204:2.052020031):0.4055950641):0.2859349006,t205:2.625888213):1.300662795,((t206:3.386476779,(t207:3.128111208,t208:3.034744967):0.1153646254):0.3258924276,(((t209:2.586433581,((((t210:1.938334115,t211:1.803495494):0.1343639927,(t212:0.606058762,t213:0.5991691203):1.18752758):0.01093225357,t214:1.704707944):0.4328704191,(t215:2.127822682,t216:2.122159051):0.004770182156):0.0667110114):0.1834589611,((t217:1.329133775,t218:1.135741859):0.01961060719,t220:0.977895046):0.9356733547):0.03851961247,t221:1.742124976):0.6592666758):0.1929227047):1.803480647,(t222:4.316323846,(((((t223:1.834392064,t224:1.801011513):0.08597658235,(t225:1.146516145,t226:1.015369449):0.5444576024):0.2578308853,(t227:1.086337553,t228:1.035993035):0.5303613427):0.5280055135,t229:2.027839641):1.014099066,((t230:1.095142096,(t231:0.8170884168,t233:0.375113511):0.2759481734):1.837901308,((((t234:0.3976640147,(t235:0.1309358312,t236:0.0730055028):0.04081895273):0.06532151794,t237:0.1647247242):0.01231396968,t238:0.1505783131):0.5652260621,t239:0.6924219108):1.308350144):0.005836448876):0.5936072598):0.0614037806):2.237654128):4.82067246):0.464907687):1.137800656,(((((t240:0.7749031651,t241:0.7719302368):2.323322141,((t242:1.399761789,t246:0.2527468912):0.6425246357,t247:0.7106740608):0.9088229001):0.3518649756,t248:1.959774341):4.421895577,t249:6.251742824):0.07612837855,(t250:0.6935415289,t251:0.6819892729):5.383295869):3.240395596):1.22565598):0.1573700232,(t252:1.263268468,t253:0.560989647):9.256171696):0.5789563799,(((t254:3.874045854,((t255:1.11595242,t256:1.077986261):2.076078724,(t257:0.3991133917,t258:0.261947299):2.753190827):0.4116468661):2.986688651,t259:6.362351817):2.694500715,(t260:8.418053671,((t261:0.3516024254,t262:0.04742805103):4.714599315,t263:4.489409526):3.326077134):0.6242422049):0.6968644523):0.5463392393,(((((t264:3.831385198,t265:3.81854845):1.543866355,(t266:2.407305921,t267:2.344302672):2.93627745):1.903990248,((t268:6.047556885,t269:6.036749344):0.6454912188,t270:6.373335993):0.4510029732):0.3987328712,(((t271:0.4053634266,t272:0.3725795905):6.266988596,t273:6.597561629):0.01148565268,((t274:3.349313236,(t275:2.365793594,t276:2.262999703):0.6824741827):0.166317134,t277:3.078214179):3.085651365):0.4574072453):1.600467418,((((t278:0.5015501106,t279:0.3921872485):0.05103242909,t280:0.3934109491):5.054728806,t281:5.381388187):2.047387068,(((t282:2.234276652,t283:2.230679884):2.80385656,t284:5.021438701):0.7128278929,(t285:5.523196191,(t286:4.451648574,(t287:1.031955249,t288:0.9633492188):3.380329436):0.9903518865):0.05633486593):1.638557108):0.5657573899):0.3522954662):0.07313259889,(t289:7.66039095,((((t290:0.7926291624,t291:0.4607017502):0.3552259969,t292:0.8003225233):4.108700501,t293:4.68966414):0.6547330319,t294:5.327615413):1.342170295):0.3507947001):0.2463078881,t295:7.241526636):0.2558950757,((t296:5.457875077,(t297:4.62741241,t298:4.562568121):0.8004309451):0.8336779406,(((((t299:4.111675781,t300:3.98744979):0.2581129535,t301:4.232039136):0.6144245592,t302:4.830674786):0.1150897143,t303:4.897673991):0.4438096899,((t304:4.701261179,(t305:4.26447402,t306:4.098183008):0.2667022016):0.211419486,t307:4.567102144):0.2850390128):0.5228987581):1.200763443):4.060537709):2.044040322,((((t308:3.196845899,(t309:2.890588792,t310:2.817657167):0.1579719057):0.1825419706,t311:3.023763973):1.36131707,((t312:4.045365651,((t313:2.408872601,((t314:1.661718313,t315:1.549747264):0.1568262313,(t316:1.432000647,(t317:0.7026591293,t318:0.6729883944):0.7191740398):0.2631249149):0.5498347896):1.298579213,(t319:3.263415599,(t320:2.389800526,(t321:1.45921031,t322:1.362280997):0.8965196536):0.646686959):0.1479924555):0.1271946892):0.2190868303,t323:3.36492106):0.09428379913):2.728205922,(((((((t324:2.174571208,t325:2.140944443):1.62697665,(t326:3.110307818,(t327:1.680444969,t328:1.580658978):1.237430309):0.4820191876):0.05183434399,(((t329:1.953912881,(t330:1.495537025,t332:1.400154684):0.4556279691):0.3984433845,t333:2.193128684):0.9565011,(t334:2.618353453,((t335:0.5168404252,t336:0.4124367301):0.658466897,t337:0.9851643079):1.418497088):0.4903449104):0.03486798707):0.2878739249,(t338:2.377645706,t339:2.323417114):0.8287494556):0.3890815015,((t340:1.131521818,t341:0.9954264067):0.7497672708,(t342:1.300886665,t343:1.245055918):0.1731533707):1.639345368):0.646050053,(t344:1.749674771,(t345:1.35528157,t346:1.299289393):0.302945338):1.935919983):0.01008045035,(((t347:0.9716297512,t348:0.5222648152):0.5334475376,(t349:0.1510038417,t350:0.007666199409):0.8618266027):1.11212815,(((((t351:0.4455281331,t352:0.415737082):0.105902393,t353:0.5029172477):0.6948290707,t354:1.101958704):0.4006977221,t355:1.49165669):0.1386415045,t356:1.609732217):0.1618509551):0.6496063484):0.8933965078):5.089350145):2.168377425):0.08618880205,(((t357:0.5027841759,t358:0.4919616856):6.183743719,(t359:1.421991541,(t360:0.8032237542,t361:0.7539270249):0.6023757759):5.224292707):3.429205442,((t362:0.3543799582,t363:0.2827023954):0.5330457923,t364:0.5467420979):8.855076706):0.4143514227):1.695618154):0.2925303278):0.01475476115):0.6075882752):0.07560098475,((((t365:0.9400999827,(t366:0.4693969602,t367:0.2378582002):0.1916503058):1.874904762,t368:2.182258219):4.13331605,(t369:1.845066822,t370:1.259187732):3.932577258):4.149871923,(t371:0.2403090754,t372:0.1233674148):8.752937429):1.383849912):0.2662190294,(((((t373:1.000186057,t374:0.9770791169):4.133393512,t375:5.099365075):1.956033895,t376:7.048826993):0.1642374035,((t377:0.04179203172,t378:0.0372596461):2.194545845,t379:2.145608062):4.828451388):1.203625792,(((t380:0.6506507555,t381:0.6479222234):5.803536218,t382:6.421948263):1.575802326,(((t383:3.447280857,(t384:0.3729637202,t385:0.05577325982):2.895697617):1.211646085,t386:3.909384935):2.101831906,(t387:1.810490857,t388:1.673314692):4.115801755):1.026580027):0.1242665461):1.959797793):11.26558411,((t389:4.654807906,(t390:1.503712569,t391:1.452329025):2.976863425):2.570263783,((((t392:6.267416957,t393:6.084326061):0.2248652541,(((t394:2.035023198,t395:1.933751103):2.458314062,t396:4.380281):0.9481320711,t397:5.171569258):0.8539469436):0.2035644047,((t398:1.665677008,(t399:0.7640013655,t400:0.6457306782):0.7734152402):4.343710091,(t401:4.85298245,t402:4.747606625):0.8672539678):0.1697044558):0.1117119255,(t403:5.594951327,(t404:5.062937409,t405:4.976144758):0.4884877249):0.2697698725):0.1356749406):12.93376396):5.645872928):67.56724363);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T56.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
