<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t474:0.878212938,(t475:0.5638497488,t476:0.1630720987):0.006722996667):0.56621324,t477:0.7269078181):0.4949852734,(t478:0.7055168901,t479:0.1629506102):0.4972799959):0.4112882893,t480:1.017886894):22.9152515,((((t465:0.09669891491,(t452:0.0505565883,(t384:0.3051359573,(t378:0.0007148546331,((t361:0.001251710292,(t355:0.3100777398,(t352:0.09929007591,((t330:0.05302302808,(t319:0.07771622498,((t251:0.2058882913,(t245:0.1934920955,((t223:0.6377195145,((((t130:0.008813977145,(t129:0.2118315002,(((t55:0.04560341233,(t46:0.2330045907,(t9:0.1969028192,t1:0.8590178455):3.926676785):0.4591805827):4.540334862,t2:9.492064279):0.7058748719,((t3:1.273499408,(t4:0.4829487678,t5:0.4088925475):0.7541216313):8.83416835,((t6:3.242961939,t7:3.14683543):3.921413421,t8:7.023205168):2.74793435):0.05998263898):0.5031684726):0.02309446966):3.453164803,((((t10:1.107385616,t11:1.062234732):3.246215808,t12:4.28845451):1.195234308,t13:5.248743263):7.552245126,(((((t14:3.744002208,t15:3.737268113):1.726995838,t16:5.327679799):2.602921992,t17:7.89986984):0.3648709177,(t18:4.719609432,t19:4.565465249):3.489779544):0.6380429295,(((t20:6.366103484,((t21:0.3363356137,t22:0.2486487071):1.16359813,t23:0.8307079534):4.864782659):0.4068532714,t24:6.050300386):0.684862874,((t25:0.1774957987,t26:0.1773459703):0.2254438769,t27:0.3870765164):6.31222539):1.132420662):3.691532229):0.4502996257):0.7269318284,((((t28:7.386830969,((((t29:2.218125539,t30:2.134737526):1.131093142,t31:3.233742181):1.749794579,(t32:0.7221967935,(t33:0.1453655625,t34:0.04989675126):0.5204895555):4.062131994):1.055856732,t35:5.65246592):1.092519229):0.332307769,(t36:6.78077371,t37:6.740312038):0.0407655151):1.917032478,(((t38:0.532948654,(t39:0.2034997455,t40:0.1369297033):0.2854166165):3.028060792,t41:3.315968975):1.769902251,(t42:1.710943162,t43:1.605401683):3.296721399):3.338706491):0.9837111901,(((t44:7.060969647,((t45:5.130066215,((t47:3.884679719,t48:3.840931862):0.2676456684,t49:3.964533471):0.3119365981):0.7610359832,(((t50:0.9103274358,t51:0.9064578627):0.8245373904,t52:1.642568414):0.3987585206,t53:2.007852872):2.887689923):1.029168161):1.009437971,((((((t54:3.831570676,t56:3.769357232):0.9727948968,((t57:0.1030260598,t58:0.08961995632):3.509546844,t59:3.562314821):1.085040969):0.5452150495,(((t60:0.9076010682,t61:0.8814720757):2.321112751,t62:2.997990935):0.183893932,t63:2.99308213):1.742634793):0.1250464875,(t64:1.709471348,(t65:1.302019203,(t66:1.027026734,t67:0.9242840436):0.08760153469):0.2777735295):3.147463288):0.5059566676,(t68:4.650842814,t69:4.533785092):0.2231635002):0.5738168929,((((t70:3.548010001,t71:3.469617228):0.2336754808,((t72:3.22876261,t73:3.149883179):0.442444965,(((t74:0.4930925572,t75:0.3107269097):0.544214606,t76:0.8005082472):0.6359619726,t77:1.23365174):1.876113564):0.01328763715):1.457300182,((((t78:1.557608254,t79:1.362468285):0.7915174066,t80:1.884276741):1.850457292,((t81:1.854619335,(t82:1.281440801,t83:1.147781248):0.5493341864):0.9866712906,((t84:1.229634224,(t85:0.8117459986,t86:0.797404485):0.3819733697):1.067523375,(((t87:0.3649030818,t88:0.3134853143):1.412894401,(t89:0.7964446455,t90:0.7456915536):0.788889884):0.2827399759,((t91:0.9076512353,t92:0.8242626115):0.6582987768,t93:1.461206283):0.2429113845):0.1609899891):0.336308727):0.8138311891):0.04683375357,t94:2.995669005):0.1918496553):0.01344905874,(t95:2.765087189,((t96:1.964965499,((t97:0.7068434109,t98:0.6056905443):1.166439478,((t99:1.604990968,t100:1.446777451):0.001914959693,t101:1.429645037):0.1531964625):0.03542450923):0.4991191336,(((t102:0.380965657,t103:0.0719166546):0.1554821847,t104:0.129043878):0.501542762,t105:0.6003893307):0.9663789648):0.2973831072):0.4191079276):0.02878648832):0.3504907064):0.3667179454,((t106:0.8514601466,(t107:0.28325227,t108:0.259623759):0.2024169894):0.4652748782,t109:0.9125290758):1.594847899):0.7002913362):2.033135028):5.141731812,(((t110:0.6655527085,(t111:0.03566945826,t112:0.02545465778):0.5282446617):0.2009195415,((t113:0.1862538309,t114:0.149768829):0.5279504176,(t115:0.5843562477,(t116:0.3134023803,t117:0.2734736455):0.2518548982):0.07621863228):0.02489305767):2.155735698,(t118:0.3291403116,t119:0.2369711358):2.452459735):7.346805799):1.405325178):0.5701071855,(((t120:0.2705081113,t121:0.2508913575):0.06529229808,t122:0.2541508708):4.664991823,((((t123:1.128943019,t124:0.9680880565):0.8662329159,((t125:0.9593889439,t126:0.9201987894):0.5611904611,(t127:0.4643597875,t128:0.442516782):0.9922910218):0.2920777019):0.0845970261,t131:1.491140703):0.6258660852,(t132:0.4332507912,t133:0.3911055888):1.649058713):2.166923361):6.96257435):1.964422939):0.9173540896):5.398088009,(((t134:5.950913488,t135:5.836724881):5.247585453,(((t136:4.313260722,(t137:3.754672098,((t138:0.4140638184,t139:0.3851873373):1.067199141,(t140:0.5478748921,t141:0.439726171):0.7401222229):1.846754226):0.3249472786):0.8777657673,((t142:0.1301963033,t143:0.08825281931):0.4723425211,t144:0.5389653108):3.145822996):1.778516606,(t145:3.108668791,t146:2.999069486):2.306319832):3.610834222):0.582684217,((t147:6.591629734,t148:6.590450366):1.588537504,(t149:2.482119996,(t150:0.3929283429,t151:0.2730080859):1.623416253):5.640866008):1.240375785):7.319983972):0.5747523146):1.139838968):1.822403164,((((t152:1.26721695,t153:1.123107281):5.301800628,(((t154:0.2052428092,t155:0.1814415001):4.715881175,t156:4.877232277):0.2578815319,t157:5.131761313):1.21975196):8.441245989,(((((t158:7.419897391,((((t159:0.203900335,t160:0.1953941967):6.693591858,(t161:4.343595953,t162:4.284972796):2.481502095):0.3382172482,((t163:1.485572255,(t164:0.1716262545,t165:0.110883928):1.282645314):3.962900082,t166:5.340506815):1.581205365):0.05956557201,t167:6.966736613):0.008040827735):0.4747163814,t168:7.327533958):0.1624570631,((t169:1.330688758,t170:1.206543528):5.921203382,((t171:6.155726857,t172:5.985356202):0.2954108893,t173:6.083889903):0.6399840432):0.1186163442):1.566096281,(((((t174:3.736985578,(t175:2.77934353,t176:2.750410819):0.6717651959):1.402994231,(t177:2.391498949,t178:2.171239687):2.415259559):0.775829867,(t179:5.189691638,((t180:4.1921677,t181:3.895218051):0.7871480616,t182:4.639766574):0.2080003474):0.1239291376):1.213917558,((t183:1.926554028,t184:1.499990825):3.213575674,(t185:3.759302106,t186:3.607805296):0.9483835754):0.861265341):0.1369031951,(((t187:4.426805976,((t188:2.081862023,t189:2.039344624):1.290214769,t190:3.084138096):1.007312652):0.1996285024,(t191:3.293976288,t192:3.058231723):0.9296287487):0.5176582876,(t193:4.272309847,t194:4.230445751):0.2216986894):0.4027101403):1.136398182):2.166028629,(t195:5.34531399,t196:5.295213688):2.72128829):2.891614513):2.43084457,(((((t197:2.711803538,(t198:2.266714655,t199:2.14905848):0.3367507667):0.4339025665,t200:2.826788163):0.3825985734,(t201:2.611126444,(t202:1.321943692,t203:1.275350259):1.056139653):0.3949180169):2.301046908,((t204:3.181211658,(t205:3.02194297,(t206:1.973564561,t207:1.970030428):0.8289100321):0.007229188271):0.5532611792,((t208:1.774470211,t209:1.668914201):1.411818234,t210:2.940710486):0.1497071735):1.199666645):0.04360486434,(((((t211:0.9474510341,t212:0.9178598933):0.8028302365,t213:1.659637277):0.2349465265,(t214:0.8212194579,t215:0.8133211156):1.052352978):0.4482824999,((t216:1.347036687,t217:1.344150779):0.6259286496,t218:1.849479752):0.1438239113):0.7071019124,(((((t219:0.3723418057,t220:0.3494738039):0.549882729,t221:0.7855786975):0.8201554096,(t222:1.352665831,t224:0.5357296253):0.08097319306):0.6589162403,(t225:0.7942686214,t226:0.7578133436):0.4181479383):0.0683069134,((t227:0.3293078248,t228:0.2408939502):0.1634333802,(t229:0.1323871246,(t230:0.05571351395,t231:0.002469453575):0.03111780577):0.2221150665):0.7449277736):0.230361844):1.178129816):7.369727261):2.124492077):0.1504728656):0.558296439):0.8473715454):0.2785843782,((((((t232:1.480671644,t233:1.210915901):5.944218233,((((((t234:0.8900283233,t235:0.7909165795):0.7191676353,t236:0.8365116243):0.06429531651,t237:0.8342055428):0.8780978135,(t238:1.050141279,(t239:0.2777355654,t240:0.2495452581):0.7327102504):0.6283897201):0.1177319656,t241:1.64514281):2.626031463,((t242:0.7300366644,t243:0.3065015195):1.590436222,(t244:0.8418469736,t246:0.4427448129):0.9750642573):1.947619397):1.844102889):3.320132446,(t247:0.8224716648,t248:0.7455420351):7.491991644):0.6447511056,((t249:1.923280622,(t250:1.586978276,t252:1.193290259):0.2536736927):4.190426302,(t253:4.624912703,(t254:0.2612750167,t255:0.08903997535):4.141502093):0.930032376):2.686262684):0.749010794,((t256:7.320070202,t257:7.283068636):0.6942365126,(t258:6.238689352,((t259:1.334890308,t260:1.297712579):3.971786281,((t261:1.815433084,(t262:0.8808459385,t263:0.8397249241):0.8505006293):2.748084954,t264:4.306173566):0.5018385503):0.84297567):1.511359477):0.5190940875):0.8017648074,(t265:7.12789873,t266:7.09419263):1.047129393):0.7776833312):1.645570034):0.7473871354):6.214828414):1.330578786):0.4537873682,(((((t267:2.316197301,t268:2.313967362):1.979613814,t269:4.005500172):3.823514149,((((t270:6.694057987,(t271:6.431485267,t272:6.202135572):0.2494209426):0.1025386745,(((t273:1.345497828,t274:1.335935792):4.549329061,t275:5.836807684):0.6238425202,((((((t276:0.6737541537,t277:0.6281289466):4.904478186,((t278:4.765543051,t279:4.747321159):0.526274409,t280:5.198178923):0.2401209229):0.06098050164,(t281:4.687379914,t282:4.579323349):0.7072313508):0.005567336862,((t283:1.996067812,t284:1.913374073):2.411618649,t285:4.269320096):0.8604090379):0.3719236415,t286:5.484198981):0.3422837931,((t287:3.058551993,(t288:2.857560847,t289:2.776816729):0.1870722143):0.9129049543,(t290:2.473716116,(t291:1.616775319,t292:1.511729561):0.8063588731):1.359181668):1.552706651):0.08361793744):0.02898272256):0.1389303798,(t293:5.385043922,(t294:2.16773497,t295:2.107917812):3.206653299):0.02193814842):0.2513297471,t296:5.575183589):0.5905516548):7.521010545,((t297:7.612628211,((t298:6.996665811,((t299:4.913630554,t300:4.835531962):0.6273893085,((t301:3.754450845,t302:3.708023394):0.4336066722,t303:4.096299723):1.001723424):1.451843543):0.2374075341,((((t304:0.6646804288,t305:0.373188295):3.644144243,(t306:1.904243919,t307:1.881635671):2.064769986):1.703262187,(((t308:4.362262981,((t309:2.216283098,t310:2.176987719):1.137317415,(t311:2.114093401,t312:1.961673836):1.149172736):0.7973803175):0.5928335504,((t313:1.332451819,t314:1.30626709):2.363194001,(t315:0.651422754,t316:0.6150718807):2.888431831):0.7571217365):0.6591840302,((t317:2.046484101,t318:1.925446466):1.31039921,((t320:0.3802771487,t321:0.1654985252):2.239470669,((t322:1.582815591,(t323:1.166578944,t324:1.157727588):0.2494092939):0.3774778956,t325:1.749528075):0.05584951669):0.3867681718):1.476786977):0.0187984425):0.5203161738,((((t326:2.685928056,((((t327:1.32115398,t328:1.283224814):0.6369121105,t329:1.807565821):0.02985392903,(t331:0.4826095412,t332:0.4806659645):1.110071897):0.2301104436,((t333:0.7220037571,t334:0.4528925853):0.4565721401,t335:0.7452417762):0.4472844801):0.4458943771):0.9980533647,(((t336:1.300008114,(t337:0.3906497181,t338:0.3750054378):0.541234087):0.5278628794,(t339:1.106210724,t340:0.9968848611):0.2947858241):0.1964294639,(t341:0.3799585486,(t342:0.3101255051,t343:0.2398302574):0.01731538633):1.089460136):0.4510638237):0.1545698882,(t344:1.544521658,(t345:1.011255565,t346:1.004700807):0.5052203313):0.3871985221):0.3274451521,(((t347:0.0717642203,t348:0.04151532594):0.1850727667,t349:0.1969767943):0.1622728073,t350:0.3269485854):1.799695473):0.009727595588):0.1206741832):0.3150360179):3.675089624,(((t351:1.354185886,t353:1.149236065):0.3166441632,t354:1.394653814):2.655503663,((t356:1.386671251,(t357:0.3838181472,t358:0.03255884858):0.7879205829):0.1878645344,t359:0.9848437334):1.925273964):1.865509121):2.366700204):3.487362472,((((t360:0.3057214809,t362:0.1253427859):1.595499837,(t363:0.7964229137,(t364:0.709295237,t365:0.6555884071):0.06056243139):0.8155223178):7.354258741,(t366:1.309463655,t367:1.139583182):7.38011838):1.0841526,t368:9.514633677):0.2729313348):0.1389024343):0.6046179953,(((t369:2.822033307,(t370:1.446541891,t371:1.346359508):1.298529927):2.453770432,t372:4.966828629):4.791323873,(t373:6.093733209,(t374:0.9452049677,t375:0.2783692126):5.137355408):3.628825815):0.4440833365):1.596523634,((((((t376:0.3610108452,t377:0.354352123):0.3175827551,t379:0.6495120312):2.520078584,(t380:0.2494311009,t381:0.1546710863):2.874215224):4.59377853,(t382:6.744804191,(t383:4.920798359,t385:3.929132119):1.811097945):0.7402300366):1.094571019,t386:7.542818687):0.2438093084,(t387:0.3513199342,t388:0.239226113):7.41374178):1.831307289):23.22102723):1.315703171,(t389:7.100074939,(t390:6.021744144,(((t391:0.8345823257,t392:0.6915992793):2.036636094,t393:2.620915184):0.7071444576,t394:3.240249044):2.316966137):0.8945288326):26.91708174):36.95861888,((((((((t395:5.737280632,t396:5.707671187):1.140770738,((t397:0.3160031755,t398:0.2782551111):6.378284793,((t399:5.290421689,t400:4.947721734):1.056359528,t401:5.966733236):0.2294563668):0.1404597244):0.4137854646,(t402:4.099306922,t403:4.068636208):2.395314126):1.12321086,(t404:6.803802452,((t405:3.494399045,t406:3.485750803):1.913363684,(t407:4.64941848,((t408:2.817149813,(t409:2.641049323,(t410:0.7354273874,t411:0.6812009056):1.837121168):0.03270480059):1.069668781,t412:3.565638268):0.6353133537):0.5014441298):1.360655521):0.6751465625):5.833891821,(((t413:1.646871711,t414:1.579551614):3.070552137,((t415:3.999873485,(t416:2.309335843,t417:2.261023386):1.63807365):0.4798682584,(t418:2.794947312,t419:2.788152699):1.518784448):0.152034773):2.629943526,((t420:4.18156617,(t421:1.643673918,t422:1.640662636):2.359546361):0.2517928302,t423:4.25058534):2.579203945):5.174467839):1.542668701,((((((t424:3.312137523,(t425:3.120840146,(t426:0.7488398319,t427:0.7382693705):2.302673209):0.1305731617):0.6898615532,(t428:3.718155633,(t429:2.386509406,t430:2.317698675):1.07304574):0.1069988542):0.4949544074,t431:3.920583578):0.1919686299,t432:4.087244435):2.340865545,(t433:5.633858556,(((t434:1.586187147,t435:1.216185793):3.321520735,((((((t436:1.647620839,t437:1.639247662):1.375571308,((t438:1.168241536,t439:1.133023387):1.134418542,(t440:2.229427522,t441:2.220146066):0.02680067889):0.64112377):0.3004398081,(t442:2.245339119,t443:2.089410139):0.6327979271):0.124839894,(t444:2.560027258,((t445:0.1686612919,t446:0.1647477953):1.551450582,t447:1.701353752):0.7159737692):0.2683089103):0.01382016448,((t448:2.14991244,((t449:1.125977856,t450:1.056081564):0.4546193671,t451:1.35242545):0.5678355495):0.2466854046,t453:1.973981299):0.2879729668):0.7869656171,(((((t454:0.6502641467,t455:0.5829116766):0.9975726946,t456:1.575923635):0.8849605312,t457:2.434248838):0.1236711541,(t458:0.8913252699,t459:0.7787580602):1.488147408):0.0005392688315,(t460:1.355148048,t461:1.098404792):0.828408527):0.3302721609):0.218652317):0.05880062312,t462:2.373532753):0.3741126337):0.7365156207):4.624159084,((t463:0.5648531829,t464:0.4279074896):2.766286666,t466:2.907925581):4.766685353):1.879530614):2.041021974,((t467:0.3675927493,t468:0.3438538668):1.18649912,(t469:0.7576490488,t470:0.7271283624):0.7610637236):10.01734574):3.725576872,(t471:1.29799229,(t472:0.865136165,t473:0.83737702):0.3215505534):13.62922889):48.76884338);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T18.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
