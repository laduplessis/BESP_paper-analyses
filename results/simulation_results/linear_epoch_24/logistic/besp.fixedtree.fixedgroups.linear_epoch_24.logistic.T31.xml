<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t365:0.5320563848,t366:0.4516661564):7.15643112,t367:7.478031077):0.7745659142,((((t368:6.364580104,t369:6.078813643):0.5082639305,(t370:2.388556933,t371:2.355876819):4.01228539):0.6963140485,(((t372:2.811890026,(t373:0.1561408645,t374:0.1062046938):2.634365682):3.949494072,t375:6.672095555):0.08629630289,(t376:0.3460431864,t377:0.2076116066):6.297033043):0.08831296284):0.4474309751,(((t378:1.513332172,t379:1.505312994):1.237321218,(t380:1.274778387,t381:1.262008864):1.450253154):3.379939786,(t382:0.5712590011,t383:0.4525616):5.518270462):0.8207836818):0.1373976323):1.083059541,t384:7.867228518):0.8347100708,((t385:5.10515206,t386:5.076353636):2.939349673,((t387:3.140598729,t388:3.113571066):4.450517715,((t389:0.5067334176,t390:0.4593294217):4.978011221,t391:5.426335942):2.061851048):0.2559663605):0.5774216602):8.064852724,(((((t393:0.8660537309,t394:0.7210557752):4.707178227,(t395:0.3780649976,t396:0.2863671645):5.034123826):0.5770732533,(t397:5.522093678,(t398:1.491833656,(t399:0.6800370672,t400:0.5517440149):0.7722463073):3.486503428):0.3450628528):0.4435088152,(t401:4.834968231,t402:4.830995303):0.5191364421):0.7579948942,((t403:4.905321958,(t405:4.571387228,t406:4.55490876):0.01241943901):0.2124070116,((t407:3.710238557,t408:3.693120997):0.4597077366,t409:4.105253366):0.5522806626):0.9754086567):8.898011049):2.255444237,((t410:5.51669229,(((t411:1.722203676,t412:1.718584312):2.639425925,(t413:3.437686177,t414:3.429272056):0.8062827545):0.9967209017,(t415:4.667302908,((((t417:0.6638921841,t418:0.5810247344):1.446049761,t419:2.014378025):1.298337415,(t420:2.524758129,t421:2.045420524):0.385666167):0.7417936104,((t422:2.753904982,t423:2.718771193):0.1314642999,(t424:2.686311975,t425:2.666333096):0.03757578315):0.2750811723):0.08419088594):0.3799619841):0.1068253731):0.6060980175,(t426:2.105947619,t427:2.072082308):1.986882492):10.52076079):37.41849119,((((t428:2.394102865,((t429:1.46379988,t430:1.324591165):0.7203532087,t431:2.03628867):0.1828215502):11.76561622,((t432:1.686158778,t433:1.643458932):0.8363255283,(((t434:1.555445196,(t435:1.376634275,(t436:1.137229533,t437:1.029691457):0.08977196078):0.1426914443):0.7996853399,((t438:0.7265949543,t439:0.7050525774):0.9784467217,t440:1.53313017):0.2715370542):0.07244032075,((t441:0.5060702677,t442:0.265062766):0.1682921984,(t443:0.2381806205,t444:0.1983355581):0.1078351596):1.194971599):0.00698139802):11.35009948):6.514320389,(((t445:2.365373587,((t446:1.366481156,t447:0.9460743222):0.3800985386,(t448:0.03669929883,t449:0.02340071608):1.247559003):0.5900265407):10.16682444,t450:11.9351835):0.8851366689,(((t451:0.5216861512,(t453:0.4111770285,t454:0.3307692535):0.096447343):2.046265044,((t455:1.744103405,t456:1.740887206):0.2825220633,((t457:0.8920788164,(t458:0.4444878978,t459:0.3839162711):0.434785025):0.2716454975,(t460:0.1963254681,t461:0.1397413018):0.84359749):0.7172788585):0.4375141528):0.3323074248,(t462:1.990914922,(t463:0.01849038297,t464:0.01805419152):1.906259222):0.3784550538):9.834678102):5.903153597):8.897791656,((t467:0.225483194,t468:0.1777813938):26.1821804,(t470:12.98711052,(t471:1.008019994,((t469:0.01912084064,((t465:0.1776101543,t466:0.1385614509):0.0605665681,(t452:0.00148342047,(((t416:0.3615949576,(t404:0.1094355252,(t392:0.001347760268,(t364:0.03927798408,(t353:0.6321786616,((t343:0.1362973413,(t344:0.02880173795,(t340:0.01302270067,(t333:0.06173815317,((t213:0.3752588047,(t214:0.1941909529,(t188:0.0215416832,(((t107:0.1253930511,((((((t98:0.009345204429,(t92:0.1049884654,((((t36:0.09940774317,t1:4.139632652):0.3903901591,((t2:1.375734241,t3:1.19984791):0.2465373384,t4:1.23987307):2.859458426):1.850260598,t5:5.670697364):0.07547400925,t6:5.69806273):3.055240924):0.4618807026):0.5305936022,(((t7:6.502578785,(t8:4.458261022,t9:4.444715638):1.844588684):2.037787848,(t10:7.703133904,((t11:6.034419191,t12:5.947591263):0.8683278043,(t13:4.417209089,t14:4.28055004):2.33992342):0.7993643752):0.4991976039):1.122503423,(t15:8.059039424,(((t16:4.475025504,t17:4.348093063):2.819614244,t18:7.149024423):0.5428926381,((t19:5.644742636,(t20:4.803653535,t21:4.619845925):0.8057230932):1.684287737,((t22:6.401920735,t23:6.259940288):0.6140126069,((t24:0.5300247369,(t25:0.1505801462,t26:0.1210844124):0.340316433):5.890383797,t27:6.176851678):0.4214830702):0.08731116324):0.1919360488):0.1028758182):0.3948675445):0.05925215067):0.2859754951,(t28:0.5497652568,t29:0.4778295025):7.131089335):0.6885445004,(t30:7.756183063,(((t31:6.848097882,(((t32:4.077549964,t33:4.045171304):1.505834019,((t34:2.096490965,t35:1.848901133):1.395789752,t37:2.941716448):1.8153829):0.7525804834,((t38:0.1539619338,t39:0.1265030723):0.7197102592,t40:0.7285631961):4.240552709):0.4957412394):0.1256433045,((((t41:1.228563379,t42:1.124344971):2.084672618,(t43:3.130232629,t44:2.783937505):0.06317575662):0.7556596409,t45:3.54886953):0.06755911114,t46:3.544869866):1.363975937):0.2264848758,((t47:2.909731345,((t48:1.583050265,t49:1.497753915):0.2073723163,t50:1.623161094):1.013192751):1.130551409,(((t51:0.06434722606,t52:0.01677012339):3.46744307,((t53:0.3332329872,t54:0.3111590249):0.2095383686,t55:0.5197374402):2.857257781):0.08536896391,(t56:2.769933132,(t57:1.021571837,t58:0.8129137765):1.71893503):0.5211392345):0.1129170268):1.066552563):0.435184351):0.5319827218):0.05976458995,((t59:2.819696139,t60:2.809407135):1.343990136,((t61:2.940330634,(t62:0.7245497945,t63:0.6423425646):2.147971758):0.4225051958,((t64:1.684499801,t65:1.471926278):0.9598115788,(t66:1.779320185,t67:1.699994466):0.5618992948):0.4796123588):0.7494408171):1.05529842):0.3667325112,t68:4.865682308):0.2854733416):5.958542753,((((t69:0.9426512509,t70:0.8226518771):0.1064369051,t71:0.8527700879):2.610475672,(t72:1.346987816,t73:1.1845164):2.051982908):5.990271185,((t74:1.589742756,(t75:0.6302051855,t76:0.6197177818):0.9436001532):1.657771319,((t77:0.3631475825,t78:0.2984408146):1.947704404,(t79:1.634149433,((t80:0.4257399313,t81:0.4188621053):0.6590850141,t82:1.003543415):0.5129621522):0.2995288161):0.8265241112):5.917958707):1.404367488):0.9744145083,(((t83:1.294152505,(t84:0.4263113005,t85:0.2902871523):0.8152254681):2.392762238,((t86:1.751893439,t87:1.642948009):0.173599724,((t88:1.135478831,t89:1.127880378):0.2022257138,(t90:0.5569146355,t91:0.5395523212):0.7680656154):0.2498702718):1.542398232):4.79069121,(t93:0.7491371449,t94:0.638896502):6.319778654):2.437796792):0.3286476211):2.874853028):0.1537379426):1.617765496,((((((t95:3.209606577,((t96:1.81679652,((t97:0.9224618566,t99:0.8180298921):0.5511042424,t100:1.05224762):0.2620031606):0.6890421913,((t101:0.546836135,t102:0.469301186):0.1813823481,t103:0.3968317544):1.0161257):0.6774318225):4.438037155,((t104:0.4319872392,t105:0.1979137912):0.8400773564,t106:0.2951794673):5.216316015):1.296402356,((t108:1.188676148,t109:1.159504916):1.742326213,t110:2.691552557):3.618586315):2.963823813,((((t111:0.4165308177,t112:0.2970084883):0.8596317208,t113:1.025392114):5.930323308,t114:6.895139845):1.937164354,(t115:3.957670797,(t116:2.365819756,(t117:0.429864962,t118:0.3987389131):1.850399597):1.549076001):4.63382156):0.07122884405):0.2566309564,(t119:7.961432043,(((t120:2.838340176,t121:2.781123035):1.371403627,t122:4.113461007):2.488595428,t123:5.907134191):1.107002952):0.7147861174):0.2542226398,(t124:4.097227713,t125:4.065296665):3.815321971):1.862954817):9.632414598):0.3664113862):0.2834798161):0.01056836564):0.4040555496,(((((((((((t126:2.813282525,(t127:0.65588344,t128:0.6241298171):2.079561825):1.297446253,t129:3.910307225):4.513114319,(t130:7.68134924,((t131:6.912760351,((t132:1.931005882,t133:1.913037162):4.573285137,(t134:3.070668796,t135:3.040894898):3.330167415):0.337172719):0.57074367,(t136:2.38943292,t137:2.341476157):4.847076286):0.1843750424):0.570331614):0.1373929168,((((t138:5.101786653,t139:5.059827498):0.7730877437,t140:5.75099392):0.1858015392,t141:5.922443931):0.8123467255,((t142:2.474705335,t143:2.247393937):2.000602367,(t144:1.360268749,t145:1.076215154):2.81205439):2.237166163):1.185496441):0.1676246476,(t146:5.79741821,((t147:4.537442401,t148:4.50319982):0.9061581308,(t149:5.207920745,(t150:4.067758198,(t151:2.062730195,t152:1.991629417):1.97246911):1.076177091):0.01249692293):0.3132608425):1.5447193):0.3661516794,((((t153:4.844163404,(t154:4.174815733,t155:4.145716899):0.601966797):0.6269647785,(((((t156:0.2743036139,t157:0.1058396675):4.076807176,(t158:2.303573356,t159:2.268075735):1.85069553):0.10339893,t160:4.199249439):0.2467182263,((t161:3.258115503,(t162:0.5636126097,t163:0.4960189872):2.682146667):0.3216934722,(t164:2.497473623,t165:2.464449887):0.9265818061):0.7746018809):0.5656802361,((t166:3.164039239,t167:2.99586088):0.4018300106,t168:3.368311899):1.144174603):0.03390760477):0.2307704024,((t169:3.194822902,(t170:2.186098224,t171:2.066419695):0.9888616584):0.3448105143,t172:3.317909538):1.21204417):0.2241649015,(((t173:2.952973691,t174:2.939174855):0.780839129,t175:3.614217271):0.5250637555,((t176:0.544305539,t177:0.4710958095):0.5537697618,t178:0.7376384171):2.947383367):0.2216293152):1.253237581):1.356912273,((t179:3.851504457,t180:3.727669056):2.013783218,(((t181:2.628962577,t182:2.514204845):2.119898169,(((t183:0.9804661527,t184:0.8214679394):1.720867131,(t185:1.61451836,t186:1.58006051):0.889263531):1.82065267,((t187:1.511588911,(t189:1.003656257,t190:0.9630547291):0.3172841193):0.9417781637,t191:2.18718298):1.739598333):0.03221843447):0.06597843422,(((t192:0.6806548478,t193:0.2750926337):0.7808201011,(t194:0.3917100019,t195:0.2261102198):0.6099074003):2.33653447,(t196:0.6118422621,(t197:0.2915913855,t198:0.2892766917):0.2694631935):2.55176817):0.1413072608):0.903063268):0.5031422929):6.141347729,((((((((t199:0.5554099091,t200:0.185736304):1.557121601,(((t201:1.127469865,(t202:0.6575082516,t203:0.3520438618):0.4293475794):0.1541974643,t204:0.8568184529):0.006894547868,((t205:0.07359796817,t206:0.06336655057):0.1952741602,t207:0.2029463962):0.5401851282):0.3013731745):0.840391004,(((t208:0.5259677592,t209:0.4239508902):0.1069823895,t210:0.4434223246):0.006493676847,t211:0.278316795):1.233189985):0.03954074143,t212:1.452639369):0.4655329599,((t215:0.1051620858,t216:0.1029331868):0.8611767995,(((t217:0.3504501333,t218:0.2336853755):0.4288391789,(t219:0.1305464918,t220:0.09164018719):0.5042969079):0.1752073028,t221:0.6919444342):0.006170514865):0.4671672667):2.601219625,(t222:0.09681668198,t223:0.08001713148):3.607142796):2.26816015,((t224:0.3202655452,t225:0.1443306335):0.604564706,(t226:0.5220046442,t227:0.276924819):0.1564868219):4.985692388):1.240502479,(t228:0.6191083399,t229:0.03501522046):5.97866689):1.128979107):1.850315202,(((t230:0.5942513691,t231:0.4377274895):4.865950585,t232:5.281883501):2.87740233,((((t233:0.185207462,t234:0.05319711802):4.693903015,t235:4.552507308):1.69033143,(t236:2.320558816,(t237:0.6243427536,t238:0.5919937469):1.596405711):3.896091299):0.0579993048,(t239:3.372303394,t240:3.247539939):2.553541867):1.52838485):0.6404694327):1.091264969,(t241:8.143778431,(t242:7.396242584,(t243:6.713595501,(t244:5.875860162,((((t245:1.407359568,t246:1.144182559):1.078439071,t247:2.168458435):0.8766747198,((t248:1.146686672,(t249:0.297290343,t250:0.1349218955):0.797041739):0.9111108759,t251:1.819818477):0.7366779497):1.899378117,(t252:3.239361216,(t253:2.511055371,t254:2.307179007):0.7066495564):1.186771244):0.494898571):0.6348837022):0.6521328457):0.7450109):0.9132462477):0.1461285707,((t255:2.064432945,t256:1.883439703):4.007210874,t257:5.868973898):1.677801017):0.5339758254):1.75617643):0.6636907231):2.10089104):1.604983063):1.147337707):1.133967957,(((t258:7.174225802,((t259:1.682555085,t260:1.676740793):3.14240261,(t261:4.434542642,t262:4.412346058):0.3231290215):2.223028396):1.190744373,((t263:6.576324504,((t264:6.366590901,(t265:5.9453466,t266:5.833685709):0.2637736366):0.1693119561,(t267:5.686227297,t268:5.668604481):0.5742376015):0.03649360308):0.4471726486,(((t269:1.310255366,t270:1.044235486):3.304858868,(t271:2.732733509,t272:2.707554961):1.568005266):1.572419819,t273:5.78013878):0.2506740862):1.113849615):6.081725917,((((t274:5.43044948,((t275:2.729490477,t276:2.606531014):0.9869734563,(t277:1.255462712,t278:1.121968166):2.298609346):1.651225591):0.9830862246,t279:6.049569635):1.940497587,((t280:4.965054803,t281:4.94197738):0.9845215168,(((t282:3.940361966,t283:3.90642297):0.4709741484,((t284:3.528582661,t285:3.460344088):0.5736723941,(t286:1.304707634,(t287:0.3198773038,t288:0.277970662):0.9405633132):2.514113209):0.1944348514):0.3161198536,(t289:3.547771624,t290:3.480120175):0.649086543):1.179352728):1.936838928):3.961724196,(((((t291:1.90158718,t292:1.844150262):2.560519702,(t293:1.829970611,t294:1.766896381):2.475691263):2.033114768,(((t295:2.719556959,t296:2.637343576):0.7544788494,t297:3.280177465):2.457534189,(t298:3.771548888,t299:3.727260846):1.955014607):0.2190886017):2.866482559,(((t300:2.141540795,t301:2.079822098):1.474565915,(t302:1.912422203,(t303:1.133214182,(t304:0.5823449877,t305:0.2293406555):0.5399492204):0.6899031642):1.609195571):0.915285078,(t306:2.423221886,(t307:1.23300873,t308:1.181568592):1.16560103):1.310206439):4.172152114):1.329051228,((((((t309:2.719092165,((t310:0.8441858226,t311:0.7877211971):1.625011833,(t312:1.45627879,t313:1.420602873):0.6911839572):0.1857060572):0.6222784525,(t314:1.769321441,(t315:1.445252557,t316:1.285301428):0.3127684459):0.9378367067):0.806357682,t317:3.299036183):0.1912728792,((t318:1.923317247,(t319:1.111021195,t320:1.013313959):0.7410212172):0.2964411525,(t321:2.002308366,t322:1.981924877):0.02460011941):1.059362992):0.2604473917,(t323:0.698589878,(t324:0.5032237056,t325:0.1413992965):0.1106084816):2.36885315):0.2620890202,t326:2.804680014):4.266961333):0.3452197224):0.8370833376):1.981832336):1.596924704,((((t327:1.224684568,t328:1.012029553):0.07259572285,((t329:0.4417168253,t330:0.403630676):0.2934867601,t331:0.5481676532):0.2544777358):0.1260192919,t332:0.8863624584):1.381999914,(((t334:0.0770990327,t335:0.04676132183):0.07729200488,t336:0.1076484577):0.7834299103,t337:0.8212134122):1.192677266):8.891577392):0.6369963223):0.9468673484):0.1813942175):0.740491554,((t338:0.345574632,t339:0.2710707697):11.79700876,(((((t341:0.1252766611,t342:0.02061147714):0.9599047366,t345:0.7771629829):0.288253348,t346:0.6943783713):9.712789713,(((t347:1.888190498,(t348:1.415821018,t349:1.201727931):0.3025077593):4.585398038,(((t350:0.08678849854,t351:0.06071601037):1.446898456,t352:1.213616471):0.1607035153,t354:0.2770390321):4.264507006):0.9498479457,(t355:4.650153922,(t356:1.299293196,((((t357:0.04719987865,t358:0.03944345591):0.260251387,t359:0.2536652724):0.6074201099,t360:0.7132424917):0.0766269406,(t361:0.7072650894,t362:0.6914498072):0.080880672):0.2684886766):3.320470362):0.8325023113):2.970668247):0.5279097616,t363:8.664997902):0.3305433721):1.23877698):0.8489842827):11.91293376):12.75331942):0.1404401685):22.38063779);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T31.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
