<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t481:0.8255622234,(t482:0.7206513237,(t483:0.586375259,t484:0.562542738):0.06184030523):0.07485725663):2.665700202,t485:2.95544502):3.296921348,(((t487:0.4596202324,t490:0.2511768468):0.5159998996,t492:0.507484735):0.1204453655,(t493:0.5769754644,t494:0.5762139815):0.01690882906):4.806240037):5.813249654,((t491:0.003508523752,((t488:0.08709857468,t489:0.001031900239):0.03207101436,(t486:0.0585216761,(t441:0.2077700093,(t442:0.06918979774,(t385:0.01742195501,(t360:0.001728325414,((((t256:0.1260295551,(t257:0.004992724966,(t249:0.2594271811,(t250:0.09611628555,((t247:0.103911526,t248:0.05612249436):0.03167883447,(t244:0.3541120641,(t148:0.01579884011,(((t129:0.1752069349,(t123:0.1394120227,((t19:0.3302214186,t1:2.16201844):7.785094844,(t2:8.635025041,t3:8.501265351):1.276104411):0.5080870953):0.6453418665):0.1104909771,(((t4:2.961695279,t5:2.943186703):2.825770205,((t6:2.085842027,(t7:1.39911383,(t8:0.5147584016,(t9:0.1951315627,t10:0.1005174323):0.25673421):0.1755767988):0.6446487441):1.195999075,t11:2.21834475):2.362571866):4.149287502,t12:8.677861649):0.8817179582):0.9342755971,(((t13:8.640115242,(((t14:4.027377125,t15:4.023955096):2.323331323,t16:6.297017336):0.7826503644,(t17:6.422212801,t18:6.404526923):0.6569644289):1.419616507):1.099071074,(t20:8.368771546,((t21:6.342355932,t22:6.339514878):0.9955298419,(t23:5.261797426,t24:5.24224673):1.844364788):0.8649500465):0.8765271758):0.4477022987,(((t25:4.057003654,t26:3.949462006):3.523862979,((t27:5.43923297,((t28:3.537880661,t29:3.470622117):1.753620569,(((t30:2.694661978,t31:2.620247612):0.4467027702,(t32:1.534364317,t33:1.518233365):1.488473284):1.449455995,t34:4.373746498):0.577513961):0.1156061787):0.8269140088,((t35:2.577656612,(t36:0.1607475492,t37:0.1100843983):2.407423853):2.261045848,t38:4.738312218):1.053384613):1.054439452):0.3456683628,(t39:6.717707894,(t40:6.52599091,(((((t41:1.330779482,(t42:0.4639395706,t43:0.4311457334):0.8472807689):2.475481021,(t44:3.364480971,t45:3.341261352):0.3806288139):0.1311402196,t46:3.727066279):1.570767031,(t47:0.3517845073,t48:0.2517983489):4.861172883):0.292065671,t49:5.359580948):0.6952004267):0.1363698303):0.4092354704):1.166916093):0.2888812785):1.406825618):8.39549965):0.2324025062):0.3156403851):0.08992141283):0.7104331604):0.03466337568):1.4866329,((((((((t50:6.124468746,((((((t51:2.975360949,t52:2.925393844):1.320866768,t53:4.169890055):0.1086028877,((t54:0.3955789071,t55:0.2537105779):2.447493918,t56:2.684747334):1.302257782):0.242007065,(t57:1.345181564,t58:1.231752126):2.794096357):0.891652668,(t59:0.4508686764,t60:0.4307204504):4.262978372):0.1774116845,t61:4.742426168):0.2734433977):1.173222942,(((((t62:3.502885166,t63:3.356358565):0.3419748388,(t64:2.761672054,(t65:1.859989937,t66:1.82032484):0.8472570401):0.8956013868):0.8990078504,(t67:4.058728663,t68:4.008265182):0.2444681277):0.06610249768,((t69:2.798374288,t70:2.684830468):1.176417919,t71:3.772658148):0.3019949685):0.005129257506,(((t72:0.5890325444,t73:0.5674585556):0.7879569772,(t74:0.8393372657,t75:0.7861691123):0.3053028918):1.526838806,t76:2.608686447):1.111015835):0.8378191656):3.418189607,((t77:2.227686532,t78:2.108783454):1.608784546,(t79:0.4433443026,t80:0.3629241633):3.208130861):4.136774674):2.353760807,(((((((((t81:2.763205488,(t82:2.013062878,(t83:1.499744851,(t84:0.412140886,t85:0.2871027074):1.022804853):0.4419780369):0.7112152503):0.5276175432,((((t86:0.3581908426,t87:0.3493981144):1.870314846,(t88:1.221177876,t89:1.074444276):0.9944106678):0.1853783421,((t90:1.946088872,(t91:1.301467545,t92:1.129157096):0.601306257):0.08207202682,(t93:1.557476245,t94:1.414279574):0.1787401669):0.1554473604):4.300183852e-05,(t95:0.6361454334,t96:0.6015538885):1.092277794):0.4960282415):0.04405885759,(t97:1.884012322,t98:1.832324198):0.2519282994):0.05557630486,(t99:2.078955591,((t100:1.507038312,((t101:0.1084920079,t102:0.07780664825):1.159124998,t103:1.232856917):0.02631561604):0.3276655647,t104:1.485741772):0.2126479077):0.005227331594):0.08014343092,t105:1.668939321):0.3548410337,t106:1.989693142):0.846178389,(t107:2.277273342,t108:2.165021798):0.3572317494):0.8062280979,((t109:2.267785666,((t110:0.9130873979,(t111:0.557542984,(t112:0.2809092859,t113:0.2545013884):0.2746858626):0.08292404604):0.3501032511,t114:0.9417056226):0.798956553):0.9918652053,t115:2.686672677):0.06458472092):0.3022025367,((t116:2.231139461,(((((t117:0.736291664,((t118:0.1771479197,t119:0.1264375666):0.3562881901,t120:0.4645770705):0.164606299):0.04567836737,t121:0.5752291151):0.08596603151,t122:0.6459234941):0.02408748339,(t124:0.2642311547,t125:0.2342095533):0.08419531224):0.5609328486,t126:0.8767591557):0.7254228138):0.4269909809,t127:1.954476638):0.3574453259):4.27013748):0.9716823777,(t128:7.214756626,(t130:3.033986301,(((t131:0.514639345,t132:0.181942495):0.03947768005,t133:0.05224660703):1.24446412,t134:1.159920728):0.6248527317):3.840420841):0.1547997935):1.532606143,t135:7.218819931):1.817562404,(((t136:1.063313047,((t137:0.3849984917,(t138:0.1895152573,t139:0.1332798773):0.1656251938):0.5753503527,t140:0.7349118333):0.02837532246):4.669358801,(t141:3.216856368,t142:3.157598619):2.076491176):0.05860462878,((t143:1.925150696,t144:1.903463735):1.08002988,t145:2.904769263):2.262987756):3.109280208):1.798193498,(((t146:9.175487513,(t147:6.821031079,((t149:4.727088667,t150:4.617397229):1.670718525,(t151:3.555807158,t152:3.457506626):2.398592228):0.1989884823):2.315989594):0.06295451348,((t153:5.035329883,(t154:4.694818163,(t155:3.435002428,t156:3.403754378):1.078992004):0.2623465924):3.231396817,(t157:4.659411153,(t158:3.164299737,((t159:0.5044774654,t160:0.4497122936):1.231328743,t161:1.678243588):1.165533327):1.403697976):3.302170355):0.08977295145):0.7640994784,((((t162:6.30878472,(((t163:0.5254620628,t164:0.5226462863):4.96427264,t165:5.341061778):0.2819454527,(t166:2.932390818,(t167:1.294712394,t168:1.171273682):1.624030663):2.654078305):0.4793066527):0.1746682319,((t169:5.641579442,t170:5.621898046):0.0702725147,((t171:2.202504378,t172:2.169056657):3.448553845,(t173:0.4095633866,t174:0.2322664752):5.191119572):0.03741481632):0.372401208):0.3407460242,(t175:2.89660465,(t176:2.760995984,t177:2.687859661):0.1146090099):3.237352158):1.288274922,(t178:2.891308607,t179:2.811551554):4.377048242):0.2781839659):0.04864430767):1.395599883):5.235576138,(((((t180:5.547222577,t181:5.505763378):0.549895864,(t182:4.323737515,((t183:3.006999046,t184:2.93031457):0.6773340542,t185:3.550317705):0.583438441):1.560132924):0.0008209612627,(t186:5.338165359,((t187:1.149834829,t188:1.084546409):0.1000285925,(t189:0.6660841471,t190:0.6295951121):0.5076172616):4.04819126):0.2576941313):1.359355071,(((t191:5.86576942,(t192:4.907290535,t193:4.62359176):0.9463426568):0.5053293834,((t194:5.274389618,(t195:5.01782396,(t196:2.668845122,(t197:0.1019608342,t198:0.02591878744):2.526607942):2.274815486):0.1493210512):0.1989272799,((t199:4.564221307,(t200:3.129311573,t201:3.009547253):1.295004982):0.525425099,((t202:1.449376002,t203:1.408584568):2.483324366,((t204:2.022789536,t205:1.859359405):0.5814033419,t206:2.331247218):1.263843612):0.8962979094):0.02907663606):0.5251058272):0.1056534033,((t207:0.2848730861,t208:0.2478935622):1.211859505,t209:1.336157158):3.532649482):0.3022354977):0.1733379722,((((t210:1.999971438,t211:1.945638599):1.647871759,(t212:2.676661889,t213:2.608102282):0.7402348603):0.1652398103,(t214:2.456495975,t215:2.45626413):0.710916714):1.238628297,(((t216:0.7090543805,t217:0.6882990634):1.905051771,t218:2.499037973):0.9448491829,(t219:1.759808133,(t220:1.253971213,t221:1.248111193):0.2287980719):1.455543053):0.7445339302):0.2882087544):6.30043308):4.788170508,((((((t222:2.704419276,t223:2.609561061):1.303256975,(t224:1.954422738,t225:1.876809689):1.889594072):2.248692993,((t226:1.038304849,(t227:0.2545340052,(t228:0.06667391184,t229:0.05993518951):0.0380846018):0.783491484):0.6201095736,t230:1.407518706):4.287345983):0.1270196801,((((t231:2.366128333,(((t232:0.8979668514,t233:0.8851814958):1.049529945,(t234:1.373027057,t235:1.319879868):0.4225320616):0.09772064851,t236:1.824521642):0.3149083634):0.8798494781,t237:2.968996807):0.3608366729,((t238:1.396407124,t239:1.335829276):0.6664062509,(t240:1.777520683,((t241:0.8354696742,t242:0.5956562639):0.8004806199,t243:1.201366595):0.09631603473):0.1070957316):1.22635744):1.500466999,(((t245:0.6541160736,t246:0.6351815913):0.5465760791,(t251:0.3524361756,t252:0.2356111114):0.1128694183):1.481714316,(t253:1.35472972,t254:1.319513842):0.27155539):0.9887048894):0.6631181483):7.691502866,(((((t255:0.680151865,t258:0.3284523647):0.03638476835,t259:0.257037488):1.065026869,((t260:0.145817208,t261:0.1069592814):0.7142807036,t262:0.1343458643):0.4455579813):7.512290217,t263:8.066872009):1.527078037,t264:9.52681139):0.1124778496):0.5196653418,(((t265:0.4407148737,t266:0.2802511992):1.105602219,t267:1.262168319):8.184495403,((t268:0.8376629624,t269:0.7496519728):4.333579526,(((t270:0.7480006406,t271:0.5886193962):2.47492643,t272:3.058188105):0.702395576,(t273:0.1726292143,t274:0.0914618065):3.584044888):1.113651713):4.218668478):0.3194063593):0.3329241733):0.2651907119):2.66001762):4.433123289):0.1370011588):4.749459006):0.2191812598):0.1833312356):2.062123941,((((((((t275:0.3410174809,t276:0.2512240954):8.441434962,t277:8.650832839):1.044420198,((t278:7.387950136,t279:7.300887874):0.0503370182,(t280:6.238884873,t281:6.183485818):0.9924512502):2.14215249):0.5206087861,((t282:3.770906404,t283:3.560983176):4.113495613,(t284:2.388147992,t285:2.375544319):5.059060047):1.768248512):0.877791588,(t286:5.229965545,(t287:4.093935375,(t288:3.463562323,t289:3.296421096):0.5751432455):0.9317731636):4.826306612):0.2282131395,((t290:7.770776687,(t291:4.288938447,(t292:1.102053662,t293:0.8847453116):2.911280793):3.451260776):1.135817052,(((t294:0.6226113872,t295:0.4634064004):4.033500468,(t296:3.797045474,t297:3.579696526):0.6809998658):1.665072955,t298:5.910815686):2.032265982):0.5472473113):5.888586218,(t299:3.865413538,t300:3.85836172):10.37017303):4.073059488,((((((((t301:3.535478794,t302:3.433688329):2.704496121,((t303:4.38100742,t304:4.182131738):0.8665627031,((t305:0.4967464431,t306:0.1720832259):2.54092876,t307:2.679304504):1.904543094):0.4925473376):0.1191543414,((t308:3.684729266,(t309:2.241126846,t310:2.233006918):1.190849149):0.9328314417,t311:4.295794593):0.4880620426):1.136615283,(t312:5.197007698,((t313:2.859445605,(t314:0.1741382936,t315:0.1505541341):2.445265486):1.185633397,((t316:3.647240242,(t317:1.66894718,t318:1.501508269):1.940525033):0.04439834106,(t319:3.13120096,t320:3.086793568):0.258550767):0.07307450001):1.035337357):0.6433425036):5.242238153,(((t321:1.395338977,t322:1.380117487):4.715423198,((((t323:5.029869655,((((t324:2.134521953,(t325:1.956170035,(t326:0.8574723431,t327:0.5443110095):0.8832149351):0.1675583818):1.69894275,(t328:2.56381223,((t329:1.367232449,t330:1.316984576):1.04582727,(t331:2.114833326,t332:1.983537896):0.2457662333):0.04202851814):0.6832524029):0.1953744567,t333:3.139295879):0.2397954037,(t334:0.8308620545,t335:0.8304407083):2.485760427):0.4465677533):0.07355029601,((((t336:0.8272868855,t337:0.7998242582):0.158370162,(t338:0.8313446947,t339:0.8199568045):0.09756378896):0.1145893128,(t340:0.3118002238,t341:0.2173756808):0.7044462458):0.3985739779,t342:1.313975328):2.325089092):0.4455602406,((((t343:0.5852600962,t344:0.5004084937):1.584148328,(((t345:0.5813816198,t346:0.5502630793):0.3278412643,t347:0.7726675086):0.6542036451,(((((t348:0.3274746073,t349:0.06658112182):0.335067187,(t350:0.2074306192,t351:0.000277643485):0.06837703642):0.164566661,t352:0.04415625237):0.363380452,t353:0.3784804072):0.004091142419,t354:0.3799421205):0.02963762513):0.4273175399):0.1853005952,(t355:0.2868302877,t356:0.05471185904):0.7169363597):0.5822244792,(t357:0.8035959799,t358:0.6779190304):0.1540024615):0.8765196682):0.2185423881,((t359:0.04907413682,t361:0.0004471728409):0.2374790223,t362:0.1393500289):1.312028211):0.3083577604):1.105517207,(t363:1.49573989,((t364:0.594418376,t365:0.5647839669):0.01262467407,t366:0.2482588764):0.6937298995):1.249471131):3.079379992):4.542683109,(((((t367:0.7108774374,t368:0.6709761384):0.1198990007,(t369:0.04434309329,t370:0.01680607663):0.6783649769):0.1927144557,t371:0.5807932463):1.174856417,t372:1.726966068):4.760727443,(t373:5.511315345,t374:5.299412948):0.9358527958):2.828954315):0.09895400815,t375:8.891258335):0.6850067625,(((t376:7.704070263,t377:7.694232951):0.5467096578,t378:7.893013336):1.122427521,t379:8.955123753):0.1932864629):0.2338096246):2.838229794):9.331994143):63.00782522,(((((t380:8.340409103,t381:8.24021395):0.3639563606,((t382:0.3905051242,t383:0.3696506087):4.397268737,t384:4.569675295):3.815493358):1.075348918,((((t386:3.075602462,t387:3.036137546):0.008993113238,(t388:2.347873127,(t389:2.247684868,t390:2.231224377):0.09537665501):0.6707294744):0.252722357,t391:2.696573781):4.96616255,((t392:5.786494072,t393:5.634352987):1.741176127,(((t394:2.273677954,t395:2.127282565):3.94079491,t396:6.014727986):1.005404756,((t397:1.10945782,(t398:0.6485166497,t399:0.5100730186):0.3957122882):0.9204555939,t400:1.820843365):4.901566507):0.08913907671):0.0819505378):1.121206863):11.44601316,(((((t401:7.115676651,((t402:2.649595248,t403:2.590650364):3.435961083,(t404:5.38733126,t405:5.381954427):0.6212218048):0.7516598627):0.277456744,((t406:6.107175734,((t407:1.495929933,t408:1.462863677):0.9185111445,(t409:2.18576522,(t410:1.938891871,t411:1.937779612):0.2124305004):0.1863126774):3.687011533):0.3245099769,t412:6.298802548):0.5764418315):1.796244558,((t413:7.491224897,((t414:5.421011198,(t415:4.990812847,t416:4.94524311):0.3612979755):0.6938748477,t417:5.92452493):1.373359889):0.2111280564,(((t418:2.125297184,t419:2.019381338):3.687983102,(t420:0.9436405288,t421:0.8598966181):4.597548085):0.2823762184,(((t422:1.021563252,t423:0.7823642771):0.4703323259,(t424:1.038439582,t425:1.025508303):0.04870744272):3.333522832,t426:4.378162386):0.7522159461):1.390206716):0.9576566703):0.2712496129,(t427:4.244657401,t428:4.231022601):3.395999389):0.5022023453,((((((((t429:1.499990689,t430:1.399404771):1.073776857,t431:2.386407522):0.2732537112,((t432:1.470925631,t433:1.438706551):0.3721414963,t434:1.771865978):0.6820902915):2.168414613,((t435:0.2258959745,t436:0.1881516196):4.151233412,t437:4.249723323):0.2379171728):0.169888876,((t438:1.913790558,t439:1.905721637):0.5960271144,(t440:2.333467817,t443:1.855525135):0.05860737721):2.037579285):0.6252847125,(t444:3.407288352,(t445:3.044976366,(t446:1.850571229,t447:1.799961616):1.085459459):0.3269677811):1.161514385):0.237245327,((t448:0.4790205268,t449:0.1670863043):3.993030528,((((t450:2.055494284,(t451:1.478263747,t452:1.260252319):0.5618936642):1.067978243,(t453:2.359804908,t454:2.254962692):0.4841328685):0.5887200617,(((t455:1.354557096,t456:1.344435325):0.07312914536,t457:1.341828447):0.5387276597,t458:1.791859146):1.218338312):0.3101026378,t459:3.260409463):0.1072726328):0.05058633722):0.5163030801,((t460:0.4081317096,t461:0.3557463943):2.572501784,(t462:0.8760491112,(t463:0.7363785469,t464:0.5885145935):0.1138734101):2.043644038):0.9323053735):1.382003699):9.373454797):1.430470529,((t465:6.430335063,(((((t466:0.07629702975,t467:0.05844431127):0.8800446256,t468:0.9007543413):0.3932115805,((t469:0.1760052051,t470:0.1300248596):0.9930873181,t471:0.8879896591):0.08641652002):1.069801472,(t472:0.9627235889,(t473:0.7955616499,t474:0.7927231436):0.01239398428):1.026145444):1.169659986,t475:2.953825224):2.770211437):0.1132850862,((t476:1.815424688,((t477:0.4713801281,t478:0.141816116):0.4739899461,t479:0.4630541436):0.3107019449):1.547046839,t480:2.302855557):2.261753654):9.240902726):61.82122715);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T12.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
