<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t481:0.3007940056,t482:0.2527569083):0.8116810466,((t483:0.3995194387,t484:0.2934301574):0.5748895621,t485:0.69045807):0.07879228361):0.7536911978,(t486:0.5914968435,t487:0.3138989193):0.8452324435):0.2182286197,(((t413:0.1360563768,((t347:0.08101241441,(t346:0.02146746288,(((((t329:0.2200524618,t330:0.2143715045):0.09069346901,((t320:0.02491411813,((t318:0.05921327344,(((t228:0.3412381981,(t227:0.01020627485,(t223:0.1341642051,((((t207:0.08770559441,((t202:0.5264268443,t203:0.4206199446):0.05653296896,(t204:0.2648214421,(((t194:0.1458847566,((t183:0.2921082559,(t109:0.06116628033,((t97:0.03758405377,(t87:0.3316636862,(t80:0.169472794,(t59:0.1063003954,((t1:1.291439245,(t2:0.3346619677,t3:0.3258197839):0.904768085):1.240458486,t4:2.16879956):3.212556662):2.572421442):1.501536791):0.5717036688):1.025682863,(((((t5:9.076743234,t6:8.894838927):0.1757211033,((((t7:3.5847881,(t8:1.230365188,t9:1.193187869):2.268663328):2.684742746,t10:5.79365636):2.295608644,(t11:7.862844907,((t12:6.098284564,(t13:5.130496912,t14:5.08589806):0.9430758264):1.066372628,(t15:5.424201614,t16:5.21876615):1.617464981):0.6443635773):0.07652411736):0.427805278,t17:7.7733611):0.05030660086):0.08404475606,(((t18:3.061540207,t19:3.010508196):3.29324452,t20:6.251824217):0.1358587091,(t21:2.893196683,((t22:0.09696851028,t23:0.0431640964):0.6525133492,t24:0.5207551092):2.008562204):3.329692778):1.328939402):0.8742663317,((t25:5.893161772,(t26:3.823311165,t27:3.612883886):2.068779462):0.7432998286,(t28:0.6596688305,t29:0.6417133569):5.693659731):1.32269375):0.3105382959,((t30:2.060749847,(t31:1.933272739,t32:1.925492438):0.112606011):4.02331313,(t33:3.786805748,(t34:2.376860095,t35:2.352880166):1.296545571):2.245351869):1.855480529):0.04011813584):1.12605158):7.570443123):0.8230049494,((((((t36:1.8776234,t37:1.779456419):5.381568357,t38:7.159281688):0.1978329472,((t39:2.929248504,t40:2.758377478):2.650078161,((t41:3.703352969,t42:3.658318091):0.3896089699,t43:3.991370815):0.9991086995):1.696791187):0.06548678633,((t44:5.358823387,t45:5.35691608):1.307070861,(t46:2.252343971,t47:2.213918157):4.228336347):0.04851584296):0.1160486073,(t48:5.263543535,(t49:0.5856537452,t50:0.4329416906):4.618447882):1.318170325):0.8929726129,((((t51:1.219717935,t52:1.210916549):3.636798818,(t53:4.127814815,t54:3.979007501):0.6567395739):0.5193296162,(t55:3.684624241,t56:3.6829877):1.32808887):0.6527742845,(t57:5.065750348,(((t58:3.37766726,t60:2.768815872):0.2475408077,t61:2.852271039):0.06829457854,t62:2.910533368):1.295633037):0.5012456685):1.179602215):8.756581129):0.243817472):1.453451865,((((t63:2.368717235,t64:2.365998506):4.136451162,t65:6.36512071):0.9962441002,(((t66:4.477790596,t67:4.317232711):0.2026687091,((t68:2.481077601,t69:2.345043471):1.663340242,((((t70:2.558684509,(t71:2.392298172,(t72:1.275920687,t73:1.099370711):1.018798399):0.07993600832):0.1651243413,(t74:1.590567887,(t75:0.9858410828,t76:0.9667792971):0.600500254):0.233295923):0.08602710087,(t77:1.137857063,(t78:0.4672028159,t79:0.4083935882):0.5839484146):0.6977083924):1.019673595,t81:2.493136749):0.108188641):0.3524894045):0.3766917364,(t82:2.795399804,(((t83:0.4767124448,t84:0.4130272264):0.3755110478,t85:0.5425834194):1.412293913,(t86:1.295067035,(t88:0.4478629878,t89:0.3770499391):0.170359404):0.4136824361):0.3492532894):0.3737177934):2.234030198):5.924408691,((((t90:0.3250561133,(t91:0.2334295121,t92:0.1718521962):0.06749751364):0.4910286879,t93:0.7035536728):1.642746889,((t94:0.07582444941,t95:0.04785108018):0.0226333973,t96:0.0344467749):2.223441587):0.02743235694,(t98:1.79934473,(t99:1.055447889,t100:0.9989571865):0.6193764227):0.05746140419):7.275221788):2.819252312):0.02378152181,((((t101:0.7263392606,t102:0.6885335078):0.8451244433,((t103:0.9883924721,t104:0.5314464539):0.1594908789,t105:0.3994271509):0.3036606892):4.704898772,t106:5.236921267):1.278000852,(t107:0.7722386147,t108:0.7614787861):5.631364437):4.134620703):0.233452781):0.0413178955):0.2247717266):0.1071346029,((t110:5.620112357,(t111:1.679496531,(t112:0.8479052307,t113:0.8166468102):0.4321416639):3.884010718):2.031216963,((((t114:1.331929231,(t115:0.5008807428,t116:0.4502081377):0.5423228065):1.102923403,t117:2.095065691):2.444756948,t118:4.464811472):2.023783001,((t119:1.401569904,(t120:0.3213631345,t121:0.2872648441):0.9969100219):0.7053153769,t122:1.959752826):4.3542168):0.2442533459):3.041090421):0.1885988198,(((t123:8.954988076,t124:8.879910308):0.6896891114,((((t125:0.08522535328,t126:0.06515178018):5.688066987,(t127:0.5959556055,t128:0.5607029692):5.14740618):0.5123584429,(t129:5.465799669,t130:4.544638378):0.7119986502):3.19044163,((t131:7.565167376,(t132:4.746783151,t133:4.724003404):2.603310201):0.6342171949,t134:7.91458807):0.2157757808):0.08530217436):0.05918149928,((t135:7.257429664,(t136:6.170345347,(t137:5.647021041,(t138:4.32846041,t139:4.177273157):1.244427902):0.2541305439):1.073727568):0.7417292686,((t140:0.3138925746,t141:0.2174718441):5.655102047,(t142:2.161509263,t143:2.066529):3.70671442):1.518300067):0.2619037377):0.06629782702):0.9754832539,((((t144:6.800848494,(((t145:5.608713574,t146:5.60079757):0.1001368901,(t147:4.938345825,(t148:4.441400053,t149:4.407353527):0.1435260003):0.7218959489):0.8008810467,((t150:0.3723964165,t151:0.1842789091):4.378402429,((t152:0.2805637705,t153:0.1667017976):1.842498897,(t154:0.3839349693,t155:0.3296165678):1.351198285):2.375917185):1.265591738):0.1461363809):0.1948657201,(t156:3.307012709,t157:3.305972288):2.295982372):0.3412158626,((t158:0.8880235986,t159:0.8351134965):2.915211605,((t160:0.4552981096,t161:0.4469226876):2.82153467,t162:3.191337801):0.4097756442):2.097055079):0.736125886,t163:6.396845088):0.03702761803):0.08851977694):0.3073419215):0.4222012):0.3235548391,(t164:5.42602781,(t165:3.421118767,((t166:1.78766438,t167:1.704905348):0.3182281415,(t168:1.924320642,((t169:0.64257234,t170:0.5659401858):0.03367703075,t171:0.4697702679):1.215615348):0.09654631329):1.26360361):1.957183387):1.937340407):5.702858166,((t172:4.778228488,(((t173:2.75932536,t174:2.742855461):0.2889670934,t175:2.91727302):1.065686002,((t176:1.787212319,t177:1.70775016):1.796210577,(((t178:1.890636167,(t179:0.2551617009,t180:0.1961340719):1.625124036):1.156439809,(t181:2.8471335,t182:2.693895766):0.01087256601):0.4055625997,(((t184:0.9501334334,(t185:0.8375801548,(t186:0.6643792914,t187:0.4888483124):0.06152483918):0.1012929097):0.6169849328,t188:1.068266173):0.708204001,(t189:1.596232307,(((t190:0.4854486334,t191:0.442671321):0.1451716664,t192:0.4600319895):0.141006425,t193:0.4657334196):0.804998836):0.1431652805):0.05694582606):0.02521370172):0.2712147538):0.6588505926):0.4110219257,((t195:0.9995507162,(t196:0.6948107335,t197:0.4612474384):0.2408804203):1.554479131,t198:1.857241106):0.07778406871):7.448414527):1.530562992):0.1260396167,(((t199:1.011992683,t200:0.9705478985):0.6410023357,t201:1.554175305):2.684568394,t205:3.379991959):6.548738598):0.02210905818):0.1126356425,(t206:2.266177999,((t208:0.6419824099,(t209:0.02920043079,t210:0.01194686799):0.5963717648):0.8746504304,t211:1.259471642):0.6172133477):7.747828504):0.8371068446):0.005187443658,((((t212:1.631548843,(t213:1.148194055,t214:1.092348848):0.3267882802):3.693566482,(t215:0.1877629365,t216:0.1451346687):4.908360198):3.572488135,(t217:8.325467496,(t218:6.021582903,(((t219:0.4613348553,t220:0.442120403):0.4756222531,t221:0.8406155347):0.1253480833,t222:0.8185782127):4.914668271):2.086855476):0.2589663627):1.392052076,t224:9.123304504):0.1193888243):0.3965627461,((t225:0.8170291468,t226:0.8149778329):4.06479282,t229:4.386745067):4.642413983):0.4954796226,(((t230:0.4042879117,t231:0.3760805132):3.195060169,t232:3.259089368):4.699657259,(t233:5.465588328,t234:5.454715697):2.438111927):1.172048436):0.778325687):0.2201258185):3.741223043,((t235:5.853256342,t236:5.80020412):1.140407746,(t237:5.120440357,(t238:3.901496513,((t239:2.604645981,t240:2.328022166):0.8588456172,t241:2.984014472):0.4346395395):1.133764793):1.171499122):6.739233429):2.241753064):6.138314726,(((((((t242:0.3802652309,t243:0.3445769569):7.009267615,t244:7.349770037):0.5434156536,t245:7.765792086):10.45916228,((((t246:8.738951713,t247:8.563915398):0.6821364361,((t248:6.114771508,(t249:3.887339817,t250:3.878271298):2.128857383):1.842698087,(t251:6.913808274,(t252:6.814727923,((t253:1.406781401,(t254:0.9496933282,t255:0.9208172718):0.4553590847):4.636023335,(t256:5.880369806,(t257:5.445163522,t258:5.394749098):0.4299087496):0.01429408269):0.6899680057):0.09771659794):0.8604241305):1.2878682):1.251926619,(((t259:4.178136503,t260:4.162315606):1.381352443,t261:5.484321702):1.425338006,(((((t262:3.866894177,t263:3.866619817):1.244779186,(((t264:1.322441932,t265:1.144870503):3.338387501,t266:4.481735448):0.0440240166,(((t267:0.8177684322,t268:0.738895168):1.123126448,t269:1.850308373):2.316614632,((t270:2.995376657,((t271:0.5892548281,t272:0.4327467921):0.0607605251,t273:0.4590565627):2.274736961):0.8833818746,(t274:2.497512864,(t275:1.534401222,((t276:0.03616411567,t277:0.03376243545):0.7042942817,t278:0.5671919307):0.2804433674):0.8732451756):0.8310648445):0.2642949926):0.2190172805):0.2129108619):0.1828343715,t279:3.381200018):0.0898801854,(t280:3.450569652,(t281:1.271374739,t282:1.255709594):2.089852445):0.01917930694):0.3215141352,(t283:0.7294809777,t284:0.589218169):2.79089914):1.172524601):2.981877551):5.471094632,((((((t285:2.767301248,t286:2.764678943):0.7654936807,((t287:2.668278686,t288:2.584653838):0.5351577024,t289:2.825166235):0.2841638103):0.7693606426,(t290:3.730204475,(t291:3.488568465,t292:3.465398366):0.1882542022):0.1201296042):0.5594773456,(t293:4.144640639,(((t294:3.193303301,t295:3.084771371):0.6022692621,(t296:2.941489658,(t297:2.814020822,((t298:1.037029327,t299:0.9561785142):1.370225735,t300:2.171524872):0.3952953251):0.004975036119):0.6756044952):0.2785846444,((t301:2.341281143,(t302:1.6387578,t303:1.635508434):0.6200216175):0.9443058257,((t304:1.07494384,t305:1.029061549):0.661427531,t306:1.657792491):1.450733168):0.04410602861):0.03039065772):0.07998264087):0.1599557601,((t307:1.977010985,t308:1.975601077):0.6595737049,(t309:2.042966522,(t310:1.838172138,(t311:1.397497818,t312:1.374631277):0.4190686516):0.1986507751):0.5723213643):0.7327141388):6.36464658,(((((t313:1.671859909,(t314:1.319831104,t315:1.25472196):0.3206214063):0.5795236362,(((t316:0.3839840207,t317:0.3096405978):1.031529473,t319:1.069493762):0.6545255861,(t321:1.41379957,(t322:1.150422352,(t323:0.759238976,t324:0.6865701847):0.2985365655):0.1720526237):0.2098227985):0.02874482532):1.290796068,((((t325:1.189498024,t326:1.187535247):0.298105427,(t327:0.8735532752,t328:0.8292973075):0.3488951286):0.3356616826,((t331:0.2192416816,t332:0.1805432426):0.288377127,t333:0.3846490206):0.4796289108):0.5378081908,t334:1.338600441):0.3251371112):4.294703182,(((((t335:0.8091622086,t336:0.6954191712):0.08511693755,(t337:0.698539549,((t338:0.2259373578,t339:0.1892791942):0.1791398309,t340:0.2922237455):0.2793728057):0.06254846003):2.409986968,((t341:0.8395904168,t342:0.6818079469):0.2319942538,(t343:0.6109035621,t344:0.5662831548):0.1017599797):1.921787479):0.2394636442,(t345:2.025254006,t348:1.362412456):0.626220511):0.4069960579,(t349:1.076895007,t350:0.9611151544):1.317706976):1.955510652):1.329777436,(t351:0.5641612974,t352:0.4193472462):4.823361703):0.4821362739):1.440620209):2.038008184):1.158347616,(((t353:5.613484509,t354:5.417881747):1.641359627,t355:7.027950225):1.692995713,(t356:5.25318695,(t357:3.118925863,t358:3.114593135):2.124870513):3.428413047):0.9636637079):0.04972832369,(t359:9.126595959,((t360:6.359033165,(t361:1.654471048,t362:1.561533714):4.648731671):2.622064078,((t363:2.312785867,(t364:0.3980989151,t365:0.396223557):1.889920341):5.231474703,(t366:2.799378536,((t367:0.4070908697,t368:0.1690853108):1.231579023,t369:1.327168258):0.8849754129):4.697820951):1.111578114):0.05262749768):0.2314722808):0.3294452683,((((t370:1.626066983,t371:1.572166973):4.225597319,t372:5.688212279):2.046022979,(((t373:5.5919112,t374:5.567695538):0.407220705,t375:5.932677293):0.8338155425,t376:6.725279993):0.6952745321):0.4008420032,t377:7.767049827):0.0960773571):0.8668075286):1.084241723,(((t378:2.847972982,t379:2.794328724):4.034110764,t380:6.821757157):0.1173692264,t381:6.909599812):2.812832741):0.2050169274):8.962898607,((((t382:1.782853859,t383:1.768872311):3.623475825,(t384:1.795035355,t385:1.781677159):3.502823803):1.745058725,(t386:0.7562572272,t387:0.6884497782):6.190016381):0.6717180108,(((((t388:6.058277151,t389:6.029914449):0.6666055393,(t390:5.416835983,t391:5.290832173):1.227500888):0.2379374697,((t392:5.030586396,t393:4.924768481):1.336688683,(t394:5.753915816,((t395:0.3485289954,t396:0.2175843388):0.2947241367,t397:0.4563536611):5.083879074):0.4834262571):0.3828156049):0.09968391676,((t398:3.163229017,t399:2.985623115):2.235432762,(t400:4.445386292,t401:4.308629891):0.7248626525):1.028177237):0.3924331433,((t402:1.525545864,t403:1.359132427):0.3212529602,t404:1.670833741):4.579012133):0.04956699434):11.01583175):15.02154769,((((((((t405:0.3374453974,t406:0.3090495775):4.029571752,(t407:2.904034934,t408:2.662603958):1.357827381):1.411450279,((t409:3.57163322,(((t410:2.015688881,t411:1.829325866):0.262051806,(t412:1.27293805,(t414:0.7356404863,t415:0.6239943859):0.2960000289):0.7771433012):0.06836489674,t416:1.752315397):1.211290114):1.249843459,t417:4.099234926):0.4782271754):0.4522536541,((t418:0.06734365403,t419:0.03365231251):4.622651114,(t420:1.574366177,t421:1.520148834):3.01858678):0.2517095168):0.3149484988,(((t422:0.2360214972,t423:0.213589522):2.925239221,(t424:2.901595538,t425:2.889989716):0.1166807131):1.205981537,((t426:2.231177155,t427:2.082206083):1.146572314,(t428:0.2682301732,t429:0.2491965852):2.950113499):0.7022653218):0.6583341595):0.3924292127,((t430:3.25196415,t431:3.158254349):0.8113679524,t432:3.881605016):0.8888064852):0.7111006977,((((t433:1.914059498,(t434:1.186469437,t435:1.023759229):0.4939459805):0.07083252702,t436:1.418271116):1.555633305,(t437:2.101414225,t438:2.061454151):0.6847256352):0.9892841446,(((t439:2.606658111,t440:2.559931259):0.005335676396,(t441:2.404902887,t442:2.233460287):0.1348424044):0.6267318718,(((t443:1.436499609,(t444:0.5720722225,t445:0.5478068763):0.8127145952):0.4976181255,t446:1.451650361):0.1562222277,(t447:0.5974329944,t448:0.4807602992):0.9935724319):0.8744234721):0.3334800956):0.9152416683):0.01030160127,((t449:0.07265371485,t450:0.005172203115):0.50899513,t451:0.4656744512):2.927713121):24.67595903):37.38952483,((t452:1.881862857,(((t453:0.498678846,t454:0.4387309436):1.079515935,(t455:0.4515863602,t456:0.1568390341):0.9237803792):0.1287633835,(t457:0.4393728149,t458:0.4229765364):0.7586752599):0.01346280521):13.08879492,(((((t459:1.379169978,(t460:1.207099205,(((t461:0.390627059,t462:0.3538641891):0.3074664458,(t463:0.4799774906,t464:0.4537793186):0.1796684535):0.2004737819,(t465:0.4645540025,t466:0.4095313693):0.3641784689):0.3039760742):0.08980946662):0.2183110385,(t467:0.4382865295,t468:0.409428184):0.8568169129):0.4063161912,(t469:1.536048251,((t470:0.3313241456,t471:0.3274059742):0.444666728,((t472:0.09367223042,t473:0.08249861658):0.25751328,t474:0.3321893862):0.4117096625):0.7270604013):0.09996078792):0.4943064118,((t475:0.4670135239,t476:0.1459006751):0.04411692664,t477:0.1198826346):1.546547955):9.052421725,((t478:0.4911324882,t479:0.3764285694):0.1123923544,t480:0.4007673197):10.0955484):2.661393856):50.36282144);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T50.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
