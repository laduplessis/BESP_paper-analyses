<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t443:2.344214696,t444:2.339481262):0.3567814464,t445:2.682896005):0.3200108891,(t446:1.059397859,t447:0.895361949):1.877301757):0.460541204,(t448:2.169453768,((t449:1.93403723,(t450:1.10960174,t451:1.055525623):0.7323059469):0.01355342005,t452:1.795059461):0.2193846481):1.014335193):0.2378216698,t453:3.15979746):5.949279869,((((t454:0.3483600004,t455:0.3471784967):1.747841149,((t456:1.329304299,t457:0.5532115972):0.07616103239,(t458:0.1799868531,t459:0.1729784584):0.2021302039):0.5132661343):0.2444971874,(t460:0.3333773206,t461:0.198387361):0.7898701459):1.225648267,(t462:1.615739868,(t463:1.4961689,(t464:0.8311647801,(((t465:0.1485461722,t466:0.1310913184):0.1971657095,t467:0.285106319):0.0215541127,t468:0.3040962617):0.409610926):0.5433838628):0.002341480321):0.5766549861):5.457973425):0.9259691692,(t469:0.585733123,(t470:0.4353913098,t471:0.3105142323):0.08631576346):7.348158984):15.74040685,(((t472:0.6133407013,(t473:0.4683988838,t474:0.4537333263):0.07344863606):0.1433454939,t475:0.5903299483):13.61492831,(t476:12.48072038,(((t478:0.8842998452,(t479:0.3074068298,t480:0.2796960036):0.1714388464):9.510358374,((t477:0.01820475362,((t382:0.05710740449,(((t348:0.03072631738,((t304:0.0631734356,((t257:0.109946584,(((t235:0.1266099115,(t227:0.002183660319,((t212:0.2770138135,(t213:0.207035649,(((t104:0.002335253674,(t103:0.1173466255,(((t97:0.05426674574,(t90:0.1127013328,(t62:0.0570521941,t1:6.834802242):2.509572995):0.8116022967):0.04857641957,(t2:0.9175790744,t3:0.8085385985):9.066978115):0.4910881059,(t4:3.183959835,(t5:0.6893558231,t6:0.5801706835):2.43245057):7.082048719):0.1212837242):0.3488689022):2.647446,((((t7:0.30740198,t8:0.2740233371):0.9860965197,t9:1.135845222):8.007010491,((t10:5.332293321,t11:5.188826746):3.126144776,t12:8.273257607):0.5984351028):0.106828102,(t13:2.267777183,(t14:0.1124381388,t15:0.06206272287):2.060677527):6.647852676):3.67898733):3.822725253,((((t16:9.220148243,(t17:7.821143103,(t18:0.4071503827,t19:0.1934525213):7.307763334):1.303129591):0.04834134869,((t20:4.328111322,(t21:0.5047151146,t22:0.4620905428):3.787840743):0.02344182555,(t23:1.764325028,t24:1.674948514):2.262666229):4.398292701):2.211875221,(((((t25:3.633878685,((t26:1.422269052,t27:1.350558295):1.821639046,t28:2.636830599):0.3346749852):2.73507877,t29:5.684902813):2.281307141,((t30:5.72202589,t31:5.693115015):0.6511667049,(t32:2.748184009,t33:2.706959073):3.520524706):1.571564848):0.5410629383,((t34:6.247987388,t35:6.239202126):0.9601625026,t36:7.066940866):1.121680166):0.5843293647,(((t37:6.271649645,(((t38:4.292579065,t39:4.2641654):0.6885992176,t40:4.942615465):0.6757225315,(t41:4.554528742,(t42:2.122759404,(t43:1.973629041,(t44:0.5762533392,t45:0.5512159215):1.185213467):0.1437819177):2.408204779):0.9530625362):0.5748453093):0.4437080822,((((t46:0.4273310476,t47:0.07708432436):1.527470319,(t48:0.6176641012,t49:0.5334066675):0.7276063272):0.7061662528,t50:1.782463081):1.144745395,t51:2.508112387):2.358173673):0.6600894426,(t52:5.007574526,t53:4.959834795):0.4911914762):1.320185213):0.5040951497):1.266920984,(t54:4.547800766,((t55:2.551703611,t56:2.476535911):1.028890831,((t57:0.4751184423,t58:0.288089787):1.600673321,t59:1.843764272):1.423504928):0.9011360109):3.919663048):3.518475316):3.870488563):0.04182871857):0.1713255802,((((((((((t60:1.402370757,t61:1.032681812):2.354647354,(t63:0.3888190757,t64:0.3682533098):2.643538049):1.966929203,((t65:4.129787197,((t66:3.37563257,t67:3.367475582):0.03132021751,(t68:1.846783762,t69:1.714787057):1.428488985):0.5748165923):0.549900738,((((t70:0.2121133004,t71:0.02364244319):2.057332389,t72:2.027541941):0.2569138558,(t73:1.807316791,t74:1.793402512):0.4719210331):1.290046858,((t75:1.890074042,t76:1.888330214):1.499525649,(t77:2.290199435,t78:2.269477673):1.038629169):0.1330427764):0.3518874852):0.2808866955):0.6579134632,(((((t79:0.7304166598,t80:0.7236994832):0.401531468,t81:0.941395197):0.426571677,t82:1.319711864):1.354808345,(((t83:1.988206921,((t84:1.471886105,((t85:0.3707133337,t86:0.3303120342):0.857419193,t87:1.1688221):0.1756224053):0.01069096058,t88:1.318491755):0.06984052201):0.2332438694,t89:1.581219719):0.02471832832,t91:0.8812897684):0.4193528177):0.05654351708,t92:1.181402059):1.74142261):0.1727233902,((((t93:0.8410661642,t94:0.6263769728):0.5021841919,t95:1.086957299):0.02842640126,t96:1.105844551):0.4589378561,((t98:0.7627331393,t99:0.6030616501):0.4133785054,((t100:0.2993969974,t101:0.2934590221):0.2217170193,t102:0.2558725671):0.461851362):0.1939084679):1.18608986):0.2615618335,t105:1.813508611):0.08350414054,(t106:0.67930613,t107:0.641764246):1.11980452):0.1995016811,t108:1.924692678):3.876299919,((t109:0.1671722929,t110:0.09689763956):0.8498225631,(t111:0.1509901946,t112:0.0772756706):0.5637688485):4.656489833):1.956098048,(t113:1.937467274,((t114:0.982150388,(t115:0.3019068323,t116:0.2718188239):0.2766333989):0.2926078359,t117:0.8193499316):0.4840927377):5.243303184):2.551055121):0.4714281447):0.7336496961):0.5239778385,(((t118:0.5271858623,t119:0.2450192411):5.739162506,(t120:1.224740715,t121:1.164799298):4.690300593):3.017215537,t122:8.707417686):1.507845805):0.9832758029,((t123:1.508878202,t124:1.393687675):8.779676726,((t125:9.068121243,(t126:8.973005997,((t127:8.178402817,(t128:1.386113316,(t129:1.315842115,(t130:0.7370018902,t131:0.6184572535):0.5741583538):0.007046502331):6.762434949):0.5442559222,((t132:8.185742151,(((t133:2.94408986,t134:2.684491966):3.716319298,((t135:1.722064606,t136:1.661454266):1.288949358,t137:2.871989637):3.162169658):1.162079074,(t138:6.388976801,t139:6.28987389):0.5662326346):0.336748387):0.2059902833,(t140:6.333712123,t141:6.229629674):0.9276867386):0.1112983603):0.1912417399):0.06732082011):0.751885377,(((t142:5.961486426,(t143:5.408810659,(t144:2.890021232,(t145:1.370976638,(t146:0.3769781613,t147:0.3682012777):0.96352359):1.480915981):2.355634313):0.4199815655):0.5810453927,(((t148:0.3189170625,t149:0.2925985231):5.441305078,(t150:4.845906595,t151:4.700884191):0.8800802265):0.05217237077,(t152:1.104234997,t153:0.9261983419):4.401449293):0.1042183591):1.23918304,((((t154:0.495365313,t155:0.2614512469):4.119690132,t156:4.318554268):0.9734358536,(t157:2.558323951,t158:2.526462632):2.677561537):0.8247428006,((t159:1.026444573,t160:1.017129433):4.472674337,((t161:2.924653624,t162:2.873412027):1.856550153,((t163:0.253500142,t164:0.04334066795):1.972049872,t165:1.962068113):2.498118791):0.6544792608):0.5131544627):0.0490037364):0.4604443727):0.3409533384):0.8498001016):1.611545714):4.534584376,((((t166:1.651492992,t167:1.575003849):2.622878076,(t168:3.664907645,t169:3.593113043):0.5221716093):2.309239964,(t170:2.281295178,t171:2.197208444):4.122889381):2.780810186,((t172:4.826965375,((((t173:2.918079312,(t174:0.4960315537,t175:0.2797254554):2.330428267):0.7500700782,t176:3.29561928):0.7784723572,((((t177:0.4900006825,t178:0.4893630786):1.092678497,t179:1.509525922):1.727598959,(t180:2.67211248,t181:2.595282989):0.556191071):0.4203776305,(t182:3.50566983,((t183:2.213767465,t184:2.079344768):0.1096919645,(t185:0.3306279413,t186:0.1539923747):1.791541181):1.112431299):0.02725708004):0.1265643498):0.2188770693,((t187:2.832364697,(t188:2.08867066,(t189:1.545715538,t190:1.452621253):0.3346083305):0.4029314091):0.2370762141,((((t191:1.619662778,(t192:0.6678418075,t193:0.6529015834):0.9098806902):0.01542550544,t194:1.546224095):0.1694233125,(t195:1.149367491,(t196:0.5129675414,(t197:0.3909937265,t198:0.3879795247):0.1151204854):0.6038517551):0.5425143096):0.3054660065,(t199:1.418982388,t200:1.277929628):0.3548799088):0.2683095967):0.294428213):0.09101470677):1.872415109,(t201:2.622439218,((t202:2.278585915,(t203:0.0467596239,t204:0.0372219564):2.185348202):0.2410701198,(t205:2.002835378,t206:1.975434334):0.2195207423):0.06932069545):1.497592058):2.299890069):3.848582362):0.6715858708):3.401512283,(((((((t207:2.038722483,t208:1.996891241):0.3616038544,((((t209:0.681682494,(t210:0.2106745931,t211:0.1397140081):0.402328171):0.848002478,t214:0.8968089623):0.3178255426,(t215:0.9975012921,t216:0.7676914002):0.1344012217):0.3714960678,((t217:0.7553489733,t218:0.7186824473):0.01496937026,t219:0.6222357529):0.5031868755):0.1142959996):1.075435366,t220:2.289254789):1.632143158,(t221:0.2672762624,t222:0.2506983904):3.632630113):4.275563332,(((t223:0.5506815788,(((t224:0.1086355734,(t225:0.03281021603,t226:0.03053539452):0.04765212075):0.1036434262,t228:0.1387145964):0.07137138819,t229:0.2058964137):0.2294999287):1.635983171,(t230:0.2660044525,t231:0.1780972387):1.686696727):0.618312764,t232:2.450480749):5.34603406):1.94625579,(((t233:1.335953673,(t234:1.106531197,(t236:0.2286442811,t237:0.1946684801):0.2753562801):0.2153711):2.170696424,t238:2.722878336):3.661255594,(t239:1.133101559,t240:0.9323437188):5.100402293):2.44094474):1.600020791,t241:9.786530156):0.8608813436):0.615337416):0.05126943544,((t242:10.97178608,(((((t243:0.7741464309,(t244:0.4701684658,t245:0.2254487365):0.2453338557):4.756037016,t246:5.03607252):1.211027325,t247:5.997475751):1.062633391,t248:6.95457062):1.051592856,(((t249:0.3304424969,t250:0.1716096717):2.171329835,t251:2.247979466):1.047031582,t252:3.142370286):4.393990357):2.033563219):0.01289026767,((t253:7.449710834,((t254:5.594856833,t255:5.564361581):1.670477375,t256:7.005339806):0.03361181474):1.437944244,t258:7.98793114):0.6703842464):0.3289333756):0.7318767643,(t259:7.233383205,t260:7.122296071):2.363666044):1.735133313):8.089869504,((((((((((t261:2.822777884,(t262:1.347813489,t263:1.23411424):1.472584623):3.612783891,t264:6.279223237):0.2846001434,(t265:4.837890108,t266:4.698705957):1.699975571):1.583823975,((t267:7.140069492,t268:7.062268374):0.2373978946,(t269:2.336966501,(t270:1.558562656,t271:1.546020902):0.7229130386):4.93165073):0.6038508834):0.9782397285,(((((t272:2.640200864,t273:2.574182117):2.879223754,(t274:3.579999886,t275:3.299892831):1.770726723):0.2727450243,((((t276:3.579718195,t277:3.513183918):0.2255865293,t278:3.665520591):0.7253701013,t279:4.280760398):0.2418032055,(t280:0.6281294893,t281:0.536933837):3.733962849):0.2837677):2.355097453,((t282:0.3240912281,t283:0.3078827685):4.872736146,((t284:2.865021761,t285:2.671110754):1.794790914,t286:4.464665566):0.4191646454):1.606292653):0.0571144369,((((t287:3.601764145,t288:3.544962384):1.181659657,(t289:1.598974445,(t290:0.2312674791,t291:0.04525344009):1.349313685):3.087032479):1.136476546,(((t292:0.4596927187,t293:0.2519460319):3.043045926,(t294:3.109038668,t295:3.039575202):0.1822307676):1.097894913,(t296:0.3087591819,t297:0.004946961168):3.709868166):0.932006936):0.1976645136,t298:4.801466385):0.3162348203):0.4685690863):0.8487939381,(((((t299:1.982310258,t300:1.972263782):1.453408997,t301:3.296459204):0.600953602,(t302:1.979441654,t303:1.731830952):1.883064613):0.03716811898,t305:3.465922214):0.4448193037,(t306:2.825623534,((t307:2.419427929,t308:2.371034366):0.1325344399,(((t309:2.158576258,(t310:0.2330607237,t311:0.2319258242):1.857389043):0.1960876627,((t312:1.909809779,(t313:1.556203948,t314:1.481257033):0.3195594957):0.1658309549,t315:1.924571723):0.179970243):0.03377741631,t316:2.110099208):0.005815883734):0.2146708603):0.7819151323):1.615788551):1.523859831,((t317:3.178162994,((t318:2.083169963,t319:2.016163929):0.4305109688,t320:2.393230773):0.5855797409):1.877566586,(((t321:2.584275584,(t322:1.799136281,((t323:0.3844738632,t324:0.2734994848):1.306596814,t325:1.532413233):0.05105594212):0.7749664654):0.194138456,(t326:1.638803093,((t327:0.255519396,t328:0.2263957899):0.8341138346,t329:0.9572235975):0.4778251151):0.8609670435):0.4658258121,(t330:1.866173255,((t331:0.7356889459,t332:0.7308910169):0.414618823,(t333:0.0929622963,t334:0.06420965409):0.9054311419):0.5664059407):0.7725072394):1.568107743):1.108728688):4.320355258,(((t335:0.6841896134,t336:0.3981169545):1.14151306,((t337:0.2681716116,t338:0.2616902798):0.5957561424,(t339:0.7880013931,(t340:0.1150872658,t341:0.06807712252):0.640716419):0.009839275579):0.6322407119):4.494262567,((t342:0.5364519285,(t343:0.1841716039,t344:0.1264427443):0.03361367838):1.364231907,((t345:0.3639792704,t346:0.3441069733):0.1018466125,t347:0.3698790019):0.8895785918):3.744418094):2.74189882):2.376503941,(((t349:0.02339152872,t350:0.005744574326):2.048307397,(t351:0.4332190825,t352:0.2632622047):1.535968438):1.462011638,((((t353:0.2075204922,t354:0.2065584314):0.252177619,(t355:0.2966382003,t356:0.128286089):0.01813553012):0.7295966098,t357:0.6989290277):0.8582298904,t358:1.542528992):1.182144055):6.138543266):0.07339222524,((t359:0.4168576881,t360:0.1945613821):1.758897313,t361:1.900419777):6.590517415):0.7293537897):1.166034514):0.08587266188,((t362:8.221932511,((t363:7.190442845,t364:7.164167029):0.9201481467,t365:7.9537725):0.1083354114):0.869617416,t366:8.876031351):1.249886778):10.54390305):1.630280726,(((((((t367:0.5954375241,t368:0.5214526664):0.04177864853,t369:0.5515505964):7.561925549,(t370:6.675110752,(t371:3.166521279,t372:3.111687694):3.489162053):1.283555526):0.6246896925,(t373:8.14124391,(t374:6.447665298,t375:6.44551365):1.672121963):0.3144427671):1.032115389,(((t376:7.301245672,t377:7.299309745):0.8712525171,(t378:0.4257415576,t379:0.3790898427):7.725899034):0.1753338836,(((t380:2.116965576,(t381:2.075023431,t383:1.295209442):0.02580119937):2.678242842,((t384:1.214529341,t385:1.091390871):1.24914335,t386:2.20313348):1.470738009):2.922360599,((t387:4.776732609,t388:4.76131792):0.656152353,((t389:1.893264802,t390:1.871392797):1.49031846,t391:3.306455507):1.886334726):1.052004156):0.5296960619):1.050823232):11.26387054,t392:19.06074042):0.3157944902,((((t393:7.232991539,(t394:3.281119032,t395:3.253489471):3.943250367):0.6995926872,(((t396:6.254848891,(t397:0.7201995122,t398:0.7180893843):5.503242652):0.2047474878,t399:6.404598972):0.5134915518,((((t400:1.432020436,t401:1.349791896):2.780537149,t402:4.089913811):1.146193682,(t403:3.570689955,t404:3.565564113):1.647272637):1.11236862,(t405:5.739738191,(t406:5.634718331,(t407:3.570431208,(t408:2.058097087,t409:1.996609815):1.457537961):2.007585095):0.01285088239):0.5296773193):0.3999330833):0.8634042052):0.6333467858,((((t410:0.7892252843,t411:0.7621828079):5.752344302,((t412:5.627962158,(t413:4.528590727,t414:4.444056913):0.9970968293):0.6474375381,t415:6.047748004):0.1499120346):0.7439690102,(((((t416:3.18861481,t417:3.173502359):0.4384657523,(t418:1.078350048,t419:0.711612348):2.364065546):1.589821427,((t420:3.314202416,t421:3.063390723):1.215600922,t422:4.209619794):0.1355992492):0.8358831782,(t423:1.861515192,t424:1.821050134):2.8890351):0.2125890022,(((t425:0.5420075199,t426:0.4995381278):3.542468511,t427:3.915041397):0.4496127661,(t428:3.700713123,t429:3.628711683):0.5364819619):0.3167258435):0.4324119861):0.2998088554,(((t430:3.388944441,(t431:3.178313776,(t432:2.683840596,t433:2.260647804):0.3176522473):0.09442082524):1.044894096,((t434:1.74105809,t435:1.582798074):0.2356699211,t436:1.716063378):1.687300083):0.06744611968,(t437:2.707170882,(t438:1.929210071,t439:1.922648257):0.7563375421):0.6375981489):0.6704473524):0.2096942577):0.984248621,(t440:1.387579442,(t441:0.4988606942,t442:0.4392895682):0.8105266932):3.699727598):9.773175808):0.7385675512):0.1316679202):1.723796064):9.089600959);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T39.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
