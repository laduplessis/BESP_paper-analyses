<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t447:1.945733068,((t448:0.4886640141,t449:0.4747932296):0.8475132971,t450:1.194949097):0.4164965872):1.608735072,t451:3.199748596):3.456119827,(((((t452:1.597834265,((t453:0.07269448119,t454:0.00511842764):0.1778321035,t455:0.1311539914):1.331829271):0.3511593154,(t456:0.9964460704,t457:0.6842904236):0.6696716):0.3330866943,t458:1.683383232):0.1313434464,(t459:0.4038527527,(t460:0.305024179,t461:0.2983445971):0.09417111143):0.9522612099):0.1302909759,t462:1.42250244):4.075536643):7.527889935,(t463:2.19786781,((t464:0.06896894771,t465:0.05660255786):1.947865929,t466:1.733930464):0.10941131):10.81292486):1.055755162,(((t467:0.6426134833,(t468:0.2580788329,t469:0.2480928044):0.3831256739):1.292544353,(t470:1.440989235,(t471:0.6986043802,t472:0.6953136291):0.6843442234):0.1291388519):11.30511507,t473:12.7260429):0.3873801646):94.44471629,(((((t475:0.2757069211,t476:0.2528142341):0.6894592706,(t477:0.3526592617,t479:0.3156521557):0.4801460096):1.836081232,(t478:0.01759066121,(t474:0.6273987048,(((((t389:0.1255131227,((t375:0.06244980819,((t373:0.09362862928,((t354:0.0692585958,((((((t305:0.1580117014,((t247:0.1197908473,(t243:0.02759625851,((t232:0.3349190058,t233:0.03128238555):0.04225546371,(((t202:0.01622937785,(t199:0.06231248591,(t147:0.003886426708,((t127:0.002461795449,(t1:9.688599501,(t2:7.126110506,(((t3:0.7076435404,t4:0.5931009834):2.127868524,(t5:0.7394353603,t6:0.6907371357):1.685164109):0.4026291566,t7:2.625912953):3.514570731):2.43628505):1.796140071):1.922425428,(((((t8:4.162495195,t9:4.103307272):4.944193101,(t10:8.491504606,((t11:3.145374945,(t12:0.5352008794,(t13:0.3042745311,t14:0.2498629014):0.1476972257):2.595250364):4.619629112,(t15:6.24705683,t16:6.236622609):1.335608015):0.4581272722):0.5148162341):0.07527781241,(t17:6.87674534,t18:6.863062395):1.735419467):0.4927706761,(t19:8.517861906,((t20:4.397183158,(t21:2.190260732,t22:1.934606411):2.172399082):3.358391181,(t23:6.83124885,((t24:2.509850445,(t25:1.654427211,t26:1.589612828):0.8293029095):2.274987168,(t27:0.1052287567,t28:0.07617021176):4.574629293):1.994899143):0.4336402775):0.3611371854):0.477749519):0.8035560711,(((t29:6.549144421,(t30:4.893476676,t31:4.892598556):1.65029181):0.7560619821,((t32:0.3565617811,t33:0.3378954816):6.06849691,t34:6.405667662):0.5593608513):0.2410634572,(((t35:3.821638838,(t36:0.8692663571,t37:0.8492043547):2.772551291):2.255929876,(t38:5.133064307,t39:5.069887568):0.7235565878):0.9254205628,((t40:1.163954213,t41:1.149780049):5.053383354,(t42:5.766393835,t43:5.588052435):0.3858117937):0.4996122368):0.1591579218):1.118621225):1.781543527):0.4796297468):4.834914193):0.2640015543):2.024420073,(((((((t44:2.738500877,(t45:1.032035714,t46:1.02984319):1.671697171):3.016674048,(t47:4.961944584,(t48:1.091706642,t49:0.9339952386):3.758284078):0.6681556493):0.43486234,(t50:4.018290976,t51:3.64988391):1.705949461):0.1607748925,(t52:4.718779201,t53:4.574403763):0.7450635619):1.787296555,(t54:5.970500707,(((t55:1.602231291,t56:1.399325962):2.825695843,t57:4.105247649):0.6966144243,((t58:3.272185527,t59:3.16813102):0.8939398969,t60:4.038409808):0.621195861):0.7951451815):0.9483586979):0.4895563121,((t61:4.221212155,(t62:2.886338741,(t63:2.589922863,(t64:2.341647494,(t65:0.5502623504,t66:0.533625793):1.764938804):0.07096556211):0.1484809615):1.155032731):0.3827637013,(t67:2.365202185,t68:2.353402209):1.660250125):2.075106835):1.021849461,(((t69:4.974568617,(((t70:2.925841636,t71:2.864959721):1.101459832,((t72:1.596877297,t73:1.586975224):2.221923976,(t74:2.142109667,(t75:0.5883996441,t76:0.511354047):1.529629677):1.549182304):0.1461966218):0.5882889487,(t77:3.507651302,((t78:1.799994117,(t79:0.3067790733,t80:0.2492026987):1.440848635):0.2092508653,t81:1.871711352):1.466677812):0.8066869997):0.327574786):0.4072906144,t82:4.789609437):1.157652524,(t83:3.985801473,(t84:0.8678021753,t85:0.7295415924):2.833620821):1.817983696):0.3633487596):7.403165572):0.3760310669,((((((t86:2.136881135,t87:2.069753775):0.0705132171,t88:2.074723405):0.3523694443,(t89:2.045192128,t90:1.979439915):0.3790528342):1.663406416,(((((t91:0.5228356977,t92:0.4682171402):1.250169991,t93:1.707954458):0.3205430994,(t94:1.488129106,(t95:1.380565759,t96:1.32354091):0.08323317759):0.5104463495):0.9080996574,(t97:2.062967045,t98:1.978125925):0.7440874508):0.6304574934,((t99:1.838312592,((t100:0.1841980173,t101:0.1793638724):1.394047507,t102:1.567106921):0.2132959427):0.3734950012,(t103:1.818245517,t104:1.754485527):0.1554167323):1.135068189):0.3752611649):1.403884211,((t105:2.24365573,t106:2.102391052):1.55270283,((t107:2.147762426,(t108:1.488166271,t109:1.004517144):0.6510991373):0.312390383,(((t110:0.4431230308,t111:0.1595076433):0.2808199954,t112:0.06999262045):0.2501510784,t113:0.3170711502):0.9027991345):1.096606961):1.016634192):5.59908483,((((t114:1.730765983,(((((t115:0.265832856,t116:0.2515308654):0.1500871213,t117:0.338002686):0.285166963,((t118:0.421951946,((t119:0.3208621842,t120:0.3063675677):0.04033623526,t121:0.2396214295):0.03904495429):0.1172882236,((t122:0.1478284645,t123:0.1346153855):0.05888667519,t124:0.1569157793):0.1660024185):0.05558927572):0.457609223,t125:0.8289294466):0.01102610438,t126:0.5061218695):0.2584390895):1.068641292,t128:1.171840876):1.173602573,(t129:1.744036662,t130:1.295393437):0.507903648):0.8830462459,(t131:0.7444656155,t132:0.5804101391):1.893583543):3.861602966):2.249233852):0.4551547614):1.165873418):0.9329799087):0.6197781248,(((t133:0.4028887746,t134:0.2899759232):0.6816331335,(t135:0.692650781,(t136:0.2728514812,t137:0.1806352637):0.351632229):0.1078266127):9.292598266,(((t138:6.52007334,(t139:2.916919586,t140:2.876359137):3.5686992):1.840946472,t141:8.245069745):0.5831978891,(t142:7.991909457,t143:7.931822395):0.7516858744):0.830421476):1.318313421):4.665244753):1.409168835,(((((((t144:0.8794186923,t145:0.8594444257):7.915865322,((t146:7.920475036,((t148:6.347855905,(t149:2.79514051,(t150:0.9501762793,t151:0.7841529499):1.84039619):3.200976978):1.017587522,(t152:6.306690661,(t153:3.744294709,t154:3.73362186):2.468534006):0.5312878891):0.4670795983):0.5234144498,(t155:6.984683153,(t156:5.938825205,t157:5.912474895):0.8656178815):0.6785327173):0.2531822443):0.3398792242,(((t158:3.757784846,t159:3.607273629):1.553290734,t160:5.130385301):1.040975391,(t161:0.8742712082,t162:0.8200430188):4.668166559):1.640406685):0.419075503,(((t163:5.564582233,t164:5.502599802):0.3815930343,(t165:3.93698822,t166:3.905434199):1.943390757):0.9635056199,((t167:5.350479332,t168:5.339694354):1.036644916,(t169:6.287514715,(((t170:1.004727605,t171:0.9665990268):0.01826285943,t172:0.8959176234):2.492212708,((t173:2.923431113,((t174:1.863527122,t175:1.78953272):0.717144991,t176:2.450888482):0.04150417736):0.4262191868,t177:2.870540531):0.02568287108):2.652414023):0.0853571385):0.406255042):0.6120819053):0.1538540322,((t178:5.155128755,t179:5.121934873):0.1726151387,t180:5.267426592):1.4313112):2.139961617,((t181:2.744925358,t182:2.689707595):2.599617207,t183:5.12577516):3.490228342):0.6587741526,((((((t184:4.703054934,t185:4.52707626):0.4455527364,((t186:2.392670059,(t187:1.875592237,t188:1.791259469):0.4327693438):1.859805409,(t189:0.4945534681,t190:0.4696011961):3.580443826):0.4883541103):0.1070868867,(((t191:3.819971473,t192:3.726769067):0.1015445245,(t193:1.534348129,(t194:0.7495974882,t195:0.7078368345):0.7006483408):2.157583041):0.07628838679,(t196:0.8681148229,t197:0.8477334118):2.612104859):0.2340941472):0.546959818,t198:4.233826543):1.0275933,(t200:4.242190243,(((((t201:1.498521661,t203:1.231290617):0.8041958193,t204:1.840124549):1.211617831,(t205:2.024405116,t206:1.93501983):0.8919633955):0.08597716394,t207:2.863823342):0.3911835578,t208:3.181836521):0.1995511791):0.9427261706):1.029960698,(((t209:4.017498162,(t210:0.2822156809,t211:0.2481936091):3.728137553):0.1253317492,(t212:1.241017873,t213:1.225726142):2.642149086):0.403385339,(t214:0.7375385716,(t215:0.4285002907,t216:0.3700257244):0.261989965):3.413429264):0.7606425009):1.306978426):4.389471369):0.109924404,((((((t217:2.228052211,(t218:1.972658844,t219:1.869981328):0.1182435311):0.669219009,t220:2.5829655):0.01397028001,t221:2.547767094):1.088640214,((t222:3.003159647,(t223:2.176025065,t224:2.174189585):0.749645008):0.4775221309,((t225:2.003717211,t226:1.963230286):0.1346501744,t227:2.095383577):1.236122834):0.08265725301):0.03843978993,((((((t228:0.9611176105,t229:0.8594338425):0.5623508301,(t230:0.4882038491,t231:0.244554962):0.7949700544):0.02307015194,t234:0.3936926939):0.05982026833,t235:0.1517768039):1.01077854,(t236:0.458698193,t237:0.2326613487):0.6847529299):0.2793001052,((t238:0.4872647345,t239:0.407673077):0.5472899181,(t240:0.1182238661,t241:0.09426375492):0.7462302754):0.05269864076):0.4347769497):5.790603466,((t242:0.4420996375,t244:0.1995604603):3.086998658,(t245:0.22131103,t246:0.1808996913):2.583840611):3.587853173):0.7206317233):0.9719124357,(((t248:3.34434446,t249:3.219315332):0.5288311815,(t250:1.551230519,t251:1.537683663):2.135623389):2.737323961,((t252:0.3066256834,t253:0.07556542619):0.127054099,t254:0.005193463606):5.624919858):1.061597049):0.3627371192,t255:6.886807472):1.981169516,(t256:8.737715593,(((t257:0.3838189638,t258:0.2133027052):3.937935121,t259:4.005734713):3.022675851,((((t260:0.4091738124,t261:0.3354921655):4.130269062,((t262:0.3702858247,t263:0.3239595143):1.064133013,t264:1.384725099):3.025531321):0.04306282001,t265:4.387283036):1.645799561,t266:5.974536755):0.7585297796):1.356152267):0.1081523465):0.12083902):0.6272926118,(((((t267:0.4317673361,t268:0.4280469502):0.2858222529,t269:0.6949992424):6.823446797,t270:7.517316351):0.74385551,(t271:7.441219283,(t272:0.9349195089,t273:0.6771761554):6.092241161):0.5760820599):0.3006981869,((t274:0.5127518528,t275:0.3332493511):0.08017954077,t276:0.2860964127):7.037050735):0.3473327572):1.235803812):0.2562326669,((((t277:6.65691691,t278:6.579317848):0.1578464131,((t279:5.261992238,t280:5.253906355):1.265684902,(t281:1.176323759,t282:1.135281488):5.310025396):0.2030752174):0.6968997641,t283:7.241790008):1.014326877,(t284:6.196968889,t285:6.178676444):1.927758408):0.5491314237):0.2925219281):1.491436079,(((((t286:5.534783862,t287:5.522614586):0.889288153,(((t288:0.05094093771,t289:0.002559824726):2.069366753,t290:2.034575435):3.85655933,t291:5.861674183):0.3758204194):0.4486357279,(t292:5.456574318,((t293:1.643686567,t294:1.621187873):2.903529593,t295:4.503386586):0.7775413256):1.19596109):1.410564046,(((((t296:3.550061713,t297:3.490292702):0.6248463713,t298:3.848962921):0.7936158939,(t299:2.721382145,t300:2.534217033):1.831107348):0.5596536136,(t301:0.3299550412,t302:0.189371953):4.571027809):1.990932299,(((t303:0.2942396431,t304:0.1913213288):2.734790605,t306:2.602994862):3.143377297,(((t307:4.516412726,(t308:4.393875425,(t309:4.326001184,t310:4.298341879):0.008897961051):0.1078350955):0.1310702302,(t311:0.8634011016,t312:0.6278580694):3.647895713):0.6542219888,t313:4.872632142):0.2742801778):0.5526404433):0.3220183236):0.05200751997,(t314:4.701862706,t315:4.493546359):1.315385861):2.098642279):0.302380841):7.242539003,(t316:4.800042814,((t317:3.512140678,(t318:3.388644515,t319:3.362589117):0.03024806812):0.9784514937,((t320:0.6197268412,t321:0.2942594051):3.308200956,t322:3.526977129):0.4198026148):0.3024165797):10.57091711):0.3967716173,((((((((t323:0.8325802085,t324:0.7723027638):3.320935729,(t325:1.833213917,t326:1.727502749):2.202614122):0.343405653,((t327:0.5915109009,t328:0.5753061894):2.482280075,((t329:0.9753356399,t330:0.94609365):0.1519960641,t331:1.022632603):1.423891162):1.18891085):0.05526652515,(t332:1.145420904,(t333:0.6908477652,t334:0.6826328528):0.3320165241):2.485513797):0.5312634888,t335:4.028852948):0.06509289989,((((t336:1.10184184,t337:1.098695603):1.594974055,t338:2.650289245):0.3633408486,(((t339:1.739674053,t340:1.596531887):0.6938346401,t341:2.272757006):0.1541998793,((t342:0.4209780913,t343:0.2059371384):0.4499482794,t344:0.1695023438):1.531908603):0.3988036233):0.5407702062,((t345:0.6020581166,t346:0.5960622991):1.869994479,(t347:1.783143715,((t348:1.053319025,(t349:0.2731302785,t350:0.2040641992):0.5543898737):0.08238772141,t351:0.7057195007):0.6399826728):0.5899340544):0.1099121528):0.4707319698):3.530729584,(t352:2.763696096,(t353:0.4801518989,((t355:0.2709504566,(t356:0.146332999,t357:0.139787779):0.06909316611):0.1037495658,t358:0.2522297939):0.02874862334):2.259391021):2.786553457):3.131410249,(((t359:0.9495374797,(t360:0.3938418942,t361:0.373339556):0.4293283514):0.6747049744,(((t362:0.1279489348,t363:0.05500235332):0.1799855958,t364:0.1951741759):0.01428243591,t365:0.1129510211):1.010762518):1.366909711,t366:2.18116639):5.414765572):3.258566881):0.3223285721,(((t367:2.86476246,(t368:1.471754254,t369:1.210807987):1.315626327):6.389491342,(t370:6.361939859,t371:6.351340734):2.468634632):0.7879834569,(((t372:0.590279918,t374:0.02637175498):0.3474169918,t376:0.2733614606):0.9427197927,t377:1.139259677):7.596204426):0.9370123127):0.7946157744,t378:10.31249105):0.5214917673):0.252619686):2.649999004):8.798117511,((((t379:9.632235753,(t380:7.266007101,(((t381:0.1120212186,t382:0.0661858153):1.429294557,(t383:1.072189192,t384:1.043611775):0.3040176817):2.495285888,t385:3.773891656):3.228068884):2.324839461):0.8534285015,(((t386:1.001362726,t387:0.7213449563):4.514985538,(t388:1.481477773,t390:0.9524107133):3.529760677):3.17295228,(t391:5.48657707,(t392:3.50718778,t393:3.280003949):1.956774159):1.878055611):1.341305499):1.321626729,((((t394:7.628919506,(((t395:4.869600588,(t396:1.26872508,t397:1.242156272):3.580456807):0.3211193528,t398:5.141297552):1.541328685,t399:6.639043163):0.6827375129):0.763865618,(((t400:0.822481107,t401:0.7462059339):5.332814019,(t402:4.57665012,((t403:0.1400396127,t404:0.1217173475):3.494284487,t405:3.587941944):0.8782681622):1.445371771):1.226155179,(t406:4.288184221,(t407:2.489489156,t408:2.440468244):1.51708743):2.843112504):0.6035766745):0.003202539919,(t409:7.258880763,(((t410:3.743494006,t411:3.520807986):1.8727919,(t412:5.252597304,t413:5.233648388):0.07590381481):1.324361168,((((t414:2.69800228,t415:2.655273034):1.464991743,t416:3.663794763):1.661017942,t417:5.149541267):0.1146298578,(((t418:3.782849538,(t419:3.146765415,((t420:1.696286373,(t421:0.1836803139,t422:0.03948525229):1.504954655):0.09721079123,t423:1.551726252):1.25240649):0.6152477304):1.039654577,t424:4.276743471):0.2360956729,(t425:3.917206175,t426:3.893063106):0.2136339176):0.1743999986):0.6447743106):0.272998523):0.1278942715):0.3353869733,t427:5.588639182):0.9052063128):0.5904384213,(t428:4.70412437,((t429:3.6163536,(t430:0.607247474,t431:0.5994987705):2.942309779):0.3258906126,((t432:1.786189678,t433:1.634998965):1.536429166,(t434:1.099733844,(t435:0.2460496465,t436:0.1643894192):0.6684457902):1.867680299):0.3613217712):0.7296860431):2.191616397):9.863771132):12.2118094,((((t437:1.644094928,t438:1.539628265):1.333459123,t439:2.753822016):0.8390863278,(((t440:1.414841476,t441:1.245163158):0.3168392249,t442:1.547301742):1.084486304,(t443:1.344547327,t444:1.221593315):1.231502912):0.7630405337):2.06699366,(t445:2.190589422,t446:2.187036241):2.813579887):22.16503866):82.96103429);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T93.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
