<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t448:0.09869080538,t449:0.09181044984):1.05081489,(t450:0.5979535783,(t451:0.4234056692,(t452:0.1563069318,t453:0.09341610974):0.2656650045):0.02531531246):0.4840163889):1.334477052,t454:2.171911041):12.86122542,((((((((t455:0.5261264169,t456:0.5239270963):0.06568411065,t457:0.451823836):0.2168088278,t458:0.4681167049):0.03440825947,t459:0.2600034348):0.5218153062,t460:0.5671139433):0.113239468,t461:0.6271400311):2.675311194,t462:3.177139807):4.753864542,(t464:0.4728452205,t465:0.3883776935):7.30622039):6.094246996):0.2825463975,(t467:11.267071,(((t466:0.2498824122,((t463:0.008785340981,(((t444:0.00653182729,((t328:0.1347621845,(t325:0.2133853808,((t320:0.08150626722,((t313:0.09784802694,(((t215:0.2126952851,t216:0.01768144258):0.0651613602,((t205:0.01484865801,(((t109:0.1055914127,(t83:0.04527690524,(((t63:0.07933833455,(t52:0.1654624465,((t18:0.14305643,t1:2.033254108):4.631992665,(t2:1.942948854,t3:1.936753436):4.609692621):0.01939248842):0.7387169827):0.6956547261,((t4:1.578125433,t5:1.170045385):0.1133895741,t6:1.128701342):6.237787227):0.5040737308,(t7:1.417862995,t8:1.082143237):6.069674201):0.1918797602):2.657323445):5.906849445,(((t9:7.744785456,t10:7.73588512):2.00651077,t11:9.737487785):1.305332812,(((((t12:5.646386411,(t13:1.799046055,t14:1.686676733):3.797528016):1.246562177,t15:6.730442241):2.628636163,(((t16:8.837268229,((((t17:1.005196675,t19:0.7783323808):4.682510883,t20:4.978563705):0.3477680213,t21:5.324113669):1.738553166,t22:6.858976985):1.033188704):0.08057550774,(((t23:3.449276208,t24:3.374387488):3.08857775,(t25:0.5436169718,t26:0.3375022825):5.817038958):1.231808619,((t27:2.247534922,t28:2.214688848):4.162676665,(t29:4.319114535,t30:4.242973371):2.02763328):0.939738041):0.09418308265):0.02604404235,(t31:5.316890629,(t32:2.023805954,t33:1.979724714):3.289709572):1.903570944):0.3877585823):0.2701880047,t34:7.81092742):1.007126133,((t35:4.018626094,t36:3.981230539):1.180389871,(t37:0.5599640495,t38:0.1921265692):4.519300841):3.464299284):0.1280434241):4.809094134):1.560282651,((((t39:4.459014301,t40:3.840000772):1.167768881,((t41:4.493086631,t42:4.435758867):0.199580707,(t43:4.410310537,((t44:0.2470032008,t45:0.2328696915):2.731360026,t46:2.717972432):1.252860552):0.1569109055):0.08360805522):0.607048008,((t47:2.845867706,(t48:2.448737913,t49:2.323883392):0.3814420877):1.006506286,t50:3.699012134):0.6091970379):3.170853307,((((t51:1.615340421,t53:1.162356533):1.13656091,t54:2.19329328):1.334018393,((t55:2.435554272,t56:2.389802061):0.1272643117,(t57:2.118608042,(t58:1.576933863,(t59:0.8481315194,t60:0.8197245097):0.70883408):0.5265581557):0.3788775003):0.8816294844):1.618212826,(((t61:3.519441203,t62:3.517646448):0.9480603301,((((t64:2.44039016,(t65:0.7206414232,t66:0.6197891628):1.45127755):0.4710695879,(t67:1.389849929,t68:1.227587118):1.025534868):0.4377833081,((t69:0.8723409664,t70:0.6931502077):1.083686618,(t71:0.8109457507,t72:0.7818153789):0.9406431002):0.7020790903):0.253856758,(t73:2.275920761,((t74:0.6398995334,t75:0.601314008):0.9788295141,t76:1.49583397):0.6125534585):0.4012462364):0.7423645816):0.1951220461,((t77:2.032736499,(t78:1.971435671,(t79:0.9074007206,t80:0.9010442438):1.004551511):0.005067175477):1.037873216,((t81:1.237929272,t82:1.204335911):1.315279197,(t84:1.554368921,t85:1.421368107):0.8099130999):0.3799608563):0.350059849):0.222884287):1.689704861):5.058604674):3.71772029):0.6910877432,(((((t86:3.153304597,((t87:1.595976305,(t88:0.92767001,t89:0.8761620658):0.3080868291):1.477535068,((((t90:1.033880905,t91:0.5177854851):0.001235471785,(((t92:0.1711502515,t93:0.1158501112):0.2077246322,t94:0.2186962839):0.09685657463,t95:0.2272023445):0.009329728367):0.11628277,t96:0.3208372359):0.8190019289,((t97:0.3747980814,t98:0.3511921936):0.03405406669,t99:0.2537459654):0.6604789422):0.6604334347):0.07832733093):2.505570773,((((t100:0.353175195,t101:0.2903765534):0.5378639742,t102:0.7281932815):1.104602379,(((t103:0.1379405084,t104:0.1095419052):0.7546076479,t105:0.786914661):0.118180236,(t106:0.8215848023,(t107:0.2992196438,t108:0.1349013537):0.3321806915):0.05735482871):0.7532707936):1.229411108,(t110:1.818461792,(t111:1.079024633,t112:0.7681294515):0.6182053621):0.4618441001):0.9037499267):3.95697311,t113:6.551081904):1.754156738,(t114:0.6735787216,t115:0.6696766449):7.46097455):2.04906525,(t116:8.118789129,(((t117:1.832245439,t118:1.178912858):5.861101609,t119:6.878469638):0.343703733,t120:7.207493337):0.02624234139):1.881616335):0.9130552296):0.5130488296):7.345623715,(((((((t121:0.09606856653,t122:0.04308884531):8.681714644,(((t123:5.779234072,t124:5.580344743):0.04270550795,t125:5.618191498):2.257109742,t126:7.278889637):0.3840510865):0.4091698637,((t127:2.397958711,t128:2.391193365):3.584937142,((t129:1.368534527,t130:1.274941035):1.428644294,t131:2.682341905):3.014421):1.765387187):0.3321518158,t132:7.76162662):0.4773953378,((t133:3.672968147,(t134:2.944128223,t135:2.942732243):0.2855293695):1.153553751,(t136:3.23910594,t137:3.155200833):1.013899387):3.411538851):0.9180878477,(((t138:6.905722717,t139:6.898952329):0.8489234879,((t140:6.891213639,((t141:4.591196984,t142:4.52022158):0.7256018212,(t143:4.548256882,t144:4.433673681):0.5318389345):1.545686623):0.3697498432,(t145:6.678620417,((((t146:4.955559956,t147:4.944319645):0.08395120434,t148:4.870211294):0.8992386689,(t149:5.203502463,((t150:0.4553993768,t151:0.3648717725):3.650068387,(t152:3.151124585,t153:3.106262075):0.8440104827):0.9740113542):0.4194016521):0.623350939,(((t154:5.254585739,t155:5.201459382):0.2544306829,(t156:4.712382676,(((t157:0.1202073612,t158:0.09486020429):4.021779568,(t159:3.886019109,(t160:1.353184999,t161:1.344998541):2.19310405):0.1965839636):0.2902339812,t162:3.850230021):0.1379196103):0.6941155571):0.05647489145,((t163:3.067531646,t164:2.933711099):1.264363103,((t165:3.998853892,((t166:3.302423568,(t167:0.1550806976,t168:0.1486255104):3.144272309):0.2761452839,t169:3.376306684):0.1712056228):0.08711143704,(t170:3.094329935,t171:3.085971617):0.5106485496):0.1078897536):0.2675291313):0.2092392581):0.08664484315):0.1044615985):0.4306646145):0.7308072914,(t172:5.290505618,(t173:0.7756814187,t174:0.7560930544):4.408638499):0.1675794262):0.01027661143):6.16741347,((t175:3.30845236,(((t176:2.107362907,t177:1.874608859):0.02910204776,t178:1.499199139):0.4033370928,(t179:0.7145457802,t180:0.3155904313):1.135090807):0.7205797233):0.6675244347,(t181:1.801682386,t182:1.74722413):0.9432286989):7.489921741):0.8016291661):3.238273013):0.1107432934,(((t183:3.830646694,(t184:1.469880863,t185:1.436200476):2.313632156):0.5002339472,((((t186:0.1856577698,t187:0.1816683825):0.8297738067,t188:0.8173021824):0.7640957973,(t189:1.249507413,(t190:1.234219437,((t191:0.4092779502,t192:0.2717407288):0.6612885805,t193:0.6183271314):0.1511824797):0.01316033637):0.3169001621):0.4935534825,t194:1.592507915):1.950244506):0.6961214091,(((((t195:0.8618434182,t196:0.5637592235):0.9993730058,(t197:0.9595946752,t198:0.6714439032):0.319142027):0.1615692931,t199:1.063080189):1.147794862,(t200:0.7430772491,t201:0.5611187991):1.436072302):0.5993806705,((t202:0.3122779476,(t203:0.2839782644,t204:0.04932935922):0.01647420361):0.7815919504,(t206:0.3157266758,t207:0.1656023313):0.5001088546):1.460427548):0.3348878349):9.285801202):0.5513295632):0.2370372319,(t208:0.3174598663,t209:0.2674459217):12.1820034):0.5720297436):0.4708701007):0.1202783015,(((t210:0.356314637,(t211:0.2722717144,t212:0.1365456965):0.04832142924):1.887284335,t213:2.043922182):10.27833553,(((t214:0.54873601,t217:0.08121678535):2.229023175,(t218:0.2640221327,t219:0.2550347571):2.044593805):8.378487063,((((((t220:0.4008020972,t221:0.1783191621):0.3395502893,t222:0.3987195747):1.530140184,(t223:1.482136696,((t224:0.1043768605,t225:0.101598375):1.36902565,t226:1.427592848):0.004860614156):0.3302788993):1.694261378,(t227:1.603900545,(t228:0.3789243948,t229:0.1327575839):1.207984314):1.844556193):4.128714568,(t230:0.6495601139,t231:0.0643677805):6.600527254):2.195239964,t232:8.762467671):0.3372450617):0.871779201):1.034555485):9.310747423):1.155371084,((((((((((((t233:7.760347069,t234:7.738231518):0.09890635153,t235:7.790047832):1.081013081,((((t236:4.100814623,t237:4.098962937):2.631068116,t238:6.131377474):0.7266026345,((t239:2.672090736,(t240:1.502935419,t241:1.344857817):1.034151867):0.6468917561,t242:2.998629358):3.170339006):1.253428886,(((t243:3.725002003,t244:3.681349844):0.7999119309,t245:4.437640542):1.470934828,(t246:5.614521004,t247:5.600909026):0.1325726301):1.407019159):0.05815612651):0.3089945125,(t248:5.885612851,((t249:0.9488763261,t250:0.9246716188):3.065950933,t251:3.966589903):1.852854224):1.572961202):0.6099222534,((((t252:5.326224206,t253:5.291766886):1.030691921,t254:6.262113561):0.9170258029,t255:7.173761444):0.5672038095,((((((t256:1.842580774,t257:1.835051543):3.0554193,t258:4.697290373):0.4638281266,t259:4.992954218):0.6731696542,(t260:5.064172576,t261:4.487652886):0.5355131901):0.2278029527,(t262:3.349041021,t263:3.177451947):1.776045234):0.1541019727,((t264:3.77565636,(t265:2.613715486,(t266:1.687081872,t267:1.640246052):0.7248089648):1.133842347):1.122698238,(t268:3.982769197,t269:3.826914055):0.6168326143):0.165922507):1.298053325):0.1176307801):0.0829295841,(((t270:2.278878442,t271:1.941665708):0.1410212891,t272:2.06165328):0.1467611463,t273:1.968529845):3.484405957):0.4315301372,((t274:4.445514135,((t275:0.7181829902,t276:0.6980769442):0.7115147073,t277:1.293749384):2.587294891):0.03636373214,((t278:3.299279107,t279:3.279938123):0.2775441207,((t280:2.276614591,((t281:1.584024999,t282:1.508030527):0.1276959598,t283:1.519187285):0.3842734082):0.634136441,t284:2.44912347):0.6377928179):0.317478526):1.320856614):0.7760055084,t285:5.488935547):0.5336122067,((((t286:0.9371303876,t287:0.8803932552):1.658298253,(t288:2.118846769,t289:2.109334108):0.4102381731):0.7685106157,((t290:1.493084131,t291:1.452749387):0.1680444053,t292:1.542190898):1.42946177):0.3616540471,t293:3.308223865):2.035004383):8.220481921,(((((t294:1.144683626,(t295:0.9458081402,(t296:0.8294913195,t297:0.8113523944):0.1147119177):0.07107854681):0.4885625848,t298:1.469517107):2.422959135,((t299:0.5230937836,t300:0.3826204275):2.062691297,(t301:2.308665541,t302:2.104013139):0.1120701213):1.200752377):1.214823138,((((t303:0.4626322102,t304:0.4310369703):1.615968376,t305:1.79124263):0.5156941522,((t306:0.4346731866,t307:0.4047053659):0.790556257,t308:1.022489874):0.974289163):1.396852587,((((t309:0.4885514733,t310:0.3351241481):0.4199228149,t311:0.6936402044):0.02286103475,t312:0.5487392004):2.378477047,((t314:0.3528122142,t315:0.1795319961):0.7425751925,t316:0.8864971167):1.501591756):0.04352884267):0.3565160483):2.036680124,((((((t317:0.1543698427,t318:0.06255081993):0.2703115706,t319:0.255878379):0.4144179086,(t321:0.1909908892,t322:0.1053967506):0.2001705596):1.490475768,t323:1.505707143):0.005675710235,(t324:1.099543616,t326:0.6791860068):0.3741879329):0.8442660936,(t327:0.3124345221,t329:0.02185630722):1.499618465):1.62094931):6.084672859):0.2833676609,((t330:7.839728074,((t331:4.202916964,((t332:2.980219451,(t333:2.443545161,t334:2.343732761):0.5230167829):0.9515453359,t335:3.771409018):0.2528787314):2.287680037,(t336:1.057800588,t337:0.9030104381):5.228399539):1.18788736):0.885244412,((t338:5.726472899,(((t339:0.4663606897,t340:0.4070468788):3.285419256,t341:3.657952522):0.50482647,t342:4.00805279):1.347392494):1.024238061,(t343:1.16844652,t344:1.167791142):4.986242612):1.427313636):0.7166946362):0.5317922251,((((t345:0.7610208155,t346:0.7487329007):1.968209862,t347:2.698056511):3.178454676,(((t348:0.063792338,t349:0.04657886211):0.02013587648,t350:0.009015677594):0.1065822363,t351:0.05080390388):5.643835755):1.656266005,t352:7.329732056):1.199587391):0.5211873862):0.1379412131,(((((t353:6.909165887,(t354:0.7214195536,t355:0.6139140873):6.099195964):0.5183990192,((t356:6.512545095,(t357:0.653320484,t358:0.5589285587):5.337602532):0.2513674084,t359:6.121065393):0.01506947667):0.7262475255,(((t360:3.680640018,(t361:1.343216571,t362:1.254277483):2.337287641):0.8171758309,(((t363:1.33651601,t364:1.334696277):1.838445834,(t365:1.382522201,(t366:0.2307939653,t367:0.2119503639):1.131510155):1.752996498):0.8404170204,(t368:0.3457195039,t369:0.2755819216):3.542411014):0.383427612):2.212219795,(((t370:1.23291149,t371:1.213302202):0.9181807212,(t372:1.603288824,t373:1.55492225):0.4833232291):4.118948627,((t374:3.229509465,t375:3.208809871):1.326316801,t376:4.530150742):1.522258966):0.08283403722):0.1189297):0.1526113579,((t377:2.170387098,t378:2.151815043):3.927533565,(t379:4.56929808,t380:3.886213154):1.438131983):0.2555363635):0.2506050578,(t381:5.581499647,((t382:1.163921074,t383:1.029130186):3.167735222,t384:4.192314143):1.178194147):0.2280643297):0.6178241036):0.3274280373):0.3654076092,t385:6.840330934):0.05467801517):0.8561119736,(((((t386:4.183157063,(t387:1.056218165,t388:1.018405944):3.08034818):1.129881761,((t389:2.354776617,t390:2.336198553):1.871195251,t391:4.192767823):0.9329835623):0.3551808463,((t392:4.953224569,(t393:0.910599557,t394:0.8290883091):3.994075102):0.3235164599,t395:5.096246824):0.1765397633):0.1213299726,t396:5.385562852):0.5138792258,(t397:4.584402326,(t398:1.889818963,t399:1.702001075):2.689405774):1.27104302):1.330648941):9.866080361,((t400:3.905344186,t401:3.764014351):2.31620749,(((t402:3.170518562,t403:3.152133571):0.203606616,t404:3.253578981):2.505953396,((t405:3.650126582,t406:3.62296449):1.470136903,((t407:3.392737568,t408:3.111551587):0.8510880186,t409:3.620520091):0.7584051451):0.4985928463):0.1873565384):10.633217):0.6173018416):2.420879529):34.85864695,(((((t410:2.25327461,t411:1.919098687):1.116225663,(((t412:0.9805378815,t413:0.9742670435):1.301374411,t414:2.193909744):0.2869955175,((t415:1.942740874,(t416:1.704896084,t417:1.588722021):0.1813685781):0.5283073926,(t418:1.346035599,(t419:0.9227868836,(t420:0.1662060207,t421:0.1141682731):0.6953756793):0.3933808597):0.7782796907):0.006373050193):0.3924518262):0.3585968979,(t422:2.14807525,t423:2.088787505):0.5481462053):9.211182093,((t424:1.939436203,(t425:0.9574678533,t426:0.9149190492):0.9726893809):1.511749004,(((t427:0.8046412787,t428:0.7156854745):1.760973479,(t429:1.915111727,(t430:1.820982706,t431:1.807823172):0.05789987628):0.4919050578):0.1901825879,((t432:2.079750816,((t433:1.329546734,(t434:0.2257815339,t435:0.1087137559):0.9884680297):0.2211135633,((t436:0.9745302518,t437:0.9700857691):0.1266711776,((t438:0.5813839845,t439:0.4295120956):0.1829170654,t440:0.5843699746):0.1786185014):0.1933616046):0.5230095856):0.108961868,(t441:0.08576928845,t442:0.05842336567):1.50074091):0.3324575538):0.5476860186):8.37462111):4.998335573,(t443:1.79097298,(t445:0.561630064,(t446:0.4686072979,t447:0.4659459281):0.05876136905):0.699686533):13.94511004):35.3231848);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T47.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
