<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t473:0.2803851196,t474:0.2280055208):0.5652390367,t477:0.2950836798):1.174628425,t478:1.417180821):25.10249296,(((t479:0.6024435542,t480:0.4679313565):0.3317602492,((t475:0.2071125808,(t476:0.1550791482,((((t435:0.1214052743,(((((t360:0.01663869203,t361:0.0007460559954):0.01454165123,(((t244:0.1368791867,((((t230:0.2784768696,t231:0.2125165056):0.1347346998,((t232:0.2194311205,((t223:0.04091243818,((t132:0.4900317425,(t133:0.07224952005,((t111:0.3389100904,((t71:0.3395451889,(t48:0.03116629224,t1:3.900450175):2.494877561):0.915796209,((((t2:0.9948312769,t3:0.97169705):0.5186888551,(t4:0.9891343278,t5:0.9402105527):0.4243168923):3.899323363,((t6:0.1472018999,t7:0.1075632228):3.668406118,t8:3.721400473):1.433827942):1.810401098,t9:6.537727439):0.05611147468):1.884297594):1.796322372,t10:10.24267031):0.9614961949):0.1984186937):0.9201147548,(((((t11:8.826975075,((t12:3.838304768,t13:3.681408036):4.749452685,(t14:0.03445287577,t15:0.003938166584):8.354534827):0.1587215219):0.1719019806,((t16:8.556879112,(t17:3.472341195,(t18:0.3196705387,t19:0.2805505198):3.095637188):5.0099842):0.1026477668,(t20:8.074840348,((t21:7.569651725,(t22:0.3605029675,t23:0.3560151499):7.20271506):0.1624822313,((t24:2.660339538,t25:2.615510367):1.964623569,(t26:4.18413244,t27:4.158374272):0.3577797471):3.095822906):0.1834424187):0.2442852872):0.02179176743):0.1519697541,(t28:4.714695609,((t29:1.01802801,t30:0.6784850631):3.662721706,t31:4.129197582):0.02842301944):3.496330482):0.2441182046,(t32:7.205669966,t33:7.089877875):0.6816289778):2.61478218,t34:10.23602838):0.2995220639):7.799138249):0.6837831642,((((((t35:8.643110776,(t36:8.379679607,(((t37:4.089208932,t38:4.017587787):2.997307336,(t39:6.462256708,(t40:1.261556372,(t41:1.099540505,t42:1.089216967):0.1029777047):4.712497275):0.4903246344):0.6015436299,((t43:5.796991227,t44:5.645448223):1.154885562,(((t45:1.233251628,t46:1.155490527):2.118165383,t47:3.270693505):1.824454448,(t49:1.026337852,t50:0.9448748638):3.843289074):1.619467568):0.02432979013):0.6841292362):0.0458126283):1.30431258,((((t51:3.487015573,t52:3.462728508):0.3199931281,(t53:2.405075019,(t54:0.8990388836,t55:0.7971217881):1.504574699):1.235467959):1.299330874,t56:4.719161658):0.6054144938,(t57:4.987144262,((t58:3.886454955,t59:3.849385789):0.4429954668,(t60:3.650992533,t61:3.644061062):0.5979679832):0.6420832514):0.209408106):2.620328284):4.488836218,(t62:6.294688505,((((t63:2.829100326,t64:2.749761418):1.645656915,(t65:3.78985016,t66:3.668911866):0.5008395357):0.4197084137,((t67:1.294409998,t68:1.277086175):0.4701749581,(t69:1.149054408,t70:1.138935426):0.1866318208):2.752319782):0.2219233853,((t72:0.5313656538,t73:0.455458286):2.186028704,t74:2.429720687):1.15720496):1.077768443):5.767606466):0.8991224122,(t75:6.579244751,((((t76:2.74991687,t77:2.745271864):1.236455283,(((((t78:1.968128117,t79:1.599675768):1.469598058,t80:3.015929917):0.01294948424,(t81:0.3613944945,t82:0.3139589534):2.555772165):0.3028391193,(t83:2.723257372,t84:2.654709463):0.4239293757):0.176744024,(((t85:1.576575386,t86:1.55616565):1.12366559,((t87:1.344175953,t88:1.284545434):0.4791737678,(t89:0.1259399093,t90:0.07188605883):1.567999478):0.8353071307):0.2558084873,((t91:1.198270099,t92:1.137890973):0.849768881,t93:1.978492716):0.6239467306):0.2793250941):0.0119690759):0.262047471,(t94:0.560173635,t95:0.5412150087):2.441679151):0.4564470728,((((t96:2.054373747,t97:2.025739867):0.06022426503,(t98:1.893822837,t99:1.825742918):0.1919169688):0.9803769895,t100:2.990549752):0.07835357646,((((t101:1.597754379,t102:1.560887288):0.3413776743,(t103:1.45737387,t104:1.35302397):0.442001542):0.4657039192,((t105:0.5859260024,t106:0.5489171297):0.3859676803,t107:0.8097213783):1.281621807):0.5333071203,(((t108:1.588876455,t109:1.559731685):0.4501746084,((((t110:0.9204131559,t112:0.4317679231):0.5947822848,t113:0.933347916):0.004269567365,t114:0.7683102999):0.1461136897,t115:0.8732053912):0.2903224482):0.3654563286,((t116:0.21303986,t117:0.1287747611):0.3422834697,t118:0.1039494676):0.8804581063):0.03760462586):0.1250993343):0.2245418312):1.866178032):4.728920883):1.418013877,(t119:2.416274425,((t120:1.932878157,(t121:0.9794866253,t122:0.9709745968):0.8249980429):0.1348732991,t123:1.834491219):0.1717812254):6.819185647):1.826302132,t124:10.39854828):0.2919101444):0.6061052938):0.03412372021,((((t125:0.3056049719,t126:0.2168508065):1.155138871,t127:1.352669029):1.07418039,((((t128:0.3843714125,t129:0.3812794081):0.4177156559,t130:0.6963543281):0.2501181186,t131:0.5022864456):0.1323574807,t134:0.08009967676):1.124991535):6.549789567,(((t135:1.882313959,(t136:0.2346291715,t137:0.120242571):1.50153542):1.898814293,t138:3.275542453):2.561584741,t139:5.703870019):1.363001982):2.228213466):0.02488622207):0.5660588637,(t140:8.028203223,(((t141:0.7734548802,t142:0.6692261346):0.1982398915,t143:0.8615964097):1.775226078,t144:2.177918154):5.25044671):1.802750414):0.1816059529,t145:9.283671743):1.1961022):4.752933598,(((t146:5.950593474,t147:5.88508778):2.323668918,(t148:1.493300873,t149:1.112706847):6.635032065):6.642965869,((((t150:8.23669562,((t151:1.823834366,t152:1.766378702):6.117004315,((t153:6.307187165,t154:6.248773565):0.9072705602,t155:7.122150479):0.6571908047):0.2123362164):0.1177470886,t156:8.05686728):0.08279773822,(((t157:2.505296051,t158:2.402499428):4.517478868,t159:6.855966642):0.715053213,((t160:0.9930964075,t161:0.9409566028):5.911458944,(t162:4.821194814,t163:4.800699995):1.914586075):0.510752294):0.3041913418):0.08636690435,((t164:3.976917994,t165:3.889527817):3.149256979,((t166:6.448121566,t167:6.405251361):0.1406313923,((t168:4.397257698,t169:4.388472152):1.769723872,t170:6.15292805):0.352422327):0.3399793387):0.3938320443):5.851245905):0.3025207311):4.418754863,(((t171:4.045911114,((t172:2.523272041,t173:2.510146621):0.7008224145,t174:3.194678724):0.6947520006):3.90053439,(t175:5.099335419,(t176:1.063254808,t177:0.9974426488):3.886788395):2.608759295):2.379457488,((t178:5.733108471,t179:5.393614052):2.474549803,(((((t180:1.660508108,((t181:0.5331152141,t182:0.4948633038):0.8751256632,t183:1.219648738):0.110810295):3.672052072,(t184:4.280543802,t185:4.22372998):0.5419578335):0.7772943188,(t186:3.722702617,t187:3.718958996):1.629234284):1.385123291,((((t188:3.085920346,t189:2.944881626):0.9536748979,t190:3.850696119):0.9774658866,(t191:2.506052455,(t192:1.476478084,t193:1.410846957):0.9047798985):2.266232251):0.6312081489,t194:5.103050579):1.002593878):0.03582456317,(((((t195:1.471073407,t196:1.395769098):2.158692069,((t197:2.427295567,t198:2.371756808):0.8816210685,((t199:2.587749647,(t200:1.122122331,t201:1.064090046):1.390196131):0.4030841267,(t202:2.643532551,t203:2.511017694):0.1262316903):0.164483692):0.2049139329):0.6439462769,(((t204:0.4837879308,t205:0.4166674169):0.9069643202,t206:1.079626818):0.274695117,t207:1.284476746):1.674574969):0.4557503264,(t208:1.185633164,t209:1.17278081):1.945926032):0.2835872308,((t210:1.023468022,t211:0.8898812018):1.81803756,((t212:0.2667099494,t213:0.1852324279):1.503986748,t214:1.674059364):0.8517479119):0.5585701096):1.095109192):0.2838075157):1.224656521):7.427601028):1.422816576):1.587951035,((((t215:3.868764445,(((t216:1.361570051,t217:1.287438458):2.025001178,t218:3.280769487):0.302933791,((((t219:1.090093558,t220:0.9843108898):0.4575653017,((t221:0.959864794,t222:0.8431233319):0.04947715437,t224:0.7562703222):0.4158762648):0.1872982756,(t225:0.6084218752,t226:0.4839636251):0.7243126113):0.1874773397,(t227:0.7301801419,(t228:0.6321788656,t229:0.4457697447):0.03866580609):0.1751457036):1.595280473):0.08492708083):1.081634246,((t233:1.823368789,t234:1.68421147):0.0251447733,t235:1.53774031):0.8886179257):10.41397636,((((((((t236:0.5559951001,t237:0.4224059167):8.878235546,(t238:5.549280681,((t239:0.6222029309,t240:0.5557648455):1.79951548,(t241:1.818340813,t242:1.767349355):0.4566662018):2.960595548):3.533928564):0.9027160008,((t243:3.022565586,t245:2.527976072):4.834184039,((t246:0.4299098313,t247:0.2675482239):0.5242188316,t248:0.7564923213):6.059692277):1.729016902):0.02049763672,t249:8.495951727):0.5989956866,((t250:8.17922272,(t251:7.784919965,(((t252:0.3065277516,t253:0.2914003862):2.642428146,t254:2.855569281):1.563362082,t255:4.30680293):3.098365974):0.3652301498):0.2759823062,(((t256:7.38003547,t257:7.355932332):0.291943777,(((t258:4.148005413,(t259:1.560008651,(t260:1.51979902,(t261:0.5133837441,t262:0.1134932975):0.7685433729):0.01581695751):2.534211087):1.384225405,t263:4.77839236):2.072863634,(t264:4.36388119,t265:4.349548969):2.161766682):0.02727168673):0.2101714484,t266:6.713938459):0.09680704147):0.479982223):0.3941954026,t267:7.494991104):0.087583036,((((t268:2.472055366,t269:2.395599804):1.42628852,((t270:1.54149423,(t271:0.7057511814,t272:0.6683760577):0.7828524968):0.9747471185,t273:2.349203478):1.225265675):3.0416933,((t274:5.110723213,t275:5.018607626):1.205803139,(t276:1.535826789,t277:1.52640601):4.662721149):0.09453514867):0.006222359628,(t278:5.646442977,t279:5.587870204):0.5901447137):0.6338855397):0.6724646977,((t280:3.794993037,t281:3.789115536):1.511231283,((((t282:0.9277843574,t283:0.8217747125):0.1306607818,t284:0.8258564294):0.1280829193,(t285:0.09207761215,t286:0.04801845664):0.8460595981):3.160320332,((t287:1.793384367,t288:1.698928372):0.6930070914,(t289:1.748867616,t290:1.732234504):0.5652002024):1.46879276):0.7502754219):1.829688504):0.3529362721):0.6804126465,((t291:6.783145067,(((t292:4.911516986,t293:4.626168295):0.02685733072,t294:4.611091384):0.1753660207,(t295:4.247915065,(t296:0.476582517,t297:0.4663151443):3.754221312):0.3443946392):1.550414781):0.1225568966,(((((t298:1.256337891,t299:1.102292745):3.26609365,t300:4.311522216):0.5559770554,(t301:4.150983455,t302:4.035176376):0.7087663399):0.5646227587,((t303:0.2972404642,t304:0.03792615956):0.05941290525,t305:0.05316390843):4.900854511):0.2493811887,((((((t306:2.589227274,t307:2.567873604):0.206970745,t308:2.716114577):0.5502081436,t309:2.996601907):0.159524803,(((t310:1.464497713,t311:1.302488741):1.073981671,t312:2.373074133):0.4025549681,t313:2.766741925):0.02649301808):0.3157092606,((t314:1.912927765,t315:1.88664712):1.0897181,(t316:2.544063786,t317:2.45543359):0.377791307):0.1010484487):0.07784146838,((t318:0.3175409334,t319:0.2581464466):1.830980604,((t320:0.1849557115,t321:0.1754781231):0.5758803866,t322:0.3667907396):1.256939682):0.8432858842):1.178468995):0.3449712014):0.4034712023):0.04359848851):0.001288262112,((t323:1.19369016,t324:1.184009511):2.767284292,(((t325:1.79703202,(t326:1.118621709,t327:1.0332823):0.6726557791):0.4174291856,(t328:1.795088306,t329:1.697091218):0.3035138813):0.2398247881,((t330:1.297745288,t331:1.210986479):0.08503009424,t332:1.144190223):0.8466441376):1.48779757):0.2898211368):1.741307677,(((t333:0.8874977545,t334:0.7646126386):2.365015732,(t335:2.476458299,(t336:2.327673146,(t337:2.11602267,t338:2.007488332):0.0102993698):0.1249725362):0.5739232386):0.1011108892,((t339:0.6930318105,t340:0.4353894757):0.8222911793,(t341:0.7326884849,(t342:0.4517430911,t343:0.2960607206):0.2797492445):0.2284814948):1.173611069):2.138874126):4.898701451):1.110621391,(((t344:0.9264004654,(t345:0.3946603643,(t346:0.05990500979,t347:0.0167876817):0.2728768311):0.5153882313):1.883687628,(t348:0.2463528077,t349:0.1516796328):2.428236118):6.678902292,((t350:1.217810604,t351:1.156485128):0.1540081775,t352:1.308067033):7.8725689):0.636515501):1.002770285,(t353:1.008760646,(t354:0.6059313888,t355:0.5724067568):0.3817368445):9.760414428):1.050134973,(((((((t356:0.9557337578,t357:0.8625276111):1.025723054,((((t358:0.3271214833,(t359:0.1145469054,t362:0.04265941507):0.1350203785):0.3873100189,t363:0.5152895495):0.1324233705,t364:0.4497856639):0.9233476328,((t365:0.9214436483,t366:0.7709696606):0.1935090223,((t367:0.6576253541,t368:0.2191394746):0.1002786514,t369:0.2904610678):0.06905593807):0.2503981631):0.1066742824):0.1084554043,t370:0.7609252476):1.309007654,t371:2.045186399):0.2208764803,t372:2.214475599):7.34279766,(t373:4.709063136,((((t374:1.207994632,t375:1.056661363):0.02580833708,t376:0.6520289622):0.1808921631,(t377:0.1378062729,t378:0.02449522155):0.5280758794):0.7065936102,(t379:0.9146767601,t380:0.9060285019):0.2962122218):2.460424164):4.743459159):0.5012418092,((((t381:3.141114183,t382:3.057737895):3.521199191,(t383:0.243624974,t384:0.1761443075):6.330480492):1.469103152,((t385:0.637014654,t386:0.6355313188):2.879862032,t387:3.496655014):4.442820727):0.2325694863,(t388:6.754361972,t389:5.951725187):1.168053218):0.3013037918):0.1706709939):0.4834260247):0.04631953529):1.110824364,((t390:8.474681206,(((t391:7.512955562,t392:7.464356029):0.1755955933,t393:7.498985169):0.06937553327,t394:7.542319341):0.7163617636):0.1909689803,(t395:8.23501268,(t396:7.407881383,t397:7.273114737):0.8000562571):0.1341742162):0.5652468833):0.2661821006):9.842545667,(((((t398:6.881644932,((t399:4.453232347,(t400:1.702307629,t401:1.700738046):2.743214931):2.217095845,(t402:4.154516621,(t403:1.993140179,t404:1.965647492):2.075794584):2.429017567):0.143398003):0.2240702196,(t405:3.296313995,(t406:1.34259063,t407:1.293414141):1.906506524):3.319908031):0.3248687944,((t408:1.409110601,t409:1.384989649):5.210653522,t410:6.542166409):0.18747964):0.3910037904,(((t411:3.304449383,t412:3.185621963):2.789823238,t413:5.505860561):0.1585161905,(t414:0.4137466355,t415:0.351632618):5.114656089):0.707879205):1.444290932,(((t416:5.471414654,(((t417:4.513581222,t418:4.249097341):0.1344451062,t419:4.177192014):0.5308986695,((t420:2.699517061,t421:2.602083649):0.7078595576,(t422:3.035596505,t423:2.856056382):0.2548272358):1.147283687):0.2600909807):0.04012104555,(((t424:0.3155595654,t425:0.1920688025):2.410414322,t426:2.583156013):1.684014983,t427:4.122668255):0.01240551986):0.3562976059,t428:4.490121736):1.731617702):9.395635742):15.59193362):9.496289718,(((((t429:1.073316278,t430:1.037409745):0.3561064215,t431:1.146149357):0.6904794569,t432:1.792523867):1.706243103,((t433:2.782689978,(t434:2.306954319,t436:2.156563466):0.3936643302):0.1009719327,(t437:1.635388969,t438:1.34260801):0.9288046209):0.4501052552):0.9127143573,(t439:2.444236936,(t440:2.311939339,t441:2.287981153):0.04956912915):1.073688208):35.95814189):18.78964306,(((((((t442:1.476296482,t443:1.413897786):0.6354095955,t444:1.920410882):0.09948075274,t445:1.983765455):1.059109859,(t446:2.900485276,(t447:2.661122757,((t448:0.8966860539,(t449:0.06294690228,t450:0.05897442453):0.8283940665):1.701083525,((((t451:1.65539739,(t452:0.4926161719,t453:0.39184053):1.154198587):0.2077405693,t454:1.714531454):0.06531023386,t455:1.669406644):0.04971828085,(t456:1.243009643,t457:1.106963854):0.4690239277):0.5722840587):0.04262483436):0.2078365309):0.09919759132):0.3794711132,((t458:1.181195595,(t459:0.5394396108,t460:0.4638904488):0.2613201507):0.6699747572,((t461:0.6947094592,t462:0.5720912091):0.01292057094,t463:0.4936534523):0.63130486):0.9359720192):11.65278629,((((t464:0.7717122688,t465:0.7555118261):0.3360549502,(t466:0.2947133249,t467:0.2847295083):0.7843272657):0.3190032793,t468:1.367995888):2.187750037,(t469:2.089619446,t470:2.084640216):1.435943341):9.681849725):11.16480887,(t471:0.2178823347,t472:0.161885879):24.02444844):31.4326331);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T75.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
