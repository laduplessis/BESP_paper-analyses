<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t471:0.08587249647,((t453:0.03329279401,((t424:0.08017094017,(((t355:0.05823461014,((t347:0.1244253727,t348:0.0463884293):0.1519492079,(((t336:0.2260062399,(t337:0.1581969767,(t338:0.0539971393,(t331:0.03823972357,(((((((((t133:0.0262390724,(t121:0.08542375654,(t116:0.3131821782,((t110:0.1503390218,(((t32:0.002756761684,t1:2.917561848):5.723951133,t2:8.628933403):1.065759419,(((t3:0.367560917,t4:0.3532286976):7.993875403,(t5:5.368639916,(t6:0.7086756416,t7:0.5026603099):4.657515077):2.901447865):0.5139976696,t8:8.502714427):0.780007589):0.721950524):0.5723501978,(t9:8.876135502,(t10:8.1891569,t11:8.140222236):0.5796770918):1.664187271):0.2682754294):0.4053879119):1.715635009):5.281967822,((((((t12:4.317556444,(t13:3.753158571,t14:3.645147146):0.5394092578):4.975491383,(((t15:7.445364205,(t16:2.691254232,t17:2.638280652):4.59297101):1.113377993,(t18:1.14864274,t19:1.063082216):6.914367286):0.3298455414,(t20:6.944553164,(t21:2.959623881,t22:2.85991271):3.922324725):1.340737245):0.1994227401):0.5369307845,(t23:3.891487134,(t24:2.147058659,t25:2.088021534):1.676940218):4.907261364):0.01776675472,(((t26:6.944280618,(t27:5.598530304,(t28:1.282450714,t29:1.279422798):4.298114178):0.8302872913):0.2805479977,t30:6.530023748):0.4942569769,t31:6.980399637):0.7420804379):0.3078185576,((t33:1.155528989,t34:1.066461006):4.392871434,t35:5.403081265):2.403064697):0.08876416322,(t36:7.341300368,t37:7.302506333):0.5514519521):7.677641052):0.1893592601,(((((t38:6.911526689,((t39:0.1455343868,t40:0.1228393903):5.022879747,t41:5.130041198):1.590066302):0.1493985923,t42:6.753444245):0.7765121431,((t43:6.620880535,(t44:0.7405573597,t45:0.7309505331):5.873313944):0.8325670265,((t46:4.413747881,t47:4.384065117):1.509800534,t48:5.735159186):1.469968856):0.07253087866):0.2316305242,(((t49:4.894386204,t50:4.855836012):1.891966947,((t51:1.381122696,t52:1.348410421):4.158587976,(t53:4.609101071,t54:4.476611444):0.8409204795):1.165181094):0.1220274841,(t55:6.144362771,((t56:4.529880326,(t57:3.519994829,t58:2.823291137):0.6487485761):1.206620491,t59:4.444251512):0.3259286379):0.3880395295):0.5823583119):1.052362903,(((t60:4.487832127,(t61:4.332042125,(((t62:0.6043128878,t63:0.5138299027):2.254113615,(((t64:0.9116453504,t65:0.6578966732):0.9892997348,t66:1.55913575):0.6645281015,t67:2.218161449):0.1346778527):1.231098032,(t68:2.032832162,t69:1.879572017):1.43291528):0.1555152231):0.09144231645):1.318375392,(t70:3.654913989,((((t71:2.142916601,t72:1.917968196):0.1457427257,t73:2.025542839):0.005067137763,t74:1.901545488):0.2252167764,t75:2.125109016):1.117520847):0.8727690547):0.4915049288,t76:4.580135903):0.4889873207):6.422032594):4.478804605,((((((((t77:2.61272585,t78:2.480633805):1.168172968,((((t79:1.753112019,t80:1.640769062):0.3737316345,t81:1.897427769):0.7817389773,((t82:2.30708262,((t83:0.6495683171,t84:0.4729521466):0.7814984378,t85:1.25237693):0.8751484492):0.1005233944,(t86:2.207465326,((t87:0.3336152599,t88:0.2439530838):1.383053345,t89:1.616658674):0.4311265528):0.006217843841):0.269811977):0.3586194021,(t90:2.049891646,((t91:1.455612433,t92:1.420822627):0.4979924384,(((t93:0.5821497409,t94:0.5227786937):0.2704269766,t95:0.73427047):0.8653412326,t96:1.430136812):0.1892117959):0.09156057169):0.5508076389):0.284262538):2.057257572,(((t97:1.190980092,t98:1.08727334):0.9478667873,t99:2.026104047):1.30446666,((t100:0.786183638,t101:0.7768599251):1.206104498,((t102:0.5344030518,t103:0.4479159062):1.072134915,(t104:0.07538666331,t105:0.03835069003):1.293833276):0.3581467452):1.244665885):1.107965207):0.3109566648,(t106:1.189692629,t107:1.072328307):2.454056311):0.3451134362,(t108:2.310628205,(t109:2.18591279,(t111:1.185418195,(t112:0.9635591084,t113:0.7188597574):0.1214611861):0.6780843615):0.08654918065):1.485111057):0.3892098091,(t114:2.65448492,(t115:1.129120307,(t117:0.5266610457,t118:0.4991616424):0.2550381799):1.479803438):0.719939476):1.14402307,(((t119:0.9943675861,t120:0.9021363911):0.3131545478,(t122:0.9132190434,t123:0.4902540011):0.1130969893):2.147696126,t124:2.726877857):0.5014307205):1.651877115,((t125:0.6414793613,t126:0.6075849374):0.4366270894,(t127:0.4602213018,(t128:0.1357277364,t129:0.1047888801):0.1928399702):0.5632562366):3.66844871):6.276701246):0.1698225935,(((((t130:1.159008053,(t131:0.7763814781,t132:0.7528391243):0.3459479667):8.083773698,(t134:0.3739878638,t135:0.3678562217):8.314776419):0.5866397954,(t136:3.534027383,(t137:1.578796763,t138:1.567083222):1.944748896):5.616690165):0.2794599666,((t139:4.866866568,t140:4.838364569):4.280925391,(t141:8.205582864,t142:7.972226552):0.6707405615):0.1300319371):0.2112135601,t143:8.717637748):0.2446087027):0.02253993856,((t144:2.863139094,t145:2.641750516):4.469507901,(((t146:5.712373898,t147:5.711725079):0.8613188461,((t148:4.652946686,t149:4.624802026):1.524475283,(t150:2.347545558,(t151:1.312585917,t152:1.241007428):0.7150877919):3.792254237):0.3924280373):0.4504444838,(((t153:1.125218552,t154:1.012180051):2.544782073,t155:3.461776203):2.077361859,(t156:4.273068338,(t157:0.6354409221,t158:0.5947659009):3.579833019):1.248417771):0.7757748316):0.03122651714):1.586894097):1.145898018,((t159:1.69927844,t160:1.36686556):5.015820962,((t161:1.652763523,t162:1.631157354):1.508796465,t163:3.060407842):3.060176049):2.161729133):6.528623969,((((t164:4.669770733,t165:4.666272737):1.134365862,((t166:4.627998071,t167:4.303129941):0.2153313102,t168:4.366126761):0.8900987562):3.901981801,((t169:6.59182953,((t170:0.1819478486,t171:0.1423173536):5.441335812,(((t172:4.259432682,(t173:3.754259028,t174:3.730560676):0.4339917631):0.3301942965,(t175:0.8041138661,t176:0.6886290165):3.539729885):0.3353893124,t177:4.391611117):0.6015601296):0.9213840769):0.2065578357,((t178:2.828340832,(t179:1.294700564,t180:1.171603672):1.44541769):1.753046138,(t181:3.827189761,t182:3.678594058):0.499968533):1.35732455):2.287919684):1.897850675,(((t183:3.037960211,t184:2.955061776):4.495535923,(((t185:3.947548156,t186:3.740597165):0.08960555487,t187:3.814615675):1.549212294,(((t188:3.544763209,((t189:0.8285675107,t190:0.7306242844):2.331819339,(t191:1.520823906,(t192:0.4370336924,t193:0.3476716015):0.8779526596):1.491222623):0.3162876691):0.0909263033,t194:2.895121271):0.6452032004,(((((t195:0.5599037638,t196:0.5213160944):1.683062597,(t197:1.566144398,t198:1.505714194):0.5683472545):0.1827048487,t199:2.053675837):0.8193775564,((t200:2.734969066,((t201:0.07792674958,t202:0.07477158376):2.145513305,t203:2.17181445):0.5000133722):0.08349191598,(t204:0.09647075446,t205:0.07281545862):2.564631307):0.02882523084):0.06697519359,t206:2.667662297):0.1003383357):1.078758904):1.861751203):1.139790045,(((t207:0.1968540195,t208:0.1730630337):1.537204164,t209:1.589502801):2.027108527,(t210:0.2839574023,t211:0.1606167887):3.242644735):3.009618616):0.9694061558):3.122218393):2.049330289,((((((t212:1.585741473,t213:1.355726573):0.7773765968,t214:2.082760792):0.2450667202,(((t215:0.4724214468,t216:0.2649831628):0.3013527929,t217:0.3251173357):0.9733183125,((t218:0.797729641,t219:0.7409051725):0.467115618,(((t220:0.3032320189,t221:0.2832177338):0.2497007781,t222:0.470384514):0.1969131718,t223:0.6418456153):0.3661575301):0.02832867141):0.02204267346):0.1909628302,t224:1.086530361):6.30473379,(((t225:0.6764269334,t226:0.20205007):1.119496742,t227:1.312033482):0.7300232873,(t228:1.202324165,((t229:0.245447729,t230:0.07438201482):0.5914256562,t231:0.558490601):0.2447489543):0.5716492404):4.487611932):2.019378971,(t232:2.560860595,t233:2.50800384):5.134149036):1.053647345):0.7041657393):0.2603054124):0.0591358295):0.01252318169):0.2713991283,((t234:1.751592989,(t235:0.08587673371,t236:0.08020696854):1.658366666):8.045178649,((t237:4.928835016,t238:4.906682729):4.288671123,(((t239:0.6434179991,t240:0.6370227588):6.426117708,((t241:0.1950335244,t242:0.1103111307):0.5068574872,(t243:0.2810162434,t244:0.1242879902):0.2940350535):6.25105587):1.986847284,((((t245:0.6072661136,(t246:0.4973353518,t247:0.4356138355):0.0967812213):0.1662401484,t248:0.6528073998):6.873702781,(t249:2.664414993,t250:2.523892795):4.484930966):0.8260304537,(t251:7.514613017,t252:7.198400535):0.2515817618):0.1225043166):0.09858516897):0.5138012775):0.1835933547):0.3325429417,(((t253:3.525551007,((t254:0.986064427,(t255:0.3567964229,t256:0.1607923158):0.3374046673):0.2977005234,t257:0.6767348865):1.939215669):4.289371188,(t258:3.526126387,t259:3.509028564):3.316326319):0.8425398344,(t260:3.360987088,(t261:0.347064026,t262:0.2186328246):2.972862658):4.284076145):0.02191522565):1.281670607):0.8180358672):0.5557912552,(((((t263:1.598700697,t264:1.577074653):3.850502761,t265:5.185838864):2.0940118,((t266:4.197724729,t267:4.196491961):2.793983723,(t268:5.66848882,(t269:4.25914647,((t270:1.509996082,t271:1.453514136):2.652108988,((t272:1.400757373,t273:1.181094611):2.600629721,(t274:3.049891367,(t275:2.351239011,t276:2.32446456):0.4726956674):0.685436354):0.05802331803):0.09141291363):1.215328314):1.228642197):0.2699828272):1.003621122,((t277:6.255907684,((t278:4.699483137,t279:4.676841627):0.9046543223,t280:5.172304152):0.634534678):0.6803220377,(((t281:1.918627503,(t282:0.7751397463,t283:0.7691706196):1.115779567):1.58653485,t284:3.318136342):1.501332709,t285:4.768943218):1.468754413):0.3377975284):1.146380373,(t286:7.309514205,((t287:4.776144894,t288:4.673692123):2.234432937,((t289:2.926561485,t290:2.834208904):1.438052742,((t291:3.860649817,((((t292:2.210565473,t293:2.128867169):0.3577215664,(((t294:1.322135489,t295:1.254345562):0.2817408268,t296:1.451366092):0.2786665426,t297:1.673022762):0.1377118803):0.315331498,t298:1.949299518):0.4825331569,t299:2.400059205):0.2936712943):0.1571577108,(t300:0.6197223833,t301:0.6154861298):2.215828675):0.08617007217):2.279233425):0.1103083792):0.3297698639):0.3822399516):1.035124549,(t302:4.575243164,(((t303:0.9726678539,t304:0.6607273222):2.511463079,(t305:1.600884682,t306:1.558666412):1.547669062):0.5131535544,(t307:2.001355551,(t308:1.031466709,t309:1.025528656):0.7692620619):1.568562389):0.5004212814):2.477022348):4.396287844):0.6069507711,((((((t310:1.369527078,t311:1.335791541):1.522195311,(t312:1.719702138,(t313:0.6232843931,t314:0.6085516681):1.008968742):1.053068179):2.658335631,((t315:1.260448069,((t316:0.3948965759,t317:0.3920943971):0.7666286936,t318:1.088102572):0.08953559247):2.176792627,t319:3.215655816):1.859185304):0.08866615098,(t320:2.239756839,((t321:1.350436977,t322:1.315710959):0.4272149809,((t323:0.6955762647,(t324:0.5423856515,t325:0.4283562104):0.09019659974):0.1395897973,(t326:0.04782915177,t327:0.006717011018):0.594339023):0.8611425772):0.4055369411):2.895685638):1.763678202,(((t328:1.730190266,t329:1.683084759):1.344038927,((t330:1.716576273,((t332:0.353567031,(t333:0.1643165797,t334:0.1514795124):0.1492161116):0.3892646851,t335:0.6591903556):0.3679326452):0.7120142192,t339:1.478126997):0.5701760724):0.6010160092,((t340:0.4643900615,t341:0.4546246526):1.585511201,(t342:1.984993524,((t343:0.7521254513,t344:0.1706764642):0.3130041818,t345:0.4161934387):0.3782672007):0.0358073551):0.5159579347):2.706040902):1.52176945,(((t346:2.012618206,t349:1.545230488):0.1205321045,(t350:0.6427292284,t351:0.5200717566):0.9681556598):1.986110188,t352:3.27926261):1.284846202):2.392263482):1.215940814):1.65965579,((t353:8.576835281,(t354:0.265355769,t356:0.05703739392):8.129008601):0.9948124378,(t357:0.310804752,t358:0.1622799805):8.773017898):0.1858968945):0.09703486974):1.318778641,((((t359:3.419298295,t360:3.394375088):1.44874242,t361:4.823375334):3.259648262,(t362:0.3611535777,t363:0.3036369162):7.568659628):0.8953662157,((t364:8.154703355,t365:8.127564312):0.4894421535,((t366:7.13194006,((t367:0.2510547694,t368:0.1591508547):0.6051817878,t369:0.7420822784):6.263414853):1.374535994,(t370:7.019347849,(t371:1.556279164,(t372:0.1186284798,t373:0.1174872073):1.350019007):5.338171871):1.321148757):0.1081426832):0.1223641417):1.4044582):1.128605269,(((t374:3.041189443,t375:2.786379475):0.02286248778,t376:2.652021746):4.608612739,(((t377:1.068357502,t378:1.040855473):3.802360824,t379:4.798537282):1.142167977,(t380:1.520317288,t381:1.519720223):4.396707647):1.133743807):3.1602924):21.76210651,((t382:8.940972432,((((((t383:1.111112416,t384:0.9496882258):4.443314766,(t385:4.602719193,(t386:2.778155816,(t387:1.132817761,t388:1.072937039):1.641209844):1.803702989):0.6692723176):0.5156708735,(t389:1.517715078,t390:1.477542318):4.158495182):1.277967875,t391:6.911138201):0.2045927027,((((t392:3.466511514,t393:3.466140138):1.782135839,t394:5.238758243):0.606375641,((t395:4.628350322,t396:4.582858905):0.8394527052,t397:5.412406798):0.2979671386):0.06867676697,t398:5.664261681):1.110864401):1.053617497,((t399:1.874827986,(t400:0.2629015308,t401:0.1876313702):1.610514956):4.820102463,(((t402:0.8449673834,t403:0.8059892864):0.3529522376,(t404:0.2090444628,t405:0.04145251707):0.9099711408):4.725441708,t406:5.42227649):0.5984459415):1.109665222):0.2171317144):12.17254941,(((((t407:5.727316644,((t408:0.4444112988,t409:0.4124097974):1.579636249,t410:1.986687013):3.487923983):0.2176654447,((((t411:2.310973047,t412:2.274459409):2.459593815,((t413:4.309426186,t414:4.183643527):0.1724456537,(t415:2.618085534,t416:2.463322642):1.5841521):0.1998222861):0.1761897465,(t417:3.581445573,((t418:2.266481017,t419:2.16488636):0.8964546952,(t420:0.5260558095,t421:0.5069729526):2.268915958):0.05318805042):0.7505060691):0.110687684,t422:3.500528887):0.2426997316):0.1341438688,((t423:3.076595164,(((t425:1.933863273,(t426:0.3234517617,t427:0.2958300748):1.590361441):0.2464031028,t428:2.101488313):0.1730835572,t429:2.26758566):0.4530068061):0.1372572196,((t430:1.748420181,t431:1.729930726):0.5110351482,(t432:0.753504746,t433:0.3968919244):1.305061955):0.3925535898):0.6008344749):0.7022642511,((((t434:2.033381968,t435:1.983902331):0.1886115739,t436:2.130485168):0.4591281908,((t437:0.1370886779,t438:0.1184453946):1.274307909,t439:1.34943556):1.152151826):0.3283122567,t440:2.685655644):0.2710188073):12.02732037,(((t441:1.303060561,t442:1.281616579):0.01953785161,(t443:1.195225549,t444:1.165363921):0.0773109964):1.753810992,((t445:2.081439221,t446:2.05872508):0.6231287243,(t447:0.5818450189,t448:0.5360688482):2.000416383):0.2858284716):11.86303878):0.6688892314):10.83985867):59.96374957,(((((((t449:1.029849171,t450:0.9978613645):1.285234602,((t451:1.794685983,t452:1.738331165):0.2998429382,t454:1.929676269):0.1708930506):0.3973147737,(t455:2.162097773,(t456:0.9953423938,t457:0.7350128767):1.135931876):0.3237558782):0.7392909309,(((t458:0.4265166033,t459:0.1677978734):0.4312966672,(t460:0.2035120726,t461:0.1505103163):0.3005181818):0.8538377234,(t462:0.709421566,t463:0.5130297623):0.5586995362):0.9979588781):1.334733879,(((t464:0.5015266454,t465:0.4881589138):0.3894060373,(t466:0.3238976547,t467:0.2904762947):0.4994219609):1.290299326,(t468:1.882781502,(((t469:0.766584072,t470:0.6865057691):0.329597675,((t472:0.4218849445,t473:0.4115911036):0.1269277645,t474:0.4951498324):0.3273767058):0.5629240405,(t475:0.4377712148,t476:0.4048413221):0.8675453959):0.1422565352):0.1752135156):1.068762837):10.31575572,((t477:0.2702712953,t478:0.223109577):1.411881352,((t479:0.7959609539,t480:0.7436109166):0.1878931011,t481:0.6749067856):0.602157594):10.95826869):13.39263059,(t482:10.1965292,t483:10.16865002):15.28410677):57.6361797);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T83.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
