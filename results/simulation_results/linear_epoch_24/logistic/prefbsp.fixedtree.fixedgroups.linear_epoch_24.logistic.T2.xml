<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t410:6.206941514,t411:6.187010726):3.762830544,(((((t412:5.34413942,((t413:4.069194713,t414:4.05844949):0.4003475286,((t415:2.018704006,t416:1.99554404):1.264434009,t417:3.222463065):1.069336689):0.7746936044):2.713995019,t418:7.764152791):0.1637514488,(((t419:2.886864198,(t420:2.468119859,t421:2.449041899):0.3126458414):0.01461693064,t422:2.771947159):3.550387997,(t423:5.556531599,(t424:0.1014019527,t425:0.09011442788):5.401157391):0.7349117167):1.340520222):0.1749005218,(t426:7.200905761,(((t427:5.324687802,t428:5.24899591):1.330869814,t429:6.550735956):0.3848840752,t430:6.851948764):0.09335077812):0.4494953663):0.1785205644,((t431:5.052920415,t432:5.023418242):1.694826862,(((t433:5.148720237,t434:5.140901211):0.4580358309,((t435:4.944618982,(t436:1.399439177,t437:1.386261226):3.244100017):0.1415745745,((t438:4.540543603,(t439:2.323592218,(t440:1.371637742,t441:1.341791229):0.8674317548):2.211070337):0.1877364628,(t442:0.6529942743,t443:0.6376039653):3.901913514):0.03503723658):0.2584031042):0.4358640276,(t444:2.155714289,(t445:0.8814459306,t446:0.8420938004):1.224325051):2.98529001):0.5720538796):0.2965198907):1.098593233):1.037196362,((((t447:2.996817874,t448:2.963552308):0.6943995282,t449:3.592283378):0.6337717701,((t450:3.706995753,t451:3.631548129):0.1984373461,(t452:1.957680623,(t453:0.7425287897,t454:0.596401318):1.070545132):1.787370083):0.2724864569):0.6131340816,((t455:3.770766318,t456:3.762370383):0.08930772972,((t457:2.446560524,t458:2.152825727):1.074738491,t459:3.12696138):0.1466825797):0.4288352458):3.029837546):10.83252205,(((((t460:1.995451948,t461:1.972878252):1.124341561,t462:3.084395937):1.7805091,((((((t463:0.8391429433,t464:0.7283089254):2.504125457,t465:3.057634797):0.0001585126699,((t466:1.371076516,t467:1.153746103):0.9089382766,(t468:0.8712592635,t469:0.6967140136):0.983879915):0.5219779227):0.8228697065,t470:2.999168166):0.2271758059,(t471:2.921991452,(t472:1.515068636,t473:1.194728432):1.389493235):0.193931841):0.2336610114,(t474:1.719814139,t475:1.616402885):1.057058922):0.1473329556):0.9637386083,t476:3.64910688):0.07269287428,((t477:1.369660125,t479:0.9201081899):0.1504105538,(((t480:0.6282422162,t481:0.1767100018):0.2174300392,t482:0.3778577563):0.08990573808,t483:0.4439023963):0.09717450136):2.103288142):11.61439461):9.514494342,((((t484:0.266930239,t485:0.2524087412):0.4366934098,t486:0.6715931823):0.3612609578,t487:1.02783992):22.47424569,((t488:0.6184935947,t489:0.5588762918):12.26411674,(t490:1.269268717,((t491:0.8694390206,t492:0.8396273347):0.1100163467,((t493:0.1173922243,t494:0.01181024732):0.1316078582,t495:0.1309481531):0.630958496):0.2490958346):11.30124724):10.61827278):0.2049951517):13.23884093,(t497:0.3965802308,(t498:0.04295086298,((t496:0.1533813838,(t478:0.04691683098,(((t397:0.04148307634,((t382:0.1260297619,(t373:0.09242865323,(t371:0.08540686053,((t305:0.01020775847,((t283:0.1550015824,(((t276:0.3545098941,t277:0.08456779814):0.05461549149,((((t253:0.03076965094,(t159:0.06125922359,(t142:0.003762806683,((t127:0.2157421149,(((t114:0.1130296843,(t17:0.1169839316,(t14:0.01930968024,t1:1.504599122):0.1880520851):7.630197321):0.9935048668,((t2:1.267083597,t3:1.134228783):8.163660634,t4:9.253511294):0.7306457163):0.1279693786,(t5:6.025691974,((t6:1.070456318,(t7:0.137213939,t8:0.06604452775):0.8748387472):3.506462674,t9:4.363950094):1.333484676):3.819657056):0.3148751662):1.307055938,(((t10:0.7298147052,t11:0.5461703281):0.1766144263,t12:0.5226985188):9.158509643,(t13:4.021788611,t15:3.920455636):5.639002701):0.9991937273):0.4754787368):1.41285823):7.585100833):0.7291947293,((((t16:6.927896791,(t18:6.579484334,t19:6.572141268):0.1294900241):0.7263211529,t20:7.4012749):3.356179596,((((t21:4.113635196,(t22:0.5788235005,t23:0.5559485612):3.514331924):3.507450701,t24:7.492028644):1.873036926,(t25:9.077470977,((t26:1.133554235,t27:1.073688587):5.073641892,t28:6.118957016):2.254813786):0.1819556282):0.1219915251,((t29:8.597087035,((((t30:2.477505576,t31:2.46651668):0.04053667165,t32:2.492447274):4.654512948,((t33:6.46013244,(((t34:0.5129189284,t35:0.3756665036):0.5919966272,t36:0.8585249745):2.700472447,t37:3.410223691):2.602523381):0.2366173205,(t38:4.237461146,t39:4.131386002):1.873250552):0.4271054081):0.1830079865,(t40:6.293158474,(t41:5.714975897,t42:5.605753441):0.5269150854):0.3202078935):1.201589834):0.05093777422,t43:7.680365297):0.01579657366):1.022611021):9.30994905,((((t44:9.064503661,(t45:2.501626006,t46:2.467287892):6.548446115):0.2316866947,((t47:5.533316848,(t48:4.813712982,(t49:2.355559742,(t50:1.749646657,t51:1.745661861):0.5523760351):2.303883713):0.5388408517):1.177527894,(((t52:5.334324512,t53:5.103684758):0.4711237544,(t54:4.971538863,t55:4.721989635):0.328412862):0.1361957049,(t56:4.822666526,(t57:4.065664091,((t58:1.012921505,t59:0.9631493754):1.348002398,(t60:1.692401037,t61:1.586688974):0.58288148):1.68670013):0.7497252903):0.3582265056):0.3471278086):2.500727451):0.6861287971,((t62:4.195472506,((t63:0.4570707677,t64:0.4164014978):1.991631408,(t65:1.213608031,t66:1.005818234):1.148244755):1.740745803):1.36248896,t67:5.168628949):2.926913418):4.150677506,((t68:4.399247797,t69:4.380005394):1.721986507,((t70:2.001898711,t71:1.952257288):1.017258043,(t72:1.324224227,t73:1.116888269):1.636278143):2.567376072):5.851217222):3.860977715):0.4299680131):0.2898046085,((((((((t74:1.09975341,t75:1.080613513):1.252033803,t76:2.27517814):0.6402805403,(t77:1.086637403,t78:0.9264106779):1.79946671):2.049808833,(((t79:2.137561316,t80:2.115771489):0.3689460075,t81:2.400511):2.03560347,((((t82:3.134689526,((t83:0.6757751207,(t84:0.5819642243,t85:0.5452611141):0.07303040053):1.670335098,(t86:0.5877200047,t87:0.5332939358):1.614104306):0.6651295062):0.1071312304,((t88:1.610450323,t89:1.561634948):0.7250944828,(t90:1.625569201,(t91:1.470699221,t92:1.454692322):0.08143882031):0.4405461363):0.5127456607):0.05162652209,(((t93:1.413121742,t94:1.405037441):0.2466851468,t95:1.572999577):0.7623821381,t96:2.314553119):0.03981540448):0.5598798897,(((t97:0.4492752217,t98:0.4156403234):1.847078335,(t99:0.7041915431,t100:0.6938869743):1.459680172):0.2120935414,((t101:2.148156138,((((t102:0.7577017066,t103:0.7572369659):0.1386050885,t104:0.8482593512):0.4777558546,t105:1.325168734):0.3576979828,t106:1.548680524):0.3778745403):0.1236673567,((((((t107:0.6164783282,t108:0.615160761):0.5753261124,(t109:0.9656355121,t110:0.9218363968):0.06963295233):0.03921102002,t111:0.8224314861):0.05344019038,t112:0.8361283061):0.4691206785,(t113:0.2155505663,t115:0.09835757427):1.034792126):0.03237366201,t116:0.950925793):0.2454357712):0.09353725663):0.3698392792):0.4984731366):0.2060307522):0.5790575535,((t117:0.4292033696,((t118:0.02934599813,t119:0.01381840516):0.2445598624,t120:0.2272421027):0.007887742078):0.8635949308,((t121:0.4944418993,t122:0.4756340261):0.4829743303,t123:0.8343034239):0.1153837195):1.388525133):0.1155403561,((t124:0.2707566186,t125:0.2657966842):0.1534119598,t126:0.3398825723):1.738149627):4.952190564,(((((t128:1.111712858,t129:1.009352515):0.7375539623,((t130:0.504211107,t131:0.3184159181):0.4279218221,t132:0.674291736):0.7950930423):1.231294707,(t133:0.6412037273,t134:0.4374554722):2.039155899):0.5768327061,(t135:2.534935541,(((t136:1.025865214,t137:0.8221305242):0.3752125008,((t138:0.760630005,t139:0.7226956822):0.09788986872,(t140:0.4507108453,t141:0.2855892993):0.196730881):0.2313401484):0.02946505923,(t143:0.3556129632,t144:0.3519627272):0.1010090698):0.9133629874):0.324296012):2.813463703,t145:4.409730842):0.2529035666):4.205915953,t146:8.738146894):0.800251407):0.5905329653,((((t147:6.305863075,(t148:0.7242625472,t149:0.51470392):5.546179407):0.8215796739,t150:6.869996341):0.9456163056,((t151:0.1898900083,t152:0.187548695):2.850607506,t153:3.036083957):4.710549426):1.07847579,((t154:0.2011815011,t155:0.1534195929):4.976114791,t156:5.044646962):3.639608146):0.7455808891):0.07828087189):0.5203216441,(((t157:6.751997492,t158:6.650505239):1.111566549,t160:7.375123249):0.3490857031,(t161:2.429196689,t162:2.343018296):4.877508316):1.794001426):0.1903522297):1.983388787,((((t163:2.242699177,t164:2.155145366):0.5838973311,t165:2.676113069):0.09820467929,t166:2.729948471):3.756437555,t167:6.485796178):4.462186404):0.007916368088):4.239238926,((((((t168:3.288863771,t169:3.261774519):4.066613989,(t170:4.298494819,(t171:2.045363288,t172:2.041027477):2.23050614):2.963160955):0.3710733221,((((t173:0.4827220488,t174:0.364314615):4.865194236,((((t175:0.374670402,t176:0.2487841195):3.921499344,t177:4.157247485):0.06555686795,(t178:2.311218831,t179:2.30749536):1.901421577):0.01496472938,t180:4.216458445):0.8199053244):0.5591355501,t181:5.56225106):1.31120946,(t182:3.80868547,t183:3.749234735):3.003827279):0.3261939426):0.5720201858,t184:7.648589093):0.4762390941,(t185:6.772976376,(((t186:5.080045739,(t187:4.80470722,t188:4.720561565):0.1869511584):0.5377499926,t189:5.43499944):0.7111191997,(t190:5.345497468,t191:5.326806521):0.7889097216):0.3397504138):1.271592239):4.990603383,((((((t192:1.781501169,t193:1.600830428):3.731615773,t194:5.280521692):0.08250207083,t195:5.054730589):2.995725806,(((((t196:1.779922478,(t197:0.611713098,t198:0.4251845001):1.143715986):2.143071326,((t199:2.841592313,t200:2.728269245):0.4038908023,(t201:0.1175024042,t202:0.08352450354):2.963548932):0.4166373862):1.522621839,t203:4.98578116):0.2536898902,((t204:2.730959045,(t205:1.030573409,t206:0.998090275):1.663033321):2.255588551,((t207:0.587599952,t208:0.5671172596):3.701041366,(t209:2.132069028,t210:2.091640513):1.911410057):0.6158786784):0.0684957714):0.9429228118,((t211:2.143652142,(t212:0.1509524192,t213:0.1188568188):1.951348051):1.953633664,t214:4.005996199):1.257543026):1.381244329):0.2590056752,((((t215:3.907649388,t216:3.372284485):1.532854621,t217:4.856028443):0.1423830171,((t218:4.050280627,((t219:1.007812922,t220:0.7822804812):2.43008694,((t221:1.743884498,t222:1.695662713):0.8791988973,(t223:1.317287705,t224:1.242517119):1.178336043):0.3891061105):0.5777337855):0.2655320187,t225:3.573127958):0.5287043023):0.1809740651,((((t226:2.54416379,(t227:2.193411711,t228:2.186427091):0.2490506499):0.5367877558,((t229:0.9122217424,t230:0.8212448536):1.722252336,(t231:1.983250907,t232:1.893953251):0.4572585737):0.1901367942):0.8047780634,(t233:1.361851426,t234:1.302691254):1.936367452):0.1499755092,(((t235:0.361404479,t236:0.3458269108):1.226150529,(t237:1.054452833,t238:1.037363747):0.4370987855):0.8653198068,(((t239:0.6455648583,t240:0.5964577081):1.025629944,(t241:1.045049022,(t242:0.4237700048,(t243:0.3205750886,t244:0.2200843765):0.07720964028):0.6182127441):0.5047845396):0.6060256203,((((t245:1.029942364,t246:1.025813081):0.4101795376,(t247:0.4893917971,t248:0.4654422099):0.900143717):0.02797837438,(t249:0.962767048,t250:0.9500530131):0.2617211947):0.3641648758,((((t251:0.7591618398,(t252:0.5734084644,t254:0.3276652102):0.1834219951):0.006796552203,(t255:0.3638481003,t256:0.04006680932):0.1009108591):0.1462607203,t257:0.2621954279):0.453157622,t258:0.6813922409):0.1336729215):0.08628813268):0.04543282194):0.8521406736):0.1585607885):1.101177834):0.2646867579,(((((t259:0.1336779726,t260:0.1310860898):0.4110897587,((t261:0.3908589801,(((t262:0.0525284336,t263:0.04727426553):0.08467699271,t264:0.09798319238):0.05653515704,t265:0.1455109584):0.1645981841):0.05280996109,((t266:0.2314958135,t267:0.1526813163):0.0253965759,t268:0.1726310917):0.1012372211):0.05901001552):0.01660514491,t269:0.3192177499):0.2338402648,t270:0.5213480153):1.962434163,(t271:1.177694641,((t272:0.6332336814,(t273:0.1522513365,t274:0.1310159804):0.1745626953):0.3712842927,t275:0.5894241713):0.1717193497):1.301570148):0.5584600299):3.580204994):1.238717944):3.714110979):0.2001714152):0.777579317):1.172737033,((((((t278:1.632054798,((t279:0.6105306191,(t280:0.1858809021,t281:0.1254827565):0.142427041):0.43109259,(t282:0.4161645434,t284:0.1861591813):0.1889774875):0.5405154541):1.671930635,t285:2.512096758):8.011219375,(((((((t286:0.4395210114,t287:0.4177632559):2.530816843,t288:2.869932495):1.591219959,(((t289:1.280943545,t290:1.066275881):0.04952168242,t291:1.079459612):2.465777049,t292:3.28701097):0.4267192191):1.038550141,t293:4.611156216):0.2570508045,t294:4.824164534):4.095598949,((t295:6.341252736,t296:6.277167403):2.271632058,(t297:6.848520951,((t298:2.645721513,(t299:0.4747920104,t300:0.4476727976):2.042849389):1.508543019,t301:3.985317405):2.691275895):1.697326433):0.2323882408):0.2486210579,(((t302:4.033079976,t303:4.028755207):3.586975828,(t304:5.730212308,(t306:4.364748268,(t307:3.499533454,t308:3.374276532):0.6605980342):1.05256442):1.772267236):0.5290312116,(t309:2.103872204,t310:2.086637607):5.096680381):0.6155251112):0.00673805894):0.4872139949,((((t311:2.758032308,t312:2.56369194):2.529177537,t313:5.063598064):1.25799655,t314:6.307421043):1.59737752,(((t315:5.058670706,(t316:0.6623751489,t317:0.6494099261):4.24870674):1.758972419,(t318:3.207566666,t319:3.119388321):3.215573684):0.9003818611,(t320:5.392090459,t321:5.271123287):1.836507414):0.07948618223):0.01978699342):0.6656434056,((((((t322:5.491081914,(t323:1.676267341,t324:1.646251566):3.793741345):0.03394429823,t325:5.331611551):0.3796301457,((t326:1.739981071,t327:1.612100151):1.225321978,t328:2.71919605):2.606793535):0.2012429788,((t329:1.429757362,t330:1.351065789):3.873437616,t331:5.110971243):0.05603913873):0.1458967301,(t332:0.09219091784,t333:0.006842068194):5.019285177):0.6707723353,(((t334:0.4108921094,t335:0.3896163958):2.849018826,t336:2.983174439):1.772630996,t337:4.634953497):0.3302587643):0.6289760958):0.06735321231,(t338:5.49529914,(((t339:5.070909558,t340:5.058405279):0.1038355772,t341:5.129446587):0.06222624188,(((t342:2.745475715,t343:2.717432901):0.1837408054,(t344:1.12931708,t345:0.8076026144):1.401424874):1.644255082,(t346:1.524995347,t347:1.506730731):2.133668596):0.4608715163):0.02672801855):0.1453933936):0.2488446846):0.6231662326):0.2541562501,((t348:3.608196066,(t349:2.341897656,t350:2.338866524):1.094387697):1.222823774,(((t351:2.900065795,(t352:2.603985672,(((t353:0.3728207107,t354:0.2426351486):1.525172981,t355:1.621834134):0.2969141027,((t356:0.1784154529,t357:0.09874399876):1.05654292,t358:1.091398928):0.6744413215):0.3180748405):0.2792237006):0.0434207563,(t359:1.419223528,(t360:0.9495253067,t361:0.894397984):0.4297547465):0.9458855766):0.1247583467,(t362:0.7086370007,t363:0.6562259395):1.669998024):1.455692):0.5665871904):6.281302477,((t364:2.624198646,((t365:0.3929928824,t366:0.1927732251):1.695864341,(((t367:0.7784475234,t368:0.4729239458):0.6464694945,t369:1.098665211):0.004954328342,((t370:0.616674684,t372:0.3089520335):0.06869383381,t374:0.2487657293):0.08665210892):0.4410230566):0.5348412524):0.5532593769,t375:1.843296211):7.226532974):2.247119194):1.536194497):0.3892488298,(((((((t376:1.054891218,(t377:0.7317562931,(t378:0.5412229213,t379:0.4394038648):0.07210523143):0.2489706509):0.3807023855,t380:0.8851696756):0.003839419145,t381:0.8292001983):0.01069773098,t383:0.6974578734):11.09493821,((t384:0.115617348,t385:0.02633292659):0.9021707798,(t386:0.3004564399,t387:0.2980810434):0.4775698083):10.71502903):0.009182102653,((((t388:0.2993831896,t389:0.279689861):2.240727507,((t390:0.806322317,(t391:0.2750871847,t392:0.1369636524):0.2917119184):0.838704952,t393:1.133964906):0.8597937523):3.335131061,(t394:1.063086499,t395:0.7775715916):4.099056947):3.545616007,((t396:1.349830779,t398:0.7833797564):2.978023629,t399:3.728048274):4.048545465):2.031524522):0.2134596472,(((t400:3.434655261,(t401:0.209028554,t402:0.07437833985):3.107030685):6.349146169,((t403:8.276192861,((t404:0.8073989521,t405:0.7175510037):1.188699941,t406:1.672486458):6.007327078):0.5555172854,(t407:0.4995993572,t408:0.2849226702):7.714609481):0.5722297798):0.1630048315,t409:8.711188683):0.002684191728):0.4741104209):0.2065138041):0.3115621153):35.21756898);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T2.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
