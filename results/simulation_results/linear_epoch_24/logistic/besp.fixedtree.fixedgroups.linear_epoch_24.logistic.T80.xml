<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t492:1.424372494,(t493:1.224991065,(t494:0.5380979928,t496:0.3584932739):0.6721601304):0.1966828123):10.11872315,((t497:1.822520398,((t495:0.1260857676,(((t485:0.1982188563,(t486:0.02062747208,((t480:0.1778175417,(t481:0.1169154531,((t471:0.02400271148,((((t360:0.1431601111,(((t318:0.1457889955,(((t258:0.06337233486,t259:0.01497005525):0.0003848851607,((t249:0.01525127351,(t238:0.04000270133,((t234:0.04003000311,((t232:0.001695600765,((t196:0.2320855299,(((((t128:0.1046832209,((t125:0.07450207372,((t95:0.1299930549,t1:8.597138911):0.6376032756,(((t2:1.107914303,((t3:0.1491215785,t4:0.07400217015):0.689419246,(t5:0.2055004004,t6:0.04977846313):0.4075549185):0.2012281722):1.837428326,(t7:1.790896467,(t8:0.5770507884,t9:0.5417937218):1.008531286):0.6794601933):5.470409941,(t10:0.2192017817,t11:0.1933419141):7.456939923):0.3535165124):2.013080878):0.186362118,((((t12:7.002133385,t13:6.958578521):1.130880852,(t14:4.518187086,t15:4.474743586):3.501944918):1.08978293,(t16:7.664708951,(t17:6.031298868,((t18:4.21428538,t19:4.209260631):0.6775321039,(t20:4.580831855,t21:4.541140251):0.2525306101):1.055426354):1.631177044):1.379341425):0.7231306084,(((((t22:2.63974716,t23:2.262974095):0.032980123,t24:2.289310065):3.589174762,t25:5.60634313):2.17972529,(t26:7.268794781,(t27:6.700664982,(t28:6.260360264,t29:6.229227021):0.2165969464):0.532125761):0.3618753507):0.4019765625,t30:7.72443868):0.3584350562):0.1341866294):0.1790040024):0.1151415365,(t31:7.565163803,((t32:5.605689943,(t33:0.2595460321,t34:0.1914569465):5.308923142):0.7404454985,t35:6.225217892):1.152397836):0.7431361488):0.24600804,(((t36:3.921821166,t37:3.908491324):1.4376954,(t38:4.827960812,(((t39:1.676308755,t40:1.642404264):1.341617532,((t41:0.07385595622,t42:0.04217499368):1.199457283,t43:1.146808233):1.390291658):1.545947145,t44:4.033392113):0.2293966886):0.5013981539):1.721021657,(((t45:4.292711929,t46:4.206345574):0.2839614032,t47:4.272986222):0.04439942021,t48:4.306373856):1.731870434):1.233147702):0.602087568,((((((t49:3.295011879,t50:3.202726127):1.901502628,t51:5.076497814):0.6572365824,t52:5.230046092):0.007063930359,((t53:3.125623066,(t54:1.401613233,(t55:0.8991712945,t56:0.8582824308):0.3410128602):1.681100429):1.727796677,(t57:3.700328999,t58:3.496635878):0.8773351595):0.3505609482):0.1552893439,(((t59:1.126339677,t60:1.123171261):2.333056227,(t61:2.306572839,(t62:2.21795745,t63:2.207300916):0.07802752968):1.145970228):0.2079284761,(((t64:0.09160036168,t65:0.05690409935):3.030025876,(t66:2.091641402,t67:2.069081599):0.9471693794):0.3209657984,t68:3.218294871):0.03643636379):0.9623451269):0.6529126139,t69:4.812065552):1.146205251):6.592789165,((((((t70:1.590004261,t71:1.509417856):1.032075098,t72:2.523417573):2.189406837,(((t73:1.573982431,(t74:1.316646454,(t75:0.497141321,t76:0.4413901566):0.741996089):0.1762410636):1.192611119,t77:2.328202682):1.437710048,((t78:2.672375336,t79:2.599757755):1.005042232,(t80:0.7311181339,t81:0.6982388149):2.831364813):0.03924923468):0.3420913951):1.317117622,(((((t82:0.5839628483,t83:0.569801609):0.5127572898,t84:1.080837444):2.583257632,((t85:0.4005439793,t86:0.3316611987):2.838382456,(t87:2.527743582,(((t88:1.932417241,t89:1.76474935):0.1802383944,t90:1.839586947):0.1771212821,(t91:0.379756034,t92:0.281458384):1.533099721):0.1605090105):0.5958393088):0.4194646427):0.1845147772,((t93:1.514301422,((((t94:0.2814750747,t96:0.08924765854):0.1418272803,t97:0.1582815641):0.9543261633,t98:1.081225607):0.09081737581,(t99:0.9515675499,t100:0.928835761):0.174280719):0.0445188446):0.356669186,(t101:0.4160521807,t102:0.3496717521):1.032480761):1.301666208):0.7706974185,(((((((t103:0.9006193656,(t104:0.7496062139,t105:0.7404863084):0.03985346847):0.357428236,((t106:0.6775060999,((t107:0.1429616144,t108:0.0884557749):0.2219691913,t109:0.2688218434):0.3091468988):0.1863670894,t110:0.6934247626):0.2123914831):1.067521655,((t111:0.2785568398,t112:0.07780163297):1.044766796,(((t113:0.3294070502,t114:0.2990337437):0.1022184094,t115:0.269489723):0.1117473727,t116:0.2035399681):0.4311248575):0.1743593481):0.1691172878,t117:0.8265748545):0.05470181839,t118:0.8811979622):0.5161115043,(t119:0.1034627538,t120:0.009726419556):1.247370777):0.007986636619,t121:1.091784866):0.3758175602):0.4713066916):0.9948942564,(((t122:0.1138378389,t123:0.08370033675):0.6443057808,t124:0.7094369046):0.4639420514,t126:0.8497867068):1.629562999):4.153980489,(((t127:0.3457537663,t129:0.02005740735):1.777317222,t130:1.673572595):0.4750083756,(t131:0.7934951022,t132:0.5383339845):1.279677056):4.029429423):1.179564018):0.3681286907):2.477859462,(((t133:1.205318055,t134:1.034841906):1.950719259,t135:2.895893596):1.958360044,t136:4.707375672):4.597729003):0.3321989258):0.3270631076,(((t137:8.525309426,t138:8.474042688):0.8831306978,t139:9.23273227):0.3744154118,(t140:6.447582383,t141:6.392248184):3.119899892):0.1769335634):0.1142118413):0.04997768347,((t142:1.700156907,((t143:0.5814718734,t144:0.5804351666):0.0575753127,t145:0.6251595358):0.9625323539):7.197964249,((t146:6.256693576,t147:6.19944314):1.276245597,(t148:4.821650288,t149:4.764655062):2.503864133):1.087329427):0.8375501805):0.3434273302):1.709201676):0.371775566,(t150:11.0873714,((t151:9.038864575,((((t152:7.267810147,(t153:5.479287737,(t154:0.6393464422,t155:0.1272121552):4.633811973):1.594002058):0.6609957605,(t156:0.2629389344,t157:0.09335770232):6.697358009):0.4242836502,((t158:6.320698695,t159:6.198423969):0.07244272413,t160:6.134049349):0.7576751062):0.3779009687,(((t161:6.110650419,((t162:3.183217697,t163:3.073313183):0.63414784,(t164:0.9372583064,t165:0.8392909453):2.768938963):2.163129874):0.4788811229,((t166:0.3629291295,t167:0.1554166027):5.619675504,((t168:0.5274005387,t169:0.4431786308):2.217332648,t170:2.591482958):2.980439545):0.00343244653):0.4090042135,(((((t171:2.812817017,(t172:0.1394112403,t173:0.1090799775):2.397100193):2.528598853,t174:5.024429847):0.03702339446,t175:5.016725393):0.2424041315,((t176:3.191691077,(t177:2.902796775,(t178:0.6399302059,t179:0.5033736336):2.210409318):0.2862835881):0.2822224128,t180:3.0793214):1.780591649):0.171223751,t181:5.009763866):0.07315326642):0.1129231467):0.1295312977):1.716420723,((((((t182:3.293311903,t183:3.205951275):1.040993568,((t184:3.663228233,t185:3.590393428):0.1833899347,t186:3.619826278):0.3381418744):0.09631363708,((t187:2.161656522,t188:2.011104848):0.6806269115,t189:2.403152631):1.150571572):0.5510283842,((t190:1.476654876,t191:1.423940375):2.017362395,t192:3.438745927):0.5522044753):0.8864486117,(t193:2.687737764,t194:2.62779975):2.147664827):0.1093535938,(t195:1.619018276,t197:1.223253186):2.751795756):0.9064999796):0.2318387521):0.4547478624):0.09630836278):6.293768412,((t198:3.414168923,(((t199:1.257868477,(t200:0.940024121,(t201:0.6849902666,t202:0.6705208959):0.2317312616):0.2136535279):1.203912584,((t203:1.428465988,t204:1.349665779):0.2073559791,t205:1.542538977):0.6481697777):0.3735513788,(((t206:0.3715524258,t207:0.3694186224):0.1340405453,t208:0.4518291089):1.150278727,(t209:1.198994839,(t210:0.10206688,t211:0.05104885798):1.01408736):0.3887105382):0.8847634099):0.5347077378):0.3729594555,(t212:1.102225886,t213:1.047096938):2.126441862):8.135560936):0.03985535454):2.42985476,((((((((t214:1.435971579,t215:1.251086417):2.03606897,(t216:2.326267414,(t217:1.409162102,t218:1.368229991):0.9144376523):0.9355931113):0.2454724043,((((t219:0.2122580676,t220:0.1421657533):0.1322966098,t221:0.2212912448):0.8023982263,t222:0.7211811141):1.967890753,((t223:0.8865325848,t224:0.5992364531):0.8191616696,t225:1.232586074):0.8546358125):0.2816967697):1.794363016,(((t226:0.3421288883,t227:0.3329583738):0.5409655459,(t228:0.6724764301,t229:0.5677506836):0.1949266935):2.046109636,(((t230:0.07038694313,t231:0.05157196261):0.5671873393,t233:0.4506532387):0.8140740283,t235:0.7133622393):1.273402818):1.01564196):4.791297671,(((t236:1.169033627,(t237:0.8979518969,t239:0.6495709337):0.1828019279):0.8701122187,((t240:0.2182186336,t241:0.09381665489):0.8815567778,t242:0.7996950612):0.5450289797):4.467920801,(t243:4.181119382,t244:3.810409477):1.434789658):1.226866673):2.664596992,(t245:6.614732996,(((t246:0.1646304054,t247:0.002785808683):0.9705004978,t248:0.9076768533):5.232408755,t250:6.064725657):0.1768189848):2.240284176):0.2697759346,(t251:0.5199004675,t252:0.4745240908):8.201288021):0.2884606299,((t253:2.042185057,(t254:0.1143171485,t255:0.07866524161):1.926814209):6.145574674,t256:7.989965624):0.7454813094):0.1731697333):0.2362304529,(t257:8.44415508,t260:8.272989343):0.6847854465):1.039590954):2.274292991,(((t261:8.409610133,((t262:8.108358013,((t263:2.819971112,(t264:2.540369581,t265:2.515015995):0.2774898022):0.5873288714,(t266:0.1438172383,t267:0.1403291991):3.198267251):4.683756187):0.1475790176,(t268:7.139527894,((t269:2.288392688,t270:2.200750263):2.783910195,t271:4.234165065):2.066895178):0.9723602169):0.0304115115):0.1106020802,(t272:7.098273194,(t273:5.526696247,(t274:0.1431738458,t275:0.1398830571):5.227207713):1.373517097):0.1448358957):0.767843706,((t276:1.041920231,t277:0.9229924156):6.201743928,((t278:5.375348535,(t279:3.810534737,t280:3.77861642):1.437326029):1.143958806,(t281:2.868356379,t282:2.855568186):3.462635314):0.5825149511):0.3947981389):2.922037795):2.184389735,(((t283:4.722698905,t284:4.71759194):2.443289124,((t285:3.560197983,t286:3.310651074):2.53997294,t287:5.739487314):0.9942954285):1.252410006,((((t288:1.324820326,t289:1.324811261):4.194224459,t290:5.39861081):0.597643299,t291:5.965382415):0.9288357409,t292:6.869672897):0.931148578):3.964038211):3.638728802,(((((t293:6.72904985,t294:6.660823078):1.12399341,(t295:6.431023642,(((t296:4.812146666,t297:4.66393744):0.2100942469,(t298:1.277393382,t299:1.240368051):3.419625461):0.114659548,(t300:0.3022028324,t301:0.2422770815):4.418352245):1.145561302):0.8165693658):0.1045846926,((t302:4.329259707,t303:4.293184417):0.3710322103,(t304:2.245167899,t305:2.088541296):2.29643839):2.00849731):5.420564628,((((t306:2.153731947,t307:2.105856291):3.111281494,((((t308:2.243982547,(t309:0.7453937493,t310:0.5575145422):1.375251796):0.5670239948,t311:2.438529244):1.424904585,(t312:0.3843945472,t313:0.3665999121):3.248802279):0.9223235586,((((((t314:1.317512428,t315:1.004526027):0.4989395221,t316:1.503293396):0.3747584288,t317:1.777348428):0.6643268164,t319:2.15256704):0.2471286806,t320:2.284021335):1.112785049,(((((t321:0.3560283445,t322:0.3258482036):1.989800604,t323:2.15080234):0.2477436104,(t324:0.1421073184,t325:0.0956759926):2.178263496):0.0614618692,(t326:1.784375631,t327:1.762502493):0.4953446624):0.4086473947,((t328:1.929416242,((t329:0.7022530258,(t330:0.6279054889,t331:0.5151101429):0.06023523251):0.5821868637,(t332:0.9231869142,t333:0.840873263):0.1994020646):0.2601752379):0.1342695941,t334:1.129406779):0.5519907119):0.3309197016):0.01853675256):0.007965586931):0.09239147325,(((t335:0.07634652002,t336:0.05141180257):0.5628764455,t337:0.3269106261):0.9137600159,(((t338:1.161619476,((t339:0.1613868779,t340:0.1604784971):0.8664727764,(((t341:0.2047011426,t342:0.2026549962):0.01410546085,(t343:0.08547794831,t344:0.07968283085):0.1081634805):0.2326150023,t345:0.3361806584):0.5717041555):0.09647523474):0.008842638053,t346:0.9586378437):0.001424907493,t347:0.946799819):0.03870245485):0.3586645347):0.4243684798,(t348:0.2000031136,t349:0.1925920211):1.498679526):5.818534377):1.321963747,(((t350:0.5636980503,t351:0.5099541151):0.08226087102,t352:0.5266208564):3.486696059,((t353:0.8700244868,t354:0.8696673236):2.81457708,(t355:1.885574743,t356:1.70108377):1.693519877):0.02516769511):4.674436511):0.5692907271):1.425715693):0.6745727765,(((t357:1.080177751,t358:0.9538648916):0.749302415,(t359:0.7308745361,t361:0.2518121395):0.8724317173):0.4888359993,(t362:0.6048728421,t363:0.03737019257):0.8518901646):8.409208149):0.6014807552):0.05366170519):0.121344885,((t364:4.431565572,t365:4.373491386):5.053616937,((t366:1.287510006,t367:1.199543208):7.612035239,(((t368:0.4278019406,t369:0.304240542):0.0977535025,t370:0.3305716478):7.964576721,(((t371:0.07131656547,t372:0.05354204735):0.6165075123,t373:0.6039402492):5.049881067,t374:5.537411574):2.475998093):0.2228506561):0.4395779357):0.4430791306):0.2418792851):0.04672346569):0.07743420562,(t375:0.3955373501,t376:0.2520017678):8.935680184):0.1635980251,((t377:2.654381846,t378:2.651581677):5.434436273,t379:8.035896916):1.211858472):0.2325823538):1.850610122,(((((t380:4.2859087,(t381:3.66671716,(t382:0.4182356192,t383:0.3641989828):3.004697741):0.5601108914):0.818089081,t384:4.545955025):3.412070762,((((t385:1.511567126,t386:1.454508684):1.667106699,t387:2.77818422):1.905595181,(t388:4.333273618,t389:4.28074415):0.2607539034):1.90818329,((t390:4.844963112,(t391:4.165652112,((t392:0.9585506944,t393:0.8785241293):0.6756099682,t394:1.531210442):2.482765043):0.6443707113):0.7912541331,(t395:4.364622429,t396:4.133455967):1.022147478):0.7705127585):0.9186097876):0.269240951,t397:7.101309014):1.218497476,((t398:7.648974058,t399:7.640392853):0.1850617438,((t400:6.902176123,((t401:1.964079593,(t402:1.36422692,t403:1.363829108):0.5240048842):1.936172006,t404:3.75390028):2.990615294):0.3817032258,(((t405:5.547267779,t406:5.462114483):0.492473362,t407:5.787775141):0.9121852816,(t408:5.893334534,((t409:2.710752271,t410:2.675856535):2.904950609,t411:5.559223414):0.2581469247):0.7299183029):0.1511053779):0.4873104491):0.4099812679):1.281655405):0.5886323174):0.8728974209,(((((((t412:3.320442294,(t413:1.650851363,t414:1.464329434):1.566610931):1.639656663,(t415:4.233787908,((t416:2.91996604,t417:2.902588867):0.09706184073,t418:2.972422151):1.192459196):0.4124385025):0.6504491463,((t419:4.077152,(t420:1.686066571,((t421:0.6942306659,t422:0.5651993365):0.9018767931,t423:1.437885468):0.05210086733):2.363284257):0.687460815,(t424:2.618835119,t425:2.580306672):1.890577296):0.4238704599):1.25293335,((((t426:2.647616911,t427:2.568618056):2.175682947,((t428:4.593350143,(((t429:1.319293376,t430:1.258339047):0.5055919856,t431:1.575514398):2.38912508,t432:3.948024666):0.3205653949):0.05791674401,(t433:0.5727667349,t434:0.5033216013):3.745597986):0.02786253361):1.029355966,t435:5.219665504):0.08799411171,((t436:3.212745178,((t437:2.353132896,t438:2.2035051):0.56761585,t439:2.74789937):0.252579622):1.805126025,t440:4.795938527):0.1687824697):0.187235173):0.3010603225,((((((t441:2.321133517,t442:2.308316667):0.3317842917,t443:2.630106528):0.8155262896,t444:3.444971051):0.4532356731,((t445:1.940413154,t446:1.863716688):0.2203729658,t447:2.040909051):1.060745291):0.3661395904,(((t448:2.507957378,((t449:1.552116454,t450:1.545061958):0.1192928886,t451:1.624933777):0.7253402838):0.2511550787,t452:2.445435538):0.6675116823,(((t453:2.217912522,t454:2.081632864):0.1908341164,(((t455:1.04222596,t456:0.9521242079):0.08801639805,t457:0.9995031561):0.8095616332,t458:1.670675637):0.3232045568):0.5863153825,t459:2.549529093):0.02482706544):0.01627211538):0.02377228614,((t460:0.9694304224,t461:0.8878066679):0.1215082146,t462:0.9940428217):1.516677304):0.9679313727):0.04409130198,(((((t463:1.101104925,((t464:0.5747431277,t465:0.4137847799):0.01233137049,t466:0.4077344947):0.4886483984):0.05047980248,(t467:0.7807372481,(t468:0.2835302141,t469:0.1625105173):0.4419746107):0.1538313259):0.1315043506,t470:0.7493836285):1.020626783,t472:1.621845501):1.029646107,((t473:0.7681471685,t474:0.7096296258):0.2454387008,(t475:0.3618723296,t476:0.2723427943):0.09932891174):1.524004885):0.1463457257):0.4056836465,((t477:0.9419947811,(t478:0.6410108335,t479:0.620568547):0.2451770858):0.2366265818,t482:0.7416851366):1.166708371):2.225263984):8.076586315):11.69027951,((t483:1.574029828,t484:1.558246636):0.0899638851,((((t487:0.1540192951,t488:0.1242965733):0.225305825,t489:0.3492571124):0.01480331675,t490:0.2796251007):0.6242847708,t491:0.7414084889):0.3308454316):22.20219145);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T80.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
