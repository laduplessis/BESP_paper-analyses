<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t472:0.07779040498,t473:0.07260536946):0.3323227277,t474:0.3965373888):1.185547534,(t475:0.5888341375,t477:0.4302474338):0.7664136791):10.93083533,t478:12.12394388):25.53063515,(((((((t479:0.139719426,t480:0.1280638737):0.07882481938,t481:0.1235123353):0.5393381147,t482:0.5289206581):0.280797034,(t483:0.3805136677,(t484:0.1753130245,(t485:0.06596386811,(t476:0.005923748465,(t470:0.1046176134,(t464:0.0446920747,(t450:0.062967163,(t369:0.04057115083,(((t355:0.2173917039,((t335:0.2410329886,(t326:0.009999548593,((((t245:0.03669984735,((t238:0.9121451114,t240:0.5346617537):0.1435868463,(t241:0.008365822064,(t239:0.1697456211,(((t124:0.06714779076,(t120:0.002453135842,(t117:0.2481910708,((t111:0.1968332821,t112:0.1224202894):0.1809909805,((t103:0.01056473585,(t102:0.1808820458,(t93:0.2484102978,((t39:0.03357447475,(t19:0.09495495988,t1:1.475010773):2.012936642):6.069722465,((t2:8.745686544,t3:8.726694158):0.1084706712,t4:8.652138657):0.3931818926):0.1273914504):0.6856468325):0.02893102488):0.4586864953,(((t5:1.124351009,t6:0.9805112272):0.05370697252,t7:1.022430204):7.582981826,((t8:8.290392405,t9:8.288797161):0.1889894356,(t10:7.703541426,(t11:5.919331435,(t12:5.491747209,t13:5.424457883):0.3848437959):1.617225453):0.7460362486):0.08698156323):1.384456003):0.8341552098):0.7132026136):0.1038905624):0.494367623):0.2626534311,((t14:8.972718059,(((t15:0.002766144331,t16:0.002135935574):3.216542,((t17:0.1013973081,t18:0.1006319663):1.01700709,t20:0.9875136767):2.088036745):2.556189804,(t21:1.351422773,t22:1.256574673):4.108882344):3.073159691):1.74505836,((((((t23:6.636936482,(t24:2.63244178,((t25:1.053732164,t26:1.022580729):0.7187353337,t27:1.355022011):0.8330908728):3.945962048):0.9893937571,t28:7.09891055):0.9128900908,(t29:3.301795499,t30:3.197611684):4.428026288):0.5032874908,(t31:7.661782322,((t32:6.873936031,t33:6.809795431):0.6332092185,((t34:0.692961145,t35:0.4815420771):2.147923846,t36:2.546954377):4.503276431):0.0934393942):0.3270685808):0.1984500872,(((t37:4.610972653,(t38:1.112862936,t40:0.6792155204):3.444330798):2.12833346,(t41:4.104122518,((t42:1.447220163,((t43:0.3855679782,t44:0.3758538651):0.4226734235,t45:0.7940212613):0.4891905842):1.502354783,t46:2.762870813):1.007349745):2.031373509):0.08779776278,((t47:2.391937887,t48:2.24476388):0.9730321904,t49:3.200651015):2.486637843):0.8195314922):0.8865675426,(t50:6.737585003,(t51:5.305826143,t52:4.944746426):1.414561508):0.5140072124):0.03960881863):1.319671099):1.898860695,((((t53:0.3170305097,t54:0.1761612764):5.353252487,(t55:4.048670623,t56:3.99943235):1.308225496):1.544550768,(((t57:5.989026579,t58:5.844005154):0.07780700569,(((t59:1.473262649,t60:1.226394631):3.031614446,(t61:3.476504415,t62:3.417098338):0.6333610441):0.8054095527,((t63:0.7647208979,t64:0.4637538048):1.742334661,t65:2.197575065):2.154470998):0.4193733667):0.468238444,((t66:1.575302366,t67:1.381299422):1.541516031,(t68:2.651463171,t69:2.553102861):0.2228651418):1.637177643):0.1587531572):0.3079129246,(t70:2.644286449,((t71:1.741336385,t72:1.689211548):0.4798808634,(t73:2.011127401,t74:1.918233155):0.1273496446):0.3966522976):2.193310728):2.496172186):8.706659459):0.4107326868):0.3067901241):0.5185544045):0.3537902368,((((((((((t75:1.304570855,(t76:0.04954962832,t77:0.03335559907):1.252787191):1.425686145,(t78:1.924256062,t79:1.857649637):0.6986292467):0.07189569418,((t80:0.2534504465,t81:0.08411536337):0.05420452202,t82:0.0773903495):2.299651589):0.5831498571,((t83:0.3361356161,t84:0.2740206584):0.2675216106,t85:0.2450818585):2.353893604):0.2315333177,((t86:2.283314822,(t87:1.220615257,t88:1.209242652):0.97721915):0.0317124616,t89:2.198619892):0.4809209884):1.852488426,(((((((t90:0.2396650752,(t91:0.1465467709,t92:0.0556906775):0.08514402795):0.5358745799,t94:0.1941119106):0.05371779293,t95:0.003001471851):0.1576597068,t96:0.1571236895):0.733415947,t97:0.8889362953):0.4250746836,((t98:0.2264775076,t99:0.1764589796):0.8401452629,(t100:0.063731943,t101:0.04630729624):0.9231597241):0.1901982334):0.002928687451,(t104:0.7190383981,(t105:0.3139831883,t106:0.01152280517):0.2609020497):0.1107137812):2.268666767):0.4818303829,t107:3.082231844):6.941936789,(((t108:0.7633908143,t109:0.7500912481):0.5347645634,t110:1.256879195):8.043758637,(((t113:0.1917155445,t114:0.09753039469):0.1302891804,t115:0.1436204939):1.50257728,t116:1.603496068):6.772565914):0.5562922178):0.7790877558,((t118:0.5562262284,t119:0.5170195667):1.740153366,(t121:1.431277648,t122:1.418872407):0.7446694105):7.028620617):2.258707521,((t123:6.7933214,(t125:4.434097766,((t126:0.3381692369,t127:0.307627986):3.549103502,(t128:1.046495335,t129:0.9578695664):2.710257859):0.3621965187):2.193851319):1.152417208,t130:7.317671758):3.144533689):1.466550658):3.98214541,(t131:9.7381842,(t132:8.318184653,(t133:1.612325893,t134:1.5795969):6.692780841):1.406358559):6.172197384):0.6248663817,((((t135:0.5182792622,t136:0.4184826136):8.821951726,(((t137:4.937709193,(t138:0.2933462511,t139:0.2889808805):4.63587041):2.889858649,t140:7.710821432):1.300798089,(((t141:2.088738175,t142:2.076516697):5.147105365,(t143:6.594577686,(t144:1.382727888,t145:1.288970776):4.955653002):0.3764770504):0.5521020859,(((t146:0.8860601317,t147:0.7874269932):3.578919069,t148:3.982694622):1.370204761,t149:5.263618862):1.334572521):1.213675621):0.08769703888):0.6158205684,((t150:3.264182756,t151:3.254458347):3.498019832,(t152:6.201875878,(t153:0.2329357161,t154:0.1752365666):5.818220078):0.5326772964):1.717625864):3.148952342,((((((t155:2.648938213,t156:2.448790991):3.523129444,(t157:5.342689514,(t158:3.264989011,t159:3.194629256):1.982051409):0.4260202672):1.200424969,t160:6.766972231):0.1767745894,(t161:6.468119931,(t162:6.203735152,(((t163:3.240703406,(t164:1.558501919,t165:1.549840837):1.647940914):2.460650437,(t166:4.973138113,(t167:3.844345967,t168:3.702289839):1.078034931):0.6173370672):0.2868380427,(t169:0.4173955969,t170:0.409662697):5.250597565):0.1889449829):0.2467384767):0.3855220885):0.6598979856,((((t171:3.672277241,t172:3.606666905):1.454465747,((t173:0.3341370357,t174:0.3034657577):0.9812761783,t175:0.9021460481):3.520880966):1.231816991,(((t176:4.71284403,t177:4.435303589):0.2951288697,(((t178:2.416355571,t179:2.375660387):1.379714646,(t180:2.618408376,t181:2.520734603):1.109141288):0.4747158995,(t182:3.892287082,(t183:1.404171744,t184:1.369292982):2.151964184):0.2045625754):0.3684934259):0.2568540987,(((t185:3.247437066,(((t186:1.246033128,t187:1.180400939):1.343271243,t188:2.487650626):0.4391657489,t189:2.821794801):0.04472916798):0.6693039662,t190:3.472022958):0.2463350989,(t191:1.645467433,t192:1.537741933):2.047911371):0.1423636356):0.01906388677):0.485041826,(t193:3.452910738,((t194:1.063205536,t195:0.9249983303):2.00482489,t196:2.830934847):0.3781110602):0.7624346956):0.2903282357):1.457061817,((((t197:2.444655482,(t198:2.238923742,((t199:1.004876538,t200:0.8293106933):0.1615204104,t201:0.9219379994):0.855028073):0.1541017545):0.3182782537,(t202:1.244567972,(t203:0.7300051772,t204:0.6665340276):0.447277293):0.9220941476):0.005233096843,(t205:0.4702558913,(t206:0.4103345219,t207:0.3083373424):0.02985279825):1.534327171):0.8566943448,(t208:1.665045053,((t209:1.012134208,t210:0.8144335865):0.2634014164,t211:0.8039446887):0.1481154455):0.9543438681):1.726228485):1.703419062):3.319701631):2.363603054):0.6886670653):1.808128994,(((((t212:0.1489553502,t213:0.1424639779):0.7232512956,(t214:0.5226378637,(t215:0.2449876256,t216:0.2218241207):0.2767096134):0.340016321):0.4044666601,t217:1.203313077):6.816375291,(t218:0.8095734272,t219:0.7263625431):7.159168118):0.9630877917,((t220:0.141142687,t221:0.08414072467):0.4598992347,t222:0.493475613):8.227412793):3.907342586):0.5593761029):0.09307930664,(((((t223:4.639428056,((t224:2.098112267,t225:2.044512031):1.054434606,(t226:1.163497621,(((t227:0.1674731912,t228:0.1580738093):0.1557967757,t229:0.3117393804):0.09901372205,t230:0.3751773056):0.7049980509):1.86066073):1.454230381):6.894459564,(((((t231:0.805994358,t232:0.7904199084):1.996534078,((((t233:0.1491033112,t234:0.08357971935):0.1674202619,t235:0.2227709021):0.136358539,t236:0.1426864244):0.3886153981,t237:0.2023502085):1.890423006):0.9785484397,t242:1.755835124):1.695398389,((t243:0.9970458712,(t244:0.6048402015,t246:0.2735895823):0.3922014704):1.945653544,t247:2.586321539):0.2581853581):5.441650295,(t248:7.525024368,t249:7.487205927):0.673578542):0.2511174503):0.8894672302,((t250:7.102297957,t251:6.8497188):0.1887802789,t252:6.982069378):1.987124306):0.02995483141,((((t253:0.5835021013,t254:0.5121891448):6.896332388,t255:7.375727024):1.285544341,(((t256:3.993544682,(t257:3.956779513,t258:3.727105148):0.01530822559):3.694969585,((t259:5.95358441,t260:5.615316044):0.1254244476,t261:5.678329045):1.271246812):0.83390451,(t262:7.254666746,((t263:3.238441101,t264:3.123780996):3.038686803,(t265:5.598428801,(t266:2.199219631,t267:2.153037865):3.237854276):0.4874890362):0.9496686997):0.5225685036):0.05787541255):0.01863278504,(((t268:0.6763244985,t269:0.5726589557):2.024462682,t270:2.565942405):4.190689552,t271:6.69480933):0.5226198624):0.2031223274):0.2811867629,(((t272:2.816127604,(t273:0.5824092477,t274:0.4133952017):2.216970391):2.995247372,((t275:1.670785502,t276:1.494385758):2.098736499,(t277:1.758368667,t278:1.681004251):1.676016122):1.745574026):1.500712033,(((t279:1.429944782,t280:1.391786003):4.938197343,(t281:5.32082849,(t282:3.79069797,t283:3.694038151):1.444333323):0.8030559559):0.04685766945,(t284:5.934561477,(t285:4.317604654,(t286:2.002430889,t287:1.966810836):1.97272293):1.352479138):0.02953330344):0.09088292441):0.3852698098):0.5011718002):1.845261191,((t288:5.164813623,(((t289:0.6076457937,t290:0.5865441098):2.125706439,t291:2.589166208):1.840080804,(t292:3.956996487,t293:3.936817118):0.3437596888):0.5319116124):2.246344033,((((t294:3.260707017,t295:3.117834279):1.675238093,((t296:3.687536332,t297:3.651360387):0.2592994574,t298:3.807392254):0.7441886649):0.2068470275,(t299:3.528888045,(((t300:0.8775474656,t301:0.8749153594):1.575560769,t302:2.43301649):0.6297060398,t303:2.996899836):0.3725057885):1.122848481):1.182779953,((((t304:1.588072057,t305:1.098215506):1.334426184,t306:2.431709584):0.1034111561,(t307:2.117124516,t308:2.04135995):0.3763312347):1.492598097,(t309:2.965066159,t310:2.895542624):0.9050360851):1.035574044):0.6560408276):0.7218150782):0.1108875047):7.838696398):0.7913624848):0.4658868679):0.4973148451):0.8141717753):0.08362848606):0.09105350483):0.3142733789):1.470891618,(((((t311:2.454461713,t312:2.428316017):0.5050182391,t313:2.610974819):3.230990886,((((t314:2.542050727,(((t315:1.600863313,t316:1.593117081):0.1521631664,t317:1.659487243):0.170867478,t318:1.783752147):0.5029233721):0.7334848978,(t319:2.665977335,(t320:2.524620285,t321:2.407855018):0.1334264728):0.2798224972):0.8978531948,(t322:0.2214297424,t323:0.2166672228):3.451986211):0.7877630107,(((t324:3.304284388,((t325:1.741613698,t327:1.714763432):0.240492888,(t328:0.3045692356,t329:0.2749674102):1.645058153):1.131429252):0.1734611605,((t330:0.8828649332,t331:0.8192567301):1.802960593,(t332:0.1000331906,t333:0.02179125511):2.514176299):0.4697907596):0.3155583945,((((t334:2.078467595,t336:1.576468002):0.07537179767,t337:1.580152839):0.2879297778,t338:1.530852755):0.4804608125,t339:1.664025589):0.2364049244):0.6327502475):0.7662336801):9.650358673,(((t340:2.12805957,(t341:0.5831370186,t342:0.5603009141):1.447980011):0.9090993306,(((((t343:0.1770833356,t344:0.1582920298):0.008718858611,t345:0.1528775449):0.1730071191,t346:0.1894951314):0.5265847543,t347:0.621968636):0.8657770357,(t348:1.22894355,((((t349:0.3359083233,t350:0.20197179):0.2157433453,t351:0.2471243729):0.007996256237,t352:0.1484380002):0.1659128662,t353:0.275377359):0.4779379952):0.2231846341):1.140481169):9.410802294,((t354:0.8549021451,t356:0.4099561858):9.471852703,(t357:4.875616603,(t358:2.115760103,t359:1.953545213):2.264559659):4.582901231):1.109293076):0.4428701188):0.2256711814,((((t360:0.9410392426,(t361:0.223052701,t362:0.1891911677):0.5945640661):7.708922899,((((t363:1.451326441,t364:1.383669208):3.287353514,t365:4.599864387):0.1360321008,t366:4.727234845):2.108429057,(t367:3.830022822,(t368:0.9752251659,t370:0.8050138377):2.692456472):2.81093314):1.499137889):0.7773330861,(t371:3.495478122,t372:3.425808879):4.977194941):0.1377016274,(((t373:3.462672246,t374:3.411549346):4.748611093,(t375:7.385170787,((t376:5.638803379,t377:5.621817715):0.5739553221,t378:6.07010676):0.8157181274):0.5777211302):0.04093521148,t379:7.417591774):0.2682504835):0.9060794666):2.616638857):11.37006068,((((((((((t380:2.765854289,(t381:0.1204710237,t382:0.03003965802):2.226330677):3.335500539,t383:5.553209527):1.545723349,(t384:6.511191517,(((t385:5.71387936,t386:5.558739654):0.05938132466,t387:5.608036122):0.4522864874,t388:5.995681338):0.2495143457):0.5780869637):0.1755716523,((t389:0.4794366364,t390:0.4611272122):6.422027361,(t391:6.639353306,((t392:2.471947697,t393:2.390072227):2.197066019,(t394:0.7043716064,t395:0.4514553867):3.858732505):1.297399351):0.2370096348):0.09288185157):0.08846393954,t396:5.992297856):0.5988343485,(t397:5.010269977,(t398:4.028980365,t399:4.014639607):0.9659718049):1.314069788):0.08582773045,(t400:5.399260085,(((t401:5.091960309,t402:5.001742462):0.008013901425,t403:4.98311114):0.02440796669,((t404:2.089642143,t405:1.841518718):2.124385926,t406:3.964859296):0.7815319801):0.1969114135):0.9663892555):1.40669433,((t407:4.622019401,(t408:4.399951431,(t409:3.50000705,(t410:3.050039337,(t411:0.9463372766,t412:0.8153469669):2.088378843):0.3301762376):0.8557740391):0.1892110079):2.256221942,((((t413:0.358657582,t414:0.1791231095):3.761328835,((t415:2.169143229,t416:2.15001237):1.697093338,((t417:0.7538989295,t418:0.6760753534):0.8821685865,t419:1.445659641):2.090699425):0.03585320902):0.6554061815,t420:4.200786276):0.6206049857,(t421:4.732982332,((t422:3.238780796,(t423:2.09075865,(t424:0.7348858117,t425:0.538947448):1.318422089):1.138425658):1.024862907,t426:3.919786316):0.3800912742):0.009339249361):0.6465871264):0.3124841729):1.316257137,(((t427:2.537036517,((t428:1.477204616,t429:1.345840259):0.4404535904,t430:1.510201312):0.5624884782):0.2961010166,((((t431:1.232126537,t432:1.227762034):0.5934822936,t433:1.792219537):0.1319551941,t434:1.839043672):0.04591899264,t435:1.830843579):0.3011751684):0.6660725945,t436:2.677424533):3.072382892):9.042034806,((t437:2.26154448,t438:2.108073099):1.419115352,(((t439:1.612224628,t440:1.512996157):0.5049384976,((t441:1.032049735,t442:0.9987745185):0.8658842089,(t443:1.066967562,((t444:0.1171331296,t445:0.1091225843):0.6812090199,t446:0.72672579):0.1219620764):0.6952114132):0.1005474852):0.6773202292,(t447:0.9426648482,t448:0.9402674237):1.370319387):0.6606653128):10.91676037):2.202423924):10.01101611,((t449:2.692023256,((t451:0.4552712436,t452:0.4064102592):0.3007067046,(t453:0.4795098911,t454:0.393030041):0.1673796609):1.672644804):19.16741435,(((t455:1.152286638,((t456:0.3321633302,t457:0.3118479672):0.3062730311,(t458:0.3772198767,t459:0.3749569789):0.2113013273):0.4989852814):0.298441689,t460:1.383442894):1.902760335,(((t461:0.2168031359,t462:0.203158733):1.019872429,(((t463:0.4350585809,t465:0.3023853923):0.1054200027,t466:0.3372632677):0.6424542084,((t467:0.3112353956,t468:0.2048438768):0.005947173446,t469:0.1947188864):0.5472780131):0.004543468328):1.236909415,t471:1.791885808):0.8016582902):17.86354146):4.131015865):13.512554);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T5.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
