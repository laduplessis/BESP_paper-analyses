<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t485:11.45217234,(((t486:0.07408620867,(((t476:0.01305394129,(t474:0.06786057519,((t466:0.1105309942,(t415:0.1757029876,(t364:0.05109229657,((t340:0.1019645523,(t338:0.01596957179,((t302:0.03325656175,(t298:0.01725940724,(t291:0.02561320371,(t283:0.07562140929,((t244:0.06152489411,((t241:0.002129252603,((t230:0.1751818877,t231:0.1253917134):0.2800989777,((t232:0.2152197662,t233:0.02590674517):0.009556355598,(t228:0.005952196413,(t148:0.04398521102,(t147:0.1099212629,(t141:0.04212024338,(((t53:0.06317885924,(t1:0.4708464081,t2:0.3396768631):4.39937891):5.170715687,(t3:7.236653181,(t4:2.054680369,t5:2.046213058):5.078811001):2.622568926):1.874657279,(((t6:2.734043826,t7:2.604598282):4.11814771,t8:6.664769248):3.314822394,((((((t9:1.379374251,t10:1.357146572):3.958346256,t11:5.241979869):2.569881318,(((t12:1.638824551,t13:1.476103669):0.7112398373,t14:2.171689589):5.449785011,(t15:0.8729650316,t16:0.7309858769):6.713296595):0.004341496545):0.8782538639,(t17:1.012815956,t18:0.6784250158):7.300899736):0.6611006715,((t19:1.308353006,t20:1.26792044):3.016286338,((t21:1.390563151,t22:1.363183956):0.04865736706,t23:1.219163195):2.783050972):4.289832298):0.2308096676,((t24:0.4526640674,t25:0.380744419):2.713116734,t26:3.075780449):5.27972895):0.2672791574):1.320934184):1.10014933):0.4204099526):0.1560475588):8.249884929):0.4698531942):0.1654789041):1.096026821):0.4081788411,((((t27:8.424132933,t28:8.195795101):1.121514764,((((t29:1.733735745,t30:1.655874708):5.430221718,t31:7.005769948):1.572207392,((((t32:1.505614937,t33:1.306230954):1.848130534,t34:2.897461916):3.652048252,t35:6.53661659):1.148393006,(((t36:6.716382766,t37:6.514285356):0.08355564701,t38:6.402518915):0.5045240759,(t39:1.409882461,t40:1.383167247):5.456511395):0.325962895):0.2020299396):0.2092654371,(((((t41:0.3475427763,t42:0.1875037896):5.843148551,t43:5.988679201):0.5042114073,((t44:3.330463597,t45:3.325947879):2.443823439,((t46:4.872810807,t47:4.772956193):0.6451615644,(t48:1.238438194,t49:1.198102884):4.070619377):0.241456034):0.6822865541):0.3175788666,((t50:5.620239405,t51:5.571937406):0.2037253082,t52:5.616822643):0.4088955281):0.1005658227,(((t54:3.593677962,t55:3.593036476):1.755718662,(((t56:0.3932586817,t57:0.2754431709):2.397145543,t58:2.670888954):0.342496917,t59:2.959888266):2.159719405):0.310047748,t60:5.409211665):0.1333882467):0.4445076549):0.2804262752):10.68519087,(((((((t61:0.4987448191,(t62:0.1792682039,t63:0.06124442555):0.2134980271):0.4631865289,t64:0.653595165):3.166939699,t65:3.771741968):2.638736043,(t66:4.097462571,(t67:3.545644026,(t68:2.579716212,t69:2.569395262):0.8537278171):0.377390263):2.230022771):1.879522097,(((t70:3.672821661,t71:3.62854556):0.8841917087,(t72:1.583145315,t73:1.572852877):2.864227805):0.6445328186,((t74:3.65940418,(t75:3.007167795,(t76:1.133010475,t77:1.077310987):1.707859148):0.6329267728):0.9578674111,((t78:3.473312468,t79:3.40286363):0.8646833168,(((t80:1.539349013,t81:1.417114087):1.213080066,t82:2.455795476):0.4622175649,(t83:2.804296652,t84:2.779058409):0.0403811293):0.9734693935):0.008837876236):0.1436273621):2.614950493):7.507102345,((((((t85:2.833287537,((((t86:0.8437761131,(t87:0.3001352088,t88:0.2809911184):0.5214808324):0.1889750439,t89:0.8906367505):0.3952175534,t90:1.20863585):0.9776730111,t91:2.007633897):0.3539815422):0.260282422,(t92:0.888261992,t93:0.8571426272):1.714378978):0.6979312664,(t94:2.432869791,t95:2.416384347):0.7875927623):0.661119631,((t96:2.863260288,t97:2.748987664):0.2240944564,((t98:2.133012712,((t99:0.3502968917,t100:0.3481397405):0.8693829804,t101:1.15175926):0.8448173647):0.4864590361,(t102:2.31078385,t103:2.177688962):0.1511559171):0.3532681639):0.7073570835):1.37106884,((t104:0.4182819082,t105:0.3132632771):2.154242796,((t106:0.7793587061,t107:0.6553080964):1.498400141,((((t108:0.5545159418,t109:0.4046436588):0.815087512,(t110:0.5244409998,t111:0.457296387):0.6021487158):0.3424728896,t112:1.320833322):0.1394788524,(t113:0.369960887,t114:0.3365546647):0.5131337754):0.2811493341):0.05298100118):2.110183454):0.9813640855,(((((((t115:0.4989171633,t116:0.4293232596):0.57576764,t117:0.8715423214):0.1199843158,t118:0.8720094473):0.09721572218,t119:0.946311971):0.1352219089,((t120:0.212171466,t121:0.1255379472):0.4608527922,((t122:0.2322620415,(t123:0.03382649978,t124:0.005189141795):0.1092618406):0.1297011348,t125:0.1505952977):0.1869039932):0.3977945957):0.2324875287,t126:0.8047813):0.04368006492,t127:0.5232100409):2.549338168):7.188433641):0.1446427188,((t128:1.038690062,(t129:0.3166227673,t130:0.2853019044):0.5084052974):0.2925476232,t131:1.022854396):8.966448835):0.5134247736):1.299442793,((((t132:0.8373298046,(t133:0.2544405439,t134:0.0693780959):0.5689859884):5.995138146,(((t135:0.1646088621,t136:0.1237883403):0.220200405,t137:0.3390260071):0.1368226445,t138:0.3234231301):6.032546917):3.417006745,((t139:0.2572954525,t140:0.2145820521):2.907376606,((t142:0.5164807533,t143:0.4879647662):0.03107603311,t144:0.4446432489):2.389012094):5.961348857):0.2061862397,t145:8.920557812):1.31745154):0.4757556527):0.09469302469):1.739442814,((((t146:10.36097696,((t149:7.239679765,(t150:5.322041082,t151:5.300781343):1.789263451):1.669654974,((t152:0.07268433956,t153:0.02709510209):8.174767369,(((t154:3.373481717,t155:3.349536474):2.614288218,t156:5.675091825):2.198288011,((t157:7.056776696,(t158:4.84617927,(t159:1.384989178,t160:1.339605735):3.292687368):2.162378638):0.2103422888,(((t161:1.176011148,t162:1.154454259):2.100827723,(t163:2.530821048,t164:2.42699719):0.5220106516):0.2432491329,(t165:0.3985080631,t166:0.1775839808):2.635909517):3.37688452):0.5049600798):0.00183463527):0.4623411137):1.095214506):0.6079841622,((((((t167:6.284567018,t168:6.268241692):1.013505157,((t169:7.024350956,(((t170:5.335368997,t171:5.17849595):1.199990609,((t172:4.145982067,t173:4.076461997):1.376786395,(t174:1.585960485,t175:1.342331763):3.516013517):0.794901736):0.2441667346,(((t176:0.4646051439,t177:0.4001192652):3.966491898,t178:4.164003561):1.089258178,(t179:4.661044657,t180:4.604956882):0.5785046878):0.3707097362):0.1475525047):0.1679066059,(((t181:3.334955177,t182:3.289542263):1.918550227,t183:5.04745551):0.404043499,(t184:0.5653122699,t185:0.4091614436):4.852349968):0.1147096843):0.01083673023):0.1693362684,((t186:0.0323068995,t187:0.02781480662):4.928332225,(t188:0.9026439221,t189:0.8744384929):4.025241146):0.4598048927):0.07576454696,(t190:4.455696015,((t191:3.368615586,t192:3.35255895):0.767059541,(t193:2.874223039,(t194:2.594737008,t195:2.340072715):0.1616079004):1.18858569):0.235792927):0.6251532648):0.05493886594,((((t196:2.254820549,t197:2.242254968):1.012011734,(t198:1.244254009,t199:1.154157493):1.759683091):1.040866985,(t200:1.714440375,t201:1.703255778):2.136747818):0.233053677,t202:3.752210562):0.0617604):0.2869342455,((t203:1.846480773,t204:1.786313228):2.001714703,t205:3.68020863):0.05203637268):0.7977965777):0.265853276,(((t206:2.363777265,((t207:1.161104075,t208:1.158940038):0.134234484,t209:1.164137239):0.9058235645):0.5046665129,t210:2.566572305):1.004353448,t211:3.51224935):0.8867178451):1.087869815,((t212:4.408249142,((t213:2.630655685,((t214:2.171347505,(((t215:0.6592359165,t216:0.6270563765):0.8221410006,t217:1.287516184):0.3735128695,t218:1.581054402):0.1802155838):0.2224152192,(t219:1.895186026,t220:1.790770678):0.07734046076):0.2089161172):0.4063758304,t221:2.418842743):1.240452648):0.2082088711,(((t222:2.624594301,t223:2.578994956):0.0799582116,(((t224:1.117483931,t225:0.9294146881):0.5180926397,t226:1.438117849):0.7663189914,(t227:0.3128283631,t229:0.1939918228):1.606526847):0.2196990563):0.0197030741,t234:0.9783734829):0.9120151684):0.8249535887):0.1954239053):3.067066069):0.687804693):0.6207514678):0.3544247596):0.8429040318,(t235:2.40848488,t236:2.39694617):6.041321163):1.768582778):0.3214634826):1.918498434,((((t237:0.9705004272,(t238:0.6295943926,t239:0.470516771):0.2635099696):0.03419168719,t240:0.6701727322):10.23548299,(((t242:3.484664431,((((t243:0.1449500584,t245:0.03871282941):0.3176748597,t246:0.2276898821):0.3715594263,t247:0.4975756853):0.9776177159,t248:1.432838362):1.311588928):6.856910388,(t249:8.040726155,(((t250:0.3297929409,t251:0.2285698507):0.8836094991,(t252:0.4999213267,t253:0.4598836518):0.426204002):5.153536204,((t254:0.3894803509,(t255:0.1919022527,t256:0.1119025176):0.07873785265):5.069651163,t257:5.256482103):0.3891346277):1.530948012):1.355987088):0.0323069898,(t258:6.69759619,t259:6.651606085):1.554711143):0.44484298):0.121718589,((t260:4.27974776,t261:4.103993979):4.097495312,((t262:4.644315428,t263:4.53008752):1.249011682,t264:5.681000213):2.053268993):0.03479857516):0.8308372511):0.688655881):5.986146401):3.951736587):0.2331905231,((((((t265:7.517099478,t266:7.333301104):0.7585866522,(t267:7.464924623,((t268:0.5172768801,t269:0.4996374861):4.616513576,(t270:3.54914837,(t271:3.454198677,t272:3.450900462):0.08106085119):1.492303976):2.300113433):0.4074965986):1.124286355,(((t273:5.673691848,t274:5.459896328):2.429085418,(t275:7.484070062,((((t276:0.6664195538,t277:0.6197284555):0.5074913874,t278:1.079322206):1.009368428,t279:1.989503094):3.170051794,t280:4.991868155):2.107082899):0.3459969356):0.1824234382,((t281:3.385316721,t282:3.351666238):1.845178523,((t284:0.8447244964,t285:0.7120868951):2.770910604,t286:3.46590387):1.369389728):1.706757283):0.5595098151):0.3316119911,(t287:5.634206811,(t288:3.088680112,t289:2.937734804):2.517864834):1.660558074):0.4082919362,(((((t290:0.2544751813,t292:0.1404692789):2.459213423,t293:2.513675647):0.6118465533,t294:3.001896021):0.3121866554,t295:3.251050075):1.091867998,(t296:3.907651123,(t297:2.933853039,t299:2.699818066):0.8069079745):0.347653755):2.715123447):1.791306829,((((((t300:3.836605164,t301:3.812611745):0.3558956276,t303:4.064627375):0.2411701779,(t304:2.722166512,(t305:2.652997993,t306:2.54211225):0.06705655108):1.492717437):0.1665015076,t307:4.200511407):0.07529524785,(t308:3.369529815,t309:2.929211633):0.8618333522):0.2047906694,(t310:3.606608027,t311:3.592103249):0.3581496517):3.418676496):7.522540835):0.3478578588):0.3066236963):0.4469814704,((t312:3.512322858,((((t313:2.256717777,t314:2.252127528):0.7352068225,(((t315:1.392238105,t316:1.278807544):0.7308618414,t317:1.975063925):0.8162222392,(t318:0.7351117281,t319:0.6824481369):1.944718754):0.01602940224):0.2506148153,(t320:2.076403447,t321:2.048245945):0.6693248042):0.06803388389,t322:2.719530144):0.1158863352):10.01916847,(((((t323:2.611976957,(t324:2.486937992,((t325:2.088024161,((t326:0.8071880589,t327:0.805059219):0.4784974908,(t328:1.172629424,t329:1.049228986):0.1103093489):0.7999885186):0.1657793163,t330:2.0095012):0.2250224677):0.1097802008):0.001006523423,(t331:1.769827415,(((t332:0.8558257526,(t333:0.7691386808,t334:0.6800686354):0.0192100067):0.2613998366,t335:0.7158504361):0.5015867552,t336:1.15873355):0.1401139523):0.5748339244):1.64234895,(t337:3.310792921,((t339:0.7855929275,t341:0.4790465151):1.807580826,(t342:0.7958267386,((t343:0.2535045612,t344:0.2258823458):0.1476229009,t345:0.2290884576):0.156188442):1.401982866):0.2901623291):0.1145744045):6.37678223,(((((((t346:0.3953726329,t347:0.09843759522):0.1550512678,t348:0.2328822134):0.0001439520045,t349:0.0818864907):0.7598291879,t350:0.769040688):0.8965780495,(t351:0.6839855844,t352:0.6230806113):0.9725845901):0.04798394666,(t353:0.7206115233,((t354:0.1214180398,t355:0.1132564):0.3684933343,t356:0.1865374421):0.02944139488):0.8411352022):2.967094828,(t357:2.177248051,t358:2.134975508):1.819906854):3.324688713):0.5087971782,((t359:1.135156682,(t360:0.9094891177,((t361:0.2111087322,t362:0.004425360538):0.4445270407,t363:0.2844503771):0.2471715472):0.1969878391):0.4379377552,(t365:0.1749901306,t366:0.1582672657):0.6297655784):6.124235979):1.700380001):2.440329381):0.4289715105,((t367:0.6430809673,t368:0.5618282065):9.995092424,(t369:6.979730324,t370:6.919153861):3.567123905):0.7419586527):0.2119494631):0.9692246366,(((t371:0.999215551,t372:0.9980378689):6.608035755,(t373:0.7013052685,(t374:0.2319057457,t375:0.0385012863):0.249720495):6.795796879):4.460126884,(((((t376:7.618790979,(t377:5.414202792,((t378:1.708986224,(t379:0.2728042251,t380:0.270051658):1.274422401):3.610467416,t381:5.118902267):0.05862081825):2.170200266):0.6385015391,t382:7.8703147):1.308586569,((t383:0.5019719154,(t384:0.07590822093,t385:0.03549103541):0.276334207):7.112110874,t386:7.376074266):1.526426063):0.2759445353,(((t387:6.47186747,t388:5.641122465):0.7580370478,(t389:5.166647475,((t390:2.687706361,t391:2.424750079):2.428046352,t392:4.84689391):0.02537026642):0.8767484606):1.091106216,(t393:6.104054135,t394:6.067639176):0.645492104):0.7971708667):1.546118349,((((((t395:5.761385048,((t396:1.164564417,t397:1.162300868):3.246452649,(t398:3.25450276,t399:3.147580866):1.095165364):1.317548076):0.1658376738,(t400:5.191571792,(t401:5.019969613,t402:4.994467807):0.1434226992):0.4823924563):0.4735013471,t403:6.073879189):0.4712821345,t404:6.522652434):0.003727355361,t405:5.978543364):1.522798369,((((((((t406:1.269963332,(t407:0.501485723,t408:0.2535306969):0.7665497951):4.554730884,((t409:1.772094999,t410:1.72017665):0.5271176575,t411:1.933394043):3.267350657):0.06635799901,((t412:0.4531284071,t413:0.3576088468):0.3779108133,t414:0.5377421149):4.360584026):0.1233347091,(((t416:1.83448842,(t417:0.6200138192,t418:0.5178746392):1.155893458):1.838345962,t419:3.494101236):0.2926810434,((t420:2.620836109,t421:2.59396992):0.2989718232,(t422:2.725308299,t423:2.69638032):0.1636575226):0.8612952787):0.5660949882):0.2116904144,((t424:2.177303461,t425:2.052058074):0.02703378899,t426:1.901265891):2.159565389):0.1179880332,((t427:1.713499273,t428:1.685401797):1.332556382,t429:2.793092892):1.092070353):0.4351008544,(((t430:2.752063,(((t431:0.7324891535,t432:0.6870749702):0.9605970375,t433:1.629758321):0.8170665453,(t434:1.691669501,((t435:0.8777673889,t436:0.8743860383):0.6830892106,t437:1.498064008):0.1107534539):0.7511437609):0.2246295223):0.390742687,t438:2.906105733):0.9791994196,((t439:2.021977057,t440:2.017661269):1.076410853,(t441:2.616462842,t442:2.506446162):0.4370893097):0.7562203213):0.1877388008):0.1684280056,((((((((t443:1.241528235,(t444:0.5984638603,t445:0.5787086649):0.6319443404):0.5056666458,(t446:0.4381622119,t447:0.3452409381):1.080246951):0.1380634411,t448:1.54000429):1.175959893,t449:2.67416882):0.1641378813,t450:2.695570282):0.2082699828,t451:2.889632664):0.156035163,t452:3.025733409):0.1564606892,(t453:2.745061803,(t454:0.8178543881,(t455:0.2134736278,t456:0.1816619109):0.5504927076):1.863086312):0.3651382602):0.2956141399):0.3513895085):0.5583758382):0.08816966774):0.3354254729):10.2725758,(((t457:0.9325290139,(t458:0.7920650023,t459:0.778593764):0.02123845462):1.615706031,(t460:1.371550426,t461:1.36406202):0.8443804205):3.978513508,(((t462:0.2836636854,t463:0.2006628052):0.3037637147,t464:0.2790147104):0.6758130836,t465:0.9082338946):4.666619801):8.162807812):0.02992664379):24.00786991,((t467:1.571288285,((t468:0.6806520053,t469:0.5588743101):0.7237332403,(t470:0.2016369546,t471:0.1696642171):1.024249358):0.1587625957):11.54484019,(((t472:2.050295476,((t473:0.5954146474,t475:0.1814852529):0.341491043,t477:0.3927862648):1.028758361):6.228605661,(t478:1.405726095,(t479:0.6350082003,t480:0.4672746954):0.66623214):6.22076449):3.081202702,((t481:0.5126373987,t482:0.4732344947):1.89669528,(t483:0.4677684971,t484:0.4257888941):1.74644588):8.003204517):1.523888636):24.1108928);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T66.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
