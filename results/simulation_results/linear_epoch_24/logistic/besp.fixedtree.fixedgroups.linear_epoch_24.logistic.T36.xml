<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t444:4.610926435,(t445:4.420518049,t446:4.337245483):0.1801900834):1.486445436,(((((t447:3.587173131,t448:3.487749051):0.2474875496,t449:3.725984129):0.0264313347,t450:3.715278927):0.6166430744,(t451:3.411621137,t452:3.229333615):0.4998851553):0.3543083133,((t453:3.432778891,(((t454:2.555378464,(t455:1.481897687,t456:1.119092133):1.070962204):0.3800687658,t457:2.547759619):0.04578132671,(t458:1.246943146,t459:1.091981163):1.287205427):0.3505498244):0.1628397504,(t460:2.560515156,(t461:1.32345819,t462:1.195515864):1.200847106):0.2971140842):0.1454889765):0.9922004051):0.4645372754,(((t463:0.2726035615,t464:0.1271388441):1.211193438,t465:1.299445478):1.603176768,t466:2.852297632):0.9587088741):11.46305498,(((((t467:0.8219067744,t468:0.8109470686):0.4324328519,t469:1.034396874):0.3561774125,(t470:0.4221312543,t471:0.3456159486):0.6907509023):0.1796907218,t473:0.492091173):2.047258686,(((t474:0.3108795471,t475:0.2398662511):0.3605020459,t476:0.5716634488):0.4248894208,(t477:0.5435543282,t478:0.5392973556):0.3832134084):1.42018029):11.25891627):21.85365826,((t479:1.666404462,(t480:0.6263189852,(t482:0.2002904382,t483:0.1257325886):0.1514742185):1.015006591):12.10421984,((t484:1.543467686,((t485:0.4023689401,(t486:0.2549070481,t487:0.02804399443):0.05478158029):0.7291067409,t489:0.7019701559):0.1352168582):2.672998543,(t490:1.722675936,t492:1.323187592):1.68221906):9.121170841):21.65017757):1.867105376,((t491:0.173703441,(t488:0.03584701732,(((t481:0.02842091194,(t472:0.5429017534,(((t410:0.2192672504,((t379:0.1469583386,(t378:0.0811546961,(((((((t294:0.01832138235,(((t242:0.3314587063,(t241:0.05459053602,(((t134:0.1916669957,(((t125:0.08393813978,(t121:0.1799355524,(((t9:0.02322716338,t1:1.234582946):1.136995119,t2:2.250888962):8.17223743,((t3:5.101751981,t4:4.966700052):4.606266747,((t5:3.87300523,((t6:0.5338181592,t7:0.4497262579):1.052087522,t8:1.097762132):2.189768992):5.005909356,t10:8.220202875):0.5259462785):0.5526438316):0.50166453):0.3584237672):0.01226581259,(t11:5.457724,(t12:0.3527641341,t13:0.2997105096):5.039977412):4.664791228):0.3133773386,((t14:8.083293596,t15:8.076292417):1.922856254,(((t16:2.931111168,t17:2.688920769):0.08408123403,t18:2.659156574):5.406483305,(((t19:3.015084201,t20:2.837199334):3.371501191,t21:6.091529173):1.261506615,(((t22:5.604553486,((t23:1.714550338,(t24:0.7451805856,t25:0.7142244482):0.9539816772):3.156862094,(t26:3.241675172,t27:3.232742071):1.497454235):0.6828696001):1.582658137,(t28:6.026622828,(t29:0.6835125917,t30:0.6481242896):5.311001675):0.7996978857):0.02395725126,t31:6.726203103):0.06121387093):0.3901961554):1.405402665):0.04741905882):0.7812215398):6.650773184,((((t32:7.074571074,t33:6.960508826):0.7548705486,((t34:3.106433066,t35:3.083178799):1.702716445,(t36:2.432776314,((t37:0.4146836761,t38:0.3895065461):0.06397616276,t39:0.4284877604):1.915279589):2.209743306):2.83498836):1.203994461,(((t40:5.597944985,t41:5.587783988):1.72223765,t42:7.187272978):0.2168069229,(((t43:5.985957249,(t44:5.643367194,(t45:4.702009942,(t46:3.503595002,t47:3.496975853):1.145805763):0.9258505023):0.2703911):0.4195207453,t48:6.06058416):0.3704607279,(t49:6.225005397,t50:6.206423434):0.1679891883):0.6013167406):1.041976048):4.713923879,(((t51:7.030069897,((t52:5.991064216,t53:5.922716836):0.2425540264,(((t54:0.2779281463,t55:0.277672501):2.842019811,t56:3.05799987):2.490301891,(t57:2.785859835,t58:2.477647323):2.715256765):0.5069337326):0.7299800341):1.017210913,((((((t59:4.606918693,(t60:4.013583783,t61:3.842077757):0.5814924455):0.139209596,(((t62:2.357764867,t63:2.301377335):0.5993700847,t64:2.823285713):1.218973337,t65:3.832112243):0.1437940448):0.2625835964,(t66:3.992376424,t67:3.885966766):0.1862575032):0.9635860585,((t68:2.047401005,(t69:0.6263018964,t70:0.4472517251):1.257412562):0.5283423728,(t71:1.40968759,t72:1.324002509):0.7174500007):2.449152373):0.3071699227,(t73:3.815736007,(t74:2.601641784,((t75:1.394368921,t76:1.338004147):0.6270075797,(t77:0.6904280839,t78:0.4550733423):1.172640157):0.5316135084):1.045189279):0.9627441859):0.5697434608,(t79:4.134899036,(t80:2.929947002,((t81:0.08019311611,t82:0.07378769038):1.554373617,t83:1.334485306):0.9539020554):1.144395256):0.4911197815):0.5455795818):1.920915466,(((t84:0.9185082343,t85:0.8852294617):1.062485535,t86:1.911435473):2.5702332,((t87:3.112528742,((((((t88:0.4325712846,t89:0.3392063576):1.106569973,t90:1.350648045):0.5125819815,(t91:1.453974715,(t92:1.223779981,t93:1.210317136):0.1689932371):0.3687299899):0.2986176295,t94:1.998135097):0.2441394566,t95:2.104507809):0.02772742433,(((t96:1.231605551,t97:1.107559112):0.1999335068,t98:1.253966821):0.1283025869,(((t99:0.3851256462,t100:0.3826933278):0.7077765696,t101:0.8180989457):0.2096949494,((t102:0.1256871652,t103:0.1009730478):0.2198910179,t104:0.1569115749):0.5948757985):0.01853949022):0.5113226866):0.4457641877):0.4360176775,((t105:0.6122160564,t106:0.5568931876):0.07594536306,t107:0.3542764725):1.432418171):0.9191490831):1.76839387):2.706419116):2.12144185):2.317172596,(((t108:1.66410435,(t109:0.6188275222,t110:0.5937329274):1.012056):0.5960796498,(t111:1.393988091,((t112:0.4823715685,t113:0.4302780296):0.3244451742,(t114:0.2596821775,t115:0.2377432231):0.4722170886):0.5559076532):0.8042283077):1.299420987,(((t116:1.148323536,(t117:0.9903561447,t118:0.9032903883):0.1002984405):1.323607203,(t119:0.3684513222,t120:0.1874464701):1.944202634):0.3553580003,((t122:0.4563762641,t123:0.2344460205):1.370407704,t124:1.57047013):0.3753872946):0.2622359527):7.966332236):0.9515699992):0.3961139825):0.793447417,((t126:0.5161473099,t127:0.003831211446):3.700813007,(((t128:0.2411574483,t129:0.1672782488):0.6577243925,(t130:0.2517963411,t131:0.2257441372):0.5558880752):2.083538416,t132:2.855355086):0.677605876):7.923410254):2.408150295,((((((((t133:3.403996878,(t135:1.03130204,t136:0.6908652441):1.993390162):5.940586448,((((t137:0.4681575262,t138:0.3254812165):0.8703554959,t139:0.9346852976):5.484159209,(((t140:0.8819002859,t141:0.8288877691):1.649548283,t142:2.382940163):3.812355132,t143:6.173918695):0.01217588596):1.444869012,((((((t144:0.6138175055,t145:0.5031579592):0.3899229322,t146:0.8411164073):0.4317136756,t147:1.180948725):2.411002054,t148:3.35293101):1.290514656,t149:4.496104484):2.139428881,t150:6.62066933):0.3457370163):0.3045676013):0.4403785097,((t151:0.5546063584,t152:0.5474402778):5.154649135,t153:5.490681645):1.647022835):1.932475632,(t154:7.874636402,(((t155:2.280026354,t156:2.107269762):1.852857994,t157:3.906995976):0.007425692643,(t158:1.56407785,t159:1.431722758):2.308716455):3.636951987):1.147568886):0.2889494653,((((((t160:5.584554682,t161:5.512969429):1.076514046,(((t162:3.245942126,t163:3.235864806):0.3040914507,t164:3.504563008):0.532609907,t165:3.926613813):2.32713837):0.8601388808,t166:7.087593322):0.1273010383,(((t167:5.068096892,t168:5.066828169):1.253115678,((t169:1.240911446,(t170:0.6964648005,t171:0.6132650876):0.3774650195):3.01820368,t172:3.937937328):1.983173948):0.6358711118,(t173:6.09758042,t174:6.03420791):0.3209170723):0.2266997478):0.4487740483,(((((t175:3.795609898,(t176:0.654930943,(t177:0.5123660003,t178:0.4725694929):0.09183656481):2.910357026):0.06478268449,(t179:0.904536632,t180:0.7449797193):2.551880387):2.783502246,((t181:1.382931209,t182:1.344575621):2.445860071,(t183:2.663193333,(t184:2.069790837,t185:2.019140805):0.5898310089):0.9362703735):2.115618276):0.1392002849,(t186:5.413425836,(t187:3.205629667,(((t188:0.01525970961,t189:0.004676927752):0.1869651898,t190:0.08901284528):2.79324053,t191:2.726171326):0.008691542917):2.152061834):0.3692212118):0.1115813557,((t192:3.998750482,(((t193:1.027366972,(t194:0.6099349415,t195:0.5928572022):0.2846732004):2.24554562,t196:3.046322046):0.1459902227,(t197:2.436473945,t198:2.163746653):0.3618059227):0.4910511422):0.3268750734,((t199:1.301349517,t200:1.280832306):1.472015846,t201:2.712791781):0.4344577323):0.9699474703):0.1266747547):0.5700538895,(((t202:1.32084096,t203:1.176660939):0.842335644,(t204:0.2357671552,t205:0.200961008):1.754142446):1.926053418,(t206:3.740674397,t207:3.726245148):0.07185474543):0.6119848418):0.04433783443):0.728827467,((((t208:2.233160889,t209:2.220044616):1.626908727,(((t210:1.533003904,t211:1.441419028):0.9934318803,t212:2.307299787):0.160467595,((t213:1.590620402,t214:1.533193674):0.5238652461,(t215:1.711311868,(t216:0.862057496,t217:0.6462591408):0.8241895966):0.2092031367):0.3092934693):1.114266238):0.4913487006,(t218:0.2391119695,t219:0.2027436558):3.25056316):0.3820497436,(t220:3.240259116,((((t221:0.9659629519,t222:0.900711533):1.079418079,(t223:1.065196023,(t224:0.4851152603,(t225:0.1175671964,t226:0.1045168074):0.323045598):0.5364379256):0.8301171101):0.400934232,(t227:2.076725629,t228:2.076404172):0.04080760652):0.7042502072,(t229:1.316310706,(t230:0.265922294,t231:0.1298344396):0.5517712833):1.470236799):0.00642499636):0.5108066667):0.3961544877):0.2110171088,(t232:1.92007092,t233:1.891288298):1.305649407):0.1770344533,((t234:1.600070516,((((t235:0.9575710724,t236:0.9518197551):0.06067831735,(t237:0.7391117738,t238:0.7281038027):0.1067165881):0.2617581589,((t239:0.1217924197,t240:0.09124977554):0.7806558063,t243:0.3776586929):0.1657771541):0.1781329169,t244:0.6921621055):0.1320739114):0.5397475257,((t245:0.2041141328,t246:0.188149051):0.8911699023,t247:0.7974486166):0.211950172):1.158830469):0.6266435465):1.674784773):1.601395082,((t248:1.960171684,(t249:0.2165973685,t250:0.1374778916):1.643060235):0.06596556063,(t251:0.4042616132,t252:0.2630956582):1.384689075):3.681786369):1.233241334,((t253:0.9043321051,(t254:0.2972540912,t255:0.2889568345):0.5415041251):0.2164246265,((t256:0.02404036895,t257:0.01550730188):0.3970971734,t258:0.2695134565):0.309304323):5.370025626):1.401631677,(((t259:1.129241781,((t260:0.1530032988,t261:0.1171306209):0.4413938717,(t262:0.5401594281,t263:0.5345805796):0.01824289038):0.2776688245):3.732551121,t264:4.461830941):1.063891098,t265:5.468173954):1.322768178):2.336669268,(t266:7.93870377,t267:7.828305104):1.111256986):0.2904148116,((((t268:0.5077521197,t269:0.4675577489):4.538373068,t270:4.976494447):3.588421547,(((((t271:5.315824424,(t272:0.7493323423,(t273:0.6384898711,t274:0.4986199767):0.07469096424):4.481431527):1.800399198,(t275:6.630692752,t276:6.627502622):0.1316579118):0.1059434663,((t277:0.2228085851,t278:0.03269100707):5.954939921,(t279:3.002447213,(t280:1.162394677,t281:1.158630961):1.776186608):2.97037427):0.6289722417):0.05021166237,(t282:4.33712233,(t283:1.428477028,t284:1.42062668):2.444425789):2.117989124):0.8038438445,t285:6.698716883):0.3722072699):0.1479867809,(t286:1.554080772,t287:1.178168604):5.599198733):0.4451917184):0.02562719398,t288:7.200852716):0.1048366318):0.1679298586):0.5594152281,(t289:2.37527469,t290:2.312890296):5.623269125):3.381653081):1.382611009,((((t291:1.682065372,t292:1.681701971):5.107697844,((t293:0.5850688051,t295:0.359534996):1.2991991,t296:1.446971868):4.8944127):1.843936592,(((t297:0.910834474,(t298:0.3078177886,t299:0.1738716097):0.5936892928):0.6976522593,t300:1.383404179):6.219157776,((t301:4.580033988,(t302:1.832745088,(t303:1.263949149,t304:1.156521203):0.5632159539):2.343485233):0.8662974958,((t305:4.676877222,t306:4.590517199):0.105790911,t307:4.654471817):0.1355187968):2.143838824):0.3483943509):2.560015287,(((((t308:5.451920979,((t309:4.033611908,t310:4.019422859):0.5125490049,(((t311:0.6998905244,t312:0.6712068312):1.038219733,t313:1.553218537):2.337536071,(t314:2.853812658,t315:2.684978489):1.030705981):0.270439561):0.8975536742):0.5498772399,(t316:3.590505896,t317:3.510026977):1.802016515):0.4606274767,(t318:5.374889059,((t319:3.871153848,(t320:0.8911146705,t321:0.8890861321):2.979189458):0.7134267542,((t322:3.732458977,t323:3.515949305):0.2057133449,t324:3.717223067):0.6267489416):0.6860745916):0.09513966598):0.5427146493,((t325:1.107840591,t326:1.0496508):1.93610229,t327:2.916481751):2.589808464):0.7758261958,((t328:3.367087493,((t329:2.293854642,t330:2.237423063):0.7431782571,(t331:0.7734431548,t332:0.5350146376):1.952111108):0.1730144458):0.473025829,t333:3.119333179):2.117721327):1.933446737):1.442985536):1.943681536,(((((((t334:2.60481799,(t335:1.351104834,t336:1.168685442):1.226676828):0.5693460919,t337:2.840386046):0.1642840965,(((((t338:1.835360014,t339:1.829749618):0.46466764,t340:2.290191726):0.01396610532,(t341:0.8619466314,t342:0.7957460332):1.406344017):0.001866918432,t343:2.13912806):0.04736590019,t344:2.124419583):0.6165935538):0.2805908591,t345:3.016261433):0.5256800421,(((t346:1.743286176,t347:1.624128911):0.3123380351,((t348:1.525904984,((t349:0.53205721,t350:0.5298367269):0.5622202372,t351:1.069050833):0.3314401049):0.1381121795,t352:1.523417063):0.2082873349):1.202511264,(((t353:0.9650459106,t354:0.8321178586):1.251649666,t355:2.022811554):0.4554179444,((t356:1.166472638,t357:1.108017685):0.5195218182,((t358:0.2381959036,t359:0.2293458734):1.028681161,t360:1.128861703):0.3506588832):0.6037062968):0.2569763087):0.2424296883):1.565882573,((t361:2.68942362,((t362:0.6245657767,t363:0.3627467484):0.1870796618,(t364:0.1898977995,t365:0.1695540748):0.2485555918):1.830913717):0.6397081767,(t366:2.751685019,(((t367:0.07891749219,t368:0.0009695319535):0.5312014355,(t369:0.1909263628,t370:0.1809769832):0.2831317933):0.8150833499,(t371:0.7755251247,t372:0.7630237998):0.4472846859):1.138945136):0.06237920027):0.8077103413):0.2578001996,(((t373:0.1533187498,t374:0.1258391474):0.5439087556,(t375:0.382700887,t376:0.1419256287):0.1758560813):0.88328251,(t377:0.7299778131,(t380:0.1414370186,t381:0.1180328073):0.09101534973):0.4708900447):1.818819778):4.498372846):3.799516301):0.5575566114):0.343458561,(((((t382:0.1592174013,t383:0.1014290768):0.2103463126,t384:0.2487941247):6.138064371,((((t385:0.6091921959,t386:0.6076774053):0.1292748062,(t387:0.4870884112,t388:0.437887333):0.05663789546):0.3532005879,(t389:0.3250113218,t390:0.2099423236):0.483530233):0.3860578001,t391:1.04132147):4.554728466):2.568492081,(t392:5.179438786,((t393:0.8690413493,(t394:0.1917513857,t395:0.1181416373):0.4678112454):3.839428934,t396:4.330420768):0.4628711804):2.909667691):1.283069797,((t397:0.3223468818,t398:0.2590155129):1.966398473,t399:2.186519441):6.249707929):0.9553602859):0.1674733093,(((t400:4.100712544,(t401:3.548618292,t402:3.53224282):0.4720147691):1.672710929,t403:5.442530482):2.741630705,t404:8.079700866):0.9966270247):0.3348246217):0.4939169155):16.15601638,((((((t405:5.426578433,t406:5.419921914):1.57752125,t407:6.845508341):0.3168710212,t408:7.079082356):3.747559138,((((t409:2.723058667,t411:2.360894758):5.013038798,t412:7.296258871):0.2594921816,((t413:4.205392428,t414:4.065404546):1.993885776,(t415:1.772933983,t416:1.760299945):4.266201038):1.32061211):0.2717928544,(t417:1.809706089,t418:1.683569942):5.505441979):2.173733228):8.580694902,((((t419:3.759852766,t420:3.696579909):2.590194564,((((t421:4.925253598,(t422:3.214676918,t423:3.199535857):1.708462049):0.6949802818,(t424:2.622877229,t425:2.393072342):2.945909504):0.3667167623,((t426:0.7211471544,t427:0.1344397431):2.047735266,t428:2.177607883):2.811820154):0.07902427139,t429:4.915710838):0.1754256914):0.6399402396,t430:5.702309139):0.4289645682,((t431:0.3786705317,t432:0.3660942893):2.655985643,t433:2.963439079):3.084701971):10.41271308):1.069298454,(t434:6.70013443,(((t435:5.263952611,t436:5.103075562):0.0443506793,((t437:4.281306904,t438:4.180239606):0.06249423936,((t439:3.265367317,t440:3.134486284):0.8106812908,t441:3.891000842):0.1119306521):0.7956063255):0.189909338,(t442:1.512664519,t443:1.500610103):3.461862177):1.179674076):10.76489909):5.337112779):19.52156701);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T36.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
