<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t417:4.04506697,(t418:0.7670564138,t419:0.7488492056):3.229685232):0.9422374062,(((t420:3.303606841,t421:3.19756395):0.739954441,t422:3.910763437):0.3972874175,((t423:1.282882822,t424:1.236751):2.245400731,((t425:0.3894259933,t426:0.3556323865):2.49190947,(t427:1.17547211,t428:1.146924465):1.664646465):0.4053728443):0.6779634489):0.4731658988):1.998916966,(((((t429:1.611070898,t430:1.39717566):0.7226977867,t431:2.07079182):0.9362108133,t432:2.809187112):1.869029613,(t433:3.037569007,(t434:2.035892697,t435:1.999493126):0.9032919823):1.624495131):0.4997639252,(((t436:1.010600106,t437:0.9332182485):0.4017209384,t438:1.309924846):3.186306333,((t439:0.01850649086,t440:0.01369423862):3.685351932,(t441:3.436959808,(t442:1.912577149,t443:1.790739506):1.484568366):0.2166454844):0.7618831247):0.3565475731):0.6997159358):9.774734477,((((((t444:1.53177034,t445:1.353631343):1.775205781,(((((t446:1.730095272,(t447:1.093627142,t448:0.9609223103):0.6331151869):0.1044732255,t449:1.675038883):0.09375254248,t450:1.757770997):0.6562120404,t451:2.33134537):0.4560099924,((((t452:1.431979886,(t453:1.266328071,t454:1.213661135):0.1038569121):0.1967187299,t455:1.476470438):0.7217915948,t456:2.196602443):0.3162802096,(t457:2.109352669,(t458:1.681930295,t459:1.641745461):0.3729742143):0.3947504763):0.08609408035):0.07182102062):0.5639456754,(((t460:1.018978646,t461:0.9283915603):1.442170818,((t462:1.514903342,(t463:0.5142736107,t464:0.4468077126):0.9503589969):0.6208745498,(t466:1.054190602,t467:1.020149429):0.6702678803):0.1401443891):0.3812821537,(t468:1.559198751,t469:1.345472963):0.5139280732):0.1138172863):0.3179845081,(t470:1.017896538,(((t471:0.4563891818,(t472:0.4229525238,t473:0.303972444):0.02545512708):0.2151954455,(t474:0.4403881446,(t475:0.3129597715,t476:0.2774940635):0.1202914499):0.0895848213):0.3375302649,t477:0.8045176569):0.006419025566):0.9125804293):0.717416591,t478:2.392983362):4.74647054,(t479:0.8875403771,(t480:0.4244648933,t481:0.3524954801):0.4625116709):6.23113169):5.317624718):47.18448605,(((t483:2.087747199,((t484:1.29433199,((t485:0.2009573619,t486:0.1555825563):0.7019126895,(t487:0.825413849,(t488:0.5309215034,t489:0.50683591):0.2448388201):0.01193968727):0.2540441747):0.771354967,((t490:0.3916581766,t491:0.3597818561):0.09906387369,t492:0.4239911864):1.141281828):0.00930477074):22.94386422,t493:24.38609354):12.54545061,((t494:0.5731171958,(t495:0.1066849832,t496:0.02551869582):0.4318124551):1.755766112,(((t497:0.1492594329,((t482:0.05842869812,((t465:0.1180741643,(((t407:0.07341892948,(t372:0.006118461567,((((t350:0.1569406162,t351:0.05025948398):0.001083587354,(t338:0.05583738679,((t335:0.0003437214822,((t256:0.01950325417,((((t237:0.07746311998,(t226:0.03600141144,((t163:0.01267001907,(t141:0.1077941694,((((t112:0.0183612761,(t106:0.1230753288,(t1:5.351253568,t2:5.307737141):5.020800845):0.469535071):0.001610419613,(((t3:9.714140992,(t4:3.075308247,(t5:0.09564344585,t6:0.03042430337):2.967066455):6.626433421):0.2331560696,(t7:1.038394386,t8:0.6381484298):8.611051016):0.0263124926,t9:9.171244857):0.7990972543):0.4365248393,(t10:7.007200858,(t11:1.416963822,t12:1.351455277):5.527515484):3.174947217):2.082123555,((t13:6.105610724,((t14:0.5977164604,t15:0.5746341379):4.535012003,((((t16:0.05790762785,t17:0.04968713313):0.3663858217,t18:0.2933699199):0.5953948331,(t19:0.09230360761,t20:0.08120301319):0.7781764725):4.026140577,(t21:0.9518799516,t22:0.8755111577):3.911297042):0.01760739078):0.9720231973):3.391647235,(((t23:2.808653525,t24:2.602433447):5.545951566,t25:8.148006162):0.4907012871,(t26:7.475456459,(t27:0.923277981,t28:0.8582040662):6.543473098):1.068751982):0.3067861211):2.633946886):0.3723398752):2.115777779):4.863458051,((((t29:5.898841217,(t30:2.559256385,t31:2.528331701):3.148560121):3.629466324,t32:8.94670927):0.05386785715,(t33:7.882490835,(t34:5.849000636,t35:5.797527275):1.857313683):1.064157576):0.4751167328,(((t36:6.233186464,t37:5.943636572):1.706439308,((t38:6.140230629,(t39:3.433322876,t40:3.396419615):2.690975291):1.078468254,((t41:5.456204619,t42:5.44444935):0.5989177847,(t43:1.519280662,t44:1.481747896):4.497684534):0.9678433973):0.3999198344):0.8278037585,(t45:1.900973408,t46:1.815973432):6.192797051):0.3874764271):8.689113223):0.670710873):1.115391223):1.480311848,((((((((((t47:6.182597069,(((t48:2.212069961,t49:2.145862936):0.5797641996,t50:2.638199889):2.235922985,((t51:2.105721388,(t52:0.8702802733,t53:0.8191307141):1.003126407):2.662110562,t54:4.132546701):0.1017315179):1.123420324):0.06263417902,(t55:5.038079157,(t56:3.401293641,t57:3.191213638):1.601833563):0.07287453023):0.7540322294,(t58:2.554753906,t59:2.542546014):3.03780859):5.240019209,(((((((t60:4.947105653,t61:4.711990628):0.8508134963,((t62:4.809549124,(t63:3.20697663,t64:3.177319432):1.56061173):0.4100273117,((t65:3.929584603,t66:3.927699923):0.9884668107,t67:4.880407266):0.07269329977):0.2925868097):1.120067908,((((t68:4.122990135,t69:3.762501878):0.1485084498,(t70:0.6359138237,t71:0.4534946405):3.20786717):0.889095076,((t72:2.088022474,(t73:1.606369537,t74:1.559582614):0.3538146795):0.6038435237,t75:2.452577296):1.821139579):0.500786618,((((t76:2.712659452,(t77:0.4862946604,t78:0.2844243312):2.18335319):0.6280634316,t79:3.045155775):0.261767232,(t80:2.058509118,t81:1.720717124):1.247611808):1.015295035,((((t82:0.2358814047,t83:0.1304474815):0.7024504706,t84:0.7940564434):0.5625229012,t85:1.126842937):1.852196904,((t86:1.725809542,(t87:1.063794173,t88:1.008612516):0.6464467994):0.2118428996,t89:1.755803958):0.7223522866):0.5510639105):0.06182403251):0.4897129648):0.620957888,(((((t90:0.2423721902,t91:0.2400334856):1.793406366,(t92:1.287832561,(t93:0.9877714218,t94:0.8821387036):0.1830753565):0.7129914354):0.4628317632,t95:2.230952102):0.08575951433,((t96:1.443681749,t97:1.334908174):0.3063175926,(t98:1.010125943,t99:0.9574692933):0.4808190432):0.5239725689):1.548383801,(((((t100:1.191624905,t101:1.159565725):0.8762495421,(t102:0.5424341744,t103:0.4910457729):1.389126395):1.078143607,(t104:0.7366483147,t105:0.138748739):1.921663153):0.022975738,(t107:0.1607168653,t108:0.1284072177):1.718680262):0.1406818656,((((t109:0.7505291494,t110:0.6436430298):0.06844850596,(t111:0.5269516525,(t113:0.1544752475,t114:0.1065727584):0.08953151988):0.1585661415):0.3252801843,t115:0.4975499057):0.1789932996,t116:0.669454166):0.5881581284):0.1799897729):0.06864818811):0.8408555233,t117:2.217621653):0.7163306827,(t118:1.034913692,(t119:0.8593691881,t120:0.7434136402):0.01251195367):1.123567172):0.2328910229,t121:2.031132915):1.443638978):2.935150154,(t122:1.462816707,(t123:0.08941528248,t124:0.0855155713):1.28197068):4.945906241):1.849506268,(t125:1.123451936,(t126:1.067479424,t127:1.028333947):0.04721005757):6.995367116):1.808892282,t128:9.721758475):0.8331333362,t129:10.30763322):0.01604571174,((((t130:0.2094618287,(t131:0.1143065335,t132:0.08100694161):0.03007762018):7.268543847,(t133:0.836029713,t134:0.7742750588):6.532720289):1.145651322,((t135:5.070861663,(t136:4.849420031,t137:4.838001059):0.118195729):3.195959141,((t138:1.001980831,t139:0.9954597301):5.788949588,t140:6.758299242):1.331807459):0.1695830048):0.3272492122,(t142:7.686132189,(t143:2.451244142,(t144:1.477424692,(t145:1.04019918,t146:0.4800090107):0.2614069084):0.8741318011):5.215366916):0.5773855439):1.143633774):0.2238402845,(t147:7.998274441,((((t148:0.5477991063,t149:0.407737258):0.5594842381,t150:0.7813007114):3.226211619,(t151:1.300969769,t152:1.26725203):2.661429079):2.692743854,t153:6.481597736):0.8900184083):0.6536123578):0.4228712905):0.125757154,((t154:0.5223069096,t155:0.5093288281):5.030686601,t156:5.512592835):2.905001489):0.3879040723,((t157:4.578812994,t158:4.577623143):3.579959042,(t159:4.82936423,t160:4.80098954):3.301191042):0.6285322497):0.444186383):3.82171456,((((((t161:3.674390876,t162:3.671100447):0.4876569899,t164:4.071821588):1.281653037,(t165:5.109675195,t166:4.822851761):0.2358920346):1.990510001,(((t167:2.125661311,t168:2.114618281):3.742069528,(t169:2.200591907,t170:2.046244902):3.566861009):0.9901929088,(t171:5.870595132,((t172:2.727489054,t173:2.670463595):2.897563186,(t174:5.16843505,t175:5.108906582):0.3300178602):0.1989217197):0.715150123):0.002936377519):0.8738459809,((((t176:4.248295132,t177:4.135899724):1.264800241,(t178:2.786811644,t179:2.779229535):2.607442249):0.1897487765,(((t180:1.019407218,t181:0.9345242165):0.8046670768,t182:1.691019234):3.14401227,(t183:3.986951772,(t184:3.697925057,t185:3.690399792):0.262071043):0.6235460475):0.4784092712):1.047205848,((((t186:0.08384587588,t187:0.01901844535):2.784107428,t188:2.518585325):1.213221005,(t189:1.45989803,t190:1.428752016):2.217432978):0.5936450471,(t191:3.48428826,(t192:3.018639981,((t193:0.3456386723,t194:0.09723688006):0.7875459078,t195:0.7727405135):1.757478352):0.4505381918):0.7482167578):1.399272673):0.3721960398):0.8791396832,t196:6.04951741):3.795189344):4.343536147):0.1208160516,(((((((((t197:0.3499497167,t198:0.2035333502):2.668825829,(t199:2.72742285,(t200:0.6609910099,t201:0.608767768):2.06353311):0.07193413974):0.9037837264,(t202:3.318477561,((t203:2.089244227,t204:2.036416605):0.3722773577,t205:2.339106347):0.6980133711):0.2056322299):0.3252002261,t206:3.4209878):1.016393253,t207:4.413235808):1.271631654,(((((t208:1.74105747,t209:1.694048664):0.4428047637,((t210:1.408323628,t211:1.402799537):0.6354471518,t212:1.986262915):0.07035127887):0.2514089017,(t213:0.9572902727,t214:0.9390369636):1.251754385):0.4379784336,(t215:1.840846582,t216:1.783944488):0.7536898614):0.1371432483,((t217:1.458137446,(t218:1.017299788,(t219:0.6152839245,t220:0.5604409034):0.3922680984):0.439689542):0.9093007252,(((t221:1.429296776,(t222:0.3854901076,t223:0.1889059271):0.985615459):0.0615821503,(t224:0.8780346458,t225:0.6916859016):0.2905383443):0.5513280025,(t227:0.4123633333,t228:0.359141579):0.8674994663):0.1547354796):0.139142331):2.614557235):3.610326023,(((t229:0.9135877023,(t230:0.6157859852,t231:0.4621540038):0.2309879958):0.6724050185,((t232:0.4214595691,t233:0.4043006743):0.865647811,((t234:0.8609077287,t235:0.8135729221):0.003735898102,(t236:0.7764800639,(t238:0.2924915962,(t239:0.0664636936,t240:0.0376059493):0.1511372467):0.2107588174):0.03704642769):0.3337868094):0.01607348393):0.784079403,(t241:0.348926528,t242:0.228963344):1.191284289):4.995250048):1.733623244,((t243:0.1259758434,t244:0.08363050299):0.1025878019,t245:0.1432750923):7.818635653):1.400799915,((t246:0.6040536122,t247:0.509539727):2.332245608,(t248:1.59875406,((t249:0.916323805,t250:0.7936904712):0.1681549858,(t251:0.4376128798,t252:0.3530785574):0.5171342256):0.4189354776):0.9261959566):6.233148951):0.8970376992):0.5724653027):1.079334191):0.8636526091,(((t253:2.366261861,((t254:1.33931862,t255:1.239420311):0.01564144122,t257:0.7978994874):0.4430301623):6.927030993,(t258:0.7158223017,(t259:0.3564633531,t260:0.347401259):0.3050418193):7.41607469):2.396954524,((t261:5.905010483,((t262:3.179344547,t263:3.052101595):2.353132328,t264:5.271272572):0.3505555398):2.731873052,((t265:0.7056916885,t266:0.6390109414):6.788367005,t267:7.386702618):0.6653577718):1.782195258):0.1256379918):1.156666581,(((t268:9.884048608,(((t269:6.260275982,(((t270:1.488024408,t271:1.403186906):1.426844403,t272:2.818440238):0.4196984105,(t273:0.3822689855,t274:0.3378373844):2.294428703):2.830304554):2.747217051,t275:7.99883073):0.6962947708,((t276:5.696838835,t277:5.661592376):2.614475225,(t278:4.129631762,(t279:3.088439102,t280:3.084100301):0.9891636237):4.107417835):0.3120857655):0.05036742385):0.1215555506,t281:8.545506018):0.1699691617,(((((t282:5.443501568,t283:5.411746519):0.7122785935,t284:6.098567768):1.2593452,(((t285:3.649148059,t286:3.60032882):1.803062842,((t287:3.714800463,t288:3.578791215):0.7181291884,t289:4.287107833):0.9113284457):1.823715027,t290:7.00302461):0.04999251434):0.03587245693,t291:6.975297421):0.5825220211,(t292:4.07312176,t293:3.948724636):3.370809835):0.4708840498):0.8827856602):0.6112088903):2.899816445):2.252576641,(((t294:2.735167174,t295:2.668826054):6.409941928,t296:9.003649634):3.42111381,t297:11.4115786):1.850127664):2.629479179,(((((t298:3.925802007,t299:3.785704581):0.4995587201,t300:3.974740941):1.879562554,(t301:2.736148218,t302:2.696938448):3.063572456):6.951635835,((t303:0.5120912682,t304:0.425196628):7.271353812,(t305:5.123608789,((t306:3.727651352,((t307:2.922039166,t308:2.755632445):0.6450278899,(t309:0.6247407648,t310:0.5796034097):2.43110682):0.1283376677):1.076302273,((t311:3.154872062,((t312:2.482403049,t313:2.36204676):0.3669254376,((t314:2.174381169,t315:1.852559902):0.1947103302,(t316:0.8728972462,t317:0.8366648353):1.157008867):0.3020947082):0.2897207851):0.5173536964,((t318:0.6752677692,t319:0.6100314806):1.979385984,(t320:1.457457003,t321:1.356879048):1.050983736):0.3997646619):0.4581044704):0.006543185227):2.390286169):4.809586398):2.385913514,((((t322:1.079805854,t323:0.9598073104):0.7055246486,((t324:1.070492072,((t325:0.9092874611,t326:0.9024710027):0.01489338953,t327:0.7527947098):0.1211758198):0.1053077601,t328:0.9488756525):0.4799877352):4.639378141,t329:5.983558807):2.152231283,(((((t330:1.239995852,t331:1.221284778):0.2003919706,t332:1.412281928):0.5582736961,(t333:1.446771041,(t334:0.3928692095,t336:0.08763593816):0.8577121598):0.5121421935):0.3474039466,t337:1.692228519):0.6833382115,t339:1.688883549):5.011323192):4.245020894):0.2437292517):0.04190519518):0.8527996064,(((((t340:0.7605232491,t341:0.6610517699):0.3760330457,(t342:0.6691376101,(t343:0.5427285406,t344:0.396610322):0.1228670319):0.3518072884):1.50115508,(t345:0.6275952278,(t346:0.08934422936,t347:0.08585475785):0.5265802478):1.716257956):7.044642363,((((((t348:0.7564533151,(t349:0.30853683,t352:0.1186350338):0.3622249204):0.4143468782,t353:0.8904968091):0.2141781422,(((((t354:0.08928592549,t355:0.08579518366):0.1303164418,t356:0.1797175137):0.1193603555,t357:0.08983956255):0.507113574,t358:0.2850496668):0.03898055014,t359:0.07646301217):0.09001992036):0.9621870665,t360:0.8825976504):0.6008593015,(t361:1.103256021,t362:0.9318418958):0.3313641986):1.693802172,t363:2.695133006):4.714617738):0.6762117755,t364:7.985492317):1.550256886):0.4061992816):0.1321119615,((t365:0.5355392857,t366:0.3389611076):1.294773452,(t367:0.7551138323,t368:0.745568337):0.8608281322):7.883093873):0.9931198022):0.1280229016,((t369:9.337270773,(((t370:2.773324518,t371:2.755097083):4.6744256,(t373:5.853961643,t374:5.819094087):1.446870022):1.669441877,((((t375:5.989689768,t376:5.914789936):1.894663534,(t377:0.2963520277,t378:0.2912854135):7.470726173):0.1124783103,((t379:1.642730628,(t380:0.181168837,t381:0.06663724918):1.461435981):5.893475734,t382:7.157641947):0.3221940379):0.4799108885,t383:7.957720186):0.421937645):0.1188403386):0.5689927262,((((t384:6.713293247,t385:6.351212564):0.2926906016,(((t386:5.24942075,(t387:2.487826484,(t388:1.455769375,t389:1.447303827):0.9584543877):2.625467943):0.1714494366,t390:5.191201629):0.438968209,(t391:0.6435334015,t392:0.4950437455):4.958627433):0.5379666953):0.5898469357,t393:6.531480848):0.5054354547,(t394:6.156941634,(t395:0.5406954489,t396:0.5083949161):5.548632565):0.792832434):0.812024924):0.6514359035):0.4626739304,((t397:3.82615766,t398:3.815940995):3.196822857,(((((t399:1.519266915,(t400:1.214498188,(t401:1.052070648,t402:1.00524121):0.04781501961):0.2128801049):1.834245477,(t403:1.151767029,t404:1.082481363):1.938010792):3.362521575,((t405:5.024394075,t406:4.888530109):0.6614695358,t408:5.16804823):0.6407844085):0.02448028254,((t409:5.200088341,t410:5.047454065):0.397639936,t411:5.424301163):0.1557612266):0.1160747486,((t412:3.080556101,t413:2.981736648):1.543211344,(t414:3.979969119,(t415:3.574013197,t416:3.219606886):0.02901691845):0.5100143458):0.959313903):0.112187693):1.707911316):1.41331499):34.47490788):21.78866769);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T38.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
