<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t492:4.2251388,t493:4.129382989):8.914000305,((t491:0.2841527843,(t489:0.03076812646,((((t467:0.1485820034,t468:0.004828628939):0.1394688331,(((((t348:0.2201807011,((t347:0.2221280306,((((t308:0.03703770491,((t280:0.01413620042,(((t229:0.04063747381,((t212:0.06615672289,(t210:0.1044699238,(t129:0.1774998322,(((t110:0.01617455929,((t95:0.1832698805,((t1:1.288491756,t2:1.191517181):7.678688149,t3:8.817472738):0.6969991562):0.698451341,t4:9.96147309):0.2810174209):0.6632440874,((t5:10.0416747,(t6:9.592817654,(t7:5.018580475,t8:4.861731464):4.561230326):0.244828406):0.2082396989,(t9:6.888729723,t10:6.881758842):2.937792556):0.2629288329):1.013111921,((((((t11:4.21308779,t12:4.085156239):4.069336296,(t13:2.51717502,t14:2.513368491):5.441561799):0.6123484828,((t15:8.051720949,(((t16:5.508374275,t17:5.389606479):0.4607483046,t18:5.740075041):1.599307375,(((t19:0.4446018197,t20:0.3728280835):0.434349332,t21:0.5841642259):3.583073068,(t22:3.425088998,(t23:2.123207234,t24:1.829786299):1.296941379):0.2308937692):2.78300427):0.4643120118):0.423516207,t25:6.870060746):0.03295028328):0.9310960055,(((t26:2.344603143,t27:2.28901689):2.215578164,t28:4.417854901):0.9760870314,((t29:3.577049741,t30:3.431412436):1.089075148,t31:4.519435212):0.7256209277):2.295632422):0.06190701064,((t32:6.561768644,(t33:5.377560584,(t34:3.232077935,t35:3.214610195):2.119681374):1.091099892):0.7600675249,t36:6.958996455):0.2589453026):0.7475437921,(((((t37:0.5230052589,t38:0.4987206101):2.300609695,(t39:0.9440746518,t40:0.8487655275):1.80202967):3.455379189,t41:6.067502731):0.9185649111,(t42:6.857815732,((t43:1.857930883,t44:1.753205234):3.123433737,(t45:0.3360877025,t46:0.3255426685):4.314648103):1.707579485):0.1125014746):0.4418409616,((t47:3.202802655,t48:3.193059615):2.366057439,((t49:4.333292184,t50:4.238792883):0.00495842044,t51:4.233778246):1.092534094):1.081161955):0.3044182372):0.414808011):1.171613545):6.708998857):0.1692162615):1.653293188,(((((t52:4.635950044,t53:4.402682671):0.3497852108,t54:4.665027992):0.3517165197,(((t55:3.993000305,(t56:3.852306059,(((t57:2.335371175,t58:2.030353683):1.095717889,(t59:3.059083842,(t60:0.545344486,t61:0.4965007501):2.344236882):0.0669830352):0.04969165987,(t62:1.254388153,t63:0.9681691722):1.669076265):0.1786068226):0.1114787738):0.5822744378,t64:3.413275425):0.419425477,((((t65:0.6709559964,t66:0.6027235225):1.162683976,t67:1.561217973):0.6909335598,t68:2.244273771):0.4455511219,t69:2.679322235):0.5395129419):0.01065124232):0.03164125983,(t70:3.128130652,t71:3.065762511):0.09493189287):8.714331126,(((((t72:1.369902224,t73:1.020796973):1.312047189,(t74:2.115890175,t75:2.091875595):0.2082645989):0.06616336204,((t76:1.043161048,t77:1.037459271):1.202975414,t78:2.217409072):0.101355588):0.05563214896,t79:2.332977127):2.909034171,((((t80:2.098269687,t81:2.069701763):0.3900519838,(t82:1.84720041,t83:1.812834604):0.5323435406):0.1927284995,((((t84:1.074975233,t85:0.6889645812):0.4478392585,t86:1.125036325):0.2789860687,(t87:1.026012568,(t88:0.3188627274,t89:0.2927240129):0.7010898692):0.2045714052):0.1088218713,t90:1.143194917):0.6157492386):2.046492635,((((t91:1.041322245,t92:1.029536891):0.4510141011,((t93:0.1895196228,t94:0.178489001):1.104696368,t96:0.9786816387):0.1449911784):0.3998902946,(((t97:0.7688194094,t98:0.7479519462):0.02216809644,t99:0.6122651671):0.3829918794,t100:0.9363275882):0.08030981305):0.4141450358,(t101:0.5418044555,t102:0.4728237235):0.8473742255):1.354061882):0.4776030566):5.849602403):2.702425148):0.6362455495):1.18496762,((t103:1.619050745,t104:1.600203365):9.952371628,((((((((t105:0.9499752219,((t106:0.04599218752,t107:0.03871904856):0.2362800346,t108:0.1456637179):0.6269401464):0.1299132304,((t109:0.09089225907,t111:0.05384914116):0.335212176,t112:0.1522798327):0.4424349775):0.4745837105,t113:0.947185764):0.5033038598,(t114:0.2646711159,t115:0.1009408419):1.140901922):0.6457429343,t116:1.864591515):0.3774005302,(t117:1.213988852,t118:1.00215455):0.9326988693):1.530574315,t119:2.74867262):6.754424123,(t120:9.293810085,(t121:4.180871202,(t122:1.067323151,t123:1.025376811):3.046730197):4.604174912):0.194032085):0.1681782995):1.905253856):2.056533783,((t124:0.9346963343,t125:0.8506949194):2.775676191,t126:3.588821933):9.256318029):2.019748079):1.739600256,((((t127:0.3864035225,t128:0.3646676164):1.422608193,t130:1.307338585):4.910842834,((t131:1.258679686,t132:1.115883189):3.622229279,(((t133:2.817748391,t134:2.783147808):0.2786214577,t135:3.057259078):1.460663483,t136:4.468564924):0.1747775553):1.276884597):4.312995508,((((t137:1.163426067,t138:1.126798836):8.537540998,((t139:0.1727076938,t140:0.1440767331):8.684359206,((t141:4.961695222,(t142:1.688646067,(t143:0.1877606335,t144:0.1698917794):1.495340237):3.125873596):1.035276574,t145:5.672553203):2.654828028):0.7503322716):0.1024815703,((((t146:0.533113553,t147:0.4696314734):5.061500596,(t148:4.961944667,t149:4.729862543):0.5521283395):3.160559838,((t150:2.930101621,t151:2.914595515):5.059740294,(((t152:1.874378638,t153:1.854304893):5.199547825,t154:6.990346307):0.5797866643,(((t155:2.639933399,t156:2.624148556):3.347334066,t157:5.962020218):1.115331036,(t158:1.151366207,t159:1.02886741):5.369994372):0.4352143534):0.3116941318):0.4142121299):0.11191663,((((t160:5.492285136,(t161:4.031745697,((t162:2.742052414,t163:2.434338635):1.245339686,t164:3.675261746):0.01204546006):1.443110797):0.3164692718,(t165:4.983146916,(t166:1.303794425,(t167:0.7092737997,t168:0.6537475794):0.5209072358):3.590828718):0.4185500598):0.3747074189,(((t169:0.05484389676,t170:0.0351536225):3.360570576,t171:3.199929788):1.716817125,(t172:1.76226583,(t173:1.051359092,t174:1.034759085):0.5566890915):3.060703027):0.404833178):0.5430264015,((t175:4.109081406,(((t176:0.2398410407,t177:0.1760768965):3.085895975,(t178:1.856640728,t179:1.819102371):1.352562519):0.6871631074,(t180:0.9388117513,t181:0.8404636865):2.817175505):0.01488414088):0.8958129148,((((t182:3.153578413,(t183:2.392902746,t184:2.271487192):0.681856493):0.1136097654,t185:3.036312249):0.4735131494,t186:3.46237008):0.01834777512,(t187:2.569209747,t188:2.427140552):0.8661104954):0.7611711877):0.3322396368):0.9296311674):0.1913343994):0.135170965,(t189:2.911930628,t190:2.852552507):2.602090951):0.2292996771):5.566358848):2.451793276):0.2907852054,(((t191:4.559089529,(t192:4.11455168,(t193:2.945220843,t194:2.937652242):1.163398337):0.4152826243):1.667679233,(t195:1.021098542,t196:0.9791836366):5.140086813):6.577377481,((((((t197:3.419201586,t198:3.361607618):0.6424554588,((t199:1.940756251,t200:1.892096805):1.71161301,((t201:2.510183192,t202:2.462900533):0.2297207463,t203:2.538070443):0.8583311313):0.06473370108):0.1891556247,((t204:2.613291545,t205:2.594109702):0.2531553687,t206:2.771326392):0.5616282795):0.6251191086,(((t207:3.072374313,(t208:2.141817135,t209:2.133705691):0.8336109963):0.3456503129,(t211:0.867552234,t213:0.5276550908):2.188450976):0.1378967434,((t214:0.8682012653,t215:0.8498577361):1.144430464,t216:1.956223375):0.8126511494):0.1432838392):0.6445745404,(((((t217:0.1139990654,t218:0.08289373095):2.665635793,(((t219:0.9971754767,t220:0.8636399649):1.067178616,(t221:1.064692378,t222:0.8113758534):0.5354902049):0.04323307285,(t223:0.9518398795,(t224:0.3924155055,t225:0.2114193785):0.3203316319):0.4185462136):0.5384644749):0.1983433822,(t226:0.2093678885,t227:0.05086220102):1.333673931):0.0160279569,t228:1.256432161):0.5031010524,t230:1.319244807):0.002475258302):1.171080534,t231:2.387725183):5.946446365):1.047394069):0.9176146277,(t232:9.940997929,(t233:8.609889212,(t234:0.3407601277,t235:0.07031776533):8.253668806):1.317554008):0.3060412183):2.00680855,((((((((t236:0.3543700125,t237:0.05653523239):0.1509162433,t238:0.04809181751):7.507769331,(((t239:0.5307753912,t240:0.3710512092):0.5895828526,(t241:0.4472428549,t242:0.4253741156):0.1004334879):6.151963484,t243:6.50344398):0.1366404576):1.116966312,(t244:0.3256210157,t245:0.1625675851):7.427053441):1.632168131,((t246:3.494679372,t247:3.443611681):4.34422117,t248:7.78186152):1.115033738):0.03688889749,((t249:8.770957955,(t250:8.479299582,(t251:7.500939511,(t252:1.596917311,t253:1.544537447):5.749979059):0.926102547):0.2766279109):0.02353235161,((t254:1.249925064,t255:1.152786362):4.623431897,(t256:4.133589695,t257:4.113279947):1.540902791):2.629095109):0.04288450685):0.7087509888,((t258:7.631224636,((t259:3.637008127,t260:3.610248336):1.760767174,(t261:2.68852557,t262:2.486086196):2.587393965):2.167675414):1.009641925,t263:8.142379236):0.328951281):0.2394162318,(t264:6.736927456,t265:6.703877229):1.827595144):0.05468845564):0.3001265182):0.3089299659,(((t266:0.151612985,t267:0.08861959819):7.837859896,((t268:5.458607605,(((((t269:0.2931456277,t270:0.2634051055):1.71931558,t271:1.918248914):0.3456632909,t272:2.208724239):1.09604182,t273:3.272302486):0.8403840255,(t274:3.21128298,t275:3.058406066):0.8363597263):1.124813815):2.10558963,t276:7.061086079):0.2304007483):0.3775066849,(t277:7.434118321,((((t278:1.178593701,t279:1.143201114):0.2965877768,t281:1.191401466):3.092514671,t282:4.195442985):2.257248238,((t283:4.354325095,t284:3.543360076):1.837609269,(t285:3.516790699,t286:3.513130543):1.561257717):0.1656267577):0.5030045264):0.03944788839):0.7283364983):0.04981857666):3.482218876,((((t287:4.469647539,t288:4.283100468):0.700856104,((t289:2.304347977,t290:2.290629448):1.29208236,t291:3.571655501):1.325060744):0.6914461696,(t292:5.320952188,(((t293:2.416026253,t294:2.393258417):0.1898433529,t295:2.502190024):1.611014142,t296:3.760903275):1.035948534):0.1987911726):2.319757749,(((t297:3.461351712,t298:2.832103419):1.549642432,(t299:1.144961154,t300:1.045336521):3.073138614):1.535655613,(((t301:1.188409287,t302:0.9857022171):0.9969160027,t303:1.97178756):2.882412981,((((t304:2.247162316,t305:2.209143711):0.3314217833,(t306:1.314270904,t307:1.310631398):1.222592231):1.066893504,((t309:1.630166321,(t310:1.105401643,t311:0.9534109959):0.4931930123):0.8800495226,t312:2.271534801):0.99985516):0.1418866197,t313:3.315806015):0.6639408863):0.5667644995):0.7307187525):1.739665844):0.5501212411,(((t314:1.235877663,t315:1.19627277):0.2553688952,t316:1.437226091):0.5607905389,t317:1.996530938):5.513511822):0.627465687,((t318:3.152477616,(((t319:0.2585189397,t320:0.1049834135):1.460431805,(t321:0.8834953785,t322:0.81704048):0.6241339684):0.9272793391,(t323:0.7579588797,t324:0.7023725813):1.589398218):0.4731703092):0.02099976772,((((t325:1.092210668,t326:1.003149068):0.1469874609,t327:1.111460157):0.4500777026,t328:0.749997093):0.1723926982,(t329:0.1557272003,t330:0.1423654683):0.7576834869):0.8816621976):4.867497658):1.941318962,(((t331:0.6658789457,t332:0.6426578236):3.289672268,(((((t333:0.2035127684,t334:0.1953234916):0.08213703495,t335:0.2251564724):0.7332053214,(t336:0.7988433994,(t337:0.6751060435,t338:0.5604327237):0.08161144631):0.1410278657):0.07966419171,t339:0.7906372077):2.648570788,(((t340:1.557637575,((t341:0.252017462,t342:0.205946341):0.06824707641,t343:0.1290798677):1.188558853):0.906424169,((t344:0.8399245284,t345:0.7323359849):0.3173372068,t346:0.8451631735):0.9636693057):0.730010566,(t349:0.4166334062,t350:0.3626040439):1.183691409):0.1579158042):0.1511673344):3.062218973,((t351:1.855849417,t352:1.68423638):1.948744971,((t353:0.3030620907,t354:0.2693874268):0.5311782602,t355:0.6091566994):2.458267299):1.015239833):1.545390692):3.015352893):1.008924503,(((((t356:2.140123233,t357:2.020220048):0.55866431,((t358:0.4220601138,t359:0.3943945024):0.3170663131,t360:0.6188558873):1.799923059):5.628654342,((t361:0.324811182,t362:0.2256783312):6.216715923,(t363:4.566024453,(t364:0.3160729641,t365:0.2979616108):4.186013689):1.77676201):1.465473346):0.7672211153,((t366:0.1204718833,t367:0.05312938682):5.490229861,((t368:2.243801074,(t369:0.1224572121,t370:0.08832339969):2.103054602):0.8492828454,(((t371:0.1302224746,t372:0.1224854038):0.4653080244,(t373:0.2521073628,t374:0.2379758848):0.32409945):0.003072231897,t375:0.5648479802):2.411803522):2.436402896):2.831110466):0.3183186189,((t376:5.509434405,t377:5.400359802):1.282711614,((t378:4.709329267,(t379:1.202018264,(t380:0.5625783047,t381:0.3468669583):0.05884651609):3.501992899):1.155925811,((t382:3.540180304,(((t383:0.6724766716,(t384:0.2472134222,t385:0.2300089839):0.1649349057):1.479140301,t386:1.839411346):1.308610705,t387:2.943720845):0.02990914213):1.31410442,t388:4.203574901):0.1053428851):0.8167104041):1.768770412):0.2291471873):0.19970007,(t389:6.85612535,(t390:1.567476373,t391:1.481857956):5.236933386):0.421046536):0.06378545158):0.5283570822):0.6942652471,((t392:5.430171524,(t393:4.840164738,t394:4.789230739):0.519321294):2.298252438,(t395:7.035448627,((t396:6.326727809,t397:6.233903002):0.1475102971,t398:6.358562346):0.5366829243):0.5296287041):0.6968436535):12.86598222):11.77254232,((((t399:7.378891472,t400:7.358629773):0.1134418962,((t401:4.430067395,(t402:0.9035213735,t403:0.8324265002):3.28583644):0.6080820295,t404:4.648354119):2.432940836):0.07582042901,(((t405:4.69113524,t406:4.56397105):0.2658425964,t407:4.791663224):1.04666012,((((t408:4.279915873,t409:4.246710004):0.4336111459,t410:4.648905575):0.01659314168,t411:4.450666138):0.6311013398,(t412:4.110963941,t413:4.000812856):0.8343831365):0.4597786826):0.9321291173):1.135801236,((((t414:4.372281429,t415:4.354836016):0.1936829444,(t416:4.214125593,((t417:2.858800616,t418:2.758295061):0.7373436029,t419:3.425094208):0.6089741501):0.2409153778):1.031098609,(((((t420:1.596161046,(t421:0.4352543867,t422:0.05352235403):1.137105803):2.494323713,(t423:3.316474643,(t424:0.859930526,t425:0.8440148821):2.404147659):0.2644416537):0.178636145,t426:3.672279811):0.1843851414,((t427:2.66227974,t428:2.635972726):0.4345154407,(t429:2.753618819,t430:2.618642747):0.3054409598):0.5843072877):0.5013693484,(((((t431:1.066387553,t432:0.9216110804):0.8445613852,t433:1.71509561):0.7151498427,t434:2.399122435):0.8619759122,((t435:1.8011019,t436:1.684775051):0.2706790125,(t437:1.466380014,t438:1.448175676):0.3832469247):1.178201499):0.09654338412,t439:3.097171972):0.4218799041):0.2493519151):0.3190374684,((t440:2.23126106,(t441:1.97636718,t442:1.973654028):0.2292362417):0.0404769459,t443:2.171119582):1.395422293):1.23780276):23.92826015):11.34200343,(((t444:1.537291428,t445:1.480845158):2.761504572,(t446:3.617199561,((t447:2.799833648,((t448:2.155924932,(t449:2.066628243,((t450:0.1909267225,t451:0.1529487774):1.081624836,t452:1.171678677):0.7586915433):0.05268395495):0.2283812609,((t453:0.6870950746,t454:0.6746725665):1.401562444,t455:2.052688462):0.06841761286):0.2909280426):0.1351463959,(t456:1.000309397,(t457:0.706675946,t458:0.5985296548):0.2316623544):1.427219648):0.6538901942):0.6071721373):11.74039633,((t459:4.188986092,((((t460:0.7365727427,(t461:0.4543552622,t462:0.371930656):0.2171274868):0.9079121337,((t463:1.292543496,(t464:1.055087991,t465:1.026924043):0.05758565115):0.08432827617,t466:1.105065259):0.1083791155):1.128098549,t469:1.930413499):1.307106337,(((t470:0.2159876263,t471:0.01858929855):1.055180584,t472:0.9901872591):0.2722232609,(t473:0.8873548394,t474:0.8746182786):0.2967255619):1.565426453):0.08931052381):3.744138891,((((t475:0.2601479114,t476:0.2344746505):0.08933999693,t477:0.3216617267):0.7569478044,((t478:0.07604135706,t479:0.04426541965):0.7448196842,(t480:0.6828735261,(t481:0.2534880011,t482:0.1929399452):0.4190731247):0.1050524104):0.1988454937):1.323410021,((t483:0.6292555196,t484:0.5819641853):0.4849989157,(t485:0.10247665,(t486:0.07377541189,t487:0.05274689834):0.02242030549):0.8352209564):1.049116399):4.101756577):7.312909185):24.02399268):10.59268723,(t488:0.3142696467,t490:0.1256733883):47.54597);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T57.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
