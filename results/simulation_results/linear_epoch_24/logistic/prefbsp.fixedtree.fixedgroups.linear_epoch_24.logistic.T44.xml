<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t490:13.19886243,(((((t491:0.6038745766,t492:0.4028937326):0.1223181919,(t489:0.1034268597,((t469:0.1560287215,(t463:0.2535691007,(t391:0.04018381715,(t379:0.01157131192,(t369:0.1062957263,((t357:0.1559379523,(t350:0.02875226881,(((t273:0.2495848962,(t266:0.01061888314,(((((t244:0.4078336678,t245:0.3204636228):0.09570826802,t246:0.2775157239):0.1123350329,(t247:0.208863058,((((t238:0.1000812237,((t159:0.04214773204,((((t121:0.04156263936,(((t116:0.04870385626,((((t68:0.2642302403,t69:0.01484737283):0.2509064102,(t57:0.03347342543,(t53:0.07375151968,t1:4.523783159):0.6130556298):1.415341061):0.1437148773,((t2:5.809220237,(t3:2.431763574,t4:2.4145208):3.320778497):0.5828789753,((t5:0.6173052536,t6:0.3786747158):3.113138353,t7:3.368341633):2.578212887):0.1070712146):3.154172342,(t8:5.746902115,t9:5.726649448):3.335866192):0.5803114545):0.4750837709,(t10:9.749772094,((t11:0.9338238968,t12:0.7673381797):7.581101015,(t13:4.785910184,t14:4.779386837):3.516218332):1.057342705):0.1277073513):0.4002911145,(((t15:4.188266603,t16:4.185173555):4.165985001,(((t17:2.234718012,t18:2.227457417):0.0914301908,t19:2.312081038):5.0878468,(t20:0.4345816764,(t21:0.3349562402,t22:0.2438084649):0.04517575169):6.920633334):0.9177209841):0.8254869128,t23:8.872421044):0.6635621181):0.3694487169):0.186936108,((t24:5.536401525,((t25:4.314901119,t26:4.282406401):0.3750335976,t27:4.656598764):0.8222360235):3.605123581,((t28:7.369982537,t29:6.94390201):0.8133819539,(t30:1.841207343,t31:1.479585551):5.765196846):0.8985232337):0.9233321591):0.04663374843,(((t32:3.20652753,t33:3.077488682):3.274302679,t34:6.275671522):1.444858954,((t35:7.220865407,(t36:2.392907678,t37:2.252609684):4.762691281):0.2714081874,(((t38:2.61880594,(t39:1.088194039,(t40:0.05113146172,t41:0.04058030571):0.9539738214):1.506742138):1.755623496,t42:4.256097064):2.856163039,t43:7.10014941):0.02882460135):0.1064995379):1.173056765):1.071251805,((((t44:6.783104097,((((t45:1.762677241,t46:1.650999712):2.208479804,t47:3.801800741):2.089510526,(t48:5.581552785,(t49:4.755131135,t50:4.531569833):0.7805458614):0.3001324761):0.4119637212,(((t51:1.25433259,t52:1.209521559):2.792550586,t54:3.444284548):0.7238136361,t55:4.089192493):1.055104):0.2135028357):1.609377887,(((((t56:2.536264806,t58:2.288432889):1.694418357,((t59:2.206293674,t60:2.138452434):0.9159745379,t61:3.027576545):0.6403113415):1.554399029,((t62:0.3321680549,t63:0.2483613692):1.598688017,t64:1.747721962):3.244209828):0.7634752838,(t65:4.791148096,((t66:4.385348067,(t67:2.400348815,t70:1.814363284):1.890994442):0.1754956633,(t71:2.784105557,(t72:2.369123476,t73:2.326753648):0.3419515462):1.030414577):0.1642070628):0.9383499027):0.1352211702,t74:4.909934199):0.2674904182):0.4333715201,((((t75:1.38227228,t76:1.16891908):1.559146097,t77:2.618140005):1.030980798,(t78:1.725567122,(t79:1.546330588,t80:1.53767843):0.1292457238):1.780022358):1.569706372,((((t81:0.8633598959,t82:0.8389208968):0.2522036215,t83:0.9877432519):1.265522909,(t84:1.979646801,t85:1.960330293):0.160543192):1.329134642,((((t86:0.3294254298,t87:0.3264376287):2.150902202,(t88:1.26376507,(t89:0.3004522358,t90:0.04332881344):0.9063059285):1.165893627):0.02389832695,t91:2.103923072):0.2209286082,((t92:0.3057254263,t93:0.2847040336):0.9764704665,t94:1.126020891):0.7253330027):0.6846208542):1.109904041):0.004102567117):0.1400810363,(t95:1.366578216,t96:1.342200933):2.4193431):0.4552497133):2.440809867):0.6099637147,t97:7.19546297):6.457942605):0.03449577259,((((((t98:1.514811441,t99:1.324824007):0.2040747618,(((t100:0.3392564593,t101:0.1863366057):0.3505876615,(t102:0.3462607127,t103:0.2197394913):0.1521842781):0.381575659,t104:0.7471202441):0.4178227955):0.07743771616,t105:0.7851291796):0.4911044343,t106:1.235825641):0.5632006284,(((t107:0.3169828353,t108:0.2895981807):0.02733912859,t109:0.3010665435):0.5401519913,(((t110:0.6589564807,(t111:0.3331307643,t112:0.3239644692):0.212884455):0.003237052496,t113:0.4814379347):0.1060030469,t114:0.4606909684):0.006729692563):0.9023391849):9.340573571,(((t115:1.362814202,(t117:0.1662152833,t118:0.1259266245):0.9830106203):2.034282043,t119:3.037184398):6.317837108,(t120:6.163320492,t122:5.922279685):2.413302715):0.9904894774):1.469014276):0.1262945925,(((((((t123:0.4940333447,(t124:0.3303122407,t125:0.2356441494):0.130710136):1.755950409,t126:1.883189045):3.445344291,(t127:0.1448709302,t128:0.05384906922):5.034347124):1.066309823,t129:6.026768148):0.8244385635,t130:6.786341142):2.332625107,(t131:2.60331713,((t132:0.3523204648,t133:0.2253512745):1.241551687,(((t134:0.2904270348,t135:0.2462686707):0.1745293478,t136:0.087829382):0.2299954375,t137:0.2566094095):0.7538226106):0.8435329524):6.512237666):0.5483861476,(((t138:7.077974614,(t139:1.039974424,t140:0.788771841):6.00359708):0.3215553982,t141:6.877087261):1.349924837,(t142:6.71766871,(((t143:0.512890006,t144:0.4425825682):0.8367749423,t145:1.25509872):3.888068178,t146:5.021808667):1.449316448):1.487720346):0.1348865643):0.2529109635):0.06454783601,((t147:0.3528498858,t148:0.271733561):7.138772853,(t149:0.5251039777,t150:0.52393324):6.863088779):0.8346712236):1.12290887):0.0933278662):0.01140077578,((t151:6.480536236,t152:6.319499805):1.666021303,((((t153:3.397303341,t154:3.216201636):0.3286986391,t155:3.413786753):1.442894827,t156:4.815943696):2.413700398,((t157:6.236790494,((t158:0.2667566023,t160:0.08671770591):1.332982242,t161:1.418310367):4.444926695):0.7460113761,((t162:0.6915347237,t163:0.6819456998):2.873204634,t164:3.552789194):2.999038815):0.2423782237):0.347226639):1.231095297):0.7458712431,(((t165:4.162220637,((t166:0.5191263286,(t167:0.07968166868,t168:0.04230125506):0.4107498165):1.529982709,t169:1.953801935):2.077249349):4.002257943,(t170:6.292674872,(t171:5.42599944,(t172:0.409596884,t173:0.385202857):4.421598888):0.8014630452):1.722639899):0.918616274,(((t174:5.263970881,((t175:0.9250963205,t176:0.8461256596):3.517579484,t177:4.207909361):0.7429711668):1.71541683,((t178:4.249103048,(t179:1.37181007,t180:1.212116272):2.866865263):2.331563861,((t181:3.305471118,t182:3.272400046):1.769495156,((t183:0.8069609695,t184:0.7373276546):1.527376227,t185:2.175570534):2.644752227):1.237927402):0.0422707949):0.6548598271,((t186:4.445030965,t187:4.381888826):0.3690363215,t188:4.695132847):1.908837468):0.6093399776):0.02921588978):0.9359657582):0.4771928118):1.427566888,(t189:5.29413702,(t190:4.844071185,((t191:3.584974995,t192:3.206132887):0.6770429795,((t193:1.87036597,t194:1.868599854):0.1776391357,t195:2.027155591):1.766196062):0.5173216775):0.3029969665):4.737640706):6.344001587,(((((((((t196:1.670653921,t197:1.669072794):3.216808228,(((((((t198:1.453155535,t199:1.406795067):0.1792753516,t200:1.577628239):0.0733543985,t201:1.604882832):1.296094531,t202:2.889451135):0.001569393153,t203:2.688823687):0.6167393619,(t204:2.604831324,t205:2.507325986):0.6700365074):1.1499571,t206:4.320200011):0.02182427249):0.8643243019,(((t207:0.828505003,t208:0.4598754124):2.324685101,(t209:2.643242654,t210:2.314616904):0.08311392369):0.2137994791,(t211:1.552490597,t212:1.371206034):1.028938444):1.833182642):1.146325832,((((((((t213:1.563969051,t214:1.553592698):0.06599914018,((t215:1.074846294,t216:1.074675369):0.3545348255,(t217:0.5698046402,t218:0.4298892549):0.8280622558):0.1283841652):0.5359704336,((t219:0.6193607334,t220:0.577828154):0.2623453476,t221:0.7156965612):0.7549728902):0.4198907826,(((t222:0.230017289,t223:0.1387278507):0.5702274521,t224:0.6781752454):0.8129157328,t225:1.28226817):0.1836576917):0.7936999697,(t226:1.354481088,(t227:0.6010721246,t228:0.5937546617):0.6336855463):0.8961152061):0.1114701194,(t229:1.907019039,t230:1.898076547):0.3141614084):0.324378733,t231:2.050843511):0.3234773057,((t232:0.3251445143,t233:0.1969290425):0.01093634316,t234:0.1250280821):1.640707327):1.062329514):4.01062755,((t235:0.6569335994,(t236:0.1562904248,t237:0.1365456579):0.4948295191):0.5733034051,t239:0.8963867548):5.606818731):1.93600414,(t240:0.6231388199,(t241:0.2194140958,t242:0.1713243536):0.2092722004):7.684033506):0.7990510574,(((t243:2.183501046,((t248:0.7054466728,t249:0.6622942115):0.3611364788,t250:0.9260318496):0.2153952455):3.560295252,t251:4.277170306):1.787952322,(t252:1.003878113,t253:0.9301908893):5.037524858):1.116144302):0.7476090339,t254:7.791476968):0.3192667523,t255:8.093003003):0.904756892):0.1096463024):0.9837052755):1.029412204,(t256:10.62994566,(((t257:7.084353687,((t258:0.621915758,t259:0.4167838999):0.05557746684,t260:0.4160554256):6.397148264):2.655732165,(((t261:2.023397175,((t262:0.4162688261,t263:0.3758826131):1.343838518,(t264:1.008739202,t265:0.979899665):0.6639855873):0.1780371598):4.150063722,((t267:2.869542143,t268:2.796676721):2.718384631,(t269:0.07048742407,t270:0.06144933337):5.365463076):0.269272959):2.522054486,((((t271:0.6121788726,t272:0.5994912063):1.864275001,t274:2.00325696):1.464140811,t275:3.186949581):2.510043129,t276:5.23519278):1.759816832):0.6632935979):0.5976842217,((t277:1.345464959,t278:1.339380884):3.772727972,t279:4.985525965):3.025230828):0.2404415993):0.4574971694):1.131097447):0.6322823987):1.64189446):5.69577994):0.7077240617):0.1809926101,(((((((((t280:2.727778294,t281:2.617958957):0.1784884567,t282:2.739828087):3.452379146,(t283:1.139380071,t284:1.096165766):5.018161492):2.278304352,((((t285:1.27903695,t286:1.254345982):5.226275766,((t287:0.3987652802,t288:0.3809818958):6.034499627,(((t289:4.209665634,t290:4.164331502):1.46073029,(t291:1.065390698,t292:1.01238954):4.550030521):0.4196720995,(t293:5.673874409,(t294:5.430573515,t295:5.191758808):0.08800675722):0.2636812468):0.3122830803):0.02471871992):0.7669381192,((t296:5.218235265,t297:5.215746729):0.2621517161,t298:5.326086602):1.160413767):1.044691839,((t299:5.806983108,t300:5.733688491):0.8278378486,((t301:5.410964553,t302:5.30141988):0.895313642,(((t303:3.092994296,t304:2.960250896):2.319770229,t305:5.257361643):0.457423571,t306:5.608361226):0.3011846339):0.1858833978):0.8331425468):0.05797707736):0.3237856121,(((t307:1.823889714,t308:1.547730338):2.877193553,(t309:1.321525776,t310:1.268919709):3.097959501):0.3666425709,(t311:3.469578298,t312:3.424194543):1.108375037):2.13061961):0.2135002994,((t313:4.039753384,((t314:2.588172866,(t315:2.035728159,(((t316:0.2417671464,t317:0.2060942783):0.3967927182,t318:0.4850862475):0.5208111928,t319:1.004560755):0.8548478874):0.4329613947):1.07027133,t320:3.103230731):0.2260676473):0.1553177971,t321:3.428917713):2.375640466):7.795796011,((t322:4.432596364,t323:4.381912069):7.848137944,(t324:5.977659408,((t325:0.6997764233,t326:0.6442604132):2.311792617,(t327:2.716092333,t328:2.511672712):0.1863604379):2.907839646):6.176828692):1.112431716):1.390991594,(t329:13.75453903,(((((((((t330:1.883710508,t331:1.667246255):0.2423021214,t332:1.838243359):1.122789235,((((t333:1.730511794,(t334:1.515364559,t335:1.39812314):0.1267921281):0.09600314444,t336:1.584140953):0.2550124044,(t337:0.7619833472,(t338:0.7437914318,t339:0.7254357558):0.008564461446):1.027345175):0.7188212169,(t340:1.101769453,t341:1.089117524):1.151869616):0.1167862904):0.1220758625,(((t342:0.8262062059,t343:0.7926124628):1.07531572,(t344:0.9224884966,(t345:0.8565760589,(t346:0.2120799864,t347:0.1209910409):0.6046744813):0.04192086499):0.4455127516):0.05734976889,t348:0.8817539098):0.3901652833):0.2361924553,((t349:0.3915303353,t351:0.3413330888):0.1458686258,t352:0.2911902147):0.8881848425):0.4543569774,(t353:0.9546273429,t354:0.734823978):0.4578333226):6.16122907,(((t355:0.4896696026,t356:0.3888918303):0.7411778636,t358:0.589348284):4.285866489,((t359:0.2143680537,t360:0.06391832884):0.7354906189,(t361:0.3091995625,t362:0.3038743382):0.3500480163):3.756675136):1.792181754):0.6673226852,t363:6.735782532):2.460280378,((t364:4.21305077,(t365:1.151162138,((t366:0.4859400628,t367:0.2280232719):0.4196185489,t368:0.5204027788):0.212885889):2.918035068):4.469798829,(t370:5.477522286,t371:5.19878986):2.442065366):0.04929850785):0.3379142194):0.1949692961):0.157735398,(t372:4.935404438,(t373:3.953161256,(t374:1.925014358,t375:1.845495496):1.935340221):0.9578654412):3.422378471):0.1795494495):1.075873951):1.146687634):0.4657636678,((t376:8.484026814,t377:8.47365408):0.2327460028,(t378:8.641468371,t380:8.443356673):0.03512361803):2.283904668):9.907648649,((t381:7.748198036,t382:7.686609825):0.06445996639,(t383:5.735915897,(t384:4.494168404,(t385:4.124741585,t386:3.973107124):0.3381643629):1.096701354):1.62087708):12.57781559):0.5415919323,((((t387:7.973348628,(t388:6.257169539,(((t389:3.796426907,t390:3.764097533):1.732989792,t392:5.386057399):0.04892581303,t393:5.369334237):0.5634658736):1.543785973):0.03714370839,(((t394:6.329547892,(t395:0.5225248642,((t396:0.3796901793,t397:0.3673634465):0.05983343081,t398:0.05893152371):0.03869039197):5.734171425):0.1129349503,(t399:4.472013254,t400:4.354286839):1.370813293):0.4454971194,((((t401:1.360340432,t402:1.342593315):2.753709325,(t403:2.942162474,t404:2.855997409):1.093031834):1.245198285,t405:4.949950223):0.3111591238,(((t406:1.343437811,t407:1.327181589):2.377640391,(t408:1.108948626,t409:1.10269088):2.578807298):1.382303946,t410:5.026554349):0.1203993567):0.3760932257):0.528074183):0.5824194457,(((t411:0.9452089598,t412:0.9419644918):0.9295512867,t413:1.677778884):3.739728353,(((t414:3.700072069,t415:3.518503431):1.388603567,((t416:2.573159392,(t417:1.064796323,t418:0.9629576119):1.41541084):1.680824522,t419:3.918954088):0.3551494361):0.2634515416,t420:4.503110522):0.05068284744):0.9349404484):1.191649449,(((t421:4.684859375,((t422:4.103770526,(((t423:1.193342209,t424:1.179404907):2.433293913,t425:3.552403396):0.1712981514,(t426:2.303753014,t427:2.245681934):1.330832754):0.2981022864):0.2223366227,((t428:3.67832951,(t429:2.531733295,t430:2.459316393):0.8302720658):0.2257235959,t431:3.355515679):0.09313875098):0.2939248619):0.3361540407,(t432:2.799741718,(t433:2.443888309,t434:2.413904562):0.1943029004):1.231799892):0.9712899326,(((t435:2.287074732,((t436:1.523743459,t437:1.508473332):0.2120039852,t438:1.658318615):0.428028385):0.593772409,t439:2.554973514):0.1065895652,t440:2.613714851):1.783389776):0.6548780589):10.34720843):1.225095008):12.56762181,((t441:4.577576886,(t442:2.958304673,(((t443:1.880050768,t444:1.860949834):0.2630575811,t445:2.075408571):0.2182529842,(t446:1.130195463,t447:1.069541429):1.154262558):0.5934995639):1.510438126):8.748351758,(((((t448:0.7951537384,(t449:0.6598305075,t450:0.6565920256):0.1252958801):0.6118286088,(t451:1.286911661,t452:1.284379912):0.06048307648):0.9662795933,((t453:1.972358578,t454:1.900178624):0.1221375163,(t455:0.636877072,t456:0.6224386091):1.261991141):0.1916732124):0.2678101462,t457:2.299210352):2.343779125,(((t458:2.08408158,((t459:1.644633656,(t460:1.277500755,((t461:0.2702271386,t462:0.1188432762):0.8168202741,t464:0.5637543259):0.1846718031):0.2772763413):0.3015231668,t465:1.289906019):0.1326855558):0.7408668731,(t466:1.73815655,(t467:0.7429423273,t468:0.5594658536):0.9258913953):0.3847704122):0.5281831212,t470:1.984032105):1.212853435):8.024722873):15.84954671):23.70325133,(((((t471:0.528022102,t472:0.4581609405):0.6601083696,(((t473:0.3020026203,t474:0.2369263828):0.294103268,((t475:0.1681678299,t476:0.09616775287):0.2846820284,t477:0.3582585946):0.02274012803):0.1035919421,t478:0.4664000647):0.4180106702):0.7946838522,((t479:0.2711972388,t480:0.2247239257):0.4691993625,t481:0.6849415289):0.9148936053):0.4311909189,(t482:1.287517603,t483:1.270077583):0.7008182298):25.51048176,((t484:0.6841059968,(t485:0.564776954,t486:0.5460240843):0.060429174):0.1867008735,(t487:0.2904574574,t488:0.1192190517):0.2550438961):26.55325822):22.81356132);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T44.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
