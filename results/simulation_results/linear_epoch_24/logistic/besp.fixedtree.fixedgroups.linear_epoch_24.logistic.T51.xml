<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t363:8.725380192,(t364:5.795196424,(t365:2.644712505,(t366:2.034686673,t367:1.734768752):0.4724042339):3.007366525):2.845950151):12.88143297,(((((t368:0.1448221821,t369:0.02222721367):7.513261064,t370:7.49270457):0.08503740857,(t371:4.660842682,(t372:2.998273447,t373:2.880769955):1.534362574):2.749184436):1.632524792,(((t374:6.806059852,((t375:3.79042358,t376:3.692752342):2.610934554,((t377:6.036021496,t378:5.990103925):0.02953911219,(t379:1.096411158,t380:1.042655172):4.854106938):0.2154505804):0.381776035):0.792788555,(t381:3.345199355,(t382:0.3452761442,t383:0.2346823615):2.955158884):3.732657083):0.2177144553,t384:7.112951918):0.9215379163):0.1152087842,(((t385:3.737922639,t386:3.700544488):3.820194601,((t387:5.221967229,(((t388:1.89027082,t389:1.854245605):0.2068520334,t390:2.008206191):2.208962583,(t391:2.584488439,t392:2.520020016):1.568768065):0.7802811984):1.45314726,t393:6.12097686):0.7665693736):0.1740619571,(((((t394:4.277277567,t395:4.25334284):0.4341002985,t396:4.653519237):1.309525864,(t397:2.188812125,t398:2.160327985):3.605036283):0.3818568965,(t399:1.083833306,t400:0.4764716497):4.934186976):0.3361043541,((t401:0.2692895296,t402:0.2137726985):5.101233973,(((t403:4.411755022,(t404:3.989722246,(t405:2.961741162,(t406:2.443074916,t407:2.017048637):0.4533512609):0.9554362013):0.2424125605):0.4303704037,t408:4.093308409):0.1777877093,(t409:3.819985456,((t411:3.491616999,(t412:3.315823974,t413:3.257762482):0.1308835712):0.005331010775,((t414:0.1058223255,t415:0.05516353649):1.348942984,t416:1.397800048):1.869815205):0.1876462941):0.2795667906):0.2907354197):0.3656476407):0.298719961):0.3755848029):11.38016451):0.5644198491,(((t417:2.117363375,t418:2.078638633):2.357928976,(t419:1.387472197,t420:1.273641882):2.858853258):0.9597674306,((((t421:2.52179692,(t422:1.662968827,t423:1.573222268):0.8309017283):0.2480065167,(t424:1.300028313,t425:0.9990086222):1.335674736):0.5339302769,t426:2.855676856):0.4090299992,((t427:2.204324408,((t428:0.2105152532,t429:0.1373402229):1.806757428,t430:1.941744367):0.1834432246):0.7845037074,((t432:0.2772624954,t433:0.2718562833):1.804356929,t434:2.022339715):0.5687684212):0.2535106304):1.36203668):11.46178441):11.32136262,((t435:1.454313824,t436:1.3057053):0.6434772697,((t437:1.009447489,(t438:0.4936012072,t439:0.3988603135):0.5009363496):0.5037696717,(t440:0.3675593109,t441:0.3522094687):0.8528555489):0.3180799775):24.84599316):38.04944751,(((t442:1.805753994,(t443:1.150535503,(t444:0.6198785647,t445:0.4962356162):0.4869992338):0.5689624424):1.385547998,(t446:1.511096859,t447:1.184743412):1.237646413):2.543249862,((((((t448:0.03697293861,t449:0.03641020138):0.4881775888,t450:0.4028714724):0.8149310259,t451:1.139422675):0.1802900603,((t452:0.622612696,t453:0.6164544405):0.299046941,(t454:0.6891674112,(t455:0.5471530443,((t458:0.1716478238,t459:0.04851658354):0.1625490569,t460:0.1863583259):0.01552751298):0.06461388043):0.1445421242):0.3731216952):0.7205209741,t461:1.497401379):1.275200619,((((t462:1.219457581,t463:0.9656330292):0.085679345,((t464:0.4602759236,t465:0.2816719531):0.4015895723,(t467:0.2405552722,t468:0.1447387792):0.3476068692):0.01607712465):0.0101583933,(t466:0.03781955359,((t456:0.08748985367,t457:0.01133018784):0.06490364668,(((t431:0.07567849776,((t410:0.1075809837,(((t342:0.2548434413,t343:0.2022601552):0.1437755966,(t329:0.04395213389,((t324:0.2256655916,(t320:0.2126144403,((((t234:0.2658946124,(t228:0.1728414453,((t194:0.003243375693,(t164:0.06439874985,((t140:0.169678368,((t116:0.5916028529,(t117:0.01384513961,(((t100:0.03721766857,(((t6:0.01287668948,t1:0.3409046378):0.1707489208,t2:0.4627936317):0.0920389669,t3:0.4877241714):9.50798829):0.5997127284,(t4:9.944007534,(t5:9.764648638,(((t7:0.8077171413,t8:0.7258874039):0.2828958436,((t9:0.03807230478,t10:0.006992861143):0.1306907574,t11:0.1239793805):0.6208772734):0.9159633199,(t12:1.2651565,t13:1.258096369):0.3241989953):7.551669274):0.02758690782):0.6404769606):0.2968321492,(((((t14:4.010910395,t15:3.887103744):1.526229856,t16:5.332841222):3.005234299,(t17:6.25867405,(t18:3.148523157,t19:2.813119513):3.106350173):1.912889916):0.9497616477,(((t20:1.770999852,t21:1.752925799):6.786617926,t22:8.536728758):0.1773833738,((t23:3.114447116,t24:2.920473042):4.996972732,((t25:0.4633528083,t26:0.389344276):1.537898851,(t27:1.43460358,(t28:0.2143851536,t29:0.120292596):0.9806659062):0.1047753147):5.746004369):0.567895153):0.01678612114):0.3817051103,((t30:3.301867962,t31:3.277003933):3.285107279,(t32:0.1316011463,t33:0.0983465452):6.384917426):1.207144408):0.1302411862):0.3771406686):0.501555419):0.5586902399,((((t34:6.118195409,t35:6.072583961):1.283733187,((((t36:4.042284278,t37:4.03338524):0.5568060426,(t38:3.686851411,t39:3.615743349):0.8739631643):0.2403514144,t40:4.619673975):1.932136156,(((t41:4.164185511,(t42:0.8316222383,t43:0.8254226614):3.249755929):0.1029856922,((t44:0.8502952751,t45:0.7740904322):2.743892956,(t46:1.017126327,t47:0.9592372962):2.494467273):0.3062668793):0.8197221765,t48:4.570161447):1.445409584):0.5543704488):0.5122672673,(t49:5.367322606,((t50:2.913941002,(t51:1.987673507,t52:1.791639165):0.8391457965):1.572975649,(t53:4.166677257,(((t54:2.321862156,t55:2.058054677):0.3324061009,t56:2.362784116):1.055970911,t57:3.396999928):0.1777868272):0.01574020889):0.768389581):1.586089943):0.8812783258,(t58:4.904301239,t59:4.903543218):1.749677874):0.2673492852):1.518270855):1.332605996,((t60:6.010781059,((t61:4.662580848,(t62:3.207023005,t63:2.999682392):1.22040934):0.4790761113,((((t64:2.12799441,t65:2.054644826):1.021997753,t66:3.009776366):0.1954814616,t67:3.024963393):1.223997267,((t68:2.402496586,t69:2.387534627):0.3602532948,t70:2.597823973):1.4601136):0.0889921456):0.5284190382):0.3039085846,((t71:2.941797413,t72:2.828661884):0.2647783303,t73:3.012605238):1.700502559):3.427224829):1.383067289):2.888375635):0.3539863891,(((((((t74:1.716594776,t75:1.700574408):0.7455947216,(((t76:0.4623511265,t77:0.195206202):1.342655455,t78:1.534066197):0.1332085189,t79:1.397725036):0.4384865164):0.07529878154,(t80:0.8734223545,t81:0.8668576186):0.9422915792):1.659454062,t82:3.374636655):1.49744341,((t83:2.806003949,(t84:1.870020243,(t85:1.63508755,t86:1.578492085):0.01204766438):0.8664767791):0.5838899685,(t87:1.967855708,t88:1.929004575):1.046992532):1.385720603):2.881069243,((((((t89:1.185300926,(t90:0.8961362708,t91:0.7989175315):0.07373660338):0.3392059908,(t92:0.215494878,t93:0.1143930064):0.9215785869):0.1846788075,t94:1.203315697):0.1949106135,(((t95:0.5623147702,t96:0.4414778473):0.217584093,t97:0.251921675):0.2418745906,t98:0.4200416989):0.3583244692):0.5103475364,(t99:0.5243828026,(t101:0.1940903734,t102:0.1707320866):0.1922596058):0.5084200839):0.2192706669,t103:1.0415494):4.518958864):1.099837363,((((t104:1.17314057,(((t105:0.2453500088,t106:0.03021789154):0.106747663,t107:0.1334215257):0.4305594939,t108:0.4926634657):0.267519035):2.246223409,((t109:0.2493464076,t110:0.2051005978):0.6412633109,t111:0.7967135265):2.102983401):0.5337284846,(t112:3.126469785,(((t113:0.7044593873,t114:0.4362713392):1.096643009,t115:1.450188645):0.03573951865,t118:0.2192093096):1.258947123):0.2485845825):1.247853977,(t119:1.537009236,t120:1.441598825):1.432059086):1.399046052):3.043548882):2.918102517):0.8816090476):0.06741114689,((t121:8.46238114,t122:8.434633948):2.432109821,(((t123:0.7920544356,t124:0.7845233147):2.458582898,(t125:0.4339899394,(t126:0.202370599,t127:0.1348063155):0.1733989809):2.801112751):3.427344845,(t128:0.4654336388,t129:0.4574280049):5.932948496):4.156920561):0.0009211747415):7.303343657,((((((t130:8.678537791,((t131:4.2873338,t132:4.187345286):4.146769701,(t133:2.331843429,((t134:0.04529878761,t135:0.04231564825):0.3732040572,t136:0.3738714563):1.858889597):5.987453713):0.1362045192):0.9266168435,(((t137:1.140412095,t138:1.125257518):6.130662082,t139:7.168625698):0.9509179252,((t141:5.798708345,t142:5.425993267):1.425249966,(t143:6.176514859,(((t144:2.306858081,t145:2.211574936):3.470436106,(t146:3.793885804,t147:3.732611196):1.675126989):0.06612748199,t148:5.450020164):0.3096110474):0.513028188):0.3922291937):1.028692801):0.01846454954,t149:7.666071828):0.156321924,(t150:6.272757286,t151:6.23291921):1.456570899):1.161650491,(((((t152:6.740513351,(t153:0.850260175,t154:0.8331832715):5.869378784):0.4699661447,(t155:6.637330434,(((t156:5.344073635,((t157:2.988089387,(t158:1.965754783,t159:1.957283814):0.875548447):0.2355582804,(t160:0.7892123493,t161:0.6796359024):1.942173213):1.987523103):0.5102817075,t162:4.94731726):0.5461965941,((t163:4.882999952,((t165:4.365498634,t166:4.338872496):0.3023814584,(t167:4.081892021,t168:3.965671736):0.5205827504):0.09022458724):0.02889722429,(t169:3.840565349,t170:3.74581919):0.7278803462):0.4560861693):0.1664171565):0.4864859282):0.4977200879,((t171:4.141286804,(((t172:1.157893323,t173:0.716608582):2.391050145,t174:2.990055498):0.1510709734,t175:2.986328517):0.3826841371):1.198537432,((((t176:3.206098551,t177:3.156173007):0.7582218439,(((t178:0.3477414138,t179:0.2848083405):0.005151979243,t180:0.2099040975):1.547774171,(t181:0.9086149374,t182:0.906925671):0.7419431145):1.999864768):0.08823909746,(t183:3.410879151,t184:3.38872839):0.2053823325):0.3427847427,((t185:0.3351103025,t186:0.3229798241):1.937999941,t187:2.156161258):1.205875625):0.114598082):0.7221551152):0.6117500964,(t188:3.626117817,(((t189:0.09998003114,t190:0.06388058653):2.912913472,t191:2.880313135):0.3049064156,((t192:1.607526475,((t193:0.1434503995,t195:0.05568568607):0.6321071382,t196:0.6508605231):0.6590094749):1.057183482,(t197:0.9367097992,t198:0.7285783476):1.415428309):0.4774659153):0.02237270204):1.162166001):0.1713532122,((t199:2.580607643,t200:2.466772717):0.5075965613,(t201:2.780550056,((((t202:1.908631649,t203:1.85527222):0.06130423891,t204:1.874039015):0.1487966454,(t205:1.859425713,t206:1.816122809):0.09498405349):0.4666850206,(((t207:1.154080815,t208:1.099066623):0.4088437492,t209:1.331229618):0.5794260672,(t210:1.324414587,(t211:0.7169832344,t212:0.7083877329):0.5662660281):0.5011490025):0.2241164298):0.1262299197):0.18384412):0.8455843938):0.3439327829):3.050740938,(((t213:0.454613489,t214:0.3711814256):2.871052768,(((t215:1.263228456,(t216:0.8262220255,t217:0.6829549784):0.2941787618):0.5954884263,(t218:0.5509659018,t219:0.521715347):0.5501251572):0.5191174932,t220:1.485131224):0.7931650275):0.9988827773,(((t221:0.2680038154,(t222:0.07683438906,t223:0.03757787687):0.114273557):0.1630125327,t224:0.1472082421):2.310547874,(t225:1.981922299,(t226:1.831555136,(t227:0.797556078,t229:0.409489735):0.8644857441):0.1404966662):0.3996063134):0.5252397461):2.035796352):3.812615987):1.612259863,t230:9.489113866):0.2028642797):0.7022659774):0.111634191,(((((t231:0.1317140954,t232:0.02185121652):0.8268474524,t233:0.805141655):0.8689264515,t235:1.199060494):5.239359326,((t236:2.086065899,t237:1.500687233):1.600783226,t238:2.82537501):2.729503457):2.949317877,t239:8.486167145):0.4693552535):0.3094539955):1.284589112):1.069952799,(((t240:9.572054206,((t241:0.7807058451,t242:0.7418643903):7.468300843,t243:8.002631863):1.232122486):0.9424980669,(((((t244:5.334574608,t245:5.333259962):3.365550055,t246:8.690016494):0.5296616187,(((t247:1.474982914,(t248:0.7010796673,t249:0.619200127):0.7331177277):6.497758661,t250:7.804006724):0.539873273,((t251:1.576502831,t252:1.365623073):5.06774473,t253:6.362477504):1.666277478):0.683003406):0.207163004,((t254:4.962147397,t255:4.598690708):3.375837913,((t256:7.359908719,(((t257:5.119837619,t258:4.844721973):1.53142699,(((t259:2.888809475,t260:2.854210013):1.724422144,t261:4.525078119):1.113176204,((t262:3.004856877,(t263:2.93381888,t264:2.856006421):0.02921717802):0.01410186009,t265:2.799742011):2.573447143):0.6480134094):0.570460298,t266:6.543260013):0.004972121508):0.4151967131,t267:6.936594934):0.08519212943):0.4386147498):0.6347238498,(t268:7.320313388,(((t269:4.865764215,(t270:0.5744813576,t271:0.5012652867):4.261852472):1.936291657,((t272:5.698896066,t273:5.64318185):0.902956562,((t274:4.037897371,(t275:2.473093832,t276:2.336338351):1.534364039):2.274121061,(((t277:4.225413219,t278:4.195814755):1.503175741,t279:5.469143408):0.1828989548,(((t280:1.648520418,t281:1.504778654):3.345575414,t282:4.550988454):0.2695000361,(t283:4.195326605,(t284:1.203808233,t285:0.9305467309):2.942249359):0.3354247567):0.1957753144):0.2265163745):0.05934391817):0.0159240289):0.3684499245,t286:5.068209638):0.1347260535):0.7422395926):0.0003615918074):0.7094101243,(t287:6.328175961,(((((t288:0.5524694181,t289:0.3826349021):3.261721582,t290:3.357429213):1.209415106,((((t291:0.3990748568,t292:0.1354282891):1.511517042,t293:1.646254407):1.047015946,t294:2.423693241):0.4643749133,t295:2.794619021):1.086781628):0.9405912308,t296:4.820906598):0.1176851314,((t297:0.7571868938,t298:0.3857992645):2.968959554,(t299:2.71294218,t300:2.70504903):0.5705642475):1.160433343):0.2000421266):0.24040935):0.2921526244):6.295417231):0.05463747691,(((t301:4.296128952,(t302:1.662818671,(t303:0.5771223792,t304:0.4249369852):1.024251175):2.131629388):1.29033901,t305:4.866724542):0.2731795008,((t306:0.132497336,t307:0.00780928624):3.145083003,((t308:1.13939054,t309:1.121827719):1.634083178,t310:2.651910579):0.335797005):1.859582273):5.635811448):1.432460929):1.140296001,(((t311:2.988375668,((t312:2.281537884,((t313:1.669986251,((t314:0.2727076616,t315:0.2523118704):0.7407216849,t316:0.9022120377):0.6313508337):0.4695428537,t317:1.985441553):0.1136952292):0.3952668206,(t318:2.049000927,t319:2.014206522):0.3664765461):0.2858768815):0.3047507135,(t321:1.400954196,t322:1.334195763):1.194966759):6.900639435,(((t323:0.6923062247,t325:0.05240121668):0.4058687323,(t326:0.3135808091,t327:0.2788194073):0.09969166341):0.4430150666,t328:0.8032027573):7.794530156):2.777158662):0.6457525515,((t330:2.544840709,(((t331:0.9284595985,(t332:0.177675687,t333:0.05802620413):0.729731015):0.4671792522,((((t334:0.3408760459,t335:0.2718379766):0.03051102297,t336:0.2805864389):0.1304787124,t337:0.3759017274):0.6625550005,(t338:0.3838664773,t339:0.3218811578):0.6316132668):0.05403295681):0.3279900423,t340:1.303584503):0.8052582676):6.853408356,t341:8.904159208):2.464141678):0.4848661835):0.8712132028):0.6326649534):0.4067410091,(((((t344:0.2242525354,t345:0.2040181913):0.2052779588,t346:0.3099090134):0.2654139221,t347:0.5183256475):3.102093159,(t348:2.484763896,(t349:0.8528677465,t350:0.5359652506):1.323478454):1.042648052):8.636624267,(((t351:3.274227805,(t352:0.40257463,t353:0.07190781882):2.82502032):2.918238214,(t354:3.817721856,((t355:0.3346405667,t356:0.2069625831):0.2420060738,t357:0.2908094614):3.17273983):1.755230705):2.799694168,(((t358:0.4465443998,t359:0.4430978664):3.017864066,t360:3.455967935):3.785283453,(t361:6.213613822,t362:6.205319266):1.012700453):0.6125389229):2.463664548):0.403692426):1.030636862):1.232122718):58.68277414);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T51.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
