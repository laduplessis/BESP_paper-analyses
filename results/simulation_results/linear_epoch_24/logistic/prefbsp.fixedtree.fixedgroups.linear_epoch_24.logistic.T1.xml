<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(t471:72.42547225,((t472:12.07333001,((t473:0.8345950356,t474:0.7905638468):3.244905495,((t475:0.6089766029,(t476:0.1157440274,((t463:0.1344678358,((t453:0.05864571097,(t445:0.2056712233,(t355:0.1503344661,(((t350:0.2356143725,(t344:0.3352811422,(t345:0.1905323516,((((t326:0.2113927991,(((t307:0.2605745278,(t303:0.07932291837,(t258:0.1911933315,(t235:0.09920541854,(t234:0.230809624,((((t181:0.1102289851,(t150:0.1526051571,((t142:0.004477750381,((((t99:0.1092961624,t100:0.04443096257):0.1546613081,(t17:0.3031226701,(t10:0.1530568759,t1:1.215344523):0.9691930502):8.712530574):0.06989082974,(t2:10.8227397,(((t3:1.346548965,t4:1.19892603):8.173320436,((t5:8.915243581,t6:8.904844717):0.1297498308,(t7:7.641661962,(((t8:0.1966715632,t9:0.09946235079):4.054518575,(t11:0.3097312904,t12:0.2078588374):3.355607278):1.894949825,t13:5.426449219):1.316051056):1.227235993):0.1885955118):0.587884257,(((t14:5.860515281,t15:5.749168615):2.084696761,t16:7.823411291):0.6425704748,t18:7.761847276):0.1432964688):0.5484493579):0.07844774093):0.5183647867,t19:8.977552785):3.473201368):0.04932288838,(((((t20:7.121430945,t21:6.754382049):0.1997377444,(t22:2.332386148,t23:2.321983858):4.378915143):2.12939834,(t24:2.918369677,t25:2.911865659):5.884626401):0.2389052274,((t26:6.73356768,((t27:6.461011515,(t28:5.389291664,((t29:1.071059038,t30:0.8391999116):4.043837259,(t31:2.611195038,t32:2.609642341):2.226950154):0.1725171479):1.066574031):0.197500988,((t33:4.515238889,t34:4.504105792):1.541234523,(((t35:3.322713577,t36:3.270463006):1.068894679,t37:4.221967322):1.158191137,t38:5.262602134):0.4398159693):0.2091499739):0.01516804493):1.062361172,((t39:5.140817855,t40:5.047101458):1.551495129,(t41:3.135097921,t42:3.115733107):3.388215467):0.1863742681):1.043864475):1.202530088,(((t43:5.965284203,(t44:1.783678906,t45:1.763867865):4.075128338):1.43783306,t46:6.961464995):0.9185134023,(t47:4.607317439,t48:4.443742887):3.026123896):0.44784429):1.554220209):0.7604748917):3.40735941):1.413214229,((((t49:2.294962863,t50:2.059848879):1.823652293,t51:3.803472495):2.971378233,(t52:5.676364128,(t53:4.712216865,((t54:3.262636838,(t55:2.811714389,t56:2.688114806):0.185891275):0.1810500385,(t57:0.6362668514,t58:0.5313521098):2.342738912):1.151316365):0.7366834095):0.7617278939):5.046589657,(((((((t59:0.4794234956,t60:0.4793512692):2.658215377,(t61:3.020289885,t62:2.638295426):0.06685492542):0.2152793524,(t63:2.193128303,(t64:2.051249532,t65:2.037190775):0.1417912916):0.5786085116):0.2369227667,(((t66:0.7011481614,t67:0.6763126549):1.045637275,t68:1.536914964):0.5566740411,(t69:1.959858881,(t70:0.9225059175,(t71:0.8569785893,t72:0.8205105439):0.0009508453453):0.8914369088):0.1333690517):0.5605536658):0.1933582286,(((t73:1.609197103,t74:1.553028563):0.3460519044,((((t75:0.276752039,t76:0.219256864):0.2274252993,t77:0.4304904843):0.3606847237,t78:0.7468461705):0.4729183391,(t79:1.050547054,t80:0.9888938199):0.03973696522):0.4513061071):0.4394398416,(((t81:1.310158542,(t82:1.160610233,(t83:0.8486401679,t84:0.2263901385):0.1827556891):0.02567897969):0.3993183402,t85:0.7766357969):0.0009921474673,t86:0.7752699758):0.1053056951):0.02222994192):3.114696762,((t87:0.1573502259,t88:0.1411279948):1.862311722,(t89:1.150615242,(((t90:0.4450221448,t91:0.3979803068):0.6130681715,(t92:0.4538482029,(t93:0.2739318575,t94:0.2736798388):0.09495161885):0.5565536572):0.02232823279,(t95:0.8218621249,(t96:0.6836844095,(t97:0.3906008156,t98:0.3783460336):0.2267475409):0.09768930739):0.06290932991):0.0657995349):0.7792910752):1.972871825):0.04313594534,(((((t101:0.1050257977,t102:0.03689294825):0.2041066006,t103:0.1629796403):0.2919455859,t104:0.4140871029):0.7284285968,t105:1.043883612):1.218096131,((t106:1.025176926,(t107:0.5251692165,t108:0.2875233143):0.06512322739):0.6760682344,t109:0.8047319):0.5196872981):0.6593931277):3.517020945):2.905490111):1.27136262,((t110:6.738824654,((((((t111:0.371368913,t112:0.1437320123):0.08507189332,t113:0.2028820351):0.3824025658,t114:0.3134298943):0.995884982,t115:1.306055951):2.275658061,t116:3.580656677):1.831782301,(t117:0.4906783047,t118:0.447818038):4.74964051):0.6768561649):2.129783598,((t119:0.7585638145,t120:0.7419010878):6.797799244,((t121:0.4283498894,t122:0.3357587867):2.913624083,t123:3.130677092):4.161283037):0.3642940228):0.7839860575):1.063249731,(((t124:4.083942477,(((t125:0.3008718145,t126:0.1551615636):0.4438883309,t127:0.5866267429):1.591528789,t128:2.158087504):1.672039055):2.987409802,(t129:2.262727304,t130:2.241624581):4.554623675):2.188016937,(((t131:7.137168546,(t132:5.311090046,(t133:2.378720449,(t134:0.4692554456,t135:0.2748511094):1.83423495):2.912226198):1.762225023):0.7894756644,t136:7.352920781):0.9405572933,(((t137:0.1681414738,t138:0.03550277347):7.0102396,(t139:3.567394077,t140:3.378492607):3.369308769):0.5807813248,t141:7.328054377):0.533315891):0.06377702046):0.2026463783):0.2607381084):0.1733376513):3.057778183):3.419488187):0.586800127):1.42926899,((((t143:6.119647818,(t144:5.77633254,t145:5.473729297):0.3237363614):0.8553325308,((t146:4.999115576,t147:4.974325209):0.1122995184,t148:5.023198895):1.475009748):0.04289928518,t149:6.52137833):0.8522561637,((t151:4.861400106,t152:4.859699931):1.849934545,(t153:6.70080697,(t154:0.4890349462,t155:0.4606557504):6.19821794):0.008796976869):0.2549281366):8.981119054):0.444773677,(((((t156:2.413434729,t157:2.293539693):4.231561376,((((t158:0.7511199261,t159:0.4076592363):4.000606151,((t160:1.533498859,t161:1.476930217):2.60321137,t162:4.071457182):0.161729156):0.4257446081,(t163:4.330544662,(t164:3.00901606,t165:2.902168876):1.104662978):0.150133929):0.8620992432,(t166:1.453851585,((t167:0.6608543397,(t168:0.4106466039,t169:0.3281678129):0.1800387028):0.6207264359,t170:1.022435677):0.03310906086):3.427064013):0.2185335681):0.05779216217,t171:4.633584782):0.1190710423,(t172:4.133006473,(((t173:2.362783717,t174:2.359174654):1.285217626,((((t175:0.7705358016,t176:0.6806670656):0.8409093978,t177:1.377350593):0.1276345398,t178:1.484668959):0.4104968844,t179:1.79220098):1.44651956):0.1158282778,t180:3.292727351):0.2927811218):0.5689455578):8.536330619,((((t182:1.106573641,t183:1.080450186):1.538803304,(t184:2.178232908,(t185:1.148770873,t186:1.146858828):0.9303536499):0.4157433737):1.45255913,(((t187:0.2656890841,t188:0.2451639215):1.048877411,t189:1.241555004):2.376421878,((t190:2.842730992,(t191:2.319406583,t192:2.278545474):0.5170628047):0.08088802944,t193:2.838110609):0.5470862727):0.1867515724):0.3254445877,(((t194:2.023614208,(t195:1.362530918,t196:1.208210341):0.5845808049):0.6969350695,(t197:2.144437815,(t198:1.232075949,t199:1.074866553):0.8738310628):0.3305076816):0.9161135431,(t200:1.296527536,t201:1.292014987):1.82035979):0.2023891833):7.77737061):0.8250883931):0.8236385481):0.8297241648,(((t202:1.650422713,t203:1.597634547):0.8171112033,(((t204:1.267761321,((t205:0.5480309803,t206:0.5229392433):0.2939230559,t207:0.755914278):0.3399502218):0.6467308985,t208:1.584317668):0.02798747263,t209:1.568733264):0.4387594116):1.624929261,(((t210:2.096621868,((t211:1.421347417,t212:1.215846869):0.4394177342,t213:1.357973547):0.1906559625):0.3332275089,(t214:1.51117891,t215:1.423481768):0.2139214386):1.027281657,(t216:0.4642053947,t217:0.420666923):1.878950542):0.1670935124):9.47484745):0.3772513527,(t218:5.469093009,(t219:1.830059778,(t220:1.055696224,(t221:0.5225532956,(t222:0.02948416,t223:0.01112807424):0.4682523856):0.4940620671):0.6193055859):3.605966355):6.782567505):0.5965989577,((((t224:0.3293712757,t225:0.2661495048):1.097774066,((t226:0.3458865473,t227:0.3354546187):0.5484637748,(t228:0.8241373374,(t229:0.6690198365,t230:0.5452320702):0.09754450745):0.04615208429):0.4057066788):0.09531748399,t231:1.106511923):3.137998695,t232:4.167483864):7.844039924):0.02383720534):0.1344306627):0.7214508535):0.3641138713,((((t233:2.206932532,(t236:1.390208935,(((t237:0.08330620137,t238:0.07236568361):0.3816280219,t239:0.3187202964):0.1429587277,t240:0.1362963952):0.6220073699):0.3235006854):0.505303651,t241:1.419970259):0.1665249002,(t242:1.17335512,(t243:0.0984238232,t244:0.03577942769):0.8032335573):0.3263566447):9.932724602,(((((t245:0.3328073176,t246:0.3075618802):0.2541270643,t247:0.528892543):0.04850333613,t248:0.4648628039):5.614631486,((t249:1.119589387,(t250:0.4149061571,t251:0.10450711):0.5572791803):1.609096544,t252:2.088205797):3.302726582):4.487033218,(((t253:8.188144137,((t254:6.229661507,(t255:6.003169873,((t256:1.534731162,t257:1.452571707):3.00236365,t259:3.671168475):1.460010574):0.1909561948):1.827412877,(t260:1.986577332,t261:1.956381488):5.154201155):0.07976343856):0.1074584322,(t262:2.497437528,t263:2.433460572):4.65537486):0.639647803,(((((t264:1.386048539,t265:1.354980261):1.701782727,(t266:0.1140472346,t267:0.07742437319):2.761980529):0.3459189916,t268:3.142738435):2.441203006,t269:5.459012596):1.673754245,(t270:6.204447865,((t271:3.320114469,t272:3.291733277):2.234484909,t273:5.477213052):0.6283951128):0.839725516):0.1350510462):0.8613579537):0.3005332016):0.4288436848):0.3500772147,((((t274:0.8627222196,t275:0.8592736313):2.976926173,t276:3.792282616):1.422341432,t277:5.167465342):2.096000914,((t278:1.449632314,t279:1.442811416):5.633424488,((t280:1.071248725,t281:1.008608056):3.104875353,t282:4.01880969):2.74607608):0.1675992158):1.656855291):0.4065606449):7.513434035):0.5836496862):0.9144717081,(((((((t283:8.296194459,(((t284:6.842955803,((((t285:1.328737488,t286:1.191668349):1.726137644,t287:2.871998402):1.09554313,((t288:2.639725632,t289:2.598304583):0.5351118543,t290:2.962193348):0.521165954):1.975007573,(t291:5.164837526,t292:5.124774868):0.2173583032):0.7051835551):0.1200322874,(t293:5.138854921,((t294:4.817061084,t295:4.723238289):0.01478338211,t296:4.667539553):0.2636971914):0.8632122986):1.102429921,t297:6.697467161):0.2193398057):0.2657918168,(t298:5.128706349,t299:5.115883817):1.881438478):0.6157927951,(((((t300:1.065203947,t301:1.061702252):4.603043858,t302:5.529259692):0.6431029948,(((((t304:0.1698477357,t305:0.1524656211):1.24515591,t306:1.374641752):1.714179112,(t308:2.530502212,t309:2.212327749):0.02691784244):1.486969487,t310:3.370516144):1.049815419,((((t311:1.538170579,t312:1.416882941):1.803035534,t313:3.128230747):0.1988878873,(t314:0.6352557174,t315:0.5796942708):2.644632564):0.6115471931,((((t316:1.380888989,t317:1.309396954):0.5800457874,(t318:0.8413310194,t319:0.7701766899):0.9655352516):0.2863948535,t320:1.752279284):0.5531590019,((t321:1.457244198,((t322:0.4133183369,t323:0.3808545004):0.6468675057,t324:0.9946210588):0.2106554095):0.3232324512,t325:1.224870196):0.3994702555):0.9150351111):0.2381862434):0.2810747145):0.7355469562,(((t327:0.2246948812,t328:0.2237525341):1.029838997,((t329:0.1073849426,t330:0.01779264783):0.3796102751,t331:0.1104105169):0.2487951714):1.2281028,((t332:0.3719820494,((t333:0.2801605305,t334:0.1937685237):0.06709790008,(t335:0.2444121303,t336:0.215934916):0.0007847674055):0.01901795481):0.5984654204,t337:0.829649072):0.5278393343):0.9892484534):0.186813373,(t338:1.201143723,(t339:0.5328971316,(t340:0.06921958805,t341:0.06729480413):0.4352709068):0.3797559295):1.328726277):0.3275642433):4.321395231,(t342:1.032174117,t343:0.954042928):5.746929968):1.583386472,(t346:1.705014445,(t347:0.5530400393,t348:0.4343959415):0.8797271387):6.235592387):2.507342598,(((t349:2.09267537,t351:1.720366771):2.235972928,((t352:0.4728199402,t353:0.3028696598):0.261319746,t354:0.3900762939):2.813931649):5.573436973,t356:8.472801606):0.08302739711):0.3960975296,((t357:8.60364668,t358:8.474893887):0.1716396855,t359:8.623703047):0.09269020031):0.005719406665):0.2234969841):0.4399565407,(t360:0.4139747972,t361:0.2982138212):8.872951457):1.151923489):0.3248510215):1.030875073,(((t362:7.062997372,(t363:0.9714510817,t364:0.9375443546):5.991637607):3.122918408,(t365:8.526168058,t366:8.369890228):1.469915854):1.105182201,((((((t367:0.06314173753,t368:0.01761268259):6.817772611,(t369:1.699051764,t370:1.611380188):4.937435249):0.5518283685,t371:7.063276722):0.2224426534,t372:7.254154043):2.323263958,(t373:1.485728251,t374:0.8179710338):8.050188128):0.07553231508,(((t375:1.768976071,t376:1.751567168):5.139241062,(t377:4.859484401,t378:4.728158752):1.996297935):1.37724069,((((t379:3.754260642,(t380:3.676029811,t381:3.567489187):0.02337689461):0.8293237372,t382:4.25211684):1.986523267,(t383:6.19735487,(t384:3.62127469,t385:3.595221288):2.574114052):5.619297153e-05):1.031040256,((t386:4.294678863,(t387:1.154102878,t388:1.145631509):3.123834245):2.884464,((t389:0.09482865475,t390:0.08952297943):2.627281358,t391:2.656834494):4.347693624):0.001108415659):0.4916753056):0.6257064236):0.8668192963):0.3240496019):2.358835324):7.921341338):13.95483835,((((((((((t392:0.8444068972,t393:0.8344639605):1.264815006,t394:2.074480621):2.928977414,t395:5.00326546):0.5693094882,t396:5.56095161):0.8416949921,((t397:1.370707298,t398:1.247874654):0.2375922242,t399:1.432988497):4.790746193):1.330154188,(t400:4.337885072,t401:4.305356178):3.120602725):0.06197418176,((t402:5.242802528,t403:5.20218739):1.455261092,(t404:5.779496194,(t405:5.021652353,((t406:3.784750575,(t407:0.4351910355,t408:0.4219607765):3.056777823):0.03049288178,t409:3.256152274):1.205926487):0.6606552621):0.5193196626):0.7782098262):0.327426008,t410:6.723066369):0.02833701491,((((t411:3.577743417,t412:3.502163861):0.7204426761,t413:4.208624858):0.562480036,t414:4.626030636):1.617726082,(((t415:3.235974209,t416:3.210174381):2.173094609,(((t417:3.321527808,(t418:0.9204132449,t419:0.9070517722):2.344859326):1.197477656,t420:4.427072863):0.3083150795,((t421:3.665019405,t422:3.624846664):0.4951394176,(t423:2.319716283,((t424:1.395636533,t425:1.362421749):0.8028967574,t426:1.920810913):0.1009805725):1.790136024):0.5009364524):0.4774466574):0.0975231963,((((t427:0.3856713564,t428:0.3495377621):0.006274468173,t429:0.1715501068):2.562079589,t430:2.616563407):1.682169727,(t431:3.123128604,(t432:2.798866994,(t433:2.204888597,(t434:1.913506185,t435:1.77355):0.2351949032):0.3157543467):0.278630039):0.9525648132):0.1683533363):0.6674433627):0.1413660451):22.6823334,((((((t436:1.829360169,((t437:1.072830627,t438:1.018842207):0.1685073809,(t439:0.4749958008,t440:0.4008068787):0.5070196299):0.5522828854):0.2261529781,((t441:1.197295855,t442:1.175413625):0.02898354834,t443:1.173850657):0.3140470224):0.5526462178,t444:2.019378281):0.4931766956,t446:2.080707217):1.653910636,(((((t447:2.30164603,t448:2.298894506):0.1267646927,(((t449:1.456985486,t450:1.422466819):0.2650023922,(t451:0.7292747893,t452:0.6814325903):0.9406282043):0.3950919032,((t454:0.731298068,t455:0.6587058455):0.6463123578,t456:1.031131932):0.4408348808):0.2027847213):0.1479729471,t457:1.813662628):1.023691498,(((t458:0.7222169244,(t459:0.5989173624,t460:0.4324560386):0.05984266906):0.3561149914,t461:0.6984829155):0.745537255,t462:1.335665897):0.9200471892):0.009454682198,((t464:1.64472131,(t465:0.4973992597,t466:0.3499369215):0.9893194266):0.2885600528,(t467:0.9406307427,t468:0.9380974275):0.3445921062):0.1164241205):0.005499619658):2.352302692,(t469:1.720341038,t470:1.719822925):1.855051082):20.10313948):2.644857318):46.2552059);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T1.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
