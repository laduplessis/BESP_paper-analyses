<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t456:1.179862697,t457:1.15690917):0.04151594002,(t458:0.2278529435,t459:0.1407827523):0.8945733114):12.49016006,(((t460:0.8444633626,(t461:0.1566894986,t462:0.04864823403):0.5778706285):1.37255249,t463:1.906510536):10.64002257,((t464:0.3036331724,t465:0.2839914816):0.839981347,(t466:0.2933491156,t467:0.2389551089):0.7721940713):11.30478981):0.6212929086):12.61108256,((t470:0.3119495273,t471:0.05186818025):2.253218707,((t472:0.6124545962,((t468:0.5115179431,t469:0.2386359276):0.01882347768,(((((t384:0.1215691096,(((t347:0.05862236183,(t346:0.1318071959,(t338:0.3307226201,(((t228:0.2089178891,((t129:0.02452320594,(t99:0.09525534557,(t98:0.0001068300535,(((t70:0.009869715084,(((t9:0.0287657263,t1:1.216981661):1.543609559,t2:2.74260583):1.502959255,t3:4.14478694):3.765608144):1.645084472,(t4:4.235949885,t5:4.182820127):4.791246661):0.8109798845,t6:9.654704402):0.1814731902):0.2017575908):4.053972802):7.544729901,((((((((t7:7.398930617,t8:7.188342885):2.041398764,t10:9.105070241):1.044518514,t11:9.965029928):0.2555692443,((t12:3.653528571,(t13:0.3690300156,t14:0.2916892661):3.27989059):5.920297604,((t15:2.44168532,t16:2.400192253):5.649916382,(t17:2.978713754,((t18:0.3197545156,t19:0.2595137402):1.058618357,t20:1.226302384):1.483770698):4.848166436):1.263445959):0.5219310999):0.7282506239,((t21:7.517524819,((t22:6.70327327,((t23:2.492998981,t24:2.461791365):2.139070916,(t25:1.004817538,t26:0.9881878943):3.570799038):1.754205371):0.3730655977,(((t27:0.5238250371,t28:0.5211462428):0.6287075989,t29:1.114445764):4.112561569,t30:5.182680515):1.240008421):0.4307903263):0.696885124,(t31:4.457930803,t32:4.430767737):3.067253071):1.726286648):0.983511715,((((t33:6.978039393,(t34:5.226618122,(t35:4.910918958,(t36:1.052019654,t37:0.8073536528):3.784281426):0.3120111427):1.74723718):0.07297541864,(t38:1.798766346,t39:1.791732246):4.835312977):0.2387453421,t40:6.800222095):0.550124612,((t41:6.763776512,((t42:5.259571291,(t43:0.4651462411,t44:0.3347132405):4.291259935):1.45088649,((t45:4.434687253,t46:4.355627348):0.881399155,t47:5.124920667):0.7269017316):0.03754718471):0.3785076552,t48:6.034623616):0.2038026959):2.201441743):7.368903267,((((((t49:6.265169756,((t50:4.909185252,((t51:0.9566125232,t52:0.9276307071):1.239161957,(t53:0.7654597315,t54:0.642654937):1.214904405):2.494792912):1.076133354,t55:5.331918745):0.1804397415):0.4387757566,(t56:5.292526176,(((t57:4.20337951,t58:4.050068039):0.02534655964,(t59:3.277133154,t60:3.08435165):0.7397782897):0.8006753189,t61:4.582244626):0.1342671312):0.4542428163):0.5846185087,((t62:1.634974458,t63:1.609798479):1.142381658,(t64:0.6671610519,t65:0.6280059584):1.962211071):2.837314258):0.1200028349,((((t66:2.485008042,t67:2.107810727):2.074783485,(((t68:2.943447275,(t69:1.986409176,(t71:1.551391924,(t72:1.48090995,(t73:1.177653055,t74:1.094486805):0.2245280589):0.06753278653):0.1755720476):0.928009363):0.1262482201,((t75:2.041685253,t76:2.025845407):0.1412254786,(t77:1.331464623,t78:1.31397976):0.7641936026):0.3032727289):0.2641070784,(t79:1.727272635,((((t80:0.2341984575,t81:0.1175458808):0.7369916133,t82:0.7700145469):0.2576361109,t83:0.9001565312):0.1644413776,(t84:0.9128364404,t85:0.8925655801):0.06667342594):0.2860176762):0.7069068434):0.4466961342):0.1647091797,(t86:0.2738553409,(t87:0.1987571863,t88:0.1661042024):0.001837818401):1.972359693):0.4353288256,(((t89:0.3378468981,t90:0.3009724711):0.2507990138,(t91:0.4043612796,t92:0.3975637843):0.02078357682):1.694102939,t93:2.075183752):0.2034901275):0.1572321631):1.136261871,t94:3.428054119):3.855015454,((((t95:0.07324860978,t96:0.0587047747):0.378156452,t97:0.1672607003):1.253791495,t100:1.015650015):2.613339578,(t101:0.9902193338,(t102:0.7962086375,(t103:0.4856084879,((t104:0.139708809,t105:0.003525548533):0.245702524,t106:0.2381915433):0.05132027841):0.2999942765):0.180840345):2.30926897):2.813043194):3.305138608):1.24529503,((t107:1.931496755,(t108:0.6025740503,t109:0.5052976001):1.010637113):6.794031288,((((t110:0.03730889665,t111:0.01931797595):0.6072484945,t112:0.6237978584):4.41705425,(t113:0.580988163,t114:0.2621321435):4.30459659):1.315122575,((t115:1.096031884,t116:1.094149403):3.893195836,t117:4.959594292):0.8403152795):1.533520101):1.645828557):0.4422391866):0.3029109431):0.3276961997,(((((t118:8.016050172,t119:7.859119023):0.5139607907,((((t120:2.45031195,t121:2.441632181):5.213810862,(t122:6.345409913,t123:6.046297414):1.305823577):0.4327409394,((((t124:3.823072646,t125:3.487256198):2.219642877,t126:5.59588218):0.7960197516,t127:6.359483309):0.3302795818,t128:6.521522424):0.546981763):0.02283764832,(t130:0.2045581483,t131:0.1781246576):6.632088721):0.03956889682):0.8791061015,(t132:6.844880588,(t133:2.384297901,t134:2.369792806):4.227605106):0.8434065817):0.07528542138,(t135:5.115156075,t136:5.079184905):2.385908189):0.1168215422,(((t137:5.504281496,(t138:5.034562569,(t139:1.744274666,t140:1.551521797):3.273306753):0.4532141818):1.648158774,t141:6.910866999):0.3047272984,((t142:1.837849733,t143:1.813677332):0.527109057,(t144:0.07688116743,t145:0.05768718752):2.211680027):4.755082456):0.09253348184):0.04353513722):2.208943736,(((t146:3.548241269,(t147:2.812549761,t148:2.691704626):0.5959124486):3.244515225,t149:6.480901796):1.156597719,(t150:5.800040802,(t151:2.894490374,t152:2.825093744):2.828690495):1.806483287):1.361846543):8.543835371):0.743130196):0.1430702379):0.8538730752,((((((((((t153:0.8205673126,t154:0.8062710198):0.477503298,t155:1.281992753):4.37798373,(t156:3.51822996,t157:3.423307034):2.126194119):1.138625855,(((t158:4.461784249,t159:4.230319736):0.602973001,((t160:4.131299374,t161:4.060535534):0.502285782,(((t162:1.508901738,t163:1.307951104):1.508179555,t164:2.680241783):0.6655400929,t165:3.21214864):0.781383579):0.1956891817):0.2149339708,((t166:3.002200803,t167:2.908368582):1.107783393,t168:3.953759739):0.0812290573):1.326678484):0.7614399994,((t169:2.130020392,t170:1.977895311):3.259896576,(((t171:2.210317127,t172:2.131680965):1.073035321,(t173:2.94465813,t174:2.711722446):0.1725030509):0.3753364737,(t175:1.92009656,t176:1.852768585):1.186201212):1.514126029):0.6663172168):1.157192595,((((t177:2.27579908,t178:2.267271896):0.8952186049,t179:3.109510148):1.34829574,(t180:2.268968423,t181:2.230783649):2.179828986):0.2513979995,((((t182:1.585668725,t183:1.530923648):1.590859392,(((t184:0.5295193433,t185:0.5108634057):1.503077079,t186:1.947436864):0.6461368966,(t187:2.258552026,t188:2.233741929):0.1166114267):0.4368222861):0.09794655087,(((t189:0.644385461,t190:0.6214762258):1.097585358,t191:1.590894837):0.5236212738,t192:2.098914877):0.6123320902):0.4379400893,(t193:2.555862396,(((t194:1.664398477,(t195:1.527769376,t196:1.390987641):0.06755742391):0.5805638053,(t197:1.042225456,(t198:0.5776311078,(t199:0.09762970486,t200:0.053833946):0.4066086089):0.4136915273):0.9888765851):0.1141250811,(t201:1.460529023,(((t202:0.656491919,t203:0.6318684021):0.2012636369,t204:0.7512743698):0.1441468009,t205:0.8789397194):0.4512869569):0.4988285616):0.09484431298):0.5683538352):0.7912259833):1.344643871):0.06360133647,(((t206:2.897646342,((((t207:0.633670403,(t208:0.4437173638,(t209:0.3392910054,(t210:0.3072206712,t211:0.1870975414):0.003393714904):0.01479200647):0.1850449669):1.433513913,(t212:0.1720251141,t213:0.09700438589):1.422736611):0.1842183273,((t214:0.246358042,t215:0.09507991591):0.5156465018,t216:0.2878009921):0.9300525441):0.4145029642,((t217:0.169710534,t218:0.1124348294):0.4161586233,t219:0.488519263):1.035006529):0.1799037458):0.1134799281,((t220:0.5148625136,t221:0.4590448476):0.1041703691,t222:0.5551769902):1.084427192):0.8278508173,((((t223:0.1763721388,t224:0.11338672):0.4352214418,t225:0.5427268625):0.1619561095,t226:0.6324313322):0.6811022006,t227:1.287560469):0.9375539691):0.652734861):7.986883074,((t229:0.1154916567,t230:0.07635713242):9.499236926,(((t231:1.637914092,((t232:0.3275141071,t233:0.2491640847):0.5760336499,t234:0.7693131783):0.7324540442):0.6542577094,(((t235:0.6626791481,t236:0.3434904481):0.131032771,t237:0.3786682848):0.8125178449,t238:1.190645529):0.4167111495):5.212842053,((t239:0.1355080807,t240:0.01926779634):1.789310317,t241:1.222759122):4.826965829):1.803295057):0.6222175806):0.2379624284,(((((((t242:0.1591506166,t243:0.1415745722):3.890882743,(t244:2.701582072,(t245:0.1114511553,t246:0.009403291898):2.48030291):1.268522189):0.4451879135,(t247:0.8333852952,(t248:0.6912660176,(t249:0.2402676845,t250:0.2223749429):0.3218757005):0.1236533792):3.366501839):0.991357024,t251:4.892842996):1.276499042,(((t252:0.3903092604,t253:0.3722025246):0.5403059837,(t254:0.7514668728,t255:0.7083205549):0.05211455092):4.862455757,t256:5.545065505):0.2868491316):1.225076194,t257:7.052424428):0.4262310029,t258:7.432795041):0.2613786074):1.154710803,t259:8.421857864):0.8651510005):1.770671682,((((t260:7.148665633,(t261:2.347111049,t262:2.215436199):4.424575546):0.4029375931,t263:7.019503769):0.3728959407,(t264:3.92346162,t265:3.870355672):3.267599306):0.2399963665,((t266:1.558574342,t267:1.457249658):4.092858971,t268:5.388671571):1.660881256):2.848405516):1.531941232):2.227248548,((((((t269:1.532235863,t270:1.475441502):2.11923627,(t271:0.7140654977,(t272:0.5205600993,t273:0.4983315785):0.186252824):2.869363504):2.841505161,t274:6.264171651):0.1003107535,t275:6.348753675):0.6394720042,((((((t276:5.291749704,(t277:4.363165359,t278:4.313846699):0.8146779556):0.3042189224,(t279:5.025275469,t280:4.988455367):0.4028517588):0.4291067333,t281:5.679694807):0.4497980858,(t282:2.582539831,t283:2.575824433):3.50011788):0.3113395123,(((t284:2.216100216,t285:2.16640394):2.380263793,t286:4.545156354):1.323182198,(t287:5.59089547,((t288:1.601794076,t289:1.597000946):2.303077831,t290:3.877939587):1.618735716):0.2243223998):0.4438564866):0.1663706311,(((t291:3.070475006,t292:3.048603727):2.807557439,(((t293:5.640626458,t294:5.422568071):0.127502375,((t295:1.389101096,(t296:0.3859785118,t297:0.3688250992):0.8165922011):4.004423624,(t298:4.603354419,(((t299:0.100771024,t300:0.09673220438):1.571654434,t301:1.509933031):1.297744133,((t302:0.5180144769,t303:0.5040292091):0.06368057321,t304:0.3794851528):2.212015133):1.517515712):0.4258848502):0.1024734065):0.06096768796,t305:4.629025613):0.02672569836):0.2635599919,(t306:1.425010091,t307:1.19617425):3.361440019):0.03178285639):0.0007584141498):2.910228057,t308:7.471376774):3.42488572):3.661484906,((((t309:5.602213354,(t310:1.004654923,t311:0.8973650613):4.57595439):0.5726481481,(((t312:1.567866488,t313:1.240486285):0.5596412867,(t314:1.243472677,t315:1.156317345):0.5255336867):3.402909172,t316:4.911577556):0.4116098799):3.449285827,((((t317:0.341280348,t318:0.2719845765):1.192566049,t319:1.460681709):0.9964650258,(t320:1.575144898,t321:1.441263815):0.8169287147):4.201364434,(((((t322:1.880044715,t323:1.847393623):0.2323925896,t324:2.042850729):2.625586996,(((t325:0.1669230035,t326:0.0913480136):3.615561093,(((t327:0.378180625,t328:0.2658873113):0.8052068984,t329:0.838876563):1.992183034,(t330:2.794456847,(((t331:1.535197432,(((t332:0.5648410308,t333:0.5237903429):0.03220325422,t334:0.4437283204):0.3472371841,t335:0.6130243884):0.2451828177):0.1310409252,t336:0.9045118106):0.7213063802,((t337:0.7730492109,t339:0.335272127):0.1010810053,t340:0.392449091):0.4717187481):0.3805217906):0.01009183328):0.5048516776):0.5558886811,(t341:0.7983879949,t342:0.697288447):1.482818655):0.2258100316):0.7835375122,t343:3.077890679):0.1462347133,(t344:2.145258496,(((t345:0.5821751912,t348:0.235103206):0.4673042851,t349:0.4543630966):0.2492006295,(t350:0.5240653147,t351:0.5194304976):0.09130943858):0.7574389032):0.9440646754):0.6599473255):1.944082537):0.1503390736,(((t352:0.4253437501,t353:0.3365347344):0.4914345898,t354:0.3452478465):0.2927307209,t355:0.3618362672):3.636377387):4.626046723):1.837501076,(t356:8.927629126,((((t357:0.301632871,(t358:0.197141512,t359:0.02558357564):0.04267022563):0.9513257042,(t360:0.6705005107,t361:0.6283954152):0.2028186107):4.182331956,(t362:1.545443013,((t363:0.4522707994,t364:0.3462492666):0.4710185753,(t365:0.1319956886,t366:0.01695726157):0.6328759779):0.5962917398):3.449446292):3.382144758,((t367:0.06031860352,t368:0.03970238647):1.81638186,t369:1.785071786):6.090569885):0.08290063169):1.336887152):0.2482895692,t370:9.539134885):0.5038156892):1.049371443):1.297856901,((((t371:0.4699503045,t372:0.3802751639):0.7797277016,t373:1.149165894):5.470926977,(t374:0.537561388,t375:0.5342973273):6.032756699):4.87862401,(((t376:5.421444052,(t377:5.006828553,t378:4.886487182):0.3948890354):4.210096671,(((t379:4.880000787,t380:4.588626318):3.363489705,(t381:3.216728828,t382:3.069926982):4.382804076):0.9555233885,((t383:6.876757859,((t385:4.491112955,t386:4.110171752):0.428771996,t387:4.526721073):1.624769583):0.1877042836,t388:6.171789464):1.244503919):0.2647533804):0.9910474635,(t389:8.577299237,t390:8.454207516):0.06652139457):0.7732958793):0.6993672476):0.3684114284):22.13108626):35.42121269,((((((t391:6.253535868,(t392:2.764632527,(t393:1.164045142,t394:1.130904642):1.556640224):3.482833552):0.4067057306,((t395:1.167054601,t396:1.141547946):4.033075145,(t397:3.242861048,t398:3.190746248):1.775805108):1.019850293):2.146460508,(t399:5.32517315,t400:5.224394182):2.782326257):9.402536652,(t401:5.299158519,(((t402:1.798555049,t403:1.790747826):2.773858989,t404:4.336297165):0.1364159651,((t405:2.915972934,t406:2.683818108):1.18509381,((t407:1.821241831,t408:1.79258593):0.8672993611,t409:2.623597082):1.175894126):0.2552385114):0.4985485035):11.90923645):1.743681257,((((t410:4.660588877,((((t411:1.297501218,t412:1.278381867):0.9213002777,t413:2.183916293):0.6672205868,t414:2.763476733):0.4338012733,t415:3.181273977):1.011219839):0.147961516,t416:4.314601804):0.7427122551,(((t417:2.034239341,(t418:0.8617941313,(t419:0.3093602488,t420:0.231349638):0.2144808542):1.13756337):2.067660041,t421:3.60182856):0.02775370306,(t422:2.165743613,t423:2.112284741):1.404426297):0.9205604044):0.1597565027,(((t424:3.180324917,t425:3.167312898):0.03734303185,t426:3.201178366):0.5496943787,((((t427:2.304971609,(t428:2.180340464,t429:2.127475427):0.1240992023):0.5730908623,((t430:0.250313619,t431:0.1885272211):2.33484813,(t432:2.230633657,(t433:1.681377901,t434:1.438174912):0.5154598515):0.2662779221):0.1529549729):0.04763807821,t435:2.378437288):0.3286757761,(t436:0.1475938798,t437:0.136519503):2.348566439):0.2812709703):0.7825107481):12.38494056):10.97054284,((((t438:1.388878433,t439:1.367565449):0.9481964458,(t440:1.588624402,t441:1.519067199):0.5220060153):1.057108259,(((t442:2.246413835,(t443:1.123981826,t444:0.9578168317):1.087311397):0.2498833581,t445:2.292901604):0.1619251155,(((t446:1.02388824,(t447:0.8157256697,t448:0.8040047986):0.1790343909):0.4173106837,t449:1.329084134):0.8127460487,t450:2.018352401):0.103238195):0.3571463752):11.48341029,((t451:0.9465258894,t452:0.7994439849):1.801379133,((t453:0.5467827966,t454:0.5457695912):1.404521316,t455:1.930891983):0.2774503948):11.15161465):11.99568543):36.86660536);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T82.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
