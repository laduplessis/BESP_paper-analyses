<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t488:6.869029688,(t489:1.45868015,((t490:0.1009041014,t491:0.04462546988):0.5779824306,((t492:0.1363672553,t493:0.1285522324):0.4240939089,t494:0.5036738606):0.03042128531):0.7356242728):5.295486892):8.770194303,t495:15.19274876):21.85170703,((t496:0.3521915343,((t487:0.1233561829,((t486:0.1854118053,((((t370:0.2646633017,(t367:0.08281872333,(t368:0.004703919386,((t361:0.002774199687,(t358:0.2687807804,(t324:0.02624130841,((t244:0.01719529186,(t242:0.02794743712,(((((t108:0.07511788568,(t109:0.01311903062,(t107:0.07832670694,(t106:0.1226676898,((t105:0.05842199085,(t104:0.04363593146,((t79:0.06485401538,(t24:0.09503172161,(t17:0.02137599283,(t1:1.370264712,t2:1.324408056):0.009071208763):0.4004211319):5.615296983):1.109882859,t3:8.170609205):1.123347435):0.09592194378):0.3127579153,((t4:2.309078092,((t5:0.5557472322,t6:0.5481107163):1.254589252,t7:1.654004546):0.460446708):6.498162862,t8:8.581902432):0.7931775458):0.00297493488):0.1302318999):0.08207465958):0.008338625751):0.4504808752,((((t9:0.5814961987,t10:0.4022646743):3.747360232,t11:4.066407026):2.349555178,t12:6.301004485):2.959726873,t13:9.231632748):0.3208835392):0.05202116285,(t14:8.890843175,((t15:0.1733190403,t16:0.1569315525):8.562397861,(t18:7.21354671,t19:7.167648987):1.462283226):0.08731496163):0.6162675747):0.5954642357,((t20:2.720757474,t21:2.710656681):6.123663341,(t22:7.107529244,((t23:5.599776884,(t25:0.9983837831,(t26:0.4132586236,t27:0.2943968049):0.4825783148):4.465159992):0.2038326188,t28:5.274849275):1.297900164):1.694271977):0.8969953335):4.406102751,((((((((((((t29:3.186995301,t30:2.869596725):4.295590803,(t31:2.430195342,(t32:1.060392462,t33:1.050024179):1.037566478):4.621891705):0.1186700613,t34:6.697344161):0.1886373661,(t35:5.963804262,t36:5.940560366):0.8007245748):0.4218985035,t37:7.116174899):0.02537233408,(((t38:6.641240032,(t39:4.668051077,(t40:1.168030475,t41:1.098541748):3.376218398):1.923691611):0.1121241798,(t42:3.293910914,t43:3.288875718):3.186620102):0.1852240012,(t44:5.812372918,t45:5.74746801):0.8388981217):0.1443607701):0.7496582158,(((t46:1.707670532,(t47:0.7376164379,t48:0.4588409732):0.8960877557):3.364742592,t49:4.683693653):0.03131332075,t50:4.427714005):2.253528179):1.166382004,((((t51:4.453403097,(t52:3.336827556,t53:3.176667649):0.9411908942):0.7437701418,(t54:2.918996979,(t55:2.864846834,(t56:2.807934845,t57:2.593768884):4.311986011e-05):0.02266028153):1.916221016):1.33137832,((((t58:1.603030885,t59:1.434992758):2.918294027,t60:4.307174394):0.9456736685,(t61:1.300277965,t62:1.181505153):3.754997246):0.1290383497,t63:4.826554821):0.2245803674):0.4705812406,((((t64:0.3592582985,t65:0.2916731226):0.877815834,t66:0.9110963936):2.292433744,(t67:2.921569079,t68:2.875926973):0.2222366189):1.94265409,((t69:0.4537536344,t70:0.4522859897):3.688424695,(t71:2.794473709,((t72:2.013281475,t73:1.965789559):0.6774098834,t74:2.586806606):0.08225717792):1.140173557):0.8806607601):0.00521952967):0.7769954956):0.4618351907,((((t75:3.341690067,((t76:1.912468676,t77:1.897792204):0.2416191571,t78:1.95263644):1.158561012):0.2845195594,(t80:0.1621257795,t81:0.06293536699):3.003341261):1.088485547,t82:4.138997292):0.455696587,(t83:3.778119695,(((t84:1.898469729,((t85:0.5526542306,t86:0.5521459464):0.9393451585,t87:1.395069998):0.2788462072):1.026966693,t88:2.645113999):0.5702494495,((((t89:1.342828676,t90:1.304056811):0.03795366797,((t91:0.3572590967,t92:0.2940998279):0.4570080932,t93:0.6482300677):0.4073271925):0.5754289158,((t94:0.2084664332,t95:0.1316038265):1.026828596,(t96:1.01069288,t97:0.8212578082):0.08136619081):0.3482287559):1.159356454,(t98:1.939649221,t99:1.807530081):0.4630275066):0.08369115208):0.16249929):0.7815003552):0.5984357925):0.3388598231,((t100:2.868507419,((t101:1.407085155,t102:1.347602571):0.5298612302,t103:1.703649207):0.870875456):1.23405496,(t110:1.718868352,(t111:1.625682825,(t112:0.8325531204,((t113:0.4973297113,t114:0.4936368389):0.08338118773,t115:0.5064536309):0.240536661):0.6488272873):0.09014644351):1.083787156):0.06301880203):0.3139794666,(t116:1.724689832,(t117:1.281721044,t118:1.158985255):0.3120226203):1.208932036):0.1955051275,t119:2.66778811):2.087653021):6.619977483):0.07028208109):0.9522790167,t120:12.2424725):6.249011571):4.083038884):0.2390375373):0.3883974569,((((((((t121:1.643294081,t122:1.428889659):8.345779683,((t123:0.4137960495,t124:0.3960821288):8.585922097,t125:8.960301475):0.4002779311):1.22988809,((((t126:4.241321769,(t127:0.2329418342,t128:0.1061814399):3.722202804):2.028735996,t129:5.833071935):2.741252808,t130:8.456745351):0.9051310881,t131:9.168411669):0.6442063221):0.5581218071,(((t132:5.066908348,t133:4.970353442):2.458157255,((t134:1.86666805,t135:1.835408256):1.343903488,t136:2.989547296):4.132894422):1.949501961,((((t137:5.869961935,((t138:0.6063887541,t139:0.5902863219):0.3571354921,t140:0.3348696386):4.692011391):1.894529882,t141:6.921359339):0.01210282022,t142:6.831688414):1.254879821,(((t143:3.271050739,(t144:1.368930542,t145:1.269781286):1.898534574):4.051815713,((t146:6.33420312,(((t147:0.782252738,t148:0.7382270827):3.229951273,t149:3.884143492):0.3769584193,(t150:3.249228662,t151:3.175214342):0.9335725527):1.831065224):0.6630502325,((t152:5.133792279,t153:5.098367286):0.8084693183,((t154:0.8116335294,t155:0.6974110727):0.7294721708,t156:1.355835644):4.356427747):0.5288497914):0.2222921384):0.3234461198,(((((t157:5.515272145,(((t158:0.2698367098,t159:0.2146253399):3.522557434,t160:3.737113677):1.380860619,t161:5.116254451):0.269330142):0.06534640608,((t162:0.4604199149,t163:0.42723212):3.745263138,t164:4.1610658):1.229970109):0.1706121572,(t165:5.508699249,t166:5.486969651):0.01869529121):0.9017359169,t167:6.346463928):0.02598299709,t168:6.134491417):0.09287802257):0.2053320095):0.03281767615):0.8852883307):0.222659153,(t169:7.145937319,(((t170:0.456202075,t171:0.3750990179):5.286668046,((t172:0.1743001121,t173:0.08701929854):4.753813513,t174:4.839511114):0.4859427752):0.9939001555,(((t175:5.666861531,((t176:3.896223136,t177:3.810631111):1.326248124,((t178:1.579229312,t179:1.282544892):3.211126847,(t180:0.5218007369,t181:0.417921938):3.849336618):0.172855717):0.02986369258):0.5137402164,(t182:4.112437682,(((t183:0.4762287365,t184:0.3341947777):0.4211653316,t185:0.7317299537):1.315505693,t186:2.039452132):1.767521855):0.8680917093):0.01911124316,(t187:4.446596621,t188:4.287104218):0.2203084397):0.09949637371):0.40218508):0.4052597604):0.6613431482,(((t189:3.561483586,(t190:3.442419583,(t191:1.412965145,t192:1.387068969):2.008608769):0.09363324463):0.7416028734,(t193:3.274615946,t194:3.06186076):0.9459237338):1.149194472,(t195:0.4365591597,t196:0.4060945082):4.629060173):0.5127003546):1.266080207,((t197:5.491116712,((t198:4.152119396,(t199:3.494422733,t200:3.358302227):0.5698074211):0.7947620673,((t201:0.6892357049,t202:0.6025129705):0.8306768099,(t203:0.0776750985,t204:0.03836299707):1.349051703):3.10214854):0.5240530195):0.9909842598,((((t205:2.569789343,(t206:1.526594167,t207:1.474100346):0.9306890469):1.170441543,t208:3.541075623):0.6185769552,(((t209:2.075595913,(t210:1.742138183,((t211:1.156570306,t212:1.095102386):0.3916298993,((t213:0.5673280507,t214:0.5181953879):0.08169638464,t215:0.5860029641):0.8324629771):0.1566298925):0.1004687566):0.3220502079,t216:1.791717044):0.1365501152,t217:1.855513466):1.625082238):1.072624104,(t218:1.687899743,t219:1.590646532):2.860912378):0.5652697007):0.3022698467):8.304251774,(((((t220:0.8529768456,t221:0.8468693397):1.743484164,(((t222:2.202320023,t223:2.190645834):0.07233812502,t224:2.2420234):0.08714927249,(t225:1.32488982,(t226:0.3287508918,t227:0.2475186533):0.919670204):0.4327198794):0.1711668874):0.5207033876,((((t228:0.1782255094,t229:0.01387849964):0.7044590109,t230:0.6046789166):0.1537247639,(t231:0.2338810441,t232:0.1589776267):0.5123329851):0.8386882923,(t233:0.2379390596,t234:0.2239264235):1.009877594):0.3593238623):0.8325629581,((t235:0.5902409675,t236:0.5667456109):0.08681151196,t237:0.6451229288):1.673176614):9.00043738,(t238:10.36660605,(((((t239:0.6205538168,(t240:0.5480805142,t241:0.4866265645):0.0389521105):0.8901009296,((t243:0.3138675552,(t245:0.194806267,(t246:0.1455550636,t247:0.003052751939):0.004797033955):0.02965449199):0.6456340277,(t248:0.4835070884,t249:0.4780094158):0.1231507885):0.1322277268):0.7407915168,(t250:1.277716896,t251:0.9975202533):0.1194219072):4.402726666,(t252:1.426443956,t253:1.149978967):4.091030817):1.90292805,(((t254:1.685705956,((t255:0.3300235835,t256:0.3242131052):0.6162066835,t257:0.8416559899):0.6753600065):2.011725542,(t258:1.524439915,t259:1.500287392):1.946199701):3.052469772,t260:5.976622):0.09632149267):1.740839002):0.9246057954):0.64564685):0.5181140553):0.1432806621):0.03602975521):0.4542569725):0.4762885112,((t261:9.095797561,(t262:3.54476664,t263:3.449655779):5.338039326):1.202699706,((t264:1.57782722,(t265:1.275796634,t266:1.2074812):0.297866756):8.114409101,((((t267:3.269131045,t268:3.245714055):3.974838445,((t269:1.934967684,t270:1.874661699):2.588977739,t271:4.374512922):2.608409867):1.093240303,t272:8.066026732):1.146804836,(((((t273:0.1162188824,t274:0.0390944302):2.425476315,t275:2.44471109):2.354134535,(t276:0.3372229437,t277:0.2704003273):4.450464406):0.6511284085,t278:5.319726144):3.379501998,(t279:1.576828407,t280:1.549288304):7.106003095):0.2242598185):0.03311991077):0.2210210042):0.6787770927):0.758395676,((t281:3.73399395,t282:3.67574202):3.628460799,t283:6.761645202):3.184787141):1.273453952,((((((t284:1.113796774,t285:1.018965103):5.76143031,(((t286:3.541052348,(t287:1.278415343,(t288:0.5498027791,t289:0.4818224379):0.6291966471):2.006638836):0.5360326355,(t290:1.474601854,t291:1.453430346):2.012040001):2.128780148,t292:5.510024002):0.5548973248):0.9409222849,t293:6.856989648):0.6857292911,(((t294:2.99144825,(t295:2.919616897,((t296:0.8235755468,t297:0.787782919):1.487866248,t298:2.241623296):0.6018617643):0.01534794706):2.756516751,((t299:0.7649235187,t300:0.6623230289):1.672220566,(t301:2.198989277,t302:2.165276221):0.009578496837):3.161320175):0.165444104,t303:5.216705417):1.526554032):2.012655945,(((((t304:4.737746426,(t305:4.363070452,t306:4.322305275):0.3439672597):0.5989321697,((t307:2.060430585,t308:1.955661745):3.131926169,(t309:0.6157477225,t310:0.3456386674):4.465445534):0.07196237378):1.30457845,(((t311:0.3778669245,t312:0.3730308862):5.025536457,(t313:0.9164751525,(t314:0.720492461,t315:0.5266746373):0.06327616814):4.388955342):0.01979014283,t316:4.854727268):0.7387987197):0.1530369446,(t317:4.36665849,((t318:2.804389197,t319:2.77806188):1.442085009,(t320:2.765955245,t321:2.695456334):1.344403142):0.1089547725):1.282147243):0.9744446585,((t322:3.993046969,(t323:2.71099078,t325:2.547154332):1.261486087):1.893879706,(((t326:0.9897876151,t327:0.6670973168):2.592301899,t328:3.230488912):0.2145239631,(t329:2.915139179,t330:2.538050085):0.5137047109):1.807240167):0.4824335467):0.9588083392):0.1015034569,(((t331:3.647747503,(t332:2.296675745,t333:2.190602385):1.183975101):0.2247753101,t334:3.550481581):0.8977361331,(t335:4.326255245,(t336:0.3494312574,t337:0.3293977344):3.950115457):0.09084990093):1.431944158):0.5745219072):9.001167601):0.04886127293,((((((t338:3.312590175,t339:3.21558497):0.3023391015,(((((t340:1.104521036,(t341:0.6326663927,t342:0.4751283028):0.4418865854):0.3073481592,t343:1.215119424):1.447259044,(t344:2.644246089,(t345:1.929504157,t346:1.902369211):0.4627135016):0.006987645163):0.04933242485,t347:2.229276465):0.4511452382,((t348:1.360937888,t349:1.329290773):0.2973996155,(t350:1.316397529,t351:1.21044663):0.1228930118):0.9719557541):0.002143945815):0.5878132048,((t352:0.6059699699,t353:0.4921486981):1.987406902,t354:2.115520466):0.1952717182):10.12641814,((((t355:0.1594346389,t356:0.05626769039):0.3030376659,t357:0.2855785337):1.432398784,(((t359:0.2787476494,t360:0.2215527096):0.1166072799,t362:0.2564257639):0.3775799345,(t363:0.5141117379,t364:0.3612536315):0.09229092419):0.4670705208):10.1888591,(t365:2.088606708,(t366:0.3961427782,t369:0.1744956204):1.492326066):8.992115578):0.2233567766):0.3142882285,(((t371:1.120287699,((t372:0.7895538193,t373:0.7009440866):0.2084815098,t374:0.8316329137):0.01197984666):4.028289426,t375:4.871413465):3.710468014,((t376:1.506897752,t377:0.998237872):3.481938106,(((t378:0.1762009409,t379:0.05503407976):2.700586183,((t380:0.4969386963,t381:0.1232905552):1.726918575,t382:1.586976353):0.1989022999):0.518755692,t383:2.26202888):1.012433592):3.48210665):1.938183999):0.5102684555,((((t384:7.374247383,t385:7.328081918):0.3225507348,t386:7.596392894):0.9399026978,t387:8.443553422):0.3999428452,((t388:4.741920034,t389:4.734733594):3.152473498,((t390:5.096953586,((t391:1.052778462,t392:0.7703620007):1.161020412,t393:1.865880532):2.842215999):0.6009037006,t394:5.070200018):2.179810924):0.700165229):0.1363311829):0.1846143179):0.1893276358):0.5905661005,((((((((t395:4.727911432,t396:4.421701698):0.827352606,((t397:1.535477172,t398:1.521702313):2.867134431,t399:4.378299093):0.7659110521):1.396590142,t400:6.501681165):0.04418088762,t401:6.491578435):0.1034092653,t402:6.543020272):0.659908234,(t403:1.953736349,t404:1.950717111):5.06583236):0.3882323084,((t405:5.625113656,(((t406:3.090851768,(t407:1.956331976,t408:1.889059546):1.114351238):0.4789806331,t409:3.465051203):0.03736051184,t410:3.473819155):2.015420024):0.4752770928,(t411:1.217266475,t412:1.189591723):4.724112729):1.289204122):0.08054939572,((t413:4.190966829,t414:4.171975485):2.134984073,((t415:1.51958783,t416:1.502456923):0.942732608,t417:2.442999448):3.805963411):0.9300895081):0.7540089183):0.2745872896):12.45218522,((((((t418:3.422514285,(t419:3.339821773,t420:3.311995678):0.03540085261):4.108541178,t421:7.384794422):0.7065451787,(((((t422:0.9716496766,t423:0.9495267267):4.746674596,(((t424:0.1434852981,t425:0.009559163108):0.6306453347,t426:0.5965489608):1.852160069,t427:2.174503499):3.023218537):0.8084801918,t428:5.85936257):0.7627410126,(t429:4.884585535,t430:4.87604041):1.674274132):0.5261596155,((t431:4.297904797,t432:4.276797111):0.483987046,(t433:3.622505467,(t434:2.572537026,(t435:0.7255206458,t436:0.4687116449):1.738545483):0.9245310858):0.9486644044):2.042445464):0.07692998838):0.1085001787,(((t437:1.721380221,(t438:1.045640021,t439:1.021431456):0.5114097386):1.323118713,t440:2.78924049):2.594819854,(t441:4.857243882,(t442:3.845761377,t443:3.73017749):1.000776823):0.5222167645):0.6226326341):0.1466949312,(((((t444:2.659445222,t445:2.515214258):0.3189371759,t446:2.797449892):0.2627253439,t447:2.842612694):1.043529427,t448:3.795483139):1.443256118,(((((t449:2.532436151,t450:2.374508938):1.152324052,((t451:2.73329543,(t452:1.877965417,t453:1.853592877):0.8076406733):0.2853083412,t454:2.894174213):0.3983192092):0.2105720084,((t455:2.251911196,(t456:0.9308757393,t457:0.928684518):1.250133914):0.847697127,(t458:2.895092024,(t459:2.285320461,t460:2.278237759):0.4540210529):0.0712195591):0.3377067528):0.3132919623,((t461:1.482535752,t462:1.464358129):1.428069938,(t463:2.198494665,t464:2.027677197):0.6911974243):0.4337708742):0.5549878959,((((t465:0.3642948997,t466:0.09033482433):0.9222526577,t467:0.9763939547):1.074775232,t468:1.963640097):0.7544707634,t469:2.426318961):0.5280355961):0.4659615323):0.2183477178):1.404190341,(((((t470:1.158717048,t471:1.061969657):0.6127604242,t472:1.624050811):0.4730358749,((t473:1.022028178,t474:1.00560563):0.2497276457,t475:1.241281546):0.7464830765):1.048341084,(t476:2.688384929,(t477:0.4322569509,t478:0.4240308668):1.830971394):0.2867139112):0.06495580567,((t479:0.6394174536,t480:0.3650710409):1.32295173,t481:1.649650295):0.2372905358):1.618142093):10.74914387):24.22271074):82.46599337,(t482:49.43284178,((t483:1.305141488,t484:1.170897277):0.9947946476,t485:2.131741353):47.13148348):71.50005676);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T27.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
