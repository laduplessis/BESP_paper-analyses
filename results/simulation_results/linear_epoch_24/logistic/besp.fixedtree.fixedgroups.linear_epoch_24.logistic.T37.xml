<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t432:4.817358796,(t433:3.563042492,t434:3.549182192):1.222802805):0.8027910037,((((t435:3.572806974,t436:3.38717562):0.7432517259,(((((t437:0.3110458252,t438:0.3008492744):1.283299625,t439:1.572611912):0.01445627217,(t440:1.449349392,t441:1.384324203):0.1069425329):1.748576759,((t442:2.152965291,t443:2.145570962):0.6349483533,(t444:1.155844871,t445:0.9281194407):1.602064213):0.4161595503):0.3704365966,(t446:1.577292159,t447:1.525918894):1.722141474):0.3365916039):0.3872294306,(t448:3.756077647,(t449:2.398364496,t450:2.307928352):1.335251186):0.1126482488):0.4981457681,(t451:3.210206603,((t452:1.687962001,(t453:1.590496174,t454:1.589398475):0.09028692229):1.203665603,t455:2.856636564):0.02325530699):0.9943308106):0.2558866963):2.598364282,((((t456:1.061925059,t457:1.008407468):1.20267179,(((t458:0.1962750123,t459:0.08920218159):1.611648216,(t460:0.5746878661,(t461:0.3904556383,t462:0.3515692877):0.1414220872):1.092934859):0.1186235552,(t463:1.136702661,(t464:0.2548123574,(t465:0.06304182464,t466:0.005783932539):0.1186085782):0.8406835771):0.5360026974):0.2632558848):3.408918253,t467:5.104262364):0.9956163526,((((((t468:2.246165373,(t469:1.867915545,t470:1.840395134):0.2613479507):0.06795456881,(t471:0.9588522462,(t472:0.5272845569,t473:0.0927214375):0.3718618377):1.064336959):0.4046025892,((t474:0.3311122774,t475:0.2607903822):0.2776617324,t476:0.4568599622):1.232860916):0.7951501121,(t477:1.532113584,t478:1.487205431):0.930348083):0.6638384869,((t479:1.125786649,t480:1.097844025):0.5580607048,t481:1.577169382):1.352988012):0.02573742016,((t482:0.2053240249,t483:0.1886065877):0.7260940976,((t484:0.116117039,t485:0.01266947735):0.5598906466,t486:0.505863971):0.2210019089):1.965293985):1.859307066):0.04982589504):7.749859787,((t487:0.9843045444,t489:0.7283240979):0.2468941546,(t490:0.7379934806,t491:0.6832778137):0.1235448935):10.86463339):60.97380249,((t492:2.589687328,(((t493:1.140331698,t494:1.109836954):0.1407721645,t497:0.3420779077):0.1746810368,(t498:0.1036198006,(((t496:0.06708645657,(t495:0.1143239685,((t488:0.0005712234865,((((((t344:0.1702127968,((((t239:0.07769878061,t240:0.07421729706):0.04253396782,(t237:0.2350085884,(t233:0.09619307571,((t226:0.02265447837,(((t124:0.3606563773,(t125:0.3113594353,(((t1:0.9154664841,t2:0.7922168937):9.061932377,((t3:8.481733875,((t4:4.83947808,t5:4.80411605):2.234899209,t6:6.921887828):1.219625167):0.07437676853,(t7:8.025206051,t8:7.821426912):0.05595895363):0.9027109091):1.195716732,((((t9:2.267002726,(t10:1.32616199,t11:1.246957647):0.7736191999):6.259508137,(t12:6.91165898,t13:6.901878457):1.294670453):0.7845619877,((t14:7.278426325,(t15:6.020554542,(t16:4.238599533,t17:4.202613046):1.639832696):1.043634954):0.9748150932,(((t18:3.274657337,t19:3.261888776):2.777041157,((((t20:1.743095605,t21:1.719306776):1.479140415,t22:3.15777437):0.7064993107,t23:3.685107957):2.042526628,(t24:5.002550173,t25:4.99406453):0.6963032472):0.04970749049):0.4014513305,((t26:2.720792621,t27:2.701114442):2.783102013,t28:5.314032454):0.5918507663):1.362035811):0.09542795364):0.06747366897,(((t29:5.238808535,t30:5.232560209):0.6669081398,(t31:0.886256262,t32:0.8196802547):4.95053613):0.3357441076,(t33:4.566274245,t34:4.529567162):1.499391187):0.9746564005):0.2825529905):1.860629558):0.01789459121):3.801131674,(((((t35:8.66913714,((t36:4.302058817,(t37:0.2638955935,t38:0.1201179553):4.007644749):3.663218609,(((((t39:2.091116715,t40:1.750957938):3.134288515,t41:4.861940279):0.9022297506,t42:5.692892483):0.5257124676,t43:6.077998752):0.1403540597,(t44:5.188797262,((t45:1.927976827,t46:1.827381032):2.06913031,t47:3.870255189):1.123851964):0.8104311154):0.8890471646):0.6139938879):0.6540639687,(t48:6.119686188,((((t49:1.780349292,(t50:0.5492823779,t51:0.1876075951):1.111871873):2.098996502,(t52:0.7295440887,t53:0.4548231219):2.538860812):0.7930480492,(t54:3.366310921,((t55:0.3714704352,t56:0.3634373063):0.6414769254,t57:0.9861854171):2.225269988):0.4142474201):0.8693267621,((t58:2.650583264,t59:2.559973476):1.306181449,(((t60:2.414736803,t61:2.304532758):0.171337107,(t62:0.3592377393,t63:0.3034419538):2.113768776):1.03313371,t64:3.304230418):0.1016838856):0.3604682139):0.3206606361):1.699261189):0.4919392874,((t65:2.484390324,(t66:0.7006479513,t67:0.6202490057):1.717397372):1.436278407,t68:3.606009067):2.152060444):0.4582749779,((((t69:2.126796995,(t70:1.10610563,t71:1.09258673):0.9180017177):0.8421223074,(t72:1.578854953,(t73:0.7044763397,(t74:0.3233496319,t75:0.3125418411):0.3764075361):0.8363968303):1.14983213):1.649785497,(t76:3.165104498,((t77:2.420176598,((t78:1.725223256,t79:1.574840414):0.3268587196,(t80:1.842685904,(t81:1.119473085,(t82:1.057622474,t83:1.042861531):0.04350922251):0.7120968301):0.05311960765):0.3176014408):0.1089390515,((t84:1.281058864,t85:1.261292476):0.337595691,(((t86:1.00002017,t87:0.9635758025):0.1673178422,(t88:0.9678288196,t89:0.9567410602):0.09553899539):0.2868403549,(t90:1.069495396,t91:1.044159041):0.1805531632):0.007737952049):0.6096000604):0.5915159492):1.159673385):0.08346501819,(((((t92:0.8720704825,(t93:0.1100758497,t94:0.02663150956):0.5508565176):0.4157127085,t95:0.8995118523):0.8544791258,((t96:0.481149667,t97:0.347054394):0.03362795012,t98:0.3430228662):0.8801291911):0.01245193305,(t99:0.4874044764,t100:0.4183710632):0.6886931182):1.135631336,(t101:0.6231116545,((t102:0.3355344885,t103:0.2925742256):0.2258820429,t104:0.5157957984):0.03569745981):1.617102166):0.3717473844):1.461578454):2.163230794,((t105:2.273428966,(t106:1.882045979,((t107:0.5793032272,t108:0.3637640339):0.618362587,t109:0.9676483253):0.5961583476):0.3873243352):3.393262358,((t110:1.770206826,t111:1.732076295):0.6000596365,t112:2.121667944):2.868692914):0.4535156608):0.5113483478):3.557332763,((t113:3.681053525,(t114:1.813712564,((t115:0.4357148772,t116:0.006778840401):0.4591123528,t117:0.4027793301):0.6652986963):1.65901425):4.491753823,((t118:0.1690460064,t119:0.120253823):1.992237798,(t120:0.04480822723,t121:0.0008787583888):1.69667835):5.050953621):1.304089252):1.051565733):0.222514661,((((t122:0.7378771637,t123:0.6276419435):0.6947054384,(t126:0.06008043561,t127:0.0307875313):0.7275222924):5.202317409,t128:5.928687837):0.05486979037,t129:5.671250441):2.459742791):0.8574561552):0.5100508242):0.1619597535):0.3864493116,((t130:0.2911052254,t131:0.2822977674):9.205832503,(t132:9.330120861,((((t133:0.4574784231,t134:0.4229394775):1.279560069,t135:1.616381744):4.218924276,t136:5.81371035):3.310157588,(t137:8.965532396,((t138:5.077317164,(t139:3.98197211,(t140:0.5511522681,t141:0.1361904681):3.404602353):1.068466214):1.364089357,(t142:2.531890346,(t143:2.367678473,(t144:0.6942136486,t145:0.6484921656):1.587589242):0.01795435836):3.235925026):2.50677813):0.0850202546):0.02477037257):0.121802458):0.5409087273):0.3074188627,(((t146:7.384370757,(((t147:6.219383229,(t148:3.059828841,t149:2.751366537):3.155998483):0.8731457174,(((t150:1.962660098,t151:1.951336116):2.444012277,t152:4.329578026):1.479948317,((t153:1.540467811,t154:1.499363601):1.191530865,(t155:0.7900576545,t156:0.7720517726):1.893527082):3.074093181):0.8530008803):0.09063819932,(((t157:1.078922766,t158:0.9698088418):4.716957765,(t159:1.665090982,t160:1.525044316):4.01489579):0.7690758559,(((t161:3.038657879,t162:3.024773422):1.427863034,(t163:0.4619582503,t164:0.4199596376):3.925287241):0.5618286147,(((t165:1.492758376,t166:1.355760511):0.9262165126,t167:2.262106398):2.36126658,t168:4.542024824):0.07915379686):1.272180143):0.1127514976):0.1774654459):1.062077988,(t169:0.79233176,t170:0.5904029582):6.293650276):0.5649895171,(t171:2.951085134,(t172:1.123499359,t173:1.084551644):1.674577389):4.482047198):0.04704569029):10.0444244):1.144615718,(((((((((t174:2.524704465,t175:2.118875657):1.720497548,t176:3.675581835):0.3174619153,t177:3.963619698):0.1676768699,t178:4.043626368):0.8428290108,t179:4.868218439):0.218984079,((t180:3.305877528,t181:3.297238756):1.417556851,(t182:2.682288679,t183:2.674130356):1.926359862):0.3328401201):1.898580557,(t184:4.428651689,t185:4.143709733):2.088693859):1.415690354,(((t186:0.2417474803,t187:0.21495764):2.916634297,t188:3.008394092):3.803314091,(((t189:3.169775357,((t190:2.098521845,t191:2.032855336):0.2863976925,t192:2.094168788):0.779075459):0.2556718225,(t193:2.685085987,t194:2.648319099):0.4009465303):2.779061766,(t195:0.1947527754,t196:0.1728209167):5.621221586):0.449762365):0.4610335911):0.4723061607,((t197:2.940240574,(t198:1.605561966,t199:1.590468114):1.332638764):1.42448163,((t200:3.536854167,(t201:2.723543628,t202:2.646148154):0.7232559187):0.3624531706,((t203:2.927689308,t204:2.781326466):0.1516703303,t205:2.803365683):0.6463837643):0.39637999):2.616257919):8.841528314):1.01339782,(((((((((t206:3.256376779,t207:3.187308438):0.3406560316,(((t208:1.726594626,(t209:1.379558054,t210:1.28602144):0.3044760975):0.8572372734,((t211:1.570397623,t212:1.546422814):0.1855182522,(t213:1.387607243,t214:1.281673099):0.292534847):0.5933932244):0.0923738584,(t215:1.721550372,((t216:1.142303197,(t217:0.1408223655,t218:0.1005347638):0.8769621114):0.02894928416,t219:0.7693161111):0.4527891542):0.4825929644):0.8402748068):0.2598814997,(t220:1.492666132,((t221:0.1759898006,t222:0.04916119765):1.215344968,((t223:0.7065577928,(t224:0.3631001822,t225:0.2604980925):0.2546412211):0.05531560193,t227:0.03629648919):0.3825646385):0.09386238865):1.230776944):0.3824788697,((t228:1.289799119,(t229:0.1671566254,t230:0.07919172279):1.106314164):0.3564973777,(((t231:0.2772407264,t232:0.1651138396):0.2600499947,t234:0.2948977541):0.461734805,(t235:0.285075667,t236:0.1251556521):0.4686429384):0.3047387411):0.465081315):3.254643363,t238:4.280112477):3.696322267,((((t241:0.786354674,t242:0.3782021399):0.3810343989,(t243:0.3281451544,t244:0.2801458311):0.2296460749):0.3123393007,t245:0.4018457229):0.829096353,t246:1.214440241):5.339477721):0.6541438696,t247:7.16317876):3.324132563,((((t248:3.132369245,t249:2.984154053):1.049530705,(t250:2.723411099,(t251:0.1479434632,t252:0.07945186831):2.50850124):1.159284724):4.518864337,t253:8.251128508):1.151878373,(t254:9.211114675,((t255:0.9990339818,(t256:0.6482542635,t257:0.646991175):0.2250107033):7.967798698,(t258:8.511732253,(t259:6.552670999,(t260:2.050759412,t261:1.958558106):4.460180842):1.953946548):0.3032404539):0.1270613413):0.06800802004):0.4558939268):0.6772986702,((t262:2.607272948,(t263:1.63136267,(t264:0.9619744076,t265:0.542379098):0.5599910215):0.9682419492):2.481050639,t266:4.549065424):4.873596181):0.4161450484):5.285902514,((((((t267:4.671537439,t268:4.551687646):0.7097825361,(((t269:2.593460974,t270:2.421386977):0.6801346958,t271:2.983477093):1.195102887,(t272:0.2625947526,t273:0.1385274772):3.787501168):0.7623794549):1.867250443,t274:6.463002939):0.3023798401,t275:6.635603598):0.3382750463,(t276:1.650078917,t277:1.518878699):5.252401566):0.0874774284,((t278:0.8177594359,t279:0.8068610139):2.099225162,(t280:1.119760871,t281:1.086549456):1.730269332):3.900840265):6.932988672):2.842975686,(((((((((t282:3.429396558,t283:3.407442786):2.750830537,t284:6.103717433):0.4562076452,(((t285:1.479261768,t286:1.448440389):4.94240387,(t287:6.252220871,((t288:5.279977282,((t289:2.228265654,(t290:1.110570474,t291:1.079704166):0.7302683644):1.046340065,t292:2.809983762):1.806309864):0.4922811126,(((t293:1.107517281,t294:1.071938341):3.16946778,((t295:2.188141151,t296:2.085178789):0.741165476,t297:2.771728342):1.061489702):0.5814819632,t298:4.391437681):0.1645321241):0.0613496545):0.1231272167):0.04749958504,t299:4.714758485):0.07840232062):0.5548430817,((t300:4.464276066,((t301:1.419643827,t302:1.381825985):0.1355847685,t303:1.47132599):2.790323395):0.5537710362,((t304:1.422469154,t305:1.401848331):1.913992806,((t306:0.6837154243,t307:0.6830967155):0.2825423322,t308:0.9420223869):2.273308022):1.447758151):0.2335292018):0.9903952434,((t309:4.150154228,(t310:1.054050077,t311:1.001330697):2.986008235):1.443621854,(t312:4.209569461,(t313:3.963521048,t314:3.776813684):0.2419006142):1.022663617):0.2659010392):0.03238826648,((t315:2.151605536,(t316:1.797228656,t317:1.63326458):0.3509953021):2.623488006,((t318:1.472030156,(t319:0.1675828634,t320:0.09080254327):0.8503641736):2.85083037,(t321:1.286394285,t322:1.274635002):2.473332395):0.2220223589):0.2947134266):0.5845377389,((t323:0.8379434841,t324:0.7698899144):2.69683604,(((t325:0.9233734561,t326:0.7222308219):0.1898675707,(t327:0.133159992,t328:0.04934002662):0.7546832823):0.2550136782,t329:1.013592712):2.046495619):1.287441802):0.1922552966,(((t330:0.911726175,t331:0.8803007488):1.110640936,t332:1.918623371):1.667492768,(((t333:0.6767406325,t334:0.6681678268):1.502645347,(t335:1.679458746,t336:1.61447096):0.4637971466):0.7892756641,((t337:1.154055169,t338:1.128386386):1.121394799,t339:1.866101607):0.5302571558):0.522991731):0.6449638758):4.056980765,(((((((t340:1.10358597,(t341:0.4613985472,t342:0.4496048867):0.3175647626):0.4518104109,t343:1.125023971):0.1904049102,(t345:0.1676674346,t346:0.008038634444):0.7484418791):0.8649501229,t347:1.613346971):0.554968602,((t348:1.785181018,t349:1.653156598):0.1792054037,(((t350:0.7444699016,t351:0.6922066902):0.363398746,(t352:0.5568300754,t353:0.5243709854):0.2917589359):0.2927920153,(t354:0.1555654321,t355:0.06891062932):0.8785477445):0.3438551933):0.1177491053):1.142267176,(t356:0.1663496412,t357:0.04834151605):2.217677533):0.4103875829,(t358:1.346208499,t359:1.188017789):1.161295361):2.899447053):3.414062541):1.456511751,((t360:1.579011197,(t361:0.1349610323,t362:0.02500730475):1.416562136):6.526017115,((t363:2.13527403,(t364:0.03817131839,t365:0.02799180013):2.06055232):4.495797939,(t366:0.5924081697,((t367:0.1702122173,t368:0.142648143):0.1474190467,t369:0.02796221602):0.08659562268):5.974671952):1.271887027):1.975416798):0.3655237795):0.5871297426,(t370:1.048360034,t371:1.017392232):9.173603845):0.3637044314):0.06808060251):0.04148581904,(((t372:5.000304569,(t373:0.4779347136,t374:0.4226790397):4.167483413):4.671081849,((t375:6.026215312,(t376:5.289785617,(t377:0.5955775956,(t378:0.4703828668,t379:0.3381653339):0.08497301806):4.620273927):0.6158964269):2.578838786,((((t380:0.3589376524,t381:0.2464056785):5.731782664,((t382:0.118162092,t383:0.07959375968):3.058317563,t384:3.103285057):2.732440379):1.170177533,t385:6.97727336):0.3270603992,t386:6.771451262):0.4121017578):0.5324781527):0.1049588227,((t387:0.7212907738,t388:0.6125597531):6.424964674,((t389:0.30542836,t390:0.1300439689):1.080659684,(t391:0.4419023046,t392:0.02793340159):0.7260007142):5.61898516):0.5382172416):0.8862091799):0.4943990707,(((t393:4.19393171,t394:4.173489658):3.021383356,((t395:6.417013842,(t396:5.722634127,(((t397:2.063000691,t398:2.005782375):3.05854397,t399:4.969780479):0.2241027695,t400:5.192399623):0.2648824617):0.6487192765):0.7427675366,(((t401:5.992041247,t402:5.973433498):0.6244096772,((t403:5.94606723,(t404:5.241952096,((t405:1.152788435,t406:1.14455609):2.841585982,t407:3.677406296):1.240319443):0.5463842546):0.1696991637,(t408:4.710263149,(t409:3.68572628,(t410:2.681313564,t411:2.655299068):0.8950046134):0.7228505055):0.580938044):0.4642289341):0.006692312877,t412:5.303775699):0.2060770717):0.01945451766):0.038626917,((t413:0.2184603386,t414:0.2073832303):3.086186138,t415:3.201914749):2.135905619):1.001557679):0.281857688):0.3579641413):1.012859735):18.24869504,(((t416:1.893935855,(t417:0.3844630813,t418:0.2874179433):1.497161759):2.996238732,((t419:4.142658961,((t420:0.3967116737,t421:0.3725527):3.064385979,(t422:3.290736991,(t423:0.9563576511,(t424:0.4205819059,t425:0.3299685132):0.5059150215):2.24851309):0.1379180569):0.6122190843):0.2662347119,t426:4.085986474):0.3134605362):1.40172292,((t427:3.318249803,(t428:2.155363559,t429:2.152088834):1.124172728):1.460925743,(t430:0.8819494776,t431:0.6415583913):3.747253463):1.018420894):19.9445627):51.61128657);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T37.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
