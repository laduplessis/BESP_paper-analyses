<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t476:14.28879651,(((t477:0.191652243,t479:0.03327509854):0.5496470579,t481:0.4283748148):0.005129325329,t482:0.3873650503):13.43492633):39.32012927,(((t485:0.9693443198,t486:0.9223703957):21.43101415,((t483:0.2134083467,(t484:0.001598220509,(t480:0.08901067215,(t478:0.102912808,((t469:0.195752204,((t467:0.3173051146,((((t371:0.0506999285,(t352:0.01178985161,(t281:0.02072666537,(t277:0.08645310567,((t258:0.03234921398,(t259:0.008944201309,(t245:0.1035503,((t239:0.06937089888,(t215:0.2557135916,(t180:0.2817594825,((t134:0.01487147487,(t130:0.1074076515,((t117:0.2031291018,(((((t91:0.0656643203,(t63:0.0489745259,((t29:0.09685936361,(((t1:0.5573666612,t2:0.5533849396):0.1657833022,t3:0.5387868045):0.4537542404,t4:0.9538582819):2.306624436):2.520934543,t5:5.463687091):0.5032926568):2.40781503):0.9164274725,t6:9.280396834):0.6922724504,((t7:4.227992539,t8:4.164023188):5.00896432,(((t9:7.0681534,t10:6.927713303):0.6895638437,(t11:0.8198760937,t12:0.5901555506):6.730043922):0.8291566766,(t13:4.881514889,(t14:1.404442407,t15:1.296353015):3.422417455):3.243252299):0.3578322499):0.6936246999):0.7162127213,t16:9.581952804):0.2170431936,(((t17:3.177245237,t18:2.940708879):3.886992072,t19:6.122832373):2.202654416,((((((t20:1.958176176,t21:1.943574147):1.794085769,(t22:0.6082341122,t23:0.5618725112):3.022138128):0.05746459736,(t24:0.02376017368,t25:0.01357237131):3.560246792):2.937998873,(t26:5.337937732,(t27:1.923733855,t28:1.893642436):3.339535394):1.157875896):0.2934077078,(t30:5.12264353,(t31:2.965698166,t32:2.926891124):2.145137439):1.343699492):0.6923298723,(t33:4.848214826,(t34:4.637229391,(t35:2.351643811,t36:2.074169317):2.283479317):0.1959096269):2.219425426):0.5000614716):0.2804521344):0.4715456511):1.091640352,(((t37:5.800521528,(t38:4.553207069,t39:4.512401564):0.5037581033):1.073619001,((t40:5.818214013,(t41:5.408419703,(t42:4.53096609,(t43:1.358144461,t44:1.339419508):3.046301578):0.7622799381):0.202722545):0.1707030655,(t45:2.877754632,t46:2.848916154):2.606176998):0.09794471444):1.924935365,((t47:4.60706189,t48:4.322767241):2.715730855,(((((t49:3.878780783,t50:3.817337721):0.3317420597,((t51:1.831145795,t52:1.754605026):1.958436881,t53:3.599067733):0.3321206629):0.5650039584,t54:4.380608436):0.5897174869,(t55:3.849928197,((t56:2.763801822,t57:2.744458563):0.3395868592,(((t58:0.6442844228,t59:0.6224280278):1.163967765,t60:1.680430411):0.2894826826,(t61:0.2967039603,t62:0.28000336):1.562557997):0.9545216655):0.7327934163):1.091369875):0.8809148462,((t64:1.985129291,t65:1.777357833):0.3710144797,t66:2.074626218):2.967396216):0.7463230286):0.09326828585):0.315260125):0.3071646762):0.2556635294):0.9666207727,((t67:4.369031406,((t68:1.58638713,t69:1.569034851):2.05654252,(t70:1.525986312,t71:1.390484262):2.010952584):0.5129465088):0.07700533887,t72:3.965095317):3.279436035):3.731242284):3.325035018):1.244178357):0.3055805876,((((t73:1.661657231,((t74:0.5692011332,t75:0.4628352788):0.5992204342,t76:0.822569075):0.3853331042):1.312865228,t77:2.463442698):6.012395409,(((t78:2.942524579,((t79:1.366122812,t80:1.203924701):0.7593531218,t81:1.926194719):0.7982035525):1.6629063,((((((t82:1.086389017,t83:1.064826228):0.5251359528,(((t84:0.1915288968,t85:0.08230098474):1.228318079,(t86:0.3911406473,t87:0.3801443992):0.8111206184):0.03181769192,(t88:0.797604086,(t89:0.1510640194,t90:0.09275294166):0.4978324029):0.4161624329):0.08359654845):0.7646855331,((t92:0.5861148571,t93:0.5577160649):0.6286661546,t94:0.7325342305):0.3539459404):0.705719649,(t95:0.9658005859,t96:0.959929357):0.6260972892):0.7222717527,((t97:0.1368637681,t98:0.06102216146):0.6926718294,t99:0.6480737729):1.469334718):0.07591147621,(((t100:0.169141841,t101:0.06458918268):0.1644620613,t102:0.1371106677):1.660673315,(t103:1.219234863,((t104:0.2216392045,t105:0.2162017055):0.07801636224,(t106:0.04719728441,(t107:0.009067648373,t108:0.001639853048):0.01603624778):0.119322428):0.8718092576):0.5574007136):0.0004440964265):0.3804341907):1.755620366,t109:3.404377777):2.098117985):6.602249368,(((((t110:0.7392500948,t111:0.6145748866):0.2716842461,t112:0.8847974923):0.5966925448,(t113:0.4106631495,t114:0.2621196072):1.048255304):9.707885159,((((t115:0.7437275437,t116:0.6619503505):2.652082681,((t118:0.7000847166,t119:0.4389816243):1.631885088,t120:1.876419652):0.6255640149):0.5979300991,t121:3.081594454):5.621930744,((t122:0.1660739023,t123:0.1465279639):2.837948899,t124:2.96213758):5.433757067):1.059220795):0.3688872582,((((t125:0.6992325624,t126:0.6511573009):2.098771962,(t127:0.4828220175,t128:0.4600488657):1.999411255):0.1526904629,t129:2.540916352):6.769781541,((t131:8.424607483,t132:8.316513021):0.3931879827,(((t133:4.745726527,t135:4.714100294):2.708097206,((t136:0.3266463911,t137:0.3077246042):3.917017597,(t138:0.5279960199,t139:0.4250059901):3.5029992):3.171989291):1.117348932,t140:8.168887586):0.1308658063):0.2516056423):0.03250479027):0.393668753):0.2135202294):0.5638351109):1.37586967):0.01120130811):0.03964420453,(((t141:6.699559293,t142:6.631665373):1.583715014,((((t143:2.221713708,(t144:1.400659324,t145:1.031702328):0.6205373288):2.078091978,t146:3.708714274):2.237254794,(t147:4.533928294,(t148:1.93618036,t149:1.883233788):2.374458068):1.038552909):0.7531774855,((t150:5.203307589,((t151:4.380090617,t152:4.374290071):0.03898410774,t153:4.395003218):0.6177712256):0.7924546608,(t154:5.19511947,t155:5.154711349):0.4711693633):0.03187690541):0.8927020036):0.488857512,((t156:6.092848108,t157:5.981764244):0.3112190128,t158:6.27087872):0.5786851651):2.382952431):2.27007253):0.219323312):7.177369479):1.715795524):4.836168656,(((((((t159:4.565809677,(t160:4.357714691,t161:4.303244775):0.1552316336):2.556189918,(((t162:2.87397889,(t163:0.3470143373,t164:0.2155359867):2.458751564):3.286785541,((t165:2.308940815,t166:2.073393022):2.26152653,(t167:0.3198631409,t168:0.268503338):4.00992557):1.353726687):0.1237803316,t169:5.681623455):0.669368036):10.52783906,((((((((t170:4.435925341,((((t171:1.03717796,t172:1.001387798):0.308499051,t173:1.169523337):2.386180661,(t174:0.3532010479,t175:0.1702090156):2.915070463):0.4435972967,(t176:1.978931653,t177:1.88599823):1.48843009):0.2541696065):2.221199479,t178:5.824317646):0.2854867857,(((t179:4.834429278,t181:4.311654672):0.04871525336,((t182:2.51543282,((t183:0.170699365,t184:0.04555183188):0.6203148427,t185:0.5892302284):1.699292947):1.199950573,(t186:0.2237197286,t187:0.09847822272):3.082707295):0.4778849859):0.02898744993,(t188:1.664941621,t189:1.649581405):1.999577963):1.119683894):0.3603674309,((t190:1.949977538,t191:1.867445934):1.315724918,(t192:0.6425588679,t193:0.5742438113):2.528954863):1.445067175):0.7113234116,((t194:3.252279721,(((((t195:0.3557597919,t196:0.2315853083):0.3265771393,(t197:0.07859106756,t198:0.07551891378):0.4648225046):0.7482946567,t199:1.196121006):1.051104746,t200:2.242430394):0.3369385645,t201:2.574155732):0.4160140271):1.543545407,((t202:2.641541434,t203:2.570639359):0.7792124882,(((t204:1.797482178,(t205:0.9908672843,t206:0.9327562425):0.804426241):0.6576208789,(((((t207:1.14046383,t208:1.07129533):0.07989780126,t209:1.148321953):0.07516519387,t210:0.9272828279):0.3356901226,(t211:0.2995127163,t212:0.2324101034):0.9557328552):0.3782308949,(t213:1.003764627,(t214:0.832128053,(t216:0.3610391868,t217:0.3081736271):0.1385689713):0.1287402152):0.1272874378):0.3605218958):0.4253930519,((t218:0.0560222606,t219:0.04641247381):0.2770257751,t220:0.313567268):1.089019156):0.4555134054):0.8449598712):0.4134858606):1.434728416,(((((t221:0.451107606,t222:0.4402318422):0.7122930587,((t223:0.5375672741,((t224:0.1953012651,t225:0.1869975096):0.142716767,t226:0.2936673809):0.1161210175):0.3348713046,(t227:0.6151709725,(t228:0.2833283792,(t229:0.1110371443,t230:0.05009771781):0.1452034915):0.2752066788):0.1245931134):0.2243520613):0.2550617566,t231:1.072072063):1.022012778,t232:2.089207029):0.1119690977,((t233:1.059953725,t234:0.977856935):0.4492077735,t235:1.242158656):0.5729539065):1.990340726):2.308614199,(t236:0.7010143603,(t237:0.1456031212,t238:0.0495715406):0.5403444459):5.399413195):0.5036527154,((t240:0.4646873908,t241:0.3896311332):0.5862735074,(t242:0.2297441196,t243:0.2266776482):0.5842036761):5.214063864):4.475308029):3.196020424,(((t244:8.9021705,(t246:1.447316811,(t247:0.38705994,(t248:0.1017612119,t249:0.06239918554):0.1391655502):0.9616730658):6.992633762):2.745029651,((t250:8.144149867,(t251:2.143329961,t252:2.137987678):5.916992214):1.433684402,((t253:6.463772418,((t254:2.817091151,(t255:2.610466505,((t256:0.08790138586,t257:0.06302264555):0.5131669694,t260:0.03291932273):1.907378296):0.05081315313):1.700559269,t261:3.496997326):1.863800843):2.700108616,t262:8.04171798):0.127410549):1.204660151):0.1123725789,(t263:9.426513324,((t264:5.02332066,t265:4.797306305):3.989141109,((t266:6.248487456,((t267:1.3311147,t268:1.160130209):4.787959508,t269:5.880043072):0.1126480013):1.666980591,(t270:6.065046716,t271:5.99879796):1.391580871):0.4457085053):0.4071880207):0.03564324701):1.687901785):0.130327285,((((((t272:2.001603707,(t273:1.81968874,t274:1.773046547):0.04596500281):3.748893194,t275:5.456931812):0.01345960088,(t276:4.925755871,((t278:1.225615053,t279:1.174459971):2.808376418,t280:3.976414808):0.6603891895):0.5435679339):0.02564855309,(t282:0.8132526879,t283:0.7582697514):4.263892063):1.552206276,(t284:0.0836132969,t285:0.04219741832):6.27693063):1.482095569,(((t286:5.439138146,t287:5.216218564):0.2011405987,(t288:3.515612645,(t289:2.22171905,(t290:0.05232743922,t291:0.04696836884):2.088526634):1.164875049):1.86349381):1.585049715,((((t292:4.016625104,t293:3.886519792):1.062366064,t294:4.923601532):1.193967536,(((t295:4.366460786,((t296:3.071312832,t297:2.935107148):0.2215578054,(t298:2.33050207,t299:2.246767862):0.6314103467):1.050302657):0.5335237315,t300:4.287347469):0.1300641703,(((t301:3.23048697,(t302:0.4202856271,t303:0.3690849103):2.781386541):0.7782478052,(t304:3.750813837,(((((t305:1.139955026,t306:1.126441313):0.2621640972,t307:1.265678637):0.6381319141,t308:1.801636095):0.6487561378,t309:2.404835221):0.6406148068,t310:2.984699106):0.3741335566):0.1692869262):0.09956592907,(t311:2.928597854,(t312:2.623001974,t313:2.576667323):0.3031781859):0.4788495297):0.0410926327):0.7098188446):0.06475429214,(t314:1.133584416,t315:1.018339177):3.033354319):0.2943334994):0.559416932):1.122591991):0.1217597387,(((((((((t316:3.339353963,(t317:1.94037486,t318:1.77261421):0.7565685634):0.9444363355,(((t319:1.642301533,t320:1.617858094):1.515174064,((t321:1.967593838,((t322:0.5287726367,t323:0.3267984683):0.0910149067,t324:0.3608432364):1.213736949):0.01645040988,t325:1.496679218):1.089243829):0.2179495985,(t326:0.3436974284,t327:0.1558520516):2.402781595):0.05333175982):0.1903430103,(((t328:0.762857159,((t329:0.05776419193,t330:0.02011464238):0.4081951364,t331:0.3878938678):0.2944966631):1.192944181,((t332:0.6596395988,t333:0.4267162792):0.7096985423,t334:1.117901692):0.4894834885):0.1009816681,((t335:1.1780907,(t336:0.3528746039,t337:0.2955192219):0.7082265471):0.2503437004,t338:0.850396226):0.215024146):0.6789969772):0.286697725,(t339:1.132400098,t340:1.111052969):0.8958586631):0.01783540508,t341:1.961969551):0.4214097113,(t342:0.5805283266,t343:0.5361463026):1.777346999):0.2843043917,(((t344:0.2568532078,t345:0.2271107937):0.417732665,t346:0.3872917295):0.9916890847,t347:1.29640657):0.9152395365):0.08103384933,(((t348:1.145552547,t349:1.099249849):0.09219657767,t350:1.152628245):0.5977449396,(t351:1.058422153,(t353:0.09210707183,t354:0.04083838016):0.7709372083):0.521267538):0.2719170452):0.3055267876,(((t355:0.07346094177,t356:0.0720485501):0.729381682,t357:0.4306137708):0.6396579326,t358:1.047677046):0.2867707972):0.2050628165):0.8681086513,((t359:0.9825919779,t360:0.8396495265):0.7887110407,(t361:1.507628527,t362:1.488575032):0.01131124985):0.6071822188):3.426515652):2.447330987,(t363:3.343186514,(t364:1.28956991,t365:1.176827865):1.959780509):4.61271806):0.444156307,t366:8.16620673):1.442853097):0.3700245901,t367:9.93546832):0.05099555126):0.1664631865,(((t368:4.208212316,((((t369:0.3619933809,t370:0.131214968):0.5959576108,t372:0.6082129247):1.333764762,(t373:1.029952203,((t374:0.08217557213,t375:0.05929782587):0.3417761654,t376:0.335930665):0.4016947995):0.8474695838):0.1025560885,(t377:1.310033295,t378:1.290659981):0.356805817):1.806004422):4.796450623,t379:8.142399157):0.3631197972,t380:8.461179702):0.743025189):0.7163008107):0.1624688937):0.1632693682):0.1678799295):2.604833729,((((((t381:2.35563728,t382:2.355281135):2.409089464,t383:4.759642614):0.4535561239,t384:5.064911014):1.624563135,(t385:3.546543179,t386:3.534358765):3.002845659):0.04834471291,((t387:0.8797905073,t388:0.7277407227):0.1357824796,t389:0.5819186693):5.523239318):0.1618587379,t390:6.001382141):5.831931293):19.80317326):22.86994097,(((t391:7.401485537,(((t392:5.951169558,(t393:5.364975613,(t394:4.314610093,(t395:0.3894363386,t396:0.3772070599):3.842358148):0.7958198036):0.4012514385):0.2293028131,t397:5.508761963):0.9177641446,((t398:1.706348437,t399:1.476805778):2.814657753,t400:4.202591353):1.898435362):0.2330413291):1.039418109,(((t401:0.4823950105,t402:0.4479094804):4.816051807,((t403:1.419733178,t404:1.397185634):3.449446502,t405:4.818510282):0.2424695742):0.5491731783,t406:5.539938064):1.443944474):33.08431195,((((((t407:5.689576739,(t408:5.338131104,(t409:4.267353756,t410:4.2601582):0.9663620663):0.3467178963):0.5530429572,(t411:0.4244225198,t412:0.3461469031):5.696362023):1.710753,t413:7.700901381):0.2522888135,(((t414:4.653905187,t415:4.599269585):2.214763991,(t416:5.844373667,(((t417:3.393817723,(t418:2.810343055,(t419:2.094683504,t420:2.008738496):0.6725636488):0.4167605028):0.238376865,t421:3.081626972):0.8796685361,t422:3.860782067):1.151094946):0.7349011565):0.8314824702,((t423:4.173859583,((t424:0.5984539496,t425:0.4919910458):2.294864249,t426:2.662740991):1.215784242):2.095430595,(t427:1.410256028,t428:1.034986767):4.237040228):0.2527714787):0.1608192089):0.008634624601,(((((t429:2.259381334,(t430:2.001157488,t431:1.793803548):0.2178878231):1.19791327,(t432:2.756768752,t433:2.600395237):0.3222481781):0.1366123106,t434:2.99150641):1.611032558,(t435:3.30171055,((t436:1.412966692,t437:1.408584787):1.656856547,t438:2.955437123):0.1603960435):1.277457802):0.4590850374,((((t439:1.821591761,t440:1.80185265):0.342299915,((t441:0.5264121723,t442:0.4752476016):0.6937138544,t443:1.165300309):0.8896283456):0.3005843643,(t444:1.524844328,t445:1.524833855):0.7596345266):2.329312649,(((t446:2.711812384,t447:2.543969108):1.253921435,((t448:3.024968713,(t449:3.001684782,t450:2.905893481):0.007129523537):0.459646631,(t451:1.39367045,t452:1.365998812):1.936574282):0.247176002):0.2482691522,(t453:2.055660184,t454:2.053771767):1.721901662):0.3568103123):0.03169500388):0.02644915285):0.307999804,((((t455:1.784712937,t456:1.558654534):0.9787805121,(t457:2.23547735,((t458:0.6725184964,t459:0.5380506209):0.6432436961,t460:1.037965614):0.8323548167):0.2407087336):0.6300029211,(((t461:0.3809723485,t462:0.218437041):1.347300479,t463:1.552005546):0.8246068756,((t464:2.022193683,((((t465:0.2295395547,t466:0.09434950081):0.5572420354,t468:0.03561437182):0.5238578553,(t470:0.1575354932,t471:0.1066446391):0.1249785407):0.0349593854,t472:0.1123037453):0.3792726494):0.02899186869,t473:0.389633767):0.3105586607):0.108518559):0.4412712216,(t474:0.1908432133,t475:0.1627232478):0.8920702602):0.641390612):31.49667275):12.85183077):7.602744744);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T3.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
