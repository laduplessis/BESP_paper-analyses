<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t449:30.53712519,(((t450:2.708568016,t451:2.622956485):0.3820349049,(t452:2.023868545,t453:1.946914794):0.9344236317):1.202017732,((t454:2.962086675,((((t455:0.5384067639,t456:0.2374086848):1.709515115,t457:1.936995374):0.0643312896,t458:1.984396117):0.1941039969,(t459:1.392694966,(t460:0.662148383,t461:0.6216717214):0.6979940337):0.6955136652):0.2647977149):0.03168741527,(t462:1.95332643,(t463:0.340609659,t464:0.3282018286):1.590152506):0.2514043688):1.082034127):26.10725686):28.84173708,(((((((((t465:2.030030306,(t467:1.696609462,t468:1.591381504):0.0114405223):0.05267697914,t469:1.647332103):0.259305949,(t470:1.232882301,(t471:1.117371069,t472:1.112598338):0.04827938811):0.1908691838):0.529519667,t473:1.79935451):1.137729089,((t474:0.6725174687,t475:0.4104102557):2.043696662,(t476:1.780251201,t477:1.763310185):0.5667282893):0.1173716082):0.8863267831,(t478:1.038635503,t479:1.002743769):1.940063992):9.695689514,(((((((t480:0.182306202,t481:0.1799032966):0.1456348619,t482:0.2544542212):0.7364442108,(t483:0.6060369008,t484:0.6043471366):0.3752269098):0.08190969156,(t485:0.2773098868,t486:0.2288908406):0.7077425282):0.6745260404,((t487:0.5957676791,t488:0.52176633):0.6551548177,((t489:0.3554077843,t490:0.3453255827):0.1847682634,t491:0.4782731623):0.5701940019):0.3345037298):1.361161973,t492:2.725745494):8.778696075,(t497:2.990099092,t498:2.862956064):7.406520301):0.6736962159):0.199223073,(t499:0.8005912764,t500:0.6494271847):10.34000332):28.77629105,((((((t493:0.3183713714,t495:0.1283409144):0.04142806718,t496:0.07091094364):0.5933995403,(t494:0.1022829276,(((((t466:0.1913135448,(t446:0.06733769918,(t438:0.08748048273,(((((t234:0.00906119326,(t231:0.0232336516,(((t215:0.05953188448,((((t106:0.01009930598,((((t98:0.1194774354,(((t27:0.107844427,(t7:0.2054638118,t1:0.5201932928):2.748581591):3.169181014,t2:6.332775407):3.782160716,((t3:7.92576791,t4:7.918082299):1.50521369,(((t5:0.2311564444,t6:0.1375775144):5.214471382,(t8:0.733702706,t9:0.6761342002):4.392644229):3.920271448,t10:8.9608107):0.0162606657):0.6322264835):0.2583939524):0.172879058,t11:9.725196725):1.048048804,(t12:9.36514398,((((t13:6.238029065,(t14:3.905753956,t15:3.352367386):1.900228785):0.7801779487,t16:5.857304794):1.416392957,(t17:6.944647458,((t18:0.3659380889,t19:0.3381866077):6.511123259,(t20:4.007394087,((t21:2.946283258,t22:2.773311168):0.1588810884,t23:2.887373631):0.6558616198):2.804646008):0.04160085752):0.3138137923):0.7013643558,((t24:5.752633462,(t25:1.988792353,t26:1.890193647):3.674684297):1.175897951,(t28:6.161531811,t29:6.060753172):0.4257932058):0.4642619479):0.0145098794):1.344613172):0.2991728933,(t30:7.309489656,((((t31:6.346642666,t32:6.340254479):0.4424452707,(t33:5.566430667,((((t34:3.926014313,t35:3.904646085):0.5856635797,(((t36:2.46298109,t37:2.383939054):0.2838036695,t38:2.537217119):0.9218265598,(t39:2.486924736,t40:2.468662119):0.9180921313):0.7706019273):0.05341321759,t41:4.013976643):0.1539402155,t42:3.934777622):0.8038280051):0.7987055353):0.1294576371,(((t43:1.653680131,t44:1.364279799):1.031287491,((t45:1.072845094,t46:0.9506602216):0.2011212088,t47:1.081242429):0.9910936001):2.012858734,(t48:4.029294124,t49:4.021072433):0.0002001780553):0.9243762537):0.239146905,(((((t50:1.19541923,t51:1.190429811):2.405363942,t52:3.536528753):0.6807021717,t53:4.118270748):0.1774176699,(t54:3.46023662,t55:3.308757813):0.8262869669):0.192156887,(t56:4.088185788,(((t57:1.943300248,t58:1.856701286):1.320321864,t59:3.13953712):0.5399230859,t60:3.507155093):0.09357009365):0.2042466848):0.4989145453):0.05666124589):1.203848774):0.411978466):7.916518995,((((t61:2.903794654,(t62:1.37859721,t63:1.36523622):1.280361781):0.1252712208,(((t64:0.3481916346,t65:0.3098009954):1.960189376,(t66:1.880172971,t67:1.766438751):0.3225563472):0.07369020759,t68:2.107605364):0.354699291):3.461644426,(t69:3.409233032,((t70:1.552600921,t71:1.49760004):0.8577457913,((t72:1.720773517,(t73:1.50960698,((t74:0.8755981393,t75:0.8345162558):0.225076725,(t76:0.3804653404,t77:0.2736857493):0.5446876914):0.3374799713):0.1589269899):0.1054150413,(((t78:0.5072577431,t79:0.4495660856):0.1586149513,t80:0.5907323304):0.6239913992,t81:1.147946778):0.1042983886):0.4937651817):0.9981423487):2.438133262):6.233724427,(((t82:1.529271271,(((t83:0.1984193899,t84:0.04778545644):1.298488345,t85:1.232209839):0.007790612818,(t86:0.7969001325,t87:0.6937170241):0.4014177527):0.008079091154):5.276917761,(((t88:0.3390859717,t89:0.2352086765):0.1062958702,t90:0.06618357622):1.623570027,t91:1.646260303):3.618794492):2.432881439,(((t92:1.741191498,(t93:0.7350965457,t94:0.4188979127):0.9854601943):0.2390832835,(t95:1.400458282,t96:1.319397738):0.1052847516):0.3446588477,(t97:1.399153503,t99:0.08719969809):0.2999853796):5.322958543):2.104844134):1.1453129):1.981143639,(((((t100:2.693409241,(t101:0.2058489296,t102:0.08774015974):2.481403046):2.890445917,((t103:1.135656141,t104:1.082552719):2.28230092,t105:3.350749502):1.494774844):2.312434854,t107:7.038337166):1.632286379,((t108:6.181761717,((t109:1.333338751,((t110:0.02402396368,t111:0.001280393062):0.5037754874,t112:0.5039847119):0.799297616):1.699866631,t113:2.983140394):3.141289804):0.7440975947,t114:6.865773007):1.449504088):0.8612574065,((t115:0.8476392947,(t116:0.5015589437,t117:0.4448792279):0.1926246931):1.062857308,t118:1.131988775):6.99417004):0.3647778164):0.02054643853,((((t119:6.011093458,(t120:5.29244666,(t121:1.685992813,t122:1.684599687):3.392218566):0.6774894973):0.04832520618,(t123:3.017433634,t124:2.990383774):2.690377448):1.579333293,((t125:3.266396598,t126:3.181506437):2.982459755,(t127:5.754465936,(t128:0.8191373573,t129:0.7327044026):4.856675548):0.3880048008):0.9569782168):0.04200496453,(((t130:3.230146212,t131:3.16827925):3.405890864,(((t132:0.3578810776,t133:0.3505313816):0.6331185399,t134:0.9153582978):3.365866811,t135:4.243887004):2.205011576):0.01636101619,((t136:0.1826413576,t137:0.1762357112):1.68392269,t138:1.742995836):4.575121318):0.2907028663):0.5680544593):0.7696939302):0.6366638234,(t139:6.879243348,((t140:5.230914547,t141:5.201741465):1.069963036,(t142:0.8917783761,t143:0.6725774796):5.289684557):0.5460980995):1.681230965):0.6422558557,((((t144:5.696249114,((((t145:0.4947998275,t146:0.4720800764):2.235754522,t147:2.673157128):1.889322408,(t148:0.08812130225,t149:0.02782793139):4.388851535):0.7832106877,(t150:2.905780979,(t151:2.783616563,t152:2.444550525):0.1186947103):2.183817684):0.1463549541):1.796643452,(((t153:4.44703708,t154:4.350756377):0.6158795439,t155:4.902590332):0.2480259954,((t156:1.466253114,t157:1.441562177):2.75432752,t158:3.868431868):0.8003076756):1.083964111):0.2868405656,((((t159:0.6040021558,t160:0.5273616719):2.933380858,t161:3.435911137):0.7308351356,(t162:3.370249219,(t163:2.937353,((t164:0.4619185967,t165:0.4236317967):1.047254916,t166:1.45041581):1.254828596):0.2247905625):0.7783183684):1.165800117,(t167:4.502496969,((t168:3.946708977,((t169:0.5800142953,t170:0.5457537773):2.147191488,(t171:1.127298341,t172:1.110126527):1.409310154):1.012433019):0.1913195627,(t173:3.316788561,((t174:3.173429111,t175:2.919346565):0.05055230909,((t176:1.007691114,t177:0.9038438379):0.5210673384,t178:1.416933515):1.275226384):0.09000095666):0.4048531294):0.2847674082):0.3668042445):0.4941255857):0.9397166734,(t179:4.678773077,(((t180:3.752033346,(t181:2.480082189,((t182:1.666013272,(t183:0.3208781979,t184:0.2850547437):1.32969856):0.1649711676,t185:1.706130803):0.6247127607):1.261091038):0.3335284933,((t186:0.1661276948,t187:0.06761231132):2.31056226,(t188:1.149555076,(t189:0.01643361563,t190:0.01207338638):1.097057647):1.178288584):1.348536011):0.1928080896,(((((t191:2.151406684,t192:2.086495504):0.6169319806,(t193:0.6947267537,t194:0.6289465346):1.921466824):0.0922325814,(t195:2.423299533,((((t196:1.773766885,t197:1.363325966):0.1155774886,t198:1.317585887):0.3620651808,((t199:1.169359037,t200:0.861467867):0.3445036264,t201:0.925174965):0.1334581209):0.07987831417,((t202:0.3900889267,t203:0.1483395199):0.3033452749,t204:0.3920599114):0.224723157):0.07798178499):0.2018772984):0.1255226076,t205:0.9171908015):0.248713734,t206:1.12416193):0.5696187486):0.1767152726):0.5404372748):0.03543702629):0.547648425):0.04542267903):1.76910728,(t207:0.2882094167,t208:0.1501832965):4.256502474):7.518163242,(((t209:0.6460948185,t210:0.4838744024):7.936406772,((t211:0.09065882403,t212:0.05901194045):3.257582182,(t213:1.259825438,(t214:1.244982574,t216:0.8483568751):0.01123230062):2.043229631):4.988797581):2.919433492,(((t217:1.019585526,t218:0.8872184855):6.257024398,(t219:0.7549725068,t220:0.5797935626):6.317558815):1.702013969,(t221:3.835491583,(t222:0.6865586664,((t223:0.1108951744,t224:0.04199041875):0.3315554942,t225:0.3443272621):0.04250899548):3.015457534):4.745826807):1.695839318):0.1447008494):0.7483894417,(((((t226:7.245010108,(t227:0.6791694597,t228:0.3340168329):6.46298084):1.751613767,t229:8.532131868):0.5750477884,(t230:7.409771975,t232:7.34471722):1.608540277):0.4988336093,(t233:6.367660792,((t235:0.3859262396,t236:0.3596400814):1.730918202,t237:2.055704334):4.191986251):3.065148733):0.5427612522,((((t238:0.7730514559,t239:0.7723857954):3.517609108,(t240:3.229233699,t241:3.216442517):0.3606209734):5.095764962,(t242:7.395432695,t243:7.393122639):1.230852937):0.1670999564,((((((((t244:0.2076990829,t245:0.1156917476):3.244404083,t246:3.078221202):1.013616918,(t247:2.825465997,t248:2.655771361):1.251901644):1.088114093,t249:4.887454674):1.686738334,(t250:3.819082569,(t251:2.678960433,t252:2.671394686):1.115928535):2.71901593):0.3739287816,((t253:3.370171596,t254:3.351431103):3.040018384,t255:6.340533682):0.3785982808):0.3146830469,((((t256:1.522286731,t257:1.520053678):4.538211723,(((t258:5.161153565,(t259:4.636035916,((t260:3.236435166,(t261:2.000535678,t262:1.968829892):1.225229577):0.7007693888,t263:3.83158634):0.6263432124):0.5110871446):0.3188534861,(((t264:4.27332022,t265:4.24562015):0.4057660822,(t266:0.09994977303,t267:0.05978098288):4.272842545):0.06155846498,(t268:1.053472455,t269:0.9749999321):3.322404897):0.4958412965):0.2307472665,t270:4.508617185):0.2314702323):0.154327407,(t271:3.755801791,((t272:3.061094913,(t273:3.017165111,t274:2.917165259):0.006250247603):0.5598823797,t275:3.468903687):0.03172068043):1.002571836):0.4876633003,(((t276:0.1885700606,t277:0.1475415992):3.993572493,(t278:3.974958633,((t279:2.895781227,(t280:2.38466009,t281:2.313813861):0.4719793726):0.8160815835,(t282:1.686924176,t283:1.640749873):1.652974556):0.2189107907):0.09828770094):0.5787029734,(t284:3.36683344,(t285:1.672139958,(t286:0.9871869348,t287:0.9478187543):0.5731534989):1.580483048):0.7187001793):0.01085225727):0.2759204987):0.1240628978,((((t288:1.752917171,t289:1.681990312):1.754923207,t290:3.263135415):0.3332371712,(((t291:0.832731827,t292:0.8316534081):1.353549875,t293:2.160253468):1.053860736,((t294:2.022323891,t295:2.005627992):0.564120582,(t296:2.27070485,((t297:1.72432278,t298:1.675579769):0.1949458858,(t299:1.577357867,t300:1.518588478):0.2891933703):0.2941214404):0.2853240328):0.5819058505):0.3383689326):0.2122508929,(t301:3.056965874,(t302:2.088782101,t303:2.033874811):0.8897875885):0.4211274436):0.1769987853):0.6724965633):0.2810390494):0.06938595745):1.244751359,((((t304:1.687510259,t305:1.644831742):1.778725799,(t306:3.224760174,(t307:1.088899923,t308:1.002493626):2.046565893):0.1517585616):0.4647864253,t309:3.663882726):1.589152876,((t310:3.604071333,(((t311:1.618175068,t312:1.598634913):0.6070099182,t313:2.193526131):0.04001567894,(t314:2.182716904,t315:2.104751451):0.02320985129):1.184962576):1.579965023,((t316:0.07932716337,t317:0.06148531157):3.112516618,((((t318:1.232926829,(t319:1.02831443,t320:1.023371331):0.1702774018):0.7685849458,(t321:0.1999037172,t322:0.1914796293):1.7039133):0.4854044966,(t323:1.350560385,t324:1.325607708):0.9972962729):0.01786515001,(t325:1.442497434,t326:1.389480555):0.789527185):0.6289012659):1.53358526):0.02284945463):0.1816248444):5.034541428):0.6538424747):1.736681133):0.554316312,(((t327:2.938895187,((((t328:1.024634292,(t329:0.2690124528,t330:0.2561672612):0.6327601129):0.6940508944,t331:1.564041946):0.0573419092,(t332:1.269520746,t333:1.206331983):0.2376743833):0.7228734081,(t334:0.3351906886,t335:0.1152377248):1.757094884):0.3948336598):0.6540807317,((t336:0.7510462687,(t337:0.09380651894,t338:0.06117676687):0.4298900619):1.094544524,(((t339:0.6047285529,t340:0.6025842186):0.3463454428,((t341:0.08945475123,t342:0.07555538905):0.3862181995,t343:0.4093776548):0.2914291068):0.1718990987,(t344:0.8120380299,(((t345:0.1703417338,t346:0.105727457):0.1546457448,t347:0.1453389368):0.002282327996,t348:0.06876866668):0.4646363983):0.05259454753):0.4543446757):0.7374825414):0.3878874654,(t349:1.123039378,t350:1.122646266):0.9724517043):8.478754088):0.6954108985,(((((t351:0.2350968681,t352:0.1886716223):0.09564363597,t353:0.1330383341):0.4747594777,(t354:0.4704173262,(t355:0.01522871193,t356:0.003700706103):0.3114274432):0.1016867005):0.627723768,((t357:0.07735719633,t358:0.05808354923):0.7585664789,t359:0.4988427891):0.2046739612):5.065554541,(t360:0.06686123288,t361:0.02665830837):5.578975373):4.752957068):0.5412621886,((t362:2.035340055,(t363:1.480018361,(t364:0.8593188628,t365:0.8134398512):0.4103716492):0.1667751694):0.9408805654,t366:2.324955987):7.922256357):0.5146877188,((t367:0.3037891393,t368:0.2496386329):1.50397516,t369:1.516665764):8.933626095):0.006478917365):0.7810608661):0.7740742672,(((((((t370:0.3920437064,(t371:0.1083966593,t372:0.01161070459):0.1698308878):0.23384029,t373:0.3533185687):5.165292222,t374:5.464848517):0.8027636731,((((t375:0.7957068281,t376:0.748488699):0.6833259105,(t377:0.1330931215,t378:0.043391706):1.133547718):2.632274696,(t379:0.1831750823,t380:0.1762197618):3.618623605):1.058420052,t381:4.785314446):0.7211928491):2.802056253,(((t382:0.2913577235,t383:0.2194773219):6.46404998,(t384:3.192964221,(t385:1.246839423,t386:1.236851473):1.889157682):3.480582788):1.025450963,(t387:0.5660213677,t388:0.4440221258):6.940054103):0.5124081459):0.2431138374,(((t389:1.828443688,t390:1.804922376):0.593314932,(t391:0.6012905539,t392:0.559390613):1.763383638):2.654507261,t393:4.971685697):2.991349997):1.061805871,t394:9.016694421):1.2847129):0.579879595,((((t395:3.887773682,(((t396:1.410284264,(t397:0.5424685642,t398:0.4561694964):0.7824921762):1.055590351,t399:2.262859841):1.180618411,t400:3.404326777):0.04280720728):0.6032753945,t401:4.015690071):2.942949119,(t402:5.291610707,((t403:2.965445539,t404:2.895191951):1.967510757,t405:4.8016031):0.3093894493):1.610672395):0.07823377431,t406:6.716330877):2.916836345):9.724180058,(((((((t407:3.550449085,t408:3.501328833):0.2815033023,t409:3.76014517):2.403848101,t410:6.15682918):0.6994222729,(t411:6.225477396,(t412:4.332725988,t413:4.19877042):1.821205396):0.6052996307):0.3555740981,(((t414:5.370369851,(t415:2.863995558,(t416:0.6881247521,t417:0.5622963472):1.737735891):2.406735739):0.0230782285,t418:4.72575766):0.6405859454,(t419:3.864062501,((t420:1.177110233,(t421:0.53842903,t422:0.4880724365):0.6064657422):0.8267053268,(t423:1.641119428,(t424:1.335673977,t425:1.162057583):0.2576972988):0.2615692485):1.851935008):1.127702896):0.7882363847):2.367338722,(((t426:5.670092023,((t427:3.19491471,t428:3.142860737):1.170105507,t429:4.299889103):1.147496746):0.3428756711,(t430:0.8119418013,t431:0.8115490863):4.875019869):0.1196116406,(t432:4.310490408,(t433:2.425639791,t434:2.406808161):1.827304464):1.399105995):1.611205803):4.001695896,(((((t435:3.985697465,t436:3.826441288):1.246561517,(((t437:4.005913328,t439:3.867304974):0.2014230061,(t440:3.706874189,t441:3.649922855):0.3163496137):0.1030052053,t442:3.675004281):0.6902035001):0.09582417026,t443:4.430985454):0.4099524278,(t444:0.8421254294,t445:0.8387904266):3.991811556):0.05210639887,(t447:2.540235434,t448:2.486522316):2.184111627):5.432900015):5.688114517):29.0908126):14.59101964);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T70.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
