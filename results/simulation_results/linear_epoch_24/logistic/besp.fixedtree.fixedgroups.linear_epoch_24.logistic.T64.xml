<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t426:3.604136628,t427:3.270632781):0.1691355646,((t428:0.2376171627,t429:0.1347957227):2.915138926,(t430:1.314043441,t431:1.214935824):1.702695821):0.2076201941):0.300356257,((t432:0.8922614663,t433:0.8212203773):0.4436747215,t434:1.255818169):2.015627244):1.630610545,((t435:1.735701591,t436:1.732065341):3.058326195,(((t437:3.287044085,((t438:1.676833932,t439:1.64513451):1.295129383,t440:2.738951755):0.3079895754):0.3003810307,t441:3.337568399):0.5305476329,((((t442:2.35288858,(((t443:1.001038123,t444:0.7805732586):0.1378180589,t446:0.7115958323):0.1008426945,t447:0.7632018292):1.024376809):0.0152407098,((t448:0.8455824197,t449:0.8047737471):0.2681955039,t450:0.9093604378):0.5377754885):0.6594339861,((t451:1.129575158,t452:0.9710277451):0.8857163596,(((t453:0.3427424211,t454:0.2782090543):0.2541107934,t455:0.4372978539):0.6525463398,t457:0.4809666746):0.5978504077):0.01219601928):0.6191339846,(t458:1.339538548,((t459:0.2085070677,t460:0.2039717191):0.02291016913,t461:0.207455446):1.070956505):0.2626027246):0.2142513438):0.4538543014):0.04779646297):0.6173640737,(((t462:0.5414678951,(t463:0.1169199814,t464:0.08356080493):0.389350549):0.3315887752,t465:0.7949235454):0.8789858559,(t466:1.468108861,(t467:0.8362464581,t468:0.8287176599):0.5325522413):0.2026185734):1.084057845):13.08731545,((t469:1.192949419,(t470:0.4722966284,t471:0.2693853921):0.6816584347):0.7758677519,(((t472:0.4202241026,t473:0.1364723863):0.03049230812,t474:0.1239452283):0.9351310514,t475:1.050508022):0.337711055):13.76410232):11.81740023,((((t477:0.4645188059,t478:0.4167322026):0.9916326419,(t479:0.6143944462,t480:0.5040247374):0.7344189353):0.7979265073,t481:1.931186493):11.18928147,t482:12.74508741):13.21046045):56.91142506,((((t476:0.0433183307,((t456:0.3548126186,(t445:0.1519424393,(t392:0.00561134693,(t358:0.1247197542,((t344:0.08933916874,((t253:0.004712487894,(t247:0.005860562561,(t246:0.04869189845,(((t229:0.02583486755,(t147:0.02903639821,(t145:0.05836498997,((((((t68:0.02968007237,(t24:0.1298824039,t1:1.875116298):3.56815314):4.656687819,(t2:4.577730288,t3:4.564219458):5.280295965):1.461641987,((t4:0.3931752902,t5:0.3633330965):1.057144332,t6:1.383119871):9.71072452):0.6664892011,(((t7:0.8460702666,t8:0.7401671594):10.70838376,(((((((t9:0.1482127173,t10:0.1261838343):9.491801007,(t11:9.461026026,(t12:7.838741025,t13:7.70010753):1.528146089):0.06516370369):0.1196648348,(((t14:2.053502594,(t15:1.02080362,(t16:0.413861738,t17:0.3309786766):0.5633055249):0.8942775168):2.486743534,(t18:3.134695565,t19:3.044326039):0.9482478408):1.241521013,(t20:2.619603631,t21:2.558037503):2.599891632):3.619843176):0.7252550284,((t22:0.8937217872,t23:0.7941387337):6.951243181,((t25:4.969260162,t26:4.784391305):2.172867311,(t27:2.5335137,t28:2.48435613):4.149547711):0.431606037):1.637142423):0.03554878222,(t29:6.880755319,t30:6.640288249):1.795079088):0.1937719641,(((((t31:2.710293121,t32:2.469698361):3.5504343,(((t33:1.96963332,t34:1.931011367):0.314636843,t35:2.202250789):0.3408956778,t36:2.507167013):3.386973569):0.2396945389,(((t37:0.4107438462,t38:0.3466331541):2.273529676,t39:2.57338187):2.935556588,(t40:0.06516619796,t41:0.06457027864):5.355939007):0.4117860234):0.6341459228,t42:6.444100334):0.9265893144,(((t43:5.355001747,(((t44:0.3774479076,t45:0.3555344378):2.808349988,(t46:2.035300032,t47:1.933196703):1.042970854):0.3903308839,((t48:2.405960397,t49:2.368743161):0.1756157217,t50:2.457326342):0.6293929895):1.763087686):0.3558619159,(t51:4.809092861,(((t52:0.3722982449,t53:0.08120299411):2.481491667,(t54:2.478001006,t55:2.473941805):0.005902579045):0.3786701499,t56:2.857207746):1.5272981):0.2103582934):1.366702858,((t57:4.226510843,t58:4.07349604):0.2229064547,((t59:0.3489868366,t60:0.3233870239):1.811946336,t61:2.03587626):2.106353151):1.494880769):0.1935564039):0.3373106856):0.6090967455,(((t62:1.837260068,t63:1.816954352):1.236210834,t64:2.983762172):1.622293918,(t65:3.889735292,(t66:2.628023834,t67:2.624370523):1.220364926):0.7144801739):1.978399866):0.07709788906):0.05202645325,((((t69:1.59113083,t70:1.508184069):2.254579075,(t71:1.836479354,t72:1.77684898):1.87993162):1.603895436,(((t73:2.715081761,t74:2.685599175):1.569210586,(t75:4.11609749,((t76:3.822633799,t77:3.520793796):0.1529815045,(t78:1.410766886,t79:1.275171631):2.2261798):0.07702964702):0.1072889319):0.4001573638,t80:3.899845866):0.4823221549):0.5826188412,(((((t81:2.937111377,(t82:2.740928811,t83:2.734888089):0.05753306021):0.1551334642,(((t84:0.4206742821,(t85:0.09877349267,t86:0.01180902652):0.1333274062):1.801272532,t87:1.946055801):0.2860398062,(t88:1.887331809,(t89:0.2127930234,t90:0.1670324966):1.606796174):0.2789505918):0.310109374):0.01701435896,t91:2.348952754):0.8573237202,((((t92:0.362405625,t93:0.3299154954):2.25444835,(t94:2.137880598,t95:2.109536433):0.3851190647):0.06458925995,((t96:0.929917571,t97:0.9075923062):0.7188004677,t98:1.619158435):0.9076309448):0.04281795133,(((t99:0.2346971239,t100:0.2172623271):0.5562196718,t101:0.586608195):0.1606263869,t102:0.2890242459):1.56994465):0.4340844822):0.03397476591,((t103:1.331364744,t104:0.9160446619):0.7118743374,t105:1.565454959):0.07466089037):0.9072109645):0.4708021608):0.1526719884):0.3900014623,(((t106:1.400245694,(((t107:0.5662924234,t108:0.5012727204):0.3105945464,t109:0.3490040543):0.2180878065,t110:0.5509240781):0.1940110552):0.1423504415,t111:0.7974568512):0.1422447664,t112:0.9347642734):1.794337224):0.1040769705,((t113:0.04053847008,t114:0.0191664368):1.43196096,t115:1.310841338):1.351423452):0.7609806033):0.1362030254):8.201909709):0.02991978229,(((((t116:3.096648179,(t117:1.771335404,(((t118:0.05919100089,t119:0.03095238261):0.2194406935,t120:0.02686307652):0.3074179444,t121:0.2670811835):1.091409855):1.150744212):1.184135816,t122:3.666663579):5.533416589,((((t123:0.8683428997,t124:0.8360300642):0.1014965421,t125:0.5909551836):0.1388438156,((t126:0.565129815,t127:0.5273457597):0.00869558092,t128:0.4627785457):0.03343898502):5.003444209,t129:5.412477413):2.990503067):1.331595784,(t130:9.142324991,(((((t131:0.2200843718,t132:0.1973593419):0.02743976769,t133:0.01428736605):3.977831322,t134:3.962465405):1.204032615,t135:4.879824763):2.920411162,t136:7.373360077):0.7653696773):0.5907864645):0.107707588,(t137:6.314399167,t138:6.052156568):2.437959019):0.3559785049):1.673849706,((((t139:4.885217496,(t140:0.05387123443,t141:0.04739122653):4.66433103):1.245964873,(t142:0.7839551081,t143:0.7797335341):5.011664423):2.32730625,((t144:0.9457648966,t146:0.7675440481):3.973520971,t148:4.64136353):3.190946272):1.816719347,(((t149:6.482179963,t150:6.194807711):2.690301729,((((t151:3.249045813,(t152:0.07551858689,t153:0.01165827804):3.110061842):0.1739742398,t154:3.069754613):4.539059964,(t155:3.84267687,t156:3.726841121):3.694201373):0.3784795883,t157:7.770690919):0.3021930042):0.2328452061,((((((t158:0.4196863539,t159:0.4133531462):2.734134371,(t160:0.4391159229,t161:0.3848468023):2.563441373):1.604752023,t162:4.531482068):0.8078966573,t163:5.313704345):0.8037011427,t164:6.106622158):1.492062412,((t165:6.980748663,((t166:4.987362465,(t167:0.9339919744,(t168:0.0712805143,t169:0.02710934443):0.5729931143):4.046255627):1.61799009,((t170:1.105288449,t171:1.012958733):4.02005429,t172:4.799219551):1.041828668):0.2533679187):0.1395317415,t173:6.197767285):0.4659572755):0.3943991265):0.199575911):0.2006495062):0.3300794522):0.03784955319):0.5761043436):4.503369595,(((t174:3.635517895,t175:3.432804363):1.803219267,(t176:3.823137862,t177:3.806746129):1.406316259):1.433981066,((((t178:5.643768306,t179:5.302666021):0.1651995821,(((t180:0.5514401148,t181:0.3506962594):3.717351053,(((t182:0.3677198279,t183:0.3668528355):3.568297422,(t184:1.24460045,t185:1.243782369):2.50544834):0.04739043825,t186:3.766489598):0.02433970914):0.7493777079,(t187:3.575501028,(t188:2.848847967,t189:2.836488961):0.6084387728):0.9324805694):0.2986191094):0.5018806485,(((((t190:3.168441602,t191:3.046640318):0.01997771514,(t192:2.578649323,t193:2.468440284):0.3383639552):0.7670712333,t194:3.424209876):0.4120688311,t195:3.552907446):0.2458817263,(t196:2.317197074,t197:2.242474434):1.235848001):0.4608364591):0.04962006031,(t198:3.285435232,(((t199:2.199326489,t200:2.109436237):0.4285553774,t201:2.464293524):0.1419646295,t202:2.558580962):0.4856287484):0.6798807255):0.1414414888):5.946298243):4.952862098):0.9162155403,(((t203:1.371282399,t204:1.366750024):2.667697339,t205:3.863758743):1.210150664,(((t206:2.795423338,(t207:0.7524044751,t208:0.7029126728):1.980441111):0.2748988705,(t209:2.289247831,t210:2.191812372):0.6390463208):1.572467127,(((t211:0.568694672,t212:0.4914158135):2.042429138,t213:2.462015809):1.354313733,((t214:2.195530479,(t215:1.239759418,t216:1.11751932):0.9296739176):1.261846946,((t217:1.019498444,(t218:0.6969912273,t219:0.5935349294):0.2820714061):1.180378157,(t220:1.421614016,(t221:0.9721202077,t222:0.9576498582):0.3437073115):0.5387567499):0.8901732231):0.3367087838):0.1715827752):0.3962500877):10.41327669):0.4135552103):3.842804189):5.173126656):1.266069761):0.6732870002,((((((((t223:9.12559113,(((((t224:0.548667418,t225:0.5104093194):0.9297187421,(t226:0.7876275494,t227:0.7055254407):0.6308992063):1.67426431,(t228:0.5699270503,t230:0.280915835):1.991766366):0.7001792199,(((((t231:0.3181779468,t232:0.2983365328):0.2589297784,t233:0.5567669495):0.8549878472,(t234:0.7410232614,t235:0.690438412):0.6560189772):0.4532411683,(t236:0.9895693847,((t237:0.4959760137,t238:0.3588329899):0.09233984543,t239:0.4112147449):0.3704506098):0.5147856577):0.3315691482,(t240:1.252291413,(t241:0.3368948633,t242:0.1975348261):0.8270579304):0.3607865339):0.6583919574):1.388217524,(t243:1.460882333,t244:1.432750813):1.574119578):3.812367885):5.048763916,(((((t245:0.3766319604,(t248:0.08732055506,t249:0.05697994545):0.05709828905):0.940202902,((t250:0.4482496368,(t251:0.06545462683,t252:0.03832648825):0.2155325838):0.09847531793,t254:0.2110114024):0.2877938108):3.612526658,(t255:0.2306848926,t256:0.1912227141):3.802649212):5.519869903,((t257:1.035765699,(t258:0.3625859862,t259:0.2616052774):0.3737632158):4.120603694,((t260:0.7904471539,t261:0.7783136347):2.064415738,t262:2.778994965):1.810013232):4.182879604):0.3707715628,((t263:0.8230985625,t264:0.818437699):2.859649048,(t265:0.148027396,t266:0.08034786319):3.456178999):5.400486382):0.6144423955):0.352454933,((t267:0.1814333222,t268:0.1280577153):7.381468497,(t269:7.112070238,((t270:2.383993335,(t271:1.938858237,t272:1.625893929):0.3221784633):0.527351115,t273:2.454146442):3.626578921):0.3877152915):2.282236595):0.664625366,((t274:8.41441607,(t275:0.8361916809,t276:0.8308469371):7.500104266):0.3340996227,(t277:1.917509588,t278:1.662957951):6.642894047):0.6407332516):0.02646245988,((((t279:1.114220136,t280:0.9448367181):5.559603654,(((t281:3.223689692,t282:3.166835279):0.9765396975,(t283:3.867345258,t284:3.792660075):0.2522588633):1.531879208,t285:5.458092436):0.6964253934):0.4367983391,t286:6.563910664):0.08105968327,t287:6.624453758):1.745301139):0.4890121178,((((((((t288:2.30645511,t289:2.230696566):3.592153139,t290:5.811885265):0.03222774751,(t291:0.1163595779,t292:0.1056698713):5.599741996):0.5318643187,((t293:4.206066704,t294:4.04252864):0.9017804076,t295:4.852770501):1.021137169):0.1032952682,(t296:5.107070197,(t297:4.239507729,t298:4.029614454):0.7230630807):0.8641708892):0.3093123639,((t299:4.75854598,t300:4.728051566):0.7402962317,(t301:4.137307078,(t302:3.507068072,(t303:3.161560926,t304:2.936064197):0.3386278884):0.6263975551):1.308268028):0.4066097307):0.8546634056,((t305:6.394482675,(((((t306:2.855803779,t307:2.816959589):1.012624317,t308:3.655244784):0.6242367095,(t309:4.102588102,(t310:2.971220017,t311:2.850700776):0.8910984676):0.1719796963):0.2524121912,t312:3.979154792):1.34657859,t313:5.294146435):0.1723404327):0.03351343658,((t314:3.798707858,((t315:2.398270829,(t316:0.8432424711,t317:0.5172185693):1.493143853):1.072339138,(t318:1.933858956,t319:1.77078972):1.047209633):0.1759911222):0.9664469536,(((t320:1.614035746,t321:1.559985209):1.723479332,(t322:3.039823346,(t323:2.752659523,((t324:0.6638324197,(t325:0.03880507376,t326:0.02744522708):0.5216222955):1.415269374,t327:1.941188831):0.4151512057):0.1847989615):0.1552059422):0.4233160898,((t328:1.368082556,t329:1.323508715):1.13474224,((((t330:1.503833221,(t331:0.6942483668,t332:0.6939089556):0.6392430704):0.3461296546,((t333:0.8981922742,t334:0.8914007729):0.06624169973,t335:0.7483149904):0.7028011232):0.06276689902,t336:1.458034524):0.1139799245,(t337:1.317816075,t338:1.288686445):0.1540523268):0.3563643739):0.4758206782):0.1950820853):0.3541991174):0.006952840365):0.6866835034,((t339:1.645734722,t340:1.553364686):0.1928886268,t341:1.588779189):1.644595538):0.3550892762):8.842287477,(((((t342:1.183829898,(t343:0.6714013202,t345:0.1894640859):0.1257780987):0.4902275384,t346:0.7756915075):2.517576158,(t347:0.8129957235,(t348:0.233523823,(t349:0.1869230978,t350:0.1694414564):0.02829462772):0.5280774188):2.434767945):6.419487441,(((t351:0.3321859893,t352:0.3278423861):1.715469346,(t353:0.7375977512,t354:0.624716922):0.9410026593):1.553702945,(t355:2.125298326,(t356:0.1059791473,t357:0.09059451789):1.912272787):0.9765109133):5.885965342):1.338957706,t359:9.833097619):0.3417765342):0.2061199869,(((((t360:0.6596795717,t361:0.6587706973):0.454152104,(t362:0.2550809032,t363:0.2344270467):0.776780126):0.06941273988,t364:1.067041069):4.628300549,t365:5.329823809):3.837375961,t366:9.03484409):0.6254222329):0.5278357711):0.7790522547):0.377628349,(((t367:0.4079966714,t368:0.0538594757):0.6950365326,t369:0.6688950536):8.708482719,(t370:1.335333934,t371:1.207115165):7.994225921):1.526388807):11.04224766,(((((t372:0.3061525334,t373:0.2215077492):0.6813616672,t374:0.8773524948):9.178444034,t375:9.854915318):0.3380233308,(((((((t376:2.058453253,t377:2.028898183):3.53401411,t378:5.386152548):1.391062685,t379:6.743466722):1.72117515,(t380:2.561446177,t381:2.281445514):5.828905492):0.4801904745,t382:8.536160616):0.293018768,((t383:0.09149217211,t384:0.003876014858):6.631609755,(t385:0.3997351627,t386:0.08286116755):6.054840989):2.063645658):0.3903917315,((t387:0.8498781932,t388:0.5084824574):7.353320402,t389:7.830597131):0.383506162):0.2176421656):0.5638925125,(((((t390:3.390056986,t391:3.359902969):3.595664125,(t393:6.425092602,(t394:3.807176239,t395:3.759114218):2.286610826):0.3834021034):0.1347915764,((t396:3.656032698,t397:3.551354745):1.881573018,(t398:1.406409136,t399:1.341164571):3.983789014):0.753606379):0.407657138,t400:6.190855092):1.085286946,((((t401:5.357139667,t402:5.065014767):0.1548299419,(t403:3.523562295,(t404:0.7749406037,t405:0.7651458157):2.549713773):1.619281878):0.3204442511,((t406:1.341302023,t407:0.9960527416):1.855833929,t408:2.85177886):2.025251732):0.9413658551,(((t409:2.906337825,((t410:2.036174579,t411:1.854278108):0.4298177417,t412:2.174297267):0.4235826394):1.575629346,t413:4.072606914):0.07088163316,((t414:3.268834893,t415:3.182622052):0.189440057,((t416:1.902858976,((t417:0.7940238561,t418:0.7804024113):1.095057524,t419:1.766078378):0.01366521454):0.7409562627,t420:2.454708013):0.7235234434):0.5742712992):1.094217325):0.4998787812):0.08622867742):10.69688784):13.40661946,(t421:4.173698351,(t422:1.078660981,((t423:0.3150742789,t424:0.2974873417):0.2764769001,t425:0.5572516559):0.4549714636):3.089411573):25.27957782):58.77651233);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T64.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
