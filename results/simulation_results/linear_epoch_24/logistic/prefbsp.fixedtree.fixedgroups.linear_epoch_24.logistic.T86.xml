<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t479:11.36552668,((t480:0.2231415931,t481:0.1477373538):11.00869909,t482:10.9668384):0.0737077462):38.13366472,(((((t483:0.1633695918,(t476:0.02675682992,(t471:0.07568042684,(t472:0.02746225514,(t451:0.4123464821,(t452:0.2311336853,(t447:0.1841347701,(t394:0.007373599849,(((t374:0.0754561992,((t367:0.08118239827,(t361:0.1953055353,((t350:0.3114134859,(((t269:0.01838393504,(t265:0.1781947599,(((t244:0.0260534835,((t131:0.105683382,((((t111:0.06027904574,(t109:0.02759936983,(t107:0.1472688501,((t67:0.1349651844,(((t1:1.348436641,t2:1.17125564):1.392953588,(t3:1.852412693,(t4:1.037689021,t5:0.8085672988):0.7973704415):0.699732956):0.9310259172,t6:2.688998789):2.924997393):3.322582571,((t7:0.5992596184,t8:0.4865006979):6.215661144,(t9:2.094947663,t10:1.992873477):4.537693631):1.881112451):0.0797126649):0.08226841083):0.07029141654):0.7185181774,(((t11:0.6210753998,t12:0.6132471297):0.2264217382,t13:0.7446324939):6.358652007,t14:7.023846429):1.992865204):0.02056224569,(t15:8.821312212,(t16:8.304437873,((t17:5.363995638,(t18:1.179177783,t19:1.005416651):4.167253971):0.9776555041,(t20:0.3411396582,t21:0.3021277211):5.28808132):1.922195641):0.4984733614):0.2102423646):0.3547413828,((t22:7.114731901,(t23:6.88128753,(t24:5.233827784,t25:5.19131832):1.370363966):0.1474070586):0.3576597691,(((t26:1.374511966,t27:1.373662479):4.455048106,t28:5.697865203):0.2790875265,((t29:3.021595844,t30:2.949712702):0.9676539971,t31:3.892936521):1.897101831):0.9001343127):0.8605334231):1.455133858):3.486517597,(((t32:5.681685342,(t33:0.5764741579,t34:0.5726485162):4.979834744):0.9009628214,((t35:5.974141498,t36:5.95866929):0.1575412514,((t37:5.24095445,t38:5.163682824):0.5391711855,t39:5.643107804):0.2565766828):0.1615103048):1.371015868,((((t40:2.633429121,((t41:0.1946218161,t42:0.121665681):0.8089889205,t43:0.8834248305):1.609797088):4.058822605,((t44:5.453166804,t45:5.448840028):0.4485914701,t46:5.892669086):0.6013955392):0.3850657573,((((t47:1.890168963,((t48:0.1219719747,t49:0.07966066579):0.2582741079,t50:0.2939726639):1.23744534):1.068428029,(t51:1.370955501,(t52:0.6162897116,t53:0.3892497314):0.7183434813):1.152346476):3.208924855,((t54:2.475120043,t55:2.469554602):2.675043605,(t56:4.109953857,t57:4.048632609):0.9390243608):0.3010347877):0.04862407886,(t58:4.855519449,(t59:4.657464219,(t60:1.113817327,t61:0.7724889515):3.27964748):0.1877593135):0.4765328617):0.5095836427):0.03598116723,(((((t62:2.855873655,((t63:0.5853611323,t64:0.5388133823):0.9219980319,t65:1.422637732):1.3420606):0.3197485949,t66:2.928566179):0.4058114145,t68:3.093361993):0.9825701993,(t69:1.570283883,t70:1.494927597):2.456079153):0.07505770833,((((t71:1.578119404,t72:1.292144641):1.664297207,t73:2.907152944):0.5405405512,(t74:2.140280529,t75:1.702485831):1.298592219):0.1980919903,t76:3.014503615):0.04376166837):0.6121044728):0.2044687889):4.518358306):7.252237354):0.3875630324,((((t77:2.504347702,((t78:0.365230712,t79:0.1838352455):1.876977289,t80:2.011137322):0.199534888):1.787859672,(t81:0.3167542808,t82:0.3162088959):3.64767158):0.4423263172,((t83:1.332286102,t84:1.318621857):2.635660448,((t85:2.837412399,t86:2.798395772):0.4773879226,(((t87:0.5708462729,t88:0.4992520389):1.997365345,((((t89:0.3056102398,t90:0.3055944483):1.012920324,((t91:0.4886907577,t92:0.4345253409):0.1273492432,t93:0.5500789423):0.5701668123):0.9224597344,(t94:1.53402036,t95:1.425173939):0.4968539939):0.09240923274,t96:1.925484026):0.1519647575):0.3453287666,(t97:2.303443575,((t98:0.7167386839,t99:0.5190558613):0.8743745197,(t100:0.864168351,t101:0.7673785821):0.4981351434):0.567286008):0.09574793875):0.3608373318):0.5631956781):0.4100226186):1.46174733,((((t102:1.839452219,t103:1.808188256):0.1982597256,((t104:0.5531744867,t105:0.517271459):1.315395807,(t106:0.4890445764,t108:0.03003625292):1.199608172):0.06990601876):2.046148352,(((t110:0.9523853594,((t112:0.5058629489,t113:0.4199517965):0.3009500356,(t114:0.1312581145,t115:0.1104017079):0.5863763671):0.06984168694):0.2401856863,t116:0.7847672737):1.662318476,(t117:1.270203543,t118:1.184465672):0.8307391343):0.4303162502):0.1468240423,t119:2.398925681):0.4803218246):9.828319084):2.117522855,(((t120:10.25309636,((t121:1.480122941,(t122:0.1234256305,t123:0.08115797691):1.302332751):1.569994675,t124:2.811424016):7.200614212):0.8358790353,((t125:0.373173368,(t126:0.09052021124,t127:0.06903875128):0.2367205258):0.8702283245,t128:1.011532768):9.290601872):3.148181452,(((t129:10.12174844,t130:9.664789335):0.6398998664,(t132:9.256850887,((t133:1.094005451,t134:0.6741516156):1.868278012,t135:2.48253444):6.278725629):0.7839973146):1.331045161,((((t136:8.237452672,(((t137:3.858319141,(t138:0.933966475,t139:0.9160334784):2.862517928):3.607872353,((t140:0.6814873562,t141:0.594890104):3.791273194,(t142:0.4738854935,t143:0.4194578487):3.87548286):2.880503341):0.007341682815,t144:7.154786561):0.7355204492):1.060095515,((t145:7.716150616,((t146:6.473261069,(t147:5.196587104,t148:4.817026473):1.258691687):0.7808235527,t149:6.594339):0.4493787836):0.5964997024,t150:7.611418616):0.6225130697):0.781877525,((t151:4.271221639,(t152:3.27680513,(t153:1.484870512,t154:1.243428533):1.733672871):0.7049648725):2.497638687,(t155:5.259868489,t156:5.235406008):0.8404041905):2.246919614):0.3894974031,(((t157:5.819970769,(t158:2.765370329,t159:2.729380793):3.052155437):1.040283096,((((t160:5.126291751,t161:5.1106176):0.8650063825,t162:5.920315944):0.3894167448,(t163:0.1072440862,t164:0.02629112103):6.160744645):0.1690799391,t165:6.28183525):0.2338274815):1.48972178,(((t166:2.265056426,t167:2.028685408):3.592955877,((t168:3.600794184,(t169:0.9573320414,t170:0.8293758946):2.624438721):1.275419336,(t171:4.532964173,t172:4.402384634):0.054237091):0.7154209379):1.217305254,t173:6.377244312):0.8801056774):0.3596048144):0.1805505992):1.297799638):0.4330424126):0.2012373085):0.2806030712):2.077350559,(((t174:2.895885183,t175:2.619712474):2.927767077,t176:5.481364949):0.1326111813,t177:5.431398014):6.028817325):0.2744547237,((((t178:5.325643741,((((t179:1.276772981,(t180:0.9242824755,t181:0.8253798346):0.09254274683):3.456393125,(t182:1.984143416,t183:1.960034052):2.322652296):0.02695327548,(t184:3.285787077,((t185:0.1605801439,t186:0.1371514309):2.996750576,(t187:1.97385559,(t188:0.4061400695,t189:0.356112489):1.443682879):1.12972455):0.07627193967):1.013980324):0.2665483152,(t190:1.632975883,t191:1.358402082):2.633668367):0.2537658785):0.2912525958,((t192:1.29927335,t193:1.248211892):0.8786778065,t194:2.060711181):2.3158129):0.4120153294,((t195:4.008041488,(t196:0.419445141,t197:0.2813909653):3.450800456):0.4357812885,(((t198:1.259498257,t199:1.219442245):0.982833731,t200:2.167203618):1.486992279,t201:3.368435583):0.318243508):0.2419686184):0.4210685691,((t202:0.1675239516,t203:0.1232444):3.461180051,(t204:2.195924045,t205:1.967443034):1.354896895):0.6916676136):5.170871849):4.737327379):0.2025637685,((((((((t206:2.080898349,(t207:1.971961823,(t208:1.691313653,((t209:1.172939582,t210:1.167608636):0.1725086189,t211:1.296749229):0.3371251608):0.1336063469):0.08315496499):0.6766421881,(((t212:0.7571004571,t213:0.7560224307):0.5950964392,(t214:0.9128834819,t215:0.9030508794):0.3877177107):1.049968433,(t216:1.359207372,t217:1.301308503):0.9272590533):0.02348964488):0.3860379939,((t218:1.150299034,t219:1.048195577):1.011621408,(t220:1.772176564,((t221:1.060446497,(t222:0.08854012551,t223:0.05828469048):0.8710417903):0.5478853113,t224:1.411091803):0.1363140231):0.1819741288):0.3582283643):0.03081964327,(((t225:0.6387044603,t226:0.6342438503):0.6015300348,t227:1.017446007):0.408191986,t228:1.336489214):0.3849166042):0.4441690103,t229:1.935406265):0.2474433434,t230:1.771360187):2.229454453,((t231:1.643977124,((((t232:0.2619073955,t233:0.2140912764):0.0772032261,t234:0.1834744913):0.3311111389,(t235:0.495496369,(t236:0.03698476087,t237:0.01234941054):0.2847379422):0.006840382334):0.7418278486,(t238:0.8504908263,(t239:0.224711793,t240:0.202684877):0.6147913804):0.1665002771):0.1938309976):1.36577946,((t241:0.3723559038,t242:0.3115288143):0.02989919609,t243:0.2687172425):1.954734604):0.9401351955):6.551089992,((t245:7.516672015,((t246:0.7385518728,t247:0.4497379857):6.469407358,(t248:0.5261232118,(t249:0.1260312258,t250:0.08298439231):0.3900080736):5.354622325):0.2904567122):0.2859083219,((t251:0.9197935324,t252:0.8415911209):1.737250076,(t253:0.5334346005,(t254:0.3995553687,t255:0.2169167188):0.1271963302):1.97746374):3.746130329):1.181932243):1.244386446):0.7117864774):0.952804106):0.1872369316,t256:10.13921237):0.6520453725):0.3166708186,(((((t257:6.811822777,(t258:0.5758528896,t259:0.4927287745):6.147807619):2.256522766,((((t260:5.12809325,(t261:2.023630881,t262:1.927425631):3.059723883):0.6566987518,t263:5.593161056):0.06612616569,(((t264:1.504060566,t266:1.073448915):0.04584782863,t267:1.112467786):1.384682836,t268:2.474837164):2.645085232):1.298874496,(t270:1.818340707,t271:1.690720353):4.488188934):1.727627301):0.1900970583,((((t272:4.643422482,t273:4.623106896):2.457987432,(t274:5.829904639,(t275:1.20926744,t276:1.128046051):4.616565819):1.110708225):0.5509372418,(t277:0.3954867323,t278:0.3489435495):7.010353001):0.1636250212,((t279:5.159583764,t280:4.981224268):2.274264758,t281:6.775290604):0.01236979015):0.2020692611):0.642009404,(((t282:5.917211354,(t283:5.743365635,(t284:2.475703599,t285:2.472357601):3.262792644):0.03028665767):0.3255962458,t286:6.022564541):0.7003412023,((t287:4.294850924,t288:4.231942821):2.264385846,(((t289:0.6358738806,t290:0.5937064713):5.082385888,(t291:5.136020481,((t292:0.633518102,t293:0.5697313597):2.473399512,t294:2.956940774):1.910553742):0.4952573459):0.03406346075,(t295:4.912668826,t296:4.813868196):0.2449899065):0.7091112182):0.1579672933):0.6643678004):0.1173707169,(((t297:3.36769311,(t298:0.8560067658,t299:0.7008745759):2.495613392):2.019733014,t300:5.124695026):0.8326254934,(t301:2.323760737,t302:2.271292511):3.472897253):0.4494474112):1.052894239):1.183683804,(((((((t303:3.547868698,((t304:1.828435172,t305:1.755983769):1.519903689,(t306:3.109928508,t307:2.993580129):0.02202711864):0.1784879496):0.0684856319,(t308:2.538676904,((t309:1.985825508,(t310:1.733183976,(t311:0.4131848035,t312:0.344846733):1.305633922):0.17336723):0.1211169481,t313:1.876724028):0.1043308186):0.6962847138):0.9495463982,t314:3.508019296):0.4592185532,t315:3.949958944):0.7340472333,(t316:3.708939347,((t317:3.063487757,t318:3.016945015):0.2940047559,t319:3.302503559):0.08904272612):0.9084020575):1.668459167,((t320:3.923697112,((((t321:2.492037862,(t322:2.30044902,t323:2.255397558):0.1914629761):0.4409513706,t324:2.857684764):0.185071769,(t325:2.086556387,(t326:1.082797139,t327:1.076297158):0.9448134991):0.9305320701):0.5689394372,(t328:2.38490323,(t329:0.4323732972,t330:0.3648988304):1.841846138):0.8096938158):0.1754935416):0.1385861665,((t331:2.283060614,t332:2.23233109):0.2099827925,(t333:1.311911125,t334:1.268957455):1.095929636):0.7370228542):1.90490851):0.04380524616,((t335:0.3122024693,t336:0.2502428133):1.858198494,t337:2.043585106):2.836455557):0.4876457935):0.1290092239):7.072185567):0.7586949714):0.05232771666):0.9037766481):0.02594381955):0.4821203885):0.9318909563):2.062249396,(((((((t338:0.1054829061,t339:0.06429313174):1.133991768,t340:1.105396186):5.901785629,((t341:3.821696059,(t342:2.126439429,t343:2.030809833):1.674530296):1.192001661,(((t344:1.965240095,(t345:1.324285606,(t346:0.5986413941,t347:0.5862657711):0.5715377895):0.6236300479):1.9698034,((t348:0.9859485045,t349:0.9281559704):1.92848506,(t351:2.32029787,((t352:0.5470275327,t353:0.3905261408):1.248053882,(((t354:0.260601835,t355:0.1505253037):1.009239222,t356:1.070517073):0.2809697755,(t357:0.7787036476,t358:0.6926185348):0.5207452424):0.05680759857):0.4576776523):0.2152788763):0.6264705899):0.2167118608,((((t359:1.128278114,t360:1.09368066):0.05357786437,t362:0.7036110365):0.2433547198,(t363:0.5664859926,t364:0.3904905128):0.2085773968):0.8985357358,((t365:0.1834555127,t366:0.01382978386):1.179714632,(t368:0.4762650632,t369:0.3507166408):0.479999373):0.07870109927):0.4030904686):0.6249346417):1.985591759):3.344329653,((((t370:1.025522554,t371:0.9093878051):2.308082753,(t372:2.163715358,(t373:0.4246444315,t375:0.2937419973):1.663966232):1.018974676):0.09822718987,((t376:0.5827599998,t377:0.3408389344):1.717736873,((t378:0.3784878006,t379:0.3672337587):0.9493915281,t380:1.296700674):0.6071043213):0.5890146489):0.6162859996,(t381:0.02004781539,t382:0.01955884542):3.044704832):2.939490574):2.985254402,t383:8.87953096):0.4992648757,(t384:4.929589144,(((t385:1.62701199,(t386:0.8798933552,t387:0.8399683676):0.7400190601):1.173073644,t388:2.669429619):0.547497007,(t389:0.1556567607,t390:0.03896442631):2.997353292):1.312402605):4.339753798):1.100151689,((t391:8.636474459,t392:8.591014973):0.6379156293,t393:9.194600244):0.4491348745):2.697884254):8.827165468,((((((t395:8.262865378,(t396:5.769860974,t397:5.570022395):1.957842674):0.1395074406,((t398:6.479277487,(t399:3.127932973,t400:2.742513257):3.304470546):0.7280971158,(((((t401:1.863301354,t402:1.841485976):0.2769018856,t403:2.066418579):3.755297039,t404:5.649464095):0.1469504443,t405:5.792456343):0.09808749787,(t406:3.191204073,(t407:2.595715571,t408:2.377663396):0.5497958828):2.679338022):0.6210739566):0.1840043148):0.1125192934,(((t409:1.152225019,t410:0.8449945817):4.168332447,t411:4.693191599):0.4025615484,t412:5.075105702):0.5404748177):0.9257813673,t413:6.530048568):0.267300709,(t414:6.667434169,t415:6.651680968):0.08565608858):0.6509016286,(t416:6.551132089,((t417:4.281112239,(t418:0.9152024333,t419:0.5956032231):3.256856499):1.089924141,t420:4.811650709):1.160862943):0.7565175364):10.73466577):12.65327915,((t421:6.373665557,(((t422:5.232094216,(t423:4.697837455,t424:4.373962496):0.4067774385):0.4130063565,t425:4.953302939):0.6888811247,((t426:4.022934764,t427:3.767747719):0.47667677,(((((t428:1.047224519,t429:1.0268857):1.773229246,(t430:0.685561846,t431:0.4002494243):2.018061061):0.191155419,t432:2.4546269):0.382022728,(t433:2.817099781,(t434:0.3909464217,t435:0.3500668215):2.31729355):0.01311537274):0.5525589495,t436:3.210611426):0.2424113328):0.8889860481):0.02931032958):3.307860032,(((t437:3.141286605,((t438:1.78377608,t439:1.407449041):0.6657192171,t440:1.967976841):0.5519958308):0.3466936138,(((t441:0.6066853069,t442:0.6051697065):1.414530608,(t443:1.917678286,t444:1.889253536):0.07646526129):0.2338886509,t445:1.850423873):0.5916094793):0.3292978297,(t446:2.198976918,((t448:1.050007401,t449:1.025434074):0.7799604931,(t450:1.529446915,(t453:0.05554430842,t454:0.01883722984):0.7088830754):0.04749878983):0.1625684452):0.5489744313):3.788581991):20.3646916):11.72781894,((((t455:0.3152133021,(t456:0.09296104121,(t457:0.0751827888,t458:0.06358022595):0.0160670282):0.212935016):1.236308567,(t459:1.290129184,t460:1.27686304):0.1605391204):0.7066376716,((((t461:0.1085529165,t462:0.09506259025):0.498380601,(t463:0.2413978876,t464:0.2276667511):0.291331008):0.01948897728,t465:0.5141864085):0.2268280992,t466:0.6987554971):1.273227973):0.3825213617,((((t467:0.04373861623,t468:0.03579465725):0.9860980093,t469:0.9775149871):0.5054463573,(((t470:0.2708022158,t473:0.1101593539):0.3373802819,t474:0.327410411):0.3387059141,(t475:0.3104082801,t477:0.05177657476):0.229932909):0.4255892839):0.2306080105,t478:0.6858950487):0.5349490532):34.70463405):13.60918392);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T86.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
