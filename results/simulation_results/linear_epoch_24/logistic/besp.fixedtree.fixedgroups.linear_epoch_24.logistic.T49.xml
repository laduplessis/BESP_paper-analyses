<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t480:11.05777966,(t481:0.8320862872,t482:0.7719582396):10.16171625):14.12489602,(t475:0.06334837007,(((t455:0.04491672493,(t355:0.001275531354,(t345:0.02707972389,((t343:0.02373682564,((t326:0.106690964,((t251:0.1538862125,(t243:0.1126939412,(((t231:0.05388257586,((t190:0.1448539807,(t120:0.04724659827,(t117:0.1441105512,((((t98:0.0994320998,(t62:0.01707270317,t1:6.545463122):2.904188007):0.1022854828,(t2:3.590116313,((t3:1.372378023,t4:1.26073656):1.671054188,t5:2.55878341):0.4883100202):5.767027136):1.737921232,((((t6:5.249945707,t7:5.200460908):2.143990619,((t8:1.890167471,t9:1.719436263):5.102202444,t10:6.794722706):0.0629364036):0.6066371516,(t11:4.100161684,t12:4.039270058):3.311126222):1.504005605,(((t13:5.976051665,(t14:2.166127548,t15:2.145326385):3.687895814):1.440633783,t16:7.271978138):1.15222641,((((t17:5.825464063,t18:5.645750227):1.274064822,(((t19:2.212225852,((t20:0.03598227625,t21:0.03196542424):0.2765060639,t22:0.2378249088):1.463865981):1.442448581,t23:3.034792399):0.6646863858,t24:3.552246698):2.354612851):0.5355668915,t25:6.413232689):0.1350285692,t26:6.535055703):0.6480081391):0.1251896141):1.037008992):0.2282481795,(((t27:5.988555734,((t28:2.609824227,t29:2.366803536):3.151940563,(t30:3.636129281,t31:3.522856056):1.715493214):0.1916880645):2.064689171,(((((t32:4.505783921,t33:4.484437651):0.5736928394,t34:5.042999812):0.9557975231,t35:5.957833332):0.767715376,(t36:6.513894668,t37:6.285424656):0.175048681):0.1271521223,(((((t38:2.362411231,t39:2.200376244):2.572633647,(t40:3.31640217,t41:3.052546303):1.357613311):0.991914446,t42:5.372861705):0.06439511145,(((t43:0.9692843764,t44:0.8355488658):0.8943962174,t45:1.618415761):2.304998668,(t46:2.001593418,(t47:0.4945350473,t48:0.4402539202):1.449768884):1.917766175):1.006676):0.3503823568,(t49:3.26738056,t50:3.264585834):1.728643597):0.1016490998):0.5037032624):0.2007285004,(t51:4.929152302,t52:4.85669956):0.8504228174):0.1938337212):0.1940444171):0.1349389358):5.984737776):0.05810860859,((((t53:2.989519496,t54:2.786878032):1.313516262,((t55:1.470769625,t56:1.321952482):1.833573774,t57:2.854324929):0.678539762):2.880083323,((t58:5.332982656,(((t59:1.343889695,t60:1.334240062):0.3447417173,t61:1.672158771):1.59807518,t63:3.198375336):2.034738021):0.3105253434,(((t64:0.9676960694,t65:0.7690479705):1.780266583,(t66:1.520959998,t67:1.445148013):1.021688462):2.42421408,((t68:1.992024574,t69:1.909037564):0.4055026522,t70:2.183100889):2.393208494):0.3633888364):0.7514751839):3.219842282,(((t71:1.904252235,t72:1.82285079):2.561049895,(((t73:1.979061264,(t74:0.957658616,t75:0.7930234904):0.8236447293):0.3883394045,(t76:1.781169673,(t77:0.6751481415,t78:0.606254931):1.076371582):0.1598476633):0.7865986532,t79:2.585127972):1.039604288):0.1146894157,(((((t80:0.1446297321,t81:0.09275296224):0.2028462934,t82:0.2462716437):1.125005072,(t83:0.774347984,t84:0.7595818408):0.5967382611):0.8243925062,((t85:1.143735261,t86:1.093172198):0.4664854312,t87:1.434777919):0.5618567829):1.11157647,((t88:2.141658261,t89:1.926558033):0.6643929056,(t90:1.315022968,(t91:0.9636615792,t92:0.9255354137):0.3385495627):1.258603341):0.2946384783):0.2942453248):4.228561471):1.792161428):4.004160685):0.8620046729,(((((t93:1.033431622,(t94:0.3164262864,t95:0.2837655567):0.7165684363):4.230311944,((((t96:1.735048303,t97:1.583474529):0.5603911523,(((((t99:0.6024023759,t100:0.4416470419):0.1359361554,t101:0.5371240665):0.07336681066,t102:0.5893866755):0.07425633733,t103:0.3807229191):0.2835910606,(t104:0.08490963742,t105:0.07083685925):0.5625712534):0.2099889728):0.7138187985,t106:1.483282646):0.5939183949,((t107:0.4948476509,t108:0.3944919214):1.228119566,(t109:0.3063337102,t110:0.1394297134):1.248135373):0.3531564045):1.607486633):6.787004496,((t111:2.008884623,(t112:1.57293861,(t113:0.812876644,(t114:0.6708744959,t115:0.6605143765):0.05709421821):0.3521295988):0.3514773882):7.946803847,(((((t116:0.3008050074,t118:0.01298220488):0.9192187821,t119:0.9230521457):3.988556548,((t121:0.5180402375,t122:0.4644407676):3.124659309,(t123:1.425295348,(t124:1.03939925,t125:0.963429065):0.2813072103):2.090296197):1.078989382):0.6119548107,(t126:4.790637558,(t127:2.392073547,(t128:1.366946057,t129:1.1831201):0.936330194):2.393980643):0.1929979123):2.641678986,((((t130:0.4507164366,t131:0.22426212):3.527385875,t132:3.707780652):0.7011190602,((t133:0.03356135261,t134:0.006152842627):0.1655433242,t135:0.0365821755):4.129084069):1.47638019,t136:5.547133685):1.070696258):0.8874740238):0.1040317134):1.183368754,t137:8.771694187):0.1412387987,t138:8.85078625):0.5151074252):0.3892718555,(((((t139:0.1153270632,t140:0.04656978763):7.70476604,t141:7.725748569):0.8288991897,(t142:0.08955743704,t143:0.0555836035):8.456207295):0.09518343868,(t144:2.887243705,(t145:0.7525587865,t146:0.7299807268):1.867787422):5.236559411):0.6688709394,((t147:3.940739481,(t148:2.610250737,t149:2.425086592):1.330217356):0.5099585597,((t150:3.646374757,t151:3.640175542):0.3909434857,(t152:2.699571933,t153:2.526338597):1.299118901):0.06755672312):4.006659547):0.1950689748):0.01132284596):0.9955732623):6.998409677,((((t154:8.192145812,((t155:1.253846362,t156:1.245054223):4.130406633,t157:5.335367106):2.694989763):1.240151197,(((t158:7.008371244,t159:6.949331098):0.8014785557,((t160:6.018144352,(t161:5.856099546,(t162:2.271242327,t163:2.193946781):3.501028091):0.1330355727):0.7402283213,(t164:6.513891821,(((t165:6.159936348,((t166:4.270522627,t167:4.2547739):1.459851013,(((t168:0.5060358378,t169:0.3212472647):3.300275076,(t170:3.226966504,t171:3.074893163):0.3511164636):0.06822624621,t172:3.459148128):1.691664307):0.3893984645):0.1031530583,((((t173:0.125054866,t174:0.0347266201):0.9947479442,t175:0.9297703601):2.699854013,t176:3.611166284):1.420863508,(((t177:1.233798115,t178:1.164918331):1.244677389,t179:2.372807015):2.43402366,((t180:1.711195877,t181:1.707601281):1.25710493,(t182:2.87623336,t183:2.794332031):0.005974919846):1.694255763):0.05779292115):0.3773921518):0.02114035393,(t184:4.728664327,(t185:4.597325685,t186:4.521889979):0.05397716216):0.125989958):0.1858975975):0.05317266718):0.9412289305):1.302715561,((((t187:0.2537828087,t188:0.08346789091):3.713782763,t189:3.792511898):0.6073671619,(t191:4.01304931,t192:3.863678185):0.1222453235):2.036064141,((t193:3.127353955,(t194:2.674466881,t195:2.657385089):0.2209808788):0.6215875926,((t196:2.278925159,(t197:0.7091822515,t198:0.6844575743):1.386053527):0.1955324772,t199:2.263435828):0.9566428411):2.261423727):0.5153846135):0.1409177096):0.4324949836,(t200:3.678386804,(t201:3.11368189,t202:2.954115661):0.4210927315):2.517960935):0.362434691,((t203:3.410960492,(((t204:2.492877748,t205:2.397489558):0.6945986524,(t206:0.2383603589,t207:0.1203777734):2.793019152):0.02219654278,(t208:2.325746176,(t209:1.277645287,t210:1.018232398):1.001332712):0.4565424087):0.1772740467):0.04693951239,(t211:1.263538217,t212:1.213431395):1.407714328):2.6848132):5.629126064):1.043364631):1.02528049,((t213:3.670425153,(((t214:0.8164113374,t215:0.8083027807):0.07540272313,t216:0.7813625378):2.287507938,((t217:2.357078925,((t218:1.117274639,(t219:0.6424928197,t220:0.6321500233):0.4707199944):0.5302101317,t221:1.619588151):0.6987950728):0.1539711843,((t222:1.691033603,t223:1.601160819):0.3033353409,(t224:1.677738377,(t225:0.6512690627,t226:0.2587133756):0.3864195906):0.1025916339):0.4358685429):0.5351246348):0.4112306063):6.088460062,(((t227:0.5528960432,(t228:0.2771064218,t229:0.2631246059):0.2367468947):1.291455739,((t230:0.135650377,t232:0.00757100357):0.1599758547,t233:0.159470508):1.490877355):0.5707586048,t234:2.208485211):5.800113102):3.227075535):1.083671181):0.06897188738,(((((((t235:0.5161603876,t236:0.5115788044):5.341381036,(((t237:0.1478607446,t238:0.08221826248):0.644027954,t239:0.2948278074):0.2100111097,(t240:0.1892043299,t241:0.08161722249):0.3091577285):4.698895107):2.655067193,((t242:1.40901927,(t244:0.4042960005,t245:0.2791452547):0.746107563):0.7599325888,t246:1.494032146):5.464745662):0.3831736764,(t247:1.648630488,t248:1.539472919):5.669907052):2.835094817,(t249:1.240120104,(t250:0.663804683,t252:0.3264485487):0.5164897335):8.789966735):0.07738364187,(((t253:2.709625731,t254:2.700056414):3.494807088,((t255:0.8052609764,t256:0.7540087352):3.365325379,(((t257:0.1599636684,t258:0.05230337201):0.4151089621,t259:0.3885755764):2.57699986,t260:2.946385795):0.9633032222):1.336334449):0.4070686752,t261:5.537071181):2.92674076):0.181682984,(t262:7.842853748,t263:7.792420695):0.7782128009):0.2254215865):0.08775280788):0.7309068616):9.361560733):0.9071675523,(((((((t264:0.1417447059,t265:0.1051891949):0.066221033,t266:0.1249989493):3.164760769,t267:3.270581875):1.31117953,t268:4.359454557):6.021451627,((((t269:5.650168373,(((t270:0.9470421388,t271:0.9446964814):3.389493887,t272:4.085298193):1.182109566,(t273:2.404778516,t274:2.388013172):2.817866062):0.0901065792):2.086334393,t275:7.27331602):0.6483277938,t276:7.905497233):1.13179163,t277:8.943743431):0.1759225001):8.83977857,((((t278:2.408014385,t279:2.257091049):5.474590986,(t280:5.483160127,t281:5.430603382):1.975070584):1.044896788,(((((((((t282:3.565600076,t283:3.195757185):2.211109772,t284:5.400045052):0.03806897442,t285:5.416786346):0.2546104403,t286:5.62341787):0.1100303843,t287:5.558941525):0.007316319427,(t288:4.148692501,(t289:3.872289118,t290:3.479097446):0.217872368):1.412509888):0.1863211395,t291:5.218355701):0.6519865532,((t292:3.79929944,t293:3.717318737):1.469067756,((t294:3.694959935,t295:3.676251914):0.06398374794,(t296:3.232953634,t297:3.230193344):0.4616764331):1.32419497):0.5159541047):0.8260822068,((((t298:0.3779937662,t299:0.3660700042):3.808761805,t300:4.09233521):0.3736667565,((t301:1.052921895,t302:0.7292950086):0.5755244766,t303:1.281594641):2.819404479):1.458867794,((t304:3.266455892,t305:3.253277676):1.16213985,t306:4.351512803):1.051093392):0.2676149273):0.5539178152):0.3421760775,((((t307:3.768239025,((t308:3.156981815,t309:3.115554415):0.4794184805,t310:3.494338616):0.03336785524):0.1414207839,(t311:2.927302899,t312:2.913288416):0.629658107):1.23407536,(((t313:0.9252829454,t314:0.7524018088):3.056582269,((t315:0.4337354591,t316:0.3455345691):2.80114691,(t317:3.094338905,((t318:0.5036723706,t319:0.4884962886):2.347404079,t320:2.335965676):0.1616400725):0.04964191734):0.5316348665):0.02923921297,(t321:2.677421292,(t322:1.703365739,(t323:0.3334289505,t324:0.1592858624):1.255014593):0.8833945186):0.3604458003):0.7293223807):0.7135512023,((t325:1.630939202,t327:1.434652184):0.6975508582,(t328:1.045874347,t329:0.9896761652):1.051426616):1.731478497):0.519321615):8.548536351):0.082575374,(((((((t330:2.754968964,(((t331:0.4520822447,((t332:0.1122189316,t333:0.04345642525):0.1841123728,t334:0.2149430861):0.07361612061):1.010681252,t335:1.291340328):0.8404670981,(((t336:1.404323423,t337:0.5682061382):0.06010366882,t338:0.6052060884):0.1025859232,t339:0.6838921286):0.2482843056):0.3506118375):0.06435448184,(t340:0.4669738031,t341:0.4075054956):0.6034919654):0.4403444792,t342:1.416923135):0.8581334111,(t344:0.7126343379,(t346:0.3752588658,t347:0.3534294548):0.265735382):1.306641657):0.2213092647,((((t348:0.0297082439,t349:0.01200484996):0.160635321,t350:0.1204070729):0.05680534153,(t351:0.1262186987,t352:0.01570139939):0.00292153411):0.5338889469,t353:0.4970786191):1.120442092):5.354415065,(t354:4.890001264,t356:4.623699547):2.056202488):0.8182415035,t357:7.488414389):2.409466683):0.2265089011):0.9694420378,(((((t358:0.7688249941,t359:0.6801985372):1.540774308,(((((t360:0.5978129921,t361:0.3024661253):0.1907837628,t362:0.463648663):0.2612436144,t363:0.6424449776):0.6111667016,t364:1.118845318):0.1735441497,(t365:1.117557195,t366:0.9571508728):0.1554947378):0.311839337):6.381960098,((t367:0.7627785368,(t368:0.4993371442,t369:0.4553150852):0.2138979057):0.8102176764,t370:1.463506422):6.201204165):0.3742346468,t371:7.530980933):0.8351277023,((t372:2.394842151,(t373:0.3342539298,t374:0.282128257):2.01904218):4.966597513,t375:7.153205667):0.9787716936):1.086245097):0.5416046251):25.76457457):70.84111636,(((((t376:5.475426508,t377:5.469220891):3.259211167,((t378:0.3419543642,t379:0.3028572656):3.50501509,(t380:1.54239783,(t381:0.1864604508,t382:0.09210024453):1.259538646):2.141180394):4.834303413):2.281528545,(((t383:2.483464897,t384:2.214610817):7.229917665,((((((t385:1.66551062,(t386:0.3295186399,t387:0.08759528535):1.181420262):5.575445448,t388:6.789836326):0.5242413874,(t389:5.578463023,t390:5.381098699):1.731339449):0.8968751509,(((t391:3.810130794,t392:3.7992715):3.278604548,(((t393:1.984953536,t394:1.914074931):1.230631449,t395:3.042719385):2.781862451,(t396:1.689904131,(t397:0.3121201403,t398:0.1817926715):1.33581835):4.081810007):0.92516116):0.2919601372,(t399:2.930403256,t400:2.888309591):3.772929784):0.5805300645):0.1792952296,(((((((t401:1.034273013,t402:1.025054971):3.960253734,t403:4.971186735):0.3770864848,t404:5.312479074):0.007422533431,t405:5.189196391):1.002483277,t406:6.183810718):0.1430953586,t407:6.220055113):0.7077432568,(t408:3.145308108,t409:2.922671429):3.740846529):0.1727901116):0.1216782471,((((t410:4.567018275,(t411:2.010175913,t412:1.926336172):2.501641819):0.5087595103,(t413:3.601987439,(t414:2.566558358,(t415:1.41029555,t416:1.392691781):1.033989228):0.9382853693):1.315559718):0.8636094855,(t417:5.273667171,(t418:4.834201496,((t419:3.682685518,t420:3.489971761):0.5634171259,(t421:3.499086037,t422:3.384133258):0.5341368783):0.4852267841):0.3343172712):0.07880772266):0.6072617176,(t423:5.23611995,t424:5.223626531):0.07515874425):0.4079004792):0.4382546999):0.2675934138,((((t425:3.863707009,(t426:2.960277064,t427:2.850777181):0.7173987655):1.260417148,(((t428:2.756528503,t429:2.699417484):0.101409222,t430:2.750774239):0.6394741222,t431:3.331006456):1.301000781):0.06584154303,(t432:4.305083984,((t433:1.59625134,t434:1.464739307):1.999413343,(t435:0.3486395777,t436:0.2585478435):2.886801987):0.4251439297):0.392188366):0.5731555732,(((t437:1.541932566,t438:1.49137393):1.10549275,(t439:0.2830700309,t440:0.1197644088):2.194882286):0.5428230671,t441:2.827298576):1.191800146):0.4003725317):0.4598049932):12.39767304,(t442:6.086241617,((((t443:3.265512322,(((t444:0.3521801188,t445:0.3315575804):0.868233048,t446:1.102778747):0.1218650365,t447:1.123982577):1.870538616):0.8048427132,t448:3.79649127):1.169730056,(((t449:1.082850081,t450:0.9309619692):1.712308214,((t451:0.9181882023,t452:0.860445947):0.7976602492,t453:1.639836251):0.9039007654):0.6330609072,((t454:1.267051309,(t456:0.9528562065,(t457:0.7224040549,t458:0.5156821759):0.1960503013):0.04022384718):0.1946907238,t459:0.8255887285):1.469275932):1.44457175):0.3532451717,(((t460:0.497733109,(t461:0.1812665348,t462:0.08998523396):0.01258681114):0.4661588106,t463:0.4971202625):0.7500843491,t464:0.6862973627):2.344814769):0.4470023513):11.18475682):19.53432661,((((t465:0.9671895583,(t466:0.6624531471,t467:0.4428375493):0.263061558):0.3450621649,t468:0.9383112638):3.138852713,((t469:1.34515647,(t470:0.81042491,(t471:0.2700055249,t472:0.2472727776):0.3592294205):0.5147438001):0.09608732941,(t473:0.9495074156,(t474:0.6650943198,(t476:0.2860037457,t477:0.21840641):0.1468116888):0.2625346833):0.1786520899):2.63033918):1.353858692,(t478:0.8320993716,t479:0.6189962807):3.875736038):28.35451669):63.36410759);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T49.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
