<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t471:0.5559501595,t472:0.551914173):13.89485607,(((t473:1.292156283,t474:1.195040126):9.499754917,((t475:0.2256723113,t476:0.1886020649):0.4660812045,((((((t336:0.8268414983,(t338:0.3040223664,t339:0.2477743693):0.1180638548):0.03111986741,(t340:0.3927272365,(t337:0.2327602283,((t334:0.1813659919,(t330:0.04569872605,(t318:0.04972477669,(t316:0.08434664492,(t224:0.2817648486,((t218:0.03498058591,t219:0.03012431657):0.1591879507,((t215:0.1818175375,t216:0.0139290857):0.1507594633,(((t203:0.516127494,t204:0.4997375401):0.1036502321,t205:0.2262183033):0.1205856655,(t119:0.00421263448,(t115:0.2688917585,((((((t24:0.05122283635,(t1:1.342645337,t2:1.292151903):0.5093976816):3.329274708,((t3:0.7656542692,t4:0.7582647503):1.003694571,t5:1.713425784):3.131573019):4.494475879,((((((t6:0.09239210286,t7:0.08371921214):1.564394658,(t8:0.4367562303,t9:0.4095409832):1.203819563):0.5979560035,(t10:0.2271179456,t11:0.1141201133):1.786968204):0.469834287,t12:2.344242619):0.4225211377,((t13:0.1423842125,t14:0.06541965902):2.480832299,(t15:0.5170691667,t16:0.4556846416):1.767806471):0.07748923554):5.958463202,(((t17:2.10438117,t18:2.086985586):2.622154194,t19:4.624000403):2.627967224,t20:7.245840268):0.7943984019):0.1732733128):0.6404269042,(t21:5.148669475,(t22:1.52231275,t23:1.41857381):3.502178567):3.642445007):0.28179936,((t25:5.813483924,((t26:0.1894349315,t27:0.08559255986):4.683467983,t28:4.173571937):0.6488697301):0.9113008036,t29:5.672571327):1.980500381):0.588386888,(((t30:3.36130136,t31:3.283126907):3.54736536,t32:6.658796142):0.2470624003,(t33:3.504556767,t34:3.397366591):3.322381152):1.035764887):0.3771333401):0.3503272227):9.680290244):0.8789036218):0.3404697577):0.9238224815):9.196852722):0.1154209776):1.343687754):0.4415435279):0.4260093277,(((((((((t35:6.100283054,t36:5.889827641):1.267780484,((((t37:2.552458451,t38:2.506033162):0.6904426736,t39:2.949538895):1.816247967,t40:4.712155228):1.624831553,((t41:4.061416816,t42:4.039828944):1.522318311,t43:5.4833914):0.6580981695):0.4560478977):1.508735245,(((((t44:5.963649002,(t45:4.729322771,t46:4.517399585):1.207303874):0.2391077292,(t47:4.441344079,((t48:3.67801404,(t49:0.7435314744,t50:0.7312568561):2.759867056):0.5431100914,t51:3.874951699):0.1024698863):1.276487185):0.1004054738,(t52:4.720777214,t53:4.639110243):0.4998470737):0.2021137096,t54:5.195002991):0.9369178214,(t55:1.248285255,t56:1.068812876):4.877595694):0.525166892):9.734682937,(((t57:1.037344425,t58:0.9762935312):3.58076898,(t59:3.591876985,t60:3.421147185):0.9402313754):0.5714342271,(t61:4.467280099,((t62:2.751739013,(t63:0.9301268276,t64:0.9070402737):1.793584805):0.5901330973,((t65:2.397581141,t66:2.239261828):0.1486058026,((t67:0.2013200506,t68:0.1936161042):2.07088448,t69:2.224205372):0.05748736938):0.4972159236):0.9289751155):0.4501068896):11.01654894):0.5351282517,((t70:4.225562661,(((t71:3.338329447,t72:3.271006539):0.2014546526,(t73:1.726498393,t74:1.41978688):1.685787947):0.4826808735,(t75:2.487473644,t76:2.48235628):1.061201926):0.08082621996):11.12583166,(((((t77:1.50769855,(t78:0.6293547965,t79:0.5301390539):0.735747813):1.360226693,((t80:0.5052523449,t81:0.3682383168):0.6211052713,t82:0.7962870265):1.461186177):3.423524938,((((t83:0.4371421504,t84:0.4367683287):1.967470549,t85:2.385641953):0.6956167753,(t86:2.244607819,(t87:1.447919027,t88:1.42419738):0.7655430442):0.7708814088):0.5189605115,((t89:1.100290644,(t90:0.648502362,(t91:0.3626860259,t92:0.3460461008):0.2674302501):0.4504667129):1.888018128,((t93:1.620779443,t94:1.535666875):0.7850614161,(t95:0.9345290403,t96:0.8555827386):1.326671052):0.5073968674):0.4695100776):1.938256536):0.1403265213,((((t97:0.3572588784,t98:0.2948270033):0.7336388415,t99:0.8802591992):0.343238622,((t100:0.1932451722,t101:0.005113277796):0.1114477079,t102:0.09166033926):0.8935980735):2.894664529,((((t103:0.8123599662,t104:0.7087958556):0.8423174773,((t105:0.9515630236,t106:0.9235417449):0.1415541223,t107:0.7062047414):0.1030287856):0.4100641531,(t108:0.8282603024,(t109:0.5171044,t110:0.5063043504):0.2929196285):0.3714824428):0.8744285026,t111:2.009680845):0.9270478338):0.8689330739):1.812330722,(t112:2.05728977,((t113:0.414678983,t114:0.1857240904):0.7687903728,t116:0.04198882613):0.8625641213):3.534426296):6.298271338):0.2915686127):0.1197056292,(((t117:0.2073895214,t118:0.0661960165):9.655300085,(t120:2.282360219,(((t121:0.4893329838,t122:0.1906595357):0.5867003504,(t123:0.09803845581,t124:0.06129079486):0.6284700289):0.150212047,(t125:0.03856996704,t126:0.02658276703):0.7743746792):1.011418059):7.359241064):0.9662505138,((t127:4.468860199,(t128:0.7974678121,t129:0.617742804):3.613524844):2.404995946,t130:6.51223784):2.856375717):0.1655290342):2.186880767,((((t131:0.3678367652,t132:0.14773314):9.276693303,(t133:7.590437445,((t134:3.100265896,t135:2.80041307):4.043662778,(t136:5.147799851,((t137:1.875123612,t138:1.757197329):0.5712143355,(t139:1.243432278,t140:1.095520405):0.9980222444):2.665323161):1.179995946):0.3439782898):1.820032244):0.9198926806,(t141:8.740862947,((t142:5.698446041,t143:5.680920375):1.414110954,t144:7.07295592):1.565964758):0.2411736171):0.263030651,(((t145:7.433359412,(((t146:0.5950019839,t147:0.489088193):5.248303811,((t148:2.438335452,t149:2.347609619):2.638931195,t150:4.943164955):0.6376363019):0.2796778818,t151:5.787490834):1.302573674):0.7867698594,(t152:6.600413689,t153:6.542200044):1.227481572):0.1848473183,t154:7.9521557):0.5614301863):0.8396623448):0.2243362184,((t155:2.058820972,t156:1.865710697):4.940209658,((t157:2.932044879,t158:2.902470641):3.445970492,t159:6.345485285):0.4105133223):2.536228663):9.426639144,(((((t160:5.726155917,((t161:2.951358701,t162:2.866243231):0.08156554419,t163:2.826003162):2.468182796):0.4894119389,((((t164:4.887008704,(t165:4.383787987,(t166:2.086733294,t167:2.005609411):1.991184057):0.4749767883):0.24547173,(t168:0.7892718851,t169:0.7824751912):3.770731868):0.3843804923,(t170:3.993469898,t171:3.742989494):0.4445913416):0.01757991536,((t172:3.886379577,(t173:2.608085388,t174:2.449812536):1.12597434):0.07784930114,((t175:0.7701555231,t176:0.6804765892):2.784193592,t177:3.259171206):0.04672591133):0.1635976042):0.2486670943):0.4667508525,(t178:3.752097486,(((t179:2.765111288,t180:2.63356874):0.2586551564,t181:2.87808677):0.2938077161,t182:3.101284567):0.4323431995):0.3736890653):0.338995654,((t183:2.394238688,(t184:0.1222504773,t185:0.106272554):1.852209676):0.8965931476,(t186:2.147206201,t187:2.052999773):0.5197438494):0.7898398477):9.853134465,(((((t188:2.984668345,(((t189:2.497645339,t190:2.171358981):0.09103142207,t191:2.260731581):0.0072884174,t192:2.197451866):0.2771815593):0.001313312727,t193:2.47581809):1.48601409,(((t194:1.026816661,t195:1.019642029):1.869390667,(t196:2.501250611,t197:2.484696002):0.1529414773):0.1402054948,(t198:1.388288824,t199:1.236720365):1.238888419):0.9107109394):4.071298925,(((((t200:1.089484286,t201:1.053617693):2.378912289,((t202:1.164745654,t206:0.3770765989):1.296823315,(t207:1.335842539,(t208:0.9824604111,(t209:0.366790559,(t210:0.1835749489,(t211:0.1182779286,t212:0.1119599121):0.06133963654):0.01930371285):0.5187465799):0.2063201911):0.2963590406):0.9699166082):0.01171894204,t213:2.191987553):3.163923654,(t214:1.005310011,t217:0.5225948668):4.323109126):0.315575485,(((t220:1.097989738,(t221:0.7664711369,t222:0.6870282437):0.0481125442):1.422240484,t223:2.146620154):1.469944281,((t225:0.1113860381,t226:0.02665972221):1.659800434,((t227:0.634039501,t228:0.6329518578):0.4810175358,t229:0.668963906):0.3120800267):1.262320386):0.8462827491):0.3892095232):1.829358959,t230:4.922163447):2.814484466):1.810337194):0.6610630163):0.02637765791):0.5957154596):0.002401061399):2.871115194,((((((t231:4.278524564,t232:4.19107489):3.895083028,(t233:2.741533185,t234:2.515797731):5.250583413):0.6187207486,((t235:0.6232277768,t236:0.5044309747):0.8283172722,t237:1.320611144):6.826679945):0.3554438785,((((t238:1.376974748,t239:1.357899326):0.2104153266,t240:1.564173693):0.8566793778,t241:2.417806752):5.882944383,(((t242:7.11317768,(t243:1.899390036,((t244:0.3241817133,t245:0.3172097678):0.874285481,(t246:0.6964841249,t247:0.6747875877):0.4941176535):0.6982966746):5.168960915):0.5943487906,t248:7.541323365):0.368470434,(t249:7.183476741,(t250:5.896852476,(t251:2.249469105,(t252:0.5307252941,t253:0.529804943):1.411240543):3.575737509):1.254551596):0.4070084975):0.1832857573):0.1675763228):0.05029465502,(t254:6.840998496,t255:6.763688217):0.6105244144):0.7202271315,((t256:4.21827086,t257:4.159043179):1.821426214,t258:5.969337598):2.035302196):3.679691074):7.268197314,((((t259:0.6173088383,t260:0.5900860215):1.536965249,t261:2.05077237):4.554071997,t262:6.555284856):2.816884976,((((t263:5.933230485,(t264:4.565335817,t265:4.55791397):1.096262356):1.056606978,(t266:3.329641677,(t267:2.474068254,t268:2.454247427):0.8470118579):3.340304605):0.06978748512,t269:6.593381097):0.6162224788,t270:7.180837199):1.630175461):9.280919838):0.1089321647,((((t271:8.39682565,((((t272:6.499863717,((((t273:3.622308356,((t274:0.3665457377,t275:0.3611895414):1.811223026,t276:2.152732319):0.9664040785):2.271142617,t277:5.372528228):0.08916939222,t278:5.404336428):0.1775422107,(t279:4.621872383,((t280:3.176728766,(t281:2.295610859,t282:1.98623281):0.4516018976):0.2053209601,t283:2.571160794):0.981830558):0.8938199505):0.3225519429):0.4255562172,(t284:3.190282872,t285:3.141902237):1.947921569):0.1002100012,(t286:4.81760091,(t287:0.2207992293,t288:0.199940879):4.593197503):0.1543491978):0.1927721243,(((t289:0.1635978159,t290:0.1410394574):4.13894354,t291:4.251596068):0.7258339621,((((t292:0.3047901975,t293:0.2808396636):1.575442515,t294:1.750768296):1.618547639,(t295:1.526535449,(t296:0.3864002901,t297:0.3298625102):1.120533198):1.694384628):0.5842172796,((t298:2.272059083,t299:2.214249883):0.3064744486,(t300:0.9975982232,t301:0.925031984):1.467375516):1.096301904):0.7062001119):0.03252804756):1.098776422):0.6187550188,((((t302:1.168086315,(t303:0.559623276,t304:0.1737633949):0.5589877943):3.789624727,(((t305:0.6614710176,t306:0.4076105822):2.32481634,(t307:0.1741992938,t308:0.1506755869):2.525878441):0.4915901283,(t309:2.901875741,(t310:2.492412423,(t311:2.09377301,t312:2.064702909):0.321229376):0.3723863645):0.1983605241):0.8035617498):0.312559969,((((t313:1.108344158,t314:1.087113743):0.6212933408,t315:1.584736545):1.189510849,((t317:1.36482986,t319:1.249730875):0.3867943237,t320:1.606621068):0.5193698489):0.8607348318,t321:2.964610585):0.2805110582):0.03260604649,((t322:2.475959769,((t323:1.76163895,(t324:0.3659830781,(t325:0.3560373216,t326:0.3108840605):0.003754067431):1.116806541):0.5424166098,t327:1.595685424):0.1436546559):0.5652129686,t328:2.069840269):0.03709122125):0.5811302474):0.3715391122,(((t329:0.4938638948,t331:0.4096239905):1.25894146,(t332:1.493152131,(t333:0.376986753,t335:0.05647399767):0.8864799661):0.1631599201):1.128167507,(t341:0.932280083,t342:0.7149983895):0.3814475959):0.1575342602):8.615381177,((((t343:0.4296828652,t344:0.3903999956):3.521178231,((t345:1.379425162,t346:1.269628457):0.7730424001,(t347:1.001336616,t348:0.8659974223):0.795124195):1.404733159):3.361826882,t349:6.271186151):0.7855598204,((t350:2.425310569,t351:2.401987347):1.402136507,t352:3.787344019):3.129235045):1.696306878):0.1592698902):0.5569440705,((t353:0.3610286783,t354:0.336340488):6.634912694,t355:6.90240852):2.033964626):1.646309851):9.710569563):2.034870823,(t356:9.492852354,((((t357:1.283442639,t358:1.28041681):5.974295737,t359:7.229671503):0.3052491248,(t360:6.577562412,t361:6.568721097):0.9539171712):0.760067232,(t362:2.293123795,(t363:1.802115283,(t364:0.2832673313,t365:0.1244053389):1.377372727):0.2192483264):5.964660153):1.112484947):12.78655363):1.582014031):8.952770996,((((t366:8.106368902,((((t367:4.230533343,(t368:0.4092233378,t369:0.1641040152):3.778885573):0.3515772387,t370:4.294201425):0.4843068204,t371:4.599032093):2.7831195,t372:7.20200848):0.1790584849):1.044447059,(((((((t373:0.7154652683,t374:0.5801563432):0.4878582369,t375:1.061984495):0.7227805499,t376:1.719942585):4.644539709,t377:6.361284091):0.4544216876,t378:6.704290663):0.6644016878,(t379:4.111531401,t380:4.078512599):3.231292923):0.213602112,(((t381:3.68104885,t382:3.600074925):1.529185355,(t383:2.946486546,t384:2.906476082):2.138486355):1.547013674,t385:6.570469064):0.7294480944):0.4424672544):1.746149054,(((t386:2.838720816,t387:2.833470607):4.459561713,((((t388:0.6863151913,t389:0.5107214789):5.764292925,(((t390:5.421799511,t391:5.342287733):0.4299914197,(t392:5.54954564,((t393:3.591176923,(t394:1.86303001,t395:1.805175081):1.59969636):1.351016397,t396:4.688884083):0.5612193754):0.1657564565):0.1006615477,(t397:5.433601546,t398:5.223442595):0.07857728614):0.3062525933):0.07871643412,((((t399:2.322321167,(t400:0.4668874154,t401:0.3476543226):1.746614218):0.8861778776,((t402:1.319511777,t403:1.301427848):0.9798123696,t404:2.114267356):0.6009493374):1.769221139,(t405:3.199711956,(t406:2.267142373,((t407:1.053534498,t408:0.9994047712):0.6082775384,(t409:0.1040118957,t410:0.015307346):1.423795485):0.3888197227):0.9174097497):1.216026487):0.03805890467,t411:3.920343199):0.5952197256):0.7073425966,(t412:0.6646788623,t413:0.6431700284):4.51929425):0.04638869426):1.811661271,((t414:1.66593281,(t415:1.066739131,t416:0.9787836636):0.5820405014):3.731435652,((((t417:1.561059129,t418:1.385772062):0.2467417331,(t419:0.6158432468,(t420:0.23309695,t421:0.07572867745):0.1480907433):1.016639193):0.6148901794,(t422:1.43415215,t423:1.311963272):0.3898659091):2.654142701,(((t424:3.186232869,((t425:1.377719373,t426:1.346284078):1.039826871,(t427:2.070616315,(t428:1.004248344,t429:0.8725968985):1.011927074):0.2921411215):0.7443007355):0.07131187019,(t430:2.400635953,(t431:1.780048654,t432:1.75339304):0.5111118468):0.579180753):0.5356165911,(((((t433:1.129161724,t434:1.099510391):0.6025747687,(t435:1.175794994,(t436:0.01901157073,t437:0.01359072759):1.101864136):0.4999301086):0.2822496517,(t438:1.038407493,(t439:0.6780619921,t440:0.6628447209):0.2800955283):0.8132714474):0.9049190794,t441:2.603879882):0.1340883179,t442:2.732037857):0.2520390274):0.5576440623):0.04801229859):1.38757715):0.197806177):9.646589616,((((t443:2.882574971,t444:2.820482434):0.1616463702,((t445:0.9185597286,t446:0.7330034705):1.82257258,t447:2.503293832):0.06003604935):1.406208084,(((t448:0.7393472334,t449:0.710501681):0.7211593896,t450:1.313318202):1.475396474,((((t451:1.249734782,t452:1.22256467):0.8081817408,(t453:1.230661451,t454:0.9377830732):0.6555894497):0.03842405859,t455:1.518907998):0.4009617992,t456:1.880203842):0.2550751325):0.5731772681):0.843991571,((t457:0.2784138391,t458:0.2533795092):2.138058735,(t459:0.4935199632,t460:0.4502714392):1.861624115):1.131441558):9.514759901):11.54156314):12.21109292,((((t461:0.09439885331,t462:0.09409997653):0.8287230111,(t463:0.08903774734,t464:0.03589159272):0.6051410113):0.5534463139,(t465:0.204822482,t466:0.1130460169):0.7816036704):25.05589074,((t467:0.7186399215,t468:0.5722945426):1.649955833,(t469:0.9408245655,t470:0.822848015):1.274121238):23.56979473):10.00276781);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T89.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
