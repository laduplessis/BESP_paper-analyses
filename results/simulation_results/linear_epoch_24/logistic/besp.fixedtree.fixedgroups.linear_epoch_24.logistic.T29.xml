<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t465:0.058445819,(t456:0.0479715229,(t452:0.1003511144,((t450:0.1358696725,(t430:0.04374124986,(t377:0.05876779994,((((t363:0.1621749184,(t354:0.05654471702,((((t292:0.000591657619,((t254:0.04159797145,((t245:0.004563580665,((t227:0.01188487343,(t217:0.1184495701,((((t127:0.4901571057,t128:0.4883258144):0.3514368936,t130:0.3848622514):0.2490736487,(t131:0.1203341481,((t129:0.263896067,((((t1:2.619549176,t2:2.509785606):7.163078731,((t3:0.7367298184,t4:0.3091736986):8.417134541,t5:8.694035975):0.4216952394):1.024247423,((t6:6.551181447,t7:6.440118633):2.532019358,((t8:0.7059759026,t9:0.587014486):8.075895647,(((t10:0.7925770329,(t11:0.6081087003,t12:0.5031313692):0.1388493942):4.795633647,(t13:2.476237164,t14:2.416304652):2.808815705):2.166822772,t15:7.205409938):0.8861406608):0.1892300809):0.8916202976):0.1615566803,(t16:8.624819262,(t17:1.474601197,t18:1.383782662):6.99849855):0.6907479329):0.1177175235):0.1898985253,((t19:0.6641927868,t20:0.6387357552):7.325231161,((t21:7.137170609,(t22:5.614537708,t23:5.565389442):1.483582757):0.285599934,((t24:1.738580024,t25:1.684937486):1.352062731,t26:2.851536822):4.144509079):0.3620801767):1.359352001):0.4192612166):0.2010379044):5.172643939,(((((t27:7.773425785,(t28:5.112857026,(t29:3.700195013,t30:3.659827575):1.162305298):2.403520174):0.3424443596,(t31:5.800836169,(t32:5.204259356,t33:5.101627032):0.5959026059):1.765738059):0.7469057403,(t34:2.060150882,t35:1.940004852):6.135207879):0.8666650803,((t36:7.071523131,((t37:4.247446696,t38:4.05187551):0.1562445469,t39:4.158747569):2.650993343):0.2699843923,t40:7.022251631):1.436690749):1.238145553,(t41:6.416829621,(t42:5.264889493,(t43:3.681345424,((t44:0.8683461809,(t45:0.5058734318,t46:0.4791753589):0.2566723715):2.532647529,t47:3.174243006):0.2504978888):1.389941509):1.09069954):3.259327097):3.494551967):4.021682065):1.276717147):1.637039525,((((t48:9.067266757,((((((t49:6.049340005,t50:5.799519684):0.3686524,((t51:0.6143469296,t52:0.4563227461):5.260026589,((((t53:2.625424478,t54:2.613206164):2.619163629,((t55:3.284080122,((t56:0.6894161568,t57:0.6723284682):1.557860658,t58:2.116639643):0.9849566602):1.882504857,(((t59:3.738894281,(t60:2.829045283,((t61:2.377630709,(t62:1.243912402,t63:1.047182236):0.9228929396):0.01338013691,t64:1.959878135):0.3667265783):0.6984289545):0.3444786454,((t65:0.9768249511,t66:0.7937573746):1.695725299,(t67:1.878981675,t68:1.870661758):0.4723244074):0.6012566728):0.1342098034,(t69:0.4903317181,t70:0.4618143642):2.571092412):0.5727739098):0.06323496665):0.2729023632,((((t71:1.608791693,t72:1.498686581):1.23941842,(t73:1.036603593,t74:0.7516694478):1.667759358):0.3137697361,((t75:0.5047263269,t76:0.4761707144):2.160301848,(t77:2.588823815,((t78:0.1408353856,t79:0.1318989972):1.351117357,t80:1.322611217):1.082203658):0.04271178501):0.007802492325):0.4975939355,(t81:2.638536302,t82:2.478239505):0.2418830374):0.04822927992):0.08460777099,t83:2.844942558):0.02306469614):0.0003818073684):0.6422528979,(((t84:0.8629653836,t85:0.8320373847):0.4566993095,t86:1.163932074):0.9012144255,t87:1.960322059):1.261429911):0.3231883102,t88:3.521170772):0.9424800661,((t89:2.596192352,t90:2.496613111):0.4651017853,((t91:1.993675053,(t92:0.8269041869,t93:0.772375014):1.140889858):0.4871523243,(((t94:1.025493601,t95:1.021987111):0.9100156772,((t96:1.655232357,t97:1.605004058):0.05838481677,t98:1.658839002):0.1833664599):0.3517244503,((t99:0.6926248403,t100:0.607302701):0.2451654694,t101:0.7204296181):1.190138196):0.05019724179):0.4788939626):1.379824428):0.2753061606,((((t102:0.3333147604,t103:0.2762771266):0.6089606984,t104:0.7575429528):0.543910748,((t105:0.2692416178,t106:0.2063574756):0.4618100369,t107:0.6339707451):0.5048710627):0.6889772774,(t108:0.8867274876,t109:0.7718788581):0.8745832686):1.793902301):0.3736866131):9.077371063,((((((t110:0.5139013366,t111:0.4760224811):0.4715816275,(t112:0.5484370908,t113:0.5395787751):0.3571338935):1.800590292,(t114:0.3414589458,t115:0.3152183506):2.354733818):0.6058514384,(((((t116:0.8367249958,((t117:0.098049323,t118:0.03789616695):0.1134631221,t119:0.1022073711):0.6196095223):0.00279473385,t120:0.7212269561):0.3604452207,t121:1.033642404):0.6514341097,(t122:0.2528014694,t123:0.2055118288):1.291882854):1.011894129,((t124:0.3717896037,t125:0.3467766538):1.796769798,t126:2.002065006):0.2094992671):0.3647146022):7.844081488,(t132:0.9220626533,t133:0.8720374393):8.282637099):1.00567294,((t134:7.943341192,(t135:5.771829284,(t136:0.6211752807,t137:0.6156344781):5.003802269):1.852408104):0.2793699673,(t138:3.587928595,(t139:0.859392186,t140:0.5740104013):2.532273023):3.962196413):1.798407275):0.348263859):0.2735612977,t141:9.467594804):0.1566745548,((((t142:0.2149472197,t143:0.1654530146):2.856132892,(t144:0.2971362022,t145:0.2940890661):2.54490425):2.646686967,t146:5.395885159):3.624917659,(((t147:5.571131455,(t148:0.2474795499,(t149:0.08691685736,t150:0.04620966172):0.06421199105):5.260582834):2.771527643,((t151:7.215771487,((t152:1.403056819,t153:1.239499795):4.353918626,(t154:2.876272188,t155:2.773352057):2.714093655):0.869126592):0.6374842878,t156:6.981844652):0.1547217185):0.02355969576,(t157:6.379977552,(t158:5.589188622,t159:5.454997083):0.7656628394):0.758713858):0.5233913377):0.1988779766):1.018620556):0.1912864382):0.8396847521,(t160:7.469572193,((t161:1.247716774,t162:1.184753391):5.722679114,t163:6.844754448):0.4345101845):2.107655367):0.2179106413):3.368305392,((t164:7.752630025,(((((t165:2.704893367,(t166:0.8344969188,t167:0.8034397171):1.849219505):2.599537559,(t168:0.4036114132,t169:0.3856162484):4.805792497):1.053114884,((t170:0.5154788912,t171:0.3087627318):2.680141867,t172:2.98433609):3.024624885):0.04143552105,(t173:3.259957394,t174:3.212361078):2.673894027):0.1598316533,t175:5.880674906):1.083151864):1.878613659,(((((t176:5.331309286,(t177:2.311920797,t178:2.204373978):2.772106595):0.973064273,(((t179:2.830634207,(t180:1.920190962,t181:1.882879004):0.745847054):1.622912377,((t182:3.013901501,((t183:1.599684583,t184:1.352731111):0.5437404347,t185:1.850217584):0.8474955411):1.057028254,(t186:2.273997162,t187:2.129205716):1.170832857):0.1715318279):0.6851008677,t188:3.81843249):0.774849563):0.9975072726,(t189:5.133549684,((t190:4.179438217,t191:3.993678543):0.3438100388,(((((t192:3.277771555,(t193:2.349457223,(((t194:0.2329222545,t195:0.2063964813):0.7666599552,t196:0.9386829464):0.83017822,t197:1.657536156):0.4055433651):0.6604045665):0.02009576979,t198:2.72563492):0.1051265062,t199:2.713970207):0.4877523405,t200:3.141632346):0.2391054236,t201:3.327106675):0.1313604611):0.5970962211):0.4477580152):0.435513671,(((t202:0.357263386,t203:0.3308293044):2.598379275,t204:2.720210324):0.1634641123,t205:2.609201464):1.591096916):0.03533098542,((t206:2.909815274,t207:2.877313059):0.1479814013,(t208:2.892101462,(t209:2.358145318,(t210:1.315783859,t211:1.116172088):1.039792066):0.5001396696):0.08312020832):1.151756055):1.04003464):3.272388364):0.5168348548):4.731976236,(((t212:1.283614724,t213:1.180391477):3.386789399,((((t214:0.2817221869,t215:0.2516715702):2.251657185,((t216:1.305124586,t218:1.100180835):0.06500115885,t219:1.037005328):1.002592377):0.2432550038,t220:2.118188738):0.9930503204,((t221:0.7225681335,t222:0.4829397529):0.8166441525,t223:1.1917984):1.522990989):0.7193020526):0.2206886286,(t224:2.712424955,(((t225:0.7056872392,t226:0.5022435178):0.6464931408,(t228:0.8931132582,(t229:0.6592306067,((t230:0.5210582828,(t231:0.1043105322,t232:0.092204637):0.2827531284):0.04024589394,t233:0.2995553194):0.0774905873):0.1900105457):0.01650278886):0.4259882832,(t234:0.0506349331,t235:0.02634800032):0.8338660363):0.8189255908):0.8553998914):8.378540673):0.3160800367,(((((t236:0.1030207848,t237:0.08114517472):0.7842212619,(t238:0.2119152131,(t239:0.1071442633,t240:0.07827725981):0.07245661902):0.427120233):0.05197702657,t241:0.5470081045):1.222537017,((t242:0.318852809,t243:0.2132325286):0.3474007151,t244:0.5591612744):0.7622054157):4.101737212,(t246:0.6368647863,(t247:0.1119448123,t248:0.07322000518):0.3406845484):4.432338428):4.920997005):0.5879936686,(t249:0.5179612531,t250:0.5123016407):9.756409059):0.4580833058):0.8998268411):0.07327542698,((t251:6.480007892,t252:6.241909539):3.297371011,(t253:9.111312945,(t255:5.771212975,t256:5.702913238):2.918214484):0.3476025423):1.739960889):0.02397915777,(((t257:2.35408446,t258:2.318939667):6.128285636,(((t259:6.348653391,t260:6.313743739):1.089473512,(t261:3.433551982,t262:3.405453255):3.933017724):0.9062798577,((t263:2.525238452,(t264:0.1973731248,t265:0.1616986148):2.294727333):5.252218128,t266:7.525857913):0.4656676226):0.0963176077):0.6570556736,((t267:3.109128551,(t268:1.439228253,t269:1.325812601):1.376551394):4.903660974,(t270:4.217841371,t271:4.17559988):3.31707385):0.1384505523):1.458900491):0.150522585,(((((t272:4.126369659,t273:4.123513462):1.300568194,t274:5.421269689):0.7810326266,t275:6.178078895):1.464369076,(((t276:3.751447755,t277:3.721491285):2.72010391,t278:6.408357443):0.6260143908,((t279:2.923417194,(t280:2.008953282,t281:1.986309626):0.5270237773):3.734285121,(t282:4.62556667,t283:4.23440707):1.316451072):0.3522973246):0.409754593):0.9753481089,(t284:6.499059867,(((t285:0.3236587744,t286:0.1733725706):4.207861593,t287:4.3152044):1.158690713,(t288:3.94714747,((t289:3.282641507,t290:3.238966268):0.513848126,t291:3.684090065):0.1461177709):1.520789271):0.7921493079):0.6636132241):0.4845330604):1.188992001):5.431262645):2.761201463):0.08851519583,((((t293:6.55595369,(((t294:0.4749719493,t295:0.1738506245):4.552282811,((t296:1.734519314,t297:1.693904875):0.776640184,t298:2.37320643):2.213520257):0.4714907016,(t299:3.559450969,t300:3.50256999):1.49410122):0.8886234047):0.7772167823,((((t301:2.922490409,(t302:1.811107291,t303:1.695585739):0.7367607152):2.048920898,t304:4.419591615):0.6808571106,(t305:0.2669145786,t306:0.2576312958):4.818422996):0.324042779,(((((t307:2.116895182,t308:2.107614925):0.2646909428,t309:2.327470617):0.2163243667,t310:2.454308805):1.603460582,((t311:2.620848855,t312:2.209483627):0.8963713866,(t313:2.638398165,t314:2.53503722):0.4461186958):0.5341021907):0.2660171172,((((t315:2.514260427,(t316:0.794424642,t317:0.7353243242):1.651679354):0.5587180471,(t318:0.9453978618,t319:0.9263062049):1.831025005):0.07473057939,(t320:0.326922927,t321:0.2917289454):2.464690553):0.1613854512,(t322:1.585411783,(t323:1.082434472,t324:1.013231214):0.494768636):1.237133035):0.4298416312):0.5748535228):0.6196698546):3.921292595,(t325:0.3279923647,t326:0.311097776):7.957491785):0.2493078692,((((t327:3.46541247,(t328:3.173452249,(t329:2.947366843,(t330:1.678039804,((t331:1.059951632,t332:0.9231649811):0.209741983,t333:1.115896023):0.3870390655):1.173769466):0.1651313718):0.1002797032):0.2595858747,(t334:0.9748111583,(t335:0.6181715733,t336:0.5856080933):0.3123595896):2.201746265):0.1550994915,t337:3.16588962):0.9347147387,((t338:2.707312811,((t339:1.621433555,((t340:0.8160861204,t341:0.7833424979):0.6395494695,t342:1.177161106):0.08152594647):0.8919059997,((t343:0.8337347619,t344:0.3832775223):0.9887179644,(t345:0.05288107287,t346:0.04928441405):1.133875531):0.2463391985):0.04975261807):1.236941241,((t347:0.8253190428,t348:0.7237887218):1.261102204,((t349:0.8130957525,t350:0.7918630064):0.1764204696,(t351:0.3679547849,t352:0.2068378394):0.1854571912):0.8473127164):0.575944796):0.03753424429):3.696453266):5.195742508):0.2333544263):0.3650249591):1.326647859):11.41642628,(((((((t353:0.5431188962,(t355:0.2281569187,t356:0.1582091009):0.1931959076):0.6448932459,t357:0.890685053):0.9018037073,t358:1.678781925):0.2381074303,(t359:0.3561833771,t360:0.08159406347):1.507284745):8.145952222,(t361:1.697956765,(t362:1.357625212,t364:1.11790093):0.2479964502):8.017961736):1.392631855,(((((t365:0.4389954347,t366:0.3734442864):0.7217256004,t367:0.9864776259):0.6090013123,(t368:0.8864837907,t369:0.8116357204):0.6404931517):7.680826006,t370:8.877955373):0.5119843731,((t371:1.264354227,t372:1.223767853):1.454577624,(t373:0.4268005707,t374:0.4236783872):2.131223693):6.60477364):0.5638268613):0.4733604659,((t375:8.947347579,(((t376:2.743463901,t378:2.451066421):5.258771471,(((t379:0.3164285863,t380:0.2393603091):4.101570109,t381:4.210553835):1.487802241,t382:5.597484971):1.774760063):0.6662520622,t383:7.865211545):0.240261823):0.9554526439,((t384:5.678172609,t385:5.118538686):0.9989398993,t386:6.106408592):2.343600128):0.2526926432):11.73396552):0.3730400367,((((((t387:2.894232351,t388:2.877610888):3.081590432,t389:5.856482944):0.9971551428,t390:6.760205518):0.9293239399,(t391:6.940230648,t392:6.902015339):0.6960568785):1.594942214,(t393:7.292468943,(t394:6.59532402,t395:6.524645032):0.6931644471):1.863479183):0.2331457615,(((t396:6.630469742,((t397:1.748873047,t398:1.747029795):4.404161779,((t399:4.162457351,t400:4.14810606):1.296694281,(t401:0.3711236275,t402:0.334494557):5.030325227):0.5270461407):0.4367270532):0.8154928294,t403:7.131322498):0.7429568393,(t404:7.397857413,(((t405:2.032177533,t406:1.922623897):4.171299046,t407:5.837423658):0.2000042383,(((t408:1.862201334,t409:1.807874443):1.048619235,(t410:0.9281695867,t411:0.6851218762):1.761795687):2.836357836,((t412:3.932707532,(t413:3.818119503,((t414:1.110482694,t415:1.039410209):0.1755575972,t416:0.9594661629):2.514093491):0.06103097278):0.9845001688,(t417:1.300053346,t418:1.001189637):3.120379288):0.3234728269):0.103114561):0.9369904662):0.3422132):1.059363142):10.97719357):11.44971444,((((((t419:5.302979726,(((t420:1.529255929,t421:1.427215721):2.514647226,(t422:2.496828176,(t423:0.6130929764,t424:0.6086007495):1.873788546):1.368120161):0.7120137323,t425:4.489425054):0.3982144252):0.3916335147,((t426:4.394256063,((t427:2.22008225,t428:2.047019211):0.4393568109,t429:2.340275457):1.414533024):0.3695221354,(t431:0.941043828,t432:0.8634134525):3.107130346):0.4549923916):0.04642444831,(t433:3.880063305,(t434:3.371260823,((t435:1.755719556,t436:1.746757564):1.369070859,(t437:2.989134254,(t438:2.102176039,t439:2.071686107):0.8335648963):0.1146587497):0.2247895869):0.4324780481):0.2795539533):0.02178087184,(((t440:2.272877493,t441:2.015091809):0.3457457973,(t442:1.73606671,t443:1.675058595):0.375833045):0.2986235322,(((t444:0.07740392203,t445:0.01463248341):1.361262537,(t446:0.831355863,t447:0.6962318917):0.1721157255):0.207223062,t448:0.9635432231):0.5603714968):0.8211979273):1.862483051,(t449:3.095294581,(t451:1.101803646,t453:0.8132700301):1.58479904):0.9612548625):17.82724476,((t454:0.4516545749,t455:0.4123382974):2.606220554,(t457:1.49933594,(t458:1.271796888,(t459:0.8976250482,t460:0.8414138076):0.04525627082):0.04265520975):0.8586892225):18.09142303):3.743629605):62.19903099,(((t461:1.244860278,t462:1.096987943):0.05608713334,t463:1.017915909):34.66377277,(t464:0.4903292964,t466:0.2477999731):35.17687203):49.85543884);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.logistic.T29.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
