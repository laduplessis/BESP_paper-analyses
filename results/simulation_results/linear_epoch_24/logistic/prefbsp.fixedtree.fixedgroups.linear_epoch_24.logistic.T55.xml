<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t437:2.738945142,(((t438:1.643025414,t439:1.610262736):0.2800928057,t440:1.700112272):0.2327864524,t441:1.904779879):0.4621213318):0.8710778493,((t442:2.233238577,t443:2.165407013):0.3955868809,((t444:0.5975569355,t445:0.5771468187):1.58243216,(t446:1.654207293,t447:1.579748556):0.3676670162):0.3452625322):0.3915741546):0.1255601372,((t448:1.301341089,t449:1.29734574):1.035275228,(t450:1.646106961,t451:1.373388845):0.5985518025):0.2621904396):0.0270699808,(t452:1.758738564,t453:1.750640427):0.3666194475):59.84808774,(((t454:1.06142688,(t455:0.7895286578,(t456:0.3360997533,t457:0.2135502078):0.3284690138):0.05857749079):0.2762921864,(t458:0.1803177544,t459:0.1571266632):0.6868545596):0.7249779947,((((t460:0.4143884846,(t461:0.07694810627,t462:0.02507925777):0.1106034688):0.08567713121,t463:0.1855797702):0.4217853513,(t464:0.2798842065,t465:0.1561491419):0.317002832):0.4033560362,(t466:0.78842426,t467:0.7402111124):0.05372952248):0.1817038986):59.33182179):71.49024907,(((t468:13.42271192,t470:12.91326188):0.1060901578,((t473:1.333267447,(t474:0.5970673457,t475:0.558238373):0.6675062274):10.34164376,(((t471:0.1367277356,t472:0.07137531199):0.03523667158,((t469:0.03306521614,((t362:0.01883731996,((t355:0.3491554238,t358:0.12729642):0.05745536711,(t359:0.1219802298,(((t356:0.05468517399,t357:0.0328798005):0.03534398075,((t273:0.08029283018,(((t243:0.1156099159,(t242:0.004615837615,(t228:0.2612850929,(t226:0.322484009,(((t214:0.02704319142,(t211:0.003417217553,(t151:0.1279373647,(((t111:0.216517717,(t112:0.002300122361,(((t96:0.3652465762,(t93:0.009163833263,t1:9.204562428):0.5761940432):0.05227848694,((t2:4.149086317,((t3:0.2478813933,t4:0.2055214302):0.3755302449,t5:0.0935564144):3.437964629):5.573599271,(((t6:1.128001715,t7:1.031462783):2.147065714,((t8:0.1666199815,t9:0.1106368674):1.811016121,(t10:1.498923751,t11:1.421883498):0.4208785633):1.183320792):4.269690138,((t12:2.028979409,t13:1.955386541):3.834700762,t14:5.786677183):1.426233582):1.41392991):0.05371496188):0.4132863614,(t15:0.3333852974,t16:0.2141386604):8.59299098):0.4623001326):0.05465758199):0.8848515743,(((t17:8.973728941,((t18:3.953614362,t19:3.899249154):4.635130144,((t20:7.57466002,(t21:0.7784180487,t22:0.7499762381):6.702779165):0.1580992989,t23:7.542763098):0.7549468341):0.3612731613):0.05082034621,t24:8.707247833):0.06535632279,t25:8.256792948):1.111396192):0.4771316648,((t26:0.3909271569,t27:0.2971323091):7.387152201,(t28:6.041581918,t29:6.016532537):1.454460558):1.849800926):3.810807644):5.188344118):0.511766128):0.2759260493,(((((t30:4.238494003,t31:3.964468712):2.635013348,(((t32:3.207486388,t33:3.18418779):2.895491668,(t34:3.369889455,t35:3.229465882):2.651607314):0.01337350412,((t36:0.6152752232,t37:0.448850593):5.022501412,(((t38:2.090550487,t39:2.026625713):0.5928719327,t40:2.544804613):2.212001173,t41:4.704880802):0.5609757347):0.2192552479):0.4290991693):0.608693152,(t42:3.182062714,(t43:2.597638827,(t44:2.563265431,t45:2.508537045):0.02590764038):0.478743633):3.075695831):1.120486157,(t46:5.863648773,t47:5.81392581):1.13708245):1.204704809,(((t48:4.00390031,((t49:0.6365577674,t50:0.5540491563):2.594945491,t51:3.121052845):0.7265668064):2.099490011,(((t52:3.622987452,(t53:2.681520402,t54:2.661905212):0.9156071943):1.2547023,(t55:3.857607709,t56:3.682245706):0.9526648719):0.09057261999,(t57:4.114094422,t58:4.04551109):0.3900747771):0.5752666905):1.362979588,((((((t59:0.9739763253,(t60:0.626971092,t61:0.6223222366):0.2895178591):1.886919247,t62:2.70835642):1.427376535,(t63:0.1206913987,t64:0.1015251135):3.998977239):0.1475529096,((((t65:1.647195143,t66:1.525888996):2.04641295,t67:3.324901152):0.1056268084,t68:3.345165104):0.324820519,t69:3.46655563):0.05751308065):0.294089054,(t70:3.6165577,((t71:3.037063318,t72:2.807161356):0.1209465459,t73:2.853441036):0.3332354805):0.1580912055):0.108617983,(((t74:0.5688706942,t75:0.4587397713):1.960226682,(t76:1.25254854,t77:1.246570415):1.093451884):0.1759679415,(t78:1.605433106,((t79:0.6182135839,t80:0.608126783):0.3763440203,t81:0.9283938427):0.478880961):0.732945062):0.4370035119):1.29002941):0.6229823041):9.20947546):0.5619018181,(((((t82:1.977416121,(((t83:0.8654041265,(t84:0.6750067023,t85:0.6746681875):0.06293286478):0.4869605883,t86:1.205321319):0.1187245142,t87:1.272433111):0.4108340275):1.79460036,t88:3.457502447):1.655129982,(((t89:1.522605972,((t90:0.3847535936,t91:0.1465598711):0.6623069375,t92:0.8027148143):0.4290282444):0.6755582715,((t94:0.5398204844,t95:0.4268316022):0.5925796037,t97:0.5179131651):0.486509422):1.334050047,(t98:1.418550047,(((t99:0.3443665044,t100:0.08327726095):0.5028146412,t101:0.5633731294):0.02706068815,(t102:0.215990764,t103:0.1623175627):0.3542615271):0.537252069):0.8649896817):1.505628387):4.559301345,((((t104:1.236969198,t105:1.22107135):0.9022098778,t106:2.110360637):1.166212487,(t107:2.486671842,(t108:0.8426914401,(t109:0.5808398303,t110:0.4993866192):0.2435815186):1.543141147):0.7615982979):1.310821761,((t113:0.4181950246,t114:0.2617012933):0.2782565092,t115:0.3284126285):3.393502436):3.33492557):4.107795353,((t116:4.914387096,((t117:0.4427129383,t118:0.2936789462):0.9898870696,(t119:0.9891317961,t120:0.8666478861):0.2578520874):3.473856826):4.132926757,(((t121:0.7970951016,t122:0.3247683279):1.091483542,t123:1.071263785):2.943991286,(t124:2.075429618,t125:2.074268933):1.808432657):3.359115255):1.974702903):0.1337570271):0.158642886):0.6865839508):1.545228239):0.1260898831):0.306727803,(t126:4.944947844,((t127:0.6521082518,t128:0.6059302965):0.04026505166,t129:0.6115465316):4.133882136):7.183081979):0.1983697672,(((t130:9.05740387,(t131:7.992021341,(t132:2.64710379,t133:2.590266105):5.247422854):1.05027508):0.5136846168,t134:8.409517126):0.9645700402,(((t135:7.059664448,((t136:5.043727172,t137:4.975995094):1.028973331,t138:5.711735547):0.9589963562):1.238935686,(t139:2.294185489,((t140:0.8002108515,(t141:0.6181082444,t142:0.5894817409):0.09465832917):0.8828431871,t143:1.549737949):0.5387477429):5.579965691):0.568381856,((((t144:3.547608807,((t145:1.034916811,t146:1.029170936):0.5332664643,t147:1.504181724):1.856692228):3.008996367,t148:6.356726946):1.356190706,(((((t149:1.199226044,t150:1.173223896):4.957790345,(t152:5.327006958,(t153:4.882833439,t154:4.877360474):0.4294465839):0.6138884344):0.2078742027,(t155:6.068396506,(t156:5.493010914,(t157:4.608846069,(((t158:1.135237149,t159:1.117885352):2.611846849,t160:3.715373267):0.4671127755,t161:4.035210308):0.2954125406):0.6343889948):0.4619137737):0.02614625728):0.5134267499,(((t162:2.529264801,t163:2.46491184):1.931641271,t164:4.348468757):0.05735675679,t165:4.304859185):1.36588755):0.5926091486,((t166:5.555840802,t167:5.527435104):0.1642327354,t168:5.666530718):0.5240055588):0.224700728):0.09976613985,(t169:1.968129825,t170:1.901751354):4.392984036):0.08356771891):0.2748323196):1.581603497):1.963643819):4.242723345,(((((t171:1.868344541,t172:1.663243922):3.96300554,(((t173:3.811440677,t174:3.706009419):0.2323843271,t175:3.616459998):0.5764591023,((t176:0.1610224585,t177:0.1268193575):1.744000096,t178:1.567660642):2.152226683):0.9263811284):0.3394387078,((t179:2.944154696,t180:2.687268353):1.583803436,((t181:3.900528535,(t182:3.754718029,(t183:2.354238804,(t184:2.273111497,t185:2.167000611):0.07201021668):1.22044475):0.09797436445):0.164958205,(((t186:0.04491121689,t187:0.015504735):2.576910826,t188:2.542783978):0.6812974415,t189:3.046107422):0.3520835055):0.197155241):0.3394733538):0.5499965592,((((t190:2.071715824,t191:1.988195771):0.6527924455,(t192:2.523609613,t193:2.339428902):0.1075732226):0.9696685712,((t194:0.5951002585,t195:0.5753719821):0.9075793985,(t196:1.288317728,t197:1.249979883):0.1243695247):1.881769926):0.6976163623,((t198:0.8616754973,t199:0.8422450118):2.623267396,(t200:2.649232743,(t201:1.169503395,t202:1.148436045):1.309082282):0.7972488771):0.4640594849):0.01624961721):1.112319259,(((t203:1.889600124,(t204:1.012336173,t205:0.9680643429):0.7285666851):1.318044853,((t206:0.5714937007,t207:0.4666589239):0.8274649194,t208:1.203807005):1.505337729):0.6510757453,((t209:1.29036199,(t210:0.9682531698,t212:0.8913481004):0.2790350391):0.9558444545,t213:1.846843813):0.8817104214):0.9659136929):6.595610606):2.811105341):0.1904694112,((t215:0.7887062692,t216:0.7583035255):10.36284719,((((t217:0.1047228244,t218:0.02796041913):1.76212649,(((t219:0.2062338303,t220:0.1345842994):0.295611982,(t221:0.1696287559,(t222:0.05630419706,t223:0.04565146309):0.064403621):0.2578857412):0.1202817373,(t224:0.2925363383,t225:0.2641608338):0.1891562915):1.097986362):0.9366058133,(t227:1.502693061,(t229:0.6204023555,t230:0.395232811):0.409310848):0.2564636891):2.545658217,(t231:0.9910309408,t232:0.8746114909):2.474297479):5.599340704):1.876838611):0.03273204398):0.02650756611):0.3990402221):6.876254174,(((((((t233:0.4448238389,t234:0.3857567922):1.777794919,(t235:1.680263855,t236:1.671259282):0.3503854255):8.191815599,(t237:1.480704748,(t238:1.254101674,t239:1.165587636):0.02074307247):8.729324256):0.05540344754,((t240:0.3827578431,t241:0.2798417942):8.698051668,((t244:4.672678014,(t245:0.4819313152,t246:0.3209957228):4.141953717):3.239178445,((t247:3.613081035,((t248:1.188045592,t249:1.18379706):2.163488149,t250:3.202732075):0.1439375012):2.684116118,(((t251:3.684179076,(t252:0.9831170976,t253:0.8871106697):2.690808239):1.582438197,(t254:4.138922858,t255:4.067709346):1.003710291):0.7390778684,(t256:0.2712900152,t257:0.2288991443):5.199509358):0.01843745715):1.344764138):0.8469708623):0.6116183006):1.060789871,(t258:1.916445579,(t259:1.410680733,t260:1.368626769):0.450600871):6.934880747):0.3583655051,((t261:7.883345222,(t262:3.718005989,(t263:1.721381712,t264:1.701793997):1.93636959):4.062231685):1.160789997,(((((t265:1.557266285,t266:1.555204855):5.816568264,t267:7.320500712):0.130506282,(t268:1.082701666,t269:1.02130235):6.352611039):0.7763717573,((t270:2.28408404,(t271:0.197671077,t272:0.04758434212):2.068544728):4.580929406,(t274:6.394837981,t275:6.393070106):0.1589250827):1.199921798):0.24033805,t276:7.992043061):0.2680704343):0.05650066978):1.976322,(((((((t277:3.339045515,t278:3.257313893):2.461286174,t279:5.706724965):0.4549498376,t280:5.99508004):0.6453417589,t281:6.593398428):0.2375756229,((t282:1.046461598,t283:0.7719916707):5.627413593,(t284:3.847255758,t285:3.82674929):2.328065841):0.1245885415):0.1764834879,t286:6.27416903):1.744754973,(((t287:5.195439143,((t288:4.590871212,t289:4.438548576):0.4128974716,((t290:0.7377882009,t291:0.3724469092):3.676009527,(t292:3.914377337,t293:3.852398353):0.1036782379):0.276435101):0.1256227019):0.9803013485,(t294:1.120048237,(t295:0.7552173139,t296:0.7140640781):0.284992562):4.17194083):0.9743941812,((t297:4.937955886,(t298:4.50693851,((t299:3.575775925,((t300:2.243009775,t301:2.230820317):1.136046633,t302:3.286089808):0.001779286236):0.699405978,((t303:0.8402164409,(t304:0.33964376,t305:0.3176438104):0.4196814098):1.049777272,((t306:0.1188404188,t307:0.03226838077):1.230484855,t308:1.247422847):0.3069798017):2.068445491):0.211287106):0.3779237959):0.1901358212,((t309:3.85517532,t310:3.513716606):0.2200782288,(((t311:1.859575865,(t312:1.126251264,t313:1.070597726):0.5336532511):0.7638627511,t314:2.317921431):0.469779646,(t315:2.579983949,t316:2.532193515):0.1014865135):0.6317273357):0.04426343588):1.013842049):0.720718036):1.219567905):4.276439783):4.998448635):0.3563653456,(((((t317:1.269417631,(t318:0.6403241148,t319:0.5357122193):0.612123161):1.442428614,t320:2.461333914):1.631677077,((t321:2.213121965,(t322:1.342742432,(t323:0.4167224023,t324:0.3834795113):0.903197548):0.8428868496):0.3056718224,(t325:1.562324802,(t326:0.6325132614,t327:0.5716046118):0.8528411191):0.8197622589):1.555004344):3.597994037,(((t328:1.20718363,((t329:0.4191300779,t330:0.3508989894):0.1038148949,t331:0.4219460637):0.6703610071):1.485776592,(t332:2.196050321,(t333:1.417811144,(t334:0.8344649669,t335:0.7282662122):0.4729043315):0.7274472857):0.2765949128):2.202041755,(t336:1.003592574,(t337:0.9443487121,t338:0.7858492738):0.002438288734):3.376057924):2.45068133):1.234733667,(((t339:2.061038438,t340:1.944177983):0.1917327956,((((((t341:0.2562785596,t342:0.2109794198):0.3086288222,t343:0.4959222326):0.1835684126,((t344:0.4313352386,t345:0.4012670497):0.164926557,t346:0.5209865645):0.07443528743):0.05061783572,(t347:0.4033628465,(t348:0.06512416136,t349:0.06249419628):0.2103920977):0.1694742726):0.2144813216,(t350:0.371265741,t351:0.3184812119):0.2436957989):0.7182086173,((t352:0.106383307,t353:0.09145516218):0.49629216,t354:0.5155768383):0.6535020112):0.04461211729):0.420536425,t360:1.120604532):4.857832326):6.553495422):0.09148490661):1.44027967,((((((t361:1.168943516,(t363:0.7136741564,((t364:0.08435573507,t365:0.06944656031):0.07809095806,t366:0.009892484715):0.4361675967):0.2536312014):0.334567015,(t367:0.6132197979,t368:0.2747822766):0.316264009):6.209696647,t369:6.55724343):3.382555977,(((t370:6.920396144,(t371:0.801786426,t372:0.725805501):6.087535754):2.241435187,t373:8.864037952):0.03527184191,(t374:4.765338032,t375:4.691425737):4.12219559):0.5867836131):1.201484243,((t376:2.111439884,(t377:0.7192800574,t378:0.4654790548):1.247175349):7.051175928,(t379:8.379380374,(t380:0.8390259021,t381:0.6623668591):7.346442953):0.2852155358):1.433496689):0.9321831641,(((t382:0.1149797517,t383:0.06861100239):8.156269078,((t384:5.588071153,t385:5.25825487):0.6133335027,t386:5.82453901):1.349870585):0.7170079062,t387:7.813483348):1.665085988):0.6091050263):10.32547968):1.077469072):24.6399836,(((t388:2.065185587,t389:1.863381424):5.75497974,(t390:6.481756814,t391:6.462720765):1.096634195):11.96510046,(((((((t392:2.877804573,t393:2.858690775):3.953338152,t394:6.776094108):0.9273151612,((t395:5.068174168,(t396:3.185253208,t397:3.142099787):1.866160701):1.343618414,(t398:5.780552604,(t399:3.31922182,(t400:0.1404517088,t401:0.1319696549):2.860730927):2.3336859):0.3206408951):1.288355813):0.1617922054,(t402:6.997607821,(t403:4.683804146,t404:4.60629075):2.224427228):0.06595600813):0.8221167561,((t405:5.255481707,(t406:2.513614078,t407:2.361808724):2.653888912):1.841841215,((t408:5.385837071,((t409:0.549203549,t410:0.3469959501):4.054225739,t411:4.391519676):0.6884140772):0.9469417305,t412:5.829669947):0.4876398015):0.5816703848):0.2763720533,(((t413:4.971498871,((((t414:0.6986483511,t415:0.6558865316):2.297044604,t416:2.890260509):0.6076277318,(t417:0.3326755166,t418:0.1060185889):3.14857583):0.9935271606,t419:4.046098466):0.2275329436):0.2457146866,t420:4.332997864):1.489295904,t421:5.680309275):0.3721965879):0.3789390036,(((((t422:2.172593634,t423:2.153226867):2.302747906,(t424:3.506903968,t425:3.373456711):0.8574974327):0.1561602307,(t426:3.521140746,(t427:3.332543863,(t428:0.9437762916,t429:0.9095212969):2.371221434):0.02126369535):0.7008754896):0.1111844558,(t430:2.867292896,t431:2.841186136):1.137592104):1.381320576,((((t432:0.4428890441,t433:0.3595754826):2.328922577,t434:2.668251989):0.04370108741,t435:2.591117628):0.8140784306,t436:3.403691517):1.669784924):0.2839666138):10.0312009):26.29436193):93.52241877);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T55.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
