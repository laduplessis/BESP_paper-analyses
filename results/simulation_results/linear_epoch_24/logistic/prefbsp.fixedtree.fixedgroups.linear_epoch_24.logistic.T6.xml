<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t487:1.022563704,(t488:0.8246275822,(t489:0.5951426233,t490:0.55143528):0.2226109279):0.1556553233):0.02599691835,t491:0.1038335691):36.67965608,(((t493:0.3122850049,t494:0.2315043083):13.19059358,(t495:0.5154612423,t496:0.4727088227):12.82803738):22.8094687,((((t497:0.4270213392,(t492:0.006104880214,((t485:0.08614023849,(t480:0.4718097252,((t392:0.01004319618,((t381:0.03563829563,(t380:0.3465853507,((t376:0.2463615343,t377:0.08965441928):0.2655522823,(t378:0.02687787024,(t370:0.04882809404,(t361:0.0241585636,((t258:0.1336158801,(t259:0.1175979573,((t255:0.02135737237,(((t242:0.3089459532,(t243:0.04982073344,((((t221:0.0926708283,(t181:0.0715235924,((((t113:0.04666814077,(((t1:1.247493714,t2:0.8235417143):7.531781414,(t3:8.046889248,t4:7.757291978):0.1580155836):1.101602973,((t5:0.8022482206,t6:0.7278112338):7.497735974,(t7:2.078181725,t8:2.034286133):6.113905931):0.6007932884):2.935439089):1.815529311,(((t9:0.7488041468,t10:0.7154364049):6.60820911,(t11:0.4554328985,t12:0.4487023728):6.767292065):1.611198685,t13:8.578564114):4.332323521):0.4911805887,(((t14:8.668847542,(((t15:3.177242916,t16:2.859403587):2.895519928,t17:5.718206253):1.738179422,((t18:3.855030088,t19:3.535796998):3.25655338,t20:6.76348256):0.2542454089):0.6602958001):0.8763617268,(t21:5.135981801,(t22:3.917513655,(t23:0.987307882,t24:0.8898410853):2.879286002):1.067570855):3.410862762):0.8835164645,((t25:6.509557579,((t26:3.507866884,t27:3.480283863):0.5354657796,(t28:3.516793572,t29:3.504665472):0.4013110036):2.331907667):1.776046266,((t30:3.041850766,t31:2.944892451):2.997877164,t32:5.763036931):1.903414562):0.4963482929):2.960689271):0.8586458666,((((t33:6.508178743,(t34:1.4542918,t35:1.302471047):5.00963579):0.09414473756,((t36:1.246005117,t37:1.078685806):3.04137625,(t38:1.426636986,t39:1.260756485):2.599821353):1.88521903):0.740748693,(t40:3.55310405,t41:3.509140184):2.711881536):1.497708424,((t42:4.276322154,((t43:2.485287649,(t44:1.662929431,(t45:1.148121454,t46:1.132564265):0.4960270455):0.6740022784):0.7399101452,(t47:2.511415126,t48:2.367867252):0.5183249903):0.999397781):2.111157151,t49:5.968612978):1.313562979):2.924571973):2.315017368):3.361960438):1.061633679,((((((((((((t50:0.9337398846,t51:0.8175018703):4.152720114,(t52:3.728453434,t53:3.683072098):1.171669695):0.4192917475,(((t54:3.364381061,(t55:3.237060793,t56:3.112106571):0.05421391703):0.04667523689,t57:3.211513514):1.093875905,(t58:4.181619173,t59:3.997637795):0.05563363475):0.7644503416):0.8274619394,((((t60:3.056645555,(t61:2.106434262,t62:1.985036816):0.7890658119):0.02253603112,t63:2.585380085):0.9689474325,(((t64:0.3817967988,t65:0.3174430962):2.4258503,(t66:2.26184804,(t67:1.746395764,t68:1.651046007):0.5055627292):0.2215480174):0.5673730737,(((t69:0.7173225595,t70:0.7109048357):1.71127797,t71:2.263189121):0.3573611457,((t72:1.741228663,t73:1.698322676):0.4529355977,(t74:1.256877962,t75:1.249204107):0.8066043151):0.3596578787):0.03156180543):0.06698818139):0.5892451724,((t76:1.771365812,t77:1.766438794):0.3463332399,(t78:1.833116477,t79:1.680845266):0.1865003876):0.8606236526):0.9677045266):1.552783593,(((((t80:0.5762926856,t81:0.5636772438):2.340837186,(t82:0.9178921742,(t83:0.1588658893,t84:0.08380388771):0.7084518854):1.981017332):0.5024235024,((t85:1.788551862,t86:1.785149153):0.056543002,t87:1.769300982):1.410895125):0.5239578933,(((((t88:0.3135101574,t89:0.132062956):0.1137431201,t90:0.1034457069):0.7361165525,t91:0.6059816095):0.4949922779,t92:0.5779345516):1.40030018,((((t93:0.2983087315,t94:0.2835977198):0.173265639,(t95:0.3313700236,t96:0.2045412846):0.1114324375):0.04657513718,t97:0.2650415264):0.5744526435,t98:0.8286423401):0.832977264):0.5877293706):0.02931189914,(((t99:0.5982031522,t100:0.4718955111):0.09776062263,t101:0.2933722693):0.2260953213,t102:0.4649381467):1.168081005):1.155032916):0.2088585601,(t103:1.684079788,((t104:0.7749105666,t105:0.5871068628):0.3379572084,t106:0.601829717):0.2089109128):1.305609512):1.076848987,t107:2.854833875):5.154750755,((((t108:1.45558063,t109:1.308080702):1.335709664,(((t110:0.5287158608,t111:0.4407294162):0.903460902,(t112:0.794255413,t114:0.404766342):0.5247003434):0.9551715478,t115:1.796048732):0.2291451448):0.7294446297,(t116:0.1681205567,t117:0.1070233707):2.435266858):1.923185915,(t118:1.158143317,t119:1.046717311):3.098608651):2.552550561):1.633618023,((t120:8.173226767,t121:8.117785686):0.0695198202,(t122:7.786351398,(t123:5.3892927,t124:5.330710515):2.36719242):0.3599113765):0.07350986286):0.04283921781,((t125:4.784941047,((t126:0.2181147879,t127:0.2165777168):0.3764151416,t128:0.4910961659):4.105022343):3.057732014,(t129:1.775144645,t130:1.45606613):5.809662601):0.2968200274):0.3548166332,((t131:6.806051532,t132:6.769747262):0.1992103682,((t133:1.332498475,t134:1.267413662):2.581218049,(t135:2.674379439,t136:2.352690175):1.119970371):2.955604679):0.8048210715):0.2282245231,((t137:5.611789462,(t138:4.868486609,t139:4.858733073):0.653650692):1.189078881,(t140:5.186647251,(t141:0.7988692093,t142:0.7367325839):4.367153563):1.410846031):0.5503902453):0.3178848812):0.03037868885,t143:7.325384881):0.3593158274,t144:7.633774931):0.4515263494):0.08440735435):0.03100188255,((((t145:4.756209684,(t146:2.453620107,t147:2.404475918):2.251868737):0.08666921309,t148:4.74290096):2.992918837,((t149:6.80120806,((t150:5.254540441,t151:5.243772017):0.8444506635,(((t152:1.557026024,t153:1.418804873):0.6635076421,t154:1.931886363):3.205743458,((t155:0.4957733272,(t156:0.3009159134,t157:0.2118359214):0.1502959281):0.008695205276,t158:0.2326853073):4.590402778):0.6388554266):0.6571334842):0.2841273306,((t159:1.577985936,t160:1.531197532):4.594953925,(t161:2.464974018,t162:2.428747246):3.651204287):0.1459938373):0.6108768815):0.288588773,(t163:5.171508206,((t164:3.649026281,t165:3.596666097):1.210070459,((t166:2.393634239,t167:2.300736334):1.415451631,((t168:1.06072387,t169:0.9796919572):2.551636474,t170:3.524152414):0.08179847208):0.8603621913):0.2033210924):1.678018633):0.0758510226):0.4959196674,(t171:6.129314643,(t172:5.386524348,((t173:1.880069332,t174:1.864813968):2.286539952,t175:3.968895505):1.197924636):0.6170566277):0.7783644681):0.870653654):0.2852232586,(((((t176:3.810287209,(t177:1.574209244,(t178:0.2566617437,t179:0.1635244342):1.051859639):2.179018456):0.8270876643,((t180:2.203543408,t182:2.08958439):1.284416758,t183:3.150799702):0.6554606322):0.9374995911,(((t184:4.266539721,(t185:2.871891872,t186:2.871010846):1.372355137):0.3107585737,(((t187:1.90961699,t188:1.905280599):0.7722239674,(t189:1.808874521,t190:1.647001923):0.8111277063):1.152351241,(((t191:2.713669083,t192:2.462638115):0.6741209179,t193:3.136214705):0.06165620053,((t194:2.251971635,((t195:1.279659253,t196:1.136793131):0.6793383607,t197:1.501782095):0.2911870665):0.7474624437,(((t198:1.687978673,t199:1.668244303):0.05984494505,(t200:1.471960657,t201:1.343590052):0.2451189609):0.1473294791,(t202:0.5823662987,t203:0.52154265):1.136968911):0.6025288134):0.09821863358):0.03595084659):0.6886122509):0.0585433635,(((t204:1.226570494,(t205:1.058345205,t206:1.002211086):0.06139131516):0.1947363854,t207:1.138883842):1.38117857,((t208:1.867125113,t209:1.839638849):0.526702868,((t210:1.615392618,(t211:1.467807698,(t212:0.9962001854,(t213:0.66543811,t214:0.6369632012):0.151183867):0.3448862517):0.1259098267):0.6815358764,((t215:1.382405171,t216:1.157319159):0.2118010477,t217:1.358592462):0.263302731):0.06222218574):0.08462317015):0.3100252732):0.02444502412):0.1159691767,(t218:2.077624129,(((t219:0.7221857203,t220:0.6685098852):0.5887771879,t222:0.8766050118):0.5019526876,(t223:0.6345767071,(t224:0.4558386785,t225:0.4541546093):0.1658448096):0.7027956119):0.1794074095):0.1190123746):0.8010161065,((t226:0.4335821137,t227:0.3501702939):1.300155436,((t228:0.3145924841,t229:0.1535108935):0.5255197752,t230:0.6658116357):0.7993414986):0.5832822014):1.117810953):0.1414990763):0.01034791089):4.23821891,(t231:7.435483145,(((((t232:0.255855131,(t233:0.1265052841,t234:0.09116144892):0.1162724473):1.078791915,(t235:0.5580368801,t236:0.5010823524):0.3966203207):0.5970376062,t237:1.352005873):1.138402028,t238:2.259351513):3.852892831,(((t239:1.803467502,(((t240:0.4435215602,t241:0.1973725078):0.2174207358,t244:0.01262001318):0.420206758,t245:0.2893426979):0.6667544791):1.136825916,(t246:1.744028272,(t247:0.4313359785,(t248:0.193705339,t249:0.1845436515):0.2167757678):1.111367091):0.09450520029):1.518661401,t250:3.119212923):1.640678293):0.4883029825):0.09576794569):3.446462288):0.8779689261):0.8856685051):0.2366832581):0.6494284188):0.1047698929):1.156256562,(((t251:6.994043014,(t252:6.043033099,t253:5.877543616):0.8558356235):1.521774518,t254:7.976742571):1.634749491,(((t256:5.209621643,t257:5.091782409):0.9702156374,t260:5.678092573):3.297027541,t261:8.944587188):0.06568141851):2.477023279):0.06950187975):6.332566275,(((((((t262:7.735870162,t263:7.617100228):0.2067789662,((t264:7.011013304,t265:6.924283188):0.04372867372,t266:6.851059873):0.6120363723):0.02724363444,t267:7.453365661):0.3320699015,t268:7.723272397):1.033873936,((t269:0.4120129774,t270:0.2868376606):6.261971037,(t271:5.849966368,t272:5.624062461):0.6937474883):2.079907775):3.131331725,((t273:7.623622338,((t274:0.7183418977,t275:0.6632730146):4.417026624,(t276:3.036216858,(t277:2.146051169,t278:2.066845439):0.8413372471):1.989615993):2.289712008):0.7712268721,((((t279:6.287215792,((((t280:0.358565527,t281:0.2588665714):2.521431124,t282:2.693676202):1.841623755,(t283:4.306097806,(t284:2.975500025,t285:2.963449741):1.27831669):0.1933949795):0.3866761413,t286:4.718955447):0.985423486):0.5067778905,((((t287:2.441466171,t288:2.406305532):0.5910941329,(t289:2.686641425,t290:2.478959501):0.05523944822):1.43313481,((t291:1.674016334,t292:1.604875881):2.079839045,t293:3.618759745):0.1021990429):0.1584039066,t294:3.860941418):1.510774244):0.2091693839,t295:5.568946232):0.3934739236,(t296:5.052202695,(((t297:0.8687700568,t298:0.8606582754):1.272904878,t299:2.11083039):0.06397991364,(t300:1.588453399,t301:1.551080423):0.4533456928):2.794259767):0.8544830852):0.4281976415):2.793605285):3.752760976,(((((((t302:0.06204887617,t303:0.002003598937):0.2771992194,t304:0.1506762131):2.763665843,((t305:1.431158018,t306:1.257918262):0.07803750619,t307:1.233550142):1.329520258):0.1078621062,(t308:2.507739407,t309:2.423508503):0.07407427853):0.3278779586,(t310:1.838158537,t311:1.810959705):0.9141655283):2.217220848,((t312:3.17604482,(t313:1.880854727,t314:1.86887439):1.254546609):1.53772836,((t315:0.4009103781,t316:0.2675660953):3.29964828,((t317:2.492638725,((t318:1.339148069,t319:1.311421815):1.015214481,(t320:1.607485261,t321:1.600618495):0.6174607008):0.1371529245):0.5516804787,t322:2.815174784):0.4443229556):0.884554621):0.1084431407):3.036753414,(((t323:5.205849462,((t324:3.278387652,(t325:2.803784838,(t326:1.602286415,(t327:1.488412258,t328:1.244915221):0.0698975284):1.192706702):0.4265496335):0.9490826618,(((t329:0.6840541123,t330:0.6128751061):1.258204694,t331:1.83535544):0.4866956203,(t332:2.279587092,t333:2.208593449):0.00975844919):1.429553587):0.9595848523):0.4761911335,(((((((t334:2.440522524,t335:2.43059391):0.2554106352,((t336:1.906761438,(t337:1.724635593,t338:1.721890255):0.1508213731):0.194358105,(t339:1.043328803,t340:0.9262645421):0.9601656742):0.4525852117):0.1520160006,((t341:1.232628533,t342:1.134009439):0.9763802266,(t343:1.410380615,t344:1.363673179):0.6506624922):0.2417854774):0.03253415355,(t345:1.357544602,t346:1.317393156):0.8097925029):0.4085777922,((t347:0.1416795331,t348:0.06469214874):2.292287919,t349:2.352696785):0.06750570654):1.52976711,(t350:1.234421139,t351:1.232210221):2.65507705):0.244238294,(t352:2.515431464,((t353:0.8513944909,t354:0.776978464):1.358706609,t355:2.135332928):0.2937281579):1.58439783):0.01820355247):0.06790610206,((t356:0.8013023907,t357:0.6304075276):1.019878418,(t358:1.466060085,t359:1.343311599):0.09298992688):2.237780255):1.459112409):3.775310334):1.598578508):2.290580131):0.3751441248):1.162677877,(((((((t360:1.041320707,t362:0.5286517334):1.960196702,((((t363:0.7006975907,t364:0.6745261564):0.7860813062,((t365:0.4916886422,(t366:0.389637996,t367:0.2702562004):0.04385618578):0.5436190026,t368:0.8544827214):0.4195521783):0.4320067211,t369:1.698250402):0.1136954881,(t371:1.400886923,(t372:1.016770014,((t373:0.255899502,t374:0.1571950489):0.6895147329,t375:0.5290678805):0.0448134551):0.3398767343):0.3064083768):0.1874132269):0.0919308839,t379:0.8802820287):0.3059870881,t382:0.1845037622):9.748767513,(t383:1.552743439,((t384:0.02666258181,t385:0.01017091491):0.9123173264,t386:0.4830900909):0.5519548379):8.372158039):0.2105342916,((t387:4.417429865,t388:4.324124158):1.425662195,(t389:0.4605822364,t390:0.4519243847):5.277104003):3.68518507):0.04443566288,((t391:9.156941577,(((((t393:4.502171672,((t394:0.3260451525,t395:0.2979248313):2.919146341,t396:3.193842023):1.052708701):2.892004009,(t397:1.132538753,t398:1.08849697):5.950992612):0.7274548838,t399:7.763259894):0.3250420664,(((t400:0.9406522686,t401:0.8378441442):3.701292523,t402:4.25926607):3.389309131,(t403:7.128737181,((t404:5.332528565,t405:5.081358485):1.663642567,t406:6.654504378):0.009788893242):0.3956689556):0.01056197552):0.4290910197,(t407:6.094474632,(t408:5.876398625,t409:5.80470771):0.01833810222):1.174292739):0.0503202411):0.113201233,((t410:1.754955619,t411:1.565073737):1.42010394,t412:2.81200726):3.982179532):0.1141937634):0.9114049806):0.02879467195):0.7775325221):0.4541147348,((t413:7.675058655,((t414:6.143476225,t415:6.14068409):0.8374449808,(t416:6.761750872,(t417:6.141872081,(t418:1.919639253,t419:1.895281789):4.208408933):0.5582672662):0.1826565458):0.6298918469):1.354650916,(t420:1.860748425,t421:1.844724658):6.944598189):0.02925594696):10.61988223,(((((t422:3.906156026,t423:3.715686534):0.8265050047,t424:4.431070085):1.160297201,(t425:5.122983265,(t426:4.84824194,(t427:4.743372176,((t428:1.652548203,t429:1.491602587):2.623237146,((t430:2.467739538,t431:2.455318043):1.180764182,(t432:2.500808109,t433:2.378641824):1.129085777):0.445658492):0.4529544002):0.03485234404):0.2271100858):0.4256576494):0.6846713531,(t434:5.066775678,(t435:2.80545443,t436:2.509620808):2.202865259):0.5541824885):0.009600061418,t437:5.20147974):12.79891495):23.96412687,((t438:8.002955564,(((((t439:3.939538441,(t440:3.809936137,(t441:2.059614262,(t442:1.47489466,t443:0.7954582203):0.5756374889):1.698569258):0.09304346098):0.9116254265,((t444:1.675222983,t445:1.517829812):2.34804565,t446:3.64859092):0.0181238646):0.287911119,t447:3.897109993):0.9765437583,(t448:4.143550324,(t449:2.993439094,(t450:2.639817145,t451:2.629780517):0.3029639648):1.129844712):0.6672850192):0.6289669082,(((t452:3.385122349,(t453:2.496333846,(t454:1.825106647,t455:1.806391487):0.6284007308):0.8262813641):0.3916675745,((t456:3.09914603,t457:2.944822259):0.2163310753,(t458:2.772356093,t459:2.609782503):0.2811397731):0.2116276422):0.8166571875,(t460:1.949276448,(t461:1.632781844,t462:1.546273355):0.2284257367):1.690340885):0.7430750469):1.2364576):9.73619308,(((((t463:1.17866995,t464:1.164934701):1.331971804,(t465:2.016914905,t466:1.945484951):0.3868204707):0.6084519653,(t467:2.29764813,(t468:0.7782248759,t469:0.768488181):1.476021827):0.6356821008):0.8053657093,((t470:2.318681523,((t471:0.3837169136,t472:0.2700395567):1.541311069,t473:1.704568687):0.3650937799):1.055938977,((t474:0.3647052457,t475:0.1647409236):0.8837781961,t476:0.9034782681):1.807096547):0.2706179918):10.97319375,(((t477:1.928840039,(t478:1.215647985,t479:0.8455091518):0.5459381678):0.4334132932,((t481:0.5772457204,(t482:0.2625553655,t483:0.2080905741):0.3057939253):0.09970996135,t484:0.5889663333):0.5850509806):0.5042124282,t486:1.356555688):11.08463395):0.2610724421):24.20555716):0.596239228):0.2879844283);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T6.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
