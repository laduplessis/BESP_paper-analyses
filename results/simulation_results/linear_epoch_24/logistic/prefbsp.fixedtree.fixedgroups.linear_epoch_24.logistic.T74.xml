<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(t482:86.87257433,(t483:60.51850706,(((((t484:0.1500234405,t485:0.06172096933):0.599820245,t486:0.6590497462):11.48077294,((t488:1.4323291,(t489:0.2668074652,t490:0.2514381784):1.161610878):8.40599874,(t491:1.73980154,(t492:0.3044968335,t493:0.1922245453):1.407019663):7.82906938):1.761345454):25.22718039,((((((t487:0.2519887977,(((t456:0.04737427379,((t392:0.03427550674,((t381:0.03511764919,(t376:0.1616237465,(t364:0.4773553197,((t365:0.1525046368,t366:0.09372716762):0.130718526,(t355:0.05280598434,(t353:0.02613648595,((t340:0.1843445396,((t282:0.07367470169,(t245:0.03302057354,(t235:0.1010483188,(t227:0.03384825128,((((t212:0.2502769784,((t211:0.07091696578,(t141:0.1958360208,(t138:0.02312293058,(t118:0.1224074414,((t116:0.005579205065,(((t23:0.01878500717,t1:1.998737786):0.1281605598,t2:2.117438161):8.44651664,((((t3:4.953258647,(t4:0.4683207992,t5:0.4125360364):4.279157282):4.070094057,t6:8.681955865):0.5385928472,(((((t7:3.372432171,t8:3.361531081):0.8344945641,(t9:1.013786481,t10:0.8651320547):3.035159964):2.457626787,(t11:1.826763263,t12:1.757209136):4.464480138):1.265858552,((((t13:0.468748471,t14:0.416906716):0.08664772128,t15:0.4934712616):3.402975714,t16:3.551048246):1.437522112,t17:4.964960393):2.076094527):0.8605288976,(t18:7.75589842,(t19:2.446434418,t20:2.420190489):5.248534474):0.01675155959):0.3887969124):0.4706029787,(t21:8.49294418,((t22:6.221762215,((t24:2.234926195,t25:2.190453705):3.209576529,(t26:5.297183817,(t27:4.126738884,(t28:0.9329348101,t29:0.9322907064):3.086896316):0.946793394):0.04708567604):0.1632528328):1.47871106,t30:6.601519488):0.7466624004):0.01729954583):0.3031333224):0.6232049683):0.2114509745,(((t31:7.402543572,(t32:3.764779419,t33:3.694904484):3.465860242):0.6188731655,(t34:4.580174992,t35:4.475217626):3.175103647):0.220045476,t36:7.8511571):0.09189260515):0.1844954449):2.255326452):1.069951553):6.439457449):0.08622438943,((((((t37:2.76408422,t38:2.745375391):0.5037568576,(t39:1.129995007,t40:0.9834761788):2.076840498):3.600255774,t41:6.430833658):1.324156934,((t42:5.644064429,t43:5.446299373):2.012128486,((((t44:1.134215014,t45:1.010155876):4.796302307,((t46:4.740618788,t47:4.674012376):0.3114812531,(t48:3.895988799,((t49:2.852700109,(t50:0.822642857,t51:0.7130409351):1.923574615):0.2961660968,t52:2.803859394):0.4894817334):1.082367794):0.6397033309):0.7397030517,((t53:4.807919639,((t54:1.796998431,(t55:1.535330966,t56:1.386260463):0.2531125139):2.189243867,(t57:2.849830243,t58:2.659199354):0.9173009479):0.7504689252):0.4809579478,((t59:3.165910235,t60:3.127924861):0.6688978689,(t61:3.338951507,t62:3.183365223):0.2589828028):0.8597436213):0.4589741453):0.1450034443,((t63:1.617010245,t64:1.520077046):2.256290553,t65:3.696053645):1.002863449):0.6324173145):0.09175282227):9.182506111,((((((t66:2.845423087,t67:2.843116128):0.7404838824,((t68:1.730211657,t69:1.680362684):1.25647516,t70:2.928107706):0.5750439889):0.1679594489,((t71:2.780105793,(t72:1.265574115,t73:1.204661956):1.220828961):0.06354623681,(t74:1.954013313,t75:1.896661997):0.5087920812):0.6079811621):0.3734215164,(t76:1.493268182,t77:1.481694998):1.821071972):0.2881658061,t78:3.537747636):9.234612963,(((((((t79:3.224750047,(t80:2.679591159,(t81:1.146492766,t82:1.102973679):1.460527722):0.5024970364):0.209482583,(t83:2.937349668,t84:2.535319476):0.317125464):1.355940952,((t85:3.498893559,((t86:1.558200047,t87:1.316349598):1.204848305,(t88:2.10969732,(t89:0.4852922883,t90:0.4517383853):1.582091327):0.3850406889):0.7157093713):0.5916753458,(((((t91:0.4112365799,t92:0.409494636):0.8254413746,t93:1.11631174):0.3211441823,(t94:0.4580175513,t95:0.3181898724):0.9764022712):0.2660614508,(t96:0.619659886,t97:0.4631753333):0.8683602822):0.8078497588,((((t98:1.120100093,t99:0.873782295):0.5384897521,t100:1.203660748):0.1210852686,(t101:0.6470668674,(t102:0.4849564818,(t103:0.3398328025,t104:0.3171162444):0.1110165493):0.02145388592):0.470443979):0.007010700258,((t105:0.4997114239,t106:0.4706326581):0.226151315,t107:0.4391861183):0.1787885576):0.2562617766):1.017852974):0.0495490525):0.3199018384,t108:1.98445851):0.1976414303,((t109:0.2533184355,t110:0.1830982007):1.355932155,(t111:0.2121076701,t112:0.1505914285):1.255118999):0.4809800454):0.2206699993,(t113:1.827781419,(t114:0.7219802029,t115:0.7057192707):1.067808959):0.1255585558):0.1055392329,((t117:0.5146489859,t119:0.1846222234):0.8727900548,((t120:0.3111829757,t121:0.2858437126):0.08274614775,t122:0.05845060432):0.5212928721):0.3473337645):7.021169013):0.9300182448):0.2036763323,(t123:7.57883359,(((t124:0.09819711829,t125:0.025532341):5.772889653,t126:5.656988987):1.666461362,t127:7.170826597):0.02171592226):1.475200959):0.1536528752):0.3005807119):0.1457707243,t128:8.924060755):1.987513789,((t129:9.746044718,(t130:3.697240892,t131:3.689791081):5.986273717):0.6650766132,t132:10.18459913):0.3885877279):0.152570588,(t133:8.812875427,((((t134:7.073478453,(t135:0.3631113001,t136:0.2683046369):6.67568642):0.333094983,(t137:3.148023474,t139:2.617923088):4.113250529):0.2725824566,t140:6.740833714):0.3285754608,t142:6.630253926):0.7423349242):1.628571157):0.07701576289):0.5864593871):1.963256169):2.706150746):3.944774933,(((t143:7.497473024,((t144:3.721323068,t145:3.682605876):3.495959686,(((t146:1.221660429,t147:1.185797213):3.731513409,t148:4.841016611):1.360530397,t149:6.079733941):0.6639169315):0.2429545776):1.067255711,((t150:7.315681877,(((t151:3.373190249,(t152:3.108535911,t153:2.993118645):0.1705789894):2.347913669,t154:5.489432007):1.400239566,(((t155:1.990279133,t156:1.932888565):3.932607478,(t157:3.039590965,t158:2.989767628):2.824453606):0.1850831243,(t159:5.773357617,((t160:4.597147833,t161:4.58081589):0.6112970277,t162:5.046157779):0.4996480977):0.07057452575):0.7800806984):0.1640200243):0.2468374964,(t163:3.905633251,(t164:0.2456665368,t165:0.1360066401):3.538447388):2.845229835):0.4610823999):9.119369732,(((((t166:3.519343977,(t167:3.152569777,t168:3.054222062):0.2625719174):1.808039974,t169:5.108652674):0.7445497556,((t170:1.937036321,((t171:0.6274046145,t172:0.5138158418):0.5128310161,t173:0.9907907856):0.7776810466):3.052050951,t174:4.802974611):0.4627313628):0.4757731936,(((t175:2.711616297,t176:2.70193199):1.644825631,(((t177:3.556159835,((t178:2.067696412,t179:2.002049298):0.1477000328,(t180:0.3660453094,t181:0.2736437155):1.714330935):1.337560432):0.4925033765,(t182:1.624804513,t183:1.540904038):2.03959147):0.258086474,t184:3.692976266):0.03722380684):0.4295227035,t185:4.151860091):0.4388522234):0.09940964347,(t186:0.3521749517,t187:0.3491937193):4.294838065):9.411263577):0.4802827459):0.1836432826):0.6313233307,(t188:14.67040819,(((t189:5.17272685,t190:5.095984681):0.166711461,(((((t191:1.758953607,t192:1.730911655):1.003076327,((t193:1.910313841,t194:1.872899869):0.4330193117,(((t195:1.725674286,t196:1.701508292):0.04037700668,t197:1.720628981):0.09861424763,t198:1.818182654):0.4342939047):0.05831894204):0.563325144,t199:2.68186983):0.8693461056,((((t200:0.392570206,(t201:0.1644392874,t202:0.08379237159):0.1299065753):0.7945171555,t203:0.7612797168):1.56501387,t204:2.262693432):0.4321856387,t205:2.645747168):0.3221311806):0.9206718598,(((((t206:0.5724765761,t207:0.5662378264):0.7068245134,t208:0.8879452937):1.381236027,((((t209:1.416792779,(t210:0.8903830702,t213:0.1543143483):0.3849163597):0.1028592992,t214:0.5174793271):0.01874906508,(t215:0.2705964951,t216:0.1625242235):0.2294806924):0.409535157,(t217:0.2096206154,t218:0.1098955692):0.5482101054):0.1189494835):0.4286677989,((t219:0.2625539728,t220:0.1941840515):0.3678698145,t221:0.511951017):0.4192258043):0.1628119393,t222:1.060474754):0.5707410989):0.143156031):8.688275056,((t223:1.050830645,t224:1.037345403):0.8608082592,t225:1.878830803):7.95170179):0.4924481029):0.6729318975):0.06362700861):0.09373556157):1.436667818):0.142907907):0.9589470264):0.3458368046):0.5400628676,((((((((t226:1.066223596,t228:0.04044756689):8.237830684,t229:8.156477372):2.341096371,(((((t230:2.937258869,(t231:0.1072461054,t232:0.03081154808):2.820850125):3.590560438,t233:6.430880343):2.198097177,((t234:1.385784356,t236:1.26537171):7.058990473,(t237:2.566260063,t238:2.170176031):5.239435227):0.1020991425):0.8558372374,(((t239:2.646845549,((t240:1.60033214,t241:1.507379975):0.6733032823,t242:2.047297765):0.07751652408):3.580202736,t243:5.64838805):0.8927769746,t244:6.357625049):1.066393412):0.6828708877,t246:7.94921738):0.2022035813):0.01186162837,(t247:7.693551417,(t248:7.240809138,(((t249:5.709053958,t250:5.701976454):1.233220322,((t251:1.891710849,t252:1.831646502):1.854785387,((t253:1.446918087,t254:1.396476855):0.4099545897,t255:1.800457204):1.825196424):3.165248006):0.1484846141,t256:6.8817232):0.02260416868):0.3754742127):0.3389581107):0.4184619595,(t257:5.738691779,((t258:5.242589408,(t259:2.000881805,(t260:1.782550741,t261:1.746590892):0.1282453633):3.225896362):0.2279500817,(t262:5.221478007,t263:5.221401958):0.1019693279):0.1590399657):2.218806864):1.002371595,((t264:2.155230096,t265:2.110763572):1.881679546,t266:3.903158106):4.636869647):0.1254724492,(t267:5.86339619,t268:5.73081474):2.746615528):0.4757502093,(((t269:6.657155086,(t270:1.647719963,t271:1.440394992):4.949379916):0.3567705903,(t272:5.274018457,t273:5.228795611):1.377711818):0.3541112599,(t274:2.370320668,t275:2.345185303):4.541077104):1.379231558):0.8045446747):0.6008159522):5.409918974,(((((((t276:3.075587194,t277:2.965659731):1.426818203,(t278:2.393376456,t279:2.277006997):1.944593769):0.4135451128,((t280:0.3439168058,t281:0.3423790977):1.024297633,(t283:0.3864717271,t284:0.3737796108):0.715310788):3.020975706):0.3871647496,t285:4.489782131):0.5034170068,(((t286:0.3389603675,t287:0.3254312516):0.1109965412,t288:0.4018324072):4.327494876,t289:4.650454274):0.1978138665):0.1188214656,((t290:3.681725033,(t291:3.284503414,(t292:2.121749518,(t293:0.2653608618,t294:0.2253602503):1.845202014):1.131276896):0.3149391738):0.9223855537,(t295:1.3111079,t296:1.195840593):3.036518212):0.3624320635):0.9708062938,(t297:4.307210796,t298:4.234678813):1.162049198):8.178507554):0.4534631919):0.5973579133,((((t299:2.883173485,(t300:2.558183076,t301:2.514371624):0.2318486244):0.4749863827,(t302:3.009505789,t303:2.989391384):0.2005666287):1.046211147,(t304:2.88421203,t305:2.857447229):1.169185305):3.56949809,(((t306:1.342335919,t307:1.265352026):1.417824551,t308:2.321510889):0.8679587246,(t309:2.686466854,t310:2.681081275):0.4713570816):3.917667889):6.614315504):1.154516491,((((((t311:1.198335003,(t312:1.124547373,t313:1.008091425):0.04607170398):0.7143976732,(t314:1.127300746,t315:1.114522262):0.5384894411):0.4873366423,t316:2.093963471):0.5608694029,t317:2.550057325):0.6552622324,((t318:1.331924294,t319:1.330650388):1.653450408,t320:2.831623183):0.07463983079):8.56765117,((((t321:2.131402566,t322:2.104578428):1.100860029,(((t323:1.681417052,(t324:0.442251134,(t325:0.1006365012,t326:0.09230582028):0.2480544713):1.238717847):0.0487079172,(t327:0.7490915505,t328:0.595893767):0.852167833):1.03929577,(t329:1.803493687,t330:1.781584042):0.6729438211):0.4034069264):0.7844078404,((((t331:1.901731,(t332:1.569407053,t333:1.566255788):0.1270073037):0.435939856,(t334:1.604585529,(t335:0.3896975172,t336:0.224629858):1.130411318):0.4491111364):0.02585953433,(t337:0.6877607259,t338:0.5420695537):0.9430040251):0.4859852755,(t339:1.120309624,(t341:0.05562166182,t342:0.006815964935):0.5766085354):0.7910375147):0.7693291528):5.049324072,((((((t343:0.2904273369,t344:0.2554375059):0.2433278934,(t345:0.3546802626,t346:0.2991095755):0.13994514):0.6688135556,t347:1.096835685):0.4253267847,t348:1.460460784):0.829404769,((((t349:0.2551595104,(t350:0.1191852377,t351:0.1061312645):0.1065961449):0.7639967645,(((t352:0.132690632,t354:0.09586747942):0.2358870072,(t356:0.1181734807,t357:0.1035353511):0.03634737925):0.3814365693,(t358:0.07385954238,t359:0.06307840418):0.3610933474):0.2062019825):0.5978942879,t360:1.218788206):0.1273982899,((t361:0.5975565785,t362:0.382683829):0.1274658659,t363:0.4310555913):0.07443030646):0.4572656796):0.5542758169,(t367:0.8119127763,t368:0.6930738276):0.1295436952):4.070933705):2.401486048):2.598623192):1.210171596):0.6632099328,((((((((t369:1.304084939,t370:1.177189508):6.27460314,(((((t371:0.26765754,t372:0.2150692975):0.4253555948,t373:0.6316436301):0.09992105368,t374:0.5551945692):0.544935183,t375:0.9921274938):5.828129466,((t377:0.954490615,(t378:0.7466985209,t379:0.7358318263):0.1172259795):0.2824277811,t380:1.034790688):5.312290617):0.1559199674):0.4195309692,(((t382:0.03424271758,t383:0.02814770307):0.111259472,t384:0.1229402869):3.926496298,t385:4.027302062):2.758647706):0.1758841096,((t386:4.505133872,t387:4.273962489):2.034286828,t388:6.22612368):0.3547216242):1.008162943,t389:7.438357328):0.9876330784,t390:8.074614471):0.8236042719,(((t391:7.031528277,(t393:0.4279916463,t394:0.4074039408):6.368441791):0.7534178096,t395:7.267230003):0.03825106897,t396:7.230303168):1.074976935):0.007089027637,(t397:7.494262328,(((t398:3.785666739,t399:3.748112013):2.869284343,t400:6.581807099):0.6940508162,((t401:4.736784675,(t402:1.519696915,t403:1.518301126):3.150645924):1.609629302,t404:6.267605174):0.5708723003):0.1328879138):0.7457722988):0.7415383696):0.09101629527,(((t405:1.726595429,t406:1.679099387):1.410904142,t407:2.936888706):5.017141667,((t408:5.232795587,t409:5.206463103):1.262781902,t410:6.389702751):1.457712591):0.362842142):0.992852675,(((((t411:6.339461689,(t412:2.150726652,t413:2.063488718):4.105895122):0.4024069309,(t414:3.538986751,t415:3.478872689):2.586096531):0.4919691953,t416:6.417176798):0.321469173,t417:6.734619398):0.01662644856,(t418:2.948004543,(t419:2.742733297,(t420:2.537856642,((t421:0.3799046424,t422:0.2672332439):1.36270191,t423:1.343529952):0.6834590476):0.2015256525):0.06850885721):3.693949846):1.624432517):10.11594384,(t424:6.099875317,((((t425:3.195896672,(t426:2.064300189,t427:1.793624852):1.105985001):1.801008357,((((t428:1.832874507,t429:1.66863271):2.274050079,(t430:1.824809188,t431:1.743728793):1.983768606):0.2442318719,((t432:2.707315896,t433:2.637107608):0.2980242363,t434:2.927463194):0.9485987881):0.229483923,t435:4.103641777):0.05017611028):0.03316912713,((t436:4.012877317,(t437:0.5640374311,t438:0.5368268197):3.427963804):0.06456638746,(((t439:2.865914543,((t440:2.092494326,t441:1.862594186):0.2452920181,t442:1.974759597):0.3509200633):0.63916662,(t443:2.853935178,(t444:2.626871346,t445:2.601238019):0.1999572725):0.04225263449):0.1525601703,t446:2.78738579):0.1464901995):0.06720782443):0.7037318803,(t447:3.256640275,((t448:2.320484186,(((t449:1.591939261,(t450:1.092565089,(t451:0.9228371952,t452:0.9052324479):0.1472689101):0.4424090393):0.06320644117,t453:1.51394026):0.06152880919,t454:1.4138494):0.5767532777):0.2207228617,(t455:2.189089744,(((t457:1.747675291,t458:1.734155543):0.03476453766,((t459:1.022450367,t460:0.9970146197):0.4981471396,(t461:1.203409424,(t462:0.1871612682,t463:0.005190015272):1.003531822):0.2351559613):0.2131940812):0.007085121072,t464:1.414445372):0.2239713666):0.01013201179):0.6425524929):0.4232076428):0.3157908852):11.31248888):10.89817544,t465:25.21242993):14.3457373):10.64281663,((t466:3.570109043,(t467:1.139761842,t468:0.873350787):2.317523556):0.05051635481,((t469:0.2803297033,t470:0.2492862101):1.89729044,((t471:0.5425393351,(t472:0.3154827856,t473:0.3115170469):0.1832911024):1.156037439,((t474:1.046539689,((t475:0.2642815346,t476:0.2483831048):0.6732707144,(t477:0.3711101996,(t478:0.1271881283,t479:0.09337070848):0.180485097):0.5089641505):0.08650674609):0.2265194359,(t480:0.3778351764,t481:0.2905229014):0.7144330144):0.3288846437):0.3756516002):0.3092985432):46.55950837):12.276273):26.24427148);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.logistic.T74.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
