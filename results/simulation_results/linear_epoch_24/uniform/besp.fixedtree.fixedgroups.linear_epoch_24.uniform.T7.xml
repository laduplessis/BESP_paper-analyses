<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t463:2.283283701,t464:2.159978183):2.476228374,((t465:3.655621542,t466:3.394390155):0.6632565994,t467:4.040686238):0.2116688604):45.73099442,((t468:1.356018938,t469:1.305973055):37.77104117,((((t470:0.3520094186,t471:0.2790982604):0.4021767636,t472:0.5237234643):7.35001936,t473:7.711732541):10.95886107,(t474:5.207410245,(t475:1.603625892,t476:1.52191523):3.587195126):13.45611779):19.5588214):10.71967031):117.8812984,((t477:23.60637546,(((t448:0.2382567415,(t449:0.04427866993,((t401:0.2549968902,(t394:0.04145925405,((t373:0.4045867556,t375:0.0247332756):0.1163239284,(t374:0.06298780882,((((((t256:0.3556684762,((t206:0.06887685108,((t105:0.1371284656,((t61:0.1349885407,(((t1:3.748264492,t2:3.745053475):1.297585717,t3:4.987371021):0.4273379399,t4:5.134251313):0.6922452):1.740425529,(((t5:2.900684347,t6:2.85689217):0.3532082303,t7:3.151985125):3.089147285,t8:6.206132867):1.122081051):2.961424206):1.603951467,t9:11.77316267):7.179542879):1.591119436,((((((((t10:2.318488029,t11:1.664832048):7.660873569,(((t12:1.309782152,t13:1.25668373):5.904252706,(t14:3.257484136,t15:3.224609772):3.803292275):1.804596749,(((t16:1.103744368,t17:0.7223873526):0.4582281771,(t18:0.707356786,t19:0.6325082519):0.4611118676):0.02974230628,t20:1.067639375):7.173155378):0.2955285865):0.4132385837,((((t21:2.129574011,t22:2.126425299):0.8900537602,t23:2.970836198):1.42507107,(t24:2.09111107,t25:2.071912336):2.228064538):1.188621847,(((t26:2.035617525,t27:1.775239925):1.468684142,t28:3.231637114):0.922714101,t29:4.154173783):0.992223168):3.290081354):2.782119658,((t30:9.815010837,(((t31:2.681758976,(t32:1.814595072,(t33:1.394561036,t34:1.357643069):0.3027314425):0.8328293633):2.255982578,(t35:4.338357744,t36:4.305475049):0.3874452314):4.018452055,((t37:4.440657199,(t38:2.835622688,t39:2.763877082):1.514225366):1.998571669,(t40:0.700193546,t41:0.6802457745):5.57209021):2.138964097):0.7869077845):0.6224702383,((t42:1.408356801,t43:1.400411568):0.3105976832,(t44:1.107901494,t45:0.7520108406):0.3237161446):7.990931337):0.7796183798):2.862625236,((((((t46:1.757609514,t47:1.629421921):1.811508634,t48:3.314158908):1.914602061,t49:5.166838183):0.8041948532,(t50:3.960158078,t51:3.821904929):1.804324478):5.667368066,(t52:10.89651314,((((t53:1.707746749,t54:1.621839828):3.625774903,(t55:2.996925653,(t56:0.4527556764,t57:0.4483108728):2.353535142):1.952918589):3.228777131,(t58:4.041270375,(t59:1.016981437,(t60:0.9214880877,(t62:0.1074387133,t63:0.07386305042):0.1551396694):0.07008972974):2.996233114):3.9291426):1.005962294,((t64:1.223528147,t65:1.173611123):3.557030172,(t66:3.499171437,t67:3.481674374):0.9255508801):3.433494814):1.189752024):0.3223290088):0.4830497653,t68:9.590545341):0.1436865569):1.10234549,((((((t69:0.340497425,t70:0.2707193458):0.1433083574,t71:0.3933796927):4.220690674,(t72:4.276316303,t73:4.256316039):0.2687651378):1.330676366,t74:5.66675707):2.00120836,((t75:2.005200586,t76:1.935738789):1.972159862,((t77:0.9308875798,t78:0.7906158248):1.132780115,(t79:1.247233182,t80:1.164425571):0.6248325188):1.743231866):3.330514996):1.232241858,t81:8.093256496):1.522506185):2.318018301,((t82:11.09922641,((t83:1.938073105,(t84:1.124318752,t85:0.8590583037):0.6242003748):0.9445152269,t86:2.425254806):8.160230258):0.6630345653,(((t87:2.785565967,t88:2.545574882):2.549512484,(t89:3.117711232,(t90:1.021599352,t91:0.9438752498):2.087493756):1.935487296):1.899466749,(((t92:0.8208691102,t93:0.3299691008):0.9591238296,((t94:0.7522715795,t95:0.7483693291):0.1472609298,t96:0.8333360327):0.31712884):4.263818792,(t97:1.261578013,t98:1.201565389):4.137796609):0.8015670987):3.929319482):0.08412253508):0.5731044074,(((((t99:1.562006882,t100:1.359460393):2.108405912,t101:3.429593742):3.974942073,(((t102:1.423278754,(t103:0.9845487238,t104:0.9177854648):0.4015136444):0.3778012999,t106:1.135947331):2.243658192,(t107:1.656674487,t108:1.312855413):1.721231758):3.21191744):2.168129268,(t109:0.3337831637,t110:0.2749191127):8.063673234):0.08396189214,(t111:2.335882156,t112:2.311963036):6.027993951):0.7927858743):0.4662973781):5.085379636):0.01093942192,((t113:0.5903059285,t114:0.4964278214):9.280875567,(t115:3.968070382,t116:3.78814861):5.782616719):4.782008445):5.354728083,(((t117:0.5996726133,(t118:0.4834077328,t119:0.4333938269):0.09037350105):3.525447346,t120:4.031198534):14.1934269,((((t121:2.643969404,(t122:0.04642792311,t123:0.01793719534):2.50353722):7.156721019,(((t124:4.206311789,((t125:0.8888935093,t126:0.8600664269):2.330959445,t127:3.109340037):0.9807980526):4.262846027,(t128:4.199494993,(t129:0.1910897052,t130:0.1867235984):3.609623878):4.007737604):0.9109007249,(((((t131:0.09887273661,t132:0.08335319772):0.2481366361,t133:0.3074288869):0.9612309359,t134:1.195254597):2.931070932,(t135:1.306059976,t136:1.27501626):2.804609653):2.741148901,((t137:2.566691337,t138:2.376789569):1.855968416,t139:4.133486335):2.362819431):1.638426084):0.1074894617):4.935031524,((((t140:10.09548005,(((t141:0.9840196341,t142:0.9455042451):6.536219392,((t143:1.644097345,((t144:1.109678121,t145:0.9900441404):0.3561636659,t146:1.331038346):0.1046602692):4.750695466,((t147:1.477922126,t148:1.465548249):0.944493599,t149:2.387146382):3.731964204):0.9372250072):0.610731681,(t150:1.743591927,t151:1.546352644):5.908614202):1.927911425):0.3372905602,((((((t152:0.1628774962,t153:0.0624304799):0.4129307065,t154:0.4282155148):1.066085837,t155:1.490991109):0.9339570653,t156:2.411462734):2.14234089,t157:4.525255608):2.468710857,(t158:5.382582502,t159:5.185265886):1.583035412):2.499497491):0.7010630951,((((t160:1.649842692,t161:1.573390251):4.780186868,(t162:4.58270218,((t163:2.48349927,t164:2.474238864):1.108140994,(t165:1.608703961,t166:1.377257721):1.8832472):0.9886940047):1.72945212):0.1972238823,t167:6.139704441):0.4768484956,t168:6.604035344):2.805281691):1.838697779,t169:10.8844937):0.1550645592):1.714696253,t170:12.4747159):1.419489861):1.370009571):1.265027374,((((t171:4.400361027,(t172:1.146936082,t173:1.146349121):3.154572617):2.22330103,(t174:5.663511162,(t175:0.1024258395,t176:0.09155584805):5.355789842):0.8086140441):0.5024630856,((t177:2.584067228,t178:2.566035104):3.128184742,((t179:0.5891069423,(t180:0.3053089055,t181:0.2626619349):0.1750908025):3.832828539,t182:3.595839626):1.235259246):0.991769486):7.992549878,(t183:11.65632481,(t184:6.946738384,((((((((t185:0.4812285765,t186:0.4516946361):0.1083739233,t187:0.2331465265):0.5418510747,t188:0.7391352015):1.132672647,t189:1.851273797):0.5039726319,t190:2.203224608):1.614896559,(t191:0.5769180954,t192:0.5704798234):3.085675266):0.06145426844,t193:3.715772579):2.324205279,(t194:0.2427082481,t195:0.2097757296):5.716944892):0.1619389479):4.606504843):2.127020838):1.310512451):0.06997693695,(((t196:2.602545862,(t197:0.565762028,t198:0.5145217286):1.88679353):7.414002329,((t199:0.1884823001,t200:0.08558458811):6.188855059,t201:6.242332238):3.407717976):1.216901207,(t202:7.949133514,(t203:1.293170578,(t204:0.4459936789,t205:0.4040398609):0.8366668063):6.616247476):2.674132392):2.940400113):1.60747841,((t207:2.310948315,(t208:0.9963418749,t209:0.9595870377):1.103786104):2.988978372,(t210:3.780103664,t211:3.773976427):0.883017161):9.604224346):2.099129126):0.4445302759):2.261198221):0.9542429726):3.947182205,((((((t212:10.65615204,((t213:1.888770011,(t214:0.8546923849,t215:0.831403178):1.007078393):0.9873353894,((t216:1.754955471,t217:1.741833773):0.3838801702,(t218:0.2048932908,t219:0.1577705553):1.918949969):0.6714839899):7.618429776):0.287317181,((t220:3.091869175,(t221:1.491373081,t222:1.124041955):1.506900652):4.66970555,((t223:1.382789603,(t224:0.1472271513,t225:0.1273977095):0.659151657):4.698347836,((t226:1.581923762,t227:1.434558426):0.5758683833,t228:1.918443176):3.267948462):1.058009327):2.726758444):0.6689825455,t229:9.375852616):1.056328004,((((t230:1.946359665,t231:1.915568305):1.042700544,t232:2.870259626):3.871118121,(t233:5.41073226,(t234:3.103989647,t235:3.022747935):2.260087137):1.310275018):2.073150717,t236:8.570852229):1.445939457):2.907942328,((((t237:2.204171866,t238:2.204080484):2.474353074,((t239:2.058734401,((t240:0.5001129001,t241:0.4518691903):0.5985831218,t242:0.4034337519):0.9489304319):2.083938894,((t243:2.207495595,(t244:0.4345282633,t245:0.1874020546):1.604998894):0.1901504452,(t246:1.241086453,t247:1.167846481):0.6081693703):1.006752867):0.5272706656):1.265491014,(t248:0.6977680858,t249:0.530322096):3.669283263):5.215457794,t250:9.334001265):1.605131668):7.538823362,(t251:6.947637118,((t252:0.7591432027,t253:0.6334372406):3.559297278,((t254:0.5700128416,t255:0.4660931273):2.759852745,((t257:1.846023886,t258:1.782373001):0.5867060295,t259:2.3298537):0.2072049334):0.6959722127):2.368797112):11.49509972):0.7328156633):0.9531790542):0.1193360755):15.06067936,((t260:5.214363746,(((t261:1.405941934,t262:1.403905685):2.072026494,(t263:1.903925049,t264:1.852026053):1.569021307):1.599803409,(t265:1.412401515,(t266:0.2046480491,t267:0.1402035463):1.197543411):3.59200108):0.01006715971):3.166735657,((t268:6.149186127,(t269:3.001720243,(t270:2.412139268,(t271:0.4392531177,t272:0.4169955005):1.960184359):0.5510620393):3.142438842):1.126885211,((t273:1.306950183,t274:1.180176005):2.163196004,((t275:1.7314364,t276:1.679658536):0.7031573236,(t277:0.609639344,t278:0.5002951684):1.758372672):0.849223481):3.455422887):0.7818373787):25.34245399):9.661180384,(((((((((((((t279:1.861880375,t280:1.798209649):4.459790106,t281:6.216120353):1.152779853,(t282:1.400010013,t283:1.196794999):5.929461476):4.60782241,((t284:5.71642593,(t285:4.349881657,t286:4.348910352):0.9694839902):1.59183397,(t287:0.1813416895,t288:0.1327428021):6.620361395):4.396518396):1.319268462,(((t289:1.876959429,t290:1.386853997):6.399389789,(((t291:0.27203415,t292:0.1678170841):3.715091142,t293:3.878275939):1.737582107,(((t294:1.675889476,(t295:1.205198207,(t296:0.1009860796,t297:0.0188761333):0.9966857724):0.4517573676):0.01272448332,t298:1.454796791):2.261620092,t299:3.659050527):1.377452918):2.010482988):1.220050721,((t300:3.272179952,t301:3.18727732):3.41119957,(((t302:1.324745256,(t303:0.45757711,t304:0.4508895094):0.7942425015):1.164278853,(t305:2.365585025,t306:2.333238946):0.02254061764):1.760637654,t307:4.007324204):2.276891992):1.556623514):2.944018863):0.1266655815,((t308:1.709467524,t309:1.578311385):3.84124619,((t310:2.600016983,((t311:0.3181605293,t312:0.172427618):1.974898103,(t313:0.688529833,t314:0.6693569149):1.451383185):0.3037790631):0.320761388,(t315:0.5247091899,t316:0.4949465651):2.211619382):2.429610326):5.313526598):2.821677329,(((t317:1.332854567,t318:1.224709612):1.01545121,t319:1.740049904):10.20160648,(((((t320:2.641997338,t321:2.639662201):1.791966876,t322:4.42164882):0.8639496422,(t323:3.059417088,(t324:2.098784564,t325:2.001708229):0.8828543759):2.220804901):4.339583684,(((t326:2.783175654,t327:2.551813902):4.933975311,(t328:3.149706115,(t329:3.020210676,t330:3.008279197):0.07027196357):4.170665338):1.120031686,(t331:6.945347071,(((t332:2.37630068,t333:2.294177784):3.585054325,(t334:4.73188453,t335:4.645411906):0.9923639345):0.539175994,t336:6.134869095):0.4213109084):1.395822567):0.530688685):1.768772192,t337:10.12640306):0.2248666868):0.6952925227):1.664909982,((((((t338:1.368884685,t339:1.013269532):0.3553747315,t340:1.233387151):0.2277612801,(t341:0.5314477823,t342:0.5228932878):0.9255710455):1.07154483,t343:2.511766884):1.632350916,(t344:3.419122394,(t345:0.6471557202,t346:0.3886658763):2.760302653):0.6787285905):5.287491238,(((((t347:3.048439688,t348:3.012241215):0.490272513,t349:3.38968665):2.066760561,(t350:1.065302039,(t351:0.186898075,t352:0.04196136718):0.7078274381):4.271479947):1.623005618,(t353:3.328152417,t354:3.299072668):3.307347301):1.389771898,t355:7.711414981):0.4357694304):2.648905324):1.742105281,((t356:7.307599176,((t357:4.300650474,(t358:2.289698365,t359:2.218039751):1.74212583):1.310610186,((t360:1.549565842,(t361:1.028173931,t362:0.9463223316):0.4352425734):1.083050281,t363:2.462786008):2.619369195):1.648290418):2.261085047,((((t364:0.4817155883,t365:0.4510098411):1.982519284,(t366:1.45459436,t367:1.394692974):0.9577366708):2.42827235,(t368:0.6748343055,(t369:0.4402077095,t370:0.3626109072):0.151714557):4.03355524):2.28510807,((t371:3.694744829,t372:3.39156905):0.874347091,(t376:2.65657294,t377:2.518413592):0.9292073309):2.139767732):1.711246827):2.814604339):0.1830883614,(t378:1.421509001,(t379:1.128883853,t380:1.047849882):0.2451366096):8.693750289):6.430462572,(t381:1.842751333,t382:1.806745386):14.53173922):7.788661662,((((((t383:7.144979681,t384:7.079284023):3.204260802,((t385:8.047254807,((t386:1.135665379,t387:0.8845023619):3.569812196,((t388:0.7107727372,t389:0.7018099327):3.629254029,t390:3.884219256):0.06274087786):3.307710692):2.024728461,((t391:5.895600574,(((((((t392:1.928883461,t393:1.80309084):0.008979098933,t395:1.588981212):1.133525669,(t396:2.421618492,t397:2.358314746):0.2343688522):0.4415479199,t398:3.01918938):0.527562768,t399:3.388648162):1.053009188,((t400:2.853545327,(t402:0.5869852784,t403:0.4945612512):1.819549177):0.7135308751,t404:3.023386541):0.695525662):0.1612012539,t405:3.739180955):0.25713282):2.957095935,(t406:3.699371052,t407:3.671466584):2.882610488):0.336515702):0.1617283345):0.3351583421,(t408:3.26082007,t409:3.204163605):4.119399465):0.7237599805,t410:7.909806344):7.888935959,(((t411:9.319444685,((((((t412:1.412105659,t413:1.410353611):1.734434386,t414:3.113839848):0.4567864887,(t415:2.361452178,t416:2.311265552):1.198565394):1.000018109,(t417:0.3020658352,t418:0.1964725073):4.026385324):1.726547497,t419:5.938976791):0.05512738749,t420:5.796421782):2.926141611):1.579742861,t421:10.2791376):3.814756982,((t422:1.21494338,t423:0.9556675):2.419714638,(t424:0.4717195957,t425:0.4171845542):2.786820908):10.2398806):1.011724298):1.6700592,(t426:1.959789931,(t427:0.3731129472,t428:0.3690232895):1.558071624):14.13223317):3.151793201):2.936007699,((t429:5.546805907,(t430:1.055986397,t431:1.022621165):4.425566845):3.526378323,(((t432:0.3584406734,t433:0.2316746045):4.840658475,((t434:3.836771058,t435:3.805691689):0.9041210685,(t436:0.4363656021,t437:0.2141399189):4.233118403):0.2180037135):1.860367859,((((t438:0.4608601076,(t439:0.09583973052,t440:0.06798750354):0.2128222756):1.581506492,(t441:0.5897604511,t442:0.04640696058):1.121227942):1.177303799,t443:1.924530018):0.1546214006,(t444:1.134397693,(t445:0.5566048845,t446:0.5527539342):0.5390813842):0.8536110965):3.056406956):1.801870864):13.05255769):5.250631953):1.350834637):11.2092836,(((((t447:0.8566958466,t450:0.5313906254):4.331261488,t451:4.765235725):3.811258964,(((t452:0.9102292266,(t453:0.5007623334,(t454:0.1347143348,t455:0.06815951878):0.3200201092):0.4058288803):4.061809802,t456:4.809649947):0.3055579728,t457:5.10362299):3.288805384):3.489493178,(t458:0.2415404762,t459:0.2331400551):11.52369272):3.099578412,((t460:1.003520104,t461:0.9441737034):6.218039662,t462:7.156310099):7.574284694):22.01718496):131.7372121);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T7.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
