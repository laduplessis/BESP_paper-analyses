<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t475:1.861553421,t476:1.807630178):1.466014737,t477:3.220625487):2.545695075,((t478:0.5804309813,t479:0.5208271966):0.9390455149,t480:1.226031612):4.241842326):1.971651777,t481:7.432713156):48.85963243,((t482:5.7467882,(((t483:0.4074064352,t484:0.3872130358):2.242509423,t485:2.598120242):2.414411514,(t486:4.025833144,t487:3.984139013):0.9832892251):0.5029981889):6.315056532,(t488:5.895533963,((t489:4.666338925,(t490:1.522429076,t491:1.413770643):2.922892465):0.8939816106,(t492:3.671023044,(t493:2.136803852,t494:2.091701327):1.285886506):1.534195219):0.2721019317):5.875669389):44.1737598):257.2272448,(((((t495:1.209720666,(t496:0.2110301657,t497:0.1566788019):0.9475125893):1.306115959,(t498:0.4760462067,(t499:0.1834974719,t500:0.1429707284):0.2832811942):1.825373836):37.31773797,((t501:1.386996923,(t502:0.1945898742,(((((((t228:0.02757597423,((t194:0.08300155732,((t170:0.04700779009,((t120:0.07903292604,(t114:0.0156711096,((((t1:6.479046095,(t2:1.930084603,t3:1.919755936):4.387426472):1.475725144,t4:7.773895014):0.7914333004,t5:8.562056045):0.3393885193,((((t6:3.673749569,t7:3.669632003):0.2676933528,t8:3.840268436):1.398826725,t9:5.201968547):3.081301482,(t10:3.5948159,t11:3.572374196):4.612554987):0.33586049):0.5160721874):0.5509342168):0.6242216304,((t12:5.699919398,((t13:4.478869258,(t14:3.937525367,((t15:1.819349771,t16:1.695287608):0.06362680311,((t17:0.6241240382,(t18:0.01870391983,t19:0.01068383454):0.5816688791):0.4480505343,t20:0.9489419262):0.5647991654):2.015693725):0.5135140662):0.159267893,t21:4.165235906):0.9694122717):1.6342042,(t22:3.193063567,t23:2.879179084):3.432467778):2.841057247):4.695247174):1.391528225,(t24:7.450888208,(((t25:2.298324713,t26:2.149017438):0.2525334024,t27:2.056251791):3.561641935,t28:5.574254391):1.133068072):7.778557424):0.6162457268):2.722462738,(((((t29:4.686871017,t30:4.591415073):1.641138664,(t31:2.768900632,t32:2.589176613):3.40012138):2.446219929,((t33:1.635794523,t34:1.534895981):3.245954001,t35:4.779212132):3.353996678):0.06606601253,t36:8.182922492):5.033180605,((((t37:1.712795475,(t38:1.123234516,(t39:0.9378488157,t40:0.8872438026):0.0462679717):0.546414937):3.727053624,((t41:2.37190772,(t42:1.477500265,t43:1.455038768):0.7392734636):2.620412199,((t44:0.7296818623,t45:0.6257350708):0.3133034755,t46:0.9113711435):3.709708078):0.0544312985):1.16123306,((t47:1.816840722,t48:1.782790381):0.2543524175,t49:2.034997386):3.734927048):1.237340947,(t50:1.034006122,t51:1.027935868):5.973056567):5.094815028):3.661094818):0.5581807064):1.839253715,((t52:1.529086766,t53:1.344121564):14.11369312,(((t54:1.836513101,t55:1.791500061):3.087832067,t56:4.839675908):5.514194686,(((t57:4.958880095,(t58:3.081759506,t59:3.06165269):1.856333547):2.540424877,(((t60:1.940280127,t61:1.933299445):0.6429972654,t62:2.481156017):3.547092762,(t63:1.210177385,t64:1.090115105):4.807022265):1.242727013):0.3450278334,(t65:2.715191706,t66:2.63269819):4.576303536):2.450601909):4.980517762):2.391390617):0.6307693393,(((((((t67:0.6677021382,(t68:0.2437743291,t69:0.2217924533):0.3096928754):9.357557655,(((t70:2.629686636,t71:2.522022832):5.241421921,(t72:5.590005577,((t73:0.9900287645,t74:0.9862871048):1.000544256,t75:1.86599902):3.569839431):2.000669657):1.446078129,(((t76:2.09987004,t77:1.936356612):4.12712266,((t78:1.48214329,t79:1.448915417):4.147667893,(t80:3.024641094,((t81:0.8750806261,t82:0.8515235131):0.04434834543,t83:0.8956147921):1.697944216):2.445017194):0.3918283263):0.87619215,((t84:0.8372091067,t85:0.8143189864):0.226906982,((t86:0.1511912089,t87:0.137080564):0.5243571085,t88:0.5365516762):0.139330131):5.179257282):1.705672533):0.510154534):1.029370343,((t89:3.903849274,(t90:3.387380623,t91:3.384005592):0.3279212119):4.171784309,(t92:7.531869686,((((t93:1.079682488,t94:1.076952456):3.451359195,(((t95:0.6374591286,t96:0.4666297789):1.738160175,(t97:2.129567538,t98:2.002898751):0.00157525697):0.3931110544,(t99:1.965625132,t100:1.911244126):0.3297176765):1.732507201):2.0295956,(t101:3.874625588,(t102:2.39298498,(t103:1.158671696,(t104:0.5431932061,(t105:0.366895473,t106:0.3145223538):0.00618355955):0.4953175025):1.203989186):1.463468402):2.090223636):0.5052458355,(t107:0.9211558944,t108:0.9161025181):4.864773032):0.4357058847):0.3419826583):0.9113509832):1.26707847,(t109:0.05749014956,t110:0.05650972114):8.630513129):0.9148054303,((((t111:0.9332634527,t112:0.8985785032):1.910798131,t113:2.796049716):2.45573846,(t115:0.2629404193,t116:0.1227264152):4.89799119):3.686463392,t117:8.570948443):0.3070452065):0.6701480508,(((t118:0.842353535,t119:0.7330078395):3.28980734,t121:3.81359997):2.183780473,((t122:2.882921328,(t123:0.8311132313,t124:0.7469647405):1.397185014):0.3151660672,t125:2.373379398):2.789338756):3.216037646):3.487065871,(((t126:3.116833566,((t127:1.0033788,t128:0.9572042276):0.8261217729,t129:1.743112259):1.101762524):4.458387545,t130:7.297239426):1.154884016,((t131:2.755205653,t132:2.534870523):0.7619588882,t133:3.185208532):4.669283606):3.040849798):0.2483056245):3.207637388,(((t134:3.610252807,(t135:1.142015082,t136:1.021311966):2.428236473):6.833201488,(t137:10.27199198,((t138:4.18025947,((t139:1.729849452,(t140:1.518493278,t141:1.166996428):0.1530313896):0.08695661115,t142:1.315415886):1.93320655):5.338941473,(((t143:2.20365609,t144:2.156996083):0.7222710319,(t145:2.100030862,(t146:0.9404322484,t147:0.7612232689):1.159577128):0.6737655899):2.66246928,(t148:2.824419112,t149:2.807394083):2.422391114):2.885572979):0.6739796279):0.009399645839):2.603802343,((t150:6.839003652,(t151:6.579603344,((t152:1.771875233,((t153:1.248154093,t154:1.154026065):0.2476052695,t155:1.331911102):0.2367997756):1.974662059,(t156:0.525678875,t157:0.5188163906):2.955117865):2.740378704):0.2224406786):0.4902841938,t158:6.845148798):4.046922546):1.171741909):14.39493868,(((((((((t159:0.731869293,t160:0.5368752783):0.438517722,t161:0.9573880995):2.706886237,((t162:1.35342738,t163:1.266958933):0.60485377,(t164:1.451526402,t165:1.29145681):0.3513340102):1.635807966):2.21717885,(((t166:2.104240628,(t167:1.31320353,((t168:0.2905955597,t169:0.2779857538):0.8649247078,t171:0.9978022983):0.1143187622):0.6973256646):0.9562779216,t172:2.753421989):0.6223830196,t173:3.365333716):1.687333286):4.408351419,(((t174:1.650049805,(t175:1.000720557,t176:0.8862903645):0.5735874071):0.9243101309,t177:2.278076506):3.744079869,((t178:3.13866033,(t179:0.356866244,t180:0.35145664):2.745843132):1.455696797,t181:4.359397715):1.263258626):3.135024619):5.635585205,((((t182:4.166735248,t183:3.936667745):0.8762050524,((t184:2.296158236,t185:2.049264964):2.381490721,(t186:4.045668718,(t187:1.736214778,(t188:0.8559319212,t189:0.8197717823):0.7146509078):2.189310069):0.2945409115):0.07738913845):4.146552761,t190:8.204358253):3.451998989,(((t191:7.157569357,(t192:1.268118644,t193:1.200963814):5.839331571):1.880545523,(((t195:5.195456247,(t196:0.9882522215,t197:0.8713467395):4.127077099):0.07784626374,(((t198:1.073420385,t199:1.004093186):1.598594979,t200:2.544968606):1.911717272,t201:4.390742112):0.4634113617):0.3661677274,(t202:3.787639803,((t203:0.5789369661,t204:0.4227235317):2.428422073,t205:2.832726097):0.5403242478):1.381260453):3.12974994):0.01322049184,t206:7.82387974):2.59291966):1.744875535):4.218473949,(((t207:5.190360592,t208:5.068431282):0.545689759,(((t209:2.243169489,t210:2.21727166):2.469232752,(t211:0.3726262644,t212:0.0648530287):4.108837376):0.06594011011,((t213:0.9972314953,t214:0.6302486655):2.028028397,(t215:1.915608554,t216:1.886402236):0.7125534216):1.204185277):0.8073273622):4.375866186,(t217:7.304630684,t218:7.270565852):1.566918798):6.240226436):1.493818442,((((t219:0.6429839378,t220:0.5353287739):4.687810366,t221:5.075178687):1.808305355,(((t222:3.029641389,((t223:0.6981790143,t224:0.488733203):1.557259666,t225:1.993589262):0.7504827802):0.1349602065,((t226:1.094755167,t227:0.895423994):1.371158166,t229:2.006748885):0.3542497475):3.236058321,(((t230:1.083978142,t231:0.9859716095):2.627470678,t232:3.577395861):1.682421651,t233:5.121727008):0.1959591705):0.3861320585):4.572031701,((t234:7.041484415,((t235:2.163411095,t236:2.033527169):0.206991233,(t237:0.2353895015,t238:0.110078294):1.71399453):4.666685959):2.447580598,(((t239:0.08420127288,t240:0.08024518129):0.2026386698,t241:0.2452809873):1.213147757,t242:1.357391536):6.970938608):0.6653245541):4.83177877):2.836097061,((t243:8.00506244,(t244:5.145764825,t245:5.092782932):2.846599095):6.029930997,(((t246:4.508645169,(t247:2.822232011,t248:2.790979167):1.434861652):4.083839123,((t249:7.082622795,(t250:5.664578902,t251:5.647276432):1.348306246):0.1350521467,(t252:6.254222091,t253:6.004401894):0.822684641):1.055212403):3.184107551,(t254:0.6920942154,t255:0.5683330607):10.36291116):2.091007399):2.578800907):1.653852706):4.291561124,(((((t256:1.546479763,t257:1.408493497):2.710194705,(t258:2.108130633,t259:1.941754906):1.933132456):3.441480567,(t260:2.129160504,t261:1.735842525):5.053054249):7.198420703,((t262:9.836049933,((t263:7.137491593,t264:7.056590329):1.90257259,t265:8.780515702):0.6571305835):1.143655254,((t266:7.917010224,t267:7.863584475):1.759688777,(((((t268:0.06079981744,t269:0.04467743391):0.04463718043,t270:0.04135178766):1.174342235,(t271:0.05416139571,t272:0.05377649685):1.117421452):0.7259437992,t273:1.498030483):0.005673409519,t274:1.366062144):7.522771418):0.8981676297):2.9066584):5.111293782,((((t275:12.33932923,(t276:9.210627885,t277:9.043350834):2.891596343):0.7661114792,(t278:10.83886944,((t279:0.7723442356,t280:0.5910611835):8.913250416,(t281:6.520592131,(((t282:4.010925026,((((t283:0.3990119695,t284:0.1124769136):0.6793691523,(t285:0.3603579162,t286:0.2955182583):0.2677144394):2.671403139,(t287:1.937175948,(t288:1.534977998,(t289:0.07435995627,t290:0.0217623907):1.363578271):0.3278281643):1.280098181):0.1801357966,(t291:2.018463569,t292:1.838679166):1.040121499):0.05846612486):1.309424446,((((t293:2.620285429,t294:2.546870765):0.1755773346,((((t295:1.89548956,t296:1.250041043):0.09483000898,(t297:0.0760606823,t298:0.04135304712):1.054729305):0.02657130058,t299:1.100054188):0.5362915213,((t300:0.07146258854,t301:0.01675776408):0.9660390795,(t302:0.05148265638,t303:0.006209275563):0.9262953071):0.4387491547):0.03938627915):0.2743509264,t304:1.613183063):0.909588195,t305:2.51502085):0.2243728182):0.6085199382,(t306:1.815830367,t307:1.723347061):1.467040616):0.5537210202):2.886701988):1.033468825):1.61387719):1.285615912,(t308:7.571144651,((((t309:0.2169994174,t310:0.1157072315):0.7881448859,t311:0.85350968):2.612626364,(t312:0.8941004508,t313:0.7383303017):2.542810383):0.4321542505,(t314:0.6571593644,(t315:0.4023827462,t316:0.3531288447):0.2443318598):3.043633601):3.041487713):2.964529051):2.076238473,(((((t317:2.073719976,t318:1.842926328):2.191752189,(t319:3.523835989,t320:3.48788592):0.3655605284):0.8962150349,((t321:0.4832668395,t322:0.4461148845):1.675152889,t323:2.066138689):2.44797798):0.7073761305,(t324:0.3538348259,t325:0.1911515126):4.857558808):0.9942233022,t326:6.005330281):4.53046904):1.288590617):1.530715125):2.413284861,((((t327:2.015593524,t328:1.863323335):4.237813546,(t329:5.722091572,(t330:1.046149272,t331:1.012143392):4.609627373):0.2639140624):3.924176654,((t332:4.954542776,((t333:1.977417209,t334:1.68399889):1.959165477,(t335:2.103970663,t336:2.077363083):1.47854381):0.9983416238):4.087968161,((((t337:1.217146244,t338:1.133303593):0.9111002432,t339:1.988925041):0.9563848135,(((t340:0.7159740259,t341:0.6469134954):0.8994193701,t342:1.42093415):0.08029662368,t343:1.476323181):1.236335022):0.5938488461,t344:3.288483546):4.931393498):0.7042005225):3.395258317,(t345:10.98149496,(((t346:6.49688846,(((t347:1.662258391,t348:1.616652685):3.607363147,t349:5.168996364):0.2877581316,(((t350:0.71396988,t351:0.5483704118):2.462677577,t352:2.663291207):0.7990466841,(t353:3.250734408,t354:3.217771399):0.1521916137):1.381181325):0.9037306165):2.945068176,t355:8.569458568):0.8983963418,(t356:4.479442722,((((t357:0.1970346278,t358:0.1372313943):1.076703833,t359:1.086163543):1.35068946,t360:2.277974559):1.226067601,((t361:2.660733687,t362:2.599089715):0.122000537,(t363:0.3708876705,t364:0.1885800775):2.229892287):0.6700545857):0.4956374749):4.972345524):0.5540510542):1.190584303):2.045966929):0.512510782):1.092397997):27.02932181,((((((t365:7.770325433,t366:7.703682976):5.92635439,(t367:10.97220971,(((((t368:3.38197036,t369:3.372175164):3.301778094,((t370:2.062279167,t371:1.914528539):1.668741814,(t372:0.9355381395,t373:0.88217057):2.646759022):2.920505528):1.391076027,(((t374:1.872801825,(t375:0.5073460995,t376:0.3835485031):1.112579898):1.261801764,t377:2.709839775):4.253202505,t378:6.85968025):0.0942359936):1.813986369,((t379:6.36186602,t380:6.346934238):1.532693536,((t381:0.7442034519,t382:0.4950608563):1.963449555,t383:2.409891868):5.110109595):0.819793963):0.7867119656,t384:9.091853744):0.2021799961):2.648105917):3.78358406,(((((t385:1.112890452,t386:1.069944439):1.163254271,t387:2.052063642):2.573496724,(t388:2.884336018,t389:2.832452091):1.666125135):1.292771104,(((t390:4.089127312,((t391:2.893824393,t392:2.876346319):0.0625438832,(t393:0.08123244666,t394:0.03407338117):2.833810812):1.102916053):0.7107405305,((t395:1.297115693,t396:1.252341451):1.877202476,t397:3.069776182):1.497886873):0.5800868606,(t398:2.823649347,t399:2.768755804):2.279336166):0.3514857466):3.705659083,((t400:1.85163974,t401:1.761921623):2.670888751,(t402:3.304937352,t403:3.235175409):0.8248419978):4.437930847):5.870704027):10.34099396,(((t404:2.174538939,t405:2.137213839):8.514941564,((t406:3.944593416,((t407:0.7085233132,t408:0.6113637962):2.261593473,((t409:1.267580528,t410:1.249150643):1.050291709,t411:2.128097262):0.5258816303):0.8648559384):0.04312785355,t412:3.331597692):6.656087458):9.165586703,((((t413:0.7201517685,t414:0.5934920637):1.368666407,t415:1.836448916):4.54042769,(t416:5.9146486,((t417:1.324424395,(t418:0.9826784621,t419:0.9412372549):0.3103734666):3.397563712,((t420:2.706793555,t421:2.674134276):0.141818114,t422:2.760766558):1.725272328):1.072613597):0.347033409):8.235367243,(((((t423:1.767781056,t424:1.75444248):5.278701832,((t425:2.398450775,(t426:0.9051722068,t427:0.8067781514):1.158991433):4.543303649,t428:6.401482758):0.05350868505):0.5477868741,t429:6.861564883):2.858239273,(((t430:0.3119565012,t431:0.2074877797):0.06481180651,t432:0.115608456):6.672236126,t433:6.696052496):2.603207739):0.398637836,((t434:5.034963863,t435:4.700892673):3.846703335,(t436:2.169471292,((t437:0.4393056231,t438:0.2336426862):1.38843584,(t439:1.085737603,t440:0.9861094215):0.4339345864):0.3173925227):6.175235153):0.7488963802):3.238537866):4.210521169):4.797391589):1.020472543,t441:21.81595219):0.5660888249,(t442:6.40314309,(t443:2.615486637,(((t444:0.2886665578,t445:0.04470249106):1.142832668,(t446:0.2859303385,t447:0.2669291297):0.801953176):0.9355959934,(t448:0.4495511979,t449:0.3778753422):1.54485615):0.1372258817):3.758410982):15.73445077):11.57264571):10.9115567):17.98834048,((((t450:1.340146757,t451:1.27890009):11.16875139,t452:12.43219958):2.393686583,(t453:2.221094365,t454:2.146995961):12.35108804):20.75259418,((t455:4.205334947,(t456:2.010387115,(t457:0.5278321513,t458:0.5061980033):1.43777925):2.142351369):9.844789997,(t459:7.357001724,(((t460:1.556033079,(t461:0.9541211426,t462:0.8639186928):0.5301676539):2.224891337,((t463:2.374164117,t464:1.733421854):0.4580024422,t465:2.165571424):0.4660159689):1.122223115,(t466:0.7225530467,t467:0.7008852426):2.865370882):2.4147379):6.56107059):21.0977719):26.25282523):153.0936284,((t468:7.658677481,(((t469:1.628311578,t470:1.53497473):1.173132129,t471:2.563088826):3.334708736,t472:5.85785422):1.385841995):0.7520552028,(t473:2.056264822,t474:2.036676475):5.902476292):204.5664294):101.5305968);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T89.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
