<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t472:2.140201403,t473:2.054180535):2.483805516,(t443:0.185423855,(t426:0.08060982544,(t411:0.09431750015,(t404:0.1773027122,(t402:0.05996904685,(t378:0.1080734597,(((t350:0.1241170186,(t337:0.02440655381,(((t223:0.3979600562,((t148:0.01774241252,(t125:0.5375727744,(t85:0.01182733399,(t37:0.04646507629,t1:4.310401461):4.386736574):5.035078269):1.947883332):7.049204161,(((((t2:3.589286423,t3:3.420324017):2.21631316,t4:5.621673082):9.854126184,((t5:6.99604938,(t6:1.082063729,t7:0.9344850105):5.892883792):0.8670414305,t8:7.691081802):7.35728698):0.788964909,((((((((t9:0.9377412732,t10:0.6702340405):4.496201872,t11:5.149313831):0.7046668059,t12:5.790421565):2.009998547,t13:7.768230505):1.632151021,t14:9.336634375):0.9445681544,(((t15:8.246944955,t16:8.041049224):0.05604794952,t17:8.006762931):1.164840763,((t18:1.061955912,(t19:0.9073141074,t20:0.7516414892):0.1126885912):1.496163463,(t21:2.329844684,(t22:1.448608407,t23:1.446851293):0.8513368977):0.01742657586):6.579102608):0.3867914378):1.301556606,(t24:6.559086172,(t25:0.7608617045,t26:0.6036457767):5.533507895):3.932315914):1.937757676,(((t27:0.9070716605,t28:0.3774608222):2.809659855,(t29:2.350635604,t30:2.3370829):0.8089433175):1.961334797,t31:4.979128188):6.246663996):1.689868784):4.585333746,((((t32:0.7401305315,t33:0.5311921876):4.971849212,t34:5.4716914):4.733595322,(((t35:0.6132604725,t36:0.5601113506):4.768736641,(t38:3.39795414,t39:3.28460042):1.482425663):0.7055606803,((((t40:1.427308495,t41:1.367469334):0.4759385849,t42:1.739944782):0.09897534052,(((t43:0.1480503769,t44:0.1185655853):0.2718151882,t45:0.328575094):0.1826774861,t46:0.4397796252):1.149881789):3.086689249,t47:4.318085614):0.3457336294):4.080243129):4.52037438,(((t48:5.602520061,(((t49:0.5112248573,t50:0.417328662):0.744336125,(t51:0.2539276158,t52:0.1452527217):0.8651382239):1.980824205,((t53:0.6090354273,t54:0.5555210278):2.052737154,t55:2.605742519):0.31745104):2.217043865):3.206381914,(((t56:0.9045531304,(t57:0.152566022,t58:0.1030317305):0.7078877644):2.963894507,t59:3.758412892):2.661074483,(((t60:2.51733009,(t61:0.1991158221,t62:0.1768501592):2.293340976):0.8042074284,((t63:0.5083695912,t64:0.4404487467):1.097973714,t65:1.416581805):1.627478971):0.9159894865,(t66:2.319789208,t67:2.132032813):1.62955796):2.14586395):1.807025075):3.285915986,(t68:1.446898994,t69:1.393866912):9.460868481):0.8928872786):2.443215046):1.563759311):0.7844204565):0.58466598,((t70:3.900976813,((t71:1.001050948,t72:0.9768811376):2.390496495,((t73:1.633849065,t74:1.572340216):0.121331599,t75:1.632802551):1.128414643):0.2323453347):7.440320567,((t76:1.777595498,(t77:1.222362903,t78:1.161922485):0.5527222059):7.072385213,(((((t79:0.8015768758,t80:0.7926158977):0.1939476448,(t81:0.5676660234,t82:0.4747978723):0.3287776105):1.706534,t83:2.508281565):2.659633366,t84:5.114347909):0.7505443656,(((t86:0.6680797271,t87:0.5321178159):1.211101192,t88:1.66888393):0.6190230322,(t89:1.614560755,t90:1.564027204):0.6529431249):3.125618671):2.630734235):1.474965314):5.638218499):4.901246857,((((((t91:5.28140748,((t92:0.7339808502,t93:0.6854023634):1.59188144,t94:2.204732026):2.824641512):1.215977413,t95:6.05861364):1.247301405,(t96:0.7319636763,t97:0.6078539573):6.540883795):2.379412695,t98:9.522531443):3.061242489,(((((t99:0.499204592,t100:0.4848909333):5.453848869,((t101:3.084471697,(t102:1.26433873,t103:1.223982758):1.501237427):2.510600092,(((t104:0.5789837261,t105:0.4603068369):2.493096086,t106:2.943542816):0.3706449299,t107:3.195471403):1.589338843):0.1875013084):1.480001258,(t108:1.43545366,t109:1.262217246):4.907236624):0.5650156186,(((t110:0.4970341044,t111:0.1791586926):0.03643569665,t112:0.1475035797):2.871622733,((t113:1.768912976,t114:1.561782565):0.6377714049,t115:2.191728568):0.5563977595):3.303491599):0.1606568723,(t116:4.307252286,(t117:3.249733573,((t118:0.9226132247,(t119:0.6782105224,t120:0.5207749599):0.1316459429):1.51906156,t121:1.848750184):0.7590185358):1.052810894):1.741616028):4.295714441):5.014975284,((t122:2.533511736,t123:2.489109582):5.592143285,((t124:0.9867560319,t126:0.2466613008):3.504186172,((t127:1.513352831,t128:1.42891083):1.236694335,(t129:1.649357345,t130:1.485356297):0.9817991858):0.8761133081):3.447546037):6.349204838):1.668806445):4.228297209):0.6612197383):0.6019279931,(((((((t131:1.214527391,t132:1.19257397):3.513396978,t133:4.682137706):0.6891750005,(t134:1.715923071,t135:1.642827078):3.414538501):4.642182104,((t136:1.805553294,(t137:0.5856131567,t138:0.5073808981):1.063137234):3.231977361,(((t139:3.164685052,t140:3.150663809):0.3070646441,(t141:1.656940137,(t142:0.1558990155,t143:0.1445170932):1.426700564):1.672481164):1.239547786,(t144:1.604992336,t145:1.505193933):2.854198384):0.02355619488):4.629125061):2.795560536,((((t146:1.264751718,t147:1.164018449):4.730429849,((t149:0.4112549207,t150:0.3249903295):4.258612862,(((t151:0.7065937205,t152:0.6219091958):2.927537219,(t153:3.414946287,(t154:2.988127838,t155:2.987472412):0.3597236796):0.1070849045):0.4601142853,t156:3.766125116):0.4505187604):1.043583313):2.039702826,((t157:4.47283652,t158:4.368618405):2.006194217,(t159:0.398336538,t160:0.3398123592):5.584167222):0.672236875):1.559121089,((t161:4.205423741,(t162:3.645938385,((t163:2.698890164,t164:2.614411581):0.4633106116,t165:3.015526138):0.3292581775):0.5160159287):3.363790461,t166:7.177933666):0.5634165361):2.191968768):0.4348747367,((t167:5.312383563,(t168:4.440474249,t169:4.380687189):0.7666953246):3.015374715,(t170:2.564057734,(t171:0.5988063915,t172:0.5752111078):1.840774187):5.585771521):1.941879579):0.5928252229,(((t173:4.738460492,t174:4.505140326):2.050272518,t175:6.545447323):1.339549697,t176:7.832514614):2.337683629):6.247905909):2.930181447,((((((((t177:2.969064191,(t178:2.293047981,(t179:1.351099725,t180:1.341894808):0.9362960152):0.6265956883):2.363425465,(t181:4.643434807,t182:4.445095374):0.5185215505):0.4926670447,((t183:2.315033236,(t184:0.4637074226,t185:0.3970696691):1.649484484):1.578812139,(t186:2.136750593,(t187:1.637427986,t188:1.542800346):0.364230739):1.435636122):1.507292315):1.291608019,((t189:0.4210342918,(t190:0.1413584529,t191:0.07678032442):0.2773891262):0.8530954444,t192:1.02998089):4.681116635):3.631076415,((t193:4.458284315,((t194:2.291417641,t195:2.142731333):0.9803749013,t196:2.983601087):1.129105815):2.344185482,t197:6.453225567):2.47841393):2.39620807,(((t198:1.724433439,(t199:0.5139132799,t200:0.4699059869):1.190419197):7.78710672,(((t201:1.516005803,(t202:0.5095451249,t203:0.4474191399):0.8901746778):4.589482714,((t204:0.4643865059,t205:0.4189456458):0.2824233127,t206:0.6857225949):5.160881646):2.905974602,((t207:0.7149598527,t208:0.702725583):3.94248257,((t209:2.861834904,t210:2.859941587):1.742551331,(t211:0.659907917,t212:0.3693339368):3.942277142):0.0153235634):4.033447524):0.3916034409):1.297162377,((t213:2.061653861,t214:1.928972072):3.606922486,(t215:4.855014813,(((t216:0.1659006083,t217:0.07729094036):0.673254023,(t218:0.5033600861,t219:0.4752493202):0.1643179558):2.315709411,(t220:1.795833549,t221:1.743360324):0.1655551795):1.618219562):0.4460322408):4.234051368):0.4578561111):2.450999092,(((t222:5.830219464,(((t224:3.748266792,((t225:0.4231320789,t226:0.4158398325):2.998450858,((t227:1.695564232,t228:1.578860331):1.091712188,(t229:0.3750049649,t230:0.326350275):2.266695995):0.3011820416):0.2192959724):0.6481403286,((t231:0.9463210861,t232:0.9434599896):2.116682656,t233:3.018654089):0.6126117577):0.3974967074,((t234:0.4784583996,t235:0.4070094924):1.219022748,t236:1.584467733):2.247406143):0.412076199):0.242181799,t237:4.225605698):2.85712779,((t238:0.9261633567,t239:0.7037801667):5.855650377,t240:6.511979922):0.175764158):1.983339611):1.927391945,(((t241:2.192133267,t242:2.178084388):3.097622682,(t243:0.8724617003,t244:0.8537368708):4.400311688):2.673533958,(t245:0.6521041488,t246:0.4229313514):7.182065461):2.614480455):1.683667922):0.3333480556):3.072130065):0.3856596224):0.7049442269):1.731232243):1.647253337):7.110003241):51.18934787,((((((((t247:2.943314783,t248:2.87725704):7.525122408,(t249:3.189098021,t250:3.182170358):7.136976946):6.511119276,((t251:5.351027424,t252:5.34878365):7.998742056,((t253:0.5028885062,t254:0.4264880023):6.201585091,t255:6.626737045):6.625647355):3.40079931):0.8574734599,(((((t256:10.12398466,((t257:0.3595283274,t258:0.251764692):1.131845692,t259:1.262980416):8.399950197):1.062112006,t260:10.59675068):0.5815813678,(t261:4.293697809,(t262:2.849152772,(t263:1.165005259,t264:1.075059348):1.662392183):1.093533087):6.823644079):2.454215383,((((t265:2.790660004,(t266:1.253955119,t267:1.148157847):1.535391472):2.392744671,t268:5.055478111):1.395922277,(t269:4.582196966,(t270:1.499421163,t271:1.333026683):2.960689755):1.701931392):4.780678974,(((t272:0.7372897534,t273:0.6768328609):3.988914803,(t274:2.215951538,t275:2.155931906):2.410127258):0.9941341974,(t276:2.912912647,(t277:2.080478052,t278:2.043900201):0.7823067731):2.569510835):5.028106223):1.73061099):2.448621396,(((t279:3.982483722,t280:3.950354659):0.7173190986,((t281:2.197050646,(t282:1.096018737,t283:1.074801736):1.086301817):1.50715998,t284:3.520762942):0.9126698353):4.534533358,((t285:1.881225758,t286:1.806447837):6.47636743,((t287:0.5169744025,t288:0.478247742):2.486518566,(t289:1.996683985,((t290:0.7491572824,t291:0.6140083269):0.6395951199,t292:1.156076045):0.6060921484):0.9350693811):5.268044676):0.5676480792):5.217247837):0.8102673123):3.473819328,(((t293:0.1544470374,t294:0.06153261585):14.88899007,(((((t295:2.363232539,(t296:0.569384817,t297:0.5467888759):1.746252817):2.641475946,(t298:2.79158132,(t299:0.9863578652,(t300:0.384599234,t301:0.2888884893):0.3638174514):1.640994599):2.132917548):1.083217892,t302:5.37203475):1.383140045,(((t303:0.5276078152,(t304:0.3240820036,t305:0.197197349):0.08471315603):3.903119972,(t306:2.737660436,((t307:1.507393127,t308:1.495477932):1.151403939,(t309:0.6704508431,t310:0.6231075699):1.861050284):0.03111661086):1.445369863):1.377638582,(t311:4.347944021,(t312:2.895074911,((t313:1.521128627,t314:1.480937267):0.1309324468,((t315:0.4735910801,t316:0.386716509):0.2007295509,(t317:0.5196007044,t318:0.4769596748):0.0508422765):0.7712996797):1.167930314):1.226985865):0.8895581052):0.8588293977):5.282408779,(((t319:0.2580089719,t320:0.2089662185):2.074311036,t321:2.141140282):6.409292758,(t322:5.875647758,((t323:1.173301944,(t324:0.889698616,t325:0.8449684165):0.2141258409):2.46741212,t326:3.490906462):2.036262025):2.502813058):1.849835):2.099637588):1.465132386,(t327:7.620851803,(((((t328:0.04659950737,t329:0.02018420262):0.2506535249,t330:0.1207092838):4.605414246,(t331:1.287083855,t332:1.157071382):3.296263439):0.1512171284,t333:4.487063987):1.393503923,(t334:5.602878582,((t335:1.543907397,(t336:0.4126582459,(t338:0.2247640284,t339:0.1978849218):0.0894099779):0.9692692025):0.7102258698,(t340:0.7671548951,t341:0.7379301045):1.173595038):3.270323228):0.2309681022):1.10315171):5.753566804):1.448447636):17.7234155,((t342:1.122523367,t343:1.060698725):26.14955326,((((((t344:5.368023164,t345:5.312771491):1.308555193,(((t346:0.5917036672,t347:0.5542290377):1.910406133,(t348:0.143037685,t349:0.1391920073):2.308725056):0.7988919939,t351:2.853537448):3.291056671):1.533013448,((t352:2.857281542,t353:2.759007638):0.9206786366,(t354:0.4997060585,t355:0.3037669251):2.987260075):3.87487619):3.832580947,(t356:0.9047795113,t357:0.7178792825):10.05124742):3.552275399,((t358:8.19086144,(t359:2.756170915,((t360:0.3489174086,t361:0.08998358081):1.33810523,t362:1.341840503):1.062126978):5.369501164):5.901647368,(((t363:1.410830829,t364:1.369009131):0.5914774996,t365:1.953106328):3.148299361,((t366:0.4834858437,t367:0.4544602001):2.102436571,((t368:0.9934366544,t369:0.718881077):0.2340235078,t370:0.7374761062):1.129392154):2.481202736):8.504867241):0.09152293524):10.44729128,(((t371:5.659848291,((t372:0.335383794,t373:0.09166396759):1.933003763,((t374:1.468238267,t375:1.266136601):0.09709310269,t376:1.320710788):0.3123660879):3.314606279):7.548083591,(((t377:10.03618121,(((t379:3.915389147,(t380:3.612921059,((t381:0.5049123259,t382:0.4395930858):2.852026542,(t383:1.287370011,t384:1.286948074):1.753473657):0.2317008805):0.1246711427):2.005661572,t385:5.198501326):3.337005686,(t386:5.612477305,(((t387:3.271032589,t388:3.086771652):0.9927106352,(t389:2.882331093,t390:2.806513605):0.9799189291):0.2794640015,t391:3.953758359):1.046934541):2.6259272):0.495079308):0.9462664979,(((((t392:1.160647407,t393:0.9880465951):2.031490533,t394:2.774139009):0.9068599975,t395:3.613432176):0.7980661472,(t396:4.053350933,t397:3.994885387):0.2718459366):1.554402918,(t398:3.594387978,t399:3.56387121):1.987611237):2.520199701):1.256174716,((t400:0.8411560431,(t401:0.5538486325,t403:0.4122776379):0.1385038496):2.027954516,((t405:0.1367544971,t406:0.08472606596):0.7969937583,t407:0.7201793388):1.23942243):6.301907435):7.927891712e-05):6.096926966,((((t408:0.9457630851,(t409:0.665934163,t410:0.5399248063):0.2612104646):0.07509217049,t412:0.5165355188):6.304319912,(t413:3.64323555,(t414:2.863719324,t415:2.844568834):0.7616409932):3.109103177):0.1977174336,(((t416:1.17961826,t417:1.106175002):3.141867047,(t418:4.093185682,(t419:2.911447992,t420:2.873238616):1.122133818):0.1155018091):0.932936037,((t421:1.6806418,t422:1.028455552):0.7634509442,t423:1.628883627):2.500334387):1.552475925):6.736652707):3.775464593):1.044342047):4.144475381):13.92635097,(((t424:1.185113171,t425:1.160593481):1.942721385,t427:2.766125215):11.63565556,((((t428:4.87201243,t429:4.863721878):0.6352524472,t430:5.44233047):0.7763758934,t431:6.122309842):2.630310998,((((t432:1.372880293,t433:1.266453646):4.44621866,(t434:3.381999097,t435:3.315524584):2.286082475):0.9729761927,t436:6.55923438):0.64597208,t437:6.924505858):1.251251554):5.315404793):20.41142781):3.166198331,(((((t438:4.059549901,(t439:1.246890206,t440:1.226281645):2.796520074):1.850886021,(t441:3.257497455,t442:3.247834101):2.543379134):0.9758676937,t444:6.496098595):2.131506388,((t445:2.139869038,t446:2.070996264):2.345610678,(t447:1.305559538,t448:0.8298833474):3.047487651):4.096350606):21.65683793,((t449:3.264059615,t450:3.238545089):4.720686923,t451:7.942567579):21.45007882):6.281788099):21.72929429):37.72713837,((((t452:9.56888453,(t453:7.844956875,t454:7.781980069):1.652806618):1.619246051,(((t455:4.640553544,t456:4.609197997):4.161851785,t457:8.657729873):1.927559207,((t458:3.494895164,t459:3.439678856):0.3567522744,t460:3.670996369):6.663711468):0.2894540205):0.3940486887,t461:11.01501261):7.095714318,((t462:5.938423087,(((t463:1.337796188,t464:1.125523947):0.9005507183,t465:2.012309227):2.946090382,t466:4.939194506):0.7155484957):2.746503022,(((t467:0.9091557722,t468:0.759819531):1.843628512,t469:2.522173294):0.9833339827,(t470:0.1364287976,t471:0.06255210701):3.338310482):4.486048484):9.398766404):76.26645585);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T82.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
