<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((((t505:0.67284546,t506:0.5438808468):0.3400842022,t507:0.8126783707):1.34226725,(((t435:0.01462104776,(t388:0.02321030418,(t373:0.1476726956,(t338:0.1171502697,((((t288:0.0714723585,(t271:0.09703998499,((((t243:0.07162563072,(((((t63:0.1235864258,t1:6.749307019):1.654265501,t2:8.384746762):1.308602181,(((t3:2.000978972,t4:1.667020829):1.94273724,t5:3.572151017):3.373206495,(t6:2.11568645,t7:1.957741266):4.777767711):2.103781421):3.648261848,((((t8:1.957488174,t9:1.832454474):2.18180765,((t10:0.4768477023,t11:0.349326199):2.24183373,t12:2.510846274):1.243916324):7.13221506,((t13:4.237889911,(t14:2.729305955,(t15:2.719405264,t16:2.670190371):0.003399248058):1.415506472):0.2210113708,t17:4.239642877):6.407398025):0.8598274663,(t18:7.153280117,(((t19:1.240317327,t20:1.184348786):0.438222734,t21:1.39966584):4.979564118,(t22:4.326663346,(t23:1.985654871,t24:1.911691714):2.330202783):2.04089708):0.3050865673):4.334914275):0.1527641238):4.134279092,(((t25:3.161894534,(t26:1.307280579,t27:1.29181516):1.653525426):1.683280499,((t28:2.137801279,t29:2.027526741):2.1335273,(t30:0.6599141647,t31:0.5780222722):3.406453485):0.2593021885):0.5998119666,((t32:0.6709443303,t33:0.645155632):2.969605524,t34:3.572656542):1.095370242):9.559334242):4.38638568):0.3386105363,((t35:3.383196614,(t36:1.06761454,t37:0.9466715537):2.313225524):7.275026397,t38:10.45769189):8.08772407):2.016467787,((((t39:1.711034402,t40:1.384078843):0.8686051615,t41:2.210738808):13.76805623,((((((t42:1.597563043,t43:1.335231846):2.696216423,(t44:1.869506495,(t45:0.1947078818,t46:0.08588924324):1.3370516):1.909987849):1.945510161,((t47:1.706809461,t48:1.508881305):1.646189965,t49:3.091551371):1.907368241):6.821504695,(((t50:6.023285739,(((t51:3.843281073,t52:3.589820223):0.4752237907,t53:4.033612743):0.1255432446,t54:4.132797662):1.568921291):1.411040516,(t55:3.188527492,((t56:0.4147549644,t57:0.3398646871):0.0960151644,t58:0.4123190406):2.672654576):3.817075528):1.127486243,((((t59:1.265647099,((t60:0.9487488539,t61:0.9248293787):0.2214580484,t62:0.9936055385):0.07667895274):4.360636378,t64:4.941521731):1.766762074,t65:6.698543435):0.144205549,(t66:0.8364268778,t67:0.730666799):5.990847519):0.3068486834):3.223057622):0.9964160334,t68:11.02632398):0.5772414031,((((t69:0.6673700178,t70:0.5318188408):3.657880187,t71:4.149997595):1.775830417,(t72:5.36925475,((t73:2.252198786,(t74:1.29683273,t75:1.25115033):0.8570253911):0.1771905557,t76:2.250911208):2.84950977):0.4704953135):4.719637846,((((t77:3.260389062,(t78:0.3955672437,(t79:0.2160748284,t80:0.1920811742):0.1635130094):2.752708451):0.8985271357,(t81:0.5778802505,t82:0.5155292715):3.327519743):0.3987022653,t83:4.210341221):0.3139476042,((t84:0.1684181695,t85:0.1386349104):1.722726772,((t86:0.0922687005,t87:0.075527475):1.752377141,t88:1.702629028):0.004954089399):2.58240845):5.391013949):0.738554888):1.220514518):2.30179088,((((t89:0.7401672393,t90:0.6624027994):5.469997343,(t91:1.260797875,(t92:1.017253764,t93:0.9172975066):0.189200024):4.624646492):2.437847349,(((t94:1.88817774,(t95:0.2837695132,t96:0.2048810275):1.51638848):3.887061213,(t97:4.822541752,((t98:2.398166278,(t99:0.9511291291,(t100:0.4141928159,t101:0.4077941586):0.5148579686):1.299882144):2.100932799,((t102:0.8113402442,t103:0.7875659617):0.5920536172,t104:1.328784022):2.889554449):0.3187539639):0.6986690524):0.4938126417,((t105:1.992134557,t106:1.934215358):2.025764497,t107:3.938977906):1.689039776):1.826494497):4.79283936,(((t108:0.9224881846,t109:0.8406023979):1.082011777,t110:1.908705699):4.349748727,((t111:1.060133375,t112:1.010583033):3.55580518,(t113:2.006105864,(t114:1.546788204,(t115:0.1805507591,t116:0.1793473124):1.325959501):0.4263238399):2.300671007):1.581582341):5.806003539):0.4972918275):1.824902445):0.2234338371,((t117:11.96247177,(((t118:4.12263844,t119:4.078402049):1.830131075,((t120:2.343233232,(t121:1.559410372,(t122:0.2745845666,t123:0.2455009771):1.24115983):0.3993172987):3.041920131,t124:4.854869062):0.5132855299):5.095179765,(((t125:0.5758732332,t126:0.5226245493):1.623933963,t127:2.108240474):7.372086639,t128:9.39874293):0.8569933889):0.6664440796):1.297081849,(((t129:8.683196143,(((t130:3.779945423,t131:3.727489577):0.7293011693,t132:4.446488001):0.4050107082,t133:4.704945428):3.602013615):1.525404127,((t134:1.031223403,t135:0.8322768482):0.906272209,t136:1.724673833):7.817617251):0.5022557422,(t137:3.37906309,t138:3.036467939):6.577257547):1.394399038):0.722418878):0.5191142901):2.133109933):1.915841793,((((((t139:3.0141876,t140:2.811227844):5.188398047,(t141:0.9264498345,t142:0.8666667637):7.019930454):4.174170378,((((t143:1.637665746,t144:1.553222225):6.355841966,(t145:3.211507366,(t146:2.150242945,t147:1.981546655):0.707175255):4.581393503):0.0351066258,(((t148:3.395794842,t149:3.387906348):0.4532784891,t150:3.611741568):0.9049464212,t151:4.499602318):2.446822461):0.1272416378,((t152:0.8711046069,(t153:0.09521313354,t154:0.07278235785):0.71279169):0.6983115091,t155:1.472179413):5.442566828):3.883376799):0.7990458921,(t156:8.255893478,(((t157:3.845102073,(t158:1.239380992,t159:1.179274098):2.578783074):0.2188136935,((t160:0.5647535981,t161:0.5642146808):0.4986207948,(t162:0.8587380602,t163:0.8133898146):0.1630324773):2.646326065):2.357985594,(t164:3.871665793,(t165:2.39856787,t166:2.396771157):1.298333091):2.054764759):1.825163377):3.305554744):0.2867322535,((((t167:3.392257113,(t168:3.230731829,((((t169:0.4104161059,t170:0.3396457012):1.26983906,t171:1.532957014):0.7718359966,t172:2.117321176):0.3878180674,t173:2.261439582):0.2934184469):0.159224694):0.3119606403,((t174:2.133099126,(t175:1.316697489,t176:1.281926933):0.7748680693):0.05670559115,t177:2.050102569):0.7474207936):4.89874843,(t178:5.944478175,(((t179:0.9289965237,t180:0.8930021043):1.156737941,(t181:1.7926067,t182:1.755140458):0.2172032808):0.9668572663,t183:2.904316117):2.552717119):1.640455824):0.6362230612,(t184:5.716580994,(t185:2.011369626,(t186:1.336515651,t187:1.227212179):0.2188604797):3.586370708):1.937311699):1.910819046):0.9424264283,((((((t188:0.1233589672,t189:0.1229493199):2.174290763,t190:2.284886381):0.8271841999,t191:2.917433456):3.17993955,((t192:0.8983058952,t193:0.8483007932):1.703547111,(t194:1.099902724,t195:1.073062339):1.361726122):3.28720375):0.7433088648,((t196:3.984608852,t197:3.849176701):0.922010601,t198:4.718681773):1.31032816):0.5715360648,(t199:0.4701066159,t200:0.4210264816):6.090368298):2.156256633):1.818326176):0.2126075745,(t201:3.748354452,t202:3.565488121):6.837323643):0.6743997125,(t203:10.19204065,(t204:0.1799746355,t205:0.1785073046):9.919523775):0.8052698929):1.744378154):2.868622783):2.241579791):4.041762238):0.9650862238,((((t206:1.038990648,(t207:0.1596906634,t208:0.02304159077):0.8738369209):3.358498756,(((t209:0.3686952061,t210:0.3362747357):1.959639956,t211:2.221752374):1.16621205,((t212:1.666464564,t213:1.543839291):1.123546416,(((t214:1.324276082,t215:1.320667077):0.8325446679,t216:2.141612449):0.5035235504,(t217:1.231179878,t218:1.19556773):1.240830929):0.0004026361338):0.5917010005):0.5586175639):1.324963194,((t219:0.2848350531,t220:0.2797102532):4.358808596,t221:4.62748007):0.04397788433):8.87611923,((((t222:1.875025458,(t223:0.8543242899,t224:0.8524639968):0.7628427606):0.5455688099,(t225:1.102289754,t226:1.030869278):0.956058938):0.6688380876,t227:2.654116231):2.748579915,(((t228:3.353161587,t229:3.30398582):1.472780544,((((t230:2.758779562,(t231:0.5181269993,t232:0.431592021):2.128629652):1.538325642,t233:3.999915935):0.1119381271,t234:3.961453247):0.1791546075,t235:4.110397306):0.09543867849):0.3063419005,(t236:3.575941435,t237:3.551951158):0.9113147365):0.09965888453):7.690975793):8.067760606):0.007209941068,(((((t238:0.3357976672,t239:0.3323948189):1.855679702,t240:2.178859524):3.030148776,((t241:0.7191880094,t242:0.5635572546):1.654204002,((t244:0.8902098897,(t245:0.2187808615,t246:0.09966070089):0.6476880456):0.07204437158,t247:0.7999339822):1.07159931):2.707463813):1.592416416,(t248:1.431098754,t249:1.087889851):4.415030174):1.837299294,t250:7.284497774):11.62270855):8.279180199):0.8296967717,(((((t251:6.683697991,(t252:5.286412644,(((t253:0.3610298107,t254:0.1075331778):3.395164732,t255:3.367406097):1.222607386,t256:4.577561232):0.235621141):1.350965924):3.435838213,(((t257:2.95481051,t258:2.73803544):1.571626359,t259:4.178690943):4.391465084,(t260:5.085727196,t261:5.084351041):3.481532123):0.5172437008):13.61189062,(((((t262:0.9725037408,t263:0.8862041505):1.126350865,(t264:1.800439858,t265:1.775032729):0.1189311246):5.408674559,((((t266:0.7826213493,t267:0.7535490642):0.5043577632,t268:1.128101509):1.325331391,t269:2.381509626):3.681885936,t270:6.004820718):0.8156249852):3.173929911,((((((t272:1.352303652,t273:1.328658449):1.05873409,t274:2.222568127):2.825556776,(t275:3.305659047,(t276:0.539615233,t277:0.508102445):2.714788431):1.711811436):1.45709305,t278:6.302661055):0.4964291073,(t279:2.8879576,(t280:1.732288894,t281:1.715682099):1.100294302):3.596025001):0.1872816152,(((t282:0.962110185,t283:0.6092596762):1.737657832,(t284:0.8583645864,t285:0.8582407829):1.111298876):0.8812687672,((t286:0.9681447886,(t287:0.2924043797,t289:0.04225825057):0.630897809):0.6122469406,t290:0.9479742585):0.9048953075):2.987325521):2.235017134):3.047532319,(((t291:2.524889757,t292:2.506469552):3.560663702,(t293:1.695155158,((t294:0.7287108565,t295:0.7278508262):0.7082597272,t296:1.43302385):0.2567530905):4.337643575):3.368538984,(((((t297:1.373108865,t298:1.273006759):5.953564411,((t299:4.083683053,(t300:1.081625659,t301:0.9934732065):2.945338522):1.787071191,(((t302:1.629340276,t303:1.545701387):1.088447994,t304:2.602179295):0.5874731207,t305:3.14577776):2.409783992):1.337550958):0.03629922697,((t306:0.1970449776,t307:0.1404689975):0.0982350158,t308:0.1981157168):6.608401996):0.512827803,((t309:1.081296051,t310:1.069872862):1.334656492,t311:2.154287042):4.77694734):0.610951724,t312:7.434649021):0.9010247768):0.553433551):8.948436848):0.3381612768,(((t313:1.658192518,t314:1.627656414):7.199666073,(((t315:0.131315339,t316:0.05854958446):0.5106830363,t317:0.5689267358):0.3738583888,t318:0.918231245):7.679493352):2.262384736,(t319:0.6289084603,t320:0.420328684):10.15841654):6.769817206):1.161623261,(((t321:6.20306795,((t322:0.8947990701,t323:0.8549348248):1.141109569,t324:1.956515469):4.103632289):0.4068730423,t325:6.440956038):1.932737011,((((((t326:0.8919712758,t327:0.6805855345):1.262116665,t328:1.920085775):1.131605135,(t329:0.5692002829,(t330:0.3982096477,t331:0.3847595583):0.06947062304):2.304781198):0.8290836035,t332:3.438871987):0.2198460802,(t333:1.60412207,t334:1.561082228):1.812188179):0.2579278676,(t335:1.956127957,t336:1.799104719):1.661579975):3.63578336):9.920103762):2.76184905):16.96620702,(((((((((t337:0.9622830826,t339:0.5846841483):2.948195023,((t340:1.353791413,t341:1.309727701):0.5970540007,t342:1.899254276):1.510861285):3.814906942,(((t343:3.391348062,t344:3.324202674):0.8932364666,t345:4.200197382):0.6990712469,((t346:2.258323644,(t347:2.034698246,t348:1.837790001):0.1344234957):0.8405640123,((t349:0.713994391,t350:0.5631829795):1.576049488,t351:1.959546587):0.4045856616):1.781932746):2.236864527):0.5924947327,t352:6.829267298):5.424445307,(((((t353:0.3985830051,t354:0.36993476):2.84195513,t355:3.160083733):0.998515649,t356:4.144500834):0.7003618449,t357:4.79895837):5.713406722,(((t358:2.923366813,t359:2.873787702):0.02868073136,t360:2.837653792):2.38767746,((t361:1.450238132,t362:1.34944811):1.646946359,t363:2.868123157):1.961096557):5.107750271):1.586542271):0.05616806098,((((t364:1.192207841,t365:1.127652013):1.964436191,(t366:2.627657384,t367:2.627151293):0.3553223418):5.796837047,t368:8.765534596):0.8497257571,(t369:4.928274019,t370:4.839255288):4.666439864):1.696190053):7.243236616,(((((t371:5.412629772,t372:5.318415292):1.442684902,t374:6.264730488):2.141849227,((t375:0.2502102537,t376:0.1023243561):7.609516653,((t377:2.645009948,(t378:2.346982548,t379:2.308465844):0.2376519694):0.9225195124,((t380:0.4784190772,t381:0.1913144757):1.881548886,(((t382:0.791584332,t383:0.2425874872):0.5204949217,t384:0.746884042):0.3677694012,((t385:0.5307132742,t386:0.3796365676):0.42081498,t387:0.7836285861):0.0882313772):0.3450460262):1.106099193):3.991200107):0.3291906402):1.27833152,(t389:3.085575916,((t390:1.062148145,t391:0.9880809174):1.093269399,t392:2.028306429):0.7697392175):4.365808873):2.512700853,(((t393:1.643776459,(t394:0.6370147869,t395:0.6118941565):1.000070074):2.124589109,t396:3.719325698):3.69522344,t397:7.29632269):2.202170029):5.652586211):0.3347624234,((((t398:3.954624948,((t399:0.7600574979,t400:0.7072237032):1.532938861,t401:2.177802396):1.592788792):5.112022881,(((t402:0.5043379157,t403:0.4412268373):0.8646107238,t404:1.270392):0.4111777836,(t405:1.079372075,t406:0.9795919015):0.3675414658):7.093708079):1.562677144,((t407:7.717137073,((t408:2.525170254,((t409:1.088350618,t410:0.8785992755):1.165582871,t411:1.883473759):0.1742802745):2.154487152,t412:4.129394828):3.030717776):1.206046183,(t413:2.829380395,(t414:1.4192017,t415:1.328381249):1.310492437):5.521076386):1.042248876):4.415088889,((t416:3.928034043,(t417:2.138652685,t418:1.94815212):1.66358899):3.80029172,((t419:2.864508282,t420:2.657089287):2.554568372,(t421:0.7227304327,t422:0.6612400692):4.460320636):1.789354339):5.649957602):0.3452061386):0.2072941853,((t423:2.291954509,t424:2.272394383):6.156267329,(t425:7.40614983,(t426:4.984722486,t427:4.923718449):2.390780184):0.9841118612):4.586791694):14.8674666):1.23470362,(t428:9.83960233,(t429:7.271626747,(t430:5.428613805,t431:5.354985666):1.618994426):2.480261124):19.08246265):17.29326275,(((t432:0.2392646737,t433:0.1120346553):1.35526696,t434:1.452416582):3.071801601,(t436:2.964556312,((t437:0.7513961184,t438:0.5522522318):0.6015087796,(t439:0.2249479071,t440:0.1838652586):0.912239115):1.607939829):1.359099275):41.10797362):42.20638738,((((t441:5.856776575,(t442:1.048502289,t443:0.9172276047):4.710367235):0.8222579202,(t444:3.071767952,t445:2.889008288):3.355287063):14.23912941,t446:20.26226805):9.019688518,((((t447:0.7882296419,t448:0.7654351657):5.407498325,(t449:1.217193865,t450:1.156194079):4.938033987):1.072861218,(((t451:0.484189556,t452:0.2101439741):0.4465789428,(t453:0.08305054616,t454:0.04071918542):0.4933419467):2.269913051,(t455:1.321737478,t456:1.320690614):1.201459944):3.674556527):8.732801092,(((t457:0.5808605485,t458:0.5147378857):2.711348762,(t459:0.2145486586,t460:0.2043326115):2.941252314):8.630055776,(((t461:1.6391692,t462:1.596577412):7.076009519,((t463:3.304433595,t464:3.233610933):4.451370185,t465:7.63167271):0.7722055876):0.7200110293,t466:9.120931707):2.310885884):2.72702357):13.26654608):57.35630219):40.11770613,(t467:1.321001458,t468:1.033714699):123.3819684):71.38409537,(((((t469:0.2359393085,t470:0.03238934279):0.6950107116,t471:0.460675684):10.33215148,(((t472:0.7792081004,t473:0.7466709321):2.331983868,(t474:2.391216104,t475:2.350817089):0.6396026416):2.724340819,(t476:4.292535139,(t477:0.09093447326,t478:0.08059535985):4.090634428):1.405989375):4.938961636):19.56227306,((((t479:1.754370827,t480:1.586364565):6.323699284,((((t481:2.413348477,t482:2.235693328):1.938071404,(t483:2.636569286,(t484:0.2473964159,t485:0.2402908582):2.19687059):1.461555162):0.2613784592,t486:4.157931926):2.706660824,(t487:0.5176477046,(t488:0.322974815,t489:0.09525177434):0.06794307629):6.276330038):0.4833221235):9.760104126,(t490:2.004689634,t491:1.979847973):14.63906053):9.134156061,(t492:4.657006753,(t493:0.2718932773,t494:0.2486591842):4.162413495):21.07470662):3.076367591):35.85073812,((((t495:0.2901553312,t496:0.2055108902):1.769139246,(t497:1.157948303,(t498:0.9359815406,t499:0.8443497635):0.1374199723):0.520718164):1.992398893,(t500:1.537230531,t501:1.420498647):1.904419634):11.10222959,((t502:4.087880245,t503:4.008877647):1.421866916,t504:5.390389969):8.818330715):49.25692702):128.9262168);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T30.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
