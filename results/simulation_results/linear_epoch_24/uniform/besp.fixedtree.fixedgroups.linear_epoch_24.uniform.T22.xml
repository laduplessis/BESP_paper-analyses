<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t477:8.351991833,(t478:5.273071899,t479:5.270909687):3.051304043):0.5463985211,((t480:0.9877404291,((t481:0.2543333831,t482:0.1630899829):0.4726064073,((((t412:0.2100904818,(t413:0.04054029189,t414:0.02249256472):0.01125757593):0.006287320166,(t400:0.1039113208,(t395:0.1577403959,((((((((((t155:0.05089769311,((t138:0.01306261266,((((t95:0.05926910105,((t90:0.2210810318,(t86:0.04673608189,(t67:0.1318593155,((t44:0.1999488424,t1:4.257639117):2.084575751,(t2:2.214857251,t3:2.063809454):4.059131071):0.2176011606):3.23008165):0.5432972875):0.3864527031,(((t4:3.037880983,t5:2.944964644):0.1309798719,t6:3.055131831):4.151641104,(t7:3.170457145,t8:3.095775107):4.00883135):3.163826909):0.09585838445):0.7216953415,(((t9:1.636469559,t10:1.428797591):1.600613388,t11:2.958997227):7.362106096,((t12:6.04530686,(t13:2.155169532,t14:1.758356337):3.704221016):2.944369386,t15:8.3949076):1.193153901):0.2705098902):2.850236715,((t16:1.121170935,t17:1.065416574):6.858170259,(t18:6.35789385,t19:6.314956676):1.517754067):4.654810314):0.07863549235,((((t20:2.797229853,t21:2.792352124):2.644006958,(t22:5.01754513,(t23:1.437270959,t24:1.175516891):3.507354789):0.3130520946):3.61127637,(t25:8.490268689,(t26:2.286966207,(t27:1.265618274,(t28:0.4467865392,t29:0.3839193406):0.6844736926):0.9736284786):6.112168891):0.1103617185):1.70861955,((t30:1.804505059,t31:1.782908377):6.059418788,(((t32:1.333388642,t33:1.285066273):2.475114144,t34:3.55059558):3.932031154,t35:7.477538687):0.01500476544):2.012649902):1.773986028):0.9776072695):0.2318089699,t36:12.27913793):1.672400955):0.956507132,((((((t37:2.083122749,(t38:1.625370774,t39:1.581155849):0.4222001482):2.603783603,t40:4.582293861):1.292785763,t41:5.839508017):1.408976706,t42:6.914917334):3.410660609,((t43:1.537084953,(t45:0.08053213945,t46:0.01275860732):1.074586519):6.995900883,((t47:1.72807131,t48:1.548592334):2.715412189,(t49:2.922014014,(t50:1.126702686,t51:1.08328998):1.755763302):1.281112011):3.384446182):1.661516908):0.412520197,((((t52:0.2587894602,t53:0.2007877529):3.562962874,(((t54:0.3866922003,t55:0.1600213069):0.8119488296,t56:0.8409388514):2.119585925,t57:2.914044728):0.2938390338):0.9572764499,(t58:3.710996539,t59:3.592698749):0.3956467967):0.3882512912,t60:4.374256232):4.395232451):3.690779013):0.8967533952,((((t61:0.4222914564,t62:0.1653691504):2.541424767,t63:2.674920383):1.826813396,t64:4.478617772):5.950391458,(t65:9.129733779,((((t66:2.233053673,(t68:1.559531787,t69:1.209107334):0.06091586864):0.06410447032,(t70:0.6325871781,t71:0.6172778131):0.691118912):3.323337459,(t72:4.308321882,t73:4.197965711):0.267483456):0.707733213,(t74:3.45853457,t75:3.410295362):1.630836546):2.780224739):1.241371329):2.586550095):2.699761888,((((t76:2.217620519,t77:2.05253432):2.164384535,(t78:3.509522,t79:2.952126747):0.6506043139):7.856572928,(t80:3.432049343,t81:3.285614521):7.881357552):0.2233472091,t82:11.08402754):1.811361913):0.9287030525,((t83:2.741575957,t84:2.69448098):6.693108216,(t85:6.731356258,t87:6.36772965):2.647953335):3.863554224):8.704512658,((((((((((t88:0.3117020945,t89:0.278030382):2.894490656,t91:2.815143463):0.912181788,t92:3.655651242):0.8067569401,t93:4.228456807):3.088948268,(t94:1.814213772,t96:1.684267378):5.466095812):5.726131379,(t97:1.463899407,(t98:0.847042221,t99:0.7443636086):0.2943209666):11.34886333):0.1589679018,((((t100:2.506411527,t101:2.258422154):0.7386762886,(t102:1.746739574,t103:1.682644962):1.234648125):0.9820793146,(t104:2.62755565,t105:2.498863285):1.253272334):3.332851697,(t106:1.839386151,t107:1.634544693):5.206024935):4.810764245):0.6756299297,(((t108:0.4354037496,t109:0.1495934625):0.7578584593,t110:0.7898039336):3.239518002,t111:3.987849503):7.573323558):2.872472671,((t112:1.874848168,t113:1.808822124):3.849480947,t114:5.654334172):8.652657649):3.521882115,(((t115:10.02998217,(t116:5.652610566,(((t117:0.05490063911,t118:0.04414644453):4.055198921,(t119:2.976015327,t120:2.947287686):1.014838588):1.145792584,(((((t121:1.677332205,(t122:0.7110019004,t123:0.6202915803):0.8851289522):1.415111737,t124:2.683668197):0.6166469853,((t125:0.7542226476,t126:0.7201443127):0.2034525616,t127:0.8784032393):2.337439897):0.2052488547,t128:3.332106083):0.2328375984,(t129:1.06767941,t130:0.8071017595):2.468463449):0.8537966275):0.2215911815):4.239007766):0.5275930258,t131:9.063786955):4.776921648,((((((t132:2.202201889,(t133:0.3772914796,t134:0.3704011724):1.822136741):0.08625356236,t135:2.277835597):2.485532855,t136:4.35920741):5.00721361,((((t137:0.3841310272,t139:0.09403185204):2.169998619,t140:2.165444814):1.492493798,t141:3.586282826):0.9916155219,(t142:4.479099995,t143:4.466169843):0.09216670908):4.324985471):1.316877553,t144:10.18550479):0.4498904671,((t145:1.564951069,t146:1.439351348):8.188734399,((((t147:4.607268941,((t148:0.6036578341,t149:0.3553438838):1.129057177,t150:1.412200193):2.730980724):0.1638063568,t151:4.050266222):0.4297236943,t152:4.395008439):2.954815069,(t153:6.846091205,(t154:4.580615564,t156:4.215118391):2.217159393):0.4731962861):1.349408754):0.7365828495):2.156479979):2.329873039):0.5684159431):2.367527407,((((((t157:2.208220474,t158:2.135006502):3.72224892,(t159:3.681532629,(t160:3.102002071,(t161:2.279064644,t162:2.243918992):0.8154072032):0.5613575405):2.166265969):2.125768483,(t163:4.406867564,(((t164:1.015049509,t165:0.9240055649):0.698709962,(t166:0.7168147713,t167:0.584617557):0.8871677393):0.4290518095,t168:1.887768821):2.246409458):3.430883906):2.840202463,((t169:0.8467429068,t170:0.7939211137):1.637753095,t171:2.341898048):7.667215255):0.7477660007,(((t172:0.1306720215,t173:0.0498724307):3.642815748,(t174:3.106244788,(t175:1.439469436,t176:1.381851614):1.592171887):0.5834551209):6.035892009,((t177:1.710760736,t178:1.581453852):2.982327753,(t179:0.9636314861,t180:0.8487156234):3.599259):4.754771481):0.9338712964):2.560586949,(((t181:6.441879282,t182:6.415059344):0.08113838416,t183:6.414862302):0.4875311106,(t184:5.540743264,t185:5.504295927):0.9251844836):5.638953237):1.909831023):1.309105867,((((t186:3.096178564,(t187:0.2597638426,t188:0.2388285247):2.829621789):0.5023988144,t189:3.517436904):3.05739661,((t190:3.40935593,(t191:1.719330349,t192:1.555973312):1.577936584):0.7480771874,(t193:2.446659639,(t194:1.36601856,t195:1.20222523):0.9194578864):1.388403054):2.033858622):0.4929360677,t196:5.880035006):8.020117095):1.502470551,(((t197:8.934578479,((t198:7.962676083,((t199:1.642565383,t200:1.561585349):1.808254186,((t201:0.4177084018,t202:0.3396999428):0.9582303777,t203:1.206187955):1.876568249):4.509656111):0.9192809113,((t204:5.211533471,t205:5.052414179):0.9513817207,((t206:0.4524236541,t207:0.3994459818):2.430769694,t208:2.689179643):3.062755466):2.200582147):0.02476490453):1.094226797,((t209:4.312739536,(t210:2.960575272,t211:2.889598643):1.289658246):3.671240017,(((t212:2.027162773,t213:1.984720227):2.450788584,(t214:1.942504933,(t215:0.9319639561,(t216:0.2633989877,t217:0.249692026):0.6556819437):0.9477793695):2.407686006):2.006208923,((t218:1.249430441,t219:1.22984656):0.2758586002,t220:1.375207361):4.563847385):1.051285096):0.9736161496):0.7066628428,(((((t221:2.548826859,t222:2.503572353):0.9651651463,t223:3.351158933):1.19123368,((t224:2.335157194,t225:2.239128784):1.846212483,t226:3.896390415):0.3262773982):1.960015782,(t227:4.759237021,((t228:2.873068834,t229:2.858939759):1.645422243,t230:4.464943283):0.1228283778):1.405277696):0.2603025693,(((t231:1.164268093,t232:1.149669976):2.809808357,(t233:3.131169884,t234:3.130755098):0.6655652067):1.944428512,((t235:4.865978169,((t236:2.522073854,t237:2.489729242):0.2092901431,t238:2.657671033):1.938141521):0.2551019698,(t239:0.5409423287,t240:0.422651943):4.276914849):0.5113467948):0.3004418351):1.679256697):4.551066322):0.9959309518,((((t241:0.3617977433,t242:0.2349460575):3.040267628,t243:3.186137192):8.088888032,(t244:3.563506287,t245:3.529452113):7.679938904):0.798664611,(((t246:1.571226389,(t247:0.6696340487,t248:0.6379579388):0.7232428214):8.707056494,((((t249:0.9187039665,t250:0.8939525422):2.829479075,(t251:0.2029548338,t252:0.2016402026):3.4861368):0.5949017889,t253:4.154721282):2.074040812,(t254:1.171470869,t255:1.133178239):4.761611746):3.628363511):0.5873461741,((t256:6.002770287,(t257:3.582648905,(t258:0.2068731215,t259:0.07712912872):3.292405236):2.389867606):1.209581395,(t260:5.274058524,((t261:0.3967188105,t262:0.3600638301):1.054678855,t263:1.399706004):3.784829213):1.610061419):2.758180502):1.037476165):0.2181628059):0.8446755478):0.6247895777):1.97409916):3.157991659,((t264:5.31872854,(t265:5.221052648,t266:4.881420849):0.08216120844):6.916253425,(t267:6.178839504,((((t268:3.780791619,((t269:0.02026165785,t270:0.01271617036):2.058237648,(t271:0.7543627931,t272:0.5828183688):1.281392196):1.626053667):1.096021124,((t273:3.062807999,t274:2.888272967):0.2998329245,t275:2.98465251):1.049364374):0.5039957275,(t276:3.985561146,t277:3.959647276):0.404459389):0.5360169988,t278:4.802064888):0.2305672501):5.665725735):5.105856307):3.017422125,((((((t279:0.6279903401,t280:0.5725941614):2.170992703,t281:2.697792771):4.273803869,t282:6.854483021):4.208890053,t283:10.90639632):4.312469965,(((((((t284:2.426303292,((t285:0.2642819238,t286:0.2006574114):1.507169614,t287:1.612479519):0.5874789685):0.1144482863,(t288:1.441252125,(t289:0.905982961,t290:0.7973469506):0.06652042679):0.711400425):2.676982301,t291:4.189227205):1.252639454,(t292:3.912305714,(((t293:2.968582036,(t294:1.144040719,(t295:0.43168907,t296:0.3441552701):0.686400737):1.631811693):0.6992723303,t297:3.254417865):0.02276031249,t298:3.256242619):0.2115959175):1.41345187):0.1025827214,(t299:2.283574498,t300:2.280895028):2.688195759):2.25272946,(t301:3.330241563,t302:3.039915649):3.846059347):2.035576837,(t303:3.52937349,t304:3.508618471):5.031999651):4.306382184):0.6449502351,((((t305:4.721182284,(((t306:0.9108083921,t307:0.8138742077):3.119081002,t308:3.931926291):0.1944445022,t309:4.02094354):0.4486025195):0.5892551633,(t310:3.577581078,(t311:0.7101580747,t312:0.6632803096):2.807787233):1.38661942):6.540155095,((((((t313:0.9778750531,t314:0.9410803408):2.414117654,t315:3.125489092):0.6083584182,(t316:0.8256147868,t317:0.8234435903):2.653193074):1.786150761,(t318:2.406487718,t319:2.28013841):2.813704061):3.332531442,((t320:1.982363867,(t321:1.10726154,t322:1.086903291):0.7961269134):3.912073217,(((t323:2.621432116,(t324:1.990512567,t325:1.906381913):0.6106114987):0.1763180207,t326:2.638300894):2.642312013,((t327:2.690755003,t328:2.658739369):1.23890173,(t329:0.07918465542,t330:0.0650452807):3.786447681):1.304223095):0.3509442294):2.502812613):1.24547421,((t331:1.363920523,(t332:0.1968125539,t333:0.1125982065):0.9917770777):2.823192295,t334:3.759504667):4.796617318):0.9857937978):1.48329403,(t335:9.74914161,((((t336:0.7152283616,t337:0.6665673597):0.3786236835,t338:0.9613745773):4.593432869,((t339:2.674786656,t340:2.568636371):0.1620893937,t341:2.670344655):2.520060391):0.9235497462,(t342:4.817922914,(t343:2.198870388,(t344:1.545908507,t345:1.306876991):0.6329957142):2.578635928):1.278431765):2.923096265):1.205746571):0.1532048008):2.436939749):1.199940271):0.2552806307):2.167941689,(((t346:3.652702864,t347:3.639204735):6.056995801,(((t348:0.5348613973,t349:0.5175995601):0.3402723062,t350:0.797407596):3.117901878,t351:3.834219404):5.687854016):1.559105997,(((((((t352:1.738583435,t353:1.727717429):3.020821436,(t354:2.315878863,t355:2.289950387):2.315372033):3.530113908,((t356:5.027834399,((t357:3.428089904,t358:3.405587162):1.101078935,t359:4.502399527):0.4059335394):1.738464397,((t360:2.33448718,((t361:1.044378432,t362:0.9826351198):0.8584996692,t363:1.813807872):0.3394510753):3.384349325,((t364:0.2951432917,t365:0.2767801531):2.40231672,(t366:0.965344367,t367:0.9074549972):1.682868581):2.735407958):0.9069415707):1.223405698):0.3032397644,(t368:2.813189201,t369:2.750274751):4.892116876):0.2187099352,((t370:0.7889865727,t371:0.7760153316):2.08967752,t372:2.718550095):4.877141301):0.03647623973,t373:7.611775009):0.9525746332,(t374:6.730891601,((t375:3.326528799,((t376:0.505972954,t377:0.4617316644):2.049429833,t378:2.495964013):0.7351236457):1.026952736,(t379:2.642248753,t380:2.573382969):1.589273868):2.189647881):1.778968377):1.275582591):4.82769791):5.690818035):25.04558051,((((((t381:0.5753488749,t382:0.442656291):0.5259799279,t383:0.707658079):0.524759349,t384:1.145079827):14.23361898,((t385:5.172227346,(t386:0.470805254,t387:0.4054240842):4.699587576):7.493611851,((t388:3.03794305,(t389:1.478767371,(t390:1.149340489,t391:1.136634685):0.2499079846):1.540452013):0.6234463985,(t392:1.240032126,((t393:0.1820735408,t394:0.04355008321):0.6134993498,t396:0.2083215976):0.2715971175):2.082054455):8.78875662):2.645244979):2.752093879,(((t397:6.413231985,(t398:4.956637166,t399:4.929465616):1.329500248):1.985448301,t401:7.942072043):1.797547913,(((t402:4.963164727,t403:4.872779532):1.782222761,(t404:4.011125764,t405:3.860647925):2.305850121):1.448109932,(t406:5.224866028,(t407:2.710654818,t408:2.569509073):2.400687246):2.358786222):1.378612167):6.429640804):1.189338436,((((t409:2.206872485,t410:2.180380678):3.502358899,t411:5.65804955):0.887136481,t415:5.89403593):1.476039263,((t416:0.7605297384,t417:0.5221124408):5.495174049,(t418:1.778251824,(t419:0.9509215301,t420:0.9148860637):0.8189943474):4.040562895):0.9529890745):8.063153339):25.0475122):33.18612075,(((t421:5.973205403,(((t422:0.4178430947,t423:0.3916184224):1.444934862,t424:1.707343409):0.3187294559,(t425:1.632301834,t426:1.556154211):0.3367794417):3.615041004):5.037699072,t427:10.46836664):55.57080901,((((((t428:0.6608230068,(t429:0.2938175333,(t430:0.1220352849,t431:0.0866732289):0.1142644242):0.2758484269):1.195905377,t432:1.63050257):2.176527464,(t433:1.600040825,t434:1.505965321):1.955324508):4.286035503,((t435:1.898577298,t436:1.708033582):5.326923998,((t437:1.209796147,(t438:0.4089372561,t439:0.407843827):0.7670391861):2.89210104,((t440:1.19802781,t441:0.6376450006):2.609787692,t442:3.189200929):0.05011416877):2.825155392):0.5117719968):15.28550739,(t443:1.916434256,(t444:0.9623719689,t445:0.7676503963):0.949843152):19.91390231):0.7988946714,((t446:0.9859328404,t447:0.7646402301):9.323333648,(t448:2.195181575,(t449:2.042205574,t450:1.959225463):0.1335008505):7.889531426):11.93505331):41.61345113):6.260180753):131.157636,(t451:15.19427782,(t452:13.69683224,((((((t453:0.6020955734,t454:0.5944389256):4.498142583,(t455:4.451922883,(t456:1.849409893,(t457:0.8739999963,(t458:0.2033766024,t459:0.1815863401):0.6577935612):0.8390150156):2.600511911):0.6097904668):0.8508166783,t460:5.683214549):0.2327375288,(t461:0.2895811305,t462:0.1562203665):5.599666982):1.806851963,t463:7.423937972):1.222944153,(((t464:4.227584831,((t465:0.3075202198,t466:0.1187572612):0.7948127604,t467:0.7031855275):3.035915464):1.921554908,t468:5.654141149):1.115567592,(t469:6.432512252,((t470:2.333051379,(t471:1.61554054,(t472:0.4710373693,t473:0.2502884358):1.109544677):0.6868362765):0.5444088001,t474:2.456997071):3.535154223):0.1679055868):1.20507839):4.151175001):1.351766197):185.7344471):74.66324534,(t475:10.92534186,t476:10.85983765):262.2877295);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T22.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
