<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(t469:140.441906,((((t470:0.7609445068,t471:0.6712259787):21.76839018,(((((t472:0.2084165522,t473:0.071766694):2.081393236,(t474:0.1157382044,t475:0.07722611697):1.973707502):1.091213577,t476:3.060533485):2.782623622,(t477:2.201070979,(t478:1.843395755,(t479:1.055988379,t480:0.9545528522):0.7028502911):0.2925789659):3.636341588):4.171302057,t481:9.675195833):12.05312243):53.0619149,(((t482:2.024185862,t483:1.920911114):33.61712345,((t484:1.632711751,(t485:0.3215577425,t486:0.1445540236):1.303457812):1.589271006,((t488:0.3500019582,((t489:0.08022428828,t490:0.02664503141):0.1485772886,t491:0.1051798076):0.05301111979):1.091983213,t492:1.201233403):0.9742399235):32.21418487):6.512601774,((((t493:0.6803673543,(t494:0.4304556565,t495:0.3291291145):0.2032508368):1.775175021,(t496:1.41193353,t497:1.396479847):0.8876720184):2.157395593,t498:4.389267581):16.15732759,((t499:1.569152214,t500:1.567833077):12.51764238,(t501:10.07665051,((t502:1.674140807,t503:1.558456227):5.874162364,t504:7.212303035):2.432042449):3.998906432):6.415139428):19.9331273):32.58391125):7.982431672,(((t505:5.680774992,t506:5.673490138):6.997439611,((t507:2.559478259,t508:2.513305266):9.505948708,(t509:7.417122279,(((t487:0.3670177672,(((((((t320:0.05636310088,(((t261:0.1722854517,(t236:0.05711453235,(t235:0.005090046547,(((t202:0.07689394906,(t191:0.07624639968,((((t53:0.1239497785,((t24:0.1343794258,t1:1.837556297):1.933366044,(t2:1.817973935,t3:1.801038104):1.728950276):0.997087227):0.909387652,((t4:2.710207745,t5:2.507755118):0.6671415828,t6:3.130179694):1.886318519):0.5804598071,(t7:5.197736295,((t8:2.297252753,t9:2.254334104):1.34236877,t10:3.545286478):1.507913729):0.3955055673):8.514371445,((t11:2.152172958,t12:2.125934451):5.593389496,((((t13:2.558181708,(t14:0.5785077556,t15:0.5339817457):1.952358869):0.3996485706,t16:2.810772123):1.381369975,(t17:3.829509697,(t18:2.721732284,t19:2.704108945):0.8993301052):0.2556358069):2.893535513,((t20:4.040211316,t21:3.943653442):0.4850833955,t22:4.417078087):2.180586013):0.4602332339):6.121081934):2.060140391):0.6944579653):0.6729231004,(((((((t23:0.7986464562,t25:0.4552806403):4.262664598,t26:4.632378272):0.1877772782,t27:4.739342431):2.146968122,((t28:5.06065809,t29:4.928371053):0.3790498736,t30:5.229361451):1.414246074):0.5833423004,((t31:3.038890551,t32:2.984993895):3.19912447,t33:6.058343444):0.9808744455):2.428970748,((t34:6.892946267,t35:6.849204403):2.190770597,(t36:1.905349675,t37:1.899155728):6.886260178):0.174758309):5.81579755,(((t38:3.125629884,((t39:1.804400643,(t40:1.547782777,t41:1.514344898):0.1642930406):0.6555786404,t42:2.291409641):0.6283135696):3.788898305,(t43:2.761293373,t44:2.676468807):3.860784896):2.197205676,((t45:1.830837189,(t46:0.7889817568,t47:0.7415504186):0.8656154993):1.321811061,t48:2.899829021):5.39596334):5.290293662):0.3539457661):2.499151424,t49:16.3873746):0.4649466047):0.1411962125):2.283525522):1.862811483,((((((t50:0.4723671888,t51:0.4132871189):5.740188718,(t52:0.7801114443,t54:0.4792016765):5.369499898):3.328187987,((((t55:0.5480174378,t56:0.5470462998):1.279843135,t57:1.823523683):4.324669451,((t58:3.839117844,((t59:2.83958583,t60:2.803839526):0.0432991326,t61:2.620488243):0.8580997353):1.931092523,(((t62:2.848268156,(t63:1.466024737,t64:1.361978797):1.205685363):0.8826102353,((t65:1.680222328,t66:1.621835806):1.415243892,(t67:1.839356359,t68:1.798618072):0.9306059434):0.3428444124):1.396755303,(t69:2.4102413,(t70:2.201241327,t71:2.183932393):0.1545290662):2.041093469):0.2231117374):0.3508237866):2.913805053,((t72:3.473168876,(t73:1.677339474,(t74:0.6124633155,t75:0.5823117909):0.9908841883):1.764031237):1.718312558,((t76:1.752772622,t77:1.729623836):1.69085076,(t78:3.253002361,((t79:0.2684908907,t80:0.2584984011):1.603726075,t81:1.756375371):1.367749543):0.1656604328):1.552362293):2.670963603):0.08678610638):4.410829639,(t82:2.705711547,t83:2.631033295):9.175181739):2.219319944,((((t84:3.443120037,t85:3.213585512):0.6985138095,t86:3.762455234):5.755550552,((t87:0.08599120758,t88:0.06117048494):6.969867523,t89:6.864493474):2.207208912):2.854828322,((((((t90:0.9535205295,t91:0.9215165163):4.483288645,((t92:2.449350556,t93:2.410015629):0.560718406,(t94:1.021251333,t95:1.012650393):1.894803752):2.314996586):0.9782191301,((t96:1.624954837,t97:1.560138647):0.9250211243,t98:2.464669781):3.56416045):1.374870025,((t99:3.277039442,(t100:1.200707218,t101:1.168241199):1.975774561):1.446067636,t102:4.570991369):2.65285195):1.969640402,((((t103:1.292458369,t104:0.9929069289):5.962618481,((t105:0.5987597695,(t106:0.1953731704,t107:0.04028683789):0.178896101):4.897563393,(t108:0.8996588699,t109:0.8542011365):4.140787204):1.290880333):1.176308276,t110:7.374677005):0.2820705245,((t111:2.003930393,t112:1.925816947):3.355044156,((t113:3.384302624,((t114:0.4896081226,t115:0.2065939839):1.086776984,(t116:0.7764293746,t117:0.7210720268):0.4108821215):1.777746873):1.73240814,(((t118:2.6156454,t119:2.612272447):0.04594645973,t120:2.607323013):1.102835961,((t121:1.579473013,t122:1.524685601):1.621471995,t123:3.066471156):0.4913825557):0.7447726182):0.1004061613):2.240256449):0.3146899987):1.227484911,((t124:0.1867956168,t125:0.1146639942):2.67819381,(t126:1.409226981,(t127:0.1436957101,t128:0.04853178739):1.192124371):1.35484625):5.234858356):0.8721048865):1.132961032):3.447124889,((((t129:0.2742285378,t130:0.2541453507):1.34193551,t131:1.565863738):0.6570663169,t132:2.19340738):4.302044148,(t133:0.8416511074,t134:0.8256797793):5.482338676):6.629133318):1.414502793):0.905808745,(((t135:0.6502541254,t136:0.4590460841):6.525806425,(t137:3.404567569,((t138:1.566298675,t139:1.45135345):0.5700907702,t140:1.822484958):1.115483448):3.561652157):6.192600291,(((t141:0.1376915001,t142:0.1082986094):5.399746617,(t143:1.523522807,(t144:0.2081322499,t145:0.1914073374):1.115137068):3.98385576):0.4237471575,(t146:0.7293093592,t147:0.6418634244):4.982317315):6.35782577):1.798867378):3.213217245):5.458290862,((((((((t148:3.078750494,t149:2.969015334):1.213339957,t150:4.041267782):0.01244317676,t151:4.030014959):13.88063683,(((((t152:1.808217657,t153:1.640426195):0.9981529613,t154:2.548283683):6.62407737,(t155:6.375283849,(((t156:0.4818352395,t157:0.4721095696):3.960427777,(t158:0.2393665261,t159:0.1506272748):4.030650313):1.645713232,(((t160:1.27110163,t161:1.16552881):0.6069070143,t162:1.638997676):1.859091666,(t163:1.019949635,t164:0.888528765):2.458090683):2.012345815):0.1779219906):2.727691663):1.237448454,((t165:6.386628885,((((t166:0.194936993,t167:0.1026236159):0.4661712172,t168:0.555215626):1.85747188,(t169:0.5990167103,t170:0.4894114925):1.615888557):2.60921571,(t171:3.536264841,((t172:0.07393685788,t173:0.05079867704):1.394795388,t174:1.402175711):1.982009892):0.8734335948):1.229327109):2.272972341,((t175:6.214622305,((t176:4.669276417,t177:4.629630589):0.05742643213,((t178:0.5747828163,t179:0.4525237135):1.164941732,t180:1.434497531):2.839209411):1.439440595):0.5605821045,((t181:1.516096618,t182:1.377497532):0.9031393809,t183:2.275880404):3.822917601):0.9712775594):0.6977535787):6.173657983,((((((t184:0.5840390992,t185:0.4579043623):1.417562937,t186:1.810265441):0.4834774268,t187:2.029642385):3.55608385,((t188:1.932753485,t189:1.859919564):2.99291139,(((t190:3.009198426,t192:2.902365166):1.352635518,((t193:0.1240633481,t194:0.09806662304):3.45369891,t195:3.461524921):0.6750802496):0.2531672765,t196:4.228929586):0.2128189614):0.5297523528):0.2694435672,(t197:0.1493822109,t198:0.1017596583):5.034439195):0.1634926037,(t199:4.503335509,t200:4.344012166):0.7768787881):7.436079674):1.066217388):0.04378430653,((t201:6.073479315,((t203:1.081709919,t204:1.01127109):0.5108620227,(t205:0.0486102176,t206:0.0436419488):1.406003425):4.114338997):3.747987803,(((t207:0.679551414,t208:0.5841977185):2.531338671,t209:2.874154777):3.382357364,t210:6.12992385):2.330874007):3.841896137):0.05719385142,((((t211:0.6426691205,t212:0.6322293786):0.133452786,t213:0.7601668085):5.173485271,((t214:0.3116802494,t215:0.2874049614):1.503112997,t216:1.747260575):4.103101996):0.3863248285,((t217:2.591554588,(t218:2.259206222,(t219:2.190065072,t220:2.167334004):0.05670202701):0.0314579699):3.390781782,((t221:4.646075659,(((t222:2.035898512,t223:1.793839974):1.963168523,(t224:3.496584647,((t225:1.550715665,t226:1.351820827):0.7724032272,t227:2.107117876):1.063379193):0.0951744513):0.1459070875,t228:3.032143058):0.4618007291):0.8195218903,t229:4.288873855):0.04279494674):0.2364971679):5.817608361):1.001074933,(t230:6.908599124,(t231:0.4912225714,t232:0.4052388881):6.41687998):4.455456455):2.186810061,(t233:7.355112056,(t234:4.966233413,((t237:0.9433662964,t238:0.920615848):1.356341645,t239:2.117868804):2.015650461):2.315337027):5.898344979):0.7184378473):0.1789099293,((t240:4.77456897,t241:4.698064011):6.935866371,t242:11.63359612):1.460058031):0.514389807,(t243:5.052574327,(t244:0.1491674843,t245:0.06016342548):4.852384286):8.530262448):1.268343521,(((t246:4.279068203,t247:4.221098019):3.825116487,t248:7.983011256):4.035105342,(((t249:5.577981482,((t250:2.818505398,t251:2.745592351):1.802221465,(t252:2.505569268,t253:2.41260344):2.036680968):0.8651453508):2.09399801,(t254:4.786511116,(((t255:0.247113435,t256:0.1213301117):0.001089626599,t257:0.04471296783):3.839665323,((t258:0.8644666402,(t259:0.6720909713,t260:0.6021626409):0.08789868199):1.370898844,t262:1.621555927):1.513303908):0.6859802608):2.427163917):0.4614432649,(t263:5.639222116,t264:5.637409243):1.042070326):3.873988494):2.565410273):0.923631168,(((t265:5.657279286,t266:5.42496211):4.526394319,t267:9.912692036):2.62258742,(t268:6.642556425,(((t269:0.4238154189,t270:0.3686857302):2.027089988,t271:2.160556019):2.589189436,(t272:1.033716807,t273:1.027079898):3.677850605):1.577873521):5.79087831):1.152754855):2.372739518,(((t274:4.458962889,(t275:2.610580985,(t276:2.183268729,t277:2.165182125):0.426131015):1.847544375):3.949642505,(((t278:2.066397118,t279:1.838144063):4.361658952,(((t280:1.291405304,t281:1.109351538):0.4059642623,(t282:1.266162907,t283:1.197909048):0.1562151408):3.907674461,(t284:1.190505617,t285:1.020538834):3.906248848):0.5895099564):0.1496222244,(t286:0.41969049,t287:0.3211668635):5.197553157):1.729594115):5.035213389,(t288:0.9061929022,t289:0.6919478911):11.20588333):2.15078884):6.143962735):1.784856185,((((((t290:1.453885339,(t291:0.7413000297,t292:0.678923117):0.6583871747):1.115522514,(t293:2.320735789,t294:2.13939141):0.07505577542):2.342597988,((t295:0.9567085799,t296:0.6857168899):0.5636005697,t297:0.9873629696):2.86553348):0.446457682,((t298:1.336986353,t299:1.324366678):2.524287141,t300:3.779510061):0.4355755884):13.09504489,((((((t301:4.463464632,(t302:1.252328768,t303:1.172884463):2.993674421):5.339540602,(((t304:3.870777977,t305:3.747764915):0.163503847,((t306:1.706219273,(t307:1.133508703,t308:1.05398982):0.4938643141):0.2864023909,t309:1.671666191):1.860070542):1.684931154,((t310:4.68949824,(((t311:0.7253689857,t312:0.6409063779):1.896449673,t313:2.524145291):0.6280147499,(t314:2.608243785,(t315:2.52545893,t316:2.344246855):0.02300010101):0.4907147641):1.328751188):0.3135738636,t317:4.466675764):0.1339586253):3.627216889):0.7061779376,(((t318:1.494882171,t319:1.372139997):4.343967154,((t321:2.359527156,t322:2.346447191):1.897391223,((t323:0.3907633236,t324:0.3008926901):0.0972630192,t325:0.3439640161):3.695365537):1.175797621):2.698833486,t326:7.689144308):0.3573647176):0.5360051274,((t327:5.454246662,t328:5.443810513):0.7212122722,(((t329:2.706815382,t330:2.622648051):0.3909563997,t331:2.891523529):2.19953124,t332:4.931977458):0.701416995):2.404629876):0.2388015808,(t333:2.590999082,((t334:0.4110592219,t335:0.3681044348):1.750394515,(t336:0.8823522281,t337:0.8580144069):0.8196343679):0.3452611071):5.684725777):3.90885828,((t338:7.254285758,t339:7.127584943):1.045768084,(((t340:0.952457899,(t341:0.5331307136,t342:0.5132999255):0.4049374255):0.5611556779,t343:1.301126296):4.01393821,t344:5.156920983):2.340146623):3.289131586):2.078443484):1.576145633,(((t345:0.6793652805,t346:0.6704685357):9.476397976,(((t347:0.5913560942,t348:0.416807899):1.953681595,t349:2.212126029):1.325575893,t350:3.500916431):6.24219317):4.163761024,((((t351:5.411453808,t352:5.312838692):2.810565868,(((((t353:0.2365538957,t354:0.08731077611):2.94222038,((t355:2.457712264,t356:2.429800372):0.3744345663,t357:2.660084188):0.03515613564):0.1121332778,(t358:2.368562873,t359:1.858275192):0.4260179243):1.179042825,(t360:0.2508569802,t361:0.04822061487):3.108005323):1.591044254,((t362:2.786379695,((t363:0.5492955846,t364:0.4891243958):0.8589593869,(t365:0.912044191,t366:0.8405073646):0.4327513003):1.298151067):1.356251587,((t367:0.4543265544,t368:0.3219434057):0.3758884371,t369:0.6637127416):3.009714584):0.5890602095):2.042585504):0.06727513376,((t370:4.920085684,t371:4.90942989):0.007475800524,t372:4.889543762):1.312755259):2.631824035,t373:8.771311672):2.975842892):0.04166380805):1.72159579):0.6425331051,(((((t374:0.8545114457,t375:0.6927526759):2.537456463,t376:3.161127929):0.377930206,t377:3.4712834):2.249136688,((t378:0.7549027003,t379:0.7148990946):0.236928364,t380:0.909312572):4.650803671):5.484370103,(((t381:1.059739421,t382:0.9513759767):1.771709766,(t383:0.5389671209,t384:0.4567012438):2.150094343):4.825215242,(t385:3.977799492,(t386:1.326145762,t387:1.270847582):2.606324171):3.438990347):3.19543331):2.571023429):6.43633699):4.4342152):0.5908913416):48.36246127,((((((((t388:3.422529776,t389:3.004974118):0.8795753982,t390:3.860879803):1.557837841,t391:5.291519137):0.2588876785,((t392:3.390713917,(t393:1.364332397,t394:1.337943743):1.855147747):1.598645979,(t395:4.197164919,((t396:2.086785891,((t397:0.9382267986,t398:0.89137665):0.111081616,t399:0.9651321518):1.030002098):0.2495951111,t400:2.17005033):1.835192571):0.4046082288):0.4398948556):6.228514052,t401:11.03781039):7.119371512,(((((((t402:2.526678382,t403:1.99235517):2.649786287,((t404:1.700922922,t405:1.699923227):0.9061883838,(((t406:0.1070318752,t407:0.09873046204):0.6584860873,t408:0.4814046565):0.5311576781,t409:0.8082681745):1.163166494):1.969648349):0.4210642049,(t410:1.981374444,t411:1.945549229):2.336935843):1.059829302,((((t412:0.2275047418,t413:0.1838070954):0.9738704985,t414:1.00078366):0.9487641382,(t415:1.681429943,(t416:0.5828030667,t417:0.4157649119):1.027048191):0.117210927):0.7146539049,((t418:0.1786043142,t419:0.1664993476):1.222974557,t420:1.286528927):0.554683419):2.348981642):0.3086102004,t421:4.386158845):6.021222837,(t422:5.097266953,(t423:3.505676822,t424:3.485902565):1.576537358):5.310096285):0.2160580402,(((t425:6.596768801,((t426:3.802971059,((t427:0.4036043285,t428:0.3592940581):2.791275611,t429:2.938927958):0.5544858796):2.256692307,(t430:5.044250394,(((t431:2.203709048,t432:2.189917234):0.5640196241,((t433:0.6840682817,t434:0.4537995611):0.4036660779,t435:0.6369919691):1.613817838):1.053875771,t436:3.273442602):1.127350233):0.6711556789):0.4835484459):1.560252589,t437:7.056782706):0.3930495639,((t438:1.648482092,t439:1.486226322):4.025253173,(t440:3.071587391,(t441:2.249982613,t442:2.216203722):0.7374930432):2.049762516):1.526396973):1.874820292):4.942491265):7.549167096,(t443:5.523598275,(t444:3.79641502,((t445:2.169304698,(t446:1.039191745,t447:0.8693745275):1.112309877):0.2596494429,(t448:0.6390882861,t449:0.58233605):1.501191591):1.108525499):1.505794305):15.35302138):5.169650032,((((((((t450:3.011257713,t451:2.903971095):1.117594955,t452:4.021530847):0.6015261225,(t453:3.235608996,(t454:1.058105282,t455:1.048061789):2.146461335):1.286284121):0.634940808,t456:4.838329117):2.248983938,(t457:0.7340150644,t458:0.4984291877):6.347263684):1.286448,(t459:3.769772452,t460:3.76233045):4.302922514):3.378843971,(t461:8.157478352,(((t462:2.71024326,t463:2.64067046):3.894114207,(t464:2.712307742,t465:2.585636173):3.816493028):0.5850077698,t466:6.941614248):0.8841056538):3.19515769):6.380659102,(t467:1.18509267,t468:1.176773244):16.06558641):6.520823642):40.6850153):19.46772468):56.57228579);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T37.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
