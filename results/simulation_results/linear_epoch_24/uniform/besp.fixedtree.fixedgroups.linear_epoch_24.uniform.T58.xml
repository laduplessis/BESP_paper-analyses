<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t378:11.2008208,((((t379:1.148638196,t380:0.6070550531):0.9488056955,(t381:1.187824168,t382:1.114760122):0.2513907416):0.7191515528,t383:1.81645504):2.900966088,(t384:2.964400464,t385:2.951155958):1.668466895):5.357645896):6.793790715,((((t386:2.818459542,t387:2.78052443):5.019461779,((((t388:0.2462547691,t389:0.2157389992):0.7239501146,t390:0.5008000052):0.8652237282,t391:1.238102603):1.492265641,t392:2.704009414):4.451078503):3.594447525,(t393:0.7033274984,t394:0.6269846303):9.947587587):2.476974831,((t395:3.580261457,((t396:0.8755289116,t397:0.8736084393):2.404865021,((t398:0.1997583422,t399:0.1827059842):1.203141624,(t400:0.05582387027,t401:0.009987417879):0.8551628774):1.856199026):0.2690409286):1.590824896,(t402:1.522235145,t403:1.386504157):2.92679464):7.865230106):2.816868083):6.960207072,((((((t404:4.145588357,t405:3.967926311):2.878945693,((t406:2.886591853,t407:2.865939217):3.079411719,t408:5.791629678):0.6708439598):0.3653889582,t409:6.809384745):0.2239531481,((t410:1.158067533,t411:1.008039604):2.827803948,((t412:1.64276916,t413:1.581097882):0.8584876972,(t415:1.444352404,(t416:1.30707377,t417:1.233499811):0.1167860401):0.6549177682):1.304445007):2.954822867):0.4428240826,t418:6.688812404):1.485196108,((t420:2.27101639,(t421:1.650775373,t422:1.648046515):0.4532118944):4.466179174,(t423:3.492181224,t424:3.382062838):2.958310261):1.085825308):12.073269):34.1166328,(((t425:6.264172276,(t426:4.095604257,(t427:1.707600003,(t428:0.3901237244,t429:0.1985090384):1.31679631):2.309214711):1.929227397):0.9915949813,t430:6.547626723):1.058353424,((t431:2.115526008,(t432:0.1264962728,t433:0.1066724814):1.97133046):3.890192861,(((t434:0.4838541952,t435:0.4368912239):2.708171589,t436:3.058366935):1.113087945,t437:4.165103513):1.471185351):1.578895562):45.1127385):168.7199479,(((t438:10.85865572,t439:10.7726906):25.1807282,((((t440:2.002176267,t441:1.944145549):0.2093059531,t442:2.011985303):15.54417325,t443:17.50729692):6.449948811,((((t444:0.6293802898,t445:0.6188786564):0.524804857,t446:1.120468099):1.559456402,t447:2.393902592):6.992158512,(((t448:2.469151485,(t449:0.683600043,t450:0.5198071944):1.575287464):0.1400356083,t451:2.046903627):1.166918766,(((t452:1.516179388,t453:1.435978772):0.4565766405,t454:1.858671144):0.8478715133,t455:2.65583274):0.01739447351):5.562241432):13.80407435):11.69635786):52.45094571,(((((t457:0.9144182094,t458:0.847580168):0.04502860645,t459:0.8598886888):3.066585506,t460:3.716414743):1.751937319,t461:5.43381974):3.666907806,(t462:3.521929217,(t463:2.921696185,t464:2.87586748):0.535205901):5.488554234):76.38075762):132.4858101):5.235267216,(((((t465:0.7859262487,t466:0.7436000735):1.222682653,t467:1.956592422):2.759500921,t468:4.598134514):6.539009433,((t456:0.0136494468,(t419:0.07896564448,(t414:0.2682066435,((((t330:0.02198447602,(t317:0.01741876584,(t302:0.03844289714,(((t258:0.04150237896,(((t148:0.04682092171,((t123:0.06384964339,(t112:0.08841769204,((t24:0.05249092224,t1:1.771412891):5.051893624,(((t2:0.4065111079,t3:0.3604705357):2.286597203,(t4:1.399306345,t5:1.36937847):1.137882518):1.555439473,t6:4.058598549):2.540422639):5.57083067):0.5148691168):1.616438274,((t7:7.509701119,((t8:2.799967748,t9:2.69626458):3.215797323,(((t10:4.488368115,(t11:2.085830822,(t12:1.498379394,(t13:0.8732664084,t14:0.5664330294):0.6122257992):0.5121745359):2.352179285):0.05450992266,t15:4.007074197):0.7462157442,(t16:4.610296936,t17:4.365975467):0.1077375248):0.5419615797):1.390479246):3.586782444,(((t18:5.409506085,(t19:4.758908159,(t20:2.001504938,t21:1.959828742):2.745641595):0.6139305898):1.646463514,(t22:5.496336039,t23:5.342095691):1.448041223):0.7610544109,t25:7.414944786):2.159123736):3.115915472):1.088267024):0.01850183913,((((t26:1.037185802,t27:0.9930643528):0.03715892655,t28:0.8418221982):1.531997679,(t29:0.8699676961,t30:0.7241044523):1.486606264):4.414534606,(((t31:3.423814057,t32:3.135545022):1.745464748,((t33:0.8517332239,t34:0.817089884):3.329946588,((t35:1.77758686,t36:1.743030989):2.208715908,t37:3.883779):0.1568168496):0.5869689966):0.2710170915,(t38:0.504020035,t39:0.2372495166):4.368976886):0.8296566338):6.741183823):1.008453035,((t40:4.490611669,t41:4.345912143):6.729173874,((((t42:1.971904826,t43:1.910098693):1.224619615,t44:3.073674881):3.154468694,(t45:0.3817345364,t46:0.3174234795):5.822203602):1.739161551,((t47:1.760230985,(t48:1.363124072,t49:1.350111703):0.03111514686):5.694839051,t50:7.065450219):0.3629142723):2.741112418):1.653095001):9.515939596):0.2945567195,(((((t51:0.5778458552,(t52:0.3303424599,t53:0.2214817823):0.04894195934):8.854506385,(((t54:2.425392142,t55:2.309118572):0.6487001123,(t56:0.4264692244,t57:0.2104995305):2.519120731):4.728556143,(t58:0.7294026953,t59:0.6408228036):6.61316246):1.310494408):3.333870181,(((t60:0.396683944,t61:0.3945710804):7.440374997,(t62:1.10282683,t63:0.9521811716):6.699525781):1.241796094,(((t64:2.838350703,(t65:0.9808488285,t66:0.9567448773):1.681043337):1.264917941,t67:3.796261707):3.33527087,t68:7.123419166):1.447086055):2.803638084):3.991563081,(((((t69:1.521846233,t70:1.518418117):7.107643314,t71:8.366689697):2.781371802,(t72:10.49676985,(((t73:0.382106485,t74:0.365193479):0.4937005927,t75:0.8459914211):5.301528112,(t76:4.635689555,t77:4.601034585):1.486611384):4.295642472):0.4238381597):0.2866958037,(t78:10.78083239,t79:10.55501044):0.2597402382):0.4611343454,((((t80:2.390445522,(((t81:0.3436750441,t82:0.256771302):1.807796795,t83:1.620756785):0.1052112173,t84:1.718999945):0.08270172615):1.750349855,(t85:3.19660438,((t86:1.283833891,t87:1.029711048):0.0103439389,t88:0.9055738337):1.770076303):0.2935531954):0.006092385463,t89:2.893420919):2.209696253,((t90:2.095286064,(t91:0.8367001045,t92:0.6980951338):0.8978017703):1.500085132,t93:2.889468858):1.383668059):4.538056385):3.123393082):1.747567636,((t94:1.455357945,t95:1.093507966):11.98499758,(t96:12.81208073,(((t97:1.328751384,t98:1.129912872):4.38545783,((t99:2.599525759,(t100:0.6929267179,t101:0.5496284403):1.77009407):0.8094579954,t102:3.068430945):1.926371153):0.5631298967,(t103:0.8575253014,t104:0.5175318063):4.652126066):6.374051091):0.1659000208):0.1469788444):3.031276886):4.781631603,((((t105:4.854173573,t106:4.838015954):7.835062438,((t107:0.897010129,t108:0.7067451096):6.74158565,((t109:1.984265632,(t110:1.58768069,t111:1.524733998):0.3872302134):4.175531736,((t113:2.905902102,(t114:1.931292122,(t115:1.120654883,t116:1.061594143):0.7097275548):0.8926036917):2.295634691,t117:4.942068655):0.7520338328):1.27656218):4.818070075):5.923411157,((((((((t118:0.2529497563,t119:0.2293998825):3.925287174,t120:4.140965205):0.1005872201,(t121:3.171641601,(t122:0.2043592376,t124:0.1055131672):2.932322819):1.063647564):3.096282043,(t125:5.495211531,((t126:3.159063608,t127:3.067716265):0.4260371372,(((t128:0.3680027388,t129:0.3180468362):0.3033475815,t130:0.6130283312):2.031645447,(t131:0.6353120371,t132:0.5556409648):1.826268179):0.7897901263):1.631923711):1.682477956):0.3141705364,t133:6.789856809):2.153004882,(t134:5.019451966,((t135:0.8099153023,t136:0.7988177398):1.549815876,t137:2.311839891):2.63348718):3.903133475):5.068028744,t138:13.88725898):0.7833432939,(((t139:0.213239256,t140:0.1482832969):5.400586594,((t141:1.955040139,t142:1.908449108):1.851014964,t143:3.469518672):1.276727038):5.332813192,((((t144:2.624869466,(t145:1.593100963,t146:1.314064799):0.8396493449):1.249549792,((t147:0.964775615,t149:0.7203143244):0.858616838,t150:1.511003166):1.311276051):3.91155903,((t151:2.471732457,t152:2.367964969):1.544862854,(t153:3.171599356,t154:3.046745132):0.4466436026):2.683638237):0.235895763,t155:6.364473733):2.001639787):3.604992227):1.947415849):0.8485659926,((t156:3.694837601,(t157:2.11132828,t158:2.091307581):1.511661275):4.8954774,(t159:4.284913371,(t160:3.754347707,(t161:0.8991182276,t162:0.8830848953):2.827543973):0.4653643689):4.025620122):6.003688527):0.003359711634):0.1807589254):1.248102446):0.7508900254):3.596945667,((((((t163:3.022892367,t164:2.796484602):0.8947204537,(t165:1.918229344,t166:1.768408748):1.553778442):1.011719853,(t167:1.035566167,t168:1.027421735):3.205346765):0.8138015212,t169:4.948448153):3.682961708,(((t170:0.1504342208,t171:0.05339566677):0.4255436549,t172:0.3547143548):3.662518444,(t173:0.7754439328,t174:0.7520050335):3.107501042):4.365318037):2.417791591,(t175:4.34641068,t176:4.215034233):6.287182149):7.96511882):1.380064511,((((((t177:3.017428991,t178:3.01261852):3.532197407,(t179:3.418325471,t180:3.33554506):2.744576577):0.1121607156,t181:6.17418157):1.698786988,t182:7.855977678):4.911690493,((t183:9.105984912,(((t184:1.15720842,t185:1.10989367):0.4769096835,(t186:1.384770119,t187:1.355666823):0.1721402226):4.619338795,t188:6.116539954):2.68641565):3.317006032,((t189:1.249887287,t190:1.235717517):7.217786384,t191:8.286015272):3.32281694):0.208065491):3.121756979,(t192:2.347842047,((t193:0.1872350847,t194:0.06646728365):1.194619122,(t195:1.093628463,t196:1.009134594):0.09411703939):0.9422402706):12.58590375):3.419058204):3.577485478,((((((t197:1.013169466,t198:0.9277799004):2.103939854,(t199:2.052024031,(t200:0.10168415,t201:0.07541974889):1.907983373):0.9592529286):1.264035431,((t202:2.235578398,(t203:1.658529457,t204:1.574529182):0.5747752416):1.016913905,t205:3.148274318):0.9102322707):8.769870604,(((((t206:1.433635253,t207:1.189067818):1.251295846,t208:2.428564196):7.142538553,((((t209:4.034486531,(((t210:0.1198667616,t211:0.0706261035):1.713809179,(t212:0.5907931739,t213:0.4553427167):1.008385497):1.304085341,t214:2.712341689):0.669585193):0.05983766878,t215:3.279863081):0.7606984865,t216:4.009899082):2.359629413,(t217:1.198575951,t218:1.18627142):5.154976743):2.202220373):1.128820524,((t219:4.438210782,(t220:3.22933405,t221:3.143859588):1.065590094):3.823340436,(t222:2.135246053,(t223:0.6659185425,t224:0.6361870658):1.335148201):5.848360379):1.35131671):1.273868438,(t225:6.72179899,(((t226:0.2674690162,t227:0.1025163762):0.9591693434,t228:0.891474099):3.419137145,(t229:1.887412854,t230:1.634536353):2.215948571):2.069630037):3.634005819):0.5641819727):3.026664878,(((t231:0.5409866595,t232:0.5306679318):7.058794968,(t233:6.496420411,t234:6.318687653):0.6479320769):4.694600739,(t235:10.23340679,((t236:2.044019996,t237:2.013164241):6.728452927,((t238:5.703233499,(t239:4.492561546,t240:4.427701186):1.193960266):1.421551774,(t241:3.311456338,(t242:1.542879493,t243:1.53459068):1.764431092):3.721035078):1.422969434):1.338262691):1.412045135):0.6444815274):3.967310277,((((t244:0.4843206243,t245:0.4795810063):4.241190249,((t246:0.5633964632,t247:0.3600934516):3.825675712,t248:4.165023901):0.1350981573):1.184153639,(((((t249:2.671651702,(t250:1.787576146,t251:1.74042689):0.7218566891):1.727568832,(t252:2.720615201,(t253:1.51954743,t254:1.509017159):0.9480462525):1.399999278):0.3433096174,(t255:1.219847037,t256:1.077461838):2.97306957):0.3862868892,(t257:1.52764727,t259:1.01511269):2.845494341):0.2049015102,t260:3.870541748):0.07508721407):0.9930476131,(t261:1.115890436,t262:0.845143897):3.777034282):8.864798193):1.408605272):0.1988420317):0.3587590451):4.487945577):1.947182029,(((((((t263:3.680412388,t264:3.520800639):5.009949684,(t265:5.987621082,t266:5.877072611):2.536105331):3.219584986,(t267:3.82276125,(t268:2.336122224,((t269:0.6315463485,t270:0.01040261911):0.3743333722,t271:0.2377143317):1.226003112):1.205184403):7.774051202):3.875018762,((((t272:4.977456097,(t273:1.764924656,t274:1.757550195):3.140813503):3.612316632,((t275:2.409926741,t276:2.372648586):5.576881311,(((t277:4.87469151,((t278:2.134785541,t279:2.079261953):2.407548566,(((t280:0.06261455601,t281:0.05770824391):0.195082368,t282:0.1842799459):2.454605688,t283:2.364937646):1.761284567):0.0587618325):1.540701566,((t284:0.6343622828,t285:0.4548980264):4.464118504,((t286:0.8457499166,t287:0.7283523121):2.335110766,(t288:0.9222446954,t289:0.9092961754):2.100896664):1.725615002):0.5624517166):0.117146497,((((t290:0.877421873,(t291:0.2116570348,t292:0.208485331):0.6282097355):0.1132405493,(t293:0.5800026909,t294:0.5128966409):0.2869865713):1.606739069,t295:2.290898508):1.019432868,(t296:1.648252353,t297:1.572310277):1.567535277):1.638128203):1.370215685):0.4227999311):2.297424332,t298:8.793948508):2.838297951,(t299:9.628394552,((((t300:1.751222641,t301:1.611062431):2.60015275,t303:4.166263929):2.759405168,((t304:2.365250875,(t305:0.2224393161,t306:0.03737400561):2.106085001):0.3230500205,t307:2.440974424):4.124974212):2.055953082,(t308:1.699855514,t309:1.662839872):6.819666985):0.3808232233):1.858914498):0.3748554714):2.842784135,(((t310:2.372329075,(t311:2.071860883,t312:1.939561666):0.2938761149):5.538979079,((t313:2.024417984,t314:2.012279016):0.7458174254,t315:2.594506811):4.910409062):4.516162884,t316:11.9999195):1.472102088):0.4606488284,(((t318:0.1425278568,t319:0.054132671):2.953921148,(t320:2.736131307,t321:2.649080423):0.2421432045):5.48436675,((t322:0.1953991327,t323:0.07990454805):1.633281183,(t324:0.6876666883,t325:0.5495073006):1.021531547):6.488911121):5.056836656):1.075103454,(((t326:2.030579703,t327:1.984527791):2.30037451,(t328:3.113043847,(t329:2.591003389,t331:2.486809676):0.4865981271):1.163228429):5.056689337,((t332:7.947770149,((t333:1.405420446,(t334:0.5597579607,t335:0.2569382481):0.5963995521):4.568839763,t336:5.365477437):1.917084129):0.1898283744,t337:7.450129589):0.9804358351):4.710265759):1.569090852):10.01141596):4.379735499,((((t338:2.660631792,t339:2.622573706):0.4489103738,t340:3.068922311):8.238242784,(((t341:1.884134142,t342:1.85689661):0.3769986767,t343:2.199748448):0.2235097975,(t344:1.608778442,(t345:0.8092008211,t346:0.7929282819):0.6742717944):0.8015466061):8.522119897):5.754074906,((((t347:5.13531599,((t348:3.294741692,t349:3.263455495):0.3222690456,(t350:2.317148648,t351:1.871929732):1.195784783):1.511642408):1.380703902,t352:5.943740535):6.177948689,(t353:8.261469599,(((((t354:3.40929002,((t355:2.133039289,t356:1.832798407):0.7475262335,t357:2.54479388):0.4175959042):0.3661500132,t358:3.297068649):0.6950590069,t359:3.880003737):0.3710962486,t360:4.229772174):2.486173565,((t361:0.8082166578,t362:0.7428592088):3.956897329,(t363:3.859413723,t364:3.837692004):0.8384428913):1.865682443):0.8502541788):3.857233033):2.287062628,((((t365:0.9750454363,(t366:0.169147931,t367:0.04492816461):0.7249540802):5.255948117,(t368:3.280931794,t369:2.941291313):2.567452407):1.493015782,(((t370:0.446129737,t371:0.4401510503):2.301263517,t372:2.730697073):1.635810259,(t373:3.318353925,t374:3.214171984):1.019843267):2.529948734):4.611819609,((t375:1.680755122,t376:1.640224774):3.865542198,t377:5.451661885):5.693487696):1.169548643):1.533316288):11.90918572):207.2822621);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T58.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
