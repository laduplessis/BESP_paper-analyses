<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t449:1.590672999,((t450:0.1584224485,t451:0.113940826):0.8314220495,t452:0.9411529659):0.5627624015):17.46368057,((t453:3.639466278,t454:3.480997997):7.394161949,(t455:3.852279132,(t456:0.7579648848,t457:0.691015034):3.043810266):6.855748619):7.887998081):6.555279457,((t458:19.44782528,(t459:8.540043826,((t460:0.7054738591,t461:0.237030803):0.190849912,t462:0.2487910505):7.623433445):10.90755178):3.377274782,(t463:3.109824426,((t464:0.1416526162,t465:0.04833212446):0.6815053141,t466:0.6990801557):2.257481852):18.95458707):2.192466727):86.10518898,((((((t467:2.337576002,t468:2.12377308):1.454451966,(t469:1.364473098,t470:1.311298011):2.099561566):4.0478068,(((t445:0.1105972941,(((t402:0.2328202472,(t372:0.04381478435,(((t332:0.05125263409,((((((((t122:0.08557388688,((t59:0.1638200897,(t60:0.02599803052,(t32:0.009144079104,(t14:0.2765647052,(t15:0.0943493595,(t1:1.144118417,t2:1.103698804):0.02742829629):0.06573944038):2.226188911):2.333051142):0.02098829647):5.44736344,(t3:7.789950484,(((t4:2.091867646,(t5:0.2257325266,t6:0.09896240366):1.730140491):0.1619168278,t7:1.985257003):3.81837229,(t8:1.687918241,t9:1.621574098):4.076610317):1.709395547):3.334694574):0.1115140069):0.1565078682,((t10:5.539610904,((t11:2.147891483,t12:1.988011502):0.291089719,t13:2.202879858):2.985332424):0.1093189605,(t16:4.001809612,t17:3.987115609):0.8733911189):5.32330141):8.609019493,(((t18:2.056612263,t19:2.046753085):12.450975,(((((((t20:3.050674073,t21:3.021710251):2.67269849,(t22:3.174063696,t23:2.888254123):2.48727666):0.03496250057,(t24:2.30359039,t25:2.184897567):2.851637356):0.3451492168,(t26:1.473514265,t27:1.375329747):3.580221535):4.101576704,((t28:6.997823851,(t29:6.301271497,(t30:5.649277435,(((t31:0.4162422328,t33:0.2635499814):4.232218249,t34:4.466987775):0.465722502,(t35:1.589097454,(t36:1.326020145,(t37:0.2658368758,t38:0.1752287964):0.9832741102):0.1636657626):3.216246553):0.5231878369):0.6369249102):0.6832717851):0.8787263978,((((t39:2.568737627,t40:2.441042724):0.7662789207,t41:3.203708545):2.245390154,(t42:5.036805136,((t43:1.176422565,t44:1.141880145):1.166648778,t45:2.298038603):2.488561005):0.3996965039):0.02345765246,((((t46:0.2100266829,t47:0.1591950093):0.1547146989,t48:0.2661050527):1.349616212,t49:1.516761432):1.70432022,(t50:2.242374659,(t51:0.2040203079,t52:0.133135641):1.834998845):0.9499609447):1.771820313):1.584667579):1.104564833):1.769675482,(((t53:3.529599473,t54:3.527469852):2.636297817,(t55:4.686730797,((((t56:2.074473518,t57:1.881177321):0.9188929042,t58:2.546339341):0.5099120538,(t61:1.721959031,(t62:1.682382353,((t63:0.3544749627,t64:0.2954287925):0.7902865883,t65:1.057514322):0.4709903254):0.01547145709):0.864449896):0.2157768088,t66:2.622244663):0.9220967135):1.419880827):1.489757028,t67:6.435542746):1.481480842):0.5055118494,(t68:6.652582315,(t69:3.174054222,(t70:0.03822190856,t71:0.01014499302):3.026314441):3.414085089):1.545437129):1.996301092):3.213713204,(((t72:1.784202756,t73:1.582446916):1.778474124,(t74:3.134569509,t75:3.076935918):0.161226153):5.351771926,(t76:2.587261276,t77:2.547901711):5.918892602):4.219291073):0.3694078511):1.776557831,(((((t78:5.256660298,(t79:1.114260743,t80:1.097780263):4.073116025):0.08630426929,(t81:1.353504314,t82:1.291453768):3.720398559):1.176901129,t83:5.831577851):0.2170376623,((t84:2.867324982,(t85:0.9899634271,(t86:0.6158272321,t87:0.5297660627):0.1439745282):1.811436011):2.054147035,t88:4.522476366):1.033411533):0.343118003,t89:5.880693613):7.721741419):0.1085978085,((((t90:1.734956266,t91:1.623056606):2.291405533,(t92:3.427543829,t93:3.314632083):0.4058244551):3.66494673,(((t94:0.11656423,t95:0.06077744335):1.151599465,t96:1.125752601):1.115752292,t97:1.842013059):4.953217899):2.104945519,t98:8.812972813):3.906187004):5.125675692,((((((t99:1.065099355,t100:1.000204645):0.7135032145,(t101:0.7097121943,t102:0.6784696653):0.9992177754):1.045370951,t103:2.675519854):1.900547244,(t104:3.215043454,t105:3.214351022):1.325974499):0.8348041511,((t106:0.7012774466,t107:0.6281319062):2.98756385,t108:3.410923186):1.635211853):6.436675114,t109:11.43413855):5.79742699):3.218988921,((t110:12.42501674,(((t111:0.1335631407,t112:0.08023940938):5.003833676,(t113:3.461112832,(t114:1.005669066,t115:0.8886056771):2.391011691):1.592833739):6.624051824,(((((t116:0.3975655935,t117:0.3243254246):0.5705983914,t118:0.755555654):3.192106757,t119:3.76476183):1.549126021,(t120:3.105001376,(t121:1.289007025,t123:1.02391658):1.786676928):2.059253035):4.32369556,((t124:2.057111696,(t125:0.31671208,t126:0.1176467817):1.305565101):4.882826112,(t127:3.314004832,(t128:1.138281426,t129:1.055112559):2.161206811):2.966724002):2.228459427):1.271396765):0.6333997362):2.248643939,((t130:4.376347509,t131:4.35064953):3.591791519,t132:7.897309862):4.563966114):5.614467285):2.303046716,(((t133:4.606259157,(t134:2.665663831,t135:2.55166099):1.897869079):11.56794986,((t136:0.3963286729,t137:0.3689345686):4.437663711,(t138:2.229098588,t139:1.996544634):2.496212316):11.12777288):1.386271629,(((((((t140:1.000868803,t141:0.9493288128):1.188878719,(t142:2.036184665,t143:1.967315214):0.006667729573):0.171113988,t144:2.120996794):0.4906240693,((t145:1.196355041,t146:1.16406376):0.3237001432,t147:1.378812914):1.038706888):0.8962284785,((t148:1.118883183,t149:0.9504508562):0.8527050692,t150:1.790430201):1.339721682):0.2181210641,t151:3.316404197):0.5972997017,((((t152:0.1435590401,t153:0.1025817474):0.6881246352,t154:0.7401053757):0.2556603801,(t155:0.2871604938,t156:0.1736231953):0.6834093826):1.886860665,(t157:2.54745545,(t158:2.204808287,(((t159:0.8658755094,t160:0.8415300304):0.1073898382,t161:0.9318576968):0.4098595718,t162:1.048176956):0.7308874936):0.3194181285):0.05640637518):0.8251618491):12.35227929):2.638828897):1.184098671):1.086431205,((((t163:4.692617211,(t164:3.811011457,(t165:1.635479533,t166:1.587368477):2.13574709):0.8163208381):4.727801547,((t167:4.227883299,(t168:0.2638318565,t169:0.2360733238):3.949298965):2.834047534,((t170:2.150259181,t171:1.973745397):2.983359377,t172:4.92130475):1.809632508):1.999895704):2.944697223,t173:11.49278741):3.710437326,((t174:1.393400635,t175:1.318042203):0.1405057892,t176:1.220603976):13.55758009):4.010595939):1.760694046,((t177:10.82601786,t178:10.75346743):1.022286427,t179:11.68563205):8.609018638):1.195968995):2.637138926):0.3862728302,((((((t180:1.501423911,t181:1.108320286):0.7113457445,((t182:0.0400024531,t183:0.0215452625):1.720200263,t184:1.695270186):0.02447252333):0.3643283698,t185:2.052595339):3.75981124,t186:5.508711595):5.449956021,((((t187:4.541430484,t188:4.512514174):0.9288113341,t189:5.100661894):0.5684675569,((t190:1.34474267,t191:1.297709096):1.000643876,t192:2.16404389):3.260893338):3.079680366,t193:8.154187984):1.632193568):1.551204008,t194:10.93379218):11.05822628):0.6585009194,(((((t195:1.085060329,(t196:0.8020161706,t197:0.6937334607):0.2598823131):2.200800122,t198:3.110445118):9.126232255,(((t199:2.395803407,((t200:1.149659493,t201:1.148417526):0.230203199,t202:1.351183673):0.9456466099):2.888416764,t203:4.970452103):6.537213582,t204:11.33321122):0.3706559966):3.480555324,((((((((((t205:0.8955535475,(t206:0.3586160017,t207:0.04850860247):0.4647186122):1.829358536,t208:2.164820281):1.379424787,t209:3.529456024):0.1214366644,(t210:1.288934674,t211:1.118549183):2.340470636):0.03335075338,t212:3.335043624):1.32403479,(t213:0.8199136028,t214:0.7020318358):3.78285565):2.745182487,(((t215:1.815660942,t216:1.679408669):3.228460684,((t217:1.152585919,t218:0.8619062106):2.244800197,(t219:2.835866431,t220:2.79302134):0.1990044782):1.438541139):1.923332508,t221:6.307862743):0.1487335536):2.32603867,t222:8.74487466):0.6701264982,((t223:2.20650535,t224:1.997265122):2.474765516,t225:4.426072203):4.669765951):2.5466872,(t226:3.697889723,(t227:2.096368139,(t228:0.8113817416,t229:0.7688615799):1.251657493):1.345239433):7.794436502):1.312433972):2.569560161,(((t230:1.577921974,t231:1.348890199):1.297924355,((t232:0.5344590189,t233:0.5245810424):0.3956321593,t234:0.8390292691):1.525019515):0.8726569162,t235:2.790237811):11.25174171):4.058008793):4.109412804):1.472212636,((t236:5.789140119,(((((t237:1.607668211,(t238:0.9651352286,t239:0.8718655931):0.6420323119):0.2427235497,((t240:0.02265990118,t241:0.005414900948):0.9358158394,t242:0.7973441192):0.7226863712):0.5628916603,t243:2.022886548):0.3936976755,t244:2.359761803):2.709394689,((t245:1.863847303,t246:1.422329693):0.8019003943,(t247:1.40272391,t248:1.385329015):0.807367245):2.379992604):0.2580367681):12.43315321,((((t249:1.653640551,t250:1.395843692):2.263350368,((t251:0.3343408359,t252:0.1343893851):1.097374978,t253:1.209752162):1.770523009):5.200066926,(t254:2.162293228,t255:1.973970707):6.003513639):7.248622938,((((((t256:0.7867124408,t257:0.7595375941):3.727977687,t258:4.336025364):1.978593148,(t259:1.743731417,t260:1.528589062):4.550845046):1.001460902,(t261:1.645544129,(t262:1.099272856,t263:0.9587793886):0.3982770562):5.25540774):0.01046406748,((t264:1.523273823,t265:1.4536256):2.135185377,t266:3.38417209):2.928833336):2.434461959,t267:8.551493664):5.270268612):0.8154016205):5.449533285):4.717514995,(((t268:4.611270451,t269:4.582503116):11.61157211,((((((t270:3.757084002,((t271:1.468237048,t272:1.404091261):1.263174945,(t273:1.318062201,t274:1.205734532):1.347330626):1.003494017):7.905694916,(((t275:3.889927136,t276:3.87023569):5.31429092,(t277:0.469619401,t278:0.4038043164):8.514404219):1.587260308,(((t279:2.019596838,t280:2.009321271):0.5922833909,t281:2.337409873):5.426981503,(((t282:1.740296741,((t283:1.024396124,t284:0.5564301418):0.03760218708,t285:0.3695070835):0.6615976316):0.2875304658,t286:1.188238974):4.971093289,t287:6.151247554):0.5469027899):2.453061098):0.4756926074):0.7458716989,((t288:0.6608075815,t289:0.5242481486):4.492634409,t290:4.822235989):5.143264676):2.771151749,((((t291:1.420157299,t292:1.087569137):4.885626721,((((t293:0.8008624165,t294:0.6136488382):0.9962297701,t295:1.543469324):1.902379208,((t296:1.749931434,(t297:0.4817327744,t298:0.4039806918):0.9558292479):0.9772450031,(t299:1.463008595,t300:1.342737291):0.7862536974):0.5292550001):0.6163795922,t301:3.220489176):1.566408937):3.391320632,(t302:2.393495858,t303:2.299559577):5.620606776):0.06547968526,(t304:3.514732672,(t305:1.832784979,t306:1.809230425):1.531471625):4.465709396):2.908657134):0.1805264755,(t307:1.42059384,t308:1.192646784):9.195407767):0.5777090817,(((((t309:2.326877589,t310:2.324358073):2.689843098,(((t311:0.3491772933,t312:0.3052413559):0.1620939231,t313:0.3769890018):2.094236503,(t314:1.366899301,t315:1.331569668):1.057331564):2.399226968):0.5453880175,(t316:4.386406387,(t317:3.028829455,(t318:2.373577744,t319:2.210345749):0.3972835384):1.26283739):0.8932590389):1.107092486,((t320:4.33740227,(t321:3.192182654,(t322:0.3887919983,t323:0.3627850776):2.76727711):1.105479598):0.5673763427,(t324:2.180096369,t325:2.135444026):2.483075811):0.9512327927):1.607818283,((t326:2.739001037,((t327:0.9339558239,t328:0.9025488127):1.257378536,t329:2.01095594):0.545113737):1.624214715,(t330:2.369092096,t331:2.340222762):1.785414489):2.742938211):2.603729108):0.1078669709):1.783735691,((((((t333:1.019503515,t334:1.017804594):0.5290467632,t335:1.542522973):1.961597622,t336:3.436224773):1.457939501,t337:4.683709687):1.927464027,((t338:3.965723796,t339:3.960476632):0.3022184991,t340:4.202116724):2.237387424):1.673674131,(t341:6.798847317,((t342:4.007009023,(t343:3.058172475,((t344:0.5364080203,t345:0.4893292237):0.1073401376,t346:0.5919824916):2.265210618):0.9211912908):0.562415092,t347:3.902408377):2.208997944):1.164873843):2.586657):6.768581381):3.424553359):18.22411556,(((t348:11.56504178,(((((t349:0.6840623204,t350:0.678121335):3.552750976,((t351:3.641302045,(t352:3.346943197,((t353:0.5014855088,t354:0.3871505129):2.36959932,t355:2.697715203):0.447135545):0.2021581664):0.3083400893,(t356:2.780842112,((t357:0.3247944627,t358:0.1737784648):1.922657363,t359:2.092128652):0.5301511496):0.7121436168):0.2330146514):0.4258224987,t360:3.707331147):0.5388084815,((t361:0.7568492937,t362:0.6756885937):1.723463208,t363:2.341302341):1.74957323):2.723475425,(t364:6.10233074,((t365:2.35887017,(t366:1.633442655,(t367:1.5440747,t368:1.267951308):0.02563552624):0.5891635102):2.802464685,t369:4.406718295):0.9346488245):0.5064821714):3.467986819):0.06990737914,(t370:0.5499985923,t371:0.4328723309):8.804209828):22.0295293,((t373:9.081658595,(t374:2.687778125,(t375:0.8952361506,t376:0.7606847587):1.769857094):6.243178651):21.60429553,(((((t377:2.063570741,t378:2.047319647):0.7700031978,((t379:2.374140204,t380:2.267785834):0.07474439068,t381:2.266596314):0.3572479432):1.669798248,t382:4.027641735):3.060981723,(((t383:0.2260084879,t384:0.1672316343):2.35080412,t385:2.421886303):4.382542076,(t386:4.770902,(t387:2.061213601,(((t388:0.2829793622,t389:0.2567865644):0.6139212266,t390:0.7762065257):0.861806824,t391:1.414745183):0.1859723714):2.646712548):2.011176171):0.07404546438):9.580559903,(t392:8.158066571,((t393:3.95134711,t394:3.834034796):1.864484299,(t395:5.132105846,t396:5.11636086):0.4192782933):2.265837559):7.7529703):13.18489746):0.3266349291):4.609891507):14.54976879,(((t397:10.75067013,t398:10.72445587):10.4263581,((t399:1.98374197,(t400:0.3016179025,t401:0.03354471762):1.664708341):8.913862043,t403:10.36018064):10.23361828):14.47858623,((t404:2.893045311,t405:2.409984568):7.064903496,((t406:5.208789759,(t407:3.653006924,((t408:0.5287885489,t409:0.4231659067):0.04249396171,t410:0.2917194227):3.05880464):1.523595095):3.268362088,(((t411:3.01431378,t412:2.989282745):1.322775005,((t413:1.916083106,t414:1.823805742):1.202614415,((t415:2.013933608,t416:1.766842977):0.5228159852,t417:2.188526239):0.4476858157):1.081917075):2.906119091,t418:6.542051282):0.8293070211):0.8921132375):25.09513667):12.46939262):48.84013244,(((t419:0.3530641727,t420:0.3342066941):19.65803505,(((t421:3.398920552,t422:3.24800682):0.5198069123,(t423:1.52806767,t424:1.340740253):2.210699521):3.063206633,((t425:1.197009279,(t426:0.6102063834,t427:0.5945201103):0.4110351698):2.767971865,t428:3.595037744):2.512120334):12.86406354):23.32919185,((t429:18.40736994,(t430:5.755781511,((t431:2.347055755,(t432:0.5954335359,t433:0.5058109452):1.733324867):2.9900691,(t434:0.9900536038,(t435:0.6223914038,t436:0.6109866385):0.352551074):3.970211012):0.04458396638):12.38521893):14.17122043,(t437:10.35213224,((t438:5.848362692,((t439:1.321142041,t440:1.304013618):1.760394635,t441:2.941831377):2.641494688):2.206867931,((t442:2.397506558,(t443:0.2159126977,t444:0.065368926):2.122665872):1.727683773,(t446:3.659252189,(t447:1.500402069,t448:1.427654143):1.986086131):0.1217424673):3.422160784):2.119610248):21.05184385):9.594419694):51.24679503):20.7448311);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T55.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
