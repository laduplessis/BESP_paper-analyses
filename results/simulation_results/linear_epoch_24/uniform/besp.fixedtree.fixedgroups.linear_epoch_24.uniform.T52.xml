<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t407:5.215006714,(t408:1.06434515,t409:1.014032554):4.129433523):1.952081827,(t410:1.511323527,t411:1.03191014):5.421563654):0.7034819145,(t412:3.614622667,t413:3.365859614):2.876288394):40.00474875,(((t414:0.4007592208,t415:0.3518465573):4.415244355,(t416:2.564872988,t417:2.539615182):2.160087778):0.3657791399,(t418:0.3044514764,t419:0.2826494859):4.738001826):40.86423714):8.277948895,((t420:3.889986335,t421:3.796191714):16.67799671,((((t422:3.36628177,t423:3.245992871):2.428790583,(t424:5.033207205,((t425:2.88369073,((t426:0.6122478274,t427:0.507871936):1.702385302,t428:2.007115469):0.5224880341):1.2806507,(t429:2.134243321,t430:1.943175595):1.645689966):0.7205828101):0.499608348):4.030335368,(t432:4.784630647,(t433:4.54080845,t434:4.495509358):0.1807940504):3.390104764):9.482816954,((((((t435:1.739200982,t436:1.738114806):1.127873618,t437:2.759096705):3.011505483,(t438:4.538702015,t439:4.501515798):1.226047241):2.685896692,(t440:0.4880222266,t441:0.4430433514):7.756652861):4.120851781,((((t442:0.07819915266,t443:0.04121877981):6.117609657,((t444:0.7868610837,t445:0.724303942):4.502953096,(t446:3.182507348,t447:3.137955902):1.824722347):0.7388595845):1.439865226,t448:7.062572997):4.571381206,((t449:3.641724731,(t450:1.487902414,t451:1.431505683):1.976472096):2.469069264,(t452:0.1792856703,t453:0.09269143566):5.631608196):5.465310759):0.02474524635):1.664063582,(t454:6.101936055,t455:6.043758003):6.745985836):3.0442125):1.154782058):33.48925873):105.657405,(((((t456:0.3821140725,t457:0.2195875143):10.71276772,t458:10.691498):8.886705745,(((t459:3.616589396,(t460:0.3252533443,t461:0.2320749798):3.239268386):1.86140006,t462:5.150253271):13.96932362,((t463:3.995864488,t464:3.898004252):2.437958731,(((t465:0.9224323969,t466:0.8957165948):0.005624654112,(t467:0.08711938519,t468:0.0831158185):0.6322956245):0.6362383189,t469:1.21937095):4.637065702):12.54835364):0.0600002443):18.10977859,(t470:23.00734282,(t471:3.798435812,t472:3.779069975):18.97893779):13.49501795):2.678372957,((t473:3.947469257,(t474:2.341682079,((t475:1.303218269,t476:1.265016731):0.9817517335,t477:2.218636764):0.0481701508):1.450556522):18.80901796,(((t478:1.807678948,t479:1.770501457):12.48279136,(t480:6.027117772,((((t431:0.3463609772,(t385:0.05739721235,((t371:0.0847693347,((((t306:0.04123176699,((t176:0.074216006,(t132:0.1640431868,(t111:0.1439676311,(t70:0.02538465267,(t47:0.07784090274,(t1:3.577905362,t2:3.570702542):0.7840066753):2.246811363):3.766373623):2.04349949):3.617491202):3.149357935,(t3:12.74436696,(t4:7.721690173,((t5:2.275508014,t6:2.247668675):4.873005918,t7:6.992891406):0.5486554007):4.969913446):6.388552846):9.123246107):3.488283129,(((((((((t8:0.6184792559,t9:0.4864053455):5.937720731,(t10:5.344469458,t11:5.326174427):0.8582929367):0.2452200946,t12:6.200385331):2.751435413,(t13:4.49118105,t14:4.337679768):4.403964291):1.134811656,((((t15:0.7743129713,t16:0.7442230164):0.927662903,t17:1.649833706):0.6181074236,t18:2.149310653):5.219676824,(((t19:2.501704075,t20:2.451290886):2.163532922,t21:4.557854358):2.614855558,(t22:2.048247431,t23:1.994394016):4.92852666):0.04184948211):2.19551933):8.821479321,((t24:4.765349236,(t25:4.374185964,(t26:4.160954559,(t27:3.302596905,t28:2.99610459):0.8137121902):0.1708815414):0.2381544581):5.340843476,(t29:3.936964244,t30:3.659241525):5.615332966):7.847653119):0.03883877363,((((t31:1.354574878,t32:1.261934675):4.400657569,t33:5.601544743):1.024182726,((t34:0.9679670557,t35:0.9269697973):2.3047104,t36:3.129101445):3.301326068):7.02641208,(t37:2.207439824,t38:2.197447026):11.22230205):3.205253471):1.488892402,((((((t39:3.804217486,(t40:2.943009331,(t41:2.119947764,t42:1.970148597):0.7914645434):0.823595081):4.346786104,t43:7.865471493):2.554905399,(((((t44:2.451897767,(t45:1.108646068,t46:1.073572433):1.310021255):0.5477529091,t48:2.691050668):1.276343596,(t49:0.6455911159,t50:0.6409883368):3.278215595):1.649854202,t51:5.519921039):0.7864181487,(t52:5.467395127,((t53:0.3842347899,t54:0.1273708103):3.999707166,t55:4.099686204):1.009456357):0.8266532035):3.258710949):1.379395444,((t56:4.54325351,((t57:2.930040568,t58:2.857160058):1.34324966,t59:4.1112743):0.1317763853):4.663068966,t60:8.698935817):1.179956134):0.8310323958,(t61:8.319791464,t62:8.281966323):2.354001853):1.883531807,((t63:2.937758993,t64:2.746411901):9.021090372,(t65:3.339221792,(t66:1.930143841,t67:1.893133457):1.0749045):8.350005662):0.5427941471):3.190054739):10.09645679,((((((((t68:1.31287741,(t69:0.527059567,(t71:0.2092290288,t72:0.06756135819):0.1562633802):0.6661540655):4.128395192,((t73:1.97314899,((t74:0.1915079326,t75:0.1704862582):0.1111740196,t76:0.1715874615):1.522759649):1.981163858,t77:3.629343686):1.01878017):0.5583901,(t78:3.79056934,t79:3.712116993):1.303822494):1.733292329,t80:6.732260229):5.522254006,((t81:1.415521248,(t82:1.244120372,(t83:0.9464529166,t84:0.7573749213):0.07095766216):0.1383539233):5.490030208,t85:6.422784777):5.114658384):9.28249662,((((t86:0.4714727535,t87:0.367929558):7.063052413,t88:7.416797513):6.421565743,(((t89:10.76124127,(((((t90:1.026940573,(t91:0.6348046035,t92:0.5567680936):0.1958991788):0.722149044,t93:1.466906654):0.1429881437,t94:1.602800866):2.156759931,t95:3.716063338):3.762256457,((t96:4.745851542,t97:4.664294614):1.676179866,t98:5.824469145):1.02180613):2.943083321):0.2941564729,(((t99:8.423212567,((t100:3.479494948,(t101:1.993188489,((((t102:0.2529182234,t103:0.2071104003):0.2664415092,t104:0.2105312125):0.2802605152,t105:0.4834464713):1.082377091,(t106:1.299102485,t107:1.157309738):0.2480161604):0.08197950845):1.470777099):4.188331575,((t108:2.811058738,(((t109:0.1006477339,t110:0.02303569661):0.5772875001,t112:0.2500736176):1.42704899,t113:1.645509371):0.647239396):2.393346345,((t114:1.090323303,t115:0.8757136481):3.409152892,t116:4.183275479):0.146107517):1.931398248):0.7170285674):0.9199524675,t117:7.668192302):0.4364437495,((t118:2.88081456,(t119:1.568816423,(t120:0.244851416,t121:0.08583328129):1.265047488):1.170837172):0.7923684068,t122:3.308110319):4.422466076):0.2611725804):2.465616419,((t123:3.362818869,t124:3.312162114):6.31712991,(((((t125:2.288548631,(t126:0.3565219571,t127:0.3055242351):1.91700113):0.1629074907,t128:2.313233458):2.598318478,(((t129:0.614036163,t130:0.340121696):3.612012955,(t131:2.013792658,t133:1.647173621):1.792621336):0.3067542244,(t134:1.277654903,t135:1.202088523):2.468620279):0.3363320216):0.4956228846,t136:4.478066648):0.6272488688,t137:5.051587696):3.388639225):0.7319173727):0.264918886):4.66227146,(((((t138:7.505116842,(((((t139:0.9563271619,t140:0.9017101295):1.484248531,(t141:2.214571051,t142:2.174447691):0.003574862685):2.074000922,(t143:3.553867685,((t144:1.058015027,t145:0.9823985199):2.162106197,(((t146:0.09733851607,t147:0.004053247898):0.2018915444,t148:0.2006526644):0.7531614295,t149:0.8874927652):1.975238799):0.3002853855):0.6626615598):0.1640510934,t150:3.703203446):2.492254328,((t151:1.229575,t152:1.214087466):0.9303500891,t153:2.064014185):3.815330294):0.2071370722):0.9388768042,(t154:3.064244508,((t155:1.653690639,t156:1.528771441):0.9930047876,t157:2.489565851):0.38198435):3.837678922):3.764467419,(t158:3.962695313,(t159:3.711312689,t160:3.520181455):0.193767198):6.478214298):1.150368045,((((((t161:1.568288808,t162:1.443875527):0.2744727067,t163:1.696415408):0.7048685323,t164:2.318354213):0.7243409802,t165:2.944363581):2.02385182,(((t166:1.287605286,(t167:0.2656538206,t168:0.1592846218):0.7994230203):0.4171355675,t169:1.270510572):0.2564138255,t170:1.504624707):2.896412522):3.577780066,((t171:0.1934712361,t172:0.09356748963):3.407115417,t173:3.462009474):4.377056336):2.465495542):0.1890071706,((t174:1.228331541,t175:1.180562997):3.337200181,t177:4.287847064):5.818375046):0.4932234223):2.133102219):0.1736212387,(((((t178:0.6578909333,(t179:0.5896764711,t180:0.5825072501):0.04661828138):0.4069684294,t181:0.5869306176):4.362460829,t182:4.915871355):4.057250258,((t183:2.48693651,(t184:1.016514504,t185:0.9635153115):1.44372948):5.339679947,(t186:4.551503633,t187:4.419507444):3.17375142):1.069251608):1.705499535,(((t188:1.772180642,(t189:0.8604172771,t190:0.7640457363):0.8898620579):2.821055865,(t191:1.548774859,t192:1.504416943):2.804426918):3.220110273,(((t193:4.264776276,(t194:4.012824425,((((t195:1.426531874,t196:1.387197756):0.9127584107,((t197:1.584186762,t198:1.536751402):0.4263583588,(t199:1.714880879,(t200:1.529356298,t201:1.379473204):0.1675925664):0.2042900708):0.2828619221):0.9480198435,t202:2.916354273):0.2523037377,t203:3.122140128):0.4362692038):0.177508442):1.30209543,t204:4.866874978):1.444901684,((t205:1.322378628,t206:1.176640538):3.997291019,(t207:2.518876962,t208:2.512258691):2.26713039):0.9103464695):0.5020898427):2.497476951):1.639639396):0.6708195914,(t209:1.697704164,t210:1.489461328):9.077035505):1.743196063):0.3048609288):0.1563341163,(((t211:1.524134653,t212:1.485699101):4.096470085,(t213:2.972883551,t214:2.950448709):2.446571984):2.238778751,t215:7.599788928):4.82413601):0.3125299594,((((((((t216:1.532444345,t217:1.24457375):2.991523198,(((t218:0.1635086635,t219:0.1469787267):0.1384093421,t220:0.2638101211):3.747500135,((t221:3.436935627,(((t222:1.437558114,t223:1.431372213):0.4458720272,(t224:0.9011073765,(t225:0.08851136704,t226:0.06993659091):0.7637950144):0.9704498191):1.24774529,t227:3.039725906):0.244066084):0.05932303489,t228:2.992553537):0.4666192806):0.1502005993):0.9731188472,(t229:2.231250499,t230:2.162853854):2.28466718):1.176386769,(t231:0.1446936734,t232:0.1242701218):5.32392267):4.383730246,(((t233:3.459614777,(((t234:0.7105574553,t235:0.5395246014):0.0533044134,t236:0.5244814024):0.4802725154,(t237:0.6724978878,t238:0.6580796504):0.2546143697):2.209403824):2.989962838,(t239:4.147409384,(t240:3.88973108,(t241:2.795227478,t242:2.637100334):0.9652848611):0.0520848455):1.954380257):2.077945205,(((((t243:1.270371837,t244:0.8069223235):2.27820341,t245:3.079286646):0.2185310927,t246:3.184273032):1.070456228,(t247:2.296451148,(t248:1.319801477,t249:0.6501217252):0.8201981248):1.95769034):0.8293999725,t250:4.204346206):1.684375729):1.275094882):0.1328622807,(t251:2.79501927,(t252:0.4904838125,t253:0.382133056):2.292407303):4.493707404):1.289323195,(t254:1.525107859,(t255:0.8843801764,t256:0.8095988987):0.576568688):6.802600066):0.1401076339,((((((t257:3.010356871,t258:2.938968807):0.1986380585,t259:3.107032229):0.1617877644,(t260:0.5560072516,t261:0.5466733426):2.691490732):1.274215587,t262:4.246133645):0.3277191462,(t263:1.205087228,(t264:0.5410422456,t265:0.469055677):0.6597603835):3.343261587):1.61543361,(t266:5.186622497,(t267:4.832814179,((t268:3.678199661,(t269:0.5235645532,t270:0.5121399722):2.920045738):0.449473062,t271:3.772683482):0.7020566114):0.1985480101):0.870385745):1.591403397):0.1142051135):2.931591538):0.7385591003,(t272:3.005487115,t273:2.899188356):7.850007554):0.6457740152):6.8584827):1.935762792,((t274:18.8781935,((((t275:1.999825725,t276:1.890022259):0.7547830754,(t277:1.781023797,t278:1.761079975):0.8630360549):0.2447819862,((t279:0.6213195593,t280:0.5129421841):1.198446396,t281:1.576342514):0.9485337486):13.5660955,((((t282:2.089107448,t283:1.877222725):5.624984894,t284:7.497760489):4.374278696,((t285:6.177637464,((t286:2.294278408,(t287:1.12704974,t288:1.123718962):1.144723851):0.3068792332,t289:2.443616855):3.527416073):5.200311688,((t290:1.603404148,t291:1.582098723):3.737625951,t292:5.235939668):5.456322983):0.4007062889):3.277375361,(t293:1.503406782,(t294:0.3562124613,t295:0.1963836518):1.043242493):12.78649564):0.6327312212):2.218756206):0.3833915715,((((t296:6.18668366,(((t297:3.49784876,(t298:2.94763846,t299:2.772205913):0.452667851):1.147025223,t300:4.34701573):1.302486562,(t301:0.6521742462,(t302:0.2463093151,t303:0.2428221752):0.3547751138):4.881234477):0.1885382182):1.056761657,t304:6.48124913):2.340362136,((t305:0.5816476737,t307:0.5051028915):6.064464161,(t308:1.169219802,t309:1.034935712):5.289773374):2.038079668):2.271142472,((t310:2.798297438,t311:2.730116469):0.3078819244,t312:3.019652298):7.506566607):5.314656271):0.8617626554):0.4127637612,((((t313:2.890992598,t314:2.869956128):0.02063873896,(t315:1.140508288,t316:1.105698757):1.593922122):0.7665048816,t317:3.441966229):6.442427368,((t318:7.372987724,(t319:5.069275795,((t320:1.024178285,t321:0.9162219451):0.7698108559,t322:1.682246923):3.199917844):2.228629798):0.2463732298,((t323:6.041250557,((t324:0.2408525094,t325:0.2330478232):4.926610848,(t326:3.891998069,(t327:1.977319003,t328:1.901290232):1.901960988):1.007263895):0.8552981064):0.02964982224,(t329:4.44039769,t330:4.099224246):1.216131148):1.110106102):2.104583167):6.899408049):7.938370195,(((((((t331:1.282681234,t332:1.018929801):1.424757601,t333:2.221769032):3.012589231,t334:5.13653118):4.477081037,(((((((t335:0.6189703704,t336:0.4990229514):0.7170842616,t337:1.205482423):0.4068585631,t338:1.509834643):1.436293854,t339:2.868356758):3.120415988,(t340:0.325711074,t341:0.1924101721):5.507076213):0.3264423675,t342:6.01484084):2.334730904,(((t343:1.37141392,t344:1.355544501):5.586234685,(t345:2.370074368,t346:2.316748851):4.084087648):0.289703714,(((t347:2.572822422,t348:2.043878583):1.867775395,((t349:1.222821582,t350:1.219560474):0.0002824336229,t351:1.058934311):2.585133222):0.111096986,t352:3.749636326):2.056827611):0.9583504372):0.508476024):3.292188825,(((((t353:1.612268546,t354:1.471650848):1.295953412,t355:2.766353089):2.1990263,t356:4.857167863):1.641067038,((t357:3.018283749,t358:2.80852886):2.907824689,((t359:1.985789707,(t360:1.946418801,t361:1.877722026):0.03047602201):0.73413423,t362:2.622644594):2.978437113):0.2596261651):3.032161395,(((t363:4.1426672,((t364:2.05317956,t365:2.007309632):0.3467418778,t366:2.180840331):1.717526163):1.232072369,((t367:0.5473574714,t368:0.4996927299):2.764529259,t369:3.215207674):1.676644721):1.291410705,((t370:1.180658095,(t372:0.7968141649,t373:0.5885191884):0.2378137066):0.5965468991,t374:1.413418961):4.226879457):2.214098263):0.7210266182):1.112987303,(t375:1.562114515,t376:1.506140461):8.109823228):5.584759826,(((t377:3.870499836,((t378:1.173668313,t379:1.161425136):2.142474447,t380:3.27884658):0.4811368023):3.223502591,(((t381:0.3273454049,t382:0.2411169029):0.450320046,t383:0.403700229):4.446818976,t384:4.714833683):1.59309363):7.567209964,((((t386:1.280106704,(t387:0.4453944434,t388:0.3646015385):0.7268168658):0.4588445758,t389:1.420888203):0.8166596793,(t390:1.974738806,(t391:1.423921507,t392:1.37800533):0.3815027896):0.06357765353):8.642056528,((t393:1.66081254,t394:1.61491074):6.320122646,(t395:6.496635401,(t396:1.293085821,t397:1.135508783):5.17983665):1.40530517):2.173462871):2.21793377):0.4676448429):3.025772263):0.1830053804):8.054044065):2.309127172,(((t398:8.080619507,t399:7.834594671):0.066533969,t400:7.704208606):4.449240221,((t401:1.514745033,t402:1.440718218):6.388036282,(((t403:3.449321346,t404:3.388228971):3.068505852,t405:6.339916558):0.7422959508,t406:6.782528183):0.4148372622):4.188480164):13.54329866):5.906994352):16.1717954):115.2391389);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T52.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
