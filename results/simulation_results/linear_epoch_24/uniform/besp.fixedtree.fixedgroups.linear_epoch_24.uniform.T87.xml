<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t468:0.03932104816,t469:0.005844383472):9.010903063,((((t470:0.4685129385,t471:0.4003645672):0.5358658606,t472:0.7796990157):2.5187316,t473:3.213346914):5.216522566,((t474:1.72382195,t475:1.590682303):1.037614267,t476:2.608140675):5.40256281):0.242912742):16.76228527,((t477:3.938050335,(t478:1.575292648,t479:1.566537486):2.35297622):1.503834972,t480:5.320024268):19.57390275):6.637342617,(((t481:1.584997752,t482:1.558275478):2.563309731,t483:4.093370536):0.8068211861,t484:4.828288784):26.54495685):173.2774083,(((((t485:0.7034689957,t486:0.5076874029):3.661074722,(t487:1.104450412,t488:1.086566277):3.027188274):9.877804479,((t489:0.9633924846,t490:0.9616025967):1.189108811,t491:2.059442462):11.82150704):59.78673987,((t492:14.34528161,((t493:4.316985139,t494:4.17334671):5.671272815,(t495:0.9706302977,t496:0.9564020995):8.861099907):4.251817245):56.56017813,((t497:35.20211345,(t498:13.07858724,(((t499:0.08301985687,t500:0.02049721456):1.957929962,(t449:0.1309427256,(((t382:0.05450267152,(((t317:0.114229812,((((t288:0.04553492473,((t271:0.1275311594,(((t208:0.04905857577,(((t85:0.0309953857,((t1:3.704264838,t2:3.580788778):1.659896939,t3:5.163168594):2.583546144):5.008263811,t4:12.5693478):1.316790099,((((((t5:2.094749482,(t6:1.19097283,t7:1.179915216):0.6740059214):3.189677618,t8:4.873797004):2.387938007,((t9:2.080450877,(t10:0.9441012764,t11:0.8981938078):1.132092955):1.91324819,t12:3.929174185):3.265755558):0.8249612649,((t13:0.313105613,t14:0.2300550421):6.617306718,((t15:4.917326654,t16:4.840606195):1.592241383,(t17:1.405247067,t18:1.401652089):4.935809059):0.08477362327):1.032506484):4.611907105,(((t19:0.4104751227,t20:0.3848572322):5.754759493,t21:6.053990969):1.706688607,(t22:7.076948513,(t23:6.694773518,((t24:3.58342993,t25:3.555040483):0.6690318277,(((t26:0.5635007412,t27:0.2554629269):1.011683672,t28:1.237178833):0.2306188156,t29:1.375050626):2.279813719):2.311791063):0.2533238768):0.6817114934):4.192167691):0.1823743853,t30:11.15077945):0.571215045):6.050356557):1.531544011,((((((t31:0.6122472816,t32:0.6077454937):9.606546607,(((((t33:3.729240381,(((t34:0.190992721,t35:0.1438549716):0.4348371452,t36:0.53882693):1.422848087,(t37:0.4834252647,t38:0.4833174715):1.242536988):1.617632386):1.167000094,t39:4.356538568):0.6917357216,((t40:2.579261067,t41:2.408213534):2.452764546,(((t42:0.6791716881,(t43:0.06043211652,t44:0.02026913131):0.5537518753):1.379702647,t45:1.935261526):0.5315578984,t46:2.294338606):2.217789514):0.01054462982):0.6268549354,(t47:2.636836951,t48:2.424993374):2.468669161):3.142522004,(t49:3.59504485,(t50:2.956910068,(((t51:1.23350821,t52:1.216295204):0.5656844636,t53:1.781248729):0.669794379,t54:2.384462019):0.3804690184):0.4951734727):4.391882127):0.7120815026):5.476415021,t55:13.80632789):0.5496228428,(((t56:2.66557145,(t57:0.2864987578,t58:0.2461177374):2.376677937):0.1328135152,((t59:1.449377754,t60:1.417195454):0.1626300341,t61:1.351271379):1.079253576):8.932986485,(t62:11.10126178,(((t63:1.044386779,t64:0.5784330043):4.637404183,((t65:2.902874372,t66:2.833329727):1.387393564,t67:4.220060456):0.8645740281):5.065046159,((t68:9.034606147,(t69:7.302513304,t70:6.967279136):1.63781982):0.672321554,(t71:8.009134182,t72:7.843299235):1.20025211):0.2893022442):0.2036315119):0.178536862):2.374569241):0.3825260862,(((t73:4.056581033,t74:3.836126696):5.551938072,((((t75:0.1733355777,t76:0.1662663621):2.333182552,t77:2.266708791):3.582932624,((t78:1.170157894,((t79:0.5070877427,t80:0.42263384):0.05303995551,(t81:0.2123665767,t82:0.2109901117):0.1011287304):0.5864305621):4.284664165,((t83:1.790900738,t84:1.790265202):1.460143083,t86:3.112888479):1.917843935):0.3384868381):2.227561347,(((t87:1.407584023,t88:1.205990412):0.2325565471,((t89:0.4129873844,t90:0.329291751):0.3088666426,t91:0.6377214916):0.6233982737):3.208274624,(t92:1.298696887,t93:1.091961973):3.130995871):2.722767627):1.039537341):0.680825222,t94:8.619414711):2.09496135):1.720362964,(t95:0.9402358766,t96:0.8584602547):11.4322372):0.7552174794):2.339089252,(((t97:3.693250493,t98:3.574478158):0.4381040193,(t99:1.9240298,t100:1.905461012):1.999566846):2.442562772,(t101:2.109433102,t102:1.960383775):4.2351875):8.744617664):2.416465589):0.7005810244,((t103:8.558292325,(t104:7.649548771,((((t105:1.071825398,t106:0.965050083):5.828134684,t107:6.705433263):0.03300496665,(t108:4.264887565,(t109:3.832757665,t110:3.661211666):0.3397691368):2.340086227):0.5493987507,t111:6.685487649):0.162630513):0.5310139944):0.08441159261,t112:7.354789774):9.267604618):0.3447506921):0.6271907331,((((t113:3.919926277,(t114:3.346512475,((t115:1.317334078,(t116:0.1546371741,t117:0.1291909328):1.110556937):1.951863898,(((t118:0.2604462133,t119:0.2284879802):0.6817178777,t120:0.8899983243):1.460919028,t121:2.251390521):0.7762283955):0.05235828576):0.4198866789):0.2068965959,t122:3.669931711):2.143992309,t123:5.642816265):2.887113351,((t124:4.507448367,t125:4.272179904):0.7154071315,(t126:4.803455531,((t127:2.209139712,t128:2.023366467):1.620150218,t129:3.643471481):0.8412046752):0.09901124617):3.241673189):8.425338551):0.8202627413,((((t130:0.3288590836,t131:0.3054287273):12.39330648,(t132:1.552642072,(t133:0.8349172707,t134:0.7178979806):0.6228764266):10.80572082):0.02207590101,((t135:10.61342729,(((t136:0.9056689855,t137:0.7864995779):2.16907975,((t138:0.9126212693,t139:0.9097055218):0.1795693248,t140:1.038418777):1.633514012):5.933225834,(t141:0.9589067057,t142:0.9554938993):7.489858035):1.531485763):1.329276516,(((t143:1.830516853,t144:1.732768657):4.271252127,((t145:3.737038904,(t146:2.380160907,(t147:0.7772525205,t148:0.7697260139):1.476086235):1.322567735):2.164384873,t149:5.488983617):0.04684059221):1.958417918,((t150:0.2472429604,t151:0.1368067361):2.023710917,(t152:1.078872359,t153:1.070737474):0.8930155284):5.082023407):3.173848353):0.1981086431):2.042933702,(((((t154:5.321683508,t155:5.240110964):0.09697792315,(t156:3.505295698,t157:3.372052029):1.470824293):0.02361897871,t158:4.720645346):1.002475692,t159:5.665499115):0.283181471,(t160:1.32344323,t161:1.213811398):4.419849609):5.682316888):2.235163154):1.062165108,(((((t162:0.837392465,t163:0.6768223432):2.37871139,(t164:1.848140055,t165:1.576937176):1.183644908):1.727747865,t166:4.43094779):1.692313161,(((t167:0.5024958468,t168:0.4467027728):3.079168191,t169:3.407195693):1.925513306,((t170:0.7851706276,t171:0.7552984397):2.200688685,(t172:1.541059219,t173:1.504360646):1.405998519):2.230647322):0.6125088797):1.127584116,(t174:3.302058101,t175:3.200045962):3.563853628):6.578624132):0.0666936566):1.436085841,(((t176:0.7190353302,t177:0.5373147413):0.1272014133,t178:0.4364629853):5.040119487,t179:5.435228907):8.832246906):4.079190245,((((t180:3.765262367,(t181:2.628068709,((t182:0.1471890791,t183:0.0287325971):1.20242827,t184:1.045775635):1.069585505):1.053744848):8.242292024,((t185:6.217646765,((((t186:0.4149271627,t187:0.2054039668):3.04744607,(t188:2.06047419,(t189:0.3931643497,t190:0.3040987989):1.667078088):1.092441551):0.5060475352,t191:3.565794885):2.069094914,((t192:0.07423705112,t193:0.05680924997):5.132681242,(t194:4.921297014,(t195:4.174564195,(t196:1.28321597,t197:1.165159026):2.885378776):0.6972442425):0.1777485323):0.4016901924):0.1166923967):0.627190502,(t198:0.1192394959,t199:0.106082673):5.859398967):4.519606061):3.283845641,(((t200:4.749482994,(t201:2.515482446,t202:2.18747366):2.195346602):5.123686664,((t203:3.240313071,t204:3.024978518):0.2917873277,t205:3.241518207):5.966343649):1.175918906,((t206:5.205888626,((t207:0.8952917165,t209:0.3818780572):3.842027928,t210:4.216769908):0.367825397):1.275123928,(t211:4.353871635,(t212:0.07534199819,t213:0.02115060161):4.247134492):1.121662074):3.886926503):2.52976045):2.814356672,(((t214:3.239334063,t215:3.120075234):2.919455764,(((t216:1.256234747,t217:1.222509396):4.382391638,t218:5.477439052):0.004428207362,(t219:5.17395949,t220:5.094144376):0.1426891988):0.3745386407):1.06194956,((t221:2.240221143,t222:2.01934912):1.395819232,t223:3.375543468):2.998598787):7.340523835):0.1785742874):0.8828474602):0.9945506464,t224:15.59123886):2.152848069,(t225:17.49118497,(((((t226:3.519250235,(t227:0.6596044276,t228:0.6325734269):2.783241381):1.486586408,t229:4.808360543):2.617565722,t230:7.372432365):1.666813299,(((t231:0.5090118626,t232:0.4555311979):6.118522116,t233:6.560525554):0.2434460378,(t234:3.389355131,(t235:2.613578149,(((t236:0.9299174585,t237:0.8971300829):0.1069668412,t238:0.8990158777):1.070969762,t239:1.893231999):0.4951304829):0.7713198153):3.213323736):1.946168185):7.394396933,(((((((t240:6.42714413,((t241:3.925090683,(t242:1.507482082,t243:1.406756764):2.288445363):2.177612316,((t244:0.2781462978,t245:0.1640374299):1.034553676,t246:1.166892862):4.544898344):0.3117159336):0.4024574058,((((((t247:0.338100937,t248:0.2885949549):0.7984972386,t249:1.079927049):1.740665388,(t250:2.549533723,(t251:0.4538003994,t252:0.3839593009):1.910321799):0.09468480802):0.1812936723,t253:2.562316914):0.8548324995,t254:3.224055955):0.4394932728,t255:3.557061272):2.068677804):1.106998656,t256:6.707144174):0.434101003,t257:7.126167037):3.681622126,(((t258:0.290845055,t259:0.1534002757):0.8802300781,t260:1.006925297):2.091271545,t261:2.999885431):7.42578517):1.17624169,((t262:0.03838249527,t263:0.03569251763):2.364516414,t264:2.112185143):9.137308199):1.060024969,((t265:0.770846083,t266:0.6267827486):11.31465102,(((((t267:3.921556863,t268:3.5494302):0.4351968275,t269:3.715752995):0.3813874116,(((t270:0.4190626853,t272:0.2224454992):1.221278406,t273:1.425371923):1.019466513,t274:2.381980044):1.256333434):3.526487403,((t275:0.9826184888,t276:0.9575907863):5.455887415,(((t277:0.03328166336,t278:0.01294828199):0.8974214803,t279:0.8399708551):0.3328329923,(t280:0.6224073854,t281:0.616127529):0.5188396732):5.135071939):0.6592852174):2.425422764,(((((t282:0.2902723702,t283:0.04246075011):0.1058907125,t284:0.09903144141):0.7922486599,t285:0.8668030567):3.584843136,t286:4.315415337):0.3412561994,t287:4.564829179):4.191526313):1.174100451):0.1671254704):1.404026448):0.5275589418):0.2098924935):3.132886744):6.817305086):4.731455475,(((((((t289:0.2463375341,t290:0.1700156984):3.015039362,(t291:1.220339883,t292:1.213050015):1.861620564):0.04340205599,t293:3.009798049):6.673528571,(((((t294:0.4725035215,t295:0.254531749):0.6050636452,t296:0.7232556521):0.7388036199,t297:1.435421711):1.548718027,t298:2.763490334):1.097295286,t299:3.848471284):5.184461994):7.210467812,((((((t300:1.828667571,t301:1.546363386):0.9708876496,(t302:1.41006157,t303:1.396480935):1.106337097):5.084165626,(((t304:2.044699107,t305:2.033340411):3.874095009,(t306:4.130485439,t307:3.962268119):1.775227493):1.155489007,(((t308:2.940890985,(t309:1.068288265,t310:0.9461547613):1.862875264):2.020283658,t311:4.827576944):1.093863122,t312:5.740021297):0.6982170849):0.4016781477):0.6490006632,(t313:5.18027408,((t314:1.208968716,t315:1.190433217):3.693465136,t316:4.665138185):0.2611738135):2.270811359):0.2915451812,((((t318:1.440749828,t319:1.373054614):0.7879820584,t320:2.077221496):0.5792672263,t321:2.346889356):1.483657959,t322:3.720704546):2.929654793):0.234171584,(t323:0.7340333681,t324:0.6274765041):6.119706699):7.173134066):1.70064292,(((((t325:2.270300187,t326:2.228744031):1.153307542,t327:3.248767913):3.830595945,((t328:2.465889565,t329:2.294067775):3.002687905,t330:5.295215107):1.54451919):0.6335367283,t331:7.401292441):1.46648995,(((t332:1.31060816,t333:1.22726057):3.994226795,((t334:2.299652329,(t335:0.2634220341,t336:0.1592594296):1.97882258):1.839306275,(t337:3.745088381,(t338:2.419005667,(t339:1.842991385,(((t340:0.5852160075,t341:0.5752351809):0.1528027016,t342:0.599911148):0.2523023296,t343:0.7300339145):0.7653525883):0.5522747656):1.216338007):0.2086692021):1.057300777):0.7258799291,(((t344:3.230042214,t345:3.01997583):0.5592831438,t346:3.316938333):0.08213926617,t347:3.191489254):1.380448077):2.750787052):6.063050453):4.566430059,((((t348:0.1820997025,t349:0.05790720712):3.736768421,(t350:1.260305793,t351:1.240943173):2.477221434):3.933545303,(((t352:3.817866492,t353:3.797031936):0.6283540325,(((t354:0.212956183,t355:0.110845298):0.6555677519,t356:0.7513593571):2.253752658,t357:2.99802133):1.216761692):1.029696457,((t358:1.72941922,(t359:0.8189214069,t360:0.7116757698):0.8355610852):0.2022996662,t361:1.366318643):3.267315899):2.111515896):1.695182439,((t362:0.3554391919,t363:0.3531759779):7.575922107,((((t364:0.3380438594,t365:0.2718009135):1.556963279,t366:1.564828753):2.361179375,((t367:0.9168732618,t368:0.8523598155):0.1440113275,t369:0.8608806352):2.862731719):0.5811806348,t370:4.275225913):2.982506263):0.4745108449):8.340365452):3.236743718):6.306111526):21.90707856):18.76142595,(((((((t371:0.7612255549,t372:0.5781380993):0.2550621265,t373:0.5277400149):0.2979439496,t374:0.6587910103):2.302372329,(t375:2.377767363,(t376:1.736107395,t377:1.668728665):0.5451760284):0.5133740073):2.040313445,t378:4.74062398):19.83165011,((((((t379:1.101534032,(t380:0.8586524701,t381:0.8166141654):0.05211568445):1.212013425,t383:1.783923224):1.508296648,t384:3.254980057):2.127309842,t385:5.275839947):5.927278576,((t386:8.877659724,((t387:2.08788527,(t388:1.22652293,t389:1.112501949):0.8560840019):3.112226145,(t390:3.405836423,(t391:2.884484377,t392:2.805770231):0.4718674989):1.623156545):3.652720409):2.223267379,((t393:1.72366613,t394:1.6968321):0.6874815519,t395:2.374533939):8.230366181):0.0007687581709):3.661254854,((t396:11.35497722,((t397:6.146062621,((t398:1.101325748,t399:1.003633465):0.8664035994,t400:1.626776397):4.155782472):1.998152306,(((t401:0.5744500666,t402:0.5637238057):1.448165871,(t403:0.7972457406,t404:0.7215399749):1.049682437):0.622784796,t405:2.389508798):5.093359061):3.006572076):0.568893606,((t406:4.53882451,(t407:1.440379978,t408:1.420083965):2.948818068):1.186647664,(t409:4.303747459,(t410:1.069651637,(t411:0.7228544534,t412:0.6565319014):0.2868264482):3.232705573):1.166718707):5.304951253):2.328472432):9.011952148):4.099441119,(t413:13.32823656,((((((t414:0.04346182824,t415:0.03513366331):3.950493926,t416:3.766176857):2.513477139,((t417:1.124112374,t418:1.031568914):3.95774869,((t419:1.435819956,(t420:1.268685197,t421:1.155774771):0.01547348282):3.303096008,t422:4.461782267):0.2045810911):1.143281222):1.322840034,t423:7.068534241):0.6502380645,(t424:4.822462879,((t425:1.156537211,t426:1.097528023):1.914655876,((t427:2.150759706,t428:2.141000225):0.8253465746,t429:2.751871772):0.01526586057):1.744789387):2.827309181):0.004245155542,t430:7.00246944):4.719939131):12.62975115):36.57349764):16.57689739):2.492028202):51.83798503,((((((((t431:3.302002772,(((t432:0.466798475,t433:0.2775563942):0.3103330515,t434:0.3899941876):0.7333666282,t435:1.120584259):1.633201379):2.378832706,(((t436:0.4537931309,t437:0.3559802148):0.03178141491,t438:0.2816474196):2.841583605,t439:2.984362627):1.658092854):1.819959124,((t440:3.885173287,t441:3.819413894):0.01931046524,(t442:3.645941202,((t443:0.7842100539,t444:0.5391082062):0.6903529169,t445:1.125111789):1.655823008):0.1408370641):2.540827472):1.827129229,(t446:6.512857641,t447:6.392684317):0.7711880759):0.4035505104,((t448:0.5725329616,t450:0.1639510751):0.5382972075,t451:0.5854145213):6.37262881):3.448290631,(t452:0.4421887707,t453:0.4360947415):9.508678137):2.281176363,(t454:12.0778794,(t455:2.407022739,((t456:0.6619941433,t457:0.6252259653):0.8866372825,t458:1.417853984):0.7586337227):9.604904052):0.1090171344):13.04054881,((((t459:3.50350054,(t460:1.657739295,t461:1.536838317):1.701135871):1.043225737,t462:4.22040609):0.2401320063,t463:4.439804936):10.59540756,(t464:0.8844977766,((t465:0.6495705858,t466:0.620915692):0.02675833593,t467:0.4203660792):0.08504077363):13.93813933):9.42865963):103.3251434):78.54487608);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T87.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
