<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t439:128.1379762,(((((t440:0.5703265533,t441:0.5551109208):3.965607927,t442:4.450706983):0.03567140343,(t443:2.867298546,((t444:1.189672073,t445:1.17984242):0.2523597378,t446:1.246386733):1.296290627):1.21808803):0.1643885823,t447:3.824142271):0.09874458898,(((t448:0.5065998013,t449:0.4359275397):1.056747941,t450:1.373160293):1.122567925,((t451:0.7258220749,t452:0.6974644266):1.508625755,t453:2.186591445):0.1632102524):1.131953031):123.1071763):19.72025823,(((t454:31.93658572,((t455:5.228484532,t456:5.182113581):1.805588699,((t457:1.088394078,t458:1.024819981):2.192473366,t459:3.216874993):3.388622201):24.8290063):14.41003132,((((t460:2.569510234,t461:2.561216494):10.88212272,((t462:1.536808299,(t463:0.9902422875,t464:0.8639321909):0.3208696114):7.330215121,(t465:6.97937462,(t466:1.563114004,t467:1.379136532):5.087081968):1.524341724):4.526766277):6.2262678,((t468:8.749986799,(t469:8.354420442,t470:8.219713012):0.3173089707):3.432431757,((((t471:2.146679396,t472:2.074267228):0.593768104,((t473:1.255864649,t474:1.175758017):0.6031350705,t475:1.685905313):0.7640340285):1.445492391,((t476:1.674921059,(t477:0.5080159656,(t478:0.3690036413,t479:0.271284284):0.01206154625):1.054217169):0.2073733683,t480:1.500288221):1.95395427):1.481435883,(t481:1.906204571,t483:1.71717229):2.975300191):6.214735854):6.522912561):1.421943263,t484:18.79555482):24.56133788):18.57837068,(t485:25.17009933,((t486:6.079333928,((t487:1.5853256,t488:1.569725668):0.4530782691,(t489:1.793843382,((t482:0.1311337466,((t383:0.1703307656,(t339:0.02460921984,(t336:0.1712333825,(t330:0.2664974283,((t255:0.1787110168,((t240:0.01451462597,((((t203:0.4748117191,(((t157:0.05199208115,((t138:0.07005171098,(((t107:0.09571826417,(t78:0.1020179109,(((t1:4.650580485,(t2:3.91092283,t3:3.798000993):0.5008748383):0.6398357784,t4:4.863388714):1.274423778,(t5:4.999150063,t6:4.980298247):1.128306166):1.594979301):3.07862733):0.619137943,(t7:4.473653995,((t8:2.983657965,t9:2.790041561):0.7915455592,t10:3.549796352):0.4938167704):6.725800153):1.836219365,(((((t11:4.312790866,t12:4.175257371):1.589998617,(t13:2.300370119,(t14:1.372379099,t15:1.276171842):0.9211017605):3.371076597):1.797318946,t16:7.34578651):0.7523227928,(((t17:6.273175571,t18:6.156394227):0.3230206013,t19:6.284491186):0.8405118692,t20:7.09966351):0.6271055346):1.498342451,t21:9.09352133):2.395308785):0.389955935):0.621893121,(((t22:4.567321263,t23:4.538290264):2.483735849,t24:6.89578612):1.388277671,(t25:6.097411613,((t26:2.565685107,(t27:1.192982483,(t28:0.8494867101,t29:0.8339714781):0.1544502021):1.218187968):1.542594415,t30:3.618111719):1.626174408):2.133068029):4.000244884):0.5666939179):3.256125035,((((t31:1.603937489,t32:1.601326801):4.501429765,((t33:2.001646039,t34:1.909537877):1.82758924,(t35:0.7993729934,t36:0.7807725458):2.806397021):2.248463603):2.983416707,(((((t37:0.6647747144,t38:0.6476165479):0.3899738498,(t39:0.7363647392,t40:0.6497635056):0.2953531295):0.03325625815,t41:0.9554902557):1.091552207,t42:2.017066146):0.9905398912,t43:2.852140367):5.569673727):2.74839603,((t44:3.541414034,t45:3.327727565):6.51864448,t46:9.621446969):1.080245762):3.116117873):1.241314279,(((t47:5.44758572,(((t48:2.050440431,t49:1.97580768):2.039466373,t50:3.935788859):0.6542710163,(((t51:0.8953884626,t52:0.8363244804):0.7061529364,t53:1.398121023):2.848294938,t54:4.207534312):0.09780035952):0.5689171089):2.787897727,(((t55:2.13148158,(t56:1.235721251,t57:1.052021449):0.7688527819):0.6281565107,(t58:0.1143876602,t59:0.07932914975):2.291066676):0.3399851452,t60:2.656304798):4.489470343):6.35000681,(t61:10.26566126,t62:10.19002192):3.197905025):0.3080071073):0.09106636048):1.480156579,((t63:0.4714819899,t64:0.4172939526):11.28969943,((t65:4.1183664,(t66:0.3406690483,t67:0.3057805121):3.331716242):5.091214958,((t68:2.093251787,((t69:1.245023762,t70:1.057764834):0.2312015718,t71:1.22298021):0.5856085223):3.148964501,(t72:2.55455125,(t73:0.5205824743,(t74:0.1417558491,t75:0.130478546):0.002913104371):1.861149133):2.349756078):3.481348372):2.289833516):3.422535734):0.3734241163,(((t76:5.974718518,t77:5.931328563):0.9501790383,(t79:4.094875993,(t80:1.251198007,t81:1.222365531):2.81127322):2.550188101):5.494639766,((t82:1.232475378,(t83:0.7172105627,t84:0.6843698395):0.343722162):9.696554572,t85:10.52293217):1.052851062):1.389613425):1.251638117,((t86:1.53892647,t87:1.370827113):11.39226675,t88:12.73724196):1.17875365):0.7160964198):0.6802378959,(((((((t89:5.072587999,t90:4.975023961):0.0659586936,(t91:4.816513246,(t92:0.4020350022,t93:0.2171413765):4.382042947):0.166922154):0.02780632777,t94:4.696264666):1.008597127,t95:5.680849896):1.952464942,(t96:5.703771879,((t97:2.115617317,t98:1.964665132):3.50729338,t99:5.030007054):0.001101972937):1.875821456):2.765488505,(((((((t100:0.8960937578,t101:0.8426349922):0.1030379999,t102:0.8235411179):2.125116666,(t103:2.178342985,(t104:0.5609776703,t105:0.5567261395):1.509091789):0.7362622573):0.5294119215,((t106:1.500770842,(t108:1.21181153,(t109:0.5813768632,t110:0.573232282):0.3668435521):0.0937511039):1.413597089,((t111:0.4433892182,t112:0.3064529094):1.755855343,t113:2.045298897):0.1524870953):0.3570578097):1.092840293,t114:3.637425811):2.727205595,(t115:2.39011649,t116:2.323148378):3.847389352):1.50250248,(((t117:1.727512641,t118:1.662463301):0.5317995943,(t119:0.8241117118,t120:0.7673705957):1.195988032):4.494996718,(t121:5.055559686,(t122:0.7848797656,t123:0.7105886779):4.163787374):1.339965681):0.8350201279):0.4513107562):3.165402315,(((t124:2.707901266,(t125:0.9248148946,t126:0.80623261):1.650357745):2.181702705,t127:4.631807431):5.125514685,(t128:1.158593134,t129:1.085896409):8.534730602):0.5712952088):1.06085358):0.723055481):1.463032554,((t130:2.884018299,(t131:1.944399297,(t132:1.181341155,(t133:0.9493513191,t134:0.5964639085):0.1723330019):0.6206780127):0.8209586249):0.08787742341,t135:2.240606701):10.39954024):5.566844349):1.056516517):0.1849035924):3.696792789):10.23435487,(((((((t136:9.457884869,t137:9.370185731):2.162841768,(((t139:2.376729922,(t140:0.4234416745,t141:0.2768818661):1.84986309):4.468395881,((t142:0.5976912748,t143:0.5891810978):3.101397086,t144:3.688002559):2.888748413):2.032314025,((t145:1.566958334,(t146:0.6342976727,t147:0.5458712844):0.9259608553):6.872583416,(t148:1.50450906,t149:1.450484352):6.639550671):0.1067575719):2.550441486):4.277515532,((t150:0.2420393955,t151:0.1395030786):4.058632112,t152:4.186527303):10.6838624):1.937734768,((((t153:9.226298612,(((t154:0.3412369126,(t155:0.2004982327,t156:0.1993544634):0.06783320598):6.79513746,((t158:0.5255101183,(t159:0.2130706329,t160:0.1889175447):0.3002141882):3.022821361,t161:3.393318671):2.840469576):0.5058368691,((t162:3.004224498,(t163:2.325589429,t164:2.292919143):0.4711600625):0.06454205927,(t165:0.4438504836,t166:0.3505533131):2.222905975):3.613740357):1.534831856):2.729650117,(((((t167:2.796320094,t168:2.66097845):0.146681993,(t169:2.237528003,(t170:0.5087449453,t171:0.4988393495):1.635508167):0.5398847152):2.213046634,((t172:2.488820376,(t173:2.098836729,t174:2.097714734):0.3715211982):0.5250777647,t175:2.981782837):1.752264714):2.897179039,(t176:1.648563163,t177:1.631127498):5.950873284):1.939604217,(((t178:0.08112760899,t179:0.05775490948):4.484105192,(t180:1.614678123,t181:1.555583253):2.776988526):1.208967668,(t182:1.299334992,t183:1.267871193):4.234323538):3.450358196):0.3910474537):1.824407188,(t184:4.291349655,((t185:0.08578219878,t186:0.08456020438):3.759278162,t187:3.379286146):0.4458471399):6.279128092):2.865787119,((t188:3.824544058,t189:3.757321949):0.521102227,(t190:0.5535132311,t191:0.5279044954):3.715199323):8.623975204):0.04614572201):2.377169299,((((t192:9.305048513,(((t193:1.15005818,(t194:1.060321948,t195:0.9643019704):0.02741557248):6.947427072,((t196:5.405694621,(t197:3.452017697,((t198:2.678709776,t199:2.675437474):0.6267134771,(t200:2.115235514,t201:2.077528524):1.160895132):0.1404877932):1.927462653):1.663511726,(t202:3.557054073,((t204:1.185517979,t205:1.019534325):0.6669086973,(t206:1.515758972,((t207:0.6994074145,t208:0.6017705886):0.1141844297,t209:0.5682699468):0.6779026139):0.07342273745):0.8456412805):3.329056371):0.8586640864):0.1697487295,((((t210:0.4445957264,t211:0.3833627712):0.4234591547,t212:0.8066501346):1.045905486,t213:1.570663679):1.031293897,(t214:2.412774048,(t215:0.8430100283,t216:0.8199587217):1.366189828):0.03315363906):3.562322694):0.9549270315):1.768946662,(t217:4.781906319,t218:4.564405969):3.559189133):1.086336461,((t219:7.335577043,(((((t220:0.6812087386,t221:0.6188039156):0.3252427295,t222:0.8121281966):0.2697528374,t223:1.056703274):0.8578471568,t224:1.849032867):2.190491871,t225:4.022459603):2.98496875):0.1412303028,((t226:3.893643435,t227:3.83813368):1.435988868,t228:5.273634725):1.773418952):1.604795499):0.9940770293,t229:9.596113214):2.087998703):1.127639172,((((((((t230:0.6420104599,(t231:0.2988359786,t232:0.2472971796):0.1522923154):1.220850611,t233:1.583502003):1.373933353,t234:2.835652959):1.820614809,((t235:3.462421045,t236:3.395359511):0.04110954873,t237:3.408297941):0.6721169149):0.4810646407,t238:4.471698889):0.5335131032,(t239:4.202024062,t241:4.149505222):0.6902342519):0.8163865065,((t242:0.8876329335,t243:0.7075532894):0.9124798506,t244:1.584016844):3.839552303):4.519444149,((t245:0.895298841,t246:0.8687924803):2.251477075,(t247:1.712896828,t248:1.588148174):1.321862916):6.778992837):1.389400553):9.346415398,((((t249:0.7716084382,t250:0.7179548311):0.5956395536,t251:1.286803708):7.178474211,((t252:2.516460788,(t253:0.0736717606,t254:0.01126818927):2.404152112):5.094536468,(((t256:1.442838649,t257:1.414405185):0.2525461079,t258:1.606137344):1.612867094,t259:3.149364022):3.648374316):0.7628609805):10.63864458,((t260:9.856878031,((((((t261:0.6959085149,t262:0.6802798376):3.850469941,(t263:4.102558243,((t264:0.7667983081,t265:0.6449453137):2.396917584,(t266:1.000138179,t267:0.8772702909):2.000045537):0.9376805054):0.2808634618):2.271089787,((t268:1.135098541,t269:1.095661485):2.61404354,t270:3.630320897):2.500238474):0.6420132283,((((t271:0.5232295294,t272:0.4248470229):0.128609353,t273:0.2306179856):0.9249050533,(t274:0.6273863843,t275:0.6234977615):0.5280359339):2.762341063,(t276:1.453776189,(t277:0.9825674716,t278:0.9472015464):0.384071605):2.419150358):2.265540456):0.3740530083,(t279:2.719185141,((t280:1.014468593,t281:0.8841932112):0.4261421517,t282:1.246088551):1.266211432):3.495426059):0.7800400012,t283:6.787480823):1.09905613):3.915529862,((((t284:2.006318514,(t285:1.82065356,((t286:0.7150618065,t287:0.7054277178):0.2358591097,t288:0.7809530428):0.6333853409):0.1194598465):5.913325138,(t289:2.264624654,t290:2.188178958):5.114976602):1.992864127,t291:9.224256177):1.69697841,t292:10.5891255):0.07320722626):4.109012276):1.144240617):2.684050525):0.2368935688):1.233416108,(((((((((t293:1.027720805,(t294:0.6473648056,t295:0.623009578):0.3210810337):2.532025305,((t296:0.2182235737,t297:0.1948136548):2.629892636,(t298:1.211767172,t299:1.035998703):1.584504143):0.5129818016):3.717653592,(t300:4.641468038,(t301:2.246878316,t302:2.180232762):2.317899361):2.143940803):2.074318937,((t303:2.58128062,t304:2.517538512):3.553298887,t305:5.764024148):2.330555748):1.774240216,(t306:0.4818785945,t307:0.4053483615):9.332738884):3.75148642,t308:13.45950637):2.83558937,((((t309:0.316519278,t310:0.3067383444):3.107356335,(t311:1.509844439,t312:1.479267446):1.896036583):0.3034318788,((t313:0.6003136071,t314:0.3945212103):0.1774400258,t315:0.4829041356):2.876642688):9.476392842,((t316:9.356294982,((((t317:1.314802821,t318:1.312033755):2.127633842,(t319:0.359911153,(t320:0.10708442,t321:0.07847714325):0.1408981392):2.599710223):1.383743193,(t322:0.867148407,t323:0.8624053683):3.301445422):0.07789209096,(t324:0.5225068466,t325:0.5017458173):3.700724763):4.388484257):0.8836414805,(((t326:3.989618536,t327:3.971194479):3.029661616,t328:6.953102909):1.487787579,(((((t329:2.310058886,t331:1.807921438):1.437971113,(t332:1.160173874,t333:1.022272071):1.723558861):1.45844295,t334:4.052076229):0.8634676352,((t335:0.8447716038,t337:0.5511152263):1.514063561,t338:2.057131317):2.399175761):1.336718407,(t340:3.323660244,t341:3.234433743):2.381366202):0.9206307234):0.9142921203):2.520525998):3.048256682):0.9819289344,((((((((t342:1.820521869,(t343:0.1343409972,t344:0.1171296625):1.587818494):1.345402632,t345:2.946782713):0.3381854131,(t346:1.944018117,(t347:0.2140122334,t348:0.04495740528):1.729726466):1.28605936):2.076854255,t349:5.092635328):2.18139551,(t350:2.871272754,t351:2.862735092):4.317499742):4.886729179,(((t352:4.793812923,((t353:0.04530398631,t354:0.03236448289):2.287037066,t355:2.228785336):2.122209541):1.358891981,t356:5.648087471):5.156250428,((((t357:4.208795686,(t358:1.706248528,t359:1.647633006):2.249030453):1.401457494,t360:5.262899746):3.40132814,(((((t361:1.08836166,t362:1.00482753):0.8042073096,(t363:0.09239745909,t364:0.09055400058):1.683231681):0.1893637967,(t365:1.225515323,(t366:0.4965024175,t367:0.46730356):0.6931896256):0.6629286108):0.7323526498,t368:2.521227676):2.150048012,((t369:0.3103443956,t370:0.1588092175):0.523918348,t371:0.403642138):3.802193293):3.563453597):0.173819246,((t372:0.7736877962,t373:0.7284990335):3.406789565,((t374:0.9278130183,(t375:0.357552968,t376:0.3228946347):0.4686836238):2.561955276,t377:3.345186207):0.4028107454):3.621049802):1.611798909):0.5103000883):0.9421956715,(t378:2.156399289,t379:2.133517473):8.229540004):0.1555964777,((((((t380:1.294464405,((t381:0.3139954484,t382:0.3050189759):0.508717059,t384:0.5837571452):0.4618483728):1.955541538,(t385:2.387346507,(t386:0.7219529756,t387:0.6484951199):1.469815436):0.5602366474):0.4384576398,t388:2.985786177):1.290231118,(t389:3.319514701,t390:3.178021377):0.8125716517):2.48123189,(((t391:1.756189008,(t392:0.5158686559,t393:0.4121779813):1.189941897):0.3832757606,(t394:0.1959652919,t395:0.1367464657):1.747294067):3.766096334,(((t396:1.369878842,(t397:1.11041867,t398:1.039533102):0.1264562206):3.001612863,t399:4.080715321):0.07056266521,(t400:0.5397724033,t401:0.478041008):3.536734719):1.050653296):0.5400865662):2.215734497,(((t402:0.5380507947,t403:0.3979610383):1.964054579,t404:2.275861275):0.882774086,(t405:0.4804398307,t406:0.1458572421):2.548062241):4.390157412):0.7156812017):0.2319058535):0.1737759086,((((t407:0.7155033601,t408:0.5098134456):5.217899677,((t409:0.9429609842,t410:0.9079990551):0.832115843,t411:1.715457425):3.840229623):1.802940006,((t412:5.966096904,t413:5.892012742):0.4364255875,(((t414:1.034653836,t415:0.9876311964):0.5080724722,t416:1.295842795):0.007165352684,t417:1.153635257):4.698909973):0.9220502475):0.04193211129,(t418:4.426584469,((t419:1.439719532,(t420:0.9093750424,t421:0.8966392011):0.1389704393):1.585574929,t422:2.589305231):1.241383691):2.092271591):0.397358437):1.122644199):0.9638629904):0.2162197817):3.986649335):6.306306325,(((((t423:0.7846468892,t424:0.4342480558):2.165671339,(t425:2.328987686,t426:2.19701919):0.2255717192):2.821360971,((t427:3.828345153,(t428:1.870833425,(t429:1.437386386,t430:1.386316916):0.4295458124):1.885722215):0.3361087351,(t431:2.77050775,(t432:2.166787012,t433:1.897562311):0.5831542876):1.257810353):1.043691371):1.856690155,(t434:5.851836208,(t435:0.6463797483,t436:0.4539323514):5.195610596):0.7479842391):1.685567073,(t437:1.153379918,t438:1.01771628):6.672464923):9.516945925):12.54150107):36.7581608):81.35613651);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T86.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
