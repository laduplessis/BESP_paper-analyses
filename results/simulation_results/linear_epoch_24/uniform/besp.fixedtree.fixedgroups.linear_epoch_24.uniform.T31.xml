<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t418:4.917353346,((t420:1.578110817,(t421:0.8085587458,t422:0.664240927):0.6711905153):1.63625422,t423:2.764282198):1.552027565):3.37003486,(((t424:1.297964866,(t425:0.6969071647,(t426:0.3118357048,t427:0.1561658913):0.2390027142):0.5513662423):0.5960336305,t428:1.395984119):4.6791571,(t429:5.797675904,t430:5.781230658):0.2227588993):1.097554148):44.85906428,((((t431:5.547031798,((t432:0.2321574564,t433:0.2214955024):5.015999037,((t434:1.761800784,t435:1.746071795):0.808401068,t436:2.433575401):2.643909403):0.2471130205):0.8874873285,t437:6.12653357):27.91449503,((t438:8.443429929,(((((t439:2.413848674,((t440:1.436523428,t441:1.431499127):0.6603298355,(t442:0.066676594,t443:0.04878361678):1.947794407):0.2295095059):0.7980270584,(t444:1.332730874,t445:1.07543586):1.655534143):1.397467206,((t446:3.351035865,(t447:2.779404478,(t448:0.3069532944,t449:0.2259742191):2.383040945):0.5286620275):0.3359900328,((t450:0.2759247316,t451:0.2550770375):1.599891429,t452:1.854739805):1.474059768):0.3711090223):1.822436664,(t453:3.400662342,t454:3.331525959):2.118016304):1.215758183,(t455:4.275470894,(t456:0.6375739073,t457:0.5569792312):3.591205282):2.316927726):0.6966361623):14.52388253,((t458:6.761418699,((t459:4.968376263,(t460:3.221147784,(((t461:0.3816687483,t462:0.3230565102):1.862951103,(t463:0.4889845549,t464:0.1820761779):1.315426963):0.0008168265594,t465:1.489682967):0.8875364339):1.696775191):0.1071105734,t466:4.134179465):1.419783922):7.839552849,(t467:4.654071259,t468:4.640758976):8.701189162):7.03703661):10.92898022):17.36008424,(t469:2.728295771,(t471:0.5814855874,t472:0.564262008):1.845781793):45.89344274):0.1876534468):86.45239026,(((((((t473:2.018374971,t474:1.976627495):1.970215925,(t475:1.173073553,t476:0.931461756):2.767421779):0.5898792364,(t477:2.853644007,t478:2.85254657):1.401255594):1.919712952,t480:6.134595855):15.31466123,((t481:12.23559276,t482:12.22238457):0.6662239841,(((((t483:0.1746887266,t484:0.1299367355):0.09567813134,t485:0.1415649366):1.455118443,t486:1.421803103):0.1834755039,t487:1.549993874):9.813081457,t488:11.22911425):1.112962673):8.402264413):14.67081412,((t489:6.688432843,(t490:1.760539266,t491:1.703262981):4.843820404):16.74189973,(t492:2.406518731,t493:2.34620715):20.53487378):11.61275019):22.68172657,(((t494:0.4045170927,t495:0.3826434957):25.41780969,t496:25.74062589):21.52307962,((t497:11.50520082,((t498:3.461682718,t499:3.450689515):4.714593266,t500:8.101198059):3.325212405):7.267609395,(t501:9.534436626,(t502:8.2664506,(t503:5.46132674,t504:5.391654356):2.732034523):1.040022658):9.136313347):28.29945416):9.774243216):75.65621532):0.7811249321,((t505:3.443310469,t506:3.391844961):5.580827191,((((t479:0.0132339556,(t470:0.05855374442,(((t419:0.1130273867,((t406:0.1263219231,((t388:0.01820653797,(t382:0.01984451439,(t343:0.0374596144,((t321:0.1686489593,(((t207:0.07579864894,(t188:0.01036094721,(t187:0.03087397693,((t178:0.008356828679,(((t160:0.00108580754,(t150:0.08753385492,(t91:0.1703232274,t1:7.623140939):5.771197058):0.9540912769):0.5610021144,((((((t2:3.727443091,t3:3.639908659):0.1813376013,(t4:3.386222518,t5:3.165338889):0.3319736828):3.493999518,(t6:6.099187872,(t7:3.718365611,t8:3.708641745):2.286729783):0.8817154309):0.5146153626,(((((t9:1.462957415,t10:1.358265267):0.7074213117,t11:2.000753121):2.397837538,((t12:2.367036693,t13:2.354983722):0.8886192675,((t14:2.695263818,(t15:1.879790661,(t16:1.480730541,t17:1.380502844):0.3897619199):0.7653670569):0.05299933736,t18:2.507176817):0.2199858562):1.135462315):1.583694707,t19:5.423840651):0.9392605376,(t20:0.769414784,t21:0.5988670598):5.564248247):0.237105543):0.213217222,(((t22:0.5413481324,t23:0.4464925771):3.431855568,t24:3.804879911):1.398875803,t25:5.180028464):1.084831544):6.160743596,t26:12.36691647):0.6164299918):0.3739773455,((t27:4.230892707,(t28:3.418016696,t29:3.379482561):0.7712759728):5.004958543,(t30:1.864839707,t31:1.846888007):7.213768642):4.075130981):0.6852904919):1.109086545,((((t32:3.535254619,t33:3.531476157):0.006395932323,t34:3.523295263):2.948243639,t35:6.423826893):1.369140712,(t36:2.410038208,(t37:0.1843139753,t38:0.1182439136):2.20525808):5.278149496):6.956493015):0.166237052):0.03645421384):1.926189288):7.027225914,(t39:10.89975937,(((t40:3.878592979,(t41:0.1437689945,t42:0.1354517275):3.542705159):0.08755217256,(t43:1.179065878,t44:1.087877084):2.580363577):6.576412885,(((((t45:0.04910296873,t46:0.01144785547):0.2134224495,t47:0.2218725485):3.262966353,t48:3.414526002):0.4372518299,t49:3.779580829):5.408300794,t50:8.931125387):0.8059420454):0.3010232877):12.71690339):1.566550469,(((((((t51:5.359859372,(t52:2.598549639,(t53:0.8494014425,t54:0.7994452111):1.722788632):2.700196974):2.065089607,(((t55:1.972737833,t56:1.659308348):0.865659264,t57:2.414028859):0.5159595287,(t58:0.4689776788,t59:0.2412624837):2.416935964):3.768281613):1.243103285,t60:7.57881995):4.247546647,t61:11.73521616):4.78865008,(((((((t62:2.057937321,t63:1.67457439):0.06443132324,t64:1.734230901):1.453689364,(t65:1.036250824,t66:1.005528887):2.039460875):0.3647700593,(t67:1.193234467,t68:1.108366191):2.115618014):4.272643581,(((t69:0.7192481718,t70:0.5766591852):6.21486657,((t71:2.427409948,t72:2.408539142):3.594953986,(((t73:2.880856544,t74:2.560225217):0.5571768083,((t75:1.139894561,t76:1.137417293):0.5483112687,t77:1.640475656):1.395131363):1.202248247,(((t78:1.266258743,t79:1.254039131):1.693109786,t80:2.859826522):0.8412904692,(t81:1.233062862,(t82:0.3045470825,t83:0.2881736465):0.8990546173):2.178038892):0.4207549672):1.243151132):0.7657168181):0.02733481159,(t84:5.319693048,t85:5.22762167):0.4663960138):0.2403628307):5.549307461,((t86:3.2809704,(((t87:2.016208236,t88:1.996513706):0.5936505968,((t89:1.284395323,t90:1.207205517):0.3551003032,t92:1.172156678):0.9490516938):0.2859013163,(((t93:0.5787169963,t94:0.4476357728):0.1486596412,t95:0.5063678863):1.057052211,t96:1.504683219):0.5740997665):0.3840780297):4.483600243,t97:6.933177487):3.71119739):0.4754334419,((((((t98:1.077464982,t99:0.9563307241):1.688184314,t100:2.609910075):1.100226847,((t101:0.05305761988,t102:0.008429680998):3.011903752,t103:2.999450932):0.6054665672):3.02685789,(((t104:0.7389986202,t105:0.6771164521):1.071935261,t106:1.71409863):3.880625572,((t107:2.400220168,(t108:0.2716481269,t109:0.2697232168):1.986938854):2.326987924,(t110:4.141917876,(t111:1.997118484,t112:1.983406268):2.020062022):0.3839877938):0.7388263709):0.6253988239):2.361387428,((t113:0.6378614186,t114:0.6284195413):0.4673669627,t115:1.073390541):6.913920907):1.639886564,t116:9.543005418):0.04727342627):2.189558827):3.413634627,(((t117:1.823629884,(t118:1.256649798,t119:1.222404893):0.4088994144):8.669955101,((t120:6.504725679,(t121:1.354840199,t122:1.117730979):5.059073609):1.478761503,(((((t123:1.18589826,t124:0.9336045217):3.422843633,t125:4.11273001):1.597493522,t126:5.548499019):0.08004928527,t127:5.561578086):1.023451308,((t128:2.268812916,t129:2.233565545):2.600689013,(t130:0.6123089528,t131:0.5610155788):4.193671007):1.695879767):0.2975181481):2.17189572):1.782126503,((((t132:2.597710466,(t133:1.057331699,t134:0.7939239333):1.416894769):2.370370436,(((t135:1.427323207,t136:1.327471677):0.9043445681,t137:2.168747545):2.146110813,(t138:4.164500782,(t139:0.5657321569,t140:0.332180094):3.473242779):0.1493323425):0.05964047193):2.274418304,t141:6.220639786):2.773937258,((t142:0.2749755738,t143:0.1681545369):6.476156878,(t144:1.091094512,(t145:0.6221972468,t146:0.5860500561):0.3692923044):5.492532392):2.115230853):0.673344554):2.830070729):0.8828544367,((t147:7.346127154,((t148:1.27872091,t149:1.209912394):0.3614350317,(t151:0.4306334715,t152:0.2155662851):0.8390353578):5.555186728):3.38145958,((t153:4.621187304,(t154:0.5067158702,t155:0.4993373311):4.013806398):0.9349957506,(((t156:1.988393021,t157:1.940659289):0.2089203911,t158:2.125265395):0.7561660907,t159:2.709738552):2.333157007):4.39578945):2.109108927):2.078632383):2.514993807):1.041239707,(((((t161:4.410772062,((t162:0.2367104306,t163:0.2162305918):4.075019224,(t164:2.698245062,t165:2.656133818):1.485823291):0.009823667565):3.825751169,((t166:5.578827103,(t167:2.205051279,t168:1.960123616):3.249036035):0.7829428109,t169:5.991937243):1.603627251):0.4346523913,(t170:1.140405256,t171:1.090098789):6.867631739):7.173867431,((((t172:1.703636658,t173:1.375338317):3.87715976,t174:5.153783572):3.805588213,(t175:7.09732634,(t176:5.499892051,((t177:1.850065247,t179:1.717940125):0.4050633403,t180:2.12254225):3.184304354):1.385193945):1.856769785):3.302560699,((t181:1.735983311,t182:1.715979577):8.758950286,(t183:3.901745778,t184:3.554428465):6.318543849):1.262247815):2.41109586):0.8700767046,((t185:1.066392011,t186:0.6006529374):6.181330335,t189:6.638247848):7.16136795):0.2458382063):0.419155357):3.949391477):0.5891380419):0.3114749239,(((((t190:3.482240017,t191:3.37518213):3.681561864,t192:7.040834555):3.861271353,(t193:6.831301576,t194:6.724201923):3.758147382):3.660249102,((t195:2.860775589,t196:2.765484139):1.691639602,((t197:0.1200688812,t198:0.09181765141):3.102263295,t199:3.113869977):1.005430081):9.556092331):1.023466888,((((t200:2.828294976,((t201:0.1864335006,t202:0.07193292206):0.7140716491,t203:0.6973805552):1.596223654):3.756104273,((t204:0.1986503018,t205:0.1386961005):4.682016974,t206:4.77980696):1.121946118):6.140184953,(((t208:4.799403766,(t209:3.564196037,t210:3.425147096):1.229892693):1.854676792,(t211:2.541628692,(t212:1.339423252,t213:1.158255214):1.139136454):3.804868135):2.725288933,(((((t214:0.2555320058,t215:0.2544026687):1.18009734,t216:1.332004831):1.296162632,t217:2.615116458):1.520734676,(t218:0.1183443366,t219:0.01666117682):4.003962131):2.590999861,t220:6.468279126):1.733570396):2.512532704):1.790334194,((t221:3.623128759,(t222:0.8558673116,t223:0.7688838143):2.747684047):4.802040125,t224:8.198704951):4.044978023):0.07872751434):3.605310319):2.079150171):0.800708603,(((((t225:1.916674159,t226:1.900406289):2.75056217,(t227:0.9349100905,t228:0.8821872871):3.599342632):6.423592073,t229:10.70625785):1.14236834,(((t230:6.883167223,(t231:2.4431335,((t232:0.5513035281,t233:0.3120419363):1.468113578,t234:1.704894836):0.3351674021):4.303470712):0.1829790267,(((t235:0.5990819407,t236:0.149860814):3.070426794,((t237:2.351088175,(t238:1.943224446,t239:1.842345996):0.08827229621):0.470256787,t240:2.356969935):0.2803641636):0.2642773071,t241:2.84959832):2.419711982):2.568601197,(((t242:0.06826733118,t243:0.01293333918):1.934269419,(t244:0.9967897956,t245:0.8920048752):0.6895622844):4.577803045,t246:6.096954091):1.072720109):2.129004339):3.595055347,(((((t247:0.2036017614,t248:0.1450342626):3.321180208,(t249:1.706920692,(t250:0.7346530375,t251:0.6536994967):0.9068068371):1.678799604):0.4023221248,t252:3.24640032):1.217410253,((t253:2.025225048,((t254:0.3038764319,t255:0.2240680733):0.270073321,t256:0.4545007335):1.259615525):1.778830406,t257:3.304060495):0.6566686581):3.365345222,((t258:3.114511857,t259:2.950848087):2.814821051,t260:5.67738039):1.208283613):4.321263692):2.946744494):0.828803406):0.6151282006,(((t261:2.607018816,(t262:0.2546668427,t263:0.2401392774):2.231732081):4.403405313,((((t264:0.1435062778,t265:0.09418971882):1.513528968,t266:1.604350718):3.671941519,(t267:0.08299773547,t268:0.01618998113):5.17530963):0.7507413798,(t269:0.3036627326,(t270:0.02044647507,t271:0.006334389968):0.2543247985):5.416438865):0.7112986986):3.355598913,((t272:0.3269497655,t273:0.2517963657):5.575266755,t274:5.633356282):3.797075409):5.217576486):2.352041804,((((((t275:3.985345871,(t276:2.726233362,(t277:2.000737104,(t278:1.479871097,t279:1.344791644):0.5073122505):0.6921686088):1.251092942):1.289323032,(t280:2.873275199,t281:2.86370626):2.126194712):7.459344071,(((t282:6.158469293,(t283:2.947377096,t284:2.834000364):3.147362761):2.776880399,((t285:1.243863371,t286:1.124969254):2.425363173,t287:3.351540588):4.986796318):0.1818081271,(((((t288:2.788222633,(t289:2.098807387,(t290:1.050123782,(t291:0.2980843575,t292:0.2891853239):0.5908939886):0.9718861566):0.5983499447):0.05029347967,((t293:0.2303951853,t294:0.1870889128):0.01727955126,t295:0.2012586327):1.898356062):0.7296734744,((t296:1.806101088,(t297:1.667780163,t298:1.511518366):0.1246760699):0.5984677162,t299:2.016133082):0.3816967998):2.502106954,t300:4.899914343):2.374504405,((((t301:1.989479252,t302:1.904019596):2.493088649,((t303:1.494486862,t304:1.304514007):0.1318229924,t305:1.31906366):2.653682457):0.9761939715,(t306:0.890746126,t307:0.8505146611):4.02853861):0.9665932026,(t308:3.594514772,t309:3.540360437):2.070078753):0.8474647443):0.05273807738):3.307929934):2.376425899,(t310:0.2393799548,t311:0.1381186339):11.90656607):0.4582588594,(((((t312:1.406030728,t313:1.246596188):1.341163288,t314:2.583299469):0.7635969382,t315:3.201230201):2.798975817,((t316:4.375446114,(t317:2.413297076,t318:2.303908674):1.951968062):0.5897584182,t319:4.843949022):0.9201500391):0.04299715092,((t320:2.636142293,(t322:1.656452912,t323:1.614352578):0.7078060872):0.5424075868,t324:2.626366749):2.575018932):6.024758793):1.221716044,(((((t325:4.081779664,(t326:2.805096459,t327:2.797085862):1.104958499):0.1880851913,t328:4.069162741):1.09497984,((t329:0.9565378683,t330:0.9454951677):0.4685031417,t331:1.393663257):3.738334429):4.755804512,(((t332:3.124712185,((t333:1.712949652,t334:1.678736484):0.2202340441,t335:1.86963324):1.045014056):1.590814348,((t336:2.940726043,(t337:1.610865136,t338:1.587623801):1.289016272):1.08741778,t339:3.954784378):0.4684351872):2.168392235,t340:6.400735391):3.002142401):0.05223006094,t341:9.4106992):2.123335051):0.1811590736):1.44341036):0.5970794817):1.73336129,((((((t342:1.220811741,t344:0.9462464504):0.2135910017,t345:1.151518252):1.109166371,t346:2.258274038):3.249497718,(t347:4.108529652,(t348:2.505083374,(t349:1.660510958,t350:1.630067826):0.8100848432):1.413787706):1.228666452):6.44399366,((((t351:0.3255366283,t352:0.3127868912):3.638409544,(t353:2.509168677,t354:2.504345538):1.267412224):0.8126054906,t355:4.567017571):1.079461675,((t356:3.725821122,(t357:1.560512373,t358:1.521885249):2.052247643):0.8788266228,(t359:1.771670414,(t360:1.595700225,t361:1.539495709):0.04190176795):2.652556071):0.9525938443):5.562463847):0.858103995,((t362:3.948598028,(t363:3.148011258,t364:2.585185514):0.7284992545):5.402197724,(((t365:1.155797727,t366:0.8477712884):1.338688177,t367:2.168949106):1.434899657,(t368:2.440069871,t369:2.371321471):1.130121307):4.782710431):2.215165827):2.338675633):2.592348634,((t370:6.735708158,(t371:5.47839011,t372:5.196284082):1.21604563):2.035095052,((t373:6.98328885,((((t374:0.8307100797,t375:0.8148342754):0.55569727,t376:1.33425216):1.989903615,(t377:0.4002786672,t378:0.1730947245):2.876294585):0.3971621519,(t379:2.670181914,t380:2.6538608):0.4215479613):3.192599825):0.5733438968,t381:6.515955775):0.8768326373):6.658610389):6.161677176,(((t383:11.61700795,(t384:7.385555708,((t385:1.800618925,((t386:0.3357792738,t387:0.2816459493):1.125668915,t389:1.246612135):0.2767730317):1.699869332,t390:3.198332413):3.856474689):4.175601221):4.110175927,((((t391:4.582056508,t392:4.403415703):3.65847814,((((t393:1.172780889,t394:1.154531393):1.530151241,t395:2.671014356):4.531833386,((t396:1.177192165,t397:1.126919525):1.022437781,t398:1.484285254):4.751118851):0.5524546108,((t399:0.2249338008,t400:0.2144570146):2.301179595,(t401:0.838449241,t402:0.6675298804):1.639069852):4.10260293):0.2042552927):0.7326595078,((t403:0.1973150127,t404:0.1487660535):6.062796744,(t405:0.8505490337,((t407:0.323371564,(t408:0.08170871079,t409:0.06503061406):0.2317121255):0.0455187758,t410:0.1923807951):0.163701301):5.325057557):1.020804643):3.050129874,((t411:2.381174158,t412:2.303981596):4.142264442,t413:6.414580752):3.001872692):3.081073814):2.000639496,((t414:3.080817906,t415:2.675359794):9.818484374,(t416:2.563348772,t417:2.524967936):9.906609367):1.350803928):2.045453792):1.040570724):123.7290597);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T31.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
