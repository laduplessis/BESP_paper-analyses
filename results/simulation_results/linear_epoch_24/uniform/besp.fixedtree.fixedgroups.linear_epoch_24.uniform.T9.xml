<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t372:5.341634052,(((t373:0.597825039,t374:0.5926775446):1.164279833,(t375:1.124034196,t376:1.098848292):0.5095185308):2.456920134,t377:4.012405921):1.116990294):2.797822286,(t379:2.354167443,t380:2.335929656):5.283792697):5.353644418,(((((t381:2.276100842,t382:2.16366072):0.8624731998,t383:3.017772753):0.8010149514,(t384:2.469636853,t385:2.467098635):1.26515031):0.5514422609,(t386:2.694636752,t387:2.616547494):1.436045137):1.617890822,t388:5.655862094):6.787150944):2.857184999,(((t389:6.996297751,(((t390:2.366428635,t391:2.251555652):1.848900707,t392:3.858602172):0.7926741467,(t393:4.591411517,((t394:0.7229069362,t395:0.02827527726):0.9893683901,t396:0.8191003511):2.703077071):0.01355846051):1.977157453):1.025709321,(t397:4.170661894,t398:4.169196711):2.285782931):6.931366419,(t399:1.157903993,t400:1.079405345):12.20152933):0.334479964):9.560265295,(((((((t401:1.865708926,t402:1.827866116):3.053604615,(((t403:2.366616779,t404:2.307052252):0.6741606565,t405:2.924505234):1.397606512,((((t406:2.181449389,t407:2.152948803):0.2327644416,(t408:0.4570343761,t409:0.455653425):1.884483518):0.2759899267,t410:2.379580316):0.727541388,t411:3.041587553):0.8874002579):0.2836941836):0.7649522712,t412:4.959956979):4.746832942,((((t413:0.2209172677,t414:0.1038933796):0.7336427505,t415:0.7836558852):3.557790221,t416:4.330939151):0.936515338,t417:5.24059609):4.23772727):1.915684752,(((t418:2.69850789,t419:2.684045332):0.2428706766,((t420:0.1706369638,t421:0.1162836563):2.472142632,(t422:0.8607687367,t423:0.8170472336):1.569851993):0.1684781093):7.263408475,((((t424:2.613317342,(t425:1.209260395,t426:1.193461346):1.204223384):0.5160141672,(t427:0.8345237183,(t428:0.1536327685,t429:0.006165800719):0.6574554717):1.992100028):0.4669284151,t430:2.877349654):3.974743666,(t431:6.318052657,(t432:0.319202647,t433:0.2984515679):5.993445402):0.267810535):2.197194091):1.127030842):1.931323682,(t434:6.59873092,(t435:4.494633992,(t436:2.674934083,t437:2.637800679):1.717843049):2.031860021):5.188235359):0.6779701575,((((t438:3.329823899,(t439:1.600180187,t440:1.514132463):1.719311881):2.891826913,t441:5.930839679):0.4019428311,(t442:2.098777109,t443:2.014341256):4.013098801):1.703135522,(t444:6.954465531,((t445:5.50792038,(t446:4.723629738,(t447:4.154996751,((t448:0.400972295,t449:0.327547695):1.363390148,(t450:0.6497722249,t451:0.6169289681):0.4633948392):2.362121641):0.4582862403):0.7573246962):0.0616430308,(t452:1.479463172,t453:1.328952588):3.216967177):1.354117243):0.7249309798):3.801521155):7.781594519):0.3889864143,(t454:0.6237158238,t455:0.4914150334):17.90266979):5.944653521,((((t456:4.811968891,t457:4.800806744):0.0545895316,t458:4.68715027):2.03611199,((t459:3.105809722,t460:3.048665806):1.830258371,((t461:0.3513250662,t462:0.3238634345):2.378198369,t463:2.630307851):2.004776727):1.659910074):0.2402359526,(t464:2.744737593,t465:2.491141218):3.671249958):16.95532341):179.6122309,((((((t466:6.120899984,t467:6.085646756):1.930922604,(t468:6.194505658,((t469:0.7643936603,t470:0.6172662127):1.629548804,t471:2.083859439):3.649438203):1.776956042):1.507270138,((t472:3.865586084,(t473:2.131227159,(t474:1.938311091,t475:1.651059159):0.1575887198):1.536182024):1.14908285,(t476:3.589936281,(t477:2.59597122,t478:2.541866746):0.9730955058):0.8930136639):3.944822951):2.94678674,(t479:3.266280513,(t480:1.123090112,(t481:1.016829514,t482:0.7501054639):0.103213478):2.112951921):8.009517666):37.13070663,((((t483:5.979960614,(t484:5.679026379,t485:5.633199198):0.2117491229):12.5871226,(((t486:0.5845897532,t487:0.5101300961):1.812568108,t488:2.248862325):2.914670179,((t489:2.006039306,t490:1.954796229):1.040632548,(t491:1.56576976,t492:1.556999873):1.40314127):2.047944467):12.83364147):7.516033303,(((t493:5.702556419,(t494:0.417848722,t495:0.221568501):5.20648319):6.496207569,(t496:2.235247453,(t497:1.913210313,(t498:0.6317537631,t499:0.5368889272):1.240078585):0.04555752897):9.638603005):8.346195272,(t500:2.126423253,(t501:2.053296844,(t502:1.248667564,t503:1.204770559):0.5785090373):0.04301510545):17.58209017):4.670533144):0.4074043482,((t504:0.7768877148,(t505:0.4928797592,t506:0.4361714853):0.2695887064):13.77166746,((t507:0.3221692847,t508:0.3079765806):0.05715050155,t509:0.2600626197):13.89728476):9.898586923):21.4763746):131.3413932,((((t378:0.04254704885,(t355:0.1391709685,((((t274:0.07311027641,((((t242:0.06386983425,(t227:0.0126168779,(t209:0.05576485739,(t201:0.4547614637,((t192:0.04534111472,t193:0.03741251698):0.03325544273,((t75:0.1276268637,(t66:0.01667297324,(t1:4.43913968,t2:4.154634787):1.659954813):1.027551703):1.136181599,((t3:1.896167979,t4:1.806183486):4.363415512,t5:5.935157686):1.667867589):9.542811779):1.135371649):1.721067277):1.447667457):1.080546585):0.984438567,(((((t6:14.0802499,((t7:6.083556665,t8:6.017330879):1.175284002,((t9:3.041269848,t10:2.994259682):3.365835668,t11:6.347514935):0.7562349794):6.569086186):2.404735301,((((t12:2.794973773,t13:2.74127427):0.7911114395,(t14:1.349669665,t15:1.337129692):2.119433447):0.1986006586,t16:3.644539625):1.493284117,((t17:2.799977387,t18:2.702884065):0.7446847825,t19:3.336273711):1.324446199):10.67895003):0.9116292817,((((t20:5.027049782,(t21:3.70206979,t22:3.472607626):1.316785424):0.661646865,t23:5.365607298):7.614301345,((t24:7.777591821,((t25:0.6987517633,t26:0.695496321):3.874436325,t27:4.41806224):3.049021584):3.47171145,(t28:7.078489552,(((t29:3.388002355,((t30:1.909293077,(t31:1.533847665,t32:1.510283305):0.1440899446):1.283605864,t33:2.886099902):0.1580408099):0.1434392726,((t34:0.4786373115,t35:0.2723945281):0.2667462262,t36:0.4858162849):2.397713955):2.121608916,(((t37:2.568689518,t38:2.494984825):0.9105622137,t39:3.3943648):0.4237167134,(t40:2.39339031,(t41:0.1369218858,t42:0.06540450492):2.097970051):1.332353235):0.9218693905):1.407235141):3.494314408):1.683500108):1.552883907,((t43:0.8925698378,t44:0.6822527793):6.889769667,((t45:1.195586662,t46:1.048740935):5.470622233,t47:6.50735663):0.8129994906):4.746153592):1.389700212):0.01191946007,((t48:4.655776188,((t49:0.311986727,t50:0.3045445842):0.2705864888,t51:0.5390261177):4.055407981):7.868167059,(((t52:2.463231047,(t53:0.3641958443,t54:0.1455334529):2.069879307):1.856192322,t55:3.785125397):3.443641587,t56:7.226314121):4.507082621):0.8728872483):3.907459226,(t57:14.38108624,((((((t58:3.334804681,(t59:0.1407386401,t60:0.1161153779):3.157722014):1.559591878,(t61:1.213118358,t62:0.9176936131):3.61481333):3.267950344,t63:7.740465894):5.239724046,((((t64:2.849593915,t65:2.815050313):1.001716421,(t67:0.5048953198,t68:0.3725327859):3.173677733):2.5749243,(t69:3.584671758,(t70:1.827379485,t71:1.797552153):1.692543238):2.472500636):5.473012878,(t72:8.837502123,t73:8.62843421):2.52974162):1.052786948):0.3019758191,t74:12.36959343):0.2710010808,((((t76:0.6177929277,(t77:0.3588731562,t78:0.3572342519):0.252877943):1.818928386,t79:2.416011924):3.193155196,((t80:0.5816496942,t81:0.5698863315):3.234107491,(t82:2.525728253,t83:2.505468068):1.233128616):1.461886279):4.361161333,((((t84:2.280402411,t85:2.157093511):2.388098202,t86:4.536710777):2.524395822,(t87:0.7193350751,(t88:0.265090678,t89:0.2630983434):0.3909907336):5.979112574):0.02454925062,(((t90:1.697989231,(t91:1.386440192,t92:1.354651251):0.3022323525):0.5101352003,t93:2.145648751):1.916480101,(t94:0.4133874157,t95:0.3256754509):3.622180122):2.510091999):2.269363999):2.129086888):0.3753293451):2.045507149):2.184818314):0.07361225679,(((((t96:1.135691211,t97:0.6922850849):0.3030451803,(t98:0.384715496,t99:0.3560182023):0.4811047111):2.788539887,(((t100:0.9743340505,t101:0.8830071972):0.06953828903,t102:0.9248983896):2.253258366,((t103:0.2621479754,t104:0.1962778161):0.4334569395,t105:0.5483968306):2.46994362):0.219554671):3.224349734,((t106:3.296464237,t107:3.276211449):0.1349239853,t108:3.389842194):2.900806961):3.488584357,((t109:4.385342426,(t110:3.567177039,t111:3.553196197):0.8150858335):3.345962324,(((t112:0.9390374168,((t113:0.3572387014,t114:0.3128446516):0.4753154252,t115:0.7554064308):0.008540564499):1.187191846,(t116:0.2675663898,(t117:0.1202423229,t118:0.1133002458):0.1260372729):1.626095116):3.323365422,(((t119:1.3400508,t120:1.159096475):0.4819651416,t121:1.410305609):2.700910996,t122:4.001656468):0.6151361261):1.822609908):2.026864912):4.380259315):1.401150912,((t123:1.907922492,t124:1.867219048):5.791723538,((t125:0.5464525951,t126:0.3482793497):0.247049607,t127:0.5680598676):6.835700229):6.536248041):0.5380958847):2.278279879,(((t128:4.524689626,((t129:3.311309131,((t130:0.3569939483,t131:0.3389545029):2.027689157,(t132:1.596430084,(t133:1.079610278,t134:0.8772516784):0.4958000728):0.6558392712):0.8887337591):0.05784167493,t135:2.867144678):1.129764199):9.50158803,((((t136:0.4687498694,t137:0.4625740873):3.910626388,(t138:1.770220801,t139:1.614102774):2.540663488):4.005171291,t140:8.072997923):1.990840642,((t141:4.714619238,t142:4.424836981):2.696849577,((t143:1.602131663,((t144:0.4907855731,t145:0.4818914211):1.102315097,t146:1.551755411):0.006638042717):3.382506824,(t147:0.1354169791,t148:0.1311251061):4.724144801):2.024376357):2.580704037):3.019289701):1.841831906,(t149:4.379958819,t150:4.28632545):9.93525152):0.8625982932):0.3779222666,((((t151:1.200632995,(t152:0.7709933882,t153:0.7499272911):0.3438180165):1.195041951,t154:2.070011927):0.02382096687,t155:2.025935115):1.334224062,t156:3.015613906):11.46154743):0.6051148728,((t157:5.589165267,((t158:1.204356247,t159:1.181817815):1.680852517,t160:2.570241502):2.685505919):3.075036156,(((t161:0.7761137014,t162:0.3419875487):1.811937359,t163:2.043150303):0.5480216062,(t164:1.547328427,(t165:1.41393715,t166:1.336871624):0.04499349515):0.9911267243):5.186489854):6.216051208):3.552148984):1.355626718):3.492165406,((((((t167:1.317383324,t168:1.296975874):7.725269209,((((t169:8.02694509,((t170:0.22013122,t171:0.2031461342):1.910445768,t172:1.986538598):5.853313716):0.3987856971,(t173:3.695856187,(t174:2.49775196,(t175:0.6793329007,t176:0.6697633438):1.671650394):1.186208726):4.341935599):0.1376040498,(t177:4.408310261,((t178:1.09730629,(t179:0.2921114198,t180:0.272207305):0.6989658499):0.7455139865,t181:1.66633016):2.559246713):3.582593842):0.1367657234,(t182:7.588343552,t183:7.541851899):0.3498235935):0.1458847951):0.05583721831,((t184:3.153050107,t185:3.01698983):2.661526519,((t186:5.168497975,(t187:2.461343874,t188:2.378296916):2.590853459):0.419081991,(t189:0.2011050012,t190:0.1272707845):5.095164359):0.08422637276):2.233093289):0.9226181513,(t191:4.547525584,((t194:1.497292332,t195:1.329950173):0.4270159238,t196:1.67143485):2.320378776):3.64821839):4.747235226,(((t197:2.963893515,((((t198:0.4008741048,(t199:0.1504734409,t200:0.1144255092):0.1454440025):1.09411453,t202:0.4833509466):0.0107849807,t203:0.3356672128):1.358355684,t204:1.507283837):0.08221969966):4.042450651,(t205:0.23037559,t206:0.03767165):4.95864787):2.379841307,t207:7.136107579):2.878512371):4.802395134,(t208:4.325046326,t210:4.152734475):10.39286958):2.588441097):0.00202073351,(((((((((t211:0.4284512818,t212:0.4084971219):2.168897039,t213:2.535441114):0.4344310899,(t214:1.420101699,(t215:1.075277864,t216:0.7399624057):0.2777277352):1.353956607):5.886919003,(t217:0.3789260075,t218:0.3657995168):7.6698852):2.63865488,(t219:9.690728893,(((t220:3.666205521,(t221:2.587682944,t222:2.583989665):1.017986741):5.20125872,(t223:4.908521738,(t224:2.192763855,t225:2.183991565):2.631440527):3.784804695):0.5245122204,t226:9.123191156):0.1983767282):0.9796291486):1.522117654,t228:11.64092829):1.49147114,((t229:4.664512042,(t230:0.9792968135,t231:0.9224950175):3.612904873):2.546678415,(t232:1.841908044,t233:1.785805436):5.180076869):5.896637048):0.6204860627,(((t234:1.674291075,t235:1.65438788):2.560604073,t236:4.157921395):4.598426672,(((((t237:3.085666449,(t238:0.6804427156,t239:0.674521457):2.34786004):1.58519743,t240:4.538699259):0.1644829384,t241:4.621290333):0.9516755784,(((t243:0.3893927488,t244:0.3010672609):4.82164869,(((t245:0.99068225,t246:0.882469412):0.476892175,t247:1.328794606):2.884017556,(t248:0.286658407,t249:0.2436583585):3.809432398):0.6855395195):0.1509734256,(t250:4.020719209,t251:3.86481991):0.7519805613):0.09002904302):2.640110224,((t252:1.539501757,t253:1.399755282):5.567116989,(((t254:2.68107584,t255:2.673594832):0.1664836525,t256:2.817905813):3.29672996,t257:6.086610241):0.5364481469):0.1872276268):0.3284257562):4.261971369):1.249482707,((t258:7.336064536,(t259:0.4356305792,t260:0.3513222274):6.86097182):0.7303910388,t261:7.805534979):4.410798653):0.6849282501):20.96049817,(((((t262:2.650916729,(t263:1.318637748,t264:1.207967836):1.299667168):3.343038192,(t265:1.280964291,t266:1.270863094):4.085960204):9.398239534,(((((t267:3.353363761,((t268:1.414009614,t269:1.241043634):1.743705458,(t270:1.721118431,t271:1.707573292):1.245407386):0.1812212224):0.2654767038,t272:3.364111807):1.281225535,t273:4.623982066):2.373222755,(t275:1.566031155,t276:1.559861116):5.229873219):3.652189392,((t277:3.349732899,(t278:3.105994018,t279:3.101387144):0.210934319):2.836116633,t280:6.047278163):4.186429686):3.741779448):7.200654567,(((t281:1.693393239,t282:1.684131582):1.48780032,(t283:0.9442768605,t284:0.8957005511):2.124423995):16.03977289,((((t285:1.232974027,(t286:0.1795497599,t287:0.035523799):0.9413108904):11.61116705,(t288:1.557141314,t289:1.525012937):10.96569607):0.04576152032,(t290:0.2676071693,t291:0.190759155):12.21141623):4.157442832,((t292:0.2780674093,t293:0.2703086014):15.8227502,(((((t294:0.2706740795,t295:0.2444601682):0.06497216558,t296:0.1679444038):0.4529251202,t297:0.6145582442):5.137454834,((t298:0.9671649995,(t299:0.539278846,t300:0.5212275747):0.3417468909):3.684787611,(t301:0.8002503632,t302:0.6799745221):3.727684718):1.039297281):1.013397609,(((t303:0.6881185796,t304:0.6540758524):0.6021487866,(t305:0.8208613198,(t306:0.2160003308,t307:0.03436813991):0.5008375161):0.4317195936):0.884678424,(t308:1.642248021,t309:1.577741308):0.1677589379):4.177916812):8.941633817):0.2915747442):1.990943475):1.895760746):1.286035494,(((((((((t310:0.05140724642,t311:0.03193057611):5.727840771,t312:5.748263816):3.014508009,(((t313:4.577141856,t314:4.573194241):0.2085525721,(t315:4.638938804,(((t316:0.2556071291,t317:0.1196607077):0.5052134403,t318:0.5225923624):3.355528509,t319:3.850461061):0.4785708574):0.1421778685):0.1008785302,(t320:1.744193658,t321:1.655530584):2.715883964):3.840685404):0.9440675621,(((t322:3.183437906,t323:2.937675911):2.33145268,(((t324:2.890868826,t325:2.88817447):0.6609927716,t326:3.529705826):0.4462037658,(t327:3.212363445,(t328:0.6428841865,t329:0.5998537773):2.306034777):0.6442270825):1.258822306):1.572858866,(t330:0.5676262138,t331:0.3143108712):5.682326586):1.906428003):0.3884697539,t332:8.174221348):1.133636697,(((t333:3.669960901,(t334:1.009606123,t335:0.9953942042):2.594272166):3.854768674,((((t336:1.621619337,t337:1.620229978):2.501711035,(t338:2.372251813,(t339:0.4713268844,t340:0.4091381305):1.81233121):1.56493432):1.995447929,(((((t341:1.134006775,t342:1.021756862):0.6554458424,t343:1.524509128):1.319905324,(t344:0.7067226458,t345:0.6861340886):2.137664841):0.7098647751,t346:3.450875153):0.725319314,((t347:3.609856453,(t348:0.639223425,t349:0.5827371597):2.845188375):0.2358743742,((t350:1.266869616,t351:1.238585696):0.1317025398,t352:1.319760716):2.149470699):0.1963600366):1.036275949):0.02441177493,(t353:1.306404621,t354:1.048806801):3.407980886):1.136735453):1.221438984,((t356:1.094775328,t357:1.038942617):1.345055463,t358:2.380037522):4.157289341):0.3082790855):0.01226815332,((t359:0.8379989688,(t360:0.3969935202,t361:0.3600676591):0.3902239625):1.4239773,t362:2.155601688):4.590855621):0.9682300282,(t363:7.17899094,t364:7.161368792):0.3463848823):7.100998549,(((t365:2.128676417,t366:2.083416273):1.447776946,(t367:1.058819378,t368:0.9255760484):2.135805321):2.894378824,((t369:0.02104971967,t370:0.002001178818):3.22244008,t371:3.161799673):2.645073076):8.130020092):0.954544096):9.868590846):165.7821389):21.36223669);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T9.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
