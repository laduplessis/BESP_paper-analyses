<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t436:0.3309900564,t437:0.2723561073):2.299442386,t438:2.514058466):0.4492475018,(t439:1.843043045,t440:1.614956568):1.118687275):5.37851822,((t441:2.205331584,(t442:1.713896032,t444:1.42901921):0.4629437661):0.5433385016,t445:2.393199625):5.312237357):0.1852349507,((((t446:2.232522439,(t447:2.10164368,t448:1.972903402):0.09851355278):0.09922885177,(t449:1.563942657,(t450:0.9005827353,t451:0.8499665785):0.5724784116):0.4644776782):0.1231835588,(t452:1.520653231,t453:1.360102977):0.4305991678):2.90505246,(t454:2.451635415,(t455:1.741491667,t456:1.596332424):0.690352028):2.23085237):2.15433576):25.13730757,((t457:1.143726691,t458:1.07125857):4.45821372,(t459:1.8852041,t461:1.68434763):3.607459111):25.89909388):85.24645486,(((t462:2.954834958,t463:2.927331904):4.308805401,(t464:1.140717485,t465:1.016489136):5.903803168):51.20471844,((t466:30.21247754,((t467:4.05014748,(t468:3.538770746,t469:3.318602834):0.5090117639):4.054255093,(t470:0.1821850812,t471:0.1101857265):7.694775492):22.10373451):1.586634965,((t472:7.360709903,t473:7.092648794):7.54086903,(((t474:2.59883017,(t475:2.403783061,t476:2.219639624):0.1490779217):1.16458942,(t477:2.514311428,((t478:0.6866790624,t479:0.6285853199):1.688441195,t480:2.279453599):0.05724483424):0.8818420573):10.61013733,t481:13.68124278):0.203684869):16.5348301):26.26720327):57.86631734):113.4070343,(((t482:7.019942456,t483:6.975165547):26.36795755,(((t484:6.524123996,(((t460:0.09903369658,(t443:0.2226785287,(((t366:0.1236847424,(t361:0.01804245969,((t284:0.08086337177,(t278:0.05475107449,(t276:0.08759575912,(t269:0.1442121724,((t222:0.207629774,((((t57:0.1721564816,(t15:0.06161736803,t1:1.382760869):4.33390214):8.340665679,((t2:3.168065424,t3:2.989459057):6.075100989,((t4:3.711871393,t5:3.672561533):1.62790171,t6:5.191487974):3.717233644):4.784538116):0.0491655968,(((t7:5.298055577,(((t8:2.551426177,t9:2.490717698):0.960418313,(t10:0.7628155788,t11:0.690678603):2.614331057):0.06207013994,t12:3.140699538):1.53753512):0.1020751807,t13:4.673654252):7.675082306,(((t14:3.061668666,t16:2.908700072):1.384394719,t17:4.213608005):3.790991277,(t18:3.16024711,(t19:0.5178471383,t20:0.4931543314):2.553495606):4.682717709):3.911566243):0.6484054152):1.510417706,(t21:8.722546195,((((t22:2.575206112,t23:2.470703448):0.7871464882,(t24:3.09436036,t25:3.013987226):0.1076597501):0.1491169741,t26:3.11725802):1.874846348,(t27:0.2795926301,t28:0.1972614747):4.683475385):3.26704567):5.056788244):5.967129674):0.8165290035,(t29:11.54154036,(t30:2.810843906,t31:2.766216847):8.650623952):8.414426887):3.155906284):0.4635420932):0.2044166512):0.6262460451):0.3359611661,((((((((t32:4.319138403,(t33:0.2813467146,t34:0.1826634994):3.277792027):1.407040342,(t35:2.365903161,t36:2.286043521):2.457797191):2.592914785,t37:7.237267099):4.393631022,(t38:4.635904805,(t39:0.7430159432,t40:0.7283076813):3.836758282):6.946524376):3.674863041,(((t41:3.687740127,(t42:1.07557786,t43:1.066414171):2.338390793):2.523237111,(t44:2.591735903,t45:2.339249932):3.229055468):3.39949371,(t46:0.3672244605,t47:0.2670522682):8.597179561):5.560227499):2.625225102,((((((t48:2.782911139,t49:2.638680269):3.00392438,(t50:1.835725483,t51:1.704059056):3.605172):0.3208814653,(t52:5.491121053,((t53:0.4677500025,t54:0.4087568045):2.25806426,t55:2.471888015):2.705538336):0.1133328557):1.723641298,t56:6.868709968):4.123137217,(t58:2.830632358,(t59:2.389145202,t60:2.384087635):0.4030427138):7.924789642):3.46350867,(((((t61:3.285363674,(t62:1.830954721,t63:1.627077767):1.389039532):1.546395199,(t64:0.4910341572,t65:0.4897268294):3.76822209):1.648127657,((t66:1.29048427,t67:1.040731717):3.533347493,(((t68:0.1485847529,t69:0.1440656973):2.45943917,(t70:1.21787909,(t71:0.3820762979,(t72:0.2600773743,t73:0.2190289327):0.0572817258):0.5777271139):1.374107193):0.6195856669,t74:2.837926959):1.20164375):1.074384103):3.746054937,(((t75:2.066656289,((t76:0.1712059516,t77:0.07348446758):0.752942649,(t78:0.5865122239,t79:0.5570326835):0.2019962128):1.13460027):5.367581234,((t80:4.301973885,((t81:1.942578305,(t82:1.498891577,(((t83:0.2236392216,t84:0.1172055469):0.1824165992,t85:0.2614238836):0.07650160988,t86:0.2029997676):0.8037987381):0.3116205716):0.4750871859,t87:1.740344191):1.693567099):0.5927894233,t88:3.98121444):2.052727573):0.5749456069,t89:6.587543185):0.7265400686):3.115111898,((t90:5.193964212,(t91:2.931102556,t92:2.717698282):2.20166009):2.048510212,(((t93:0.09913521481,t94:0.07522106112):2.322675821,(t95:0.6200568268,t96:0.5320144265):1.72447834):3.212020786,((t97:1.507417123,t98:1.46178853):2.771304302,(t99:1.823335059,t100:1.802210702):2.390291498):1.095966005):1.137813886):3.16043708):0.7754773035):1.629834178):1.14623478,(((t101:8.270750906,t102:8.25274813):3.065868752,((t103:4.312538609,(((t104:1.190821783,t105:1.102520214):1.162375924,(t106:1.412685823,t107:1.24675147):0.8397000824):0.9688625711,t108:2.923329985):0.9492573585):4.588645488,(t109:5.489103302,t110:5.288118613):2.744657649):2.335888933):0.7204537643,(((t111:3.095148854,((t112:0.6217841653,t113:0.4725945348):1.597550642,t114:1.757383022):0.8640653376):1.860506958,t115:4.352284642):4.532967637,(t116:4.617378206,(t117:1.503320522,t118:1.475660206):3.110328751):4.224659749):1.387203563):0.9898844716):0.6296724396,((((t119:7.917682352,(t120:3.8100642,t121:3.653350076):3.758148289):1.717689831,t122:8.837962252):0.02270089954,(((t123:1.282847857,t124:0.9905116894):4.493384202,(t125:2.798036669,(t126:0.9870097051,t127:0.9288177537):1.768739719):2.678468296):2.371906094,(((t128:1.481556313,t129:1.455066688):1.377257402,t130:2.821124642):2.433204653,(t131:1.296814171,t132:1.279524728):3.868095033):2.351337902):0.4475442785):1.916680001,((t133:0.3360425724,(t134:0.0365691547,t135:0.02913586876):0.2669100289):3.726389602,(t136:0.3702308596,t137:0.1022684169):3.64269943):5.762681796):0.129914248):3.818636779):7.032102861):1.06963028):1.478172474,(((t138:2.302928089,t139:2.068181373):9.837054896,((((t140:1.20356276,t141:1.174928084):3.886775032,(t142:1.750971863,t143:1.717681273):3.23982619):2.992927312,((t144:1.184137663,(t145:0.4415546945,t146:0.158718071):0.5942262399):5.670303754,(t147:5.133090912,(t148:1.84124786,(t149:1.133122409,t150:0.9944579515):0.6955013727):3.210744898):1.276407654):1.039855952):3.708474434,(t151:7.704297049,(((t152:2.647362249,t153:2.581621062):2.644716138,(t154:2.648216717,t155:2.513797974):2.506118702):1.412742795,(t156:1.830628882,t157:1.61042708):4.564635292):0.7470622596):3.059056455):0.06411111958):1.732551641,(((t158:7.856411731,t159:7.601981097):1.4654095,(t160:8.744862193,((t161:2.365710378,t162:2.181587726):2.725348124,((t163:0.7402709966,t164:0.6746951669):2.164469781,t165:2.683016974):1.693841933):3.55978222):0.2451764816):0.4307674605,(((t166:2.127531316,(t167:1.061067447,(t168:0.3507932696,t169:0.3065080136):0.6632181458):1.030045899):2.743096791,t170:4.709980844):0.4365936302,(((t171:1.1680476,t172:0.9886203189):2.921115146,t173:3.88120189):0.9792354349,(t174:1.433935453,t175:1.423576124):3.412637162):0.03513957478):3.191357914):1.902664582):9.115758364):5.647410042,(((t176:16.00966764,(((t177:3.702027418,t178:3.413474775):0.7566943229,(((t179:0.2300109204,t180:0.1715881487):0.9714330704,t181:1.084898829):1.227028427,(t182:0.5635078885,t183:0.5113300919):1.475718891):1.675786303):11.46193555,(t184:12.02054278,((((t185:2.29951467,t186:2.235055913):1.113419437,t187:3.308053509):1.802812662,(t188:1.224420091,t189:1.173188304):3.764630227):5.635011435,((((((((t190:1.617956937,(t191:0.2505898485,t192:0.2323847417):1.29550281):0.7842609858,t193:2.270916407):0.05900361793,t194:2.323002299):1.752207587,(t195:0.6726664365,t196:0.4851059625):3.347629383):2.65155723,(((t197:0.6039069039,t198:0.5452684053):0.6530444413,t199:1.097741111):0.3463584341,t200:1.423184227):4.816110939):1.010672007,((t201:0.3382052772,t202:0.2742581584):0.3950545718,t203:0.5089406616):6.405972129):2.035654044,t204:8.805470402):0.2337943317,(t205:1.937113376,(t206:0.1482061536,t207:0.1279273645):1.722684052):7.060817794):0.2786690267):1.057943958):3.095028563):0.02895152579):4.893908314,(((((((t208:0.01529582009,t209:0.01255472495):0.1947076793,t210:0.08528622843):0.2089282235,t211:0.2529158012):8.3209876,(t212:4.432807179,t213:4.432294321):4.03163771):0.09758681186,((t214:2.803788341,(t215:0.5266944698,t216:0.4921304501):2.175882341):5.436815532,(t217:3.386585208,(((t218:2.009005895,t219:1.961143225):0.2788511994,t220:2.128419559):1.087817907,(t221:0.8022411621,t223:0.2891364015):2.39757158):0.009044735376):4.605201114):0.217182854):1.83923228,(t224:1.220087801,t225:1.020103231):7.990808098):7.093904897,(((t226:4.353553474,t227:4.336589098):7.890922518,((((t228:0.3304077712,t229:0.2419097814):0.03987780517,t230:0.2137532273):3.695289988,t231:3.87598162):3.388315124,t232:7.152723069):4.63801528):1.823996176,(((t233:2.106078289,t234:2.018792738):1.506418127,(t235:1.354492115,t236:1.261777734):2.155558291):5.146127776,t237:8.409044248):4.847262076):1.954667526):0.3968778412):2.670537192,(((((t238:2.059609342,t239:2.017911688):3.070886779,((t240:1.388059744,t241:1.373907893):2.421970991,t242:3.782706461):1.266956473):2.365220198,((t243:0.7545327141,t244:0.7090813306):4.940347649,(t245:2.980949069,t246:2.893612759):2.55196407):1.692261998):2.881432093,((((t247:0.8159095992,t248:0.72226006):0.6313377452,t249:1.324668557):0.2435850041,t250:1.490535752):4.036536788,(t251:1.807933706,(t252:1.000787876,t253:0.826351181):0.7622197829):3.692658601):4.25455274):2.438137951,(t254:6.059142142,((t255:3.817886785,t256:3.717170195):1.550593606,(t257:3.233824999,t258:3.191595777):2.02792295):0.641699199):5.866524085):5.359204941):1.128193342):0.558213337):1.853243532):2.058752766,(((t259:15.02088286,((((t260:0.6917708738,t261:0.5158332506):0.1660102274,(t262:0.2418866763,t263:0.1417409764):0.1360861917):1.639768734,(t264:1.539514605,t265:1.454014765):0.3540426221):8.830717152,((((t266:1.981845779,((t267:1.220876045,(t268:0.5489765381,t270:0.357233724):0.6096867678):0.3183321694,t271:1.214678792):0.3459266619):0.2423381354,t272:1.801949225):1.844799423,t273:3.546801434):4.509360755,((t274:2.987118278,(t275:2.563059561,(t277:0.3173743056,t279:0.1816071894):1.980292643):0.4237827245):0.1597380323,(t280:0.4487687837,t281:0.410816844):2.200905195):4.812030746):2.018698436):3.534533719):2.881386461,t282:15.79079093):0.4719342009,((t283:5.708134528,t285:5.503378374):0.359365281,t286:5.765827065):9.959847218):4.179175314):3.527056519,(((((((t287:2.45530378,t288:2.441756329):1.705959668,(((t289:0.4160166683,t290:0.3603588899):0.1442794545,t291:0.4257571826):0.9032963231,t292:1.235214072):2.673007688):2.780310024,t293:6.531491237):0.9673468614,(t294:0.6835750289,t295:0.6472318511):6.784343831):0.3015479306,(((t296:3.069636204,((t297:1.689184305,t298:1.406886282):0.4134453003,t299:1.815188432):0.6584419672):0.6466306122,t300:3.080404613):2.880214882,((t301:2.464596678,t302:2.433078771):1.526559023,t303:3.875174277):1.897726976):0.9530617049):5.277210732,((((t304:3.333399988,(((((t305:0.7760926915,t306:0.7538699942):0.08938896381,t307:0.6742140168):1.103662932,(t308:0.2697876044,t309:0.206136839):1.178694611):0.7860819441,t310:2.070033067):0.3488497402,t311:2.240480864):0.2281438296):0.7062962538,((t312:0.3590143036,t313:0.210051934):1.844740245,t314:2.026804647):0.8832857263):3.508063137,(t315:3.030626402,t316:3.023890085):3.292268508):3.086408191,((t317:4.657665301,t318:4.601262027):0.4940616008,(t319:2.067464097,t320:2.044013858):2.91650464):4.00115385):1.214775733):6.343834577,((((t321:3.713361202,(t322:0.6487726982,t323:0.6268770731):2.970762484):0.3567648894,(t324:0.7022154227,((t325:0.0631412305,t326:0.01751044393):0.2392406161,t327:0.2355615697):0.3520261979):3.178983015):3.264931213,((((t328:1.178369269,(t329:0.9302161259,t330:0.9008759458):0.2189090571):1.219727613,t331:2.262658928):1.083488848,t332:3.34215257):1.898354903,(t333:2.341500317,t334:2.319534346):2.866693512):1.626086693):5.969461419,((((t335:9.578440131,(((t336:2.509523034,t337:2.482693225):0.3780509634,(t338:0.3383519332,t339:0.3161282855):2.483897705):6.445219137,((t340:5.078045234,((t341:1.153353174,(t342:0.6266943336,t343:0.3504172418):0.4758983922):0.2687553638,t344:0.9779399187):3.6559205):2.894439818,(t345:6.678101793,(t346:3.121658199,t347:3.066270031):3.543274193):0.3394248172):1.23287281):0.1213851787):0.7788291601,((t348:6.729002457,(t349:1.097125996,t350:1.005691817):5.479953758):0.9160697861,((t351:6.909826069,(t352:3.680013589,(t353:0.4986460269,t354:0.4694581827):3.063141915):3.229401903):0.444878637,t355:6.777672509):0.02045348781):1.274927568):0.8721298322,(t356:3.217056498,t357:3.044222533):5.660521349):0.8489645606,(((t358:3.390056894,(t359:1.417098349,(t360:0.1198025662,t362:0.04285307695):1.238498548):1.896152129):2.264266476,((t363:1.67796515,(((t364:1.008417343,t365:0.8904503856):0.08529568272,t367:0.5430515689):0.2572556927,t368:0.767793965):0.038284142):0.1780318171,t369:0.9309597196):3.268201136):0.1454851909,(t370:3.354471799,t371:3.351347188):0.9268868378):3.553077215):0.4872659628):3.104346858):3.458695887):3.893083287):4.39434439,(((t372:1.806133386,(t373:0.4966101294,t374:0.4037027258):1.298108359):3.52141044,t375:5.008016539):14.07493141,((((((t376:1.489614352,t377:1.443545396):1.16580989,t378:2.472222451):0.5265170231,t379:2.870500842):0.3400935275,t380:3.147364026):4.14880716,(t381:6.494288995,((((t382:0.7720542397,t383:0.5111622657):0.9314017933,t384:1.07499178):0.7875794616,t385:1.827550623):1.832700009,(t386:2.363236665,(t387:2.09096342,(t388:0.4309531131,t389:0.4148137069):1.337435814):0.2662520827):1.222062979):2.140960273):0.5537352173):4.433286295,(t390:6.166282458,((t391:1.610877496,t392:1.478885894):2.142370299,(t393:0.8527148374,t394:0.501200403):2.746408971):2.262509399):4.173905196):6.928737063):3.690872567):3.146234573,(((t395:4.772011697,t396:4.722479726):4.671156993,(t397:0.8566914856,t398:0.7128438897):8.474091687):1.300347363,((t399:3.317018147,(t400:1.370154875,t401:1.366803572):1.62732353):1.614699823,(t402:1.070286831,t403:0.9839641782):3.533098604):5.309892517):12.66666337):19.27548259):11.44199753,((((((t404:2.336260571,t405:2.301444929):0.2439052584,t406:2.448397157):8.216586103,((t407:5.169593749,t408:4.965423542):2.632372143,(t409:3.2701466,t410:3.266201625):4.130604543):2.715933466):0.3356621294,((t411:5.087949434,t412:5.066129584):4.092109754,((((t413:3.139742053,(t414:2.752748791,((t415:2.272498705,t416:2.217684652):0.3698669555,(t417:0.7075401376,t418:0.6858235401):1.810016945):0.07627710627):0.2323372826):3.134312449,t419:5.913136009):0.7590871036,t420:6.46566641):1.15971013,(((t421:3.701967393,(t422:3.08021197,(t423:1.634256131,t424:1.427560723):1.43450896):0.4685458209):2.661947142,(t425:0.6810578574,t426:0.5959452308):5.129660631):0.6826949508,(((t427:2.153726274,t428:2.120717117):0.3022376043,t429:2.302734522):2.169294464,t430:4.419182898):1.699812752):0.5703656633):0.723039268):1.181474469):12.12524618,(t431:13.59321787,(t432:1.394587686,t433:1.297162537):12.15633952):7.081296062):18.91929171,(t434:1.413099714,t435:1.396165978):37.91711509):10.97922184):182.1512954);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T17.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
