<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t477:3.204541761,t478:3.194937808):25.37260571,((t479:0.7073069551,t480:0.7026640573):4.111986698,((t481:1.1745753,(t482:0.6936930338,t483:0.4087102082):0.4801049977):0.974971144,t484:1.784371078):2.641857087):23.73064542):38.34887164,((((t485:3.912952672,t486:3.897036491):18.21604506,(((t487:2.025863384,t488:2.010123425):1.117072412,(t470:0.01149096143,(t460:0.08400711291,((((t431:0.007065854328,(((t338:0.03758820135,(t326:0.1243423156,(t320:0.04686247495,((t302:0.0666256056,(t283:0.04198998302,(t253:0.1634549968,((t234:0.1177698202,((t162:0.1091469946,(t151:0.2200371282,(((t82:0.308551539,(t1:6.441432986,t2:6.394203379):2.718330954):1.93242326,(((((t3:5.411012283,t4:5.357883964):0.7948993833,t5:6.073198366):1.135591951,t6:7.061285521):1.496465554,((t7:4.725130735,t8:4.577563771):0.9852601642,t9:5.323403391):2.815010263):0.9935045091,((t10:2.921613014,t11:2.668654198):3.556431195,(t12:2.344160988,t13:2.253033775):3.878777422):2.637850566):1.211016389):2.19647967,((t14:8.821937865,((t15:5.910356252,(t16:4.998223653,t17:4.915991926):0.9064586015):2.647868018,(t18:0.8876138851,t19:0.8294461146):7.518020586):0.07689769097):2.668493104,(((t20:2.70391142,t21:2.683880054):1.961893172,t22:4.642425407):4.139923957,(t23:0.07571496245,t24:0.0756329581):8.702605059):2.257346192):0.6369157972):2.375808533):1.172816434):1.216134096,((t25:9.808790049,(t26:8.878870273,t27:8.83992941):0.7647898366):2.077404665,((((((t28:4.446853031,((t29:2.22627593,t30:2.092159855):1.241125428,t31:3.326823238):0.4548032288):0.2993056964,t32:4.063331816):3.43042349,t33:7.33883275):0.602551588,t34:7.773305172):0.3513645867,((t35:4.486103163,((t36:0.4560557795,t37:0.4220920955):0.7148244016,t38:1.078156954):3.256048769):1.066853617,(t39:4.316109274,(t40:2.635446525,((t41:1.03047256,t42:0.9075527773):0.8741701384,t43:1.699851987):0.6133087564):1.580063721):1.027076977):1.890993066):0.3494873335,((t44:1.292228215,t45:1.148801979):2.421405442,((t46:0.367991781,t47:0.3204069488):1.347177525,(t48:1.213282181,t49:1.204357039):0.3230431282):1.850668045):3.441330088):1.985601152):4.381826498):5.358055706):0.7440377179,((t50:13.25170386,(t51:1.607154052,(t52:0.4691596999,t53:0.4545130552):1.124681801):11.53857769):4.499577612,((((t54:1.166332153,t55:1.07868082):7.520472537,t56:8.569777584):0.421169173,((t57:2.937323365,(t58:2.558657347,(t59:1.557707858,t60:1.460371757):0.8020760728):0.3255591991):1.960156585,t61:4.454058795):3.99651882):7.091304509,((t62:10.19593773,(((t63:1.246678539,t64:1.218865651):4.631737688,(t65:4.004958809,t66:3.95523931):1.619053682):0.9527490534,((t67:3.940125882,t68:3.811657537):2.045984419,((((t69:0.7969499571,t70:0.6569669462):0.1738389009,(t71:0.3960403707,t72:0.2872001078):0.09903719611):1.518955117,t73:1.807810365):2.683795292,(t74:0.7312327292,t75:0.383890077):3.645613459):0.4235370061):0.4034635085):3.320622499):5.272659817,((t76:4.427502593,t77:4.42185744):2.901936493,(t78:3.714346681,(t79:3.298238651,t80:3.041983314):0.3459930631):3.500550314):6.054277033):0.07176656254):1.389528645):1.513539309):0.8919045086):2.464200221):2.260484579):0.8840447229,(((t81:11.39085827,((((t83:0.2024728631,t84:0.1106918583):3.757250088,(t85:0.7795796062,t86:0.7774566535):3.043105469):6.055318471,((t87:5.813867511,t88:5.809635819):2.792157206,((t89:0.9871146195,t90:0.9410524229):3.799258267,((t91:0.6970486842,t92:0.596410676):2.393945626,(t93:2.11452027,t94:2.082744964):0.8578358018):1.580154659):3.800985393):1.195462595):0.1403371824,((((t95:2.538958376,t96:2.115724658):0.5243833267,t97:2.547488652):0.6838958591,t98:3.034033682):1.174413186,t99:4.139975769):4.704494355):0.395469411):6.333121397,((t100:6.69752044,t101:6.549976067):7.541436961,(((((t102:2.262215523,(t103:1.848544231,(t104:0.7983557217,t105:0.6800901119):1.008879592):0.04288305721):7.066012913,(t106:0.2244474785,t107:0.04606885088):8.554503891):0.06011668212,(t108:2.627898426,(t109:0.8959622865,(t110:0.280098,t111:0.08175281199):0.556781695):1.722518234):5.832305905):0.7463669484,t112:8.930712229):1.627401757,(t113:0.4111352938,t114:0.3149796736):10.04856243):2.045643446):1.321494549):3.877265077,((t115:0.8047207585,t116:0.6992483623):16.52004926,(((t117:4.972483382,(t118:1.001093343,t119:0.8887742826):3.944270591):4.10882368,(((t120:2.887370538,t121:2.833347325):1.757646587,t122:4.514911864):1.91606382,((t123:0.637497139,t124:0.5682169351):1.209559679,t125:1.753194541):4.469143949):2.279337686):4.246069676,(((t126:1.554473157,t127:1.304898207):4.194028555,t128:5.453337852):0.6368357144,(t129:1.242381152,t130:1.221983164):4.845502069):6.289573279):3.772279716):0.1633986):0.7333113413):0.3507845637):0.8744590635):1.187369665):7.091301529,(((((((t131:0.7302611614,t132:0.6107577379):0.963487161,t133:1.479101638):4.397064838,((((t134:3.430456216,t135:3.397452734):0.9200249619,(t136:1.301914175,t137:1.278268496):2.843842788):1.068159812,(t138:2.253162241,t139:2.199871392):2.805280593):0.3684195062,t140:5.102228959):0.04491580812):7.520441121,(t141:6.5232197,((t142:2.571084693,t143:2.538935054):1.911103872,(t144:1.021795778,t145:0.873575659):3.334211699):1.869143145):6.126666136):0.7088773164,(((((t146:0.8620172392,t147:0.7456442553):0.7157235563,(t148:1.172217707,t149:1.104114254):0.2212484547):0.5046668037,t150:1.821636555):2.126006474,(t152:0.4633086224,t153:0.4184891519):3.121411369):5.23052258,(((t154:2.655808744,t155:2.64875071):1.626530051,(t156:1.558297551,t157:1.472220688):2.586300594):2.150951519,t158:6.156235465):2.193636267):3.410270689):1.209628925,((t159:10.32419213,(((t160:2.437590516,t161:2.175776257):4.553542391,t163:6.411524217):0.6240767113,(t164:4.797697046,((t165:0.3051095918,t166:0.3050765969):1.611345944,t167:1.86822783):2.823076688):2.195019027):2.609195344):0.4762769796,(((((t168:1.333550724,(t169:0.2655582093,t170:0.2440557834):1.003921003):0.4158951701,t171:1.628940598):3.797951704,((t172:2.937911697,t173:2.890334038):0.09467891492,(t174:1.497019057,(t175:0.926634207,(t176:0.6198589901,(t177:0.2408092123,t178:0.1828677881):0.3535564088):0.1069305553):0.5569711598):1.487869352):2.3367582):0.7788179532,((((t179:1.034279641,t180:0.8599789234):0.3069655161,t181:1.124130373):0.03798297664,t182:0.9091738319):0.3181541394,t183:1.197279731):3.987316354):1.084854674,(((t184:0.2382949094,t185:0.2246534533):1.441880797,t186:1.56110345):1.989926166,t187:3.529421674):2.475331378):2.515008656):2.097860553):0.8760034773,((((((((t188:2.38391669,(t189:1.143761677,t190:1.11636721):1.240009474):0.1554734599,t191:1.979634853):1.775398286,(t192:2.928625615,t193:2.278580965):0.7989167483):1.170747577,(t194:3.681494385,(t195:3.272256133,(t196:0.03037428158,t197:0.0100380634):3.202191796):0.2743606181):0.4180421831):1.536133644,t198:5.387645596):1.726936399,t199:7.006848833):1.094968664,(t200:6.808796414,(t201:1.56110297,((t202:0.6777962116,t203:0.6325681983):0.6013089713,t204:0.929719736):0.04159377127):5.063758863):1.288461648):0.8692837675,(((t205:1.169369844,t206:1.151452292):2.813531557,t207:3.797104116):1.872922523,((t208:0.3198110582,t209:0.09312106711):0.183659409,t210:0.2291657545):5.093662828):2.323142993):0.641034612):10.10875472):0.2890615834,((((((t211:0.5123979479,(t212:0.1787167897,t213:0.02610579527):0.3157356469):2.920623779,t214:3.258730478):1.659166555,((t215:3.010571351,t216:2.999283838):0.9018382892,t217:3.878582358):0.924524133):4.63054598,(((t218:2.666545763,t219:2.59533767):1.611369646,((t220:0.7541886561,t221:0.7491575272):1.020136775,t222:1.737228519):2.39918165):1.700704338,((t223:0.5708707681,t224:0.527889163):1.039494,t225:1.51968056):4.155891283):3.347373732):3.664948316,(((t226:1.472466759,(t227:0.8581695054,t228:0.719928768):0.5937016666):4.543560239,((t229:2.948112925,(t230:2.233498634,(t231:2.078675371,(t232:0.2835899497,t233:0.2748008173):1.505410186):0.07079150021):0.6592377494):0.3450929145,t235:2.446876404):2.495113317):2.442708283,(t236:3.273660645,(t237:0.1838375884,t238:0.1694552479):3.069601817):4.042242465):4.22791594):0.1584348001,((t239:2.401757315,(t240:2.188273869,(t241:0.3806477509,t242:0.2353324405):1.775367529):0.1534508828):8.642728679,((((t243:3.131320917,(t244:0.7938937955,t245:0.6891478655):2.272292065):0.1335359814,((t246:0.8199553848,t247:0.8017644817):1.305100485,t248:2.085420887):0.932458731):3.205343915,t249:6.184204178):0.4286921404,(t250:0.8634606682,t251:0.8288404829):5.45271689):3.901293445):0.5494104982):5.127305342):2.047250573):0.7831548655,(((((t252:4.690977813,(t254:0.4003033039,t255:0.3165952225):3.836020183):0.9347812114,(t256:2.85782459,t257:2.849914548):2.060654506):2.292019237,(((t258:0.7069614112,t259:0.6551664445):2.580480937,((t260:1.826955127,t261:1.763387108):0.3524183045,t262:1.918584979):1.055320043):1.104170392,((t263:2.556629611,(t264:2.305286056,t265:2.286857453):0.2027307213):1.470176024,(t266:2.765243338,t267:2.455301077):1.183712192):0.005638380086):2.739330964):0.3746585622,((t268:1.388346615,t269:1.354103957):3.583401564,t270:4.882857692):1.519075683):6.018734243,((((((t271:3.777124797,t272:3.750741052):0.5350381618,(t273:2.366264481,t274:2.321907016):1.835551935):2.10603194,((t275:0.1901726205,t276:0.03376695184):3.760041764,((t277:0.6946156104,t278:0.4175490411):1.785078781,(t279:1.148693901,t280:1.10160642):1.049524046):1.266575396):2.258771406):3.886216481,(((t281:2.652368413,t282:2.640123469):1.736815124,t284:4.203391397):0.5194175948,t285:4.646932428):4.583033497):0.1807025444,((t286:0.7796138317,t287:0.7430656963):0.8219377179,t288:1.457669247):7.438730844):1.790718504,t289:10.6590232):0.08115396055):4.28205655):0.9840033537,t290:15.92431588):0.8719016179,(((((((((t291:1.97431516,t292:1.897305376):1.104279671,(t293:1.656307737,t294:1.595170615):1.342873143):1.727768627,t295:4.663418581):0.5958322048,(t296:0.8545867899,t297:0.8430033988):4.068267943):2.546652736,t298:7.456190942):3.503302111,(t299:3.621248995,(((t300:0.4605385093,t301:0.3346102522):0.4350476559,t303:0.5144966422):2.305106021,t304:2.793016126):0.2409362697):7.150573078):1.526327401,(((t305:0.9009989914,t306:0.8861685246):2.513658393,t307:3.313989147):1.215015522,((t308:0.7376097982,t309:0.6599521968):1.002892239,((t310:0.4195135759,t311:0.3977527173):0.6196432666,(t312:0.4015887819,(t313:0.2427475771,t314:0.2286776972):0.1195323383):0.5267867807):0.4063645419):2.78662673):7.066463509):1.408512587,(t315:3.12835397,t316:2.956968397):9.296088699):0.1798067186,((t317:5.062061241,(t318:3.659543321,(t319:2.679342722,t321:2.450626523):0.967688393):1.323157959):6.252424009,(((t322:4.376111354,((t323:1.390739676,t324:1.153387671):2.06624971,(t325:0.7503314722,t327:0.4142265758):2.457496539):0.857610246):1.80422682,t328:5.407640533):3.053574756,t329:8.142335031):1.608719448):1.077301367):1.952537505):0.007354222432):0.7033964882):5.22120964):11.93547123,(((((((t330:5.66481008,(t331:5.254628419,((t332:3.198155368,t333:3.14381373):1.035589003,(t334:2.983260469,t335:2.662953509):1.141202382):1.01090101):0.4087306196):7.227598011,(t336:5.818098118,t337:5.807533725):6.621226125):2.09585317,((t339:3.663300579,((t340:0.4862667977,t341:0.4129069403):1.610726896,t342:1.931872031):1.346324521):6.201831664,(t343:1.35435225,t344:1.22885784):7.702718955):4.569578012):1.952869213,(((((t345:0.1746759153,t346:0.1535144033):4.945299565,t347:4.902418835):1.291836568,(t348:1.484546661,(t349:1.017983957,t350:1.010062153):0.3316632188):4.669874001):4.453837468,((((t351:1.412214783,t352:1.348937812):1.208431808,t353:2.304087846):3.468082479,(t354:4.983002787,((t355:2.059434808,t356:1.996061203):1.797172571,t357:3.732313836):0.9481723227):0.7505820154):0.8756129752,t358:6.128229332):3.351371325):0.8554281095,(((t359:1.142049926,t360:0.9486454251):4.15321768,t361:5.033866376):4.502404324,((t362:0.5767082914,t363:0.4842065705):1.679610747,t364:2.137627463):7.095964005):0.4201498359):3.623790045):0.04386995304,(((t365:0.5238468977,t366:0.5018803715):4.743362437,(((((t367:0.3865210372,t368:0.341221272):1.415862531,(t369:1.366825264,t370:1.24850139):0.1382795946):0.7706121728,t371:2.101171099):1.769431376,t372:3.834376784):0.07915521036,(t373:2.551266954,t374:2.416449015):1.216268216):0.7861271035):5.069545354,(((t375:3.788480174,((t376:0.2762942573,t377:0.01794861378):2.66748746,t378:2.682211412):0.5481622957):1.793253558,t379:4.853671581):0.09628892393,((t380:1.241125024,t381:0.9439858135):0.7397974184,((t382:0.2187185781,t383:0.1160169342):1.177405574,t384:1.268773928):0.2041438847):2.914974084):3.713097222):2.943702621):3.519889298,((((t385:4.296723015,((t386:1.427073256,t387:1.21626236):1.540978992,((t388:1.361786327,t389:1.035680246):0.02962553982,t390:0.9468916515):1.249297691):1.242439068):1.903075572,t391:5.310065387):1.435688296,((t392:0.8539682601,((t393:0.04010385254,t394:0.03359133636):0.2411423295,t395:0.264105659):0.5401592378):3.832646663,((t396:2.288209067,t397:2.191690652):0.1220512497,t398:2.307430921):2.223652114):1.951033761):0.21612074,((((t399:1.56686311,t400:1.554172478):0.7958688345,(t401:0.2925555601,t402:0.152373315):1.947457525):1.546147558,t403:3.455953499):0.6432141143,t404:4.000953541):1.985482647):6.465203387):8.220460048,(((t405:1.04155051,t406:0.6947911691):0.6915208352,t407:1.318846015):3.981633196,t408:5.280445238):14.92059765):1.739265273):6.569184907):8.350528872,(((t409:16.477527,(((t410:0.4768796302,t411:0.4746715989):3.56165691,((t412:0.07597120225,t413:0.06066135855):1.833842138,t414:1.858748656):2.119340845):3.874451015,((((t415:0.08570130634,t416:0.047737543):0.162442896,t417:0.1359978164):2.239428694,(t418:0.6244474329,t419:0.5497895033):1.704988017):3.06645319,(t420:0.4903618118,t421:0.4822577562):4.727599221):2.214668857):8.507703923):10.03132294,((((t422:9.82695678,(t423:8.616786162,((t424:1.231177408,t425:1.112060504):2.941028773,(t426:3.423473187,(t427:0.8481010293,(t428:0.2153691469,(t429:0.02390887513,t430:0.00921585336):0.1055153449):0.4917033204):2.401398226):0.510928099):4.324107167):1.135793071):0.0427721089,t432:8.917916328):10.60271839,((((t433:1.20466837,t434:1.131689789):2.007373545,t435:2.798036028):0.3714201957,(t436:2.303728891,t437:2.272159832):0.7268775001):3.70325755,(((t438:0.4437748708,t439:0.3974613345):0.5627586505,(t440:0.7639423656,t441:0.6313534664):0.03318736658):0.2303204685,t442:0.8620582158):5.296720846):12.19651707):2.939131838,((t443:6.236480211,(((t444:1.764589721,t445:1.538648208):1.221444257,t446:2.624461762):0.2840879859,t447:2.890269986):2.930371798):3.428015263,((t448:0.4765281516,t449:0.4198258218):0.446994464,t450:0.8554315794):8.196320096):11.62260051):2.546489032):4.235449735,(t451:6.331028564,((t452:1.142470639,t453:0.9355213569):1.839339398,t454:2.690720563):3.345760852):21.12327105):6.114658469):4.914193057,(((((t455:1.671211424,t456:1.659022369):1.673038257,t457:3.321360832):18.76165569,((t458:0.8310060109,t459:0.7559435511):0.9540131701,t461:1.248546603):20.22503021):9.600051998,(t462:5.155039556,(t463:1.777881128,t464:1.77652246):3.370210863):25.83619208):4.202163749,(((t465:3.628005848,t466:3.594395762):1.643978645,(t467:3.002010668,t468:2.971405468):2.182232014):12.48206019,((t469:2.910667726,t471:2.811634792):7.650809038,((t472:0.6975359876,t473:0.4430960041):9.673124497,(t474:6.087858783,(t475:3.239936339,t476:3.11224456):2.603116674):4.007372376):0.01852285249):7.020128682):17.18439754):2.270590022):30.94497212);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T94.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
