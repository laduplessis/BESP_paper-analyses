<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t367:7.546933629,(t368:2.258234035,t370:1.80809406):5.258908939):0.8509968253,(((t371:0.7529689834,t372:0.7467252954):4.504586987,t373:5.1126843):2.275710044,(((t374:4.208984196,t375:4.170467296):0.4946900299,((t376:4.019397258,t377:3.873955617):0.4875162452,((t378:3.27589701,(t379:0.6404864542,t380:0.5147900936):2.570988976):0.518034548,(t381:1.88882653,t382:1.830409532):1.682179993):0.5434971402):0.1310689177):2.01913482,((((t383:1.529634948,((t384:0.5288800667,(t385:0.3296812267,t386:0.3031776577):0.1310496198):0.02334743819,t387:0.40957074):0.9388061652):0.6302374333,t388:1.867076012):2.883814215,(t389:3.821392132,t390:3.812045368):0.8176293653):0.6678897424,((t391:1.27143912,t392:1.214166912):0.09659532902,t393:1.138113085):3.814684906):0.3487857044):0.6194909272):0.1727661548):1.511003235,(t394:3.470030313,t395:3.355244498):4.087962463):2.944522192,(((t396:0.5055204307,t397:0.04226060289):7.358315402,(((t398:0.7263953752,t399:0.6407581955):3.163319398,t400:3.779410254):2.681690841,((t401:1.073815411,(t402:0.7030911512,t403:0.686905902):0.290757376):0.4788644662,t404:1.3914704):4.770055904):0.6438610415):1.32662683,t405:7.988428876):1.185856315):2.372209107,(((t406:2.125033087,t407:2.122201564):4.519923489,(t408:3.240430058,(t409:0.2739038834,t410:0.1666181184):2.849162446):3.217317229):2.298334669,((t411:7.811832636,(t412:5.490198123,t413:5.396676491):2.305617251):0.3925145351,(t414:4.114161361,((t415:3.095952362,t416:3.014007344):0.9764037188,(t417:0.9700896749,t418:0.8854519068):2.955698448):0.03021602745):3.950070495):0.2499378983):2.546909654):7.807974892,((((t419:0.7318910313,t420:0.7256341855):2.049765553,t421:2.775382145):2.248510765,t422:4.574362757):9.112320007,(t423:1.138791284,(((t424:0.3904900717,t425:0.3646997635):0.1804648873,t426:0.4220762723):0.1822908643,(t427:0.3472477672,(t428:0.2679454682,t429:0.2396667327):0.04282647808):0.007533056385):0.2085462743):12.50922811):4.19191242):36.24070982,(((t430:4.120673484,t431:4.111717122):4.046031299,(((t432:1.647852167,t433:1.403688971):1.29902651,(t434:1.537639231,(t435:0.2430303973,t436:0.2017169535):1.209716241):0.9691610848):2.465016864,((t437:2.83298902,t438:2.720446802):1.638641006,t439:4.332761496):0.3720537605):2.689924662):44.72423721,(((t440:5.322266345,t441:5.274616684):23.70741767,(t442:0.5198394532,(t443:0.230941559,t444:0.1944365113):0.2478748489):28.26274739):1.980999189,((t445:12.64419755,(t446:7.109106654,(t447:4.99608105,(t448:1.236691641,t449:1.110625977):3.742587711):2.093851434):5.449494553):9.517434108,((t450:3.832219204,t451:3.804248343):5.02815928,(t452:2.050055366,((t453:1.007469646,t454:0.8342134283):0.3409694852,t455:1.137640878):0.6871879268):6.645261059):12.89760461):8.496599136):21.06362588):0.4149323403):70.75902203,((t456:24.08922323,((t457:5.865837477,(t458:1.383501198,t459:1.349775177):4.427597042):8.963584426,(t460:9.799690843,(t461:1.517821776,t462:1.412555362):8.266293497):4.577251859):9.223295168):0.8328724601,((t463:0.3500562879,t464:0.1242123233):20.5438519,((((((t465:1.13192839,t466:1.04631345):7.649701835,((t467:2.49690606,t468:2.458294077):2.338294773,((t469:0.7737913641,t470:0.6282815139):3.685453055,t471:4.271699294):0.1691309175):3.845848727):3.917558103,((((t472:1.388104104,t473:1.333155852):2.900267122,(t474:2.679459275,t475:2.55703197):1.522721746):1.476481567,(t476:2.030255509,t477:1.795251512):3.334032751):4.149007332,(t478:6.386081162,(t479:0.6577991821,t480:0.6350990833):5.683945214):2.880583072):2.277342719):3.819140701,((t481:2.507823372,t482:2.485363459):8.190371777,(t484:9.320600388,t485:9.250115833):1.184828102):4.552317249):0.165234969,((t483:0.02626722576,((((t369:0.1500105061,(t343:4.083172917e-05,(((t317:0.04762566898,((t270:0.06935605812,(((t185:0.02429357568,(t182:0.0553569996,(t148:0.2149000571,(t142:0.03620885997,(((t1:5.459117789,t2:5.449032204):6.570746221,(t3:5.283181999,t4:5.276603161):6.488636904):0.1967077639,(t5:2.972457584,t6:2.870690534):8.969394291):1.908129293):1.261587471):3.808959702):0.387272574):0.05747166827,(((t7:7.863040214,t8:7.724858573):2.787882362,(t9:7.893189842,(t10:4.648985362,t11:4.588867952):3.213069269):2.355790727):2.045100485,(t12:4.001936771,t13:3.932209002):8.179001094):6.375175869):4.7086838,((((((((t14:4.840950726,t15:4.793270199):2.185619917,((t16:1.621738107,t17:1.583381015):3.507841284,((t18:1.10891357,t19:1.00664093):2.312111288,(t20:1.866103376,t21:1.783796224):1.371602514):1.664513616):1.722958995):3.3756123,(t22:6.836998403,(t23:4.114370309,t24:4.060750213):2.576906713):3.00329989):2.420520468,(((t25:4.35542247,(((t26:1.062968875,t27:0.9653862717):0.1817086129,t28:1.066510189):2.738599816,t29:3.66476773):0.3082146675):6.23111732,(t30:5.609384026,(t31:2.794685488,(t32:0.5136738984,t33:0.4483598798):2.186144725):2.606079865):4.535972925):0.1636032911,((t34:6.881110766,(((t35:2.532245721,(t36:1.74201528,t37:1.654114277):0.7299512131):2.286791379,t38:4.644616596):0.6330170156,(t39:4.664402948,(((t40:2.213250735,t41:2.03794545):1.485914104,t42:3.349313969):0.0597667918,(t43:0.5444736355,t44:0.2658241675):2.817571897):0.8802761293):0.4834175254):1.269458501):0.6271899668,(t45:4.673570489,t46:4.508927157):1.603980481):2.250674263):1.30843629):0.1389265168,(((t47:1.620113794,t48:1.494221161):0.4982004661,t49:1.658443306):1.656838023,t50:3.218274824):6.006227615):6.942973219,((t51:0.324402606,t52:0.3215005294):6.911632471,t53:7.024551281):8.849908457):1.24254621,(((t54:0.7238141614,t55:0.6882770717):4.770249735,(((t56:1.759308717,t57:1.535303323):1.168310038,t58:2.693990021):0.7446135623,t59:3.167817789):1.678199879):7.218296735,(t60:8.411329694,(((t61:0.8254086013,t62:0.7091395567):1.029512159,t63:1.596931193):5.000474376,(t64:4.040758893,t65:3.843121076):2.424852425):1.533289097):3.594988702):3.938234404):0.7479755529,t66:16.06471787):1.265062432):3.624570254):2.341431056,(t67:1.811903434,(t68:0.824355511,t69:0.54629739):0.9726996176):21.45808682):1.439633057):0.3703449897,(t70:12.79354565,((t71:4.967381548,t72:4.851955797):6.923306437,((((t73:1.641620747,t74:1.597296512):1.795489282,((t75:1.028113832,t76:0.9649819849):0.2447750315,t77:1.199702572):1.766837603):4.687852363,t78:7.640657148):1.722499845,(t79:6.066277742,(t80:5.383491452,t81:5.367048236):0.5893869179):2.935357879):1.831245968):0.8725578739):11.97018992):0.05129900221,(((((((t82:2.397567447,t83:2.128369834):1.260661383,(t84:1.874843263,(t85:0.422826451,t86:0.3247677779):1.39878779):1.43692895):0.8767401957,t87:4.001079625):1.850855633,t88:5.570290779):1.737874915,(t89:1.396779451,t90:1.361776859):5.77025139):3.104546057,((t91:2.245892761,((t92:0.935893502,t93:0.8796030864):0.3917695979,t94:1.200618858):0.8914718731):0.4530456798,t95:2.219078476):7.476618587):3.243983166,(((t96:3.238378844,((t97:0.5557078454,t98:0.4792915518):0.301531283,t99:0.4661413653):2.368666566):6.004851993,((((t100:3.665387135,(t101:1.461167381,(t102:0.5028034793,t103:0.4383994038):0.8044692818):2.12916896):1.891256566,(((t104:2.030045933,t105:1.977751716):0.1297628409,t106:2.03009076):2.711225791,(t107:0.26195152,t108:0.2462415088):4.411473403):0.3800434924):1.798264678,t109:6.650512974):1.336320295,(((t110:0.3972060067,t111:0.1572792927):3.808835392,t112:3.918040258):2.854009509,(((t113:0.3110625626,t114:0.2875672754):0.5817541257,t115:0.6919967061):1.448156649,(t116:0.4201407557,t117:0.3891100049):1.62824066):4.203679706):0.762614791):0.1290352513):2.452802532,(((t118:3.347374645,(t119:1.172696961,t120:1.134525886):2.035537599):0.09150117881,(t121:1.031557246,(t122:0.5892778428,t123:0.5843426471):0.4190946476):2.218763074):5.381842151,((t124:5.18046511,t125:5.098644112):0.1909559368,t126:5.278472893):3.22194799):0.6795809491):1.154681718):9.046503174):2.416001815):3.123372111):1.489047691,(((t127:5.607296339,((t128:2.185997631,(t129:0.4500884791,t130:0.377191159):1.705946438):0.5253171661,(t131:1.522509485,t132:1.446400419):1.070763827):2.84922002):1.050682766,((((t133:1.32229898,t134:1.26347932):1.580631998,t135:2.833482483):0.6486937399,(t136:2.729155552,(t137:0.9961574538,t138:0.7674415139):1.723881307):0.7204897284):1.246804202,((t139:1.775787547,t140:1.581323571):2.522251477,(t141:1.663605702,t143:1.421394247):2.384139929):0.04350558625):1.537549204):13.02096359,(((((t144:2.233753668,(t145:1.738454663,((t146:1.057703574,t147:0.5328225847):0.02480304117,t149:0.2224417288):0.5841213315):0.2840614013):6.569152274,(t150:7.331737769,(t151:1.376890236,t152:1.329187663):5.658436928):0.07429809856):2.27234908,((t153:3.509301214,t154:3.382178399):0.07767733558,(t155:2.835209999,t156:2.797752502):0.5302774607):5.718320103):3.441407768,(((t157:1.718554765,t158:1.565469463):5.62088433,t159:7.040783707):1.015557237,((t160:1.942064525,t161:1.495539909):2.128459543,(t162:1.896815811,(t163:0.727391718,t164:0.7272530473):0.8935231156):1.720660517):3.968821743):4.058068552):0.7969469658,(((t165:1.276495847,t166:1.268992216):6.314375993,((t167:3.338341057,t168:3.133249364):2.236978024,t169:5.363306735):1.970622944):2.824557059,((((t170:0.7401222994,t171:0.2634501176):1.124934623,t172:1.241447907):4.805265594,t173:6.01832379):0.580085712,t174:6.553032047):2.902974742):1.745252138):3.050544022):6.522219922):4.215275969,(((((t175:0.3716756641,t176:0.1804795968):0.7496619601,t177:0.9264550967):0.6209632616,t178:1.465799881):1.018628456,(t179:1.827247125,t180:1.637064979):0.6176859204):6.353841742,(t181:0.2624253342,t183:0.00255562743):8.206051792):15.82868682):1.003857268,((((((t184:4.865654727,t186:4.762361857):0.1083173167,((t187:0.8998955712,(t188:0.5383777092,t189:0.3683744883):0.3572896067):1.407020275,(t190:0.1880608268,t191:0.1465015436):1.906834523):2.499719982):9.344019964,((((t192:0.5501963092,(t193:0.1857063305,t194:0.1787297819):0.3550327886):0.4121050853,t195:0.904080661):3.737689028,(((t196:1.029441051,((t197:0.4822134677,t198:0.4673948724):0.2567306451,t199:0.6735012135):0.196871936):1.146754202,t200:1.952094338):0.7700412889,((t201:1.942209654,t202:1.914005127):0.6360714823,(t203:0.9073790556,t204:0.8606314163):1.555744921):0.02999264017):1.585044659):3.58206806,((t205:1.382224317,t206:1.357295437):5.53333722,(((t207:0.806907996,t208:0.7717250394):2.366349984,t209:2.991027008):1.564226534,(t210:0.4896548668,t211:0.3309126495):3.713161995):1.984809852):0.674286337):5.537190983):0.0732735523,t212:12.27872711):1.963156699,((((((((t213:1.961995348,(t214:0.6321250761,(t215:0.3200478953,t216:0.2583025245):0.1431848136):1.285053617):0.2137905707,(t217:0.6363907368,t218:0.6003412265):1.200911778):0.9180796341,(t219:2.336652806,(t220:1.420655239,t221:1.312351114):0.9098389187):0.1842246505):5.740863074,((t222:2.173625267,(t223:1.75131888,(t224:1.024149487,t225:1.01300493):0.722100143):0.3557578486):2.411197477,t226:3.797394731):3.553770269):0.695194016,t227:7.98996353):0.3834213427,(((t228:2.314606461,t229:2.27007319):0.03354914998,t230:2.191900468):4.657205409,(((t231:1.82623166,((t232:0.5957355147,t233:0.5898305007):0.5482584901,t234:1.050026884):0.4876038632):0.732997907,((t235:0.4292246786,t236:0.3932174345):0.5759594576,t237:0.9212450943):1.184611624):1.700244888,(t238:1.164750504,t239:1.069501764):2.513842221):2.522777421):1.089966461):0.4945968003,t240:7.675521854):1.386622014,(((t241:3.270411374,t242:3.264753353):2.295899685,t243:5.471900008):0.0317039447,(t244:0.1854296723,t245:0.0620638035):5.203830945):3.230036525):2.42736159):1.613824456,((((((t246:1.564615188,(t247:0.727224801,t248:0.7223836279):0.7248648369):4.769244803,t249:6.089813472):0.05948926952,(t250:5.043536981,((t251:2.094868156,t252:2.079868227):0.07483117326,t253:2.151315773):2.635018515):1.072272781):1.673037514,t254:7.176422378):1.611164862,((t255:5.859037964,t256:5.840430571):0.9984813133,(((t257:0.8210939449,t258:0.3298702925):2.172175743,t259:2.402929584):0.2543609333,(t260:2.137586129,t261:1.779536391):0.4904878392):3.56462468):1.927166332):2.278049003,(((t262:7.898037307,((t263:3.912182675,t264:3.864971588):0.4934915812,t265:4.355696276):3.292932358):0.5894374842,(((((t266:3.442960377,t267:3.391953974):0.1560961221,(t268:2.222038265,((t269:0.6773359106,t271:0.3659079649):0.9569515027,t272:1.275952771):0.540163928):1.310614618):0.459954502,t273:3.375297247):0.8952794061,((t274:1.187823862,t275:0.9181503168):2.215280927,t276:2.970723275):0.6191148529):1.8592413,((((t277:0.2624970021,t278:0.2219942299):1.386769686,t279:1.571273124):1.577178783,(t280:2.377336539,(t281:1.370122088,t282:1.329973331):0.7792214932):0.7343433774):0.749059499,t283:3.538989817):1.47129358):1.392194432):0.9132278959,t284:7.288122385):0.4914727107):0.2785658311):6.91204816):3.323117469):0.2133473259,((t285:9.275623471,((t286:3.961534109,t287:3.853284205):5.026364854,((t288:0.2035374447,t289:0.1484828117):0.8996448493,(t290:0.5567987264,t291:0.4585818845):0.4898145967):7.754329748):0.2525681034):0.1591542653,((t292:4.238531547,t293:4.031990754):0.139255631,((t294:0.3310514763,t295:0.2327273628):3.137775525,t296:3.257014878):0.6046610464):4.711196788):9.025849079):15.15225828):0.8458463074,(((((t297:0.500624191,t298:0.4911015211):3.352439356,((t299:1.497883184,t300:1.463812972):0.2893247676,t301:1.72994803):1.943796428):4.863895432,((t302:6.609034864,t303:6.530307072):0.2938949619,(t304:5.375254404,t305:5.338477818):1.369591339):1.392642039):6.801648035,(((t306:7.170173433,(t307:5.76409661,((t308:1.714112358,t309:1.508330514):0.9083399371,t310:2.413757596):2.988322903):1.404383854):3.125439619,(t311:0.8414127327,(t312:0.3114322555,t313:0.2708094084):0.469424581):9.084448378):0.6250450296,t314:10.4334935):3.920353501):6.576752375,((((t315:0.8930069078,t316:0.8238237146):1.173831971,t318:1.765430999):15.67127068,((((t319:4.983884539,t320:4.900639668):0.2620017386,t321:5.034900097):2.801741521,((t322:5.653115263,(t323:3.183817864,(t324:0.8353595673,(t325:0.2309934398,t326:0.1994185423):0.3632159314):2.325862277):2.190678886):0.5597614182,((t327:1.673013391,t328:1.617847215):1.786410546,(t329:2.641489274,t330:2.600777825):0.708340898):2.169811488):1.564502943):9.128319397,((((((t331:0.984795771,t332:0.7549879955):3.716063529,(t333:1.747849254,t334:1.620541237):2.689744924):0.7708274001,(t335:0.3583264763,t336:0.3458008303):4.461954953):0.706090142,(t337:2.262710085,t338:2.22452151):3.133731352):2.378589013,(t339:4.063460747,((((t340:0.2865229258,t341:0.273279698):0.9020557861,t342:1.059695098):1.61468582,(t344:1.654986654,t345:1.610598934):0.8540544902):0.3825993396,((t346:0.6129354504,t347:0.1181101412):1.340080465,t348:1.217682992):0.7766874825):0.7677677835):3.547564989):3.566390502,(((t349:4.558104717,t350:4.523459978):1.581343152,(t351:3.756824649,t352:3.630112546):2.316367536):0.7235322376,t353:6.461895656):2.953209667):3.723732902):0.1997175567):2.359388844,((t354:4.53889346,t355:4.404292312):5.268513768,(((t356:6.631093256,(t357:5.950169135,(t358:3.840637649,t359:3.725487676):1.961494022):0.3810872401):0.2468040054,(t360:1.658215941,t361:1.632426967):4.51047549):0.5754024815,((t362:1.428851093,(t363:0.936857616,t364:0.798747594):0.491617185):0.2479535341,(t365:0.310535212,t366:0.3033698661):1.195541573):4.844461132):2.141591883):5.829013834):0.8208582878):11.4583128):3.073657609):3.356468394):97.08587708);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T2.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
