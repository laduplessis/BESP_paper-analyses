<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t480:1.668926567,((t481:0.6643616276,t482:0.6380416186):0.8094709589,t483:1.390707421):0.1618962011):1.869865839,t484:3.342091713):8.955985828,(t485:11.14795207,((t486:2.104266875,t487:1.661982013):4.300351666,t488:5.772379708):4.719382087):0.9979596295):14.04266372,(((((t489:1.563322096,t490:1.494576414):3.274625333,(t491:3.285110067,(t492:2.60438862,((t493:0.5486061905,t494:0.5009815582):0.6329642451,t495:1.005125657):1.318815317):0.654079367):1.202895822):0.8385335091,((t496:0.4352247498,t497:0.3673607322):3.92100317,t498:4.248892667):0.6006516281):0.6432999801,((((t461:0.06298034809,(t420:0.1039122424,((t393:0.1055049491,(t340:0.2277131906,((t328:0.1262468039,((((t266:0.2332334485,(t254:0.08130431285,((t212:0.09634805152,((t191:0.1783714133,(t165:0.04446396388,((t32:0.01755475876,t1:2.192031398):7.319491652,(t2:1.408088902,t3:1.368188166):8.100594408):5.696818356):2.431923029):1.217298974,((((((t4:0.8657720976,t5:0.8536858482):4.752072707,t6:5.553400383):1.322142683,t7:6.766193486):0.5456553068,((t8:5.199047486,(t9:1.798242778,t10:1.63950411):3.243157984):0.4464141408,(t11:4.840492335,t12:4.680080118):0.4661956147):1.64017646):4.113694584,(t13:3.493093064,(t14:2.926669457,t15:2.789051032):0.5505580291):7.403509456):4.817748035,(((((t16:3.362548647,t17:3.255868616):0.4621869705,t18:3.677759728):6.20657203,(((t19:1.99851512,t20:1.932115443):3.018368073,(t21:3.191340751,t22:3.06330835):1.753627912):0.3050865578,t23:5.049270679):4.388198882):1.662800354,((((t24:1.614842354,t25:1.568373475):2.81800365,((t26:1.245192051,t27:1.148118338):1.575636443,(t28:1.235593123,t29:1.074826349):1.472758349):1.553017782):0.6642482999,t30:4.693101674):4.375279485,(t31:1.696474119,t33:1.48086912):7.340307597):1.619759452):1.316258114,(((((t34:0.7917222628,t35:0.6821211242):6.640980494,t36:7.280944142):0.2571944916,((t37:0.7477292863,t38:0.6829332642):0.568999186,t39:1.238424287):6.129217946):0.4629865789,(((t40:0.2523296157,t41:0.2114125508):1.747611461,t42:1.755529499):0.04804070775,t43:1.778277809):5.682480962):1.811066,(((t44:0.8944024552,t45:0.8919811623):4.642939712,(t46:1.7088674,t47:1.704002634):3.796885942):3.054857697,t48:8.527894867):0.6301962518):1.770374838):2.514965144):2.345184172):1.00468352):3.652742472,((((((t49:4.823607533,(t50:0.8491968792,t51:0.8378439816):3.942814801):9.079305487,((t52:1.000624357,(t53:0.6656921673,t54:0.3704564017):0.2194990026):11.88467922,((((t55:1.066734544,t56:1.03452474):4.170430257,(t57:1.063531866,(t58:0.3255504545,t59:0.2280466448):0.6654303171):4.056479329):4.486509179,((t60:3.689070216,t61:3.661420933):4.616097446,(t62:0.09401315718,t63:0.07156566658):8.016404136):1.118824013):1.895975729,((((t64:3.68361684,((t65:1.609015538,t66:1.21066185):0.7881494747,(t67:0.4790090919,t68:0.3943685629):1.319338461):1.060406655):0.438102383,t69:3.121198974):6.025497238,t70:9.137029674):0.1199234894,(t71:5.766999508,(((t72:0.5007819605,t73:0.372774041):4.583270263,(t74:2.506414819,t75:2.444287823):2.446610344):0.1882254957,(((((t76:1.736465689,(t77:0.2110438032,t78:0.2075397183):1.360867478):0.7525370695,((t79:1.89043818,t80:1.873045663):0.1357176238,t81:1.459586091):0.2833148837):1.420536779,(t82:0.2642269173,t83:0.2148990828):2.889224692):0.1947419262,t84:3.281650891):0.6229884656,(t85:1.852706454,t86:1.738580078):1.959861758):0.3279417656):0.4428947747):3.409258291):0.7360798284):0.6932451407):0.8866118118):0.9924202486,((t87:6.100504638,(((t88:0.9973273495,t89:0.984667777):1.471107419,t90:1.626639853):3.36108692,(t91:2.656325109,t92:2.608824513):2.321128462):0.2685627462):2.545981879,((((t93:1.17310057,t94:0.8984693015):0.1691395763,t95:1.040596918):3.538207915,t96:4.365689246):1.140834748,t97:5.369400816):1.658290031):2.51679504):3.31053657,((((t98:2.359118993,t99:2.0225046):2.591856274,(t100:3.573731761,t101:3.378707246):0.9555355634):0.4010911916,(t102:3.212735988,(t103:2.98514791,t104:2.966276114):0.1075904454):1.413355475):0.4996115167,t105:4.871635104):6.915709027):0.07156172626,(((t106:3.041415132,(t107:2.398269703,(t108:1.841187921,t109:1.591867783):0.5103416821):0.6232864745):0.9629408309,t110:3.503440289):2.774337854,t111:6.25149723):5.080146033):1.258691397,t112:12.56274122):0.8435162612):0.01666184293):1.483459612):1.386262534,(t113:13.89882701,(t114:0.3383694536,t115:0.2389682246):13.51333455):2.297252333):0.7165010192,(t116:15.62100675,(((t117:1.646949828,t118:1.614788388):0.164824571,t119:1.777591304):8.066519351,((((t120:0.3215245906,t121:0.08960606844):0.7410852432,t122:0.7892395027):5.501305731,(t123:6.119110749,(((t124:1.272890401,t125:1.188742379):0.3309077401,(t126:0.2550456442,t127:0.2321939638):1.205358591):3.558711819,((t128:2.054689676,t129:2.035836472):1.181933015,(((t130:0.7648399369,t131:0.7433828152):0.02972541775,t132:0.6731502565):0.247941927,(t133:0.8387066745,t134:0.7935468704):0.07377559235):1.90629857):1.746696927):0.9446784894):0.009118029343):0.4707465252,(t135:0.869047878,t136:0.7518894423):5.01898109):2.521724509):5.529858565):0.9174513383):2.956822161,(((((t137:8.252339523,((t138:0.9462612953,t139:0.9436041034):0.3618659557,t140:1.129709794):6.654298032):1.05509455,(t141:5.687066642,t142:5.501392222):3.124581947):2.584756303,((t143:4.933431922,(t144:1.084955163,t145:1.066151481):3.757992342):0.2698098082,(t146:4.738245441,(t147:2.801589866,((t148:0.2666021734,t149:0.1811157907):1.028155028,t150:1.187617469):1.314677842):1.841956042):0.1994008701):5.701524589):3.518672119,(((t151:1.920756037,t152:1.895954332):1.816125569,(t153:1.936687073,t154:1.920498418):1.735992141):6.391624252,(t155:4.407199976,t156:4.280506711):5.633652948):3.634699695):1.5911731,((t157:0.2991893287,t158:0.2106378623):9.697044334,((((t159:0.4715941611,t160:0.3626938492):1.482536274,t161:1.815679191):2.209157641,t162:4.00788978):1.313078476,((t163:1.941969512,t164:1.831618211):2.095049797,(t166:2.873519998,(t167:1.803061353,t168:1.747135143):1.038599777):0.9506177079):1.078550233):4.218059302):5.053194569):0.6482775041):1.273319436):0.5842451539,((t169:0.7411168208,t170:0.6989073698):8.458679434,(t171:2.621937854,t172:2.559238394):6.337685687):7.345452186):0.6341577898):5.17345848):0.2954971776,(((((t173:5.34130175,t174:5.323803833):11.05385894,((((t175:1.680488151,(t176:1.49785655,t177:1.475968726):0.1555449646):3.895597562,(t178:1.690011987,(t179:0.0535106482,t180:0.003359201836):1.555602511):3.761878372):1.419637354,((t181:1.735925962,(t182:0.7846249983,(t183:0.1221357156,t184:0.07134770097):0.5212009607):0.9380144994):2.858012231,t185:3.998914597):2.026754128):8.886467333,((t186:2.928515678,(t187:2.425523544,t188:2.34032654):0.2095901504):0.6154788188,((t189:0.7056247644,(t190:0.4810086878,t192:0.1708722658):0.1558839122):1.632954734,(t193:1.229503057,t194:1.219085476):0.659638585):0.7561569067):11.20972116):0.4780558383):2.360612495,(((t195:5.694250827,t196:5.582871263):2.19661122,(((((t197:2.127056041,t198:1.979020075):1.089296239,(((t199:0.555047297,t200:0.4459673456):0.8507316216,t201:1.269546041):1.517622287,(t202:2.740287251,(t203:1.644908859,t204:1.525361447):0.6843118777):0.02508825247):0.1060819094):2.632065003,((t205:2.058350146,(t206:1.220534295,t207:1.1936616):0.6637742711):1.703072893,(t208:1.953825357,t209:1.851897692):1.505615055):1.210655034):0.06432109401,((t210:3.281425448,(t211:2.855223487,t213:2.530323964):0.2691360763):0.6741019333,t214:3.349577279):0.5991867989):1.192175239,(t215:1.66088543,t216:1.61819275):3.397023586):0.6147525271):2.833919664,(t217:2.535233157,t218:2.450642077):5.919840434):5.731363707):0.334442324,((t219:7.375560544,(((((t220:1.363416172,t221:1.350729093):0.4492395613,t222:1.770456247):1.776518184,(t223:0.6158025106,t224:0.6000141473):2.779209085):2.008865028,((t225:3.173362749,t226:3.114113049):0.3830698762,t227:3.363207133):1.628403587):0.6076325024,t228:5.512018101):0.9383647401):2.969840542,(t229:6.90852769,((((t230:2.140982466,(t231:2.055427426,t232:1.95541852):0.03068076569):1.47507517,((t233:1.567578447,(t234:0.5077355024,(t235:0.2629606706,t236:0.1186916978):0.1239563845):1.046714174):0.6743780547,t237:1.912677859):1.083598166):3.036064574,(t238:3.261867363,(t239:2.100218646,t240:2.086264308):1.071503152):2.762257803):0.1168228789,t241:5.948001493):0.08591825421):2.445165489):3.99560154):0.1027638792,(((((t242:3.137023245,t243:3.029914862):1.005753603,(t244:0.5557639702,t245:0.3819117244):3.437553366):1.107442177,t246:4.820114944):5.074525778,((t247:3.571507751,t248:3.541589284):5.223981601,((t249:0.1739946672,t250:0.06211935715):5.576621984,((((t251:0.9239072813,(t252:0.5495855146,t253:0.4029904114):0.3467224836):0.8702825201,(((t255:0.4323129651,t256:0.3500642391):0.6013719779,t257:0.8278289843):0.2313542069,t258:1.001001567):0.191927883):0.336853507,t259:1.313444103):1.660684111,t260:2.70216246):1.772170098):2.83724032):1.054771698):0.5541510629,(t261:5.988998883,((((t262:0.5319260706,t263:0.4499888595):0.7480387749,(t264:0.7593005758,t265:0.7434721144):0.2792776331):2.714028475,(t267:2.859079636,t268:2.6075578):0.5788302949):1.055851832,t269:4.019767118):0.873650774):2.790226284):1.684358458):3.14034189):1.732699214):3.781529051):2.07892643,((t270:7.419383317,(t271:1.070621124,(t272:0.2597782919,t273:0.2421568492):0.6938331668):6.334319981):3.901609947,(t274:1.143794648,t275:1.128544572):9.960898156):8.744287616):0.3130615044,((((t276:3.170587638,((t277:1.401042541,((t278:0.335953876,t279:0.2698304076):0.03702832909,t280:0.2732076879):0.9942930569):0.4399716204,t281:1.691835931):1.049750743):4.424064049,(t282:1.949486269,t283:1.642708652):5.163480664):0.6263357657,(((t284:1.105100522,t285:0.9797624203):3.04726389,t286:3.961355668):0.1205570676,(t287:2.325832607,t288:2.315258603):1.618525898):3.073163095):2.910223796,(t289:0.1147351821,t290:0.1079678658):9.765092826):8.913421235):5.523382911,((((((((((t291:0.3771008464,t292:0.2860500027):4.23295709,(((t293:0.6248667406,t294:0.4905976046):0.2956798505,t295:0.7449248813):0.1530587202,t296:0.856986351):3.247602388):1.077045488,t297:4.845720901):6.217254519,(t298:6.118042622,t299:6.101453687):4.936224686):0.5368133162,(((t300:0.0566961222,t301:0.02156224629):7.29710899,((t302:2.886756759,(t303:1.487965273,t304:1.32970827):1.387243589):2.101189213,(t305:3.129547065,(t306:0.7787034016,t307:0.6564583586):2.236750265):1.682131854):2.070435115):1.9069697,t308:8.3340733):1.987645168):0.85600108,(((t309:0.7110602531,t310:0.5351346141):6.294222575,(t311:6.307210585,(t312:5.652541851,(t313:4.369802544,t314:4.05528816):1.126665661):0.514475684):0.5115945601):0.6362986998,(((t315:0.8541876366,(t316:0.2119360056,t317:0.1019294055):0.3992513141):0.1745787732,t318:0.6304471222):3.17623482,((t319:1.414128194,t320:1.339787212):1.727689649,t321:3.015071707):0.6165295619):2.420748574):3.505615862):5.63411679,t322:15.18725187):2.84996101,((((((((t323:0.6286323801,t324:0.6190081401):4.530176661,((t325:2.655410615,(t326:2.105025689,((t327:0.2702861283,t329:0.1167882774):0.07287720349,(t330:0.1528406938,t331:0.07267709248):0.01930109785):1.743093088):0.4368729045):1.286421014,(t332:1.56382545,t333:1.425741477):1.947759205):1.150930271):1.469163649,(t334:1.953711109,t335:1.717981679):3.994762885):2.12586457,(t336:4.932318065,t337:4.817886946):2.864133283):1.333971157,(t338:0.7619293536,t339:0.717505962):8.195270304):3.273388204,((t341:8.509130421,((t342:1.090779416,t343:0.979123707):2.364182515,t344:3.337236915):4.919649372):1.182944601,(((((t345:1.473463102,t346:1.273213744):2.748584652,(((t347:1.33040313,t348:1.151363285):0.2518296816,t349:1.293477263):0.5337839981,t350:1.677334828):1.779590621):0.2532301203,t351:3.215295249):1.0838107,t352:3.996686027):3.81372107,((((t353:0.2713572481,t354:0.2573441314):0.103006268,t355:0.3332495323):2.717818287,((t356:0.999546292,t357:0.9209617905):1.04016146,t358:1.872798747):1.003613471):0.5738673997,t359:3.36754803):4.108361575):0.04807993316):1.704820439):1.157141435,(((t360:2.359325162,((t361:0.2120918069,t362:0.1506160242):0.7962651805,t363:0.9183300728):1.277421651):0.8955602836,t364:2.919104998):0.9744031286,((t365:0.9203816984,t366:0.8401750103):0.9110269368,t367:1.731979288):2.058918815):6.151069983):1.71170843,(((t368:9.133024735,(((t369:0.05854118413,t370:0.03800859612):4.027480833,((t371:0.07526665262,t372:0.05023361684):0.7967876815,t373:0.8221388285):3.149399431):3.685364806,(((t374:1.918188565,t375:1.894997542):1.074956927,t376:2.861785493):4.392876507,t377:7.225965909):0.2311924428):1.329949919):0.8508388136,t378:9.520621081):1.448727972,(((t379:1.771332913,(t380:0.6920166299,t381:0.6537244431):0.9377566353):0.8486448119,t382:2.366987354):7.583272782,((t383:1.601868959,(t384:1.309399917,(t385:0.3403164717,t386:0.2931068829):0.9620429359):0.1089949436):7.695421327,(t387:8.998911071,(((t388:3.985675286,t389:3.611746976):0.4873701287,t390:3.871805842):1.61688768,t391:5.444874959):2.83461499):0.0535503556):0.5639983077):0.5703827731):0.2163012598):1.73418871):0.3688457863,t392:11.71572044):1.621697194,(((t394:0.2337406948,t395:0.218087526):4.40827844,t396:4.414497947):1.764957772,(((t397:1.309959721,t398:1.262998605):1.668058727,((t399:0.5750537114,t400:0.53693404):0.1936356201,t401:0.6979011114):2.151469488):1.681052894,(t402:3.105789912,(t403:0.8702273303,t404:0.8511231438):2.221615642):1.329991032):1.442941055):6.773975985):0.498171748):1.825285317):14.28757259,(t405:1.217683541,(t406:1.119873767,t407:0.919851657):0.05991852463):27.90463218):4.91689):67.32688283,((t408:0.3612731267,t409:0.2730655587):2.74620686,((t410:0.457313885,t411:0.3458777425):0.8391456105,t412:1.011907236):1.722421746):98.00661238):5.856339559,(((t413:3.692492507,((t414:0.9267488002,t415:0.8361397489):1.036462793,(t416:0.428867135,t417:0.4193303844):1.434196707):1.697574253):2.888361215,(t418:2.186291202,(t419:0.6012065694,t421:0.3630925128):1.485887863):4.075817229):24.74228075,((((((t422:0.5847723559,t423:0.2073267806):4.041374805,t424:4.219965169):1.45083499,t425:5.596972136):2.984669055,t426:8.488687554):2.636194292,((t427:0.3276856374,t428:0.2930832519):1.72826521,(t429:1.60088064,t430:1.508136737):0.4101219457):9.034527307):1.683753506,((((((((t431:0.2539453956,t432:0.2057508969):0.9973210745,t433:1.151239852):0.6238829108,t434:1.770266368):1.774301726,t435:3.543813793):0.7860288414,t436:4.308984956):2.730066472,(((t437:0.4686590743,t438:0.4320202975):2.632883348,(t439:0.7463008005,t440:0.6999774336):2.277467496):1.104140522,((t441:1.097458616,t442:0.9482415713):1.436750556,t443:2.367623087):1.456751688):2.819954539):0.1691411067,(t444:2.770077275,(t445:2.091827992,t446:1.997041684):0.5484639014):3.914714634):4.226179412,t447:10.63782559):0.9380115369):17.23963014):75.20486141):223.4470153,((((((t448:5.19456094,((t449:0.4916185109,t450:0.2812284619):1.569416535,t451:1.761076551):3.040171398):1.60215278,((t452:0.4306487573,t453:0.3711332681):0.5832245193,t454:0.8776552852):4.912054308):2.095046862,t455:7.753644963):1.760283736,((t456:1.369148358,(t457:1.187385142,(t458:0.9975354275,t459:0.9609898696):0.1641308877):0.1603287291):1.960125205,(t460:2.928707355,t462:2.776394137):0.08681126232):6.057569872):4.550510001,(((t463:0.5617333011,t464:0.4793626296):2.242952698,t465:2.591052229):7.357540264,t466:9.920760327):3.29879806):17.55231812,(((t467:3.428004439,t468:3.254375453):0.6588035608,t469:3.631524261):11.13400119,((((t470:0.8333080737,t471:0.7426343737):2.080663865,t472:2.441482518):6.567981048,((t473:0.759213018,t474:0.6277004483):3.900522171,t475:4.453193534):4.32224407):3.309050219,((t476:7.753538086,t477:7.429874222):2.241690964,(t478:0.3471700092,t479:0.2396613479):9.182836542):2.073748841):1.830284334):15.51778943):294.4890906);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T85.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
