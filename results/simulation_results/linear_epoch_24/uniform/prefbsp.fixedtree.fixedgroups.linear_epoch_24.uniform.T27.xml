<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t449:2.167591894,t450:2.050171241):0.5446494448,(t451:0.07657598121,t452:0.05749304196):2.440470928):0.7577241387,(t453:1.422629757,t454:1.387145297):1.729621647):0.2186545248,t455:3.224809408):4.067713695,((t456:1.42262117,(t457:0.05243667791,t458:0.02724669379):1.117194544):0.2876069216,(t459:1.291710018,t460:1.160473821):0.1398326396):5.524881471):46.02496531,((t461:30.93887153,((t462:5.201274434,((((t463:1.081528211,(t464:0.4093370114,t465:0.2902889091):0.4685775508):0.03425961638,t466:0.6363360084):0.7678763057,t467:1.367194741):0.7531187807,(t468:1.695086316,t469:1.591621129):0.3740797725):2.505317201):25.0858454,((((((t470:1.658722985,((t471:0.08605195596,t472:0.06786450711):0.1356859503,t473:0.144957209):1.423247384):0.1876958649,t474:1.670900224):0.3113263951,t475:1.959719691):7.191109621,t477:8.715570093):1.656140929,t478:10.29105288):3.841929263,(t479:0.8132962383,t480:0.7520327884):13.29345671):14.55053521):0.6461771396):7.136338182,((t476:0.04593716615,(t433:0.1393768142,(((t303:0.001553519498,(t288:0.1773813248,(t248:0.1694909922,((t215:0.08119478678,((t208:0.102700132,((t131:0.01082640213,(((t68:0.2223200613,t1:6.042147236):2.675790414,(((t2:5.059494555,(t3:4.043619753,(t4:2.895452215,t5:2.762578826):1.095394089):0.9648211104):3.14379367,((t6:0.02992179817,t7:0.02849257006):4.493167926,((t8:0.1997131444,t9:0.1340070771):1.679843468,t10:1.78634423):2.628074472):3.276245748):0.04140845004,((t11:1.574207841,t12:1.385017094):4.534857481,(t13:3.947910569,t14:3.88153811):1.96349687):1.587004114):0.320437972):1.721935293,(t15:1.916034922,t16:1.887023385):7.489797113):3.492548506):3.517335876,((t17:4.055608436,((t18:0.47667194,t19:0.408835558):2.634850143,t20:2.997076297):0.9323888514):11.47758639,((((((t21:4.589412246,((t22:0.7460793081,t23:0.4428590733):2.27740336,t24:2.475069976):1.546883234):1.186932241,(t25:3.275181974,t26:3.270832445):1.794130853):2.736983607,t27:7.696491805):1.04321546,(t28:3.345997969,(t29:1.674257352,(t30:1.548690664,t31:1.460098154):0.03628382709):1.632229614):5.295242306):3.17278136,(t32:9.72058264,(t33:3.471587723,t34:3.468488287):6.205532648):1.874840065):2.390363469,((((((((t35:0.6321979403,t36:0.5947379968):3.620686909,t37:4.159586055):2.626924912,t38:6.738507358):0.4944504076,((t39:3.461866224,t40:3.360518333):0.2075998072,t41:3.455951857):3.557617844):0.02901616175,(((t42:1.28124691,(t43:0.9657851667,(t44:0.8966066792,t45:0.7594061597):0.06443031776):0.2133141919):1.188042583,t46:2.153302583):2.603231846,t47:4.660125284):1.589425715):4.39986826,((t48:0.8355325105,t49:0.5325101119):2.664014739,(t50:1.618011215,t51:1.546905235):1.564637301):6.991148353):0.2289780868,t52:10.2682486):0.2217129935,(t53:2.691332345,(t54:2.324659007,t55:2.194628993):0.2491209518):7.797212025):1.40479874):0.09925928637):0.8442648217):3.974218581):0.3694929234,(((t56:8.54846329,((((t57:0.6535768294,t58:0.5931486766):2.656233074,t59:3.086770128):1.721890315,(t60:2.857234243,t61:2.680396795):1.904526372):0.2159786289,t62:4.761679858):3.257800061):1.544411844,(((t63:1.417726559,t64:1.416907809):0.3776419602,((t65:0.9268985987,t66:0.8726584134):0.1794406759,t67:1.010507105):0.6181866435):3.403907656,(((t69:1.547931684,t70:1.529496473):2.037806818,((t71:0.5427772915,t72:0.2257187902):1.175342718,t73:1.288281529):1.762841981):0.6888015136,((t74:0.219478899,t75:0.05155327807):3.350364665,t76:3.334419947):0.009306189276):0.1532183936):4.280554562):0.2610020337,(t77:0.237342036,t78:0.2242924172):7.760380436):6.556856202):0.266189575):1.758395885,(t79:6.29898705,((((t80:0.443074763,t81:0.3049202205):0.8939906121,t82:1.186711425):0.4075318471,t83:1.421626284):0.04535299631,t84:1.424682616):4.387739258):10.11938991):2.261067458):3.172181455):1.892308217):6.340957346,((((((t85:8.062066909,((t86:0.7726045219,t87:0.6870156299):0.1192473692,t88:0.6345138426):7.140281843):0.6887894883,((t89:4.275791181,(t90:0.9977641336,t91:0.9374782804):3.272826817):1.105116866,(t92:3.814248206,t93:3.621487955):1.473546639):2.665267364):0.9319563651,(t94:7.248587693,(t95:2.799351807,((t96:1.777269247,t97:1.756356479):0.6955251413,t98:2.179770301):0.1373337567):4.116252898):1.039796958):1.14271753,(t99:0.3587968601,t100:0.2438404029):8.219057533):3.308134737,((((t101:2.517209947,(t102:2.250608774,t103:2.172859213):0.1303966092):3.956332881,((t104:3.163451865,t105:2.934708986):0.7376475805,(t106:0.6650348937,t107:0.6123071311):2.777496972):2.271744971):1.039811702,t108:6.627395627):2.95149979,(t109:2.339101781,(t110:0.9159634303,t111:0.7996952514):1.354506475):6.788862331):1.263889517):13.81808488,((((t112:7.219304221,t113:6.839343604):1.428265448,(((t114:3.417790137,(t115:1.888379496,t116:1.864686776):1.435932169):0.2837841473,t117:3.486555668):2.019687113,t118:5.471167387):2.50284687):4.661892539,(t119:3.712437703,t120:3.710515279):8.833445244):0.2649689128,(t121:10.80047351,(((((t122:3.793603266,(t123:1.495169712,(t124:0.4497786725,t125:0.08021463612):1.002045307):2.284615171):1.310418304,((t126:0.5297709251,t127:0.4806819204):3.833247486,(t128:2.192080416,t129:2.14059286):1.735012299):0.2679363119):0.9012953545,(t130:0.9982732875,t132:0.7699185816):3.968464212):0.1396009779,t133:4.693561808):1.508651363,t134:5.810485448):3.138601178):1.988059925):10.3752331):1.591642929):1.727646813,(((((((t135:0.2163913601,t136:0.1826968707):9.778074426,((((t137:2.621503688,t138:2.605649002):3.538884285,(t139:5.053245897,(t140:1.705804033,t141:1.667306826):3.094368332):0.7448711717):0.2861358121,(t142:0.09920514388,t143:0.03210636521):5.623632697):1.451680345,t144:7.026529284):1.977545818):0.2575130534,((((t145:5.543314386,(t146:5.287007822,t147:5.252260653):0.177997465):0.1829743791,((t148:3.046128566,(t149:1.654578217,t150:1.644654412):1.259568035):2.3152738,(t151:5.186369113,(((t152:1.908005435,t153:1.586329846):0.3084690917,t154:1.83469851):0.3509691494,((t155:0.8107658666,(t156:0.5116541557,t157:0.4971331064):0.2648988552):1.19567237,t158:1.843042245):0.1778979064):2.58662404):0.001858724905):0.1087370541):1.863325235,(t159:0.7601975971,(t160:0.2734982436,t161:0.1651433771):0.4533629353):5.790475683):0.287467319,(t162:3.3306563,((t163:0.8816074952,t164:0.7396931755):0.8364562023,t165:1.447329113):1.538854296):3.354361014):1.382695708):1.226219757,((((t166:2.664973311,t167:2.65599522):0.7957298839,t168:3.227993144):0.953780094,(t169:3.122837894,t170:3.101621474):0.9193018729):3.104595288,t171:7.051884799):1.385138694):2.94281454,((t172:0.5995414569,t173:0.513804235):4.763058574,((t174:0.5908353722,t175:0.5794339284):1.405030333,t176:1.984371461):3.209904945):5.67122039):3.036161256,((((t177:6.353503449,(t178:0.2529691021,t179:0.1204652661):5.925014873):4.944213391,t180:10.94923619):0.5391536593,(((t181:4.029970563,t182:4.014321297):1.466814196,t183:5.44129627):4.938155216,t184:10.35462998):1.052303468):0.2339394714,(((t185:5.359937122,(t186:5.016312871,t187:4.77688629):0.3225795202):0.6614352217,(t188:0.6342610336,t189:0.4596605269):5.066733713):4.398326848,((t190:4.030500853,(t191:3.578485825,t192:3.437293351):0.294239579):3.734248197,((t193:3.480212071,t194:3.043250771):2.962184724,(t195:5.063990758,t196:4.680265608):0.8563144684):1.017201591):2.022370887):1.117239617):1.813867939):3.031367626,(((t197:2.331683654,(((t198:1.398483543,t199:1.314028466):0.4381481508,(t200:1.038083859,(t201:0.5637721066,t202:0.4755519661):0.4510827033):0.6874866461):0.03183452553,t203:1.566267247):0.3291261546):9.745347044,((t204:7.556597717,((t205:4.470553703,t206:4.451020041):2.234842439,(t207:1.242699718,t209:1.086519484):5.286900978):0.8501019163):3.555834989,(((t210:2.890254477,t211:2.774603782):3.332137839,t212:5.943975557):4.016836332,((t213:5.914749773,(t214:2.981597681,t216:2.883973136):2.824819818):1.117543538,t217:6.733822647):2.901033411):0.4218185588):0.498022482):1.698601036,t218:12.23200632):0.6692114118):4.133921728):4.613651059):3.714249397):1.691533829,(((((t219:0.3507645172,t220:0.292259885):3.796800232,(t221:0.9231177572,t222:0.758764556):2.957025601):7.086030492,(t223:2.225609566,t224:2.109118257):8.186173958):11.1072873,((t225:1.701729024,t226:1.683066317):16.87166399,((((t227:8.145713527,t228:8.132113613):5.18435134,((((t229:1.416002788,t230:1.311082261):4.711129396,(((t231:0.2931154151,t232:0.08299310642):0.2764211707,t233:0.2986871632):2.275205363,(t234:1.912468915,t235:1.899210786):0.6048855212):3.00451236):1.947204845,((t236:1.217582148,t237:1.130022983):2.597084916,((t238:0.9642666934,t239:0.8187467373):2.142881982,t240:2.864998808):0.5582572033):3.588556834):3.236105129,((t241:4.446483318,((t242:2.262835815,t243:1.810553554):1.89295959,t244:3.657245912):0.2506101994):1.854032114,((((t245:0.8436838002,t246:0.5295223305):1.811770421,t247:2.127930386):0.09419701757,t249:1.979576645):2.407918936,(t250:3.112403428,(t251:1.284764907,t252:1.025192098):1.58495437):1.231296127):0.5820491814):3.931144865):1.903198062):0.2417494445,((t253:0.9402139924,t254:0.9363791176):4.90867258,((t255:0.5430239307,t256:0.4412293796):0.1655054938,t257:0.5430817266):5.006052163):4.631008092):2.675430509,((((t258:3.071258214,t259:3.070580333):4.982562013,(((t260:2.279204348,(t261:1.71504428,t262:1.689563704):0.510209828):4.26791404,((t263:5.291748227,(t264:2.498257,t265:2.495836616):2.789942188):0.9173662239,((((t266:0.264303374,t267:0.1361898159):1.448750663,t268:1.51121996):2.355619949,t269:3.865023141):0.07445978234,((t270:0.68296446,t271:0.5905002575):2.981836537,(((t272:1.647046448,(t273:1.041213135,(t274:0.7786376319,t275:0.6250362011):0.2218584841):0.5612087042):0.08791684074,t276:1.465192371):0.1503794263,t277:1.602596161):1.583236822):0.2362008987):2.028323347):0.1580780417):1.475517385,((t278:3.380119791,t279:3.277553162):1.122935161,t280:4.352250022):2.499447859):0.006315208317):0.7199394524,(t281:1.897097432,t282:1.834646666):5.548598556):0.01147052609,t283:7.331189263):4.004528652):1.888685838):2.797611008):0.24189924,t284:16.18184463):4.442993525):34.97485813):14.74514422):44.72710497,((((((((((((t285:1.988240822,t286:1.897278512):0.9245376938,t287:2.695157282):3.10881946,((t289:4.58490896,t290:4.411070841):0.775633508,t291:4.89473206):0.0305607663):0.3680891157,(t292:3.695727031,(t293:1.404383455,(t294:0.801113138,t295:0.7600325039):0.4779962701):2.261781187):1.54087334):0.8066401251,t296:5.762263634):0.7658240178,(t297:3.307204374,((t298:0.7214366295,t299:0.6371356504):0.1991758925,(t300:0.5673250621,t301:0.5605336246):0.2684017826):1.937620227):3.082616178):0.2946910063,t302:6.101294255):1.360832612,(((t304:1.764970975,t305:1.755880259):1.993849627,(((t306:1.761251274,t307:1.608410905):1.157249932,t308:2.742739151):0.5510935079,((t309:1.329440905,t310:1.196258903):0.5998425675,t311:1.739334969):1.301836773):0.2708931889):3.065775451,(((t312:3.70991227,(t313:1.650425831,t314:1.610963954):1.652103506):1.427673927,t315:4.555874029):0.1680588223,t316:4.65897817):0.9975294654):0.2660372807):8.866784677,(((((((((t317:1.057882876,t318:0.9935995147):0.8472390748,((t319:0.03038136869,t320:0.0004770073451):1.495065454,t321:1.463017957):0.2345528758):0.7000296488,(t322:1.916858115,(t323:1.482929643,t324:1.401730795):0.4253989892):0.4255572431):1.103401196,t325:3.240124568):2.05514221,t326:5.263446133):1.295539986,t327:6.494138355):1.014689331,t328:7.349315781):1.016825679,((t329:3.244180422,t330:3.0997387):0.5855491401,(t331:0.5022468527,t332:0.3662192433):3.153020335):4.527152082):0.8434242395,((t333:5.379515556,((t334:0.5821009458,t335:0.5027636926):0.6746987365,t336:0.9951198425):4.075741852):2.112065431,t337:7.144109356):1.218917481):4.828831112):1.219255217,((t338:9.418005258,((((t339:3.338607919,(t340:1.939817513,t341:1.821847567):1.392338865):0.9244662128,t342:4.030040047):0.3480548167,t343:4.273565282):1.025861939,t344:4.949396317):3.761925872):0.2591098345,(((t345:1.762286624,t346:1.719244244):2.692174071,t347:4.410102196):2.87793689,t348:7.219639153):1.610936896):4.648133287):3.366789487,(t349:2.71798515,t350:2.689430171):14.09549502):43.15177308,((t351:5.894555862,((t352:0.9795698509,t353:0.918308686):0.7668844245,(t354:1.173384378,t355:1.14556198):0.5115399355):4.080198027):9.611985048,(((((((t356:3.392799972,(((t357:0.243741288,t358:0.1166571096):0.6245169295,t359:0.6832027865):0.2332316131,t360:0.7338702425):2.144578238):1.742775419,((t361:0.0757207172,t362:0.04413770559):3.074353154,t363:2.977022613):1.348802432):3.183445657,((t364:0.8359968173,t365:0.6909240726):0.1713614245,(t366:0.3280741087,t367:0.3264356362):0.4915552955):6.459716086):3.679540369,((t368:3.10804317,t369:2.825164827):3.624993298,((t370:4.364585323,t371:4.273125543):1.450902115,((t372:3.041832964,(t373:0.589097235,t374:0.3823047137):2.276566628):2.084288765,t375:4.674482516):0.5803081642):0.4819266562):4.211831033):0.7272702325,((t376:2.679040526,t377:2.565777091):4.454873409,t378:6.778163856):3.233441815):0.03747873634,(((((t379:0.3285951968,t380:0.3225003662):3.379210948,t381:3.539342211):1.894586297,(t382:0.9303222191,t383:0.9115035663):4.43360173):3.568730993,((t384:5.300834092,(t385:1.273566226,t386:1.119557731):3.953668142):0.5655304682,(t387:2.035135027,(t388:1.906169772,t389:1.839485575):0.1227595764):3.585379845):3.036630989):0.3716914257,(t390:3.918764493,(t391:2.290294191,(t392:1.486787293,((t393:0.2909565469,t394:0.2120815053):0.478614649,t395:0.6273097387):0.2116752421):0.6442732546):1.407173218):5.026947433):0.4589910029):0.02889172424,t396:8.262281702):2.551189527):44.2111495):48.73127334):52.35592527,((((((t397:8.595808613,(t398:6.745086154,((t399:4.658208909,t400:4.610983156):1.680876068,t401:6.287950495):0.3162328883):1.599748861):1.610920648,(t402:6.599424745,(t403:1.162073926,t404:1.03538492):5.370823213):3.164592018):2.435006575,(((t405:2.852742036,t406:2.663353168):4.173498883,((((t407:0.9142449979,t408:0.8811463603):0.3280559182,t409:1.18127532):2.069264986,((t410:0.453037429,t411:0.3971003232):2.275829129,(((t412:0.2849085122,t413:0.1842331212):0.6289584518,t414:0.4714916547):1.099254474,t415:1.495071695):0.6130726929):0.4595019924):0.2172895116,t416:2.692441422):3.277512849):1.070958409,((t417:1.374940345,t418:1.342585806):3.991748892,t419:5.133450662):1.532034618):3.851397767):15.88112953,((t420:0.5831238452,t421:0.5275204201):8.194429175,((t422:3.144011728,(t423:0.8750914461,(t424:0.6344303797,t425:0.471746374):0.1641797767):2.119787434):1.274708287,((t426:0.1332071393,t427:0.08492154319):3.421758443,t428:3.360855383):0.4517679152):4.287089394):17.59168656):0.7902509319,(t429:0.3297487782,t430:0.1412657039):26.09195825):37.10209549,(((t431:5.548391549,((t432:0.7570517235,t434:0.3558396902):1.758407695,(t435:1.580188067,t436:1.502049334):0.3891493104):2.951955096):15.01040665,(((t437:0.3397916208,t438:0.3013112603):0.8862844214,t439:1.153247424):13.6045559,t440:14.70880304):5.004041844):4.146700385,((t441:3.608050121,(t442:2.165279838,t443:2.156370055):1.37526816):5.538925925,(t444:5.992367602,(t445:1.759847583,((t446:0.9967541426,t447:0.8867064809):0.5410090529,t448:1.196723816):0.1667037778):4.110262509):3.070573636):14.3484173):38.57372507):89.40532872);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T27.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
