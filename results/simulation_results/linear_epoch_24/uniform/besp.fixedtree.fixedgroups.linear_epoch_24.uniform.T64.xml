<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t483:7.626478752,t484:7.492025497):19.90999971,(t485:23.65495361,(((t486:1.141190886,t487:0.8580790017):4.220669188,(t488:0.03860150469,t489:0.004039984712):4.848563225):17.05586192,(((t490:3.801030177,(t491:2.032241419,t492:1.888300662):1.729050343):2.661071964,t493:6.192482238):3.498314153,((t473:0.3700790718,(t460:0.2434530615,(t448:0.3004946552,(t436:0.1250493776,(t433:0.2891372997,(t434:0.2339925093,(t420:0.08651203531,(t397:0.05990015686,(t395:0.01009279232,((((((t293:0.03135050144,(t287:0.00304363893,(t286:0.05352156644,(t257:0.05933481649,((t237:0.1258352383,(((t89:0.136939759,((t1:4.782227082,t2:4.700866472):1.227976093,((t3:4.119136567,(t4:1.872264086,t5:1.853728613):2.157017392):1.674527357,(t6:4.189941144,t7:4.133025047):1.451035495):0.03817409631):1.546128874):0.4075197035,t8:7.352748915):13.70427892,((((t9:0.6476768313,t10:0.6291700217):7.628188425,(t11:7.653589556,((t12:3.539391268,t13:3.486764648):1.736376669,((t14:3.092718089,t15:3.088416337):0.0976852661,(t16:2.315638655,t17:2.315229801):0.7000684565):1.993380301):2.204159824):0.5940925125):1.791546063,(((t18:4.155331389,t19:4.09655336):0.8786985348,t20:4.881005192):0.9237459012,t21:5.737222669):3.607757163):1.952860518,(((t22:5.858129033,t23:5.830895866):2.167717106,(((t24:2.649548934,t25:2.518158557):2.245365304,(t26:3.496486982,(t27:2.487670451,(t28:1.884511972,t29:1.856831911):0.5465083708):0.9629727165):1.209726337):1.840758315,t30:6.332695275):1.100064264):2.508086614,((t31:3.952961456,((t32:0.2284263859,t33:0.175092811):2.948176403,t34:3.095987113):0.5886423212):5.831296678,((t35:3.155191337,t36:3.096864448):1.480161252,t37:4.430278625):4.834426006):0.04326377375):0.3871209175):8.614186041):0.1682251071):1.838420965,((((t38:7.492907355,(((t39:0.04209697391,t40:0.02054639817):2.347266146,(t41:2.325989698,t42:2.206010821):0.01120737591):1.179930791,t43:3.343511734):3.893969303):3.241666512,(t44:6.966948802,((t45:2.406025085,((t46:0.5914333207,t47:0.5409354158):1.681848133,(t48:1.705681748,t49:1.634666656):0.3983644768):0.1301853745):2.580799142,((t50:2.612083282,t51:2.510610446):1.595626129,((t52:2.143860021,t53:2.135235217):1.719716345,(t54:1.902991813,t55:1.774550862):1.768319448):0.2257963857):0.09773492578):1.896450428):3.48625354):8.103333042,((((t56:4.307373569,t57:4.287469266):1.890800653,t58:6.171837982):0.647564856,t59:6.818087283):7.664647548,((((t60:5.230392687,t61:5.092315325):5.39044637,((t62:0.3412001126,t63:0.3394111234):5.34258875,t64:5.666272585):4.648675979):1.09538142,(((((((t65:1.128692605,t66:0.7926766461):0.2136514314,t67:1.002981586):2.052880436,t68:3.028429083):4.439239961,t69:7.450450126):0.8351313479,((t70:4.870631212,(((t71:0.5753562264,t72:0.2351636076):0.3927427374,t73:0.5329695146):2.639671827,(t74:0.6191851693,t75:0.6097455915):2.528839427):1.249790181):2.253904275,((((((t76:0.8714709085,(t77:0.6904173033,t78:0.6876256951):0.1027403225):0.108626686,t79:0.8548277363):0.4242549217,(t80:0.8081941517,t81:0.7880310589):0.2623143571):1.69320907,(t82:2.532399025,t83:2.511874919):0.1808086242):1.555046773,(t84:2.381920066,((t85:0.7065459172,(t86:0.5411320496,t87:0.3632958135):0.06545231666):0.3085011314,t88:0.7166359954):1.244519581):1.845414218):0.5713236012,((t90:2.828540465,t91:2.678207245):0.2638258649,t92:2.903960464):0.9320327531):1.369296255):0.9114855219):0.1904501649,(t93:5.014807103,((t94:0.03038499255,t95:0.01884858061):0.1690812111,t96:0.1802607028):4.729703036):0.6925404708):0.7171610857,(t97:0.7376326167,t98:0.6248476136):5.563871793):1.792769534):2.128796277,(((((t99:0.5631887799,t100:0.5242022838):2.042960775,((t101:0.3989066737,t102:0.2223180174):0.07117461784,t103:0.2252069436):1.895807958):2.780178603,t104:4.72174343):0.510770764,t105:5.221496301):0.565865918,(t106:1.212624261,t107:1.014663891):4.503923974):3.611682118):0.6145021618):2.778403504):1.273941962,(((t108:0.8677142075,t109:0.8208851631):1.933698351,t110:2.547840758):9.688201347,(((((t111:1.962213232,t112:1.82383955):3.465566371,t113:5.217668782):1.262403116,(t114:3.455999929,t115:3.424733745):2.962372053):3.141323468,(t116:0.8607053044,t117:0.6550730881):8.239595165):1.250585835,((((t118:0.4160306017,t119:0.3550997084):8.500391244,((t120:4.067719832,(t121:2.424553767,t122:2.37232248):1.037073888):1.648167531,t123:5.039141991):3.138439799):0.7966300867,(t124:2.488847943,t125:2.270823447):6.280108908):0.1069160697,t126:8.533499929):0.2306156157):1.137264019):1.305830731):0.1927833533):0.1350401422):2.778117118):0.005932601676):0.5197894803):0.009212426156,((((t127:1.842105502,t128:1.771606578):0.8131073222,((t129:1.435223013,(t130:0.5113896551,(t131:0.3066050038,t132:0.2871747329):0.1973761558):0.8692042829):0.6679203726,t133:1.961574097):0.3848701895):7.49412438,((t134:1.248192922,t135:1.23483494):0.6004724842,t136:1.830478195):7.827907042):1.4283781,(((((t137:2.474653615,t138:2.447143211):0.5087612654,t139:2.948693524):0.4250420303,(t140:1.006567305,t141:1.006365552):2.362375851):2.058679791,(t142:1.376945517,(t143:1.13359885,t144:1.062093121):0.216553386):3.889660761):0.413049043,(((t145:0.9055797188,t146:0.6543419348):3.662655555,t147:4.276009053):0.139014265,t148:4.291683809):0.8569617744):5.201060109):3.211673568):0.5408958846,(((t149:2.954344392,(t150:0.19368186,t151:0.08803907426):2.568816617):2.041961443,(((t152:0.9652797469,(t153:0.6758135767,t154:0.2100928561):0.2779672594):3.534663915,t155:3.90909315):0.1037820367,t156:4.010310551):0.001947638913):5.906752679,t157:9.733244122):3.159019803):0.6295503318,((((((t158:2.074089632,(t159:0.2689153432,t160:0.1523550806):1.759067534):6.051448867,(((t161:5.931968643,t162:5.895657319):0.6867300655,((((t163:0.2597273625,t164:0.08444075984):2.167569257,t165:2.154907938):0.7136742594,t166:2.850930163):2.194914944,((t167:2.145797648,t168:2.086504142):1.751563117,(t169:2.619715202,(t170:1.714203939,t171:1.690525733):0.8576723929):1.209505556):1.131992128):1.129817774):0.7536159921,((t172:2.142237531,t173:2.082773091):0.7103507697,((t174:2.057785444,t175:2.035122991):0.6559474232,(t176:1.74329801,t177:1.562409296):0.760881196):0.0727869811):3.749076501):0.4725668704):0.5597340666,(t178:1.222722932,t179:1.094943736):5.844960772):3.149866583,((((t180:0.4956054422,t181:0.4482147959):2.252934364,t182:2.64963396):4.523396792,((t183:0.7371673224,t184:0.6843722373):4.434836422,t185:4.931133271):1.999990123):1.749846054,t186:8.604582099):1.032493418):0.4865758752,((t187:0.2787257269,t188:0.1214165505):6.116062559,(((t189:3.605640913,t190:3.585361323):0.3112295629,(t191:0.8418967676,t192:0.7919833459):3.028096096):0.3336519847,((t193:0.8807242477,t194:0.8378424586):0.7608781792,t195:1.499110804):2.436641914):1.94224674):3.683362683):0.471538407,((((t196:2.436231527,(t197:1.829251561,(t198:1.431199424,t199:1.355422296):0.3767112182):0.5433038626):1.344700777,t200:3.593959366):0.4999551481,t201:3.938989887):0.6602915051,(t202:1.367219476,t203:1.33471298):2.87479844):4.883970305):0.6558750923):3.316479505,((((t204:5.314285336,((t205:1.096716689,t206:1.015592168):3.844815774,t207:4.860154701):0.3704905704):1.782217321,((t208:2.001204995,t209:2.000643088):0.7529499516,(t210:1.81818017,t211:1.721875996):0.6378580134):4.208810428):3.213764589,((((t212:0.4554695256,t213:0.4475056452):0.08874917429,t214:0.3482665266):3.041862148,(t215:2.33053705,(t216:1.296437377,t217:1.267670311):0.8810571968):0.8680875569):1.846462731,t218:4.647952144):4.305755469):0.2825229573,(t219:9.108583422,((t220:3.83915189,(t221:3.052351349,(t222:2.32827777,(t223:1.326150893,(t224:0.9113143115,t225:0.8998215716):0.3704802442):0.9582774694):0.6719091756):0.6768437656):0.9288310284,t226:4.497698987):4.274139805):0.09359314644):2.139858797):4.629849718,((t227:5.659662548,(t228:3.669409084,t229:3.655059492):1.949060289):7.567636737,(((((t230:0.1012228744,t231:0.07096698911):3.277303367,(t232:2.412752337,(t233:2.135638177,t234:1.872693397):0.2757682259):0.7726370315):3.471026848,t235:6.359368796):3.345573455,(t236:7.674585816,t238:7.296804361):2.004087994):2.269699732,((((t239:0.6363362383,t240:0.4503134681):2.982735129,((t241:1.283499544,(t242:0.7761392112,t243:0.7361908567):0.4678413783):1.299889203,t244:2.360538782):0.715981548):0.01178957413,t245:3.073537452):5.267511212,(((t246:3.253566616,t247:3.217886818):3.151743301,(t248:1.072451481,t249:0.9425243175):5.105005837):0.05899769625,(((t250:2.987862086,t251:2.937948845):0.5073159549,((t252:0.1383027333,t253:0.08655837376):3.133850789,(t254:2.980138678,t255:2.915441062):0.1322116269):0.1022599297):1.044531797,(t256:0.4282195918,t258:0.2757032989):3.729028772):1.376700592):1.782861581):2.492935643):0.4370892747):2.285085714):0.6407009068):0.1346436464):1.437104934):1.486353653):0.02454333791):0.4092020562):1.220776458):1.609232873):1.714988745):0.8837698429,(((t259:4.260356662,t260:4.257749254):12.05380996,((((t261:1.841701639,(t262:1.117730684,t263:1.07300688):0.1828878879):2.438482605,(t264:1.245578404,t265:1.242499013):2.437966757):6.905577766,(t266:3.327373139,t267:3.209414888):7.197002221):1.081900653,((((t268:8.45846455,((t269:4.412846319,(t270:1.866443004,(t271:1.43269781,t272:1.277870571):0.3503364999):2.489105336):2.101540647,t273:6.150925324):1.838522662):1.28259037,((t274:7.448554946,(((t275:0.9405440248,t276:0.6880428099):0.9427463809,t277:1.232231056):4.626653217,((t278:0.9691972626,t279:0.8899386306):3.464896429,t280:4.255404485):1.383928798):0.9029612978):1.625711428,((t281:2.067049093,t282:2.013064337):1.595769498,((t283:1.35288055,(t284:0.2806361736,t285:0.1907733609):1.070873195):2.068066089,(t288:2.479328818,t289:2.427333648):0.7441032749):0.1828523465):4.46873366):0.1874118555):0.02729798056,((t290:1.952715084,t291:1.861784612):2.798167507,((t292:1.177372082,t294:0.9535596891):1.190579865,(t295:1.466527403,t296:1.459852541):0.6460457539):2.212725653):3.188219253):1.621472998,((t297:2.410633643,t298:2.357844777):5.582232423,(t299:5.082600892,(t300:1.305017646,t301:1.297658989):3.776092521):2.758346628):1.11066512):0.04233284202):3.856141671):2.344355047,(((((t302:0.8467901143,t303:0.6700077149):2.43591811,((t304:0.6538978224,t305:0.6419970473):2.357453551,t306:2.943978462):0.06987581501):0.2885820388,t307:3.165352855):2.524946655,(((((t308:0.196607216,t309:0.02039301931):1.57429246,t310:1.586497117):0.9009496974,(t311:2.349584659,t312:2.259912556):0.1135329561):0.44019863,t313:2.775417242):1.894565949,((t314:0.7362950179,t315:0.6677043522):1.188424272,t316:1.794988675):2.631725974):0.5400312343):6.512538452,(t317:3.423493905,t318:3.300378829):8.043835627):2.510642378):3.251155382):11.56429187):11.86637502):1.027958579):3.47595529):251.9708921,((((((((((((t319:0.1853486333,t320:0.1692551892):0.6261200807,t321:0.50505126):2.234513413,t322:2.603372019):0.2697659252,t323:2.594491282):1.97655308,((t324:0.8901807952,(t325:0.4084752565,t326:0.2774014562):0.4618401823):2.219772131,(t327:1.655336926,(t328:1.053486353,t329:1.040140197):0.4774339231):1.220427028):1.393198893):3.915206206,t330:7.770124574):1.318297621,(((t331:1.077782764,t332:0.980356574):5.233270175,(t333:1.273616061,t334:1.258704529):4.827124825):0.03289318299,(((t335:1.56989058,t336:1.559175917):1.020474559,t337:2.477333412):2.454498871,t338:4.850989741):0.8026409232):2.704699348):3.584979844,((t339:2.233964741,(t340:1.17595246,(t341:0.5487074269,t342:0.5031235226):0.3577699066):0.8521771511):5.301749492,((t343:4.31907647,(t344:3.24716584,t345:2.961920727):0.8790979639):2.204962083,t346:6.019172272):0.274559286):4.31191607):7.991260752,(((((((t347:0.6156464542,t348:0.4894045024):3.109076233,t349:3.58789537):2.01775683,t350:5.365863726):1.893608312,((t351:0.2249739909,t352:0.1185212446):2.247958663,t353:2.302788033):4.751413111):5.70212427,(t354:7.735815194,t355:7.404049391):4.923795103):1.293111172,((t356:11.5611284,t357:11.54171618):1.472351706,((((t358:2.245620708,t359:2.148198288):1.528653574,(t360:0.2352581982,t361:0.02578383855):3.357916049):4.859272203,((t362:1.058842463,t363:1.058773934):0.1581388002,(t364:0.9055271041,t365:0.8762302142):0.2533517749):6.950864484):1.570991805,(t366:9.00320195,(t367:5.462604231,(t368:3.484675609,(t369:2.624158842,t370:2.537679048):0.6346787229):1.842630297):3.422897738):0.6130789093):2.799362634):0.3942263572):0.09367063845,t371:12.26914382):3.578198944):0.0349013271,(((t372:2.237953116,t373:2.172072093):10.18686866,((((t374:3.080821471,((t375:0.07347942612,t376:0.04830445678):0.7458245791,(t377:0.2345562646,t378:0.2120203132):0.4810453739):2.15939154):2.411712337,(((t379:3.052408281,(t380:0.9260872236,t381:0.9208920408):2.119437069):1.201939901,((t382:1.934149857,t383:1.930467982):0.7053552863,t384:2.615310431):1.316333184):0.3151960668,((t385:0.5690642077,t386:0.4339213496):3.134306658,t387:3.489332981):0.4917463507):0.5451903145):0.3349282543,(((t388:0.6877858463,t389:0.5493172148):1.909825865,((t390:0.5724219945,(t391:0.09011159801,t392:0.08683484756):0.4559396923):0.1198924766,(t393:0.4354293371,t394:0.434874891):0.1366877503):1.651638035):0.1475285944,t396:2.17139836):2.109683686):4.553830218,(t398:8.507900902,(t399:0.5548305198,(t400:0.4734195199,t401:0.4443542401):0.07358908514):7.724880503):0.1816113129):1.858421721):1.828026306,(((t402:3.908605041,(t403:2.801865584,t404:2.557093306):1.091407819):1.433494304,t405:5.058527385):0.8325693211,(t406:3.138185138,((t407:0.7927934562,t408:0.7886082867):1.735679132,t409:2.51466806):0.4701727714):2.699785398):5.854263142):1.587319795):3.921121219,((t410:6.577788648,t411:6.539872144):5.825877357,(((((t412:2.990042,(t413:0.09291502013,t414:0.0004124210173):2.8707042):0.4390949711,(t415:2.623260394,((t416:0.5485966007,t417:0.4411872739):1.371246813,t418:1.778029734):0.6706703628):0.6639649328):3.180327801,(t419:4.165339188,t421:3.892013876):2.093364192):2.395417155,t422:8.055088371):2.421636106,(((((t423:0.4717420215,t424:0.3888037779):0.1275552083,t425:0.2032917464):2.88612342,t426:3.081162395):1.969984865,t427:4.981110176):4.234786785,(t428:8.99806073,(t429:1.448593111,(t430:0.6547162476,t431:0.6381406075):0.6846945739):7.527850811):0.1652563206):0.7653657672):0.9224353627):4.621855933):223.6965856,((t432:8.478100191,(((t435:0.66845334,t437:0.2636658857):1.842637445,(t438:1.371587977,t439:1.33985282):0.507774159):0.5959467291,t440:2.42967106):5.053624727):72.43890563,((t441:8.180815854,t442:8.08974178):43.29405196,((((t443:8.206957941,((t444:5.751218234,(t445:1.737049006,t446:1.650410975):3.829898867):2.443759788,((t447:1.5160415,t449:1.045078578):4.00442099,t450:4.903237888):2.399876944):0.005303204104):0.2480586549,(t451:3.065931732,(t452:2.137812546,t453:2.04045321):0.7352931035):4.233283449):5.696561632,((((t454:2.601028321,t455:2.592010288):3.727184675,(((t456:0.5925667514,(t457:0.4815621038,t458:0.3797355636):0.066608907):3.018960514,t459:3.215726031):0.1224857996,t461:2.977621676):2.419153588):0.443245551,t462:5.772520682):2.565875213,(t463:5.19364618,(t464:0.2179740004,t465:0.1825314782):4.623522217):3.144225001):3.344394612):3.624807301,(((t466:1.129137079,(t467:0.4660105364,t468:0.2605111863):0.6577018662):4.933131867,((((t469:0.04023212036,t470:0.02295082649):0.3644428019,t471:0.1402130273):1.329277773,t472:1.371708601):0.4378144243,t474:1.136595143):3.582148076):8.792525623,(t475:6.769395806,((t476:2.506463964,t477:2.399999997):3.948137631,((t478:1.134195434,t479:1.112158404):3.291836304,(t480:2.381226113,(t481:0.3185188531,t482:0.08073748581):1.930146958):1.929810622):1.754712435):0.05837863756):6.680030361):0.05312863217):33.59682349):28.33397919):158.0336601):47.09959964);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T64.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
