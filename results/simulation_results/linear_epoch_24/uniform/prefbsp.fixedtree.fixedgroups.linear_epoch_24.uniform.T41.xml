<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t471:12.92630385,(t472:3.041207955,(t473:2.379851505,((t474:0.7669809756,t475:0.7447460091):0.4527263657,t476:1.172268408):1.078592194):0.3716121235):9.796510444):0.5854304622,(((t477:0.9234117791,t478:0.8851220552):1.398267013,t479:2.28173754):1.081799084,(t480:2.204382082,t481:2.123895123):1.033277034):9.352412198):48.95489996,((((t482:0.9625084716,t483:0.8356731165):0.1347861212,t484:0.8633464598):6.751239731,t485:7.609152209):47.90288672,((t486:12.29967588,t487:12.29930456):3.733841582,(t488:11.22169179,t489:11.1625873):4.721043108):39.44080851):5.707834491):139.8366633,((((((t490:0.9824223192,(t492:0.1204896512,t493:0.06581034263):0.2378127283):0.9142762491,(t491:0.01831308893,(t466:0.01621740593,((t459:0.1162572568,(t457:0.01161872692,((t430:0.1320472115,(t422:0.1956435859,(t387:0.08421100342,(t380:0.06577037615,((t335:0.05648265691,(t315:0.01199514843,(((((t43:0.003422724647,t1:5.446652996):6.448488256,t2:11.6356327):5.332985679,((((t3:9.326081199,(t4:7.67643796,(t5:0.5251111388,t6:0.4959875546):7.017800982):1.568891605):0.01309455178,(t7:6.605732844,t8:6.536280274):2.32736338):0.856596316,(((t9:3.949610327,t10:3.888231867):1.200671719,(t11:2.264635006,t12:1.888354938):2.583583537):2.667425426,t13:7.016807383):1.788612751):5.66200811,((t14:8.446194659,(t15:8.060219195,((t16:3.79439973,t17:3.778763733):1.60477207,t18:5.222502701):2.654789586):0.2856278442):4.143939969,t19:12.24450776):1.822843398):0.7014384771):3.112905411,t20:17.85343227):9.879478698,((((t21:8.210811842,t22:7.73803224):9.123521402,((t23:0.4382064082,t24:0.4086326641):7.27615812,(t25:2.31071503,(((t26:0.4305269828,t27:0.4254587388):0.8098007987,t28:1.071861534):0.722826226,t29:1.620150574):0.2622543609):5.191090644):9.113269197):7.243601335,((((((t30:2.395149144,t31:1.924090771):2.592422869,(t32:2.982525429,t33:2.980262471):1.506943816):3.666141983,(((t34:3.276584042,(t35:1.870410768,((t36:1.130840031,(t37:0.1709656026,t38:0.1338284928):0.9086701899):0.03676650152,t39:1.032637577):0.7006571448):1.319602864):2.52538546,(t40:5.138091884,((t41:2.630215676,t42:2.492735101):2.194942307,t44:4.651547728):0.281794151):0.3529813129):0.609879145,(((t45:0.9761803925,t46:0.8648171045):1.860198447,(t47:2.165803685,(t48:1.475041572,t49:1.149631887):0.537186):0.5382638125):2.092019224,(t50:2.409256475,t51:2.399224886):1.388010611):0.8985384397):1.565610236):6.119527351,((((t52:2.238532586,t53:2.225665533):2.974796115,(t54:5.142863054,(t55:3.477072859,t56:3.428891169):1.592224757):0.0002011898468):0.6869418599,(t57:3.647917703,t58:3.531406219):1.850243221):2.267325927,t59:7.606482786):4.077558989):3.288448909,((((((t60:2.426219704,t61:2.351703309):0.2653841229,(t62:1.08039755,t63:1.004635987):1.411522155):4.189600766,(((t64:0.7268014146,t65:0.6668325412):2.957809012,((((t66:0.6009406814,t67:0.578759863):0.931316646,t68:1.460094364):0.1587087509,(t69:0.9157258366,(t70:0.4838754677,t71:0.4185952212):0.2385419065):0.5641249978):0.6786985292,t72:1.847188361):1.195475191):2.682399958,((t73:3.262454008,t74:3.261167074):1.554561667,t75:4.813330667):0.8724312075):0.2027256915):1.812738669,(((t76:1.249435236,t77:1.198557433):0.09053256322,t78:1.200355063):4.073288355,t79:5.253621541):2.260611851):1.902507384,((t80:0.5004052615,t81:0.4857764316):1.06248942,t82:1.268714314):7.769432035):3.533987993,(((t83:2.836463459,(t84:1.649919503,(t85:0.807833912,t86:0.7534632889):0.7281573727):1.110134859):2.970475182,((t87:0.8569863892,t88:0.807264901):2.25744339,t89:3.038869556):2.43246215):2.552680101,(t90:7.904094252,((((t91:1.115693992,t92:0.9829642506):1.745156033,t93:2.690982295):1.394849948,t94:4.059943822):2.160068037,t95:6.193249246):1.324777982):0.08237355304):4.151396523):0.8242199804):4.062222613,((t96:1.550628912,(t97:1.438451827,(t98:0.7366724745,t99:0.6329352343):0.6830101699):0.09824660427):3.642398031,((((t100:0.1104556011,t101:0.1032354339):0.5433332998,t102:0.5560211497):0.436290661,t103:0.9048702587):2.986896765,((t104:0.6369742271,t105:0.6109820119):2.759627125,t106:3.365907861):0.4913667509):0.940545781):11.39590996):1.108293331):2.529537405,(((((((t107:0.8714355218,t108:0.8226444471):1.72254324,(t109:0.4332241722,t110:0.4111788337):2.06589731):8.706747891,(((t111:6.663965345,(t112:3.30890908,t113:3.169917217):3.255037488):0.6097939181,(t114:3.866779505,(t115:0.4643330561,t116:0.3978812691):3.268501252):3.027985586):0.2815293133,(t117:3.609188489,t118:3.54368405):3.336823742):3.616305447):2.877998118,(t119:0.4395190371,t120:0.01856174886):12.90198283):3.866930538,(t121:6.267090728,(t122:0.3984290466,t123:0.3591175784):5.730640451):10.41856032):0.1786269169,((((t124:4.87375721,t125:4.821680597):1.396350313,(t126:1.805436571,t127:1.692564307):4.349005866):3.64487018,(t128:5.94863941,(t129:4.381794647,(t130:2.050940624,(t131:1.589398845,t132:1.46912838):0.3007944018):2.258457685):1.298999059):3.727636732):6.087974072,((((t133:0.5050050469,t134:0.4430125078):2.731772764,t135:3.037487555):2.061743056,(t136:1.816342896,t137:1.788331797):2.990817919):5.237138407,(((t138:0.3244045677,t139:0.2195682174):2.937392544,((t140:0.9398973519,t141:0.9308180716):1.049465992,t142:1.851877847):1.138568797):5.809807983,((((t143:0.05331526035,t144:0.01060020076):0.1134149078,t145:0.1202051284):6.324381044,(t146:4.860631979,((t147:2.304284643,t148:2.253853314):1.785602269,(t149:2.867454653,(((t150:1.406569935,t151:1.225748321):0.5553721195,t152:1.771095271):0.5501617004,(t153:0.9640067156,t154:0.8717810946):1.322910256):0.3466937176):1.12059599):0.6143335823):1.400562479):0.782612525,(t155:0.3841630008,t156:0.3835265825):6.045589047):1.482450089):0.9079707848):4.553052023):0.480030468):1.380389241,(((t157:6.081025409,t158:5.973983133):5.915463442,(((t159:4.241066921,((t160:1.165955671,t161:1.13597781):1.704999832,((t162:0.4778795975,t163:0.2895223826):0.4581628703,t164:0.6883844018):1.71472052):1.32708197):5.400177514,(((t165:0.610736657,t166:0.4802585054):2.862111208,t167:3.323865004):4.912013489,((((t168:0.3802321085,(t169:0.2103511379,t170:0.1714043193):0.06998450749):2.485604008,t171:2.629973085):0.8197884887,t172:3.444943413):3.646341619,((t173:1.300137396,(t174:0.9041016699,(t175:0.5474633284,t176:0.517675218):0.107648257):0.3526124939):5.232628381,(t177:4.904030915,t178:4.871139897):1.259221551):0.508115235):0.8424354407):0.7119102579):1.948226447,(t179:7.739519282,t180:7.634870381):2.289219345):0.2641323314):0.174527459,(((t181:6.080360868,t182:5.83258766):0.9775115638,((((t183:4.688950045,(t184:0.8753242239,t185:0.8180302472):3.571942566):0.0652101885,t186:4.355574985):1.621654823,((t187:2.328196728,t188:2.269395972):2.662313235,t189:4.889309341):0.8964300389):0.1281470548,(t190:4.450394441,(((t191:0.3732998703,t192:0.3161682939):2.038201697,(t193:1.556261222,t194:1.514012835):0.7658649098):0.8314403096,(t195:2.151755727,t196:2.057447676):0.8165176547):0.6331195751):1.17650435):0.2673964849):0.4592496116,(((t197:1.540568543,t198:1.535452619):0.5847963267,t199:2.050435365):2.388324598,((t200:0.8426491935,t201:0.667636259):1.465289282,t202:2.027742781):2.120356414):0.3530379434):2.735622917):3.056965713):0.2113338566):0.1994749347):0.2706150773):1.606530908):1.276346887,((((t203:0.3237410701,t204:0.292066856):1.231729125,t205:1.44876539):0.6781373241,t206:2.102079605):10.46843184,((((t207:0.6091593559,t208:0.5274093388):0.9901785791,t209:1.459443493):4.796846736,(t210:5.459206588,t211:5.458450932):0.7295205938):3.485771659,(t212:2.383653867,(t213:0.6649211829,t214:0.6379006759):1.597269363):7.160883119):2.67773312):0.9826207899):3.185315135):0.719342618):3.623482372):0.496100279):1.887300542,((((((((((t215:2.546700218,t216:2.114966112):0.7737828362,t217:2.679356536):1.110659176,(t218:2.771703907,t219:2.766406216):0.8738908148):2.695850619,((t220:1.664195009,t221:1.631875162):3.583014421,t222:5.095663326):0.9399668285):0.3449914106,((t223:0.5521380197,t224:0.2777832783):3.161738101,t225:3.406093528):2.629139489):2.770530219,(t226:4.522605958,((t227:0.7771470392,t228:0.6872167479):1.19597809,t229:1.880375285):2.40519523):4.219209365):3.225964248,(t230:7.98833306,((t231:2.462212956,(t232:2.42995557,t233:2.215286587):0.03101611246):4.894407059,(((t234:2.488463676,t235:2.406083317):3.880495747,t236:5.925516424):0.05478369879,(t237:1.519461076,t238:1.338569984):4.441745184):0.1515283436):0.6084207757):3.541414142):3.471904552,(((t239:6.685350811,((t240:5.850160168,((t241:0.7434814849,t242:0.6511852292):0.9919330349,t243:1.622549827):4.070558821):0.6073422049,((t244:1.886641269,t245:1.807201334):4.145123985,(t246:3.973646042,((t247:0.127394112,t248:0.1267334281):0.5244049229,t249:0.6036215319):2.985672335):1.809074956):0.1659075676):0.1844052967):5.065448711,((t250:3.124622192,t251:2.942873016):1.961880615,t252:4.831583889):5.698809551):0.01808681674,(t253:3.210936399,t254:3.154655857):7.280291124):1.702365885):0.9516727116,(((t255:0.09617874823,t256:0.08787566382):3.536284542,t257:3.623548893):7.688549783,(t258:0.3504882108,t259:0.3475154217):10.9424433):1.710384631):4.748755139,((((t260:1.150920109,t261:0.9335097275):4.447998869,(((t262:2.728935142,t263:2.68089903):0.08934025034,(t264:2.337116293,(t265:1.345728116,t266:1.236974792):0.9771143943):0.399825211):1.666452113,(((t267:0.9600454938,t268:0.6976955478):2.50386856,t269:3.135337939):0.7125801445,(t270:0.3957401362,t271:0.3309781068):3.253933773):0.03984112):0.8838040587):2.955798546,(t272:1.881519488,t273:1.781379072):5.574702083):7.586369757,(((t274:11.57097021,(((t275:0.3714848697,t276:0.3114632504):5.420462175,t277:5.673447836):3.240564689,((t278:2.112914631,((t279:0.8239115677,(t280:0.4877114324,t281:0.3979566377):0.08442171894):0.266559861,t282:0.4576358068):1.004998871):5.175022263,(t283:5.926861498,(t284:3.222636639,t285:3.041607973):2.701548905):0.6599581728):1.578932449):2.409346979):0.09726565544,(((((t286:4.365695793,t287:4.225451394):1.512876158,((t288:0.3569476125,t289:0.1815103237):4.303538814,t290:4.377965744):1.07631691):0.09812645007,t291:5.425294086):0.6532068693,t292:6.045210247):0.2376551479,(((((t293:0.2491832772,t294:0.1977924477):1.363503757,(t295:1.026554322,(t296:0.4116341176,t297:0.3946181249):0.5453250421):0.4775171455):1.463120301,(t298:2.751169397,t299:2.651631828):0.05296987569):2.327163076,t300:4.977693403):0.1043723346,t301:4.891620078):0.3817542549):3.593835665):1.952782779,((t302:2.532280637,t303:2.270109212):1.629415582,(t304:2.628901808,(t305:0.4430611839,t306:0.3872762958):2.096644665):1.206800694):6.6222147):1.315202006):1.485271373):0.1313023744):0.2439734607):0.200327815):0.1685348623,(((t307:0.9494663529,t308:0.9104565267):9.238875435,((((t309:1.756658447,t310:1.736333226):0.01883091177,(t311:0.4005593137,t312:0.3548887653):1.285934599):4.975410063,((t313:1.293706887,(t314:0.2707752065,t316:0.1646606644):1.013714034):2.968856071,(t317:1.575421154,t318:1.424899762):2.538730479):2.346782334):1.659172041,(((t319:3.378513379,t320:3.233019125):0.4781416439,t321:3.673580866):2.410395994,((t322:1.816492434,t323:1.798245477):0.9749109016,(t324:0.7336465378,t325:0.7301089095):2.00084557):3.277665483):1.63239186):1.520336132):0.8596622843,((t326:3.125456439,((t327:0.2587205481,t328:0.252587225):1.964734405,(t329:1.303628974,t330:1.226398057):0.7996764114):0.807156409):2.850371547,((t331:1.520670469,t332:1.436213068):3.076872529,(t333:4.062375159,t334:4.050223817):0.3803126309):0.9260158593):3.768530312):2.789686342):0.6393590384):2.713744552):1.760712417):10.87884654,((t336:6.50601904,((t337:1.522700932,t338:1.210112695):1.656332853,t339:2.81446921):3.285735162):11.43391429,(((((((t340:5.110793656,(t341:1.246040716,t342:1.156361052):3.860172081):0.8254163813,(t343:4.461878523,(((t344:0.2744255743,t345:0.2638714213):2.712507317,t346:2.867864415):0.4543467361,(t347:2.651540367,t348:2.529381236):0.6475645894):0.9086933833):1.273140893):0.1437183623,((t349:2.283617247,t350:2.198799118):1.650328031,t351:3.803853011):1.532297404):0.5238749969,(((t352:3.592891196,(t353:0.7589844367,(t354:0.3699386485,t355:0.3170618198):0.3508312197):2.795221956):0.6330599434,(((t356:1.545581864,t357:1.407716611):0.1335762553,t358:1.517403995):1.474592732,t359:2.910661176):0.8497833209):0.5799297949,t360:4.26205012):0.8288026555):0.6666993481,t361:5.733167604):1.835869047,(t362:2.908492472,t363:2.780371302):4.49498085):3.579495865,(((t364:2.538519545,(t365:1.943027852,t366:1.936513069):0.4008969208):2.366056651,t367:4.515493976):1.750912161,(((((t368:0.3176157603,t369:0.3032032482):0.5193560263,(t370:0.3150252676,t371:0.2703684223):0.4661138279):0.2087304578,t372:0.6839662201):0.2193862812,t373:0.5764687293):1.983241605,(t374:0.176323544,t375:0.1713240363):2.343014681):2.981184303):4.085241426):4.835111736):9.8179732):1.519669508,(t376:9.179663517,t377:8.901955888):16.38047923):33.19448465,((((t378:8.809650097,(((t379:4.784684684,(t381:2.479552363,t382:2.398635528):2.089601123):1.383886043,((t383:2.380122377,t384:2.35346763):1.604150807,(t385:0.8168633781,t386:0.6129940413):3.104018934):1.750385114):1.991016653,((t388:0.295740719,t389:0.1874219631):3.945734156,(((t390:1.925941443,t391:1.758725911):1.331058741,t392:2.870197559):0.001511146575,t393:2.843429465):0.6992172932):3.039607311):0.5427904886):12.38496144,((t394:2.714618515,(t395:2.160310362,t396:2.099529364):0.4465228015):5.686944193,(((t397:0.8173644343,t398:0.8104945194):0.3644658731,(t399:0.2750333838,t400:0.2627702645):0.8913198009):4.821149513,(t401:1.440604219,t402:1.286514856):4.378474752):2.202624845):11.0416172):0.4153986639,(t403:11.65636477,(t404:0.9286561607,t405:0.7468372484):10.72055165):7.316336346):21.51267701,(((t406:6.378097115,(t407:1.969332336,t408:1.96889613):4.314243664):1.991798725,(((t409:4.971109035,(((t410:2.658922521,t411:2.576535415):0.1039020636,t412:2.560290663):1.64380006,((((t413:0.5041547381,t414:0.1326907213):1.202677459,t415:1.260249926):0.486446309,t416:1.6467583):1.281019123,t417:2.875244595):0.7231067672):0.354025861):1.977677736,t418:5.866639173):0.06095088038,((t419:1.030587872,t420:0.9975899174):0.1171486579,t421:1.109963222):4.743745968):1.202374879):28.71123297,((t423:1.63870479,t424:1.619207131):3.607408964,t425:5.066094047):30.16374457):3.01997605):15.16177932):40.84682336,(((((((t426:4.147797529,(((t427:0.4989101956,t428:0.4941401034):0.9311614525,t429:1.402399834):2.494485775,t431:3.74197945):0.1833981808):7.686786539,(((t432:0.4137425022,t433:0.3982182993):2.91374286,(t434:0.5797231308,t435:0.5239680073):2.713994719):7.206187731,((t436:7.225318807,(t437:3.373289626,t438:3.183791642):3.787602858):1.383525982,t439:8.351854038):1.772306414):1.026433058):4.060376865,((t440:1.304457157,t441:1.223348917):12.94952377,(((t442:0.3018652508,t443:0.2105153254):0.6386590211,t444:0.7943888453):10.11444472,(t445:2.527897503,(t446:1.894503109,t447:1.806165838):0.5393113208):8.356550427):3.073080087):0.7906858299):0.06654632853,(t448:2.079011583,t449:1.932327211):12.48168399):0.7364976133,((((t450:0.3569317174,(t451:0.3178627847,t452:0.2306277619):0.03844567721):0.05706122589,t453:0.1406534734):0.2242597357,t454:0.2522306807):3.44361631,((t455:0.7969719748,t456:0.7340199266):2.610960843,t458:3.052243903):0.2755914871):10.95800872):13.65448151,(t460:1.832404421,(t461:0.569665769,t462:0.5621330076):1.092809015):25.88953048):62.10759548,((t463:1.369627413,(((t464:0.3113984772,t465:0.2852318053):0.2332598788,t467:0.1196679111):0.5530066861,t468:0.6446751048):0.1801758444):4.800564703,(t469:2.664359392,t470:2.452888068):2.560228192):83.46197011):1.793876311):112.3217732);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T41.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
