<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t453:2.637344486,(t454:2.086092932,t455:2.038112324):0.5481285415):0.5109280421,(((t456:2.128866483,(t457:0.7183176018,t458:0.703612646):1.388136155):0.4435050131,t459:2.399771189):0.07100269342,t460:2.381255393):0.427831374):3.32460757,(t461:3.785509674,t462:3.719706091):2.303827861):2.514449798,(t463:1.537107765,t464:1.182281747):6.813381198):124.2174094,(((((t465:2.266375005,(t466:1.285224388,t467:1.214674388):0.9468326706):18.43651612,((t468:1.229997587,t469:1.153109042):1.763757606,(t470:0.2328753356,t471:0.2298001508):2.588713702):17.54997913):11.89979774,((t472:6.579723385,(t473:6.059853223,((t474:0.2415418148,t475:0.2315241301):1.398454543,t476:1.535466446):4.372353776):0.4394286127):7.262162164,t477:13.5822904):18.23014016):7.849319374,((((t478:0.5456634892,t479:0.4290892796):6.353341312,(t480:0.1827811525,t481:0.13102597):6.474178197):25.97563375,(t482:20.00445545,(t483:0.9160784826,t484:0.7656198385):19.04852394):12.55962981):4.734303309,((t485:5.141893341,t486:5.08470544):17.32662639,(t487:11.20462581,(t488:4.808390458,(t422:0.02794126986,(((t381:0.01742624809,((t335:0.08928896684,((t318:0.03547016543,((t246:0.1426564829,(t243:0.1089817993,(t237:0.03416330905,(t191:0.009079091191,((((t44:0.1513809546,(t33:0.02785427442,(t1:1.786047916,t2:1.685578622):1.962519478):1.491407025):1.721641023,t3:6.450800884):4.009809905,(((t4:6.449752467,t5:6.44833781):1.688410001,((t6:7.024547731,((t7:4.160079,t8:4.128373215):0.1165290797,t9:4.165185152):2.46384012):0.6949409924,((t10:2.245585134,t11:2.029726764):3.145727437,(t12:1.055362281,t13:0.9179143837):4.065608778):1.738581125):0.2976808009):0.489531558,t14:7.301655637):1.823760955):6.676488986,((t15:1.262053781,t16:1.250004305):7.671304655,((t17:5.041133466,t18:5.027786012):1.906692047,(((t19:3.661623424,(((t20:0.3183758597,t21:0.1783368125):2.00130582,t22:2.107032472):0.06388194409,t23:1.950027895):1.23492416):1.351051565,t24:4.461606604):0.3051725816,(t25:0.5664854147,t26:0.4252688973):4.120709583):1.370392795):1.921300076):6.839138558):0.6274242143):4.79060246):0.5179748728):0.277679383):6.693057702,((((((t27:9.662541224,(t28:8.46973888,((t29:4.978381599,(t30:4.089131063,t31:3.987223078):0.8316716603):0.6317280433,t32:5.427034696):2.839648352):1.025612556):2.741375789,((((t34:2.286218843,t35:2.150889268):1.939417166,(t36:3.184669417,(t37:0.5677886363,t38:0.3485745462):2.427398429):0.889665008):1.715408739,t39:5.24130733):5.266366431,(((t40:1.031428089,t41:0.9146557148):0.8993712116,(t42:0.9989512521,t43:0.7970716669):0.7579314501):2.580163686,t45:3.905288582):5.812496824):0.5444297787):0.8671010657,(t46:10.46125697,(t47:7.155311935,t48:6.805265328):3.228170423):0.5064342282):3.945991757,((((t49:1.344432446,(t50:0.2845021381,t51:0.2586054617):1.015831772):3.903996911,((t52:2.734889344,t53:2.619128754):1.06144973,(t54:0.8936461212,t55:0.7922954379):2.772535739):1.366371988):5.271683214,((t56:1.992947817,t57:1.928170106):3.67829784,(t58:3.703012786,t59:3.658719125):1.779426983):4.34699062):0.5341091303,(t60:8.83876723,(t61:8.525648843,((((t62:1.828802472,(t63:0.2044726428,t64:0.1005546949):1.598820794):1.424153589,t65:3.036949061):0.4088693336,(t66:1.262863581,(t67:0.0983259506,t68:0.09022203883):1.018791916):2.117345393):0.3957837053,t69:3.45705602):4.380207718):0.1959522251):1.463171089):3.339294524):0.3270712893,((t70:1.500756189,t71:1.422969722):0.6157740109,(t72:1.059672259,t73:1.021282366):0.8254793606):11.03784469):9.139026378,(((((((t74:7.341315859,(((t75:1.773374141,t76:1.659031693):0.8243206582,((t77:1.327830365,(t78:0.2198454644,t79:0.183576323):1.091433601):0.7254259531,((t80:1.311786656,t81:1.251725079):0.2410713523,t82:1.315788257):0.2739003912):0.3821064027):4.243228417,(t83:3.5399421,(t84:1.594215004,t85:1.553192125):1.783231801):2.342034272):0.4877878068):4.134422234,((((((t86:2.941702716,t87:2.890328516):0.4532744404,((t88:0.37085414,t89:0.363633359):2.314370315,t90:2.645494962):0.5701189542):3.256722982,(((t91:0.02076546422,t92:0.008769929809):1.175011002,t93:1.173458498):4.19027137,(t94:3.984241941,(t95:3.277546448,t96:3.244605613):0.5894489372):1.319509756):1.030104822):0.01416754505,(t97:2.339350766,t98:2.084532632):3.740997116):1.379786611,((t99:1.314810924,t100:1.220601679):5.439404105,t101:6.627674105):0.3486178491):1.391527887,(t102:5.033374138,t103:5.02281936):3.331178624):0.7409027016):1.001238292,((t104:1.105678584,(t105:0.7219823486,(t106:0.5757810719,t107:0.5535383656):0.1412949213):0.3426022709):4.288840343,(((t108:1.702569516,t109:1.611299295):0.9206706967,(t110:0.5012526543,t111:0.3979554272):1.782371915):1.992166913,(t112:1.209919383,t113:1.123178703):2.81168132):0.6849179892):4.692068699):2.188794999,(((t114:8.135862645,((((t115:2.892797748,(t116:1.014964571,t117:0.8541741177):1.86028897):0.2974233892,(t118:0.8813696894,(t119:0.04897164527,t120:0.005563247221):0.6559279903):1.926171807):0.285539237,t121:2.56122004):1.152151271,t122:3.691082618):3.27114047):0.8263174516,(t123:3.934301427,(t124:0.2132414369,t125:0.07249914244):3.660774341):3.848328918):0.788579408,(t126:2.811648002,t127:2.785978961):5.528834298):1.693228456):1.96860768,(((t128:3.677963997,(t129:0.8197773153,t130:0.5600276993):2.689512961):3.906429844,t131:7.127629813):3.385600066,((t132:1.970738614,((t133:0.1462627418,t134:0.1427782072):1.173298007,t135:1.226793623):0.4254440273):4.205073543,(t136:5.277874216,((t137:0.6914693093,t138:0.6529529145):1.924315993,t139:2.562709021):2.425709086):0.3888546501):3.92510675):0.9111925714):3.623353193,((((t140:4.543114574,(((t141:0.605899062,t142:0.3792981654):0.8540573987,t143:1.186895408):2.183871446,((t144:1.041237138,t145:0.9017221539):0.8892415622,(t146:0.9797111534,t147:0.9714058687):0.7858297507):1.424728623):0.8460695445):0.8039061911,t148:4.790286464):0.4187627196,t149:5.183818544):2.84195715,t150:7.923880094):5.023743663):0.428414475,((((((t151:1.27794489,(t152:0.7541708649,t153:0.7493174431):0.4642261684):0.3551075711,t154:1.561450488):4.503526342,(t155:2.716845468,t156:2.644026599):3.28498349):0.7063812321,(((((t157:1.699301824,(t158:0.4708741992,t159:0.4264904853):1.150370787):3.868203912,t160:5.41173461):0.118700937,(t161:4.391106968,((t162:2.559725297,(t163:0.8918523106,(t164:0.1033957934,t165:0.05819101983):0.6932697398):1.603165061):0.1079019938,((t166:1.53763953,(t167:0.9618238327,t168:0.8570387815):0.5514180046):0.4282788424,t169:1.567953496):0.3276965345):1.652627666):1.138782324):0.01542348325,(((t170:1.545782081,(t171:0.2180598132,t172:0.1426925604):1.307397186):2.616376481,t173:3.981099326):0.0006639050394,t174:3.97997205):0.3379241938):0.1330539047,t175:4.432600524):0.776782586):0.1223564325,(t176:4.117482304,((t177:2.273847553,t178:2.151422181):1.09241263,((t179:0.962097952,t180:0.9168325918):1.533994348,t181:2.302242826):0.5377504776):0.7379970767):1.092036145):4.398898558,((((t182:1.594223203,(t183:0.3682533144,t184:0.3359033009):1.103647767):0.6311975938,t185:1.875889435):3.934852976,(t186:3.42595517,(t187:1.552186513,(t188:1.280942562,t189:1.276497416):0.2710621126):1.839756064):2.370437415):2.164404674,(t190:2.83599647,t192:2.670830721):5.057044419):0.6466555295):1.863347454):1.299286923):0.7257570309):1.44948547):1.412296492,(((t193:2.851887463,t194:2.691714991):0.3499920424,t195:2.902918546):7.133512067,(t196:1.881016237,t197:1.822808951):8.12354388):4.727756664):0.1520716014):2.173532026,((t198:7.284137572,t199:7.259488193):4.811810146,((((t200:2.914690865,(t201:2.478617323,t202:2.46905067):0.2486480899):4.394073279,(t203:2.502720916,(t204:0.1384213883,t205:0.1335529731):2.014869978):4.350245276):1.177877886,(((((t206:3.762320379,((t207:0.2839982215,t208:0.2063746782):0.1585849243,t209:0.2936383838):3.263840452):0.6307287082,t210:4.180768356):0.505253223,t211:4.650386081):0.8938205251,((((t212:0.4970235832,t213:0.3618370675):1.249382969,(t214:1.36324767,t215:1.295257548):0.2331296885):2.466408407,t216:3.861149662):0.5938171195,((t217:0.6955141055,t218:0.4092771804):2.552226977,(t219:1.978211776,t220:1.967861271):0.9445775132):0.8204629828):0.6678341926):1.478038264,(t221:1.581654777,t222:1.374145254):4.296177904):0.3568228772):2.424052579,(t223:7.171299117,((t224:3.188157868,t225:3.186117309):3.73369776,t226:6.834695415):0.1653690076):1.074918667):1.03301283):4.900911157):2.485581052):2.804008506,(((((t227:9.933884484,(((t228:0.2508185749,t229:0.107971199):2.179138103,t230:2.266558168):1.693060072,t231:3.938450891):5.801972455):4.288820356,((((t232:2.248125127,t233:2.061295365):3.648484722,t234:5.614476942):4.506576868,(((t235:4.231378179,t236:4.114135911):0.07871706543,(t238:1.193355076,t239:1.109340178):2.675424977):3.570650736,(((((t240:1.240285225,t241:1.227631165):0.3006721036,(t242:1.13948103,t244:0.9758968876):0.3393864308):1.389729299,t245:2.640078736):0.003137511318,t247:2.432838823):1.881300095,t248:4.313818479):2.484994627):1.931510201):0.6067828498,((t249:3.774014093,t250:3.707821742):5.069645201,(t251:7.659319328,(t252:7.464754103,((((t253:1.686768582,t254:1.678218692):0.1624808536,t255:1.79500061):0.7412639817,t256:2.346572729):1.929494013,(t257:0.3469125131,t258:0.2324067793):3.879693681):2.901091808):0.08841790933):1.066819526):0.3590806831):2.852700889):0.8833939179,t259:12.21751612):0.6699238578,((t260:2.787764803,(t261:2.272728058,(t262:1.955670284,t263:1.813710631):0.2168248593):0.48738992):8.085295804,t264:10.34685084):1.848406513):0.6776557202,((t265:4.689802037,(t266:0.3103478554,t267:0.09080296092):4.357160964):7.674825049,(((((t268:0.3785409792,t269:0.3567874133):2.704806452,(t270:0.3591855709,t271:0.3432581276):2.657105152):5.515244617,((t272:6.083050373,(((((t273:0.4856033554,t274:0.396924472):0.3246623741,t275:0.6578352678):0.009003582391,t276:0.5491399521):4.198895866,t277:4.385943476):0.3454500126,(t278:1.675707965,t279:1.674023647):2.987245893):0.6743841905):1.952920101,t280:7.196692911):0.4704141514):2.447454869,((t281:2.728707474,t282:2.689719932):5.864426362,((t283:6.610316871,(t284:1.527273811,(t285:1.368041221,t286:1.318123542):0.02776846654):5.010451041):0.190355246,(((t287:0.8708400657,t288:0.7604502417):1.133681076,(t289:1.048279562,t290:0.9867145972):0.8443847174):1.444936454,t291:3.272256077):2.82240719):1.702590583):1.482450291):0.115186353,(t292:4.183249898,t293:3.923173455):5.140933415):0.9518769126):0.3446018479):2.741811635):0.7412996527,((t294:10.18314332,(t295:7.426017208,(t296:0.481918634,t297:0.4625870404):6.922893517):2.729261034):1.763812835,((((((t298:2.71252137,(((t299:0.3872516537,t300:0.3453092147):1.366703195,(t301:0.7622288065,t302:0.7321304502):0.8659997546):0.4269852469,t303:1.961545878):0.4450876048):3.003910177,((t304:0.8635554856,t305:0.5855280708):1.602074675,t306:1.741386507):2.684456664):0.472475736,((((t307:2.391118842,t308:1.940534561):0.08939800093,((t309:0.2130257889,t310:0.179823551):1.085027619,t311:0.8663875042):0.7265145732):0.2572118839,t312:1.639778588):1.561832518,(t313:2.893640491,(t314:2.180063124,t315:2.104594759):0.4100258118):0.1553621124):0.2192362975):0.6627572893,((t316:2.254001684,t317:2.160135101):0.2668524234,t319:2.262921732):0.7126360767):3.609534271,((t320:1.269657486,t321:1.26856674):4.190727417,(t322:0.1400745332,t323:0.1015866639):5.139993547):0.9806503497):1.097537069,(t324:2.098976628,t325:2.068113458):5.030735666):0.2563904053):1.804075655):0.3098837945):10.61177283):6.207221035):10.55091989):14.26468885):1.922643267):43.44385285,(((((t326:1.688652926,(t327:1.234165351,t328:1.144285133):0.4324274013):7.450783551,t329:8.789726901):4.322358065,(((t330:9.403334477,(t331:7.0639938,(t332:3.092395289,t333:3.071939405):3.970702682):2.207871862):1.549846286,(((t334:1.694254786,t336:1.537417342):4.347404747,t337:5.495450716):1.903961481,(((t338:1.779662294,t339:1.777348414):3.90574162,(t340:3.36811667,((t341:0.6521809603,t342:0.615333294):2.451782034,(t343:1.545961161,(t344:0.5972503825,t345:0.3920052965):0.9392746336):1.399813892):0.2413665768):2.29143119):0.7158453539,(((((t346:0.2761854572,t347:0.0250588181):1.926766115,t348:1.890682761):0.4142479421,(t349:0.6217303763,t350:0.5688664054):1.681611232):2.058958452,t351:4.225292447):0.4421853681,t352:4.372841992):0.8516143918):0.6353888562):2.595178227):1.821466745,(t353:1.786844059,t354:1.774797354):8.435659288):0.2735581847):2.520409149,t355:12.95874262):12.0344259,((((((t356:1.814940122,t357:1.765763906):1.431391,t358:3.173314108):3.284512586,t359:6.273219233):3.430207623,(t360:0.6642716457,t361:0.4707731711):8.941499638):1.218587233,((t362:7.906464692,(t363:0.4429105326,t364:0.3610683569):7.409520211):2.002744788,(t365:3.833556801,(t366:3.402737217,(t367:1.906642221,t368:1.718744383):1.417568867):0.2929072814):5.813375064):0.56585087):4.701425309,(((((t369:2.08566304,t370:2.000061012):0.3205509909,t371:2.143517351):0.6142572376,t372:2.607021976):2.753236368,t373:5.315666786):4.895617214,((t374:8.249513043,(t375:7.241266446,((((((t376:2.278940674,t377:2.22284043):0.04652287779,((t378:0.7780946767,t379:0.6022522691):0.1587977732,t380:0.5828568628):1.327409748):0.6798258512,(t382:0.06763116988,t383:0.01620796668):2.448384034):0.8184788687,t384:3.240484939):1.100216397,(t385:1.257943903,t386:1.214377598):3.07336624):0.1488170778,((t387:1.618270955,t388:1.34197358):0.757509631,t389:2.006906336):1.844070097):2.150809366):1.001866653):0.6427206367,(((t390:0.8301304186,t391:0.6344863026):0.4313231727,t392:0.7851030152):1.222982497,t393:1.94981954):5.097251457):1.290147372):3.807155655):8.896971539):68.43269751):48.29037143):231.1320733,((((((((t394:2.232694452,t395:2.199485839):1.512991166,(t396:0.7593167724,t397:0.7252225966):2.868757612):0.1423882987,(t398:2.419004295,t399:2.249225624):1.285289342):0.6832666048,((t400:2.222023266,(t401:1.214132354,t402:1.151032992):0.9929330848):1.717589906,(((t403:1.034421153,t404:0.8885460841):0.03087485646,t405:0.627868321):0.660986439,t406:1.210044342):1.983348376):0.2169776648):2.63450973,((t407:3.361520605,(t408:1.402083824,t409:1.364774762):1.94738177):1.73831907,t410:4.818800237):0.8578535808):1.271501208,t411:6.918094618):8.171491077,(((((t412:0.1371228279,t413:0.1139107829):6.1081085,(((t414:1.682050007,t415:1.549505553):0.09558236468,t416:1.48493568):3.205541003,((t417:3.642711867,(t418:0.1340738134,t419:0.1280551231):3.397881384):0.4652300789,((t420:1.383885438,t421:1.357621159):1.370914127,((t423:1.029373066,t424:0.9889011861):0.6717132182,t425:1.629807504):0.6662769248):1.194794654):0.5750206988):1.207958148):1.906606994,t426:7.103046956):2.726386553,(((t427:5.364090381,(t428:0.6657174287,t429:0.6562994315):4.670221126):0.5510812727,(((t430:1.924499849,(t431:0.5941139755,t432:0.4838000947):1.306253782):0.9375735301,(t433:0.6981328721,t434:0.697394506):2.008388958):0.02261098725,(t435:2.237613464,(t436:1.037886119,t437:0.9612916869):1.194004658):0.3478421794):2.934887339):2.070870218,((t438:4.70513576,(t439:0.5652080214,t440:0.5259174787):3.864355222):1.548150023,((t441:1.154463577,t442:0.9521267683):1.76920452,(t443:0.7471905667,t444:0.6912410719):1.855173531):2.993775174):1.253777235):1.711217959):2.977146781,(t445:5.642141566,(t446:2.062754452,t447:1.977956759):3.541773296):5.709424167):1.211039921):8.115760017,((t448:1.349567407,(t449:0.3986410958,t450:0.349962693):0.9442992363):6.745915597,(t451:3.37710701,t452:3.365624183):4.600358976):12.34768111):344.1189131);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T48.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
