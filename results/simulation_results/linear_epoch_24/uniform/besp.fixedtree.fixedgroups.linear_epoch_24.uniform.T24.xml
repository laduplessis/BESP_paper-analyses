<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t452:4.759792366,((t453:2.27997899,t454:2.115892749):0.3598075134,t455:2.2206539):2.092838211):20.95322417,((((t456:0.4050236446,t457:0.318788859):0.04649015248,t458:0.1504103244):0.2884907064,t459:0.3279140018):3.39145991,t460:3.380229093):21.11971919):19.20735885,(((t461:0.2680242981,t462:0.2274372589):16.82131642,t463:16.97045932):8.434847951,(t464:1.37186328,t465:1.360355236):23.82772319):18.12288573):2.528868456,(((((t466:0.8809195819,t467:0.8783545035):4.321045157,t468:4.94497775):0.2711707053,t469:5.148317987):1.894229959,(((t470:0.8273111996,t471:0.8265539291):2.27838457,t472:3.000962444):2.613576765,(t473:0.6138689012,t474:0.3461000646):4.80821851):1.089284021):18.4740008,(((t475:1.325368437,t476:1.305704793):1.439016738,(t477:1.993292374,t478:1.991817093):0.6479937827):4.86749969,t479:7.457788685):16.99125409):19.95846471):191.2658016,(((t480:10.33073959,((((((t372:0.02021857915,(t344:0.1993104604,((t339:0.01757850822,((((t310:0.1974785021,((t260:0.3154119964,((t179:0.08715191254,(t123:0.08035508817,(t112:0.1045358248,((t83:0.05295131656,t1:8.40749773):0.852870196,t2:9.080970396):2.61329597):1.25721756):4.777463921):7.286369108,(((((((t3:5.266701462,t4:5.095437879):0.1443853863,t5:5.076590605):4.543339006,(((t6:2.355781972,t7:2.283143031):6.795023923,t8:8.876052793):0.05100866101,t9:8.900301321):0.3067747913):4.068551578,((t10:7.787324558,t11:7.699097593):5.126321115,(t12:7.544676175,((t13:1.022026069,t14:0.7554461821):0.7198459777,t15:1.464452355):5.771792901):5.236646346):0.2127349843):3.510840783,(((t16:3.232842777,t17:3.134887171):0.4314334298,t18:3.266201268):3.383722071,(t19:0.307082324,t20:0.1890883834):6.270116277):9.06364117):2.000802746,((t21:7.135052073,t22:7.102039549):3.853411442,t23:10.93582472):6.436254387):2.690403368,(((t24:8.423467349,(t25:1.4712441,(t26:0.6656075306,t27:0.6247763965):0.7572537488):6.836734137):4.427633385,((t28:6.806083471,(((t29:0.4091410433,t30:0.3835652113):0.9775123528,t31:1.349050591):0.1223594504,t32:1.401731601):5.213803574):1.108666021,(((t33:3.617200157,t34:3.4640264):0.9805559442,(t35:2.018425027,((t36:0.5085395849,t37:0.4927425347):1.237530886,t38:1.571363492):0.2543715388):2.406948626):1.824569909,(((t39:1.354188137,t40:1.345131012):2.721366648,((t41:2.32011902,(t42:2.067681639,t43:1.925676267):0.1534670932):0.002637368548,t44:2.062801579):1.142770791):0.540040921,t45:3.70748319):1.388702469):1.249679131):4.699474121):4.383052534,((((t46:7.103089977,((t47:0.455856487,t48:0.4156730676):0.1114834538,t49:0.5246568377):6.201637524):2.862856775,((((t50:0.8746184131,(t51:0.6614269283,t52:0.5065775323):0.1592846692):1.593900728,t53:2.210718607):3.286699422,(t54:4.033462057,t55:4.025710113):1.411115618):0.9239637812,(t56:1.121742991,t57:1.104586084):5.163522653):2.868421234):2.436975982,(((t58:0.9556953018,t59:0.7481413233):5.196404206,(t60:0.6330307086,t61:0.4672886722):5.275434015):0.7371453296,((t62:1.269549259,t63:1.229751018):4.4209807,(t64:0.260843564,t65:0.2276493872):5.184187713):0.7612035261):4.596978666):1.551466059,(((t66:0.7575760054,t67:0.3621567919):2.895788061,t68:3.041906943):7.365672496,((t69:5.447053248,((t70:0.4791373776,t71:0.4452773209):3.149657064,(t72:0.6370362809,t73:0.5606571018):2.780146573):1.697730849):0.8308160311,t74:5.605705098):4.120485913):1.085227361):1.423625546):2.727296175):2.731449207):1.87756043):4.92923767,((((((t75:5.063902165,(t76:0.5390266191,t77:0.2832749479):4.437871052):8.554526002,(((t78:0.2168794689,t79:0.1557633011):10.781434,(((t80:1.989815975,(t81:0.5642543104,t82:0.5451600439):1.402617015):2.785788915,(t84:0.9328944326,t85:0.8798082435):3.57017477):0.1087991834,t86:4.433912989):6.025516263):0.2575958961,(((t87:1.513811393,t88:1.485755):5.301929585,(t89:0.3716273221,t90:0.2146113326):6.345763341):2.194569742,(t91:0.5287040675,t92:0.4686469648):8.090235877):1.694986072):1.904430862):7.462864794,((((t93:5.197341772,((((((t94:0.8524459597,t95:0.6908702297):1.174202495,t96:1.744216907):0.628595628,t97:2.316397704):0.2112749485,t98:2.488595409):0.832496113,t99:3.282572264):0.8944893526,t100:4.100790589):0.5600728939):1.53164742,t101:5.92826043):7.594586513,((t102:3.241991301,(t103:1.260967818,t104:1.189177972):1.828591926):5.722447969,((t105:4.797858598,((t106:0.9672229935,t107:0.352307528):3.426178403,(t108:0.6958876546,t109:0.4333954435):2.89724887):0.3528138438):0.3738336578,t110:4.016769754):3.517052208):4.47571391):3.905971436,(((t111:0.8024225846,t113:0.3626742071):10.87349151,t114:11.09193604):3.580236212,(((((((t115:0.1757187499,t116:0.1118068393):2.511048946,t117:2.538344213):2.946013475,(((((t118:2.495861504,(t119:0.1460359333,t120:0.03941871677):2.261386958):0.4572114401,t121:2.638742206):0.1484877939,(t122:2.69644777,t124:2.460318024):0.02437559476):0.2544672368,((t125:0.2563602165,t126:0.2462583799):0.552034275,t127:0.5434903803):1.922011893):0.5177980544,t128:2.953310927):1.602070434):2.181469434,((t129:2.975196073,((t130:0.01453611836,t131:0.010072659):1.346546035,t132:0.9054923825):1.606160589):0.2629916363,(t133:0.6831174828,t134:0.508566495):2.085489582):3.41256911):4.059798783,(((((t135:2.192780899,t136:2.098738963):1.610768593,t137:3.643936625):2.193089132,t138:5.795562461):1.598183693,(t139:1.607252956,t140:1.582691653):5.764317049):1.321338036,((t141:5.52269124,(t142:0.6109535421,t143:0.5137939711):4.858825192):0.1972746208,((t144:4.535077147,((t145:0.1877954217,t146:0.1506625722):2.72004952,t147:2.797025746):1.57007035):0.6100180216,t148:4.92108549):0.4056695766):2.824025816):0.8827262574):0.9608492407,(((t149:3.396369806,t150:3.367814519):0.1937643322,t151:3.555232744):1.949716682,t152:5.417282959):4.446744469):0.09201368808,(((t153:4.793568256,t154:4.657712545):0.05257444879,(t155:1.466418432,t156:1.38288432):3.207074072):2.820524048,(((t157:1.011494564,t158:0.9735959653):4.368389467,(t159:4.50035775,(t160:0.5544184789,t161:0.4996122492):3.818876888):0.7282556431):1.813247138,(((t162:3.759488157,t163:3.756700931):0.674776735,(t164:0.6561287014,t165:0.604881758):3.742176946):1.963937733,(t166:2.958285352,(t167:2.010236498,t168:1.586297449):0.8876136467):3.196213826):0.4611698129):0.09149616308):2.257829413):1.6183516):0.4802761331):1.33251202):0.04074550606,(((t169:0.491892962,t170:0.1563957075):2.573666974,(t171:1.877490331,t172:1.780294815):0.8254117279):4.537127916,(((t173:0.5197961501,t174:0.4690385645):1.907321655,t175:2.353117938):3.667224887,t176:5.865672902):0.9696118036):4.220478876):1.574091034,(((t177:2.48065391,t178:2.4585816):3.598769036,(t180:4.022726752,((t181:0.338422352,t182:0.1983810505):3.008882007,(t183:2.810322348,t184:2.707884533):0.3124273254):0.6153954011):1.912958599):4.710876343,t185:10.24218183):1.780985566):0.1600062682,((((t186:0.1640641655,t187:0.1529688168):3.684023198,(t188:0.7284761048,t189:0.5485036727):3.011476735):1.987196672,((t190:3.724740737,t191:3.651827504):0.8704716528,(((t192:1.11600848,t193:0.8593522016):1.023562735,t194:1.868881046):1.106681241,((t195:0.7198793763,t196:0.688886249):0.6725999281,t197:1.035635532):1.570622456):1.194579855):0.941443274):5.755468892,(t198:4.877060445,(t199:2.854688717,((t200:0.2400820822,t201:0.170861638):1.649805138,t202:1.784104879):0.9036199387):1.879927195):5.585343173):0.3875676484):1.480275204):0.3159026041):1.504322269,(((((t203:5.776902282,t204:5.706350509):0.4071009996,(t205:3.079616122,t206:3.031619295):2.784596153):1.548273181,((t207:0.2461100035,t208:0.1355883843):6.065480831,t209:5.985304123):0.9329334202):0.1138433079,t210:6.545928105):3.736929782,(t211:7.026253617,t212:6.95542906):3.017296781):2.209938588):0.787028298,((t213:0.2924075122,t214:0.2491019922):8.449177417,((t215:7.649834919,t216:7.625550759):0.4165842941,((t217:2.783727174,(t218:1.547871968,t219:1.489925315):1.14028866):3.426794899,(t220:1.779501672,(t221:1.719353656,t222:1.64435859):0.04240500671):4.179617342):1.447074688):0.5881751311):3.980324556):0.1469692554,((t223:4.264182606,((t224:1.970350151,t225:1.892044674):0.8764201736,(((t226:0.5770375215,t227:0.5023108677):0.5480872853,t228:0.7894407425):0.4670457506,(t229:0.9778098826,t230:0.853842696):0.1506820243):1.090421508):1.328047328):7.674696182,(((t231:1.078392246,t232:1.045462989):1.400786137,t233:2.387517514):3.303521506,(((t234:1.214922033,(t235:0.7253599252,t236:0.481337194):0.4712101386):0.06235500266,t237:0.9649927073):2.487162096,t238:3.4077818):1.903828546):5.295524858):0.08181987938):0.4376776017):0.1680617821,(t239:9.636390196,t240:9.537609914):1.615514049):0.2344026029):2.819763336):2.448895921,(((t241:6.95171822,(t242:2.321709176,t243:2.260694663):4.600072257):6.579409506,((((t244:2.37450135,t245:2.094011478):1.186044459,t246:2.782613646):6.007862479,((t247:5.083095508,(t248:4.307584665,t249:4.190984607):0.6982281904):0.4047753912,t250:5.288352999):3.277903736):3.648352856,(t251:0.8271313288,t252:0.8154007706):11.26007365):0.1880590159):0.9617020262,t253:13.06775119):1.999323624):0.01270999733,((((t254:0.64555969,t255:0.5515673408):1.447074969,t256:1.77329448):7.821059456,((t257:3.803881666,((t258:1.484688522,t259:1.322305874):1.50647681,t261:2.322914579):0.6712578106):1.547093064,t262:4.475340436):4.161705642):4.801001803,((((((t263:1.403306531,(t264:1.108866985,(t265:0.2373779314,t266:0.213272465):0.4575072586):0.281778973):1.666702599,(t267:2.123480366,((t268:0.3883777016,t269:0.3339870299):0.315064839,t270:0.5489009317):1.335517592):0.4667172835):2.505591303,t271:4.853952877):1.889788362,t272:6.655321106):0.7121757284,t273:7.338598144):1.694202879,((t274:2.112245355,t275:1.872337551):4.885273242,(t276:6.643372932,t277:6.584683995):0.05507581716):1.996717025):3.535941229):0.2147145271):3.193769653,((((t278:2.723337721,t279:2.570393457):2.427779042,((t280:1.044811184,t281:1.010626943):0.4052988819,t282:1.397958677):3.453943373):0.7020169944,(((t283:0.2630821037,t284:0.2435336857):4.275668617,t285:4.500787833):0.6291307162,(t286:3.601281634,(t287:1.701146251,t288:1.655581509):1.857061829):1.108318566):0.2202093521):7.52004013,(((t289:4.904691797,t290:4.904015517):1.544269926,((t291:0.9959809967,(t292:0.3956992892,t293:0.3589791604):0.4295618944):2.28615589,t294:3.046612759):3.136275865):3.648128227,((t295:1.018650419,t296:0.9930410281):5.340371272,t297:6.249246921):3.041457457):2.223154014):2.065789162):6.63832471,(((t298:1.932266977,t299:1.773329737):3.468323031,(((t300:0.1007819392,t301:0.03885023689):3.904604479,(t302:2.391029771,t303:2.375664772):1.377024941):0.8773109165,t304:4.627702952):0.3428401363):3.112503685,(t305:4.084052878,t306:3.958915989):3.89436633):11.47675324):4.178219406,((((((t307:0.9020006492,t308:0.7336108268):7.185497453,(((t309:4.956171971,(t311:2.406691581,t312:2.290931604):2.177433513):0.6820633232,t313:5.038297525):0.5775468886,t314:5.598162533):1.30706842):4.377906036,((t315:0.1782607549,t316:0.1747403482):6.44940246,t317:6.455868292):4.540600392):2.816406838,(((((((t318:0.6137697443,t319:0.3611336442):3.02978972,t320:3.350824171):2.899739901,((t321:0.08463330677,t322:0.05359417078):0.2345908177,t323:0.253604999):5.683468369):1.910473782,(((t324:3.866914152,((t325:1.570386794,t326:1.484720162):1.010752628,(t327:1.895688669,(t328:0.5750386881,t329:0.507305295):1.09698017):0.5537622513):1.269917753):0.0944446304,t330:3.389160657):2.665600584,(t331:3.328054962,t332:3.053003766):2.718748483):1.197500125):1.514873483,((t333:2.843348604,(t334:2.125302764,t335:2.041701405):0.4897286896):5.283963221,t336:7.688286665):0.3199478736):0.9185010743,((((t337:2.216538413,((t338:1.027271249,t340:0.9420984486):0.0770465042,(t341:0.7680301762,t342:0.7318788062):0.1837888515):1.105484913):1.423891881,(t343:1.425720711,(t345:0.191763683,t346:0.1220462804):0.9331698302):1.984439764):0.6328523732,((t347:0.7118684808,t348:0.5901488509):2.898209603,t349:3.486275412):0.04894688111):0.6506039717,(t350:0.3274510996,t351:0.2871771082):3.735659243):3.931142509):2.020924274,((t352:6.782795504,(t353:3.760603076,((((t354:1.293393246,t355:1.182067765):0.9455492713,t356:1.838186904):0.04589262387,(t357:0.7977742467,t358:0.7960775223):0.9086330922):0.9537697749,t359:2.528776043):0.3552749671):2.850025222):3.028523633,((t360:1.595075517,t361:1.502266568):3.647284135,((t362:1.67334452,(t363:1.225527432,t364:1.186035864):0.415535025):0.4736553563,t365:1.951387612):2.944251166):3.098056603):0.1206190198):0.7384755937):1.765530809,((((t366:3.487174565,((t367:0.3630771456,t368:0.2590228455):0.5416177752,t369:0.7699020327):2.574627571):0.08254134187,((t370:1.688319635,(t371:0.5394372688,t373:0.385834799):0.9679110666):1.079690285,t374:2.403083061):0.643382598):2.618205856,(t375:1.95993298,(t376:0.03662708163,t377:0.03418958507):1.918092513):3.394140207):2.699093797,(((t378:3.833214111,t379:3.749523099):1.434426117,((t380:0.9510075117,(t381:0.543697746,t382:0.5329247662):0.3183410166):4.024624949,(t383:1.624135231,t384:1.567579844):3.224481458):0.09465005807):0.7667812373,((t385:0.2234472838,t386:0.1442097995):1.148220701,t387:1.287621546):4.105259301):2.006780113):1.649970391):4.499926155,((t388:6.958138516,(t389:6.245250466,((t390:1.297374905,(t391:1.189377221,t392:1.184868509):0.08479111128):3.983990251,((t393:0.6334765438,(t394:0.06522993821,t395:0.03360750837):0.5032682929):3.810066076,(t396:0.6201576994,t397:0.5160922485):3.65024154):0.8086142832):0.9575525108):0.6979875905):3.154568979,((t398:8.51681482,((t399:5.501406634,t400:5.49934451):0.7717668787,(t401:5.948914308,t402:5.847800694):0.2084861147):2.151092101):1.021626082,(((t403:2.34305551,(t404:1.457051221,t405:1.442738966):0.8764712478):2.152369811,t406:4.425864289):1.298523022,t407:5.495207839):3.358073597):0.1067617767):3.401055029):1.849375862):3.225527815):18.1708658,(((t408:8.247532194,(((t409:1.587078188,(t410:0.09747021147,t411:0.03944496732):1.390790804):1.597147699,t412:2.850116525):2.693020944,(t413:0.8968807108,t414:0.7979754687):4.619868471):2.252495518):0.3005251285,t415:7.86148528):3.668763803,(((t416:1.758735591,t417:1.396460348):2.707598113,((t418:0.3864483486,t419:0.3584420697):0.5719478568,(t420:0.09029186511,t421:0.05168423563):0.8002140543):3.029719002):5.486410113,t422:9.213139879):1.512824228):23.38607927):8.782394028,((((((t423:3.168179172,(t424:0.396297927,t425:0.3275223193):2.731204473):0.9266905381,((t426:0.5677292944,t427:0.5423897883):2.293105908,(t428:0.7703383286,t429:0.7416928392):2.065016744):1.068136092):0.4479389023,(t430:2.790509085,(t431:2.324416795,(t432:1.477904815,t433:1.403959422):0.6160750344):0.3169851684):1.478899309):4.258410333,((t434:3.500148344,t435:3.477611513):2.045666378,(((t436:0.3122611222,t437:0.2321302555):3.831008449,t438:3.929663214):0.8898400781,(t439:0.7375264086,t440:0.627254315):3.987380721):0.3158635239):2.421433219):6.735043334,(t441:7.685238575,(t442:3.290472767,(t443:0.8672491153,t444:0.7933028349):2.422687142):4.245632668):6.380455595):17.82248137,(t445:9.439122435,((t446:3.485057863,((t447:1.871790236,t448:1.858612027):1.268152883,t449:3.126568736):0.2892072934):3.676749383,(t450:5.108133011,t451:4.788714813):1.852821541):2.136944279):22.2048136):9.432798146):198.3144564);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T24.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
