<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t404:10.27424755,(t405:9.864492503,((t406:6.476509764,(t407:4.787352501,(t408:4.237232842,(t409:3.008112711,t410:2.941830596):1.227314647):0.5015188951):1.622179251):0.431199842,(t411:1.132705693,(t412:0.9518372621,t413:0.8415076588):0.09975893848):5.487968443):2.759513008):0.1649218326):47.39229173,((t414:1.469859318,t415:1.338031163):2.286035667,(t416:0.8956182437,(t417:0.6084065006,t418:0.509373565):0.1008170018):2.718558123):52.85646067):99.62500144,(((((t419:7.77783272,((((t420:0.4896836319,t421:0.3627929707):0.8489100957,(t422:0.9762761388,t423:0.9410965303):0.109326088):0.4166829889,t424:1.237551018):1.36570198,t425:2.567754255):4.519724612):1.380803984,((t426:0.6937677241,t427:0.5728165913):3.103965483,((t428:1.03393982,t430:0.9775603634):0.6179897533,t431:1.56248716):1.857433247):4.610781878):11.84934778,((((t432:0.8734047355,t434:0.7660596532):1.243490077,t436:1.236914602):0.3179882762,t437:1.395613025):11.17006657,((t438:3.388188516,(t439:1.249538839,t440:1.221901201):2.074370964):3.807397997,t441:7.045147115):5.357123388):6.271778273):4.160406075,(((t442:1.82876997,t443:1.685552991):2.532258827,t444:4.181198001):1.803297809,((t445:3.1257449,t447:3.06057379):0.9640695971,t448:3.963205197):1.848538542):16.61455307):94.93684969,((((t449:4.248527503,t450:3.954807859):5.684285186,t451:9.62407042):4.646366981,t452:14.25904882):78.93223877,(((((((t446:0.004217878298,(t435:0.127972067,(t433:0.004914916106,(t429:0.01815252009,(((t259:0.02895006614,((t165:0.04386252485,((t132:0.003736627922,(t130:0.08010444365,(t97:0.009375662083,((t72:0.07031235782,(t1:4.407742747,t2:4.302696488):2.977553191):0.2155121611,(t3:2.140351965,t4:2.116102764):5.268534946):3.69992243):3.255118124):0.1002223238):0.1799227941,(((t5:4.391239213,t6:4.327644521):0.3117903254,t7:4.484516401):4.80217586,(t8:8.590269131,(t9:6.059469045,(t10:3.264643119,(t11:0.4930534168,t12:0.4925418395):2.662509554):2.742963954):2.50356951):0.5812256813):4.994205454):2.784433288):5.032912904,((((t13:7.84049776,t14:7.768386859):0.7166781854,((t15:4.977311356,t16:4.83669143):1.306016222,(t17:1.432434849,t18:1.422446832):4.657307804):2.167807862):3.027647108,((t19:5.916047316,t20:5.711614219):5.011094109,(t21:8.240242996,t22:8.238309409):2.413545108):0.1755846438):5.392070791,t23:16.04521239):4.729914088):4.702369635):4.403572958,((((((t24:5.52945309,(t25:3.885396552,(t26:1.216864016,t27:1.173506474):2.323348024):1.217859305):2.939102494,((t28:3.765508964,t29:3.66977954):3.359084341,t30:6.782803926):0.4168787055):5.157534593,(((t31:2.892007247,t32:2.885952604):0.7426647074,((((t33:1.095824898,t34:0.8697744418):0.6493376973,t35:1.463479371):0.5986648175,t36:2.010712066):0.2845042943,t37:2.220386792):0.9636506849):8.160969431,((((t38:4.795035065,t39:4.510330813):2.272515782,(t40:3.477966884,(t41:1.228694327,t42:1.038539129):2.213557349):3.108157249):0.9868983059,t43:7.157585329):2.425895829,((t44:0.3209417753,t45:0.2219676033):3.504089771,(t46:3.244383135,t47:3.241892335):0.4397890474):5.698408868):0.8318169804):0.3394667352):3.383938824,(t48:12.49976391,((t49:4.924264376,(((t50:1.501757509,t51:1.368124514):0.2436470098,(t52:0.899369282,t53:0.7045601079):0.6834936053):0.2450106278,t54:1.619760417):2.788899163):4.322090755,(t55:5.169435813,(t56:2.690457794,(t57:1.475267445,t58:1.347946434):1.085217024):2.455758296):3.383939842):3.219972799):1.374981981):5.600974013,((((((t59:4.188833288,t60:4.081339017):0.9027774912,(t61:1.16621723,t62:1.099514613):3.768466135):2.712260081,(t63:6.628607821,((t64:0.3059315183,t65:0.08587195676):0.3034923101,t66:0.2436730555):5.992677928):0.9420490893):1.78930906,((t67:2.143011542,(t68:0.8517749609,t69:0.7674702319):1.197139491):0.9898074765,(t70:1.323323144,t71:1.238502584):1.570582542):5.768510858):4.994092267,((((((t73:3.634497156,(t74:0.7431452242,t75:0.6676009163):2.829894763):1.419155685,t76:4.906215307):1.29020339,((t77:4.66171954,((t78:0.4160854932,t79:0.2972965086):0.5140618629,t80:0.7158023014):3.562697609):1.080578475,t81:5.240536648):0.3266678699):2.886976225,t82:8.243293143):1.520210781,(((((t83:1.185635976,t84:0.6967903501):1.666711793,t85:2.328112479):3.140350862,(t86:1.265013257,t87:1.180714788):4.139046968):0.834049036,((t88:0.9532492041,t89:0.8774369807):2.736184791,(t90:0.1527955862,t91:0.1382147827):3.134045257):2.237303423):1.67738957,(t92:5.056235944,((t93:1.173876072,t94:1.115462372):2.074977259,t95:2.991352956):1.542676254):1.912491918):1.003288553):0.6959738476,(((t96:1.569095672,t98:1.479088988):3.100683442,t99:4.198052615):0.9760415105,t100:5.14866929):2.072514165):1.851846403):0.5272011428,(((t101:3.853062545,(t102:2.558342311,t103:2.516187397):1.216557815):2.408794568,(((t104:2.848583833,t105:2.434821845):0.1452169667,(t106:0.3026755311,t107:0.1669037276):2.261371996):0.8087748329,t108:3.171494216):2.085734867):1.34605145,(t109:1.921146133,t110:1.831003739):4.331930585):1.882866786):3.345293736):2.78086492,(((t111:3.734155384,((t112:1.769484339,t113:1.73514509):0.6738950927,t114:2.357551876):1.095041311):2.415519001,((t115:3.062205235,t116:2.955839925):1.775556317,((((t117:0.1014004475,t118:0.09504278788):3.186949228,(t119:2.295711543,t120:2.23919049):0.9678795272):0.9654705004,(t121:3.260184903,t122:3.233879471):0.865731558):0.29648215,(t123:1.359878319,t124:1.322839644):2.995584136):0.1638638142):0.9398650016):1.833632266,t125:7.175097815):6.004062791):4.305470321):12.87739362,(((((((t126:4.71210939,(t127:2.288896046,t128:2.210362585):2.412859798):0.1888620078,((t129:0.1949746778,t131:0.06707549906):2.975262699,(t133:2.437844032,t134:2.280396058):0.431072007):1.579373351):0.9369925484,((t135:4.063724158,((t136:1.576373398,t137:1.513591801):1.961156042,t138:3.416531245):0.4445344944):0.6125336185,(t139:0.9743553795,t140:0.8302124301):3.362134335):0.1972830302):1.836189099,t141:6.166111672):10.11682313,((((((t142:1.83353398,t143:1.751455467):5.175286756,(t144:4.439952414,t145:4.310082314):2.476666957):0.04601817181,t146:6.701721445):3.665038591,(((t147:1.594457467,t148:1.542729604):6.736260943,((((t149:1.048679213,t150:0.928676285):1.829048848,t151:2.584807035):1.278847381,t152:3.74761527):2.15868682,(t153:4.600410385,t154:4.421290392):1.283906407):1.918126093):0.2088965906,((t155:3.61241631,(((t156:0.7990177869,t157:0.7831356353):1.184298889,t158:1.959206374):1.052732742,(t159:1.454875107,t160:1.369457986):1.522795168):0.5498829804):0.2287702538,t161:3.667133101):3.988480462):1.634420586):2.70681327,t162:11.83028185):1.380745207,t163:13.17553305):1.425059366):2.318147439,(((((t164:3.408745327,(t166:1.840056917,((t167:0.7607995219,t168:0.5668517554):0.5544869691,t169:1.080972678):0.498994749):1.462786465):0.9978297721,(t170:1.556849622,(t171:0.5437086558,t172:0.4711787899):0.966903895):2.446528871):3.407840111,t173:6.750310377):4.765808884,(t174:9.474522969,((t175:2.132539574,(t176:1.790342469,(t177:1.086043471,t178:1.053434588):0.632691296):0.1253725204):3.511126173,(t179:4.606543927,t180:4.523566226):0.6328175695):3.727751526):1.970455439):2.839186945,(t181:7.206130237,(((t182:0.2992425787,t183:0.09325235222):2.576088452,((t184:1.254972103,t185:1.231167903):0.06607117747,t186:1.217486385):1.268839806):3.876623206,t187:6.314277758):0.335119731):6.474116243):1.430972151):8.767378028,((((t188:8.787735431,(t189:3.943282243,(((t190:0.9784188088,t191:0.6867618961):1.354396236,(t192:1.03095463,t193:0.7475848982):1.009939455):0.9733191032,t194:2.702147699):0.5160866893):4.741373086):9.644056522,((((t195:2.112081492,(t196:1.656957575,(t197:0.9296626172,(t198:0.1990330945,t199:0.0604683118):0.6177938347):0.6478646731):0.437763791):6.899369688,(t200:5.984545996,(t201:2.436453919,t202:2.364635355):3.467325492):2.471688139):2.099298789,t203:10.39368267):3.868697944,((((t204:2.582809666,t205:2.510270864):7.717677806,(((t206:3.152581009,(t207:1.027451153,t208:0.4054942763):2.05639265):2.109748561,(t209:0.2193476828,t210:0.01547439631):4.343272666):3.617173219,((t211:1.042452647,t212:1.023130116):0.9692516549,t213:1.80418738):5.865466489):1.341790577):0.8202999994,(t214:5.854648037,((t215:1.655704703,t216:1.572200283):4.099186273,(((t217:0.3639588542,t218:0.3250331809):0.8955741919,t219:1.172244898):0.6788204966,t220:1.819306384):3.719672716):0.01405504586):3.719707788):2.097522123,((t221:5.384599553,t222:5.377308041):2.838446073,((((t223:2.297356488,(t224:1.482118183,((t225:0.1690273289,t226:0.1066345866):1.063571498,t227:0.9954787401):0.2119722237):0.6674045436):1.906585934,t228:3.484744208):0.04069284732,t229:3.506136376):2.404588577,t230:5.859354757):1.544667914):3.08821539):0.8336205942):2.614776997):0.3641694304,(t231:2.826413351,((t232:0.0256596336,t233:0.002605046878):0.5271188605,t234:0.4398922468):2.174978198):11.47293575):4.307934482,((((t235:1.23333053,t236:0.9626961408):1.23340739,t237:2.189353728):3.678267833,(((((t238:1.361958618,t239:1.177057614):0.361228507,t240:1.459393065):1.606565762,t241:2.956855027):0.3942873961,((t242:0.2616582081,t243:0.2237890248):2.793188822,((t244:0.599866802,t245:0.4994720119):1.696839969,t246:2.128636284):0.4676798533):0.237206589):0.8231919779,((t247:1.519690224,t248:1.508055115):0.5010353379,(t249:1.848367112,t250:1.740850009):0.1428871057):1.370248711):1.307756971):4.780212248,((t251:7.240216253,(t252:3.860764844,t253:3.758612309):3.254159443):1.681058086,(((t254:2.973524293,t255:2.956104929):3.956608623,(t256:0.9920961962,t257:0.8569817233):5.863029698):0.5314193515,(((t258:3.733578396,((t260:0.9950480424,t261:0.9426518008):1.667201341,t262:2.413620644):0.7132471209):2.10167054,(t263:2.378579324,(t264:0.6733456341,t265:0.6222004657):1.652459305):2.758511443):1.06766489,(t266:3.371587972,t267:3.186674071):2.448568213):0.1075467235):1.193919604):0.2637234094):7.366841823):0.1487922567):1.467835056):1.091448661):0.1559597957):0.167240332):1.244059295):0.3944236955,((((t268:5.985805066,((t269:2.427271115,t270:2.375241427):2.848268457,t271:5.188052765):0.5824220667):3.733797027,((t272:8.159219178,(((t273:2.123335527,((t274:0.6165708864,t275:0.6114476408):0.5523184182,t276:1.033816724):0.9375567668):3.245824349,((t277:2.853276877,((t278:0.3680699193,t279:0.3043230544):2.29190868,t280:2.427806239):0.08576514078):0.411631969,(t281:2.515002768,t282:2.385666873):0.2534452716):1.920056586):2.404790963,(((t283:1.616258126,t284:1.355304421):0.2028402483,(t285:0.6531758576,t286:0.5753315754):0.8795313591):3.7804829,(t287:2.055572272,(t288:1.774051855,t289:1.598330271):0.2563922404):3.030556974):1.255557254):0.2167012896):0.2370757901,(t290:1.746050589,t291:1.556767874):4.661504236):0.939901968):8.833466122,((((t292:0.7066986909,t293:0.6276896893):3.612879214,(t294:0.6624909244,t295:0.4719426172):3.557654545):7.427424277,((t296:2.544657969,t297:2.544318502):1.658256083,(t298:2.622049261,t299:2.421009654):1.525019643):6.874740558):3.901329219,(((t300:5.274766826,t301:5.229271127):0.4774998628,t302:5.633017135):0.9043149127,(((t303:0.6935233956,t304:0.6932402065):4.277715494,(t305:3.435767007,((t306:2.71082782,t307:2.664269915):0.08123813582,((t308:0.9396532669,t309:0.5780046929):0.2112062616,t310:0.7075168927):1.516200299):0.4449103355):1.429708035):0.6216497757,(t311:0.9256521181,t312:0.8851795268):3.474409186):0.8807311181):7.908182232):0.3398125382):0.03220438602,((((t313:1.046019794,t314:0.8349061558):0.6388534235,t315:1.460275124):3.755107729,(t316:0.2085319537,t317:0.05877883386):4.976805988):5.819246808,((t318:3.111006566,t319:3.052951755):4.694730901,(((t320:3.440417208,t321:3.292520732):0.5014937445,((t322:2.328801442,t323:2.268405668):1.044391731,t324:3.240349691):0.05728851716):2.079456421,t325:5.343789215):1.614323651):2.943845818):1.756222527):0.6266767731):0.6310523341,((((t326:1.701642601,((t327:0.3387899577,t328:0.2625640157):0.05920864752,t329:0.01474553752):1.274106843):1.088069469,t330:2.190387683):0.6498645378,t331:2.742233145):4.027159376,(((t332:1.682852663,t333:1.212750583):3.348910831,(t334:1.615189505,(t335:0.2781024424,t336:0.1722395883):1.312943719):2.894649616):1.175169555,(t337:2.563889278,t338:2.473465658):2.933883375):0.4965152837):5.408210874):2.452351171,(((t339:0.3743774967,t340:0.3654080054):0.07119756089,t341:0.4319209788):8.363580127,(((t342:0.3788767406,t343:0.3385393759):1.543146332,t344:1.785586981):3.676655546,t345:5.427174769):3.196721348):4.858909097):1.911711907,((((((t346:0.678758854,(t347:0.4140243693,t348:0.2106292331):0.1472209701):6.126234242,(t349:6.242973612,(t350:3.650169682,((t351:2.918168986,t352:2.801976451):0.264892268,(t353:2.618913177,t354:2.541106661):0.424294619):0.3601229422):2.552874011):0.0128930703):1.907098188,t355:7.79238142):0.6426251306,(t356:6.397176846,((t357:3.877425157,((t358:0.4634746427,t359:0.4503540576):0.5055073556,t360:0.8765661514):2.761875221):0.1900198696,t361:3.651374305):2.277346328):1.992626073):0.05344774404,(((t362:2.38371774,t363:2.194688057):0.07729068524,(t364:1.821422696,(t365:1.535007527,(t366:0.08983610755,t367:0.0299642165):1.25061612):0.2028564447):0.3541041619):4.966348144,(((t368:2.592663212,t369:2.547761648):2.954869396,(((t370:2.763449339,t371:2.485335863):0.9821474209,(t372:1.832840548,t373:1.803632902):1.591994225):0.278754017,t374:3.566919256):1.194095671):1.122041533,((t375:0.1259895993,(t376:0.0937085807,t377:0.02092991384):0.02716966278):2.056234362,t378:2.034775677):3.682844778):0.100630267):0.503961489):0.4038996492,t379:6.602066888):5.561409212):14.37091231,((t380:2.64046849,(t381:1.320488973,t382:0.9497456966):1.247386344):13.6333691,(t383:9.875632858,((t384:3.61259593,t385:3.385569111):1.618668007,(t386:3.733123731,t387:3.515209215):1.116227539):4.627914572):5.860963763):9.963807684):7.506956327,(((t388:3.834609673,t389:3.833034227):1.19477474,(t390:3.078352607,((t391:2.415847965,(t392:1.594102979,t393:1.451539556):0.6496884844):0.5579264621,t394:2.525619384):0.1006029707):1.888846308):9.571908716,(((t395:0.5422632568,t396:0.4559197775):5.76973421,t397:6.156374478):1.459776046,((t398:4.607571188,t399:4.571076574):0.5405187119,(t400:4.790714208,((t401:1.010000052,t402:0.9072778254):0.5383489208,t403:1.415551855):3.221171277):0.1662762283):2.402146514):6.307524714):17.98822969):66.45508171):23.73869522):35.66336787);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T32.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
