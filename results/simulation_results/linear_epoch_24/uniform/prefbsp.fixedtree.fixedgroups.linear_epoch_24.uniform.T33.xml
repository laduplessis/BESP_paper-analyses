<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t486:5.055903511,(t487:4.516438948,t488:4.485891582):0.1604047577):235.8017707,(((t490:19.0308055,t491:18.90771155):1.138044657,(((t492:4.304005396,(t493:1.589474441,t494:1.570560413):2.629979817):1.806363238,(t495:0.8071792897,t496:0.7186210904):4.96401229):13.55496466,(((t489:0.1274707082,(t369:0.1388321682,(t367:0.01503071463,(((t325:0.1629294129,(((t315:0.1476628956,((((((t163:0.1114310854,(t159:0.09437977615,((t121:0.2132943916,(t122:0.1305683101,((t95:0.0769244675,t96:0.02005186821):0.1792692588,((t79:0.05524473203,(t1:5.165674735,t2:5.006065728):2.640544077):1.944440078,(t3:3.002792156,t4:2.988490649):6.285000996):0.5267407557):1.931025023):0.04199341413):0.3938814419,((t5:1.894584703,t6:1.654977067):7.765315093,(t7:5.177001928,t8:5.080091449):4.226765294):2.407011482):3.306855828):0.7449253545):1.1026964,(((t9:5.545808535,t10:5.48198934):5.654224668,(((t11:6.643541189,t12:6.509054513):3.027356019,((t13:8.621628222,((t14:2.055509706,(t15:1.295275137,t16:1.171680392):0.663909712):1.431108043,(t17:1.554771415,t18:1.554365549):1.590977756):5.086808044):0.3849668124,(t19:3.955509405,t20:3.847793736):4.559042777):0.416909163):0.6161778486,(((t21:3.87726043,(t22:3.561429626,(((t23:1.521746073,t24:1.472809944):1.417955913,(t25:0.2209638484,t26:0.04777534089):2.537234477):0.1521279822,(t27:2.60253685,(t28:0.2180533565,t29:0.1993748371):2.287347701):0.1213557999):0.3990238793):0.1811034507):0.498707398,((t30:0.2860718645,t31:0.2029549294):2.431122335,(t32:1.32823195,t33:1.286405462):1.284002299):0.9606443779):4.46112198,((t34:3.10086521,t35:2.906432642):2.423494465,t36:5.197165583):2.317963469):0.5623161222):0.6228085077):2.040346895,(((t37:0.9040674017,t38:0.8667731028):3.126686843,((t39:1.736270092,t40:1.71777613):0.4166406682,t41:2.085068725):1.62876799):1.80855665,(t42:5.165872868,t43:5.142821517):0.3487116873):4.823173585):3.590956966):1.598691348,((((t44:1.97397743,t45:1.958610633):1.071229215,t46:2.66385398):9.275885582,(((t47:3.021455283,(t48:1.841961077,t49:1.73493795):1.137843251):0.7281062132,(t50:3.084272358,(t51:2.34176482,t52:2.319652574):0.6447804167):0.3663563304):7.857469132,(t53:3.080439425,t54:2.660336125):8.105950002):0.1487369621):0.7814389468,((t55:4.828092548,((t56:0.6325740862,t57:0.429659614):3.760704893,(t58:3.440900813,t59:3.396217511):0.619440039):0.4114191254):6.255319953,(((t60:1.936357487,t61:1.858055901):0.2233718743,t62:2.079138468):6.559610233,(t63:5.953508643,(t64:2.394130386,(t65:0.800488659,(t66:0.5559801181,t67:0.02313054741):0.1429886982):1.563511127):3.483029196):2.556628575):1.897554388):0.4796241119):2.388611134):3.596296552,((((((t68:0.9955943569,(t69:0.9260092544,t70:0.9216142789):0.06424750289):4.423999911,t71:5.396234063):3.767771613,t72:9.022976139):0.3377744891,(((((t73:1.848800961,t74:1.83891569):0.6482109328,t75:2.479878927):0.4524072428,t76:2.893632821):4.90415966,(t77:4.242678692,t78:4.225951636):3.473554219):0.6816455366,(t80:3.942954974,(t81:3.231756001,(t82:1.787879464,(t83:1.151335209,t84:0.7675615008):0.532517467):1.202249722):0.6936910445):4.070523681):0.6112009347):0.5130415052,((t85:7.356631686,(t86:3.237392914,t87:3.126788463):4.113795964):0.8215706307,((t88:0.8973218865,t89:0.8404101614):2.752688722,t90:3.544045033):4.143984963):0.1668896041):1.966408091,((((t91:2.538885778,t92:2.244653976):2.966780009,(t93:2.530789424,t94:2.412063219):2.559448319):1.725761002,(t97:1.416744395,t98:1.407801029):4.861361411):0.7193718934,t99:6.927443831):1.656534844):4.043762145):3.434703077,(((t100:0.1750356669,t101:0.174468831):9.862027919,t102:10.03298904):1.645637282,(t103:9.745191172,(t104:5.352258151,(t105:2.834753471,t106:2.696249582):2.292150136):4.35623323):1.87955236):4.285258629):0.258039618,(((((((t107:3.436468501,t108:3.384638941):2.20553492,(t109:2.055846726,t110:2.022027987):3.494620933):2.678863441,((t111:2.680512725,t112:2.65003106):3.572246054,(t113:5.433090544,t114:5.300086913):0.692989745):1.911259569):4.402902917,((t115:1.575402289,t116:1.547634923):0.5691181838,(t117:1.086412565,t118:0.9829419767):0.9684561924):10.13919183):1.174445992,((t119:2.09171159,t120:2.018068163):0.6055251749,t123:2.149369383):10.29775297):0.9660386936,((((((t124:0.7299577307,t125:0.673719173):0.1121161459,t126:0.3256490814):3.134024324,(t127:3.002030165,((t128:1.132103327,(t129:0.1646955691,(t130:0.1043567606,t131:0.09679944763):0.01436595273):0.9191477822):1.421700378,(t132:1.119981124,t133:1.042845801):0.893140851):0.4128045272):0.4048659866):1.371312432,(t134:0.561858462,t135:0.4447142182):3.462423117):5.416216481,(t136:8.785846748,t137:8.779643187):0.4491158201):1.244785411,(t138:8.113505505,((t139:0.149579981,t140:0.01174903715):4.56305037,t141:4.523991543):3.393652613):2.319293359):0.9920091629):0.5403443661,(((t142:1.081277901,t143:0.8421410738):6.120718057,((t144:2.613200255,t145:2.54531131):3.165784574,((t146:0.7738971497,t147:0.7224760033):0.2658467667,t148:0.9443847512):4.531176536):1.150644029):3.222011217,((((t149:1.77423213,t150:1.770477538):0.622081395,t151:2.288207103):1.352789345,(t152:3.445796716,(t153:2.258257961,t154:2.246035507):1.164886179):0.1022133033):4.950217896,(((((t155:0.2104796986,t156:0.07972704013):0.9360167387,t157:1.013410626):0.8519897768,(t158:1.180340984,t160:0.7564256335):0.6495395818):0.1381599585,t161:1.267629263):0.908496052,t162:2.129616853):5.380692249):1.069638047):1.217991784):0.3391150283):2.581298358):0.4390204011,((((((t164:6.541658414,(((t165:3.280695834,(t166:0.9544466308,t167:0.942870376):2.289031133):1.078958476,t168:4.228731904):1.118489409,((t169:2.904890409,(((t170:1.050798338,t171:0.9576491611):0.07230907732,t172:0.9469851544):0.1087346698,t173:0.9163636036):1.615330952):2.275731246,((t174:0.4771699443,t175:0.1801391857):2.008129056,t176:2.095731157):2.262279005):0.1662179071):1.038782681):0.7435355603,(t177:5.396043429,(t178:1.444520102,t179:1.311967306):3.939343059):0.8824396994):3.395949626,(t180:2.890728034,(t181:1.571361579,t182:1.265239228):1.296906972):6.58867534):0.03708016694,((((t183:0.8355874306,t184:0.7699277721):1.276757815,t185:2.027798901):0.6754561415,t186:2.664084872):5.588239103,((t187:6.94627497,((t188:4.843832154,(t189:1.875913426,t190:1.690608861):2.906355105):0.3657117693,((t191:2.509029331,t192:2.504429248):0.7182935221,((t193:1.091578547,t194:1.029845633):0.5864038284,t195:1.495587525):1.439787688):1.726400832):1.614892943):0.6119207734,((t196:5.262841208,((t197:1.895179376,(t198:0.6711424391,(t199:0.07819526983,t200:0.06605372033):0.4468625598):1.212865487):1.441142879,(t201:2.050386206,t202:1.519072146):1.005131694):1.913567817):1.2783601,((t203:0.09494906375,t204:0.07197260102):4.707745222,(t205:0.6036666769,t206:0.4707462054):3.838149152):0.912465158):0.3466258):0.6708834028):0.5665539241):0.6328361196,((t207:3.132857531,(t208:2.161639188,(t209:1.646790724,t210:1.622986214):0.2581905351):0.8728387578):1.923366331,t211:4.555590023):2.188856245):1.304074962,(t212:5.465441639,(t213:5.340219413,((t214:1.977179993,t215:1.892831543):1.424266861,t216:3.170467982):1.90560727):0.1048840414):2.47751877):0.2639520787):0.201588251,((((t217:0.9508467191,t218:0.9364322894):1.066196997,t219:1.969463003):4.173752714,(((t220:0.4872825649,t221:0.4845494722):0.09953739663,t222:0.5669046784):0.6516077751,t223:1.175236592):4.806462498):0.6862747906,(t224:1.479376107,(t225:0.6936424055,t226:0.6254312178):0.7055248161):5.119446463):1.154974383):0.1655224544):0.252545852,(((t227:0.6743606499,t228:0.6436750523):4.206383879,((t229:2.290494429,t230:2.219193396):1.238929785,(t231:3.249651169,t232:3.246079651):0.1410306923):1.314035006):0.3492830565,((t233:1.552921133,t234:1.381214583):3.020111637,(t235:0.6610238389,t236:0.3896417227):3.670885012):0.3353235629):2.66195126):1.378339866,((t237:6.590144829,(((t238:0.7081652808,t239:0.69610133):0.5191042376,t240:1.088687769):2.372199404,(t241:2.35773656,t242:2.299017997):0.8335016215):2.839862281):1.212029497,((t243:2.130636351,((t244:1.676505195,(t245:1.229584646,((t246:0.6540254125,t247:0.6158003057):0.1588178931,t248:0.7240349419):0.36476684):0.2977535649):0.002056376047,t249:1.376969058):0.4049652504):4.207576698,(t250:1.426719421,t251:1.218599352):4.499632361):0.808210303):0.6053385356):2.222675566):0.1768779038):13.09149904):13.94526447,(((((((((t252:2.112990598,t253:1.926523086):3.840106588,((t254:3.720456716,(t255:2.37789306,((t256:0.6540715785,t257:0.6225997882):0.0923766915,t258:0.705438592):1.399355308):1.326162213):1.386946745,(t259:1.960805679,t260:1.864192222):2.764248016):0.6250507566):0.6337707077,t261:5.857457591):2.965945448,(t262:3.874712587,(t263:3.674043278,(t264:2.403537001,t265:2.318391234):1.254085471):0.06065168303):4.924735187):1.002944554,((((t266:2.802399314,(t267:2.628931857,t268:2.526094125):0.1084147808):4.746328233,t269:7.119534503):0.5790250086,t270:7.617048975):0.1756421064,(t271:2.776815644,t272:2.733472247):4.998613297):1.228867803):0.4412601656,((t273:0.4412553477,t274:0.4275659802):3.065504955,(t275:1.186475362,t276:1.146058678):2.286879593):5.667390283):7.833204441,(t277:4.568699909,((t278:3.972270025,(t279:2.699122835,((t280:1.548192506,(t281:0.4220408014,t282:0.2650238485):0.9658751943):0.0671006775,t283:1.215711084):1.047067693):1.13470785):0.1128679189,t284:3.397427506):0.372884364):12.32749883):1.124412193,(((t285:2.670004731,t286:2.657079845):9.575161976,(t287:3.910312981,t288:3.843256194):8.302667263):2.93801157,((t289:5.347291408,t290:5.33463719):3.735752211,((((t291:2.618091301,(t292:0.6573201954,t293:0.6297669263):1.823918531):1.151847347,((t294:0.08750828606,t295:0.01537878503):1.955399391,t296:1.920851423):1.557138001):2.870596049,(t297:2.447493907,(t298:1.305776518,t299:1.294544193):1.071908086):3.821352226):1.811644191,t300:7.942986213):0.4842942358):5.891280596):2.016058636):12.46334602,(((((((t301:4.30173565,t302:4.227631793):4.02198922,(((((t303:0.4894961849,t304:0.4346337229):1.713554761,t305:2.140994294):2.645759257,t306:4.785323677):2.609142769,((((t307:0.3971150807,t308:0.2142979229):2.310841593,t309:2.489730147):3.21318656,(t310:0.5029467436,t311:0.4949976754):5.127421654):1.291908056,t312:6.8422687):0.1286197796):0.05112296616,(t313:0.7156346088,t314:0.6308869139):6.299592159):0.7336835703):1.73792566,t316:9.156881619):1.145883423,t317:10.29496951):1.401807328,(((t318:6.531581909,t319:6.49827774):0.4633792497,((t320:0.1340217436,t321:0.1243921062):2.886962044,((t322:0.1447441444,t323:0.1080430426):1.516834426,(t324:0.553598344,t326:0.2262075838):1.062549393):1.111615945):3.691262316):2.563933643,((((t327:1.183676676,(t328:0.7303006924,t329:0.7299597282):0.2464569012):0.5690094792,(t330:0.6490350944,t331:0.5502859444):0.7547501331):2.130151464,(t332:1.416684046,(t333:0.3296199927,(t334:0.1855788209,t335:0.02234527206):0.1281713955):1.058700699):1.996192439):0.404737318,(t336:1.494226078,t337:1.444702151):1.994070858):4.365569603):2.112354041):1.972287517,((t338:1.29662209,t339:1.187234246):9.830647425,((t340:5.207113588,t341:5.136791378):2.159945488,t342:7.239828747):3.506316106):0.7046813147):12.50566345,(((t343:2.282681371,t344:1.955006041):10.36120416,(t345:5.516045306,(t346:3.595168815,t347:3.493210425):1.811416773):6.759353328):8.14577644,((t348:6.045654263,((((t349:0.3865616541,t350:0.2111997055):2.0213855,(t351:1.09078046,t352:1.048903383):0.9792231322):1.553271621,t353:3.393644999):1.326363606,((t354:0.5245750986,t355:0.4726205182):1.854806528,t356:2.300048498):2.282284849):0.7514898709):0.06570204985,(((t357:0.4199174096,t358:0.3377261482):0.8518569443,t359:1.124195883):0.6617652647,t360:1.776848489):3.36841093):13.90336326):3.037598768):1.67971413):4.005066767):0.5806558394,(((((t361:1.331444693,t362:1.300302272):0.9672160922,((t363:1.373211337,t364:1.153641793):0.5280315222,t365:1.630273666):0.1773235157):1.184307441,(t366:0.866081342,t368:0.8275646134):2.103862439):4.275529369,((t370:5.98952089,t371:5.981521781):0.8770831719,(t372:2.957902344,((t373:0.6450646824,t374:0.5631737627):1.794323449,((t375:0.9676443891,t376:0.8937942761):0.2567186337,t377:0.4271675845):1.044516614):0.4834881192):3.897877906):0.08008422235):1.052565029,((t378:2.138217486,t379:1.984450062):4.361678806,(t380:5.72070348,t381:5.684962955):0.2806387917):0.4043626331):19.53220576):5.4479325):0.2557131258):209.5845405,((((t382:2.975655892,t383:2.901185477):3.154881459,(t384:3.206440866,(t385:1.84199804,t386:1.811084119):1.271201368):2.820878789):3.284697881,(((((t387:0.5616840962,t388:0.4808708341):4.885950029,t389:5.315597712):1.780608982,((t390:0.7542936825,t391:0.7493050359):0.1624396056,t392:0.8500723451):6.054992911):0.5032041324,t393:7.209359265):0.2224586874,((((t394:0.2703396811,t395:0.2252196649):4.297026875,t396:4.481118203):1.15051097,t397:5.577678984):0.2855484989,t398:5.747806583):1.181975228):1.138833194):180.195567,((((((t399:6.595461123,(t400:3.4945326,t401:3.297477942):2.941006237):0.07632811923,(t402:4.109574699,((t403:1.598940673,(t404:0.5586978613,t405:0.2011637764):1.019085378):2.299805145,((t406:0.4810418432,t407:0.4773844044):2.107452656,t408:2.352784267):0.8428675535):0.1315951399):2.203666737):2.487611136,(((t409:0.6759476595,t410:0.1368487066):0.7590679616,t411:0.7548861829):5.997460101,t412:6.73362202):0.5627886474):5.27860197,(((t413:0.273572706,t414:0.07902952358):7.156884257,t415:7.230086335):3.195470149,(t416:4.718249263,((t417:2.511914701,(t418:1.014552118,t419:0.9942161839):1.454283287):1.267718201,t420:3.711178018):0.7219646316):5.421927091):1.820221793):23.88725961,(((((t421:4.667155225,(t422:1.093907203,t423:0.957483275):3.539983941):3.638989892,t424:8.099755803):1.131339651,((t425:4.002869724,(t426:0.7873392175,t427:0.7386851907):3.18451606):3.940477219,((t428:5.269309632,t429:5.22229529):1.492619464,(((t430:3.296834892,(t431:0.4364017422,t432:0.143203045):2.700805818):0.06665120141,t433:2.891558971):1.43268914,(t434:2.977087928,t435:2.921004782):1.289519842):1.850663095):0.7678105923):1.217203643):4.821279464,(t436:6.864565545,(t437:1.036554623,t438:0.9013334012):5.704957286):5.957172888):15.00573755,(t439:20.47814585,((t440:1.67404145,t441:1.628784678):5.294503675,((((t442:1.112397269,t443:0.9022988233):1.726263541,t444:2.596881426):1.862527167,(t445:3.891716238,t446:3.855082734):0.5046772649):0.3001027799,(t447:2.084505945,(t448:0.3503181969,t449:0.3394052519):1.558731429):2.493708619):1.919197389):13.36488831):7.039740304):6.25593468):12.9155954,((((((((t450:1.176874228,t451:1.031161059):0.05534760577,t452:1.031349751):0.4861559349,t453:1.413361623):1.455214188,t454:2.833703638):5.426723072,t455:7.779646222):4.251797591,(t456:4.647107579,((t457:0.6346380116,t458:0.5080449792):0.4626834368,t459:0.9135271707):3.447301988):7.257793239):7.078284909,((t460:5.335629225,(t461:3.210537887,((t462:0.1728292994,t463:0.1379573053):1.075699688,(t464:1.124333998,(t465:0.7504734709,t466:0.5392711773):0.2831643434):0.01971202381):1.686397178):2.117078179):10.13704048,t467:14.65270324):3.079206065):14.8604054,((((t468:5.32025715,t469:5.292487231):3.540016469,(t470:2.973060319,(t471:1.984001697,t472:1.941702441):0.8720319289):5.855404793):8.319810538,((((((t473:1.431661915,t474:1.329304974):1.175752986,t475:2.368805919):0.06480382132,t476:2.198725977):0.9574592388,t477:3.12686137):2.577200927,(t478:1.749179175,(t479:0.3261986281,t480:0.2782370042):1.305547913):3.667038442):0.8244072075,(t481:0.2506299475,t482:0.2489762283):5.675638671):9.917999698):1.674191608,((t483:1.276163799,t484:1.241614113):1.052630155,t485:2.225567608):14.972362):13.7063242):11.06455141):136.9818594):51.54653381):10.39902957);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T33.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
