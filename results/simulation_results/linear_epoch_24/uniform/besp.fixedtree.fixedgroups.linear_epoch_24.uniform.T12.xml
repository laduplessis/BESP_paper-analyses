<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t481:2.035298266,t482:1.99174527):15.8286269,((((t483:2.344546066,t484:2.343477158):0.9780566208,t485:3.286050698):10.33378075,(((t486:0.5006537377,t488:0.3594249003):6.370622506,t489:6.496414584):3.436264127,(t490:5.839242557,t491:5.690999178):3.981196151):3.200329202):1.961974327,((t492:0.388444239,t493:0.3180409616):10.23197675,(((t494:0.7242578291,(t487:0.02499206721,(t428:0.01574129255,((((t382:0.02686492078,(t333:0.09872127681,(t251:0.2570069512,((t191:0.03858192055,(t188:0.08086398678,(t147:0.004983504652,((t112:0.1971586409,(t81:0.006382631295,((t21:0.04621805446,t1:2.697415741):1.943456579,(t2:4.543120035,t3:4.361146499):0.07474946958):3.711766555):2.97775984):0.4868407301,(((t4:7.111300117,(t5:7.054360508,((t6:3.489563042,t7:3.341957425):0.4891205734,t8:3.350578917):2.962374537):0.007559008403):3.42285978,t9:9.404317514):0.7551908978,((t10:4.460228638,(t11:3.291741727,t12:3.100963171):0.9885791759):3.948283565,(t13:3.351585331,((t14:2.863205533,t15:2.81814043):0.2583008134,t16:2.903293361):0.1695240911):4.662444935):1.738183485):0.2246823228):4.362592112):3.645368246):0.5627863287):5.096907054,(((((t17:0.8429795293,t18:0.7878635101):8.551971716,(t19:5.025472478,t20:4.984701403):4.143276277):6.27606053,((t22:12.35864804,(t23:6.484296975,((t24:0.9406171128,(t25:0.2634292162,t26:0.246772918):0.619835473):0.5391849483,t27:1.355343175):4.711563126):5.797346278):2.591288567,((((t28:1.780452296,t29:1.607637345):1.655561481,t30:3.072696969):5.44073166,((t31:1.860343872,t32:1.808450044):3.798331797,t33:5.571209707):2.764633089):3.470511128,(((((((t34:0.669165568,t35:0.6623884938):0.7877124328,t36:1.292646159):0.3306506018,t37:1.60920562):2.910081945,t38:4.408844207):1.748829049,(t39:2.084770364,(t40:1.736507765,t41:1.429378216):0.2551880256):3.969088828):0.8535680515,t42:6.389145978):3.744328654,(((t43:1.23886315,t44:1.193413001):3.735875308,t45:4.801518387):3.303251728,((t46:3.011112165,((t47:0.9997146065,t48:0.9174437849):1.52464108,(t49:0.130856808,t50:0.1088078722):2.223055309):0.4157457224):0.8035785799,t51:3.395550939):4.050997389):1.774079827):0.6927071004):1.986211611):0.1197898716):0.355357841,((t52:3.060345508,(t53:1.538248715,t54:1.518555545):1.456013813):8.288992302,(((t55:0.8932659989,t56:0.856554776):6.542379871,((t57:2.467855315,t58:2.452619947):2.523781711,((t59:4.393043943,(t60:2.084086032,t61:1.982504228):1.975264673):0.3402485081,t62:4.122428856):0.1824360065):2.405800084):3.285246674,t63:9.985413712):0.4306977862):1.001628755):4.122213914,(((((t64:3.670157923,t65:3.534751193):0.4222205657,t66:3.925795311):3.383091739,((t67:2.590032821,t68:2.217885357):1.772397621,(t69:0.4670311945,t70:0.1772651329):3.514635764):2.926659259):0.8989125812,(t71:1.521341683,(t72:0.03319662915,t73:0.01244882228):1.438546797):5.933346776):0.3228836022,(((t74:0.4623632041,t75:0.4097429068):2.392577895,(t76:1.300615867,t77:1.299824785):1.417475362):0.1835004894,t78:2.802792332):4.595660995):6.710443445):3.122939286):0.7074069503):7.533678938):3.780642488):0.9699805555,((t79:16.45115703,((t80:2.084814031,(t82:1.915807088,t83:1.619071773):0.1330771832):2.138867635,t84:3.760606104):12.20614852):12.48736324,((((((t85:7.333085041,(t86:4.210004278,t87:4.121743904):3.093240309):2.560955987,(((t88:1.681618767,(t89:1.15087877,t90:1.14940708):0.4875724827):5.841580247,((t91:0.5335661562,t92:0.4872126526):6.399874429,((t93:4.354041596,((t94:2.507976138,t95:2.489645199):1.414157569,(t96:1.521937516,t97:1.518493344):2.306096417):0.4242030915):0.3265615655,(((t98:0.2640686976,t99:0.2209325685):1.346218245,t100:1.506508913):2.647509978,(t101:3.974886908,(t102:2.205377073,t103:2.072105966):1.656586407):0.1644797853):0.234116122):2.100167303):0.1961834433):0.2545600761,(t104:1.386713947,t105:1.374053903):5.175321049):1.993707264):1.617520135,(t106:2.057765844,(t107:1.464953874,t108:1.444298276):0.4363494847):8.007744899):8.216386243,((t109:9.042243795,t110:9.005029361):7.202165333,(((t111:1.170000898,t113:0.8260676599):8.320921372,t114:9.12527386):3.015387019,((t115:6.721182457,(t116:4.94591903,((t117:1.471582065,t118:1.396483144):0.5833800477,t119:1.895874536):2.369029173):1.762304905):1.752504156,(t120:1.901499438,t121:1.822186854):5.876171551):3.580416778):3.290761704):1.72940679):0.4243811983,((t122:10.55065489,(t123:9.221132768,(((t124:3.052962813,(t125:2.828558933,t126:2.392326261):0.1508074579):0.2431190824,t127:2.767814991):0.4993449933,(t128:2.17044069,t129:2.128877309):0.820214894):5.145170336):1.32549638):5.247920921,(((t130:1.604238376,t131:1.589957554):8.634588653,((t132:5.945803414,((t133:3.562220056,t134:3.38605425):2.320279396,t135:5.609321326):0.02507118081):2.596802999,((((t136:1.390554937,(t137:1.267052947,t138:1.038093362):0.1071306602):0.1838940328,t139:0.9268331251):0.0562218845,t140:0.9546330348):4.144983604,(t141:5.017016607,((t142:0.8348748751,t143:0.800344322):2.279538603,t144:2.486683128):1.854007221):0.06813128266):2.364769899):1.628529579):2.51972238,((((t145:0.4429319673,t146:0.08520284154):7.919084986,(((t148:1.953803233,t149:1.710404122):0.6108882554,t150:2.296760908):1.77254727,((t151:0.6601911101,t152:0.578361268):1.503977736,(t153:1.150063171,t154:1.026972789):0.8903477941):1.708144823):3.382269214):0.1109389488,(t155:1.209148415,t156:1.191564348):5.660943697):1.86621143,((t157:3.051672971,t158:2.948761778):3.120248712,t159:6.014532923):2.509961564):0.5390736387):1.793039719):0.6708674858):2.565034525,((t160:8.772661697,(t161:2.338624562,t162:2.322532386):6.43338464):4.87418178,((((t163:4.108535278,t164:4.027667874):0.8155118125,(t165:0.1465887014,t166:0.128026982):4.67230686):2.365210498,(t167:3.540218563,t168:3.459088504):3.58193404):4.408138947,((t169:5.301538852,(t170:4.295608122,(t171:1.568116167,t172:1.553852577):2.598353058):0.8896530048):4.72446274,((t173:4.806240986,(t174:2.524831021,t175:2.509161363):2.148065392):1.272016975,(t176:1.320487586,(t177:1.010121407,t178:0.9498864224):0.1629614538):4.562364163):3.596090993):1.279829566):1.868087208):0.2605318139):5.667923831):1.239995002):0.6062917903,((((t179:2.815795088,t180:2.659192097):5.467141239,((((t181:0.5022595185,t182:0.3897676813):0.5946013646,(t183:0.6308126264,t184:0.6091992474):0.3423981272):1.921664886,(t185:0.1615071704,t186:0.03112871263):2.691969435):2.221118465,(t187:2.858803373,t189:2.598349334):2.064655434):2.750277909):0.3662918788,((t190:4.179245685,(t192:2.805741522,(t193:0.5022218168,t194:0.1732965937):2.15395797):1.125423136):0.627901344,(t195:3.757223197,t196:3.671205971):0.2610903717):2.765021272):2.5364234,((((((t197:0.8519034266,t198:0.8512991705):0.07381900455,t199:0.7673044542):2.990312544,(t200:0.548893568,t201:0.476591167):3.152975511):0.4192171869,t202:3.98512305):1.063460069,(t203:0.7948955569,t204:0.5086966582):4.217663663):0.1707598524,(t205:3.429312631,t206:3.319580742):1.450048033):3.609148918):8.771260143):0.7547786797,(((((((((t207:2.095082074,(t208:1.769151828,t209:1.668444599):0.2195089458):3.635393165,((t210:1.543753394,t211:1.515885339):3.396770285,(t212:1.216675227,t213:1.108408681):3.644737711):0.5657603643):1.059960975,(t214:0.9993578217,t215:0.8442957106):5.248212636):5.116445735,t216:11.2027127):1.217672099,((t217:8.150406761,(t218:6.047624045,(((t219:0.4284621157,t220:0.3202897414):0.7624384517,(t221:0.3614754908,t222:0.3233015289):0.5226358586):1.093269637,(t223:0.7405544557,t224:0.6783865575):1.192919937):3.735320965):2.015484004):1.977226249,((t225:2.572058596,t226:2.559268757):2.201515981,t227:4.755760762):4.75384632):2.223175493):0.3013072381,(((t228:0.08348071157,t229:0.05680139736):6.285936198,(((t230:4.535106609,(t231:2.145987059,(t232:1.291025049,(t233:0.6012294717,(t234:0.4691788429,t235:0.242325298):0.1268055034):0.6752600531):0.3100557886):2.320293492):0.6647597454,(t236:1.593386704,((t237:0.6197077968,t238:0.6188116442):0.6012086827,t239:1.190883295):0.3617070095):2.743178207):0.6649405687,t240:4.891046378):0.3392396153):0.9602692228,((t241:1.978050225,t242:1.894159136):3.43210095,((t243:2.368333592,t244:2.298397186):0.6752642662,(t245:1.129934591,t246:1.053617733):1.799406139):2.260771413):0.5754064455):4.499640947):1.225065487,((((t247:4.697349196,((((t248:0.3797178619,t249:0.3517036416):3.257714214,(t250:3.470694523,(t252:1.451025712,t253:1.408291317):1.702695306):0.1175670051):0.5233578661,t254:3.705625487):0.30137445,(t255:0.4438247556,t256:0.3959507468):3.561740675):0.0848120235):1.974438977,((t257:1.787053868,t258:1.72989029):1.181205393,(t259:1.577495339,t260:1.571142578):1.296644293):2.715226029):1.269774079,t261:6.774175152):0.4405705189,(((t262:0.4779436233,t263:0.4316818774):2.982550603,(t264:1.92618273,t265:1.919464264):1.442899856):0.5105500197,((t266:0.2819433656,t267:0.2270442966):1.531225065,t268:1.49051648):2.057426232):3.223703051):2.498909935):0.8648894033,t269:10.08650796):2.27680755,(((((t270:1.903105604,(t271:0.9396322199,t272:0.8956248255):0.8940728929):0.8105735845,(t273:1.279303596,(t274:0.6479158161,t275:0.638659158):0.5657191493):1.302391787):0.1342163858,t276:2.481412836):5.985098069,((((t277:0.5755711368,t278:0.4061051293):1.744538998,t279:2.086643187):2.838173305,(t280:1.876850806,t281:1.746807273):3.018071673):1.909205365,t282:6.615859821):1.38968595):2.054493135,(t283:0.3397424877,t284:0.2318665813):9.691527126):1.417122988):0.09052158283):1.665733011):5.424632099):1.536256765):0.225820482,((((t285:6.19284187,(t286:3.222967494,t287:3.132243987):2.551248131):1.824819803,((t288:1.900878909,t289:1.371458169):3.08415083,((t290:2.4846561,t291:2.422298251):0.9872796367,t292:3.331784873):0.9796987293):2.406710431):5.186355658,((((t293:4.581735627,(t294:1.306671069,t295:1.296698596):3.141569093):1.45621618,(t296:2.28154415,t297:1.74376393):3.565039998):0.03239302714,(t298:1.105164939,t299:1.06339354):4.197123842):4.133481729,((((t300:4.345913256,(t301:3.599724504,(t302:3.247101941,t303:3.138670285):0.2446447242):0.6311000011):1.896538169,t304:5.892735982):0.9290038543,t305:6.754035948):1.276708564,(t306:2.139466499,(t307:0.06610680553,t308:0.0309122479):2.028781333):5.887814606):0.8978091148):1.471920477):4.531626359,(t309:6.74793215,(((t310:0.9779919118,t311:0.8304170796):3.000206479,(t312:1.996167417,t313:1.919582653):1.69651659):1.376272448,t314:4.887833424):1.368567848):8.030229285):2.408108468):0.8062259787,((t315:12.24746581,(((((t316:0.8164863254,(t317:0.4348577895,t318:0.3298491883):0.3576512381):2.556944301,t319:3.191860904):0.204114414,(t320:0.8887449206,t321:0.8733443656):2.422352455):2.470093899,((t322:4.090207544,(t323:3.451273949,(t324:0.6031119156,t325:0.446494039):2.773697459):0.6361790068):1.525633671,t326:5.249134205):0.04704102362):3.62625668,(t327:6.826822586,t328:6.771048395):1.996390652):2.312796083):3.784487601,(((((t329:1.294579784,t330:1.286853686):2.027896944,t331:3.303540595):0.8545425695,(t332:1.77674653,(t334:0.3489233605,t335:0.1687449785):1.223823019):2.311173268):0.9297622894,t336:4.488650173):4.493002042,((t337:6.088454615,((t338:2.416278658,t339:2.349936354):1.381464001,t340:3.65249154):2.253635153):2.469552315,((t341:1.508012639,(t342:1.422135819,t343:1.285927567):0.08322973529):4.022897862,(((t344:3.732494451,(t345:2.052886543,t346:1.877373527):1.659804767):0.6539639049,t347:4.181627509):0.01129159738,(t348:3.246876643,(t349:3.205681109,t350:3.172457209):0.01523682175):0.923336372):0.8422949716):2.814721439):0.3736923417):5.064139172):1.360972801):8.714674322):4.084079517):2.156985917):129.10119,(((((((t351:7.437517439,t352:7.371679575):5.656783535,((((((t353:1.841738659,t354:1.816583086):1.779572344,(t355:2.947516553,((t356:0.7931656748,t357:0.7813971717):0.1522043624,t358:0.9161446892):2.00009645):0.474159483):4.800216537,(((t359:0.09339954665,t360:0.06623399451):2.298270887,(t361:1.450591467,t362:1.344668562):0.8907308151):5.724340729,((t363:3.175597509,(t364:0.5197437795,t365:0.34344715):2.629491423):2.372701319,((t366:1.822234645,((((t367:0.2178226799,t368:0.1488777834):0.2603662975,t369:0.3554685203):0.7226196345,t370:0.8188502088):0.09402981937,t371:0.7621294862):0.3703017613):0.5580799173,t372:1.634263699):2.922061404):2.379357557):0.01362811938):1.23098636,(t373:1.048854407,t374:0.9382560502):7.118790777):1.146880925,((t375:4.603446198,((t376:1.049000804,(t377:0.2105118749,t378:0.2086974988):0.6821125294):1.656248703,(t379:1.031383376,t380:0.8891981727):1.464949101):1.851417236):4.31657704,(((t381:0.5282036618,t383:0.2802842714):2.974580261,t384:3.220098465):4.70802151,(((t385:3.102196778,t386:3.073456942):3.741061667,((t387:3.087412659,(t388:1.439252413,((t389:0.6842733019,t390:0.6592627059):0.1251047182,t391:0.7622954231):0.6256316881):1.631445774):1.815826668,(t392:2.395443068,t393:2.325393445):2.401795268):1.857328891):0.6543399502,(t394:2.333173462,(t395:0.2012642814,t396:0.1569951527):2.107472672):4.879732843):0.2173465571):0.2807059617):0.1815182541):0.3004452305,(t397:7.938653574,(((t398:0.6845179126,(t399:0.2252446889,t400:0.1232691594):0.4449984175):1.939485,t401:2.31068643):3.307649459,(t402:0.5911839708,t403:0.4966098351):4.992127782):1.584912015):0.1668086733):1.821336663):2.576568921,((((t404:0.4180714733,t405:0.2615735324):1.042520269,t406:1.296313831):0.3216921568,(t407:1.410086252,t408:1.362730415):0.005786898449):1.167686833,((t409:1.140016972,t410:1.070746768):0.4554914581,t411:1.519934126):0.7654831015):8.67988756):7.676007131,(((t412:0.5057308698,t413:0.497943163):0.9852174893,t414:1.352524475):2.662897559,(t415:1.003520169,(t416:0.7155169073,t417:0.6852933006):0.2840339109):2.941920696):14.42883883):2.96538026,((t418:4.258850299,(t419:2.132898965,t420:2.06242562):2.028222764):0.3102768445,(t421:3.734658578,t422:3.551460922):0.6309834958):16.62598987):4.927634694,(((((t423:5.534742377,t424:5.460042692):1.08139759,t425:6.513304286):1.455019205,(((t426:3.34962999,t427:3.129400204):0.09350226919,t429:2.844569248):2.641055022,t430:5.475476257):1.818458996):5.176472953,t431:12.33681808):0.233250457,(((t432:4.621515596,t433:4.61893194):1.293120241,t434:5.716308436):0.1332175815,((t435:3.385251755,((t436:2.794714758,t437:2.789435946):0.2552064037,(t438:1.46009976,t439:1.374298666):1.536960975):0.3218409581):0.8945461932,t440:3.850563404):1.462236021):6.345774851):12.07947844):18.74146524,((((((t441:2.130684124,t442:2.021673164):4.569568629,(((t443:0.4272224295,t444:0.3750350165):0.06514830704,t445:0.4169664492):4.963368148,(((t446:2.362212471,t447:2.290478399):0.5759769866,t448:2.800045963):1.721547695,(t449:4.244971217,((t450:1.108753303,t451:1.045295828):0.8259593355,t452:1.792961977):2.1565727):0.2492596046):0.6614140416):0.9211958558):2.180498878,(((t453:1.997225343,(t454:1.010077292,t455:1.007022848):0.8812974868):5.118355175,(t456:5.51169941,t457:5.398800158):1.480734398):0.4396331941,(t458:6.029268968,(t459:1.534055487,t460:1.396057431):4.326196577):1.236139289):0.343322104):1.27918159,t461:8.391069123):25.91599028,((((t462:0.265588096,t463:0.2388195117):3.621320075,t464:3.710895452):19.3860769,((t465:6.155211315,(((t466:2.177758089,t467:2.164307192):0.2172844916,(t468:1.281852191,t469:1.049496395):1.011181408):0.9723658391,(t470:1.33661888,t471:1.263455436):1.660140955):2.518647277):7.535615956,(t472:0.1595396693,t473:0.1368740355):12.806996):9.274344652):9.216017705,(t474:5.827241892,t475:5.634440277):25.53913775):1.541525267):0.7133406547,((t476:4.598768156,(t477:0.09926026638,t478:0.08766239181):4.370773965):6.030733721,(t479:1.470175653,t480:1.346706186):8.981320618):22.56514901):5.634224132):108.4999666);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T12.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
