<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t321:2.849682575,(t322:2.390882193,((t323:0.3647009527,t324:0.2569096672):0.6718536975,t325:0.9208899371):1.071218436):0.4088368366):12.85839901,((((((t326:1.421448835,t328:1.040186958):1.111379894,t329:2.083114547):3.123318631,t330:5.20588248):1.794114366,(t331:5.516654117,t332:5.410433245):1.464281099):1.428509062,((t333:3.385692343,t334:3.318077373):1.78704933,(t335:0.7057276002,t336:0.6233651077):4.236644187):2.625989497):0.188640285,(t337:7.226896496,((t338:4.819337057,t339:4.674066644):0.0002470055991,t340:4.643256396):2.359324668):0.4236122722):6.129164675):4.355004505,(((t341:9.539903079,t342:9.458445159):1.74547581,(((t343:0.3349317758,t345:0.1827640844):3.96596263,t346:4.106131999):3.359740024,((t347:5.247145114,((t348:0.254287061,t349:0.2453675379):2.024998288,(t350:0.5903931888,t351:0.3985297675):1.586472445):2.897138717):1.549198167,t352:6.295112194):0.4675223528):3.508171614):3.005439802,((t353:0.7711327142,t354:0.7638940281):7.531091824,(t355:2.605843048,(t356:0.9452704703,t357:0.8635922242):1.61936406):5.596884938):4.849065962):3.516671495):3.540314247,((t358:7.952139532,(t359:5.663058312,((((t360:0.4386540569,t361:0.3336476755):0.5448019499,t362:0.8412117899):0.3294420823,t363:1.077148341):0.1081920668,t365:0.7217747155):4.19920737):2.24548131):5.918999779,(((t366:0.08962404,t367:0.05161576549):0.4029805501,t368:0.269907787):5.06367415,t369:5.122829686):7.47132203):6.052329877):4.552090909,t370:23.11826702):20.12630107,((t371:15.98253083,((((t372:4.14937899,t373:4.035736716):2.424582613,t374:6.450605707):1.453856248,(t375:3.466130467,t376:3.447135996):4.122480164):3.041078665,((t377:4.682638517,(t378:2.218045335,t379:2.137656595):2.220394846):0.8260235827,(t380:2.448990063,(t381:1.338796085,t382:1.120511226):1.06849368):2.701768006):5.0589996):4.855061535):2.534287526,(((t383:6.7400822,((t384:3.004915058,(t385:2.900442416,t386:2.698575308):0.09790506503):0.4755544825,t387:3.173663258):3.256215299):1.643926547,((t388:0.3382028784,t389:0.1513374397):6.013651771,t390:6.069109893):1.544466461):3.489937542,((((t391:5.281244557,t392:5.244714705):0.8000967974,t393:5.978968067):2.500847687,(((t394:3.516843934,t395:3.444120193):0.8537405148,t396:4.167544089):2.305336089,(((t397:2.822150458,t398:2.735385938):2.007392218,t399:4.602522605):1.283342756,t400:5.648202611):0.2046798347):1.587801916):0.1151501339,(t401:3.949844092,(t402:1.642641409,t403:1.375690689):2.209193376):3.385208571):2.249279688):5.445604638):24.6141439):43.98442595,((((((t404:1.889208734,t405:1.716973555):3.96574761,t406:5.470756055):10.48065506,(((((t407:3.484056703,(((t408:0.2802322762,t409:0.1419984655):0.2973883145,t410:0.4019665062):1.804170033,(t411:1.424652111,t412:1.411692307):0.6519276061):0.9223439997):1.061729905,(t413:0.7706594257,t414:0.7195367281):3.262419641):1.178085629,(t415:4.123019207,(t416:0.9530873934,t417:0.8363704446):3.111709978):0.8821048014):0.4025725605,(t418:2.893388302,t419:2.63595833):2.253273808):5.826011447,((((((((t420:2.113312696,t421:1.890675061):1.027470969,t422:2.800427144):0.472045863,t423:3.232198458):0.7995686881,((t424:1.063280372,t425:1.009153725):0.4574723088,t426:1.356273394):2.115998667):2.010371535,((t427:1.061474421,t428:0.9491467658):0.5684499515,t429:1.47756286):3.77281965):0.2086134364,(t430:2.164019859,t431:2.110829214):3.174872937):0.06933183099,t432:5.306949027):1.764430104,t433:6.665994729):2.154383923):3.927698928):6.370180554,(t434:8.565795197,(t435:2.856435987,(((t436:0.8767995373,t437:0.8634759812):0.2559109561,t438:1.018488553):0.4592722224,t439:1.437919827):1.135053981):5.689935109):10.5199989):17.61701308,t440:36.37258104):13.12196765,((((t442:1.84407816,t443:1.698692692):0.9389629112,t444:2.60799198):1.573569757,((t445:0.1263340641,t446:0.08942499004):3.802728497,((t447:1.194076116,(t448:0.7779361056,t449:0.613049563):0.3743228734):0.9117516852,t450:1.887514556):1.491098724):0.1317432888):7.087972147,(((t451:1.044252722,t452:1.014759919):3.554353743,((t453:1.202984057,t454:1.188783891):1.100509965,(t455:1.580168375,t456:1.414163196):0.6868728135):2.1562976):4.50277815,t457:8.501767847):1.395187464):37.84934503):29.76837507):150.5056092,((((((t458:1.566964417,t459:1.375447879):3.345938671,t460:4.525385398):7.369397817,t461:11.85205433):15.48546643,((t462:5.984039762,t463:5.977590732):1.568900531,t464:7.519882304):19.73577127):39.18521984,(((t465:2.200164316,t466:2.099492313):12.77525184,(t467:9.627612719,(t468:0.908474305,t469:0.8400967776):8.541888542):5.115442056):14.8609619,(t470:5.139456348,(((t471:0.6543281739,t472:0.4440463999):2.107364761,t473:2.466281098):1.949782036,((t474:0.1936429745,t475:0.1431585333):1.873371208,t476:2.003260193):2.321209078):0.3680120383):24.2152226):36.57037471):43.68941333,((t477:2.739420499,(t478:2.156084943,t479:2.010951728):0.5033930012):5.363223298,((t480:0.1581485615,t481:0.1432858369):5.444747616,((t441:0.04780441966,(((t364:0.05998094999,(t344:0.0274537227,((t327:0.01810798027,(((t211:0.351922045,((((t162:0.3591181208,(t130:0.03564654122,((t103:0.1138114279,(((t54:0.0514836494,t1:4.507008106):0.9346524874,t2:5.400052152):0.1046274497,(t3:5.068190073,((t4:2.435703242,t5:2.402617884):1.822337307,(((t6:1.65922329,t7:1.634423825):1.180003534,t8:2.589205057):0.5912225807,(t9:2.843244789,(t10:1.830303883,t11:1.694815734):1.000519637):0.2700858144):0.7477076662):0.8028744512):0.4222099275):4.076620286):2.063760031,((((t12:2.637003297,t13:2.596710048):0.9132209364,(t14:1.282393794,t15:1.177281378):2.177536885):2.298582622,t16:5.613928074):1.812642976,(t17:0.8720595582,t18:0.8609944951):6.485839739):3.281698726):0.9873038242):2.879321914):0.9406054664,(t19:14.64658096,(((t20:0.1720835695,t21:0.1139887639):4.126819765,t22:4.166694464):3.25220675,t23:7.33536368):7.016305531):0.7480508012):1.539175385,(((t24:1.335071567,t25:1.313206878):7.014282126,(t26:5.06117107,((t27:0.6650394071,t28:0.5333432993):3.021369505,t29:3.299597877):1.302362769):3.202671713):3.222000034,((((t30:6.114096496,(t31:5.155434913,(t32:4.482948413,t33:4.311147219):0.5518050469):0.9296638627):3.400238673,t34:9.014839292):0.1991157849,(t35:3.536599196,(t36:2.80899211,t37:2.796980105):0.4990539861):5.66738247):0.9561587807,(((t38:1.84749875,t39:1.770678722):1.251033448,(t40:0.4543500281,t41:0.4502642843):2.433028773):0.7099389902,((t42:1.730516073,t43:1.634114497):0.7203300353,t44:2.234252867):1.126221936):6.04359215):0.2445371379):4.591545308):0.2294813848,(((t45:5.035502252,(t46:2.911009602,(t47:2.228638645,t48:2.202734836):0.6548107239):2.100733889):5.237853859,((((t49:6.236950375,t50:6.229020181):1.745800829,((((t51:0.2136924615,t52:0.06276965785):1.16494364,t53:1.163221129):2.957873604,(t55:2.02225827,(t56:0.9971738244,t57:0.9925096529):1.01336262):1.885310211):0.7031748784,t58:4.446010944):2.796871628):0.7596436866,t59:7.7974129):0.2046209551,(t60:7.932701971,(t61:3.834035718,(t62:1.498249509,(t63:0.8827456379,t64:0.672256613):0.2702912401):2.086460266):3.909086498):0.05970490542):1.147225139):1.635793954,((t65:0.2631145835,t66:0.1198254305):2.311615014,t67:2.310762318):7.024185427):2.538874422):2.182792112):0.6933538177,(((t68:2.205777536,t69:2.170337684):0.8176080837,((t70:1.82822637,(t71:0.3706869426,t72:0.2646949821):1.408936664):0.578698761,(t73:0.9230898722,t74:0.8601874696):1.290302914):0.5753984008):11.45483518,((t75:1.680755324,t76:1.658562812):9.899831429,(t77:2.322055509,t78:2.276734359):9.140079321):2.507681531):0.2023923728):7.608450282,((((t79:2.932264414,((t80:1.599000004,t81:1.511513254):1.248164077,(t82:0.8915669849,t83:0.5306803226):1.864256643):0.0714546311):4.322715625,(t84:6.53627715,t85:6.523916009):0.2404354187):4.322401259,(((t86:0.2431507216,(t87:0.04314541955,t88:0.03949642645):0.1239707585):2.830802035,t89:2.964189591):6.951462059,((((t90:1.544783263,t91:1.258039668):2.483911172,(t92:0.8128119983,t93:0.7974829112):2.908615617):4.436733076,(t94:3.567806603,((t95:0.2721024924,t96:0.2436052007):2.175865528,t97:2.22029969):0.5814841368):4.499289861):0.01548138297,(t98:1.795298889,t99:1.688639804):5.395256019):1.39288672):1.026745069):2.023333994,(((t100:0.3506113339,t101:0.3357126756):0.04731378723,t102:0.2547017488):9.037816379,(t104:5.383943076,t105:5.374069713):3.512184495):1.973688824):8.013844141):3.06504209):0.7187928054,((((((t106:4.288503273,t107:4.112979849):1.505056217,t108:5.577700158):5.043287682,((((t109:0.2424508938,t110:0.1206024503):1.057887175,t111:1.178473355):1.215581383,t112:2.258454025):2.747257803,((t113:2.789885906,t114:2.478888627):0.1911289257,(t115:1.950040492,t116:1.677637808):0.6722826002):1.98706776):5.283486533):0.3042377443,(t117:7.961814192,((t118:3.866132217,((t119:0.1039247337,t120:0.05740178943):0.8417878407,(t121:0.7371992253,t122:0.5738565878):0.1147030441):2.915072996):0.3503276481,((t123:1.216304477,t124:1.183877865):2.200211958,t125:3.21895963):0.4530432264):3.68948444):1.672544816):0.3566720373,(((t126:0.4205355226,t127:0.2751146565):1.194573554,(t128:1.213668274,(t129:0.5048314291,(t131:0.3930907539,t132:0.3003154803):0.02202749244):0.6409333093):0.04873675182):6.997063038,(t133:5.137860498,(t134:3.575412047,t135:3.545406208):1.401542198):2.853374887):0.5698948422):4.834513663,(((t136:1.261993026,t137:1.214917575):1.848119051,t138:2.968860944):4.445928367,((t139:4.014296108,t140:3.96194503):1.130279569,((t141:1.218327761,t142:0.9924317612):3.126089647,((t143:1.030069191,(t144:0.6944961392,(t145:0.2009556092,t146:0.09024066791):0.4865645854):0.2681498243):2.384848978,(t147:2.059551959,(t148:1.741301625,t149:1.724302744):0.3076393056):1.070820479):0.6670664771):0.6266532976):2.241078104):5.458108889):6.318598079):1.213351226):1.951849332):3.63091752,(((((t150:9.648094525,((t151:3.201556228,t152:3.156710058):2.587509453,(t153:3.040714292,((t154:0.5626375339,t155:0.503095758):0.9797183347,t156:1.456959634):1.493316045):2.557625271):3.830763477):1.131416259,(((t157:1.954425269,t158:1.928637824):4.931705033,(t159:6.054036436,((t160:2.96440892,t161:2.929184779):1.39088424,(t163:2.383402831,t164:2.351742956):1.375350139):1.57795131):0.6348176209):2.81297453,((t165:3.064408004,(t166:0.434247855,t167:0.3231958373):2.585604467):5.340278677,(((t168:4.299631997,(t169:0.5180908644,t170:0.5051575887):3.701278633):1.926418989,t171:6.004149053):1.557877698,(t172:4.355596788,((t173:1.898852536,(t174:0.3509306775,t175:0.2395979099):1.491593437):0.5300140086,t176:2.19476845):1.887643494):3.204507863):0.120593194):0.2876806872):0.5451020618):4.907303982,t177:12.76997311):1.285229382,((t178:0.8357686172,(t179:0.1603607182,t180:0.03856320872):0.674371472):8.374927465,t181:9.06952486):4.704863605):0.3045553061,(t182:5.977048631,((t183:2.413798794,t184:2.398206633):0.559789318,t185:2.79329446):2.968814198):8.100915857):7.919610485):1.942554113,(((((t186:5.098866997,(t187:0.5174001664,t188:0.4540553189):4.265329605):1.739676687,((((t189:0.4709181336,t190:0.4310609071):1.518377876,((t191:0.3677548963,t192:0.1230444625):1.05806194,t193:1.04189096):0.4873904211):0.823842413,t194:2.231579353):3.430361324,(((((t195:0.0263951626,t196:0.01581946205):2.111574251,t197:1.977161195):0.9406646732,(t198:2.56313046,t199:2.4117427):0.194644842):0.8869540078,((t200:0.8472199525,t201:0.7968519066):1.837381214,t202:2.589458656):0.5504538442):1.037022277,(t203:2.426381175,t204:2.354971793):1.723750769):0.6219538557):0.1476313441):2.067340749,t205:6.90358692):0.5026203454,(t206:3.599883221,(t207:2.056193623,t208:2.050989494):1.354582668):3.783530289):12.65254303,((((t209:1.10950096,t210:1.081991638):0.2751732098,t212:0.7946015936):3.488467134,t213:4.24014512):6.315852975,(t214:9.523022925,(((((t215:0.8864355535,(t216:0.5301499643,t217:0.4278852224):0.3308669971):0.005812779444,t218:0.629539581):5.270735186,(t219:1.48418788,t220:1.448299767):4.288747265):1.137082611,t221:6.748100883):0.2169655293,(t222:1.562047709,((t223:1.057879328,t224:0.686711333):0.01077093356,t225:0.6285098737):0.3931846802):5.347266841):1.958123299):0.9457787838):8.629680184):1.56288762):3.068154454):3.157866263,(((((t226:2.227267218,(t227:0.9931312923,t228:0.91568987):1.222196046):9.541301657,((t229:0.9615453974,(t230:0.2871301975,t231:0.2682942464):0.5147319118):9.248182394,(((t232:3.37026327,t233:3.231227164):0.1495185562,(t234:3.304729003,(t235:3.142296056,(((t236:0.3177701447,t237:0.2829854691):1.081034574,(t238:0.6725745607,t239:0.6468068246):0.4919878542):1.331706645,t240:2.447881365):0.3808390044):0.1604022777):0.01458404284):4.927226554,(((t241:4.205482802,((t242:0.7756472318,t243:0.7311226506):1.161197119,t244:1.801248404):2.185540395):2.305958462,t245:6.280460983):0.4755369723,(t246:5.283563668,(((t247:1.692709407,t248:1.494395646):1.06568977,t249:2.549017021):2.035970034,t250:4.485613928):0.3985088735):1.351517823):0.9204124391):1.580031993):1.461458931):3.60063128,(t251:4.695743469,t252:4.68355595):8.986814727):1.051102433,((((t253:4.328005305,t254:4.081551229):4.0946081,t255:8.10138011):4.029848135,(((t256:0.151488465,t257:0.09710231725):6.748256181,((t258:1.866853665,t259:1.802438635):3.002399568,(t260:2.880850129,t261:2.511460311):1.611690483):1.948872739):4.106106097,((((t262:2.850412236,t263:2.753271594):3.400191304,((t264:3.749919831,(t265:1.656051754,t266:1.610617896):2.055209814):1.782376896,t267:5.334334875):0.4938929562):1.303441201,(((t268:0.2602405742,t269:0.25212188):4.724850767,(t270:2.780465124,(t271:0.2830001106,t272:0.1436297739):2.478379737):1.806311035):1.375641009,(t273:2.72958595,(t274:1.561998896,(t275:1.110600731,t276:1.100400899):0.3261166516):1.124265612):2.865220399):0.6699095896):0.05680351183,(t277:1.497960655,t278:1.371841607):4.509469578):2.309996201):0.7125264947):0.7610835468,((((((t279:0.1809265691,t280:0.0107993384):0.7740624455,t281:0.7269454635):0.3765254635,t282:0.8864865391):3.251471977,t283:4.110097225):2.078314162,(t284:5.353116917,t285:5.313953123):0.8218347312):1.190638334,(t286:4.827689333,(t287:4.333401783,(t288:3.331762669,((t289:1.730919666,t290:1.596040483):1.469763197,(t291:0.8359300772,t292:0.7841251961):2.217269169):0.05829132069):0.7796991298):0.4659773886):2.359252281):1.77783884):0.5744683297):5.281566346,(((((((t293:0.8292071016,((t294:0.398398967,t295:0.3253859282):0.2911105475,t296:0.4957749758):0.1005071401):1.217977672,t297:1.721190663):0.7304489663,(t298:0.8957348626,t299:0.8460339616):1.412904105):0.3774828746,t300:2.566040198):3.131943815,(t301:2.87247734,t302:2.826940121):2.772017269):1.684511213,(t303:4.664705143,(t304:3.107486085,(t305:0.5502936338,t306:0.4989752957):2.532742286):1.479942795):2.561568458):3.537464016,((((t307:0.6339402526,t308:0.6146737753):0.7202711757,t309:1.333831262):2.974662431,t310:4.179683671):5.438734486,((t311:3.769696428,((t312:0.1921012231,t313:0.1767364119):2.130717522,t314:2.254665575):1.419216535):2.066460216,((t315:0.983551689,(t316:0.4178592668,t317:0.3003346644):0.4568490639):3.535702853,(t318:4.168674405,(t319:2.66466216,t320:2.570002206):1.472264289):0.1168444415):1.111907378):3.712350263):0.8166599231):2.724075201):3.921905848):6.049776125):2.251088417):100.8921171):117.3472626);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T54.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
