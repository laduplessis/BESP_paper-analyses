<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((((t379:1.066260096,t380:1.054371861):4.237920356,(t381:5.08636819,t382:4.871522783):0.1151394618):0.2941676033,((t383:1.393588866,t384:1.361814913):0.7231882886,t385:2.04804144):3.142643534):5.237746286,((t386:3.193094382,t387:3.119874265):3.602290631,((t388:0.94940022,t389:0.9268967862):5.072363534,(t390:4.775633974,(t391:3.929245983,t392:3.91725894):0.6047395798):1.209815903):0.5783951216):3.582148891):0.2822227973,t393:10.16613518):7.803729761,(((t394:5.261655239,(t395:4.278024063,((t396:1.41938684,t397:1.379078536):0.03575293212,t398:1.350209902):2.742867093):0.9155047495):0.745546872,t399:5.668520508):7.671161781,((((t400:2.089287977,t401:2.079838615):2.253664179,t402:4.300803757):0.608848525,(t403:1.354270074,t404:1.298662668):3.553035825):2.763772305,t405:7.562292694):5.606311416):4.232267679):17.63970143,((t406:13.40708599,((((((t407:1.36357052,(t408:0.6772713468,t409:0.5153839036):0.2802759761):0.7488512851,t410:1.532502739):0.8517929776,(t411:0.284436026,t412:0.2550805512):1.87283007):2.622183872,t413:4.710998208):1.480468685,(((t414:2.452749014,t415:2.44062836):0.3330685971,t416:2.74059019):1.359850341,t417:4.034799855):2.013794697):1.56313035,((t418:3.78171497,(t419:0.6588112347,t420:0.4833596826):2.951330555):0.6296642419,((((t421:1.075661788,t422:1.064678172):0.4168845765,t423:1.307040321):0.8388580024,t425:1.721810933):1.026963018,t426:2.671999785):0.6572334944):3.172037329):4.65991054):2.233481117,(t427:4.706292719,t428:4.668486196):8.590091941):19.32414915):1.118698324,(((((t429:4.407856987,(t430:3.928142781,((t431:0.5012462729,t432:0.4021118301):0.5608827532,t433:0.8924869023):2.687562415):0.2827884011):0.3179772263,((t434:0.7680294504,t435:0.7273618536):0.4987210727,t436:1.168740039):2.842586191):2.438466671,(t437:2.750563983,(t438:1.05866498,(t439:0.8821591074,t440:0.53571404):0.1708824932):1.674416157):3.689079466):21.06634878,((t441:2.70523267,(t442:0.614689577,t443:0.4838510952):2.050448296):0.5109083477,t444:3.042988647):23.69096099):1.482283092,(((((t445:0.4783907363,t446:0.3555380439):0.5881781647,t447:0.5840190111):4.479106074,(t448:0.2427308208,t449:0.2019543608):4.81994529):3.718507099,((t450:0.4663829872,t451:0.4402006244):7.212499842,t452:7.407843773):0.9759706131):1.87702838,t453:10.02580356):16.96268037):3.973314455):45.82918413,(((t454:9.344488239,(t455:4.195904776,(t456:1.286695165,t457:1.216363652):2.876474964):5.136401892):32.37939709,t458:41.57474227):10.29401949,(((t459:8.894189886,((t460:0.388644297,t461:0.2720500397):1.50902816,t462:1.723713972):6.850705966):23.03771447,(((t463:0.7117668205,t464:0.5962569929):2.487915397,(((t465:0.8977818522,t466:0.6894110809):0.2466575282,t467:0.9236272446):1.757058453,(t468:0.09958971793,t469:0.08659313702):2.560354248):0.0122161263):4.666824333,(t470:5.398946236,(t471:0.690504482,(t472:0.5341446346,t473:0.4079875879):0.0335329503):4.696426214):1.908378008):23.5718143):15.49533043,((t474:2.33342333,(((t475:0.1677718395,t476:0.08367792375):1.620771183,t477:1.674356174):0.2321386383,t478:1.865130581):0.1851912216):3.116711632,(t479:2.960035919,(t480:1.483616551,(t481:0.3281775951,t482:0.115839208):1.129974331):1.455783954):2.157250853):40.63752128):4.411074767):24.61546361):13.35531985,(t483:38.25895919,((((t484:3.936940072,t485:3.767819927):0.9532524369,((t486:3.218327508,t487:3.185380729):0.01169585932,(t488:2.983805893,(t489:1.747838854,t490:1.365877636):1.093466388):0.09368549618):1.418964997):0.5760140266,t491:4.466830831):8.525284294,t492:12.97814407):24.22149552):49.49349519):19.92590789,((((t493:12.12515651,t494:11.99757861):2.814095495,(t495:4.433480209,t496:4.174672785):10.27823385):0.001801459854,(t497:9.939881641,(t498:9.672867777,((t499:0.8076829095,((((t424:0.09735488991,(((t340:0.062358775,((t303:0.08857161679,(t285:0.271195817,((t210:0.01302569347,(t205:0.09027358385,(t204:0.08805378726,((((t186:0.1004304543,(t181:0.02171847539,(t136:0.04534928967,(t125:0.2291620233,t1:10.80536446):0.9796175223):3.810775091):0.5318000226):0.5846281704,((((((t2:3.533054968,t3:3.441070007):1.792471689,t4:5.143862127):1.288196626,t5:6.275067525):6.048765318,((t6:5.628255718,(t7:0.3418256284,t8:0.2869648479):5.184703347):0.75379547,((t9:2.400701974,t10:2.390453758):2.216487161,t11:4.533031231):1.442461243):5.921043417):1.097195062,(((t12:2.412841064,t13:2.319014287):6.390939301,(t14:6.112871492,t15:6.100916676):2.57892706):2.845676038,((((t16:5.918817078,((t17:2.014380101,(t18:1.71857388,t19:1.689465476):0.2785608118):3.518156017,(t20:0.9863784709,t21:0.9285502141):4.150528636):0.3576242918):1.621220968,(t22:1.974361858,(t23:0.9413712593,t24:0.8693212317):0.6731310536):4.995636437):0.2860871432,t25:6.727888181):2.190591834,t26:8.846156443):1.462126793):1.340529696):0.612927116,(((t27:1.273145263,t28:1.075743911):9.72711643,(t29:6.622347849,(t30:5.551516686,(t31:0.9688071196,t32:0.7931949149):4.526116165):1.062288321):4.150530821):1.167760718,((t33:5.067428181,((t34:1.903996477,(t35:0.3471023358,t36:0.3039972653):1.554525981):1.825233188,(((t37:0.3034777373,t38:0.2968250719):1.979354152,t39:2.133247577):0.6239632494,t40:2.700246888):0.5302580949):1.253181749):0.3361748167,t41:4.727245393):6.235162354):0.03988917632):2.303515254):0.3836368818,(((((t42:1.537950494,t43:1.522438288):3.261125542,(t44:0.528322879,t45:0.4392211971):4.199286203):2.679651785,t46:7.307798688):0.604093393,(t47:2.217729512,(t48:1.879855577,t49:1.83765676):0.3312654498):5.272064799):1.685358308,(((t50:1.030917749,t51:0.9669772232):1.738531858,((t52:0.8836285194,t53:0.5652701405):1.33960038,t54:1.835909143):0.4073355724):1.166855555,(t55:2.707625693,t56:2.580635887):0.6663990086):5.190013832):3.831364265):0.3914352548,(((t57:1.712976787,t58:1.439765196):0.8408454541,t59:2.269234924):8.815476921,(((t60:0.1631676846,t61:0.08146996778):1.019524714,t62:1.036895061):1.726821905,(t63:1.950403805,((t64:0.9317562568,(t65:0.6195863016,t66:0.5539122667):0.3026213186):0.9239232698,t67:1.711749354):0.06650153116):0.7775986354):8.170831429):1.240459175):0.4549414192):0.2376614282):0.3329300096):3.301171185,(t68:5.609970815,(t69:1.999548592,(t70:0.06446711662,t71:0.02036184854):1.845940058):3.596666916):10.65059034):5.07868872):2.332579009):2.8332749,((((((t72:1.083633473,t73:0.8773276157):5.178470567,(((t74:0.4019612169,t75:0.3749195712):1.158672396,t76:1.504659037):1.454188848,t77:2.930867009):2.993401416):3.205220223,(t78:1.3495552,t79:1.227417835):7.628443039):6.793987959,((t80:12.09198459,(t81:8.572644352,((t82:4.939322776,t83:4.833574383):0.07589375367,(((t84:0.5275329091,t85:0.473781786):0.303313504,t86:0.7570335428):3.122047031,(t87:1.483079032,t88:1.413365075):2.063674761):0.9519444278):3.427199623):3.355441966):0.0606463905,t89:11.19864322):3.443887371):2.091463853,(((((t90:0.9130782541,t91:0.7997485046):7.879086536,(t92:1.032608466,(t93:0.6754761652,t94:0.6683903269):0.3046580319):7.62754046):0.1129226343,t95:8.604460507):6.696596505,(((((t96:0.223548012,t97:0.2200301329):3.937216232,(t98:2.312408297,t99:2.165288638):1.80087867):3.319668177,t100:7.128290982):0.2076752655,t101:7.280564055):3.094190492,(t102:8.303782306,(((t103:1.378567665,(t104:0.994826784,t105:0.9552802286):0.1885394535):4.384929681,((t106:2.600268791,(t107:1.016745261,(t108:0.1625418035,t109:0.151690484):0.6711023808):1.378310527):1.285483187,(t110:1.014446104,t111:1.004241896):2.471945889):1.637917578):0.2997953658,(t112:0.4524943959,t113:0.3421076611):4.926941786):2.119914665):1.996830198):4.439759156):0.7044349044,(t114:13.70477092,(((((((t115:1.615649498,t116:1.47902047):1.276917,((t117:1.56256115,t118:1.335794628):0.4407915833,t119:1.592890545):0.7069580262):1.367864422,(t120:0.9625068108,t121:0.6127626823):2.598035767):1.281203116,(t122:3.582810933,(((t123:2.240803685,t124:2.085667001):0.5168690562,t126:2.246705622):0.7145645282,t127:2.872351596):0.07380706879):0.8858547038):4.479889627,t128:8.261880685):0.4253766051,(((t129:0.8324104167,t130:0.7077927153):3.150399942,(t131:1.513777303,t132:1.500850075):2.220057073):2.230147545,t133:5.916910509):2.098820282):2.847770156,((t134:3.930415005,(t135:1.481490158,t137:1.290506284):2.447216238):0.02946301646,(t138:0.7580724603,t139:0.7032125184):3.007913457):6.89138702):0.354456095):0.7974030862):0.3831828893):0.8283520196,(t140:8.896720189,(t141:4.928419589,t142:4.902412844):3.841726803):4.067518761):7.151821369):0.9100925238):0.9887437457,(((((((((((t143:1.613565389,t144:1.478457714):1.613514262,(t145:0.5322880314,((t146:0.182912577,t147:0.0845345311):0.09547533282,t148:0.0974972822):0.1472683009):2.510704949):3.932506002,((t149:1.656473838,t150:1.628179598):2.788724529,(((t151:0.7145632146,(t152:0.3458808214,t153:0.2550478611):0.3603116706):1.127303799,t154:1.647114847):1.218439329,(t155:2.171775207,(((t156:0.8077076716,(t157:0.376927867,t158:0.1971175028):0.418170353):0.8658384518,t159:1.348422696):0.2613678976,t160:1.372604765):0.1206868212):0.6305234101):1.01470944):2.232957646):0.4959460811,t161:5.641757589):1.465068109,((t162:1.398792418,t163:1.395744505):1.945052983,((((t164:0.226576873,t165:0.1847238558):0.2909467422,t166:0.3472392964):0.5248421243,t167:0.7726072263):1.225118085,(t168:0.2339932686,t169:0.1923116525):1.748399756):1.05585419):3.751634476):0.1392638935,t170:6.875143659):3.258233,(((t171:4.099702538,(t172:1.476320425,(t173:0.7166329289,t174:0.546044592):0.7308814279):2.260825782):3.88070831,((t175:2.801996279,(t176:2.251061567,t177:2.199680386):0.5032368956):4.541754605,(t178:5.287944368,(((t179:2.141583301,t180:2.133848552):1.629181061,t182:3.622537543):0.005391773317,((t183:1.326284381,(t184:0.1455728331,t185:0.08156584375):1.140274767):1.780865563,((t187:0.3548386737,t188:0.3310909185):1.105866686,t189:1.371526533):1.126678734):0.3338445455):1.479307069):1.785977054):0.02483907447):0.6044746679,((t190:2.298626514,t191:2.252731826):2.573084106,(t192:2.912523937,(((t193:0.4269941372,t194:0.1984589051):0.1042989124,t195:0.2582112315):1.778112611,((t196:1.278750927,t197:1.248878469):0.02283433836,t198:0.8999208635):0.6955026749):0.5777020905):1.912111751):1.815186969):1.48196408):4.999668468,(((t199:3.906711514,(t200:1.415223619,(t201:0.4726040135,t202:0.2860457049):0.8996315916):2.293244468):1.463936603,t203:4.93925398):1.370298528,(t206:0.8411102352,t207:0.6948010392):5.054108124):5.517751681):0.223854518,((t208:1.581026562,t209:1.579936453):2.982645087,t211:4.411117757):6.882624416):3.297544486,(((t212:11.71541242,(t213:9.461271429,(t214:0.4497330372,t215:0.1676977227):8.917868237):2.192885333):0.3456491057,(t216:2.53947218,((t217:0.2689544124,t218:0.2662937602):0.8525877775,t219:0.9416625701):1.397204684):8.622743147):2.443713245,((t220:4.534169394,t221:4.501756426):1.630757244,((t222:2.419786034,t223:1.917104393):2.003083207,t224:3.84103295):1.331233415):7.107988384):0.06691890162):0.7423875755,(((t225:2.840257099,t226:2.812416589):0.294997961,t227:3.008152795):8.204108331,((((((t228:2.409441946,t229:2.37276587):2.453667045,((t230:3.788262543,(t231:2.433731831,t232:2.306474909):1.238186252):0.4264033542,t233:3.948329597):0.4349000555):0.8334542736,((t234:1.402456074,t235:1.336305735):3.41700578,(t236:4.342685807,(t237:0.5280086473,t238:0.4612051481):3.722431896):0.4100603594):0.3927316656):1.516918086,t239:6.259474855):0.660071998,t240:6.918957095):0.5567498055,t241:7.314791555):2.576700307):1.739967043):0.07625540514):3.296091672,(((t242:3.657822772,(((t243:1.146308973,t244:1.1364784):0.334400154,t245:1.373559665):0.5618825765,(t246:0.5691307252,t247:0.5647433237):1.316776257):1.500856863):2.513501598,(t248:4.542447412,((t249:2.84070816,(t250:1.21125174,t251:1.174391786):1.500037011):0.1822454432,t252:2.594684773):1.418151461):0.9511246):2.54743631,t253:7.420926884):6.171953342):3.227532051):0.2424595613,(((t254:1.000119359,t255:0.9277263383):0.9501488054,t256:1.851008893):4.642988794,((t257:1.603296754,((t258:0.248072986,t259:0.1684270473):0.3698038392,t260:0.4968500564):0.4584384366):0.5867234482,t261:1.513062193):4.140496266):10.30511203):6.628530574,(((t262:1.023648441,t263:0.9852361997):1.273165905,t264:2.113183286):12.76840559,((t265:2.140037262,(t266:0.422422682,t267:0.2046198799):1.668029754):10.67297704,((t268:6.4324487,(t269:1.622647864,(t270:0.6816739282,t271:0.6478778077):0.9377796666):4.696535964):4.904917528,(((t272:1.572483576,t273:1.57155438):4.046469751,t274:5.54582208):4.456550625,(t275:6.410720797,t276:6.383255809):3.56223471):1.003690767):1.177472022):2.059778077):7.461630036):1.088584851,((((((((t277:1.193611775,t278:1.184514184):1.499825976,(t279:1.735055306,t280:1.601331518):0.8673854155):4.504725809,(t281:6.361264996,t282:6.040410273):0.3815245311):0.001848681688,(((t283:1.79375224,t284:1.776554823):3.009711302,(t286:2.381587919,t287:2.271805717):1.949768633):1.043074272,t288:5.172672499):0.5731096551):1.399598001,(t289:0.6836401694,t290:0.5202564061):6.457863496):1.013760324,(t291:2.095414459,t292:2.064176947):5.767942732):1.698652806,(t293:7.343105837,(t294:1.680880449,t295:1.679592007):5.653645072):1.652997669):4.2780008,(((t296:2.095257019,t297:1.898692026):2.005456865,t298:3.835129683):7.061200503,(((((t299:0.799199922,t300:0.6623591795):0.7678764111,t301:1.286478515):2.764298574,((t302:0.7688245237,(t304:0.2594671214,t305:0.2080768376):0.3000553522):1.832440334,(t306:1.828813385,t307:1.822497785):0.4929679679):1.411198359):2.156549905,((t308:2.973059704,t309:2.905125954):1.448178145,t310:4.244104918):1.20666649):0.150882369,t311:5.562399037):4.077902324):1.905476781):7.070582328):0.232523407):0.03458921299,(((t312:9.001217941,(((t313:6.233146032,t314:6.066426847):2.561354356,(t315:1.702189517,t316:1.64591011):6.836476144):0.03377030987,(((t317:3.330175744,t318:3.328640269):3.694764504,(t319:0.04069796015,t320:0.03611694226):6.973575888):1.048333533,(((t321:4.470461243,(t322:1.900837862,(t323:0.1380950779,t324:0.1090653612):1.60668299):2.561418501):0.3271524768,t325:4.261062573):1.26698835,t326:5.220420415):1.605969498):0.3936553549):0.1440855657):0.5302659551,(((t327:0.6353996972,t328:0.5055240317):4.26209786,(((t329:1.457751985,t330:1.297645947):0.1195804819,t331:1.311970457):0.2080981471,(t332:0.3965750921,(t333:0.1174825142,t334:0.08315762418):0.2645785904):1.082889539):2.926819111):0.664653263,t335:4.963707494):2.226396342):2.667242669,(((t336:1.382123221,(t337:0.3419309222,t338:0.1902469793):0.9286012712):0.06539655995,t339:0.9218983285):5.971854277,t341:6.780335948):2.387624752):6.544908885):8.753410632):0.09121799248):4.44848834):68.98130207,((((((((t342:1.759332512,t343:1.718099134):0.1491620575,(t344:1.70375698,t345:1.55310413):0.02446715961):0.06167263611,(t346:1.255542576,t347:1.124621906):0.3693989006):0.1820508017,t348:1.334883331):1.093625666,t349:2.301825027):2.146728714,t350:4.409103456):6.364098588,((((t351:0.8574581703,t352:0.6712409135):1.934397094,(t353:1.542335508,t354:1.240707783):1.053044607):2.66713113,(t355:1.12691214,t356:1.100745085):3.820736932):1.001909457,((t357:3.119109554,t358:3.077987936):1.970382336,t359:4.77734727):0.8165064521):4.28404498):0.7177800229,(((t360:5.844988399,((t361:0.7218178298,t362:0.675469997):4.205067715,(t363:3.142494081,t364:3.09890867):1.736929489):0.8435697107):1.271493712,(t365:3.341965014,t366:3.319380943):3.449140004):1.717383849,(((t367:1.856390316,t368:1.729784627):0.9861915686,t369:2.613884843):4.818721658,((t370:3.427336249,(t371:1.397828024,t372:1.138818904):1.923383737):0.7407298706,(((t373:1.3846313,t374:1.347097615):1.577793615,(t375:2.401896883,(t376:1.990323558,t377:1.980812832):0.1960912566):0.3681410167):0.1507394699,t378:2.628209):0.5879803885):3.177813609):0.7920388242):1.675305624):85.40614583):22.63354248);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T63.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
