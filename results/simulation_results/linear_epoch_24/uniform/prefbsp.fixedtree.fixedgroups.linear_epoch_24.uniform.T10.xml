<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((((((t282:1.169657807,t283:1.168870806):4.78062969,(((t284:2.089680796,(((t285:0.2675238286,t286:0.1440074217):0.2122531222,t287:0.2990929655):1.237395696,t288:1.460565333):0.2910785179):2.151811177,((t289:0.2139395976,t290:0.1783585435):3.009949986,((t291:0.1607816533,t292:0.09516680442):0.6914737101,t293:0.6972644319):1.89116572):0.4014860239):0.9143635808,t294:3.893699553):0.7394745485):4.495284332,t295:9.027923235):0.5577741906,((((((t296:2.243429574,(t297:1.809141305,(t298:1.318114654,t299:1.233978585):0.3999466051):0.3656208234):0.1899250262,(t300:1.619665563,t301:1.50736353):0.4130540441):1.319042335,t302:3.033886304):0.06556034522,(t303:2.477569251,(t304:0.2873390032,t305:0.2042225673):2.172140224):0.5424242784):3.259850882,(t306:0.1128767346,t307:0.01371062588):5.91934637):0.5351113048,(t308:1.221581405,t309:1.181913937):5.180862235):1.891730157):0.5492049444,((t310:4.366725096,((t311:2.068118775,t312:1.881958181):1.998198603,(((t313:1.619136677,t314:1.468274015):0.2730145693,t315:1.705387166):1.009693792,t316:2.56099415):0.6437301706):0.2526138422):2.514240802,((t317:1.161909275,t318:1.153337136):2.783094958,(t319:2.586649866,t320:2.482132221):1.334556783):1.987929869):1.904856756):5.748019607,(t321:4.25541342,t322:4.12447657):9.089346596):0.07187182569,((t323:4.643420841,t324:4.632482014):4.715373052,((((t325:3.508099432,((t328:0.9200483847,t329:0.8239039147):0.9930536679,t330:1.738796805):1.4950181):0.9882696673,(t331:0.1981884704,t332:0.1225337388):3.921248366):0.5469732996,(((t333:0.8910170583,(t334:0.09796415817,t335:0.07158436475):0.7569742771):0.6379531793,t336:1.460167289):0.6243810853,t337:2.019907559):2.220564895):2.265720047,(t338:2.854543488,(t339:1.260296937,t340:1.091325859):1.578980808):3.591771277):2.025359453):3.923254234):2.016533017,(t341:5.796596506,(t342:0.2694926932,t343:0.2574520828):5.5040863):8.258283431):1.686503436,(((t344:0.6877253914,t345:0.6861738987):2.504106781,t346:3.134534803):5.248846653,(((t347:5.933628699,(t348:4.688207086,(t349:2.315744284,t350:2.240641999):2.30846721):1.059022845):0.7807791933,((t351:0.6733471027,t352:0.4340093329):1.584691302,t353:1.987118621):4.108961658):1.173894216,(t355:0.7023861439,t356:0.6276354821):6.072967455):0.4391538858):7.233929573):2.577874985,((((t357:4.199764655,t358:3.991003759):7.57333102,(((((t359:1.557589947,t360:1.487828178):0.925382902,t361:2.322270762):0.5351769214,((t362:0.8435452698,t363:0.607766125):0.8991994233,t364:1.475212046):0.9492852766):5.775135637,((((t365:3.179469111,((t366:2.398231748,t367:2.141519781):0.6335040356,t368:2.436701238):0.09715698282):1.533677495,t369:3.968963077):1.998488554,(t370:0.6361028379,t371:0.4871060409):5.328458827):0.7867152887,(((t372:0.08518769494,t373:0.03776576598):2.42787891,t374:2.408073121):1.052601864,t375:3.448209636):3.014988887):0.684074321):0.7709648437,((t376:0.9065627961,t377:0.7841684057):0.7904379257,t378:1.571479389):6.172901521):1.781685867):0.1183807347,((t379:3.781554617,t380:3.634185535):3.55868105,t381:7.018023907):2.166865351):0.9461314891,(t382:9.979400749,((t383:3.249934365,t384:3.239860605):0.7904155705,(t385:1.349809697,(t386:0.3400780196,t387:0.3136848817):0.7551146844):2.564155443):5.92222161):0.0461653184):3.938859663):26.26620159,((((t388:5.27433878,t389:5.219683359):0.3307431621,t390:5.452538412):23.27285036,(t391:1.021707496,t392:1.006424313):27.61757653):8.787410872,((((t393:8.746901296,(((t394:1.477704892,(t395:1.317960736,t396:1.148775982):0.08914155013):5.359876667,(t397:1.283403893,t398:1.150210249):5.217576061):0.08668121182,(t399:3.379188471,((((t400:0.6657851561,t401:0.582504318):0.2846156056,t402:0.7692901043):1.503646209,t403:2.194267415):0.6780721322,((t404:0.4782410346,t405:0.4375144954):1.11119703,t407:1.440520889):1.238812808):0.2139343735):3.016231634):1.818557942):8.363671317,((((t408:4.874842942,(((t409:1.670857512,t410:1.343935333):0.6672493142,t411:1.983301592):1.846589901,(t412:2.172257243,t413:2.144767939):1.652323129):0.4964431414):1.724751401,t414:5.979352239):0.9783375062,(((t415:1.812945339,t416:1.686900408):1.713332943,((t417:1.126237769,t418:0.917500407):1.228004987,t419:2.038799808):0.8740710492):2.574760924,((t420:2.217293091,t421:2.189183143):0.008706520677,t422:1.927456075):3.149646631):0.4628640867):3.868768615,(t423:0.1903852297,t424:0.07633768232):9.111101623):4.301977586):8.083826031,((t425:6.318720363,t426:6.007970626):4.35362753,(((t427:2.83900653,t428:2.571205929):3.572006775,((t429:2.719751114,(t430:2.310647751,t431:2.225795863):0.2500275028):2.557638055,t432:4.996685215):0.7623324087):1.983601447,(t433:4.28863298,(t434:2.677371377,t435:2.511030158):1.551337919):3.29344411):1.949175712):10.5998759):7.906216108,((((((t436:1.249395208,(t437:0.3350159686,t438:0.2232877963):0.5175018843):1.344196382,t439:2.077203016):0.01122769003,t440:2.083667221):1.113127631,t441:3.175868609):5.435525483,((t442:4.391369177,((t443:1.04818841,(t444:0.7941591511,t445:0.6706264522):0.2532314125):0.5202196659,t446:1.376946566):2.810048834):1.216009821,t447:5.363994546):2.998995236):1.959753055,(t448:9.810755189,(t449:5.389191293,(t450:0.7500607948,t451:0.4724673046):4.611668102):4.113054391):0.4106545062):16.66257418):3.939609162):2.136414081):8.757136513,t452:41.05735058):204.84531,((t453:105.3542908,((((t454:2.729320534,(t455:0.3989569977,t456:0.3648553467):2.14058102):3.06235735,t457:5.528693804):6.362713472,((((t458:0.6881241471,t459:0.673712767):6.50186751,((t460:0.5603491607,t461:0.536292599):0.417008129,t462:0.9231430273):6.036121415):0.8581268732,((t463:2.07538894,t464:1.869230647):3.391965267,t465:4.78702943):2.255151108):3.226858049,(((((t466:3.579477538,t467:3.531438491):0.6218619918,((((t468:0.6408933769,t469:0.6288611698):1.160950536,t470:1.6473878):0.07470244062,t471:1.431318197):0.5051426635,t472:1.924835826):1.763739098):1.418544089,t473:5.067742118):0.7499246499,t474:5.731352049):0.8111887897,((((t475:0.9848725039,t476:0.9603921619):0.2687253491,(t477:0.7947608456,t478:0.7835941073):0.3772293387):2.827593692,t479:3.820471662):1.012934219,(t480:2.856792338,t481:2.774856065):1.919662102):1.30293327):3.0395174):0.512027753):1.635247639,(((t482:0.02471895259,t483:0.004145795235):1.557425697,t484:1.52738497):9.192356511,((t485:0.08394661504,t486:0.04012323362):4.743089152,((t487:2.298612787,((t488:0.9606020671,t489:0.9159099545):0.8493536658,t490:1.71950392):0.4791031537):1.910222895,(t491:1.074985436,t492:0.8906122662):2.914159085):0.5120048709):5.633997004):0.4088550688):91.48611116):75.81389036,((t493:9.561096194,t494:9.502493664):12.00780363,((t495:3.993938573,t496:3.874065265):15.39733836,(((t406:0.00328059631,(t354:0.009301297939,(t326:0.07853337444,(t327:0.05786161583,(((((t227:0.03312292999,(t212:0.02562346221,(t211:0.01342017342,(t202:0.0118509223,((t122:0.1905460909,(t99:0.03941403533,(t18:0.07712380399,t1:1.202527241):7.787413854):2.56637885):4.549552421,(((t2:4.218635257,((t3:2.397849869,t4:2.144812603):0.5738783502,t5:2.701436826):1.205548728):10.79956487,(t6:7.960998321,(((t7:6.192460127,((t8:2.822389649,t9:2.814965434):0.8548077442,t10:3.447496504):2.416847746):0.3965277321,(t11:0.7264621548,t12:0.7256364945):5.525675032):0.003550125588,((t13:0.8191572576,t14:0.7964418516):5.24760741,(t15:5.676887295,(t16:5.172499306,(((t17:2.798333959,t19:2.388513755):0.2627023098,t20:2.472304277):0.2948908658,t21:2.707631315):1.788839081):0.3751832638):0.3224408993):0.1795756683):1.350650159):6.679561404):0.1151324214,(((((t22:3.291354606,(t23:2.186167837,t24:2.077822455):1.050907143):0.6187308489,t25:3.723314822):3.821684956,t26:7.425082657):2.141919041,t27:9.404190248):2.531934318,((((t28:2.521721645,(t29:1.82381573,((t30:1.603305872,t31:1.382301539):0.07139923557,t32:1.446167359):0.06331470902):0.6133103772):3.20171064,t33:5.256984828):1.08481268,(t34:4.1583982,((t35:2.659969638,t36:2.628696548):1.149573257,t37:3.760894332):0.2870812329):2.102423431):2.291341765,(((((t38:0.5878672276,t39:0.5324366286):2.366374483,t40:2.839464284):2.823757664,(t41:2.41377722,(t42:1.00810439,t43:0.8296171768):1.223130599):3.24545799):0.9647653018,((t44:3.273220616,t45:3.013646907):0.8943524661,t46:3.871554247):2.025517147):1.30318011,(t47:4.08534598,t48:3.998450009):3.105319714):0.3664228846):2.780608261):0.845652823):0.87654298):1.929270679):0.6069872399):0.07810448442):1.168287687):1.042700047,(((t49:2.358758939,((t50:0.130733616,t51:0.1237185186):1.768978072,t52:1.850523718):0.3703362744):7.336068348,t53:9.547122137):5.913294236,((t54:1.206210983,t55:0.9417314668):4.205486996,(t56:0.4284785646,t57:0.4223309853):4.693845886):9.800400692):1.108423167):0.1173463514,(((t58:1.556826662,t59:1.453434589):0.8776630427,(t60:1.01960589,t61:0.8772762404):1.260740738):9.207725047,(((t62:4.794909656,t63:4.738448919):3.78116582,(t64:0.3591655164,t65:0.271766992):8.080818985):1.86811056,(t66:0.1386341434,t67:0.1207543211):10.04215206):0.8575948137):4.367048181):0.06312264169,(t68:3.803586773,t69:3.701821646):11.32121935):2.895483157,((((t70:2.126375959,t71:2.096283674):8.933673119,t72:10.96571382):1.96078682,(((((t73:1.148207906,(t74:0.4863000504,t75:0.30715899):0.4518542871):1.831786841,t76:2.529957766):1.768132276,t77:4.092922962):0.4167831628,t78:4.365548248):4.422709832,((t79:2.881736954,((t80:0.3432796261,t81:0.3254090579):0.3908760675,t82:0.671601249):2.016674792):3.181898143,t83:5.84052901):2.646022785):3.304581104):0.2222215531,(t84:9.17203582,((t85:2.234390503,(((t86:0.7417514679,((t87:0.3436989756,t88:0.2560582533):0.1763378059,(t89:0.3944064338,t90:0.3819369647):0.02609267705):0.1871742357):1.28909847,t91:1.866473537):0.06717116256,t92:1.824866211):0.07930601406):2.030180999,t93:3.82781983):4.711909348):2.765675102):4.652377912):6.169236381):0.007570740107):2.052919285):5.486330852):0.5856680143,((t94:1.500919495,t95:1.463661996):21.72445279,(((t96:13.55630805,(((((t97:0.8544168733,(t98:0.7471957373,t100:0.3263186602):0.05869411127):6.073623263,(t101:5.934529162,((t102:1.151088571,t103:1.091243782):4.6439831,t104:5.234463743):0.03703824503):0.4611007265):2.133024316,(((((t105:1.273691335,t106:1.107579049):0.03636587986,t107:1.140578659):1.049981902,t108:2.037933355):3.521126277,((t109:2.071127857,t110:2.035028246):0.8026141248,t111:2.606289109):2.592297586):1.636398278,t112:6.82382062):0.03046072284):1.82410278,((t113:0.2784520863,t114:0.1391182631):8.375192799,(((t115:0.6327842464,t116:0.6327840587):1.976784729,(((t117:0.8553995867,(t118:0.10289109,t119:0.02306498784):0.7064640037):0.4607497749,t120:1.137197119):0.7394326841,t121:1.750343425):0.5101750258):5.734452425,((t123:1.353422311,(t124:1.127838537,t125:1.106757401):0.2061879854):5.249568881,((t126:4.91766186,(t127:3.833070249,(t128:1.240015043,t129:1.184728194):2.549224442):1.023225318):0.445909577,t130:5.002065418):0.7613745509):0.8859256582):0.1403102197):0.01820069356):1.848923886,(((t131:0.7735108076,t132:0.7712770779):0.812172058,t133:1.367415244):2.531855784,t134:3.868895288):4.435685674):0.7211224031):5.920678525,(((((t135:1.893879665,t136:1.841067058):0.673490763,(t137:0.3592959321,t138:0.3341396987):2.098003173):5.558985268,((t139:4.822030072,(t140:0.9824405035,(t141:0.787643869,(t142:0.6199571885,t143:0.577782886):0.1296277644):0.1542140289):3.633460033):1.482040848,(t144:2.413456243,t145:2.396028298):3.468619263):1.405275544):2.982946915,(((t146:1.569499959,t147:1.522763136):5.954991246,(((t148:4.006912219,((t149:1.15966997,t150:1.136062117):1.084707941,(t151:1.851870942,(t152:0.443758745,t153:0.3609082557):1.401669479):0.3611008074):1.690242005):0.9867963345,((t154:0.412898238,t155:0.309536576):1.54016039,t156:1.839615463):2.75738249):0.7504446274,((t157:4.373154169,(((t158:0.8107046075,t159:0.6985919294):0.5979396985,t160:1.282308968):2.008210687,t161:3.235605851):0.8510467741):0.3507035242,(t162:4.140623425,(((t163:0.4874078812,t164:0.332744542):0.2652055102,t165:0.5260550954):0.5061276176,t166:0.9396761176):2.881303326):0.2233862704):0.5597945381):1.652258601):0.04418014437,((t167:2.88373143,t168:2.730933646):0.699896727,t169:3.350381201):2.300275761):2.674574856):0.0203595374,(t170:0.6897989858,t171:0.681938282):7.652075447):3.751276534):0.2392003425,(((t172:2.646224242,t173:2.47633915):5.759702397,(t174:4.421338359,t175:4.385156763):3.672385382):2.724996236,(t176:5.084105091,((t177:0.2528629189,t178:0.1724406591):2.64742318,(t179:1.074913184,t180:1.025213972):1.649973114):2.179327313):5.698310205):1.183202889):3.424134446):6.692368514):1.156055384,((((t181:2.150344156,(t182:1.333076381,t183:1.045706262):0.72144303):10.23038327,(((((((((t184:1.447767632,t185:1.439542597):0.156461101,(t186:0.04956269488,t187:0.02136038002):1.380385123):2.778131761,(t188:0.8653053545,t189:0.8473223761):3.23606113):1.545522243,t190:5.519916596):0.6878938604,t191:6.154986532):0.006652213436,((t192:1.273497813,t193:1.260405258):4.185892827,(t194:0.741564976,t195:0.7196101504):4.673665027):0.646807897):0.02023337294,t196:6.010865856):2.996525221,(t197:8.894073107,((t198:2.007156234,t199:1.935738488):1.231821309,(t200:0.08343419122,t201:0.07834672804):2.871565609):5.620915607):0.08759524907):2.163811467,((((t203:5.64854943,(t204:0.4405686161,t205:0.4236143958):5.179122904):1.459483945,((t206:3.412363625,t207:3.370076746):0.4503609731,((t208:0.1095545909,t209:0.03037746783):2.4661336,(((t210:0.4194655859,(t213:0.03984784697,t214:0.02026216257):0.2407854874):0.06811878975,t215:0.3188443276):0.05627528249,t216:0.291936973):1.853836386):1.117604477):3.092803275):2.100992732,(t217:2.609993216,((t218:1.257202799,t219:1.181876855):0.2396640482,t220:1.321803906):1.077201278):5.796637904):1.27231552,t221:9.342206011):0.1871684042):0.09799597615):5.140866878,(((((t222:2.141607115,t223:2.087608074):6.171699525,((((t224:1.272525846,t225:1.014918552):0.8616367498,(t226:1.000562449,t228:0.5951690278):0.8292054896):0.5484730806,t229:1.966136705):3.757762487,((t230:2.115598834,t231:2.081274704):1.393769469,(t232:0.6287005953,t233:0.6156399687):2.815482931):2.077246965):1.816300138):0.2299456722,(t234:7.143975254,(t235:1.796026061,t236:1.683095101):5.116950444):0.3652105902):5.841881339,t237:12.95702457):0.1658534736,((((t238:6.461496585,(t239:4.388315324,t240:4.288642607):1.996816231):0.5127692067,(((((t241:3.769593767,t242:3.6975978):0.1303437252,(t243:3.621376646,t244:3.544932414):0.2050592449):0.8584453141,t245:4.149644221):1.057169352,t246:5.092041144):0.1429575233,(((t247:1.895255749,t248:1.881743232):0.006229734227,t249:1.754787933):0.8582014026,t250:2.447143287):2.371411986):0.8390040342):0.5593433315,t251:6.203621945):1.393149853,((t252:0.1889895807,t253:0.1746758172):7.016163223,(t254:4.628038884,((t255:1.159562323,t256:1.121695925):2.495341673,(t257:2.308903663,(t258:1.360728662,t259:1.35439201):0.6087590355):1.206656871):0.8340181353):2.508506591):0.02230145247):4.002193982):0.1896814036):3.934708455,(((t260:7.717675744,((t261:2.134569307,(t262:1.70931261,t263:1.661181415):0.3870725639):2.544782874,((t264:1.430083349,t265:1.265333138):2.89575433,t266:4.122465516):0.147899065):2.8824912):0.3160831821,(t267:4.502439597,((t268:2.400224743,t269:2.317482347):1.407351176,((t270:0.8598709904,t271:0.8585078248):1.112503946,t272:1.84455755):1.608786008):0.5824426667):2.808751913):4.577157793,(((t273:5.278982622,(t274:3.661893548,t275:3.648727643):1.584666315):5.119974528,(t276:7.712148926,(t277:5.80676156,t278:5.686309086):1.6302203):2.514378861):0.06204992164,(t279:2.985754105,(t280:0.5867647674,t281:0.5550926915):2.362759491):6.881217841):0.8175866067):1.54808601):1.519086204):27.46726343):2.046987199):156.0404297):64.47454258);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T10.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
