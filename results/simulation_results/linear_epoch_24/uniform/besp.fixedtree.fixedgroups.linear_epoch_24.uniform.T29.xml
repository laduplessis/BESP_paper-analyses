<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t460:10.35692076,(t461:6.926508845,(t462:0.602426504,t463:0.5309120726):6.265634279):3.370443637):41.19468204,(t464:18.7281046,((t465:3.53962091,((t466:1.908824124,t467:1.766400386):1.506848075,(t468:1.164688322,t469:1.081280111):2.085684508):0.09465682655):9.193827412,t470:12.27439681):5.937505598):32.54143324):14.78618401,((((t471:5.533539028,(t472:4.556689463,((t473:0.6353658429,t474:0.1793003027):3.530421743,((((t440:0.009416301228,(((((t401:0.3223517962,((t387:0.09231707828,(((t360:0.1501610636,t361:0.01469883583):0.0867885855,(((((t218:0.04355746215,(t212:0.3695842842,(t202:0.08917469799,(((t193:0.1026679576,((t159:0.0178992719,(t116:0.02826436491,((t79:0.4759195531,(t53:0.2028846791,t1:5.260198267):2.936033484):0.2983111093,(((t2:2.681850041,t3:2.649570792):2.214956957,t4:4.816485676):2.384632778,((t5:2.932860625,t6:2.872009349):0.1010696169,t7:2.778568288):4.0951932):1.178661577):3.095495898):4.225818336):0.5568928155,(((t8:4.410137156,t9:4.102091467):3.330704755,((t10:2.029380164,t11:2.024955532):2.659438036,t12:4.539378663):2.707449532):6.190045383,(t13:4.008446217,t14:3.649337493):9.282506993):1.989660976):3.264018178):0.7175544093,((((t15:3.153264462,t16:3.049241767):6.285207126,(t17:7.05096677,((t18:4.380311667,(t19:3.976417362,t20:3.863628345):0.395086635):1.207878018,(t21:0.314794846,t22:0.2788708845):5.149707179):1.413922758):1.84028179):2.345502131,(t23:3.614523799,(t24:1.82773055,t25:1.7868535):1.77769349):7.402458343):5.616146382,((t26:7.284778746,(t27:6.762534688,((t28:3.218601442,t29:3.162489819):3.007194466,((t30:2.817851512,t31:2.536583362):1.494392199,t32:3.885034979):1.815291103):0.4497659815):0.478092755):5.259930005,((((t33:1.543293091,t34:1.525910388):6.698470461,t35:8.214366127):0.4880885494,((t36:3.781036537,(t37:2.500611097,((t38:1.471408685,(t39:0.9167810375,t40:0.7991022155):0.4267813446):0.774147837,t41:1.937827414):0.1726710011):1.20814255):4.328673607,((t42:2.928712273,t43:2.818992629):0.7361200915,(t44:1.636380571,t45:1.625033713):1.779585246):3.931223458):0.5706251113):1.837813578,(t46:9.249450299,((t47:2.768656462,t48:2.586484334):2.25233713,(t49:2.546410698,(t50:0.4523362959,t51:0.4346340596):2.015697768):2.215535994):4.183028854):0.2711259114):1.066548025):3.897566624):1.392801207):0.1792123487,((((t52:0.7284976308,t54:0.3027472434):3.792437259,(t55:0.1958119417,t56:0.06169645111):3.876012161):1.633536901,t57:5.472259518):0.4875733902,(t58:4.200504085,(t59:4.072141015,(t60:1.876626365,t61:1.819746592):2.078996391):0.1248968855):1.637063558):8.997480442):0.02666054237):1.326407495):0.3017662777):0.3391356618,(((((((t62:4.556685389,(t63:4.31319116,((t64:1.644468846,t65:1.521616029):1.024438994,(t66:1.774366633,t67:1.765927154):0.6506349):1.388439423):0.2099972131):2.158963246,(((t68:1.27260469,(t69:0.9758868838,t70:0.9690642502):0.2547017201):3.006455281,t71:4.157946689):1.389223712,(t72:3.386880647,t73:3.152879828):2.159211647):0.3413187014):3.194389515,((t74:1.336093707,t75:1.295789193):2.904343987,(((t76:1.464287614,t77:1.447647932):0.7913411524,t78:2.064891879):0.9448622303,t80:2.294801411):0.7750228167):4.523976586):0.01216454769,((t81:3.488619722,((t82:0.3295362112,t83:0.3141969862):1.951320352,(t84:0.2597584193,t85:0.2128919027):1.929101334):1.183347281):3.800034929,((t86:1.672135635,t87:1.626434818):4.838408479,t88:6.404903078):0.5447407811):0.3028730343):1.412322138,(t89:0.3954282573,t90:0.3837387583):8.156560521):3.738988742,t91:12.19425945):0.5767664128,(((t92:8.838935689,((((t93:0.06258565733,t94:0.0113609674):4.09438187,(t95:2.133033471,t96:2.050166188):1.750968787):2.037654503,(t97:1.592166722,t98:1.454659761):4.200261836):0.6684947748,t99:6.30458521):1.914411072):1.616949284,(((t100:2.003594759,(t101:1.6270843,t102:1.571524982):0.239004396):1.041091527,t103:2.584408009):5.776631955,t104:8.344449888):0.8618201246):1.913034659,(t105:9.688645219,(((t106:0.1821438645,t107:0.1739428544):1.633395886,t108:1.636591855):0.2412217249,t109:1.615157737):7.613904413):1.103924417):0.1786085472):0.9557498709):1.496848606,(((((t110:0.1921513966,t111:0.1286173859):0.4459832838,t112:0.2838741891):2.55255923,(t113:1.885424475,(t114:0.2303130752,t115:0.2221428304):1.65467135):0.9342384351):5.741699029,(t117:4.903792144,(t118:2.46640457,t119:2.155048338):2.428510623):3.506241368):2.681702447,(((t120:0.25169542,t121:0.172145177):5.940482597,t122:6.010186301):3.376496726,(t123:6.875831013,t124:6.825019567):2.453082385):1.063843954):1.259755547):6.196934108,((t125:7.581734243,((t126:4.058946873,t127:3.889852904):0.4164571326,t128:4.24987786):2.861438374):7.320996869,((t129:3.166083444,t130:3.039407154):7.877958406,t131:10.78157319):3.201449158):2.79342698):2.209212466,(t132:14.44535735,(((((t133:0.1758996601,t134:0.1503658293):7.395928211,((t135:4.667519372,t136:4.390023428):0.09999575851,((t137:2.70852077,t138:2.418677597):1.348826771,t139:3.703952688):0.3981439334):2.617484985):3.598644826,((t140:0.2612620768,t141:0.2407165374):6.241841944,((t142:2.025653118,(t143:1.386864409,t144:1.287390547):0.6341907142):3.272415622,(t145:1.649551965,((t146:0.3982038157,t147:0.3979944437):0.3847883943,t148:0.7710630108):0.7924022965):3.535352454):1.05509904):3.765441444):1.233944864,((t149:3.101807186,t150:3.057156109):1.271162213,t151:4.314436811):6.764097412):0.8005375536,(((((t152:0.8458860154,(t153:0.0266108943,t154:0.02368358586):0.6036805053):3.156186937,t155:3.608121374):0.3362353595,(t156:3.334122317,t157:3.278132129):0.552897081):3.881185051,(((t158:1.719596523,(t160:1.280115647,t161:0.9425536607):0.271326584):3.178307621,(t162:2.087414744,t163:2.050177135):2.260657949):0.2510639989,((t164:1.720301101,t165:1.384528704):1.779952282,t166:2.977121496):0.8491609046):2.524146522):1.820190933,t167:8.014731035):1.620733041):1.134128962):4.454048523):3.426934249):2.147238591,((((t168:2.569706961,(t169:0.1002114323,t170:0.08259684276):2.464111347):8.23927516,t171:10.73388643):0.413942669,(((t172:0.8944372633,t173:0.8783661482):4.189140287,((t174:2.65888426,(t175:0.2874015221,t176:0.1176750255):2.323433228):1.029727007,(((t177:0.2364774376,t178:0.2251780985):1.905156236,t179:2.07817002):0.4958538444,((t180:0.5253228497,t181:0.4296423437):0.9816613927,t182:1.312551791):0.9806248018):0.7878790281):1.112652053):2.653461858,t183:6.835943753):3.115061531):6.084741307,(((((t184:0.1784839773,t185:0.1172724104):1.611896695,t186:1.716623787):6.119115146,(((t187:0.8283981408,t188:0.8100743421):4.733759681,t189:5.398131701):0.1897710838,t190:5.559927813):2.034881136):5.26017928,(((t191:3.767871965,(t192:2.383376375,t194:1.886405926):1.323137644):3.921513639,(t195:5.251981107,((t196:1.305086285,t197:1.227334504):2.564382091,(t198:2.042717385,(t199:0.7223551073,t200:0.7160135568):1.145372735):1.724583898):1.153088647):1.834138056):3.851103421,t201:10.38015585):1.045920259):1.601663922,(((t203:5.216489068,t204:5.21395297):2.58862452,(t205:1.093526164,t206:1.046348123):6.666748824):3.756159675,(t207:6.13511165,(((t208:1.634864836,t209:1.475279678):1.311893133,t210:2.578814041):1.996629542,((t211:1.465989118,t213:1.071893976):0.7537447448,t214:1.72505638):2.083103095):1.057304646):5.260236582):1.183871115):1.22832347):3.460217637):1.18839874):0.148694957,(((t215:3.389384525,((t216:2.634634121,t217:2.610468665):0.303159461,(t219:1.656847191,(t220:0.978604045,t221:0.9354422794):0.6652376529):1.080242508):0.4340673946):11.99230513,((((t222:2.129259534,(t223:1.478751126,t224:1.359840674):0.6397445242):3.602235977,(t225:0.4968972638,t226:0.3965469207):5.096713346):0.02060398272,t227:5.471732828):8.408906256,((t228:4.60072304,(t229:2.312253018,t230:2.249267759):2.238197287):1.113291438,((t231:2.311203705,t232:2.23099063):2.721441471,t233:4.662087707):0.1736852891):8.053721343):0.8071267989):0.1047736741,((t234:3.948333466,(t235:3.629669048,(t236:2.966146502,(t237:1.186867445,t238:1.134574562):1.732698414):0.6525318317):0.01713851925):7.178362667,((t239:7.192683091,(t240:4.423084261,(t241:1.00886889,t242:0.9623987846):3.34361334):2.484452673):1.813678042,(t243:8.173224918,((((t244:0.5560298483,t245:0.5054655331):3.10992659,(t246:2.927927482,t247:2.888080136):0.5693785817):0.9451593309,(((t248:0.08458081025,t249:0.03651003258):3.844758657,(t250:3.072776546,t251:3.004203975):0.7772590385):0.118099252,(t252:2.905394472,(t253:0.246831155,t254:0.1165829483):2.586486874):0.7727061895):0.3527820718):0.8307936686,(t255:0.4003001317,t256:0.05755381573):4.156975873):2.413766768):0.4276384535):1.505533125):2.506610887):1.757295407):1.583208451):0.9863394732,((((t257:2.597382982,t258:2.512732366):1.479519391,(t259:3.28992226,(t260:2.055670407,t261:1.917143094):1.200271658):0.6563310648):0.762282447,(((t262:1.448175244,(t263:0.9349089452,t264:0.7951152963):0.4922406643):0.7713010489,t265:1.714423296):1.906074909,t266:3.451091735):0.3926971085):3.197696814,((t267:3.525631979,t268:3.344303607):0.3063487525,((t269:2.296737817,(t270:0.8617683075,t271:0.5741795128):1.417353833):0.6690895577,t272:2.581682772):0.5762678765):3.147897818):7.164207088):0.523751182,(((((t273:2.796120149,(t274:1.341751097,t275:1.207470635):1.302851864):2.471029301,(t276:3.032784512,(t277:1.280422942,t278:1.145323782):1.697498273):1.81758381):1.297156722,(t279:0.1954631247,t280:0.1071537812):5.603019133):0.4941580742,(((t281:4.15985801,(t282:0.8085653985,t283:0.6771845406):3.189351049):0.7632781555,((t284:0.7550362574,(t285:0.6167101193,t286:0.547535913):0.1326722362):3.716984374,(t287:1.296523253,t288:1.223333675):3.050486748):0.1252905528):0.3406139267,t289:4.736868196):0.9390055084):5.709795944,(((t290:3.013756306,t291:2.983257472):3.621830801,((t292:3.448400257,(t293:1.324246911,t294:1.277836816):2.090534999):2.476988916,(t295:3.647988466,((t296:0.9574728994,t297:0.8756591765):0.7277196536,t298:1.417954821):1.800763146):1.874918617):0.6425125819):3.622699611,(((t299:4.289241983,(t300:2.258172001,(t301:1.172310391,t302:1.152852052):1.013422785):1.99060128):1.838696639,((t303:2.251384605,t304:2.249677085):1.989895687,((t305:2.427146202,(t306:2.100789653,t307:2.077615476):0.324900704):0.8797550916,t308:3.185698151):0.8950255741):1.752310297):2.437729419,(t309:1.991513999,(t310:0.7427005671,(t311:0.2741986683,t312:0.2731548965):0.4607812235):1.229287173):6.253772922):0.6924869691):0.9293199283):1.02763392):0.8367579549,(((t313:6.019880527,((((t314:0.08668389591,t315:0.05408003833):1.078093023,t316:1.090049442):2.649593021,(t317:1.970685363,(t318:1.3397706,t319:1.059162006):0.6071554699):1.6924561):0.4128300372,t320:3.76951374):1.497185658):1.362735062,((t321:1.642683847,t322:1.629074629):3.166240116,t323:4.783982969):1.729110424):1.858916966,t324:8.346354156):2.353091954):0.7928457527,(((t325:0.09330595642,t326:0.03833356997):8.399453146,(((t327:2.844489263,t328:2.808827894):4.000178469,(((t329:3.328692205,t330:3.267556031):0.6916744592,(t331:0.9517905142,t332:0.9046246146):2.856612582):1.248696771,t333:5.006794104):1.432919373):0.9566303511,t334:7.190853123):0.6046197043):0.3607993255,(t335:2.479616001,(t336:0.6542332316,t337:0.6389713091):1.772048088):5.611450192):2.494171746):0.5009723361):0.4635581093,(t338:8.266720811,((t339:1.177232399,t340:1.077511642):4.381903672,(t341:4.199996674,(t342:1.962150155,(t343:0.5535160797,(t344:0.341887086,t345:0.2710444283):0.1867793167):1.219685567):2.216178871):1.215617824):2.684502526):3.134027857):2.306841346,((((t346:2.582187749,t347:2.522830004):6.171320604,(t348:1.746787823,t349:1.716699599):6.888528705):3.425164201,((t350:1.416099306,(t351:0.6986041651,t352:0.6718580937):0.6913613545):4.3065031,(t353:3.498292529,t354:3.426895342):2.155406469):6.050137455):0.2635101012,((((t355:2.020109675,((t356:1.429569408,t357:1.039605189):0.1961606927,(t358:0.5128540273,t359:0.4116011516):0.6292420575):0.3867611358):3.754363535,t362:4.729858325):2.823178349,(((t363:3.013347827,(t364:0.804779004,t365:0.4532407495):2.021933951):0.8447731255,t366:3.314813758):1.870133953,((t367:0.2531728723,t368:0.101318021):0.981509056,t369:1.053718107):3.839759589):1.783238055):0.8319030511,t370:7.382517664):2.342274669):0.6864231805):0.829335467,((t371:1.052450196,(t372:0.4244875288,t373:0.3894924246):0.5545069442):3.223206044,t374:4.021161687):6.819988956):3.416690371):0.2582351073):0.9568426758):0.6018813158,(((((t375:1.063297753,t376:1.028901869):0.9504285478,t377:1.833841801):5.991973202,(t378:3.78905553,t379:3.539507853):3.968783046):5.374750836,t380:12.74525001):0.04601347308,((t381:0.2133588644,t382:0.1393624075):8.011565448,(((t383:0.3609244546,t384:0.1293576855):0.6269534544,t385:0.493163647):4.772418824,(((t386:1.344739773,t388:0.9796449849):1.243623309,(t389:0.7274712273,t390:0.5057586288):1.421184524):1.061041085,t391:2.948677841):1.566352951):2.186256325):4.40986331):2.643958884):5.874751192,(t392:1.155123473,t393:1.149119823):18.10234242):2.09294571,((((t394:6.885324556,t395:6.800915444):0.1587163617,t396:6.84340721):0.7266587347,t397:7.435687565):9.305302874,(((t398:1.592343259,(t399:0.1995322028,t400:0.1287082386):1.351579291):0.8679564037,t402:1.856068523):4.715399085,t403:6.505880768):9.526091718):4.254616618):51.30496864):137.6285608,((((((t404:2.533182457,t405:2.372954341):0.6889880345,t406:3.027193084):2.077168546,(t407:3.811526096,(t408:3.263725405,t409:2.941214898):0.4288944261):1.292153196):19.01780101,((t410:16.01399211,((((t411:1.208323444,t412:0.8025864857):4.825736229,(t413:3.802371968,(t414:3.275689822,(((t415:0.5549292286,t416:0.5118188081):0.4613440722,t417:0.9578442757):2.045602595,(t418:2.977665671,(t419:0.2848579817,t420:0.247064527):2.688374857):0.01337270789):0.1467786906):0.1120606613):1.825544767):0.873505348,(t421:5.373846959,((t422:0.9416675538,t423:0.815134608):1.628489895,t424:2.295755889):2.667300923):0.4157175814):8.327072358,t425:13.68132947):0.7433636332):2.425940228,(((((((t426:0.7446857327,t427:0.7256289524):2.139638448,t428:2.721705785):1.62853961,((t429:2.502222839,t430:2.476177204):1.227266249,t431:3.660219554):0.6071824814):2.947835475,((t432:2.594967917,t433:2.583509503):0.9447560924,(t434:2.778824834,t435:2.776692366):0.7273090857):3.662788423):1.728852924,((t436:4.649039008,(t437:3.034918969,t438:2.907188987):1.488991341):1.97677766,t439:6.325466164):2.143265018):0.1094141873,((t441:0.2090594417,t442:0.0389751939):4.260126503,t443:4.041373172):3.853572494):5.229200449,(((t444:4.267727843,((t445:0.6065326758,t446:0.5583301896):0.8098510812,(t447:0.2979931783,t448:0.2820050793):1.060311847):2.816443203):0.4170166024,t449:4.552175346):1.898473675,((t450:0.669541454,t451:0.5446677791):2.771801176,t452:3.314264006):2.864218629):6.446855126):2.234091453):4.997705984):15.98523241,(t453:0.06505805449,t454:0.04801618037):35.74496684):81.43658617,(t455:15.79411315,((t456:0.1247303515,t457:0.0006447948296):3.477722651,(t458:0.1350128142,t459:0.007803377542):3.158566912):12.12047239):101.2969413):87.40394351);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T29.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
