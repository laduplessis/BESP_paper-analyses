<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t475:16.85849501,(t476:13.91699911,(t477:6.538525466,t478:6.523365049):7.303183458):2.857399909):23.03012004,((((t479:0.6583865306,t480:0.5187407734):2.870976688,t481:3.344691366):0.6322619109,t482:3.865072394):3.064341743,(t483:3.669965869,(t484:0.9283206083,t485:0.878545508):2.387526247):3.248787127):32.48032372):228.9094227,(((((t486:0.5171457061,t487:0.5088324708):32.19455048,(((t488:4.565821536,((t489:0.6060847582,t490:0.5589263213):0.08330415762,t491:0.4652199083):3.684987148):1.970717452,(t492:4.321930409,t493:4.086354758):1.70163533):16.57810621,((t494:0.9079428788,t495:0.7333267357):0.8818164853,(((t464:0.2032577296,(t455:0.007808118115,(t443:0.0003962351909,((t425:0.0688735373,(t406:0.007565601113,(t394:0.01240171396,(t387:0.04832055617,(((((t316:0.07013100759,(t248:0.1845118239,(t228:0.09500544014,(t204:0.1611782268,(t168:0.1337285662,(t155:0.219717516,(t152:0.3789298566,(t108:0.1526395609,(((t84:0.1847905176,((t41:0.08067748297,t1:4.12436558):2.760384395,(t2:1.604867074,t3:1.422510611):5.222514477):0.2804007648):0.3818018003,(t4:5.690767242,t5:5.596802156):1.601321572):1.022682413,((t6:1.740079591,((t7:0.2361368856,t8:0.1962194297):0.882657464,t9:0.9690204288):0.3788354921):5.834126375,((t10:0.1376723592,t11:0.06915274597):4.093009945,(t12:3.872928921,t13:3.782186498):0.2708329549):2.781195972):0.5428822801):0.7559964484):4.460432798):0.8173753866):2.135512355):2.786396086):2.226225994):1.496940194):6.675757687):0.09614276232,((((((t14:9.839428415,(t15:6.95842335,(((t16:1.961506733,t17:1.911609426):0.1976515859,t18:1.993371977):4.759244497,(t19:1.826226515,t20:1.743203856):4.809182961):0.005599539276):2.709382069):3.950411054,((((t21:4.371408995,(t22:4.213328469,t23:4.17890989):0.1453545372):0.3272902337,(t24:0.5634311964,t25:0.399315869):4.057882838):4.378303604,(t26:1.284396288,t27:1.142219636):7.325601063):2.138388507,((((t28:0.5230823303,t29:0.2955701061):1.837909315,(t30:0.8143021726,t31:0.7902545944):1.256542898):5.003250519,(t32:1.292520026,(t33:0.2850745984,t34:0.2434411931):0.9192275213):5.615376611):1.586641091,((((t35:1.163317498,(t36:0.9789167732,t37:0.8027310936):0.04742547926):2.601940769,t38:3.071242806):1.349438835,t39:4.374604868):0.2161588788,t40:4.582136816):2.977412128):1.556071318):1.964467663):1.596808319,((t42:6.911221295,(t43:1.886877654,(t44:0.5950888821,t45:0.4367574544):1.264962477):4.920127035):0.9936365733,t46:7.614444436):4.639499137):2.285619082,((((((((t47:0.3452587011,t48:0.2474609362):0.05266746955,t49:0.2513669998):0.3184869641,t50:0.5424449104):2.047282323,(t51:0.5003662931,t52:0.4956671276):2.056102494):2.176526004,(t53:0.8387102019,t54:0.8218895527):3.850450033):4.274833488,((((t55:1.884736735,t56:1.864875747):0.829220466,((t57:0.2366087967,t58:0.1994417235):1.525214614,t59:1.65655887):0.9101866706):1.342131524,t60:3.879485797):2.193800791,t61:6.002079379):2.680516598):0.2326759391,t62:8.85154619):2.137299273,(t63:2.582219088,t64:2.541310787):8.27554589):2.944889257):3.906013297,(((((t65:3.433410194,(((t66:1.650126699,t67:1.3864085):0.7271844715,t68:2.084237319):0.4083853994,(t69:1.839060584,(t70:1.737708928,t71:1.681338889):0.05071537984):0.5450978557):0.3149978042):2.058293329,t72:4.574066205):0.6728736541,(t73:4.643715923,(t74:1.693558577,t75:1.520060848):2.865046158):0.5984244682):4.104710318,t76:9.064820517):1.929202963,(((t77:3.725123535,t78:3.622172401):4.604213517,(t79:6.028475392,(t80:4.405972533,t81:4.242663969):1.579557391):2.190056733):0.0431515216,((t82:5.317181989,t83:5.302992356):2.002042684,t85:7.037534265):0.7196617695):2.620009174):5.272270287):3.330238256,(((t86:0.2979540462,t87:0.2259189776):12.48082877,(((((t88:4.969613214,((t89:1.479985947,t90:1.319272702):0.541456198,(t91:1.55795785,t92:1.461205842):0.2451871556):2.915871605):0.3215921849,((t93:1.445335802,(t94:0.04800338673,t95:0.0319248792):1.34604323):1.594656496,t96:2.955398488):1.881069184):3.645978164,((t97:5.550119867,(t98:2.428534644,(t99:0.3276180525,t100:0.3098630828):2.093249984):2.952037786):1.289799933,(t101:3.81844258,((((t102:0.826806121,t103:0.7790509379):1.539546282,t104:2.223466809):0.2035887814,(t105:2.094658399,t106:1.912335911):0.2768468286):0.1610810785,((t107:1.184620885,t109:0.9344882328):0.4869043349,(t110:0.4530358094,t111:0.4251559441):0.9394275438):0.2994087039):1.058095916):2.614289374):1.63796114):2.546938458,(t112:7.070568431,((t113:1.04502578,(t114:0.5357658172,t115:0.5239996438):0.4055411881):1.992017622,t116:2.834204352):4.025146419):2.447978797):0.7160152834,((t117:3.343658669,(t118:2.101968136,t119:2.093033635):1.17934587):6.246509788,((((t120:0.303615154,t121:0.2966437542):0.7261769408,t122:0.8379267623):1.763428284,(t123:2.509666578,t124:2.202801632):0.09080665428):3.138932689,(t125:0.5482997808,t126:0.3925581106):4.838174853):3.563535724):0.3919094003):0.4467189742):5.164125731,(((((t127:1.856784583,t128:1.538260255):3.033723187,(((t129:0.5335510581,(t130:0.04418108599,t131:0.02172938488):0.4523157384):0.8355328168,t132:1.297011486):1.329095456,(t133:0.9738697061,t134:0.9467837206):1.469297381):1.712622927):3.037200132,(t135:2.160783589,t136:2.149525421):4.927070849):2.49381032,(t137:2.087549203,t138:2.075551774):7.471569546):1.955163446,(((t139:1.23386011,t140:1.211654199):0.6261057613,t141:1.812824149):0.1720619015,t142:1.975234012):9.395819519):2.268731268):0.965453232):3.814224746):4.593984754,(((((((t143:8.065144499,(t144:5.442410549,((t145:4.233704443,(t146:3.515877622,t147:3.132307936):0.5926337438):0.844365908,(t148:0.7408526828,t149:0.4940167893):3.478357212):0.3239605283):2.588472374):4.815901716,((t150:7.976024834,t151:7.814419167):0.2389716174,((t153:2.701550813,(t154:0.5373683021,t156:0.2310659218):1.613993959):4.183589123,(((t157:1.565009905,t158:1.497207839):2.606313234,t159:3.825439629):0.9479916174,t160:4.653978545):0.7121889126):0.7382440293):3.127973874):0.6914327006,((((t161:0.7696839533,t162:0.07697474764):2.516078334,t163:2.528923528):1.112584884,(t164:1.695010603,t165:1.636792152):1.902223445):2.458251777,(((((t166:0.2679266133,t167:0.2172668297):3.541862271,(t169:1.692736671,t170:1.680693168):1.871478451):1.018216377,(((t171:1.431877933,t172:1.390948375):0.1320204686,t173:1.444673872):2.800013615,t174:4.022478396):0.08183489798):0.1299846642,(t175:1.198092238,t176:1.039067484):2.998711707):0.01280148683,t177:4.030404107):0.7155072865):3.043023427):2.674259869,((t178:1.852022331,t179:1.840744406):3.667292554,((t180:3.52782417,(t181:1.347582968,t182:1.326235199):2.153755878):0.107449425,(t183:1.839485765,t184:1.795522742):1.743093787):1.708237745):4.869346788):0.8651792743,((t185:5.764328749,t186:5.678591703):2.652019496,t187:8.252046236):2.455190816):0.4046542808,(((((t188:1.696274714,t189:1.507426186):2.368911934,(t190:0.60551074,t191:0.561594286):3.257878178):2.37394805,t192:6.118455872):1.568570348,(((t193:2.95823574,(t194:0.1296521314,t195:0.08811160786):2.811599559):1.369339536,t196:4.250467539):3.000567103,(((t197:4.384949269,((t198:1.026094452,t199:1.022026162):0.6391158429,t200:1.467185748):2.656118706):0.5868024909,((t201:1.591117241,t202:1.521446016):0.8017904489,t203:2.035383859):2.255101403):1.945211226,t205:5.941926767):0.3112163494):0.2663342505):0.2640319354,(t206:6.550195774,(t207:5.294631097,t208:5.267854188):1.204162271):0.1853857393):2.802478162):3.255985765,(((((((((t209:0.379989352,t210:0.3599871904):1.293387752,t211:1.558124222):0.08015548265,t212:1.636755235):0.21624112,(t213:1.230319569,(t214:0.8036376754,(t215:0.2727539432,t216:0.1056634639):0.4890706194):0.3387562901):0.5609462116):1.53713706,t217:2.81797004):1.665295955,(t218:4.068736693,(t219:3.406867987,t220:3.383930323):0.6293837658):0.3943213456):4.103297897,t221:8.396658954):0.0729947681,(((t222:4.872981388,t223:4.843273362):1.532332628,((t224:1.688131885,t225:1.483651196):2.954404788,t226:4.385858406):1.458935975):0.6076406639,t227:6.37258563):1.273214558):0.7797307619,(t229:5.455829652,(t230:3.733511226,(t231:3.606901763,t232:3.594714023):0.06164135191):1.695878185):2.584131458):2.505972793):2.174770805):0.08339803493,((((((t233:2.431108388,((t234:0.5560355461,t235:0.5392091828):1.404776788,(t236:0.6554366639,t237:0.5161969936):1.24899812):0.4677337237):2.660895558,(t238:3.72331509,(((t239:0.1619603382,t240:0.1391129941):1.351952058,t241:1.408313304):0.4383048015,t242:1.803956592):1.743514529):1.156917354):1.738442058,t243:6.439187525):4.617444483,t244:11.03503072):0.1760823676,(((t245:5.508361296,t246:5.449485898):1.165413299,(t247:3.987783905,(t249:2.909834583,t250:2.851666521):0.5028914178):2.595605794):3.681208843,((((((t251:1.270537391,t252:1.196259597):0.9489039813,t253:2.112561176):1.599019489,t254:3.585758169):0.7595992309,t255:4.299172604):3.113235715,((((t256:1.094003159,t257:0.9215502319):2.223594916,(t258:2.030800139,t259:2.002173747):1.076975763):2.942453812,((t260:4.245793293,((t261:0.9059221994,t262:0.6407028808):0.490877113,t263:1.130397386):2.663798122):1.122740803,t264:4.65100897):0.6477291697):0.7224229094,t265:5.906498242):0.4115608066):0.4674980875,t266:6.764519571):1.371237914):0.6771650524):0.5791180195,(((t267:3.107741221,t268:3.075660181):1.498599383,t269:4.513458675):4.400289883,(((t270:0.2332093825,t271:0.1651589086):0.1670284618,t272:0.1811969639):7.704983092,(((t273:2.28863688,t274:2.023252034):0.2140172397,t275:2.161388508):3.442688665,(t276:4.775655117,t277:4.705837498):0.5478205085):1.705220004):0.799796429):0.1955779908):0.3798549883):1.036989892,(t278:5.611721686,t279:5.298673608):3.75209408):1.056542418):0.5931638781):0.9411838258):1.850738825):0.5325329773,((((t280:2.879875016,t281:2.876756058):0.09726217571,t282:2.844939776):2.122157477,(t283:1.101429402,t284:1.085758188):3.793725036):6.198496429,(((t285:2.244008772,t286:2.208067803):0.9147182981,(t287:2.965910001,t288:2.94606525):0.1335423976):6.805698735,t289:9.816414197):0.9365977036):2.599377697):1.15950372):1.64049062):1.073852652):0.4864038588,((((t290:0.9718655494,t291:0.864608607):5.852724081,((t292:2.884823493,t293:2.835397619):1.555847342,((t294:2.175709885,(t295:0.1738242106,t296:0.1366264312):1.991871028):1.357287848,(t297:1.448701239,t298:1.397001635):1.818981363):0.8412084958):2.138368416):1.088761994,(((t299:2.58363946,t300:2.514593876):0.7608482951,(((t301:1.049797604,t302:1.02809919):1.435848214,t303:2.46172372):0.5560010179,(t304:0.6609711617,t305:0.6571181177):2.101924153):0.2263319438):1.4584864,(t306:3.183553121,t307:3.143536679):1.064698979):2.461059178):3.31827357,((((t308:0.6831448995,t309:0.1892122011):2.137013204,(t310:0.9231009989,t311:0.874852999):1.243359795):1.403956331,t312:3.424862526):2.908100257,(t313:4.601570752,(t314:1.909008497,t315:1.879392425):2.69139508):1.547154131):2.820625157):6.457510776):1.100126315,((((((((((t317:0.5111667281,t318:0.3758818698):3.517092497,t319:3.850154697):0.2579464587,((t320:1.924967072,(t321:1.848411854,(t322:1.472456171,(t323:0.1596851691,t324:0.141379765):1.240498288):0.3162371668):0.05520491145):1.323346808,((t325:0.0501464965,t326:0.03765472222):1.632723602,(t327:0.5875985293,t328:0.5597052081):1.018128325):1.339445693):0.7791897828):0.7818020378,(t329:1.638142705,t330:1.591914877):2.83789683):1.246137619,t331:5.647488224):1.995524757,(t332:4.978532856,(t333:1.699855352,t334:1.476203081):3.17386794):2.554508366):1.24858065,t335:8.303665355):2.25215887,t336:10.47310703):2.635420096,((t337:1.066388764,t338:1.014766855):7.52973887,(((t339:1.826520898,((t340:0.01262780432,t341:0.004667597024):0.7549721138,t342:0.7022936067):1.042732696):0.9110974687,(t343:0.2363033337,t344:0.2130299607):2.396288482):0.06823793913,t345:2.50070366):5.688167685):4.377741817):0.01906699225,(t346:4.689628549,((t347:0.4564634349,t348:0.4314571793):0.8489432748,t349:1.248221216):3.363828397):7.861376385):1.603826645):3.183219779):20.4426502):9.491474759):1.406660665,(((((t350:4.8540824,(t351:3.990139698,t352:3.987272964):0.8073790192):0.5205591797,t353:5.140085403):3.578706724,t354:8.10975035):0.7491866741,(((t355:1.229574456,t356:1.214717944):1.709579903,t357:2.921477303):5.356084892,(t358:2.859135071,((t359:0.243274948,t360:0.05993693681):1.308123003,(t361:0.3984150251,t362:0.2392406596):0.8439205959):1.223852406):5.270835076):0.1847626156):17.8779168,(((t363:7.443938823,((((t364:0.7276933849,t365:0.6002443814):1.531506468,t366:2.100304443):1.956433541,(t367:1.663093592,t368:1.62702284):2.382485908):1.188081673,t369:5.034864313):2.035630588):3.925922797,t370:10.72608545):2.427169517,(t371:3.67498658,t372:3.638816702):9.407292737):11.76119705):21.01493874):0.8867650569,(((t373:8.463932748,(((t374:3.448731248,t375:3.336176676):0.7696158318,t376:3.891977862):3.144828307,((t377:4.532046628,(((t378:0.04461793125,t379:0.01281015191):0.8342938953,(t380:0.4666397734,t381:0.4656870602):0.3509398516):2.12809574,(t382:1.67521092,t383:1.517537229):1.219543375):1.482381397):1.843892416,t384:5.793716232):0.2242083629):1.098642663):0.08315336295,((t385:3.864869922,(((t386:0.883729865,t388:0.7518156307):1.701037092,(t389:0.36830343,t390:0.2976962576):2.008562357):0.2345352384,(t391:1.619007082,t392:1.591258204):0.8094010519):0.6479263392):3.034766257,((t393:1.77914499,t395:1.489477212):2.169037436,(t396:2.853110268,((t397:0.2734660185,t398:0.007531532071):1.979011811,t399:1.976707105):0.5690159223):0.7076942179):2.05660917):0.2383172237):3.647069025,(((((t400:1.145954659,t401:1.122990896):2.757513275,t402:3.798295194):0.1468407937,t403:3.812430373):2.400437965,(t404:2.826187708,t405:2.72910805):3.373157338):0.5325880841,(t407:4.859827371,t408:4.666657097):1.543748671):2.195769241):34.47616722):82.36326486,(((t409:3.921067177,t410:3.777916754):13.50281628,(t411:11.08970442,t412:11.07686145):5.986500893):50.21025015,(((((((t413:4.595327458,(t414:1.254967264,t415:1.213820675):3.228971341):6.047188495,(((((t416:1.424303486,t417:1.230967514):5.249582558,(t418:0.7152081978,t419:0.6669510331):5.667084113):0.4768069671,(((t420:1.86002834,(t421:1.356363277,t422:1.278711285):0.4606104848):1.509768963,t423:3.243972675):1.129658122,(t424:0.780710413,t426:0.4016637303):3.57284235):2.300755425):1.125139496,((((t427:2.333690895,t428:2.329248831):1.15143216,(((t429:0.1451770113,t430:0.07228611959):1.62098467,t431:1.671147883):0.74454231,t432:2.409093724):0.8482313595):2.008135094,((t433:3.173568029,t434:2.999268835):1.126675369,(((t435:1.003414627,t436:0.9449754076):0.3481938748,t437:1.264567287):0.3023901833,t438:1.528323398):2.341458436):0.9631794785):0.379421276,(t439:4.770245602,t440:4.693815192):0.3574503579):1.26019281):0.5602604581,((t441:0.7789967377,t442:0.6776112472):0.09027196773,t444:0.2340897422):5.80977686):1.511774954):1.955359024,t445:9.241762974):5.529967275,((((t446:4.857660172,(t447:2.500134982,t448:2.431473672):2.073439758):1.658117008,t449:6.099294516):1.91665773,(t450:7.615514888,(((t451:2.571786399,((t452:0.543075323,t453:0.5077905026):0.7033702421,t454:1.13558201):1.215008084):3.363683139,((((t456:0.5156482653,t457:0.3291595103):0.6778221014,(t458:0.2795046256,t459:0.2643372747):0.6741356602):0.6965823908,t460:1.620019172):2.09699724,t461:3.651254803):1.632594337):0.005821589875,t462:5.052503973):1.649452584):0.3651655691):4.88084166,(t463:1.042736237,(t465:0.689613093,t466:0.6801987708):0.004231850946):10.74527913):1.392918109):16.1469522,(t467:22.12064137,((t468:0.5311079391,t469:0.5306253789):15.91942084,((t470:5.655796107,t471:5.491033732):5.849066857,t472:11.26337924):4.919147756):5.562650841):6.673278604):0.04291148653,t473:28.20139964):15.70377243,t474:43.77561788):17.11636909):57.49911897):150.4922424);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T1.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
