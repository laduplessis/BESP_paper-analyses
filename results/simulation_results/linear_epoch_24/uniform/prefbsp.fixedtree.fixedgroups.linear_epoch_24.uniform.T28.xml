<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t437:3.881562276,t438:3.714659992):0.7172443604,t439:4.413169752):51.07750317,((t440:6.301311984,(t441:5.671938645,t443:5.562467971):0.5440319971):1.126854846,((t444:1.936658465,t445:1.930133645):0.2797405664,(t446:0.2123848899,t447:0.2109925398):1.860981033):4.896428555):47.96273636):130.7389995,(((((t448:1.436478621,t449:1.395424101):2.48813104,(t450:3.625224341,(t451:2.40839587,t452:2.289390987):1.160499253):0.2028149482):2.166865379,(t453:4.528565824,(t454:1.302009427,t455:1.183585001):3.217475067):1.231745135):14.88708956,t456:20.38732424):101.1687785,((((t457:4.469325986,t458:4.340076351):4.849572441,(t459:4.570349548,(t460:2.716393561,(t461:0.9803083739,t462:0.8652628581):1.733023471):1.752291862):4.453230013):14.50454596,(((t463:2.946620515,t464:2.868686242):7.740955148,((t465:1.023581812,t466:1.018113767):3.268321682,(t467:1.538213337,(t468:0.7687046586,t469:0.7545949684):0.7241804064):2.717394698):6.288685695):4.687970555,((((t470:2.175307153,t471:2.094831723):0.607876567,t472:2.696333324):1.461194989,((t473:3.000020023,t475:2.696067615):0.7601471475,((t476:1.25609647,t477:1.146734118):0.2882960721,t478:1.318058045):1.904705763):0.1765787702):0.6385548097,(t479:2.395680876,(t480:0.3157104965,(t474:0.0001875011393,(t442:0.02626232629,((t419:0.002131366716,(((t303:0.02263375556,(t288:0.03602985951,((t201:0.1961783469,(((t154:0.03529976659,((t93:0.09981044655,(t84:0.01376508225,((t23:0.03185204172,t1:2.260027076):3.409399458,((t2:4.537569969,(t3:0.816999746,t4:0.5606943131):3.615366521):0.8238150234,(t5:2.030382982,(t6:1.461118532,t7:1.449980434):0.4844420791):2.910748886):0.2191861513):2.743348436):1.379434157):6.072996314,(((t8:4.439709601,t9:4.278941652):5.895591764,(t10:1.895444245,t11:1.878597458):8.136263511):0.5875289048,((t12:0.8402869048,t13:0.7817848179):0.9320940157,t14:1.671282457):8.790901279):4.247854375):1.19540282):4.828974301,((t15:14.81092575,t16:14.80663498):0.8032879833,(((((t17:2.887032843,t18:2.791228872):1.480007795,t19:4.027407972):0.7582553436,t20:4.726843266):8.163567903,(((t21:3.116994376,t22:2.996151883):7.091781755,((t24:4.517875035,(t25:4.471937042,(t26:2.464439196,t27:2.290385694):1.966797355):0.02213073011):2.127016031,(t28:5.387370157,(t29:4.904560759,t30:4.854861519):0.4273335488):0.729538004):2.872357776):1.292302798,(((t31:3.320356245,(t32:2.866755969,t33:2.800147248):0.2308960837):0.0858941824,t34:3.098914767):1.992562257,(((t35:0.07462317739,t36:0.03305373257):1.617147585,(t37:0.5845298962,t38:0.4784256074):0.8551104452):0.4937282117,t39:1.759884955):2.652364347):4.738982582):1.369844288):2.039303297,(t40:3.376255926,((t41:1.701251303,t42:1.640866867):0.3763792488,t43:1.959781996):1.279040959):8.986321812):0.2676328039):5.088277866):0.9089848721,(((((((t44:5.01975908,(((t45:1.735140917,(t46:0.04759140665,t47:0.03670769863):1.479750743):0.7323955761,(t48:1.646823779,t49:1.482728952):0.556293738):1.877593445,t50:3.60115499):0.6709858382):4.132456352,(t51:5.217532245,t52:5.086858705):2.986740123):1.973307821,(t53:4.885236065,t54:4.862718478):5.141609363):2.452529122,t55:12.35300706):4.222583603,((((((t56:1.624321942,(t57:0.840912094,t58:0.8336681124):0.7372412948):0.8657885975,t59:2.301601088):1.808290502,(((t60:1.729448481,t61:1.53343309):0.3791345704,(t62:1.491100611,t63:1.346366436):0.4034219491):0.1023483046,(t64:1.113664927,t65:0.9873246623):0.6113739259):1.897701023):5.192810867,t66:8.687019835):0.06204900479,(t67:5.938755841,((t68:0.6191809144,t69:0.5157252238):0.02453748289,t70:0.4327675752):5.269829024):2.571079179):2.51061591,(((t71:3.830539996,((t72:1.999522253,t73:1.72303407):0.6972550062,t74:2.337602565):1.04946677):0.2679637609,t75:3.624980789):3.549346967,(t76:4.164141999,t77:4.049423256):2.953249188):3.016468367):4.262335968):0.0857163141,((t78:4.876080586,t79:4.785600463):4.214038789,(t80:1.830947049,(t81:1.374898775,t82:1.137074547):0.4108732806):7.148642505):5.26192461):0.03228209999,t83:13.97686224):0.5279546912):0.7111098648):0.2379169489,(t85:7.983880627,((t86:4.135760174,t87:4.084381828):2.981034393,t88:6.976008422):0.8060163019):7.004140044):6.324592104):1.804155141):1.108156065,(((t89:8.973300304,(t90:6.960976214,((t91:5.266909841,t92:5.208833487):0.4809338306,t94:5.510098948):1.146033935):1.977376263):2.202007537,(t95:10.45031863,(((t96:1.360964168,t97:1.042724906):1.314898559,(t98:1.238052399,t99:1.150214063):1.00473759):4.5113294,t100:6.456909407):3.12737726):0.3329849154):6.700031868,(((t101:13.02438821,t102:13.00813394):2.703056307,(((((t103:0.0723107706,t104:0.0008958338045):1.328464077,t105:1.294686687):8.052158783,((t106:3.521529418,t107:3.143399523):4.058256737,(t108:1.231149672,((t109:0.3420552059,t110:0.3041421703):0.5200102677,(t111:0.4792302001,(t112:0.2439781722,t113:0.1458854104):0.1662889169):0.2631668634):0.3514540579):5.490716597):1.718800603):0.5994955227,(t114:1.288938681,t115:1.187147907):7.368175462):0.1748248386,t116:8.623647213):5.234422907):0.8003660444,t117:14.65516704):0.01918427554):5.591308617):5.040510346,((((((((((((t118:0.7495601161,t119:0.6131309548):1.652768372,(t120:2.117187691,(t121:1.095168304,t122:1.074935739):0.7565528543):0.1436010803):1.406040126,(t123:0.3218149564,t124:0.3054184809):3.01667022):5.316672473,(t125:0.1313274648,(t126:0.04260898814,t127:0.03356892303):0.03401542726):8.433300048):1.189602905,t128:9.11272944):0.4419751125,(((t129:0.7739445551,t130:0.6682565141):2.556010037,(((t131:0.8843445119,t132:0.8421822868):0.3616318656,t133:1.125358888):1.142030452,t134:2.169414353):0.7930068823):3.113805802,((t135:2.704350651,(t136:0.7077364021,t137:0.2703501492):1.975847867):2.373735911,(t138:0.682303654,t139:0.6542843664):3.819871689):0.985130842):3.080878132):0.75422124,((t140:2.358891913,t141:2.268581912):1.403446106,t142:3.481434539):5.459858739):3.225963701,(t143:10.70841414,((t144:0.735069007,t145:0.7280733844):0.3171311537,t146:0.998412071):9.599216339):0.8304521637):1.16348735,(((t147:5.50186586,(t148:1.676349579,t149:1.634844608):3.813655662):1.563283125,(t150:2.3004447,(t151:0.8621940594,(t152:0.6979564572,t153:0.6599594731):0.1084604263):1.437715723):4.707459751):3.875921305,((t155:2.551631332,(t156:2.0120575,(t157:0.9555207047,(t158:0.7801356284,(t159:0.3095930386,t160:0.1201101788):0.3901087517):0.1387885639):1.037474833):0.5191497139):4.670752607,((t161:5.119007264,(t162:0.2271339951,t163:0.1882915368):4.827994384):0.9295054516,(t164:2.653977952,(t165:0.2245605834,t166:0.1671762368):2.377264855):3.265949143):0.7551130566):3.115955513):1.418338775):0.790765471,((t167:8.842191527,(t168:6.304353063,t169:6.228039711):2.431201088):0.7608216291,(t170:2.938921945,t171:2.551274448):5.715091427):1.899539887):4.736001171,(((((t172:0.7174850972,t173:0.6950756064):1.957665695,(t174:1.708078158,t175:1.662930681):0.8022646088):5.79275504,(((t176:1.373560771,t177:1.033691767):0.6989662136,t178:1.649717356):2.024188342,(t179:0.3154275669,t180:0.2790858052):3.303559353):4.096897413):3.965095205,((((t181:0.663258417,t182:0.5547782294):4.00742555,t183:4.406721084):5.037417895,t184:9.26957397):1.089804489,(((t185:4.62921497,t186:4.572004063):2.342175709,((((t187:0.09884162157,t188:0.08940634646):3.075766697,t189:3.130331992):1.184374704,t190:4.065936084):0.3882349884,(t191:1.819429304,t192:1.465248417):2.577107436):2.080978449):2.941497135,(t193:7.779249907,t194:7.652115245):1.283634719):0.3738062752):0.7715265379):2.270274426,(t195:4.184463379,(t196:3.387099445,t197:3.299430894):0.7947647067):8.148644175):0.1469047347):0.7762730235,(((((t198:2.8663117,t199:2.568032525):5.138802954,((t200:2.612343564,t202:2.193557436):0.759369138,(((t203:1.310417524,t204:1.171104061):0.378763789,t205:1.488968797):0.469458307,t206:1.955427624):0.7609725072):3.836208989):3.040030491,((t207:3.698375799,t208:3.661799533):2.221168284,(((t209:2.262914989,t210:2.031648363):0.8342341503,((t211:0.6466887249,t212:0.5453290851):0.4086365306,t213:0.9175945127):1.727285117):1.375710739,(t214:1.145736706,(t215:0.6383909175,t216:0.5889368678):0.4631375123):2.8477366):1.402084147):3.479479604):1.193509528,((((((t217:0.285709227,t218:0.174259685):0.5903386277,t219:0.7420181445):2.402310223,(t220:0.4804177873,t221:0.4056132428):2.659343644):1.364552209,((t222:2.27397999,t223:2.165883492):0.379904223,(t224:1.299962637,t225:1.225700142):1.225423541):1.587030436):0.5216660503,((t226:1.199277863,(t227:0.9992255096,t228:0.9367203943):0.173369857):1.518058114,(t229:1.022112961,t230:0.9409682024):1.588737764):1.767951273):4.6249183,t231:8.890591199):0.1144504432):0.5138933185,((t232:0.2186444549,t233:0.187595209):1.785894118,t234:1.892162474):7.241606935):0.1881242844):2.754901587):4.8772808):2.206155645,(((((((t235:0.4163124835,t236:0.3205745634):3.963463948,((t237:1.504884985,t238:1.490461137):1.854197984,t239:3.213098964):0.9088258733):1.297596884,(t240:3.407321619,t241:3.403443402):1.984660673):3.767230917,((((t242:1.198745408,t243:1.124615769):2.15879615,t244:3.223079856):3.019358314,(t245:2.276351395,((t246:0.09346580805,t247:0.09223759707):1.646070596,t248:1.696522491):0.4898924804):3.953016756):1.510932124,((t249:0.5266334843,t250:0.3829547959):0.9265399267,(t251:0.0742964621,t252:0.02758328359):1.215025821):6.146298641):0.9920621131):1.349824762,((((t253:0.6381047681,t254:0.6199028312):2.233574533,t255:2.76315734):0.5886707042,t256:3.320875541):4.484453725,(((t257:4.708783644,((t258:1.946963046,(t259:0.9785070356,(t260:0.02139651088,t261:0.001628176888):0.83409588):0.9526578483):0.8521833764,t262:2.63210343):1.607329839):1.123233755,(t263:3.224784835,(t264:2.511077075,((t265:1.398149686,t266:1.329676926):0.929703089,(t267:1.504440057,t268:1.434290033):0.7086757694):0.1723751947):0.7137013503):2.070433082):0.7523432949,t269:5.753502277):1.110243076):1.766581353):3.831606943,((t270:2.425329773,t271:2.353332028):3.413798273,t272:5.519526729):6.572619064):2.107183884,(((t273:0.1930245564,t274:0.1810838788):4.792772077,t275:4.951460802):3.640155611,t276:8.449931426):5.492167428):2.391066208):0.03249374897):2.21351824):0.9337383733):2.044045192):1.592738521):10.27013441):7.799118026):66.41883546,(((((((((((((((t277:0.2175946876,t278:0.05723640904):1.751930445,t279:1.740840866):2.367880926,t280:3.995586026):2.508733086,(t281:1.420874835,t282:1.280446848):4.960795328):0.8460765832,t283:7.025055524):0.7970084982,(t284:1.776052083,t285:1.574269724):6.034067008):0.4894644428,(t286:3.660218245,t287:3.467297918):4.394757181):0.8555336712,(((t289:1.496332318,t290:1.480451514):5.760268493,t291:7.222975826):0.1725408,(((t292:2.418797795,t293:2.116655012):1.033522818,t294:3.060416902):3.477455523,t295:6.499251515):0.2709249136):0.9159990096):8.69647452,(((((((t296:3.58234931,(t297:3.088814114,t298:3.027019732):0.4001714747):2.201002478,(t299:1.092536199,t300:0.9592068116):4.516700747):1.030076882,((t301:0.6893203213,t302:0.5344983354):0.7073248503,t304:1.146535513):5.043135749):0.1599272429,t305:6.268271017):0.6927728015,t306:6.955502889):4.942604554,(t307:10.12558683,(t308:0.6611145127,(t309:0.4582322059,t310:0.3527994851):0.1986789276):9.391287176):1.698865886):1.470574174,((t311:6.523235502,(((t312:0.150986765,t313:0.1451640823):3.53327823,((((t314:1.42462252,t315:1.394032468):0.8781187142,(t316:1.20386334,t317:1.051902079):0.5440857304):0.3761465753,t318:1.857440626):0.2912220851,t319:1.968936772):0.6960809585):0.4054747278,((t320:0.1680756393,t321:0.06829389743):1.520388987,t322:1.529668163):1.313087774):2.397255193):0.07649702535,t323:5.266238953):6.503086563):2.05217695):4.504851814,((((t324:0.5330942251,t325:0.4177796925):5.005444891,(t326:1.335036478,t327:1.30691457):4.067304804):0.5024335772,(t328:4.851556526,(t329:1.783717721,(t330:0.8842234433,t331:0.6522351441):0.8309926105):2.905611487):0.8828793272):2.886757191,t332:8.115854682):9.379832456):3.249940196,(((((((t333:0.5051155507,t334:0.4769541139):0.1264582293,t335:0.3529443326):0.4845394933,t336:0.7429231106):2.393134447,t337:3.113050736):2.916552895,((t338:1.942688802,(t339:1.630031633,(t340:1.002511366,t341:0.8642268732):0.2673674102):0.3005392025):2.2031869,t342:3.46395885):1.79097296):1.892463128,((t343:2.377590663,t344:2.330541396):2.669820581,(t345:3.947397542,t346:3.736915569):0.9219210197):2.041442958):12.0129249,(((t347:3.072133737,t348:2.999159323):1.065468436,((t349:0.1594882978,t350:0.1458953943):3.258025762,((t351:1.584652956,t352:1.52988979):0.8931423214,(((t353:0.8849338098,t354:0.8082270581):1.255785241,(t355:0.612422266,t356:0.5072687184):1.308525564):0.05745693455,t357:1.803054668):0.2214447758):0.8642457918):0.6017080502):7.849187128,(((t358:2.18831689,t359:2.142364451):5.370938507,((t360:0.9841074511,(t361:0.4797245277,t362:0.4303616355):0.3523535003):2.259260304,t363:3.038210424):4.261803459):0.03775618915,(t364:3.156948122,t365:3.124779415):4.026001358):3.650875451):6.573819667):0.3054682305):0.4719686566,(((((t366:0.9552751943,t367:0.9551217562):1.742381468,t368:2.631443961):2.97282064,(t369:5.202233886,(((t370:4.105486789,t371:4.091005946):0.04222438983,t372:4.044548962):0.4878048724,t373:4.523707158):0.5271780867):0.2952718541):2.653242147,(t374:1.506857433,(t375:0.1710908539,t376:0.1295040004):1.330491648):6.433051468):4.904874611,(t377:5.420998718,((((t378:0.50424888,t379:0.2788578073):1.008972368,t380:1.24202926):1.877866623,(t381:1.255348522,(t382:0.4680000904,t383:0.2923664862):0.7423502701):1.849706927):1.162910309,t384:3.888135524):0.8080083195):7.362878241):4.838991949):3.110565402,(((t385:4.442131627,t386:4.417301556):1.309445338,t387:5.686986254):2.905936027,(t388:4.398939192,((t389:2.830322424,t390:2.669539424):0.9940486578,t391:3.585712319):0.5683325948):4.105794259):11.23923418):1.128281281,(t392:10.55090463,(t393:5.109340903,(t394:3.47694604,((t395:1.43738142,t396:1.335260052):1.489348003,t397:2.739400941):0.3320933276):1.390138856):5.301079344):9.805315761):19.94549504,(((((t398:0.2964212055,t399:0.2823143279):8.909935773,((((t400:2.712682967,(t401:0.4565425722,t402:0.4176014804):2.114443389):0.6910941972,t403:2.65984132):2.722871227,t404:5.346430646):1.413195066,t405:6.600920451):1.620853984):2.136336792,t406:10.3509976):0.8382696771,(((t407:3.369775137,(((t408:0.3772262273,t409:0.2187318782):0.5472098372,t410:0.6708061537):1.42394198,t411:2.062304098):0.8100413709):3.919802708,(t412:5.635858163,t413:5.620991863):1.041609525):0.5014282485,((t414:5.562615517,(t415:4.272826495,t416:4.045119771):1.274990743):0.5925622703,(t417:5.038949531,((t418:1.155125423,t420:0.6605709355):0.2099933785,(t421:0.6095090026,t422:0.5537596779):0.2590683091):3.510593098):0.8696055194):0.9703883281):3.390465462):1.908575173,(((t423:2.825522181,(t424:2.214958172,t425:2.076453602):0.1358919276):4.228048534,(t426:4.055445234,((t427:0.9865053213,t428:0.9614167629):0.6117940019,(t429:0.7334877635,(t430:0.1920750521,t431:0.06034594752):0.5214081047):0.7536897971):2.407338468):2.266597248):1.540166334,(((t432:1.583215203,t433:1.464829118):1.439560155,(t434:0.567422203,t435:0.5670087927):2.202753162):3.370380381,t436:6.013741983):1.047641756):2.850293986):25.36710027):56.55195065):31.26314444):63.47073595);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T28.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
