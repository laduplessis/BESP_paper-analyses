<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t440:10.67953821,((t442:5.288987224,t443:5.228972557):3.900141362,((t444:5.680475476,(t445:4.53644561,t446:4.381236086):1.008904728):0.008171914669,t447:5.330543869):3.286248886):1.421783899):6.261692964,((((t448:0.9399727399,t449:0.84608035):2.463078493,(((t450:1.582869721,t451:1.497360608):0.3947322091,t452:1.607894206):0.7093807329,t453:2.29742723):0.5938131266):0.7166952491,t454:3.578412189):5.794928921,((t455:2.943833981,t456:2.851786193):3.378882498,((t457:2.702819901,t458:2.667092891):0.3709617559,t459:2.91223953):3.136906511):3.006860936):6.345676179):56.94294199,(((((t460:2.122202231,(t461:0.8159838138,(t462:0.2331496842,t463:0.05035949884):0.5403395132):1.293126449):9.183118098,(((((t464:0.6261861035,t465:0.552864837):0.1537358307,t466:0.6208663203):1.028371294,(t467:1.322664483,t468:1.132281113):0.3177475356):0.6033036006,t469:1.805943013):4.900606875,t470:6.706286103):3.614878297):2.640543255,(t471:1.328326931,t472:1.115824803):11.62466068):5.325900497,(t473:2.062645718,t474:1.938657749):15.9894024):11.38879632,(((t475:2.515033811,(t476:2.21287094,(t477:0.756571688,t478:0.7170913277):1.455936279):0.2124945068):5.690230576,(t479:6.182680478,t480:6.171908929):1.87628985):9.675891996,t481:17.61666463):11.28798538):41.04465177):11.32475861,((((t482:12.45356368,t483:12.41498705):16.50712202,(t484:23.27874284,(((t485:1.373444287,t486:1.294484103):9.537362136,t487:10.56300361):9.59300658,((t488:0.9747042332,t489:0.9269121366):1.044767873,t490:1.892390344):18.01758345):2.477438959):5.589605721):7.72845601,(((t491:0.8608265005,t492:0.8527317054):1.208314709,t493:1.935104239):5.049569789,(t494:6.457079794,t495:6.421524538):0.2997446403):28.53117466):35.69892739,((((t496:0.07953294298,t497:0.02393934528):4.190544693,t498:4.190541595):3.068445582,((t499:1.492648282,t500:1.447571643):3.267930807,(((((t441:0.02922003713,((t355:0.04870322927,(((t242:0.04463007816,t243:0.03516427896):0.009769935113,((t194:0.03746728411,(t164:0.0328518932,((t100:0.08663869658,(t76:0.1952011084,(t60:0.02474429374,(t1:3.458520762,t2:3.438730722):1.115707269):1.405098066):2.685991938):1.358962028,(((t3:2.396641237,t4:2.251710553):2.438341975,(t5:1.174301729,t6:1.116461825):3.504785784):2.197045644,((t7:1.376219229,t8:0.9823870144):1.879921463,t9:2.729821085):3.49840768):2.823903196):4.591418403):2.265869083):4.201042814,(((t10:6.765260751,t11:6.73505898):6.558720066,((t12:3.155490628,t13:3.049597542):7.781330569,(t14:9.397735916,(t15:6.990694517,t16:6.976624114):2.404955741):1.415696583):2.130467901):0.1293107523,((t17:11.10716875,(t18:8.276712427,((t19:1.527629205,t20:1.51876567):2.113979484,t21:3.419491427):4.607795469):2.807776641):0.08844941498,(((((t22:0.4440672258,t23:0.3817704036):2.734158526,(t24:0.4415996278,t25:0.3721835011):2.627503732):0.1312428775,t26:3.126314051):3.002829716,((t27:2.236546345,(t28:1.733013798,t29:1.640489144):0.4796677724):0.7504956312,t30:2.677889878):3.137542728):2.36626688,(t31:1.192655677,t32:1.187554889):6.859547735):2.199889115):1.740376937):6.630276445):1.078350532):0.5545161228,((t33:14.01383336,(t34:11.00017312,(((t35:0.08142785288,t36:0.06949941653):5.434570825,(t37:5.272493511,t38:5.268922529):0.1571194031):3.156261105,((t39:3.895297406,((t40:0.4032040631,t41:0.3625561583):0.4806248546,t42:0.8328576616):2.945221354):1.173488979,(t43:0.5039081208,t44:0.4831587102):4.421715195):3.405118279):2.245798167):2.637943943):2.7621358,((((t45:4.623978744,t46:4.619879653):0.9218198732,(t47:1.653006821,t48:1.407518464):3.867860435):7.865128842,(((((t49:2.457228766,t50:2.423276735):0.4073447097,((t51:0.209558038,t52:0.1873342907):1.532511763,t53:1.706643331):0.942777633):2.759396232,t54:5.302142878):2.703761872,((t55:0.337018044,t56:0.2675283647):2.05098636,t57:2.292817145):5.571998796):1.548828416,((t58:7.102690487,(((t59:3.576896921,(t61:1.262406818,t62:1.243501912):2.199989061):0.5283313298,(t63:1.748996072,((t64:1.60718299,t65:1.478132941):0.04247733183,t66:1.331087929):0.08222539953):2.222344578):2.85898171,((((t67:0.9904677796,t68:0.9857684022):0.4000771259,t69:1.191084245):0.7636565532,(t70:1.085497354,t71:1.04805202):0.8142698206):0.7364596764,(((t72:1.319539006,t73:1.136314187):0.193107848,t74:1.28266519):0.875575838,((t75:1.300237941,t77:0.9740951102):0.005658709807,t78:0.9238407191):0.764061515):0.1241683924):3.579158267):0.1319807357):1.796829633,(t79:4.800579066,(((t80:0.4869060691,t81:0.3901771142):0.9517361824,t82:1.132979831):0.865713517,t83:1.935219418):2.374876321):2.440583338):0.3145175047):3.181099948):1.68141559,(t84:3.448023264,t85:3.421908099):8.333412439):0.691237317):3.448101914):10.77346876):3.669284635,(((((((t86:4.168802739,((t87:2.057961767,t88:1.929894989):1.201623376,(t89:1.189459767,t90:1.125323268):1.918369794):0.8589074257):0.4527659022,t91:4.299222235):5.828351732,(((t92:0.2011052055,t93:0.1477930794):0.7765176971,t94:0.701453766):4.061713546,(t95:2.214837048,t96:2.150945019):2.150438003):5.02550317):7.629146449,(t97:4.325470958,t98:4.288402619):12.41031712):1.056622167,((((((t99:0.425983317,t101:0.1033124135):4.383274119,((t102:2.661503103,(t103:2.404558307,((t104:0.4606074299,t105:0.3758398494):0.1501060314,t106:0.3310627871):1.365906348):0.05586940435):0.337368068,t107:1.978737017):1.292487817):0.1816917547,t108:3.039225959):0.7491513766,((t109:1.309567315,t110:1.295013578):1.277110342,t111:2.240176962):1.103849402):0.7536385662,(t112:2.596600979,(t113:1.95620573,t114:1.90085598):0.6359841698):1.446539287):6.031240902,(t115:5.230603233,t116:5.21530988):4.762142415):5.003094092):2.020277738,(((((t117:5.638947351,(((t118:2.471776802,t119:2.364740983):0.1613870048,(t120:0.5377524986,t121:0.5370547047):1.985441178):2.298871308,t122:4.568588548):0.6744324184):3.386391629,t123:8.475196051):1.191163195,(((t124:0.2822708509,t125:0.2247083442):5.345677158,(((t126:2.482067902,t127:2.476414505):1.198775862,((t128:2.960003935,(t129:2.23084976,(t130:1.303373952,(t131:0.1124461601,t132:0.06333408041):1.15700997):0.9090980771):0.592816167):0.2193969353,t133:2.812994384):0.4348115121):0.2110962139,(t134:1.929789401,(t135:0.3410219501,t136:0.2992982112):1.587317921):1.389804091):1.550898849):3.089744008,((t137:4.840017013,t138:4.830453836):2.869994484,((t139:5.433042636,(t140:2.429437271,(t141:1.96720477,t142:1.931152225):0.4126421226):2.890313271):2.087649101,(((((t143:0.2244033519,t144:0.1449099941):0.488581202,(t145:0.5024105739,t146:0.5020454111):0.1268678889):3.286536642,(t147:1.824488042,t148:1.644470392):1.926931753):1.290933415,(t149:0.2542332552,t150:0.2379619504):4.587397242):0.7896753611,(((t151:1.033536547,t152:1.016475469):4.147261543,(t153:1.62853226,(t154:0.800869482,t155:0.7499933666):0.8093567327):3.518301274):0.09996473525,(t156:4.449095427,(t157:2.273780874,t158:2.045285453):2.140032739):0.6347551277):0.2508729423):0.9667882641):0.1761419537):0.05649905322):0.8032245012):1.232517864,(t159:5.978186607,(t160:1.898517582,t161:1.741951369):4.06632303):2.289925983):2.502893905,t162:10.56340375):3.014012408):2.939208269,(((((t163:4.429036869,(t165:2.787535929,((t166:0.8566852023,((t167:0.2427693886,t168:0.1274279008):0.1118383822,t169:0.230686931):0.4350623485):0.006372454167,t170:0.4375062573):1.889171325):1.381045534):0.6777148013,((t171:0.151810937,t172:0.1476489114):0.1519936216,t173:0.2195111666):4.01609511):1.684872017,((t174:1.752956632,t175:1.690593832):1.583515558,t176:3.171016088):2.561238463):3.242581223,((t177:2.445637351,t178:2.349653207):1.500393252,(t179:0.9347443981,t180:0.8397955596):2.906400182):4.957073983):2.619971562,((((t181:1.945564518,t182:1.839577106):0.1361105446,t183:1.939732329):1.827443347,(t184:1.796927439,((t185:0.5579232627,t186:0.2904863853):0.8715646213,(t187:0.2936415712,t188:0.2930141103):0.8017372076):0.3277516218):1.905375815):0.147351622,t189:3.438090909):7.126206104):3.839353062):6.094266412):5.080603755):1.3981905,((((((((t190:0.8917742455,t191:0.8892925149):1.84585566,t192:2.640292466):5.036226862,t193:7.644534914):1.987827724,(((t195:0.2409510351,t196:0.2174384556):2.352851519,t197:2.513301461):5.709527447,(((t198:0.8787600806,t199:0.840841701):5.987533068,t200:6.801777711):0.1636299008,t201:6.886339124):1.066449971):1.075060216):0.8534582425,((t202:0.3513175157,t203:0.2879002743):5.38630697,t204:5.478912778):4.000033008):4.881257883,(((((t205:8.478664856,((t206:1.213972523,t207:1.051911052):2.278994841,(t208:2.690804095,t209:2.570220041):0.5524013006):4.972336139):0.9441399256,((t210:2.136161425,t211:2.05321591):0.6008438743,t212:2.614959736):6.248813831):0.3925870796,(t213:3.876068217,t214:3.74077604):5.376607921):0.8529507056,(t215:4.877391314,(t216:2.290185485,(t217:1.307661627,t218:1.07446945):0.9460510462):2.442074173):5.082181967):2.054339262,(((t219:1.735489603,t220:1.671001613):2.957741474,((t221:0.5684843574,t222:0.4981749061):0.4442715916,t223:0.8382079014):3.437152789):0.9766831965,t224:5.173535499):5.896979291):1.542365354):0.8704233711,((t225:4.745741906,t226:4.399487346):6.184005889,(t227:2.170812406,t228:1.954204522):8.401201091):2.547021919):7.378668726,(((((t229:2.251616685,t230:2.247564973):4.574414581,t231:6.499232336):0.0167094475,((t232:1.238749661,t233:1.126553312):2.38536541,((t234:2.528314951,(t235:2.413216949,(t236:0.07573027536,t237:0.006105338225):2.150229101):0.03188350528):0.7365882074,(t238:2.284884951,t239:2.235118842):0.5829916471):0.1281546581):2.626061923):8.39091319,(((t240:1.424233099,t241:1.2575581):0.8936644225,(t244:0.4383693252,t245:0.01539056779):1.409166217):7.826137331,(t246:1.601661194,t247:1.53924033):7.290144334):3.53584061):0.7256971845,t248:12.96921207):4.187081594):3.230528315):2.387773991,(((((t249:0.9673507043,t250:0.956207622):5.313094432,(t251:4.815525602,(t252:0.5629542379,t253:0.5566084322):4.247043799):1.37480287):5.795755356,((((t254:1.05789922,t255:0.870350336):4.017098863,t256:4.854675172):2.414214422,(((t257:2.512620428,t258:2.488970727):4.058134514,(t259:4.034878925,((t260:1.021174986,(t261:0.222642077,t262:0.141412719):0.6943444677):0.4657969027,t263:1.235759683):2.519749363):2.376396199):0.1626137886,t264:6.011982824):0.4018226064):1.453143129,((t265:0.2612456793,t266:0.09063655666):6.713839307,t267:6.474380449):0.7710481033):3.022852334):1.702190366,(((t268:3.282480593,t269:3.126971666):1.511919793,(t270:3.66494653,t271:3.553579762):0.8571686372):0.5340790719,(((t272:1.674066642,t273:1.645786847):0.8337148804,t274:2.335145055):1.381117072,((t275:1.585537159,t276:1.487114006):1.148270844,t277:2.563327842):0.9551786479):0.875211255):6.610291484):3.691073529,((t278:5.660679248,(((((((t279:0.2846112959,t280:0.1488954425):0.3303833727,t281:0.391034222):0.4517785042,t282:0.8021219381):0.002648553605,t283:0.7182425337):1.499906484,t284:2.189341909):0.1143319944,t285:2.027992543):1.651370216,t286:3.37096035):1.275226603):4.954564226,(((t287:0.6859963946,t288:0.6632803702):0.4622816195,t289:1.096230117):4.488293493,t290:5.522774242):3.897131009):4.064629014):5.157586273):3.114673384,((((t291:2.707041471,t292:2.529724101):5.307310696,(t293:5.183367628,t294:4.913922057):2.63293114):5.998992971,(((t295:0.2211374632,t296:0.2034587982):0.701137722,t297:0.8980568788):9.450352671,(t298:3.93297178,(t299:1.428174887,t300:1.411112636):2.474160283):6.316405485):3.150578305):5.267878244,((((t301:2.414294033,t302:2.398883099):4.605383182,(t303:4.399199728,(((t304:0.490410946,t305:0.3483030295):0.3556355951,t306:0.6696536878):3.284717411,(t307:2.578528641,t308:2.565022722):1.175175173):0.2368964719):2.587879971):0.1016841606,(t309:0.5030497934,t310:0.4782382918):6.002093311):10.23410487,(((t311:0.05413065736,t312:0.02943201295):4.24566153,((t313:0.8429285608,t314:0.6682344636):0.140269402,t315:0.6608290899):3.285366934):4.64274725,(t316:4.218229859,(t317:3.687676994,t318:3.392980736):0.217971419):4.287784433):7.718390806):1.213580649):2.399772692):2.376037297,((((((t319:1.390446904,(t320:1.257919931,t321:1.22519859):0.05596174198):1.104027169,((t322:1.40161423,t323:1.279928466):0.9033743497,(t324:0.4513069155,t325:0.4098816035):1.455780924):0.07789826):5.862609658,(t326:5.913781277,((t327:0.1793837197,t328:0.1480045118):2.459755152,t329:2.593420522):3.174549936):1.774288075):3.596313237,(t330:1.619352382,t331:1.279255863):9.309034498):0.7195243508,((t332:3.012600105,t333:2.810280301):7.522130504,((((t334:6.597191158,((t335:2.240043592,(t336:2.089942262,t337:1.98803227):0.1129260962):2.502200871,t338:4.547986632):1.837326107):2.354124285,((t339:2.210591846,t340:1.760562332):2.335909962,(t341:0.5131160501,t342:0.458180267):3.511831334):4.153924497):0.8407252226,((t343:1.505739331,t344:1.478704554):3.87337716,((t345:1.925600622,t346:1.724178194):1.559893788,(t347:0.1705812638,t348:0.1572280524):3.102733871):1.864777184):3.46502503):0.07742584891,t349:8.648214852):0.3685940644):0.7656685277):8.638587551,((((((t350:0.872588966,t351:0.8082280671):2.140492965,(t352:2.459811879,(t353:0.3437022624,t354:0.3036866501):2.012406818):0.3670506271):4.977547371,(t356:6.568781357,(t357:4.090549152,t358:3.958330412):2.424302605):0.9586898944):1.035013458,(t359:1.939600994,t360:1.867148609):6.353739775):3.59475398,((((t361:1.268784875,t362:1.116095122):0.8875682471,(t363:0.4003985592,(t364:0.08964272408,t365:0.04298366333):0.2122389983):1.388151898):2.960309645,t366:4.17264326):6.379341548,((t367:0.3794373805,t368:0.3614200028):5.58302998,t369:5.939083098):4.257791711):0.2798724228):3.400132971,t370:13.81461443):2.282038691):0.1209034472):1.162313534):2.454877668):2.79023104,t371:22.21466822):60.60696759):8.86033378):29.10603338,(((((((((t372:3.314100421,(((t373:0.7390542116,t374:0.5125491533):1.62413886,t375:1.942248857):0.3988034057,t376:2.291931853):0.525876295):0.9634930175,(t377:2.222427801,(t378:1.739165969,t379:1.716106717):0.4548319587):1.556126035):0.560241301,t380:4.13070397):0.1620951279,((((t381:0.5966492117,t382:0.5843098874):1.395934586,t383:1.968408982):0.1342127955,((t384:0.766965279,t385:0.7409657548):0.04492851652,t386:0.7204025019):0.9814363041):1.032784278,(t387:1.519569149,t388:1.223818431):1.188439002):1.050432637):1.472748645,t389:4.837546277):2.330020448,(t390:4.952525,t391:4.907062486):2.082238152):2.829005539,((((t392:2.806777424,t393:2.729581036):2.009007588,((t394:0.3857055425,t395:0.3773013705):1.408680878,t396:1.75978581):2.931749281):1.313098538,(t397:3.005487023,t398:2.987039711):2.973500616):2.551891032,((t399:1.615568934,t400:1.598718574):6.084016874,t401:7.609683333):0.7743029744):1.066108599):1.620378934,((((((t402:2.608054777,(((t403:1.050129651,t404:0.8457432817):0.3779398604,t405:0.9244858231):0.7812286271,t406:1.702073622):0.2967215547):0.0182503643,(t407:1.796241273,(t408:0.5799127382,t409:0.511166794):1.060183875):0.02539075508):4.000130005,((t410:0.3715178166,t411:0.2508483921):3.74949652,(t412:0.6050393,t413:0.5916637681):3.307405109):1.344242469):0.7160205692,t414:5.941284238):0.2980496202,t415:6.16111371):2.910128239,((t416:1.604510829,t417:1.423821683):0.920368842,((t418:1.853064921,t419:1.81535098):0.1751359478,t420:1.94094531):0.08939136144):6.518539607):0.5095506554):19.64056357,((((t421:0.9159500657,t422:0.8291159396):0.3676069452,(t423:0.6362326012,(t424:0.2456138496,t425:0.1801198999):0.1053395879):0.4806501018):4.504779992,((t426:1.081964109,t427:1.054760528):0.7417500052,t428:1.52994957):3.42717945):20.66661202,((t429:1.98784654,t430:1.986138152):7.481609512,(((t431:2.469355002,(t432:1.676774903,(t433:1.322321861,t434:1.237649934):0.3229856032):0.6516956054):0.3406387001,t435:2.389494064):3.444009596,(t436:1.991080395,(t437:1.032276195,(t438:0.386272921,t439:0.1085448221):0.3485818782):0.8571987139):3.772957852):3.187304348):16.13936383):2.18360116):87.81623584);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T51.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
