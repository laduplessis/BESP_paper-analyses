<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t442:2.370511685,(t443:2.035691849,t444:1.948043061):0.3090874123):18.17607835,((((t445:2.128516258,t446:2.09131972):3.178047106,(((t447:0.2557461189,t448:0.1995391819):1.495461726,t449:1.673661127):1.454028869,(t450:2.538364158,t451:2.337499132):0.5719117905):2.001968209):0.1025034016,(t452:3.17779508,t453:3.121975211):1.811165505):2.109747983,(t454:6.592648255,t455:6.468368602):0.3732921762):12.80878826):2.425247686,t456:22.06492884):0.7547691059,t457:22.60999758):86.57138263,(((t458:3.172736544,(t459:2.301415128,(t460:0.9496137614,t461:0.9297211462):1.024255824):0.68003336):9.296520086,t462:11.90637226):11.89021962,(((t463:0.06062091679,t464:0.05173493481):1.629184895,(t465:1.443255284,((t466:0.4720193912,t468:0.3929540594):0.2800889238,t469:0.5435561905):0.639252451):0.2020729629):14.33413156,(((t470:7.132020932,(((t471:2.031274724,t472:1.956287492):0.5731469171,(t473:0.5312828387,t474:0.4520665717):1.897607576):3.011667524,((t475:2.245648339,(t476:1.891303365,(t477:0.746192275,t478:0.6237338822):1.076054287):0.3224534626):2.174655526,t479:4.02543553):0.6045065746):1.503452804):0.2710581967,t480:6.377589227):6.168427682,t481:12.37031501):2.087929969):7.548160858):84.71820273):2.94131791,(((((t482:2.398339821,(t483:2.030173024,t484:2.019780798):0.2893390177):10.1068541,(((t485:4.105859086,t486:4.065257521):0.4224010899,t487:4.419247746):2.147582121,(t488:2.177349585,t489:2.176521333):4.040688818):5.619782129):25.62311647,((((t490:4.922968256,(t491:2.364282253,(t492:1.585842707,t493:1.434812593):0.7263820319):2.506606177):1.499316875,(((t494:2.186524596,t495:2.076754008):0.5486022842,t497:2.319861576):2.621076679,(t496:0.05946997605,(((t467:0.02297400519,(((t364:0.07404549681,(t365:0.04499782998,(((t281:0.03266981019,(t270:0.05565819497,((((t219:0.0110091964,(((t110:0.1370498477,((((t1:2.630451963,t2:2.589034251):2.505209002,(t3:3.386359073,((t4:0.7895704227,t5:0.6059663495):1.913128137,t6:2.417675937):0.6115121779):1.682674717):3.671606271,((((t7:5.611359268,(t8:1.609382933,(t9:1.372269333,t10:1.166960771):0.2223327616):3.843026039):0.04628324892,(t11:0.212914456,t12:0.1814742269):5.036919587):0.2994264492,(t13:2.522372911,t14:2.404164153):2.838382737):1.819755966,(t15:6.764410475,t16:6.600411369):0.1788624626):0.5880268814):0.0612272123,((t17:4.572233933,(t18:0.6039430664,t19:0.5959717741):3.792874807):2.343162218,t20:6.526139869):0.4959811503):0.6268279916):2.432989623,((((t21:3.481581174,(t22:3.208737147,t23:3.208405312):0.1348323901):3.147757332,(t24:3.331297758,(t25:0.6407438927,t26:0.6243751115):2.673380537):3.069300872):0.7574583627,t27:6.902851281):2.3885099,((t28:4.537099587,(t29:4.071948545,t30:4.020819517):0.2323465522):3.127901534,(((((t31:0.6025754295,t32:0.5822661917):0.08581057779,t33:0.5824146891):2.618788538,t34:3.11331909):3.59882016,(t35:3.293786274,(t36:1.451933461,t37:1.447241494):1.681274049):3.327172502):0.0247060065,t38:6.432794276):0.3789355771):1.431621458):0.2593062792):0.3636948567,t39:8.73867112):6.925598817):0.09546465797,(((t40:4.512411295,t41:4.47525935):0.04330723116,t42:4.314321244):4.257491699,((((t43:0.2378752223,t44:0.1286918676):1.545271616,t45:1.580582261):4.708618643,((((t46:0.1736184033,t47:0.07321700088):0.2939352451,t48:0.3222255039):3.604108763,((((t49:0.2283332115,t50:0.1161342636):0.1154399742,t51:0.1589557193):1.18087776,(t52:1.144569124,t53:1.121111195):0.1460551493):2.12525212,(t54:1.246287493,t55:1.098045965):1.806306418):0.1530636329):2.054182493,t56:4.989732346):0.04247669781):0.5571464077,((t57:1.51556636,t58:1.452916128):2.76358117,(t59:3.510496107,((t60:2.569835926,t61:2.536152645):0.3302540465,t62:2.823526894):0.376695671):0.6212481501):1.297964105):1.464100565):6.845998002):2.671608779,((((t63:5.585496072,t64:5.452647902):7.329440033,((((t65:1.778831375,t66:1.774039148):3.931594848,t67:5.657927935):1.655621545,(t68:1.570571426,t69:1.412955068):5.740889562):0.5029563981,t70:7.398834707):4.910063019):0.5716351161,((((t71:0.9687893741,(t72:0.4379209503,t73:0.3372234627):0.4229322241):0.6894747459,t74:1.419653572):3.857878935,(t75:1.275972215,(t76:0.7260257412,t77:0.6905690344):0.3742202805):3.929533545):0.3224455064,((t78:1.005729497,t79:0.9123437289):3.997462867,t80:4.764705992):0.3107377289):6.904666045):2.584589593,((((((t81:7.657491761,((((t82:0.7260271643,t83:0.7175091376):0.5842863472,t84:1.251316285):0.0799085371,t85:1.239197158):3.865122936,t86:5.046169431):2.298735836):1.822351988,((t87:2.004585904,((t88:1.016177238,t89:0.913035867):0.6591984432,(t90:1.255484465,(t91:0.7507297763,t92:0.7447446485):0.4591316084):0.2797641126):0.1670383726):0.6016767892,t93:2.14627981):6.405205165):0.7709539558,(t94:6.86774442,(t95:5.036354881,((t96:1.51821942,t97:1.468406743):2.915194557,((t98:2.439129622,t99:2.404324231):1.695593135,t100:4.083925025):0.206706235):0.5432475699):1.830846169):2.450734477):0.8739576393,((t101:1.152485983,t102:1.056393766):7.843549881,((((((t103:1.220745447,t104:1.218530706):0.8149703425,t105:1.927594397):0.8052960414,t106:2.537961334):1.530417706,t107:4.041559564):0.2490637657,(t108:2.569589752,t109:2.54186547):1.504022222):2.48572199,(t111:0.8755796815,t112:0.8055869716):5.236761075):1.763414038):0.9676097051):1.64124939,t113:10.24930845):0.9926257436,(((t114:2.483421566,t115:2.387097059):0.02422921121,((t116:0.8133553093,t117:0.7301936796):0.6259225349,t118:1.337228262):0.8316044398):0.3687776681,t119:2.521033528):8.264691941):0.7965488386):0.01488067844):0.1646974978,(((t120:3.096720461,t121:3.082375775):0.5051663711,(t122:2.42948202,t123:2.310311222):0.9942872272):0.3545609032,t124:3.608269212):7.801683321):1.613195803):1.180404763):0.9008974258,((((((t125:0.09464324997,t126:0.01809743173):1.664353169,t127:1.640179162):4.526629981,(t128:3.800241121,(t129:3.331045397,t130:3.317543073):0.3355631452):2.363234847):0.7323136436,((t131:4.089388581,t132:4.083145498):0.9822383585,((t133:0.457259641,t134:0.338373133):2.069428643,((t135:0.2404680694,t136:0.1746152988):1.685581862,t137:1.751948244):0.2496735563):2.501283969):1.554319876):5.87357566,(t138:3.905481346,(t139:1.441454567,t140:1.422927351):2.367097127):8.003369035):0.8533678963,((((t141:3.734955976,t142:3.595685133):1.344580844,((((t143:0.1637676852,t144:0.06936730398):1.327602331,t145:1.344846156):1.065586102,t146:2.37203186):0.2751760404,t147:2.606897272):2.099418713):5.120036308,(t148:2.245952908,((t149:1.693718234,t150:1.608093392):0.2015070945,(t151:1.601289912,(t152:1.292735416,t153:1.099679304):0.2741837819):0.2021262171):0.2916109533):7.577734401):0.3117819746,t154:9.738161985):2.024768439):1.324557):5.526176854,(((((t155:0.703537145,t156:0.6432364302):4.434462537,(t157:0.2229361264,t158:0.109829429):4.847080879):2.699701343,t159:7.552852422):0.1110092276,(((t160:1.247851405,t161:0.8992109864):3.092392417,((t162:2.452951292,t163:2.411507255):0.3862629607,t164:2.712974474):1.04280168):0.7318230956,(t165:2.862615484,t166:2.765093728):1.570109479):2.561434121):10.1723577,(((((t167:6.481192194,(t168:2.25634817,(t169:0.2855428871,t170:0.1370381042):1.96360087):4.011664487):0.5991092218,(((t171:1.787525403,t172:1.654225607):0.8573915437,(t173:1.68247683,t174:1.473351391):0.7961368241):1.474070686,t175:3.732057417):2.458454872):2.24559728,(t176:6.694975599,(t177:5.199041392,t178:5.198106249):1.448936398):1.645485843):1.85107788,(t179:7.197609428,((t180:5.080832803,(t181:2.346412578,(t182:0.5594253461,t183:0.3142594928):1.769501329):2.663038148):0.2301881241,((t184:4.224733377,(t185:1.612544012,(t186:1.314982732,t187:1.287935469):0.2772711989):2.522994258):0.5723497605,(((t188:1.891421807,t189:1.759858316):0.3213233739,t190:2.033950621):1.794403908,t191:3.819813025):0.5896768235):0.1725640934):1.539303821):2.91152456):1.804198178,(t192:0.8772335749,t193:0.8289063576):9.928589787):3.914937282):0.07093522179):2.781081038):0.0274558419):0.4057111998,((((t194:9.63050333,t195:9.381160562):0.3069768533,(t196:7.585953335,((t197:0.2926008678,t198:0.2800038038):4.867649025,(t199:4.971697729,t200:4.951859226):0.0989675572):2.255377428):2.029696414):1.436685552,((t201:3.292273233,t202:3.061417959):4.660904672,((t203:2.720499655,t204:2.674963014):0.03335708914,((t205:1.481579423,t206:1.385106092):0.3582807563,(t207:1.497188928,(t208:0.5772231068,t209:0.5402330225):0.8983130401):0.03745184943):0.7516997331):4.847724947):2.566512797):5.127580134,(((t210:3.292448448,(t211:2.599001545,t212:2.567842999):0.6276158571):6.055285568,((t213:2.484703619,(t214:0.9970633392,t215:0.9148257062):1.480129981):0.2056735174,(t216:1.617546505,t217:1.491987405):0.8571681606):6.495491039):5.336097478,((t218:2.811465794,t220:2.548924009):9.058537763,t221:11.44597738):2.086547672):0.05301935304):1.439308621):1.250251701,((((t222:1.023383837,t223:0.8036232527):4.628084414,(t224:4.901815646,(t225:1.078634786,t226:0.9929085301):3.822057654):0.4463143173):3.820461369,t227:9.066807456):0.2625815333,(t228:2.329827759,(t229:0.5235701962,t230:0.3734144522):1.790433691):6.936470101):6.439162936):8.482734569):1.089002273,((((((t231:10.93876372,(t232:4.772267742,(t233:0.9575902832,t234:0.9513139449):3.796397005):6.050117682):2.340606169,t235:13.13632835):0.3914644907,(((t236:0.7025651595,t237:0.658720483):8.987316101,((t238:0.07255719555,t239:0.04098339518):2.971386682,t240:2.917896611):6.558394959):2.357183902,(((t241:1.945975946,t242:1.9320022):0.4059246166,t243:2.050849597):2.999278126,t244:4.977311733):6.419365591):1.342559813):7.419852767,(((t245:2.348720056,(t246:1.026994777,t247:0.985460755):1.249579109):0.2310999215,t248:2.398650412):7.752841871,((t249:4.516718085,(t250:0.9097724334,t251:0.90504205):3.594698064):4.200401372,((((t252:2.24792735,(t253:1.236924176,t254:1.031850602):0.4767479288):1.854113108,((((t255:0.1811277633,t256:0.160213774):0.04932207068,t257:0.1831756617):0.4158782514,t258:0.422547376):0.01659275927,t259:0.3938553043):2.661241072):2.478890378,t260:5.515608305):0.276313337,(((t261:0.3366444197,t262:0.1388158577):4.722233857,t263:4.765047785):0.3926289621,(t264:1.776164124,t265:1.618309644):3.370810226):0.2796718674):1.780584221):1.272190417):9.806301027):1.125675767,(((((((((t266:0.7120540333,t267:0.5780738309):2.867918511,t268:3.35601772):1.979539084,t269:5.23579036):0.4498345986,((t271:2.791972243,t272:2.75242677):2.047438118,(t273:0.316171793,t274:0.2602213674):4.226155629):0.7598962419):0.02419846377,t275:5.124460562):2.121233283,(t276:4.080325567,t277:3.959345328):3.04728915):2.667691416,t278:9.635517566):1.467600335,((t279:7.348191943,(t280:6.325267528,((t282:3.471147987,t283:3.330637563):2.415579167,((t284:0.5423204929,t285:0.5382968618):1.535372266,(t286:1.007073988,t287:1.00170438):0.9845349118):3.562036389):0.1389340215):0.9709017667):2.080388837,(((t288:0.7955813597,(t289:0.307831232,t290:0.2692224435):0.3503046415):6.477590307,(t291:1.508063192,t292:1.48271908):5.414150584):0.158749972,t293:7.005802387):1.135308903):1.478750663):2.516884593,((t294:10.61192087,((((t295:0.5972720229,(t296:0.2971765295,t297:0.2823381837):0.2922752988):0.3726402457,t298:0.9394313627):1.536882972,(t299:0.8662474514,t300:0.8295910856):1.595920655):6.578599146,((t301:1.150824797,t302:1.082549985):5.914779631,(t303:5.781625404,(((t304:2.362444583,(t305:2.245880137,(t306:1.971747112,(t307:0.4175604535,t308:0.3063472369):1.519031571):0.1742504819):0.07326647253):0.1234028236,(t309:0.9735533769,t310:0.940179737):1.082564701):1.956692117,t311:3.797862748):1.250996694):1.087389618):1.916505845):1.48980738):0.502718502,(t312:4.559783398,t313:4.221886401):5.484126116):0.9939905122):4.342868923):1.636348253,((t314:11.54881535,((t315:10.6576513,(((((t316:2.374588016,(t317:0.4259985336,t318:0.2962578726):1.873134103):0.338117334,t319:2.494142595):0.8148219419,(t320:2.044533818,(t321:0.2119470823,t322:0.1041404477):1.785364931):1.191506238):2.493425139,t323:5.366843259):0.7964028482,(t324:5.799558474,(t325:1.471719206,t326:1.447558052):4.208302609):0.1888764614):3.808540271):0.02344864911,(((t327:3.014515159,t328:2.603379033):1.83510733,t329:4.399872083):0.9610593156,t330:5.265229056):3.778744101):0.6674562998):1.733846602,(((((t331:0.6206272756,t332:0.5111598646):2.686908191,(((t333:0.01441048358,t334:0.006677264747):1.272894425,t335:1.015292368):0.1236608155,t336:0.9083989952):1.780490969):0.5657229045,((t337:0.2055392491,t338:0.04188358389):0.8061852893,t339:0.8250634864):2.204213266):0.235613919,t340:3.035577775):2.184392489,(t341:0.3560158235,t342:0.2017579984):4.734825655):4.91926807):3.38505697):1.251453826):0.3861416533,((t343:13.31512716,(t344:0.6726221819,t345:0.5765459058):12.31946051):0.1372159321,(((t346:4.52846046,(t347:2.273709337,t348:1.932688667):2.107164004):1.09350746,((t349:2.228299293,(t350:0.2068297691,t351:0.09605387649):1.999876217):1.371324723,t352:3.208492473):1.323793368):3.446974888,(((((t353:1.157423153,(t354:0.9105512254,(t355:0.5848071359,t356:0.4007394768):0.3194002731):0.2130550952):0.5376476735,(t357:1.102863183,t358:0.9971859216):0.3151547243):1.27988676,(t359:0.77370073,t360:0.745322987):1.803075231):0.1302609519,t361:2.436819298):0.9243203557,t362:3.34748449):3.546403357):3.847708014):1.362610022):1.939558168):5.005821598):0.7273901617):3.918257889,(((t363:3.016652089,t366:2.515170376):6.601749751,t367:9.089890452):0.971178876,((t368:5.824086567,(t369:0.1498651545,t370:0.05530563918):5.620119266):3.641836389,(t371:0.8832353494,t372:0.7510904685):8.371204534):0.5364934889):12.97628993):20.77061158,((((t373:0.1262930352,t374:0.1213337262):11.58792726,((t375:5.978988689,t376:5.677100824):1.061462948,t377:6.545758961):4.382310225):1.78620324,((((t378:1.248387476,t379:1.10209824):3.154621806,t380:4.159911733):0.0868634365,(t381:1.275576214,t382:1.143524203):2.536449018):2.275083341,((t383:2.384418304,t384:1.944542277):0.7002258159,(t385:1.354357712,t386:1.28781451):0.9075405905):2.832932116):5.598964043):2.411227483,(t387:8.154297583,(((t388:3.648518827,t389:3.601400245):3.705428398,t390:7.304832082):0.5266085206,t391:7.76280636):0.2345994784):4.766441851):27.48782894):6.145571933):5.032160005,((((((t392:2.62211462,t393:2.541812109):2.01201781,t394:4.506824893):1.019174733,(t395:5.383155517,(t396:4.025761196,((t397:0.9603260543,t398:0.6473598273):1.977516712,t399:2.486787694):1.040760144):1.344370008):0.07165128826):1.727185244,(((t400:3.579256067,((t401:1.298409188,t402:1.114681024):0.799193537,t403:1.73178445):1.4246504):1.383238257,t404:4.518942877):0.2235125906,t405:4.73771525):1.382242804):0.6063257024,((t406:0.3626694293,t407:0.3144143806):3.656254914,((t408:2.374908435,t409:2.299086574):0.3276296057,((t410:1.824647688,t411:1.75575476):0.6084877398,t412:2.10691827):0.09876781502):1.113743166):2.580044333):23.37693743,(((((t413:0.8344050613,t414:0.8024756168):0.4710981601,t415:1.257124478):0.6567444653,(t416:1.672324158,t417:1.649473648):0.2042180642):8.06280344,(t418:4.007143196,t419:3.990039273):5.88402807):6.706443214,(t420:12.03983546,(((t421:3.484884479,(t422:0.9824132955,t423:0.9461940353):2.258176636):1.224840991,t424:4.305834646):3.629591307,(t425:0.2532551442,t426:0.09249228651):7.629895656):3.661702976):4.530109571):12.53778713):20.03084252):31.13827829,((t427:5.694860027,((((t428:0.5905725487,t429:0.5479749047):0.1775739214,((t430:0.1790858986,t431:0.1109019587):0.05470273647,t432:0.0995764676):0.2825794601):1.06084551,t433:1.280588337):0.3584663005,t434:1.499865123):3.437042878):46.99494285,((((t435:1.457584401,t436:1.270920984):1.642970411,t437:2.868553586):1.621742327,t438:4.477519982):0.1560403524,(t439:2.100552964,(t440:1.872239351,t441:1.856727192):0.1556625382):2.468025794):46.95528942):26.91456394):34.91598718);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T16.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
