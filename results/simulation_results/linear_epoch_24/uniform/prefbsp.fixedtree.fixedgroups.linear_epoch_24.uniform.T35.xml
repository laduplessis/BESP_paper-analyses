<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t475:53.89799012,(((t476:2.540524171,t477:2.407804018):22.17207486,(t478:5.143649346,(((t479:1.35398616,(t480:0.2847723869,t481:0.2086066861):1.038981121):0.1147505349,t482:1.227358614):1.09185835,(t484:1.232326226,(t485:0.9818347579,t486:0.8771851):0.1118799718):0.5341664508):2.54618833):19.40825524):0.01789237756,(t487:1.139967331,(t488:0.9046152788,t489:0.4406657819):0.2199782494):22.35030317):29.03679331):2.205322096,((((t490:3.119166668,(t483:0.05751385502,(t453:0.188853541,(((t357:0.05186317351,((t332:0.05796101367,(t306:0.1524360462,((((t84:0.08140791338,((t1:4.696002973,((t2:3.414451223,t3:3.394803234):0.7928387029,t4:4.164288141):0.4715039485):0.5763046999,(t5:3.890323755,t6:3.845148986):1.291125105):1.972585752):9.628611825,((((((t7:4.969372429,((t8:1.83720212,t9:1.713002234):2.854891832,(t10:4.107730178,t11:4.091635768):0.3885705475):0.200487698):6.279242607,((t12:2.935918979,t13:2.755145077):0.6577154617,t14:3.34039353):7.319876467):0.3114157895,(t15:0.7284911702,t16:0.637076646):10.23056309):1.248721273,((t17:7.152721725,(((((t18:0.670323318,t19:0.5952310093):0.5893696161,t20:1.026525627):2.486266815,t21:3.403110935):1.358972081,(t22:4.225971831,(t23:1.748029481,t24:1.677632326):2.448447459):0.4429115996):0.1597359248,t25:4.699379872):1.808933841):2.80145887,(t26:0.3588976359,t27:0.2986118143):8.919201439):2.149330444):0.3946611356,((((t28:5.052500107,t29:4.850588397):3.526844154,(((((t30:1.982972603,t31:1.974388103):1.687322065,(t32:0.4676962303,t33:0.2776822107):3.129876479):1.436277078,t34:4.687428431):0.07429975263,t35:4.65171264):1.467962659,((t36:5.247990915,((t37:0.1761648725,t38:0.06827575393):3.726633207,t39:3.785219612):1.280881626):0.6985041775,(t40:3.495320942,t41:3.465742244):2.249831895):0.160729961):1.710845262):0.833898347,(((t42:2.057270927,t43:2.004132862):1.31331275,(t44:0.7441785365,t45:0.6995882398):2.308151275):4.414997264,((t46:3.683276582,t47:3.651899193):3.288412372,((t48:5.236209846,t49:5.103453933):0.1761060156,((t50:0.4861722737,t51:0.462382777):0.5901365271,t52:0.8732675704):4.088898963):1.396591926):0.4405497578):0.5220064861):1.865648216,t53:9.140252451):0.01673792808):2.604423004,(((t54:5.104107149,t55:5.098838564):1.413170479,((t56:1.758962047,t57:1.685604533):3.084491474,(t58:2.251413986,t59:2.242474095):2.38139814):1.648102508):3.968547712,((t60:6.178826628,(t61:1.027901262,t62:1.012105319):5.127961085):3.161697956,(((t63:4.466043013,(((t64:1.24397052,t65:1.072862713):1.297328212,t66:2.31444588):1.645390471,(t67:2.038557811,t68:1.875284833):1.747790425):0.2245566786):2.841610947,(t69:6.054029633,((t70:1.70281191,t71:1.557565984):1.651077976,t72:3.200973465):2.605960821):0.6203346523):0.4619478509,t73:6.746104373):1.474471677):0.8919563233):1.231499543):0.8590777619):1.842359545,((t74:7.467934995,(t75:7.250610995,t76:6.888037928):0.03193199691):4.76229708,(((((t77:0.4111471103,t78:0.3937200915):6.330968801,((t79:2.366152707,(t80:2.213532955,(t81:0.593075368,t82:0.2968023796):1.326127043):0.0637591659):3.00248849,((t83:0.2817819773,t85:0.1974725414):1.312322279,(t86:0.5639839675,(t87:0.5244138206,t88:0.5016236769):0.0168311672):0.7904199302):3.029441282):1.278555033):0.6006117171,t89:6.209226806):2.643565412,((t90:1.369855819,t91:1.345491655):6.260841309,t92:7.506953074):1.133732029):0.03215118286,t93:8.603721113):1.574301924):0.8007902259):9.698202258,((((((t94:0.1924257657,t95:0.1794087301):2.233597199,((t96:0.08974808691,t97:0.06476655606):1.16153441,t98:1.17618395):1.149818778):3.333407188,((((t99:1.252009196,(t100:0.606482667,t101:0.4537741668):0.2340683633):0.4776969756,t102:1.120040206):1.485069893,(t103:1.001308243,(t104:0.8893731214,(t105:0.4929675769,t106:0.2729129365):0.2011857483):0.04011987396):1.602466383):1.20050044,t107:3.306687697):1.170610168):0.166474198,(t108:3.989123502,t109:3.72055015):0.5784314855):11.44308687,(((((t110:3.079737515,(t111:1.743137574,(t112:1.341659067,(t113:0.752694805,(t114:0.2009097693,t115:0.007954037885):0.531980714):0.511025063):0.3810476213):1.33551487):0.5678038253,(t116:1.928478473,t117:1.913968566):1.344665523):0.06714558616,(t118:1.932353982,t119:1.909537213):1.37436559):0.3430564279,t120:3.585189981):6.506822863,(((t121:1.445874893,t122:1.39160155):3.014926191,((t123:0.9879313128,t124:0.8106387311):2.1614342,t125:2.909613335):1.112734009):4.576742678,t126:8.530583517):0.9516938067):5.032813561):0.9434418454,(((t127:0.2974683222,t128:0.09446220648):8.881482803,(((t129:0.3871821917,t130:0.3281430958):6.089390688,t131:6.30789728):1.776519903,t132:8.084181385):0.5371782878):0.6582963918,t133:9.220187466):5.353549333):2.361474819):0.40979802):1.838176143):1.69317811,(((t134:2.355351211,t135:2.26333611):13.73670279,(((((t136:3.704959053,t137:3.631934282):0.3230140089,(t138:1.506515109,(t139:1.261425652,t140:1.196891575):0.02406727956):2.44770954):5.335613869,((t141:2.222386199,t142:2.198661234):2.043595707,t143:4.002118174):4.207069508):2.299044766,(t144:5.753757871,t145:5.753112274):4.664347163):4.188819778,(((t146:1.042737276,t147:0.9712276108):4.519788693,t148:5.476964008):0.6503481743,((t149:2.799967148,(t150:0.8932778234,t151:0.8185883555):1.901974914):0.0846903969,(t152:0.6403380809,t153:0.6327520423):2.127757536):3.218276876):8.260722675):0.001432379439):0.5762656357,(t154:2.724117416,t155:2.706606365):12.01854211):4.166717043):0.2481364243):0.5994004975,(((((t156:5.065589432,(((t157:2.96556404,t158:2.957535555):0.6063612934,t159:3.468031298):0.2303012498,((t160:1.625110465,t161:1.568223382):1.349854269,t162:2.666894508):0.7113746207):1.190063774):3.317075944,t163:7.718556056):2.541750253,((t164:3.709860289,((t165:2.427924855,t166:2.393207946):0.7490031136,((t167:0.6378823022,t168:0.6273848448):2.152317579,t169:2.482941617):0.1824728594):0.2210467139):6.002005682,((t170:0.9118544283,(t171:0.1207814813,t172:0.03671628195):0.7417559479):1.090845101,t173:1.846807882):6.863296368):0.5089418639):3.957709628,(t174:7.482388711,(t175:6.931036537,((t176:5.125097741,t177:4.625351217):1.597663151,(t178:2.375465172,(t179:2.134171739,(t180:1.653657669,((t181:1.187225917,t182:0.8879459151):0.2551136516,t183:1.137382061):0.193908289):0.3945846003):0.1282901784):3.820296604):0.08786042617):0.5121286235):5.416656602):1.948263828,(((t184:1.770190559,t185:1.76471535):5.383947941,(t186:5.051567637,(t187:1.319435128,t188:1.257041647):3.712185156):2.047011314):4.965757077,((((((t189:0.6551120647,t190:0.5696608366):0.5731033525,t191:1.00846543):1.660391845,(t192:1.365740602,t193:1.288283424):1.130516733):0.03533746433,(t194:1.7641733,t195:1.740053472):0.6015871059):1.984005631,(((t196:1.072040864,t197:1.071348776):1.281766834,(t198:0.8345187243,t199:0.7997596098):1.43519634):0.1440462343,(t200:2.089317417,t201:2.041230405):0.1627456214):1.702112252):0.1889530018,(t202:2.977375519,(t203:2.443109449,t204:2.437306003):0.4182902822):0.8761720011):6.768610335):1.490551505):2.810984078):7.433368531,((((t205:0.762042453,t206:0.7478594584):0.2226621397,(t207:0.7144125006,t208:0.5684112659):0.0980290081):6.459386979,t209:7.053530895):9.342814156,((t210:6.294789524,(t211:1.029040324,t212:0.9599100985):5.22689991):8.283251434,(t213:5.960025328,((t214:0.1911198504,t215:0.1880630518):0.6478041861,t216:0.6538030744):5.103675857):8.126247239):1.692226743):5.27111465):2.241157137):3.476817161):4.325398275):2.24844341,(((((((((t217:0.7835847783,t218:0.7353091753):2.277760319,t219:2.838823374):0.8030430696,t220:3.626930315):1.312835523,t221:4.901859172):6.028652272,(((t222:1.336764022,(t223:1.022896041,t224:0.9879387056):0.2865157844):5.056699642,(t225:3.893943926,t226:3.87946403):2.333725613):1.919803265,(t227:6.017785809,((t228:0.3960815698,t229:0.375587376):2.690810459,(t230:2.213767386,t231:2.15985443):0.8223270511):2.917610401):1.970155667):2.580466107):3.170780134,(((t232:6.942222194,(((t233:0.3987638601,t234:0.2340134154):0.6492829754,t235:0.6731470887):2.553263227,(t236:1.135812475,t237:1.125198732):2.070225404):3.331810499):4.225494507,(t238:5.636752296,(t239:3.789633758,((t240:0.9701151511,t241:0.8506571654):1.990602629,t242:2.717201748):0.6483955531):1.809820497):5.028754129):0.8785233132,(((t243:0.2175628159,t244:0.00576695457):7.198073574,((t245:5.990726142,((t246:1.706200844,(t247:0.5490057772,t248:0.4905916127):1.150525753):2.193526635,t249:3.813600314):1.432924836):0.2986674283,(t250:2.866484073,t251:2.823693223):2.536573652):0.7820621965):1.076372153,t252:6.902640585):2.578542364):1.538947368):7.063397327,(((((((t253:0.6142712894,(t254:0.2466050046,t255:0.2248146971):0.1943156531):2.596813067,((t256:1.461174727,t257:1.410385231):1.326585921,(t258:1.547741178,t259:1.411170121):1.108772761):0.1864755848):5.567130359,(((t260:2.357107632,t261:2.352534134):5.201835344,(((t262:0.7083694901,t263:0.4154662424):1.888196611,t264:2.19153974):3.18158897,t265:5.349691101):1.646156939):0.6063202704,(t266:4.18231919,(t267:3.639045719,(t268:0.597265763,((t269:0.2799129424,t270:0.2470448523):0.2161959668,t271:0.2488693936):0.0260003225):2.995135218):0.2666194306):3.391685751):0.09090914735):0.7877782293,(((t272:1.986198504,(t273:0.9700992571,t274:0.9095088013):1.013757666):2.243310011,t275:4.151430968):3.364120338,(((t276:1.316045832,((t277:0.5916297926,t278:0.3326709179):0.2791117531,t279:0.4293908315):0.4256813005):0.5795726538,(t280:0.6251338183,t281:0.5489497583):0.759258909):3.70788504,(t282:3.617630726,t283:3.387668642):1.217086055):1.611787269):0.1804913365):1.149769439,(t284:6.829355114,((t285:0.56874486,t286:0.5644898441):4.180918102,((t287:0.7500160511,t288:0.7495369243):3.347072978,t289:3.804666321):0.433395322):1.957237368):0.5163677002):2.2693796,(t290:7.282769637,((t291:0.593365185,t292:0.4228890907):0.4231168017,(t293:0.7250012486,t294:0.7170472383):0.08255848557):6.211414786):1.677224199):0.9854360854,(((t295:2.740851958,(t296:2.148065628,(t297:0.7832043346,t298:0.7324166501):1.354176992):0.4548835139):1.451821145,t299:3.958689693):0.3536992026,((t300:2.569114927,((t301:0.1244032372,t302:0.1013653472):0.03197911157,t303:0.0236821015):2.221194035):0.3459512328,(t304:0.5767663632,t305:0.4849423825):1.978379266):1.245249352):5.11699807):4.039448929):6.019131647,(t307:14.46259607,(((((t308:1.397038166,t309:1.358387537):10.41658567,(t310:9.603674245,(t311:5.843283136,(t312:4.613985188,t313:4.490203704):1.215263657):3.72535501):2.079792857):0.2942907333,(((t314:0.9733669554,t315:0.8509522706):0.3804813114,((t316:0.5280426392,t317:0.3029532261):0.6363445412,t318:0.9301786306):0.0473152259):3.338820563,t319:4.234890597):6.973758681):1.584456256,(t320:8.97542392,(t321:5.821071756,((((t322:2.620621749,(t323:1.408920403,t324:1.401950993):0.9136996447):1.101655944,(t325:1.809840987,(((t326:0.1231062304,t327:0.06844552641):0.1971649865,(t328:0.09551887093,t329:0.08470708942):0.1117233642):0.3717836259,t330:0.5671665675):1.101349337):1.462393446):0.7884616382,(t331:1.31916961,t333:1.173682958):2.569798463):0.4528262571,t334:4.013725749):0.8452370186):3.123330736):3.697418):0.1554060214,((((t335:5.243795906,(((t336:2.6171471,(t337:1.071366217,(t338:0.4484390341,t339:0.4324558944):0.5840602786):1.536525403):0.8159985116,t340:3.364682107):1.693630416,(t341:2.034099307,(t342:1.234230262,t343:0.784133711):0.7709079621):2.996431948):0.02835754808):0.3091270496,(t344:4.506042983,(((t345:1.810636924,t346:1.776655483):1.88977898,t347:3.529703829):0.04275353556,t348:3.482914571):0.5874376718):0.375209587):1.937769073,(t349:2.093294515,(t350:1.533884032,t351:1.506310656):0.4983843749):4.258428809):2.00090318,t352:8.240657961):2.331052906):0.5915725661):4.024532705):4.477070869,(((t353:6.954371087,((t354:1.58999447,(t355:1.097920558,t356:1.000657269):0.2765015301):5.315619379,t358:6.276493032):0.03764177169):0.1224183702,(t359:1.96372029,((t360:0.5202672832,t361:0.4143542374):0.3927794989,t362:0.7203246213):0.9661912444):4.199546048):6.963618645,(((t363:0.3868758025,t364:0.3455999748):0.8593654953,t365:1.13586015):3.674264433,(t366:1.440794473,t367:1.374093873):3.304897124):7.830641878):5.622273972):1.107558637):0.02590226686,((((t368:2.975282274,(t369:2.00966079,(t370:0.8764846487,t371:0.8419464556):1.023912301):0.864438347):5.266703417,(((((t372:1.604766545,t373:1.402944748):0.9980774819,(t374:2.184637779,(t375:1.987406605,((t376:0.8073653632,t377:0.781307094):0.4403816483,t378:1.13962435):0.7351321485):0.1571783309):0.1559275123):2.012649788,t379:4.05803363):0.1693273909,((t380:3.315113891,(t381:0.262367713,t382:0.2183474369):2.960382126):0.09763543853,(t383:2.226684751,t384:2.148964843):0.9863071075):0.8069638671):1.180618127,t385:5.09505227):1.976812137):2.489397085,(((t386:4.553154202,(t387:4.072889231,t388:3.904949169):0.4733004123):0.6896100753,t389:4.915340963):1.441606977,((t390:2.443585753,(t391:1.91044738,(t392:0.6409859315,t393:0.5084315755):1.065048516):0.455221358):3.173204314,(t394:1.767144021,t395:1.546202998):3.35812664):0.7160417607):2.604547828):4.01559275,(((((t396:1.296822379,t397:0.7218708704):2.8991185,t398:3.616136709):2.943190492,t399:6.501237226):2.823676246,((((t400:1.500736052,t401:1.25653894):0.3753443691,t402:1.494347947):5.931995333,((t403:4.42259409,t404:4.392867171):0.05528331427,t405:4.441514468):2.89201485):0.5687159043,(t406:3.321697601,(t407:1.02505192,t408:0.8675576006):2.087851747):4.495401137):0.9231850831):0.8694591169,((t409:1.744648175,(t410:1.049521105,t411:1.032137195):0.5054319612):1.370328072,t412:2.880254055):6.110091316):1.315258347):4.090357297):18.13796896,(((t413:3.302321629,(t414:2.113073865,(t415:1.193051917,t416:1.151721511):0.7213249062):1.126564221):2.056910919,(t417:3.447492697,(t418:2.781914072,t419:2.764018431):0.4875846427):1.608875209):19.93738549,(((((t420:0.9149333837,(t421:0.6647577629,t422:0.5628759469):0.185059998):5.333575315,t423:6.012359072):5.690759851,t424:11.58504244):2.921554334,((t425:2.368915461,t426:2.364563344):2.336581153,(((t427:0.03063305832,t428:0.007348063791):0.3406534143,t429:0.1780387311):0.897046517,t430:0.9660446889):3.423040993):9.733951371):1.850614492,t431:15.93412629):7.840873945):7.2357642):30.71359766):20.52737501,(((((((((t432:1.620847983,t433:1.578738866):0.131007665,t434:1.651793172):2.614551756,((t435:0.9154607224,t436:0.905773301):3.243892985,t437:3.62556163):0.07158342353):0.4776989798,((t438:1.253085012,t439:0.9887845211):1.568896699,t440:2.545476934):1.249954314):0.50976845,t441:4.288368542):0.4092768485,((t442:2.015094106,(t443:0.795087849,t444:0.6932760116):1.208646464):2.468576425,((t445:0.7175465113,t446:0.5173394176):3.181885586,t447:3.611412321):0.2524585306):0.2058521157):2.33389643,(((t448:0.2627535677,t449:0.1178493812):5.456767587,t450:5.367717737):0.3640787077,t451:5.696811086):0.003416457357):12.07685313,((t452:4.354905436,(t454:3.572337196,((t455:0.6571485648,t456:0.5585292519):1.005979165,t457:1.281679523):1.887278075):0.51179472):2.960560412,(t458:4.908591101,(t459:4.074713196,((t460:0.6587386435,t461:0.3763056724):2.840221238,(t462:2.27190692,t463:1.990905897):0.8881719662):0.4416440091):0.6104550234):1.668919463):10.40134388):23.2228165,((((t464:0.7358554381,t465:0.5356903414):1.141106051,(t466:0.3155453181,t467:0.2713930481):1.243384345):0.9578332565,t468:2.251008391):36.22083869,(t469:4.102457964,t470:4.067094969):34.29857442):0.1332472603):38.7781442):67.22150116,((t471:2.259036992,t472:2.220855762):4.18055684,(t473:2.693199237,t474:2.30223966):3.677303942):138.0363862);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T35.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
