<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t427:5.54732873,t428:5.526487141):4.867689825,((t429:2.941797336,(t430:2.862553457,(t431:1.514693542,(t432:1.336251704,t433:1.321215326):0.1407957116):1.316726632):0.036961881):6.947239369,(((t434:3.319113888,t435:3.131110392):0.7061399434,t436:3.730913979):5.041810171,t437:8.739283224):0.673002262):0.1200600851):1.889839644,(t438:1.257326204,t439:1.248082899):10.15449681):6.227035101,(t440:8.221651883,((t441:1.084143533,t442:0.8423979964):3.657795888,(((t443:1.53435816,(t444:0.3429016614,t445:0.2462613041):1.138918742):1.40896285,(((t446:0.5325039468,t447:0.5115286155):1.628962905,t448:2.075378542):0.41171994,t449:2.463773195):0.1590707885):0.2919102291,(t450:2.537428244,t451:2.453579994):0.3742082442):1.20460643):3.303289077):9.378263332):26.65178176,(((t452:5.970422844,t453:5.970213333):2.614382902,((t454:0.3322568476,t455:0.2962065145):2.57859875,(t456:0.557275472,t457:0.4693051602):1.851533155):5.64754238):11.9772518,(((t458:1.280140958,t459:1.257228187):4.111574922,t460:5.238672086):6.967052912,t461:12.1934676):7.553193571):22.69359787):71.41040346,((((t462:1.045116668,t463:1.00445829):2.961296505,(((((t464:0.8129149786,t465:0.7708776034):0.1722617506,t466:0.7955151375):0.7344106799,t467:1.444688737):1.839659713,t468:3.221976797):0.2799744258,t469:3.330427654):0.05684445338):6.427388928,t470:9.643142178):53.28700974,(((t471:19.9762715,(t472:3.162616074,(t473:0.6192300268,t474:0.6001055184):2.502279196):16.69111314):10.81612482,(((t475:6.002727987,t476:6.000140342):5.951262942,(t477:0.2444750887,t478:0.17626968):11.67568942):0.3094409086,t479:12.06062263):18.32783106):8.129570269,t480:38.46970433):23.99619346):50.07429665):174.4490354,(((((t481:0.9984118653,t482:0.9243832876):0.3136418067,t483:1.077983446):23.052649,((((t414:0.1640515397,(t350:0.003474195261,(((t265:0.0312072862,((t223:0.2062043003,(t220:0.06156736896,((t183:0.09514775248,((t130:0.09586173722,(t89:0.08076343796,(t80:0.02883279168,(t50:0.02499186946,(t1:2.267184017,t2:2.19012637):2.09257828):2.413693357):0.9044067882):3.078363238):5.843007174,((t3:10.24584893,(t4:8.021520752,(t5:4.728738797,(t6:3.463598053,(t7:2.822030435,t8:2.765749255):0.4707465662):1.131414166):3.258504816):2.071610046):0.669252589,(((((t9:2.877988068,t10:2.818842794):1.392627272,t11:4.000762192):0.3690153955,t12:4.226874653):2.574585331,(((t13:2.556106816,t14:2.532960838):3.722857195,((t15:0.9301109606,t16:0.8752842819):2.807765527,(t17:2.003870745,t18:1.861120217):1.473264375):2.478367993):0.1637965465,(t19:5.35911401,t20:5.126588314):0.5300357445):0.3011160772):2.065364231,(t21:1.385350473,t22:1.375977991):6.586272034):0.9761372531):5.511820459):1.071392979):2.465280808,(((((t23:6.95993413,(t24:3.642209021,t25:3.339078922):3.297412908):0.6887906336,t26:7.289367245):1.45378685,((t27:0.5402294425,t28:0.53240705):1.338892243,(t29:1.63845296,t30:1.594340879):0.2128274324):6.840377205):2.12568171,((t31:2.181204921,t32:2.080095436):3.718995121,(t33:0.7833440207,t34:0.7626345512):4.934680566):4.857018039):3.920469446,((t35:8.8959878,(((t36:2.610156805,t37:2.5772824):0.6423929897,t38:3.118099813):2.022128571,((t39:1.489724302,t40:1.439982197):2.687382391,(((t41:0.3549475181,t42:0.162497432):1.957898333,t43:2.024639952):0.5744945386,t44:2.39041123):1.237231892):0.9479120886):3.538789745):4.79978346,((t45:5.81924807,t46:5.796779338):3.359217148,((t47:1.46299171,t48:1.389536457):3.982071757,t49:5.240266872):3.439128292):3.71302794):0.6939251731):2.780040374):0.801725623):0.2826015507):3.294782247,(((((((t51:4.094613848,(t52:2.028533174,((t53:0.7904321854,(t54:0.7316041388,t55:0.7129463218):0.0433284706):0.3523832861,t56:1.097928177):0.8789812986):1.947824082):4.138751265,((t57:0.8724328791,t58:0.7587742264):3.838653287,(t59:0.6850990737,t60:0.66374136):3.86987953):3.150434524):3.071659783,(t61:9.842547153,(t62:5.254331674,(t63:0.9448795732,t64:0.925204012):4.271277665):4.244651133):0.7488638578):2.264591121,(((((((t65:0.3704327545,t66:0.2857986814):2.734503916,(t67:1.905145358,(t68:1.555164104,t69:1.451777463):0.3124442085):1.099132214):1.01044493,(t70:2.197597358,t71:2.159311337):1.570616952):0.381857256,(t72:3.019477097,t73:2.779728368):1.011455593):0.4776970032,t74:4.230232819):3.552556022,((t75:4.032846073,((t76:1.664263878,t77:1.642986047):1.078103819,t78:2.593830094):1.225623207):3.029616719,t79:6.842105188):0.6771449895):2.558625803,(t81:3.230452477,t82:2.873385653):6.512450118):1.358139293):1.990771802,(((((t83:4.302798534,(t84:3.327906341,(t85:1.18041223,(t86:0.9608922746,(t87:0.5259305443,t88:0.4694654588):0.4195347812):0.1974255818):2.14088426):0.91851037):0.0731410269,t90:3.904736493):0.2304374387,(t91:1.678983334,t92:1.619566316):2.346271127):4.987898521,(((((t93:0.1065649034,t94:0.09280066866):0.5322266874,t95:0.6002616239):0.8926681811,t96:1.470300503):0.4932293674,t97:1.939573476):1.840605182,t98:3.778788482):4.994680532):2.318367572,((t99:0.3890716493,t100:0.3571458551):4.790276023,(t101:3.058674762,(t102:1.238872969,t103:1.138849361):1.808607395):2.086196571):5.86718673):0.8182072005):0.5436110361,((((t104:4.744075214,(t105:0.4129515514,t106:0.4045254617):4.256357596):5.330931472,t107:9.74023086):0.999073281,((t108:2.855586923,(t109:2.347300831,t110:2.156119108):0.5008375134):4.004372992,t111:6.321945555):3.778820738):0.276499521,(t112:9.834233895,(t113:1.45642501,t114:1.401189261):8.31329887):0.4138180847):0.8953639787):2.392304344,(((t115:1.48892003,t116:1.394283957):4.062008823,(t117:1.122859795,t118:1.041691312):4.329004532):7.430330331,(((((t119:1.180533224,t120:1.14858867):3.821980614,((t121:3.388377657,((t122:0.542849577,t123:0.2511618975):0.02379424028,t124:0.2125278734):2.680419796):0.8420210568,(t125:0.04647999119,t126:0.007432634034):3.637857657):0.7197297435):0.4986433323,(t127:0.6011527261,t128:0.4208385508):4.209008539):2.163369432,t129:6.791342661):0.3599269727,(t131:0.5827522199,t132:0.5411673831):6.417499416):4.774940679):0.3286599691):1.61892701):0.9194902699):2.838460112,(((t133:3.416472999,((t134:1.110967231,t135:1.006000809):1.10986584,t136:2.045801528):0.738375064):3.398852999,((t137:4.473637879,t138:4.132042005):0.09583274037,((((t139:0.4385417042,t140:0.3415451235):1.163100587,t141:1.352690895):0.07615316161,t142:1.000704958):0.2688308719,t143:1.094755516):2.071204757):1.432907984):4.020492299,t144:8.61781967):6.467277147):5.121326068,((t145:5.261118683,((t146:0.2590466587,t147:0.2224120463):0.09254864712,t148:0.01172393463):4.78643018):9.887114273,((t149:3.105234123,t150:3.000688731):6.180270589,(((t151:1.463194825,(t152:0.963409296,t153:0.7204207216):0.3791833457):3.750949543,t154:4.808148305):3.456437724,((t155:7.50075235,((t156:4.353332692,t157:4.33563837):0.6594130713,t158:4.910346058):2.406459711):0.1041109969,((t159:3.686936944,t160:3.315699281):3.128494468,((t161:4.033614247,((t162:0.2993354868,t163:0.1918257252):0.4570697636,t164:0.4775011481):3.205971208):1.369037129,t165:5.047306795):0.983519803):0.5789259462):0.3171545628):0.443408286):5.283922069):5.05504945):2.10268051):7.159421351):0.5816550169,((((((t166:7.372525233,(((t167:0.1802637363,t168:0.06893093049):1.347291049,t169:1.353216005):2.889190341,((t170:2.434020612,((t171:0.9447733868,t172:0.9279139439):0.8080779329,t173:1.632352355):0.5531663958):1.305182518,t174:3.481279237):0.4704673888):2.881678744):3.956053476,(((t175:3.016319891,t176:2.757728342):2.633106068,((t177:0.08837135921,t178:0.08556592411):4.037783254,(t179:3.310362147,(t180:2.001946625,t181:1.960433937):1.281242525):0.6538485925):1.089633964):1.374245715,((t182:0.6303802795,t184:0.2647399442):3.901949616,t185:4.16154859):1.785421598):3.610103714):2.698693115,((((t186:0.6746274492,(t187:0.3163859509,t188:0.1851160839):0.2505525456):1.774241932,(t189:0.7159281143,t190:0.6878051062):1.436218794):5.927441117,(t191:6.319502051,(t192:2.006017207,(t193:1.690084286,t194:1.667913119):0.1240686548):4.255173581):1.7239314):1.612830234,t195:9.341870367):2.22548076):2.106163769,((t196:12.23149043,((((t197:2.238613324,t198:1.967816257):6.350497187,((t199:4.724917311,t200:4.677412157):2.941187808,(t201:1.366502464,t202:1.326283169):6.211249735):0.6503252273):0.8031603874,((t203:0.5396603494,t204:0.4340209988):1.287381344,t205:1.719159663):7.058298137):2.348722848,((((t206:2.33092631,t207:2.149562077):1.275966554,(t208:0.09680889707,t209:0.0333378657):3.31243652):1.695321452,((t210:0.4361731269,t211:0.400392697):1.116546938,t212:1.431294754):3.470140113):5.118596907,((t213:7.109616261,t214:7.008596473):1.955868506,((((t215:0.6477294239,t216:0.4489511225):5.409197237,((t217:1.304376367,t218:1.239865972):1.669731057,t219:2.89153411):2.842992715):1.630231033,(((t221:2.464410113,(t222:2.385319881,t224:2.11820042):0.06253778034):1.46574572,t225:3.57931783):2.510778148,t226:6.007705193):0.6595109815):0.2722361318,(t227:1.316389806,(t228:1.176640845,t229:1.06914998):0.06645358113):5.571837556):0.9011006284):0.6879104249):0.601696152):0.3006569884):1.072280031,((((t230:1.296959466,t231:1.230993829):0.04645329996,t232:1.18392345):1.496825935,t233:2.385630126):0.0247493119,t234:2.396091009):7.184553109):0.2855048148):2.920678741,((t235:1.869979304,t236:1.847788966):6.212936988,(((t237:4.133929015,((t238:0.9226923066,t239:0.8712100469):3.09857174,((t240:0.7996629184,t241:0.549608111):0.4864755985,t242:0.9375269338):2.626884182):0.1097108873):0.4800819703,((t243:1.678199533,(t244:1.506167624,t245:1.474493237):0.1104059807):2.355946293,(t246:2.744361675,t247:2.246962386):1.176567992):0.1024563522):0.7068454235,t248:4.185153007):2.71653641):4.68804486):5.554829066,((((t249:6.463515403,(((t250:0.4110048317,t251:0.3798978368):3.556535874,(t252:1.482159277,t253:1.357784019):2.405932367):1.424252379,(t254:3.295476686,((t255:0.2228014707,t256:0.0007149950194):1.012020291,t257:0.8949929808):1.910038564):1.870510334):0.9902920074):1.298404318,t258:6.702316978):0.9093936626,t259:7.328677537):5.32085054,((t260:5.496723658,((t261:2.712772121,t262:2.678587575):2.675975613,(t263:4.493019822,t264:4.459041139):0.7115791612):0.1038550364):4.040258618,((t266:3.666432366,(t267:1.121697843,t268:0.9796012585):2.380802076):4.161624109,(t269:0.2475674029,t270:0.2312712011):7.169144578):1.359607488):3.002806566):3.012063203):2.582647982):2.437227965,(((t271:4.140442555,(t272:1.644697741,(t273:0.6260221081,t274:0.4628435245):0.7447461306):2.44866323):4.817098626,(((t275:2.667791474,t276:2.506850929):1.059024007,t277:3.553620301):0.1405882249,t278:3.473533559):4.507861047):5.107285652,(((((t279:3.30157045,(t280:1.589737613,t281:1.534397332):1.677798831):1.089177355,t282:4.262540557):0.8095016374,(t283:4.313607371,t284:4.285184514):0.5586190674):0.009604797833,(t285:2.989682125,(t286:1.521866275,t287:1.48957074):1.290197297):1.791250259):0.898224205,((((t288:0.1391246904,t289:0.1262650423):0.5551995675,t290:0.5377221174):1.431351211,t291:1.796718492):1.465904497,t292:3.098122425):1.658356043):6.94754831):5.648792327):2.633902584,(((t293:3.21801614,(t294:1.06713429,(t295:0.3221902049,t296:0.1675079821):0.7269725622):2.050690267):0.9588519886,(t297:2.497519661,t298:2.48123715):1.390504781):2.538762436,t299:6.339137566):13.07664978):23.66931954):22.06370877,(((((((t300:1.651909448,t301:1.497164609):13.14504946,((t302:1.213669301,t303:1.14721426):9.956003943,(t304:2.85650867,t305:2.756487732):8.136571964):3.439810643):1.028358716,((t306:1.905030666,t307:1.786106252):11.85031743,((t308:8.184209424,(((t309:3.502947195,((t310:2.803796189,(t311:0.5639385081,t312:0.3588485581):1.931390096):0.07617116827,(t313:1.254779842,t314:1.176231201):1.029913361):0.5494812418):1.2056052,(t315:0.7982867016,t316:0.7349893363):3.118219757):3.044749132,(t317:3.401630322,(t318:1.204692804,(t319:0.05506935791,t320:0.05485436628):1.142439004):2.196142862):3.419873917):0.256220008):0.8006439686,((((t321:1.498670768,t322:1.491244534):2.931987123,t323:4.404179759):0.2333654864,(t324:1.897165022,(t325:0.8061376399,t326:0.6334409317):0.8773152478):2.646978835):0.9619467435,t327:5.111809953):2.1808043):4.148593061):1.500259202):4.894610521,((t328:15.34577727,(((((t329:4.017704443,((t330:3.395528002,t331:3.218360727):0.4158978312,t332:3.611967674):0.1449802555):3.548182344,(((t333:3.867357854,(t334:1.536238039,t335:1.388300177):2.221712306):0.5443564264,(t336:3.362413616,t337:3.224625984):0.747778795):1.883675968,(t338:0.7302604259,t339:0.6506417517):4.856532692):0.9278787591):0.1593817112,((t340:4.286939793,((t341:0.6640460125,t342:0.5102110404):2.244198794,t343:2.678011907):0.9275971318):0.9082997422,t344:4.17880737):1.208199659):3.243955881,((t345:4.236141453,(t346:3.371126832,t347:2.964163736):0.7620554555):3.381016038,(t348:5.925857115,t349:5.743594274):1.125030783):0.7585501696):3.717187293,(((t351:0.4098436394,t352:0.406115754):0.9870207962,(t353:1.125220992,t354:1.053437609):0.1435740996):4.498277789,(t355:4.64761623,(((t356:1.96655534,(t357:1.018193264,t358:0.2683413038):0.7284167255):0.4311657698,t359:1.13281617):1.202964539,t360:2.246590474):0.7518279556):0.991097845):5.284794971):0.5727896775):1.60835158,t361:11.43997593):0.778201531):7.239676041,(((t362:5.127619332,t363:5.081228054):5.115835943,((t364:2.495176947,t365:2.464945831):2.13794491,(t366:3.035316181,((((t367:0.2435608625,t368:0.2390117005):0.2616067877,t369:0.4024771235):0.5993131331,(t370:0.1525001421,t371:0.07711041644):0.7936018377):1.680673596,(t372:2.179771075,t373:2.14633434):0.228300996):0.146673954):1.514650247):5.508991091):8.857663218,(((t374:0.4162044646,t375:0.2228333214):8.640261093,t376:8.532055924):0.3738709272,((t377:5.465301662,t378:5.457468232):1.9637071,((t379:2.032962383,t380:1.826060442):2.313848001,t381:4.091604846):2.833437489):1.465721217):8.949845825):0.354152325):0.06111654308,((((((((t382:1.471360709,(t383:0.5533454538,t384:0.4293011155):0.7783806154):1.399278988,t385:2.508114367):0.375905855,(t386:0.08283699759,t387:0.06950157916):2.510429245):1.743141294,(t388:0.6195947319,t389:0.3023822373):3.699760196):4.618978391,t390:8.522265103):0.1559277672,(((t391:3.006242289,t392:2.999522232):1.233940339,((((t393:0.3901611395,t394:0.1523267301):0.8489149931,t395:0.9183212059):1.375979059,t396:2.253502437):1.152154944,(((t397:1.074168511,t398:1.026986661):1.80719116,t399:2.817939934):0.331332402,t400:3.00683882):0.1346707332):0.1793264686):3.925907303,t401:7.165304796):0.3788335904):3.020644216,(t402:3.90643175,(t403:1.409247844,t404:1.323330655):2.32194539):6.619405434):2.250909563,(t405:9.048128875,(t406:5.47821286,((t407:1.025918677,t408:1.025084291):2.635006751,(t409:2.225329245,(t410:1.209425061,t411:1.184516706):0.9918262699):1.417370987):1.803522848):3.530563322):3.276946069):2.686408412):8.433395496,(t412:2.748946536,(t413:2.431612308,t415:2.086098086):0.08929067149):20.55460954):28.59546072):25.36177089,(((t416:4.806631906,t417:4.579250748):3.041825889,(((t418:3.947718053,t419:3.937919321):0.8631152477,t420:4.728150087):1.045797253,((t421:1.708545489,(t422:0.7177733217,t423:0.6377056922):0.9899374472):0.1193338908,(t424:0.6406787527,t425:0.6181702516):0.9417790173):3.936683661):1.705429517):0.2272381947,t426:7.415418886):68.56881633):215.1007195);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T73.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
