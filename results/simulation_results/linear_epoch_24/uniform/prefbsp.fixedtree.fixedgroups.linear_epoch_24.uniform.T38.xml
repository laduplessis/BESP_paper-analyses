<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((t446:3.103411833,t449:2.85218744):0.3176930047,t450:2.958887392):2.644164612,t451:5.601784301):0.5811517005,(t452:2.707496437,t453:2.668856562):3.436727047):0.1648488175,t454:5.960862174):7.274640279,((t455:6.566635226,t456:6.491650749):4.486900026,((((t457:1.650822126,(t458:0.5748526873,t459:0.5406544083):1.038006636):0.2227054291,t460:1.71691348):4.088787574,((t461:0.3170533895,t462:0.2912467441):1.837869134,(t463:0.06990063374,t464:0.06212041338):2.046266087):3.534843254):0.8761009789,(t465:4.462892231,(t466:3.788618017,(t467:3.079738112,t468:2.916216449):0.6674289554):0.6232544858):1.932926859):3.972702817):2.073487468):22.65991958,((((t469:1.691598707,t470:1.664678999):0.6941745434,t471:2.349192797):7.884872664,(((t472:0.6822708952,t473:0.4500180371):2.862676048,t474:3.244668528):1.097169925,t475:4.309924122):5.444644387):20.88061292,(t476:2.875220183,t477:2.694766822):27.70454204):3.347112267):23.09006296,((t478:4.167343293,t479:4.07449274):46.68465259,((((t480:2.801978623,(t481:2.336779298,(t482:0.5709697443,t483:0.5323129624):1.725156491):0.4049290685):2.747031314,(((t484:0.3582153422,t485:0.3552964394):1.199983512,t486:1.548343234):0.1591163295,(t487:0.5244032336,t488:0.5124738958):1.173825279):3.670694708):14.47542429,((t489:6.094588184,(t490:1.994117241,(t491:0.414783412,t492:0.377559671):1.325136204):3.903427488):5.162071337,t493:10.7485903):8.448756043):0.8127085006,(((((t494:1.298451804,t495:1.174517021):0.5225192948,t496:1.614250771):2.620021397,(t497:1.540145033,(t498:0.8332116988,t499:0.7183105175):0.6789986565):2.668173792):1.011535847,(t500:0.3035734452,t501:0.08898647575):4.728014866):2.158237774,((t502:0.6087732253,t503:0.4801040258):3.706383638,t504:4.125028761):2.616459077):12.09309778):29.90202748):5.921793517):315.1423303,((((t505:6.263437653,t506:6.1532213):2.863996715,((t507:2.993763975,t508:2.86805064):1.149798939,(((t509:1.235089652,((t447:0.05706740075,t448:0.05192866873):0.006918041798,((t427:0.1249167865,(t359:0.02411336958,(t337:0.07339086793,(((t304:0.08590267893,(t283:0.3046788672,(((t234:0.01552169608,(t143:0.02859190007,((t1:3.015401439,t2:3.008560033):2.395200384,(t3:4.883099305,(((t4:0.8599519209,t5:0.8440946178):2.729336638,t6:3.475609313):0.6747106556,t7:4.112415429):0.5121341267):0.4649963255):9.421741104):6.91707716):2.560281161,((((t8:5.60553399,(((t9:2.818549737,t10:2.792660599):0.658870939,(t11:0.1105276591,t12:0.06907029714):3.274039601):1.925699737,t13:5.193486326):0.1674435169):7.538453802,((((t14:6.180360681,t15:5.904589963):0.06182276027,t16:5.920474553):5.579819929,(t17:4.064823143,((t18:3.871356787,t19:3.814772917):0.0565439841,((t20:2.364984765,t21:2.345873322):0.02090617287,t22:2.345018699):1.470503023):0.07391394057):7.139751184):0.4216085413,(t23:2.766494533,t24:2.565094288):8.326293913):0.5752612855):3.428029922,(((t25:11.77459184,((t26:3.732997076,t27:3.42497653):4.668665632,((t28:2.015168013,(t29:1.923781023,(t30:1.219226085,t31:1.1542982):0.7013344231):0.05141377599):2.545487116,(t32:3.950097879,t33:3.715503377):0.4668191381):3.262036542):3.322753273):2.138291266,t34:12.75875594):0.3076195461,(t35:10.30297674,(((t36:1.066779047,t37:0.9887648664):1.789106288,t38:2.763369117):4.16347833,((((t39:3.757200669,(t40:1.991091642,(t41:0.3146993929,t42:0.1709462508):1.508105166):1.657582258):0.6142132257,(t43:1.818938555,t44:1.715194101):2.101318033):0.4900331433,(t45:4.136687472,t46:4.129465027):0.1659546876):0.2123466295,(t47:0.3040920578,t48:0.2521288687):4.143500386):1.705705841):3.146401102):2.630440924):0.6373855956):6.842129979,((((t49:5.940547344,(t50:4.419248318,t51:4.214568993):1.482136637):1.335072058,(t52:3.510177938,t53:3.352031352):3.369887634):2.029276113,((t54:4.773368416,(t55:2.334504472,(t56:2.187371257,(t57:1.833936369,t58:1.786870994):0.2820812891):0.1301066529):2.334974518):1.5833591,t59:6.009571401):2.260799299):2.583382774,((((t60:3.205206908,t61:3.082477246):0.4840622829,(t62:1.04454105,t63:0.9827372817):2.479818086):1.119880597,(t64:1.149342998,(t65:0.4710955301,t66:0.429187387):0.5874477877):3.376773319):0.4057638518,(t67:2.665202623,((t68:1.72182552,(t69:0.3338986113,t70:0.2587996302):1.272001175):0.1956960358,t71:1.455929824):0.603917617):2.106843444):5.614899072):7.368264932):0.5276634938):1.284065078,((((t72:1.194970586,t73:1.087315069):1.552469296,t74:2.637303147):3.174016094,((t75:0.2834043775,t76:0.2141879776):2.923438322,t77:3.05023964):2.524165692):0.1450487932,((t78:0.6256226396,t79:0.2639613689):3.529290617,t80:3.719235195):1.464273534):12.57315912):1.377380072):2.043565303):0.7660106441,t81:21.94044922):1.610733264,(((((t82:0.5105380373,t83:0.4536352519):3.699874248,t84:4.132358891):5.230237319,(t85:6.346579021,(((t86:2.259043001,(t87:1.514323429,t88:1.40191454):0.6337747947):0.6129177647,t89:2.52608325):1.455514946,(t90:3.919005722,t91:3.910450898):0.006410663655):1.982040074):2.982680301):12.62114849,(((t92:4.600924298,(t93:1.348439332,t94:0.8697427787):3.160034276):3.451653714,(t95:1.898251511,t96:1.599515746):5.5781253):0.9947724426,t97:8.038002071):12.27080891):0.3071578409,((((((t98:1.861305742,(t99:0.3828806114,t100:0.353625827):1.404932373):3.499411096,(t101:4.144112152,t102:4.106137019):0.9588144175):2.268472762,((t103:2.309327703,(t104:0.7120639046,t105:0.7101008834):1.55945776):3.915727271,((t106:2.185825251,t107:2.115983657):1.756813591,(t108:0.5884639101,t109:0.4671279748):3.244229214):2.237139174):0.9555175358):0.4254446692,t110:7.252700009):1.111209768,(t111:2.650847126,(t112:1.389328627,t113:1.332953022):1.252014342):5.69839436):6.271673499,(((t114:9.002944009,((((t115:5.523573274,((t116:3.29131347,t117:3.228613052):1.319639074,t118:3.987458481):0.7252631986):0.8744257139,t119:5.513191629):0.3918035434,t120:5.485106573):1.766437477,t121:6.994991625):0.1658633023):2.007616025,(t122:5.096569255,(t123:4.689228391,t124:4.676465545):0.3694707033):4.033538012):2.014441765,(((((t125:0.8520797968,t126:0.69031957):3.185896953,(t127:0.3456154192,t128:0.1182428339):3.492127655):5.595788642,((t129:4.265257501,t130:4.122542062):1.38567346,(t131:2.537725644,((t132:0.1770032417,t133:0.1370552323):0.02171487194,t134:0.1505767277):2.147743225):2.656556049):3.534215043):0.3943150604,(((t135:1.356526553,t136:1.294175188):3.483947047,(t137:1.268410378,t138:0.9428681685):3.309341138):2.33466519,((t139:1.648563688,t140:1.545601855):4.338852178,((t141:2.234019433,(t142:1.197819648,t144:0.931030376):1.015802373):3.294163025,t145:5.214222652):0.2141890062):0.5844077752):1.527034821):0.5685535776,(t146:5.691671675,((t147:0.5466970685,t148:0.5016315217):4.23761158,(t149:3.233253566,(t150:3.132976361,t151:3.121490797):0.05316730682):1.437377414):0.8129320968):2.389109891):0.4476814569):1.525826366):5.168168258):1.158509488):0.628009563):2.016915051):6.010361008):0.1366485219,(((((((((t152:2.941605984,t153:2.864521209):8.147262243,((t154:5.512891224,(((t155:0.4295645689,t156:0.4222501179):1.072794931,(t157:0.192400386,t158:0.05502489479):1.267855799):1.417665147,t159:2.640537916):2.586610747):0.8994450514,(t160:1.360332984,t161:1.353771522):4.70969966):4.575996077):0.4189424652,(t162:8.313899313,(((t163:1.220548528,t164:1.214459012):3.18765785,((t165:1.37592445,(t166:1.063802608,t167:0.9447645776):0.1429748786):0.6461711097,(t168:0.03946300941,t169:0.0342679645):1.626211397):2.348557023):2.303387575,(t170:4.300137942,t171:4.220227979):1.968968103):1.360705213):2.689910106):1.393444613,(((t172:6.237782233,(((((t173:0.05064293821,t174:0.0440652816):1.058907409,t175:0.9359279526):0.6318211502,t176:1.478479557):0.2155142235,t177:1.549659574):3.643080465,t178:5.090578986):0.6169862719):0.905113771,(((t179:3.053576318,t180:3.000489719):1.137676986,((t181:2.243123785,(t182:0.5197162793,t183:0.5175080552):1.626755885):0.8848993662,t184:2.83436021):0.8046246634):2.381196746,((t185:0.9468100336,t186:0.8923906307):4.936771869,(t187:4.80950174,t188:4.768947412):0.9661965058):0.05932633141):0.01975864338):2.896538188,((t189:3.834525431,((t190:0.06578052955,t191:0.05744737273):2.174804752,t192:2.231016696):1.56575404):4.229864123,((((t193:0.5307442186,t194:0.525317103):0.266101421,t195:0.704616955):1.373846058,t196:1.746349793):2.191753355,(t197:2.733065093,(t198:2.668883819,(t199:1.078923218,t200:0.970580569):1.538725582):0.04646356034):1.118318012):3.595357284):0.6078851362):1.583445627):1.713720513,(((((t201:1.08959869,(t202:0.5213986435,t203:0.493525974):0.2642340964):0.8418630425,t204:1.577325816):3.946924668,(t205:3.788142556,t206:3.483436381):1.713920901):2.036046744,(t207:6.438296597,(((((t208:2.170772225,(t209:1.016888981,(t210:0.8430590081,t211:0.8238971048):0.1703702762):1.079697556):0.1201362959,(t212:1.987302058,t213:1.827590641):0.1935389467):2.151443734,t214:4.109179709):0.3728819914,(((t215:0.6185160579,t216:0.5656279244):2.238127367,t217:2.781781775):0.3392376298,((t218:0.4144161455,t219:0.3301557526):0.8595457431,(t220:0.004636058498,t221:0.001411177132):0.785630134):1.846237033):1.130193986):0.116532454,t222:3.808183332):1.354328541):0.786707273):0.2180632702,((t223:1.640771541,t224:1.436656346):0.06922206096,(t225:1.051989395,t226:0.9405661026):0.3926946044):4.386638109):2.946554072):0.2164553191,((t227:1.339432757,t228:1.338095659):5.238837599,t229:6.49940355):2.282380236):8.134614937,(((t230:8.689941904,(t231:7.916858961,(((((t232:1.321253106,(t233:1.023862767,t235:1.004544099):0.1091053396):2.520565142,((t236:2.498888327,t237:2.49397425):0.2611582704,t238:2.709020122):0.7492893109):0.002552009109,(t239:2.633146096,t240:2.556118433):0.75881027):0.7035056635,(((t241:0.4473342039,t242:0.328746507):0.06793324286,t243:0.2253189331):0.1781422353,t244:0.2933877067):3.303827733):2.958542044,t245:6.534874424):0.3731258026):0.7449995781):0.4739123136,t246:7.986312277):0.21562317,(((t247:1.055859411,(t248:0.6597485258,t249:0.6572141507):0.3467211775):1.474133929,t250:2.470589592):4.957512389,((((t251:0.2082232176,t252:0.199211725):1.118692469,t253:1.098133064):3.530538846,(t254:3.375148939,t255:3.371440076):1.016304083):1.661293316,(t256:0.4015397216,t257:0.3918012544):5.621234253):0.837400058):0.6851611124):7.451752047):0.6873199689,((((t258:2.104469994,t259:1.945731013):2.355993977,t260:4.293742652):1.195543413,(t261:0.1928753001,t262:0.1839826107):5.227598638):5.523557084,((((t263:0.9657499588,t264:0.9646519495):1.968176494,((t265:0.8365790064,t266:0.7345806428):1.702840299,t267:2.214787914):0.2245167881):4.577226142,((t268:6.077001741,((t269:0.460171997,t270:0.3427121028):4.369595486,((t271:1.780642791,t272:1.63088002):0.08890768679,t273:1.612797025):2.802541148):1.23384049):0.7539720944,t274:6.228383093):0.1739093595):3.262229557,(t275:5.996116635,((t276:1.063033455,(t277:0.5530489145,t278:0.3492008514):0.3699564504):4.448519307,(t279:2.700717677,((t280:1.957421782,t281:1.651896381):0.6039864877,t282:2.082184763):0.02466022221):2.410622535):0.3030328225):3.377349151):0.1484438168):4.404600437):0.2800815959,((t284:2.659553993,t285:2.630907299):7.283219744,t286:9.670993832):2.173185679):0.9047074742):1.812362654):6.965694968):0.120354077,(((((t287:4.538186486,t288:4.472287441):8.664472715,t289:13.11322202):3.551963192,(((((((t290:4.264163908,(t291:2.83696838,t292:2.660319665):1.324636671):0.9583283245,((t293:3.779867255,((t294:0.2194987577,t295:0.2041537994):2.631445961,((t296:0.605999995,t297:0.3664065729):1.579407846,t298:1.941820776):0.6265858476):0.9209795702):0.2051939581,t299:3.631133485):0.9222989417):0.8786530302,t300:5.383144894):2.733836235,(t301:5.63127845,(((t302:0.3585828434,t303:0.2445448952):0.8260042926,t305:0.8593877936):2.993604318,t306:3.712452393):1.293793187):2.285056138):2.423547056,(t307:3.872478728,t308:3.81821783):5.731739781):2.376352271,((((t309:2.295073288,t310:2.242824417):3.85714435,t311:5.967063259):0.6336385908,(t312:6.255194707,((t313:0.2688442672,t314:0.1399587857):5.498213495,(t315:3.322755623,t316:3.121255279):2.186981368):0.4725039845):0.209404503):3.40502041,((t317:3.942148,((t318:0.6943249946,t319:0.657780564):2.06905037,(t320:2.61506367,t321:2.28854593):0.04447443464):1.136844135):3.319713892,((t322:4.526933269,(t323:0.3206737119,t324:0.3065916941):4.192828624):0.21925755,(t325:0.6695774327,(t326:0.3974564536,t327:0.3931805659):0.2434667321):3.994229225):1.923902604):2.01098508):1.696784458):0.7135564484,(((t328:0.7958780928,t329:0.7247484779):7.940271867,((t330:4.513011741,t331:4.378245882):3.123285277,t332:7.489119838):0.8569467673):0.9057562789,(((t333:4.559053518,(t334:1.676635107,(t335:0.5516418793,t336:0.393837596):1.114423526):2.841751518):0.823399459,((t338:3.726276119,t339:3.692140868):0.5945983241,((t340:0.1060039388,t341:0.1049857518):2.178860862,(t342:1.238357195,t343:1.163747815):0.8694121858):1.918867229):0.7356617832):0.3768381501,(((t344:3.050746369,t345:2.956719718):0.09010389277,t346:2.948169803):0.6182569549,((t347:0.2728597337,t348:0.2692036556):3.028004816,t349:3.129646879):0.1517915643):1.291924107):3.303834795):1.27042542):2.233393949):2.781825087,(t350:1.428557796,t351:1.298891713):12.68051771):0.8968119188,((((t352:0.564667113,t353:0.4484877138):2.978134595,(((((t354:0.345702363,t355:0.3031050593):0.04339570823,t356:0.1514241008):0.4792352772,t357:0.4140652561):0.1797868043,t358:0.3284750446):1.739607508,t360:2.015361489):0.6173129723):1.400240166,t361:3.900482894):9.267701836,((t362:3.786985268,(t363:0.63939262,(t364:0.1175811523,t365:0.008551943025):0.4668593044):2.97583449):3.072073305,t366:6.400673362):6.101052918):0.6382564491):1.099817504):0.9697766319,(((t367:8.310901631,((t368:6.678338071,((t369:3.937376713,(t370:1.452563664,t371:1.323286346):2.095032673):0.3894926733,t372:3.772625014):2.325749938):0.9110107988,((t373:0.07975031158,t374:0.03560921226):3.450079903,((t375:0.5271933181,t376:0.4256177265):1.31488494,(t377:1.522913652,t378:1.522248588):0.1402553355):1.638331909):3.459356447):0.6727683458):3.992993108,(t379:3.461020591,(((t380:1.518577666,t381:1.480759605):0.335323334,t382:1.738551358):0.4416988142,t383:2.164453218):0.7555183112):7.941029184):0.1178845273,t384:10.81548105):2.737193891):1.539252793):4.708048768):8.229363631,((((t385:4.274467684,((t386:2.088515244,t387:2.067024745):0.133656387,t388:1.819460748):1.970057191):1.154143523,t389:4.915565085):2.077469303,(((t390:2.449786898,t391:2.447752649):2.235112881,(t392:1.146356803,t393:1.023759202):3.495214113):1.238585824,(t394:1.917157873,(t395:0.6032344611,t396:0.5762499837):1.204183532):3.783036358):0.9219527675):20.41206249,((((t397:5.817223946,t398:5.399864716):3.247423983,(t399:4.075026549,(t400:2.866536562,((t401:1.019735895,t402:0.9734702476):1.716553149,(((t403:0.3203694398,t404:0.310100718):0.4094102426,t405:0.630794341):0.559721218,(((t406:0.2644343323,t407:0.2325761619):0.3184362654,t408:0.3994913076):0.3889323072,t409:0.7577425402):0.1357805874):1.399792739):0.005885997819):1.175084516):4.545858886):4.131845658,(((((t410:1.885495768,t411:1.810963622):1.199099239,t412:2.935398753):2.57389276,(t413:1.863479937,t414:1.736898418):3.562491077):0.06158940233,((t415:3.115781645,t416:3.10804626):1.800468485,t417:4.90656592):0.4358788329):2.994507572,((t418:1.13359006,t419:1.131240026):0.2107449168,t420:1.16483067):6.975057499):3.300669806):7.30622422,(((t421:7.713006241,(t422:4.868275961,(t423:3.229948294,t424:3.028408526):1.587183256):2.834489151):1.335169532,t425:8.781350038):3.289966177,((t426:7.575393012,((t428:1.419373386,(t429:0.2300732638,t430:0.1895622876):1.080477169):0.2642531279,t431:1.349558986):5.604410886):1.231315885,((t432:0.808079405,(t433:0.05301415902,t434:0.00105888471):0.6349059129):2.457914879,(t435:2.35354004,t436:2.324224796):0.7304700227):4.837825705):3.194430067):6.406921174):6.166382168):0.0946457905):96.17440348,(((t437:1.415828791,(t438:0.8357954428,t439:0.7568304066):0.4130191272):0.05887818834,t440:1.216818267):6.200726232,(((t441:0.4156033279,t442:0.3689652936):0.950800584,t443:1.110027417):0.8484165512,(t444:0.8348097658,t445:0.4844650171):1.04144713):5.185511364):112.1927469):256.0908437);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T38.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
