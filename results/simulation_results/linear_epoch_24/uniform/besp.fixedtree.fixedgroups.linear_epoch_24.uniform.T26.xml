<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t486:2.393299075,(t487:1.540515294,t488:1.519543995):0.7295041921):66.11415327,((t489:2.56204526,t490:2.502433651):7.169329116,(t491:4.920501584,t492:4.907754979):4.664239592):58.59981109):131.9703274,((((((t493:4.264554939,t494:3.982997627):3.862168212,(((t495:0.677698145,(((((t449:0.2429482341,(((t378:0.1405942085,(t379:0.02220716221,(((t291:0.08686766352,((t252:0.002279025304,(t237:0.04706190826,(t213:0.02217010741,((((t88:0.05496128762,(t80:0.1557550426,(t72:0.01694005237,(((t1:2.156116241,t2:2.107911397):0.4917734652,t3:2.598773606):0.5571519165,((t4:1.597816663,t5:1.443269813):1.194728476,t6:2.58796045):0.1268260196):3.705892907):1.038213547):1.099370662):5.640035794,((((((t7:3.141310797,(t8:2.719713743,((t9:0.2864026633,t10:0.1828921331):1.244765302,t11:1.376849206):1.117021318):0.3918885846):3.459487731,t12:6.165195739):3.596069737,(t13:7.572849981,(t14:6.30701235,t15:6.26779335):0.9062318111):2.140555401):0.4293374449,t16:9.714781015):0.0361707947,((t17:5.520685614,(t18:3.49062281,(t19:1.481401481,t20:1.409695661):1.970176875):1.879411116):3.710966684,t21:8.897283184):0.5043476171):0.04587673983,t22:9.440178552):3.418231469):3.774389337,(((((t23:5.072218157,(t24:3.253996252,t25:3.150950037):1.793442301):1.677757684,(t26:3.042489315,t27:3.021043007):3.5442222):2.239932184,(t28:8.227141785,(((t29:4.67322832,((t30:0.1960996536,t31:0.01543665791):1.664800813,t32:1.598615066):2.798236139):0.7453243704,((t33:3.377652617,t34:3.375158872):0.5885552728,t35:3.87133176):1.107795976):1.705615163,(t36:1.632024937,t37:1.574032423):4.845407792):0.9736285786):0.4605295479):2.927415746,(t38:4.999006969,t39:4.852805451):5.745088149):0.5284731914,((t40:9.637378408,(((t41:0.7165503182,t42:0.6946751211):4.053685195,(((t43:3.007243087,t44:2.927277959):0.00917068353,t45:2.771819669):0.8138835424,t46:3.524273413):0.8717172311):2.848062784,(((t47:4.26667406,(t48:2.541447142,t49:2.526037166):1.709799262):0.1431333411,(((t50:1.022394363,t51:1.01183579):2.2111854,((t52:0.9518855924,(t53:0.6856060784,t54:0.3394103951):0.2572934516):0.5935411372,t55:1.070022661):1.227624228):0.9149235015,t56:3.127659011):0.06598804344):1.888498805,((t57:1.825902046,t58:1.817387241):3.158635007,(t59:2.674647999,t60:2.549217381):2.194678642):0.006040634573):0.8895578643):1.896351126):0.9700000242,(t61:7.396696423,((t62:2.285924918,t63:2.226718123):2.369924361,t64:4.544847217):2.578301837):1.041003806):0.1773570283):3.904958447):2.924644996,((((t65:2.908493098,(t66:2.494770842,t67:2.486388011):0.2898344771):5.8039176,(t68:7.926425563,((t69:4.183227645,(t70:1.047400896,t71:1.046879169):3.04244545):2.531252339,t73:6.16472223):1.1099517):0.6163420127):1.858443725,((t74:7.598607293,((t75:0.6309915613,t76:0.5439424734):1.517378284,t77:1.935928143):5.429584364):1.322859205,t78:8.399372581):0.8153297395):2.322973825,((t79:3.277228752,t81:2.966270184):6.478261561,(t82:5.212812526,((t83:0.5870053943,t84:0.4648004772):4.174197946,t85:4.595219151):0.2959179347):4.192693507):1.726586595):2.130572067):1.064551976):2.30144099):1.560633308):1.42191388,(((((t86:2.187211407,t87:2.180421225):5.858842661,((t89:4.336656443,(t90:2.601237622,t91:2.583506325):1.542670456):0.4141139733,(t92:1.3133055,t93:1.297633134):2.592490306):2.845365927):3.359893729,((t94:1.492530368,t95:1.435792556):8.575042923,((t96:6.303564186,(t97:4.627141509,t98:4.604481528):1.640384363):2.033067283,((t99:3.462248765,t100:3.285473623):4.077754673,(t101:1.598851163,t102:1.59391595):5.697488927):0.6736968768):1.584141794):0.007649571119):2.542337977,((((t103:1.200199776,(t104:0.796384637,t105:0.7393663393):0.2944296776):0.2077051149,(t106:0.7244300179,t107:0.7169852473):0.157166286):7.997422353,(t108:0.6868681688,t109:0.6483090934):8.177165396):0.1018437543,(t110:7.713310721,(t111:2.68715099,((t112:1.216532104,t113:1.157809106):0.8471949471,t114:1.998124827):0.5682082104):4.932124618):0.9758748455):2.448725831):0.8005759874,((t115:0.5013232929,t116:0.4961787946):2.760207902,(t117:1.063789935,t118:0.9387610388):2.127097773):8.361318863):4.263101699):1.28334175):0.8754412032,((((t119:2.873182737,(t120:1.446893964,(t121:0.08501703288,t122:0.0003052688705):1.143414988):1.376770764):0.9436489212,t123:2.998947589):0.3714859978,t124:3.19683761):6.934964239,(t125:2.528423854,t126:2.523403962):7.535986417):6.594786327):5.693297362,(t127:17.01583068,(((t128:0.7696732277,t129:0.5960573152):4.977754332,(t130:1.067014565,t131:1.056959269):4.431368828):4.00553582,((((t132:1.281124762,(t133:0.9029040258,(t134:0.3259813115,t135:0.2433677055):0.3537076322):0.3342826559):0.1323422023,((t136:0.1412275729,t137:0.09524597198):0.4624510437,t138:0.5326985432):0.4568960537):3.312185335,t139:4.163824377):3.934878793,(((t140:1.465968915,t141:1.209682068):0.03670019784,t142:0.9079730819):0.8415968004,((t143:1.071039764,t144:1.03538812):0.3594821756,t145:1.366117611):0.2519510648):5.733316365):0.7307458621):7.226942143):5.064727397):2.042978791):0.1043106741):0.9376164782,(((((((t146:0.5968815474,t147:0.5938690723):2.094261947,(t148:0.4981863958,t149:0.4377504953):1.791886562):0.277152505,t150:2.483581008):6.760333707,(t151:1.484165302,t152:1.144505715):7.689601987):8.816418817,(((((t153:9.25973597,(t154:8.261926804,(((t155:1.229993864,(t156:0.7733184479,t157:0.7048725666):0.4404218428):0.3564410988,t158:1.492494968):6.417016218,t159:7.034886787):0.2193471345):0.9841566953):0.962231347,((t160:0.8722309864,t161:0.8353300507):0.3356955538,t162:1.033983385):7.83198474):4.289807207,(((((t163:3.325401098,t164:3.312290693):2.106583508,t165:5.405445061):3.742486837,((t166:3.985348324,t167:3.968206406):1.821403598,t168:5.551563147):2.933461521):2.347223382,((t169:5.348752916,t170:5.236713727):0.455457139,((((t171:0.6377973312,t172:0.5444905523):1.10284594,(t173:0.3737975944,t174:0.3424005204):1.155378191):0.238759897,t175:1.514339041):1.750148505,(t176:0.306350915,t177:0.2478262025):2.918217837):1.902390187):5.005720804):0.8004919398,((t178:7.207516357,(((t179:0.8573719337,t180:0.7988037527):2.260638215,t181:3.046935008):0.1025914546,t182:3.067720437):3.804543231):2.398244949,((((t183:2.276467131,t184:2.098076205):1.280898711,(t185:0.8006546107,t186:0.7933035881):2.553148851):2.122397314,t187:5.444578971):1.267736717,(t188:4.950322228,(t189:0.1667396202,t190:0.1507893995):4.735461636):1.748254562):2.321936823):1.111249506):0.6966937615):2.165212288,(((t191:6.01889679,(((t192:1.005434854,t193:0.9046098762):2.428520544,(t194:2.254296099,(t195:1.888593078,t196:1.88331811):0.3482721381):0.9812398641):1.855224368,(t197:3.949901064,(t198:2.950184797,t199:2.555427961):0.7144947449):1.112429982):0.7232343567):1.759731679,(t200:5.535032533,((t201:2.495195494,t202:2.367290471):1.896999492,(((t203:0.09425929698,t204:0.05783917287):1.01606688,t205:0.872627053):0.1418685368,t206:0.5918407174):2.849024853):1.010598629):1.288388728):4.528530452,(t207:4.763271522,(t208:3.501890356,((t209:1.489981317,t210:1.446965394):1.39069379,t211:2.791525719):0.608158431):1.240423483):5.423569087):0.6176012076):0.2710401074,((((t212:1.683285905,t214:1.375596097):3.117386039,(((t215:1.73767132,(t216:1.68302633,t217:1.279588448):0.04440011646):0.3377077495,(t218:1.460546771,t219:1.27568389):0.1898884605):1.046662053,t220:2.414725618):1.267345904):0.8570347422,t221:4.509959034):0.8967178984,t222:5.354340594):4.222788253):0.6843333424):0.3076918498,((t223:8.589374519,((t224:1.460699798,t225:1.166490846):1.926736377,((t226:0.2211500426,t227:0.1185606268):0.502551087,t228:0.5640826835):2.324535153):5.156766034):0.4320684922,((t229:1.963037091,(t230:1.209780647,(t231:0.8652337156,t232:0.8074474656):0.3408659308):0.6475668161):1.353083451,((t233:2.293022037,t234:2.281403751):0.166181584,t235:2.292522233):0.6716220258):5.151754543):1.470204639):2.485914668,(((t236:3.949885318,t238:3.864588414):1.756636799,(t239:3.63203375,(t240:0.4253978197,t241:0.1378563255):3.010860414):1.967356471):1.339587131,(t242:5.487490677,((t243:3.209243563,t244:3.091388524):0.2851241797,((t245:0.4546816857,((t246:0.08592008911,t247:0.05852058642):0.2605772732,t248:0.2076986919):0.04534397249):1.411868605,t249:1.561404292):1.420657809):1.93120483):0.7019886062):4.937719136):2.018233276):1.041729517,((((t250:0.5346151788,t251:0.5075548708):2.234613624,t253:2.591511906):2.901687604,t254:5.479612618):3.126343306,((t255:1.37498856,t256:1.299703814):0.5912186448,t257:1.886370477):6.6356637):4.778524691):4.075453731):0.06756086853,(((t258:5.069171436,t259:4.994296511):8.163244077,((((((t260:5.12396714,(t261:3.020327005,t262:2.977041911):2.102795248):1.354510657,(t263:2.737596708,((t264:1.351639257,t265:1.304486997):0.7874336036,t266:2.070014742):0.5907141271):3.506495553):2.588660962,(((t267:0.70439662,t268:0.6644882938):2.668673359,t269:3.307788833):2.642691905,t270:5.94035201):2.731336382):1.925444253,((t271:0.2038576785,t272:0.1011206583):9.62890078,(((t273:0.154289012,t274:0.1034205986):5.459750642,t275:5.484999461):0.1925105829,((t276:2.740906721,t277:2.619590153):2.762927206,((t278:1.820503735,t279:1.792613188):0.4489712597,(t280:1.874957881,t281:1.634074):0.2138992319):3.101795518):0.1055859289):3.86539479):0.6540577958):0.1976200739,(t282:7.098196731,(t283:4.610504924,(t284:3.711096724,t285:3.668242458):0.7338545831):2.445108273):2.641992997):0.3335226841,(((t286:3.813306105,(t287:0.6795490862,t288:0.6360277858):2.881364424):3.142451691,(((t289:2.535738432,(t290:0.7635441245,t292:0.6436825106):1.720721367):2.189796796,(t293:3.334895663,((t294:1.893388067,t295:1.874541388):0.5567929618,t296:1.957934606):0.7370911655):0.8804095749):0.8929915743,t297:4.44276906):0.8843884929):0.1572516744,((((t298:0.423391565,t299:0.3996717868):0.2297115078,t300:0.5348523042):0.3224697919,t301:0.6865276734):0.9898473361,t302:1.481462191):3.454924295):2.626436249):1.630525333):0.6325166634,((((t303:0.6552840918,t304:0.6303524752):3.710352922,((t305:0.01823270898,t306:0.006551745062):3.123352763,t307:2.859127409):1.181266628):0.7752589995,t308:4.805079195):0.681859033,(t309:3.77491383,t310:3.611263118):1.671603685):3.967918481):3.457710786):0.195336223,(((t311:0.5686287121,t312:0.5231158985):5.803122218,t313:6.303653409):3.585056789,((t314:2.845068059,t315:2.786349246):6.984675234,(t316:6.48015123,t317:6.478431218):3.200287298):0.01114018431):2.675252855):2.406108394,((t318:2.409634181,(((t319:0.6549233736,t320:0.6034438444):0.5520797568,t321:0.9954274146):0.184757966,t322:1.07599948):0.74644943):1.419082551,(t323:0.4812066489,t324:0.4137839902):2.458648258):10.70266774):0.9709234203,((((((t325:3.060079606,t326:3.053520658):2.249770522,(t327:0.8235149512,(t328:0.6476415604,t329:0.4839866346):0.06597774097):4.416457636):0.128446655,((t330:0.4339078121,t331:0.3596966444):3.244136894,((t332:0.6614455635,t333:0.6241640968):2.045294206,((t334:1.59928891,(t335:1.440313711,t336:1.39840874):0.09279533363):0.4891538029,t337:1.955569738):0.5787229638):0.8494736882):1.364500168):1.39429447,((t338:2.296424011,t339:2.161080661):1.345592907,((t340:0.5155210363,t341:0.4567556785):1.943526252,(t342:0.5904042447,t343:0.5902759983):1.658629534):0.8454302952):2.428631739):6.602351055,(((t344:3.422743902,((t345:1.892107268,t346:1.88877983):0.5591189695,(t347:0.9105071344,t348:0.8601616246):1.364384886):0.9274749644):3.318791584,(((((t349:0.2999835152,t350:0.2716140028):2.468596937,t351:2.712617404):1.279940516,(t352:1.022130941,t353:1.009091811):2.9479816):0.1887782137,t354:4.080304918):0.05088577261,((t355:0.6449593299,t356:0.6214174431):0.9590729501,(t357:0.8651294047,t358:0.8635212248):0.5703421692):2.523542986):2.145201626):4.376491305,(((t359:0.9917884007,t360:0.9635134813):4.777781554,t361:5.739637963):1.111238516,t362:6.776920319):3.594141408):0.7958053177):0.07537596975,(((((t363:2.091011145,t364:1.881611254):2.023384502,t365:3.887363048):0.3478197306,(t366:3.489018544,(((t367:0.2126611194,t368:0.05890179639):0.5029796303,t369:0.303431713):0.1698131482,t370:0.1810636502):2.445424425):0.60909274):0.7162621044,(t371:1.065005687,t372:0.9402096284):2.878698616):3.515795941,(((t373:1.710989267,t374:1.645060725):1.366353431,t375:2.952008298):1.572208653,t376:4.362783811):2.343964539):2.284097773):0.9211353572):1.159904625):0.544355107,((((t377:5.127972171,t380:4.762339455):0.3502286777,(t381:1.526415734,(t382:1.258251201,t383:1.256516461):0.1675539024):3.543971346):2.735478572,((((t384:1.086806306,t385:1.062966527):1.480535615,t386:2.520023321):1.357508969,((t387:2.36933244,t388:2.243218086):1.386651409,((t389:0.04712394504,t390:0.01697429987):2.002955581,t391:2.016627561):1.523135931):0.1193677676):0.2990855892,t392:3.946018978):3.463967521):3.212669745,(((t393:3.600701002,(t394:2.862051984,((t395:0.5549299059,t396:0.5040790293):0.7503667433,t397:1.186609041):1.548966009):0.5957054196):3.309938049,(t398:2.102620151,(t399:1.603501451,(t400:0.31062196,t401:0.2801395179):1.184833233):0.3516810604):4.344863881):1.962495247,t402:8.006351299):1.73696485):0.11697259):4.82291971,((((((t403:0.2712129231,t404:0.2342423124):2.081081495,t405:2.137746918):1.184285221,((t406:0.6607224264,t407:0.5919966961):2.465424586,t408:3.009847124):0.1839790332):0.245187143,t409:3.43793607):0.3307671021,(t410:2.641819404,(t411:1.538474302,t412:1.524496696):1.088874115):1.025567502):10.37383407,(t413:7.494421768,(((((t414:0.4717403104,t415:0.4534401268):1.659335912,t416:1.992932557):3.173130599,((t417:2.848616653,t418:2.788561994):0.5142822229,t419:3.251051704):1.652614209):0.8283535346,t420:5.718188974):0.8928879421,(t421:2.159770358,t422:2.04711359):4.029541158):0.3912165454):6.433026213):0.1929654428):1.774447622):7.08913446,(((t423:1.078525476,t424:0.6452500527):6.36507009,t425:6.687498441):12.09513705,(((t426:4.521197498,(t427:4.352639421,t428:4.351590469):0.0008966694976):0.6335435669,t429:4.866339651):8.870124158,(t430:12.36438631,(((t431:1.622712932,t432:1.50876852):4.146619325,t433:5.643491447):3.456008445,t434:8.923538211):2.921874859):1.293343316):4.662850777):2.294660969):4.699346699,((t435:0.09277598573,t436:0.08742858204):18.19934326,(t437:1.992605586,t438:1.944755405):16.27736856):6.457622214):100.1439011,(((t439:7.709586589,t440:7.661318508):1.74904063,((t441:6.281137019,((t442:1.480171308,t443:1.465817391):0.4938773516,t444:1.894040429):4.091549119):1.135972871,t445:7.117364879):1.960431588):25.44045691,((((t446:1.782835574,t447:1.763586378):2.953113694,t448:4.616184436):6.124716809,(t450:5.003827822,(t451:0.6294301938,t452:0.6099161086):4.365563843):5.3420299):14.20990358,(((t453:6.957683491,(((t454:0.07113434309,t455:0.05506603122):1.551021619,t456:1.549847921):4.069841063,(t457:2.313633405,t458:2.144808025):3.188405388):1.230417774):5.451197961,((((t459:2.681774717,t460:2.677374253):0.23619793,t461:2.755621035):3.003741383,(((t462:0.5075497766,(t463:0.3514569152,t464:0.2079481493):0.1236612874):2.497041222,t465:2.825525687):1.236378692,t466:3.974279167):1.517845191):5.656263093,((((t467:0.1117735634,t468:0.05197880214):2.544540099,t469:2.54345481):0.4247340369,((t470:0.8072481955,t471:0.7536048697):1.676664503,(t472:2.151815968,t473:2.137882159):0.1904445375):0.3682302911):3.159964959,t474:5.721498232):4.609683249):0.2130986998):1.59597368,(t475:1.699384975,t476:1.468710583):10.35186715):10.37709316):9.395518834):89.85057314):24.46900794,(((t477:0.2668095056,t478:0.1268886339):2.648848166,((t479:1.491979344,(t480:0.8748062055,t481:0.7746370325):0.6028934271):1.053890356,t482:2.249396875):0.1826008614):35.39299848,((t483:0.7870924985,t484:0.6335113892):5.847479754,t485:6.356948843):31.17225773):107.3752937):55.59598672);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T26.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
