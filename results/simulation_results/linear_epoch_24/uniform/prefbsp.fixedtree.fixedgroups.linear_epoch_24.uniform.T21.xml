<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t440:1.416159898,t441:1.399182237):0.07892651029,t442:1.412145909):0.06413930478,t443:1.252743607):4.991579271,(t444:4.221248981,((t445:1.944084923,t446:1.921708019):1.757477137,t447:3.535075127):0.4911728829):1.922699272):135.5865898,(((((t448:2.120790972,t449:2.056816152):0.4434208104,(t450:0.6344853781,(t451:0.005453940485,t452:0.003124949526):0.2454588252):1.826843922):31.79144704,(((t453:1.391046517,t454:1.367761213):1.992825266,t455:3.354451706):8.039798303,((t456:0.3280237705,t457:0.30154489):9.797910689,t458:10.07914096):1.206636205):22.3999405):21.6322864,(((((t460:2.096719,t461:2.086096015):0.2376284037,t462:2.079622178):14.36856392,(((t463:9.770766949,t464:9.770644843):0.2136001171,((t465:7.192383928,((t466:1.092009679,t467:0.9712309032):0.8230979263,t468:1.620982771):5.272395342):0.5345253193,((t469:2.185461979,(t470:0.5335146669,(t471:0.106714628,t472:0.1043581439):0.4188456557):1.625093984):0.005855115972,t473:1.90513587):5.139220154):2.173521789):5.909409055,((((t474:1.119438891,t475:1.057529484):2.401033325,(t476:1.150517061,t477:0.8497341136):2.067954683):6.488790209,t478:9.396635031):1.490454512,(t479:7.976605784,t480:7.925315866):2.858379058):3.412804267):0.5105727821):8.360807942,((t481:2.497324605,t482:2.462571788):3.425301111,(t483:5.48179945,(t484:1.940074916,(t485:0.9110201625,t486:0.8161293683):0.8400011748):3.179733519):0.379362396):17.10294591):12.23487629,(t487:4.796924434,t488:4.70662047):29.35728931):17.79588641):11.9754509,(((((t489:2.165487391,(t459:0.1230551925,(t405:0.156557145,((t359:0.05877094508,(((((t241:0.1440175072,(t205:0.1752128238,(t189:0.01435398765,(t151:0.481949224,((((t74:0.01974741981,(t62:0.03107388309,(t51:0.1396396964,t1:4.855313094):1.102912407):1.241885926):2.710355393,((t2:4.412647452,t3:4.307208064):3.330781917,t4:7.529205255):2.127995582):2.266033628,(((t5:4.513336452,t6:4.459329007):5.27543211,(t7:6.741049129,(t8:3.732934963,(t9:2.812401639,t10:2.752374845):0.7764828225):2.725530575):2.993574528):1.106840166,t11:10.22144502):0.8440684062):0.4216977095,t12:11.35694732):4.357726633):3.838661289):0.9529201589):3.632133037):7.715979242,(((((((((t13:2.009175118,t14:1.872835983):0.8118434706,((t15:1.968076272,(t16:0.6016342644,t17:0.4335790654):1.35190305):0.1526080207,t18:1.827844693):0.4619884514):8.831925652,((((t19:1.764360535,t20:1.664280705):6.388969005,((t21:3.194938099,t22:3.006688299):0.502563616,t23:3.453668974):4.348632517):0.1214403991,(t24:2.678047024,t25:2.66123589):5.109963517):0.4350276945,t26:8.137055541):2.384100573):4.70445006,((t27:5.361726771,t28:5.191093326):0.8545987246,(t29:5.444010404,(t30:1.656851687,t31:1.65679522):3.733567424):0.51156852):8.924697657):0.9859430393,((t32:8.267325515,(t33:5.320228749,t34:5.302931358):2.843136258):4.464812339,(t35:4.011410098,t36:3.931816838):8.487545755):2.972204968):5.833338455,(((t37:3.135767692,(t38:2.725959247,t39:2.606412482):0.3557748574):5.483145989,((t40:0.7410465826,t41:0.7072926157):3.150067191,t42:3.829273597):4.518282184):6.607221006,((t43:1.570870076,t44:1.476776122):4.587466182,(t45:1.177530434,t46:1.052145899):4.567970877):8.717242):5.823954327):4.77981013,(((((t47:3.759584112,t48:3.712102629):14.29665961,(((t49:5.171054988,t50:5.158763609):3.186694487,t52:8.082597291):0.7725705292,(t53:1.773919797,(t54:0.6865972775,t55:0.6336394508):1.031500634):7.072970546):8.749742997):1.831304106,((t56:4.573585705,t57:4.550906723):13.1507901,(t58:9.341629465,((t59:3.446232906,t60:3.422887361):1.042858795,(((t61:3.774286511,(t63:2.624952327,((t64:2.277032878,t65:2.030855276):0.3112791533,t66:2.13783054):0.02617447213):0.7496829217):0.250575537,t67:3.056730018):0.251543152,(t68:1.272713536,(t69:0.07918197943,t70:0.0575359734):1.084636158):1.883773824):0.1750021283):4.845961431):8.111006916):1.416016092):1.335457607,(((t71:3.526526194,((t72:0.2587621325,t73:0.1206919706):2.005683419,((t75:0.7246592486,t76:0.7169257113):0.9708258024,t77:1.564686438):0.2510113419):1.17235777):3.367333998,((t78:4.390277941,t79:4.370815164):1.220258619,((t80:3.935111127,t81:3.881921025):0.6880677855,t82:4.21145764):0.8629574185):0.6722277043):0.9628698748,(t83:1.610779502,t84:1.554008669):4.985191379):11.05197484):3.364306342,((t85:1.921918861,t86:1.755898066):11.85088176,(((((t87:2.834646038,t88:2.799402008):4.082550557,((((t89:0.4123262135,t90:0.3352246076):1.583331163,((t91:1.105302473,t92:1.035709367):0.3026249187,t93:1.064888188):0.2408488437):0.5887772789,(t94:0.521926916,t95:0.4904096292):1.238255411):1.295211207,t96:3.016556224):2.889782611):1.749124212,(((t97:0.6910420295,t98:0.6236821894):1.265336363,t99:1.841981248):3.820036359,t100:5.509315792):1.610854228):2.609402748,(t101:4.529976359,(t102:2.855800517,t103:2.855696045):1.576968633):5.190792587):1.999067697,(((t104:3.594061222,(((t105:1.422215897,t106:1.357451046):1.914319876,t107:3.238498906):0.02022349215,t108:3.047511552):0.2173100806):4.282221858,((((t109:0.2954125351,t110:0.220253383):0.06956118443,t111:0.2503105503):1.7458074,t112:1.910784148):0.3727479799,t113:2.145816117):5.03610001):3.477153872,(t114:3.639398851,((t115:1.180893587,t116:1.176929129):1.520763727,t117:2.675615906):0.885708139):6.921931968):0.09756410741):0.1219860637):7.002537693):0.2064377599):2.038263846,(((((t118:0.4639488707,t119:0.002048742677):5.63136682,((t120:1.767610728,(t121:1.596964103,t122:1.46010388):0.1270975791):2.471603279,(t123:2.183926616,t124:1.888193543):1.785573521):1.285593538):2.044380465,((t125:2.753569858,(t126:0.2887124884,t127:0.2307559871):2.445806324):0.6666706055,t128:3.26555374):3.418069275):0.1573118832,(t129:2.952547706,t130:2.724666611):3.772860397):11.34178993,((((t131:0.3078067621,t132:0.2886608128):7.480396617,(((t133:1.206681269,t134:1.178147305):3.522077529,t135:4.497638898):2.319691404,(t136:4.916706494,t137:4.735249743):1.472784759):0.2625253908):2.889052573,((((t138:3.200204687,(((t139:0.9058720808,t140:0.6924789547):1.279546226,t141:1.892955715):0.3950854356,(t142:1.599290368,(t143:0.710856078,t144:0.4339021978):0.8254087071):0.5659216059):0.448255776):4.419928726,t145:6.665427511):0.3607434142,t146:6.901786034):0.7858065042,(t147:3.326922718,((t148:1.407836194,t149:1.319879337):1.086613615,t150:2.295660597):0.7939859865):3.883145382):0.5920127349):3.186080583,((t152:3.075139136,(t153:0.5981803731,((t154:0.3602491661,t155:0.2217846482):0.1063421554,t156:0.3022574001):0.1221380162):2.470471244):2.181491973,t157:5.04178414):4.791965005):3.823027673):0.309937461):0.4725685479,(t158:6.948366247,((t159:0.1234321051,t160:0.1199053094):1.734760947,(t161:0.7582192159,t162:0.5283615625):0.5977013008):4.97693382):7.446485744):1.282768381):0.7221116264,((t163:3.739171139,t164:3.657340624):3.275278724,(t165:4.167314479,((t166:3.863215372,(t167:0.3881327664,t168:0.3807315678):3.357061733):0.1044212373,t169:3.226665605):0.1340508251):2.663751788):8.471339446):2.274089128,((((((t170:1.821325544,t171:1.809696424):0.1586035456,t172:1.948196295):3.606421126,(t173:2.0073472,(t174:1.235072008,t175:1.188285807):0.4579855637):3.514100859):0.4413846364,t176:5.547868332):2.640801093,(((((t177:1.201750817,(t178:0.8838315247,t179:0.875142272):0.317267679):0.05146540367,t180:1.176714152):0.653902622,((t181:0.150513652,t182:0.05695814384):1.088213934,t183:1.073783739):0.4753152643):1.237228823,(t184:1.505151656,t185:1.476226325):0.9816876947):2.324218299,(((t186:0.2293390041,t187:0.1983188652):0.6189585256,t188:0.7983531611):1.920232228,((t190:0.6754275504,(t191:0.1057109424,t192:0.004139753135):0.4997836275):0.09010420184,t193:0.5924089006):1.682093897):1.969475366):2.655628352):2.953157559,((t194:5.824859967,((((t195:0.7826567503,t196:0.7523534234):0.5468511942,(t197:1.259402772,t198:1.258990684):0.03949784993):2.882734728,(((t199:0.2750249766,t200:0.2673408789):1.330297428,t201:1.529813312):2.163205336,(t202:0.2554453872,t203:0.1225362452):3.418038533):0.3591824216):0.7521088246,t204:4.608073013):0.8412388828):1.209267527,((t206:2.882151164,(t207:2.068946091,t208:1.973588723):0.7185249713):1.308402654,t209:3.982419751):2.18674305):2.797501783):5.082621412):0.3502689694,(((t210:7.944831015,((t211:3.33352947,t212:3.160987259):4.552663333,(t213:6.525993925,((t214:2.148037225,t215:2.071991294):0.8869561843,(t216:2.436700984,t217:2.319886746):0.4805322628):3.152485213):1.158489212):0.0382533317):4.989395991,((t218:7.45641458,((t219:0.3324381669,t220:0.3065844557):2.543325908,(t221:2.069414884,t222:1.952565167):0.7413712213):4.538723351):2.372425528,(((((t223:4.276484823,(t224:1.827817776,t225:1.649891481):2.43766876):1.041825338,(t226:0.3864635171,t227:0.3422499348):4.726003508):0.3147461921,((((t228:0.6532462477,t229:0.6464509033):0.08600706459,t230:0.7213728204):1.678605748,((t231:0.4813452049,t232:0.4617677138):0.387424415,t233:0.7976490151):1.160571593):2.165211115,(t234:2.828273646,t235:2.679459874):0.9293891454):0.7941123705):0.2039351673,t236:4.489012875):2.941331244,(t237:5.872954655,t238:5.765680913):1.490717778):0.5913445404):2.119498289):0.7196403155,(t239:8.386515852,(t240:1.781169967,t242:1.547203041):6.567516135):2.233441752):0.6486167881):0.03097683838):1.470084202,((t243:3.013578676,((t244:1.2935642,t245:1.098037584):1.122939349,(t246:1.260236618,t247:1.105974193):0.8811592656):0.4670163036):1.589257632,((t248:0.02750097111,t249:0.01510506159):1.287060112,t250:1.129721463):2.407691002):7.807735457):2.391474725):4.181443178):5.476214455):0.7224159323,(((t251:2.985771706,t252:2.982788919):0.7176753875,(t253:1.711683675,((t254:1.064191584,t255:1.027884223):0.0777238602,t256:1.068856138):0.3973688378):1.926139574):7.222828249,((t257:5.034245686,t258:4.915534353):0.2483629141,(t259:2.394698121,t260:2.377455809):2.690764579):5.190228733):13.17338518):2.171472445,(((((((t261:10.46154998,(((((((t262:1.195350772,t263:1.190221494):2.435449314,t264:3.61270481):0.966220173,((t265:1.812818205,((t266:0.2414089733,t267:0.2135180354):0.3276817618,t268:0.4167704871):1.174286817):0.6845899823,t269:2.215408459):1.877473314):2.390865255,t270:6.273604761):1.113506508,((t271:3.586774032,((t272:2.906959594,(t273:1.680405773,((t274:0.99378767,t275:0.8120403606):0.5459312736,t276:1.357927078):0.02950167828):0.6894077565):0.1194169029,(t277:1.786069217,((t278:0.4216787839,t279:0.4003162646):0.1341126147,t280:0.3520444908):1.178419155):0.3215301097):0.5259352559):3.170211983,t281:5.538666402):0.4878780801):0.4534567322,(((t282:0.5101870422,t283:0.5013021852):0.6275448257,t284:0.9661065172):2.135664641,((t285:0.4815990686,t286:0.403316533):0.07080516916,(t287:0.02383734402,t288:0.0216922292):0.4132428258):2.314707053):3.198320244):1.661821772,(t289:1.306065611,t290:1.268354936):6.299347176):0.2341782019):3.900378432,t291:11.59689099):0.1094944924,(((((t292:0.4652222994,t293:0.3226188792):4.9258595,t294:5.23632181):4.135604157,(t295:8.191222983,(t296:5.251473657,(t297:2.522242651,t298:2.521866483):2.640067068):2.897328046):0.9252093656):1.033740803,(((t299:0.4271416851,t300:0.05996146017):2.870387336,(t301:1.200130034,t302:1.136980105):1.660926152):2.139083275,(t303:1.791129074,t304:1.628074693):3.114824973):4.578458757):0.2997023742,((((((t305:2.122546007,((t306:0.2265176638,t307:0.1748196394):0.2514040419,t308:0.4230512753):1.4570032):0.2496165966,t309:2.106356272):1.022833912,t310:3.11729237):0.995085132,t311:3.666612069):1.99867273,(t312:2.5680419,(t313:1.218676993,((t314:0.3534014327,t315:0.2836817777):0.3203383455,t316:0.4464480806):0.5173341665):1.218337172):3.00693817):2.533340286,(t317:4.776499197,t318:4.705720139):2.821533862):0.3201080593):0.7508055247):2.13150118,((t319:0.4300615407,t320:0.2854393615):0.1070547941,t321:0.3276133095):10.17426001):2.82892481,((t322:3.768841537,(t323:0.424246548,t324:0.4090733298):3.275438302):2.408099575,(t325:0.8218950001,t326:0.8143167655):5.127076886):6.958502165):0.6198983085,((t327:5.748676883,((t328:4.27411224,((t329:1.319063422,t330:1.268163569):1.526830736,t331:2.749684947):1.277494702):1.40476872,t332:5.186053724):0.0672464964):5.189508855,((t333:2.840855429,t334:2.82216013):2.555752091,t335:5.261302418):5.011971976):2.453777541):0.79636914,(((((t336:1.456240649,t337:1.44812296):4.960214202,(t338:1.881092119,t339:1.802747875):4.400968434):0.5598484396,((t340:2.415366193,(t341:0.440835286,t342:0.3921179525):1.954099016):2.359780346,t343:4.629636574):1.820081046):1.196178758,((((t344:2.16397047,t345:2.085211269):0.6215845983,((t346:0.3837432996,t347:0.3822106924):0.2619460903,t348:0.5759216512):2.030908828):2.65543584,((t349:3.516091352,(t350:3.294012745,(t351:3.188373429,t352:3.093669614):0.05695573801):0.1584488016):1.231625739,(t353:0.8836649864,t354:0.758860479):3.631364378):0.335780735):2.094211258,t355:6.702536083):0.09393408215):3.646002077,(t356:8.966056176,(t357:4.024461866,t358:4.017249178):4.906348977):1.253622965):1.626683829):4.737040657):31.31121965,((((((t360:7.745679039,(((((t361:2.082578177,(t362:1.799985898,t363:1.780893836):0.2705844421):1.370731962,((t364:0.6383026372,t365:0.4918033517):0.916294703,((t366:0.1305194616,t367:0.1232696066):0.1659020083,t368:0.1808616796):1.069065583):1.760071865):2.162699586,(t369:2.31568822,(t370:0.1970362312,t371:0.1481027373):2.042603458):2.468468375):0.0972955907,(t372:3.870170013,(t373:0.355932011,t374:0.1909589127):3.466152986):0.8659280673):1.136123529,(t375:0.8163150172,t376:0.7729535214):4.793889251):0.8477722696):0.09345621602,t377:6.343817247):1.043156454,(t378:1.908490708,t379:1.891063907):5.437146697):1.817863306,((t380:1.705641815,((t381:1.080100644,t382:0.9727219024):0.4005157717,t383:1.302201938):0.1452463682):4.297488738,(((((t384:0.4580840438,t385:0.4099689138):0.152172744,t386:0.5594349177):0.7787776104,t387:1.14428341):2.311170777,(((t388:0.6694964576,t389:0.6530459216):0.3405028689,t390:0.9340067954):0.04818560501,t391:0.765443407):2.395945013):0.9809655113,t392:4.035411686):1.018630924):2.925184739):1.434209904,t393:9.288896334):19.41517839,((t394:9.000751503,((((t395:0.4026505706,t396:0.3459033618):1.494395767,t397:1.718463923):2.869341599,(t398:1.341000253,t399:1.235162706):3.228928479):0.3437085696,((t400:1.503045472,t401:1.479858573):2.946808197,t402:4.364395714):0.3268343411):3.888531858):4.008143881,(((t403:0.8223576346,t404:0.7735857149):1.472426722,t406:1.814436914):0.9193294022,t407:2.680072999):9.348382325):15.46507859):16.16872922):22.18392617,((((t408:3.173489453,t409:3.114104319):2.340059307,((t410:4.26658395,t411:4.217814536):0.9583354849,(((t412:1.453276437,t413:1.438035007):0.8173094134,(t414:0.2112354334,t415:0.1685094704):1.992423911):1.910578376,t416:4.015129908):0.9890537713):0.2153411867):22.44068938,(((((((t417:0.4701431747,(t418:0.1698346161,t419:0.05266790836):0.201169752):1.750432779,(t420:0.5544174559,t421:0.4052404071):1.386580921):2.284442573,(t422:1.468529857,(t423:1.000726389,(t424:0.5715210236,t425:0.5587325267):0.2459381213):0.3658050166):2.246163065):0.9327092787,t426:4.057311157):0.5800215372,t427:4.511464307):0.3683386431,((t428:3.857989542,t429:3.81284183):0.1087273771,((t430:0.7341963835,t431:0.7276096349):2.884781446,t432:3.558415555):0.2565487472):0.868145751):5.234182067,((t433:1.836845348,t434:1.824342058):5.395718755,t435:7.216993874):2.618341166):15.9638364):1.994126368,((t436:2.132420361,t437:2.082417759):7.285524151,(t438:2.363852384,t439:2.311397588):6.991073035):18.31725499):35.8864461):5.23333589):73.50546863);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T21.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
