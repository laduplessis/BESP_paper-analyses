<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t490:2.708204878,t491:2.676259359):37.13000581,(((t492:9.904201331,(t493:4.225591234,t494:3.949028989):5.650319313):6.973124112,(((t443:0.02799249072,((t399:0.2143255419,(t362:0.1084842892,((t347:0.1241518141,((((((t260:0.03100753287,(t247:0.06950776485,(t233:0.07793480767,(((t209:0.01266349476,(t203:0.3138706063,((t120:0.0055520744,(t115:0.05269683753,(t114:0.1593973583,(t97:0.04045522673,((t28:0.1279022607,t1:3.098277378):6.721582796,((t2:5.364566568,(t3:4.717148533,t4:4.608119169):0.5554952526):4.278512085,t5:9.244586808):0.163689377):0.5199715376):1.272020231):0.1569479529):0.6529992298):1.301091154,(t6:8.302654588,(t7:5.955204293,t8:5.943252014):2.251793531):5.006206723):5.834985036):0.3929161342):0.7993213408,(((t9:5.720543304,t10:5.524098379):5.943253665,(t11:5.52233871,t12:5.471894353):5.600643705):4.865137699,(t13:5.136028337,((t14:0.8036340561,t15:0.6485551575):3.615566137,((t16:0.3820848538,t17:0.3200656342):3.227264963,(t18:0.5144701808,t19:0.4601883822):2.912000329):0.5412276633):0.6889101439):10.66502869):3.698871954):1.008719534,((((((t20:0.4132631908,t21:0.3127769291):2.467893379,(t22:0.2775376813,(t23:0.09338137102,t24:0.02195889796):0.08145858253):2.423843047):0.2846734096,(t25:2.053829612,t26:2.025643143):0.4474440637):3.115694295,t27:5.228129805):8.913900283,((t29:0.2149159814,t30:0.156392116):12.87318811,(((t31:0.4776485726,t32:0.3386334484):6.285315894,(t33:1.69882435,t34:1.627079009):4.909095832):2.644219559,((t35:2.899820597,t36:2.65307841):2.69801824,t37:5.334151988):3.33811767):3.395833895):0.7414370269):3.97800061,(((t38:8.29612982,((t39:6.210844282,((((t40:2.486702302,(t41:1.177980986,t42:1.15241787):1.193583643):0.9404935801,(t43:2.658880768,t44:2.596607143):0.5546462583):1.815626478,(t45:4.904889378,t46:4.771187146):0.04229210038):0.4473006294,((t47:0.7842989151,t48:0.6783615743):0.8150805806,t49:1.221137651):3.644405208):0.2550959036):1.392878045,(t50:0.5815937232,t51:0.5153882221):5.735084017):0.6178439002):1.383992959,(((t52:2.926236495,t53:2.849030575):4.0757879,(((t54:3.655935265,t55:3.540243914):1.86412941,t56:5.276928008):0.6828417293,(((t57:2.6430565,t58:2.628144336):1.324826808,((t59:0.2181126234,t60:0.2105961238):1.196067183,t61:1.40298878):2.366009828):0.8999218471,((t62:0.2128360432,t63:0.2079854205):1.745577682,((t64:0.5040276667,t65:0.4955323703):0.232650704,t66:0.5087832389):1.064214466):2.632947473):1.083224725):0.4612974023):0.1991179229,((t67:4.197642013,t68:4.053668098):0.4157834303,(t69:0.7345300818,t70:0.580111984):3.575072999):1.222412712):1.021357248):3.120186961,t71:9.277676443):3.842259792):0.7454159823):0.4411952228):1.163913554):1.19284385):0.6100333564,((((t72:4.72509542,((t73:1.364806824,(t74:0.741650293,(t75:0.2459359253,t76:0.1401982308):0.2038697105):0.5916014947):2.382011855,((t77:1.272449332,t78:1.074025088):0.4960907375,(t79:0.7752262755,t80:0.6513488232):0.749002292):1.541666505):0.9761408408):0.3183197763,((t81:2.661375101,(t82:1.442442705,t83:1.435326322):1.002283343):0.4699436808,t84:2.850990838):1.067750359):2.560859498,t85:6.428488477):3.645218355,((t86:2.62270898,((t87:0.05082854161,t88:0.0331608136):1.960779203,((t89:0.2549531678,t90:0.03433974038):0.9534208095,t91:0.9406447899):0.7213477268):0.5294407236):4.60150906,(t92:4.326639357,t93:4.154182273):2.434358886):2.848496484):5.909244501):0.239807293,(((((((t94:0.01114349531,t95:0.00572221305):5.588736582,(t96:3.202407032,t98:3.033564527):2.327782428):1.347633229,(((t99:2.379545896,t100:2.340324709):2.362292514,(t101:3.715826737,(t102:2.183554341,t103:2.141934882):1.348288313):0.9301115757):1.891260535,((t104:3.462097705,t105:3.197692616):0.8176797649,(t106:3.81512581,(t107:3.618934784,((t108:0.007761646958,t109:0.0007008066979):2.484764087,(t110:0.7239077323,t111:0.6802711989):1.745531738):1.121271813):0.1059246483):0.1636145652):2.010993655):0.01913772743):2.9934865,(((t112:2.83800654,t113:2.764655916):1.071420755,(t116:2.135983958,(t117:1.791893297,(t118:1.262169626,(t119:0.7986978105,t121:0.6043969899):0.400546315):0.3239879544):0.328231646):1.060314202):4.683690075,t122:7.394724767):0.1905403584):1.099138889,t123:8.655932689):1.172660639,((t124:0.9490629858,t125:0.9202559148):4.449685952,((((t126:0.3211235006,t127:0.3093124109):0.4093217591,t128:0.6092895245):0.6153708408,t129:1.041901367):1.830472543,t130:2.807514848):2.045101948):4.391816054):2.049019205,((t131:0.2758449943,t132:0.1223786025):6.801567728,(t133:1.03705136,t134:0.9917803397):5.816060325):4.123520016):1.005353551):0.7167021234,(((((t135:0.752190667,t136:0.7477695582):0.6626663702,(t137:0.9136530268,t138:0.8928169962):0.3783404988):1.351069677,t139:2.569392855):0.01760077244,(t140:2.277952082,t141:2.24166655):0.2506657615):7.672663134,(((t142:5.320027952,t143:5.259033437):2.970786848,(t144:3.038924325,t145:3.020864615):5.155063817):0.2674428413,((((t146:0.1694136503,t147:0.09763410489):1.565687137,t148:1.633877118):3.078167172,(t149:4.409703496,t150:4.314070552):0.1477844843):2.638920045,(t151:3.282756433,((t152:0.08782582361,(t153:0.06545448203,t154:0.01533985643):0.01065479369):1.566290047,t155:1.402376301):1.553001159):3.799000634):0.9452972011):1.591706846):2.025611416):1.177828972,(((t156:5.661235479,t157:5.596909843):3.109492515,((t158:2.590413994,t159:2.551978493):2.904266743,((t160:1.813033617,((t161:0.3660744155,t162:0.3368831203):0.7788957265,t163:1.075030574):0.5807608218):1.153049974,t164:2.808260695):2.448879771):3.043417147):1.920419858,(t165:2.829483519,(t166:2.476308678,(t167:2.426092017,(t168:1.675735656,(t169:0.1282058798,t170:0.001926068919):0.927189373):0.7438760383):0.04038069462):0.2620672738):7.31858643):1.726592895):2.082223506,((t171:0.632554165,(t172:0.1811934658,t173:0.1228109808):0.4179164012):1.876338864,(t174:2.095176361,t175:2.085832067):0.3153910418):10.581631):3.731188731):1.020698931,(((((t176:4.518389601,(t177:0.6056988375,t178:0.4627980381):3.859315279):4.547960646,((t179:4.888578751,t180:4.758778396):0.1021896344,(t181:4.321781076,((t182:0.7096082756,t183:0.5284954749):0.01921914924,t184:0.4706617213):3.502365017):0.409875366):3.823691327):2.980894055,((t185:1.762444831,(t186:0.7236346709,(t187:0.1993336508,t188:0.1563001934):0.3196616869):0.9425533371):7.326180595,t189:8.673815942):2.097770024):0.2021711428,((((((t190:1.58090048,t191:1.564581879):2.928507836,(t192:0.6501078043,t193:0.5874298328):3.762249737):1.217811563,((t194:3.55649789,((t195:1.384988096,t196:1.224276729):1.975664297,t197:2.921254654):0.1695589037):1.848133234,(t198:1.039183779,t199:1.037709062):3.688587055):0.08227311534):0.4028349759,(t200:2.804812577,t201:2.671509411):2.296485894):1.129865524,(t202:1.103668558,t204:0.7474603025):4.747688682):2.881817777,(t205:6.764754321,((t206:0.344261381,t207:0.3073420312):3.048721127,((t208:0.5583731343,t210:0.5073117965):0.4352302998,t211:0.8643042578):2.159078433):3.370401802):1.496515496):0.803201708):4.152260667,((t212:1.437179032,t213:1.2434278):5.760474475,(t214:1.11531791,t215:0.955719016):5.792864213):5.50261463):1.242443961):0.3698387948):4.366075004):3.017672867,((((((t216:2.205318815,t217:2.140696941):6.76851322,(t218:7.015555618,(t219:6.16168599,(t220:1.898732361,(t221:0.3130937106,t222:0.1741224079):1.455839138):4.170511284):0.7674412923):1.883119143):1.987902689,((((t223:1.337885945,t224:1.320867482):1.35371709,t225:2.62539268):0.5392457975,(t226:0.05649157561,t227:0.04722435859):3.057415674):5.526935656,(((t228:0.275420675,t229:0.08086360611):2.990894552,(t230:2.620486053,t231:2.603576877):0.4321729952):3.353835683,(t232:4.349407776,t234:4.181592363):1.775680486):1.928092153):1.602659464):3.62361176,((((t235:1.884820449,((t236:0.6313677574,t237:0.5713824098):0.3614777557,(t238:0.3474660619,t239:0.273745535):0.4875886114):0.8562778691):0.6424064337,t240:2.151916437):2.879577866,(t241:1.265740134,t242:1.243409664):3.603118159):7.338134657,(((t243:0.7124133466,(t244:0.1131995194,t245:0.02927840681):0.5889912716):3.829508982,(t246:1.579949888,t248:1.327859292):2.790176605):2.852654832,((t249:3.911924667,t250:3.743379913):0.8041696662,((t251:0.2888433974,t252:0.2788201685):3.993143724,(t253:0.8997518386,t254:0.8527844793):3.325678168):0.1527233048):1.941324232):4.740401148):0.26654067):1.025195929,((t255:1.018783675,t256:0.9383277999):5.158551414,(t257:1.91323837,(t258:0.7991476805,t259:0.6193164281):1.086968083):4.182367418):6.059252109):4.779997775,(((((t261:4.274409652,t262:4.245157877):4.576167041,(t263:4.438045536,(t264:3.94890714,(t265:0.7369155054,t266:0.2838728697):3.200480958):0.302162405):4.364841384):3.039846612,(((t267:1.073994103,((t268:0.3806572787,t269:0.3209977344):0.2958859143,t270:0.5373134554):0.2738902604):0.511834324,t271:1.275987183):8.886196969,(((t272:3.043327212,((((t273:0.7162348845,t274:0.6224552848):0.4238771885,t275:1.021756218):0.3866142495,t276:1.337111028):1.178285216,(t277:0.8296308899,t278:0.7759731845):1.537798827):0.1412926616):2.767412605,(t279:3.522016556,t280:3.508134783):1.628677029):3.791850321,(t281:7.141644831,(((t282:3.395989984,(t283:2.401327536,t284:2.326422981):0.9503368613):1.195317097,t285:4.467910578):0.7971690019,((t286:1.611190423,t287:1.54319852):2.188758004,t288:3.628855109):1.407953164):1.6296498):1.693251694):0.5077081658):0.5641630463):3.053725237,(((t289:2.06862165,t290:2.039056399):1.551580582,t291:3.324786905):8.35314067,(((t292:1.844784722,t293:1.636385136):8.764923938,((((t294:0.7192066844,t295:0.5544138189):0.06942941882,t296:0.4488166687):2.448540868,(t297:0.8862823929,t298:0.5517421264):1.71291493):0.003113022052,(t299:1.053803314,t300:0.9182369227):1.132914955):7.090802115):0.8704065172,((t301:6.131096979,(t302:2.117187753,t303:2.107184161):3.998562865):0.1055799242,(t304:1.689645357,(t305:0.8472199839,t306:0.6600103176):0.8419107771):4.472080625):3.576802492):0.004844396772):0.4950623074):0.2665060932,((t307:3.035922148,t308:2.963681086):3.852017295,((t309:0.0397441433,t310:0.01012235872):3.04236244,t311:3.044553392):3.596649159):3.400728222):1.311002029):0.733775569):0.9390204849):2.689204033,(((t312:5.013994632,(t313:4.443412896,(t314:0.6464961802,t315:0.6414412118):3.741101798):0.355594478):0.9086016758,(((t316:3.637322061,(t317:3.146338705,t318:3.068488248):0.4329806171):0.1142368376,(t319:2.86379547,(t320:0.9933116011,t321:0.7989401364):1.784699015):0.7151596334):1.305059283,t322:4.591519278):0.4391331654):5.064906101,((t323:7.083176009,(t324:3.18900396,t325:2.984050658):3.755363135):2.355745042,t326:8.911661523):0.6032122483):4.702161393):0.4523113803,(((((t327:0.9144579441,(t328:0.7807806053,t329:0.7507762363):0.02114544158):0.02327810481,(t330:0.6947977447,t331:0.6368918999):0.07736693025):2.729417088,(t332:1.907296276,(t333:0.9085582892,t334:0.8753990937):0.9576180638):1.517658305):7.341237448,(t335:1.346631623,t336:1.277509739):9.252527721):2.657056473,((((t337:4.241183302,(t338:3.697724119,t339:3.53895836):0.5387558285):0.4531636269,t340:4.493736156):0.8802043086,(t341:0.9354552336,t342:0.7013176012):4.231640575):3.084185256,t343:7.990655953):4.279784121):0.8713288562):18.57012778):6.664583052,((t344:6.903754567,t345:6.899769355):1.187297027,((((t346:1.592533738,((t348:0.4040429374,t349:0.4009551146):0.9625486198,t350:1.294454152):0.0007580864754):1.174254181,(t351:1.946814383,(t352:0.87598076,t353:0.8314021528):0.9819486329):0.5035572426):0.3932514155,t354:2.536185116):1.964192565,(t355:1.508548501,(t356:1.185362945,t357:0.9674904944):0.1703338405):2.765697281):2.939365322):30.2344693):16.06067406):128.9713374,((((((((((((t358:4.764421836,(t359:2.250906208,(t360:1.387652218,t361:1.245422926):0.7965961195):2.503286859):0.3487780927,t363:4.72569912):5.59290342,(t364:10.08401029,(t365:9.772733763,(t366:6.862346305,(t367:5.446353497,(t368:2.369268527,(t369:1.542087922,t370:1.466826233):0.7373065816):2.906043048):1.278349402):2.802755212):0.2954199993):0.1255120534):2.640077999,(t371:10.28575075,(t372:3.803776054,(((t373:1.002142696,t374:0.9271584283):1.616621403,t375:2.433098582):0.8354888426,(t376:0.3415086724,t377:0.2951237809):2.887406254):0.2825638423):6.239572283):1.903703479):1.454661184,(((t378:0.9020336176,t379:0.6587911065):2.830522194,(t380:1.07327136,(t381:0.6973898684,t382:0.6926098962):0.2150470583):1.912660673):1.641651219,t383:4.447539369):7.614673356):0.5169544416,(t384:3.653155753,t385:3.635625843):8.67530197):2.299612353,(t386:7.56104784,((t387:2.267199452,t388:2.176880367):4.137747073,(t389:1.091766003,t390:0.9874739064):5.190878801):0.9484188315):6.948948702):1.48629553,(((t391:3.294206868,t392:3.234500956):2.760565577,t393:5.951573251):2.37983897,(((t394:1.575167203,(t395:0.4728428213,(t396:0.1445417897,t397:0.09395120984):0.3037501746):1.030619595):1.698825316,(((t398:2.140719303,t400:1.617690498):0.5124747886,t401:2.118186517):0.07640376889,(t402:1.927980275,t403:1.829284686):0.1243606481):0.1669774132):4.182149231,((t404:5.246120626,((t405:0.335219079,t406:0.3071327385):0.4660528724,t407:0.7578955671):4.391192331):0.3585339394,((t408:0.8631389097,t409:0.8363639547):1.515800431,((t410:0.7231761419,t411:0.5750463616):0.2338192179,t412:0.7343139371):1.225081871):3.098248608):0.6060546556):0.8328838042):6.840205431):1.143020262,((t413:5.42099312,t414:5.42040924):5.378635291,((((((t415:2.547862433,t416:2.43569522):3.1844723,t417:5.374977579):1.907498345,(t418:5.868538356,((((t419:2.18900111,((t420:1.09662555,(t421:0.1383146497,t422:0.1322378747):0.8205961965):0.211538744,t423:1.12944684):0.8319889827):0.980240496,(t424:0.88902024,t425:0.7858854976):1.500560243):0.8507766598,(t426:0.07061490369,t427:0.03099689771):3.009127841):1.200155338,(t428:0.8587544402,t429:0.8303639824):3.37817879):0.5152231467):1.322608471):0.2295079904,t430:6.191843614):1.345013854,t431:7.503919776):0.5623609741,(((t432:0.1859776564,t433:0.1705304841):3.955372215,((t434:1.02956586,t435:0.9049184333):1.412721701,t436:2.3085642):1.407762279):0.6557266924,((t437:1.229458708,t438:1.170524667):1.40277271,t439:2.567972546):1.463723765):3.196704523):0.9999437563):3.539101787):0.1080194892,t440:11.82474064):26.7178067,(((t441:4.159837,t442:4.143370172):13.30825863,((((t444:0.4139072392,t445:0.3238258436):3.417428943,t446:3.591811305):0.535014769,t447:4.112373739):6.472190912,(t448:3.597771932,t449:3.547927389):6.969185456):6.328912087):1.849901866,((((t450:1.292079785,t451:1.270764592):0.2552694514,(t452:1.147021314,(t453:0.8504463275,t454:0.5648906733):0.08262090072):0.2752330671):2.285489713,(t455:0.6154744136,t456:0.5875971475):2.522491896):6.99890261,(t457:2.771512173,(t458:1.220293158,(t459:0.9548051494,(t460:0.2912419934,t461:0.1799063825):0.635103105):0.2309238033):1.50099344):7.306930718):7.646666159):19.14212327):51.00105969,(((((((t462:3.449197301,(t463:0.9893734901,t464:0.5621690474):2.404812259):5.491958116,t465:8.253900781):1.959551042,((((t466:0.2861942239,t467:0.1638244604):0.885776993,t468:0.9620748294):6.284672979,(t469:1.40532766,(t470:1.163336565,t471:0.8192352438):0.1306231936):5.78480382):0.7660810702,(t472:2.0714446,t473:2.039927298):5.411702159):1.930184617):0.7577216117,(t474:2.777360865,t475:2.654063967):7.31913655):1.579513819,(t476:1.528911245,t477:1.497924119):9.945164413):7.277338904,(t478:1.865471756,t479:1.805204918):16.5736042):12.82257244,((((t480:1.468302785,(t481:0.1399533107,t482:0.02613781124):1.308803648):2.211061139,t483:3.47094128):6.555922066,((t484:0.304517169,t485:0.2945973473):3.111883588,(t486:0.1949400526,t487:0.1121196855):3.138880614):6.606614622):18.60432739,(t488:1.241806771,t489:1.24091679):27.12326699):2.334696808):54.17650445):84.01097801);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T76.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
