<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((((((t333:1.12966953,t336:0.6639612527):3.862390875,(((t337:0.866670293,t338:0.7931174722):0.1527783322,t339:0.1815095175):0.9452328731,t340:1.116193506):2.556361035):1.099582072,((t341:0.5501365425,t342:0.5148477942):0.370719761,t343:0.8167869784):3.578290104):3.864737819,(t344:7.154074427,t345:7.147953837):1.072691367):3.924690402,((t346:5.839487627,t347:5.411296914):5.59185472,(((t348:6.544419004,(t349:5.529675219,((((t350:2.466930383,t351:2.436592938):1.069296116,(t352:2.888028548,t353:2.619006525):0.5374468122):0.2854206927,t354:2.837735845):0.9615600131,(t355:1.018140672,t356:0.9344486241):2.660244355):0.7038822295):0.8524592563):2.629123526,((t357:5.371117365,(t359:1.651670341,(t360:1.082542587,t361:0.8477730874):0.5403418819):3.58492372):1.209159636,t362:6.108324004):1.116131436):0.4566791278,(t363:6.294692796,(t364:5.63731689,((t365:1.26690138,t366:1.236362338):0.4762946531,t367:1.65672966):3.744023385):0.492431174):1.299943032):1.343988507):0.6626027912):3.810030764,(t368:8.283429125,(((t369:3.381525581,t370:3.31370485):0.2423838393,(t371:2.202875248,(t372:1.480013315,t373:1.326742312):0.6552955358):1.274144059):1.314416804,((t374:1.88512201,((t375:0.6130439361,t376:0.3660160626):0.9026945565,t377:1.095799273):0.3635348988):1.327502655,(t379:0.7014949623,t380:0.6373445507):1.935997362):1.297295952):3.340066614):4.658428999):5.739016833,(t381:2.74423995,t382:2.630066118):14.85873926):13.1754302,(((t383:7.044283406,((t384:0.909031084,t385:0.8315392372):4.951081991,((t386:0.9271076703,t387:0.8658833279):2.540568563,t388:3.240180936):2.277326931):1.029825319):2.247822004,((t389:1.425464263,t390:1.368258525):5.785435537,t391:7.017723896):1.548519736):5.881147783,(((t392:6.282463429,t393:6.274048048):2.185964801,(t394:0.2267879736,t395:0.1457758452):8.085764428):0.8509033679,((t396:3.653892249,t397:3.5212792):5.087163503,((((t398:0.1873067293,t399:0.1494668501):2.276264997,t400:2.280302574):1.498198861,(((t401:1.225032652,t402:0.9768188719):1.378508508,t403:2.125427063):0.7302291117,(t404:0.05302111707,t405:0.03751764862):2.69668933):0.3151226576):4.159558682,(t406:6.998703183,((((t407:3.342985287,t408:3.246580997):0.9334654306,(((t409:0.3838144353,t410:0.3047023647):1.648669647,t411:1.821653666):1.340180099,t412:2.979854042):0.512536527):0.1152229425,(t413:2.091334185,t414:2.050678489):1.396079727):0.08274223257,t415:3.411372529):2.393794436):0.1922758814):0.2777624484):0.1498432369):5.088243928):15.40508773):14.07744745,(((t416:5.023881114,t417:4.90241167):3.978511848,(((t418:0.5329245435,t419:0.5278667732):1.87487194,t421:2.263891582):1.285857226,t422:3.538250596):5.184775428):18.36239174,((((t423:0.4419251021,t424:0.4311098398):2.473098702,t425:2.876303669):10.66706986,(((t426:0.4102693473,t427:0.4028966299):0.5582380117,t428:0.8437086169):6.305279092,((t429:1.269913143,t430:0.9612518109):0.1956335671,t431:1.106427292):5.667781944):6.260197061):6.279441667,t432:19.22808638):7.214676522):13.45487338):7.677058101,(t433:28.55726222,t434:28.36167077):18.97159061):4.995147088,(((t435:5.855421121,(((t436:0.3765127955,t437:0.2586391217):0.02156562945,t438:0.2421384785):2.959535911,((t439:2.050484057,((t440:0.8322609697,t441:0.7934215624):0.5943194248,t442:1.277643875):0.3757055693):0.8015705984,t443:1.978415905):0.2854250036):2.451636122):0.5107344084,(t444:1.743484816,t445:1.701182899):3.271052898):0.3078611173,t446:5.209249001):45.52655523):83.18300259,(((t447:8.718839487,((t448:3.179134826,t449:3.139472547):2.069845693,(t450:2.660129367,t451:2.505637447):2.257103571):3.321886317):1.279725977,((t452:1.028522395,t453:0.9133941999):7.373208557,((t454:0.4530272883,t455:0.391302925):2.223798945,t456:2.614280265):5.533692431):0.6198027002):23.28290722,(t457:1.156768123,(t458:0.001384293061,(((t420:0.001726430402,((t378:0.03328595946,(t358:0.05385424943,(((t335:0.01176983699,(t334:0.06048393196,(t326:0.2321448814,((((t228:0.07424190607,(t226:0.02215676214,((((t97:0.1427377976,((t45:0.1140913638,t1:5.213371035):1.745396158,((t2:5.395665041,t3:5.30765926):1.130212553,t4:6.173279078):0.4040599763):3.845179625):2.571006169,((t5:2.800804576,t6:2.651576763):6.083344178,(t7:5.071613668,(t8:2.701000588,(t9:2.543922141,(t10:1.068838924,t11:0.9680185589):1.188734281):0.03173966989):2.249200911):3.601122633):3.966815506):2.634515973,(((((t12:2.953946214,(t13:2.482323618,t14:2.459443199):0.4053296508):2.419770614,(t15:0.3260145873,t16:0.1789377659):4.774624738):0.7630446352,t17:5.677359852):1.073700681,t18:6.692373628):4.375076345,((t19:1.4250689,t20:1.340780628):1.845108615,t21:2.971273372):7.763260368):3.038679083):1.295596057,(((t22:2.191126468,t23:1.752946668):5.759403531,t24:7.503316171):3.490880333,((t25:1.781486407,t26:1.343654101):6.422101206,((((t27:2.574913597,t28:2.347718717):0.1123691716,t29:2.281819464):1.458079847,t30:3.734867077):3.128111318,((t31:4.527755474,t32:4.394592614):1.116482467,(t33:0.4844891446,t34:0.4491178494):4.935450816):1.17819693):0.4756602432):2.616932319):3.58383525):6.260893963):0.2915411596):0.3166520962,((((((t35:8.336042776,t36:8.273189011):2.567919168,t37:10.46813396):1.435298493,((((t38:3.585118912,(t39:2.420708095,t40:2.375368296):1.109982576):4.421369321,(t41:5.553507837,(t42:3.415987863,t43:3.40669655):2.118086875):2.227632035):1.414887787,(((((t44:1.476762954,t46:1.304748617):1.778204034,t47:3.028236619):3.237651445,(t48:1.429769697,t49:1.277495404):4.613814934):0.5418583015,(t50:1.243427623,(t51:1.082424134,t52:1.067267899):0.0702520329):5.165047574):1.223948453,t53:7.454197918):0.6755416383):0.4606481881,(((t54:0.7279510553,t55:0.6897519063):3.547947505,(t56:3.348473773,t57:3.292330605):0.7870346934):4.172523264,((t58:2.862199557,(t59:1.906250225,(t60:0.8712948225,t61:0.849130928):1.031367534):0.922198257):2.715233727,((t62:3.834717273,t63:3.772468057):1.152216795,t64:4.466267381):0.288470414):2.660006775):0.08271655988):2.007609312):2.44222388,(((((t65:0.9318878997,(t66:0.736699999,t67:0.3764282015):0.1038856599):6.79536045,(((t68:0.5260685984,t69:0.4220329946):2.660448374,t70:3.039478388):0.982419707,t71:3.954250528):2.984489165):0.6421318391,(t72:7.156838687,((t73:3.91102363,(t74:0.6201586956,t75:0.5369582483):3.27388882):1.124596324,t76:4.846643642):1.636788442):0.2285061809):0.1656313393,((t77:1.612277684,t78:1.599108777):0.377613194,(t79:0.9792871491,t80:0.9319846874):0.8692575177):4.857245703):2.781959633,((t81:4.480220392,(((t82:0.4736082514,t83:0.4231432828):0.8623194379,t84:1.258187119):1.64138279,t85:2.805430324):1.450414456):4.083006155,(t86:3.949105158,t87:3.771932874):4.371507751):0.8312627864):0.6206259587):0.9880162437,(t88:4.219557933,t89:3.972839318):6.204897679):3.291806025,((((t90:4.184551318,t91:3.787963285):1.482325255,t92:5.187030406):0.7620164347,(t93:4.670943212,((t94:0.6073017003,t95:0.5025265673):0.6036243802,t96:1.022299989):3.426725487):1.185004593):4.61017702,((((t98:1.186876723,(t99:0.3587338512,t100:0.3482108873):0.6432894622):2.26909653,t101:2.746901436):5.037610029,t102:7.638840337):1.20078672,(t103:8.33788757,t104:8.28592061):0.4598907993):0.2364324063):2.315589555):1.003149881):0.1904419311,((((t105:3.874106868,t106:3.805747915):3.80136959,(t107:4.361293962,(t108:2.35288414,(((t109:0.4396635256,(t110:0.3909343442,t111:0.3457775803):0.01068927544):0.2789041606,t112:0.5156991594):0.8757081565,t113:1.311957665):0.6047213281):1.868091357):3.221213782):1.675129374,((((t114:0.4928645882,t115:0.4823030726):0.3305103941,t116:0.8128039159):3.364896419,(t117:1.668729695,t118:1.658727091):2.485026811):1.623892107,((t119:0.9039181268,t120:0.8259466492):3.185792979,t121:3.872945476):1.541430879):2.690183641):0.2817419859,(((t122:1.896792863,t123:1.824915369):2.474807117,t124:4.268040061):2.379919564,((t125:3.919111845,((t126:1.284568836,t127:1.115780047):0.5495479866,t128:1.616608698):1.949017331):0.3206437281,(t129:2.069816134,t130:2.041371999):1.735144286):2.262681204):1.415209483):2.741049091):4.492001855,(t131:6.429333519,(t132:6.241563515,t133:6.173336777):0.1357985443):7.969928926):4.293359414):0.7903929097):0.1069843539):0.7635996347,(((((((t134:1.763680297,t135:1.726894481):1.72223298,t136:3.345704957):1.836799103,(((t137:1.902657937,(t138:0.8599827437,t139:0.5604358058):0.9728358669):2.020234731,t140:3.332487347):0.4405878924,t141:3.448579193):0.4056221264):1.31512372,(((t142:1.492024065,(t143:1.160468884,t144:1.13050196):0.3274838205):2.021179966,(t145:2.876466195,(t146:1.100060137,t147:1.060547902):1.570288251):0.5775058605):1.129397469,t148:4.242049298):0.2127709691):1.773638705,t149:6.173487942):0.0825888624,t150:6.031884938):11.59790949,(((((t151:1.153012186,(t152:0.8876169305,t153:0.6969130919):0.1248683454):5.61299571,t154:6.400962225):3.453336027,(((((t155:0.8245042831,t156:0.7852443432):1.373775568,t157:2.116935172):1.446945758,(t158:2.896351871,t159:2.832668442):0.5094715112):2.566773729,((t160:1.303251478,t161:1.131072103):1.950020246,t162:3.055572669):2.518105681):3.238000235,(((t163:2.86496135,(t164:2.17723905,t165:2.092879153):0.6033116861):1.92820263,((t166:2.016827476,t167:1.813280007):1.87884502,(t168:2.965703077,(t169:1.725325639,t170:1.53652888):1.201089851):0.6283122935):0.7232112007):0.03209188369,(((t171:2.134010882,(t172:1.793705384,t173:1.730392935):0.3013133613):0.09256690815,t174:2.087901855):0.0667246502,(t175:0.7260336176,t176:0.5793186118):1.418049418):1.819639969):3.950985352):0.3120685535):0.4510393059,(((t177:6.460092719,(t178:5.293576863,t179:5.241363916):0.9703627476):0.2653552477,t180:6.212392375):0.5014101084,(((t181:0.8009352207,t182:0.7826164623):1.876595405,t183:2.6067914):2.633670948,((t184:2.334607863,((t185:0.3193836759,t186:0.2788275594):1.744623213,(t187:0.4541446974,t188:0.4463193107):1.532077534):0.09569423129):0.02130444274,t189:1.939315425):2.849579006):1.301487858):1.243562133):2.717852696,(((t190:3.892974133,t191:3.877242598):1.690068685,t192:5.539052333):2.101681358,(((((t193:0.8489501481,(t194:0.3982181401,(t195:0.05928608541,t196:0.01667941779):0.2387676757):0.3728583678):0.3129302144,t197:0.9308614608):0.4882819726,t198:1.41866187):4.326873185,(t199:1.338804357,t200:1.149549314):4.28262864):1.071664406,t201:6.482095849):0.5348435419):2.339419733):4.238291283):0.02021619845):0.3907969545,((t202:2.535531397,t203:2.507973826):8.493561466,((t204:0.1155528808,t205:0.07478962929):2.944592792,t206:2.866436594):7.92579916):2.958453856):2.262503379):1.927491478):3.215817905,((((((t207:14.00975581,((((((((t208:1.664346191,t209:1.481918068):0.6018273267,t210:2.056336511):0.5420807545,t211:2.555441431):0.9514603331,(t212:1.990786507,t213:1.871571042):1.412606337):0.6665495414,t214:3.868130456):2.699923174,((((t215:2.19746537,t216:2.081931134):2.60859671,t217:4.637745374):0.09382153007,((t218:0.06632140952,t219:0.02693451357):3.697927716,t220:3.676032646):0.8675529345):0.335774221,t221:4.831686771):1.28965807):2.121312414,(t222:7.510631046,t223:7.459977846):0.4775791482):4.181833008,((t224:2.109483947,t225:2.045520651):1.279118797,t227:2.894702115):8.719195282):0.5362214729):4.060376401,(((t229:5.869890002,(t230:4.593441578,((t231:0.04625853861,t232:0.01638729183):0.5416175242,t233:0.5460976911):4.005183091):1.245807823):1.636114489,((t234:1.724716473,t235:1.701291378):3.982850149,(t236:0.7193375064,t237:0.5903665262):4.70476574):1.716167481):5.652404427,t238:12.61651534):2.760294308):0.1491563243,(((t239:4.87912785,(t240:0.4262882136,t241:0.3929915642):4.394532403):1.170448995,((((t242:1.754867828,t243:1.747878777):0.03140000367,(t244:1.490231377,t245:1.476504326):0.1732344361):0.3984575684,t246:1.975102164):1.774077577,(t247:1.102023586,t248:0.9062957468):2.466116718):1.930187712):5.734926333,(((((t249:0.8462080458,t250:0.7859965303):3.726457496,t251:4.279145722):0.7059305416,((t252:3.649617592,(t253:1.29101587,t254:1.069814345):2.197297587):0.5384380983,(t255:2.631500659,t256:2.509126325):1.171142415):0.7817760843):0.1160891981,t257:4.540937047):1.512314659,(((t258:1.950965552,t259:1.873219459):2.343828692,(t260:2.270111131,t261:2.221608551):1.741395942):0.5083233304,t262:4.407541081):1.173639409):4.0600019):3.624413972):0.02641485314,((t263:8.628391191,((t264:4.456760874,((t265:1.977563402,t266:1.942312434):1.606207361,t267:3.450618014):0.5888160202):2.954451808,(t268:1.069120385,t269:0.8478201623):5.68563991):1.127483187):4.143751572,(t270:3.69505229,(t271:3.064600195,t272:3.036013383):0.3680237774):7.941770201):0.4941985658):1.480408723,((((((t273:0.0434477151,t274:0.00583709158):5.117386066,(t275:3.516157604,((t276:1.787328789,(t277:1.417772007,t278:1.396475727):0.3601456926):0.4937525574,t279:2.106307404):1.231311236):1.410821354):1.345390157,(t280:5.568776722,((((t281:1.173945578,t282:1.168214848):0.7718487089,t283:1.932917025):0.4002436038,((t284:0.5614966477,(t285:0.3982917605,t286:0.1366769796):0.1367678481):1.348792683,t287:1.577381177):0.4216953121):2.684065299,t288:4.5510605):0.5177716542):0.3897585095):0.1035015339,t289:5.533988854):0.8129530285,((t290:0.9433823244,t291:0.9108694463):5.244439405,t292:6.049610275):0.08995667694):5.043686564,((t293:1.749630103,t294:1.26078383):8.417246332,t295:9.533619095):0.885413196):0.7780080414):1.042104171,(t296:4.451160468,(((t297:0.9673210218,t298:0.8047309428):1.656762255,t299:2.260721582):1.06615783,(t300:1.865767242,t301:1.854396402):1.379275122):0.725889601):7.66474144):0.1155330356):1.064962809):0.4798189811,((t302:3.11327891,((t303:1.928749966,t304:1.918211511):0.8087293448,t305:2.66414616):0.3102189321):2.76773633,((t306:3.927542045,((t307:0.962051749,t308:0.809406128):1.357941105,t309:2.145213084):1.362985853):0.4631325603,t310:3.882131319):1.207711906):7.093236564):0.9975475438,((((t311:0.1437473844,t312:0.09450564506):1.371340464,((t313:0.7324243668,t314:0.7224931648):0.5352509672,(t315:0.2735252328,t316:0.1748435277):0.9555614894):0.1771492133):7.439835959,((t317:3.655443387,((t318:2.666452491,(t319:2.316863662,t320:2.292332887):0.1266149408):0.9048731823,(t321:2.093314742,t322:2.056448895):1.196894442):0.04815635344):3.169422777,((t323:3.674174382,t324:3.623192138):1.768804066,t325:5.306811147):1.005149721):1.848277863):1.426977846,(((t327:2.562433973,t328:2.485674932):2.091892861,t329:4.545777097):0.01839878519,(t330:3.326135427,(t331:1.323822245,t332:1.277144875):1.980246165):0.9664647033):4.483763368):2.790472415):2.798879381):1.123856035):30.74446051):100.3936864);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T67.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
