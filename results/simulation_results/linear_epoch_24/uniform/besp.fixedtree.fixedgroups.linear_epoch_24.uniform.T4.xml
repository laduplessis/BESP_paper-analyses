<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t441:4.037869667,(t442:3.129665224,t443:2.985933359):0.8220707276):12.63196732,(t444:9.494188618,((((t445:1.524078266,t446:1.520434669):2.090727487,t447:3.532034462):1.402916325,((t448:0.2314499189,t449:0.05421029827):2.079562569,t450:2.130447595):2.507374742):2.233748578,(t451:0.8659190237,t452:0.8595554097):5.963727484):2.237085176):6.876576654):36.15819995,(((((t453:6.068891987,(t454:3.071036776,t455:2.733824499):2.610086884):13.51196452,((t456:2.147410523,((t457:0.1288437855,t458:0.1133775271):0.5916281018,t459:0.6547918691):1.373451451):1.312001561,(t460:1.863805488,t461:1.839387495):1.347944311):15.30359899):4.396495503,(t462:4.941807656,(t463:4.783141662,(t464:2.132973015,t465:2.115835381):2.617587024):0.07922911723):17.77878727):8.169123406,t466:30.66604337):10.61339917,((((t468:0.4783065197,t469:0.4215539632):5.886044366,(t470:3.635309052,t472:3.306566811):2.620124641):13.2336268,(t473:9.237546165,(t474:6.501635427,t475:6.495720505):2.678532217):9.898670211):13.65396079,t476:32.71333596):7.909666273):9.087219967):6.820303623,((t477:1.442299148,t478:1.439895316):14.90577677,((t479:8.28439802,(t480:1.077991675,(t471:0.00513419347,(t467:0.04977592885,(t431:0.05354852982,(t421:0.05482200293,((t357:0.02801194528,((t259:0.09848357816,((t256:0.233080579,t257:0.2129636547):0.1962193228,((((t157:0.07833389115,(t116:0.1582048275,((t1:4.177410663,(t2:2.014219417,t3:1.990190121):1.86883076):1.498238494,(t4:5.0429954,t5:5.010555148):0.1957369514):6.419085581):3.575738703):3.865875289,(((t6:7.337675382,t7:7.265876403):2.052098899,(t8:3.617263467,t9:3.566406333):5.653591711):2.394657659,t10:11.57244296):7.114834238):0.6485540292,(((t11:7.350975533,((t12:2.196946828,t13:2.176694891):4.783523503,t14:6.517679889):0.3665343163):4.209130295,(t15:9.67305707,((t16:1.857623401,t17:1.638907834):6.849922053,((t18:2.554669173,(t19:2.437272694,t20:2.344721324):0.07704455419):1.219582629,(t21:0.7178915664,t22:0.6690193727):2.863756673):3.925425016):0.7265577081):1.363669835):6.663686983,(((((t23:1.079132423,t24:1.021681898):8.208037822,((t25:4.357058886,t26:3.983926529):3.875898822,(((t27:4.899871274,t28:4.817415457):1.238483028,t29:5.741161978):0.5058772768,t30:6.126313973):1.17133373):0.9854637091):0.4013236482,(t31:2.689005658,t32:2.548562746):5.864034649):3.799680808,(((((t33:2.807904037,t34:2.513388485):0.5812262059,(t35:0.5722164165,t36:0.5236464169):2.454576582):2.029158286,t37:4.987217333):0.1201324329,t38:5.09596642):3.166268255,((t39:4.921136346,(t40:0.952757508,t41:0.8772075586):3.941356661):3.053969919,((t42:3.457718667,t43:3.410792917):2.41686206,t44:5.791996665):1.838244428):0.2568901778):3.318059884):0.1975246269,t45:11.31739133):2.506098348):0.9437857328):0.5317638903,(t46:3.334987342,(t47:2.934255736,t48:2.856427428):0.3279769208):11.81498375):5.243427603):0.2685849022):5.754646987,((((((t49:2.35892675,t50:2.190911744):6.511029713,((t51:1.367452642,(t52:0.4514050389,t53:0.2961758452):0.766543533):2.370739172,((t54:0.2523861099,t55:0.2478013523):0.2486909848,t56:0.4486165882):2.928425974):4.857076875):4.904306275,((t57:6.541732132,((t58:2.835813626,t59:2.682928089):3.381573118,((t60:3.72139302,(t61:2.085431595,t62:1.923808467):1.386187511):0.6585603533,(t63:3.806774267,((t64:2.876412222,t65:2.865774317):0.7941384279,t66:3.208748041):0.04836817272):0.1517735547):1.602437791):0.3003184142):4.4279765,((t67:0.03931966029,t68:0.03244194553):2.646646058,(t69:1.593436819,(t70:0.7065640339,t71:0.4541402916):0.7123793856):0.9375396183):6.899915033):2.074770742):0.5869761982,(((t72:3.627899018,t73:3.617119298):3.520721567,(t74:3.895141003,(t75:1.085553143,(t76:0.6525343674,(t77:0.3910963869,t78:0.3720595606):0.191138296):0.3818780623):2.784848222):2.983365317):0.332955552,(((t79:0.6197553059,t80:0.5995524536):2.143431325,((t81:0.6217981624,t82:0.5934226401):0.1008803971,t83:0.6771733176):1.998080287):0.9905494869,(t84:0.05482831629,t85:0.01610536486):3.5212573):3.117383305):3.920918655):6.664856654,((((t86:0.9208946907,t87:0.6212595942):7.703148856,((t88:5.665397888,((t89:0.6712712512,t90:0.6559782281):1.326941,t91:1.935152033):3.589478935):0.8123786946,((t92:3.328708437,((t93:2.468553687,t94:2.447899919):0.2287507365,t95:2.649051629):0.4552801077):0.8824861163,t96:3.973081624):2.114858406):1.694032876):2.095730735,((((((t97:0.09086623144,t98:0.006019591904):4.62228238,(t99:3.995339363,((((t100:2.110177502,(t101:0.8388540456,((t102:0.336697734,t103:0.2628005311):0.179030037,t104:0.3194610211):0.2206094558):1.238601273):0.4087593604,t105:2.169650654):0.1403497714,(t106:1.594203439,t107:1.512187185):0.589130082):0.5270365277,t108:2.476308294):0.7324511024):0.6264366403):0.1586644875,(t109:0.2051398595,t110:0.07787761081):3.743539804):3.733264467,(t111:5.849726048,(t112:2.683937947,t113:2.503558521):3.035955825):1.677729728):0.02068346667,((t114:3.192814857,((t115:0.5927620412,t117:0.3256208681):0.163868464,t118:0.4649887465):2.383022097):3.21071496,(t119:3.74770506,t120:3.591263437):2.279735233):0.8143617365):1.167068342,(t121:1.417358323,t122:1.330798499):6.346057651):0.05364136622):5.213672804,t123:12.89710352):1.262403636):3.342797859,(((((t124:1.200962405,t125:1.135501594):1.464937719,t126:2.591384248):8.574477081,(t127:3.240210234,(t128:1.643010115,t129:1.63136209):1.568291913):7.866844185):1.977650518,((((t130:1.925314179,t131:1.883961389):3.067420417,((t132:1.610463007,(t133:0.4295477924,t134:0.419439763):1.097865496):3.155182565,t135:4.536822007):0.1630914875):3.472560048,((t136:4.329277562,t137:4.082030665):3.225085745,((t138:4.366238176,(t139:1.638136069,t140:1.594893812):2.713089512):1.813791717,((((((t141:1.027389469,t142:0.9295569616):0.616183911,t143:0.9572152407):0.02379352645,t144:0.9667190532):2.811017137,(t145:2.356611588,(t146:0.1573869036,t147:0.110936732):2.115671959):1.297435208):0.8291777027,((t148:1.710229429,t149:1.640107625):0.4639483673,t150:2.075237258):1.991178454):0.167078501,(t151:0.1310542731,t152:0.09685668654):4.056600822):0.5458044901):1.123251141):0.5596434713):3.205163218,(t153:5.959325408,((t154:0.1766962772,t155:0.0258155404):3.993467421,(t156:1.431181625,(t158:0.5414682022,(t159:0.4771363687,t160:0.3663289178):0.01185350984):0.7016004928):2.353291363):1.644672874):3.571950627):1.367906708):3.728352476,(((t161:5.046941018,((t162:2.013026384,t163:1.555885531):1.65930015,(t164:2.291021564,t165:2.284106103):0.6389003617):1.161974526):0.08358712678,t166:4.11951774):3.361437229,((t167:2.775825892,((t168:1.139119761,t169:1.077411469):0.166372186,t170:1.187057834):1.232727631):3.736006849,t171:6.109843431):0.9289271894):5.121960112):0.5156934346):1.886179339):3.137348626):3.872205367,((((((t172:1.70620454,(t173:0.5799065641,t174:0.4238252881):1.074245711):1.237350155,(t175:0.8550910235,t176:0.8243377458):1.851762396):9.795077583,(((t177:5.773879855,(t178:5.129237744,((t179:1.591339143,t180:1.341802033):3.25423044,(t181:1.439517288,t182:1.394086118):2.933136351):0.2788127145):0.6261998418):0.1543965872,t183:5.216299909):0.17023198,(t184:1.839307032,t185:1.819516352):3.431938976):6.269437568):3.017994007,((((t186:1.332419953,t187:1.291846119):0.8762277973,(t188:1.694744571,t189:1.673117585):0.2408904061):3.692836232,(t190:5.498352762,t191:5.400668478):0.1016753486):5.518787072,(t192:5.091282149,t193:5.080384133):5.893100226):2.816377824):2.76283232,t194:16.48341703):2.446534452,((t195:6.521797326,t196:6.469045463):2.074666854,(t197:0.4551410745,t198:0.2626536652):8.028996129):10.31510292):0.387423188):3.170555602):0.6324250555):3.771866141):0.1962259087):1.958887388):7.049380183):6.903397609,((((((t199:4.464837915,((t200:0.3456714707,t201:0.3131711767):0.142832378,t202:0.3499191949):3.820269616):1.808749659,(((t203:2.314961158,t204:2.311216392):0.1231315468,((t205:0.1850297041,t206:0.1253225025):1.306703152,t207:1.407694285):0.8470916247):1.489604612,(t208:0.5714952852,t209:0.4447882831):3.15727792):1.981596083):3.554644352,(((t210:2.297236915,(t211:1.54660393,t212:1.438975406):0.6756710038):4.135108052,t213:6.136574292):0.9684329059,(t214:6.135711103,((t215:3.859767009,t216:3.740492841):0.1175881761,t217:3.849537889):1.935603189):0.9077332588):1.674633993):4.816513399,((t218:12.39072498,((t219:4.754190374,t220:4.402577582):2.636323083,((t221:1.759456917,t222:1.716718535):1.10944836,((t223:1.946029507,t224:1.856695541):0.724161699,t225:2.567561476):0.1161312626):4.122076158):4.556187945):0.3693904749,((((t226:2.37745549,t227:2.342029951):0.1049623046,((t228:0.1003585627,t229:0.09685444145):1.2541567,t230:1.343182969):1.080453968):6.892359624,((t231:2.324428561,(t232:0.3490870418,t233:0.2741396306):1.939065265):6.73404764,t234:8.866248438):0.003625212101):1.407994757,(t235:6.015422384,(((t236:3.824419764,t237:3.788598664):0.60357053,t238:4.349920814):0.9866723949,((t239:2.391842374,(t240:1.306043225,t241:1.302640551):0.9577274063):0.1769224661,t242:2.176401542):2.766186238):0.5673308614):4.230639691):0.6279881418):0.3934383129):4.754438306,((((t243:5.643447979,(t244:1.549332911,t245:1.491391917):3.946104858):1.751633608,((t246:2.14632826,t247:2.07797635):0.4582234946,t248:2.506871593):4.57755613):1.872653361,((t249:2.234682308,t250:2.129740758):3.461898587,(t251:4.865214938,(t252:0.1842493609,t253:0.1206979107):4.519977642):0.6631744189):3.225244793):5.097974983,(t254:1.800229258,t255:1.364365447):11.76297546):1.068472977):12.54494218,((((((((t258:2.107491563,(t260:1.42402283,t261:1.416122756):0.3469620042):5.733330976,(t262:1.812155121,t263:1.803360177):5.54143999):3.529452452,(((t264:1.269687208,t265:1.242457332):2.246559798,((t266:1.416090372,(t267:0.2776422418,t268:0.08127633266):1.029798307):1.077597153,t269:2.00860714):0.9254921345):7.270502359,(((((t270:0.9708327368,t271:0.7880851297):2.069998593,((t272:1.722324527,t273:1.440552341):0.009772829263,t274:1.371103452):1.099745096):0.2628810743,t275:2.582677601):2.747959465,(t276:1.13653881,t277:1.095416649):4.165133061):2.900548505,(t278:4.392910523,t279:4.388345789):3.725941151):1.115938135):0.02345105139):5.829536629,((((t280:0.3987156337,t281:0.3452616412):5.745739312,(t282:2.478780539,t283:2.42701425):3.544498885):3.077169332,(t284:6.091652105,(t285:5.006236076,t286:4.87319244):1.082516612):2.933752015):2.162547221,(((((t287:0.6543295214,t288:0.6207913233):0.4971745878,t289:0.9273260114):1.845591027,(t290:0.5357127377,t291:0.5151952841):2.159874927):2.093477902,(t292:2.391429969,(t293:2.252830488,t294:2.221870117):0.1245165956):1.956776063):3.975186878,((t295:3.956262711,(((t296:0.3564177056,(t297:0.2496997749,t298:0.1200109196):0.04036397033):0.02937598169,t299:0.1782426769):2.896619435,t300:2.77867688):0.6642291412):4.24933918,(((t301:0.03717088736,t302:0.007610144):0.7950447049,t303:0.7790907268):1.82101548,t304:2.463520728):4.996786332):0.06842222969):1.979735143):3.471390821):0.02902287055,(t305:10.5451147,((t306:5.283902185,(((t307:0.6620167814,t308:0.6254503749):1.640424211,t309:2.140937849):2.379775248,t310:4.255195532):0.4919853317):0.3079746306,(((t311:0.8205466006,t312:0.8182388112):0.7282234378,t313:1.49538824):0.1320644251,t314:1.564850497):3.289200605):4.921621349):2.305304846):0.6739334759,(((t315:5.557945403,t316:5.440917686):5.352646997,((t317:3.515756096,(t318:2.423502033,(t319:0.03481807207,t320:0.03182387278):2.365950195):0.8683431054):1.587143808,(t321:3.998887889,((t322:0.4445043889,t323:0.1636145145):0.8319222807,t324:0.9044851655):2.436637062):0.8021776282):5.649709767):0.9843273934,((((t325:1.339504292,t326:1.306555653):4.162673,(t327:5.153922276,t328:4.785416247):0.262582756):0.9065966032,((t329:0.1189896293,t330:0.1046435917):0.6532885595,t331:0.7485805112):5.109215313):4.164575444,(((t332:0.1238952415,t333:0.1177912746):4.165399336,((t334:1.039781292,t335:0.9934404849):2.712951604,t336:3.512214743):0.4561009008):5.258437458,(t337:1.636179501,t338:1.507500813):7.513171244):0.2054236388):0.004061275344):0.8533254759):0.8226115438,(t339:2.645171059,(t340:0.8476530014,t341:0.8411852139):1.647826938):8.119358102):2.745434646,((((((t342:1.818327667,(t343:1.082538627,t344:0.8315212797):0.6612946201):0.07695660364,t345:1.549042091):0.5502212204,t346:2.076873426):2.084603565,((t347:3.25562403,(((t348:0.1435690646,t349:0.0676733891):2.2193163,(((t350:0.02416036348,t351:0.008771423948):0.9058351592,t352:0.8800127141):0.2170981045,t353:1.023252382):1.129829558):0.4921537799,t354:2.562268268):0.3960126524):0.1461913108,(t355:1.903310586,t356:1.871718896):1.164824714):0.6609351579):8.203422238,((((t358:1.594700892,t359:1.522406785):3.962661281,(((t360:0.9924258578,t361:0.9553159091):1.699548492,(t362:0.2224043163,t363:0.2223044837):2.412755177):0.1931868233,((t364:1.26199606,t365:1.159239629):0.5710143751,t366:1.608317651):0.9021039443):2.555379543):3.584360639,(((t367:0.756654768,t368:0.7351259894):1.253373912,(t369:1.605374785,(t370:0.8872922215,t371:0.7147649273):0.6932666184):0.1608277684):1.711315304,t372:3.230706202):4.798076607):1.574444179,(((t373:1.190812386,(t374:0.8350398037,t375:0.760232022):0.1555452016):5.333255523,(t376:5.670114787,((t377:0.01646811204,t378:0.004790053385):0.5713009831,t379:0.393736176):4.994114009):0.5558922833):2.278979699,(t380:7.165757456,((t381:5.958446541,t382:5.926779069):0.5154349224,((t383:2.982154644,t384:2.97020484):0.1711961525,t385:3.05144552):3.21930014):0.5431403621):0.7749980816):0.5666496397):0.8836336948):0.3414887507,t386:9.378417762):0.2266738158):4.777593005):10.45530509):0.9731480635):40.03931388):91.93237582,(((((((((t387:0.3228151888,t388:0.3057884869):0.2629223497,t389:0.4695933871):0.2432516042,t390:0.6709871415):1.253404805,t391:1.830373958):5.930456684,((t392:2.629127329,t393:2.557477765):0.3003035026,t394:2.72438453):4.816345582):5.651721269,(t395:1.590922896,t396:1.506975372):11.60080287):7.548199171,(t397:1.095856397,t398:1.083191308):19.42077408):75.28764808,((((t399:0.5310887235,t400:0.178069031):2.481374932,(t401:2.359124553,t402:2.130545868):0.2275277699):2.462540547,(t403:3.097851571,(t404:1.766646557,t405:1.730815545):1.305727972):1.708920484):2.965218635,((((t406:2.022766643,t407:1.265640045):0.2194223637,t408:1.415291582):2.506792301,(t409:3.47021758,(t410:0.1813369115,t411:0.1687605):3.216921066):0.1576267525):2.645564373,t412:6.178334581):0.3116600952):87.24800461):44.127339,((((t413:8.407689941,t414:8.241828842):2.05330718,((t415:8.149683013,((t416:0.07805059029,t417:0.05981129891):1.236083319,t418:1.164378931):6.624867765):0.5719361495,(t419:2.657146028,(t420:1.215732393,t422:0.6234809016):1.410580848):5.584350798):1.376128038):5.027772778,(((t423:2.662589461,(t424:0.5217548058,t425:0.4950349032):2.084315884):0.3545695494,t426:2.921670302):1.130237364,(t427:3.153838766,(t428:1.446998463,t429:1.423473958):1.692718087):0.7441724933):9.779533683):4.566000502,((((t430:1.075090416,t432:0.7507526759):2.997942978,t433:3.727775355):1.089425522,(t434:4.3487176,t435:4.2154865):0.427444004):1.238542157,(((t436:0.2330349933,t437:0.03012205961):2.946983039,(t438:1.513475127,t439:1.46270811):1.323218171):1.771037724,t440:4.437368501):0.7607487871):11.74461708):117.7984715):17.01337414);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T4.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
