<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((((t348:1.567157966,t349:1.529998687):5.083782285,(t350:3.372674304,((t351:0.8146936419,(t352:0.7389068659,t353:0.5882480926):0.04572393664):1.875015642,t354:2.389219469):0.5543150713):3.222797861):0.622916228,(t356:4.354544915,((t357:1.148593318,t358:0.9662559515):2.017912361,(t359:2.299030628,t360:2.201815017):0.5172111517):1.04660316):2.235369071):4.809599126,(((((t361:0.9197103454,t363:0.5677554773):2.128158734,(t364:1.574486521,t365:1.432354592):1.093081541):1.77358776,(t366:0.07928826951,t367:0.02658123814):4.162455484):1.088241898,t368:4.955519592):1.555256646,(((t369:2.886650287,t370:2.745748402):0.1698508239,(t371:2.69256342,(t372:1.795136928,t373:1.711531815):0.8318704271):0.1275085104):1.347822133,t374:3.926257218):2.089340516):3.312753617):4.476560915,((t375:0.9388167629,t376:0.9104259931):3.051168093,(t377:1.112405573,t378:0.8638918748):2.734345575):9.635565048):0.0428809556,((t379:2.31661395,t380:2.262054121):6.612861913,(((((t381:0.53544719,t382:0.4758972753):1.742064369,t383:2.037357536):1.89450674,t384:3.764795367):1.262942903,t385:4.808516101):2.142830011,t386:6.804228426):1.041091361):4.291844028):17.15101458,((((t387:6.077749619,((t388:5.622646362,t389:5.534802402):0.03220023144,(t390:2.949529859,t391:2.889850237):2.607508378):0.2902397935):2.52021393,(t392:1.658031201,t393:1.20320924):6.485698076):5.833729459,((((t394:1.395099293,t396:1.303617853):5.432447131,(((t397:1.885177172,t398:1.85672843):1.303226703,t399:3.022668916):0.3307191241,(t400:3.225263703,t401:3.093107699):0.1146458637):3.164406126):0.3049006393,t402:6.566846269):1.452304383,(t403:0.9105499765,t404:0.6594973389):7.022343602):4.933477957):3.690086109,((((t405:0.5530996799,t406:0.4785114729):3.400475301,(t407:2.61651698,t408:2.594212956):1.207250781):0.5117989848,(t410:0.8987212775,t412:0.5126276159):3.172349458):9.762591104,(((t413:4.323689341,(t414:3.133443516,t415:2.900603244):1.163782058):5.366096846,t416:9.305685213):1.088644592,(((t417:1.015157228,t418:0.9339140647):0.2513338185,t419:1.180710654):5.37582574,((t421:0.6085474236,t422:0.5896509049):4.275787079,(t423:2.145574919,t424:1.689210872):2.69313449):1.463006926):3.71158087):2.596554456):1.954283892):11.15898515):59.80363213,((((t425:2.546486157,t426:2.393262846):4.632823338,(t427:3.463103156,t428:3.328252531):3.478462841):19.11584786,(t429:2.122563297,(t430:0.7365911876,t431:0.7218920163):1.314886707):23.64353234):22.4550629,(((t432:8.778929073,(t433:6.764896629,t434:6.666972108):1.807246263):10.99478669,(((((t435:3.602642827,(t436:0.9498804246,t437:0.8464433828):2.62561968):0.06463907535,(t438:1.820641504,(t439:1.013064366,t440:1.007903879):0.7461794827):1.665226359):1.147485266,(t441:3.201716967,t442:3.057755762):1.20372758):2.010854141,t443:6.237097499):5.873692473,t444:11.9026924):6.685509035):0.1892826108,t445:18.74556982):28.16915377):36.1485798):41.84027069,(((((t446:3.714427571,t447:3.600932594):3.374442451,((t448:0.4421063603,t449:0.4096038683):0.7755410246,t450:1.163938586):5.640305938):16.7020402,((((t451:0.8780990541,t452:0.8597312272):2.763567442,(t453:3.553091828,(t454:2.60514199,t455:2.597948563):0.7014783676):0.04704348751):1.031124632,t456:4.009796321):1.747159197,(t457:4.651980313,(t458:1.076073466,(t459:0.4853024248,t460:0.3985674547):0.4670817909):3.216354634):0.9361425185):16.95870524):11.62394584,((t461:7.548866044,(t462:3.013935389,(t463:0.4266176857,t464:0.3890403858):2.56949999):4.238810146):17.40273038,(t465:3.748611525,t466:3.721954782):20.81652963):8.547096139):15.42117564,(t467:27.57690209,t468:27.43099045):20.88202633):73.84458956):47.86063233,(((((t420:0.1159318883,(t411:0.1435078035,(t409:0.01873704105,(t395:0.001924320404,(((t362:0.2045516723,(t355:0.006989922346,(((t184:0.1251703761,(t156:0.0590929125,(t149:0.04335810629,(((t90:0.1982748375,(t82:0.1352781098,(t30:0.05344415852,t1:2.951660369):5.269558213):1.093698039):1.32854045,((t2:6.542421678,(t3:3.871220757,t4:3.819654093):2.430865319):1.796524807,t5:7.945153385):2.278937236):0.716964035,(t6:6.238217017,((t7:2.356057438,t8:2.318131521):0.950851104,t9:3.264118058):2.878494823):4.507142532):3.987131581):0.5127019417):2.570654623):1.734073712,((((((t10:1.950316991,t11:1.901324654):3.809249685,t12:5.328437913):6.764952325,((t13:2.156792951,t14:2.097874659):3.030380182,(t15:2.810554156,t16:2.615022634):2.059479372):6.896515676):3.365225687,((((t17:1.978024672,t18:1.919673794):1.530519847,t19:3.34039481):0.9436587514,t20:4.137710209):3.496893834,t21:7.484007002):6.982631082):2.503416346,(((((t22:0.9148886422,t23:0.8615722013):10.64560602,((((((t24:3.076586118,(t25:2.85069896,(t26:1.504453042,t27:1.492287095):1.269634382):0.1106673698):0.5142803537,((t28:2.123587953,(t29:1.077789255,t31:0.6224322352):1.025170269):0.5088364236,t32:2.12102841):0.6896559885):2.661160089,((t33:0.4489003467,t34:0.3045062097):2.98630069,(t35:0.3280289546,t36:0.2269835565):2.794906448):1.994680056):1.526113701,((t37:2.944544253,t38:2.925839644):2.083811925,(t39:1.582065572,t40:1.562636164):3.281884985):1.491362987):1.474304986,(((((t41:1.647620414,t42:1.580788916):0.7939862752,t43:2.369644527):3.628166229,(((t44:2.057967376,t45:2.004104462):0.6329592647,t46:2.617220339):2.000251347,((t47:0.9576248436,t48:0.8725071011):2.129582867,t49:2.983387068):1.390127039):1.173156756):0.7976862235,(t50:5.796198349,(t51:3.591644697,(t52:1.094880624,t53:1.074704793):2.487080421):1.928734763):0.3393289289):0.8734615052,(t54:4.536097937,(t55:1.417534396,t56:1.184273943):3.099628676):1.620764052):0.03113122527):0.7026850772,t57:6.455454896):1.424279781):1.613957192,((((t58:1.515457341,t59:1.508044003):2.932588863,t60:4.369895696):1.031192943,t61:5.372072066):1.262728626,(((t62:0.5206729843,t63:0.5126811321):1.187613282,t64:1.584006113):1.249006371,t65:2.778460037):3.652272688):2.727700864):1.412278386,(t66:2.010720089,t67:2.007155639):8.473928066):1.380503774,(t68:3.589763793,((t69:1.258044899,t70:1.028617189):0.5465545001,t71:1.512888459):1.684322908):8.221809263):0.970207885):0.5713607504,(((t72:1.186142803,t73:1.037275587):2.644893163,t74:3.442283415):5.943005668,(t75:5.881263032,(((t76:0.4439156599,t77:0.4189182956):2.179523057,t78:2.567737764):2.318978019,(t79:3.963700594,t80:3.925190025):0.7258348793):0.8018522892):3.391752023):2.895970812):0.4879618043):10.03261167,((t81:17.12057801,((t83:1.261468719,t84:1.253007304):9.932631709,(t85:6.174736468,(t86:1.382932832,t87:1.345849869):4.764830818):4.671216315):5.600162112):2.509296962,(((t88:6.681886417,((((t89:2.438795258,t91:2.081322376):0.6866259947,((t92:0.4017567984,t93:0.3239952955):1.33863674,t94:1.657168699):0.9217830451):0.2338021362,t95:2.796788052):1.52579095,t96:4.308083043):1.70050552):1.590540596,(((t97:1.791914578,t98:1.771682749):3.414241172,t99:5.062109481):0.8170213338,((t100:4.097560789,t101:3.60550519):0.4740068374,((t102:2.497412453,(t103:1.424900697,t104:1.396626537):1.028751218):0.3486228683,t105:2.647744156):1.117553859):1.098543621):1.564103066):1.019922202,t106:7.12385614):9.4099388):2.629886048):5.025108002):1.14282473):2.090501084,((((((((((t107:3.130045947,((((t108:0.6554846262,((t109:0.0871120527,t110:0.06525560641):0.1727729358,t111:0.06711213066):0.3585836976):0.4019553586,t112:0.7651079558):0.2616449361,t113:0.9087133496):1.37665033,t114:2.164627691):0.3852572183):2.108205413,((t115:2.222353348,t116:2.143436253):2.200419311,t117:4.338199398):0.04144184718):5.421027354,((t118:3.679105474,(t119:1.656644279,(t120:1.380084562,t121:1.165849104):0.2598239561):2.002237059):0.9509136104,t122:4.365116656):4.961393558):1.249676373,t123:10.48686503):4.481486853,(((t124:1.094733535,t125:1.03586177):1.808203677,t126:2.716476895):2.944628948,(t127:1.355427545,t128:0.9573601549):4.279137915):8.913270516):1.81598258,((t129:3.112981216,t130:2.55050052):9.536797276,(((((((t131:4.055176047,((t132:3.120828345,(t133:1.694526664,t134:1.683563492):1.35336975):0.3794808812,t135:3.408308406):0.5501166607):1.233052561,t136:5.072360715):0.4223875412,t137:5.338120447):1.016937538,(t138:3.190871198,t139:3.17721281):3.019216437):0.1527041049,(((t140:1.881721632,t141:1.875751332):1.997680018,t142:3.85784222):0.1953602653,t143:3.804821185):2.182756436):2.503552602,(t144:6.686506883,(t145:2.97778406,t146:2.919778164):3.695933624):1.80028147):0.5793540871,((((((t147:4.2399418,((t148:0.7140137436,t150:0.4845657473):1.743745087,t151:2.061087299):1.662005134):0.06927733895,(t152:3.097371067,t153:3.061557719):0.6281838875):0.8271204916,((t154:3.180758964,t155:3.152187813):1.02669208,t157:4.062676695):0.2802121359):1.028735501,(t158:4.741598683,(t159:3.851093634,t160:3.778243991):0.8701962135):0.5676948768):0.09917535418,((((t161:1.543931377,t162:1.460936452):0.00269270325,t163:1.31489085):1.472720003,t164:2.740497593):0.06800483417,(t165:2.457436137,(t166:1.512916282,((t167:0.1128032765,t168:0.003023210355):1.238311534,(t169:0.9903083506,t170:0.7752707659):0.1084598768):0.1536484041):0.4672120039):0.3283731387):2.153218044):2.351156864,((((((t171:0.6676418201,t172:0.4474634181):1.087125766,(t173:0.3324029961,t174:0.3119738333):1.200699036):1.75420244,t175:3.087144798):0.7245738503,t176:3.811543773):0.8397378045,(((t177:0.9348286815,t178:0.8921484171):1.340102431,t179:2.225344164):0.3334500519,t180:2.498335823):1.979386154):0.3521915068,t181:4.727597503):0.891488326):0.2874700116):2.086616858):3.204717354):5.441461634,((t182:5.431882511,(t183:2.162829213,t185:1.849150483):3.266358034):2.307387458,(t186:2.62162981,t187:2.569217076):4.663396246):8.832249151):1.979251535,((((((((t188:0.2252746573,t189:0.1888723153):0.7540634216,(t190:0.2129232811,t191:0.03827756852):0.4664796459):2.218201423,t192:2.694111422):4.778390116,t193:7.365737193):2.078797724,((t194:2.146877538,t195:2.006910854):3.572627464,t196:5.395650807):3.687477342):0.6215687378,t197:9.435166621):3.497446023,(((t198:2.349481624,t199:2.208378864):3.498101966,(((t200:0.2295263533,t201:0.1326304178):1.99722213,t202:2.097741341):1.375217326,(t203:0.3955628635,(t204:0.2960189597,t205:0.2198446432):0.02043256663):3.00064213):1.939201597):4.322556628,((t206:4.282458017,t207:4.226845098):0.4947745223,t208:4.708925999):4.694672298):2.749041065):3.224080392,((t209:1.952191509,t210:1.917575754):5.151586375,(t211:2.363298273,t212:2.274425543):4.552982462):8.250173373):0.4658989275):0.3748200345,(((((((t213:1.796471633,t214:1.670398253):4.204023767,t215:5.837432894):0.3567502877,t216:6.043829509):1.5560025,((t217:1.762852898,(t218:0.8275976716,(t219:0.3582105132,t220:0.2658427216):0.3741850584):0.8001369806):0.7944390825,t221:2.111347661):4.809037985):1.004734762,(t222:1.055901209,(t223:0.1550989966,t224:0.07755569698):0.8513100464):6.848080219):1.272444825,(((t225:0.4635584816,t226:0.2157235956):0.2945005791,t227:0.3395615863):0.6803608107,(t228:0.3827373237,t229:0.3224303532):0.5581485213):7.528085894):5.182991609,((t230:7.208954977,((t231:4.13732954,((t232:1.341922338,t233:1.235075202):0.8774091799,t234:1.884785211):1.878966754):2.621719556,t235:6.245405661):0.4331379031):2.219944225,((((((t236:1.543990532,t237:1.458758686):2.304126788,((t238:0.2615654428,t239:0.1461643928):3.300374815,t240:3.393226851):0.09607839773):0.9686477171,(((t241:2.511050089,t242:2.327947557):0.2433627071,(t243:1.582426076,t244:1.361461672):0.604635329):0.3605904184,t245:2.230697599):1.240885569):1.681354226,(t246:0.7297930878,t247:0.3480886279):4.303621448):0.467872069,(t248:3.215836996,(t249:1.614087089,t250:1.548393374):1.55808268):1.856723212):1.720368492,((t251:0.1745288962,t252:0.1707725989):3.169751049,(t253:1.989201019,(t254:0.7456117515,t255:0.6745278501):1.213135653):1.304882511):3.256560474):0.1400173327):4.106780128):0.5371072692):0.3362908943,(t256:4.639242088,(t257:1.431053267,t258:1.369523508):3.112741034):6.911191847):1.017949204):0.5234966011,(t259:8.91457258,(((t260:0.3812935171,t261:0.1746133631):3.390640002,t262:3.520326386):0.9597529664,t263:4.420024607):3.902194353):3.981288242):1.179609421):1.350916491):0.2173699481):0.9567251187):2.869089316,(((((((((t264:1.084926215,((t265:0.1960724994,t266:0.1442631824):0.5165510654,t267:0.6382679956):0.3043180162):0.4958385983,(t268:0.3588205894,t269:0.3178138111):0.8628596616):0.7928829333,(t270:0.4871205632,t271:0.3907518862):1.332757915):0.5699990541,(t272:1.122578364,t273:1.094853932):1.13488682):4.32259171,((t274:2.500181043,t275:2.426305028):2.250796563,t276:4.632819545):1.672664996):0.03602953007,(t277:6.001268933,t278:5.993627119):0.3102732771):0.1844787519,t279:6.322977548):3.70631396,((t280:2.085615906,t281:2.01027087):2.153273029,(t282:0.8545575016,(t283:0.7171410618,t284:0.625971263):0.05034640177):3.059971557):5.729145905):5.179092355,t285:14.49521952):2.138011934):1.471994914,(((((t286:2.459482383,t287:2.316220446):8.381742536,(((((t288:1.870870491,t289:1.849503143):2.747171227,(t290:0.4461901193,t291:0.4172782578):4.097657142):1.51858569,t292:6.028495929):1.501141495,((t293:0.1826706397,t294:0.1629947935):4.527412416,(t295:3.585794756,t296:3.582647568):1.010052531):2.805745914):1.218485972,(t297:1.15020781,t298:1.066168655):7.30939981):1.787192565):0.8806517756,((t299:3.61280873,(t300:0.3109797472,t301:0.2638759716):3.253921112):4.322233954,((t302:4.479177047,(t303:2.167900044,((t304:1.328541857,t305:1.299139744):0.08971765248,t306:1.387652127):0.6623218649):2.186275807):1.577471187,t307:5.593807382):1.653575556):2.78189048):1.632083241,(((t308:1.873429034,t309:1.821127436):5.212203116,(t310:1.299112493,(t311:0.8824006519,t312:0.8552480419):0.3878391385):5.677100207):1.232741682,t313:8.150261643):3.217755925):1.56468412,(((t314:0.1638050299,t315:0.07288452014):1.459151093,(t316:0.09404266884,t317:0.09025574035):1.399496667):5.831909662,((t318:5.745536744,t319:5.217502578):0.3211246862,(t320:3.894027443,(t321:2.649438472,(t322:1.13348293,t323:1.08747838):1.490893944):1.184948752):1.408571194):1.212542101):5.31744447):3.112908352):2.386228797,(((t324:0.6550634076,t325:0.3769558013):5.170312941,(t326:3.329976918,(t327:1.301972108,t328:1.229190874):1.904112446):2.210676094):9.61572915,((t329:0.3694125028,t330:0.3549752967):5.985578396,(t331:0.1676412027,t332:0.03760697528):5.747154645):8.549152611):1.650947164):0.4844157904,((((t333:7.084941488,t334:6.932773761):0.7831981584,t335:7.701885995):0.6386185545,t336:8.11998439):1.86086535,(((t337:2.686496622,t338:2.333022369):3.059367885,(t339:2.850843854,t340:2.800896671):2.53832438):0.7762564983,((t341:1.088843913,t342:0.9274871546):2.810744153,((t343:0.6257866722,(t344:0.01520363776,t345:0.001535926238):0.5521229698):2.124618438,(t346:0.2214423605,t347:0.1573276585):2.44299409):0.9680270788):2.18598208):3.370351812):6.059191093):168.0865701);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T90.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
