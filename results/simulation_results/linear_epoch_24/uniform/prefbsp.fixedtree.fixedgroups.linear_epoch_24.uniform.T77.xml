<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t443:2.37445055,t444:2.260241863):2.985175871,(t445:3.855553004,(t446:0.1531287258,t447:0.120524167):3.542301941):1.322162763):1.303310156,(((t448:0.3272692218,t449:0.1917412329):2.397103164,t450:2.441446545):3.218836764,(t451:3.17014249,((t452:0.3108193957,t453:0.2194941001):0.4238220488,t454:0.6206513598):2.382766174):2.331306995):0.1718554997):3.729758375,(((t455:0.871842705,t456:0.8433200837):1.063589936,(t457:1.255213676,t458:1.124487195):0.6501246243):4.370654218,(t459:4.533634312,t460:4.469164274):1.574473463):2.929509663):0.5863822615,(t461:5.909424417,(t462:0.2554424502,t463:0.2473577614):5.512564943):3.611207017):105.3783579,((t464:5.588627636,t465:5.455877457):14.97930947,((t466:1.351007048,t467:1.336122668):18.9881652,((((t468:2.78811426,(t469:0.5319882466,t470:0.3086698836):2.220619654):0.4027693153,((t471:1.006696238,t472:0.7781286543):1.38464642,(t473:1.413623919,(t474:0.7487078796,t475:0.5947311001):0.6648972705):0.7462091158):0.1412019703):3.105283646,t476:5.176873298):6.519258777,(t477:6.121229631,((((t478:0.6272338038,t479:0.5565079004):0.07489479043,t480:0.5849981694):0.02363554663,t481:0.415021804):1.138248072,t482:1.515990644):4.240540331):5.553828635):7.507094818):0.05658587906):94.13959555):261.9714172,(((t483:0.3557054858,t484:0.3358134741):34.12112986,((t485:1.08656148,t486:1.070603427):7.133391807,(t488:3.443376145,(t489:2.109128835,t491:1.913469075):1.259235256):4.376255561):26.20922109):30.89176754,((t492:9.889745783,(t493:1.055847034,(t490:0.1314849677,(t487:0.2600415637,((t440:0.02573163572,(t395:0.05885117762,(t388:0.01768541993,(((t303:0.05335140557,(t267:0.1053958732,((((t140:0.07552517736,((t39:0.01294397252,(t36:0.02148077024,(t32:0.1455385559,t1:2.694098418):0.3750998033):0.4684126924):5.894550388,(((t2:2.375850118,t3:2.356844076):0.8711388016,(t4:0.1927179803,t5:0.1731218064):3.018725163):5.471269506,t6:8.654277075):0.7109350657):3.874978041):0.744303345,t7:13.91088158):5.200199389,((((t8:8.795072616,((t9:1.775668282,t10:1.639385498):1.397659364,t11:2.917277761):5.60214883):6.559025664,((t12:7.71256601,((t13:0.190656649,t14:0.002108367212):4.149983775,(t15:2.938559685,t16:2.855249381):1.129736659):3.369732144):1.041585705,(t17:5.873675818,(t18:3.383880878,((t19:1.14095958,t20:1.069555203):0.1290739721,t21:1.145986354):2.071499729):2.29802718):2.4912393):6.022189553):0.7280276439,(((((t22:1.779160895,t23:1.629464656):4.786863695,(t24:1.975110215,t25:1.926214559):4.411467373):0.2672250172,t26:6.407817075):1.092608652,(t27:7.219740469,t28:7.20560456):0.2661671911):5.443524137,((t29:9.112629751,((((t30:2.981738639,((t31:0.6343169836,t33:0.3722009975):0.6001100625,t34:0.844240937):1.528539284):0.4300279885,t35:2.736361529):0.2749759113,t37:2.865099621):2.748842347,((t38:1.974401346,t40:1.651108489):0.3981401602,t41:1.936961211):2.944174235):2.665650385):1.427380829,t42:8.915588641):2.320297867):1.302073651):0.5828642532,((t43:0.5222528957,t44:0.4857988426):1.668018167,(t45:1.336939328,t46:1.312519875):0.7902597303):10.88250463):2.267566831):5.200758769,((((((t47:3.863397695,(t48:0.662598546,t49:0.6191535582):3.039569575):1.581259872,(t50:5.176099544,((t51:1.845862966,t52:1.649797249):1.930187692,t53:3.483349543):1.33356211):0.05812716691):3.260559604,(((t54:1.717905711,(t55:0.6125237431,t56:0.3396495298):1.010031202):1.266836206,t57:2.540801265):4.475604479,((t58:1.656009985,t59:1.600164303):2.487854486,(t60:3.045517885,(t61:1.089322703,t62:0.9834774764):1.884028465):0.850785464):2.851130545):0.4484574833):3.619280002,(((t63:3.484702218,t64:3.465298535):2.48825779,(((t65:0.524454821,t66:0.14970156):0.7408403113,t67:0.7882802004):3.710557562,t68:4.477190766):0.8455600145):0.488620748,((t69:3.161149061,t70:3.118608041):1.710568938,(t71:3.542626502,((t72:0.6279335112,t73:0.5879166407):1.186601395,(t74:0.7424714224,t75:0.6688937059):1.000640922):1.702079843):1.176138512):0.9142758706):4.115153284):5.05338975,((t76:0.6192255641,t77:0.5071374184):8.823410282,((t78:4.477766357,((t79:0.5423114414,t80:0.4781398892):3.140821303,(t81:0.3071802115,t82:0.0915295166):3.295157777):0.7773547628):3.474309245,(((t83:4.533457095,t84:4.533389733):0.662646229,t85:5.179670674):1.911762641,(t86:5.289661603,(((t87:3.807384532,(t88:2.732519833,t89:2.628124387):1.057370119):0.6762667142,t90:4.353087732):0.2008936241,t91:4.459666941):0.555619335):1.725837393):0.3015998587):1.334652313):5.119384078):0.788098212,((t92:6.791766105,(t93:4.747049497,t94:4.731508181):1.911349487):6.669899852,(((t95:4.063973527,t96:3.933353909):4.01581393,(t97:6.878098486,((((t98:1.636110804,t99:1.450268374):1.868827675,(t100:1.559476364,(t101:0.9342519805,t102:0.9176141918):0.5816697063):1.370713693):0.8991465852,t103:3.528290406):1.772428426,((t104:1.439433141,t105:1.436229469):2.033741388,t106:3.466141844):1.754871423):0.5874257165):0.4351745629):0.5181739124,(t107:2.025773476,t108:1.970743862):4.722675649):4.691509547):0.8179229429):2.073975109):1.062693656):4.357002684):1.09228277,((((t109:0.787460038,t110:0.7245440395):5.121460602,((t111:0.3308960923,(t112:0.2699429717,t113:0.2241157957):0.02009093567):0.2555451208,t114:0.4840721025):5.134156438):6.539064273,(((t115:1.82281162,(t116:0.8340563392,t117:0.677957944):0.9816315696):3.913227232,t118:5.554368403):3.435842599,(((t119:1.55190651,(t120:1.107804047,t121:1.095741869):0.3570221442):4.22472242,t122:5.673512328):0.4230965694,(t123:3.580372365,(t124:1.168955812,t125:1.151601878):2.026724668):2.287204124):2.761534237):2.813761462):1.066366717,(t126:5.069790625,(t127:4.243371491,(t128:3.046795929,((t129:0.4566865712,t130:0.3802865883):1.746859025,t131:1.937255971):0.8381987174):1.162210787):0.8031942625):7.0280201):7.146651338):6.946706166,(((((t132:3.384188156,(((t133:1.036871725,t134:0.8605977649):0.3651525208,t135:1.161922203):1.306495204,t136:2.29606513):0.6597417217):4.015761257,((t137:2.121801048,t138:2.05462993):4.294627609,(t139:4.990144314,((t141:0.6250695391,t142:0.4827577798):2.315238332,((((t143:0.5674330274,t144:0.4381069973):0.2722379054,(t145:0.546579278,(t146:0.477804653,t147:0.456957949):0.06050241807):0.101644197):0.1643694846,t148:0.7699198399):0.1215800218,t149:0.8712941008):1.57678354):1.1618457):1.167406789):0.548131603):1.286574861,(t150:5.944936417,t151:5.850728231):0.4589157047):7.103524466,(((((t152:2.750701736,t153:2.714997603):1.288803895,t154:3.79315443):5.257513393,((((t155:1.31962609,(t156:1.186987563,t157:1.012075432):0.1132281888):2.001265003,t158:2.986601103):3.180223104,(t159:6.059729146,t160:5.927810965):0.0830052076):2.33082238,(t161:7.763109623,((t162:3.197369163,t163:3.182086417):4.020295091,(((t164:1.635184968,t165:1.540794308):5.058209161,t166:6.541874509):0.1548360241,(t167:1.988392202,(t168:0.598394284,t169:0.5156230465):1.124946195):4.702485261):0.2762119589):0.5173295418):0.5662582302):0.1822288308):0.436323254,((t170:2.31846092,(t171:1.102846725,t172:0.9711252904):1.204272346):4.14383684,(t173:5.368604337,(t174:4.404529936,t175:4.337122096):0.9615638681):0.9181138591):1.823650497):0.4658921402,((((t176:1.295025437,t177:1.262544163):4.678348429,((t178:0.5621716312,t179:0.3894314092):3.662400908,t180:3.924613528):1.636379376):0.03888316151,t181:5.567527551):0.6217026116,(t182:4.874374379,((t183:1.463743892,t184:1.31104968):2.81392018,(t185:3.969136726,(t186:0.449433225,t187:0.2879657431):3.345426347):0.1061064922):0.5506509159):1.173938549):1.630016202):3.056264502):1.96016891,(((t188:7.569713931,(t189:0.8660799759,t190:0.8218226028):6.591665057):0.08086610604,(t191:1.438789146,(t192:0.7523357405,(t193:0.04306287804,t194:0.0405756917):0.7054807819):0.6808264665):5.887256053):1.935954833,(((t195:6.257145655,(((t196:1.769004958,(t197:0.7945348963,t198:0.6908859711):0.9378146249):0.04689055877,t199:1.553230195):2.441461768,(t200:3.119925426,(((t201:0.02522598498,t202:0.02292335325):0.50586203,t203:0.4206027253):0.8763104688,t204:1.271868476):1.492006078):0.7850835208):1.729572515):1.232139394,t205:6.386886509):1.50788313,t206:7.855397677):0.1659863371):2.510359988):8.020122502):0.4533111789):0.5318579187):4.43972479):2.485562333,((t207:1.767186361,t208:1.488861659):16.49411731,(((t209:10.84233736,((((t210:0.4150073071,t211:0.4100252468):1.981879927,(t212:0.4786124598,t213:0.2671365221):1.881174848):0.6756566854,t214:2.473809996):5.520454446,(t215:5.007734726,t216:4.837404893):2.97801713):2.203452085):1.188996346,((t217:0.7409233073,t218:0.6704897917):7.628656125,(((t219:0.7038668009,t220:0.6075780859):6.795654941,((t221:1.294903877,t222:1.216353993):3.509690485,t223:4.723273013):2.491965533):0.3390362464,(t224:2.560661818,(t225:2.284457464,(t226:1.365062287,t227:1.178844271):0.8722276284):0.16703941):4.771622535):0.382246899):2.816068002):5.489286061,(((t228:1.350563501,t229:1.349590771):3.115630809,(t230:2.517539181,t231:2.462208225):1.934131523):5.258784062,t232:9.390105545):5.934484164):0.3625468024):8.011012343):1.455292156):0.32193681):1.306888851):8.829334297):32.34919335,((((((((((t233:1.99332061,((t234:0.6158525791,t235:0.5378895105):0.539245789,t236:0.8783917633):0.7245066202):0.5106599971,t237:1.803817893):7.977758379,(((t238:4.170754295,((t239:0.9080022451,t240:0.8717167325):1.906209481,t241:2.681093234):1.336522994):0.4965584554,t242:4.449621715):0.6041994498,(((t243:0.7599024387,t244:0.7204934644):2.167369279,(t245:0.865046129,t246:0.7549955918):1.969244947):1.73626206,t247:4.085687406):0.375529756):4.484513629):9.01216331,(((((t248:1.222198489,(t249:1.195352919,(t250:0.4771472752,t251:0.4661586388):0.7163784948):0.01185581668):7.206992356,(t252:6.697985867,(((t253:1.367670759,t254:1.218274347):3.953343243,((((t255:0.3568734021,t256:0.3501550962):0.429331147,t257:0.7673796677):1.824751489,t258:2.53020236):0.480370292,(t259:0.5644450371,t260:0.4990660648):2.383516476):2.005083579):0.4382546652,(t261:2.517209941,((t262:0.2952429761,t263:0.2779743003):0.1763217018,t264:0.3208951823):1.954540456):2.607224329):0.8591252029):1.258840504):2.483055127,((t265:6.540714601,((t266:3.149807565,t268:2.943485075):2.787213758,(t269:4.5557116,t270:4.384371767):1.087234177):0.5206469066):4.236378834e-05,((t271:2.153771581,(t272:1.714987246,t273:1.604726278):0.4186211329):1.326134435,t274:3.345883499):2.292285607):2.926552628):2.303952691,(t275:3.054077024,t276:3.00209241):7.654007816):2.67935353,(((t277:2.538256453,t278:2.275086173):2.810561853,(t279:0.4079251757,t280:0.306850834):4.499175139):6.660878833,(t281:7.133855042,(t282:6.978150965,(t283:1.003959458,(t284:0.3527413258,t285:0.2219880978):0.6279638504):5.927542252):0.1229289346):4.306192261):1.174576627):1.926278685):0.2551824683,((((t286:2.335438643,t287:2.335307922):5.177477943,(t288:3.975907701,t289:3.912221613):3.359635257):5.500707449,((((t290:0.7702953589,t291:0.4059893887):6.816835591,t292:7.101345539):0.9679072736,((t293:7.021751846,t294:6.704842077):0.2574936461,((t295:3.672545848,((t296:0.4695423289,t297:0.4633075424):2.36662534,(t298:1.44375755,t299:1.400053777):1.309462754):0.6824217392):0.8775730202,((t300:0.817595837,(t301:0.558325755,t302:0.5395996306):0.1113730182):2.75242723,(((t304:1.454089703,(t305:0.5005986873,t306:0.4835774625):0.896374483):0.573003569,(t307:0.1937845901,t308:0.03698364106):1.666314334):0.1571121696,(t309:0.2594609633,t310:0.2592975082):1.573564508):0.979280912):0.6468532509):2.375869717):0.3670540753):0.3297011116,(t311:3.530904587,t312:3.392381815):2.962331303):3.737896408):0.7413004083,t313:10.81830475):0.6185391026):0.6433047014,((t314:8.103904918,(t315:2.041061084,((t316:0.7967148138,t317:0.7939572045):1.037963016,(t318:0.288569913,t319:0.2826938957):1.399287671):0.1184319706):6.057197369):0.8822975717,(((t320:3.036893566,t321:2.885408445):0.5390022039,((t322:0.7580054766,t323:0.7568801902):2.593199138,t324:3.285872293):0.01477532543):4.101518595,(t325:0.2073980349,t326:0.1260396934):7.033865237):1.033066188):3.021693136):1.645317998,(((((t327:2.257814886,(t328:0.313499783,t329:0.2291925711):1.917701886):0.05089494752,(t330:0.4607114111,t331:0.2218277016):1.693775604):4.585071717,(t332:6.085458835,t333:5.817147002):0.3767494852):0.8533438983,t334:6.858217615):0.9863463046,(((t335:1.358019806,t336:1.113338807):0.9244748322,t337:2.03120488):4.404693997,(t338:5.985963463,(((t339:0.5980168882,t340:0.5118075733):1.090510143,t341:1.534739958):2.466381711,(t342:2.270915502,(t343:1.661342671,(t344:0.8595906936,(t345:0.7712594554,(t346:0.5512981918,t347:0.2092692074):0.1525646657):0.02707155306):0.3989491507):0.5983357265):1.654625739):1.772579979):0.2287507599):1.082597398):4.105556161):21.03581462,(t348:11.64987033,(t349:5.437753848,t350:5.288676595):5.967669869):19.19703105):15.52447358,((t351:11.41477403,((((((t352:1.534191069,t353:1.526533664):2.458717177,t354:3.95141264):0.746488365,(t355:0.1137821223,t356:0.1042938568):4.554547897):1.951958924,((((t357:0.9188048359,t358:0.8600802677):0.128474216,t359:0.9865320064):0.5889905619,t360:1.544323994):2.364431197,t361:3.87257445):2.368499631):2.279778103,(t362:7.927072957,(t363:5.292009717,(((t364:1.256426019,t365:1.094398047):1.534952278,(t366:2.469866901,t367:2.441234277):0.06020477477):0.3240730607,t368:2.568492035):1.915049614):2.56612828):0.4936613553):0.5790556701,(t369:5.497356672,(t370:1.346931475,(t371:0.3509569965,t372:0.3331890959):0.7129606516):4.112617846):2.623532345):1.846683826):0.1091538092,((((t373:0.8050322071,t374:0.6128605901):0.8256147358,t375:1.179437345):0.1637562816,t376:1.266542443):2.379788072,t377:3.439371101):5.51937224):34.37230341):8.58203697,(((((t378:0.6531496197,(t379:0.06625125342,t380:0.06104074157):0.5727938338):2.378256049,t381:2.965944056):3.319333897,(t382:5.348684424,(t383:3.114044698,t384:3.055097281):2.152177122):0.8552882667):0.7700150504,((t385:0.8455835838,t386:0.7773620576):2.589582529,t387:3.323693722):3.30444125):25.10367258,((((t389:5.839572659,t390:5.79684221):1.580165861,((t391:2.025934697,t392:1.916815614):4.093576573,((t393:1.611107067,t394:1.520744979):3.204360309,(t396:1.998371495,t397:1.844619048):2.578830689):1.145514739):1.144428518):4.315948664,((t398:8.696716145,((((t399:0.9830642551,t400:0.9730585486):0.4603577198,t401:1.329712764):1.755044777,t402:2.72932957):2.392525938,t403:5.082190887):3.060627267):1.451882177,t404:9.439289846):0.7676205978):14.69611038,((((t405:4.3237172,(t406:3.946460138,((t407:1.214767517,t408:1.096402043):0.1671024077,t409:1.25303867):2.44379063):0.3206845224):4.633459378,(((((t410:1.402587521,t411:1.3945525):1.645215601,t412:2.933792193):1.346821962,(t413:0.4529742441,t414:0.4176492575):3.782476745):0.8273326235,(((t415:0.1047862473,t416:0.0711653296):4.084223186,t417:3.997313728):0.6688474009,((t418:1.191797673,t419:0.9446511731):0.8657931427,t420:1.806148062):2.428142896):0.1380251561):2.683074496,((t421:2.050276134,(t422:0.2077868092,t423:0.1165417191):1.761331003):2.176015515,(t424:3.442708352,((t425:0.2236505778,t426:0.1646819998):1.132613689,t427:0.5902517796):2.070612891):0.5392932):2.743206312):0.6892962134):4.671338744,(t428:11.02825984,((t429:1.910463263,t430:1.86987099):0.3826985147,t431:2.023233305):8.721162111):0.0799562961):2.645751184,(((t432:2.722335926,t433:2.696289544):3.851833199,(t434:4.909692847,t435:4.736100305):1.563059113):1.536558802,(((t436:3.513091469,(t437:1.212575448,t438:1.191442603):2.21711726):1.241109055,t439:4.623367049):0.3664889822,(t441:1.975186336,t442:1.953888089):2.880042787):2.585150352):5.345472551):8.618084211):5.001892568):19.58553073):0.6945983868):22.17006535):309.5684918);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T77.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
