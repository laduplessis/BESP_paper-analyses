<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t408:1.724052788,t409:1.583173982):1.096580615,(t410:1.986180465,t411:1.83638878):0.6182208382):3.835215125,(((t412:3.518741983,(((t413:0.6636364866,t414:0.593080849):0.1918511366,t415:0.7498252228):0.07036672815,t416:0.7205704986):2.386197403):1.729263908,t417:4.77115864):0.8679503089,(((t418:1.166946662,(t419:1.082997978,(t421:0.1197477492,t422:0.1033702349):0.3145383666):0.0213518441):2.820716302,t423:3.252031598):1.202760433,((((t424:0.8957425706,t425:0.7988153041):1.67627635,(t426:0.7670212293,t427:0.7538445315):1.701394619):1.324975055,t428:3.633291785):0.3589785426,((t429:2.395690147,(t430:1.508277204,t431:1.488307816):0.8409141291):0.3470694141,t432:2.648781981):1.231168511):0.07458409686):0.2002331542):0.04339999125):17.47270175,((t433:0.4896465367,t434:0.2968726721):11.36650282,((t435:2.73946569,t436:2.671261569):0.253557695,t437:2.58179775):8.655839916):9.677881428):14.11139924,(((t438:3.149998183,((t439:0.8821811073,t441:0.7374765764):0.145106984,t442:0.8822569852):2.037934565):5.039715169,(t443:3.098573799,t444:3.062984822):4.825174566):2.134657474,(t445:1.45335846,t446:1.201976696):8.444846868):24.4906017):161.093778,((((t447:1.098479372,t448:1.089802897):1.077595454,((t449:0.7055104146,t450:0.6747118494):0.2749622177,t451:0.917496285):1.134307506):7.281943948,((t452:1.362073174,t453:1.178702216):7.335778351,(t454:0.7105550241,t455:0.4798796783):7.251575952):0.5665944366):95.9623817,(((t456:0.7865765697,t457:0.774811824):8.775708551,(t458:9.399388323,(t459:4.341125647,t460:4.321429139):5.02031641):0.1459421348):27.09014451,((t461:2.763495073,t462:2.760442453):3.615991075,t463:6.344272071):30.17394433):67.59115602):89.79118841):54.37757142,(((t464:2.328554782,t465:2.270363612):8.752286531,(t466:1.187647549,t467:0.944088801):9.733512828):70.89913251,((((t468:7.573703576,((t469:0.9178325283,((t440:0.0683591775,(t420:0.005920324735,(t395:0.01385270224,((t341:0.02275124425,((((t329:0.007471993187,((t306:0.04492086767,((t253:0.1460320021,(t204:0.1376292347,(t174:0.01930855679,(t161:0.1624549029,((t138:0.03107856117,((((t29:0.02875957986,t1:2.418156775):5.583058592,t2:7.932870848):0.476045503,t3:8.263933307):3.666110105,((t4:2.253071538,t5:2.218374675):7.669634316,t6:9.857130979):1.932563826):1.54326706):2.003628477,t7:15.23862112):1.033515077):0.9736834063):3.16736143):4.814136232):3.360423458,((((t8:2.810441348,(t9:1.559281889,t10:1.498404666):1.228422926):3.431694542,(t11:4.649975575,t12:4.491518351):1.291035137):1.171128449,(t13:0.8099015112,t14:0.5713669098):6.136396496):5.704760788,(((t15:2.875633949,((t16:1.676223748,t17:1.639911717):0.08504665013,(t18:0.8796880521,t19:0.8494958408):0.8402314139):1.02521213):0.65566452,t20:3.305718774):5.10379437,(t21:6.949366296,t22:6.78030783):1.361915371):3.679272548):15.27621827):2.345738832):2.161471582,(((((((((((t23:0.4995966525,t24:0.4782478339):3.13956809,t25:3.605957966):0.02713758955,(t26:1.237083229,t27:1.133518135):2.304052016):2.140541913,(((t28:0.2825196497,t30:0.1393834962):1.734700358,t31:1.815998228):1.450945996,t32:3.178213663):2.054714541):3.81756901,(t33:1.564316482,t34:1.542885695):7.463156421):1.332871723,t35:10.16593502):3.037443485,t36:13.05472808):11.9858731,((((t37:7.041972213,((t38:3.684755042,(t39:0.1350188908,t40:0.07432233227):3.403738289):0.2036350212,(t41:3.430577909,t42:3.192177821):0.2321296768):3.120016155):2.93810391,((t43:2.91448031,t44:2.765575921):2.375419419,(t45:3.36814535,t46:2.953190559):1.701429353):4.021268666):4.072342013,(((t47:8.394782965,(((t48:2.5439469,((t49:0.9295557271,t50:0.8883236269):0.4231804701,(t51:0.6609263246,t52:0.6271844765):0.3193884338):1.139503109):3.669681402,(t53:2.362577512,t54:2.281985952):3.327231258):0.2187531481,(t55:4.885716006,(t56:3.425951453,((t57:1.352676464,t58:1.321352009):0.8506976864,t59:1.858202317):1.183776111):1.452086363):0.9280604731):1.952769045):0.3859084515,t60:7.633907632):1.082974954,(((t61:1.125349201,t62:0.9979261181):2.97271323,(((t63:1.116938553,t64:0.9867053103):0.8718971314,t65:1.781845822):1.074199225,t66:2.790020773):0.9024734258):2.246295381,t67:5.814556419):2.292726785):2.748563486):3.053830582,(((t68:6.146531971,((t69:4.2812816,(t70:1.553766668,t71:1.529294715):2.719669122):0.354204317,(t72:3.695846695,t73:3.642856638):0.5861335065):1.395424474):1.851946432,((t74:0.7695194183,(t75:0.3476329096,t76:0.2088894103):0.41029697):3.791469419,(t77:1.319287609,t78:1.290916276):2.963764061):2.882347946):4.915055875,(t79:4.640151605,(t80:0.2218869661,t81:0.2187725363):4.396539719):7.319353183):0.950694796):7.877088054):2.57821351,(((((((t82:2.405749274,t83:2.19554112):3.445411435,(t84:0.6037972976,t85:0.5104386803):4.46517873):0.09064439535,t86:4.99279186):2.51011721,t87:7.287020392):1.501028574,(((((t88:1.677234909,t89:1.670051251):0.4094407973,t90:2.012645932):0.3801669046,(t91:2.206864835,((t92:0.7685861452,t93:0.7537972298):0.3964764106,t94:0.5871686607):0.9533308131):0.1104560813):4.397491371,(t95:4.122696559,((t96:0.3891359394,t97:0.2948602902):1.147086551,t98:1.428153778):2.547618937):1.885078142):0.5393746474,(t99:1.681535892,t100:1.657207995):4.700514142):1.376975934):10.04543868,((t101:7.859098864,(t102:1.11148815,t103:1.013040996):6.538112426):1.001079708,(((((t104:0.4494591179,t105:0.4479416516):0.2340214753,t106:0.3233863416):2.142169921,t107:2.317857256):2.887475926,(t108:0.1563840668,t109:0.12155549):4.96646129):0.675531918,(t110:3.399291489,(t111:2.228098687,t112:2.222782394):1.164163823):2.305475124):2.085678879):8.851944183):2.480950599,((((t113:6.776571363,(t114:1.590140873,t115:1.334755671):5.101496205):1.731188256,t116:8.156360974):4.854264894,((((t117:1.71209413,t118:1.695361944):2.637173262,t119:4.285540123):5.847262829,(t120:7.524231266,((t121:0.06676926429,t122:0.04007539165):3.363591695,(t123:0.4555413375,t124:0.4293071392):2.855838324):3.788461743):2.277820601):1.855779235,(t125:4.535507539,t126:4.530725986):6.646217475):0.9140398679):4.759483756,(((t127:0.08145183518,t128:0.06162279758):6.719224444,((((t129:0.7672384953,t130:0.7550089154):4.657451475,((t131:3.047031006,t132:2.810711361):1.148494051,((t133:1.609384601,t134:1.515828705):0.7123906037,t135:2.194880363):1.506582078):1.099882328):0.2220255237,(t136:0.1956218746,t137:0.1499630677):4.745914177):1.075805647,(t139:3.747007977,(t140:0.4132641935,t141:0.3602433469):3.215514148):1.600914733):0.006469463872):6.212025641,((((t142:5.231658056,(((t143:0.2698003657,t144:0.2232357079):0.01559370207,t145:0.2251310543):2.990936683,((t146:1.059279724,t147:0.6879788082):0.6714043946,t148:1.359009388):1.408005523):1.88316509):1.476707134,((t149:1.92343803,t150:1.90501996):2.119809544,t151:3.978622622):1.915125631):1.957284539,((t152:1.426165707,t153:1.174201988):6.020232835,(t154:1.044586856,t155:0.9645713413):5.896902095):0.2519837245):1.772462121,(((t156:1.67058901,t157:1.606792446):3.266495821,t158:4.819167293):0.8881272524,t159:5.625034214):2.811981248):0.5494722724):3.781366227):0.8105494324):0.6694391147):0.1441835706,(((t160:3.394964029,(((t162:0.6437215566,t163:0.6407788763):0.5534852301,(t164:0.1998574043,t165:0.1461780479):0.9638833199):1.043363004,t166:2.102622658):0.6271848701):2.500487492,t167:4.988696053):8.027686411,(t168:11.85355678,(t169:0.5737148007,t170:0.4883506923):11.2120951):1.129916028):0.4508780513):0.9617947339,(((((((t171:1.564608577,t172:1.562307478):6.858794869,t173:8.417463961):0.3548852412,(((t175:1.104170635,t176:1.06578922):0.03420632103,t177:0.9277617639):1.038616277,(t178:0.980156198,t179:0.9784165461):0.8208568853):6.457483896):1.421480705,(((t180:4.86172235,((t181:4.221760414,t182:4.023018632):0.3360713853,((t183:2.099656339,t184:1.998967191):1.584882066,t185:3.461312548):0.5989447904):0.2736274709):1.428265305,(((t186:0.2161867132,t187:0.1770567184):3.184660085,(t188:1.384232191,t189:1.331849426):1.572001034):1.966069958,t190:4.500689327):0.2792518408):0.2355466707,(((t191:1.204711861,(t192:1.099262991,(t193:0.8387172414,t194:0.8233233295):0.09027960169):0.09206501451):1.874702946,(t195:1.352521438,t196:1.348971302):1.459565208):1.345668843,(t197:3.861826581,t198:3.67565431):0.25679145):0.5724696261):3.134560943):0.6245734232,(t199:4.278526462,(t200:3.380968275,(t201:2.020545994,t202:1.98725309):0.9616531837):0.8638466897):3.951542324):1.271218464,((((t203:5.043206821,((t205:0.9871667417,((t206:0.2357355613,(t207:0.1121705312,t208:0.07599143058):0.06214312302):0.4345421632,t209:0.4392093732):0.1138919046):0.1887732775,t210:0.7116157219):3.548044017):2.67839211,((t211:3.595720323,(t212:1.449552199,(t213:0.9672464591,t214:0.9468516854):0.4770257655):2.027603227):2.543420371,((t215:2.831861777,(t216:1.79673414,t217:1.638854162):0.9052568254):1.292774382,t218:3.83264001):1.809270998):0.7168946261):0.3275789918,(((((t219:3.178671216,((t220:0.7067333302,t221:0.610773509):2.044506792,t222:2.65275762):0.353631694):0.6218544377,t223:3.52583144):0.5318894407,t224:3.804930529):1.101219726,(t225:3.31256459,t226:3.296372718):1.526802352):0.4810823043,(t227:1.669494819,t228:1.645713623):3.36244023):0.7408265617):0.5779488002,(t229:4.88401211,(t230:2.350816081,t231:2.136335771):2.397731391):1.305126188):0.3750978618):0.6634963181,(t232:5.2713962,(t233:1.137215637,t234:1.1181108):4.105964518):1.45634976):1.408442278):1.816687251):0.4803504089):0.06077413915,(((((t235:1.213365767,t236:1.21267609):0.3159153199,t237:1.476873621):3.72061952,((t238:0.4474394179,t239:0.1915179158):3.282696992,(t240:2.285634653,t241:2.11982698):1.051140925):1.44658318):1.093846679,(t242:0.2777590238,t243:0.2585439262):5.24953407):1.951236206,t244:7.306974861):2.115210485):0.618251037,t245:10.00640116):0.4102029427,(((t246:3.426763134,(t247:1.319214945,t248:1.150267104):2.104059741):1.630199475,(t249:2.027567512,t250:1.828238784):2.671032133):3.347737135,t251:7.754316399):1.964032298):0.0958022352):5.18845829,((((t252:2.857097755,((t254:0.925466163,t255:0.9237999999):1.500974547,((t256:1.380203654,t257:1.352262089):0.5658160995,t258:1.914147687):0.4689146597):0.02564918395):0.492171903,t259:2.724001903):6.233855563,((((t260:2.077740089,t261:1.714161184):0.9264737059,((t262:0.8046428802,t263:0.6969185367):0.2167456102,t264:0.6467284757):1.576155429):3.553094893,((t265:3.567544274,(t266:1.441795027,t267:1.232023146):1.874876561):1.173580034,t268:4.265091951):1.018751848):2.060775831,(t269:5.697316274,t270:5.610503835):1.524656366):0.2301605938):4.918123966,((t271:0.1744131738,(t272:0.02216412884,t273:0.01638895751):0.1280267147):11.30666333,t274:11.43272191):0.7035370709):0.4585483299):0.05488653449):2.936650211):2.034265385):1.878158055,t275:19.49200315):1.431555772):0.5363205785,((t276:1.615597195,(t277:0.5203262333,t278:0.4560294537):1.080722971):4.906334747,(t279:3.742259712,t280:3.729479803):2.438012498):14.77837838):6.035559031):1.54630824,((((((t281:2.03651461,t282:1.926485479):5.248911558,t283:7.12412251):6.338928313,(((t284:3.006563958,t285:2.846841969):0.1921900133,((t286:1.191005757,t287:1.136148814):0.9675378516,(t288:1.225602686,t289:1.213619314):0.8771446092):0.6190097115):5.969886943,((t290:4.007643307,(t291:2.701830769,((t292:0.9055262805,t293:0.9009155991):1.166484356,(t294:1.177630291,t295:1.067423575):0.4449091441):0.5800077448):1.213263272):1.526081831,t296:4.812210729):3.126990214):3.776440021):2.032069306,(((t297:10.0805188,(t298:3.892235673,t299:3.832470676):6.122080191):2.135467536,(t300:4.976014974,((t301:3.436720166,(t302:0.1279924769,t303:0.0109607383):3.278015188):1.102847206,(t304:0.5226052097,t305:0.4629710201):3.693039535):0.3964765293):7.102925815):0.8979290948,(t307:1.340214193,t308:1.316349287):10.54789981):0.5884007777):2.518094726,(((((((t309:3.80710746,(t310:3.558993115,(t311:0.7237682902,t312:0.6569486177):2.724669926):0.2385318529):0.4077902041,t313:3.916714556):3.479523823,((((t314:0.1033012256,t315:0.01782342639):0.5485339193,t316:0.4623869461):0.51469081,(t317:0.3106278546,t318:0.2542663488):0.5570105112):4.207223639,t319:4.914139397):1.952657608):0.5067969958,((t320:1.004160148,(t321:0.8484448995,t322:0.8422044343):0.08805604247):2.876248239,(t323:3.194431659,t324:2.847899581):0.4315093245):3.314865288):1.328879159,(t325:2.942601327,(t326:2.157340738,t327:1.955649511):0.7808112278):4.653817573):0.04839798539,(((((t328:1.588629851,t330:1.460947938):1.096950827,(t331:2.393711421,(t332:0.1780987276,t333:0.1236985104):2.082395025):0.02675660621):0.1536642475,t334:2.383148008):0.6326707149,(t335:2.316950074,t336:1.864184849):0.694613364):2.296889389,(t337:0.9656497842,t338:0.8979790007):3.819636151):1.427887564):3.626880179,t339:9.649310863):1.735451834):2.800804417,(t340:1.213008248,(t342:0.334931521,t343:0.3071514008):0.7821944059):12.96246904):7.539077524):0.3995866765,((((t344:2.65375515,t345:2.53100377):0.3179290288,t346:2.703507495):1.569335784,((t347:3.065320647,(((t348:1.069621552,(t349:0.9913773916,t350:0.8379506774):0.06825829389):1.827052107,t351:2.714676577):0.07142837766,(t352:1.577517772,t353:1.565898531):1.20826376):0.03650142165):0.6484488318,t354:3.10130433):0.4416831287):4.756855389,(t355:5.392966002,(t356:1.284307661,t357:1.220119698):4.101268478):2.897688404):12.62419249):31.0357293,(((((t358:0.8310107147,t359:0.8218511828):7.411912073,(t360:5.570752615,(t361:1.091822355,t362:1.078527481):4.401717874):2.623484778):2.0452609,((t363:0.7740161517,t364:0.6142160911):5.376052412,(t365:0.2419588103,t366:0.1360262459):5.377566446):3.925761165):0.3488110032,(((t367:7.936572476,((((t368:0.4896550315,t369:0.3799916544):2.404009264,t370:2.310940207):0.7107508899,(t371:2.39219386,t372:2.178231878):0.6067668823):3.421400515,(t373:2.695680356,((t374:1.71989712,t375:1.71582689):0.7959892768,t376:2.498500521):0.09722228901):3.395400696):0.9098825747):0.3550491466,(t377:2.677492779,((t378:0.487346501,t379:0.4057588786):1.82237988,t380:2.02056066):0.3213399):4.556275548):0.2916192022,t381:7.147646188):1.06450387):32.55945999,(((t382:1.653846675,t383:1.648793569):12.59250048,t384:14.03236626):7.867458082,(((t385:13.20855217,((((t386:2.591824618,t387:2.347444508):0.3435842435,(t388:1.496909295,t389:1.412248683):1.158418124):1.816237399,(t390:3.346520932,t391:3.295590698):0.7275028221):3.964871743,((t392:0.869001274,t393:0.6825491129):4.665104829,t394:5.293173873):2.374334506):4.429540515):2.516470944,((t396:1.193039029,t397:1.12484214):11.86648805,t398:12.90356169):1.323342047):5.265511422,(t399:10.47243419,((t400:7.091598768,(t401:6.527034431,(t402:1.750857515,(t403:1.370101408,t404:1.282470815):0.1895292601):4.754475755):0.4367619022):2.232011202,((t405:1.095480893,t406:0.9686724791):3.384860624,t407:4.218835944):4.41486769):0.9160961559):9.015800332):0.8804965327):18.64848039):8.622354297):40.94825764):166.2616639);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T60.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
