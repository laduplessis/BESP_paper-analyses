<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t475:1.679601835,t476:1.556309384):1.315190591,((t477:1.153187146,t478:0.9887636078):0.7262121536,t479:1.628246286):0.9052080451):54.08487208,((t480:8.887257064,(t481:5.869973415,t482:5.763409724):2.923539761):4.071872411,(t486:7.142616213,(t487:3.824714046,(((t488:1.281242636,t489:1.260736343):0.03188556796,t490:0.7982171786):0.6919810508,t491:1.480984348):1.681872717):3.002219704):4.89343171):43.64731451):9.501846993,(t492:35.95157856,t493:35.88695935):28.13188308):57.96251589,(t494:1.33242402,((t495:0.6817171421,t496:0.09849429793):0.5880654954,t497:0.6292206037):0.05961854729):120.6449023):304.608239,((((t499:8.34073075,(t500:2.453934478,t501:2.158853043):5.88566357):1.049055393,t502:9.013833601):4.319240759,((((t498:0.4360542014,((t483:0.4579945651,t484:0.4576824258):0.07589958073,(t485:0.1890181484,(t467:0.03966516185,(t442:0.05256455305,(t425:0.4263632307,((t348:0.4914003504,(((((t172:0.142676952,((((((t100:0.2470426742,(t60:0.08066449516,(t33:0.007931997963,(t1:2.203550978,t2:2.151657485):1.605050551):2.93462557):3.386878049):0.01410553614,(t3:6.401906937,(t4:4.909837151,(t5:2.448870192,t6:2.354272321):2.274627557):1.412468265):3.583380927):3.93439609,((t7:7.507178182,(t8:5.454080636,t9:5.164636201):2.032648126):3.693912951,((t10:6.391817925,t11:6.339517436):2.451815396,((t12:3.670740423,t13:3.479301155):0.6675282432,t14:4.045431426):4.447737493):1.998464286):2.09591673):0.5023647793,(((t15:1.64420934,t16:1.245009495):2.112393722,t17:3.353098349):8.679819483,(((t18:1.210980387,t19:1.05535425):3.475516559,(t20:3.213798783,t21:3.212433501):1.307914638):6.883588401,(t22:10.18711916,t23:10.08257104):1.210071576):0.4395381072):0.6381296565):1.970551444,((t24:11.83246821,(((t25:2.470158976,t26:2.378732134):1.257150304,(t27:1.006785738,t28:0.531868363):2.584522525):3.116545999,(t29:2.355035855,t30:2.268441977):3.647807544):4.706870285):1.536272981,(t31:5.188016831,t32:4.965560349):6.912546066):0.9216462857):1.052025621,((((t34:4.659359886,t35:4.598404857):1.442403153,t36:5.998982945):4.941391532,t37:10.81951855):2.556776125,((t38:6.745560035,t39:6.714274248):1.05232242,(((t40:1.495973889,t41:1.256340326):1.539189761,t42:2.72595092):3.834098607,(t43:4.909663595,t44:4.821765223):1.589167382):0.8627203353):5.352103491):0.1802334642):0.2399959169):5.99916069,(((((t45:2.552190182,(t46:1.424760391,t47:1.209501141):1.071239259):2.171678417,((t48:0.3515787928,t49:0.2942016658):3.711187447,(((t50:2.684567369,((t51:1.178730587,t52:1.156837511):1.364254026,(t53:1.129615401,t54:1.025982719):1.328013102):0.1075199549):0.4579159371,t55:2.887723398):0.1633226263,(t56:2.068926703,t57:1.650234441):0.7063837249):0.6936793854):0.3576777284):1.478844876,(t58:4.513527885,t59:4.342916481):0.3656201822):0.8223258381,t61:5.067884966):1.961324277,t62:7.02814261):10.04304534):0.7543822223,(t63:2.650951233,t64:2.57542479):15.12225254):3.912286969,(((((((t65:3.824605384,(t66:1.032809436,(t67:0.8897897966,t68:0.8779179581):0.1065990976):2.742347267):1.655569655,((t69:1.78234803,t70:1.730708452):2.696690668,((((t71:0.1536660319,t72:0.1389170763):1.474791758,t73:1.608268845):1.506769337,(t74:2.292880203,t75:2.183398845):0.7510245592):0.09644272205,t76:2.962838276):1.081542431):0.8858376177):0.5102265367,t77:5.34105169):5.411103495,(t78:2.455296594,t79:2.400491638):8.255348631):1.717538075,t80:12.03663197):0.9242317093,(((t81:1.226463805,t82:1.167174167):1.126393204,t83:2.224821538):7.417701315,((t84:3.360511964,t85:3.311442559):5.605788539,t86:8.887703684):0.3272825954):3.173371946):5.552490949,(((t87:7.081730492,((t88:5.913239129,(t89:5.603231612,(t90:3.496984232,((t91:0.4211057908,t92:0.4122899998):1.83603448,(t93:1.260021364,(t94:0.4071615302,t95:0.366563954):0.6922347798):0.9626163671):1.127102541):1.826474224):0.09074230133):0.7182548931,((t96:0.3565287746,t97:0.343846624):0.8687236633,t98:1.199691039):4.47450122):0.3678705903):7.394104643,((((((((t99:2.914592264,t101:2.576043086):1.367494159,(t102:0.3273223883,t103:0.03419020007):3.495880278):0.8195662939,((t104:1.526271632,t105:1.4254133):2.210756301,t106:3.402152882):0.319238767):4.274616922,(((t107:1.594252248,t108:1.407597737):3.040912595,t109:4.343615611):1.064317593,t110:5.300537258):2.274278443):1.125337738,(((t111:3.234762538,t112:2.918111892):0.2184121827,t113:3.124676479):2.758333344,(((t114:0.8351044501,(t115:0.3907785311,t116:0.3040799636):0.3697050392):2.253929076,t117:2.910030962):2.580369954,(t118:2.956160722,t119:2.955252947):2.446760695):0.08644020357):2.462161183):0.5522358153,(t120:7.378064153,(t121:3.274294787,t122:2.812590303):4.085665165):0.9546505376):0.7766335638,((t123:5.436348243,(t124:3.987482389,((t125:1.788279962,(t126:0.1355493181,t127:0.01331456014):1.397784008):1.767837268,(t128:1.95747136,((t129:0.7372993261,t130:0.737038329):0.6257946976,t131:1.269938818):0.4598072097):1.166446223):0.420996985):1.417751108):0.4249550688,((t132:0.2417118114,t133:0.09140270465):4.448436738,((t134:1.394265746,t135:1.370913315):1.302746761,t136:2.569240273):1.789188971):0.2480777986):2.752845222):0.6571716382,((t137:2.553067122,t138:2.433495154):4.622408359,((t139:4.913317669,(t140:4.093429289,((t141:1.183155692,t142:1.030205853):1.405618501,t143:2.401277651):1.491556442):0.8037915473):1.851504882,(t144:1.121402768,t145:1.032346797):5.266391292):0.2796685953):0.8376243685):0.825860697):1.229179859,t146:9.456058222):2.231764748):1.865490426):4.44326454,(((((((((t147:2.061631779,t148:1.791235781):1.478241913,(t149:1.474605865,(t150:1.39923258,t151:1.381250433):0.0136640022):1.752786576):1.784907611,(t152:3.785740941,t153:3.677248186):1.103023833):2.946328975,(((t154:5.115500604,((t155:4.491221158,((t156:1.460318443,(t157:1.273542791,t158:1.264026822):0.1351989988):1.33636087,(t159:0.7251254753,t160:0.6444821474):1.962389857):1.246648111):0.4687557363,(t161:1.379750954,(t162:0.2385364848,t163:0.1444072754):0.9559444066):2.817843317):0.10295088):2.226392685,(((t164:0.1868290465,t165:0.1822892615):3.424250898,t166:3.552547326):0.6443588536,(t167:2.585224198,(t168:1.72641301,(t169:1.341952279,t170:1.182762017):0.1971008834):0.8020049128):1.50780804):1.979377047):0.1544477103,((t171:1.466136642,t173:1.214088113):0.3727777841,t174:1.335613746):3.90095747):0.1960137979):5.337165806,((t175:6.703440873,t176:6.660233199):1.998065843,t177:8.351608153):1.9385834):1.64046053,t178:11.85447334):0.7337619767,((((t179:3.211202085,t180:3.198718608):1.934688586,t181:4.732734429):3.293751167,((t182:2.897629943,t183:2.82884087):1.215531945,(t184:1.148404909,t185:1.004962355):2.804742559):3.654982274):1.744966051,((t186:0.7742547256,t187:0.7286320993):7.882633949,(((((t188:3.230288388,(t189:0.9389169792,(t190:0.1378881308,t191:0.1171463533):0.7565067553):2.09579981):0.7587037662,(t192:3.483507379,((t193:2.22348932,t194:2.210268146):0.1729719383,t195:2.323029051):1.079637141):0.2029089789):0.5741643772,t196:4.101155295):0.2542981664,t197:4.209469578):2.045959579,(t198:5.800509196,(((t199:0.7174278383,t200:0.6346277079):0.7882946733,t201:1.277601218):0.3968362575,t202:1.582538003):3.854999351):0.4210359583):1.741877956):0.5082271601):2.384745627):0.05108400015,(((t203:7.213901702,((t204:5.022098745,(t205:2.863910501,t206:2.852005243):1.681760207):0.6668519698,t207:5.199876306):1.488722352):1.649348037,((t208:4.76692969,t209:4.671217188):0.3956446403,t210:4.958574908):3.031143955):0.4200204468,((((t211:0.8874294832,t212:0.8819993259):2.10528423,(t213:2.839130475,(t214:1.135073381,t215:1.008257023):1.564095583):0.1296446994):1.084148693,((t216:1.027362157,(t217:0.2778957035,t218:0.1137370943):0.7084713416):2.057731114,(t219:0.5510062716,t220:0.3213703042):2.282327655):0.6068392208):0.8871561236,t221:4.092706621):3.392508747):1.236600103):1.256603844,(((((t222:1.520576453,t223:1.357668244):0.4784769395,(t224:0.3034123863,(t225:0.08297129732,t226:0.0411084682):0.06189172341):1.442298666):1.15466491,((t227:1.287023711,t228:1.268096969):1.044605475,t229:2.260839392):0.3068569909):3.092671513,(((t230:3.245256639,t231:3.21600456):0.5764755295,t232:3.790404172):1.446172833,(t233:2.162582413,((t234:1.530318416,t235:1.471400592):0.4632550776,(t236:0.8655118474,t237:0.7308097111):0.8231724951):0.1516522627):3.043376617):0.3256075206):0.08131607936,(t238:1.417872781,t239:1.308521449):3.726290738):3.598194051):0.3978730705):0.2698428357):2.624796495,((t240:4.467831387,(t241:4.221046545,(t242:3.976683705,t243:3.949009225):0.2200349314):0.1393413329):4.590995741,(t244:2.219121021,(t245:1.691810871,(t246:0.6960886041,t247:0.5248718443):0.9761249129):0.4673438415):6.674176062):2.803160703):3.626602779):1.643893497):1.721729763):1.799330759):0.2355138521):2.562405679):0.4191872703,(((((((t248:2.048991937,t249:1.923812435):1.861132231,((t250:2.506327952,t251:2.413318824):0.07098330254,t252:2.171043875):1.199406341):0.1540269015,((t253:1.728745386,(t254:1.546002584,t255:1.295240488):0.1344840047):0.8785179817,(t256:1.006959305,t257:0.915747557):1.274043761):0.8953396698):3.033698576,(t258:4.482004189,t259:4.458975909):1.433895934):1.844416167,t260:7.693319575):0.1699026894,(((((t261:0.5412225782,t262:0.3662080106):2.616088167,t263:2.973285553):2.1896535,t264:5.087695813):0.18849439,t265:5.221861848):1.61721883,((t266:1.506110034,t267:1.476905913):1.476543814,(t268:0.8878671955,t269:0.8399470183):2.030173785):3.730097467):0.6513721149):13.14123145,((((((t270:3.127064383,t271:3.04480422):2.681834282,(((t272:2.091177253,t273:1.933853186):0.2374955487,t274:2.169102919):0.2400951093,t275:2.364856621):3.06062428):0.03382421087,((t276:0.5211799682,t277:0.450097209):1.09797401,t278:1.467110344):3.695731337):1.220398546,(t279:2.49370254,(t280:0.4685034859,t281:0.3268243377):1.97919531):3.675777788):4.693668144,t282:10.64395047):7.010226953,(((t283:1.344281668,t284:1.31797356):1.400878403,t285:2.668894701):1.700451933,(t286:1.42699585,t287:1.29497967):2.807024006):13.20094543):1.511194804):1.092323927):3.155784158,((((t288:0.4366212426,t289:0.4132155319):7.035410885,(t290:0.5839629304,t291:0.5489462652):6.837465782):0.6308358226,((t292:7.122895307,t293:7.114183437):0.1787545743,(t294:6.898859718,((((t295:1.818137054,((t296:0.5375025009,t297:0.3993642961):0.6643969591,((t298:0.7034869087,t299:0.6913210335):0.2843244363,t300:0.8633801885):0.02669070903):0.5782286703):0.5097463177,t301:1.761977701):2.484927422,t302:4.234162181):1.013985803,t303:5.236511899):1.03475291):0.3063145745):0.5921632963):5.55761793,(((((t304:1.479257271,t305:1.4713693):3.220894141,(t306:3.697142306,t307:3.294652837):0.9513037915):5.754642094,((t308:3.045967965,(t309:2.197301102,t310:2.131188978):0.8266924528):5.620568407,(((t311:1.377163662,t312:1.296553541):0.6291268257,t313:1.913536148):3.536130934,t314:5.014951824):2.822524731):1.326524109):0.08923204235,((t315:0.3071465746,t316:0.2156941195):6.636293603,t317:6.729961887):2.301128218):1.868837428,(((t318:7.109501883,((t319:1.39144731,t320:1.384559038):2.789297038,t321:4.103363623):2.846774127):0.4619546324,t322:7.328843392):3.174770635,((((((t323:1.875622218,(t324:0.333161961,t325:0.2834667151):1.514868894):4.312007468,(t326:0.5779558093,t327:0.5218667005):5.39769836):0.9330870014,t328:6.74955576):0.1587345266,(((t329:0.0309206399,t330:0.002564392787):1.552556477,t331:1.54540758):3.644061852,t332:5.093334445):1.618364452):0.2865080149,(((t333:0.8564744321,t334:0.6317623229):0.1844210968,t335:0.8041358337):0.7460757491,(t336:1.168305806,t337:0.9912788145):0.1677757656):5.114367092):1.468242542,((t338:0.3379743019,t339:0.3228441778):6.514274312,(t340:1.468284654,t341:1.346949971):5.335045318):0.8852033264):1.448584005):0.1192832745):0.3022041491):9.288120658):9.7686995,((((t342:8.208159877,(t343:0.3115039927,t344:0.2780982631):7.851428466):1.421338531,t345:9.550135272):1.272143597,((((t346:0.3385008962,t347:0.3263743625):5.561286776,(t349:1.9189839,t350:1.838351448):3.372972369):0.4610442569,(((t351:2.252838883,t352:2.174379652):2.73325366,t353:4.894860476):0.4718719858,((t354:0.9944018002,t355:0.9941353689):2.768868308,t356:3.726005476):1.516581486):0.08750805185):1.778492727,(t357:2.161454422,(t358:1.119945277,t359:0.8828208737):0.9923861856):4.910572122):2.665915752):5.469814477,(((t360:7.438179849,((t361:3.858692102,t362:3.805370274):1.667770451,t363:5.463910566):1.882645106):3.052300069,(t364:2.766270013,t365:2.757187719):7.609455841):1.540381362,((((((t366:2.164991551,(t367:0.04829973028,t368:0.03644586819):1.966313528):0.9072950117,t369:2.856969487):2.769870772,((((t370:2.015346086,t371:2.004003264):0.0338319838,t372:1.956026784):0.08222841305,t373:1.942828905):0.9933905612,(t374:0.1898936205,t375:0.08900817339):2.468526176):1.954737585):0.2545242539,((((t376:0.7106749588,t377:0.7097803727):1.181940721,t378:1.864978885):1.538294392,((t379:1.828049342,((t380:0.3216151999,t381:0.2272628018):0.4889135037,t382:0.6911138618):0.8450229741):0.4018745794,(t383:0.4942595004,t384:0.4620446395):1.370758243):1.133096279):1.267489221,(t385:3.169876155,(t386:2.989598826,(t387:0.9854435825,(t388:0.06476321236,t389:0.05510367478):0.8819912532):1.845196815):0.07387099649):0.9567693069):0.03922822975):3.074364292,(t390:1.570428528,t391:1.40143985):5.274281369):0.8537989932,((((t392:1.871306092,(t393:0.9920656208,t394:0.9625512224):0.8635519491):4.145083175,t395:5.818099235):0.6384484881,t396:6.411236923):0.2541495627,((t397:3.208055134,t398:3.159311042):0.7357909857,((t399:1.393336436,((t400:0.6128571904,t401:0.6085684257):0.3521327234,t402:0.949124627):0.3878992093):0.2383741284,(t403:1.399258975,(t404:1.189493569,t405:1.165700638):0.2063863329):0.1694939806):2.259327809):2.558869894):0.4052784718):1.855787306):2.882469373):11.82174065):0.453140886):229.9959561,(((t406:17.3806285,(((t407:0.3065530414,t408:0.1754840001):8.58188483,((t409:3.419278841,(((t410:0.9831261742,t411:0.8942590598):1.324505093,t412:2.192996228):0.1053505781,t413:2.245256011):0.937725095):5.05267438,((((t414:0.9217462407,t415:0.7279248748):1.113303074,t416:1.805861567):1.561589888,(t417:3.023197525,(t418:2.596683229,t419:2.549511971):0.256799501):0.2868689012):0.5198124273,(t420:2.341491152,t421:2.238340281):1.063882964):3.93513239):0.2612578901):1.32728737,((((((t422:0.2227717409,t423:0.2113194442):0.2501370942,t424:0.4602071751):0.6980565276,t426:0.3709891968):2.958688264,(t427:0.9461916973,t428:0.6830393844):2.353320008):0.2957962837,t429:3.247107735):1.663137873,((t430:2.282388629,t431:2.12761893):0.00630812642,((t432:0.3247523745,t433:0.06392184966):1.074325375,t434:1.110721225):0.732314):2.546898851):2.694300032):7.106102162):23.48941265,((((t435:1.646367744,t436:1.609652705):4.288644015,(t437:0.2292898843,t438:0.1173477705):5.666282585):11.91648376,(((((t439:0.4832623994,t440:0.4661726115):0.5259885829,t441:0.8970810702):0.4090171974,t443:1.069815045):2.660180404,t444:3.537174415):4.964238753,(t445:4.109412267,(t446:3.393920549,t447:3.350943795):0.4794760656):4.382738053):8.621601661):3.116565625,(t448:15.93314355,((((t449:1.091506102,t450:1.071478734):4.912959632,((t451:0.5158095047,t452:0.436486124):3.837985867,t453:4.226832837):1.593694935):3.606171588,(t454:0.1465991871,t455:0.1186500103):9.251593856):4.015107034,((t456:1.928635366,(t457:0.8146371306,(t458:0.6351418598,t459:0.5613333783):0.0530573958):1.103318825):0.2057059704,(t460:0.1767320634,t461:0.1252886994):1.738513375):11.2340517):2.27035798):3.985898726):16.68392337):0.6146326238,(((t462:3.737869137,t463:3.453666667):4.321291625,((t464:0.2235795858,t465:0.2194573914):0.641942812,t466:0.8139988301):6.832129992):13.19705823,(t468:12.16886588,((t469:3.058361049,(t470:1.422844441,t471:1.34061875):1.598104444):3.777230702,(t472:2.978267702,(t473:0.9870854653,t474:0.7000129157):1.929865314):3.717373674):5.272337315):8.498802956):15.3891807):212.2597385):181.5869187);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T19.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
