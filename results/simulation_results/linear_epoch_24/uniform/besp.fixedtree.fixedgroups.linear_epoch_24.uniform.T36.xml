<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t494:2.406695306,(t495:0.7278028483,(t496:0.374168216,t497:0.3108352369):0.3223217923):1.451131611):4.107806105,(t498:0.9988457127,t499:0.7705748607):4.993619793):3.836760216,((t500:2.704740612,((t501:1.559430247,(t502:0.3856142426,t503:0.3853985078):1.145606582):0.364447303,(t504:0.4901226747,t505:0.3659544366):1.369212121):0.5332537366):0.9281269776,(t506:0.1313278119,t507:0.1082409549):2.934051236):5.962656232):6.907243972,((t508:3.876638229,t509:3.851872241):9.24837243,(((t446:0.02293464884,(((t420:0.02386712431,(t395:0.08946142528,(t382:0.07745301041,(t332:0.02244038037,(t326:0.0472696887,((t216:0.1074091557,(((t1:3.493265282,t2:3.441131057):8.141144776,t3:11.51978463):1.808343223,((t4:4.501820836,t5:4.468522951):2.333685826,((t6:4.061143546,((t7:2.139898363,t8:1.788747441):0.6209345218,(t9:1.425809821,t10:1.253148186):0.9570990436):0.9548951265):0.631175691,t11:3.752505392):2.072524804):6.366185995):6.119094151):0.8330268059,((t12:3.300494007,t13:3.232573567):12.49245092,t14:15.35232525):3.32696397):10.45542178):0.344090013):4.782044473):1.416810515):2.622265795):0.5161055022,(((((((t15:3.80166793,(t16:0.784494978,t17:0.7369653593):2.857006579):2.349038266,t18:5.904266296):3.034121721,((t19:7.155627338,t20:7.127427514):1.184574353,((((t21:1.500738271,t22:1.453031478):1.04223756,(t23:1.848849266,t24:1.832087417):0.4582097739):3.197262775,((t25:3.661993662,(t26:2.176187853,(t27:1.042432327,t28:1.017835401):0.8156975127):1.389245508):0.1710872348,t29:3.320597051):1.594108595):1.079689803,(t30:4.283015349,t31:4.273071016):1.683176687):1.456298241):0.5679477924):1.955870919,(t32:6.155730046,((t33:0.9114319393,t34:0.5782163697):0.7844568172,t35:1.355143291):4.370214725):3.778637059):17.61661767,(((t36:15.10717734,((((t37:3.301953517,t38:3.276261341):1.10962644,t39:4.334091309):0.2318118267,(t40:1.040354229,t41:0.9547190339):3.019540467):8.394005754,((((t42:7.121105501,(t43:4.017120333,t44:3.723503881):3.042822338):1.618980138,(((t45:1.286026164,t46:1.231309275):1.426247351,t47:2.61555558):4.137461612,(t48:2.122627522,t49:2.04321626):4.519361605):1.406905974):2.293816785,(t50:8.381267351,(((t51:1.11985661,t52:1.082841529):4.732028865,(t53:0.4236925608,t54:0.2812438668):5.37116326):0.695184975,(((t55:2.757563724,t56:2.644341259):0.2817688435,t57:2.826542307):1.753467526,t58:4.431881982):1.506798533):1.663371315):1.753524372):0.6695783626,(((t59:1.318417889,t60:1.183832546):4.145353416,(t61:0.9781201983,t62:0.9310946081):4.257312644):0.00748030978,(t63:1.447623048,t64:1.336449481):3.663373109):4.552930469):0.6256099894):2.03789735):2.224255099,(t65:12.33659772,((((t66:4.847630928,((t67:2.444892701,t68:2.312088433):1.464146258,(t69:0.4293893063,t70:0.2302222978):3.336404959):0.9170846334):2.113893059,(t71:0.7749107877,t72:0.708625808):5.818570699):1.111623875,(((t73:2.799687601,((t74:0.1580757794,t75:0.1219352323):0.05417725893,t76:0.1712162556):2.517829283):0.1254962543,t77:2.778768743):0.8641222711,t78:3.351620833):3.836133691):3.210992917,((((t79:0.7887228631,(t80:0.6159292519,t81:0.5550770996):0.1277897808):0.2333083027,t82:0.8792472581):0.9982730258,t83:1.835094718):4.182116047,t84:5.925451964):4.045815131):0.8678654109):2.049467027):5.842705619,((((t85:4.924544575,(t86:4.202754571,(t87:3.057853041,(t88:2.833667012,t89:2.493261557):0.2045786834):1.136927976):0.5975753763):1.670567117,(t90:2.041301954,t91:1.955057581):4.055988088):7.230655353,(((((t92:3.549302876,t93:3.495461564):0.3464239977,(t94:3.752445991,(t95:3.130055723,(t96:0.8569360591,(t97:0.05952558849,t98:0.009638369042):0.7692948633):2.232038211):0.4139667227):0.08609681943):2.019201353,t99:5.529441905):0.6533834727,t100:6.114339672):2.457577521,t101:8.44771517):4.211454033):2.634990678,(((((t102:3.393631174,t103:3.325463314):3.105898667,t104:6.268452772):0.4580270656,t105:6.716344302):0.1508647135,((t106:5.128258713,t107:4.912513204):1.281568837,((t108:0.567137271,t109:0.3813524989):0.8485228023,t110:1.171628693):4.695780815):0.4261749312):7.263873836,(((((t111:0.1824640682,(t112:0.1729101712,t113:0.1597174943):0.004389547103):4.106826927,(t114:2.735788365,t115:2.724950209):1.521065535):3.755639903,(t116:3.194155393,(t117:1.01033999,((t118:0.0552581703,t119:0.02521084907):0.1731610847,t120:0.1931859148):0.7716485574):1.931363722):4.505346718):1.754896709,t121:9.137775986):2.633262787,(t122:5.576896002,((t123:0.5597055602,t124:0.4180037986):0.8738372017,(t125:0.9783300765,(t126:0.1304563716,t127:0.01656527672):0.5276862046):0.309450172):4.035305508):6.168000249):0.9548619266):0.7534863231):2.097375477):3.863850929):1.228387864,((((((t128:0.4452633274,t129:0.4379215397):0.8311423799,t130:1.188931435):4.1661387,((t131:1.120668043,t132:0.9082456582):2.535765853,(t133:3.041766214,(t134:1.774774082,t135:1.661191256):1.241602311):0.3963821863):1.618039092):3.510281382,((t136:0.6570376566,t137:0.6250094737):5.973668457,(t138:5.925971785,(t139:1.206699354,t140:1.081001972):4.570758008):0.5489139051):1.75973775):5.89213389,(((((t141:4.257568293,t142:4.177291611):0.6322079884,(t143:4.699359674,t144:4.69934765):0.0346247737):0.3084204802,(t145:2.379275212,t146:2.320325829):2.193249955):5.62491935,(((((((t147:1.419816004,(t148:0.4608542468,t149:0.4267439806):0.9579545667):2.445013723,t150:3.763897155):0.1061752252,(t151:0.8188464541,t152:0.8101792226):2.929084699):0.985236044,t153:4.569165114):2.463642938,t154:6.97997706):2.150395915,(((t155:4.014328139,(t156:1.580646661,t157:1.19812367):2.38048328):2.847611804,(t158:5.572857424,(t159:2.076378243,t160:2.04746016):3.422548439):0.8092646212):0.05158327599,(((t161:0.8441701427,t162:0.8240179381):0.05745401464,((t163:0.1672472799,t164:0.1547201125):0.3886601344,(t165:0.2701604972,t166:0.2675613202):0.09879794111):0.1769026637):0.1031546267,(t167:0.3377068142,t168:0.3037191333):0.3077414727):5.309565029):2.176833302):0.1970495128,(((t169:0.6081520283,t170:0.5840564767):0.2392951929,t171:0.6230030959):3.769431803,t172:4.288560607):3.58737261):0.2663547489):1.646815304,((t173:4.215012245,((t174:1.371878442,t175:1.236430205):1.564794311,(t176:0.4155303099,t177:0.2071474021):2.378912738):1.047520134):3.660334634,(t178:1.10392372,t179:1.078664075):6.15406113):1.845372064):1.132161725):3.593707707,(t180:12.66605997,((t181:1.848339302,t182:1.813905479):6.119583123,(t183:6.657367059,(t184:3.250251385,((t185:0.2284752151,t186:0.1369526347):2.798620198,((t187:0.7106962972,t188:0.650326917):0.08961832493,t189:0.6917992404):1.998986644):0.1539882076):3.394531278):1.238933625):4.664606159):1.115327528):1.484110164):6.369000734,(((((t190:9.996347619,(t191:1.144713381,(t192:0.1209752331,t193:0.08708616617):0.8568102189):8.813421557):6.81546704,(t194:3.740199265,(t195:2.031912822,t196:1.997062461):1.679911346):12.73183221):0.06258443609,((((((t197:0.1449716171,t198:0.1394276959):0.7148833922,t199:0.783912858):9.272598197,((((t200:1.626383452,(t201:1.113599547,t202:0.8663760489):0.5076536566):7.932019137,t203:9.26672899):0.008195753064,(((((t204:1.524426306,t205:1.484398419):0.342220875,(t206:0.5260096176,t207:0.4671174728):1.013433149):1.869699335,(t208:1.188671219,t209:1.137447265):2.149370316):3.705198068,((t210:2.858630545,t211:2.783455057):1.20036121,t212:3.908418042):2.821543798):0.3935638105,(t213:3.043818781,t214:2.781404449):4.029217006):1.330377623):0.1696419737,((t215:2.304766209,t217:1.950355464):1.562939422,((t218:0.3387891355,t219:0.1765216075):2.246462885,t220:2.369838485):0.6349245704):4.435677689):0.2839773798):3.324552164,((((t221:3.513541389,(((t222:0.6701944458,t223:0.6132447013):1.816777713,((t224:1.595142761,t225:1.543778785):0.4700463635,t226:1.95018551):0.3064310258):0.8188572307,((t227:0.4472407696,t228:0.2488376347):1.885306296,t229:2.090223537):0.7357152456):0.07027407724):3.543153548,(((t230:0.2509100774,t231:0.0796001401):3.776834556,(t232:3.721291579,((t233:0.448590938,t234:0.4334502392):2.21619789,t235:2.553702956):0.9522974624):0.1338385765):2.061497801,(t236:3.135247152,t237:3.1255133):2.300910307):0.2778384583):1.851843178,(t238:5.412028374,((t239:3.975866961,t240:3.64898271):0.7213043713,t241:4.111778805):0.6604515606):2.001560411):0.9447833391,(t242:4.536811718,(t243:2.905931523,t244:2.765721043):1.593870355):2.994704337):0.9104688044):0.8841755702,((t245:5.448535089,(((t246:1.704590274,t247:1.509100112):1.646979008,(t248:2.820307226,t249:2.810942323):0.1119212304):1.03841844,(t250:0.9425978584,t251:0.9379742614):2.98490134):0.8361454394):1.105363165,((t252:0.4357809891,t253:0.3252294302):1.910185462,t254:2.096978484):3.408094566):2.586648011):1.42906433,(((t255:0.2682664109,t256:0.1022237808):4.524250399,(t257:0.6189677849,t258:0.3073935707):3.808397571):2.59530203,((t259:4.650035013,(t260:1.07800274,t261:0.9713158914):3.532147521):0.9641016717,t262:5.431272301):0.9008154103):2.056851146):0.5721315236):1.997394738,((((t263:2.25752507,(t264:2.064656852,t265:1.801065322):0.04118050924):3.435200384,((t266:0.8538276479,t267:0.8261608636):0.502453491,t268:1.296745108):3.749285844):3.002285173,(((t269:0.4161812771,t270:0.34434259):3.963627545,t271:4.229781492):1.958044564,((t272:0.2277341919,t273:0.2059557275):1.150793805,t274:1.191533944):4.637965806):1.694884649):1.737359845,t275:9.237658384):0.515722634):0.4765933711,(t276:7.174940381,(((t277:0.1477605535,t278:0.007066047007):1.542974591,(t279:0.07993106233,t280:0.04830852352):1.164359341):2.49267452,t281:3.615860682):2.874147096):3.017436143):1.584062686):2.361493123):1.488896891,(t282:10.758949,((((((t283:2.424294084,(t284:1.74492631,t285:1.733846943):0.4912617296):2.048865931,t286:4.251743097):3.058513184,t287:7.251555656):0.3160158526,t288:7.406101536):1.317951045,((((t289:0.0199402376,t290:0.01516863945):0.9018542772,(t291:0.6887783226,t292:0.6599343777):0.2279378495):5.056927557,(t293:1.795240897,t294:1.790507736):4.040154009):2.138747271,(t295:2.131679553,t296:2.022258158):5.791210318):0.4290354469):0.2609040639,(((t297:6.927084715,(t298:5.085919485,t299:4.977220577):1.833056965):0.42705077,t300:7.207978917):0.3093877958,(((t301:3.032358323,t302:2.970273651):1.902050461,(t303:4.495273822,t304:4.380824912):0.354722406):2.210851765,(((t305:0.2839340679,t306:0.2397173704):2.42065859,(t307:0.6794229214,t308:0.6329321283):1.866885219):1.766129261,((((t309:0.06381111678,t310:0.003485534269):0.3627225704,t311:0.170145788):0.4067899961,t312:0.5196744634):0.3168953237,t313:0.7240337581):3.078252935):2.423086877):0.2533329593):0.7343040355):1.22685511):3.832275453):0.3683544066):3.763834458,((((t314:1.90650709,t315:1.905564142):0.5007133073,t316:2.340423434):1.053891204,((t317:2.314393655,t318:2.309560984):0.3268352139,(t319:1.965116409,(t320:0.7558697959,t321:0.7162692001):1.182102039):0.6248175366):0.687083466):10.66990598,(((((t322:3.53720288,t323:3.512969359):1.851740466,t324:5.247783842):0.953557049,(((t325:1.652580001,(t327:1.368420984,t328:1.332875677):0.05294025065):1.178739927,((t329:0.5179479754,t330:0.4468117797):1.860517682,(t331:1.134410098,(t333:0.3989519753,t334:0.3414603394):0.5667514415):1.124574475):0.1635624718):1.605439149,((t335:0.2102898133,t336:0.005569306897):1.674782472,(t337:0.8989387125,t338:0.8922122268):0.6857922127):1.906612937):1.638543872):2.809938247,((t339:1.789930747,(t340:1.217995159,t341:1.17028674):0.5510008843):4.432092469,((t342:2.062515073,t343:1.939456337):2.933885439,t344:4.758878602):0.9620430995):1.632088974):3.948142578,(t345:0.9573356278,t346:0.8071682255):10.32031814):0.4632610025):2.208849001):2.188088958,((((t347:4.241024307,(t348:1.110182611,t349:1.044642677):3.044460883):6.421837536,(((((t350:0.7533809905,t351:0.6951931602):0.2164733865,t352:0.5124464322):4.767952817,(t353:4.23345873,t354:4.17019136):0.9906080995):0.2385040467,t355:5.291271413):1.353968588,(t356:1.272188278,t357:1.20938934):5.152106551):3.100789492):2.834743454,(((t358:6.667503453,(t359:3.770802131,(t360:3.652604832,(t361:2.759354787,(t362:1.186595622,t363:1.154144824):1.545772822):0.7870910833):0.05958325333):2.772731779):1.563389327,((t364:0.9794278332,t365:0.9046880059):3.598420721,t366:4.480623816):3.202340992):2.029619485,(((t367:3.473159316,(t368:0.809295448,t369:0.6880159918):2.658494453):1.200865361,(t370:2.464967606,(t371:1.629690675,((t372:0.531649269,(t373:0.2604671212,t374:0.227200872):0.1978869997):0.2203202172,t375:0.6354565412):0.8750483375):0.7860936501):1.646821053):4.693788158,((((t376:3.105604029,t377:3.092749656):1.554157948,(t378:0.5104674543,t379:0.4900420909):4.009174544):0.4068036201,(t380:1.888222839,t381:1.834462285):3.01557386):1.369000096,(t383:0.7791311946,t384:0.6221271367):5.008536522):2.077940357):0.2270251581):1.688027724):1.449436593,(t385:5.506806335,(((t386:0.08732145439,t387:0.0009803573679):2.850116326,(t388:2.027150329,t389:1.983611277):0.8024599652):0.9450319857,((t390:2.188260539,t391:2.134433833):0.8906560411,t392:2.973009995):0.5878271804):1.579150239):5.50012352):0.9197491315):12.74472896):2.688153863):5.962361832,((((t393:0.3187449066,t394:0.1443488308):10.45674042,((t396:2.95129325,(t397:1.191269709,(t398:0.8365112374,t399:0.8208943068):0.242302314):1.54494785):6.349585493,(t400:0.5725404472,t401:0.5453244844):8.348502987):0.903304717):3.512723748,((t402:9.548530502,t403:9.514873986):0.003089457245,(((t404:1.221721916,(t405:0.9777753925,t406:0.532085115):0.2086565556):6.153983661,((t407:0.8239153131,t408:0.7483950351):1.340668266,(t409:0.7794071633,t410:0.7269006638):1.187621338):4.692451607):1.446554177,((t411:3.751052674,(t412:0.1003855551,t413:0.0572727723):3.533113865):3.25284461,(t414:3.905758721,t415:3.756717062):2.896251012):1.045238345):0.6688044483):3.743708062):1.9108195,((t416:4.522536894,(t417:2.176191975,(t418:0.5752711059,t419:0.04766280211):1.442907957):2.316281391):7.295501359,((t421:0.9721126548,t422:0.963822615):8.106022429,(t423:2.363128318,t424:2.313458283):6.705664291):1.953129407):2.181766885):16.49309017):39.29469302,(((t425:18.39366172,((((t426:0.3247478838,t427:0.2869389062):3.833672101,(t428:2.03336991,(t429:0.4650873615,t430:0.2037850333):1.555629836):2.014572374):2.736582261,((t431:1.130628167,t432:0.8670709163):4.869127627,(((t433:0.09999202701,t434:0.09567975157):3.71295373,(((t435:0.2139677355,t436:0.1135647004):2.227568219,t437:2.299440911):0.2951189813,t438:2.548160412):1.004184906):1.297017148,(t439:1.160720621,(t440:0.1902923354,t441:0.09151943801):0.9111110885):3.683741092):0.524280045):0.07103469782):0.4188655052,t442:5.605680924):11.07959692):13.44340326,(t443:10.26931149,((t444:0.2553914401,t445:0.0682662485):7.558642679,t447:7.522078335):2.343681662):19.70316628):5.170009569,(((t448:1.588003844,t449:1.448734555):1.953473268,t450:3.325937785):14.82268189,(((t451:0.8946599706,t452:0.8630948757):15.21343072,(((((t453:5.375043128,(((t454:0.4416602265,t455:0.2177132631):2.481583831,(t456:1.10584317,t457:1.047215112):1.547248246):0.04567414581,t458:2.59574812):2.376974547):2.412977743,(t459:4.245057697,t460:4.206531072):3.117660065):1.834671601,(t461:1.325645076,t462:1.186203816):7.788104378):4.417842937,((((t463:0.2328113161,t464:0.232349098):0.3454979083,t465:0.5517970789):6.156188131,(((t466:1.043102026,t467:0.9241193943):1.144535859,t468:2.028943953):1.271107101,(t469:2.147204787,((t470:1.511610394,t471:1.396658438):0.04695882178,t472:1.403463423):0.5514695722):1.094360698):3.24865918):2.987295008,(t473:8.97875045,((t474:1.972454078,t475:1.667123038):1.296062073,(t476:0.6861417202,t477:0.6841952024):2.271282903):5.611920845):0.2879719246):3.441523099):0.9902245578,(t478:0.7246366584,t479:0.6143666522):12.54496946):0.9205359591):1.16691603,(t480:3.934861634,(t481:2.010311638,(t482:0.6150419657,t483:0.6090467587):1.214503964):1.900345936):11.23462771):0.7936740325):16.22534127):31.85110659):72.72648848,((((t484:1.520776835,t485:1.493110772):10.18092346,((t486:4.081916075,((t487:0.1917593425,t488:0.187335103):0.8869928223,t489:0.8274686383):2.972837192):2.450031463,t490:6.060497355):5.041777471):4.991999683,(t491:2.49304613,t492:2.418363537):13.19023225):80.03279282,t493:95.62157149):39.78889516);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T36.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
