<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t435:17.80463945,((t436:11.98643625,(((t437:7.632317508,(t438:2.52030287,(t439:0.6103752719,t440:0.5309666411):1.796516493):4.910487466):2.053765367,((t441:2.495168988,(t442:1.839609543,(t443:0.2623105351,t444:0.1681496928):1.572308327):0.6513337765):4.501530631,(t445:0.5988538198,t446:0.5606163272):6.269117428):2.176669226):2.130280912,t447:11.04953053):0.06078877302):2.465434443,t448:13.52247716):3.090276145):98.91467281,(((t450:13.09135466,(t451:3.418365051,(((t452:0.846478717,(t453:0.6423506409,t454:0.5706668434):0.144796251):1.926339938,t455:2.258144535):0.4831182974,t456:2.633198114):0.09683168631):9.360088354):23.99045005,((((t457:12.97689158,(t458:1.254434869,t459:0.8611687897):11.60135172):3.843222832,((t460:5.867555131,t461:5.576542561):5.222607655,(t462:3.693268457,(t463:2.011521432,(t464:0.5878357474,t465:0.4962062976):1.38803865):1.65192161):6.93164522):5.191038148):17.34001065,((t466:2.895085215,t467:2.876345203):7.482334129,(t468:3.24857709,t469:3.017829524):7.105919447):22.25086692):1.792482726,(((t470:2.996566591,t471:2.982135913):10.8512172,(t472:3.377891523,t473:3.165460134):10.33195884):6.436842844,((((t474:6.086747947,((t475:1.039971697,t476:1.016915875):4.133163073,t477:5.124586611):0.8401252997):2.661383047,((t449:0.281555348,((((((t294:0.006576793002,((((t234:0.06285448941,((t218:0.0102347068,((t132:0.163972937,((t92:0.1113116379,((t1:7.152444052,t2:7.116182956):2.486846384,(t3:3.71861853,t4:3.695140472):5.686739373):0.3644654169):3.642062288,(((t5:1.335709832,t6:1.21241581):3.68380459,t7:4.886558501):5.266364065,t8:10.12023748):3.039044127):0.2254150619):1.214040763,((((t9:6.908121696,t10:6.66724969):6.204946004,(t11:3.806523346,(t12:3.221375232,(t13:2.932797831,t14:2.710436897):0.1345562457):0.4249640832):8.954470066):1.262921689,(t15:6.865358415,t16:6.522007025):6.613191266):0.02214015786,t17:13.11938114):0.07776582869):6.216032958):1.591576337,(((((((t18:7.927340417,(((((t19:2.376877376,t20:2.355374491):0.5402326609,t21:2.558708969):0.8200836524,t22:3.159177592):0.5238751751,t23:3.371336066):1.999461316,(t24:4.31904264,(t25:2.422079941,t26:2.394478812):1.7336653):0.9107752109):1.555941255):1.821762893,(t27:7.064512782,(t28:1.494428736,t29:1.481079237):5.489687481):1.224010969):0.1426810658,(t30:6.785494355,t31:6.777478878):1.291315668):0.2359862756,t32:8.276883177):5.922382574,((((t33:2.362516282,t34:2.249278999):3.901564768,t35:6.120976541):1.494989949,(((t36:0.0657608934,t37:0.05057508976):0.611080552,t38:0.3026040416):6.513096814,(((t39:1.36109321,t40:1.300815544):0.05767915742,t41:1.321162334):4.558594947,((t42:4.640659468,((t43:4.04558987,(t44:1.843168645,t45:1.622467166):2.183723036):0.2544459266,t46:3.98458787):0.1412332084):0.8063433575,t47:4.731724023):0.1698271998):0.6567016862):0.2783311702):3.202396302,((((((t48:0.2391875537,t49:0.1407859118):0.176767279,t50:0.3124208821):0.4661508729,t51:0.6626518973):2.790228871,t52:3.352606021):0.3484032469,t53:3.692825827):4.764570745,t54:8.29285637):0.1073974112):3.224180385):1.950289581,((t55:1.779429072,t56:1.435198555):7.894209081,(t57:6.141827546,(((t58:0.7197239096,t59:0.6697443975):3.724398335,((t60:3.8723598,(t61:3.114048402,(t62:0.5713969954,t63:0.5217695908):2.536713499):0.6665962857):0.08296173905,(t64:2.793926063,t65:2.705864189):1.009160261):0.4371963869):1.648861278,((t66:4.14307802,(t67:2.295194039,t68:2.286568769):1.832631216):0.7908573,(t69:0.2915025076,t70:0.2390176079):4.567499798):0.7219818027):0.0226608176):3.161749124):3.873831672):1.581587467,((t71:8.725557035,t72:8.566991626):1.713986286,(((((t73:1.179471736,t74:1.168089421):1.572684441,t75:2.722204069):1.930733172,(((t76:1.653862262,t77:1.638348422):0.09138921622,(t78:0.2138325427,t79:0.1929474793):1.513200559):0.2908558959,(t80:1.327966652,t81:1.162185362):0.6587034536):2.316574815):0.1846768611,t82:4.206101874):3.063141681,((t83:0.3016260104,t84:0.207525937):4.750607648,(t85:2.566875276,(t86:0.3979267065,t87:0.358210526):2.152141194):2.08328946):2.171088162):1.848607811):3.583405945):1.26228147):0.1263387482):0.8133413808,(t88:12.19457155,((t89:4.397736869,t90:4.266054351):3.592596582,(((((t91:1.395968526,t93:1.115453777):1.890516225,(t94:0.6814245416,t95:0.6590529334):2.313433666):0.4207045279,t96:3.211623655):0.7463110473,t97:3.800823376):0.8641579397,(((t98:3.011622154,(t99:2.280817671,((t100:1.028462527,t101:1.010988196):1.225227914,t102:2.166236258):0.02522419039):0.6451064436):0.4982560591,(t103:0.8173838515,t104:0.790279348):2.441330855):0.6945083672,((t105:0.2674295021,t106:0.261496181):2.84831272,(t107:2.705701489,t108:2.673446057):0.1903392213):0.7607302176):0.4295497702):2.340527226):4.149369956):2.189880986):1.459351484,(((t109:3.889111615,(t110:1.766358612,t111:1.726031107):1.919210317):0.939900581,t112:4.500829169):6.732004081,((((t113:0.4808789625,t114:0.2695570461):5.67683021,(t115:3.433416211,t116:3.404882493):2.27059003):0.482343684,t117:5.964053801):1.928494081,(t118:4.718565814,(t119:3.038219516,(t120:0.7543615739,t121:0.7497918366):2.281114888):1.60550798):3.039430882):2.5413323):2.263672242):1.981417686,((((t122:6.38800321,(t123:4.398938991,((t124:2.618389497,t125:2.483498145):1.168796795,(t126:0.8035365957,t127:0.7857328559):2.829245407):0.5830742405):1.948748284):5.994989728,(((t128:2.385878682,t129:2.239195872):5.177535607,(t130:6.499148063,t131:6.450234343):0.7283813564):0.8674623319,((t133:6.507568322,(t134:0.9392727065,t135:0.9334278224):5.497256232):0.4192264357,(t136:5.548845304,((t137:2.473015799,(t138:1.826171379,(t139:0.7097984778,t140:0.6949181792):1.080922272):0.5784582163):2.910359096,(((t141:2.363566334,(t142:1.448985393,t143:1.356145759):0.7914131475):1.450801484,t144:3.596450652):0.5097365457,(t145:0.2736302956,t146:0.265317241):3.784961396):0.734879787):0.1050491341):1.295615039):0.8342746855):3.616809497):0.6417809624,(t147:6.85968097,t148:6.818219683):4.289549863):0.6011375323,(t149:2.621984277,(((t150:0.03242044456,t151:0.02730865243):0.5329236135,t152:0.4505103366):1.783906225,t153:2.074302509):0.2297727666):8.946126271):0.77720406):0.2386858998):5.533705046,((((t154:6.404265352,((t155:1.861438806,(t156:1.127940671,t157:1.120165711):0.6888577539):2.392793524,((t158:0.4414488204,t159:0.4189619553):2.922880293,t160:3.255811671):0.5087710271):2.073183555):3.844001022,(t161:2.897399415,(t162:0.05434064769,t163:0.0265465562):2.672829837):6.721126818):0.8657886158,(t164:1.799681106,t165:1.608465506):8.263305238):1.591452318,((t166:7.592737588,t167:7.455694835):3.600794636,(t168:8.919205049,(t169:3.519770859,(t170:1.809017916,(t171:0.3064147422,t172:0.2478673483):1.497900822):1.709548793):5.364115546):1.837071962):0.1660630697):5.050051745):1.505541403,(((t173:6.596896243,t174:6.161193482):2.432572397,((((t175:0.4656493464,t176:0.3167607026):1.272733575,t177:1.537028533):0.3309498179,t178:1.844854699):5.969165452,((t179:3.29843838,t180:3.235848942):2.742681994,((((t181:1.401174375,(t182:0.1859300559,t183:0.1718568847):1.19897016):0.9320859121,(t184:1.53635841,(t185:0.9990642581,((t186:0.2828666652,t187:0.2696070723):0.386050299,t188:0.5765707397):0.3153655394):0.2446029424):0.7582860857):0.3289802274,(t189:0.5077043355,t190:0.4988041797):1.703412282):2.65662945,t191:4.705183785):0.6356537491):1.638380481):0.462037454):4.898677152,(t192:9.801035654,((t193:3.388477408,(t194:3.171780983,t195:2.935845869):0.1545653598):4.684944955,t196:7.701455134):1.658442242):2.371961445):3.33853081):0.9268959297,((t197:4.527863999,t198:4.459321714):11.18594773,((t199:11.50833015,((t200:5.173825011,(((t201:0.1069833574,t202:0.08409755705):1.774783555,(t203:1.424636761,(t204:0.9109143738,t205:0.836298649):0.4708725939):0.3164569696):1.798451493,((t206:2.643906737,t207:2.417781356):0.335498505,(t208:0.4631254792,t209:0.4434696131):2.258051577):0.3661510689):1.431563819):5.250650126,((t210:0.9625532757,t211:0.8840663828):5.475810405,((t212:3.558972999,t213:3.440143104):0.6691580141,t214:3.98884192):1.955484542):3.30081392):1.078669744):0.846718835,(((((t215:0.6835700799,t216:0.6206703809):0.6649680095,t217:1.216949285):2.305953387,(t219:0.8681584797,t220:0.6354179862):2.56215202):6.430615371,(t221:8.641511546,(((((t222:0.8354875283,t223:0.6741818423):1.709389486,t224:2.156984154):1.73482341,t225:3.859312171):1.547962765,((t226:1.650953454,t227:1.572424263):3.01201559,((t228:0.969714264,(t229:0.194410066,t230:0.04588446243):0.6694664854):1.223648546,((t231:1.325142637,((t232:0.5151172103,t233:0.4547592834):0.4716251631,t235:0.8176506015):0.2078007069):0.3070074101,t236:1.225396619):0.2703708439):2.336727801):0.5841209771):0.5971556229,(t237:2.002418414,t238:1.951733191):2.923046727):2.140434937):0.9446620181):0.5586672674,((t239:1.224338613,t240:1.180754764):5.597284155,(t241:0.830529435,(t242:0.4846202658,t243:0.4406966657):0.2834876652):5.93740489):1.664386167):0.2794524705):3.285076601):0.116818756):0.2666258307,((((((t244:5.160530151,(t245:1.104750233,(t246:0.5627074587,t247:0.5326812752):0.5012967732):4.044980198):1.767049137,((((t248:3.038420069,(t249:1.284747542,(t250:0.6633192253,t251:0.6631216862):0.4726401351):1.577548644):1.532443648,t252:4.221763084):0.06387585198,(t253:1.926792284,t254:1.878554782):2.342379913):0.2465859995,t255:4.257940108):1.931996044):0.2425500082,(t256:3.79154677,((t257:0.5935942056,t258:0.4622161678):1.180093279,t259:1.579578932):2.001757766):2.62139896):0.9237579346,(((t260:1.773297373,t261:1.653013553):3.842099564,(t262:2.547714512,(t263:2.148205551,t264:2.084375764):0.3574425652):2.69242765):0.1617609713,((t265:1.496570783,(t266:0.2929608021,t267:0.2673450695):0.9647859088):1.709779701,t268:2.857872568):2.062450934):1.342201147):1.210390798,(t269:1.843290326,t270:1.741980821):5.513300771):0.6600023753,t271:7.893179939):2.282558717):7.121234324,((t272:8.38209956,(t273:6.533219253,(t274:1.88741518,(t275:0.1450551147,t276:0.1240380098):1.608829572):4.593085738):1.700488954):3.880880443,(((t277:3.128144607,t278:3.098179421):4.429279073,(t279:0.4337267606,t280:0.3922149288):6.971009458):2.092594121,(t281:3.872346524,t282:3.717210679):5.509481565):2.219042417):4.836928217):1.609282092):10.9884223,((((((((((t283:0.7669199475,t284:0.6703031885):0.5982177594,t285:1.105831137):0.1865990973,t286:1.265007536):4.951399931,((t287:2.712421848,t288:2.665164793):2.634602921,(((t289:0.2087250273,t290:0.1700320612):1.342407266,t291:1.503062676):3.318043948,(t292:1.405409543,t293:1.291261731):3.374346386):0.3488405859):0.8648852655):0.6810366328,((t295:1.58593493,t296:1.217686761):3.419180116,(t297:4.166569116,t298:3.97926828):0.131193129):1.329927598):0.8389217561,((t299:4.995612623,t300:4.961646284):0.8299473687,(((t301:1.401761772,t302:1.092771409):0.3132742853,t303:1.40198796):0.434112369,t304:1.723026866):3.509389137):0.2712628562):2.622088612,(t305:0.7174656086,t306:0.6385754489):7.278881806):1.405033461,((t307:1.454829024,t308:1.264570424):4.77306564,(t309:4.377790809,t310:4.31940988):1.598600866):3.056681469):7.728774861,(((((t311:4.071880537,t312:4.054820531):0.2988475628,t313:4.246537947):5.748818791,(t314:6.904808386,t315:6.879000153):3.022852061):2.260878209,(((((((((t316:0.2808241931,t317:0.2785059999):2.36099466,t318:2.623043239):0.7971327877,((t319:0.784109873,(t320:0.333898696,t321:0.3014869432):0.4480381519):2.405054579,t322:3.109232989):0.1703218696):0.07085668885,t323:3.307577833):0.8250301485,((t324:1.842172583,(t325:0.2778002378,t326:0.02292110314):1.481115168):1.728935876,t327:3.071056046):0.4156690554):0.8000167718,t328:4.217449729):1.877648197,t329:5.994489898):0.4619548887,((t330:0.8218184498,t331:0.1292311458):2.366877848,((t332:1.873011962,t333:1.870851776):0.1506455747,t334:1.935932082):0.415294788):3.110281983):1.308034559,((t335:3.041426932,t336:2.98521721):2.613743172,((t337:0.1190041313,t338:0.07553835773):4.431950754,t339:4.4168723):0.8106649031):1.050084818):3.374896077):3.240081772,(((t340:4.514791188,(t341:3.519827193,(t342:0.0268525114,t343:0.01252087818):3.383667976):0.8441237939):3.132069517,t344:7.340236651):1.618146551,(((t345:1.277462523,t346:1.26010288):3.341662602,t347:4.543090414):2.162349607,(((t348:2.606895046,(((t349:1.414545412,t350:1.374605742):0.5149819067,((t351:0.8442275198,t352:0.8261872754):0.2238122088,t353:1.011786538):0.767062481):0.385614282,(t354:1.146156864,(t355:0.8857912464,t356:0.7723138692):0.1429770073):0.947762006):0.1859846052):0.024055416,(t357:1.171811387,t358:1.06449172):0.5892233156):1.042612477,(t359:1.244835187,t360:1.107024052):1.397773345):2.962452941):1.594376747):3.368336933):1.034858705):1.15492932,(t361:0.7321374614,t362:0.6807807402):11.87345652):7.849025256):1.128743428):0.1202464099,((t363:7.003280618,t364:6.990530859):13.09746786,((t365:3.454378556,t366:3.422005716):15.68608388,((t367:9.639394243,((t368:1.016196553,t369:0.9955317839):4.402761021,t370:5.336515121):4.203930933):7.216170769,(((((t371:5.791812482,(t372:5.497929694,(t373:1.549717116,t374:1.261204042):3.886063215):0.2322662101):1.080145414,((t375:2.424802993,t376:2.394245942):2.880102497,(t377:3.872019808,t378:3.811906965):1.200321206):0.6192171018):1.884404555,t379:7.421953562):1.880406147,(t380:9.040373332,((t381:5.541583053,t382:5.397283181):2.429720134,(((((t383:1.077236076,t384:0.8987913833):2.392283799,t385:3.229285051):1.73235106,t386:4.858436867):0.334509803,((t387:2.799980726,(t388:1.147665668,t389:1.067969632):1.606826051):0.05091398096,(t390:2.689975088,t391:2.587015352):0.01213116877):2.283374732):2.091072329,t392:6.717700919):0.1792730338):0.8229419835):0.1791122812):0.06454684941,((t393:1.042475407,(t394:0.386709914,t395:0.1266000619):0.4629154452):0.1518804088,t396:0.6128380028):6.720750297):6.024024347):2.192047259):0.8901266132):1.405738038):0.8612945347,((((t397:2.381034093,(t398:2.154285665,t399:2.086300173):0.1039309492):2.810611947,t400:4.904334796):2.662294505,(t401:5.387201639,(t402:1.171827738,t403:1.074439878):4.180467879):2.170230904):0.8485578822,(((t404:1.244618237,t405:0.9243772173):1.822094634,(t406:1.604518468,t407:1.406303333):0.9043140758):3.682227825,((t408:0.8141842803,t409:0.8125949676):1.768118025,t410:2.553715344):3.371706268):1.337805136):9.914778214):10.14607858):13.87193958):0.1121204584):49.30481225,(((((t411:1.513476836,t412:1.492790713):5.179214591,(t413:2.505756561,t414:2.466809742):4.040660124):6.549322031,(t415:3.477238692,(t416:0.4105103736,t417:0.4040727706):2.790316989):9.550885018):17.66858062,(((t418:1.582937192,(t419:0.7062164184,t420:0.1549004184):0.8073946317):2.180203169,(t421:3.021219895,(t422:1.397882215,t423:1.334513662):1.55073282):0.03518787271):0.8072371112,t424:3.699869541):25.82649219):5.75047957,(((((t425:0.5450368571,t426:0.4022347118):2.911741094,t427:3.165260114):0.8007136545,(t428:3.736691877,t429:3.733595424):0.01667690469):1.217637596,t430:4.958545759):0.08816447634,(t431:3.256938584,((t432:2.219984207,t433:2.207850456):0.9747317644,t434:3.131161713):0.0620459639):1.433639309):29.64993046):53.91989178):28.63359477);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T25.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
