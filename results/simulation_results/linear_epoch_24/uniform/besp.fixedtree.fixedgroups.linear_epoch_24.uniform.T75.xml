<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t469:0.4385826407,t470:0.3578416817):4.826962361,t471:5.10773612):5.279917512,(t472:3.54707656,t473:3.52615048):6.836559157):49.94083476,((((t474:3.693590914,t475:3.689627263):5.68234521,(t476:3.620001625,t477:3.58334423):5.706298618):12.4708034,(t478:4.10830356,((t479:1.734959074,(((((t368:0.2654602059,(t341:0.09193619861,(t324:0.01583568658,(((t277:0.03040764187,((t253:0.006756235497,(t246:0.2900531373,((((((((t113:0.04746869779,((t1:7.753634148,t2:7.66035263):4.042408113,(((t3:4.647591235,t4:4.640796208):2.71650789,(t5:2.8653876,((t6:0.655754667,t7:0.6291074452):0.8344530436,t8:1.40866251):1.292123891):4.466608514):0.4928550604,t9:7.626981294):3.684168671):0.303692945):1.792142787,(((t10:1.912836381,t11:1.873563805):5.600704601,(t12:6.520842951,((t13:1.154954454,t14:1.087344538):5.289948737,(t15:4.921579979,((t16:2.828601116,(t17:2.427351599,t18:2.409037078):0.3893833391):2.00994894,t19:4.569152181):0.02532295268):1.35231042):0.07371117146):0.9183074946):4.323218628,((t20:4.05799469,(t21:0.8701107269,t22:0.7238777755):3.142656573):4.151152066,((t23:6.520520581,(t24:4.957198811,(t25:3.166642271,t26:3.058429443):1.76524775):1.447206616):0.7781417538,t27:7.002854549):0.6343793005):3.025857859):1.376301736):0.8249267639,(t28:1.647844002,t29:1.618532027):10.99410488):2.158981455,((t30:5.537518324,((((t31:3.83901037,t32:3.527960156):0.8410219874,(t33:3.106919173,t34:2.900646777):1.016170146):0.01112444384,t35:3.917446683):0.4565772272,t36:4.272455241):0.3686160244):8.753527943,((((t37:5.862413688,t38:5.770828917):0.784186108,t39:6.541092461):2.831881283,(((t40:0.3150045998,t41:0.1862911895):2.959701274,t42:3.118841935):1.391549837,((t43:1.043874882,t44:0.875319328):0.6371573773,(t45:1.291863295,(t46:0.7554478238,t47:0.5329765619):0.4737745712):0.1192537121):2.799223506):4.606727059):1.354857563,((((t48:1.576525417,(t49:0.6544363221,t50:0.5719728314):0.7921974486):0.7278988615,t51:2.048713414):2.136955004,(((t52:1.416125727,t53:1.205098533):1.198774671,t54:2.109547145):1.214390478,t55:3.252200207):0.3367107797):2.384836841,t56:5.936897394):3.04067944):2.380081536):0.4179291874):0.9011247584,((t57:6.908633869,((t58:3.108936615,(t59:0.9102240755,t60:0.8994180375):2.126375024):0.4579570663,(t61:3.251273989,t62:3.196501988):0.01432807686):3.259116438):2.451189001,t63:8.780942189):3.269637458):1.963225146,((t64:2.82250746,t65:2.610058795):5.973362365,t66:8.371156886):5.132163477):2.032988554,((t67:2.121559403,t68:2.040007378):13.05447031,(t69:14.20807181,(((((t70:0.1923259999,t71:0.03793559073):0.7563952114,t72:0.6616861558):0.009267219455,t73:0.6519788028):8.302153124,((t74:3.431040152,(t75:0.6552985278,t76:0.2652363037):2.719586321):1.678217295,t77:4.474186041):3.739437282):0.5309420551,((t78:1.035329447,(t79:0.6007359119,t80:0.5680737861):0.2345671957):5.938194841,((t81:1.658406016,(t82:0.4399548602,t83:0.4206712242):1.074640011):2.34006669,t84:3.807377854):2.6550558):1.717209355):4.043454353):0.7646077831):0.2116156352):2.54877475,(t85:15.48830647,((((t86:3.551914404,((t87:2.235841004,(t88:2.035416749,(t89:1.568551362,(t90:0.3579503634,t91:0.3362065587):1.111072231):0.2493828513):0.0331223085):0.942856757,(t92:2.291882843,(t93:0.5619932557,t94:0.3355645117):1.580683437):0.2590704955):0.3671132053):0.4598071762,(t95:1.117691223,t96:1.083158803):1.631838399):8.347450748,(((((((t97:1.955831565,t98:1.57764185):0.379958249,(t99:1.265817636,t100:1.205692288):0.601141933):3.558800836,((t101:1.325746147,t102:1.025451989):0.8013153245,t103:1.710576044):3.169669453):0.3746990775,(t104:2.283065331,t105:2.187803932):2.939192146):0.5017821506,(t106:4.850431437,t107:4.719328806):0.6160007336):2.676252476,(((t108:0.4288609466,t109:0.3972873302):1.953523968,t110:2.035677689):5.29881205,((t111:2.172448261,t112:2.168894304):3.895008996,(((t114:2.225183516,t115:2.165689061):1.171285212,t116:3.300346421):0.7989322565,(t117:2.286615215,t118:2.243800117):1.665329253):1.700175309):1.249486682):0.2015458713):0.09294428174,(t119:5.327522987,((t120:1.851674206,(t121:0.4911948302,(t122:0.2653637598,t123:0.2192286262):0.1710215941):1.25785961):3.131561281,t124:4.671447423):0.1410433261):1.738424068):1.435371519):2.485655023,(((t125:0.9255677627,t126:0.8822302979):4.281599141,t127:4.963827791):2.307709327,(t128:4.043344744,(t129:2.849264706,t130:2.844087179):1.061180158):3.217239217):2.647815274):0.576159864):0.2249525369):0.3614686303):0.6089354641):2.177731176,(((t131:6.275765429,t132:6.155688821):0.02516558996,(t133:3.498825265,t134:3.449170439):2.679012852):5.96340254,((t135:9.061629558,(((t136:1.549692514,t137:1.398330057):0.3816299049,t138:1.728276914):6.173314271,t139:7.859712615):0.9096550821):2.495893182,((t140:9.672670129,(((((t141:1.289529124,(t142:0.9521624003,t143:0.8891331404):0.2893331791):0.9481062421,t144:2.107510483):0.01892112464,(t145:1.283606315,t146:1.241322939):0.7513747424):0.4236816194,(t147:1.938049232,t148:1.724464678):0.3886322976):4.892275031,(t149:4.393712033,(((t150:3.180716837,(t151:1.714527873,t152:1.651673555):1.237469304):0.3353496417,t153:3.202195035):0.7967149771,(((t154:0.7696559093,t155:0.7541674928):1.797711871,t156:2.486077545):1.027687884,(t157:3.287627173,t158:3.239433473):0.01503455581):0.3500466901):0.06450402883):2.587885442):2.060889257):1.133082831,(t159:0.8480794263,(t160:0.7715213637,t161:0.7648346604):0.02272007166):8.197077278):0.3396900818):0.413272624):1.424338803):0.7966036741):0.05606097795,t162:11.9252393):1.029429385,t163:12.94544685):3.688609315):2.398635253):2.475813667):5.889281664,((((((((((((t164:0.7307946118,t165:0.5496650976):4.406227257,t166:4.931501727):1.48012254,((t167:1.178720312,t168:1.137348143):1.562007685,t169:2.664615862):3.656642135):1.420543951,((t170:1.102272312,t171:1.052858195):4.218460986,(((t172:0.5330864592,t173:0.4655015818):3.194821334,(t174:3.501786598,t175:3.441195107):0.03807359092):0.4474035644,(t176:1.350352168,t177:1.244603235):2.574398553):1.042340809):2.376718011):0.01176240233,t178:6.932738576):1.303243269,((t179:1.802318047,t180:1.699259217):5.79902522,(t181:4.032305466,t182:4.015564225):3.356276317):0.2898118503):1.696099953,(((((t183:1.295831837,t184:1.00942472):3.390507166,(t185:2.977047217,(t186:2.540800346,t187:2.200760145):0.2594586078):1.358604619):0.916567894,t188:4.405806949):0.2580482718,(((t189:0.9686796176,t190:0.921280263):0.05254624905,t191:0.9051116228):1.954537974,t192:2.734363876):1.647552865):0.05701220264,t193:4.38005742):3.329144457):2.209086697,(t194:1.997919403,(t195:0.3354512748,t196:0.2197668484):1.638662669):7.909898494):4.640869434,(((t197:2.756165638,((t198:1.357746991,t199:1.355731569):0.8497842989,((t200:0.8851411752,t201:0.5455238246):0.4681651223,t202:0.977368348):0.660971005):0.4903352239):3.449464599,(t203:4.470431583,((t204:3.411270772,t205:3.351202588):0.6426018368,(t206:3.540115848,t207:3.521944623):0.3970735547):0.4039807217):0.961757424):2.059065148,(t208:5.429501297,(t209:2.692488955,(t210:0.5265477833,t211:0.3685824538):2.122258867):2.730185247):1.850717019):6.08932796):1.000417426,(((t212:0.4738192444,t213:0.4255795225):1.815574446,t214:2.084923551):7.126483756,((t215:2.025552032,t216:1.968604911):5.882464017,(t217:1.114231216,t218:1.032435825):6.623032237):0.9596501091):4.499857234):3.862271475,(((t219:12.13179439,((t220:1.2513923,((t221:0.4632506354,t222:0.4100561918):0.5308366357,t223:0.8411175951):0.2148461385):2.421810521,(t224:0.28457649,t225:0.2187681263):3.081225212):8.411365811):2.921679713,(t226:5.786493012,(t227:1.552975353,t228:1.513702562):4.155940236):8.763050815):1.330089993,((t229:3.970440976,(t230:0.5398805938,t231:0.5101953726):3.374925332):8.868256637,(t232:8.31850461,(((t233:2.707374568,(((t234:1.174231479,t235:1.166080001):0.9368270191,t236:2.054075957):0.05196188793,t237:2.02940634):0.43754065):2.024464544,t238:4.43822266):0.3023769144,(t239:1.685293075,(t240:1.048412579,t241:0.9880931834):0.39797432):2.902601203):3.193579689):4.427772001):2.918175248):0.4558433688):1.636497167,(((((((t242:5.236849362,((t243:3.520161374,(t244:1.223746638,t245:1.185311713):2.212433889):1.558689043,t247:4.602297444):0.04945148646):0.07155516042,t248:4.667823172):2.541476852,(t249:4.938930099,(t250:2.853238694,(t251:0.7857566973,t252:0.7538910554):1.763598172):2.004849886):2.180155931):6.64301016,((((t254:2.288456688,t255:2.243098715):1.097735252,t256:2.765073366):4.639683962,(((t257:0.7440655925,t258:0.7195760687):0.5801958443,t259:1.229923561):5.269677142,t260:6.493290337):0.7788963859):3.448905581,(t261:3.76129405,t262:3.516920061):6.814707706):1.811022623):0.1961087305,((t263:1.80452892,t264:1.480316303):10.03993211,((t265:4.897194454,t266:4.878184639):5.08888667,(((((((t267:2.863525775,t268:2.811936321):0.4129122492,t269:3.165850474):0.1375033008,t270:3.03988711):0.02892291411,(t271:0.5802965415,t272:0.5189168541):2.343187549):3.838623686,(t273:3.223018397,(t274:2.384796804,(t275:2.0375099,t276:1.843940533):0.2534431599):0.5485444116):3.399752884):0.12122508,t278:6.020835308):0.2264341776,((t279:1.006420735,((t280:0.1488864285,t281:0.05400392719):0.3370952665,t282:0.1957407301):0.5056249026):2.977917192,t283:3.406794559):2.213716369):2.258775924):1.482078367):0.4843787914):0.4644611101,(t284:4.872440232,((t285:4.001642026,t286:3.787146748):0.01744856835,t287:3.708309395):0.5891877758):5.362168874):1.664119854,(t288:11.08097568,(t289:4.630133797,(t290:1.571521374,t291:1.444123422):3.050190261):6.415654311):0.1353681113):0.05240116504):2.812382388):2.712966986,(((((t292:2.964057376,t293:2.663759951):0.7595968034,t294:3.355019717):9.108923996,((((t295:4.856053447,(t296:1.359324523,(t297:0.4227068402,t298:0.3031727701):0.7784477724):3.294701074):2.202081278,(t299:1.757636898,t300:1.711345015):4.646264232):2.546289431,(t301:3.373268321,t302:2.976275598):5.402945651):1.20863291,(((((t303:0.8004594061,t304:0.7690885227):0.6124662717,t305:1.332288159):2.817163908,t306:4.116972768):0.709147573,(t307:4.346317603,(t308:0.06860126674,t309:0.03877050781):4.277157919):0.3605522177):2.813591969,((t310:5.188786968,(((((t311:1.830230482,t312:1.807207642):1.162943111,(t313:2.511453116,t314:2.50203881):0.3820659704):0.380711515,(t315:1.513747416,t316:1.353919002):1.699140047):0.04685359103,(t317:1.897321223,((t318:0.2415608756,t319:0.2413051693):0.4828268081,t320:0.6673559739):1.164864947):1.086025649):1.392596939,t321:4.280555653):0.3431102403):2.03121713,((t322:1.779384668,t323:1.648812786):1.638760491,t325:3.141533632):3.119905581):0.08705466654):1.818943881):1.518689666):1.805235175,(t326:10.19309007,((((t327:0.5976759898,t328:0.4196708923):2.515598725,t329:2.918812219):1.149146922,t330:3.987974551):0.9172060369,((t331:0.5280319114,t332:0.4569227986):3.632167659,(t333:3.307129501,(t334:1.921623964,t335:1.847277863):1.195771927):0.6693033656):0.5678077823):4.904324975):1.294300893):0.05363252713,((t336:1.502025097,t337:1.470443433):7.468828667,((t338:1.91269877,t339:1.798729824):5.598792138,(t340:5.830180941,(t342:5.103914727,(t343:1.684919096,t344:1.635780412):3.394713941):0.433932241):1.18165204):1.022465128):1.486318033):1.824432893):0.04794246981,t345:10.79870861):1.953689596,((t346:8.22980201,((((t347:1.642441183,t348:1.527418715):3.934038654,((t349:1.382923857,(t350:0.7442799659,t351:0.6990037473):0.4699121514):1.118686639,(t352:1.606988829,((t353:0.05453868824,t354:0.01284428974):0.4231573363,t355:0.4161276935):1.111519947):0.5654198429):2.730467769):1.241750277,((t356:0.8797150161,t357:0.8191860206):1.12135438,t358:1.940284418):4.062196573):0.3886957295,((t359:2.788845899,(t360:0.6686125069,t361:0.4140758787):2.026463573):0.1180991923,(t362:2.466306476,t363:2.418462371):0.06644531992):3.409034843):0.9452798985):1.507781803,t364:8.303847609):2.98730782):1.124621233):1.27496827,(t365:7.439335521,(t366:3.561530424,(t367:0.7848527852,t369:0.4673555145):2.562868734):3.825284253):6.137455347):1.09760786):17.63052081):37.07781109,((((t370:0.9324992767,t371:0.8960710608):6.570121373,((((t372:1.48763005,t373:1.401347183):2.506782112,((t374:2.212669387,t375:2.034724809):1.215509307,((t376:0.545115696,t377:0.4238847962):2.101836758,((t378:1.910399339,(t379:1.655988666,t380:1.514843482):0.1071047176):0.226610548,t381:1.819560062):0.3127193275):0.5115941797):0.4546706643):2.147238621,(t382:2.717704336,t383:2.62591597):2.395875744):0.5108452353,(t384:3.950738567,(t385:3.26206283,t386:3.230994183):0.47825048):1.433517711):0.7384129949):15.0759843,(((t387:6.784269016,(((t388:1.163353038,t389:1.051980664):4.312235622,(t390:3.65645452,t391:3.566502981):1.698348706):1.074775736,((t392:0.3973005857,t393:0.3890906275):2.449548621,(t394:2.322203918,t395:2.284828941):0.463780793):3.446340965):0.1337851272):1.779922266,((((t396:0.8855126169,t397:0.7133492938):1.460615651,t398:2.141457012):2.25878769,t399:4.23465608):1.189148874,(t400:3.266622636,((t401:1.501592249,t402:1.462606247):0.2543335086,t403:1.64197933):1.300377169):2.150286275):2.145410364):0.1238405623,(t404:5.193317868,t405:5.109841612):2.159709429):12.21292331):33.65964215,(t406:41.13244134,((t407:2.617777914,t408:2.555791548):4.461758096,(t409:2.690146958,(t410:2.051121439,t411:1.958818152):0.6151410532):4.318238708):33.99333989):11.98409799):12.50643389):1.332724631):351.7671702,((((t412:1.525394715,t413:1.440538565):10.45548322,((((t414:1.716565008,t415:1.641079343):0.3435817182,t416:1.948675125):3.976735807,t417:5.876327365):0.642000881,t418:6.469047016):5.201964483):11.40731139,(((t419:1.25754318,(t420:1.128469702,t421:1.103219249):0.007586985494):6.72770618,t422:7.826165917):11.48810643,(((((t423:0.9689521635,(t424:0.7781708784,t425:0.7066722027):0.1266400646):4.588355607,(((t426:2.413689624,(t427:2.088688316,t428:2.029717808):0.01850912873):2.247997699,t429:4.157070262):0.09009140527,t430:4.219350809):0.6215465467):1.720277007,t431:6.394874342):5.584391192,(t432:8.617743309,(t433:8.482857009,(((t434:2.72257484,(t435:1.077896117,t436:0.9242585688):1.560730072):2.613847819,t437:4.79174186):0.490981996,(((t438:0.1380791681,t439:0.1034945113):1.471222697,(t440:1.455546228,t441:1.398488188):0.02547500458):1.743853602,(t442:1.338186785,t443:1.331480944):1.783523183):1.859926177):2.595915975):0.03571482023):3.352131942):5.669467692,((t444:2.731003327,(t445:1.625103665,(t446:1.307379452,t447:0.9423409852):0.1500550066):0.9967613826):9.63158949,(t448:8.589198646,(t449:0.7777866686,t450:0.6102806179):7.760083711):3.110398432):4.109770514):0.3091761541):3.503765344):17.93669071,((((t451:6.348318505,((t452:3.936377667,(t453:2.016425763,(t454:0.9720731434,t455:0.9515714898):0.9469754934):1.872983319):2.156808744,(t456:0.6403231055,t457:0.628598131):5.157521869):0.2274224777):8.133551731,(t458:0.8533148471,t459:0.7311298948):13.19936427):2.995125299,(t460:7.33666307,((t461:1.316565242,t462:0.9856935811):2.923691916,(t463:0.8417503805,(t464:0.4013022429,t465:0.1939035442):0.4351620103):2.880484115):3.051815253):9.510196518):0.3213769484,((t466:1.298557729,t467:1.116957605):10.31395368,t468:11.34044118):4.700135514):19.44805318):377.1130723);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T75.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
