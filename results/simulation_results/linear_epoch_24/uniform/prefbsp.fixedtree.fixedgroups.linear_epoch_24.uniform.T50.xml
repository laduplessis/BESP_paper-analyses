<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t506:1.578971699,(t507:1.238548322,((t497:0.2581995625,((t419:0.1876687477,(t394:0.04002685411,(t358:0.3128327089,(t289:0.02179240642,(t268:0.1408398702,((t175:0.01876677881,(t139:0.1466111652,(((t81:0.05852058899,(t71:0.1925770359,(t14:0.01297954223,t1:1.231707062):5.993115714):1.035084775):3.288280227,(((((t2:3.73311362,t3:3.589843936):3.21822631,((t4:3.660291334,((t5:1.307514898,t6:1.246377658):0.8208259179,t7:2.013675383):1.41578572):2.646017359,t8:6.070969664):0.266252356):0.670680787,t9:6.847498188):2.118035039,t10:8.792582948):0.5310523363,t11:9.155203839):1.235178446):1.839057018,(t12:8.611617087,t13:8.576046501):3.608917512):0.1113742899):3.54854694):1.114527019,((((t15:6.640653149,(t16:2.47409497,t17:2.471188652):4.087755978):3.784503293,(t18:6.610959475,t19:6.599561963):3.432826681):2.7501456,(t20:7.947670975,((t21:1.877926889,t22:1.813219597):0.2803504387,t23:1.838421819):5.593024486):4.798257393):0.6904051811,t24:12.88901455):3.048847339):7.012488781):2.47881873):7.512439871):3.022219878):2.31582366):3.818337104,((((((((t25:4.471114853,t26:4.459138114):5.107081184,t27:9.474852697):6.711002392,(((((t28:0.7034478534,t29:0.5495427499):5.506887786,(t30:5.583218515,t31:5.51828699):0.3687718887):0.8203744254,((((t32:0.5522964512,t33:0.5088526089):0.7013952293,(t34:0.5358291762,t35:0.4847608982):0.2574516016):0.7370399811,t36:1.471886965):1.539185395,(t37:1.64512524,t38:1.377808339):1.318433997):3.129634413):5.94946055,(t39:6.655666046,t40:6.652394155):5.060585758):1.289990732,(((t41:5.298720371,t42:5.21609622):3.498101183,(t43:2.414215323,(((t44:1.309099902,t45:1.264316255):0.6430987986,t46:1.804682536):0.3674324912,t47:2.05444049):0.07410038252):6.283108797):1.880125246,(((t48:8.011446756,((t49:0.5841551417,t50:0.4860798822):6.085141086,t51:6.501829941):1.144896373):1.30776054,(t52:4.186401836,((t53:3.191907054,t54:3.173864042):0.5140045758,(t55:3.003507193,((t56:0.9782605173,(t57:0.3180234597,t58:0.3082072271):0.6463740976):1.381816788,t59:2.301274333):0.2640307853):0.6597003271):0.4349339563):4.728976166):0.4683255089,(t60:4.656764586,(t61:1.916489897,t62:1.789945006):2.715253496):4.124420983):0.5006766029):1.847802307):1.775650911):10.542233,(((t63:5.869782567,(((t64:0.5419693527,t65:0.3848052084):0.5550540892,(t66:0.7331816044,t67:0.6912743326):0.05903945793):2.756779219,t68:3.296445596):1.979044486):13.40672563,(((((((t69:2.692326659,t70:2.467277234):1.720990527,(t72:2.442248624,(t73:0.7927331022,(t74:0.3217352252,t75:0.3177954052):0.402089159):1.572497032):1.12154146):4.917688991,t76:8.2643804):0.7355670121,(((t77:1.340306006,t78:1.173016316):1.740422332,t79:2.854791246):0.8967412908,t80:3.656886105):4.977229336):2.980352694,((t82:6.931664856,(t83:3.903819476,(t84:2.551232231,t85:2.505892639):1.225798607):2.929240161):0.5483172253,(t86:4.046592315,((t87:1.575456074,(t88:0.7238753047,t89:0.6115090344):0.8197558207):0.08438834507,t90:1.48844704):2.259805898):3.074823585):3.986311317):3.534139459,(((t91:0.9011595762,t92:0.7888362167):5.447609235,t93:6.178219292):0.5321185539,((t94:0.5677303055,t95:0.5575901403):3.809116397,((((t96:2.735696006,t97:2.69447396):0.3957161499,t98:2.983847615):1.062905677,t99:3.861863086):0.1253943228,((t100:0.662838537,t101:0.5670889008):2.918110608,((((t102:0.1832843571,t103:0.1754367015):1.580658947,(t104:1.123199893,t105:1.038374431):0.5073742318):0.5087565137,(t106:1.490967204,t107:1.457405244):0.5078847509):0.746958816,(((t108:0.4650273513,t109:0.3548562624):1.267467857,(t110:0.9566386684,t111:0.4935858806):0.6132848388):0.6263311298,t112:1.724994677):0.2379768263):0.3277243791):0.2926548334):0.01272609381):2.180414588):7.353871769):0.1788230512,((t113:0.6044614289,t114:0.5964459164):11.06171036,(t115:10.0321471,(((t116:2.274749624,t117:2.245599687):3.629082315,t118:5.83450491):1.953959626,((t119:6.895070502,(t120:3.015863628,t121:3.010901462):3.750458669):0.5711580812,(((t122:3.345846241,(t123:0.2482858789,t124:0.1621153629):2.961645335):1.094599278,((t125:1.235914599,(t126:0.9302897006,t127:0.8879249612):0.2525679251):0.04538849374,t128:1.165251762):2.890853426):1.641104935,((t129:0.6640825023,t130:0.6368506563):4.003409175,(t131:0.2069281604,t132:0.1613988955):4.070168397):0.9112707824):1.219549366):0.2310642106):2.022042499):1.451914965):0.5830578452):1.784992306):0.2150838611,(t133:11.44227511,((t134:5.787528597,t135:5.74758693):3.95013555,((t136:2.083026872,t137:1.992390256):2.188758275,(t138:4.115596642,t140:3.951852038):0.02150829552):5.262675926):1.695547504):1.069613667):3.733742172):0.4153342931,(t141:4.103025728,t142:4.031121403):12.03774979):11.01851216,(((((((((t143:3.829217561,((t144:0.2572509233,t145:0.2479451086):1.057823198,t146:1.286716041):2.408678291):6.338036683,(((t147:0.9368502495,(t148:0.6341694447,t149:0.6145105002):0.0406808321):1.188768755,t150:1.723993162):1.574906314,t151:3.249118675):6.225602264):0.7082690355,((((t152:4.657203326,(t153:3.061180203,t154:3.002208703):1.286135168):1.314544988,t155:5.570724379):2.9999754,((((((t156:0.7496397938,t157:0.5798916422):0.7244518802,((t158:0.4457955725,t159:0.4152665186):0.2277031974,t160:0.6176455395):0.523645851):2.428762024,t161:3.461094747):1.756224854,((t162:2.614207195,t163:2.57032124):0.5376602687,(t164:0.7725261695,t165:0.7405784254):2.11739514):1.942848011):0.1066681375,t166:4.632644395):1.024868672,(t167:2.903392464,(t168:0.5401326185,t169:0.4015658279):2.315835631):2.693941369):1.723129795):0.4313099633,(t170:4.567016853,(((t171:2.162042516,(t172:0.3703167574,t173:0.3381970577):1.629664923):1.581447924,t174:3.472151114):0.3303362753,t176:3.52208754):0.2600281792):2.896759452):0.6724944869):1.493855899,((((t177:7.598631827,((t178:4.964227967,t179:4.760594711):0.07130471398,t180:4.743684913):2.556971672):0.2661207509,(((t181:0.6954964526,t182:0.6445826307):2.273992791,t183:2.864779189):1.228898721,(((t184:0.2701615112,t185:0.1109367109):0.3854668637,t186:0.4377279082):0.6029735335,t187:1.018632601):2.824451409):3.256240892):0.0759315295,(t188:0.08914720851,t189:0.04756523834):6.840251887):0.1933697145,(t190:3.026091421,t191:2.764466836):4.019830047):0.6465339497):0.8921517977,(((t192:2.847905749,t193:2.808650436):2.217413915,(t194:0.5219390311,t195:0.4522192592):4.396391391):1.831676153,(((t196:1.799022729,t197:1.414949674):0.8618326517,(t198:1.408309594,t199:1.365660022):0.8655198073):3.410025123,t200:5.329743118):0.5730694929):0.9779406365):0.371137175,t201:7.24608404):8.253645861,((t202:7.55197952,((t203:6.965607461,t204:6.862200614):0.2793702294,t205:7.075634028):0.2854491067):5.206535848,(((t206:4.37708014,((t207:2.035455368,((t208:0.5115950311,t209:0.4520080251):0.1725728538,t210:0.4500006747):1.332119016):2.165022272,((t211:2.157042579,t212:2.075062641):0.5678188423,(t213:1.420423607,t214:1.307087361):1.177431885):1.215632665):0.1143163498):2.01177992,(((t215:1.538410076,t216:1.51481262):3.622347785,(t217:0.3022838375,t218:0.2617585417):4.786915787):0.3019208612,(t219:1.64332186,(t220:1.338394881,t221:1.223506364):0.2733180787):3.646803003):0.1528116542):3.470957895,(((t222:0.1885587661,t223:0.08320129243):3.911931611,(((t224:0.8412175002,t225:0.8356800769):0.7224477751,t226:1.502213448):2.038444345,t227:3.517404497):0.2575898137):2.705755463,t228:6.460831753):1.9042411):2.667376912):2.730795642):1.635735244,(((t229:0.5997724732,t230:0.4898409586):3.565321069,((t231:0.3836453227,t232:0.3733187733):3.401314772,t233:3.720148125):0.2079589451):5.18151325,(t234:0.9774538671,t235:0.907877518):8.061514907):5.992825718):2.725404109,(((((((t236:2.175889121,(t237:1.406923051,(t238:1.221434528,(t239:0.1236380599,t240:0.01575387726):0.7034557295):0.1419342467):0.6845482244):2.960859993,((t241:0.3200062247,t242:0.1153892999):2.086912959,(t243:2.123367373,(t244:0.2157254907,t245:0.1502963299):1.886901154):0.06338826287):2.069011775):2.733235662,(t246:6.805529515,((t247:0.9132151839,t248:0.6209475727):0.1334152895,(t249:0.2432983772,t250:0.2028056465):0.1843058651):5.680620605):0.05031786195):1.240613463,(((t251:0.3332085165,t252:0.314782814):0.6571800174,t253:0.8637357293):5.013597516,(((t254:2.432595022,(t255:1.62006991,t256:1.521895781):0.8010361464):2.067985128,(t257:3.697435771,(t258:1.866582406,t259:1.840440176):1.614094617):0.6084469376):1.103935998,((t260:0.8154084766,(t261:0.688614144,t262:0.6318059792):0.06926090688):3.602217015,(t263:1.560225655,t264:1.535652399):2.738782111):0.7294615107):0.1312475158):1.327017874):0.2161993167,t265:6.661768193):1.793769108,(t266:7.933947135,(t267:7.764816235,((t269:2.917382854,t270:2.798746804):3.874868097,(t271:2.078922926,t272:1.987550224):4.290334997):0.7825563571):0.1609887178):0.4071783649):4.373103004,t273:11.66245178):2.147684538):0.8053218777):0.6628955748,(t274:7.275405602,((t275:2.356079608,(t276:0.7222799793,t277:0.6794115789):1.589530542):3.525119661,(t278:0.6702143181,t279:0.6466637886):5.050504418):1.283245394):7.870190117):1.644093956,(((t280:7.750136483,((t281:1.281629592,t282:1.280215139):0.8693137299,(t283:0.8374106875,t284:0.7651659716):1.259886681):5.550347088):1.894081376,(((t285:3.711581678,(t286:0.525746503,t287:0.1549131173):3.101151006):2.110430766,(t288:2.944473863,(t290:2.365603701,(t291:0.8944175348,t292:0.8290852147):1.31265341):0.3373086778):2.377964111):1.900219317,t293:6.445203507):1.404901061):5.563896707,(t294:9.750759609,((((t295:0.2041549024,t296:0.1865080924):1.37817801,t297:1.517759915):0.6580833749,t298:2.154853888):1.349384032,t299:3.453743379):6.114590331):3.561682744):1.282940472):1.332482951):2.783129609):0.6286476502,(((((((t300:7.011610028,(t301:4.256598549,t302:4.242897371):2.716910736):0.3267628561,((t303:1.483920496,t304:1.314011989):4.289862255,t305:5.504958597):1.472785637):0.4976184054,(t306:6.56208839,(t307:0.09118804589,t308:0.04025806321):6.36469702):0.6027324112):4.023927436,((((((t309:5.206130482,((t310:1.093996799,t311:1.078797002):2.237309623,t312:3.269582783):1.550449467):2.878035928,((t313:0.2930118848,t314:0.05380455373):0.9920242125,t315:0.8106781673):6.362794922):0.1897306132,t316:7.347725519):1.481951898,((t317:5.234546808,(((t318:1.816475439,(t319:1.018104822,t320:0.9364123118):0.6987131471):0.8796995369,(t321:0.9910671775,t322:0.9460182441):1.482622803):0.2178603186,t323:2.60509107):1.990633646):2.212432898,((t324:0.3072209918,t325:0.1147076749):6.278651695,(((t326:1.519143768,t327:1.422430435):1.691934713,t328:3.102306262):2.07179264,(t329:0.7327570403,t330:0.7200305355):4.354897009):1.08421289):0.1165809199):1.207568023):0.1516894291,t331:7.596489499):0.2841181326,((t332:6.060231996,t333:5.964603345):1.06457301,((t334:3.410317746,(t335:1.152006817,t336:1.072978394):2.1833382):1.116151347,(t337:2.046070529,t338:1.765683597):2.196818971):2.397380435):0.6731418044):0.6409834221):1.197279945,((t339:6.46906287,((t340:3.160193924,t341:3.10100952):2.496763067,(t342:4.114058077,((t343:0.6866549851,t344:0.6615984404):1.741332925,t345:2.206600371):1.612595052):1.338543403):0.7554874991):0.5007599634,((t346:1.162214554,(t347:1.041228752,t348:0.9019971687):0.09806420228):2.566244734,(t349:3.473868104,t350:3.460319274):0.07775061113):2.245824958):1.883948269):0.766714905,(((t351:2.502583936,t352:2.47666078):5.160320971,(((((t353:0.3403727869,t354:0.1001692899):4.645905537,t355:4.551886343):0.3054059577,((t356:3.106021534,(t357:2.499443953,t359:2.12922884):0.5327493471):0.08585123875,(t360:1.812096218,t361:1.607447797):0.9187103761):1.577674268):0.6317206715,(((t362:1.160916081,t363:1.115380906):1.575784081,(t364:0.2975428494,t365:0.2128892125):2.343335935):0.3506961513,t366:2.904929852):1.625513216):0.6150923613,(t367:3.029568657,(t368:2.207875699,t369:2.024917636):0.5915867023):1.984652459):1.060222496):0.4725849753,(t370:2.806678872,(t371:2.176666361,(t372:0.6120408336,t373:0.5610452402):1.564441891):0.5897707244):3.204893321):0.1937194284):3.657126403,t374:9.728182483):1.600682287):1.421034123):0.2417251233):10.59804079,(((((t375:3.29473767,(t376:0.1214605736,t377:0.03869286488):2.98500391):3.12479082,(t378:0.7139244582,t379:0.5812615989):5.415150393):2.780343509,(t380:0.5729439488,t381:0.4751059349):8.164289914):6.637436533,((t382:5.76105585,((t383:1.787311128,t384:1.705927437):2.018216545,(t385:1.256641931,t386:1.20905336):2.28121532):1.920440737):2.361547729,((t387:5.987315112,(t388:5.577692189,t389:5.532709243):0.3091260551):1.670233456,(((t390:3.761615328,t391:3.617188662):0.4647893929,(t392:2.261003288,(t393:0.6813965194,t395:0.5566228331):1.544916189):1.598090352):2.136564361,(t396:4.030314469,((t397:3.080310101,(t398:1.389846652,t399:0.9698859515):1.637892421):0.3087372601,(t400:2.396407584,t401:2.257021439):0.5161754896):0.6334843801):1.727530175):1.10963052):0.1101309141):7.142730111):3.126719888,(((((t402:1.405304486,t403:1.288396291):1.419170562,t404:2.677600212):0.1408309616,t405:2.77676675):3.769991288,t406:6.529747084):5.37640536,((((((((t407:1.571672985,t408:1.502011155):0.2387440042,t409:1.581782731):0.3299156291,t410:1.850957487):0.01302086799,t411:1.805406994):0.8860723081,t412:2.661794676):1.613681901,((t413:2.617954018,(t414:1.128784863,t415:1.035543169):1.459847734):0.5273648021,t416:2.890100628):0.9275111199):0.5245283047,(t417:2.718765742,(t418:1.692991094,t420:1.427951734):0.8688502285):1.530198704):6.538483844,t421:10.21318561):0.1519458226):4.502437248):4.398026639):332.5600742,((((((t422:0.01185641789,t423:0.01176879813):5.200569826,t424:5.203334737):8.720105855,((t425:3.572148219,t426:3.546631806):2.34463564,((t427:3.169454449,((t428:1.472395244,t429:1.443520318):1.286963304,t430:2.714218222):0.4097784515):2.420156695,t431:5.51222463):0.2106096754):7.878205083):0.208504009,((t432:6.490609843,(t433:5.683453349,(((t434:2.90716147,t435:2.739770781):0.3710016666,t436:2.972569492):0.1521327842,t437:3.000804091):2.18738937):0.7059597433):1.495036472,(((t438:2.455646834,(t439:2.062001643,t440:1.934984373):0.2147649839):1.916812492,((t441:1.401725002,(t442:0.8370278296,t443:0.7278597718):0.4878689208):2.229280119,t444:3.339671599):0.433110925):0.6777853123,((t445:2.356733656,t446:2.347811761):1.022621121,(t447:0.3094263112,t448:0.2969043365):3.037582457):1.061621594):2.338182011):5.623498475):6.676951687,(((t449:1.930088515,t450:1.696662749):2.783916796,t451:4.406254011):2.25508688,((t452:4.03048633,(t453:0.7537649954,t454:0.7044937797):3.056605965):0.3450146249,t455:4.092611735):2.245666472):11.99536403):32.11567528,((t456:5.424520482,((t457:3.500200059,t458:3.350530064):1.842032082,(t459:2.788732205,t460:2.652412647):2.310591932):0.03162083699):44.42590108,((((((((t461:0.3884149084,t462:0.355714252):0.3414546251,(t463:0.6836368494,t464:0.6423727289):0.01243059912):0.1286368059,t465:0.6688605736):3.175034758,t466:3.761746366):12.18983665,(((((t467:4.169033778,((((t468:2.834539836,t469:2.733892748):0.1524635733,((t470:0.7258563788,t471:0.6786067668):1.091977447,(((t472:1.071765808,t473:0.9603010297):0.4253453295,t474:1.340705888):0.1705839097,t475:1.292617475):0.09161218957):1.044452414):0.1770403794,(t476:2.284279805,t477:2.148738118):0.1624858409):0.09889888521,(t478:1.698205073,t479:1.632896441):0.6983655018):0.884663759):1.827230133,((t480:0.5185972285,t481:0.5125728706):1.562578727,t482:2.016155772):2.959012483):5.665711495,((t483:0.4008810392,t484:0.3406327779):3.513064438,t485:3.517058045):6.68416643):3.011004796,((t486:1.561653012,(t487:0.1246639712,t488:0.02689795226):1.401890923):6.161200219,((t489:0.447087931,t490:0.4044219348):1.63181112,t491:1.971582357):5.434832442):5.48366134):0.7671017571,((t492:0.7212716045,t493:0.4579722385):0.1593715408,t494:0.5340962019):12.72183773):0.475976365):0.9397676593,t495:14.63946081):12.81476292,((t496:3.166982002,t498:2.773309695):23.94035098,(((t499:2.37454247,t500:2.367027719):3.261982979,t501:5.482608448):12.49489113,t502:17.93006066):8.500802029):0.2141686938):11.93673337,(t503:20.75294082,(t504:0.3849135585,t505:0.3159022172):20.14596991):17.82653576):7.355159092):0.4679673488):298.6592458);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T50.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
