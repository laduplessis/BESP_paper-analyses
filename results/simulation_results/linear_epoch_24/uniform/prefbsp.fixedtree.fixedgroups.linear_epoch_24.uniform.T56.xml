<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((t321:1.551717688,t322:1.54301845):0.6778934267,t323:2.195737033):0.6143997814,(t326:0.9660716309,t327:0.9002162204):1.432573164):4.394458454,((t328:4.470833478,t329:4.450410265):1.510897936,((t330:3.418808779,(t331:1.666064357,t332:1.382081368):1.631554774):1.54885304,(t333:1.561689247,(t334:0.3666101893,t335:0.2599157447):1.120349235):2.85361882):0.9463468767):0.5879778648):2.625053413,((t336:2.077656269,(t337:1.096341855,t338:1.006901111):0.9617899929):2.392176057,((t339:1.482386007,(t340:0.6415801575,t341:0.5755310976):0.5756916345):0.7616325259,(t344:0.06502213284,t345:0.06162438729):1.425140704):1.95718123):3.874448444):2.426478939,t346:9.714844181):0.8022042097,(((t347:4.543453416,((t348:0.1675773179,t349:0.003493427735):3.327522401,(t350:2.816223823,t351:2.765414881):0.3651063185):1.033809294):0.489236824,(((t352:3.036618856,t353:2.894903318):1.242109418,t354:4.08021172):0.06652203078,(((t355:0.4055508563,t356:0.395518317):0.9077450951,(t357:0.739182894,t358:0.6781136863):0.5507293995):1.199295855,(t359:1.470993463,t360:1.126861246):0.9145002901):1.51087553):0.1898870374):3.378527152,t361:7.087031955):1.934951746):31.08475056,((((t362:8.358583155,(t363:5.830205686,((t364:0.8875520953,t365:0.8485068541):3.041850929,((t366:0.8362003026,t367:0.7480116497):0.004393038743,t368:0.6985613164):2.904385459):1.871920463):2.475320574):0.5795238094,(t369:7.324838627,((t370:2.421609297,(t371:1.143378953,t372:1.079950373):1.263892206):3.755070529,(t373:2.445688974,t374:2.433499183):3.547793613):1.135605676):1.1985441):9.437037021,((((((t375:1.030688358,t376:0.7944205426):1.429961081,t377:2.100644216):0.8826224703,(t378:1.346976373,(t379:0.4503320796,t380:0.4063013443):0.8642804799):1.446857046):0.6343504378,(t381:1.556543215,t382:1.470323893):1.673887374):1.186931213,((t383:0.968565872,t384:0.7930395953):2.076931578,t385:2.839704595):1.211924125):5.333809968,((((t386:2.09174244,t387:1.986841778):0.3177637706,t388:2.229091027):5.800277925,((((t389:0.4415978308,t390:0.3828813884):4.223635361,t391:4.482949845):0.2072814441,((t392:3.59950209,(((t393:1.415383659,t394:1.337843634):0.2340876075,t395:1.367186995):1.07231914,(((t396:0.4833451936,t397:0.3480909707):0.06699625139,t398:0.3889653626):0.1234016743,t399:0.3372837736):1.621409352):0.7785395236):0.5683466344,(t400:0.4727819672,t401:0.4322805873):2.733337493):0.4984649958):0.03583830371,(t402:1.606687579,t403:1.475365416):2.068842906):3.034318946):0.8399044512,(((t404:1.396263374,t405:1.223733261):3.246475852,t406:4.46788993):1.232717569,t407:5.627721879):1.393286367):0.2933225176):7.171357257):13.21552296,(((t408:2.185187903,t409:2.156432221):0.0444964983,t410:2.107132714):0.2015506878,t411:2.234588027):25.26420028):8.489149808):82.65819903,(((((((((t412:0.8187789961,t413:0.527009207):1.634950716,t414:2.130412317):6.633352782,((t415:4.767615216,((t416:3.848507029,t417:3.753573871):0.106972477,t418:3.84575255):0.8105271237):2.348785515,(((t419:1.161269503,t420:0.9080676185):1.311282509,(t421:0.6729977757,t422:0.5684261534):1.206101275):4.351887855,((((t423:1.679451966,(t424:1.10134756,t425:1.098230761):0.5619002271):1.751928966,(t426:3.319348532,t427:3.298552397):0.08800000105):0.7818517755,t428:4.158423075):1.459318371,(t429:5.142650102,(t430:4.469924888,((t431:2.547732036,t432:2.454748595):0.2544560895,t433:2.695102292):1.600747233):0.5519333995):0.4326203575):0.3756312532):0.1165852837):1.441388837):0.5782582373,(t434:2.980799002,t435:2.975149335):4.531752506):4.190985816,((((t436:0.5611496235,t437:0.4139032441):2.750525591,((t438:1.528980439,t439:1.521008937):0.8304405487,t440:2.330346826):0.7100620276):7.07603871,((((t441:1.108735395,(t442:0.5043367906,t443:0.4523825165):0.5907344603):1.620104789,t444:2.311113509):1.408377827,(t445:2.416652531,t446:2.297722236):1.284644891):1.164948132,((t447:1.897308183,(t448:1.723383195,t449:1.691412355):0.03077402885):1.49378213,t451:2.890384579):1.174498304):4.810224497):0.06188262821,(t452:7.314389163,(t453:5.91309631,(((t454:4.634112932,(((t455:1.295157914,(t456:0.9419416192,t457:0.8403536326):0.3057021778):0.1187986434,t458:1.154523189):0.8279430907,(t459:1.39858785,t460:1.223124684):0.494484672):2.241602032):0.5872643403,(t461:1.156858338,t462:1.054417918):3.378232643):0.5955713198,((t463:3.332949641,t464:3.312644997):0.3064821479,t465:3.566765885):1.385964987):0.09587255903):1.388209481):1.471048027):1.189740465):7.565351897,((t466:5.277575055,t467:5.240735502):3.249998448,t468:8.343389235):8.088230882):3.72625973,(t469:16.43962644,((t470:1.869488574,t471:1.75119126):4.205643912,t472:5.916280947):10.33690909):3.675620312):37.62378987,((t473:11.50414978,((((t474:0.4239226931,t475:0.3202576831):1.705416845,t476:1.932708447):4.318520086,(t477:0.3057009519,t478:0.1439420997):5.732899931):2.61635545,(t479:3.8478676,t480:3.798539517):4.530810786):2.328431953):7.845173497,((t481:0.7944520312,(t482:0.3526967575,t483:0.0007078580003):0.4311959774):0.6870574913,t484:1.094989622):16.94223708):38.17731014):18.3093599,(t485:69.6260181,((t486:12.87847031,(((t487:1.093745709,t488:1.077388474):5.988617617,t489:6.925774027):2.211276486,((t490:5.127823156,((t491:3.923632333,((t492:0.4404898183,(t493:0.1408674801,t494:0.05204836798):0.2357705346):2.034491504,t495:2.168785396):1.384705522):1.033740085,t496:4.404082056):0.05934402714):1.679775403,t497:5.997054987):2.175731645):3.571910501):27.09517933,(t498:14.42963869,(((t450:0.1138740296,((t343:2.093099384e-05,(t342:0.151650949,(t324:0.2049972473,(t325:0.1466657746,((t311:0.02214165659,(t272:0.07759662008,(((t220:0.03916785832,((t197:0.03408887473,((t173:0.1292929259,(t174:0.00594333986,(t150:0.01176806163,(((t120:0.09497364335,(t74:0.01601642185,(t32:0.1590445454,(t1:1.778306847,t2:1.733452166):2.022636837):4.923170024):4.416436156):1.072753501,((t3:6.654708692,((t4:3.141146919,t5:3.024930652):0.3919774646,(t6:2.39861914,t7:2.381482135):0.8332984171):3.083644268):4.67119059,(t8:10.3310212,(t9:8.598605003,((t10:0.6964163569,t11:0.65685483):7.18220319,((t12:5.356885066,t13:5.318274318):0.579917103,(t14:2.897100354,t15:2.826473769):2.986308152):1.786333257):0.6571885764):1.585364919):0.1433939846):2.653412295):0.01958161659,(t16:1.386032935,t17:1.38324464):10.9108267):1.010408076):2.05670997):0.05147375583):1.090893404,((t18:1.561917522,t19:1.355524069):11.19315435,(t20:3.907145272,t21:3.882159845):8.580888051):3.551589041):0.4579196126):0.872321319,((((((t22:8.32554952,(t23:4.82807541,(t24:1.170073409,t25:1.081339305):3.391847181):3.373519022):0.6114227547,t26:8.451395583):0.7937781918,((t27:4.77002465,(t28:1.555210652,t29:1.334086743):3.213730823):3.59136753,(t30:3.902421196,(t31:0.6703375346,t33:0.4168423876):3.094903128):4.136572212):0.8238822785):5.620354983,(((t34:2.886707526,t35:2.776850606):1.254580849,(t36:1.909098967,t37:1.437174373):2.023506466):0.3701248766,((((t38:1.107581266,t39:1.051276653):1.680423365,t40:2.718588781):0.07412124884,t41:2.731252127):0.4156131889,t42:3.051047415):0.4689206921):9.225658172):0.06200557592,((t43:4.859027858,t44:4.839553998):2.983362561,(((t45:2.383788299,t46:2.303612998):0.6931364682,t47:2.706657369):0.4565956145,t48:3.125101792):4.111344156):4.960217755):0.6254778197,(t49:0.7799090271,t50:0.6833828499):11.99110143):1.173803648):2.225906869):0.6461782732,(((t51:7.511459322,(t52:2.583145311,t53:2.577653873):4.663545763):0.03191199774,(t54:6.057402759,(t55:1.464351093,t56:1.356335004):4.124413679):1.159102968):8.539420668,((((t57:5.777329722,((((t58:0.8355577009,t59:0.753929015):0.03139833297,t60:0.749632462):0.2730486834,t61:0.9938427968):0.1397623721,t62:1.061459311):4.395467031):0.7943787786,t63:6.13594928):5.299579025,((t64:1.205749935,t65:1.104930499):4.962758184,(t66:4.313894011,(t67:2.708391446,(t68:0.8590469117,t69:0.8238694248):1.827216447):1.470592217):1.685368283):5.162394065):0.9866523634,(((((t70:0.4964107772,t71:0.3867892333):1.682433376,(t72:0.1467281873,t73:0.1265805061):1.802563368):1.238543607,t75:2.767899114):1.721507186,(t76:1.79763072,t77:1.652985444):2.35054895):2.534760099,t78:6.52890789):4.057792433):2.29870136):0.5192061969):1.201515593,(((((((t79:1.480766115,t80:1.334329288):4.078391679,t81:5.313334853):0.1445353372,t82:5.427481966):1.434955501,(t83:3.129544633,t84:3.125939497):3.643998905):3.581089131,((t85:0.4905321485,t86:0.4150668372):9.459204613,((((t87:1.204112829,(t88:0.91371641,t89:0.6168153763):0.2268650281):4.08562249,(t90:1.561827372,(t91:0.2383455464,t92:0.2312514179):1.298080988):3.349720097):1.062014861,t93:5.527583648):1.274933808,t94:6.80079685):2.225546977):0.3980342882):0.3394645399,(((t95:2.63502402,t96:2.540659527):6.346325457,((t97:7.007194582,((((t98:0.5183207399,(t99:0.1556742967,t100:0.1217018504):0.3148197163):2.944031199,t101:3.132084657):1.47038151,t102:4.593333329):1.915976103,t103:6.500604979):0.06545028403):1.242696629,((((t104:1.540188514,t105:1.515668129):2.654852176,(((t106:2.145711297,(t107:1.775370954,((t108:1.101058832,t109:1.005280522):0.3921084615,t110:1.392406812):0.001061700466):0.3039095525):0.4559069673,t111:2.126024167):0.2394010914,t112:2.360097352):1.32904409):0.3239267915,(t113:0.9778558398,(t114:0.7095499888,t115:0.1611295084):0.1802000947):2.993612139):2.456911183,(((t116:0.5010456649,t117:0.4328029576):0.7572067612,t118:1.126306214):1.806737031,t119:2.837974917):2.45872507):0.8203151482):0.5894612557):0.6513909219,(t121:4.863693569,(t122:2.270460457,((t123:0.631383654,t124:0.5748500985):0.06973531745,((t125:0.25087132,t126:0.120086204):0.04974913858,t127:0.1365208025):0.194667198):1.565527138):2.581645713):2.296333242):0.01570418994):1.854650673,(t128:3.791669551,(t129:3.642704405,t130:3.591500612):0.1347657504):4.801955883):1.633439071):2.740400633):4.038941038):0.5289842685,(((((t131:0.4886263589,t132:0.3047953326):0.3593821741,(t133:0.2336702462,t134:0.09546189608):0.3407482292):0.5938722213,t135:1.002974917):2.09681689,t136:3.068178719):2.876698925,((((t137:0.5421149761,t138:0.3753251766):2.925539545,(t139:1.638944212,t140:1.590458393):1.65132521):1.032961699,(t141:2.980937686,t142:2.948505901):1.228105575):0.1023224202,(t143:0.574788533,t144:0.4344893473):3.700138266):1.278315396):11.00945076):0.9277799235):0.01176152921):1.986360733):0.07780255785):7.101519135,((((((((t145:3.060866058,((t146:2.002665165,(t147:0.3222681568,(t148:0.05912767848,t149:0.04247033581):0.0574837706):1.672427964):0.8535635302,t151:2.455007451):0.0001152147814):1.051427526,t152:3.441773707):0.7647966915,(t153:1.096543349,t154:1.089781778):3.026101541):3.97371504,(t155:3.600648349,(t156:3.391330753,t157:3.29387085):0.1140995262):4.432841306):2.050245409,t158:9.851870592):1.748021633,(t159:5.482910734,((t160:3.336749151,(t161:2.746826122,t162:2.718335073):0.5294772275):1.456491701,t163:4.555870403):0.422718856):5.852341433):4.457684369,((t164:9.667263204,(t165:7.194220129,t166:7.052456115):2.45320218):3.995026851,((((t167:5.071235504,((t168:0.889211577,t169:0.7607845157):1.831364652,(t170:1.773890472,t171:1.755215899):0.6574561367):2.278275931):3.924058573,(((t172:0.2191212656,t175:0.04384531726):1.40956446,t176:1.4368699):0.313141645,(t177:0.6933742528,(t178:0.3320843968,t179:0.2929395129):0.1870874944):1.056346606):6.608325652):0.2009157778,((((t180:0.8101674419,t181:0.7906237401):2.2419673,((t182:2.025072531,(t183:0.4189143266,(t184:0.2092705211,t185:0.01953980192):0.1878503707):1.482064316):0.4926855792,t186:2.13062247):0.4762773674):2.181792691,t187:4.756880396):1.050403852,((t188:0.5039142564,t189:0.4847758736):4.895012842,(((t190:0.6654742215,t191:0.5965412352):1.587191158,((t192:0.166240477,t193:0.008692114129):1.368882966,(t194:1.258712209,t195:1.221478428):0.07399330433):0.6190197766):0.6920061815,t196:2.495542337):2.306398898):0.3931417193):1.912139861):2.105361589,((t198:1.563254691,(t199:0.2897351288,t200:0.2860881753):1.224384634):2.486675104,(t201:1.671895781,t202:1.3698727):2.274785643):5.093449417):2.17874771):1.618194712):6.884149079,((((t203:4.080386481,t204:3.995003645):5.506060815,(t205:4.991745883,t206:4.984798329):4.30883233):3.703781768,(((t207:1.233049749,(t208:0.8989987988,t209:0.8287050463):0.2604976631):6.136233873,((t210:0.4815864695,t211:0.1867156329):3.718221552,t212:3.620462513):2.919832677):2.698789517,((t213:4.028254323,t214:3.907097266):4.157945333,(((((t215:0.4078692841,t216:0.3473105529):0.1613295293,t217:0.4798131902):4.046220606,(t218:1.737358132,t219:1.453414153):2.738890947):1.368354371,t221:5.378153488):1.980028062,((t222:1.966882555,t223:1.883333291):0.49649954,t224:2.074009125):4.841002541):0.0942225883):0.658929789):2.461407165):4.387699037,(t225:4.080449285,(t226:0.6296265293,t227:0.6177240084):3.374667101):10.15365129):1.721193513):2.501067992):2.424004071):2.956976429,(((((((t228:0.4337909494,t229:0.07296764411):8.427265591,((t230:4.316027608,t231:4.261434107):1.986049673,t232:6.216312152):2.004796862):4.111954543,(((t233:0.09314213817,t234:0.08149732308):6.483431697,(t235:2.958239807,((t236:1.043828195,t237:0.9435215351):1.517959669,t238:2.456733051):0.3361485012):3.554085175):0.3888741823,((t239:1.027633911,t240:0.9994430328):0.5548865765,(t241:0.3549334049,t242:0.317671429):1.193326236):5.134471378):5.23672617):1.320440702,(((((t243:5.091674956,t244:5.090784966):0.9840352715,t245:6.061205028):0.9752104864,t246:6.936846724):0.4971467951,((t247:5.425591778,(t248:4.428492543,t249:4.374652058):0.9748722192):1.104549091,(((t250:0.2182502666,t251:0.2053281435):1.55464693,t252:1.646076547):0.5363325607,t253:2.112550397):4.125682513):0.7653903732):1.693681686,t254:8.693721188):3.909186672):0.981224255,((t255:1.025581723,t256:0.9290817839):2.718009604,t257:3.407286818):9.781436618):1.569116398,t258:14.74046967):1.690854259,((((((((t259:0.48176141,t260:0.4347823072):0.1477405143,t261:0.5719617529):0.6272469004,t262:1.143826932):2.242130463,t263:3.32263105):1.01110457,((t264:3.180952061,(t265:2.780788414,t266:2.747804354):0.2085517205):0.2781943775,(t267:1.837583739,t268:1.814602081):1.375073287):0.8658145836):5.587202345,((t269:4.968648923,(((t270:1.479927784,t271:1.264134156):0.08507264751,t273:1.155723922):2.383856849,(t274:3.187801997,t275:3.173389584):0.2758907294):0.5531397055):1.516429121,((t276:0.7845381992,t277:0.4969096179):2.340765702,t278:2.414158146):2.321575778):3.035992229):1.871245326,t279:9.500426165):0.5557189619,(t280:1.205448011,t281:1.188126012):8.828381558):3.829973869):5.106804249):1.309117784,(((t282:9.492646969,(t283:5.755107629,((t284:4.66594549,(t285:2.469400782,(t286:0.8153923588,t287:0.7952432373):1.546252677):2.062743965):0.8719295046,t288:5.165051735):0.1796289236):3.698503442):4.420665189,(((((((t289:0.9410009261,t290:0.7244095167):1.081823949,(t291:0.09777343247,t292:0.04078799739):1.640549306):0.1384830712,(t293:0.8368903537,t294:0.8129577947):0.8887196941):0.7967762479,t295:2.240766133):0.05503139792,t296:2.130986507):4.252347224,t297:6.247792149):0.003909708398,(t298:2.816131172,t299:2.467824846):3.4292327):6.152137148):5.002567317,((t300:5.830482982,(((t301:1.44547683,(t302:0.1864265587,t303:0.03666243948):1.225992565):0.8284750582,((t304:0.5360531839,t305:0.5141852376):1.444978636,(t306:0.2574078028,t307:0.1905566139):1.594766235):0.05952105818):2.169240974,t308:3.822429138):1.213442214):6.125554013,((t309:3.659616427,t310:3.596287277):5.623096242,((((t312:1.147005146,t313:1.015205016):0.2052576727,t314:1.213061267):1.423624479,t315:2.480904388):5.23077775,(t316:3.322684356,(t317:3.175520348,((t318:1.62924929,t319:1.32860436):0.4034359306,t320:1.624170014):1.105697375):0.08750065182):4.248908085):1.057317272):1.82183259):5.025183409):1.314561083):14.31223428):24.3817092):29.64851762):4.865808941):37.36714225);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T56.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
