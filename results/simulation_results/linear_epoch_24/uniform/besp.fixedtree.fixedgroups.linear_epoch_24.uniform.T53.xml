<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(t470:116.9451462,((((((t471:0.3065968124,t472:0.3053949401):3.927831601,t473:4.103554887):5.120444303,(((t474:0.8876163193,t476:0.7199022818):0.5245741501,(t477:1.03410612,t478:0.8802680027):0.1154742997):2.626311337,(t479:2.588050568,t480:2.518302372):0.9002349561):5.157038494):34.43707463,((t481:17.19852442,((t482:0.500618233,t483:0.2162708367):9.267324879,((t484:6.364867808,(((t485:0.8095643682,t486:0.7412693895):1.796614239,t487:2.505209837):1.628413501,t489:3.754090221):2.058246211):1.596961878,t490:7.392842041):1.471885513):7.429935672):22.78173697,((((t491:8.389091684,((t492:0.9070248193,t493:0.7424305234):0.6093000178,t495:0.8321889438):6.864578493):2.694590087,(t496:0.8909739395,(t497:0.4501182256,t498:0.4413967413):0.438848527):9.41326968):7.137359268,(((t494:0.2654755652,(t488:0.1324748088,((t475:0.0466349192,(t446:0.04877070392,(t435:0.02564178844,((t401:0.2335862894,(t374:0.01809827609,((t363:0.1737170458,(t295:0.008597540158,(((t187:0.0228443849,(t181:0.05749398576,((t141:0.02252391092,((t81:0.0664744148,t1:7.600079005):1.023904995,((t2:4.87171621,((t3:3.225362295,t4:3.185933607):0.1490523194,((t5:2.530320239,t6:2.526225245):0.5330976481,t7:2.986319556):0.2390709787):1.471879575):0.3747252788,t8:5.029482001):3.195845557):4.537606655):0.9625997176,(((t9:7.996836786,(((((t10:1.608596779,t11:1.337900877):0.5124081497,t12:1.845498728):0.05518898345,t13:1.830285783):1.776441559,t14:3.520951262):1.585580794,t15:5.078215884):2.303123418):0.6823841183,(((t16:0.9245341829,t17:0.9057552916):5.264017161,(t18:5.103238643,(((t19:0.7992469513,t20:0.7844755974):0.2986390711,(t21:0.3373636208,(t22:0.2958942342,t23:0.1687991542):0.007877243476):0.7370744801):1.204599787,(t24:1.45573221,t25:1.428014712):0.5688975987):2.352593757):0.6963274219):1.534974135,t26:6.553169704):0.2845000399):4.405185992,(t27:6.308333789,(t28:6.249286782,(((t29:1.27241887,t30:1.258515364):1.451368601,(t31:0.8842438936,(t32:0.7523551731,t33:0.70169665):0.03385806207):1.804094584):1.403266742,t34:3.927308282):2.103178115):0.05015609885):4.715427249):0.6100732963):2.40402375):0.7229311996):0.2462245494,(t35:9.366394306,(t36:7.95806533,((t37:1.566153755,t38:1.536369739):4.429103885,t39:5.809574429):1.881345667):1.376851469):5.252157662):9.510970752,(((t40:4.876876004,(t41:3.583097457,t42:3.335980589):1.180819803):0.5793748143,(t43:0.8654049497,t44:0.650962739):4.226888665):6.420370255,((t45:7.940474476,(t46:3.397683366,(t47:1.916788359,t48:1.838138325):1.444161593):4.33135572):2.602666057,(((t49:1.315005635,t50:1.309309453):5.360196523,(t51:3.435689273,t52:3.431551235):3.125013425):0.003035112434,((t53:0.1559916977,t54:0.04952385698):3.564110103,(t55:2.035717156,t56:1.986982729):1.549739137):2.805404361):2.977811597):0.5090693208):11.91304861):0.5458597171):7.301480722):0.08922803626,(((t57:11.20227997,((((t58:2.639091011,(t59:0.4491467369,t60:0.4127876689):2.077800011):3.074386172,(t61:0.3939295086,t62:0.2075427813):5.154297826):1.387409286,((t63:0.4900879313,t64:0.4450542399):0.9322685469,t65:1.26023474):5.173903171):3.695694958,(((t66:2.680556825,(t67:2.331329632,t68:2.310745666):0.3073168783):5.760788682,(((t69:4.791418844,t70:4.681995694):0.524892631,(t71:0.9252102459,t72:0.8556555407):4.064801905):0.982360906,(t73:2.818944723,t74:2.748239232):3.079047923):2.022959718):1.576909972,(t75:3.667303033,(t76:1.423990741,t77:1.083512654):2.131179683):5.674560135):0.08021453506):0.2383626015):5.303631662,(t78:4.519974206,(t79:1.736084929,t80:1.618403809):2.748188031):9.925352071):0.9205132183,((((((t82:0.605942419,t83:0.5283629137):2.100697589,t84:2.499918668):1.765837998,t85:4.24558386):3.352695579,((t86:2.416245445,t87:2.3097429):0.5213253528,t88:2.486492104):4.516821776):0.8750465585,((t89:1.393924192,t90:1.381923184):0.9099522341,(t91:0.1543567182,t92:0.1172617797):2.135032134):5.318091202):4.369501176,((t93:6.788795638,((t94:0.2663991958,t95:0.03174644611):1.469652941,t96:1.321479462):4.88470638):3.370862358,(((t97:1.145372591,t98:0.8053391856):4.875178829,((((t99:0.5966479614,t100:0.3604181436):1.549826411,t101:1.903006572):1.087286919,t102:2.979465177):0.7950461734,(((t103:0.4287356673,t104:0.1536866924):1.816778564,(t105:0.8976015706,(t106:0.3487243101,t107:0.1795919187):0.501657944):1.021923459):0.9713244015,t108:2.632008526):0.3131875634):1.591813142):1.042358473,t109:5.500772736):2.258624575):1.726781395):1.929907588):12.24653722):0.8056601523):3.4572327):2.435761867,((((((((t110:1.491875513,t111:1.445291501):5.134462847,(((t112:2.937550974,((t113:1.170538813,t114:1.104894053):0.4915066231,t115:1.483313826):1.059153918):1.232709992,t116:3.718535493):1.259335566,(t117:4.962070646,t118:4.856010326):0.0127641927):0.9798967403):0.7975362067,(t119:3.351125238,((t120:1.086113413,t121:1.033491863):2.178005413,((t122:0.134189024,t123:0.1200871486):1.798589635,(t124:1.479639505,(t125:0.3534032926,(t126:0.05425587384,t127:0.01375454938):0.276288847):1.065299803):0.3378839034):1.249918811):0.01345806108):3.16066687):4.759685626,(((t128:2.685587399,t129:2.670230495):2.591165654,(((t130:0.5799126787,t131:0.5655602667):2.766902135,(t132:0.3990227912,t133:0.3853253919):2.794123527):0.1091476293,t134:3.266063651):1.752530014):1.363343091,t135:6.369603087):4.098479042):6.767978417,(((t136:3.048056168,t137:3.033180081):3.325701842,(t138:4.684458168,t139:4.661074392):1.672300686):3.544846444,t140:9.87748468):7.26566177):4.713812131,((((((t142:2.032550666,(t143:1.626212137,t144:1.319576491):0.2991401046):1.81147425,((t145:2.05146752,t146:2.018738687):0.958153038,t147:2.933363815):0.3648389266):0.5588582838,(t148:3.316527276,(t149:1.368703147,t150:1.365605365):1.823211526):0.5367490697):4.66749074,((t151:2.959041345,(t152:2.372699648,((t153:0.3869418812,t154:0.2461590271):0.8848916946,t155:1.128876987):0.9525516854):0.5781006113):4.360565856,((t156:3.768501621,(t157:1.134518967,t158:1.092636334):2.473451144):2.055652635,(t159:5.439029378,t160:5.357844021):0.04084672026):1.1666107):1.010078685):4.309714356,((((t161:2.280599205,t162:2.231462769):1.350595855,(((t163:0.3370024517,t164:0.2490117324):0.2880407639,t165:0.2035958486):0.7090704977,t166:0.7770249028):2.199825241):0.1396726563,((t167:0.2278636991,t168:0.2172320847):0.04743594492,t169:0.1168046853):2.674598278):7.1677948,((t170:2.977707212,(t171:1.668307686,t172:1.535192437):1.271399388):4.206007327,((t173:0.4478453051,t174:0.3652321764):2.657922801,t175:2.978152673):3.767520132):2.730120807):0.9201650307):3.805212253,(((t176:3.41694376,t177:3.408653671):0.9310540124,(t178:4.207332999,(t179:2.764305398,(t180:2.386077652,(t182:1.352583455,t183:1.220364465):0.8592740296):0.3026709068):1.423821993):0.1308148282):7.976342347,t184:11.64523261):1.831079718):4.565258439):1.223151552,(((t185:11.22601136,((((t186:1.453669214,t188:1.258441287):4.181084294,t189:5.417176423):0.235499384,t190:5.642821424):4.414765526,((((t191:4.189394884,(t192:0.2499965943,t193:0.1798428568):3.935899876):0.7631713231,(((t194:1.504024905,t195:1.345857479):1.928746787,(t196:3.059016144,(t197:0.89993306,t198:0.8526507479):2.05584885):0.1606361877):0.8012747432,(((t199:2.091030711,t200:1.913354771):0.7552374915,(t201:1.381067294,(t202:0.05412376251,t203:0.02630705105):1.265316182):1.186057222):0.1915349533,t204:2.587696554):0.7133164202):0.5208343453):0.365281651,t205:4.136347072):0.7288345796,(t206:0.3228873323,t207:0.3162150264):4.486498466):3.832421819):0.7755831119):4.077018217,(((((t208:1.452240185,t209:1.404202013):0.8627489401,t210:2.021774372):3.247070217,t211:5.223067558):4.932476141,((t212:0.5417985746,t213:0.3006764843):8.009630666,((t214:0.1062921696,t215:0.09516720293):1.407681434,t216:1.463390048):6.743873044):1.359548817):0.2743079671,((((t217:0.5169114178,(t218:0.5023639328,t219:0.4161174214):0.01227813176):1.6988127,t220:2.073492789):1.184726075,t221:3.178519578):2.992033204,(t222:2.64808303,((t223:0.894032017,t224:0.8598970865):0.02085748858,t225:0.6984260818):1.717550347):3.488666624):3.433466585):2.571941284):1.410023879,((((t226:1.039304356,t227:1.004617974):3.112209534,t228:4.049255519):0.4248226963,(t229:2.078442379,t230:2.064663272):2.375910268):4.453791325,((t231:3.967354295,t232:3.557521109):3.410771136,(t233:1.898858242,t234:1.897272729):5.032547018):1.46172374):3.78604073):2.445931043):0.8162057682,(((t235:1.483683687,t236:0.8586161979):8.907624939,((t237:6.705659755,t238:6.703048944):1.205226091,(t239:5.765850374,((t240:4.380367503,t241:4.315762962):1.160889648,(t242:4.347105513,(t243:2.122318643,t244:2.042660706):2.210159553):1.080595546):0.05047416467):2.071246549):1.778418528):0.560464232,((t245:1.988340703,(t246:0.9106322666,t247:0.7943807234):0.9515527967):1.893142349,((((t248:0.117905407,t249:0.009828901608):0.8447552233,t250:0.6676267316):0.0702796404,t251:0.5674472454):1.743169679,t252:2.162851023):0.8566457972):5.881593323):4.48574619):4.62823238):0.2151854404):1.098934392):2.242633423):1.16032042,((((t253:5.296673569,t254:5.295829413):0.9328229794,(t255:4.488835533,(t256:2.006020808,(t257:0.4719304286,t258:0.3029655067):1.500313392):2.195071514):1.553900202):12.64363884,(t259:10.88986167,(((t260:3.28284126,((t261:2.575295761,t262:2.44460714):0.4594059851,t263:2.820041604):0.2141171296):2.934501504,((t264:3.517499493,(t265:3.038125377,t266:2.992201469):0.4217482276):0.3616025464,t267:3.662907163):2.0822054):1.489318568,(t268:3.765492769,t269:3.710498415):3.253650839):3.125754443):7.261726475):2.25660265,(((((((t270:3.497388176,((t271:2.154868799,t272:2.133885021):0.5351405757,t273:2.624587681):0.5466523138):0.1306185355,t274:3.223701743):4.737215788,(((t275:0.6380454196,(t276:0.5639524101,t277:0.4686541199):0.0588741243):3.703521639,((t278:0.9389139301,t279:0.8859299518):0.3604619713,t280:0.9660690291):2.634480797):2.027434208,t281:5.526598907):1.539486263):0.4992679013,(((t282:2.581057173,t283:2.42406333):1.53430923,(t284:2.733730743,t285:2.585032563):1.127830803):0.2587464905,((t286:0.6426057892,t287:0.6035134026):1.298263458,t288:1.874257561):2.018523869):3.180787358):0.3372371591,t289:7.409911263):7.012685136,(t290:3.724304373,((t291:0.9175606571,t292:0.8838041816):1.157493557,t293:1.933882077):1.636969738):10.57963965):1.086521666,(((((t294:3.274477505,t296:3.185619373):2.385580031,(t297:2.5862951,(t298:0.03525414928,t299:0.009160635107):2.239544769):2.842525501):5.237143877,(t300:2.244171038,t301:2.09181901):8.057236808):0.2184778735,((t302:4.815702358,((t303:1.604411197,t304:1.256704564):2.228483835,t305:3.289014149):0.9228608357):0.4141400795,t306:4.419446242):5.094838812):2.069456906,((((t307:1.015996878,t308:0.8760078479):6.919569681,(((t309:1.12274538,t310:1.041938148):4.440512167,(t311:3.548787992,t312:3.249584681):1.813648723):1.612528158,(t313:3.959142375,t314:3.944788162):2.532759592):0.4655506275):0.9389989811,(((t315:1.582821874,t316:1.519113597):0.5105488761,t317:1.64716633):1.456430264,t318:3.03338086):4.25370474):2.462528067,((((t319:3.086735395,t320:3.079032797):0.1092104743,t321:3.177913334):3.20377092,((t322:0.4159747807,t323:0.3948145572):1.551559484,t324:1.874504404):4.353577276):1.014992972,((t325:0.459924194,t326:0.3559856084):3.652390747,(t327:1.595253374,t328:1.5582039):2.348313481):2.948348388):2.320108876):0.1967900779):1.960529018):2.20184573):1.510242763):0.2901338096):0.9004567473):0.08982651495,((t329:2.066903225,(t330:1.077858195,(t331:0.4738422193,t332:0.2718433522):0.3803210647):0.9489787684):8.68941369,((t333:0.24829214,t334:0.1541221745):4.04196099,(t335:3.699634731,t336:3.543517673):0.42084685):5.966028027):5.419551426):3.070032298,(((((t337:11.42764501,(t338:6.199107246,((t339:1.165042239,t340:1.138758478):1.564748817,t341:2.596717404):3.259070203):4.933875577):0.2765062394,(((t342:1.727234059,t343:1.698888914):2.318112907,((t344:0.9360815631,t345:0.8905490879):2.52042808,(t346:2.937923472,((t347:0.2253622218,t348:0.2031832403):0.8186058004,t349:0.9999430127):1.797902302):0.4647133516):0.3979889568):6.591976559,(t350:6.663033872,(t351:0.3291197286,t352:0.2838354224):6.304425564):3.349409298):0.4267610945):3.00762839,(t353:1.649928438,t354:1.54157511):11.65785459):0.177225449,((t355:7.043253122,(((t356:2.673415906,(t357:2.164265343,t358:2.084212266):0.2447363975):1.546592371,t359:3.832924204):1.413868156,t360:5.146770823):1.366780444):0.34468389,(t361:4.88486567,t362:4.823676595):1.954669245):5.866273645):0.6111248209,(((t364:5.676705489,((t365:1.082982539,t366:0.7195168236):0.3202441749,t367:1.026099815):4.23128207):2.580738911,((t368:4.646478279,((t369:0.2707861771,t370:0.1947880827):1.469877474,(t371:1.456140265,(t372:0.2382003596,t373:0.2169074529):1.185834493):0.1593766708):2.784269633):2.254150667,((t375:3.025385554,t376:2.544576362):3.351464754,((t377:2.596869991,(t378:0.6660057244,t379:0.6016085863):1.897953801):0.3412878976,t380:2.805633133):2.938874344):0.1505096714):0.8370734407):3.474563207,t381:9.912686406):1.30017161):2.775773267):14.43841931):18.66018107,((((((t382:3.065880037,t383:2.918590846):4.722871991,t384:7.552952022):1.52667331,(t385:3.518662889,(((t386:2.150737376,(t387:0.7641579273,t388:0.392015002):1.2902708):0.05290124224,t389:1.705803747):0.6294575953,t390:2.239230057):0.6623220043):5.541391209):5.927411566,t391:14.28490375):0.02753240467,(((t392:1.576753349,t393:1.485689484):0.9962636594,(t394:0.5115212646,t395:0.4940322117):1.626743394):7.799928488,((t396:0.7987950226,t397:0.6990630134):7.777285904,(((((t398:1.469062488,t399:1.401548245):2.31565928,(t400:2.499258712,(t402:1.318104158,t403:1.269368765):0.7614123541):1.213225489):0.9264659038,t404:4.057421142):1.715119286,(t405:2.225098982,(t406:1.503409806,t407:1.469891011):0.6692455307):3.448934312):1.656584344,(((t408:1.230539306,t409:1.196398876):0.8198436459,(t410:0.3457932441,t411:0.3304414089):1.632311782):1.210058215,(t412:0.1611595606,t413:0.06960926259):2.93872054):3.815396321):0.3245973331):1.294955906):3.806559624):0.2788768262,(t414:7.663984682,((t415:4.164415475,(t416:2.003596766,t417:1.945187538):1.92512029):3.314382767,((t418:0.2455507957,t419:0.13629371):5.691384532,((t420:4.204634115,(t421:1.377261659,t422:1.353793479):2.817622225):1.446183231,t423:5.614525407):0.1627261521):1.213361134):0.08365869408):4.840078876):31.21918875):1.968727291):2.995017919):24.52792184,(((t424:5.096002626,(t425:2.752768562,t426:2.634703197):2.317347931):14.23904052,(t427:5.552097958,(t428:0.5774985516,t429:0.4426053913):4.968395608):13.58509515):23.36235333,((((t430:0.2296599183,t431:0.2243712597):0.2729788637,t432:0.4452304487):9.818116359,(t433:8.017137334,((t434:0.6107223889,t436:0.4523357077):6.520534582,(((t437:2.284397632,t438:2.194207245):2.797088868,((((t439:3.001825682,t440:2.73896961):0.09022842325,t441:2.825222431):0.08735706731,((t442:1.6207915,(t443:1.474551827,t444:1.304423904):0.08069373148):0.8012677302,(t445:1.360239103,t447:1.271922077):0.7434019304):0.3389161999):0.7817601085,(((t448:0.2595435121,t449:0.1569582211):2.520536377,t450:2.498470419):0.09285106098,t451:2.553860779):0.1678286918):0.959203561):1.535032133,((t452:1.277012227,t453:1.205507467):1.255005761,(t454:0.2051067076,t455:0.09333868864):2.195148377):2.660702987):0.2761753676):0.7923446916):1.86706914):14.64925444,(((t456:9.346249928,t457:9.309629207):9.049223482,(t458:15.77096688,t459:15.74233267):2.470301965):2.060762209,(((t460:1.378142977,t461:1.293774913):0.6356469131,t462:1.791037569):2.310663908,t463:4.028881974):15.70745366):2.007375318):17.3653639):29.7509736):21.83199073,((((t464:0.1636830531,t465:0.08174359236):0.7857651034,t466:0.8672492065):2.052862123,t467:2.883247946):2.35461295,(t468:0.4637051261,t469:0.3949516656):4.616221329):85.3327039):26.68783777);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T53.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
