<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t500:1.273435643,t501:1.188092096):28.12411683,((t502:1.414520706,t503:1.141547896):22.5090138,(((t504:0.2486484054,(t445:0.1646848344,((t429:0.1159628736,(((t389:0.1039052178,((((t267:0.04223334286,(t235:0.05025692088,((t178:0.04616868852,(t150:0.04097018759,(t137:0.05592658775,(t118:0.08489557152,(t99:0.06936614658,((t19:0.1279567063,t1:1.78176507):3.799314855,t2:5.205560954):3.873202471):1.897214847):2.01923266):1.140376051):3.017086779):0.6794481563,(((((t3:4.65808538,t4:4.626541175):6.355100871,(t5:10.44305014,(t6:10.3004793,(t7:4.667250433,t8:4.44844862):5.439452491):0.124367903):0.5182473076):1.251681538,((t9:0.209602574,t10:0.1729015211):9.702775348,(t11:5.722011118,((t12:2.674518292,t13:2.527593223):2.785674591,(((t14:0.9005876524,t15:0.889138484):1.668203762,t16:2.286425242):2.105604747,t17:4.374579704):0.602757969):0.2236046687):4.121171797):1.827131623):5.031665177,(((t18:3.284783343,(((t20:1.325114174,(t21:0.8179314768,t22:0.7237602038):0.3779562669):0.4412048685,(t23:1.180419741,t24:1.106999699):0.333302148):0.1037112758,t25:1.498395606):0.9220444394):4.33933028,(t26:1.176287328,t27:0.9852483623):5.536042773):8.146356513,(((t28:6.294857715,((t29:1.598354329,t30:1.581167902):0.1508408452,t31:1.71932858):4.340397031):1.69729295,(t32:1.410890585,t33:1.334621819):6.343671087):0.9308565229,(t34:7.146761025,t35:6.913374998):1.41493831):5.728585157):0.3005546519):0.2477964373,(t36:5.153528877,((((t37:1.912371603,t38:1.904897278):1.229575564,t39:3.116636547):0.9654917003,t40:4.075843742):0.6962638029,(t41:1.555542085,t42:1.493436517):3.147035867):0.1599215053):9.385475999):0.237169547):4.931834056):1.602282718):3.458550945,((((t43:3.720822863,t44:3.715757439):2.320712047,(t45:0.750168296,t46:0.7225951357):4.952864111):10.65233209,((t47:9.097696936,(((t48:2.796313626,t49:2.78343485):3.646464991,t50:6.157172262):1.812651989,(t51:0.670301442,t52:0.5870646527):7.28751712):0.7903055202):2.170250721,((((t53:1.936534334,t54:1.933184756):3.695057073,(((t55:0.9903651793,t56:0.9041553192):0.7873402619,t57:1.467601602):2.229695036,t58:3.591012633):1.511712218):2.990213792,t59:7.896389184):1.995976001,t60:9.871131111):0.1780627284):5.041378355):3.617463907,((((((((t61:1.521720554,(t62:0.3806206197,t63:0.08152122933):1.028610688):1.194870228,t64:2.131673086):5.271901888,((t65:5.982751305,(((t66:1.523046675,t67:1.380747587):2.275390745,(t68:0.5982048873,(t69:0.5120794694,t70:0.4618123332):0.05685582231):2.949330482):0.2521589959,((t71:0.4876302033,t72:0.3186206631):2.918526913,((t73:0.1834903056,t74:0.180134342):0.4999269493,t75:0.6501709077):2.477624462):0.2565502583):1.919467112):1.364608461,(((t76:0.7218403225,t77:0.6127930344):1.606655376,t78:2.051380772):2.348845348,(t79:2.864359992,t80:2.65884986):1.449410315):1.976887936):0.04515766317):0.6260378138,((((t81:0.9746553252,t82:0.853710211):2.714586126,t83:3.348640549):0.5985582244,(t84:1.939543303,((t85:0.811202694,t86:0.799369634):0.5993510772,t87:1.354235626):0.3507457925):1.831680546):0.9611652266,t88:4.277755838):1.365967822):0.009662506409,(t89:1.809974855,t90:1.80931179):3.644119414):7.121296186,((t91:3.095765511,(t92:0.2044482847,t93:0.1911905004):2.834685446):4.028088516,t94:6.988488205):5.45046119):0.9885079388,((t95:3.929651365,t96:3.917980226):1.611960958,t97:5.524801467):7.853785745):1.812946983,(((((t98:3.826252265,t100:3.63762293):6.759518664,(t101:6.877075034,(t102:4.052614192,(t103:3.213515719,(t104:2.524369929,t105:2.482741551):0.5854429021):0.8075227743):2.800664779):3.512663355):0.05814058811,(t106:4.739581141,(t107:1.679848848,t108:1.594153247):2.924058229):5.387390448):2.218625372,(t109:6.740720483,(((t110:0.8538442315,(t111:0.1224161094,t112:0.0380766919):0.5097500435):4.087101208,(t113:3.323680745,t114:3.322905694):1.260638469):1.414425916,(t115:0.8808077611,t116:0.8751171715):4.973257012):0.2128354352):5.162580382):1.197464286,(((t117:0.4271338541,t119:0.01474870468):0.741009876,t120:0.2895720698):8.564555984,((((t121:2.944265735,((t122:0.9503069264,t123:0.9431358864):1.092576344,t124:2.008170979):0.7484835518):0.5393392478,t125:3.201941884):2.126851385,(t126:4.966310118,(t127:3.114398688,(t128:2.998760032,t129:2.772078433):0.08889642022):1.666680326):0.3410673472):1.968857374,(t130:4.470203269,(t131:3.989750096,t132:3.910662033):0.3717866183):2.270942943):1.243211767):2.618006573):0.6233816363):0.1397344082):4.090821463):0.441785905,(t133:9.905226103,(t134:5.834516198,((((t135:1.907452951,(t136:0.9264946021,t138:0.6742354501):0.9443445507):1.61931555,t139:3.107200527):0.1831030133,t140:3.031709944):0.7556552498,(t141:3.277716081,t142:2.951870337):0.4979940715):1.260280994):4.044507786):5.750626281):3.279116635,((((t143:6.324001773,(t144:2.705877455,(t145:0.1596217442,t146:0.1418835579):2.486089025):3.58864473):3.170469045,((t147:6.550738534,(t148:0.0413012287,t149:0.01398489125):6.405606169):0.4645714891,t151:6.786772142):2.332304302):0.2593781289,(((t152:4.138765591,(t153:0.3354783975,t154:0.2872627661):3.493738048):0.9670031558,((t155:2.639835176,t156:2.632257323):1.879015085,(t157:1.722132408,t158:1.58420878):2.7526015):0.02848942493):4.064721861,(t159:3.828227074,((t160:0.4159544076,t161:0.3583736096):0.3076287442,t162:0.1790842644):3.032000953):4.542282511):0.08417000458):6.356185567,((t163:0.6736023029,t164:0.6603065183):8.052171964,t165:8.624615521):5.314041885):1.648890016):5.445382428):1.729437062,((((((t166:0.6753836425,(t167:0.4096565135,t168:0.3055885387):0.2597928435):9.307442865,(t169:2.638542196,(t170:1.337005106,t171:1.131881533):1.290253185):7.130008504):0.05245033364,(((t172:0.7605961409,t173:0.7213236877):4.416485547,(t174:4.18645771,t175:4.18594659):0.9004427411):0.9224230734,(((t176:2.096902591,t177:1.897137633):1.095245893,(t179:0.9251186558,t180:0.8892492498):1.91545896):2.177070964,((t181:1.800017954,(t182:1.464405155,t183:1.262869623):0.145090824):2.016877477,t184:3.323408006):0.9391796973):0.5983081783):3.474558415):1.772274451,(((((((t185:2.557458496,t186:2.530419014):0.06206427881,(t187:1.997728923,t188:1.917745353):0.5130704804):2.137342987,((((t189:1.577527958,t190:1.435382026):0.2706467144,(t191:1.333767874,t192:1.283358875):0.2284578822):0.08100489907,t193:1.398942581):0.9925852606,(t194:1.429927544,(t195:0.7054279333,t196:0.6481137897):0.6445765829):0.7370390622):1.619371532):0.6229750214,t197:4.183548452):2.892534406,(t198:4.601819694,(t199:4.344147856,t200:4.331806533):0.06790083081):2.333766779):0.1536746484,(t201:5.451519282,t202:5.41728393):1.356319174):0.8054600766,(t203:1.953646976,((t204:0.1225704034,t205:0.1181832784):0.1370422755,t206:0.05211366647):1.62762562):5.561715647):0.8610557528):1.205041709,(((t207:3.750077266,t208:3.671877022):0.1754627237,(t209:2.44664082,(t210:1.689572514,t211:1.653283947):0.5885970198):1.393015125):3.497779378,(t212:3.14044334,((t213:0.523413405,t214:0.5227309839):0.515006939,t215:0.9835058797):2.080050922):3.836598122):1.561410865):9.081316246,((((((t216:0.5241780916,t217:0.4668725349):0.4764780945,t218:0.9401279208):3.901103858,t219:4.805316514):0.07913092866,((t220:3.765657121,t221:3.596180732):0.5431340514,t222:3.831483609):0.3342105446):7.067779217,(t223:3.576936495,(t224:1.877372582,t225:1.858216936):1.689304756):7.627881439):2.419266245,(((((t226:0.9449617554,(t227:0.4060660896,t228:0.3930279829):0.4327894953):0.789087066,t229:1.351989002):0.3056639669,t230:1.570551581):4.094588737,(t231:5.488299773,t232:5.332370211):0.05142075824):3.390598163,(((t233:2.472212322,t234:2.424173065):5.275799514,((t236:1.745916039,t237:1.562861439):2.91893214,((t238:0.4239267421,t239:0.3745952931):2.111703412,t240:2.472095138):1.929804979):2.865417433):0.2495044232,t241:7.499514944):0.6930619396):3.991034428):3.071973739):0.4153986321):0.7577962861,((t242:1.779091991,((t243:0.7467007192,(t244:0.6464691516,(t245:0.4713390569,t246:0.4269173003):0.1708874338):0.03552118337):0.8031518151,(t247:0.5982027553,t248:0.5853967156):0.7863507201):0.1907433185):14.09038598,((((t249:2.48801035,(t250:2.048961401,(t251:1.885946077,(t252:1.621038655,(t253:0.869270903,t254:0.8483639257):0.7425766347):0.2246820516):0.08138072426):0.4208354838):9.526709425,((((t255:3.092533421,((t256:0.9723485803,t257:0.9418470741):0.6982914394,t258:1.598412911):1.402861537):4.825359593,((t259:6.840451842,(((t260:0.6489484904,t261:0.6055854599):1.695466015,(t262:1.012704435,t263:1.006628985):1.231485638):0.2218095091,(t264:1.302981676,t265:1.282977008):1.030900845):4.199224108):0.7947731613,(((t266:0.4869751189,t268:0.1824621758):3.843823201,(t269:1.498804529,t270:1.484297209):2.295652356):1.100114331,t271:4.875392756):1.69328734):0.09839214802):3.295481719,(((t272:8.257303014,(t273:7.615503272,t274:7.546863287):0.5833030861):0.3458949897,((t275:2.267365576,(t276:0.3428554889,t277:0.06692700644):1.885708254):5.79101017,t278:7.654218395):0.2716234801):0.2631025589,(t279:6.716340857,(t280:0.7109526773,((t281:0.07831908994,t282:0.05549186607):0.5318934966,t283:0.5231686763):0.04574119187):5.918532792):1.349446817):1.059161063):0.4051299793,(t284:3.91550429,t285:3.871133597):5.310587386):0.2248751713):1.9991075,((((t286:3.467572079,((t287:0.1734051298,t288:0.1666624805):3.025776676,t289:3.045350071):0.1841217899):6.471020233,((t290:1.252450668,t291:0.6982204719):0.8487889399,(t292:0.1597770213,t293:0.07377574756):1.326285448):7.437186091):0.2053506775,((t294:1.498634928,t295:1.388839853):7.437660369,(((t296:0.4366498169,t297:0.08460359683):2.871703944,t298:2.941159283):3.921568863,(t299:4.099393741,(t300:1.988982108,t301:1.978004313):2.095185919):2.641221576):1.026031583):0.06041037408):0.2202501653,(t302:3.707203695,t303:3.706198015):4.187155517):1.018326021):0.4180883129,((((t304:1.035775196,t305:0.9190513436):3.755118786,(t306:1.792652665,t307:1.769529923):2.758315869):1.51603565,(((t308:2.765991604,(t309:0.7889899846,t310:0.6752496434):1.723886263):1.520938455,((((t311:1.479180847,t312:1.199830434):0.3702552331,t313:1.539070081):0.6281997891,t314:2.090393412):1.213484841,(t315:1.542868802,t316:1.522005993):1.751471818):0.1012505718):1.23640361,t317:4.585932729):0.3890609098):0.4294690626,(t318:0.7703393072,(t319:0.312796732,t320:0.1845692006):0.3381328604):4.632838847):2.522708846):1.089004835):0.5103446572):1.096383931):0.2223211034,((t321:3.006177463,(t322:2.451374535,t323:2.239842507):0.511763486):0.5057336795,t324:3.221525042):7.035484376):1.013842406):6.017951908):4.12066763,((((((t325:0.8031582388,t326:0.7088476827):4.894110295,(t327:4.217216578,(t328:2.476119722,(t329:1.451995654,t330:1.451684899):0.9825376035):1.628561136):1.229862315):2.595379274,((t331:3.491489041,((t332:1.846885384,t333:1.702185744):0.6270240922,(t334:1.095072752,t335:1.037275097):1.197203585):1.001608368):3.939512647,t336:6.950274126):0.1591299855):5.106790149,(((((t337:1.898928255,(t338:0.9568908469,t339:0.8613587057):0.9352039251):0.01314649638,(t340:1.425630862,t341:1.180939311):0.3030550438):0.3581345869,(t342:0.4492241191,t343:0.2503727736):1.320719852):8.000792718,t344:9.529400968):1.618376001,((((((t345:1.419894035,t346:1.245851896):1.140650501,t347:2.162092845):2.550334755,t348:4.57738484):0.3753991798,((t349:1.208956211,t350:0.8287963579):2.276023125,((t351:0.5693493076,t352:0.3980956665):0.8790141421,t353:1.220787363):1.585872438):1.441523857):0.6352674975,(t354:2.961660043,t355:2.954159591):1.868978437):3.458239425,(t356:0.2291652641,t357:0.2046324375):7.908525035):1.558932974):0.1755455082):2.265976905,(t358:1.746918974,t359:1.614539229):10.23798563):5.431422241,(((((t360:2.262693878,t361:2.201025046):5.344882714,((t362:1.205926191,t363:1.134751115):4.440402806,t364:5.420177541):1.885255093):3.546936489,(((t365:4.457925896,t366:4.291668681):2.207770682,(t367:4.542898714,t368:4.470797054):1.625158424):3.117675019,t369:9.154758825):1.018665427):1.114132305,(t370:9.200007338,((t371:1.836285878,(t372:1.484261833,t373:1.335864113):0.2080531722):4.270282782,(t374:4.245907827,((t375:1.280504018,t376:1.27268272):1.642109618,((t377:0.09668998063,t378:0.08393047114):0.9630753901,t379:1.011762696):1.835033875):1.260179307):1.2551025):3.053672154):2.078748434):3.192980994,(((((t380:1.145416599,t381:1.062441241):2.281703398,t382:3.216780069):5.849235796,((((t383:0.9316314598,t384:0.8996662898):2.224025524,((t385:1.09642899,t386:1.091664066):1.755505659,((t387:0.6655594717,t388:0.5551938443):0.793698058,t390:1.018605399):1.351456005):0.2081681177):1.015151404,(t391:3.110185931,t392:3.026057928):0.4246454326):2.898593116,(t393:1.626677768,t394:1.455775154):4.647717773):1.989787081):0.2606080658,((t395:2.257789709,t396:2.069712026):2.293897155,(t397:0.2870200343,t398:0.08418990457):4.056775389):3.592435406):2.770780919,((t399:2.298533954,((t400:0.6322909836,t401:0.6093411847):0.3718246398,t402:0.8619877514):1.175684497):0.6031412616,(t403:2.266506808,t404:2.256313697):0.3192603993):7.564999974):1.323161646):1.819335328):0.1246958122):8.271514744,((((((((t405:0.5134472982,t406:0.4678531876):1.088856832,(t407:0.8723572209,t408:0.633271922):0.6511232278):1.619967049,t409:2.850986526):3.26879819,(t410:1.210511636,t411:1.058884228):4.886391521):3.440600218,t412:9.270349825):3.046423445,(((t413:2.674327876,(t414:1.701136951,t415:1.666095425):0.9404742232):3.273286112,((t416:4.924806575,t417:4.885531999):0.6102794735,(t418:5.150513035,((t419:2.511184683,t420:2.500479513):1.784251038,t421:4.244015449):0.8326129845):0.3241392157):0.3259801968):5.72869412,((t422:3.416353091,t423:3.220127815):7.680575736,((((t424:0.7738520428,t425:0.6009617978):0.950258272,t426:1.465114059):0.4213362272,t427:1.731255658):7.463758146,t428:9.0504638):1.222748107):0.2263334506):0.5687600749):5.766663342,((t430:1.845175958,t431:1.778899235):3.75360876,((t432:1.333313888,t433:1.293110483):3.559352487,((t434:3.685063707,(t435:1.455976501,t436:1.415676483):2.199655564):0.2101308551,(t437:1.990588193,t438:1.871413622):1.725668372):0.9344716457):0.5846915165):11.06489914):1.53858651,((t439:2.722968172,(t440:1.679623361,t441:1.583456228):1.012627964):3.5690466,(((t442:1.594031355,t443:1.564126044):2.923198807,(t444:0.6275255083,t446:0.331195454):3.816288319):0.1834473666,t447:4.316248156):1.457111389):11.18074908):1.391497302):10.8092078):5.383062587):38.68050732,(t448:9.17297896,(t449:1.907971805,(t450:0.4598053463,t451:0.2054715047):1.435903135):7.199419792):63.91797462):2.991365065,(((((t452:0.9968371059,t453:0.7281106602):17.3818262,(((t454:1.979067606,((t455:0.2236810437,t456:0.1213932586):1.366033598,t457:1.428135717):0.3707224761):5.314758877,((((t458:0.3527436186,t459:0.1620139922):3.508022112,(((t460:0.7076348056,t461:0.6558132204):1.288175135,t462:1.822198294):1.535367747,((t463:1.120562634,t464:1.056921835):0.1058258258,(t465:0.9169504267,t466:0.9013256647):0.2110204791):2.107201563):0.06283689443):0.7591089028,t467:4.012918122):1.352677876,(t468:1.47624795,t469:1.436511691):3.706961305):0.9425253022):1.258807996,(t470:6.153510326,t471:6.068277202):1.03036188):9.51689435):5.252704438,((((t472:2.842009189,(t473:0.9139541803,t474:0.8903546413):1.78315735):1.914900826,(t475:0.2994444749,t476:0.258452309):4.234355221):1.686462947,t477:6.065025635):1.195104241,((t478:2.862881493,(t479:2.774594712,(t480:1.355004581,t481:1.252176134):0.9158198571):0.0873177195):3.122081644,t482:5.344757011):1.245213849):14.17960847):3.793279645,((((t483:0.224673037,t484:0.1413202854):5.542974136,(t485:3.231851587,t486:3.20075832):2.112063621):4.686948176,t487:9.968923978):6.005131116,t488:15.85010884):8.097971917):2.123555153,t489:26.03356609):46.05153995):16.56493564,(((t490:0.3377962204,t491:0.3083273968):1.728943114,t492:2.017967575):16.28480777,(((t493:0.9826217896,t494:0.8462299306):7.928196457,((t495:0.3453987283,t496:0.08685975241):0.3411654066,t497:0.4113997849):8.029723386):2.524713257,(t498:2.92892465,t499:2.898159831):7.963340753):6.661894185):70.15512561);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T92.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
