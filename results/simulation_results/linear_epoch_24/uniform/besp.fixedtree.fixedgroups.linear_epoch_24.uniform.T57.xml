<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(t415:152.5716384,(((((t416:2.581685475,(t417:2.017957242,t418:1.821163313):0.5336258784):12.78567415,(t419:2.497602608,(t420:0.728137348,t421:0.6279017205):1.75678537):12.61760898):33.14099518,((((t422:2.398428293,t423:2.366446201):2.094965512,(t425:1.800275711,t426:1.756297121):2.037772117):9.363279774,t427:13.11453642):26.87800258,(((((t428:3.506724488,t429:3.435516812):0.5803796747,(((t430:1.302433967,(t431:1.062502652,((t432:0.7133626857,t433:0.6532199656):0.1361493442,t434:0.7685634526):0.1982071351):0.01575697442):1.489905177,t435:2.464584851):1.105869597,t436:3.509401792):0.05545457696):0.09412922043,t437:3.495602847):4.526736777,(t438:3.42662558,((t439:0.2867950054,t440:0.1872416638):2.739118208,t443:2.154579381):0.1425498382):4.51757496):11.59554128,(((((t441:0.3332377428,(t442:0.1930944566,(((t424:0.1651880949,(((t392:0.3464196956,(t346:0.02857830375,(t289:0.09980014339,(t274:0.2658553343,((t209:0.3609965175,(t184:0.1046172888,((((t82:0.1519272609,(t73:0.08340073399,t1:7.997947163):1.01320815):5.373334534,t2:14.37133109):0.4041663068,(t3:14.60319443,(((t4:4.521430884,(t5:2.117591277,t6:1.95301971):2.193002938):5.559436317,((((t7:1.783121276,t8:1.752787973):2.292306219,t9:3.805970943):1.914048578,t10:5.638547415):0.9705171351,((t11:1.242615507,t12:1.059208532):3.684365297,t13:4.500120718):1.546279269):2.741714008):2.080419849,((((t14:2.568469902,(t15:1.233137056,t16:1.197928031):1.324522143):1.240401849,((t17:1.628965444,t18:1.62673193):0.01682288711,(t19:0.384339168,t20:0.2990745196):1.207607914):1.992565159):3.561680178,t21:6.966725322):0.4618675319,(t22:6.636461766,(t23:5.055125318,t24:4.657484609):1.380782501):0.7034387178):3.001040191):2.418672611):0.1663453075):3.523422294,(t25:11.16670357,(((t26:0.4733523868,t27:0.3863619005):4.64466194,(t28:3.944434706,(t29:0.186937249,t30:0.09965940263):3.710565524):0.9909230499):0.7539211452,(t31:0.06189753968,t32:0.03104516692):5.477926082):5.014008287):4.626207297):2.450917208):2.185977006):5.133780927,(((t33:6.270469427,(t34:1.586088618,t35:1.528044846):4.312461255):7.174193745,(((t36:2.597789864,t37:2.470580682):6.484755327,(t38:5.326988394,t39:4.923832562):3.613930865):2.939347057,(((t40:5.25928441,t41:4.884411109):2.810419731,((t42:1.347181291,t43:1.324493314):2.312502569,t44:3.614706413):4.015083271):2.923650548,t45:10.53896891):0.3980684988):0.9849691834):10.05360332,(((((t46:3.431261008,t47:3.196672746):2.253893018,(t48:1.029888189,(t49:0.7063394586,t50:0.528338628):0.08451017147):4.408122366):7.062432019,(t51:5.433966979,(t52:5.175776938,((t53:2.105467266,t54:1.967994414):1.354095062,(t55:1.227732459,t56:1.184572878):2.081641291):1.55795028):0.06781218559):6.560596986):5.72668261,((((t57:6.409047359,(t58:4.586259511,(t59:1.052018776,t60:0.9899701712):3.461897552):1.688772663):0.8732171891,((((t61:0.6501767119,(((t62:0.08554881925,t63:0.01341535218):0.2419390024,t64:0.2461916878):0.1723010752,t65:0.3302147008):0.139083797):1.036545795,t66:1.498934252):3.796908434,t67:5.220667862):0.3222197951,(t68:3.984073795,(t69:0.4183756146,t70:0.4050892429):3.505421556):1.267453863):1.01153878):1.825047984,(((t71:1.834212868,t72:1.621181421):0.4056600269,t74:1.81614755):2.156146564,t75:3.915181917):3.326626638):5.361498928,(t76:5.963108008,t77:5.798717726):6.614397104):2.666902622):0.6899204757,((((t78:1.503784111,t79:1.353639457):4.381442731,(((t80:3.532352775,t81:3.520495722):1.075477101,(t83:0.3606721436,t84:0.1622649835):3.747024237):0.1853471415,((t85:0.5592590185,t86:0.4760803567):2.200850016,t87:2.656742003):0.9707262087):0.8100150144):5.064096147,t88:9.412341288):1.001197764,((t89:7.534056005,((((((t90:2.066600341,((t91:0.3572713879,t92:0.2675813019):1.542099734,t93:1.697540179):0.1589116002):1.467402253,(t94:2.84685987,(t95:1.676688916,t96:1.660942289):1.089405176):0.3484609287):0.5884912042,t97:3.291740644):0.2163312526,t98:3.477045371):2.23914258,t99:5.264056966):0.3801573859,(t100:1.281729,(t101:1.178117765,(t102:0.05975190053,t103:0.01311099219):0.9240437813):0.083339594):4.076359813):0.540757404):0.9169998098,((t104:3.373428567,t105:3.21079157):0.3766236481,(t106:2.47236258,(t107:1.963799406,(t108:0.5368552688,t109:0.5230656546):1.398076365):0.2559368255):0.8362830542):2.775794035):1.708339975):3.786118136):2.66456267):1.369906175):1.723835187):1.313484677):5.381159889):5.75547023):0.4435959299,((((((((((((t110:3.015855205,t111:2.903945013):2.406262644,((t112:1.775348228,t113:1.652794555):0.208229475,t114:1.708457727):3.251993162):1.182835063,(t115:0.7768369667,t116:0.4067058466):5.139298158):1.028886364,(t117:1.345617287,t118:1.230086429):5.209801482):3.46490307,t119:9.634560264):4.402411594,(((t120:0.8304450296,t121:0.7929660755):0.09832708901,t122:0.8899704308):11.3980707,(((t123:0.05340199602,t124:0.01453793152):10.26168964,(((t125:6.646629601,((t126:3.656467721,(t127:2.728189031,t128:2.586050587):0.8407129336):2.33790076,((t129:2.404930177,t130:2.401914617):2.43074692,t131:4.634919753):0.896231312):0.6425089009):0.9961100511,((t132:3.012534143,((t133:0.3000781317,t134:0.2449701619):1.757200823,t135:1.912178222):0.9280566817):2.912653036,t136:5.636072107):0.9829728532):0.9828842897,(t137:3.482711215,t138:3.288540204):4.11671403):1.561557052):0.7964975429,((t139:0.03964378992,t140:0.007686106297):3.712119621,t141:3.695367522):5.983309161):1.127181772):1.659188226):4.970739633,((t142:6.984010606,(t143:5.049367265,t144:5.02502526):1.892085752):0.8043595974,(((t145:0.5121968569,t146:0.3977002445):0.1362199686,t147:0.4532398777):6.210955952,(t148:0.7843606067,t149:0.6829529395):5.842325004):0.6355741429):9.599753643):2.668770817,((t150:10.67480928,t151:10.60211695):7.703406871,(((t152:5.468844229,t153:5.430559265):3.407081908,(((((t154:0.2750032809,t155:0.2514160144):1.428063967,t156:1.643250796):2.681630853,t157:4.225211409):1.935975389,(t158:1.153732402,(t159:0.9542819073,t160:0.7756441885):0.09003615007):4.752504949):2.410779653,t161:8.026055916):0.01345145629):6.297526512,t162:14.13623622):3.110463334):1.027730164):0.02682538285,((t163:3.641760735,(t164:2.505411262,t165:2.432148455):0.898895267):8.785399912,((t166:0.8787907653,t167:0.5967882809):5.591220522,t168:6.030194862):5.545489868):5.800856458):1.415236087,(((((t169:3.162653221,t170:2.972162787):2.412277142,t171:5.284782173):0.883836439,(((t172:0.3434568328,t173:0.0735665542):0.2740650298,t174:0.1741648443):5.009694385,((t175:1.1536387,t176:1.043404563):1.314767894,(t177:1.481367742,t178:1.465766095):0.8631952249):2.667584163):0.4195343018):4.410257431,(((t179:1.064608578,t180:0.9157719429):1.729921781,t181:2.629365827):2.12824915,t182:4.724258164):4.665268686):0.1940441933,((t183:2.089210859,t185:1.881170166):5.42534222,((t186:0.9680222221,t187:0.8654373846):5.736118228,(((t188:3.225838576,t189:3.15584868):2.260295648,((((t190:1.279999521,t191:1.211297679):0.6480932423,((t192:1.021394048,(t193:0.9523021747,t194:0.8858820755):0.06554214706):0.2292224145,t195:1.089980289):0.5142388839):0.414912216,(t196:1.149613474,t197:1.066199569):0.7602088209):1.029130692,t198:2.853687259):1.989063293):0.7384810743,((t199:0.1564394925,t200:0.03711142721):1.903098909,(t201:1.152191586,t202:1.005596982):0.7584086917):3.408345205):0.3617862109):0.5972110913):1.706276467):7.563499972):3.391987699,((((((t203:3.208497557,t204:3.193755172):2.914403153,(t205:0.7069794752,t206:0.676258784):5.200039026):6.008323439,(((t207:6.017453733,t208:5.979615156):0.7079823672,t210:6.118128953):2.036744803,(((((t211:0.9820095594,t212:0.9595080115):0.4075100977,t213:1.290408087):0.01308928216,(t214:1.057571671,t215:0.9962798055):0.05776030964):3.281838334,t216:4.318320672):0.1488522413,(t217:2.921484931,(t218:1.641870131,t219:1.520292185):1.236046229):1.27231963):3.24034545):3.073983429):0.8935682171,((((((t220:0.570547681,t221:0.4642924301):2.349533468,t222:2.785744921):2.580043458,t223:5.328483294):3.328608729,((((t224:0.8362632279,t225:0.8008843937):0.2241756575,t226:1.022281844):0.7785356334,(t227:0.6965538789,(t228:0.4960505885,t229:0.3774897919):0.1812110061):1.082278825):6.526429398,t230:7.993161096):0.2477433467):0.03209285319,t231:8.138682624):0.02253066163,(t232:7.30207263,(((t233:1.721098726,t234:1.691997285):1.276803943,(t235:1.97716875,t236:1.820853312):0.8611213446):1.821598803,t237:4.370980294):2.43131834):0.8119535105):2.291937226):0.8556165104,((t238:5.787846745,(((t239:2.937107504,t240:2.852029483):1.361599397,t241:3.900549436):1.080898331,(t242:0.3772602812,t243:0.2443522527):4.430301694):0.1661306422):0.2473574646,(t244:0.8862950953,t245:0.8444918196):4.175852639):4.444409518):3.775958917,((((t246:1.064375581,t247:0.9867965556):0.1628612471,((t248:0.708233055,t249:0.684163485):0.2121986307,t250:0.8693099833):0.2264494905):0.5713747358,(t251:0.6653726879,t252:0.4897360104):0.9556817367):10.04617831,(((t253:2.549846757,t254:2.105868441):6.249780303,((t255:3.700420713,t256:3.511316339):1.054769273,(t257:3.558899936,(t258:1.865433172,t259:1.793174437):1.57577639):1.001116262):3.234062831):2.398430903,(((((t260:0.9115824333,t261:0.8598819801):3.249680612,(((t262:0.7578419269,t263:0.7033610725):1.668674038,t264:2.345854986):0.6712049579,(t265:2.425050694,(t266:0.5138094348,t267:0.3952533865):1.909091656):0.5306874418):0.7628594537):2.82888894,(t268:2.141054562,(t269:0.9304230669,t270:0.8726592552):1.192353956):4.160745604):0.1701852859,((t271:0.1675599283,t272:0.01841245825):2.022088606,(t273:1.063043343,t275:0.455286665):0.9092942808):3.872716516):0.6283322931,(t276:0.05033513446,t277:0.03283581565):5.775010639):2.173820724):0.2879355191):1.384085551):1.059044259):1.387242138,t278:12.00226166):0.5011056295):0.2280675327,(((t279:1.652478339,t280:1.431749579):4.521684648,t281:5.908883522):1.63668303,t282:7.456867331):4.806896298):2.245416672):0.09937913369,(((t283:3.743605344,(t284:1.551659038,t285:1.519968953):2.078656402):2.742159947,(t286:4.456102941,(((t287:0.952277167,t288:0.9493303991):0.2099816767,(t290:0.4350198108,t291:0.4243898384):0.5608716334):2.134591421,((t292:1.312078873,(t293:1.242530961,t294:1.177569239):0.01579681191):1.44061598,t295:2.364981862):0.3360196793):1.096598018):1.80133832):5.726394779,t296:11.27878314):2.378888599):0.9528673744,(t297:10.03050742,((t298:1.75736667,t299:1.684291237):7.117138651,(((t300:1.209117068,(t301:0.1825276474,t302:0.1357789115):1.012039426):1.778566028,((t303:0.1109229315,t304:0.1020068529):2.402933726,t305:2.363071719):0.3404571543):3.706302408,((t306:5.370881707,t307:4.70206998):0.1980766777,(t308:3.975650743,(t309:3.409731987,t310:3.409460737):0.378394569):0.7965094233):0.8103454876):2.055207845):0.7286376365):4.412605413):1.282997807):0.1180042776):1.519601461,(((((t311:2.986053432,t312:2.77878331):8.401008733,((((((t313:4.194960858,((t314:1.396884265,(t315:0.8256114141,t316:0.8094002076):0.3584865537):2.336107568,(((t317:1.710690433,t318:1.691642022):0.8292448523,(t319:1.026130447,t320:1.016871138):1.352787924):0.5066296451,t321:2.800855149):0.3303266876):0.2560366868):2.66916354,(t322:0.6547476926,t323:0.6344852808):5.392383808):0.5368440677,(t324:4.877192671,t325:4.861644205):1.570086577):1.182046919,(t326:3.636075141,((t327:1.249000269,t328:1.240805875):1.833495005,(t329:0.5112925871,t330:0.4653934045):2.495689591):0.5385214259):3.948388212):0.7807379188,((((t331:3.127112551,(t332:1.704249448,(t333:0.2578893529,t334:0.1889686689):1.203094527):1.392282175):0.9208518522,(((t335:0.7796649963,t336:0.5655610354):0.8701306864,t337:1.312166124):0.3648597896,t338:1.63152382):1.564475377):1.707201848,(t339:2.83956013,(t340:1.853592912,t341:1.834427845):0.8766171135):2.041776165):0.1778797367,((t342:0.2623666102,t343:0.2431449291):1.759697907,t344:2.00249042):2.882112365):2.096193786):0.4619233993,t345:7.438366932):1.325074083):0.0312735479,(t347:5.605539097,t348:5.372734325):2.951372633):1.488176164,(((t349:2.858606412,((t350:1.849047959,t351:1.390805264):0.6920614533,t352:2.077385326):0.109254561):1.414176785,t353:3.473319219):3.360164715,(t354:6.228287052,(((t355:2.35124202,(t356:0.8028795962,t357:0.7982989201):1.454325175):1.577095431,t358:3.368652444):0.3374031142,t359:3.585332873):1.952975187):0.5312184956):2.151056176):1.970798986,(t360:6.996708201,((t361:1.214326426,(t362:0.771836718,t363:0.6925722938):0.3295101454):3.582419397,t364:4.513640652):2.091051476):3.098682179):0.5853652626):1.306954406,(((t365:4.141342811,t366:4.135982573):3.391855553,(t367:3.938692238,(t368:1.041800617,t369:0.9232193389):2.857981503):3.526347005):1.795633639,((t370:3.534997168,(t371:3.348730493,t372:2.970472821):0.01357686256):1.971525671,(t373:1.214593021,t374:0.8442861701):3.633133978):3.432436756):2.247658652):1.613207021,(t375:4.26634634,(t376:2.135419458,t377:2.07671215):2.109125641):7.163579919):10.46532767,(t378:1.29783609,t379:1.244787845):20.49380159):3.652168519):19.52269744):7.19804441):18.76774194,(((t380:6.829896149,(((t381:3.248317269,t382:3.240433457):1.232932544,(t383:3.647758492,(t384:2.59274665,t385:2.285884419):0.9033531912):0.806593883):0.293111019,((t386:3.150685089,(t387:1.079239987,t388:1.002860913):1.830563683):0.2975651835,t389:3.022491151):0.8112018421):2.03529224):5.884124883,((t390:3.23695868,t391:3.184972571):3.029996691,(t393:1.250251593,t394:1.189678334):4.44830947):5.423492425):12.97299261,(t395:17.11741057,t396:17.06958877):6.906136876):45.18477879):2.216217709,((((t397:4.362164798,t398:4.351635828):1.450734872,(t399:2.023716357,t400:1.96189066):3.652161211):10.61599299,((t401:1.24036915,t402:1.060735482):4.417669211,((t403:2.373701196,(t404:0.4424344718,t405:0.3913896463):1.827496969):1.163804625,t406:3.324777017):1.902634278):10.56772625):20.34004443,((t407:4.144541295,t408:3.969182278):1.043885646,(t409:3.643298759,(t410:1.953073014,(((t411:0.07709673042,t412:0.0568055943):0.1703768894,t413:0.1805613422):0.4072071776,t414:0.4602659839):1.266516393):1.628696892):1.333395616):30.79702884):34.15441634):82.93727457);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T57.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
