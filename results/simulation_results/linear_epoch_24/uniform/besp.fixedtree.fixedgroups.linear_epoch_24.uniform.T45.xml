<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t452:39.62320729,(((t453:2.081183942,t454:2.079260595):6.289701068,((t456:0.6488041526,t457:0.6216606104):3.855379552,t458:4.459581768):3.214545788):24.78969751,((t459:1.765550782,t460:1.714007867):3.715866142,((t461:2.480445176,t462:2.412710501):0.01022749907,t463:2.369681664):2.893012937):26.97203904):6.436687897):8.136635767,(((t464:2.127851276,t465:1.39386887):21.75005303,((t466:4.211983075,t467:4.139142615):6.027124912,t468:10.15006127):12.85933791):0.1828679234,(t469:0.6435175479,(t470:0.429213022,t471:0.3380081161):0.1784095708):22.52686147):22.73870408):165.8967634,((((t472:7.288241595,((((t473:0.2730911735,t474:0.165231033):0.3748184819,t475:0.4280647041):0.2015449671,t476:0.5809895287):3.995973852,t477:4.510693793):2.432571591):6.010779675,t478:12.89826666):2.847111836,((((t455:0.08003876689,(t413:0.0003011745056,(t399:0.09686279927,((t368:0.06076556709,(t360:0.07121209605,((t348:0.07730716396,((t309:0.273124239,(((t267:0.01367422464,(t266:0.003691190136,(((t187:0.2230493807,(t188:0.112919807,(((t75:0.004564073878,(t74:0.2305156892,((t52:0.2248546925,((t25:0.06713950421,t1:2.400512748):0.9530076869,(t2:2.669913119,(t3:1.99819541,t4:1.912788309):0.6118220818):0.5749641968):1.247381193):3.024162723,(t5:5.769284072,(t6:4.396914977,(t7:3.218688976,t8:3.205220467):0.9900215541):1.313724537):1.118227097):0.1040338312):0.158990845):0.412531584,((t9:3.274765444,t10:3.194926166):0.3108264443,(t11:2.382794117,t12:2.346854903):1.085681777):3.384360574):2.66114409,((((((t13:3.586267191,t14:3.496697193):0.5337413038,t15:3.987811832):0.07847242283,t16:3.991739013):0.7683721959,t17:4.695882132):0.8517127371,t18:5.508788427):1.747823945,t19:7.228171005):1.903948394):7.477563202):0.04066488408):2.338702748,((t20:4.163752154,t21:4.160452754):4.787919659,t22:8.890230086):10.01602079):0.1948315452,(((t23:3.334861379,t24:3.209188885):6.645816578,(t26:9.070762697,(t27:8.107633966,(t28:3.101815566,t29:3.046264036):4.960472582):0.8879649556):0.5032875887):0.9223256999,((t30:1.258313418,t31:1.153926054):5.673721247,(((t32:2.485949731,t33:2.372755148):0.8606771087,(t34:2.057753388,t35:1.999859927):0.8556159143):0.5239545814,t36:3.290874623):2.881510928):3.183982527):8.046925312):5.857140807):0.08023486629):2.883823248,(((t37:16.28268428,(((t38:7.622543462,((((t39:0.171914243,t40:0.1094316266):0.8026703146,t41:0.8694022414):4.598733134,((t42:0.4465421933,t43:0.3984526025):4.984266451,((t44:1.840915113,t45:1.773910327):1.486003161,(t46:1.753659482,t47:1.738948811):1.500998899):2.041856978):0.009658256615):1.15254295,((t48:3.431328787,t49:3.356133687):1.764582168,t50:5.097313786):1.133283322):0.8622530171):3.145392736,(t51:7.998322167,((t53:0.2521401641,t54:0.2052555719):1.042636702,t55:0.9931955739):6.249925291):2.198092492):3.864368806,(t56:10.97278043,((t57:1.043378572,t58:1.011740405):5.860480456,((t59:1.407419183,t60:1.379448277):1.282485033,(((t61:0.1904700057,t62:0.08659010366):0.7270063461,t63:0.7691221562):1.365249104,(t64:0.5028454783,t65:0.3046665225):1.516522542):0.363878557):4.039041286):3.997462185):2.329022144):1.611366913):5.781800076,((((t66:1.377933142,t67:1.289085715):10.36652382,t68:11.2654598):3.2770099,(((t69:3.855337199,((t70:0.1234438744,t71:0.1202992647):1.849352702,(t72:1.230503605,t73:0.9699059835):0.04964256903):1.819258623):2.177965909,((t76:1.721557509,(t77:0.8662950315,t78:0.8625990006):0.8324638806):2.135560581,(t79:0.2924486421,t80:0.1759303985):3.473069346):0.5351184897):6.926026126,((((t81:2.924299331,t82:2.860247244):2.619321557,t83:5.468408028):0.4491918989,t84:5.838058624):3.279408947,((((t85:1.27503016,t86:1.249268612):0.8674916378,(t87:1.114820998,t88:1.036202377):0.992119974):2.258128983,t89:4.271023436):2.342800955,t90:6.569094743):2.164621863):1.688117913):1.551574393):2.295863906,((((((t91:1.230757934,t92:1.036363052):0.02799108499,(t93:0.3875140226,t94:0.2335170516):0.6446522064):3.671452516,t95:4.415985111):3.849279824,(((t96:5.886102655,((((t97:0.1981412247,t98:0.1916536503):2.511213421,((t99:1.598837054,t100:1.553775952):0.07736731294,t101:1.569093718):1.007617788):1.519666333,(t102:3.913457762,t103:3.83706837):0.1746171941):0.562227935,(t104:1.846843932,t105:1.68195614):2.610504465):1.028367565):0.0125279443,(t106:3.073615838,(t107:0.3099360365,t108:0.2918243731):2.726835032):2.190249418):2.166108626,t109:7.258127015):0.1599465755):2.881737594,((((t110:1.03291659,t111:0.8910509861):0.8628889205,(t112:0.7227619563,t113:0.6236154421):0.8057190946):0.08402971175,t114:1.437261883):3.956643726,(((t115:0.4947147115,t116:0.4793222316):3.089511856,t117:3.473908245):0.2503632659,t118:3.719432257):1.516371388):4.306813918):1.056428012,t119:10.46373112):1.521262363):2.583983477):1.575105719,(((((t120:7.658820493,(t121:4.185381208,(t122:3.232618326,((t123:0.592653416,t124:0.1790541139):1.305978261,(t125:0.2583064548,t126:0.253652675):1.07913815):1.251745985):0.7452434429):3.388003749):0.8277174116,((t127:4.756892888,t128:4.740466182):1.789945779,((t129:3.579905035,(t130:1.748454624,(t131:1.255158999,t132:1.244191455):0.440029263):1.810574498):0.7725926179,(t133:2.558242073,t134:2.475797019):1.697219968):1.888143045):0.8154917603):2.359378279,((((t135:0.3916503059,t136:0.2864540921):2.806941758,t137:3.07669149):1.130576911,(t138:1.460478743,t139:1.261791076):2.618886074):0.8321275259,(t140:2.688923825,t141:2.543014794):1.856838221):3.979899166):3.129366695,(((((t142:2.932985469,t143:2.898825912):3.074420146,(t144:1.108172267,t145:1.044705676):4.839224716):0.9375403654,(t146:3.679135247,(t147:0.7117674042,t148:0.5166612304):2.940852361):2.973641859):1.446208122,(t149:6.31483074,(t150:4.795327985,t151:4.676155115):1.503336046):1.466815656):0.8774381444,(t152:8.06074435,(t153:2.946751539,t154:2.936031802):5.017731648):0.4259911746):2.23763627):0.7492548223,(((t155:2.039643052,(((t156:0.08329146682,t157:0.07517534681):0.5058660427,t158:0.4583704563):0.07116748491,t159:0.3743850933):1.316450668):4.985179368,(t160:2.74425664,t161:2.635778006):3.565340184):2.51400898,(t162:6.992136847,(t163:5.378961185,(((t164:2.297056944,(t165:0.9183872324,t166:0.8499501176):1.116498126):0.04423104673,t167:1.63811467):2.417402882,(t168:1.254280974,t169:1.181442003):2.662372767):0.5626268509):1.518531558):1.584083388):1.632619282):1.404416754):2.556379455):0.5558883472,((((t170:7.462510856,(t171:4.549520388,((t172:1.031073491,t173:0.9968014298):3.167504683,t174:4.05545224):0.323624475):2.82002893):0.2608980551,(t175:5.66250593,((t176:1.329148125,t177:1.110034965):4.114122253,t178:4.989735801):0.1884024531):1.788155604):3.19298327,t179:10.14739048):1.378248392,(((((t180:0.4196216945,t181:0.3766535903):1.356135638,t182:1.639666789):1.546334226,t183:3.010612646):1.189713995,(t184:2.764845302,t185:2.641989451):1.360746295):4.028645771,((t186:3.614185107,t189:3.222862313):3.026193572,(t190:2.813815689,t191:2.755822424):3.428353519):1.38802671):2.931612431):1.277756339):0.5863007126):2.411538352,(((t192:0.1869142818,t193:0.06963534689):9.294090486,(((t194:0.3199187998,t195:0.2264698768):0.6971846868,(t196:0.1438346617,t197:0.05083957871):0.7561483182):2.708186405,(((t198:0.6620298134,(t199:0.3606376467,t200:0.248360314):0.1190831706):0.6284914665,t201:0.9854775341):0.08825385243,t202:0.9952635579):1.95458985):5.562184826):2.191440196,t203:10.65291179):3.064060545):0.9634052488):0.2196542927,((t204:7.014407793,((t205:1.924391837,t206:1.840456014):0.04166466645,(t207:1.484271028,t208:1.230731359):0.3834967377):5.036980468):0.2438717587,t209:6.61210221):7.479529897):0.9647529016):0.7778880945):0.9356850254,((t210:0.6946841802,t211:0.6753467454):8.147183913,((t212:1.440610434,t213:1.363412114):2.75640964,(t214:1.191433267,t215:1.100328783):2.694974432):4.612462324):7.707997839):2.33668345):1.433973188):4.708649477):0.1699988907,(((t216:2.931215868,t217:2.85671072):5.012835836,(((t218:2.251487178,t219:2.142044237):0.789795546,t220:2.798511401):2.199826117,t221:4.993189461):2.621674965):11.61742594,(((((t222:1.505758784,t223:1.437686537):9.283907944,(((t224:1.507069472,t225:1.411222104):7.299287084,(t226:0.7167791326,t227:0.6203388476):7.744166216):0.5887120155,((t228:0.8627998449,t229:0.7830607917):6.343055726,(t230:2.142715435,t231:2.057673099):4.686776192):1.417315828):1.213698701):4.840444543,(((((((t232:0.2833657888,t233:0.2126762773):0.6672192899,t234:0.7760277756):0.9561077432,t235:1.655233374):0.2116343762,t236:1.789735682):1.419745833,(t237:1.080472724,t238:0.9920863622):1.86084981):1.062098546,t239:3.898846867):7.7299235,((t240:4.680513302,((t241:0.4211980231,t242:0.3431239478):3.534479303,t243:3.81590461):0.702609393):5.124795404,(((t244:7.191652928,(t245:2.273413485,t246:2.021140983):4.776797115):0.1368477234,((t247:0.4341340926,t248:0.4213082888):3.08503286,((t249:1.448441233,(t250:1.086853302,t251:0.8602019444):0.2345738702):1.844845994,t252:2.907009139):0.08122064025):3.308138762):1.592194854,((t253:3.134532585,(t254:1.477807363,t255:1.470338149):1.443109706):3.463383121,(t256:2.89746191,t257:2.843028112):3.432099971):1.182228476):0.4956682987):1.741943958):1.877040718):2.058117733,((t258:0.6205732531,t259:0.4084592422):2.937168443,t260:3.260792805):9.764977784):1.246258172,((t261:5.377789554,(t262:1.015453042,t263:1.008480736):4.089928272):6.625271355,(((t264:7.840118844,(((((((((t265:1.489237505,t268:1.237167176):0.8907801161,t269:1.934302607):0.5321239636,t270:2.121868618):0.09720793857,t271:2.077399975):0.167800029,t272:2.204816811):0.523908753,t273:2.530484369):0.4683456177,t274:2.974437496):0.8887456972,t275:3.796413349):1.46876627,t276:5.214667488):1.155365901):0.2838237653,((t277:0.8319756907,t278:0.7987065508):3.686571196,t279:4.44566905):2.090964514):0.9556055947,((t280:0.2845774006,t281:0.2771858612):1.580837497,(t282:1.172509715,t283:1.083584853):0.6820882139):5.607952557):2.588245783):2.131303903):0.290402126):5.100943144):0.2480809174,(((t284:4.969201934,t285:4.743594748):1.119759996,t286:5.689924238):0.8042345061,((((t287:1.325915672,t288:1.274946036):0.9518670861,(t289:1.196126728,t290:1.171351331):0.9775353476):1.116688327,((t291:2.023615323,t292:1.892642666):1.134431154,t293:2.981168095):0.03624569117):1.841898167,(t294:4.101537346,(t295:1.036781607,t296:0.7616508291):3.032489417):0.6913617196):1.22146444):10.83015603):3.908199272,(((t297:4.591310789,((t298:0.3416046374,t299:0.3335890858):0.5284736206,(t300:0.3658272631,t301:0.1800333431):0.2631374896):3.712979279):2.998530897,(t302:2.297195312,t303:2.031287509):4.827495097):4.709332594,(((t304:2.985182832,((t305:0.05182861474,t306:0.03330823669):0.7503673812,t307:0.6595459962):2.159175827):0.6069976055,t308:3.390772763):4.009851921,t310:7.026777322):3.847917407):8.133098843):13.54198507):74.90582824,((((((((((t311:3.772658626,(t312:1.256001778,t313:1.064376726):2.299493863):1.594179912,t314:4.934425303):0.6489107931,((((t315:1.103548039,t316:1.039734949):1.422896049,(((t317:0.5798618499,t318:0.4206009892):0.7114872887,t319:1.00229627):0.9349193735,t320:1.928008374):0.2195676755):0.1552301519,t321:2.113921779):0.05226017209,(t322:1.461594749,t323:1.43736098):0.6744737983):2.784139047):2.846847727,(t324:1.434420893,t325:1.394643521):6.298563229):6.133332551,((t326:0.6947188572,t327:0.61587913):4.418947142,(((t328:2.099822995,t329:2.065802899):0.6048570441,t330:2.623807262):0.2544497018,t331:2.824116891):2.067910386):8.468281429):3.094155194,(((t332:6.003258515,((t333:3.910343542,t334:3.807758465):0.4287706156,((t335:3.816385057,((t336:1.324975235,t337:1.318738412):1.974978301,t338:3.078520946):0.5143049244):0.3448893315,t339:3.831669402):0.05443541317):1.635674337):9.051621083,(((t340:4.773653892,t341:4.727102917):1.534818155,(t342:0.1920487123,t343:0.07827556983):5.939711852):1.85714129,((t344:3.482344747,(t345:0.05517488034,t346:0.03981331238):3.334334256):0.787632124,(t347:0.3563414464,t349:0.08692296563):3.754649355):3.523060167):6.219522211):0.5459526218,((t350:9.49748994,((((t351:1.424550282,t352:1.363215345):0.8780813228,t353:2.215290768):5.876357097,(t354:0.8502977699,t355:0.7588800894):7.221876155):1.125688277,((t356:1.02308768,t357:0.974565411):5.147918519,((t358:1.933135587,t359:1.79864558):3.693576938,t361:5.216081707):0.2991788646):2.768617825):0.1413465617):1.468641665,(((t362:0.2676011676,t363:0.2362784522):6.109210076,(t364:3.716995318,(t365:2.947356746,t366:2.914876332):0.673772521):2.613243673):3.147453609,((t367:3.878633144,((t369:1.670068539,t370:1.654659536):1.28204327,(t371:1.897165694,((((t372:0.377045198,t373:0.3720665957):0.327128285,t374:0.4633301595):0.02771506509,t375:0.3723277735):0.3347533623,t376:0.5480419574):0.8257286509):0.9081643405):0.6167186395):3.207327546,(t377:0.3944308724,t378:0.3510836977):5.619705637):2.227771503):0.1807218547):2.981835405):0.6905545235):12.64099106,(((t379:10.30611513,(t380:10.05892433,(t381:7.673978146,(t382:7.053469963,((t383:1.27121314,t384:0.9008575256):1.157777748,t385:1.978915658):4.556861897):0.6155545096):1.893117641):0.08710776738):1.865785417,((t386:0.9777547493,t387:0.9028558288):1.75052472,t388:2.607625867):8.148195769):4.382257853,((((t389:4.824421885,(t390:0.778045081,((t391:0.2624064706,t392:0.2508522621):0.2189507697,t393:0.4637421861):0.1247175855):3.990492696):2.239244148,(t394:5.078824354,t395:5.029583017):1.539990967):1.560369862,t396:8.065692452):0.03337111656,(((t397:1.643148472,t398:1.629680431):0.4923505097,t400:1.836510884):0.2633013957,(t401:1.277664256,t402:1.174342617):0.6401768131):5.66585427):6.462813794):8.060611146):11.84291219,(((((t403:3.518500995,(((t404:2.041752155,(t405:1.233741495,t406:1.225816407):0.7500656503):0.4878097505,t407:2.298781703):0.08778287079,t408:2.380752012):0.8269010216):4.955214534,(t409:0.6942778399,(t410:0.4817425818,t411:0.32257332):0.1375838445):7.356233318):3.142651349,((t412:0.6549143856,t414:0.590803755):3.641290362,((t415:0.2767312125,t416:0.01001977301):2.217064633,t417:2.165507335):1.607323941):6.636145581):0.3384773922,(((t418:3.495681857,t419:3.380209382):0.2372161732,(t420:0.1363878418,t421:0.1214386477):3.453566288):4.6431915,(t422:6.428909749,t423:6.332209791):1.752389769):2.29824926):0.3611447168,((t424:1.074156317,t425:0.6596783175):0.1737895052,t426:0.785120905):9.359039064):21.17430429):20.80369552,(((t427:2.331492142,t428:2.320484487):3.55918115,((t429:1.602636142,t430:1.538356617):3.501294638,(t431:0.9812508009,t432:0.9797501851):3.876992635):0.6898768601):36.25833459,t433:41.62537261):9.599738521):8.912265042,((((t434:1.767074246,t435:1.570569007):1.599256588,((t436:0.9300733317,t437:0.8028537553):1.054446327,t438:1.515477522):1.02697437):2.797965095,t439:5.229817744):9.263105854,(((t440:0.5142118889,t441:0.4942019163):8.811548501,(t442:2.365421453,(t443:1.382998552,t444:1.213437957):0.968077249):6.889966141):2.821059744,((((t445:0.729184894,t446:0.5888205167):2.984017986,t447:3.44751994):0.01487260565,t448:3.456326866):5.266523109,((t449:2.381928651,t450:2.286319886):1.954602953,t451:4.11073201):4.362879032):2.889256366):2.110461498):44.65349862):35.02282718):120.6109015);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T45.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
