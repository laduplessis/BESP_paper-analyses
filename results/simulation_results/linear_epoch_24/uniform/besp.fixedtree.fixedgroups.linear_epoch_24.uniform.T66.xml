<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t490:180.5639085,t491:180.4772206):89.43308661,((((t492:3.633585098,(t493:1.486832916,t494:1.398961491):2.111270913):14.58052089,(((t496:5.530097198,t497:5.46416385):0.1529946175,((t498:0.4352431495,t499:0.3863972842):3.244718337,t500:3.574809116):1.595526187):1.095324004,t501:6.261057127):10.84720842):32.3116206,((((t502:8.03797827,(t503:0.3437627756,t504:0.3159535036):7.655860322):23.39719322,((t505:1.860497788,(t506:1.183849673,t507:1.176941103):0.5638960847):2.539585861,t508:4.251124207):26.68948674):1.485589962,((t509:2.233412777,(t510:0.5693839421,(t511:0.1297625233,(t495:0.002930994566,(((t467:0.1179602461,((t413:0.0359598423,((((((((t229:0.006303421954,(t198:0.1230165061,(t169:0.106001033,((t154:0.1582843631,t155:0.06064433903):0.04499339159,(t131:0.09628725872,((t119:0.05625430691,(((t70:0.2630490703,(t60:0.1604650652,(t1:5.362970869,t2:5.278598601):0.5155522647):0.9037562294):0.292392971,t3:6.802049892):2.293228351,(t4:8.00029976,((t5:3.10628072,t6:2.962145585):0.6456319058,t7:3.607452666):4.145800151):1.041378397):2.059394985):0.1755302752,(t8:5.285784988,t9:5.103970136):5.731435412):0.9524597915):2.213098874):2.047301679):2.139113868):3.255475458):4.83916463,(((((((t10:7.072547993,(t11:3.53753163,t12:3.531104152):3.147762465):4.495602281,((((t13:0.8786020234,t14:0.74357883):2.808070656,t15:3.453414908):3.342985608,((t16:0.8240545404,t17:0.753772205):4.854584307,t18:5.456110181):1.030217088):3.574655122,((t19:5.513078737,t20:5.270849506):3.046786332,(t21:6.586808519,t22:6.257911644):1.663213897):1.47009437):0.534752691):5.767890422,(((((((t23:2.752205817,t24:2.586914675):0.3705172107,t25:2.942959946):0.001171316725,(t26:2.783346246,(t27:2.663388027,t28:2.557824128):0.01838597213):0.1261441568):0.0008473818088,t29:2.669431448):4.209568911,((t30:1.444492555,(t31:0.07664152584,t32:0.06025859039):1.327646279):0.7652251571,t33:2.030644763):4.575248035):2.04480303,(t34:1.005533727,t35:0.9238223637):7.555293218):0.4251464276,(t36:3.929124945,(t37:2.770682864,t38:2.600918094):1.07259194):4.912810873):5.668866064):0.03518557122,(((((t39:2.949333033,(t40:2.743423318,t41:2.735601304):0.1377157938):0.4101121599,t42:3.116397802):4.173085464,(t43:2.364928041,t44:2.305207532):4.832883515):2.448110024,(t45:4.688446461,t46:4.683557252):4.852699447):1.459967953,(t47:10.53462839,(((t48:2.736741301,t49:2.606648803):0.2655666538,(t50:0.2561114142,t51:0.1625460503):2.508341281):1.826547236,((t52:1.350342702,(t53:0.5101311882,t54:0.4732688815):0.6547422305):1.135327586,(t55:0.528337722,t56:0.4717658011):1.710455731):1.961856331):5.644149262):0.3442377095):2.798282097):1.420974914,((t57:3.878865225,(t58:0.2158565249,t59:0.1012809819):3.576689418):1.164875566,t61:4.589067518):9.254172754):1.990625058,(t62:3.731555636,(t63:0.1603031771,t64:0.03611331088):3.518431493):11.87417504):1.007405673,(t65:0.9495950765,t66:0.9275537823):15.47816248):4.328254063):1.793053978,(((((((((t67:1.15940381,((t68:0.2263754443,t69:0.1726401112):0.8057365054,t71:0.6344033684):0.122438822):5.382763273,(t72:4.88722964,((t73:2.038284631,t74:1.997560312):0.6325947739,t75:2.49342835):2.209471577):1.240096514):1.057745197,(t76:0.6442096025,t77:0.5628300488):6.315971031):1.200961564,t78:7.877085913):3.387802813,(((t79:2.140263318,t80:2.082296125):2.480642112,(t81:4.055419092,(t82:3.062040602,t83:3.042097711):0.9851355453):0.1583556998):0.960748693,(t84:4.936440034,((t85:1.538773549,t86:1.457586187):2.578256837,t87:3.547426366):0.7045409159):0.1112754771):5.610641947):4.616244803,(((t88:0.4085707831,t89:0.3178166369):5.082721575,(t90:3.325707259,(t91:2.165192072,t92:2.096269072):1.135351947):1.935092013):3.732630821,(t93:8.671342728,(((t94:2.427611018,(t95:1.290496582,t96:1.152302145):1.010859343):4.955027941,((t97:4.552374156,t98:4.450008369):1.436687133,t99:5.756743696):1.048548702):1.051673935,(t100:3.721302753,t101:3.542301992):4.0362238):0.1600422767):0.1635844165):5.35343383):0.3505085404,(((t102:0.8812184976,t103:0.8278484078):6.067024427,t104:6.891030128):2.033523236,t105:8.837115505):4.484889419):3.154128906,(((t106:11.51514146,(((t107:1.53061702,t108:1.451210604):4.608868379,((t109:3.96629717,(t110:0.3272062192,t111:0.2817188325):3.555011469):1.351963447,((t112:2.190823446,t113:2.12336759):0.01718897059,(t114:1.049973583,t115:1.004061463):1.013931506):2.945802559):0.7355998004):4.460112055,(((t116:0.4302133413,t117:0.3502305195):4.423729977,(t118:4.044732757,t120:3.631036344):0.4749515305):4.22711937,t121:8.296493325):1.072428351):0.8730833994):0.5482918078,(((t122:0.3984353982,t123:0.3242385739):1.681911192,(t124:1.01113428,t125:0.9589551956):0.8255672855):6.477734828,((t126:0.5356473361,t127:0.4846386092):5.919641952,t128:6.390785786):1.574161837):2.213989578):1.493112892,(((t129:1.561668707,t130:1.532639569):1.804264917,(t132:2.137393701,t133:2.00907584):0.8803578198):7.825671011,(((((t134:0.2872574828,t135:0.2813149803):0.1606354894,t136:0.372841808):0.862611876,t137:1.222963724):2.080855854,t138:3.129117952):0.1051024857,(t139:2.615223445,t140:2.561163692):0.4701215001):7.215414896):0.4582654898):2.679800325):0.4402078613,((t141:9.907168794,((t142:1.255489459,(t143:0.4787931401,t144:0.4704528876):0.6079356871):3.947193793,(((t145:0.4104560652,t146:0.4091904518):0.1442076715,t147:0.4548903796):0.311108886,t148:0.5657752125):4.086279128):4.536496169):3.202889189,(((t149:2.757179384,t150:2.681150627):1.295736095,(t151:2.490924483,t152:2.461752438):1.193392032):7.725932862,((((t153:0.6256869902,t156:0.2807334072):5.635394853,((t157:1.274380555,t158:1.240674846):2.495099249,(t159:3.110126534,t160:2.951426795):0.6234491748):1.770092399):1.626518062,t161:6.705433952):2.251297518,((t162:4.895756924,(t163:2.415131183,t164:2.259048667):2.40791479):2.429651766,((t165:2.586300012,((t166:1.109004189,t167:0.9606496499):0.6428889601,t168:1.542712791):0.7965367061):1.873641194,t170:3.781400945):2.452573631):1.530474044):1.235414672):0.5881853436):0.6868338356):1.676441442):7.359342312,((((t171:1.319955139,t172:1.227032899):8.979668906,(((t173:2.091872303,t174:2.01478303):1.570902646,((t175:2.020041432,t176:1.970355171):0.1206552811,t177:2.073865523):1.41887795):1.319736252,t178:4.788712073):5.125628577):5.592264218,((t179:7.314508481,(t180:5.594533125,((t181:0.1908479799,t182:0.144245687):2.987348982,((t183:0.8980183501,(t184:0.3394907773,t185:0.3373349351):0.4677863715):1.120718401,t186:1.91935684):0.9785180089):2.409119538):1.700239941):3.45707496,(((((t187:1.401294711,t188:1.274632654):0.7255722408,(t189:0.3054230203,t190:0.2265714509):1.635724545):3.800816524,(t191:0.4752772192,t192:0.3043119742):5.166198221):1.414159625,t193:6.75137232):1.056569979,((t194:0.8165919265,((t195:0.04152214789,t196:0.02033616213):0.5738864267,t197:0.5520941134):0.1911150318):1.600179813,t199:2.029204785):5.373691024):1.953884506):4.622319068):2.121925204,((t200:13.68514078,((t201:7.724890639,((t202:2.99860104,((t203:0.9031719756,t204:0.592654176):0.2723485953,(t205:0.4618391096,t206:0.4354558359):0.2342374212):1.656045872):3.027896273,((t207:0.432312964,t208:0.3770994823):1.058915553,t209:1.412022064):3.823934487):1.233595271):1.832180446,((((((t210:0.963863526,t211:0.8763192841):2.13754346,(t212:0.2740398077,t213:0.0873468602):2.662583655):0.4388225868,((t214:0.7152238776,t215:0.7017317026):2.052189169,t216:2.69966309):0.2510612762):3.486268864,(t217:1.017477649,t218:1.010037962):5.165447647):0.0782544394,t219:5.974857998):0.1749910064,((t220:2.447309841,t221:2.415389323):2.557231755,(t222:3.927910258,(t223:0.8443407099,t224:0.8417314388):3.054707065):1.030732577):1.100438425):0.9493187727):4.009851013):2.241775447,((((t225:4.59902679,t226:4.544236615):0.7547853722,((t227:0.7099989468,t228:0.7051932367):0.3955211283,t230:0.6420077141):4.192192135):1.863238941,(t231:4.278307924,t232:4.037140544):2.232905955):1.375464253,(t233:2.614586529,((t234:0.05797996451,t235:0.03863924309):1.944756035,(t236:0.9886605976,t237:0.5271130064):0.8292238913):0.5797944647):4.999232004):4.574837123):0.154467101):1.113017064):0.3319313252,(((((t238:4.064522408,(t239:1.045304519,t240:0.9961967997):2.912897016):3.360780527,((((t241:0.4648916853,t242:0.4359387575):1.937699364,(t243:1.498426083,t244:1.488316773):0.8468453763):0.3926417504,(t245:1.959476303,(t246:0.8903990357,t247:0.829594596):0.8738759417):0.7632563772):0.9154855739,t248:3.361913442):3.523057311):1.110747805,t249:7.991191401):0.8079508982,((((t250:0.4044646273,t251:0.3933816889):3.560982338,t252:3.84777009):3.872069164,(((t253:1.415357585,(t254:0.5164577644,t255:0.5067821345):0.7388031778):0.1624644204,t256:1.384413161):5.622765114,t257:6.74174681):0.5048451494):0.2412967055,((t258:0.3279669413,t259:0.09429727797):6.101461905,(t260:3.147109783,t261:3.112821808):2.939657649):1.051658184):0.7068606376):0.5782257986,(((t262:0.3374812195,t263:0.3226764055):0.01562862188,t264:0.2935110388):5.329896373,t265:5.531784127):2.684552283):3.152363693):0.2543792582,(t266:0.3864471547,t267:0.2959328054):11.05329256):0.8253987836,(t268:10.01836913,((t269:5.219825129,((t270:1.957046819,t271:1.939620503):0.03592323815,(t272:0.6820865071,t273:0.674902756):1.229516965):3.066677209):4.590953842,((t274:1.126080312,t275:1.001493):1.620826481,(t276:0.3527986697,t277:0.3230928817):2.259086347):6.76601673):0.07224557312):2.05408263):0.155919765,((((t278:0.5849683908,t279:0.4550302731):1.748266398,t280:2.199789352):5.068993673,(t281:0.66958494,t282:0.6494140609):6.375932356):1.749694017,(((((t283:2.998469027,t284:2.781649644):0.2700514269,(((t285:0.5339981684,t286:0.5074041536):1.922511781,(t287:1.652274048,t288:1.531567342):0.7544271809):0.08929770704,(t289:1.156435464,t290:1.128516673):1.049767277):0.3622675554):0.2819964918,t291:2.816671132):4.170515539,((t292:3.185475053,t293:3.173378328):3.129862927,((((t294:0.6876114585,t295:0.649820333):2.184929376,(t296:2.653828514,t297:2.393361587):0.1433317804):1.870849287,t298:4.080927492):0.2036997086,(t299:2.220030332,t300:2.207034623):1.959016527):1.334465134):0.4832046562):0.236659475,((t301:0.09090565896,t302:0.03166623419):0.1896856569,t303:0.1808917036):5.808161215):0.7313320813):2.391168075):0.9373767338):0.4700611065,((t304:7.293059951,(((((t305:1.107997405,t306:0.9457568427):0.3409935452,t307:0.9088263624):1.569093174,t308:2.401052694):3.4762855,((t309:0.4539533866,t310:0.3866126699):1.352776442,t311:1.369501918):4.066061419):0.1000015458,t312:5.486235749):0.6731187259):1.438489441,t313:7.584145583):1.725239252):4.394672255):0.9970327771,(((t314:0.9890386586,t315:0.8972688432):9.40828568,(((((t316:0.90401082,t317:0.8094250321):4.622999122,((t318:2.182737169,t319:2.155628263):1.172566242,(t320:0.7392111275,t321:0.7136377738):2.581479248):2.060915391):0.7615129517,t322:5.903590443):2.608345894,((((t323:0.4709283077,t324:0.3536971622):2.866820358,(t325:1.806842681,t326:1.78912785):1.410376973):0.9957810097,(t327:1.082190607,t328:0.6060316013):2.89584391):3.285700673,(t329:3.887157089,(t330:2.119834083,((t331:1.062779364,t332:1.02827819):0.1183278538,t333:1.07929027):0.6593497883):1.75990487):2.793102308):0.8775723807):0.9943438886,((t334:0.2075068547,t335:0.1793416111):2.119361135,((t336:0.4218977633,t337:0.3158224685):0.08437084611,t338:0.3884736417):1.777798476):5.832864914):0.4099246957):0.5942906181,((t339:4.818397231,(t340:2.781816311,t341:2.706551211):2.032959498):0.9251726629,((t342:2.606339,(t343:1.632850731,t344:1.407127108):0.9385319948):2.049009149,t345:4.318347762):0.9952477834):3.165330889):3.636129005):0.7444454484,((t346:4.353737692,t347:4.303233331):5.583404756,((t348:5.423880021,(t349:0.264158002,t350:0.1846448461):5.158747516):3.113927014,(((t351:1.961250433,t352:1.912205607):0.6192327976,(t353:0.7318432821,t354:0.7044982515):1.688009745):3.691797054,(t355:0.4341055561,t356:0.4099228625):5.630681779):2.183920407):1.325854071):2.838371982):0.7137742479):1.541918663):0.3436869858):1.652245361):5.264112541,(((t357:8.37843422,((t358:3.09159224,t359:3.0523492):5.147653185,t360:8.178249591):0.02857616477):7.818365561,((t361:1.880185709,(t362:1.079914332,t363:0.8964636028):0.7634260098):1.418228576,(((t364:0.7588850558,t365:0.6361089894):1.183037684,(t366:1.155677694,t367:1.152442748):0.465762561):0.03087141527,(t368:1.296660182,t369:1.262815058):0.2421681171):1.034000882):12.65433429):0.8309204443,(((((t370:4.988762784,((t371:1.14922668,t372:1.112886487):0.4870981141,t373:1.480347428):3.270914308):1.149879807,(t374:2.178834496,t375:2.077343012):3.683032006):3.419130268,(t376:9.007838267,((t377:5.854567438,(t378:3.899056882,t379:3.842117924):1.902885855):1.28005238,((((t380:1.303446326,t381:0.8229711063):2.228495968,t382:2.968373357):0.3008933699,((t383:1.814402071,t384:1.764590117):0.2957566636,t385:2.052486417):0.9860894559):0.832332803,t386:3.827630783):2.302578355):1.831611914):0.07349041472):1.518264721,(t387:1.415265509,t388:1.403570394):8.006709635):3.317427899,((((t389:2.34475496,t390:2.1079334):1.603106015,t391:3.533775857):7.281367617,(t392:7.796957107,(t393:2.942365823,(t394:0.7501713432,t395:0.5806545563):1.847067367):4.758943043):2.746049767):0.8295525062,(t396:1.737832379,t397:1.595759701):8.940184647):0.5990885295):1.525933684):4.818655975):24.92635128):8.173006952,((t398:11.79911131,(((((t399:1.474367961,(t400:1.341405543,t401:1.316237246):0.02575467689):3.057264439,((t402:1.25250651,t403:0.8771545133):0.8817911094,t404:1.67421253):2.074386684):2.399794606,t405:6.127682357):2.118130934,t406:8.171176701):1.598395324,(((((t407:0.6250458857,t408:0.6121882008):0.3894931005,t409:0.9450827228):1.109684342,t410:2.050555136):5.151933343,t411:7.153253699):2.267837642,(((t412:0.2677818016,t414:0.1121579842):2.095469844,t415:2.187412949):0.3777047319,t416:2.371367233):6.602739425):0.09235931936):1.093041374):22.07970949,(((((t417:1.47742853,t418:1.368316344):3.354293305,(t419:3.348063737,t420:3.346350058):1.324832423):0.359903761,(((t421:2.597750516,t422:2.341752639):0.07254385511,(t423:1.512787562,t424:1.469003103):0.8611831181):0.2375092488,t425:2.560863743):1.873078286):17.23906692,(((((t426:1.791997728,t427:1.781169053):0.9315161273,(t428:2.173554659,t429:2.096863247):0.4596363997):1.138508831,(t430:2.318106843,t431:2.283788684):1.326911885):0.5810936046,(t432:3.794739438,t433:3.788682251):0.2234678909):9.233729736,(t434:3.452963499,(t435:2.160739943,t436:2.000815318):1.193638431):9.751405227):7.96361907):7.755418527,((((((t437:4.141012005,t438:3.983041957):3.276545257,t439:7.212304921):2.992183123,((t440:0.1589687424,t441:0.1208541309):1.665154535,t442:1.465167719):8.361707299):0.6234031249,(t443:9.201708448,((t444:1.468082437,(t445:1.279823324,t446:1.085808752):0.06026576033):7.413326139,((((t447:3.160802151,t448:3.146468005):0.8445908,t449:3.938516072):1.283894561,t450:5.167358852):2.882757186,((t451:0.4323242955,t452:0.2964133063):3.222687731,t453:3.440937209):4.384325251):0.3672358126):0.3198876541):1.106347065):8.659985709,(((t454:0.280143336,t455:0.05102408921):2.196841047,t456:2.223979327):7.91392744,(((t457:1.765269213,(t458:1.316987923,(t459:0.4229403952,t460:0.2031105258):0.8257937963):0.2711028731):1.378291498,t461:2.584064185):6.83947864,(t462:4.484341351,(t463:0.7557424738,t464:0.5788276417):3.671746248):4.88016137):0.05059396654):7.880000409):0.3188894692,((t465:1.220262022,t466:1.19556007):10.70244895,((t468:0.1788266872,t469:0.04031949196):5.519572781,t470:5.282231969):5.952008295):5.367183408):8.540871517):1.987481463):16.69485668):8.30652203):63.05301366,((((t471:5.199970829,(t472:3.945071754,((t473:3.322303987,(t474:0.7146510678,t475:0.7101250897):2.567329305):0.3652917438,((t476:2.667732033,t477:2.642491886):0.02553684842,t478:2.556320732):0.8270456633):0.2251362403):1.108982123):4.268583293,t479:8.977506607):1.541858839,(t480:0.2234524297,t481:0.2183837522):10.26929175):5.079080601,((t482:6.198064583,(t483:2.316983772,(((t484:0.85434786,t485:0.6737122308):1.275552817,t486:1.902554763):0.08662412083,t487:1.846716345):0.0843624315):3.790545574):1.366502882,(t488:3.422581753,t489:3.113939033):3.611948879):7.968393047):99.06072493):156.290056);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T66.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
