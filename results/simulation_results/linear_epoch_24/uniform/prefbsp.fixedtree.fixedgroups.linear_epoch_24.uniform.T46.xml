<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t398:4.399383447,(t399:1.763570362,t400:1.704174767):2.426801299):4.450507998,((t401:1.293741037,t402:1.236158236):1.427285391,(t403:1.472592005,t404:1.264761133):1.161478374):5.855215581):1.156744175,(((t405:0.5963895481,t406:0.4861752141):6.41449413,t407:6.844853884):0.5416239967,(t408:6.944572747,((((t409:0.6302967448,t410:0.3543052328):0.4441886947,t411:0.791430887):2.431505792,t412:3.072218114):2.780630852,((t413:1.568742346,t414:1.343553788):3.243401873,((t415:4.133215653,t416:3.926803494):0.005655242692,t417:3.852750416):0.447297922):0.7284719315):0.420596421):0.3892602618):1.780774576):38.96578267,((t418:1.788188825,t419:1.588225012):2.693159519,(t420:3.55267968,((t421:0.5204188022,t422:0.4950571455):1.260894046,t423:1.712684437):1.611486539):0.6755088299):41.72189567):6.003725891,((((((t424:2.600412986,((t425:0.7936962089,t426:0.7350004134):0.5104534425,t427:1.238723399):1.156703828):2.984636615,(t428:2.736795651,t429:2.593589321):2.530874898):0.3720137778,((((t430:0.1321739936,t431:0.05152770082):0.01396776101,t432:0.02304369225):1.512232668,(t433:0.7422551968,t434:0.6850423141):0.7407286387):2.489068353,t435:3.897349354):1.283156771):0.02970856952,((t436:1.406068136,t437:1.259700772):1.777768008,((t438:0.9256026821,t439:0.924184811):0.5980149136,(t440:0.9430915696,t441:0.9013854681):0.5482720605):1.361705109):1.89508867):3.244475705,t442:7.905167943):6.493975578,((t443:2.710865638,t444:2.688430175):1.436000149,(t445:3.664506451,t446:3.575270935):0.4049996629):10.10929319):35.9827529):16.86914631,((((t447:7.114886076,(t448:4.698465728,t449:4.667945111):2.404318732):2.240205181,t450:9.177709822):22.28430895,(t451:4.3854459,(t452:1.874995056,((t453:0.3066563006,t454:0.3059545709):1.036931163,t455:1.083757863):0.4818888097):2.480200209):27.03489689):32.3775841,(((((t456:6.040169081,(t457:0.9369022297,t458:0.8411026406):4.990391048):2.033477969,((t459:6.684684719,(t460:3.439659624,((t461:2.247380529,(t462:0.3618967469,t463:0.1467325539):1.879811473):0.001284447457,(t464:0.1525514396,t465:0.1103459848):1.682750867):1.037389097):3.223091579):0.1841695687,t466:6.212411572):0.8332462172):1.160637549,((t467:0.7172926131,t468:0.6985488764):1.939415056,((t469:0.1322303137,t470:0.123557871):0.3776620164,t471:0.3813232058):2.123270527):5.546252932):1.935619387,((((t472:0.8633415252,t473:0.8267520363):0.1211343673,t474:0.8497353858):0.8792433771,(t475:0.4469589175,t476:0.4060650238):1.213391747):5.960122955,(t477:5.068694417,(t478:1.498450619,(t479:0.6908261279,t480:0.6516655801):0.6948233086):3.259558236):2.50540198):2.125025167):8.994724433,((t481:0.397104742,t482:0.298123463):2.096040826,t483:2.157979295):15.71638751):43.28960914):2.822965764):22.29677423,((((t484:1.535160695,t485:1.426047596):0.6699016012,(((t392:0.02637738005,(t349:0.2727201877,(t350:0.01726300988,(t332:0.04350116988,(t317:0.0318839444,(t308:0.03242813863,(t275:0.05700617631,(t274:0.007217158166,(t271:0.06546420363,((((t186:0.02382564796,(((((((t83:0.001207586368,(t81:0.103660114,(t75:0.03621991917,t1:6.825997527):0.3678866823):0.09251800423):2.877545885,(t2:4.585040964,t3:4.498644497):5.016467316):0.7045216419,t4:10.20172689):2.897998029,(((t5:5.571000162,t6:5.498529194):0.08754031783,(t7:2.073010759,((t8:0.805066084,t9:0.6975460136):0.9890879106,t10:1.579416221):0.2274671349):3.391839753):6.004007744,((((t11:1.760303463,t12:1.647304795):2.433675535,(t13:3.459887295,t14:3.434560794):0.6128691906):2.32285479,t15:6.363923522):1.149540576,(t16:2.449670434,t17:2.406014745):4.989717183):3.511015714):1.407237631):0.1627894475,(t18:1.839772409,(t19:1.230758966,t20:1.208071673):0.5696463388):10.52987722):2.538575681,((t21:6.799577221,((t22:3.898972867,(t23:1.172759354,t24:1.16687645):2.710905856):0.3643195055,((t25:0.8306149557,t26:0.8245223882):0.8473046207,(t27:1.260027252,((t28:0.234618588,t29:0.08887357414):0.8279777379,t30:0.864960251):0.07300215111):0.3048713914):2.379377245):2.263186316):1.161237922,(((t31:4.415254908,(t32:1.47177417,t33:1.295786821):2.744239294):0.7943786689,(((t34:2.990819677,(t35:1.114255011,t36:0.8401191196):1.794559102):1.112244264,t37:3.691261076):0.5441741652,t38:4.016780797):0.08389989264):1.248985118,((t39:2.51971268,t40:2.43691011):2.378849426,(t41:0.6707180875,t42:0.5900659767):4.074886533):0.360503221):0.5504456608):6.864135382):0.2397588423,(((t43:2.207263428,(t44:1.101846527,t45:1.083932369):1.028260502):0.7774652156,(t46:1.758673565,t47:1.590749478):1.096574162):9.001092462,((((t48:1.676538956,t49:1.584762069):1.920295458,(t50:0.9411234941,t51:0.8685175931):2.539529511):1.300976329,t52:4.687866149):6.520479428,(((t53:1.922488984,t54:1.910627048):1.752417169,t55:3.616279191):2.31512827,((t56:5.403916464,t57:5.322689918):0.4289090459,(t58:1.553077329,t59:1.44517031):4.184407944):0.08660262017):5.13638058):0.2586017162):0.559280989):0.5633995768):2.815349173,((((t60:3.256555988,(t61:2.075372406,t62:2.046572173):1.120163621):1.398754214,(t63:1.32726774,(t64:0.975466486,t65:0.9634632482):0.04180209149):2.94391991):3.661889537,(t66:3.897797838,t67:3.885094071):3.700532957):5.933178813,(((((t68:2.46741797,(t69:1.986086432,t70:1.930884074):0.3961904831):1.767057516,t71:3.976931641):3.782548553,t72:7.495199198):0.5277911438,(((t73:1.726641173,t74:1.492127324):0.6616811359,t76:2.045162074):4.005985792,((t77:0.08602866542,t78:0.07403851964):1.570038547,t79:1.611991877):4.318300365):1.559895937):4.224728636,((t80:8.689755244,t82:8.433777346):0.3246946836,((((((t84:0.3488379662,t85:0.3033321436):0.4778613515,t86:0.7377729512):2.721660357,((t87:0.7785435528,t88:0.5874457778):2.073203449,t89:2.642171997):0.5929153524):0.8835438567,t90:4.014263207):1.091791188,t91:5.097444534):1.801297513,(t92:5.698656722,(t93:4.887621691,((t94:3.462382231,t95:3.422034323):0.03090326898,((t96:0.4129180761,t97:0.3529970172):2.450242863,(t98:2.075656399,t99:1.78182649):0.6121853068):0.3273883143):1.062399774):0.7687755318):0.8785580223):1.177637339):2.637452894):0.6234204788):0.7878239372):0.7094281899,((t100:1.524104528,(t101:0.7490541872,t102:0.7034325071):0.712092242):4.113202243,t103:5.476622533):5.653049636):3.216240512,(((t104:2.89798358,t105:2.885391152):3.856164339,(t106:5.816055558,t107:5.802321648):0.8970990432):1.574150841,(t108:1.608744973,t109:1.502355237):6.594586009):5.57757537):2.103230603):0.377243899):0.1112586704):3.328751417):0.6819181376):1.506854632):1.701167673):0.1295767418):4.795445212):3.241493095,((((((t110:8.464298775,(t111:6.497737636,((t112:3.726632088,(t113:0.2779820416,t114:0.2608854788):3.362338191):0.5819217867,t115:4.128837194):2.06079428):1.746854148):3.083120246,t116:10.96733745):3.831060418,(((((t117:6.154465637,t118:6.144747005):2.788545699,((t119:2.812934477,(t120:0.9165070838,t121:0.8665146538):1.541821303):1.595082438,(t122:2.154561422,((t123:0.9045541181,t124:0.7801649134):0.3197619707,t125:1.076153198):0.930130246):1.820944181):4.478558667):3.969275241,((((t126:1.570097608,t127:1.548853183):0.04523356881,t128:1.583555777):0.808877468,(t129:0.2694960581,t130:0.1809723145):2.071708506):1.638272021,((t131:2.237988443,((t132:1.062419232,t133:1.053663955):0.2334779384,(t134:0.3471292855,t135:0.2400436985):0.7190275686):0.9038073861):0.1718196571,t136:1.886570565):1.422105563):8.011385158):1.010074872,((t137:1.368946249,t138:1.343557961):6.227154802,(t139:1.202455821,t140:1.144267937):6.335370958):4.711189461):0.2963609493,((t141:7.979172012,t142:7.952421003):2.653446779,(t143:4.934540559,((t144:2.68752343,(t145:2.12564965,t146:2.092715843):0.4682078281):0.173636164,(t147:0.5431282259,t148:0.5290184081):1.957436952):2.028815057):5.609415639):1.755849615):0.3239319848):1.515722607,((((t149:5.186722085,t150:5.160738946):5.104315648,t151:10.15183778):0.03367462018,(((t152:6.136206699,((t153:3.068820588,(t154:0.6844912354,t155:0.6789513473):2.375612467):0.9554078258,(t156:2.42529281,t157:2.350734182):1.455945842):2.059919469):0.7719310442,(((((t158:0.2605335895,t159:0.2298787866):1.229234522,t160:1.449171989):1.577081437,t161:2.469076643):0.1514880458,t162:2.580395043):2.009597368,(((t163:2.46221192,t164:2.438539483):0.1778800615,t165:1.817297945):0.8449702933,t166:2.634228545):1.07393871):1.309157625):0.1247258905,(((t167:3.070986761,t168:3.026172477):0.2013454506,t169:3.224910705):0.2465718701,t170:3.431754608):1.504600468):3.085115463):3.099593006,((((t171:2.171957819,t172:2.132729169):0.3432521474,((t173:0.8793793792,t174:0.7726573493):0.1623327821,t175:0.9325132478):1.429960405):5.821961995,(((t176:0.9040663934,t177:0.6916804503):0.1834973592,t178:0.8278784262):3.940086499,t179:4.735431904):3.117942735):2.511724442,((t180:6.490011866,(t181:3.4575501,(t182:1.626821165,((t183:0.2221119691,t184:0.1988139915):0.5322825804,t185:0.6303897985):0.7872581247):1.751012122):2.95714734):3.571804848,(((((t187:2.428395367,t188:2.281251804):0.08021271452,t189:2.344774916):1.080644111,(t190:2.111508711,t191:1.99233261):1.230528906):0.8818396958,t192:4.048166833):1.28925409,(t193:4.757443811,((t194:0.8208613396,t195:0.6825903696):2.989964421,(t196:2.788057778,t197:2.741408683):0.8784853877):0.9034701957):0.4412573411):3.850596559):0.2581517939):0.1284205289):0.1535523081):9.918264669,(((t198:3.084681369,t199:2.594062946):10.71883203,(((t200:4.374521898,t201:4.307572311):0.5902657945,(t202:0.4793633445,t203:0.4703815392):4.396723711):1.937813322,((t204:3.939349633,(t205:2.928541991,(t206:1.666681682,t207:1.531618204):1.246978861):0.99529136):2.237970684,(t208:2.488879537,(t209:2.016330449,t210:1.783156386):0.3073780569):3.377814557):0.2975898806):6.346508192):2.290699112,(t211:0.4548778602,t212:0.2386327701):13.93680727):3.026354548):2.862156129,(((((t213:5.674892433,t214:5.66686782):3.530279576,(t215:0.343026316,t216:0.2203209514):8.768049966):1.817154801,((t217:2.475638068,t218:2.333596929):3.500981756,(t219:0.2424606804,t220:0.1610286867):5.581513801):4.68283448):2.527355259,(t221:0.7102549457,t222:0.6968762771):12.16556412):0.6591413935,(t223:5.358376276,(t224:3.951968134,((t225:2.301465501,t226:2.22600741):0.3644365845,t227:2.562044243):1.112395801):1.251848822):8.132468832):5.83695542):1.778943272):1.25961737,((((t228:6.112863933,(t229:2.070756844,t230:2.040416143):3.766695467):3.348175272,((t231:2.304386783,(t232:0.8839051895,t233:0.8595692174):1.320594265):2.971327635,(t234:3.657406063,(((t235:1.231355753,t236:1.045254191):0.2248639322,t237:1.207668247):2.073217908,t238:3.212411266):0.01093592924):1.450628189):3.714518863):7.528091151,((((t239:3.021679619,(t240:2.832213809,(t241:0.09710137839,t242:0.02510940484):2.73465533):0.164118697):0.3741480268,(t243:1.10162689,t244:1.084544062):2.096461395):8.197824407,((((t245:0.1419291595,t246:0.02788543895):4.899223143,t247:4.657844534):2.466103661,((t248:3.506475254,t249:2.915642334):3.014056965,t250:5.813736434):0.5516460984):0.5108559165,(((t251:0.5620011545,t252:0.4852462571):4.580773804,(t253:0.2136818593,t254:0.04478808989):4.800267974):1.33154037,(t255:1.543762438,t256:1.457407773):4.502367003):0.3312535504):3.258454984):3.550718406,(((t257:5.737959707,(((t258:3.096162888,(t259:2.471082068,t260:2.32122605):0.4125116047):0.1982134302,(t261:2.067459235,t262:1.94808346):0.8644259893):1.650801485,(t263:4.091027271,(((t264:1.759230866,((t265:0.6844447563,t266:0.3780748775):0.5037059633,(t267:0.6420764005,t268:0.621282664):0.2037926059):0.5073689948):0.9256471221,(t269:0.3064919435,t270:0.249834131):1.864562441):0.1687138316,(t272:0.4074943722,t273:0.3707561577):1.693579331):1.132017814):0.3542843362):0.6066666461):2.029563983,(t276:0.485603633,t277:0.2072332265):5.202426797):2.289397538,t278:7.671321197):2.88962408):0.7424520427):3.413560553,((t279:9.158382424,(((t280:4.753785471,t281:4.704862295):3.257869997,((t282:0.9994093688,t283:0.9949642686):3.673600356,(t284:2.41732999,((t285:1.425251393,(t286:0.4225228196,t287:0.3479575934):0.7313774994):0.02935544743,t288:1.051004153):0.8721516875):1.920975415):3.073087444):0.8162605354,(t289:7.383120525,((t290:2.277648914,(t291:0.6986421732,t292:0.6417260853):1.497883045):1.207810645,t293:3.295299525):3.891363725):0.3270107282):0.3212759646):0.12276261,((t294:6.34081285,((t295:0.4945995557,t296:0.493933403):4.535916932,((t297:0.4049217325,t298:0.2412778583):3.73657657,t299:3.943877506):0.8321183356):1.261688119):1.045848969,((t300:2.956679459,t301:2.905168441):0.7692257499,(t302:0.9595800939,t303:0.9329476797):2.663576923):3.232870598):0.4983243097):5.162358829):1.513092759):6.609283473):10.01454426,((((((t304:1.59518059,t305:1.591183062):5.600422709,(t306:3.365708617,t307:3.187887537):3.495634125):4.150649602,(t309:5.287026303,(t310:2.895031853,t311:2.861485293):2.367180473):5.32514905):5.25325944,((((t312:0.3674562662,t313:0.3339683535):2.671818112,(t314:0.2776104891,t315:0.2296960996):2.591791161):3.785726324,(t316:1.786469225,(t318:0.8597597389,t319:0.7236280393):0.675755839):4.816962608):2.399665608,(t320:2.61994479,(t321:2.119033533,t322:1.708222117):0.301078043):5.896250851):6.562993731):2.116170588,(((t323:4.571361651,t324:4.52034866):3.171765846,(((((t325:1.296412144,(t326:0.1328611334,t327:0.1130540392):1.14246919):0.1813398091,t328:1.414337029):1.412857767,((t329:2.317545593,(t330:2.138179943,(t331:1.427663109,t333:1.003137147):0.7084912391):0.1077667029):0.4770026102,(t334:1.833741423,t335:1.598145439):0.4366125523):0.01434077503):1.509272835,t336:3.389412275):0.8539531391,t337:4.027400156):2.334757117):5.110356139,((t338:2.487976401,t339:2.487492369):1.885104398,(t340:0.8794547851,t341:0.7434331398):3.485368573):7.043905883):3.72024276):7.185020757,((t342:3.530140152,(t343:2.133138271,t344:2.054416743):1.354755092):14.96198282,(((((((t345:0.4680454408,t346:0.4035064712):2.649385183,t347:2.959819539):0.4271848523,((t348:2.045424276,t351:1.680226615):0.8600802242,t352:2.244864155):0.4746722647):1.38982056,t353:4.100433416):2.694669081,((t354:1.534601905,t355:1.52430629):4.900609047,t356:6.133482592):0.1625880388):4.696368885,(t357:5.865178371,((t358:3.525128193,((t359:1.342301617,t360:0.7018756936):0.5675844321,t361:1.236917559):1.592967659):0.3502871453,t362:3.113817416):1.953324074):5.049040608):5.573420456,((((t363:0.4171558656,t364:0.3141202503):5.460266536,((t365:2.271539796,(t366:1.8672487,t367:1.864804146):0.07786806434):2.550487167,t368:4.466786582):0.9233480562):3.373066562,(t369:4.237565066,((t370:1.500047937,((t371:1.188461396,t372:0.931756012):0.0463744432,t373:0.8875308354):0.2316097171):2.05830832,t374:2.930212393):0.5456688416):4.521163419):4.993014469,((t375:0.3230626195,t376:0.1820684684):4.222477442,t377:4.383603888):8.311111663):1.36150949):0.2627255981):3.598458837):4.614193934):14.48114268,(((((t378:1.673464948,t379:1.344249377):6.099469226,(t380:2.338930267,t381:2.181725588):4.922114325):0.6558697875,t382:7.750119103):0.6935864742,t383:8.364028123):8.912336532,(((t384:4.350811444,(t385:2.470729142,(t386:1.373499316,t387:1.313080627):1.050153239):1.762291071):3.234551044,((t388:4.350113544,(t389:0.1293452834,t390:0.1144556175):4.042108933):2.077180652,(t391:6.110491222,(t393:2.158680486,t394:2.129145616):3.536024153):0.1018795409):0.9075920377):3.719269159,((t395:0.4033153476,t396:0.3782974658):8.285208248,t397:8.392005038):1.699608667):5.927573924):18.93360513):59.42199826);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T46.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
