<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t473:42.43220645,(t474:13.05279116,(t475:2.931558743,((t443:0.05839633752,((t402:0.1067482314,t403:0.02333669849):0.06963849258,((t362:0.004296151128,(((((((t157:0.1185623237,(t124:0.001664440309,((t102:0.003077855607,(t27:0.3778380984,t1:3.296931087):7.62004275):1.722457748,(((t2:8.162792507,((t3:2.92417649,t4:2.901492302):3.997898553,(t5:4.002751579,t6:3.858729148):2.860275029):1.058347306):0.9079963659,(t7:7.350053366,t8:7.295529151):1.205345047):2.40456228,(((t9:8.334585569,((t10:6.660625568,t11:6.638892592):0.02891657648,(t12:6.149877157,t13:5.88026035):0.4910718744):1.585404204):0.8478126213,(t14:5.323589355,((t15:1.795717493,t16:1.659187378):1.165112327,t17:2.648261552):2.361723159):3.206508181):1.452161611,(((t18:4.654184117,t19:4.460684882):1.745601737,(t20:3.951720486,t21:3.923669815):1.966080549):0.72513736,((t22:4.473165716,t23:4.256574507):1.028563491,((t24:4.01662708,((t25:1.066412081,t26:0.9888623306):0.4612252874,t28:0.9324008388):2.43725184):0.9437130299,t29:4.289601704):0.2876558335):1.112739647):2.450618329):0.2353212079):0.9247169632):0.6895395669):3.834947237):3.095544406,t30:16.88718854):0.7464162017,((t31:4.637784878,t32:4.627375667):6.768652541,((t33:3.684086979,(t34:2.193293624,t35:2.159051385):1.273660114):1.012259958,(t36:0.2059596953,t37:0.2037350907):4.186924697):6.668156321):6.191302894):3.135137953,((((t38:1.86962199,t39:1.673603154):7.185216958,((t40:5.567652995,((t41:2.7153236,t42:2.525953937):2.209267335,(((t43:1.952655652,t44:1.919690828):0.5790814135,t45:2.466108442):1.726428103,((t46:0.3533651691,t47:0.2754103385):3.618548462,(((t48:2.280033643,t49:2.11045952):0.7037725602,(t50:0.8290835313,t51:0.681620673):1.96591946):0.3806116716,t52:2.898162667):0.4402955328):0.145149718):0.4134776839):0.4347633987):1.169950288,(t53:0.1686396351,t54:0.1183723364):5.324903454):2.111225711):8.279821293,((t55:6.623347168,((t56:2.883601687,t57:2.828065656):2.88816181,t58:5.438329008):0.770687586):4.246288977,(((t59:7.535099407,((t60:3.977178293,((t61:0.5269889139,t62:0.5218142081):3.382212741,t63:3.89166372):0.03946445966):1.834962945,(t64:1.103839143,t65:1.097139183):4.490158536):1.498760697):0.02036752426,(t66:5.755596526,(t67:1.972625184,(t68:0.8562594322,(t69:0.5524099228,t70:0.5252316796):0.1315250084):0.9083549026):3.366320796):1.267489261):1.3782477,(t71:3.816821445,(t72:0.7232298339,t73:0.6964525306):2.988623944):3.697910592):1.45735868):4.914041165):1.788172004,((((t74:8.295027251,t75:8.167817072):2.068667452,(t76:1.950101283,t77:1.923465614):7.99624355):0.4308262277,((((((t78:2.305174431,(t79:1.524151292,t80:1.514467329):0.589734668):3.741500433,((t81:0.5468160068,t82:0.3387792958):3.252345417,t83:3.490825395):2.018064341):0.06896685091,((t84:1.77268948,t85:1.730832496):2.819024756,(t86:2.779485832,(t87:1.8011128,t88:1.764139825):0.9594853171):1.679885694):0.7819081037):0.9566796628,((t89:0.08015299969,t90:0.06958341839):2.639848032,t91:2.616143345):3.393729553):1.367004361,((t92:2.091530212,t93:1.64999998):4.456731691,(t94:4.450872355,(t95:0.6042615612,t96:0.5446471474):3.443668224):1.52118399):0.3625698596):1.44812363,(t97:4.462426433,t98:4.352800171):2.736975067):0.3563311028):4.501962858,((t99:0.3666163473,t100:0.3400458036):2.234724912,t101:2.546859708):9.318392723):0.2159819126):1.242776457):2.232594859,(t103:14.21048275,((t104:4.841437097,t105:4.757075851):9.023110139,(((((t106:2.434863471,(t107:0.2848805434,t108:0.2425463435):2.080314039):0.03495566156,t109:2.347065642):2.575885302,t110:4.776788446):3.026863574,t111:7.767886335):4.482223437,(((t112:1.235003843,(t113:0.9221621303,t114:0.7060812049):0.07396389915):0.03213766617,t115:0.7775379672):3.196195366,(t116:1.861823641,(t117:1.126864887,t118:1.000965571):0.6889129965):2.077114666):7.665275988):1.198823324):0.2723777016):1.237220341):4.579395733,((((((t119:0.674329359,t120:0.3733193133):2.037389525,t121:2.348247449):5.19796542,t122:7.410771587):3.850952046,(((t123:2.571302153,(t125:0.8821854707,(t126:0.4064576463,t127:0.3243591805):0.2038596276):1.53693356):1.158476988,t128:3.053074953):1.561058409,((t129:1.783734261,(t130:0.6019394657,t131:0.4545682406):1.176618497):0.1586555512,t132:1.736488056):2.252433868):5.63438907):1.119475906,t133:10.63718704):3.479948757,(((((t134:3.11678868,(t135:2.493795854,t136:2.482740463):0.09061673147):4.401898761,(((t137:2.488945071,t138:2.476679847):2.694429469,(((t139:1.434041754,t140:1.432535889):0.1258355757,t141:1.497697658):2.541617188,(t142:1.752800642,t143:1.704591186):2.268178977):1.04729717):1.089853805,(((((t144:1.059321969,t145:1.016852141):0.9167846597,(t146:1.844917868,t147:1.812824128):0.05721779344):2.105860998,(t148:0.3043816284,t149:0.04170630166):3.407190849):1.077959503,t150:4.525870666):0.1625246154,(t151:4.220412731,(t152:1.88028798,(t153:1.159876819,t154:1.051374918):0.6594853273):2.268021286):0.2325283344):0.7344149968):0.6056208472):0.6296040856,t155:6.15797933):0.5811085985,t156:6.732058073):2.634798655,(t158:4.476293422,((t159:0.7251756465,t160:0.7226792028):0.7229404814,t161:1.30270412):2.989035164):4.659239931):2.439401629):2.168576999):3.746397845,(((t162:1.149116015,t163:1.115712382):14.69812815,((((((t164:0.8055584041,t165:0.7275494325):6.709179475,(t166:2.720915181,(t167:0.8152525744,t168:0.6239611481):1.590827782):4.577382127):3.967667083,(t169:7.685546864,((t170:2.68009507,t171:2.659144449):4.261631158,t172:6.687273636):0.6722334415):3.043004501):0.9139744156,((t173:2.856309082,((t174:1.015526043,(t175:0.6019292961,t176:0.4802862446):0.3316540454):0.9150491678,t177:1.566211822):0.8733197809):7.249687134,(((t178:5.255299503,((t179:0.9850148055,t180:0.9797463016):0.2405838265,t181:1.178674513):3.718439418):0.4466897831,(t182:3.115850431,((t183:2.208479889,t184:2.11654986):0.5057272961,(t185:2.420059593,((t186:0.641879404,t187:0.5822579037):1.215285436,(t188:1.25239587,((t189:0.7023227474,t190:0.6883697746):0.2243802174,t191:0.8514881984):0.1063753946):0.3575205316):0.5484516539):0.02757303387):0.3681286958):2.169623274):3.103658197,t192:7.460880611):0.8724694357):1.20429602):1.759966187,(((t193:3.435695467,(t194:2.05540401,t195:2.010393517):1.272166203):2.50502865,t196:5.593244157):1.541709127,((t197:5.007685545,t198:4.991842905):1.647930465,(t199:3.584125351,t200:3.366741619):3.045862987):0.4766604062):3.687791754):0.552730012,t201:11.12690912):0.8985492705):0.001194698512,(t202:9.01787918,t203:8.977681528):2.838013584):1.306422602):0.8572469692):0.8196623293,(((t204:7.623800633,((t205:0.05516668139,t206:0.006994179082):1.964562329,t207:1.873712778):5.603931809):3.620505408,((((t208:6.877636006,(t209:6.528616511,t210:6.453921446):0.1700665934):0.7257963247,(t211:1.580450757,(t212:0.776095471,t213:0.7301027106):0.6247688991):5.715662308):0.1466926311,(((t214:1.109996445,t215:0.9159441615):2.284400043,t216:3.130448644):1.052978864,t217:4.159962223):2.52028311):1.073492887,((t218:0.1566802909,t219:0.1502022239):4.86554706,(t220:3.994694014,(t221:3.532773134,(((t222:1.15523517,(t223:0.969285872,t224:0.9462124852):0.1532528638):0.9829717141,t225:2.069844299):0.1610837839,t226:2.13876589):0.992828322):0.4482556567):0.8584003128):2.444911619):2.094599021):2.975450266,(t227:6.626442037,(t228:2.921043592,t229:2.715386487):3.380367104):5.243982779):0.4102615478):2.608626995):5.824307781):1.098322567,((t230:1.949057718,(t231:0.4181464865,t232:0.4019955738):1.527203082):2.275371281,t233:4.136546202):16.85673593):4.948415328):9.837257572):29.332845):71.10240514,((((((((((t234:2.899623265,t235:2.742150225):8.855899713,(t236:3.006609388,t237:2.946260459):8.345055402):0.4581108782,(((t238:2.198926971,(t239:1.610545077,t240:1.449050431):0.5709575831):2.857541526,((((t241:0.8635962617,t242:0.7723580238):1.613931124,t243:2.367333107):0.1883143938,t244:2.307607764):2.15873874,(t245:4.113821,(t246:2.392202153,((t247:0.4628983186,t248:0.3428343874):1.215337087,(t249:1.241187245,(t250:1.017890247,t251:0.891556208):0.1502439213):0.2818272826):0.6783126274):1.676056897):0.3388856897):0.04828993046):4.008216738,(((t252:2.192182483,t253:2.179171334):2.976876352,(t254:3.859687199,t255:3.804043205):1.23173315):0.373831345,(t256:2.542082063,t257:2.491753153):2.835520602):2.508044476):2.62216462):0.4615331266,(t258:2.11934198,t259:2.079870535):8.777742549):4.314520076,((t260:0.6507062113,t261:0.6407831197):1.454999754,t262:2.033087114):12.90722175):4.518440757,(((((t263:3.217210989,((t264:2.197985561,(t265:0.8000877655,t266:0.7675306841):1.318218801):0.1578367287,t267:2.231060701):0.8054403623):1.7107093,(t268:0.7181573238,t269:0.6616740071):4.021095253):1.160398032,(t270:5.533925936,(((t271:1.976716446,t272:1.937330915):1.029882333,(t273:0.2195008252,t274:0.1729825967):2.60665352):0.7208556954,t275:3.478880185):1.525042915):0.08676285031):1.541726912,t276:6.612252):9.105025641,((((((t277:0.9131326014,((t278:0.2197862037,t279:0.2177810219):0.2390230261,t280:0.4129402374):0.4420031306):2.037571358,t281:2.818398473):0.2073768309,(t282:2.819954312,t283:2.483019039):0.121719871):2.882372415,(t284:5.012960168,t285:4.929658432):0.3619233297):0.5833901148,(((t286:0.7252929358,t287:0.6536725008):1.579925324,t288:2.115590945):1.961525309,((((t289:0.3411640949,t290:0.3206168698):0.3162510457,t291:0.4139032137):1.54644135,t292:1.890955979):0.7738018593,(t293:2.09319363,(t294:1.665189802,t295:1.52324941):0.3832095524):0.3693005699):0.9987466068):1.408405796):0.9313507424,((((t296:2.225627222,t297:2.159918827):0.1061226245,t298:2.215822333):0.8275806932,t299:2.949555079):0.6052135074,t300:3.434979242):1.55131648):7.989010582):2.631687134):2.306448956,((t301:5.984912903,t302:5.902222674):4.93074984,(t303:1.383396361,(t304:0.2713672905,t305:0.1917355573):1.045033215):9.37621616):6.935401524):8.276046108,((((((t306:0.09991669547,t307:0.05211973595):7.687476236,(t308:6.118419508,((t309:0.1417864057,t310:0.01470882299):0.5022066508,t311:0.3979638081):5.432372288):1.609593853):0.4386238539,(((t312:0.4517868054,t313:0.4310881025):1.504748191,t314:1.933505592):1.45260224,t315:3.357082462):4.420948023):2.042671154,(((((t316:1.602216774,t317:1.573352243):1.964691005,((((t318:0.6639949878,t319:0.484809066):1.409016413,t320:1.890932806):0.5647907258,((t321:0.9197479441,t322:0.8110510205):1.134685894,t323:1.859497794):0.3439498245):0.746788468,t324:2.852585285):0.1135847115):0.1760044473,(t325:3.083645486,(t326:1.998579919,t327:1.917473587):1.040299755):0.05006930855):3.699717376,(t328:4.33009637,((t329:1.221796492,((t330:0.333734442,t331:0.316856713):0.3899070027,t332:0.6634712743):0.2980910703):2.841193382,(t333:0.5981243589,t334:0.4418061539):2.850574034):0.1605219233):2.156620807):2.174481527,(t335:1.05518884,(t336:0.9200718833,t337:0.9123730698):0.05103873465):6.70664224):0.06754936097):4.349930806,((t338:1.411511475,t339:1.378917503):3.784111534,t340:5.062282933):6.846211171):9.829048466,((((((((t341:0.2914128029,t342:0.2464165595):2.658967238,((t343:0.911407879,t344:0.8947028531):1.126644308,(t345:0.05651345647,t346:0.00151171007):1.758029089):0.8543966963):0.6734827244,t347:3.282466313):0.1392874342,t348:3.404255767):1.907778456,(t349:1.209005191,t350:1.004083217):4.089394125):8.142654345,((((t351:4.151693237,(t352:0.6626150408,t353:0.5076623718):3.486165049):5.525962505,((t354:0.3846885641,t355:0.3694160375):0.2708042835,t356:0.6193917974):8.726103363):1.341630724,((((t357:3.949138829,((t358:1.053669986,t359:1.009617903):1.489474859,t360:2.486295167):1.368306344):0.8836284445,t361:4.651112495):2.807153975,(t363:2.872615929,t364:2.711675616):4.332559493):1.19868279,((t365:3.553061776,t366:3.506035043):4.31955685,(t367:5.803875501,((t368:1.216561038,t369:1.208244993):4.160012561,((t370:0.2357024217,t371:0.2060958145):2.044107461,t372:2.18154215):3.040030995):0.2918793306):1.915034441):0.3119098826):1.837973752):0.1356785134,(((t373:1.271736482,(t374:0.3840905622,t375:0.2517725679):0.7399286667):0.7973147793,(t376:1.216750479,t377:1.179271958):0.5398045652):2.907212641,t378:4.583019029):4.684405854):2.003476643):0.8508548458,(t379:8.919350923,((t380:1.027235162,t381:0.9210309085):0.5919976734,t382:1.400880389):7.220164863):3.19931138):5.10575839,(((t383:1.344619785,(t384:0.4224655199,t385:0.3550527779):0.8190934328):0.02122347419,(t386:0.3797761689,t387:0.3748781162):0.7549841325):7.416905874,t388:8.528388179):8.06780897):1.938602293):1.31855942):21.81800615,((((((((t389:1.907401334,t390:1.895977609):0.1805151261,t391:2.040523664):4.640617674,((t392:0.3348346972,t393:0.3248972605):5.291703581,(t394:2.376316693,t395:2.230685406):3.215234209):0.8854014641):2.440260901,t396:8.647643003):2.741460497,(((t397:5.644772146,((t398:1.481507362,t399:1.42806232):3.139793599,t400:4.209737033):0.9055096574):0.7645969033,t401:5.698762022):0.1336790479,(((t404:0.9537039788,t405:0.9502707592):0.7307883812,t406:1.549297421):0.2856638641,(t407:1.534521887,t408:1.345626122):0.1076190986):3.435776779):4.843840896):2.601366218,(((((t409:7.011732706,(((t410:0.1220520543,t411:0.07735612604):1.060487499,t412:1.096207839):3.000383153,t413:3.809353187):2.703559928):0.03119411979,(t414:4.174110604,(t415:3.109460906,(t416:0.2831917785,t417:0.1768632441):2.659712242):1.025578227):2.348086475):1.18485965,((t418:0.7915935298,t419:0.7085287068):2.161617992,t420:2.834952901):4.39962812):1.091526751,(t421:7.481942009,(((t422:1.44334037,t423:1.439358754):1.840647898,(t424:0.7666263249,t425:0.5549671607):2.492734519):0.5782586314,(t426:1.373922245,(t427:0.6403797054,t428:0.3401676523):0.7060556486):2.186718542):3.293547001):0.7826357436):1.191368318,(t429:7.93668399,((t430:1.875745753,(t431:0.7210550075,t432:0.6005548038):1.071328867):1.181765524,t433:2.831962929):4.665511122):0.4870619428):1.316722071):15.92438343,(((((((((t434:0.5468430267,t435:0.130126554):2.834602809,t436:2.710504086):2.800677178,t437:5.371632871):0.04505540796,t438:5.136800137):1.410805357,((t439:0.703322677,t440:0.6149587441):3.542049803,t441:4.024867299):2.271005745):0.5418707591,t442:6.471216113):6.798658798,(((t444:0.07948095658,t445:0.05391866508):3.170157618,(t446:1.374200868,t447:1.314885652):1.784163403):8.69859025,t448:11.73386065):1.24904969):0.1124364317,t449:12.95583137):2.835368545,((((t450:0.4531573569,t451:0.3859819769):2.998868134,t452:3.337884888):1.127510581,t453:4.271631435):3.820548944,(t454:5.248579827,t455:5.227339956):2.625694503):7.287548221):6.896057714):2.076725057,((t456:3.226484719,t457:3.167176873):9.379340445,((((t458:1.090818158,(t459:0.3290534254,t460:0.1535777852):0.5905770076):0.5378728142,t461:1.200756445):3.971700872,(t462:2.557972538,t463:2.385071438):2.416690178):1.34535311,(t464:1.949786292,(t465:0.9218650751,t466:0.7104582612):0.9954082598):4.116158467):5.573268221):11.49407917):9.146033075):23.78476219,((t467:6.266591826,t468:6.219891015):35.55538023,((t469:7.278341636,t470:7.205478013):25.21791006,(t471:19.15997353,t472:19.02220657):13.24993236):9.269787351):13.95427985):58.26828719);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T96.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
