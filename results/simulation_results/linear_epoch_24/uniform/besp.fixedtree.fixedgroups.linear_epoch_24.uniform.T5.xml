<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t436:68.71668362,(((((t437:0.8278848985,t438:0.8009794261):19.75710986,(t439:4.386994613,(t440:0.86081646,(t441:0.7268775158,t442:0.6703150521):0.04985763575):3.459787715):16.11102688):6.107592736,((t443:3.701963581,(t444:0.06147560737,t445:0.04804014674):3.612198805):1.62842049,(t446:0.4607965898,t447:0.4184765139):4.647683979):21.00754394):6.945916187,((t448:2.248147887,(((t449:0.3952032901,t450:0.263743775):0.1565512883,t451:0.4155881967):0.8863195404,(((t393:0.03627091111,((t377:0.2425009951,(t347:0.03505376616,(t334:0.03936087944,(t315:0.0005119908585,((t206:0.05658592391,(t190:0.00327161455,(t174:0.03347996007,(((t124:0.163972516,t125:0.01042454175):0.03673962607,(((t109:0.2580984307,(t82:0.0314687884,((t59:0.03512602824,(t1:1.857685163,t2:1.735485463):4.552691033):0.8841041551,(t3:1.16793207,t4:0.9349867908):5.909586295):1.039085882):4.019716959):0.709993048,(t5:1.934616819,(t6:1.631568632,(t7:0.9885910062,t8:0.9720368224):0.5389016355):0.3007421258):10.66543694):0.5814373876,((t9:5.07263521,t10:5.001968271):6.3710716,(t11:6.286466266,t12:6.181707766):4.954249621):1.56480022):0.409419175):3.629042804,((t13:4.544873434,t14:4.343318328):1.725472891,(t15:2.078537716,t16:2.039712025):3.989384237):10.25777751):0.5958427364):1.760427627):1.873035397):9.776856456,((((((t17:6.338505193,(t18:4.473360224,((t19:2.89943099,t20:2.787931773):0.8844189829,t21:3.590647735):0.5470198568):1.84415011):1.546465508,(t22:3.393960513,(t23:3.238743396,t24:3.229954757):0.1451247234):4.095580181):0.620357968,(t25:4.194343877,t26:3.794670317):3.865271201):7.459077603,(((((((t27:3.254357086,t28:3.242068743):2.257450779,(t29:3.257911758,t30:2.784634752):2.152306256):1.290525963,(t31:4.473273219,t32:4.429930405):1.674082712):0.7530728549,(((t33:0.1247885809,t34:0.1182445841):1.883751618,(t35:0.169669012,t36:0.03654550936):1.492955303):2.914201307,t37:4.32003121):1.811211182):5.257966901,((t38:2.267127303,(t39:0.4995286201,t40:0.4790225897):1.739842795):2.817263244,t41:5.02223758):5.85231607):0.6442790792,(t42:10.48212316,(((t43:0.4969819982,t44:0.4727064871):2.276997172,t45:2.487816302):1.019730462,(t46:0.6070723912,t47:0.5350421436):2.650905162):6.63166559):0.8772369532):0.9896396103,(((t48:0.4340450985,t49:0.3371722971):4.223720305,t50:4.556513813):4.277438378,((t51:7.524317625,((t52:0.5979715386,t53:0.5927978424):4.196441675,((t54:2.572435414,((t55:1.226469093,(t56:0.2022471162,t57:0.1472001094):0.9135339379):0.1107198724,t58:1.099483249):1.007036992):2.068765004,(t60:1.736828908,t61:1.701966854):2.376187615):0.06188620653):2.632013662):0.8890490449,(((t62:4.272644672,t63:4.243304789):0.4801089718,((t64:3.729212576,t65:3.665640434):0.5725564422,((t66:0.7754107026,t67:0.5576292515):0.189936156,t68:0.47663361):2.930000487):0.150123357):0.8157187967,t69:4.278591954):1.952173547):0.3703330033):2.656641799):0.634250965):2.196611821,(t70:1.212339498,t71:1.193615715):10.8572679):8.622378858,(((t72:3.497204144,((t73:0.8440387775,t74:0.8004719043):1.548196517,(t75:1.995972353,(t76:1.039928775,t77:1.033264258):0.9479325636):0.3029438003):1.01415135):8.437246348,((((t78:3.286808535,(t79:2.536909167,(t80:0.6526796489,t81:0.6492296948):1.842354253):0.7227294813):3.84557525,t83:6.967811559):0.01896041522,t84:6.734344846):0.9058327372,t85:7.639053506):3.641204276):0.03694681143,((t86:2.823083623,t87:2.516774888):4.425288342,(t88:6.512830603,((t89:1.205586328,t90:1.126655103):4.337450335,((t91:1.568859364,t92:1.513924094):3.003338036,t93:4.323119038):0.6557565322):0.6902870019):0.3873781926):3.920819679):8.688736405):3.092378258):1.736881096):2.06545226):1.31531888):3.19101427):1.175575291,(((((((t94:6.921156679,(t95:4.782571008,(t96:3.361777032,(t97:1.43730167,t98:1.294849664):1.885612741):1.401940863):1.991487005):5.293446747,t99:11.72891989):3.912719583,(t100:12.57386154,((t101:5.828771499,((((t102:0.6602709816,(t103:0.5346414405,t104:0.4040860617):0.107881717):1.322454594,t105:1.69486708):0.742265699,t106:2.389484872):2.350720238,t107:4.300709323):0.5608693804):4.373489565,((t108:2.736983774,((t110:0.9036858428,t111:0.4957397312):0.8802551671,(t112:0.1331389754,t113:0.02828356327):1.207367208):0.6645072534):0.5015566617,(t114:0.5220216848,t115:0.4739897465):1.864455756):5.921233241):1.990606676):2.950454038):1.026842379,((t116:2.148915776,t117:1.9729363):9.303518207,(((t118:3.710962968,(t119:0.1418582805,t120:0.1028621191):3.353866809):3.621296374,((((t121:3.982750182,t122:3.962998524):1.152277261,t123:5.115245141):0.03043603014,t126:4.856498836):0.1102205488,(((t127:0.282301486,t128:0.1658876966):1.307030082,t129:1.413553711):1.208138235,t130:2.537436163):2.108471523):1.607094119):2.535227178,(((((t131:2.27259933,(t132:0.9077723311,t133:0.7803616259):0.9710541806):0.06244915246,t134:1.77803137):2.346501442,(t135:3.91926112,t136:3.910843984):0.2048031528):0.4487668348,t137:4.43450533):0.1241086092,t138:4.43128297):3.311969401):1.329475771):2.676683272):1.018780068,((t139:8.214474572,(t140:0.6285593343,t141:0.5272969176):7.428184457):3.184247572,((t142:4.730570709,(t143:0.8380276934,t144:0.8054994578):3.838522603):3.735458472,(((t145:0.8280619963,t146:0.7337631046):6.723274461,((t147:1.359980187,t148:1.324888095):1.297758025,(t149:1.420599048,(t150:1.113592623,t151:0.9503312499):0.07418954706):1.078020585):4.778166888):0.6995664224,(((t152:3.249858463,t153:3.164087346):0.478420609,((t154:0.8035473415,t155:0.7382611661):0.9240574263,t156:1.544197878):1.864339983):1.880499405,(((t157:2.348498769,t158:2.269480113):0.7103717198,(t159:0.6251446648,t160:0.5452207398):2.322053918):0.3038558923,t161:3.01779052):1.864417398):1.85403704):0.01831226763):2.628428419):1.235344656):1.51004545,t162:12.11235611):2.985765604,((((((t163:0.2325720653,t164:0.2204573905):1.504304959,t165:1.715571614):2.906649218,((((t166:1.295269702,t167:1.285737384):0.1524055823,t168:1.345864963):0.2286668349,t169:1.562468876):1.794128696,(t170:2.714544447,((t171:0.2743526054,t172:0.1092798104):0.5752277742,t173:0.6728407339):1.797466491):0.6135775153):1.020637619):3.642567261,(t175:4.284354178,((t176:1.722567709,(t177:0.05542586562,t178:0.007847335236):1.529106502):0.3326557036,t179:1.826477561):2.154294671):3.299602991):3.518636691,((t180:6.85654324,(t181:6.415148962,((t182:1.163858941,t183:1.16125126):4.784901173,(((t184:0.8240669589,t185:0.4518637694):0.9555207585,(t186:0.5009553631,t187:0.4504819371):0.4778032142):2.508784044,t188:3.353236187):1.550786079):0.4078142631):0.4354109613):0.6847614887,((((t189:1.436682086,t191:1.304487346):0.1292668884,t192:1.416080248):1.442273918,t193:2.629325762):3.137466407,(((t194:0.6778131748,t195:0.4145184593):0.2828940029,t196:0.6349110033):2.546919093,t197:3.176057983):2.246920829):0.2701642453):3.037739373):0.7927560196,(((t198:5.995681223,(t199:0.9251631957,t200:0.8931976773):5.069049196):0.8676610094,(t201:4.312820635,t202:4.159392654):2.383809772):2.3406116,t203:8.55966626):0.3162003557):2.49729253):8.460902918):0.3901290196):1.372942155,((((((((t204:1.207981725,t205:0.7952799989):0.07167015828,t207:0.4262350132):2.654529243,t208:2.403929659):0.2999558533,t209:2.4912503):2.465190068,(t210:1.766209032,t211:1.758297278):3.143864041):0.4952633922,((((t212:1.409330554,(t213:0.4425910801,t214:0.4354848495):0.9525973648):0.05851876566,t215:1.443546939):0.08214524895,(t216:1.061425776,t217:1.055627549):0.3868091229):1.821568244,t218:3.126924383):1.924237005):4.656576403,(t219:6.353582374,t220:6.324375909):3.32540525):8.49023004,((((((t221:2.103916901,t222:2.049538503):5.13437439,((t223:3.737573345,(t224:2.454867645,(t225:2.19412841,t226:2.138839939):0.1845740961):1.064750754):3.111931155,((t227:4.571093823,(t228:1.36235133,t229:1.359952618):3.172844251):0.2713089232,t230:4.580622099):1.652616822):0.1592322846):0.1902641846,((t231:2.08508954,(t232:1.708528118,t233:1.616232886):0.1997315052):2.749638307,t234:4.512336332):1.235178848):1.006515832,t235:6.583259276):1.352148133,(t236:2.924571662,t237:2.750766524):5.004313327):6.161816559,((((((t238:1.721124812,t239:1.60740849):2.958889942,((t240:0.9846215713,t241:0.9204190717):1.775628882,t242:2.682799755):1.781640054):0.1679589611,(t243:3.782772637,t244:3.754416659):0.6593637519):2.568174995,(((t245:1.963954053,(t246:0.4225274354,t247:0.391211745):1.455020272):0.710896623,(t248:1.931058172,t249:1.774189455):0.5654703424):1.17885238,(t250:1.842998084,(((t251:0.3022421084,t252:0.283772493):0.4586601369,t253:0.565841615):0.2157547862,t254:0.7376716798):0.7896630783):1.626896249):3.074987963):2.994719221,(t255:3.222588412,t256:3.172248871):5.701639502):1.571408287,(((((t257:2.47278998,t258:2.466960389):0.5012611144,(t259:0.98179074,t260:0.9814614788):1.982591523):0.1859196615,t261:3.132273777):5.304088055,((t262:3.482948836,(t263:1.212779003,(t264:0.4894712162,t265:0.3580117207):0.6638860118):1.968826352):0.1126892291,t266:3.078027952):4.803151886):1.23715264,(t267:8.631357766,((t268:6.731479018,t269:6.644425989):0.7102859042,t270:7.256129122):1.092798046):0.117433786):0.6804000888):1.925315349):2.061059919):1.236537295):1.857564723,(((((t271:2.067461563,(t272:0.242864434,t273:0.08497556096):1.772737712):3.230282704,(t274:4.631558358,t275:4.630239853):0.4440852533):3.381333939,(t276:4.354809034,(t277:2.64993877,t278:2.361477863):1.587931193):4.046638754):0.961688732,(t279:3.305155554,t280:3.228365097):5.507656696):2.025659048,((((((t281:0.7630717371,t282:0.6275121442):0.9716223934,t283:1.540312167):3.89450709,((t284:3.884721437,t285:3.847687859):1.263623107,(t286:3.057754472,(t287:1.622552632,t288:1.394498666):1.064806531):1.793085112):0.2513167991):0.183829965,(t289:0.9621504441,t290:0.8804489498):3.630312098):0.05218165134,(t291:2.799295247,t292:2.785618106):1.566222349):0.486786229,t293:4.760148171):4.263511759):4.430250674):4.349599655):0.7691870349):9.129925159,((((t294:7.732556116,((t295:2.306906582,t296:2.193901803):2.714389158,t297:4.8430698):2.49407555):1.863466416,((t298:4.150659876,t299:4.106008994):1.772874971,t300:5.786047606):3.178059966):3.820109894,(t301:10.45222892,(t302:0.7559531118,t303:0.7458966217):9.314140829):2.270623771):2.581715733,((t304:4.572966343,(t305:1.359008436,t306:1.346803075):3.196894139):4.410362981,((t307:4.984713484,t308:4.905847267):3.233627045,((t309:0.1636577425,t310:0.06174770971):0.957221708,(t311:0.4328868883,t312:0.4135654234):0.4908818171):6.883313618):0.6049112948):5.810991793):11.66931584):21.56463974):33.89569264,((((((((t313:0.6894703391,t314:0.5867359857):1.482692672,(t316:1.841151226,(t317:0.2361380719,t318:0.2272287957):1.409966009):0.1976654827):1.778824753,t319:3.515944561):7.853907486,((t320:0.226814576,t321:0.1991130133):1.80188412,(t322:0.1463483068,t323:0.05354115912):1.689135785):9.258390413):2.587774504,((t324:7.305840725,t325:7.276400323):5.717377587,((((t326:1.439102692,t327:0.9863380156):3.349498875,(((t328:1.98314927,t329:1.97495837):0.04944486438,t330:1.903153469):2.09557416,(((t331:1.368664742,t332:1.34312185):1.889005149,t333:3.064831441):0.4504716337,(t335:2.249659474,(t336:1.677931976,t337:1.539544892):0.5132727638):1.18187147):0.06184206934):0.2051514347):5.584889499,((t338:5.811867438,(t339:2.17643571,t340:1.902929188):3.457023311):1.656196298,(((t341:2.812678931,t342:2.791413846):0.4216500882,(t343:0.7710971523,t344:0.7386452144):2.40131372):1.614203694,(t345:2.98596148,(t346:2.148221765,t348:1.768675034):0.7490225385):1.692004834):2.159217445):1.524173676):1.581559871,t349:9.369065773):0.8198655046):0.5067546206):8.482289395,(((t350:3.062312744,t351:3.007351732):8.246479423,((((t352:2.385226241,(((t353:0.2607274867,t354:0.2061332409):1.411190408,(t355:0.7057257372,t356:0.7009871498):0.8082272737):0.2505352266,t357:1.743103961):0.4626694108):0.05730899483,(t358:1.600188089,(t359:0.9657905479,t360:0.8949371935):0.5507633219):0.05178188474):6.000531426,(t361:5.584844811,(t362:5.238387234,(t363:2.916020186,t364:2.837973168):2.221440699):0.2934949014):1.847591355):0.6431627729,((((t365:1.186793402,(t366:0.5377557332,t367:0.3526347753):0.4421467744):1.961508998,t368:2.746105872):1.576429733,(((t369:1.080448109,t370:0.9223015948):0.1444089187,t371:1.059654977):0.560442348,(t372:0.4425244348,t373:0.3520986799):1.067497445):2.516616296):3.041873131,((t374:1.267973456,t375:1.204406319):2.407710337,t376:3.457558615):3.147438371):0.0734373232):2.081500788):1.807551603,(t378:8.79374501,(t379:6.602921243,((((t380:2.556198449,t381:2.506130607):1.57558505,t382:4.008783897):0.3684251949,((t383:2.529601609,t384:2.460989952):1.026377642,(t385:0.4113777434,t386:0.3577343235):3.007199252):0.7282427238):0.3204951546,t387:4.396495624):1.688398777):2.099317424):1.457683813):5.872539916):16.52383437,(((t388:2.886780614,t389:2.877411959):5.045420647,((((t390:1.238345011,t391:1.201978385):1.637970233,t392:2.729459272):0.08570825987,t394:2.397977543):2.8730662,t395:4.978430579):1.942304461):4.878582317,(t396:6.409154248,t397:6.403988488):5.220807803):18.95558426):36.86767522,(((t398:4.288396313,(t399:2.822174806,t400:2.486790488):1.109915414):5.715736726,(t401:0.2265298525,t402:0.15514741):8.840287771):13.73368607,((t403:1.904234066,t404:1.650987168):2.20306643,t405:3.800903514):18.5274413):43.5549797):4.919395722):1.069101479):97.4369874,(((t406:3.367418591,(t407:0.3560051156,t408:0.353987104):2.864532839):4.82054209,(t409:1.125964242,t410:1.12541473):6.50642927):137.6497267,(((((t411:4.748682519,(t412:1.126304069,(t413:0.08679890871,t414:0.05984053766):0.7044289572):3.504966637):1.451320748,(t415:3.453223842,(t416:0.2141622526,t417:0.213635618):3.224029936):2.200947254):3.226061132,((t418:4.605461399,(t419:1.256310159,t420:0.9872846889):3.311712138):3.789425484,t421:7.975424418):0.4142066167):1.085739164,t422:9.316967091):0.7258221115,t423:9.92423931):134.0310402):23.40316464):28.94502998,(((t424:1.542538363,((t425:0.04342601727,t426:0.03828241396):0.8072571622,t427:0.8119819577):0.6016554265):32.34804843,(((t428:1.372924966,t429:1.368002469):7.503226476,(t430:4.505984472,(t431:3.798159615,t432:3.779899521):0.6744915665):4.355671584):5.71661453,t433:14.49042712):19.1470499):63.93250031,(t434:10.55548984,t435:10.4424941):86.89713958):97.83079123);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T5.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
