<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t475:0.1620308301,t476:0.06660906468):0.7873970065,t477:0.7811240238):20.14879552,((t478:4.808496861,(t479:0.05840361179,t480:0.01129805916):4.56375252):0.9392453192,(t481:4.395404469,t482:4.218609736):1.114565668):15.12698456):12.7556304,t483:33.16627204):104.4582015,((((t484:3.30999551,(t485:1.454519782,t486:1.228662037):1.728903515):20.89575082,(((t487:3.295658438,t489:2.766546409):9.529487951,(((t490:1.043223853,t491:0.9359466929):0.5838938191,t492:1.464071171):3.487589173,t493:4.932319979):7.136863472):0.8143661468,((t494:6.104947199,((t488:0.3649766418,(t474:0.1020915515,((((t435:0.005821511847,(t430:0.01423919632,(t411:0.07297902914,(t410:0.2439020314,(t408:0.01768282545,((t382:0.06328822197,((t360:0.04583218061,((t351:0.08650793348,(t326:0.1960328483,((t300:0.01872826692,(((t255:0.0595655794,(t227:0.01910208414,((t154:0.04258470019,(t150:0.05897107769,(((((t73:0.02378436949,(t1:3.738345589,t2:3.625470264):2.543204889):1.149839179,((t3:3.1596677,t4:3.126153644):3.492722588,((t5:1.095155623,t6:0.9893205473):2.45573265,t7:3.223890575):3.0112962):0.6552351603):0.06255779018,t8:6.910423497):2.373797778,(t9:6.08912013,(t10:1.586365196,t11:1.499614424):4.24360401):3.049612362):1.151658236,((t12:7.562380456,(((t13:4.775809539,(t14:1.080338271,t15:1.027749148):3.64888635):2.14054825,(((t16:0.6583296869,t17:0.6213616345):3.093130278,t18:3.408600666):2.000357808,(t19:4.013119853,(t20:2.348456841,(t21:0.3074486083,t22:0.1771576655):1.990570513):1.66241524):1.339231973):1.032176964):0.5089725257,(t23:2.892498571,t24:2.736784363):3.777289903):0.03589149091):0.1481179094,(((t25:0.5520310521,t26:0.4259410601):0.582027337,t27:0.9132444958):4.577216774,(t28:1.561969522,(t29:0.9670260419,(t30:0.6179300399,t31:0.5953997985):0.2925607072):0.5904393086):3.924311325):0.9796503069):2.203447964):1.845338574):0.4325133289):6.236236609,(((((t32:5.676340244,t33:5.57385499):3.935290614,(t34:5.546392692,t35:5.486986945):3.793855025):2.101762012,(t36:3.586427323,(t37:1.253118956,t38:1.09122666):2.306034398):7.58517385):2.955278693,((((((((t39:1.348548469,t40:1.263875365):3.855088142,t41:4.942017139):0.6739292576,(t42:1.740325323,t43:1.703637377):3.846195273):0.3707788709,(((t44:0.2015519037,t45:0.01098917074):1.384723092,(t46:1.135479706,t47:1.123254882):0.2370722095):0.4367283994,t48:1.707064572):3.820137778):2.956272261,(t49:4.336028477,t50:4.329690111):4.143839022):1.749345221,t51:9.983214593):1.06053277,(t52:9.467173617,(((t53:0.8525910577,t54:0.7770033003):2.336550594,t55:2.920143772):3.141627247,((t56:5.189949764,(t57:2.387975279,(t58:1.455571358,t59:1.376533878):0.9233266989):2.739883329):0.4500418999,(((t60:3.247329651,t61:3.205109665):1.348655766,((t62:1.022703563,t63:0.9347775179):1.765423862,t64:2.600719725):1.525184621):0.5261247406,(((t65:0.9017731207,t66:0.8330559041):0.01072811179,t67:0.7077045089):1.704013404,t68:2.404673586):2.012337859):0.2551479163):0.2412299576):2.998818804):1.489692688):0.08719319355,(t69:4.830288872,t70:4.719653623):4.503605508):1.806949586):2.304792035,((((((t71:1.640129605,t72:1.624049038):5.319783074,(t74:4.369956211,((t75:0.5652856174,t76:0.5308999819):0.2363513225,t77:0.7591807554):3.125113266):2.431865871):0.4404290807,t78:6.644073752):0.1925615083,(t79:0.5178173526,t80:0.4980500714):6.222768663):1.436588722,(((((t81:1.672656022,t82:1.597980279):0.4939397947,(t83:0.2012040748,t84:0.1024834088):1.877898838):0.06380416144,(t85:0.5140571258,t86:0.5109714227):1.512557596):1.211075141,t87:3.223030283):1.564719852,(t88:3.251584115,t89:3.188443141):1.466557217):3.135919469):0.3841341782,t90:8.154999203):3.76611614):0.1207255343):0.1500617294):1.641127611):2.837529343,(((((t91:1.343668271,t92:1.34171757):3.385758429,t93:4.379138879):3.695566226,(((((t94:2.459631066,(t95:0.8680584388,(t96:0.3835527091,t97:0.3736854153):0.4041544575):1.58315015):1.42727284,(t98:2.571045176,(((t99:0.9395082083,(t100:0.7492551781,t101:0.6385921483):0.1695605877):0.9170946792,(t102:0.1707378556,t103:0.110052662):1.542234755):0.01675196707,(t104:0.04394960583,t105:0.00667879491):1.408467761):0.6695616743):0.9257021445):0.770278437,(t106:2.440455861,t107:2.402195521):1.203823521):0.08561518338,t108:3.691266556):1.980786301,t109:5.32231206):1.256348978):4.878791649,((t110:1.154404574,t111:0.9844447676):6.123020651,(t112:7.031424879,(((t113:3.695745491,t114:3.657689194):1.476119397,(t115:4.000974851,(t116:3.749874789,((t117:0.6409441875,t118:0.4969106512):2.937003203,(t119:2.547361489,(t120:1.077803005,t121:0.7620658445):1.44623902):0.8799920575):0.1572734255):0.2297784981):1.022828453):0.2350418374,t122:4.436941418):1.554285782):0.02888819805):4.077374489):1.124988457,t123:11.18808682):2.207472946):0.5218359451,(((t124:5.98794157,((t125:1.710788109,(t126:0.6355898748,t127:0.5517376159):1.015404856):0.4123007031,t128:1.973563467):3.666413403):2.257625648,(t129:3.25679659,(t130:1.394596145,t131:1.337782827):1.849598251):4.584215947):2.963906027,(t132:5.299842648,((((t133:2.36149086,t134:2.302682777):0.9095690158,t135:3.019343664):0.519051701,t136:3.385447955):0.5177024554,(t137:3.765242063,((t138:0.1876988654,t139:0.143930243):1.66985752,t140:1.774397176):1.860916077):0.0006390374999):0.9698633217):5.380036894):2.6901093):0.6559752308):2.637106512,(((((t141:1.083083193,(t142:0.5009628712,t143:0.4530076953):0.4751079558):3.795494182,(t144:0.608722252,t145:0.6026082646):3.735420636):0.2947404663,t146:4.581145635):5.557606794,((t147:5.958621847,t148:5.954309619):3.793085574,((t149:5.206626073,t151:4.929186444):1.449521503,t152:6.279630645):3.024115085):0.3173732681):4.506120592,((((((((t153:2.202768588,t155:1.961319631):2.402355024,t156:4.313652522):0.1490383795,(t157:3.424314367,(t158:1.530385876,(t159:0.9864593043,t160:0.8467222268):0.5004818474):1.859222425):1.0144962):5.175238146,(((t161:1.764387876,(t162:0.5929821661,t163:0.5211394868):1.162197256):5.018733625,((t164:4.120525447,(t165:3.464505947,(t166:1.414459876,(t167:0.8297437904,t168:0.7819697595):0.5400555478):1.914807473):0.1213291461):1.801275981,(t169:1.003729748,t170:0.9889868152):3.95439316):0.6579787318):0.7593466792,(t171:5.665584868,(t172:1.916425183,t173:1.823412075):3.536169267):0.647975014):1.748719268):0.2102585092,((t174:2.779773153,t175:2.738615112):0.6637812337,(t176:2.880339159,((t177:0.4651819908,t178:0.3813167836):1.492246293,t179:1.827786991):0.7698682257):0.4478584095):4.125912399):0.2198293484,(t180:2.621008232,t181:2.435882171):4.737915007):0.894285792,(t182:4.133896658,(((((t183:0.3322936424,t184:0.3257675131):1.699541771,(t185:0.4256772586,t186:0.3707193947):1.383700002):1.536421853,(t187:2.776644775,(t188:2.516511629,t189:2.454633083):0.2239191225):0.3396069724):0.1331214635,t190:3.109797153):0.06835803698,(t191:1.092550245,t192:0.8086136702):2.081878649):0.3305318173):3.854102557):1.566146782,((((t193:3.53956586,(t194:2.722253251,t195:2.67778685):0.6721886179):0.4660722015,t196:3.742488992):0.2367799859,(t197:0.5804931475,t198:0.5450638286):3.184285653):3.665240059,(((t199:2.752873186,t200:2.752201711):0.9043001458,t201:3.616923512):2.128434927,t202:5.73248826):1.391696094):0.7231098988):1.248447248):0.7237679421):0.6726556056):2.855790194):0.5764401103,((((t203:0.5531208096,t204:0.5210476565):7.570107762,(t205:4.499126844,(t206:3.206097879,(t207:1.730750548,t208:1.725647414):1.468465096):1.217029524):3.543670889):1.645104817,((t209:0.1557121314,t210:0.1547764982):3.229432917,(t211:3.223299737,(t212:2.915554467,t213:2.611742181):0.3071587225):0.02435276793):6.17557228):0.9917813949,(((((t214:4.39732527,t215:4.393304187):2.127229774,((t216:1.635403383,t217:1.551438643):1.650391101,t218:3.148359844):3.199681599):0.3485770069,(t219:3.712088966,(t220:0.8281253784,t221:0.7416916605):2.829874925):2.967058362):0.7833188709,((t222:0.2281334479,t223:0.1649481528):1.677731363,t224:1.832675757):5.335783275):0.03957731885,((t225:4.502659847,(t226:4.019604251,t228:3.857497):0.4411561003):1.922080346,(t229:3.507772003,t230:3.362081494):2.689348718):0.7102323176):2.340514835):3.105242402):0.4377887015):2.395522918,(((t231:1.992644816,t232:1.987912075):0.07597368694,(t233:1.758015261,t234:1.704334989):0.3032051011):3.564044057,t235:5.56554726):9.279754321):0.1080661235):0.5737289742,(((t236:8.604732449,(t237:5.860867314,(t238:3.9103647,(t239:0.4592774261,t240:0.4439269246):3.396805055):1.949461016):2.692200039):4.508899022,t241:12.9448691):2.086831002,((t242:5.233693257,t243:5.230334359):8.529013659,((t244:0.4837459938,t245:0.2400656368):3.816323457,t246:4.027487079):9.375752426):1.254792749):0.1004224259):2.160081168):0.3398943127):0.1185787667):2.323929272):0.4873424956):1.011819609,((((t247:8.122754079,(((t248:1.943941759,((t249:0.405855242,t250:0.3863460606):0.9291984867,t251:1.248446056):0.5800542684):0.3394266842,(t252:1.887599645,t253:1.803426865):0.2050790693):2.263889578,(t254:0.2510472472,t256:0.1246731506):3.959161343):3.49862617):2.158264933,(t257:9.029691132,t258:8.96002466):0.3739901803):8.654369861,(((((((((t259:0.8792534373,t260:0.7343218927):2.225385577,t261:2.872291086):1.759416833,((t262:0.3919669385,t263:0.3795540225):3.86536659,((((t264:1.689920119,t265:1.578245237):0.4085857429,(t266:1.490963763,(t267:0.692227129,t268:0.5882998231):0.785309354):0.3685589882):1.013448745,(t269:1.480789946,t270:1.472702201):1.227357981):0.8296114607,t271:3.498921832):0.2711274971):0.2800518892):1.024423061,t272:5.060232153):2.407196984,t273:7.365693757):0.7222633332,t274:7.930812202):6.063138124,((((t275:0.6208723633,t276:0.4457520529):0.425905439,t277:0.7215970478):6.984867014,((t278:0.2782434841,t279:0.2723937539):6.78213786,(((t280:1.007312469,t281:1.005580448):0.5846047851,(t282:0.6287440696,t283:0.6071805173):0.6788299482):4.139064162,((t284:1.707481524,((t285:0.7912566788,(t286:0.3053275191,t287:0.239371179):0.4554863207):0.4317216537,t288:1.114583023):0.4166893144):1.139443261,t289:2.631368723):2.556486895):1.272142315):0.3812031319):0.7568662674,t290:7.452975877):5.164963806):2.305963028,(((t291:2.868225826,(t292:2.213538051,(t293:1.366212887,t294:1.338607826):0.6772127841):0.3109198518):5.060073452,(t295:4.519261444,(t296:0.5845964444,t297:0.5160977808):3.922775037):2.848740146):1.307651241,(t298:0.4122619757,t299:0.4075687405):8.104870122):5.681112147):0.06121877014,t301:13.96758041):0.3998455587):0.3118082438,((t302:3.172343679,(t303:0.7768795828,t304:0.5424178916):1.939365353):8.559344326,(t305:5.013171602,(t306:3.300787533,(t307:0.4312173544,t308:0.4254672743):2.682537239):1.705472499):5.994802409):2.906162968):1.949072703):1.463392013,((((((((t309:1.248162358,t310:1.138214614):2.62086106,t311:3.700500274):0.4291437014,t312:4.044017306):0.1606493221,((((t313:0.08576946291,t314:0.07690600217):0.8738730141,t315:0.9278366064):1.894335934,(t316:1.613821251,t317:1.500455253):1.074341845):1.051063039,t318:3.584316275):0.1269248171):1.191666723,((t319:2.408571486,t320:2.140667621):0.5446391662,(t321:1.486285251,t322:1.333354577):0.8583965638):1.909776336):0.8721355581,(t323:1.923523068,t324:1.895874468):2.887194176):0.8558034079,t325:5.50325624):6.197297101,(((((t327:1.387069986,t328:1.379185342):0.6813613101,t329:2.031558548):1.813504087,t330:3.814787449):2.75385252,(t331:3.113998915,(t332:1.880247399,t333:1.853816397):1.042202728):3.119834719):2.416797732,t334:8.390152634):2.28979528):3.468411553):0.7718617844,t335:14.84603918):1.429606444):1.729358584):3.922767978,(((((((t336:4.202197797,(t337:3.794508705,t338:3.778888632):0.3322118028):2.85994203,(t339:2.019711167,(t340:0.39390405,t341:0.3898685455):1.537015019):4.7670168):8.820937655,((((t342:2.599510854,t343:2.588853728):2.328762937,((t344:3.860554861,(t345:3.605924414,(t346:1.298903891,t347:1.270087939):2.234231746):0.08954465799):0.4799968406,((t348:1.744846686,t349:1.742263528):1.516912842,(t350:3.161069368,t352:2.623536199):0.05320599993):0.5207987052):0.2822725131):2.167725537,(((t353:1.279654363,t354:1.041813929):2.58492334,(t355:2.013223756,t356:1.991042692):1.564904761):0.6791889521,(((t357:0.9800024531,t358:0.8574022078):0.8461932787,t359:1.66014153):0.799067025,(t361:0.7989383091,t362:0.6692897726):1.467955054):1.4539238):0.820333598):0.02796366182,((t363:0.660831936,t364:0.6172515995):0.3996247424,t365:1.007951439):3.306784985):8.132962928):1.029288503,((t366:1.882757533,t367:1.837512216):10.11253939,((((t368:1.301099464,t369:0.7399346879):9.004908747,(((t370:1.654703264,((t371:0.2730230586,t372:0.1632540724):0.8208313297,t373:0.9752917295):0.3365286113):1.745762139,t374:3.016522898):5.560421525,((t375:0.7691311774,t376:0.6746692302):4.327643505,t377:4.950958642):3.442845571):0.7125786299):0.06504401385,(t378:4.964077947,t379:4.7459589):4.17755823):1.463874764,(((t380:0.8013629112,t381:0.7989618671):3.798024479,(((t383:2.03611606,t384:1.940705214):0.2439597293,t385:2.066495079):1.392192305,t386:3.40759322):0.3445969959):1.323564817,(t387:2.417064257,t388:2.194245391):2.595122468):4.418751723):0.07631996059):1.288158354):1.799854791,((t389:1.576563309,t390:1.514554247):4.655543972,(t391:2.092000823,t392:1.864042715):3.97595436):6.091947185):0.6000977531,((t393:0.1946628602,t394:0.171825897):2.452676327,t395:2.542516216):9.742536492):0.04261338045,(((((t396:2.959766457,t397:2.923991223):2.210281942,t398:5.060119443):1.345202537,(t399:2.094238184,t400:1.830086543):4.293931551):1.151421953,(t401:6.429307017,((t402:0.1906410019,t403:0.1256603348):5.082007345,(t404:3.214425839,((t405:0.3065518148,t406:0.1851541324):0.8923612605,t407:0.8042038324):1.867830428):1.984035445):1.149552886):0.7726810817):3.496035865,(t409:5.08159919,(t412:2.483088902,t413:1.967619248):1.971046371):4.883412794):1.062323918):2.540636022):2.582893027):2.749870984,((t414:6.663703497,(t415:0.606026066,t416:0.568229904):6.024157744):2.362084771,((t417:1.842799115,t418:1.698669398):4.820970674,(t419:5.982332849,(t420:4.894836411,(t421:2.638607498,t422:2.567961737):2.20034095):1.068130517):0.4554297402):1.873173179):8.681910779):3.971771277):10.14045566):0.2329159636,(((t423:2.874725984,t424:2.823255523):14.32195824,(((t425:6.691268761,(((t426:4.181114578,((t427:3.274605566,t428:3.25023254):0.4338429553,((t429:1.229116121,t431:0.8543750286):0.8266427016,(t432:0.3659893701,t433:0.3345964917):1.287913724):1.506990487):0.4614178546):0.6353247425,(t434:3.790386419,t436:3.389045928):0.4008116293):0.1826734345,t437:3.91139914):1.434502221):2.626494612,((t438:1.184170931,t439:1.072563449):5.137103004,t440:6.166465462):1.613143912):1.789308671,((t441:1.735619332,t442:1.498025771):4.607703618,((t443:3.049598948,(t444:2.190681724,t445:2.163820383):0.7156190049):0.4888649572,t446:3.249220008):2.474218252):3.192706427):6.019139593):10.78470066,(((t447:6.347445572,t448:6.292465327):1.019969016,t449:7.148588512):1.014986617,((t450:0.2539724063,t451:0.2512143793):3.053753188,((((t452:0.5071577321,t453:0.360221857):0.1400203724,t454:0.4280089813):1.222394796,t455:1.598636965):0.9699741612,t456:2.353972707):0.4295186403):4.643416761):17.26588868):3.119175265):35.83774077,(t457:0.1906066755,t458:0.07247454344):63.33913449):77.25674741):45.46058294,(((t459:3.767207651,((t460:1.079684401,t461:0.7480588289):2.430705942,t462:3.080476072):0.1063130922):2.868177114,((t463:1.36640511,(t464:0.4639256686,t465:0.3824933219):0.7866098435):0.7841484601,t466:1.823144289):3.812276691):13.63687637,(((t467:3.405864471,(t468:1.24387707,t469:0.9056511008):1.933923501):0.3858328436,(t470:1.929367859,t471:1.897845243):1.29568759):7.977875743,(t472:1.867015074,t473:1.865113695):9.181054338):7.246153616):165.696048);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T70.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
