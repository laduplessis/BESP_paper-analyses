<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((((t386:0.07405123391,(((((t243:0.1514367946,t244:0.003279344657):0.09844208926,((t213:0.2205304589,(t210:0.1151081738,((t133:0.09104658845,((((t35:0.1742451622,t1:2.644892477):5.809538828,t2:8.376347409):1.007785737,((t3:1.714964032,(t4:1.519398485,t5:1.483717221):0.1149893871):1.486946291,t6:2.987925689):6.131852057):1.265492279,(((((t7:3.692110276,t8:3.644540168):0.5555641461,t9:4.157362259):2.107801347,((t10:3.007049474,(t11:2.666181245,t12:2.649935055):0.2565039095):1.287558614,t13:4.177190416):1.852455752):1.476879519,((t14:1.081342374,t15:1.054345922):0.385880914,(t16:0.1124113824,t17:0.02046016072):1.179615893):5.974683718):0.5005375784,(((t18:3.86247813,t19:3.729336854):2.216458881,t20:5.911431662):0.5046454612,(t21:2.183183562,t22:2.147886202):4.120242628):1.086598447):1.730709229):1.73331834):1.480546085,((((t23:3.06442521,(t24:2.844335757,(t25:0.4000249482,t26:0.3902528994):2.271408893):0.1979920735):1.778447464,t27:4.596297255):2.817744813,(t28:1.060237571,t29:1.053874219):6.347818216):2.297357067,(t30:4.719614146,t31:4.586574486):4.950638706):2.32599242):7.103679094):0.3176806613):2.642428584,(((t32:3.842459355,(t33:3.125046802,(t34:1.127606291,t36:0.7465074024):1.956502097):0.5773216584):3.536755168,(t37:6.023731537,(((t38:1.123870829,t39:1.036831827):1.178816732,t40:2.188602243):3.269669366,(((t41:0.1181821761,t42:0.100209867):1.215893562,t43:1.159556818):3.245724751,t44:4.285589124):0.8642652931):0.4071417009):0.6437735636):13.89771172,((((((t45:0.3694863018,t46:0.2799627977):4.902461408,(t47:3.977631206,(t48:3.130321241,t49:3.052072807):0.8452223318):1.196097346):6.551052253,((t50:2.171431756,t51:2.020482679):5.186800671,((t52:2.907164281,((t53:2.14535233,(t54:1.381648909,t55:1.36214706):0.7355161726):0.2571855639,t56:2.349189648):0.4565478341):1.400572524,t57:3.902022624):2.850104304):4.24405663):2.834647942,t58:13.68922917):1.070728801,t59:14.74188528):2.265432426,((t60:10.38021536,((t61:5.458654643,(t62:2.930456033,t63:2.912727029):2.479528364):0.1432781923,t64:5.39272291):4.744403749):1.939918511,((((((t65:1.417067389,t66:1.372804051):3.198299847,t67:4.489901267):2.352245344,t68:6.729091573):0.3452141737,((t69:1.019471833,t70:1.006251613):2.868610847,(((t71:0.07167156966,t72:0.05629468843):0.1643432998,t73:0.2176028154):2.512957273,(t74:1.636388419,t75:1.534958138):1.031951918):0.7879035655):2.946712919):0.5274148995,(t76:6.759619776,(((t77:0.6354862464,t78:0.5450383348):0.7968292039,(t79:0.6872034286,t80:0.6865607275):0.2631140154):1.028195115,(t81:1.572919775,(t82:1.212738784,t83:1.044091452):0.2297992962):0.116262867):4.151196255):0.009745412954):3.844511655,((t84:3.994824703,((t85:1.129811024,(t86:0.4867383471,t87:0.3938871441):0.5730215297):2.085066903,(t88:1.592974181,t89:1.167869724):1.448878779):0.7255330665):1.491314561,(((t90:2.103078568,(t91:1.045627164,t92:0.960856903):0.881764586):0.9860792204,t93:2.767932431):1.222548757,t94:3.925570333):0.5106777981):3.875401981):0.3875087808):4.399074372):2.044930997):0.4939655338):0.5574608699):8.047887702,(((((t95:10.33181127,t96:10.32742594):0.9611075124,(t97:3.255154382,(t98:0.6954235349,t99:0.669144593):2.463004801):8.016929986):2.459722827,(t100:2.024403588,t101:1.956682218):11.56827685):4.646616184,((t102:7.001634072,t103:6.878069657):0.8923391849,(t104:2.807663419,t105:2.630896497):4.66746473):10.21521452):1.647141042,((((((t106:3.937786403,t107:3.689167804):1.626012969,(t108:4.28292923,((t109:2.337739473,t110:2.249088193):0.9880621097,((t111:1.223256153,t112:1.212795946):0.7746139779,t113:1.952770964):1.207187514):0.9184911164):0.9302481932):2.486817247,(((t114:1.361196605,t115:1.211327853):4.263677892,t116:5.462582186):0.641199724,((t117:0.1599839556,t118:0.09875148471):5.384263156,(t119:1.892749066,t120:1.793627429):3.471160196):0.5459334674):1.120433233):2.876969368,(((t121:0.5343314655,t122:0.2790893413):2.668301907,((t123:1.484692984,(t124:0.2198159907,t125:0.195143056):1.118886249):0.1093500457,t126:1.153650769):1.273135183):2.195327107,t127:4.548686623):4.308028099):6.053525746,(((t128:1.423508701,t129:1.191251323):0.5017110908,t130:1.326330583):2.868249174,t131:4.082400005):10.08373341):1.79848171,(((((((t132:1.224052356,t134:1.110529376):3.632951972,t135:4.670603677):5.53146068,((t136:3.382693406,t137:3.306771713):3.33055804,((t138:1.978755253,t139:1.931432187):3.154611232,(t140:4.804773248,((t141:1.128015777,t142:1.074079289):2.477598479,(t143:2.335383189,t144:2.104392266):1.151013782):0.9894704971):0.1719168524):1.492053843):3.408292365):0.4630437997,(t145:1.787383526,t146:1.714900404):7.896049408):1.070798751,((((t147:1.611004247,((t148:0.8272126041,t149:0.7715946472):0.06342468043,(t150:0.1940968593,t151:0.1286379572):0.6387911627):0.6161424575):0.1055985137,t152:1.284311774):2.331485028,t153:3.402985445):3.568780039,(t154:1.766758352,t155:1.596551624):5.178169546):2.957715173):1.623122589,((t156:2.992189815,t157:2.949291086):8.047932232,(((t158:4.237697099,((t159:2.609214729,(t160:1.128129177,t161:1.023520879):1.385460873):0.1283521165,t162:2.490858161):1.387934663):0.8032608993,t163:4.654638758):0.09476743113,(t164:1.996291448,(t165:0.7919117344,t166:0.7586707661):1.14399666):2.553314649):5.820095673):0.07974409958):0.4079046735,t167:10.55723874):2.001303078):0.1234471134):4.180051069):0.5954170986,((((t168:1.648175405,(t169:1.207668328,t170:1.204754666):0.1868363209):5.136452178,(((t171:0.5408977921,(t172:0.4997773286,t173:0.4674770613):0.01236955445):0.7217755246,t174:1.195995607):4.083805135,t175:5.078349864):1.062136385):5.124958967,(t176:1.695411403,(t177:0.9454902814,t178:0.886385632):0.4562882783):9.502278209):2.438533835,(t179:11.81889477,(((t180:0.5322563421,t181:0.3513668972):7.074467901,(((t182:0.6753751732,(t183:0.2242332025,t184:0.1771807157):0.2836678057):0.9718630791,(t185:1.241560737,(t186:0.3602608566,t187:0.1959042277):0.7404562011):0.1356178176):0.9188006198,(t188:0.8189829036,t189:0.3734616523):0.9841621344):4.718063999):1.806542911,((((t190:1.493874249,t191:1.319564775):0.4549538541,t192:1.628603728):3.32793533,(t193:1.609656151,(t194:1.261143686,t195:1.113849258):0.3101385771):2.976357884):0.7963336022,((t196:0.5834088287,t197:0.5539817115):4.109808675,(t198:2.227957125,(t199:1.635572738,t200:1.506067948):0.4666043532):2.33512785):0.4487247319):1.801277038):2.388881274):1.366058447):2.95787954):1.661846831,(t201:9.420553714,((t202:2.215511106,(t203:1.681203655,t204:1.66763544):0.2776121354):6.610699212,(((t205:2.845871538,(t206:1.253495847,(t207:0.7357282911,t208:0.5139725723):0.5133319726):1.45611563):3.895603886,t209:6.36844127):0.7303959761,((t211:2.315656476,t212:2.282003251):4.132480503,((t214:1.284908042,t215:1.154676646):1.439298876,t216:2.590710347):3.417486446):0.2210023657):1.066952202):0.5191364372):5.507293855):3.166087903):5.22405843,((t217:9.302389462,((t218:5.879090486,((t219:3.885302901,t220:3.858973942):1.067766365,t221:4.902125247):0.7556030857):3.30959776,((t222:0.6544490259,t223:0.2569446105):2.655438469,t224:2.897093509):5.481173196):0.1003928998):11.42556145,((((t225:3.915536579,t226:3.744251612):1.439524702,(t227:4.778216483,(t228:1.287491513,((t229:0.5368754633,t230:0.5130105086):0.2708563944,t231:0.7735750156):0.4044388817):3.437452141):0.1854272702):11.71146086,(((((t232:9.137924468,t233:8.976987865):2.406255015,((t234:0.5018528094,t235:0.3862449964):0.8166025985,t236:1.012841131):9.987856818):1.184094677,(t237:3.40217074,(t238:1.244626767,t239:1.150380069):2.117106099):8.728313836):0.8000938117,((t240:7.925393894,(((t241:2.640202497,t242:2.566198737):0.09298489182,t245:2.234379995):0.007246111877,t246:2.112829541):5.14298417):4.502753726,(((((t247:0.5216065421,t248:0.4965412672):0.5484444151,t249:0.9241056867):0.3581716229,t250:1.131571579):5.195757996,(t251:5.200436194,(t252:0.5685607813,t253:0.5334105625):4.616414067):1.050900041):3.823639337,((t254:3.499228371,(t255:2.880871788,t256:2.803649359):0.420566643):4.822028026,(t257:3.126034377,(t258:1.418970817,((t259:0.7923996698,t260:0.7610661893):0.4003047812,t261:1.155575544):0.06359953621):1.414062937):4.673708569):1.593936258):1.268195483):0.2816626577):2.423198481,((((t262:5.220808795,t263:5.155796226):0.774344315,t264:5.819304577):1.234422883,((((((t265:0.5990722693,t266:0.4467428631):1.69543586,t267:2.106235187):0.1404968153,(t268:0.6584464902,t269:0.575072524):1.490371236):0.2479157421,t270:2.245547844):0.6456867255,(t271:1.083409687,t272:0.9407555553):1.637008137):0.1553284121,(t273:0.4276145923,t274:0.3975927129):2.253840312):3.558719444):2.766162743,((((t275:2.207334685,t276:2.192517509):2.583947503,t277:4.545423749):1.96845591,(((t278:0.1055250529,t279:0.1044827894):3.088372362,((t280:0.6956607233,t281:0.6555363256):1.032229539,t282:1.516263374):1.345550124):0.8446427723,(t283:3.522030756,t284:3.392395279):0.1781851463):2.426872805):0.3209449589,t285:6.22022959):1.835420818):2.693610619):0.3799755763):2.63943502,((((t286:1.23445666,t287:1.014618888):4.571097184,(t288:2.159293134,(t289:1.014208671,t290:0.7625740084):1.081673244):3.341473718):2.592911405,((t291:2.759148327,t292:2.329195288):0.2939436967,t293:2.588286027):4.571614555):1.224937079,((((t294:0.6467169365,t295:0.3515754622):2.222145588,t296:2.438875669):3.004668172,(t297:1.243093237,t298:1.16780883):3.908816001):0.5402598004,(t299:3.664573661,((t300:0.7707931375,t301:0.6526071521):1.578781398,((t302:0.8244243926,t303:0.7679253897):0.3318313106,t304:1.019154074):0.9680511974):1.270067582):1.941798489):1.964180844):4.058814151):0.1280417337):0.8855546929):3.552815873,((((((t305:0.6254498617,t306:0.6171290142):1.886833423,(t307:0.5472335476,t308:0.5119378679):1.805725636):4.120862791,t309:6.432021808):4.186888447,((t310:4.586624382,t311:4.439888377):5.096082566,((t312:0.491384518,t313:0.4095820381):6.898044347,((t314:6.370327892,((((t315:1.775978441,t316:1.761025883):0.2871578354,t317:1.794238251):1.637719012,t318:3.365136172):1.215409455,(t319:1.617598871,t320:1.608325025):2.938082807):1.333013964):0.2868764071,((t321:0.5781917683,t322:0.5486090234):4.51735977,(t323:1.268909938,t324:1.207316506):3.465386085):0.9608769311):0.5762272858):1.99895466):0.9033620384):3.70345815,((t325:6.398348579,((((t326:0.5555617997,t327:0.1092837567):3.771314425,t328:3.858594328):1.011914384,((t329:2.576107906,t330:2.547522941):0.06894835068,(t331:0.963907756,t332:0.9555866663):1.624469591):2.110500323):0.4856339473,((t333:0.3262316661,t334:0.3015799491):2.836125394,t335:3.107666312):1.948062029):0.5348644828):4.449868934,(t336:2.661027164,(((t337:0.8398720254,(t338:0.804472765,t339:0.6006677608):0.03348850591):0.5144783584,t340:1.070134732):0.8481062589,t341:1.683704397):0.4233628977):7.359753662):1.965858695):0.178635926,((t342:3.210839123,t343:2.861418657):5.097925717,((t344:3.075228287,(t345:0.04247753719,t346:0.02980579227):2.953664143):3.175914182,t347:6.015715837):1.580789977):3.213518525):1.037171367):0.4109777206,((((t348:3.977462036,(t349:1.202132926,(t350:0.07957802784,t351:0.07733573416):1.054050827):2.699069699):3.354077198,(t352:2.550245439,(t353:2.339851455,t354:2.290756155):0.1539410469):4.518207109):1.422487278,((t355:1.363568158,t356:1.235097292):5.522616878,((t357:2.656094501,t358:2.601433846):3.310054481,(((t359:1.318818941,(t360:0.3107479531,t361:0.1359452689):0.9149454311):2.390122447,(t362:1.489605337,(t363:0.9522350478,t364:0.8008220615):0.532225759):1.91452284):0.5891630618,t365:3.807614213):1.60554094):0.6787302621):1.464608998):3.053604309,t366:10.57168652):0.4180880476):1.787896463,(((t367:1.3721321,t368:1.251690321):3.785818083,(t369:0.684137059,t370:0.575753443):4.316241765):3.411022969,(t371:3.722603939,t372:3.705952784):4.256013081):4.184817072):0.5906480872,((t373:1.447658797,(t374:0.2228554624,t375:0.2143551974):1.046035779):5.142341938,(t376:3.798767353,(t377:1.851619799,(t378:0.9782891845,t379:0.9061556941):0.8479447208):1.902445273):2.595287978):6.098635092):11.48672782,((((t380:3.215445552,(((t381:0.211624635,t382:0.1691277461):2.478268182,(((t383:0.3644659797,t384:0.3426262572):0.3153062856,t385:0.5497818985):1.454130338,(t387:0.9746792835,(t388:0.5829651006,t389:0.5298717743):0.3496832495):0.7586519621):0.1152644972):0.2390534182,((t390:0.3747581714,t391:0.2840726339):0.4413820253,t392:0.6488753175):1.098722156):0.2832708854):0.09010719419,t393:2.109827941):10.05072949,((t394:3.321715281,t395:3.250578981):1.467423682,((t396:1.064356462,t397:0.718591048):0.5504986689,t398:1.262647367):3.086678605):7.113231931):6.535369125,(((t399:5.335069748,((t400:0.7591556224,t401:0.7112229478):0.5241505868,t402:1.157269672):3.955784418):3.441852233,((t403:0.8395234287,t404:0.6128838529):6.432925822,((t405:4.890097655,((t406:0.7055430253,t407:0.4406934207):3.238468723,t408:3.528763338):0.757977153):1.921334941,((t409:1.856695569,t410:1.844423653):0.5334873216,(t411:1.020872542,t412:0.8136919144):1.245760256):3.596862188):0.1135960979):1.250661213):1.755575115,t413:8.436593849):7.461363385):3.920762147):3.177673744,((((((t414:2.30922315,t415:2.23790781):1.059818625,(t416:2.560898359,t417:2.502504301):0.6435344855):0.272322638,(t418:1.272964827,(t419:0.7413875272,t420:0.6517059307):0.5050968759):1.92108693):7.525168838,t421:10.58355771):1.590551409,t422:11.94743204):7.231447724,(t423:4.335615484,(((t424:0.2215634129,t425:0.2183835056):2.004363385,(t426:0.5532569083,t427:0.3778133302):1.665485946):1.296558011,(t428:0.8525873192,t429:0.6666573898):2.474837548):0.7695607357):14.80392322):2.633402908):20.88555031,(((t430:4.737061275,t431:4.702521008):0.2696749293,((((t432:2.145002397,(t433:1.796801756,t434:1.740634735):0.3246128145):0.4539137682,t435:2.505692462):0.2105764178,t436:2.568802041):0.3240930344,t437:2.768764897):1.819419754):16.77176465,((t438:1.273736764,((t439:0.06018621307,t440:0.02557784431):0.6871012025,t441:0.6743548853):0.3285152021):14.73397876,(((t442:0.6065829549,t443:0.5755694708):4.872709552,t444:5.390916841):6.242189605,((t445:1.852649513,(t446:0.3159233899,t447:0.3116487594):1.49318008):1.920896217,(t448:0.945013103,t449:0.941102249):2.619065778):7.633398154):3.989403053):5.283333716):20.41419142):5.310533365,((t450:5.228354154,t451:5.217114038):12.35557342,(((t452:4.888753542,(t453:1.128720416,t454:0.9982661953):3.759339449):2.329479284,t455:6.989348182):4.353742965,(t456:2.439211222,(t457:2.000168182,t458:1.934235596):0.3193944606):8.898428657):5.912902012):28.5323218):67.71679832,((((((t459:5.041122202,t460:5.009426498):1.161057599,(t461:5.15824553,t462:4.883807617):0.7431257448):1.500073365,(t463:1.263725117,t464:1.212174188):5.798432114):11.30614891,((t465:1.417656851,t466:1.375585492):0.6712871153,(t467:1.604255489,t468:1.601137688):0.2997052863):16.00500251):3.011420116,((t469:9.041356474,((((t470:0.07673835804,t471:0.06423521836):1.243311218,t472:1.254680555):0.2487269718,t473:1.39283376):1.228795643,(t474:0.9736804234,t475:0.9128015054):1.61067276):6.071297231):3.428620921,(t476:3.088405388,((t477:0.3198087622,t478:0.1888207743):0.3308248623,t479:0.5056160602):2.304886251):8.930227698):8.153139575):17.62272891,((t480:2.029921781,t481:1.96151633):29.48136771,(t482:8.896378099,(t483:4.379155491,(t484:1.882266387,((t485:0.1986350659,t486:0.07513701447):1.184980024,(t487:1.115275066,t488:1.11087076):0.128586684):0.4945274535):2.415431841):4.382496436):22.44769489):5.980555452):73.34655176);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T78.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
