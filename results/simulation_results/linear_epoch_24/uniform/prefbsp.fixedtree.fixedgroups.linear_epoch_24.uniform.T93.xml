<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t462:4.134756245,(t463:0.3498400739,t465:0.08006408768):3.775648569):0.9680958025,((t467:2.440444733,t468:2.415347483):2.098808234,t469:4.247444435):0.1348123965):0.5185166221,(t470:2.987285877,((t471:1.99312914,t472:1.906269298):0.1928401843,t473:2.043547751):0.684662159):1.882171192):2.475743951,t474:7.053114401):3.656739495,t475:10.70053279):74.61887421,((((t476:27.62117176,((((t477:0.6944328525,t478:0.6805195452):9.382761111,t479:9.841283351):7.414735316,((t480:5.235273784,((t481:1.856838953,t482:1.811142938):1.130782672,t483:2.576515139):2.027486135):9.967853645,(t484:13.38728249,((t485:2.757394475,(t486:1.261980476,t487:1.065545631):1.476632016):3.667512497,t488:6.199215557):6.891565628):1.149104003):1.776043887):7.8440052,(t489:4.474761651,t490:4.419440017):19.3247602):2.264953635):3.991496044,(((t491:4.315035302,t492:4.249066486):7.371133604,(((t466:0.08041010053,(t464:0.04781704988,((t383:0.05820899452,((t338:0.4417374841,((t278:0.2854066189,(t271:0.02697433732,(t257:0.04070823163,((t214:0.02549100059,((((t152:0.1179700039,(t148:0.0930498022,(((t66:0.2027929131,(t1:1.455679748,t2:1.43092637):4.705766009):1.922036528,(t3:0.3853255586,t4:0.3537518635):7.627592313):5.776665139,((t5:8.033612428,t6:8.003391275):2.903250701,t7:10.8201191):2.698602264):0.7345275757):0.4760583708):0.3830809396,((((t8:4.388170145,t9:4.328063067):3.559254744,(t10:4.007411644,t11:3.747700689):3.49210732):4.541062676,t12:11.71739285):0.821219789,((t13:1.17509189,t14:1.025489631):5.098347884,(t15:0.9830088415,t16:0.7215353311):5.064731723):6.12363379):1.797205336):0.9525265019,((((((((t17:2.035861445,t18:1.962324897):2.137331737,t19:4.079309637):3.045051437,((t20:2.815188945,(t21:1.803948492,t22:1.790761579):0.9519650473):2.805460363,(((t23:0.1485077403,t24:0.1452818209):1.166126521,t25:1.154595378):3.936621952,(t26:0.9700025881,t27:0.9339059453):4.042397935):0.2906654647):1.441546945):0.9252666029,t28:7.574117866):1.341497734,(((t29:0.2547971047,t30:0.2130706403):0.2655725448,t31:0.33631736):6.331237691,(((t32:1.561120867,t33:1.526099563):0.8013529531,(t34:0.8925757389,t35:0.8136167987):1.411053829):2.32640222,(t36:1.108282328,t37:1.018763508):3.436523906):1.863336094):1.873913862):0.9626166748,t38:9.154136238):1.896071231,(t39:2.598300044,(t40:2.343960405,t41:2.237955294):0.2282882047):8.230011419):0.5901228846,(t42:1.495829161,t43:1.486469292):9.680289701):1.551088066):1.005381223,(((t44:4.267404677,((t45:0.4310407375,(t46:0.2616801735,t47:0.2397190764):0.1561945089):3.820919419,t48:4.153840178):0.005942068483):2.100705566,t49:6.197764563):4.719099628,(((t50:0.2675024573,t51:0.08722722711):4.425758597,(t52:2.839504245,t53:2.53151179):1.667237868):5.410758275,(t54:3.782176981,t55:3.318857928):5.812530405):0.7438445222):2.621368091):3.716016363):0.1057563437,(((((t56:3.056134485,(t57:2.564252889,(t58:0.734591501,t59:0.6544624988):1.827716355):0.2693175359):0.8484250394,((t60:0.2224416477,t61:0.2042313889):2.702434205,t62:2.763812028):0.5962402924):4.763414814,((t63:0.8619933817,t64:0.8251346563):3.603385447,t65:4.385326609):3.541566362):0.4967762698,(t67:1.142775786,t68:1.130369203):6.904266204):5.556042628,(t69:1.83271112,t70:1.780853066):11.60007511):1.404276839):4.194596948):1.313081306):0.7955529674):0.7395179902,(((t71:1.540113594,t72:1.539405298):14.12495812,(((t73:2.46381492,t74:2.459146738):2.144837574,(t75:1.216115258,t76:0.999142851):3.374289739):9.081138238,((((t77:1.222813738,t78:1.061204163):3.851429188,t79:4.81889543):3.952983927,(t80:3.310018624,t81:3.207120065):5.324593864):0.6121459577,(t82:2.657475723,((t83:0.6770215406,t84:0.6126666892):0.6007796661,t85:1.128505369):1.325924406):6.110551052):3.707900399):1.639084567):0.2408191936,((((t86:0.1304673273,t87:0.08910557345):2.964845434,(t88:2.36863701,((t89:1.223635955,t90:0.8502764936):0.8719692938,t91:1.715443329):0.06849691257):0.5652389302):3.174335752,((t92:0.747560757,t93:0.646088049):2.986289484,t94:3.522855008):1.706130839):6.48326509,((t95:0.4608753689,t96:0.2259632598):9.578284234,t97:9.797654592):1.617263648):1.212467968):5.904658418):3.824764901):2.795712782,((((((t98:2.517752593,(t99:0.8045576717,t100:0.7524510682):1.677791838):0.7411537083,((t101:0.9541900023,t102:0.9505258058):1.992704836,(t103:1.751810074,t104:1.749731727):0.871224972):0.1224197042):3.8643957,((t105:1.02412758,(t106:0.7309819038,t107:0.7046759936):0.1900271286):3.834897654,t108:4.699084737):1.690652006):2.009969445,(t109:0.2070072472,t110:0.1011196214):7.848288642):5.447894747,((t111:0.7450748438,t112:0.7119779962):8.826950534,(((t113:0.4144352054,t114:0.3966206483):2.776688132,t115:3.160110368):2.195948964,(t116:2.050367843,t117:1.814337309):3.099769265):4.008636646):3.742086796):1.342845886,((((t118:2.748109205,t119:2.730910821):1.04946904,(t120:3.06199777,t121:2.980663533):0.660308684):1.318533717,t122:4.689392329):2.08559656,(t123:3.180809441,(((t124:0.963201373,t125:0.8609325817):0.1698586995,(t126:0.4545365668,t127:0.3766281794):0.5150681209):1.673451507,((t128:0.8795876203,(t129:0.4259077159,t130:0.3825851322):0.2130035815):1.092567614,(t131:1.537235783,(t132:0.9855352378,t133:0.9497341354):0.4556900995):0.106839196):0.2097428088):0.3352953273):3.464715731):6.797412714):9.059766581):1.889008462):4.530781576,((((t134:4.643813083,(((t135:0.6813719998,t136:0.6677720252):1.150865981,t137:1.780105193):1.899741788,t138:3.656862119):0.7356434365):10.16454533,((((t139:1.232492447,(t140:0.3844938316,t141:0.326105659):0.7519182273):2.483028891,t142:3.472095694):1.014859035,t143:4.37976758):1.501117543,(t144:5.729504385,(t145:1.083568266,t146:1.022252438):4.629018041):0.04507973351):8.284896486):3.806411232,((t147:2.923963091,((t149:0.5277525543,t150:0.4073403187):0.2202676009,t151:0.5175033895):1.9874404):8.011482274,t153:10.16764377):6.849314788):7.943946989,((t154:6.434991308,(t155:6.213227893,((t156:0.1258841897,t157:0.1125460546):0.3911922148,t158:0.3174860083):5.36720325):0.0711716953):10.48842137,((t159:6.577449645,((t160:1.309183554,t161:1.306206064):2.697891215,((t162:1.821425527,t163:1.634798444):0.8220406598,t164:2.365698796):1.333785783):2.415402039):0.08692225896,(t165:1.746701139,(t166:1.265399023,t167:1.192915006):0.3937710928):4.371391167):9.084190972):7.988621138):1.161896766):3.879362046):0.3535960574):5.441391046,(((((((((t168:3.797653624,(t169:2.221129044,t170:1.933245238):1.57312394):3.10964696,t171:6.58605337):2.684978498,t172:9.188796202):2.470079917,((t173:2.309549797,t174:2.251543354):7.937160064,(t175:8.384378328,(((t176:0.6896522234,t177:0.3352538093):2.926421222,(t178:2.12749197,t179:2.122661252):0.9908866122):2.088018054,t180:5.191734958):2.634298785):1.563141215):1.358347855):0.3558793671,(((t181:2.022706741,t182:1.940535395):4.132155506,t183:6.067689033):0.3764783464,(t184:6.322899621,((t185:2.417581077,t186:2.195895346):1.027401118,t187:3.088693062):2.818578151):0.08431266682):4.507971515):1.720663385,((((t188:4.022150824,(t189:2.955058727,t190:2.903091258):0.9863052959):3.574930699,((t191:0.5738174534,t192:0.461546313):0.5535430098,t193:0.8930628207):6.270273292):1.95829089,(((t194:0.3523241357,t195:0.3019563972):6.16723322,(t196:1.1111846,t197:1.108938051):5.279180003):2.408120044,(t198:1.853047713,t199:1.809740438):6.894081038):0.1456640187):0.6393977068,((((t200:1.353545257,(t201:1.059794356,t202:1.056026589):0.2857088057):3.554028753,t203:4.561424754):2.551355063,(t204:3.93082849,t205:3.895216167):3.129415691):0.9447293918,t206:7.890566865):1.041387788):1.995261091):0.9644819646,((((t207:2.557505149,(((t208:0.570374135,t209:0.4913092103):0.4763028042,t210:0.9175913808):1.248280124,(t211:1.414153439,((t212:0.3023669304,t213:0.263523822):0.104672613,t215:0.1224738609):0.9876949019):0.7014921431):0.09383487419):3.464347772,t216:5.343109269):1.143000765,(t217:2.675996921,((t218:0.5367186458,t219:0.4094487845):1.233268008,((t220:0.4569132664,t221:0.314285379):0.332271932,t222:0.640546001):0.849439348):0.905394641):3.748465479):0.5138778136,((((t223:0.7408012476,t224:0.5864523871):1.052192755,t225:1.504982965):2.234388194,t226:3.482474452):0.9485404027,t227:4.202673072):1.641632003):4.146647462):1.812511285,(((t228:1.403503304,(t229:0.511590117,t230:0.4576746937):0.7872288018):6.430783424,(t231:6.659180368,(((t232:3.657803836,(t233:1.410294676,t234:1.409169771):2.228365587):0.4199429913,t235:3.970800112):1.282205694,t236:5.168133801):0.9682610771):0.9842221361):0.8162957309,((t237:0.9180651934,t238:0.8182343708):5.571249264,(t239:4.872903216,t240:4.712549476):1.402548096):1.446470062):3.119876657):9.369281237,(((t241:1.073627853,(t242:0.6197853373,t243:0.5905668122):0.2056423497):12.68303704,((((((t244:2.256481743,(t245:1.142558491,t246:0.6503646559):1.094618555):2.250795209,((t247:1.596732396,(t248:1.019877517,(t249:0.360404329,t250:0.3011726733):0.2871687742):0.5505487399):1.8525149,(t251:0.3044208071,t252:0.2578176681):2.628939209):0.1971846926):2.19073513,t253:5.243326047):2.48217486,((((t254:0.4766774126,t255:0.4477170394):2.529553355,(t256:2.415303937,t258:2.007105453):0.5486633431):2.666340757,(t259:3.861344214,(t260:1.585204084,t261:1.576249132):2.223497092):1.325054631):2.003077074,((t262:3.599432052,(t263:1.019423552,t264:1.012912041):2.456735045):0.8844141169,(t265:1.80828542,t266:1.76361124):2.397005741):2.494475782):0.04578098171):0.9683560178,(t267:5.655850815,(t268:5.399768237,t269:5.272398697):0.2363602058):1.85166002):0.9324248462,((t270:5.8403228,t272:5.726813789):2.183160571,(((((t273:1.881076434,t274:1.727503949):0.2188637022,t275:1.857071981):0.262950068,t276:2.003888631):0.4939662404,t277:2.480124921):2.189274386,(t279:4.157989868,(t280:0.8747380602,t281:0.8721139619):3.267649954):0.0546890121):2.82943328):0.2330055856):2.392306002):2.429087309,((((((((t282:0.1303965238,t283:0.02638676882):0.6481735911,t284:0.6596837051):0.5933467983,(t285:0.8987299194,(t286:0.2972394196,t287:0.2398724468):0.4164269817):0.2510199782):1.609142095,(t288:0.9279988487,t289:0.9164479644):1.56765862):1.55877705,(t290:0.7552991002,t291:0.6334826215):3.125753619):0.6928546078,(t292:1.625871934,t293:1.554946896):2.817068951):4.479119876,t294:8.811023154):1.710804279,((t295:3.212912332,(t296:1.277059312,t297:1.150104534):1.833101722):2.175296715,(t298:3.774399182,((t299:0.2404657131,t300:0.2232382138):1.915757806,t301:2.137203784):1.570754821):1.373510093):4.886643284):0.5296244529):3.824084753):7.438865461):3.627729035,(((((t302:0.4982335107,t303:0.4362710286):3.900093678,t304:4.32529836):1.054941956,(t305:3.360428657,t306:3.344559245):1.987602845):8.538528313,(((t307:1.057562497,t308:0.9424349073):8.681467594,(t309:4.506645791,t310:4.441586079):5.091914877):2.928480997,(((t311:0.76319523,t312:0.7535195815):3.093545189,(t313:1.868208471,t314:1.865883431):1.87258028):8.150597235,(t315:2.682234848,(t316:0.9462107006,t317:0.7994354125):1.684572541):9.096646412):0.4343251155):1.153387812):1.496482437,(t318:11.56397731,(t319:10.16597199,(((t320:1.468310087,t321:1.39121407):1.825598929,t322:3.158663882):3.177649023,((((t323:0.03426168467,t324:0.02591513171):1.218312939,t325:0.8072321231):1.051572623,t326:1.830045661):2.081264772,t327:3.890714562):1.897478605):3.659030332):1.312037184):2.982397276):9.88593191):4.967829026):4.83730603,((((((t328:5.871232091,(t329:0.4936035019,t330:0.4864751245):5.352194078):1.33165736,(((t331:4.714866047,(t332:1.820478558,((t333:0.6830253153,(t334:0.4802670823,(t335:0.04003234022,t336:0.006502296319):0.3977896208):0.1720854332):1.052183559,t337:1.573587013):0.02903049233):2.781163401):0.2363615135,(t339:3.271800989,t340:3.229609658):0.749245958):0.334718223,t341:4.144694505):1.850546085):2.644079597,((t342:2.00164393,t343:1.906839289):2.388862018,(t344:2.127040384,t345:1.980342253):2.16773946):4.225396548):5.220539724,((((t346:6.693745907,((t347:1.69875341,t348:1.529742422):0.09524197594,t349:1.579663909):4.769488823):3.070734488,((t350:6.759895418,(t351:1.496614987,t352:1.222545179):5.022196027):1.103462211,((((t353:0.9929975401,t354:0.8861067779):0.8985562763,t355:1.729361201):0.9887985395,(t356:2.533672324,(t357:2.167640471,(t358:0.7703732171,t359:0.7624353252):1.377586663):0.1858095252):0.05313503634):2.531863782,((t360:1.38970941,t361:1.294125462):1.748923507,(t362:0.5830089462,t363:0.5028148524):2.303202254):1.525015152):1.873382358):1.441685419):1.449973169,(t364:8.650406314,(t365:0.3675607257,(t366:0.1737466029,t367:0.0644671943):0.1829129525):8.195405705):0.4141777445):1.910081049,(t368:9.59820546,((t369:1.963201745,((t370:0.4109749808,t371:0.3222841788):1.295546106,t372:1.609812569):0.2381450463):0.07482582511,t373:1.895139999):7.504251327):1.119892426):0.2610133844):0.347864953,(((((t374:3.355947824,(t375:1.15114622,t376:1.061042943):1.999126526):0.6647988497,(t377:3.136901277,((t378:0.2923061693,t379:0.2367508033):0.389822639,t380:0.6237120357):2.37977472):0.3561253478):3.878088464,t381:7.129457545):0.8319708481,(t382:1.118290446,t384:0.6205138882):6.603711757):1.532141389,((t385:2.471982926,t386:2.420265023):5.321317173,((((t387:2.041787224,t388:1.995033615):1.139045341,(t389:0.4602310729,t390:0.3606835782):2.408658187):1.235405782,t391:3.865455313):2.408445534,t392:6.204692386):0.8287280794):0.9455376458):0.8041509577):16.43734871,((((((((t393:0.3147914653,t394:0.312212831):3.357085405,t395:3.592966232):0.8372415826,t396:4.37157083):0.5970031766,((t397:0.6340423153,t398:0.6109142225):0.9895011102,t399:1.34028725):3.166959428):1.320709577,(t400:5.72453006,((t401:1.941540786,(t402:1.527394671,t403:1.212705777):0.3409900746):2.866659249,((t404:2.816937127,(t405:0.1431456864,t406:0.08101438533):2.623557014):0.5359295227,t407:3.232816134):0.9664495545):0.7886452013):0.03874974302):0.5071370155,(t408:1.332580524,t409:0.9316479269):4.117896672):1.833134312,(t410:5.608658945,(((t411:0.6909921509,t412:0.5349551691):4.276209406,t413:4.802058845):0.1248029936,(t414:3.158681238,t415:2.929976757):1.756269238):0.1673757471):1.205855468):0.08838464944,(((t416:1.911106786,t417:1.47344448):0.2125129053,(t418:0.7175422977,t419:0.3951622965):0.8894298331):2.16076982,t420:3.195744341):1.754044706):16.34419882):1.397552174):13.4488158):41.91409386,((((t421:7.023808271,(((t422:2.926086156,t423:2.839846634):0.04559676337,t424:2.871496562):1.173671759,t425:3.96910608):2.614105338):11.5403911,((t426:2.68816399,t427:2.547237262):10.26754631,(t428:7.947445503,((t429:0.8869843244,t430:0.8467121677):3.600493493,((((t431:0.3466544507,t432:0.3415997086):2.585761875,t433:2.861301332):0.1990083967,t434:2.901640823):0.8275522437,t435:3.676164155):0.4869562632):3.4162578):4.711932122):4.973945918):1.11144684,(t436:9.855036285,((t437:1.142686937,t438:0.955880485):1.529663216,((t439:0.5866031236,t440:0.5385205065):1.569415668,t441:2.092133221):0.008470636581):7.176501032):8.313034587):17.67096122,((t442:4.281850081,(t443:2.400026839,t444:2.362476666):1.812894094):26.18170985,(t445:9.294564589,t446:9.273135076):21.00523842):4.757100038):40.70271347):11.00949011,((((t447:0.08883567004,t448:0.06446377457):2.163573621,t449:2.189366242):4.656648289,(t450:5.792095767,t451:5.759105772):0.759180139):0.8901347931,(t452:5.992048849,((((t453:0.3681594249,t454:0.3276665638):1.633160071,((t455:0.7204066227,t456:0.6944802418):0.4320558355,t457:0.9654432804):0.7991909966):0.3506384011,t458:2.090242006):3.028319569,(t459:3.351637382,(t460:0.168626775,t461:0.1436515706):3.145749726):1.697870291):0.5301310192):1.408762189):78.92366513):0.7037259863);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T93.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
