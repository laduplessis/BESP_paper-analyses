<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t505:16.72720281,(t506:5.660578199,((t507:1.694858459,(t508:0.8905090713,t509:0.8865113081):0.804228508):1.999453222,(t482:0.01236936183,((t339:0.2137314612,(t333:0.07608865481,(t307:0.236833038,((((t202:0.2935786554,(((((t104:0.1426749894,(t1:9.158868474,(t2:8.110937229,(t3:7.5829196,(t4:3.250095446,t5:3.225753251):4.315993799):0.4123364327):0.8900384417):0.9006758906):1.693174217,(((t6:2.250685623,t7:2.243156891):5.164014075,(t8:5.648706279,t9:5.591299386):1.677427916):1.568402503,t10:8.817704935):2.237374914):4.228640214,((((t11:3.64345339,(t12:2.158800354,t13:2.121143607):1.417478747):2.992055876,(t14:5.798570928,((t15:3.64162671,t16:3.604981518):2.12331055,(t17:4.19809033,t18:4.116965056):1.167751323):0.01202308262):0.6741945086):4.403669473,(((t19:3.767954025,(t20:0.9779435777,t21:0.7736720893):2.788473454):3.610273909,(t22:1.556825876,t23:1.530732718):5.578591754):2.175098751,(t24:8.233414116,(((t25:1.496408145,t26:1.348369333):1.46722338,(t27:1.138555009,t28:0.8654863227):1.647627812):4.820907266,((t29:5.343273006,((t30:0.7874485794,t31:0.7749527465):2.050675753,t32:2.7738214):2.504910066):0.4008689747,(((t33:1.940628153,t34:1.899763156):2.423808886,(t35:2.264905581,t36:2.174778072):1.605563504):1.282977921,t37:5.050177698):0.0290160173):1.471259659):0.4219555749):0.7853978833):0.3330559543):3.207016965,(t38:2.703384172,(t39:1.258487111,t40:1.205540039):1.010078796):8.384101588):1.0332315):0.6254508147,(t41:7.327987273,t42:7.30818443):4.732308911):1.376326923,(((((t43:4.803385892,t44:4.687399328):4.200321072,(((t45:5.99783604,((t46:4.318191989,t47:4.266216734):1.098436164,(t48:2.560774937,(t49:1.602172027,t50:1.586098426):0.7528108706):2.60689867):0.5761866628):1.948886601,t51:7.459814314):0.3044762818,(t52:3.277271923,((t53:1.440832491,t54:1.436966864):1.325383955,(t55:2.413036228,(t56:2.122704881,((t57:0.4207571267,t58:0.2033783544):1.221575266,t59:1.197777927):0.4617148992):0.2576594644):0.3229830326):0.308592364):4.338111167):0.591250245):0.7454257474,t60:8.130059153):0.3484089653,((t61:3.418022161,(t62:2.191026307,t63:2.121361587):1.194803455):2.785744344,t64:6.004549152):2.262621733):1.349682358,(((t65:1.104100397,(t66:0.9314888535,(t67:0.5541548692,t68:0.4215802737):0.3335622125):0.06664589285):5.664912624,(t69:5.075436362,(t70:2.183224952,t71:2.127033777):2.859966247):1.328883248):2.484400127,(t72:1.480795438,t73:1.421767169):7.241399966):0.273172269):1.770356506):0.4019846666):0.2916540274,((((t74:0.2772044154,t75:0.2695687484):6.882446237,t76:7.120243239):2.638361743,((((t77:1.169041323,t78:1.145774483):0.8857590228,(t79:0.6267478834,t80:0.6191781442):1.314384251):0.4515544108,t81:2.107131488):1.273794977,((t82:1.485357306,(t83:0.335592783,t84:0.3021618746):1.093514865):0.2293169115,((t85:0.9682803584,t86:0.898097743):0.3547964183,t87:1.233470975):0.2537690669):1.595374105):5.908570002):0.7593320276,((t88:1.894331807,t89:1.866071957):5.79573567,(t90:6.233090169,t91:6.231487819):1.167969506):1.974533964):0.8019511775):0.06870699578,((((((t92:0.9925129116,t93:0.9436995388):0.05937151538,t94:0.7846482101):2.742894622,t95:3.479957084):1.008033117,t96:4.336722846):0.8584154773,(t97:2.067896896,t98:2.061256513):3.02808147):2.950104355,(t99:2.963862443,t100:2.901436894):4.961401622):1.598520346):6.759988491,(((((t101:1.53904439,t102:1.535292598):6.356373589,(t103:4.941482536,((t105:1.127654641,(t106:0.2864917418,t107:0.2641387101):0.8285646493):0.6491342305,t108:1.688906285):2.948001634):2.573725211):0.190023287,(t109:4.411351923,(((t110:0.4339169712,t111:0.4141539615):0.8135265676,t112:1.079433795):1.847711596,(t113:2.132469998,t114:2.024217):0.7429880201):1.273032043):2.836373196):2.3321232,((((t115:3.883356829,t116:3.877168951):2.028502665,(t117:0.1809863114,t118:0.1726768185):5.632857186):1.707277025,(t119:6.352861086,((t120:1.087299386,t121:1.063322698):2.205937334,(t122:0.5189955575,t123:0.4598332769):2.296582658):3.028307824):1.051393361):1.476179,(t124:1.723596734,t125:1.717812367):6.336035293):0.06574429099):5.600889573,((t126:8.177777573,((t127:2.609804985,(t128:2.423167413,t129:2.410327565):0.1139423792):1.141634111,((t130:0.7396113736,t131:0.3499102079):1.223664513,t132:1.528926414):1.650558292):4.195457046):0.6617268309,(t133:5.018359792,((t134:1.725255235,t135:1.34074613):2.125617275,t136:3.310078447):1.020545878):2.855031507):4.829667899):0.01290661353):4.203125734):3.251040584):0.789570943):3.374330102,(((((((t137:4.284256597,t138:4.252944579):4.534164443,t139:8.779813028):0.4751022491,(((t140:1.650542321,t141:1.638606073):2.145955714,(t142:0.2120712468,t143:0.05839035458):3.425698635):0.2044842961,t144:3.667377666):5.241945504):1.033148307,((t145:1.647542338,t146:1.566406529):6.007969786,((((t147:3.25250733,(t148:3.123971254,((t149:1.329481864,t150:1.212973628):0.0497701909,t151:1.22434787):1.625863945):0.09815875074):0.01018027927,((t152:0.7095600913,t153:0.6915819069):0.8928765996,(t154:0.6057400759,t155:0.4877436296):0.8559520355):1.296192736):2.13170259,(t156:4.433894032,t157:4.386712927):0.2769400697):0.4224686635,(t158:1.96393882,(t159:0.7725496432,t160:0.6952396734):1.040798999):3.005873113):1.684415113):2.286190231):0.2326323557,(((((t161:2.581253332,(t162:0.6831570964,t163:0.6514645962):1.876971988):1.158616242,((t164:1.664660118,t165:1.590149758):1.727482201,(t166:2.679833136,t167:2.653516587):0.6257754939):0.2260671066):3.399954022,((t168:0.2375928029,t169:0.2126984592):5.328631271,(t170:2.71246585,t171:2.687090712):2.817327962):1.173324233):0.9513485485,((((t172:3.678131351,t173:3.48780439):1.327001193,(t174:0.6922708157,t175:0.5463141658):4.013670587):0.01896508825,t176:4.375738437):1.516817962,(t177:0.477306941,t178:0.4551189671):5.343585501):1.052621008):0.02352599748,((((t179:2.523071267,(t180:1.148089353,t181:1.111881617):1.32192147):0.2234627209,t182:2.528975107):0.1564440097,((t183:1.250839254,t184:1.249246698):0.2377614353,t185:1.476790378):1.124972035):0.9982242462,t186:3.562915524):2.956251469):0.8114617614):2.285562875,t187:9.526318826):8.280197434,((t188:5.736323816,(t189:4.350464581,(t190:2.329080099,(t191:0.76228314,(t192:0.1901178415,t193:0.1582275176):0.5504446778):1.527583348):1.903484996):1.367954609):6.348764298,((t194:2.021018018,t195:1.920492418):1.070266623,t196:2.950053532):8.443180119):5.70124697):2.509915655):9.039996672):5.439817842):1.890599393):10.94292328):20.9910519,(((((((((t197:5.068269275,(t198:3.704522371,((((t199:0.6703226791,(t200:0.3533387526,t201:0.219597581):0.3143549077):1.119693381,t203:1.122105527):0.5110442061,(t204:0.6478579468,t205:0.5359534765):0.906965436):1.03545774,t206:2.374841113):0.1778644343):1.350943389):3.993204925,((((t207:1.029555104,t208:0.9302365259):0.9277056096,t209:1.793524571):3.837870335,t210:5.330727346):0.8692667394,((t211:1.472900712,(t212:0.555347163,t213:0.430047537):0.8777169383):0.7362768889,t214:2.025812874):3.972924748):1.152641604):0.5004916413,t215:7.639739229):6.589080389,((t216:14.11586715,((((t217:0.2242955453,t218:0.1268333135):4.760795862,(t219:2.070753818,t220:2.060471684):2.804678863):3.322218603,t221:8.146346377):5.606482549,((t222:2.950226734,t223:2.847938102):5.866244386,((t224:0.8472387081,t225:0.7980261648):3.144420907,t226:3.926107186):4.611750789):4.900284601):0.08876870079):0.01170614466,((((t227:1.148284967,t228:0.5064587827):3.079204658,t229:3.541004939):0.1586863021,(t230:2.015171657,t231:1.996559149):1.570219098):1.583111582,((t232:3.425761685,t233:3.264887799):1.369716188,((t234:0.8722770661,t235:0.8156873737):2.80577211,t236:3.490638984):0.9481553753):0.3482715806):7.556043369):0.0547019753):4.893656136,(((((t237:1.551117812,t238:1.495972488):4.335833421,(t239:2.94653531,(t240:1.411772836,t241:1.314208778):1.224226488):2.794811765):1.775225373,(t242:2.382811676,((t243:1.07779651,t244:0.9496886257):0.6211833811,t245:1.371937042):0.3577452927):4.712712069):4.778224379,t246:11.05024861):0.6840613186,t247:11.73377793):4.123949557):3.521200196,(((((((t248:3.889651494,(t249:1.957391091,t250:1.884839511):1.718279285):0.1918111114,t251:3.503731608):0.8394360604,t252:4.247637977):1.922118804,(t253:1.607419544,t254:1.49734498):4.536288538):5.537848088,(((t255:4.904028393,t256:4.746842533):3.154483278,((t257:1.592197298,(t258:0.6355107192,t259:0.4968771663):0.9532302856):1.963093352,(t260:0.3681926227,t261:0.3645631427):2.979060044):4.198557697):0.3263183057,((t262:3.382211922,t263:3.220244643):0.3037285796,t264:3.514681738):4.090002537):2.642222196):6.691876171,t265:16.88219531):0.168952833,(((t266:1.273498265,t267:1.205289161):3.122471961,(((t268:1.548426617,t269:1.545610961):1.152696203,t270:2.442782256):0.1191099514,t271:2.455159769):1.32106982):10.66891307,((t272:4.378086155,(t273:2.183135508,(t274:1.598754822,t275:1.545277186):0.437963589):2.062494845):7.87160445,(((t276:0.8380062382,t277:0.5759297835):1.12260535,t278:1.452346871):3.562585449,t279:4.982171296):6.330423422):2.114571359):1.981569296):0.1177182027):7.202574285,(((((t280:2.555169922,t281:2.406405461):0.3837877799,t282:2.743110677):2.809560098,t283:5.514815679):6.21060561,(((((t284:3.355145323,t285:3.157078075):0.5508456476,t286:3.627716333):0.4719204851,t287:4.030200979):6.239330961,(t288:0.4520616682,t289:0.2503502045):9.708573284):0.5438629322,t290:10.49192499):0.3252469378):0.08194159597,t291:10.78777537):10.56648791):7.650827715,(((((((((t292:1.073369259,t293:1.049973933):3.402730251,(t294:0.5946100333,t295:0.4102545425):3.807318347):7.653163373,((t296:7.830088629,(t297:6.327376948,t298:6.287966135):1.243550603):1.907474893,t299:9.40321991):2.01000264):3.306933818,(t300:1.031740634,t301:0.9557194721):13.68298258):1.510413705,(((((t302:1.161625035,t303:1.134489198):5.263297368,(t304:1.774244282,(t305:0.9481903468,t306:0.8981602089):0.5064469922):4.609556587):1.48996829,(((((t308:0.5504093366,t309:0.3374488503):0.3943381298,((t310:0.2449368243,t311:0.09007496577):0.2725267321,t312:0.2467778497):0.2095137954):2.951464868,(t313:1.439241919,t314:1.286710321):1.858057254):2.417050225,t315:5.484909647):0.5693698444,(((t316:0.3451202804,t317:0.2690898253):0.4300931421,t318:0.5234716746):1.089409031,t319:1.339919929):4.017734853):0.2471156186):0.7879552422,(t320:1.968710706,t321:1.789270147):4.306302376):7.224456565,(((t322:0.3173854145,t323:0.3017968646):5.028118249,(t324:2.587398437,(t325:0.7871396584,t326:0.558113874):1.501449846):2.589953439):3.482108383,(((t327:2.470744448,(t328:1.844247146,(t329:0.1628338391,t330:0.1356119485):1.644958785):0.5780402438):0.4856271068,(t331:2.806815995,t332:2.764830885):0.01530766107):0.5764033624,(t334:2.912203221,t335:2.71851788):0.1942673854):4.484962755):4.29901159):0.1048596554):2.673168358,(((((((t336:3.373760679,(t337:2.790070784,t338:2.782948896):0.5695293017):1.233462286,(t340:0.08548104741,t341:0.07593344083):4.149527263):1.321301277,(t342:1.502197432,(t343:1.034239577,t344:0.9813808025):0.3491950504):3.793708642):2.346421819,(t345:5.120899348,((t346:3.163216046,(t347:1.337478286,t348:1.079839834):1.79832178):1.850497186,((t349:1.04446816,t350:0.8975094821):2.543111384,(t351:1.486897087,t352:1.406664722):1.857027093):1.132235662):0.03207997107):2.211032278):3.470136114,(((t353:1.029733729,t354:1.026424444):1.36753333,t355:2.3096311):0.7573870204,(t356:0.4100546732,t357:0.3310784364):2.614852303):6.772038055):0.5133597917,((((t358:3.131133748,(t359:2.74134342,t360:2.548392931):0.3129420803):2.210909401,t361:4.931236043):4.293366679,t362:9.118897646):0.2596547245,(((((t363:0.07808568566,t364:0.06115597864):3.435652852,(t365:2.316714292,(t366:1.080270728,t367:1.013535651):1.157293505):1.066677266):1.290635528,t368:4.510905906):2.16127869,(t369:2.377184988,t370:2.364448532):4.216084346):2.137868208,(((t371:5.602127587,t372:5.506009227):1.336193159,(((t373:0.9703656691,t374:0.9158250429):0.8705962776,(t375:1.365096466,(t376:0.375870763,t377:0.3372693259):0.6925754823):0.2176895019):1.908451113,t378:3.140581086):3.080598048):0.6765844963,((((t379:0.7437700597,t380:0.6666311809):1.430812531,t381:1.936974006):0.5749073566,(t382:1.436528409,t383:1.414221202):0.7458341175):1.995649057,(t384:1.804964979,t385:1.773021019):2.311440899):1.942711066):0.8990029005):0.2437092354):0.3291757158):1.330563574,(t386:3.289454713,((t387:1.076769184,(t388:0.05238311431,t389:0.02490470205):0.946431231):0.3910900564,t390:1.342089348):1.817435634):5.533840734):0.592364617):0.7439826231,(t391:8.46634495,((((t392:1.297773159,t393:1.134997111):2.199686877,(t394:0.7063134721,t395:0.6951709873):2.591188295):1.9448125,((t396:1.682026702,(t397:0.4082690863,t398:0.3889075824):1.254918576):0.9910712379,t399:2.610999686):2.556838159):1.931480406,t400:7.040787204):0.9833265233):1.493826926):1.541439386,((t401:0.5096918634,t402:0.343998225):0.5890008523,t403:0.9013133027):9.942622302):5.684713524,(t404:9.502455651,(t405:6.327337278,((t406:2.340179469,t407:2.339215019):0.4261804083,((t408:0.9439697223,t409:0.9312507668):1.253484582,t410:2.114553031):0.4595784877):3.52284593):3.099537095):6.894337127):1.399015027):1.216628437,t411:18.6954055):27.16592255):175.587544,((((((((((t412:3.264728786,t413:3.055587855):2.001049619,(t414:2.138771058,t415:2.073824971):2.850480015):0.8314363264,(((t416:1.710028376,t417:1.702605224):0.4894470154,t418:2.127747045):0.7683387494,(t419:0.3797748838,t420:0.3711825976):2.446788121):2.627499085):2.051676473,(((t421:2.500770547,(t422:2.476791943,(((t423:1.358737943,t424:1.291217993):0.3378906199,(t425:0.903481672,t426:0.8858826463):0.6864288228):0.5608095441,(t427:1.585424649,t428:1.560773354):0.4162737818):0.1987139404):0.01722869823):4.056919289,((t429:0.3069205679,t430:0.2012822497):2.48376205,((t431:1.953234254,t432:1.888887135):0.2018726534,t433:2.081135999):0.5154918567):2.981431771):0.6341249852,t434:6.191387851):0.2311435062):0.006199671817,(t435:1.155443419,t436:1.058320925):4.9961694):2.278454377,(t437:2.884711146,t438:2.790507656):5.410075393):3.319042367,((((t439:2.558272034,t440:2.528041305):4.201385793,((t441:3.003655176,t442:2.998648342):1.25429129,(((t443:1.122442834,t444:1.003932104):1.554853023,t445:2.168002697):0.6128129964,t446:2.692730544):0.9223387495):2.44695076):0.5516510462,((t447:5.153839124,(t448:0.6176429631,t449:0.549913747):4.521229715):0.723580934,(t450:0.4592603899,t451:0.4393828491):5.21217527):0.3502687812):1.073624445,((t452:0.7308551864,t453:0.6518839462):0.7973749953,t454:1.372746325):4.975369087):3.056072518):14.22274347,(((t455:1.529791744,t456:1.39475538):1.963550339,(t457:2.364579196,t458:2.21658899):0.907084705):3.095759316,((t459:1.956836555,t460:1.943593215):0.05562796345,t461:1.901179045):4.205355508):16.99076586):16.71290676,((((t462:4.254915066,t463:4.178830116):2.22061256,t464:6.254784358):14.98859606,((t465:4.987539277,t466:4.921556734):2.345240104,t467:7.143290279):13.86751161):17.30199393,(((t468:5.83076929,(t469:0.4503943026,t470:0.3778232606):5.348242404):9.101005562,(t471:3.576942406,(t472:1.25997293,t473:1.135310912):2.284826211):11.1408393):19.00250701,t474:33.52566737):4.366552481):0.9164255968):58.86275499,((((t475:3.054379844,t476:3.054036861):5.791886826,t477:8.636780204):8.594966406,((t478:3.739442115,(t479:2.319051419,(t480:2.023315338,t481:1.820763656):0.1930327033):1.380375493):0.415852363,((t483:2.298635668,(t484:0.4190414704,(t485:0.370592976,t486:0.2740431256):0.04462312469):1.872134893):0.1462570127,t487:2.115196937):1.249041383):13.05381692):25.36200127,((t488:26.79679202,((t489:15.35230443,((t490:2.037372889,t491:1.925369757):5.180791543,(t492:1.839257401,t493:1.76568838):5.257175022):8.075098101):2.459419533,(t494:5.77948813,((t495:0.2767867731,t496:0.2127725296):3.97109246,t497:4.057444821):1.521232997):11.76637998):8.906178435):3.60888182,(((t498:0.1177691337,t499:0.002569564972):1.103523365,t500:1.095075791):6.394663198,((t501:0.459487573,t502:0.4256232015):1.798697192,(t503:0.3963748802,t504:0.3291371073):1.750915884):5.222364644):22.16956856):11.27034088):54.81019638):117.8508705);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T8.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
