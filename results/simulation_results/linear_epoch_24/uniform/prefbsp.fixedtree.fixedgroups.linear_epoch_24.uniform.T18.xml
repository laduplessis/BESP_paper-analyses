<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t449:0.8809539961,t450:0.8378077775):2.83435475,t451:3.472361301):4.570095672,((t452:0.8372780235,t453:0.7157798294):1.666511564,t454:2.38191451):5.531319599):13.11280732,((t455:6.938389603,t456:6.908819985):6.525388767,(t457:0.7125587361,t458:0.6301672487):12.66890911):7.559259571):5.989449008,((((t459:0.6164749127,t460:0.5629422648):1.303503027,(t461:1.153413571,t462:1.135815945):0.605312955):0.7018996037,(t463:0.9968853449,t464:0.9500059444):1.150398709):6.007160815,(t465:3.219843285,t466:3.134922365):4.850296732):18.20145549):2.754573741,(((t467:7.325469429,((((t468:0.04394172055,t469:0.03138076624):1.297713617,(t470:0.3238992156,t471:0.2598268027):0.8818954466):1.833913916,t472:2.973397529):0.1790386598,(t473:0.8617030174,t474:0.7229743624):2.289671981):3.773498936):1.310294824,((t475:5.297417791,t476:5.059796854):0.7311475206,((t477:1.869142095,(t478:0.6254900481,t479:0.5607775498):1.233002616):2.307915267,t480:4.001998783):1.564523189):1.971145114):6.204909705,(t481:2.421996206,(t482:2.083997748,t483:2.075497484):0.2990138451):11.187039):14.01333965):408.0425999,(((((t484:2.219729059,t485:1.9795388):4.879656463,(((t486:1.501897875,t487:1.498383341):0.4113167431,((t432:0.0496554222,(((t350:0.07570851332,((t337:0.4853152153,(((t293:0.01426126631,(t280:0.01006465433,((t273:0.4144839938,t274:0.07435328517):0.0009003649264,(((((((((((t96:0.08802688638,(t93:0.03199805972,(t1:7.951006694,(t2:4.423519228,t3:4.396797466):3.52110262):1.853610169):0.3037015638):2.993078719,((((((t4:5.004508281,(t5:4.549151222,(t6:3.53573266,t7:3.441062879):0.9552855341):0.3530094398):1.471820036,t8:6.128575414):2.89543106,t9:8.087099464):1.627455258,t10:9.619272031):0.6888240923,(t11:7.044652905,(t12:6.821933968,(t13:1.861454041,t14:1.850751904):4.823213943):0.1353446446):3.20739952):1.078527622,((t15:2.992055108,(t16:1.503555806,t17:1.427292265):1.317656507):0.3694778644,(t18:0.5367387891,t19:0.5100609599):2.575268368):7.648837119):0.06441158586):0.7277394519,((((t20:3.338296646,t21:3.263560733):1.971087345,((t22:3.69240664,(t23:3.488642363,(t24:3.135336416,(t25:0.3487481425,t26:0.07687514285):2.551997079):0.3208237516):0.157044371):0.5984873034,t27:3.5505471):0.8712509859):3.232568436,(t28:5.459147979,t29:5.45705034):2.108287388):2.514494641,(((t30:5.724886274,(t31:3.889092427,(t32:3.308930575,(t33:2.664120775,t34:2.534872077):0.61896247):0.5245280446):1.826970383):2.101729213,(t35:5.619113788,t36:5.447008331):1.934007231):1.345568947,t37:8.725190266):0.8283389313):0.3988090284):0.5409438178,(t38:8.919544253,((t39:6.536514478,(t40:3.125665088,((t41:0.1267562481,t42:0.09216530303):0.9368060231,t43:0.794397194):1.976110469):3.347140664):0.5707804024,(((t44:2.366008988,t45:2.219607719):2.584054281,(t46:3.105298383,t47:3.017061601):1.685157195):0.3822859612,(((t48:1.180389794,t49:1.113842665):2.281375493,t50:3.275361344):1.2080512,t51:4.463626676):0.3820168846):0.9870258903):1.575183385):1.041285395):1.316995501,((t52:2.211284225,t53:2.135171745):6.857393644,t54:8.949734411):0.5934938376):0.1955794148,((t55:4.327252613,(t56:3.313924276,(t57:3.162351224,(((t58:1.939812658,t59:1.406549511):0.1651208187,t60:1.477577328):0.6595128934,t61:2.137073428):0.3726977058):0.005547464874):0.8824113229):4.007082145,((((t62:1.296348595,((t63:0.6741698895,t64:0.6533173075):0.06840539255,(t65:0.2050090341,t66:0.2049914074):0.4137307118):0.4859131671):1.493525606,t67:2.427119015):0.8427930548,t68:3.264661066):3.139972048,t69:6.359739866):0.5862499505):1.243137223):2.463529497,(t70:0.6215278334,t71:0.4747001589):10.00121067):3.617289523,((t72:3.674958063,t73:3.669611):6.954774761,((t74:2.079651954,t75:2.047881612):7.654770323,((t76:2.486480169,t77:2.442136016):6.315576763,(((t78:4.645084279,(t79:3.188539431,t80:3.162082034):1.307711905):1.701373114,(t81:4.439712886,(t82:3.593603516,(((t83:0.3104266252,t84:0.06199741159):0.7781457219,t85:0.8256541924):0.9403543105,t86:1.598682857):1.53717982):0.6702847288):1.710670251):0.1863952092,(t87:4.366255229,t88:4.33839016):1.332909095):2.221990849):0.7768994679):0.6692282757):3.343527631):0.354195192,((t89:5.455555848,(((t90:2.302147403,(t91:0.3948908171,t92:0.3025460986):1.902748981):1.409206237,(t94:1.745079195,t95:1.691090174):1.649095985):0.3851919682,(t97:0.4073014236,t98:0.36379132):3.143562253):1.227120508):4.387853797,(t99:6.806289957,(t100:3.525792843,(t101:0.1262091629,t102:0.116286746):3.159476671):3.242752306):2.197620344):2.997845356):3.030034999,((((((t103:0.2973275566,t104:0.273004251):4.90808594,t105:5.124903538):1.359285781,(t106:3.311093179,t107:3.265465863):3.076758718):3.32059165,((((t108:2.759282411,t109:2.544685117):1.825004352,t110:4.115227274):2.215007595,(t111:3.024597151,(t112:1.846114949,t113:1.822271447):1.149380887):3.300877699):2.012498886,t114:8.181188185):0.5033868802):0.2307239532,((t115:3.566921583,(t116:1.918671555,t117:1.833018774):1.568151731):2.69720553,((t118:0.101725325,t119:0.04828875374):4.903907909,(t120:2.265867906,t121:2.171244046):2.668615852):0.9512633085):2.458374219):1.852767239,(((t122:1.395761802,t123:1.207748086):5.973515488,(t124:6.19406288,(t125:2.66437937,((t126:0.7592331416,(t127:0.7575481811,t128:0.7500903078):0.0001201908808):1.393049363,t129:1.965640043):0.4211484588):3.417141944):0.9549188227):2.347579649,(((((t130:0.495860873,t131:0.4941291839):1.617785063,t132:2.027314472):1.688750453,(((t133:1.506761883,t134:1.480767758):1.476670053,t135:2.932962007):0.2346480162,((t136:0.5103134147,t137:0.4858823057):0.2430185808,t138:0.4311862913):2.382337038):0.3978263759):0.2499332073,t139:3.441414986):0.2914813771,t140:3.634493375):4.751547928):0.08006290693):2.717191333):0.1986891688,t141:11.30452912):0.8843352403):0.670364159):1.011574478):4.084769808,(((((t142:1.172454322,t143:1.124144255):0.06120406101,t144:1.146480838):1.473970778,t145:2.525046312):0.8160068743,t146:3.26541123):12.88243647,((((t147:7.877087393,t148:7.746415964):0.1787530183,(t149:0.7224709773,t150:0.7064426434):7.139880989):1.345670849,(((t151:1.838178437,t152:1.773286666):0.9646046121,t153:2.603410677):5.767216461,(t154:5.594275941,t155:5.46585432):2.677564281):0.6095585577):5.027528203,((((t156:4.754887005,(((t157:0.5155404915,t158:0.3919682663):1.971916728,t159:2.343577059):0.9111866169,t160:3.226095821):1.275865731):3.099663115,(t161:3.015680642,t162:3.002876761):4.513548245):1.623204987,(((t163:1.856736567,t164:1.712144966):2.689282525,(t165:3.812349777,t166:3.798775575):0.4526876458):3.832989927,(((((t167:0.4037462875,(t168:0.1863980427,t169:0.1151455183):0.1222722771):0.5305333488,t170:0.6584462759):2.013434991,t171:2.417714718):3.498887808,((t172:0.2855489409,t173:0.2222784633):0.7322372548,t174:0.9180213024):4.885323931):1.011635767,t175:6.782678205):0.5011851089):0.6941193197):3.736152901,(((t176:1.623939153,t177:1.564680789):5.924357228,(t178:0.08461181572,t179:0.0230771609):7.377023352):1.645665509,(((t180:4.377033941,(t181:3.53763143,((t182:1.054624019,t183:0.9755136783):0.1944471928,t184:1.139099913):2.257776168):0.7720116874):0.09787439855,(t185:0.3137589303,t186:0.2218122613):3.67873787):3.880175112,(t187:4.941423053,((t188:0.4828524596,t189:0.3765562658):2.122598493,t190:2.497969911):2.315334328):2.832862188):0.5511053705):2.265737973):0.5242092623):1.501897774):1.535923745):0.7771341544,((((t191:3.357115246,(t192:2.184560538,t193:2.150737789):1.094687424):1.721774882,((t194:1.809463118,t195:1.787587345):0.5999903972,t196:2.269692214):2.171197743):5.445658062,(((t197:6.360525982,((t198:3.019384212,t199:3.000700926):2.071862686,t200:4.567376633):1.226497784):1.425505883,(t201:4.234582034,t202:3.996341329):2.945073057):1.761544784,((t203:2.509312247,(t204:1.541489195,t205:1.199768836):0.8180146391):1.945089175,(t206:0.1454206393,t207:0.09756129236):3.6465133):4.142176079):0.1371622808):2.942476517,(((t208:2.764411901,t209:2.741439751):3.355216583,t210:6.051556178):4.012696281,(t211:6.855586028,(t212:2.364466529,(t213:0.2840799977,t214:0.2343436939):2.04623794):4.448167579):3.133034307):0.8050739274):1.304350477):0.4728983058):0.5130726639,(((t215:7.243981493,t216:7.178287092):1.561732792,((t217:3.306722888,t218:3.235571254):5.238984574,((((t219:1.705510201,t220:1.612639761):2.468053423,t221:3.952417928):2.604925406,(((((t222:0.1867836986,t223:0.1032670272):1.104796827,t224:1.001082395):1.605175515,(t225:0.909810195,(t226:0.7672623046,t227:0.7357707503):0.1422787134):1.624710103):0.3872110014,(t228:2.041370072,(t229:0.5559681357,t230:0.5051254306):1.451789275):0.7077669097):1.285224186,t231:3.869416229):1.870418988):0.3428717646,(((t232:1.522551321,t233:1.501239562):0.09240406905,(t234:0.7424506434,t235:0.5610135692):0.8234916894):3.146843563,t236:4.497586889):1.262222357):1.09038004):0.08007125886):3.724299498,(((t237:5.907747364,(((((t238:1.04422569,t239:0.9571301119):0.4118974947,t240:1.342503078):0.852562611,t241:2.068677447):0.5073870738,t242:2.549581039):0.9533370502,t243:3.455017013):2.083043898):2.35758747,((t244:2.006599483,(t245:1.768477357,t246:1.754249937):0.05591123923):0.6315227687,(t247:0.8265751824,t248:0.4437638899):1.532203499):5.165041185):0.9610068883,(((t249:2.181203139,(t250:0.02978404354,t251:0.02278057647):2.125442158):2.54117973,(t252:0.6124223445,t253:0.6006528663):4.047978903):0.9867020539,((t254:2.82140383,(t255:2.055817964,(t256:1.36676751,t257:1.346028803):0.6832609228):0.6959350217):1.210633671,t258:3.886181984):1.592295044):2.359386031):1.419283753):0.3578197771):1.282020039):2.755006702,(((((t259:0.5765996081,t260:0.4400122696):1.666468801,t261:2.01022563):0.1445439336,t262:1.78360559):2.717130185,(t263:1.975550791,t264:1.84615403):2.4862807):3.264897989,(t265:2.958249533,t266:2.924454036):4.487643341):5.129260944):2.55289244,t267:15.05144302):1.747002738):1.679661337,(t268:2.873043541,(t269:2.740998305,t270:2.535523955):0.05728845871):15.54626732):5.46888879):2.256371731,(((((((t271:0.6406386731,t272:0.6340209734):8.895961917,((t275:0.2194096705,t276:0.1714713068):6.298220407,((((t277:2.833640295,((t278:0.71587288,t279:0.5718153538):0.7119412481,t281:0.6935992005):1.33442715):0.2622198231,(t282:2.218400565,t283:2.167757291):0.06647456041):0.9598821786,(t284:2.308798853,t285:2.183222803):0.8586816199):0.1000138659,t286:3.080506057):2.265907673):2.465836935):2.04633555,(((t287:5.556750015,((t288:2.723633781,(t289:1.141008247,t290:1.113445431):1.530424954):0.08422964128,t291:2.713606056):2.62920839):0.4016033943,(t292:2.256627456,(t294:1.410336834,t295:1.348357095):0.7121579107):3.466801609):3.167550923,(t296:4.632833579,(t297:2.112519592,t298:1.614205975):2.430868892):4.049391765):0.6615817241):3.588863743,(t299:9.315760042,(t300:6.651279798,((t301:4.593670963,(t302:0.467564091,t303:0.4354643616):4.079689848):1.231168693,t304:5.667600631):0.8258286576):2.580039962):3.002089975):1.512102382,(((t305:3.940380316,((t306:1.195042462,t307:1.082110041):1.29946654,(t308:1.030376185,t309:0.9950271075):1.338758298):1.375360488):1.689218975,(t310:0.4508955108,t311:0.4387310787):4.922638082):6.972455546,(((t312:1.102862489,t313:0.4998845777):6.181434346,((t314:2.082044073,t315:2.013856313):3.439455257,t316:5.441757295):0.9622838386):0.2086465105,t317:6.480398948):4.730511792):0.8378870205):4.778704275,((t318:8.19521127,(((t319:0.3309074015,t320:0.03556687653):2.26906019,(t321:1.888654904,((t322:0.2012226374,t323:0.06367166361):0.4822549596,t324:0.4032009203):1.179396453):0.3548906286):5.03980638,(t325:2.169203518,(t326:1.689084545,(t327:0.7193240302,t328:0.5872948372):0.9568595607):0.3519743524):4.771694068):0.4718392194):0.5859948836,(t329:2.488023373,t330:2.213820956):4.945877673):8.030810614):0.1828354406,((t331:6.236087696,((t332:2.022880635,t333:1.996553402):1.439598241,((t334:0.5263754567,t335:0.4842183459):0.8102172099,t336:1.258601405):1.833606758):2.719299453):0.4477155616,(t338:1.268152041,t339:0.9813862212):4.287485151):8.588872408):4.048416793):2.625467686):3.368019178,(((t340:0.7889083384,t341:0.6896040488):6.145045062,((t342:3.64161364,((t343:2.839981831,t344:2.802852338):0.06787174221,(t345:0.4658579711,t346:0.4593817769):2.18761192):0.2974138348):0.07883485824,(t347:2.179105202,t348:1.959051125):0.7917289826):3.087464676):0.3953044794,(t349:4.478768299,(t351:3.000320691,t352:2.998642777):1.242223861):1.70582238):16.48243593):57.82083424,(((((t353:6.665936933,(t354:5.515017164,(t355:4.598951193,t356:4.595050159):0.7447042891):0.9063636177):7.0714006,((((t357:1.195625744,t358:0.8162349354):1.731456942,(t359:0.1396312117,t360:0.0444631003):2.276136928):2.400743421,t361:4.635383842):5.17179333,(((((((((t362:1.646788407,t363:1.643613626):1.554847366,t364:3.183170018):2.034784916,(t365:3.831981587,(t366:1.78952213,t367:1.781493736):1.846799913):1.249177451):1.327397024,t368:6.175806777):0.08524920148,t369:6.090966662):0.2772090272,((t370:0.02114298936,t371:0.01087617172):1.446014594,t372:1.446863194):4.870795717):0.7208807736,(((t373:3.785171556,t374:3.769448616):0.2333665562,(((t375:2.783981771,(t376:2.436184578,((t377:0.8583685065,t378:0.7587885715):0.9528116937,t379:1.608474972):0.5143306901):0.2981498146):0.9983071428,t380:3.371614237):0.1008809431,(t381:2.783666438,t382:2.607658831):0.5355790512):0.1113076053):1.479420111,(t383:1.148296301,t384:0.8733618479):3.584819416):1.485106294):0.4488143151,((((t385:0.9327946104,t386:0.8898031859):0.3541181819,t387:1.076367722):4.118511214,((t388:2.46549678,t389:2.411291327):2.311601644,t390:4.713734634):0.3724764979):0.1976724275,t391:5.279897696):0.7614121098):0.3422639482,t392:6.269235875):1.318534934):2.786980634):0.1916750027,(t393:3.500142485,t394:3.385612046):7.0046955):33.42206229,(t395:8.208625251,(t396:1.417096437,t397:1.372564605):6.791250403):35.1642143):24.25535983,(((t398:8.097218464,(t399:6.680400133,(t400:6.07289211,(t401:5.562882204,t402:5.555918169):0.5074105911):0.5425400464):1.315694929):1.127748353,((t403:3.362086175,t404:3.326474327):2.922076404,((t405:3.430729871,(t406:0.7336526254,t407:0.5794460696):2.673143388):0.9906500716,t408:4.164800192):1.761850564):2.66195189):0.9642803731,((t409:4.276441303,t410:4.272033813):3.247683926,(((t411:0.9722428263,t412:0.9613609125):2.06974848,(t413:1.043139115,t414:0.932092167):1.968854812):0.9729512403,((t415:3.094908473,(t416:1.915351488,(t417:0.08038463098,t418:0.05099355131):1.712595006):1.103892699):0.05139249346,t419:2.836359982):0.5619361092):3.499534017):1.974689771):57.36305154):8.642998896):1.884029584,(((t420:19.63718951,((t421:4.111269183,(t422:1.588873228,t423:1.556077204):2.313353897):2.363482083,((t424:1.556775577,t425:1.514880689):1.315856743,t426:2.76954369):3.195093048):13.12400886):1.455270349,((((t427:8.246065936,(t428:2.986788748,(t429:1.336770811,t430:1.331150686):1.514217787):5.111694609):3.022278643,t431:10.56309153):0.5670466931,t433:10.69434666):0.893640487,(((t434:4.566424292,t435:4.518140349):4.38805596,t436:8.741581867):0.1260854052,(((((t437:0.5593164139,t438:0.5350647466):2.360035549,t439:2.820483886):0.244597378,((t440:2.595369873,t441:2.59447103):0.1606010398,(t442:0.7697241431,t443:0.1889720916):1.96830409):0.2436909028):0.6993487264,t444:3.024943563):2.447152019,t445:5.444383979):2.10087118):2.404603338):7.647095776):10.17128868,((t446:0.02876031586,t447:0.02507995163):1.534437713,t448:1.456336921):26.08724565):45.45336315):365.2688147);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.uniform.T18.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
