<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((t366:8.654126984,(t367:3.021165513,(t368:0.2081576827,t369:0.08688241374):2.647711402):5.453287213):4.473823837,((t370:2.224728233,t371:2.18533121):7.249452602,(((((t372:0.7667715116,t373:0.6226308881):2.346078043,t374:2.941635434):1.061085079,(((t375:1.077464168,t376:1.065889654):1.610597998,t377:2.629659519):0.3473315631,((t378:0.8261553017,t379:0.5548820943):2.063426027,(t380:1.735453587,t381:1.560884304):0.8583519414):0.05990566476):0.8609071489):0.4244434493,t382:3.653102455):0.4867402652,t383:3.978943188):3.846406937):3.065814648):2.368757932,(t384:1.63413219,(t385:1.193370683,t386:1.032864367):0.3049788318):11.56944807):0.4492162402,((t387:2.023090342,t388:1.999249582):6.240997145,((t389:5.34949239,t390:5.33243415):1.826772869,((((t391:3.753653428,t392:3.225687259):0.3822686644,t393:3.59435273):2.199901574,t394:5.780927709):0.1249139846,t395:5.855980824):0.5819600204):1.034322593):4.952585254):1.888866426,((t396:2.385446228,t397:2.374506015):3.158144827,((t398:1.794212711,(t399:1.527529604,t400:1.520271855):0.2478599735):0.3290983049,(t401:0.9059083679,t402:0.901086599):0.9692253805):3.372601582):8.663879088):5.962849962,((t403:5.836339842,(((t404:1.03162196,t405:0.682690081):2.600376156,t406:3.167309158):1.622936184,t407:4.628954384):0.5275251671):2.358904467,(((t408:0.600558053,t409:0.458688089):3.584092351,t410:4.030067566):0.9897302866,t411:4.998794487):2.266528633):11.61865423):0.857910917,((((t412:0.06827771073,t413:0.03323804555):3.09832123,t414:3.112332175):5.384724001,(t415:4.449949084,((t416:0.6152753598,t417:0.5835297332):1.995686934,((t418:0.633289912,t419:0.5927447381):1.35565124,t420:1.774491985):0.3941385549):1.805434161):3.994150131):5.125346139,((((t421:4.112164777,t422:4.097538516):1.261964351,t423:5.34637742):0.5229003563,t424:5.815740983):3.869279162,t425:9.56970812):3.281294775):5.777007953):36.35618033,((((((t427:0.1577434024,t428:0.1537040143):5.23567922,(((t429:0.3763434075,t430:0.3759779686):0.4415983829,(t431:0.6168118706,t432:0.575335383):0.1480138353):1.986662206,t433:2.508215936):2.459026727):7.492981901,(t434:1.702942061,(t435:1.015778452,t436:0.9786470362):0.6110086796):10.64896778):17.0596103,(((t437:3.043442718,t438:2.74058232):0.4581452834,((t439:0.3633822298,t440:0.2714603169):2.476034293,t441:2.742357636):0.1584589665):25.12954017,((((t442:6.61412171,(t443:3.854723067,(t444:1.179355429,(t445:0.8433858921,t446:0.8122829922):0.1684293693):2.655748777):2.661353756):1.177649608,(t447:5.826608322,(t448:4.992937094,(t449:3.339428863,t450:3.211852737):1.621836744):0.4602855249):1.573360348):0.5301917414,t451:7.278261466):13.25891486,(((t452:1.244327007,t453:1.217309393):0.2349498171,t454:1.202561577):4.836208214,(((t455:2.058390652,(t456:0.8718647841,t457:0.6556445068):1.044052473):0.8977284842,(t458:2.383221775,t459:2.381088873):0.05834907691):1.547106086,(t461:1.555643535,t462:1.436015075):2.306986033):1.46477752):14.0514098):6.340873969):0.6298475408):22.11091658,((((t463:6.690771798,(t464:2.671025144,(t465:2.439388537,t466:2.414163583):0.2075925374):3.991608929):3.958096319,((t467:5.282704307,(t468:1.081267842,t469:0.9270333946):4.114681165):4.659752305,t470:9.656475092):0.6255254984):2.818093014,t471:12.98099588):4.966254443,t472:17.55635337):29.82018114):1.223586853,(((t473:11.64964732,(t474:3.473976018,(t475:3.327165801,t476:3.146933897):0.1084873972):8.137539265):12.66962991,(((t477:1.850854703,(t478:1.333402052,(t479:1.030513452,t480:0.8955251998):0.3002236123):0.244528608):0.2637940223,t481:1.686394088):9.905620108,((t460:0.009254737189,(t426:0.1175501765,((((t229:0.01262035537,(((t142:0.2038430106,(t133:0.08807305593,(((t73:0.04919450738,t1:7.574690733):2.75436352,(t2:5.539875477,(t3:3.47676497,t4:3.475710646):1.675756659):4.671656356):3.638770884,((((t5:3.719939003,t6:3.688778058):2.515851843,(t7:5.919359474,(t8:3.034848734,t9:2.879714766):2.863116776):0.1994594745):2.89178068,(((t10:2.566503429,t11:2.565562687):0.4983014084,t12:2.537494532):2.023264421,(t13:4.160079124,t14:4.14342985):0.28230533):3.718817532):3.754634752,(t15:8.47264523,(t16:2.071846561,t17:1.948223568):6.364875323):3.395623189):0.2178265241):0.3967645987):1.090297361):2.851888125,(((t18:9.527180836,(((t19:3.671431942,t20:3.570873621):1.667666351,(t21:2.0322397,t22:1.980549819):3.027845463):1.736151533,(t23:4.120731604,(t24:3.245948521,(t25:1.751004138,t26:1.715664316):1.412343046):0.8746318041):2.564184846):2.326175871):0.1410737601,((t27:7.784629348,((t28:2.897659083,t29:2.836000897):1.511149783,t30:4.312588548):3.369591789):0.5107907773,(t31:1.110322697,t32:1.012116071):7.077731477):0.7202474689):4.95952397,(((t33:0.2190027654,t34:0.08075109287):2.026493899,(t35:0.1764611142,t36:0.1727156724):1.720454206):3.643608619,(((t37:1.410337408,t38:1.214516488):0.9484682085,(t39:0.1296752838,t40:0.05849836468):1.857006901):2.840054045,t41:4.738076056):0.1657454016):7.876644799):1.606675179):4.112969301,(t42:8.488273865,(((t43:5.093244171,((t44:3.368279608,t45:3.253739918):1.413566195,(t46:4.021378617,t47:3.850571659):0.5182528071):0.2811466657):0.777425345,t48:5.388833409):0.151878574,(t49:2.556103037,(t50:0.6800297986,t51:0.6711999149):1.726035006):2.98021574):2.421563911):9.976738638):0.4474417214):0.06830828346,((((t52:8.289459613,((t53:2.463885473,t54:2.265575933):5.53668055,(t55:2.738532823,t56:2.684253683):4.537758698):0.2598017687):4.06987975,(t57:8.788836624,((t58:4.689340365,(t59:4.412112032,t60:4.340162657):0.2236824404):0.6582473327,(t61:4.056425046,t62:3.792127473):0.8556985407):3.364378329):2.719779054):0.09912310903,((((t63:2.290142738,t64:2.273268408):0.2725414401,t65:2.222128843):1.596734393,((t66:0.07116749622,t67:0.06447309088):0.6779073604,(t68:0.4824512311,t69:0.3764256769):0.09807924357):2.933766428):2.110087335,(t70:1.817272829,t71:1.683247678):3.583941919):4.549884091):3.029211935,(((t72:5.286270369,(t74:1.409959015,t75:1.31693062):3.774774894):4.298902134,((t76:2.021195894,t77:1.913746612):4.232363484,((t78:1.324711293,(t79:0.3915201599,t80:0.341364321):0.8174847211):2.82101626,t81:3.878523245):1.844731501):3.020397297):3.122679356,(((t82:5.369163554,((t83:1.412809368,t84:1.410452527):1.049629206,((t85:0.3108264307,t86:0.3013577328):0.2644587886,t87:0.3695531341):1.653053371):2.749642804):3.703442955,((t88:5.055949225,((t89:3.199518007,t90:3.082695335):0.08679691264,t91:3.149588086):1.761620882):2.694655513,(t92:3.74206785,(t93:0.2357232251,t94:0.08463445274):3.437895114):3.775291176):0.7087191578):0.5887231439,t95:8.475737132):2.138857285):0.134293944):2.59221051):7.575855433,((((((t96:7.178830627,(t97:4.467421646,((t98:1.609207774,t99:1.511419881):1.734476309,t100:3.026136375):1.067629347):2.340337853):2.951484275,((t101:0.3010255321,t102:0.2493057869):6.007030423,(t103:2.197025165,t104:1.923803408):3.761081468):2.990500499):3.338024965,(((((((t105:0.592227081,t106:0.5383039821):0.7641788762,t107:1.247619586):3.85821498,(t108:0.5342887482,t109:0.5114866127):4.398932485):1.467353097,(t110:0.7481017552,t111:0.7032944841):5.537676875):1.046382657,(((t112:0.9548757603,t113:0.9158466957):4.974796707,t114:5.859123316):0.2705034699,((((t115:0.2834289996,t116:0.1754055401):2.969347578,(t117:2.657289769,t118:2.641419961):0.3502748627):1.071136573,(t119:1.930379097,t120:1.649301545):2.022403378):0.6994092602,(t121:3.873135003,(t122:0.708875813,t123:0.59959224):3.136827767):0.4934163695):1.029255439):0.9260708842):2.724733843,((((t124:0.5500971935,t125:0.359318953):4.652551733,(t126:4.547948027,((t127:0.649207712,t128:0.4417425537):3.294710948,t129:3.441766646):0.4574298299):0.439994619):1.006269742,t130:5.23606586):2.009126555,(t131:1.692768218,t132:1.679235277):5.550568359):0.2423797822):1.089749199,(((t134:3.560162632,t135:3.455283812):4.020987676,((t136:0.926616703,t137:0.8230334937):2.843801051,(t138:2.67885569,(t139:1.261373849,((t140:0.8649323279,t141:0.6512857116):0.1253597234,t143:0.452331298):0.1517644962):1.412444033):0.8202056723):3.616147107):0.1947249015,(t144:3.162308104,t145:3.025871333):3.327042634):0.6045544688):0.4384154228):0.5249123329,((t146:4.395959832,t147:4.28116594):2.383907527,(t148:0.491314793,t149:0.4679719424):6.08349955):1.127866153):1.134212584,((((t150:0.9047594493,t151:0.9034685752):0.1114641057,(t152:0.3082867334,(t153:0.1662221215,t154:0.1299387206):0.1136066076):0.6939478704):2.866955505,t155:3.528499162):2.841712641,t156:6.355166177):2.077133249):4.890596273,t157:13.30042598):0.7466341961):4.6773876,((t158:2.951117503,(t159:1.927557182,t160:1.880147335):1.015104104):11.53796412,((((((t161:1.029325177,t162:0.9430787233):1.660397016,t163:2.408835861):3.869791553,t164:6.093910349):1.301909537,((t165:4.902946995,t166:4.813865923):0.5366700102,t167:5.225575464):1.948043509):0.1620408631,(t168:2.030791559,t169:1.957482643):5.27271231):1.989843293,(((t170:1.485429154,((t171:0.1520602186,t172:0.06714464112):0.4392150511,t173:0.4732021541):0.8724763306):2.472601473,t174:3.763832223):4.070032528,((((t175:1.479495975,(t176:0.6033320468,t177:0.5303598888):0.8636435912):0.05581540679,t178:0.9956815098):2.620787543,t179:3.444280536):0.3662592003,(t180:3.727020356,(t181:0.7668680947,t182:0.7485274093):2.817128557):0.03922815393):2.996807022):1.180580227):4.316230692):4.230894621):6.948512304):3.571744733):1.743403866,((((((t183:7.481405062,((t184:0.9371536725,t185:0.8834697061):3.230588673,(t186:0.09048369928,t187:0.05233786005):3.956271298):3.285674001):0.3067253381,((((t188:2.023682271,t189:2.000445543):4.43031103,((t190:4.056080592,(t191:0.7518966678,t192:0.6129815551):3.230685837):1.211337333,t193:4.947707634):1.054565271):0.2981453605,(((((t194:0.7793995977,t195:0.7188947048):0.5781019979,t196:1.250844277):2.436850412,t197:3.662170608):1.018463872,(t198:3.964551717,(t199:2.214701079,((t200:0.755570947,(t201:0.1636347923,t202:0.1079978774):0.3160675991):0.444673962,t203:0.8437219484):1.006557889):1.733498394):0.7103637543):0.1134280413,t204:4.130914333):1.353894259):0.7235552822,(t205:5.248267202,t206:5.223899155):0.8394292956):0.03091198831):11.58456315,(((t207:3.754763775,(t208:3.138073061,((t209:0.5081216798,t210:0.479345044):1.10004455,t211:1.296131647):1.526739149):0.5820363153):2.307617128,t212:5.510856933):6.441761334,((((t213:0.6316720296,t214:0.4542739957):0.2153613433,t215:0.4981179379):1.736046731,t216:2.128639825):6.74152359,((t217:2.396940327,t218:2.371192179):6.095421024,(t219:6.929159076,(t220:2.31649561,t221:2.2860764):4.447804848):1.522318055):0.2313819913):2.538560936):5.148662416):2.507619556,t222:18.67400493):2.200826783,(((((((t223:0.4573591073,t224:0.4252643781):1.972947975,((t225:0.5954339727,t226:0.2882412732):1.313286281,t227:1.598623353):0.3855240178):7.799980697,((t228:7.798369642,(t230:6.531649167,((t231:4.995306132,t232:4.975894383):0.9920553979,(t233:0.1983271319,t234:0.1276586487):5.723496456):0.4587776418):1.048960199):0.9217556008,t235:8.194542861):0.8627501187):0.9543458192,(((t236:0.09979378036,t237:0.02688034274):0.7961688095,t238:0.8205104423):6.987965917,(t239:3.37612781,t240:3.262106878):4.186653606):2.127469025):4.243610959,((((((t241:3.023077105,t242:2.855801873):0.6662854137,t243:3.442681903):0.1032844887,(t244:1.705828821,t245:1.56646476):1.805362937):2.465681914,t246:5.829883783):2.833247921,t247:8.578873986):1.488362597,(((t248:0.5077490485,t249:0.4704851108):6.010037549,((t250:4.138321234,t251:4.058407475):0.2681003936,(((t252:2.513948477,t253:2.318341306):0.933874547,((t254:1.313475969,t255:1.094985766):0.325049778,t256:1.356421275):1.607348252):0.2997464947,(t257:0.4058979837,t258:0.0933670466):2.574804227):0.5151462464):1.894470645):0.5022607259,t259:5.366471882):2.958661398):3.188271935):1.7163537,(t260:9.990803219,t261:9.987788566):3.229393009):1.538474082,(t262:0.4931932889,t263:0.3479186274):14.20156317):2.143439024):2.710621194,(t264:14.07055974,((t265:8.249569728,((t266:4.70356563,((t267:2.887503293,t268:2.773038512):1.739819313,(t269:1.153057833,t270:0.9281060426):3.214802282):0.04175198391):2.910522243,(t271:1.507092801,t272:1.188924099):5.554147804):0.5571836521):5.563082738,(t273:5.078832504,((t274:0.293669791,t275:0.2796115875):0.3478472843,t276:0.597670218):4.274655795):7.758098543):0.2234727033):5.321005028):1.725099071):11.89932235):11.86368553):23.61412883,((((((t277:5.727632453,t278:5.693165148):1.932493329,(((t279:3.381120059,t280:3.374238241):0.2576234326,t281:3.598139117):3.298642771,((t282:1.875754196,(t283:1.353986109,t284:1.296209271):0.4567408439):0.03875071854,(t285:0.8739983994,t286:0.6766993106):0.913744605):4.900975548):0.492561433):5.750052151,(((t287:0.4750408146,t288:0.4088186875):0.6901418023,(t289:0.6180446762,t290:0.587994167):0.4716620915):10.41638735,((((t291:1.097730976,t292:0.8754324782):0.934223614,t293:1.625599262):2.042140397,t294:3.575862454):6.993443181,((t295:1.646939422,(t296:0.9926923015,t297:0.9702808256):0.6070004389):1.550371925,t298:2.896471482):7.295619775):0.2290121407):1.149175899):0.2616252712,t299:11.80758423):4.54348785,(((((((t300:0.2207097028,t301:0.1938445432):0.9017699553,t302:1.000258219):1.968315341,t303:2.882578447):4.674425243,(t304:1.217058918,(t305:0.947991556,t306:0.7478176634):0.1177092981):6.289079552):1.105007491,(t307:8.021987912,((t308:2.993597188,(t309:0.2705896989,t310:0.2669251607):2.661952485):4.442379754,((t311:2.855657311,(t312:0.950270232,t313:0.4042492176):1.621889851):3.018069292,((t314:2.241636047,t315:2.225221235):1.554645094,t316:3.553427542):1.173312766):1.474048901):0.5649643619):0.1809593445):2.987333562,((t317:2.331859871,((t318:0.8340889152,t319:0.7643382616):0.5621372148,(t320:1.036712018,t321:0.929947861):0.2797399927):0.9017217997):0.7898979251,(t322:2.160057805,t323:2.069557161):0.6837729172):6.738381395):0.7057271976,((t324:2.329699757,(t325:1.022391465,t326:0.8873119801):1.24764633):1.012146936,(t327:2.012989656,t328:1.978843866):1.069160371):6.700324697):3.432608741):36.49580751,(((((t329:8.630795804,((t330:4.589578071,t331:4.459707677):1.926626814,(t332:5.966857445,(t333:3.273545737,(t334:0.3837559977,t335:0.07900845068):2.848707236):2.677421816):0.2705516275):2.109135146):0.7605639285,(((t336:0.2078845276,t337:0.09588774604):1.544184092,t338:1.620010674):2.320530829,(t339:2.147607882,((t340:0.6124338513,t341:0.4920026242):0.3699412568,t342:0.7664115214):1.101105913):1.773915343):4.633317758):0.7363459445,((t343:1.449609291,t344:1.323188437):3.089604942,((t345:0.8768506906,((t346:0.09570963594,t347:0.02080683137):0.411040036,t348:0.3671810795):0.3283867714):2.33074213,(t349:0.2442292268,t350:0.2061093333):2.774805119):1.152145673):4.440397032):2.464189012,(t351:2.983131228,(t352:0.5514336911,t353:0.545826765):2.077935933):8.050102095):8.808145737,((t354:3.935822783,(t355:1.392494319,t356:1.154296273):2.367620247):5.182049744,((((((t357:0.5283273212,t358:0.4925830141):0.3961900522,t359:0.7320032109):0.961779792,t360:1.663630202):0.6772756933,t361:2.306680275):0.1436092502,(t362:1.769203166,t363:1.701809916):0.6074447812):2.238273604,(t364:0.3736007537,t365:0.3556458156):4.059245064):3.740663283):10.22390332):28.25356698):12.30045927):0.6655899394):1.503996708);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T20.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
