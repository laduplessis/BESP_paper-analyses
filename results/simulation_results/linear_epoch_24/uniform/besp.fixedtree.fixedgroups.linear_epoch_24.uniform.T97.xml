<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t459:3.303501715,t460:3.302785785):0.2218105568,t461:3.51477637):5.89255109,(((t462:0.6178839136,t463:0.6156748914):0.79552535,t465:1.106403718):1.340113082,(t466:1.578492673,(t467:0.4934664502,t468:0.3997409072):1.049442232):0.858169087):6.627755788):14.83150659,(((t469:4.409720752,t470:4.344331703):8.960475447,(t471:8.794288736,((t472:0.6052714566,t473:0.3969686607):4.144746946,(t474:1.204457641,t475:1.156902014):3.254008101):3.959272025):4.445955247):4.993398369,t476:17.69167698):5.370828721):113.7827384,((((t477:0.1785405857,t478:0.03114998585):21.22686956,t479:21.25494352):16.84082684,((t480:0.2070772926,(t481:0.03723085943,t482:0.03002236589):0.1446283087):34.75692982,((((((((t483:0.7822298257,t484:0.5073730478):2.628292208,((t486:1.288262651,t487:1.247368017):0.388363193,t488:1.611820066):0.881360012):0.1327506142,t489:2.588163611):3.545341857,(t490:3.171962556,((t491:0.8094249642,t492:0.6212214589):0.5648489479,t493:1.181289483):1.788021452):2.844451849):0.3635627513,t494:6.166806314):2.879237361,t495:8.810508174):1.487409274,(((t496:0.8600134504,t497:0.6341571965):0.3302242948,t498:0.8617851715):8.918922297,((t499:3.201977564,((t500:0.1237202684,t501:0.123548736):1.263762226,t502:1.242341874):1.765873795):4.976532021,t503:7.730971359):1.382575834):0.1558546419):16.66497372,((t504:8.273973152,t505:8.232565943):1.930143824,(t506:0.6995990933,(t507:0.3425668921,(t485:0.4561916013,(t464:0.002464303485,(t457:0.008022111954,(((t370:0.01971382373,(((t342:0.04987447817,(t260:0.089442001,((t205:0.08855568469,((t196:0.09536197656,(((t134:0.1446534544,(t70:0.1105231301,(t1:2.99829918,t2:2.905088886):2.019221258):6.254766027):1.526484519,((t3:5.575541936,(t4:1.747375851,t5:1.726283088):3.725862381):0.3174794298,(t6:1.102275668,t7:1.050186171):4.666942245):6.728614481):3.49665744,(((t8:3.213460704,t9:3.080125348):1.785524732,(t10:3.65978989,t11:3.583160146):1.197888521):10.51769104,((((t12:4.480858854,t13:4.430361688):0.4426757903,((t14:2.159355325,t15:1.806738205):0.5229347682,t16:2.122838785):2.147142205):3.598569226,t17:7.74349623):5.91568443,((((t18:1.621176681,(t19:0.8387274784,t20:0.7791158064):0.7162491473):0.1603825666,t21:1.467596475):3.21896846,(t22:1.662588506,t23:1.632490491):2.945303988):2.140076646,(t24:2.939061481,t25:2.902503334):3.714992969):6.388539741):0.5418659543):0.3961542665):0.4337061921):0.3088351627,(((t26:1.294244921,t27:1.198015756):5.660127114,((t28:3.948617032,(t29:2.869473651,(t30:1.661050025,t31:1.645984012):1.177014313):1.056498297):1.466909795,((((t32:2.485761471,t33:2.432349319):0.2068637151,t34:2.372842527):0.2068257845,t35:2.423027041):0.1758950746,t36:2.516241911):2.195933668):1.340508334):5.324369021,((((t37:4.266408615,(t38:3.732122746,(t39:2.556383435,t40:2.552768826):1.165798308):0.5021390119):3.407715673,(((t41:1.876538275,t42:1.846064494):1.499770194,(t43:2.442900428,((t44:0.266909812,t45:0.1360311619):0.01913503488,t46:0.06179837434):2.155249212):0.8026287612):1.545679797,t47:4.41221889):2.684513356):0.8726053175,t48:7.899594253):0.9067694145,(t49:6.831227564,t50:6.805397731):1.917845275):1.800545065):2.309419108):1.239238944):4.714694054,(((t51:2.751497904,(t52:1.039880755,(t53:0.3298491738,t54:0.3267571):0.615658325):1.671436978):0.2359511985,(t55:1.429828146,t56:1.369294795):1.41482829):13.79490441,(((t57:3.805791336,t58:3.717517764):5.764306457,(((t59:1.19010998,t60:1.163678927):1.656338257,t61:2.816140442):3.465450302,((t62:5.443498587,(t63:1.869335323,t64:1.854318066):3.562049941):0.1729012742,t65:5.587831089):0.6264414848):3.050745168):2.828277303,(((((t66:3.832350782,t67:3.785888229):0.1049618985,((t68:0.4244438494,t69:0.4077187371):2.889182984,(t71:0.9567106397,t72:0.8726693264):2.052252854):0.5358117246):0.07000663456,t73:3.401677929):1.600583217,((t74:2.04084484,t75:1.888794986):0.7320507451,(t76:1.887530336,t77:1.822613956):0.3977288788):2.120353058):4.501672862,(((t78:2.274241287,t79:2.264687059):0.022349796,t80:2.237613165):0.03775119476,t81:2.269296384):6.487923712):1.95995517):4.14148365):1.996826695):0.4027867768):8.66838656):0.5071450773,((((((t82:0.5723267521,t83:0.4792467353):3.991727779,t84:4.308829101):5.831488511,(((t85:5.050714903,(t86:4.0935973,t87:4.009355934):0.934959713):1.273832019,(((t88:2.796830367,t89:2.776701693):1.456113795,((t90:1.93440393,t91:1.839947994):0.01392953847,(t92:0.9589259194,t93:0.5743731444):0.5948469562):2.005603648):1.858923834,(t94:2.218632991,t95:2.126810874):2.345586734):0.05444315882):1.639158764,t96:6.137402951):2.133265948):1.644617709,((((((t97:1.74593117,t98:1.618745572):1.796609686,(t99:0.9175641705,t100:0.7182385265):2.490150137):0.4108265863,t101:3.543329045):0.04314056788,t102:3.51820744):3.688864414,((t103:3.092538814,t104:3.048659504):1.267992758,(t105:1.592473928,t106:1.57848943):2.722217339):2.833151398):1.183801574,(t107:0.755168134,t108:0.6809734098):7.551288401):1.027277702):0.5137971598,((t109:5.869020392,(t110:3.454500778,(t111:2.829361313,((t112:0.618155123,t113:0.6011659454):0.5203618475,t114:0.839493135):1.618395656):0.5941631696):2.263110267):0.6882939741,t115:5.937404629):3.203182675):10.3031365,(((t116:2.455339313,t117:2.369959033):0.5181402332,t118:2.814820462):9.505436647,(((((((t119:1.611879373,(t120:1.223098524,(t121:0.8001499184,t122:0.6050324667):0.4085315967):0.341556595):1.750754174,t123:3.063094398):0.6253133095,(t124:0.9232795936,t125:0.8228622413):2.636396911):1.985905736,(t126:4.568820401,t127:4.529033731):0.6370002686):0.8558900932,((t128:2.324379771,t129:2.269031597):0.9235286699,(t130:3.042691562,((t131:1.803379058,t132:1.787506522):0.9162650421,t133:2.698434515):0.2834520084):0.1017673995):2.74226346):3.245937765,t135:8.501097928):2.122964741,((t136:3.344724829,((t137:0.4865129898,t138:0.4469666928):1.731179088,(t139:0.6488273242,t140:0.609532733):1.525418043):1.041456961):1.402163936,t141:4.522794646):5.844553038):0.03461665855):6.879720364):3.575905437):0.7853360656,(((((t142:14.78194648,((t143:3.864161062,((t144:0.6628493331,t145:0.5331735406):2.975551587,t146:3.467184939):0.2086512614):0.5334520155,((((t147:0.8330478159,((t148:0.1264190674,t149:0.09686764102):0.5485549001,t150:0.5094061984):0.1358237386):0.5561968136,t151:1.113252454):1.681980388,t152:2.759916362):0.9971204746,(t153:1.222466774,t154:1.209783346):2.41908708):0.02687354395):10.38326693):1.484916315,((((((t155:4.191592129,((t156:2.176220325,t157:2.096399301):0.0373225969,(t158:1.288480622,t159:1.156642426):0.82606477):1.649137779):5.082087784,(t160:6.624685496,((((t161:1.167750537,(t162:1.098132209,(t163:0.3929280656,t164:0.3338913646):0.3739910889):0.002436762573):1.070079692,t165:1.74188339):0.8436027048,(t166:1.383343001,t167:1.340001997):1.160822344):3.023305997,(((t168:3.970724829,t169:3.936126251):0.6607598152,t170:4.407319829):0.01916874063,((t171:0.8090004592,t172:0.6209468117):0.4014649934,t173:0.9835566873):3.134976026):0.4718234089):0.2909445688):1.813996257):1.42499648,((t174:3.295176712,((t175:1.896564958,t176:1.856241145):0.8296187636,t177:2.67830773):0.5207231827):0.07757018541,t178:3.210651475):4.705716816):0.2414910119,(((t179:7.092901414,(t180:0.3399015808,t181:0.2856894013):6.703824397):0.8877035844,((t182:1.349743278,t183:1.303610844):1.775731677,(t184:2.829796924,((t185:0.4707457708,t186:0.3666704796):0.8196734217,t187:1.080160086):1.429505345):0.2421884992):4.734732224):0.1096019215,(((t188:1.069203394,t189:0.9647579128):2.599296838,t190:3.542891096):1.045732891,((t191:2.68525137,t192:2.576220139):0.6357945788,(t193:2.833425969,t194:2.670693993):0.3406130952):1.267553003):2.767446085):0.05244367389):0.941647436,(t195:2.743110505,t197:2.593219371):5.244046766):2.176155571,((t198:4.016658706,t199:3.52877405):3.75100969,(t200:1.392705915,t201:1.389654526):5.770869918):1.874582221):1.447174014):0.5716371602,((((t202:2.353669618,t203:2.31314088):2.12727891,t204:4.132492062):0.5926373011,(t206:1.068559797,t207:1.055777608):3.165180314):3.949178498,(t208:0.9432458408,t209:0.8328934839):7.145627028):2.002597366):0.8395644101,((((t210:2.212874611,((t211:0.5269614257,t212:0.4680304913):1.283963068,t213:1.654063262):0.3853802697):0.2671500003,(t214:0.9556225295,t215:0.935760611):1.116369046):5.729354459,(t216:6.325430584,(t217:1.485158535,t218:1.47286115):4.813479697):1.404055612):0.5016540697,t219:8.011065428):2.063939552):2.782186865,((t220:8.483742449,(t221:4.106546597,(t222:1.253052548,t223:1.23397161):2.805002969):4.293265377):0.1435380697,t224:8.443970988):4.225746226):0.9553694341):1.658854735):0.1541882929,(((t225:2.450136694,((t226:0.1798748229,t227:0.1083263903):0.3964029112,t228:0.3722669905):1.865367313):2.296172306,t229:4.42613327):10.12981961,((t230:1.02940601,t231:0.6396887566):11.76359043,(((((t232:1.59003291,(t233:0.1489552593,t234:0.1063846972):1.184804651):1.041400717,t235:2.15000929):4.815824623,t236:6.859988777):0.6539237451,((((t237:2.899822775,t238:2.888397626):0.6918221899,(t239:0.3285030562,(t240:0.1403413266,t241:0.05119529368):0.1516478236):2.981878263):0.45341181,(t242:2.790146328,(t243:0.3443118143,t244:0.2445411049):2.432623608):0.8183505782):2.034878179,((t245:1.430394556,t246:1.314525434):0.1943494276,(t247:0.4842697949,t248:0.3608881323):0.7884847032):3.866551759):1.410178329):3.153785984,(((t249:0.8938152481,t250:0.7895707445):5.698436071,((t251:4.013078371,(t252:2.82795813,(t253:1.063012854,t254:1.003372678):1.615950738):1.180567834):1.860470638,t255:5.629424198):0.6087660246):1.579752439,((((t256:1.194263279,(t257:0.2774383754,t258:0.258582941):0.7071282227):1.612592447,t259:2.554781564):0.7245082798,((t261:0.06384058312,t262:0.06097731522):2.282339243,t263:2.268885584):0.7241160355):1.659463466,(t264:2.208450747,(t265:1.363261273,t266:1.333190823):0.8430861788):2.414274279):2.602848029):1.225805221):0.9480027161):1.646616103):0.5086943929):1.217779643,(t267:10.41874554,((((t268:1.085269935,t269:0.6980897119):3.90844017,((t270:0.07422401446,t271:0.02196070521):1.784182446,(t272:1.415037941,(t273:0.8157370771,t274:0.7257402027):0.5490634709):0.3729437332):2.648673739):0.9693471624,(t275:2.667949255,t276:2.565581455):2.564964951):3.563064461,((t277:5.034936748,(t278:2.504721665,t279:2.366877419):2.395754502):1.415718079,(t280:5.786628389,((t281:1.094748233,t282:1.089959013):4.14380918,t283:4.987174461):0.4533239863):0.3878098946):2.040604263):0.6379764006):2.229180107):6.715942381):0.4592027074):2.175456973):2.384730111):0.3379017435):9.359672842):15.65071234):6.220139445):3.052298494):0.797657902,(((((((((t284:3.21403481,(t285:1.257348319,t286:1.04059292):1.689168824):5.63145273,(t287:1.011162201,t288:0.9409910223):7.2763674):0.1588172451,(t289:3.493929158,(t290:0.5761724824,t291:0.2790700665):2.571563723):4.817531926):3.031730365,(t292:7.771229832,(t293:3.155221465,(t294:0.3191508207,t295:0.2563527765):2.756774552):4.515703741):2.847850067):0.3643306588,(((t296:1.462443719,t297:1.44809607):0.8054648749,t298:2.244122194):4.302588609,(((t299:0.1383670201,t300:0.04849233577):0.2591611771,t301:0.2766611223):2.088184992,t302:2.356032266):4.049028079):4.108158133):4.260507297,((t303:4.711238887,(t304:2.847658609,t305:2.678264728):1.622322409):6.994049266,((((t306:0.586327691,t307:0.5741567937):2.083357524,t308:2.595648031):2.87160781,t309:5.45688563):4.071581875,(t310:9.188366228,((((t311:0.6097391811,t312:0.5930735446):0.4728472497,t313:0.8084399197):0.348036792,t314:1.135086473):1.560635395,t315:2.689430649):6.185281896):0.2767605787):1.658606426):2.870955974):2.360760123,(((((t316:2.226682013,(t317:1.762978753,t318:1.65822506):0.2288268003):3.690533283,(t319:0.964448825,t320:0.8386424626):4.598596973):6.359747673,t321:11.76095118):2.686793468,(((t322:7.080175029,(t323:5.512392186,t324:5.500261708):1.235583051):4.387562044,((t325:7.174418008,(((t326:0.7569431075,t327:0.5956780742):4.211949161,(t328:3.049800793,t329:2.801929982):1.711641941):1.893555291,((t330:5.697450207,((t331:4.066777832,t332:4.066593722):0.1309183993,(t333:0.9703076012,t334:0.9686051342):3.210679963):1.2411233):0.6424925716,((t335:2.396614603,(t336:0.1293023113,t337:0.06336940596):2.160902837):3.177501262,((t338:3.071286571,t339:2.918600809):0.1738799807,((t340:0.6750165253,t341:0.5671701111):0.438843522,t343:0.39892699):1.871240158):1.92516148):0.3981815218):0.03641520943):0.2888866445):3.030886885,((t344:5.400835012,(t345:1.407635466,t346:1.215024326):3.972575369):2.317326476,((t347:1.256392761,t348:1.228713574):2.666887399,((t349:0.5093534461,t350:0.4393482183):2.29111427,t351:2.670656898):0.8544073602):3.569997702):0.08423080764):0.8452634102):1.335363883,(t352:2.493400083,(t353:1.176960309,t354:1.132936914):1.296055977):6.829937649):1.580759838):0.2176015364,((((((t355:1.183122019,t356:1.164319443):2.314295372,t357:3.453375936):1.745313757,((t358:3.607828961,t359:3.467505669):0.9303757077,t360:4.364753892):0.4501559928):1.498684716,((t361:0.7879712584,t362:0.7072502173):3.667107106,(t363:1.856311621,(t364:1.575996725,t365:1.438112677):0.2798684163):2.469692021):1.808509112):0.3696511249,t366:6.348363768):1.682865213,(((((t367:1.639430959,t368:1.110882977):2.120912551,t369:3.062893235):0.1817280338,t371:3.01578921):1.158538724,(t372:3.55502419,t373:3.494583393):0.5776386064):2.565087501,(t374:3.093092446,(t375:1.572332938,(t376:1.10585591,t377:1.056328323):0.4415729237):1.507552038):3.472062461):0.3246902944):2.118190577):0.7342804131):8.393459154,(t378:5.850643141,((((t379:1.512426087,((t380:0.1375955639,t381:0.1317449871):0.2521858915,t382:0.3348332666):1.096698117):1.579945912,((t383:0.6696345757,t384:0.2569321377):1.895351445,t385:1.895453003):0.4366927949):1.18893632,t386:3.421981011):0.5056582263,(t387:3.568451936,t388:3.549463999):0.3331598809):1.003719634):12.1801959):16.33663122,((((t389:11.04790568,((t390:7.896001201,(t391:4.694052962,(t392:2.067239413,((t393:0.5862618558,t394:0.5332055919):0.5849253916,t395:1.045988908):0.8280365369):2.603296052):3.057759586):2.830842402,((t396:3.05884338,t397:2.845453878):5.177344796,((t398:1.222849942,t399:1.11667412):1.105355938,(t400:1.20442621,(t401:0.3445311524,t402:0.3193698712):0.7825769486):0.8545474234):5.562221283):1.613460358):0.1704212019):1.455091905,((t403:2.622264113,t404:2.47912896):2.124743407,(t405:2.074150224,t406:2.074043883):2.428849734):5.89765627):0.1913430051,(t407:4.563659225,t408:4.4644215):5.977063447):11.61931643,(((((t409:1.351436622,t410:1.011824552):0.3141061178,t411:1.301730333):2.048752689,((t412:0.5752262113,t413:0.4328931201):0.7386309158,t414:1.136119181):1.983667257):5.93750888,((((t415:2.837070757,t416:2.65725348):1.709275319,t417:4.320895975):3.761074578,(t418:5.480199457,((t419:5.377605152,((t420:2.976854598,(t421:1.299067663,t422:1.139878969):1.571626472):1.902574151,t423:4.539489564):0.4412775914):0.03679073994,t424:4.856369611):0.06395349031):2.376457327):0.5730484644,((t425:0.8267508116,((t426:0.3876703969,t427:0.3593945736):0.4187742472,t428:0.775499839):0.00082612254):5.005216099,t429:5.599278605):1.974140823):0.1399742723):2.056558481,(t430:5.683040575,(t431:5.466979922,((t432:3.39474224,(t433:1.383547967,t434:1.345747335):1.959432676):1.840001808,(t435:4.446616828,t436:4.446288646):0.6279111137):0.09598990063):0.1172597972):3.878650044):10.25430396):8.942525883):13.87038712):97.7650766):216.3119404,((((t437:0.06246306853,t438:0.02297354735):3.383473503,((t439:0.1530230621,t440:0.06264339415):2.390977845,t441:2.251223501):0.7349426453):0.3021622679,t442:3.11934524):26.3845651,((t443:3.903866195,(t444:0.2176779328,t445:0.1917566984):3.495635089):18.02242836,((((t446:0.9673885937,t447:0.9044763806):0.5841662695,t448:1.458465261):6.267752295,((t449:0.1427558561,t450:0.03206687916):4.354224084,(t451:1.158189285,t452:1.012951384):3.201447081):3.18992257):6.302084729,(((t453:1.171463954,t454:1.067403867):3.868328973,(t455:0.5811909405,t456:0.4961591904):4.346543892):1.669584279,t458:6.315251742):6.840274958):7.514537147):7.576676024):326.1469761);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T97.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
