<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t479:5.340638601,(t480:2.967439897,t482:2.802039915):2.214978239):15.45152545,((t481:0.1137879448,(t478:0.0826026282,(t405:0.04488114934,((t316:0.05128774462,(t275:0.3924884421,((t225:0.06989148232,(((t128:0.03901025577,(t84:0.1183335071,(t62:0.08907553887,t1:7.414699964):1.756235845):5.485526652):5.483809978,((((t2:5.031541593,t3:4.97240089):2.953487822,((t4:3.621475641,t5:3.543086742):2.812062717,(t6:5.560097496,t7:5.35177661):0.7566586829):1.438141073):5.74793079,(t8:6.454677106,((((t9:2.658778547,t10:2.538876534):1.274377602,t11:3.725699799):1.579071609,t12:5.275771346):0.4176971988,t13:5.612337837):0.4052825743):6.677405245):1.791629656,((t14:10.72499283,(((t15:1.75451693,t16:1.571328621):3.895287932,t17:5.448506721):1.864346764,((t18:1.105487331,t19:1.049104734):3.620392481,t20:4.52513307):2.49466028):3.204413496):1.545749181,(t21:6.928183773,((t22:3.662785791,(t23:2.555457559,t24:2.465839913):1.052081038):2.021483498,(t25:1.769721592,(t26:0.6330560514,t27:0.5785594362):1.05142457):3.722711034):0.3796659204):4.595340922):1.963605652):4.61114156):0.1599080641,((((((t28:0.7677642472,t29:0.6389377207):1.151660517,(t30:0.2695810006,t31:0.1972583544):1.448259998):6.706572653,((t32:5.683278049,(t33:3.50945423,(t34:1.610038345,t35:1.550033216):1.813122457):1.607741256):0.2171621876,t36:4.866219267):2.346406341):0.01084171226,((t37:1.496281459,t38:1.48147364):4.107749005,t39:5.570617715):1.461392504):7.161262117,((((t40:0.3770727247,t41:0.3243320158):4.249690323,t42:4.398490155):1.744959767,(t43:0.1287405882,t44:0.01488405424):5.752157084):1.755724986,t45:7.495389802):6.038577075):0.6071778801,(((((t46:1.990085657,t47:1.945077838):2.643669067,t48:4.374102264):3.54449393,((t49:2.964425386,t50:2.939374438):1.596972391,(t51:4.081674032,(t52:0.357056558,t53:0.2391424969):3.590759317):0.3577954891):3.333297564):1.807030661,(t54:9.057780824,(t55:3.890806653,((t56:1.823047022,t57:1.775762572):1.16777779,(t58:1.242288878,t59:1.188609377):1.650608614):0.3582199292):5.155116462):0.265316119):0.5134886549,(t60:1.502699611,t61:1.464371485):7.448864659):3.462518277):0.6486195408):2.610720848):0.1361506912,(t63:14.71414228,(t64:0.1738005844,t65:0.1212581154):14.53535598):0.8132493316):4.124730984):3.979399428):8.566198636,((((((((t66:0.8984427759,t67:0.8854019972):3.846366054,((t68:0.5404378218,t69:0.4398399303):0.491800192,t70:0.8506923399):3.409901748):3.411331708,((t71:6.364409684,(t72:4.447452278,(t73:1.449455846,(t74:0.2953480765,t75:0.2891415115):1.133286463):2.97585299):1.910397053):0.1276250438,t76:6.304018775):0.9658707142):0.8685947473,(t77:0.9322804061,t78:0.898912186):7.068071687):10.7548705,((t79:13.74729487,((((t80:3.270283616,(t81:1.908471239,t82:1.902347252):1.310425398):0.06261615489,t83:3.161334445):2.100144487,(((t85:2.132735135,t86:1.795479857):1.532994299,t87:3.24769116):0.1599246756,(t88:2.64436475,t89:2.459487486):0.5363454271):1.158855654):1.302398536,((t90:0.598057947,t91:0.5743736479):2.911391582,(((t92:1.09703671,t93:0.9190885348):0.4173120817,t94:1.233235093):1.698577525,t95:2.833574066):0.01706804893):1.94333008):6.961762837):2.953040848,(t96:0.28368655,t97:0.1724227175):14.28856249):1.853811857):0.9746620423,((((t98:1.236866371,t99:1.119643392):1.933262111,t100:3.045655992):2.390658767,(t101:2.349629501,t102:2.344748833):2.946612137):7.72449706,(((t103:1.080628403,t104:0.9405020144):8.245940701,((t105:3.995983219,(t106:1.534485909,((t107:0.4159129434,t108:0.2487276634):0.9548068548,(t109:0.189981139,t110:0.08178077841):0.9006284202):0.1108874453):2.399178262):0.5180147359,t111:3.470542711):4.65566263):2.195211538,((t112:1.637492026,t113:1.603802732):7.746725759,(t114:1.60049923,t115:1.492257951):7.72518904):0.747801824):1.448229029):3.749134146):10.27823954,((t116:11.28299894,((((t117:4.969674105,t118:4.949448677):0.778197452,((t119:3.876555478,(t120:0.5288992201,t121:0.1569444033):3.225649724):1.641944896,(t122:3.813258025,(((t123:1.593454042,t124:1.567815036):0.6424864711,t125:2.038731749):1.437985959,(t126:1.350921737,t127:1.070724874):1.976129228):0.114332088):1.165506834):0.08982567012):2.961647203,(t129:5.015900909,t130:5.004336796):2.282829501):0.1414351595,(((t131:1.699807947,t132:1.656498406):1.338167253,(t133:0.06973312178,t134:0.0692239491):2.914769066):1.737981934,(t135:0.7868356959,t136:0.7606926983):3.815782348):2.196517819):2.407996021):2.136111194,((t137:8.720333326,(t138:3.804867184,(t139:1.349681376,t140:1.33065663):2.422684444):4.888922188):0.8570217818,((t141:2.182156715,(t142:2.03167178,(t143:0.7045306231,t144:0.6775832072):1.260480724):0.09874196172):1.332443613,t145:3.356931388):5.794805169):1.640373982):11.98442627):0.02044275158,((t146:3.368369731,(t147:2.53310634,((t148:0.507169572,t149:0.3900669798):0.05824233715,t150:0.4224316074):1.947483215):0.7836599798):6.894250279,(((t151:9.25970815,(t152:6.854030684,(t153:1.435353483,((t154:0.4338084582,t155:0.3795255904):0.1162802115,t156:0.3421062571):0.8496207768):5.393719905):2.373299772):0.4519753851,t157:9.385378585):0.2657485601,((t158:2.612800544,t159:2.588699887):0.9420776076,((t160:1.670724801,t161:1.323274326):0.1934061389,t162:1.414883261):1.661390233):6.091992736):0.06658105169):12.45734358):1.069893428):0.5899683312):7.11826775):0.305359652):17.85566541,((((((((t163:5.177311027,(t164:4.072544839,(t165:0.5257197209,t166:0.4413081455):3.510530013):1.014579341):2.592737964,((((t167:1.186736141,t168:1.014523003):1.677390071,t169:2.651885124):3.759665887,(t170:1.338500541,(t171:0.9803315676,t172:0.6021978324):0.2276089193):4.994761375):0.5678165595,(t173:3.385231183,t174:3.314635372):2.650844863):0.3547607583):7.202151044,(((((t175:0.2862966355,t176:0.1661308078):0.7090711911,(t177:0.1229196143,t178:0.112209779):0.7045081842):0.03671030817,t179:0.7258144681):0.06153899307,t180:0.5432516285):11.89280277,(((t181:5.760522177,((t182:0.6394775372,t183:0.6120090077):1.450231438,(t184:0.1097569711,t185:0.08421838038):1.825354518):3.520522921):4.993275587,(t186:4.067886251,(((t187:0.722490343,t188:0.3757351178):1.514813361,(t189:1.147349103,(t190:0.4443222344,t191:0.4019334143):0.6176885393):0.7250517113):0.6656818192,(t192:0.4789278771,t193:0.3421086062):1.678661477):1.125884798):6.276315442):0.5459827707,((t194:1.405974058,t195:1.388454984):7.509749357,(t196:5.608507917,t197:5.487769781):3.192578644):1.018610068):1.131472772):0.5262417181):4.9306682,((((t198:1.574778619,(t199:0.4475414639,t200:0.4186936606):1.052305852):7.300975156,((t201:4.626176424,t202:4.572114818):1.680834836,(((t203:0.7688072312,t204:0.5010094063):1.735339665,t205:2.222641572):3.443585129,((((t206:2.315168783,t207:2.210917007):1.844914595,(t208:0.194271858,t209:0.1871517525):3.853033627):0.3356038253,t210:4.286203499):0.04321403384,(t211:1.881599692,(t212:1.69652746,t213:1.673927315):0.1294576881):2.354321283):1.086499783):0.2051569704):2.421539108):0.6737559568,(t214:6.638979548,t215:6.551382295):1.859702553):3.550167311,t216:11.91443033):3.14929564):12.30342854,(((t217:0.8860817275,t218:0.559265287):3.67960889,((t219:3.480627408,(t220:2.837583755,(t221:1.738408953,((t222:0.427044428,t223:0.1630121907):0.8298558688,(t224:0.2302650743,t226:0.01790709081):0.7595043941):0.356375672):1.033506074):0.5611046799):0.3926933132,(t227:1.800511365,t228:1.439178011):1.244091325):0.3571671313):20.95021368,((((((((t229:1.941150778,t230:1.795861904):1.529663249,t231:3.305759629):3.570136358,t232:6.837677697):0.536907861,((t233:2.982702315,(t234:0.1433419955,t235:0.1381284844):2.67367734):3.556297985,(t236:0.469242778,t237:0.4302910346):5.799677617):0.7746340836):10.71074446,((t238:5.446492636,((t239:3.918535561,(t240:2.929283805,t241:2.88148053):0.7771847104):1.166270824,(((t242:0.05052713544,t243:0.02731433424):3.395935724,t244:3.279282075):0.01047779966,(t245:2.721666631,(t246:0.1773801291,t247:0.1040000491):2.540565986):0.5428818332):1.319484886):0.2427981947):1.229617054,(t248:5.130600966,((t249:1.148248023,t250:1.05695072):2.036808421,(t251:1.019556255,(t252:0.2851612002,(t253:0.1131118166,t254:0.06640239788):0.123151671):0.6948904472):2.00088099):1.666876381):0.7574876772):10.90569237):3.531981487,((((t255:4.202607119,t256:4.065435315):1.140830536,((t257:4.549211642,((t258:2.106829743,t259:2.101985772):0.9892074962,(t260:1.185275771,t261:1.150291274):1.897223636):1.449208818):0.5752836466,(t262:4.225524554,(t263:1.49052627,t264:1.480826866):2.628590076):0.8206157371):0.04553192598):4.739309085,((t265:0.260273027,t266:0.1858567248):3.014216495,t267:3.19293766):6.38813825):5.727898343,((((t268:3.311563554,t269:3.26354174):6.01558605,((t270:3.63645997,t271:3.622060579):4.393239132,(t272:2.144913393,t273:2.106568142):5.705369377):1.212497132):0.4361519884,t274:9.453310179):3.301510312,(t276:1.021907523,t277:0.8654021348):10.99202164):2.238068819):3.884523501):0.2488626909,(((((t278:1.198028945,t279:1.194140462):0.8261743227,(t280:1.756367521,(t281:0.2917836581,t282:0.2508755776):1.32379873):0.08000436492):2.734602714,(((t283:0.2569110808,t284:0.1826325697):1.193773055,t285:1.365997905):1.177104861,(t286:1.936066674,(t287:0.1011255189,t288:0.05078768643):1.712062849):0.4966001683):1.699162078):4.697557253,((((t289:1.010774938,(t290:0.3675811452,t291:0.2748430406):0.550093694):0.5607070204,t292:1.369364343):0.5906546575,((t293:0.2379103283,t294:0.1378768304):0.7984450611,t295:0.7882916104):0.9141149568):4.880293959,(t296:5.740269968,(t297:4.009616917,t298:3.964160109):1.682580414):0.6463136272):1.587571181):1.643981616,(((((t299:0.8239144242,(t300:0.3988378438,t301:0.174020809):0.2730257677):2.629148905,t302:3.020093852):5.351303419,((t303:0.9938600334,t304:0.9209264778):4.568389471,(t305:0.9191327345,t306:0.8750301021):4.477435856):2.778049294):0.01615860703,(((t307:0.3458891074,t308:0.2668514061):2.455075462,t309:2.618309242):0.580675493,((t310:2.483571345,t311:2.467831385):0.0657164255,t312:2.463639149):0.1922559782):4.639297238):0.2416714775,((t313:2.578985271,t314:2.534815927):4.095722649,t315:6.544377557):0.6473244495):0.411309795):7.025713605):1.48218949,(((t317:0.04352636288,t318:0.04100433156):2.403962177,t319:2.371081511):12.13533188,(t320:8.277871508,((t321:2.278332146,((t322:0.3892383105,t323:0.1721337773):0.594927669,t324:0.605726174):1.193140632):5.882161762,(((t325:0.4399901343,t326:0.4389864885):3.285758822,t327:3.683461977):0.421694975,(((t328:1.387437231,t329:1.336215143):1.075667283,t330:2.337692782):0.6094471456,t331:2.928784397):0.7967207266):3.228644743):0.1002623786):6.103827364):1.294667339):0.2302028436):1.833756427):0.8013029429,((((((t332:1.026555353,t333:1.025216694):0.01488943035,t334:0.6698417844):4.826155527,t335:5.416987067):1.383027652,((t336:1.462840948,t337:1.461941958):0.7810840928,(t338:1.023530104,t339:0.8045350156):1.138774835):4.446170904):1.607479975,(((t340:0.6265874913,t341:0.592607206):3.279298544,(t342:0.6674373631,t343:0.5225268287):3.003931707):2.226527675,((t344:2.888023554,(t345:2.235920826,t346:2.229810461):0.6457315176):0.9911202643,(t347:1.701590076,(t348:1.18500115,t349:0.7491510295):0.4811691696):2.162820209):1.807176977):1.704093026):4.791214111,((t350:3.683625597,(t351:0.356659915,t352:0.309946676):3.039311536):2.620505932,((t353:1.033958948,t354:1.003984007):1.49468033,t355:2.311404821):3.416686845):5.378579284):3.582044105):1.132747883,(((((t356:3.215025377,(((t357:0.1792134523,t358:0.1674310915):2.471069801,((t359:0.1596023326,t360:0.140408952):1.307178429,t361:1.41905609):1.108644306):0.1407439034,(t362:2.319275767,t363:2.312896653):0.06114774161):0.3839733363):0.9952872237,(t364:0.5810233195,t365:0.4242924167):3.143291169):3.321722674,(t366:5.416694203,(t367:0.6930076948,t368:0.627509976):4.697528676):1.40841224):0.06707094647,t369:6.438792613):7.183033084,((((t370:2.416795382,t371:2.236163265):2.762011469,((t372:1.053492629,(t373:0.8027070908,t374:0.7865573752):0.1963801474):0.3756640877,t375:1.181276896):3.54909695):2.681165627,(t376:5.068399444,t377:5.028576462):2.249713098):5.001266652,(((t378:0.3807023534,t379:0.2644039656):0.7721820143,t380:0.9616978288):7.513212839,(t381:4.647149434,(t382:4.304741272,t383:4.011334064):0.3010943627):3.779129833):3.446565194):0.3169318605):0.9760077767):3.051601648,(((t384:2.776284788,((t385:0.678572475,t386:0.6170609938):0.0130821871,t387:0.4047028567):2.068479337):2.01428194,((t388:0.9359915347,t389:0.8981850112):0.4057732701,t390:1.249954135):3.10617546):9.639731177,(t391:5.422447681,t392:5.390617664):8.555443436):1.378205911):11.38807071):2.656412234):5.175425994,((((t393:1.026456745,t394:0.9771772892):1.261071576,((t395:0.1849208679,t396:0.08400146295):1.412772049,t397:1.434087978):0.405013366):5.036164788,((t398:1.82051906,t399:1.615354594):1.596336278,(t400:2.258191851,t401:2.180458484):0.7714402752):3.311827766):10.57276142,((t402:0.07056556699,t403:0.006959321083):2.84262783,t404:2.726020306):13.8889768):16.56177868):86.0898877,(((((((t406:2.367945334,t407:2.333665533):3.904284299,t408:6.162357227):2.467118484,((t409:5.006951927,t410:4.791261111):1.123862422,t411:5.904127624):2.22796158):4.604362395,((t412:2.426094911,t413:2.260658237):1.005176119,(t414:1.644519846,t415:1.612973292):1.272502346):9.257690376):1.294692793,((t416:1.321735416,(t417:0.7711546711,t418:0.7510878734):0.5123508369):6.675939599,((((t419:0.9370108561,(t420:0.5982188341,t421:0.3436647585):0.3360231809):2.766821053,(t422:2.412576141,(t423:0.8027978599,(t424:0.7706288726,t425:0.6644208541):0.02049859343):1.505718985):1.032976178):2.092868509,(t426:2.780209994,(t427:1.962497965,t428:1.901552921):0.8016342937):2.329628279):1.612446113,((((t429:2.519631669,t430:2.415751354):0.9348246994,t431:3.345530099):1.428426681,t432:4.754569304):0.6075033298,t433:5.243031649):1.106026444):0.5276395101):5.381619497):20.54994008,((((t434:0.4318380548,t435:0.2263491444):3.789937695,((t436:1.298203014,t437:1.120157615):0.2259312613,(t438:0.2075468381,t439:0.156054534):1.129241189):2.206466056):3.27688303,(t440:1.813855939,(t441:0.9704430802,t442:0.9568057228):0.7676249941):4.694797904):6.101532893,(t443:5.074455152,(t444:1.297516518,t445:1.230876425):3.628506929):7.410227016):19.1055979):14.46461672,((((t446:0.4047046671,t447:0.3246841277):2.938471819,t448:3.178354966):1.347398377,t449:4.479164365):1.359342107,((t450:1.265009654,t451:1.201353103):0.6884520753,t452:1.871407909):3.875959919):39.74358293):69.52197755):42.04061936,(((t453:3.791427054,(t454:2.521631308,(t455:1.826533362,t456:1.645239087):0.6780117986):1.205392062):9.138159472,t457:12.38900462):9.917474486,((t458:9.46848155,(t459:3.085533843,t460:2.991035429):6.354047051):4.89582253,(t461:2.373232927,(t462:1.116655585,t463:1.110000789):1.231013636):11.74272492):7.797400725):134.1973654):103.4775666,((t464:15.62137586,(t465:3.69175519,(t466:2.598219509,((t467:0.1400478409,t468:0.03800193976):0.6067259128,t469:0.5330707811):1.762704959):0.8259644991):11.92788408):6.363669974,((t470:3.821737959,((t471:0.2691421116,t472:0.2007476812):1.00349905,t473:1.131785988):2.515516311):4.292027953,(t474:1.799027687,((t475:0.6106047771,t476:0.1168903011):0.01711543247,t477:0.09303700814):0.8532479316):6.114632095):13.10561116):237.5286584);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.uniform.T79.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
