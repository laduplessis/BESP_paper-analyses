<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t444:4.959411047,(t445:3.330687934,t446:3.286559834):1.558657322):1.733763845,((t447:1.394602511,(((t422:0.2701332028,((t400:0.07109142939,(t354:0.1684103616,(t335:0.193244271,(((t264:0.0223830874,((t232:0.09408003677,((t218:0.1930233807,t219:0.1445622382):0.01694678535,(t141:0.03836059544,(t135:0.1232743762,(t64:0.1751833931,((((t26:0.0860713209,(t11:0.04962183164,t1:1.148930857):1.661343521):0.6708382245,(t2:0.9934123486,t3:0.9608531819):2.457688729):3.336371021,(t4:4.477151685,t5:4.350971184):2.18156901):0.8228099494,(((t6:1.618964333,t7:1.472839218):0.5917858123,t8:2.052010671):3.280736764,(((t9:2.43225327,t10:2.248949709):0.6223563348,(t12:1.367998208,t13:1.188788408):1.15040883):0.8171421178,(t14:2.090386627,(t15:1.920723278,t16:1.917695619):0.02519580112):0.6674353918):1.318129096):1.702025117):0.1716188326):6.738450467):0.9401397809):7.833121428):1.146153863):2.531782286,((((((((((((t17:1.077199092,t18:1.009639335):0.7857822579,t19:1.751811907):0.8393912964,t20:2.555051852):0.07653272429,(((t21:1.283207625,(t22:0.4280315186,t23:0.383378331):0.7232513634):0.7086001381,t24:1.722152839):0.07688259538,t25:1.661115957):0.5051618814):0.5404177472,(t27:1.067894373,t28:0.8307793637):1.294376775):0.594433353,((t29:1.105543688,t30:0.9120601116):0.1685324144,(t31:0.5733815191,t32:0.4918426389):0.497592217):1.38640086):0.6800179696,t33:2.864051634):0.1196327516,t34:2.854502839):1.177000509,(t35:3.257374979,t36:3.237997487):0.6905551957):5.387488189,((t37:0.2297182637,t38:0.1609471268):8.340969052,((((t39:0.8910461428,t40:0.8454135257):2.218139912,(t41:1.105013067,t42:0.7831623219):1.447628693):1.020564962,t43:3.179431873):2.856066215,t44:5.973141825):1.486193509):0.7048611652):9.969274456,(((((((t45:0.5439765855,t46:0.494348311):5.141997481,t47:5.281603699):0.3544281866,(t48:2.739333,t49:2.551741712):2.887368644):1.987453425,(t50:2.429285779,(t51:0.406285989,t52:0.2847234834):1.983506109):4.867882232):1.985776329,((((t53:1.938130551,t54:1.884142954):3.583909393,t55:5.297120505):1.632938658,(t56:6.351351819,(t57:5.486754515,((t58:1.970062132,t59:1.943772551):2.303224145,t60:3.893025433):1.107958421):0.852409702):0.05876554737):1.678287604,(((t61:4.791985606,t62:4.753360337):0.6156778208,t63:5.297835605):2.090859807,(((t65:6.424771707,((((((t66:0.7223787192,t67:0.6863875539):0.2153604083,t68:0.8975531256):1.896828229,(t69:2.127027038,t70:2.083165271):0.5580747812):2.053274912,t71:4.436873539):1.164204434,t72:5.549986116):0.2035206637,((t73:2.687324956,t74:2.630555154):0.9080129303,(t75:3.198058699,t76:3.066493294):0.2440918087):2.133530662):0.1520795441):0.1830018799,((t77:2.68043914,t78:2.61195176):2.070758835,(t79:3.955625658,t80:3.917555871):0.6724588413):0.9626118828):0.4002946597,((t81:3.674748231,t82:3.657231005):0.7119215856,(t83:3.795620018,((t84:2.051411061,t85:1.910133819):1.26314586,(t86:2.847962497,(t87:1.957007957,t88:1.954771472):0.8537333384):0.2008926448):0.4525905178):0.4697228252):1.351982532):0.06607609632):0.01157294963):0.2117198268):0.9258893978,((t89:3.907579497,t90:3.888893965):1.444595772,((t91:3.068363499,(t92:0.2426734795,t93:0.1719657965):2.765428159):0.4105523669,t94:3.322633237):1.322877293):1.082657005):6.885967965,((t95:2.223387594,t96:2.218963428):1.60452636,t97:3.743391577):8.684354041):0.2861240417):3.442445322,t98:16.01383435):0.2580597085):0.7971789543):4.881531611,(((((t99:4.057536951,(t100:3.950491448,((t101:1.29958687,t102:1.233333843):1.680551855,(t103:2.73592879,((t104:1.453815213,t105:1.313834156):0.3428489473,(t106:1.570880269,t107:1.211693888):0.04567688329):0.7185402013):0.1304519498):0.7265186996):0.02946404269):1.034262264,((t108:2.316411762,t109:2.285804731):0.7500294187,((t110:2.548362381,(((t111:1.21347242,t112:1.166644958):1.005569187,(t113:0.2891928518,t114:0.2579370087):1.878946465):0.04573502625,((t115:0.4626140258,t116:0.366810901):1.064649754,t117:1.426107697):0.644679652):0.1905904533):0.3234427354,t118:2.419946597):0.09856357365):0.8093331759):0.2361086656,((t119:2.066776829,(t120:1.180947204,(t121:0.8387176073,t122:0.2431873967):0.3342468794):0.7885158798):0.7344397091,(t123:0.7490241953,t124:0.6808609587):1.225669308):0.4322427563):7.575684713,((((((t125:0.3142133203,t126:0.1992603556):1.128359053,((t127:0.5678983463,t128:0.5327097636):0.2281783155,t129:0.7264055371):0.4229766247):0.06065924745,t130:1.168226844):2.982786447,((t131:0.2896877926,t132:0.2636185733):1.012287076,t133:1.219409676):2.835060212):2.025044115,t134:6.044955069):3.044788816,(((t136:1.247147897,(t137:0.7076295208,t138:0.6967061273):0.4126010461):5.683028676,(t139:5.293188985,t140:4.932798616):1.434067603):0.01089120339,((t142:5.34563939,(t143:1.891527015,((t144:1.076727581,t145:1.066978876):0.1100235597,t146:1.166945119):0.6464948176):3.424432514):0.08845697523,t147:5.268569741):0.5550356599):1.650082073):0.1787317524):2.38036016,((((t148:2.518106637,t149:2.451573978):4.343143293,((t150:3.278404353,t151:2.9406008):0.5676630046,t152:3.315507222):2.821668705):0.3074535909,t153:6.347653512):1.904459818,(((t154:7.104293886,((t155:3.738868304,t156:3.680613021):1.770880778,t157:5.443999176):1.526018042):0.03805947014,((((t158:1.000400895,t159:0.972722687):0.8351242409,t160:1.806781042):2.717096867,(t161:4.214723894,(t162:3.705192354,t163:3.624761719):0.3218690535):0.253987671):1.516042302,((t164:3.104854296,t165:2.827317311):2.08468537,(t166:2.161064568,t167:2.116007584):2.723357799):0.4185818143):0.9272565438):1.066245947,(t168:6.408138705,((t169:3.41057066,(t170:2.288305176,t171:2.259465492):0.9584375676):0.5128613246,t172:3.333715963):2.341279252):0.6386489493):0.01716215188):0.8059220399):6.642942978):2.381791883,(((((t173:0.5575875332,t174:0.4974294877):2.000833338,t175:2.47234522):3.119863757,(((t176:2.092657613,t177:1.966022321):1.927884693,(t178:0.7100302872,t179:0.6254909017):2.910203111):0.7888993584,((t180:2.737938991,((t181:0.8636621996,t182:0.6978445007):1.392179294,t183:1.852936197):0.4532534972):1.016406861,t184:3.320624175):0.5422820492):0.7443896649):6.674401663,((((t185:0.8119426602,t186:0.7676513404):1.161454047,((t187:0.8751200104,t188:0.8311009567):0.2600389897,t189:1.051952874):0.7774274738):3.198173279,(t190:2.94786118,(t191:0.8440995774,t192:0.6620348262):1.912565244):2.032235078):4.126642563,(((t193:2.109585202,t194:2.091671181):3.770384369,(t195:1.697321266,t196:1.637918219):4.157937292):0.7339382938,((t197:3.102098622,(t198:2.510616797,(t199:1.328659286,t200:1.092830689):1.161214582):0.4016896633):1.166900186,((t201:0.9766623049,t202:0.9635922105):1.137394556,t203:1.980059972):1.367295111):2.091109716):1.962587209):1.966301588):1.891335728,(((((t204:0.99486403,(t205:0.7118475722,t206:0.5709993193):0.2812437118):0.6639065962,t207:1.453363137):1.588736367,(t208:2.659593048,(((t209:0.5525951296,(t210:0.5302221656,t211:0.5197848484):0.01346313879):0.4666724438,((t212:0.3942570524,t213:0.3603946013):0.3722578099,(t214:0.6081373217,(t215:0.5295683368,t216:0.3273502327):0.0400593478):0.1195052911):0.1406307897):0.3751769734,t217:0.7400178864):1.170652456):0.3284856014):0.08071978369,t220:1.789160864):7.546578643,((t221:0.1797273793,t222:0.1013375661):0.8427142156,t223:0.8768462856):8.274457291):0.3008171982):1.91470916):1.3457453):1.862946876):4.346060126):1.292973623,(((t224:0.3740090361,t225:0.3592689397):7.240526418,(((t226:0.3291734993,t227:0.2445504921):0.7847734717,t228:0.979249042):0.8905357318,(t229:0.2657299037,t230:0.2387158191):1.582908492):5.571282187):11.2303525,(((((t231:7.350428859,((t233:0.6129200329,t234:0.2261622023):2.127227361,t235:2.275959063):4.386525238):0.9164884119,(t236:0.8203996858,((t237:0.1898668294,t238:0.002473221827):0.4336174757,t239:0.3976466576):0.1838874901):6.655453722):0.9595079325,(t240:1.811631166,(t241:0.5303523368,t242:0.4821336586):1.027327767):6.355634191):2.285995607,((((t243:5.312539917,(((t244:1.106799882,(t245:0.7389433,t246:0.7260942107):0.3397488171):0.8052090437,(t247:0.5306802569,t248:0.1342961425):1.300314517):2.994309307,t249:4.235063433):0.3291158043):0.9947567944,((t250:0.6260977716,t251:0.6000180177):0.2460452315,(t252:0.2765571647,t253:0.1772280652):0.492225923):4.61284346):0.99408723,t254:6.193774146):0.5489745292,(t255:3.916145571,t256:3.745371354):2.817278222):2.19727446):6.663725329,((t257:7.046024177,(t258:4.431394228,(t259:2.105322043,(t260:0.2801634343,t261:0.2661011433):1.751010201):2.250058985):2.476213132):2.148360695,t262:8.84820116):5.879242451):0.4269801929):0.9877355458):1.111351204):1.547487924,(((t263:8.742881404,(((t265:5.746457428,(t266:5.199243538,t267:5.16108843):0.5029746573):0.8772273303,t268:6.249555003):0.09030524811,((((t269:2.688350284,(t270:0.4536443226,t271:0.2791972257):1.844068242):1.294809101,t272:3.334467905):1.539675509,(t273:3.964947664,t274:3.738721186):0.6766948096):0.7729593403,t275:5.027892281):0.03264180605):1.882825337):0.504058531,((t276:3.614483431,(((t277:2.211880478,(t278:0.6467971306,t279:0.5296596724):1.465112471):0.513905359,((t280:0.3022101396,t281:0.1826237692):1.676867064,t282:1.851480557):0.5124017972):0.8535742577,(t283:1.697013009,(t284:1.652052577,t285:1.548442016):0.04160224679):1.517032171):0.001170045185):0.296305801,(t286:2.433724114,t287:2.368835943):0.9438793027):3.520870819):6.374532678,(((((((t288:3.283133912,t289:3.255855223):0.5579461618,(t290:0.6734719499,t291:0.6147460126):3.040720684):0.721510397,((((t292:1.1798454,t293:0.9898415002):0.5992073008,t294:1.287940246):0.1465620067,t295:1.340977655):0.6675156182,(t296:1.378325129,t297:0.6578998751):0.2305875802):1.686329937):1.65677789,(((t298:1.412323024,t299:1.37904688):0.5373425673,t300:1.898076397):1.649024224,((t301:1.620295299,t302:1.603335351):0.6149892332,((((((t303:0.3595814178,t304:0.3536289949):0.1402316481,t305:0.4430073533):0.2006709075,(t306:0.1933568991,t307:0.17747695):0.3915904563):1.04344439,(t308:0.6588438185,t309:0.5685095055):0.8803005369):0.01676008421,(t310:1.315391159,(t311:0.2874617713,t312:0.2821946062):0.8536529951):0.0697918546):0.3295215247,(t313:0.2784394213,t314:0.05945725839):1.115041196):0.0254579576):0.9912622484):0.569139316):1.283466895,(((t315:1.218771617,t316:0.8854906453):0.4227175633,t317:0.9900076163):0.7706458369,t318:1.503139866):1.501601181):3.062804973,t319:6.044927796):1.168400629,(t320:2.093291006,t321:2.069356323):4.777402365):1.466075365):3.173624632):1.520460136,((((t322:7.44462591,t323:7.37535281):1.047353084,((t324:5.008022583,(((t325:0.3005879178,t326:0.2788722949):0.1549209675,t327:0.3550220983):3.71067938,((t328:0.289802773,t329:0.1722305166):1.491368715,t330:1.589230586):2.233448395):0.7720411848):2.955866842,(((t331:0.7145390372,t332:0.7032046892):3.02974278,t333:3.717552256):0.550998628,(t334:0.4063245538,t336:0.1040361556):3.765005971):3.21291752):0.231210482):0.08695947671,((((t337:0.3918185307,t338:0.2189142819):0.9935117911,t339:0.9974688199):0.04949977279,t340:1.025144153):4.411425111,(t341:4.267152476,t342:4.197514075):1.151090706):1.369121787):0.04705585693,((t343:4.359390509,(t344:3.812662431,t345:3.778560037):0.3436380362):1.965216357,(((t346:1.1511132,t347:1.145252867):1.004862446,t348:1.987778694):3.741859484,(t349:3.963658405,t350:3.822845785):1.754358347):0.1845102989):0.4026549324):4.146401929):1.273247827):2.763474348,((((t351:5.567294328,(t352:5.168736751,(t353:3.800316169,t355:3.486554024):1.237528679):0.2944915701):1.463047879,((t356:3.61185538,(t357:1.889493181,t358:1.879051325):1.642187282):2.12924481,(t359:2.869757018,t360:2.777037316):2.733739537):0.5754965004):0.4952678951,(t361:5.868402643,((t362:3.012159541,t363:2.995767033):1.179262556,t364:3.91557704):1.629294012):0.5382691408):1.905622,((t365:2.854085046,t366:2.675244485):1.409854834,(t367:3.676975019,t368:3.635199325):0.2519123639):3.506775383):4.906755983):2.402893023):18.15014677,((t369:12.4250381,((((((t370:2.12554473,t371:2.063638465):0.9662197552,(t372:2.812508733,t373:2.798893255):0.1471178):0.5747836109,((t374:2.475730582,(t375:1.317461707,t376:1.205242284):0.9587614778):0.2849353653,(t377:1.651085286,(t378:0.7505062579,t379:0.3344155506):0.8925192392):0.6171178534):0.7511722925):0.6430868233,t380:3.021582807):1.313859888,((t381:1.310808875,t382:1.297939161):1.566132741,t383:2.735908454):1.300972273):3.324342649,(t384:5.354081674,(t385:2.553026165,t386:2.540141728):2.749533652):1.938048848):3.474741203):1.570320917,((t387:1.596909583,((t388:0.8093704133,(t389:0.7220494817,t390:0.667577067):0.07601218238):0.2316939492,(t391:0.8976996005,t392:0.7840627114):0.07123412202):0.4886285592):5.129493376,((((((t393:0.6581191661,t394:0.5711843649):0.7916188128,t395:1.323692208):0.2187785208,t396:1.457655942):0.5041126875,(t397:1.940444249,(t398:1.119839524,((t399:0.376336019,t401:0.1090963739):0.1164126268,t402:0.2213498664):0.562868158):0.7643189542):0.0195397742):1.568917623,(t403:2.247898616,((t404:0.4228185238,(t405:0.159559326,t406:0.08944425984):0.18403467):0.9148927259,t407:1.145669844):0.8756141053):0.5500302932):0.1018457656,((t408:0.3207129901,t409:0.2229143418):0.8326378428,(t410:0.9159636448,(t411:0.380770949,t412:0.06327139009):0.3920937096):0.0463122645):1.483018074):2.593294595):5.365343473):18.67262559):9.316717684,(t413:3.114285567,(t414:0.06007272837,t415:0.0565608213):2.998625989):34.79397934):11.66757923,((t416:0.0896743386,t417:0.03421036377):1.590638347,(t418:0.3147313207,t419:0.2853680238):1.259225644):47.67975768):41.08787122,((((t420:8.191318134,(t421:2.234312774,t423:1.908425276):5.888038029):2.259909156,(((t424:7.288959375,((t425:2.492592005,(t426:2.044791134,(t427:1.921057944,(t428:1.157188333,t429:0.8846367604):0.6730194082):0.09411091218):0.3561008371):4.189515553,(((t430:0.4061262735,t431:0.3016023018):1.402603297,t432:1.115819303):0.2931559427,t433:1.332539746):4.083392657):0.5061973427):0.3459466492,(t434:2.869286789,t435:2.811972911):3.084136697):0.8166623926,(t436:1.34427674,t437:1.247000488):5.23351289):1.423771717):1.643120887,(t438:3.159865678,(t439:0.388364001,t440:0.26141672):2.597727188):6.249600328):7.310397054,(t441:9.570704805,(t442:9.27343678,t443:9.258627986):0.262381228):6.775173259):70.67540826);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T55.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
