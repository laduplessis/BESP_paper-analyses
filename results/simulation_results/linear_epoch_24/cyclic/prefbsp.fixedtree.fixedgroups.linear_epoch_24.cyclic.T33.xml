<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t469:29.75404758,(((t470:8.254072158,((t471:1.093426756,(t472:0.7944891577,t473:0.7048485277):0.2931927703):4.195334097,(t474:0.4289882135,t475:0.2322195926):4.689118443):2.819557079):19.46955707,(t476:22.42754225,((t477:4.747738217,(((t478:1.353179091,t479:1.341893427):0.7614159934,(t480:1.150808292,t481:1.121031054):0.8481000484):1.541178921,(t482:2.471361971,(t462:0.1289926865,((t448:0.3294792111,((t439:0.2748306811,(t440:0.09250499076,((t422:0.007659750279,(t358:0.2247603824,(t349:0.3187330258,(((t343:0.02806803686,(t342:0.0179677606,(((t308:0.003096421541,(((t241:0.03806784951,(t221:0.05312343374,(t143:0.002862312246,(t135:0.2485312158,(t134:0.1001396079,(t129:0.01432236857,((t72:0.04786768657,(t56:0.1582138781,(t39:0.3453443327,((t24:0.2247844249,(t22:0.009252515085,t1:2.216268333):0.2560775596):1.056834206,t2:3.309436254):0.447553627):1.549136332):2.173173806):3.266960923,(t3:9.231562941,(t4:3.905221685,t5:3.901271374):5.190285962):1.301054998):2.497520272):0.2765118182):0.4983262404):0.6000120527):7.599282138):2.558373974):1.019292516,(((((((((t6:2.70258731,t7:2.632136801):10.9763379,((((((t8:3.848867764,t9:3.817083496):0.1883433351,(t10:3.004334337,(t11:1.454826377,t12:1.036504848):1.515852412):0.9205661778):0.04517363355,(t13:2.326754415,(t14:1.723241867,t15:1.383436542):0.4084389488):1.001308382):1.231084598,(t16:2.478666377,(t17:2.292957191,(t18:1.897709354,(t19:1.119548739,t20:1.111775896):0.773543763):0.388114222):0.1594183534):1.511915526):1.208900989,((((t21:1.493616772,t23:1.345364571):0.8408300287,t25:1.947333833):1.353388095,((t26:1.918487905,(t27:1.085499461,(t28:0.6231057006,t29:0.4294166025):0.03436118732):0.788452703):0.3087793194,(t30:0.6000485889,t31:0.5129476747):0.9345284917):1.053016336):1.338494617,(t32:3.335238959,((t33:0.2558276721,t34:0.1610055401):1.117166841,t35:1.256674052):1.835061299):0.4967759617):0.1085999837):4.948822572,(((t36:0.08355039036,t37:0.05526568279):0.9552949455,t38:0.9533238125):0.01975896799,(t40:0.5212244258,t41:0.5197660799):0.06526824686):7.584921179):2.070730965):0.4510592283,((((t42:2.704637117,t43:2.608356719):6.03368994,(((t44:0.7884425088,t45:0.6114773554):1.686606389,(t46:1.489166895,(t47:1.35463382,(t48:0.8163521903,t49:0.426503729):0.5342033867):0.1041034113):0.8088280726):2.463869496,t50:4.296476309):3.647663391):0.6677390673,((((t51:7.136404706,(t52:0.2138893912,t53:0.2054439485):6.915083333):0.4831636813,(t54:7.203470204,t55:7.186673551):0.1294601755):0.3593891126,((((t57:1.559706592,((t58:1.396809388,((t59:0.2677558011,t60:0.2224070898):0.3351220661,t61:0.5165925183):0.7635791071):0.05789486211,(t62:0.4502153473,t63:0.3550876148):0.8758193322):0.08018798631):0.4060121869,t64:0.8820134216):3.88384394,t65:4.6902298):1.347195099,(t66:5.890294963,((t67:0.587216025,t68:0.2861052736):3.584614623,t69:3.776895296):1.602198647):0.07968124715):0.1111181794):0.3533022246,(t70:5.796942874,(t71:5.044303469,(t73:4.608442461,t74:4.511808917):0.357674073):0.6193721535):0.03485927126):0.1137515947):0.01284395754,(t75:2.842062742,t76:2.459876396):2.638764311):1.228138421):0.9607925381,t77:7.165367402):5.16279761,(((((t78:3.967162568,t79:3.933064133):0.09797962764,t80:3.804906001):1.050845787,(((t81:2.997533347,t82:2.818854205):0.2231673284,t83:2.997255659):1.15419064,(t84:0.1372569985,t85:0.08545603595):4.011038678):0.2697297847):1.714417704,(t86:4.889211177,((t87:1.949519241,t88:1.869739842):1.36874099,t89:3.069785825):1.525919366):1.11228921):2.56320059,((((t90:1.260750834,t91:1.189727134):0.5104537318,t92:1.62653616):0.5343385873,t93:2.143818197):1.050795792,((t94:0.9081510064,t95:0.9072843255):0.8679014124,t96:1.638134703):1.314463576):4.825472296):2.920718077):2.41842598,((((t97:5.84542905,((t98:5.458902285,((t99:0.8097806812,t100:0.8085086618):0.4185772613,t101:1.21686893):4.163121568):0.1250710869,((t102:1.941125533,(t103:1.018233689,t104:0.774132603):0.8523168649):3.264670831,((t105:0.9925663701,t106:0.8610763095):1.327240492,t107:1.841008976):2.288727049):0.2956606798):0.137235447):0.5256396862,((t108:2.793095881,(t109:1.982013062,(t110:0.3951768392,t111:0.2608889058):1.490996141):0.6509046596):1.377947655,(t112:0.7255913021,t113:0.6752109534):3.011327487):0.9061497377):5.855560982,((t114:2.849105726,(t115:0.6109624224,t116:0.5835480386):2.166441469):1.412613319,((t117:0.4849110614,t118:0.2473498295):2.243099114,((t119:0.4325040742,t120:0.1614413881):1.416331654,((t121:1.301779751,((t122:0.6257260863,t123:0.5618446644):0.06647883976,t124:0.4925389633):0.5746027614):0.003363634231,(t125:0.6000897949,(t126:0.3645636242,t127:0.3491155391):0.2044143333):0.279456132):0.219578265):0.6058419275):1.349486497):6.12463771):0.52578607,t128:9.491755142):0.3189946706):0.6304350138,(t130:0.6201060821,(t131:0.1208104917,t132:0.09715922705):0.4941154546):9.681484955):0.6049343106,(t133:4.475368346,(t136:1.240766428,t137:1.228441847):2.567343383):6.379355165):1.224505245,(((((((t138:0.917632369,(t139:0.1641831261,t140:0.1475184493):0.6191272958):0.5305306197,(t141:0.256447556,t142:0.1715440416):0.9273245259):0.6772553044,(t144:0.9698154884,t145:0.895169999):0.6050834096):0.1466103174,t146:1.379782006):5.179488132,t147:6.295879336):2.562230041,(t148:2.623396675,(t149:1.575650998,t150:1.547766248):1.036876775):6.1272895):0.3135566825,((t151:1.533493679,t152:1.532995681):4.292962401,((t153:1.546178209,t154:1.287593764):2.553702492,((t155:1.771754285,t156:1.585306084):1.545144534,t157:3.052965345):0.40650471):1.708812724):3.196715221):1.063613793):0.3097775226):3.836908612,(((((((t158:1.313474639,t159:1.238938837):4.908467314,((t160:3.17090398,(t161:1.262389072,t162:1.236041403):1.905121635):1.208053173,t163:4.258118663):1.579478058):1.107564054,(t164:6.291498191,(((t165:0.4110163928,t166:0.2042250673):0.6827797781,t167:0.8745971831):5.150261577,((t168:4.510185698,(t169:2.186276294,t170:2.089773924):2.273633074):0.199535432,(t171:3.016383444,t172:3.000751137):1.537885369):1.296112466):0.009441891964):0.3662201013):1.30188302,((t173:0.5640617567,t174:0.01220508194):5.927928894,t175:5.813864033):0.9008905352):1.054689593,(t176:5.244727799,((t177:2.627006535,((t178:0.4825569679,t179:0.4620577683):0.1724882639,t180:0.5759276534):1.772136348):1.287808347,t181:3.43329691):1.096851286):2.482579025):1.984364143,(((t182:1.747403273,t183:1.721310548):0.1566081818,t184:1.762962708):2.680205951,(t185:2.566331726,t186:2.549538858):1.850167319):4.351053207):1.350438026,((((t187:1.49669627,t188:1.489813966):2.167621695,(t189:3.289349134,t190:3.264196672):0.349912314):0.6112576174,t191:4.221407219):0.4406417048,((((t192:0.7862223113,t193:0.7420495507):0.282206016,t194:0.9331334699):1.727451786,(t195:1.830673853,t196:1.685547648):0.7493268325):0.8670959388,((t197:1.166635875,t198:1.162345528):1.911253451,((t199:1.883439075,t200:1.851990681):0.3060212933,t201:2.057943079):0.8063010789):0.2184177546):0.9950851681):5.193222225):0.3332716518):0.8238515007):1.261303925,(((t202:2.289309194,t203:2.106480005):1.241689797,((t204:0.9657028563,(t205:0.4889843108,t206:0.4772075059):0.3940513237):1.765821161,(t207:0.7451798328,t208:0.5995241421):1.68619501):0.55094313):7.513381724,((((t209:1.592036473,t210:1.353591097):0.1556022539,t211:1.190988179):0.1962245979,(t212:1.256564169,(t213:0.832401117,(t214:0.6407927103,t215:0.5769757303):0.1698797774):0.3752645095):0.1252791187):1.366611994,(t216:1.121766271,(t217:0.9661171789,(t218:0.4682314349,t219:0.4536524768):0.4596850987):0.07946227976):1.377651508):6.867123889):0.3460366271):0.807617808,((t220:2.002943854,t222:1.659861877):2.595010746,((t223:1.857081832,(t224:0.8606740439,(t225:0.5610214982,t226:0.5151007066):0.1137886909):0.9610183293):1.660170265,((t227:1.480494579,((t228:0.5795671451,t229:0.5705801212):0.05962787088,t230:0.5693475491):0.7749400488):1.368929909,(t231:1.942031113,(t232:0.3767106735,t233:0.3425266306):1.468011101):0.04883726846):0.2826646318):0.7189346088):5.774717309):1.116215613):0.2379307231):0.4660429589,(((t234:1.036586989,t235:0.8664940165):0.09376018148,(t236:0.3368679267,t237:0.1593782977):0.5458412864):7.6609178,((t238:2.323636374,t239:2.042942464):1.36148083,(t240:0.5002977181,t242:0.2462573349):2.83222259):4.674700261):1.618270118):0.4096464436,((t243:9.36050975,(((((t244:8.041721839,(((t245:5.046028682,(t246:2.413229297,t247:2.393164004):2.614644825):1.66738615,((t248:0.5535722859,t249:0.5215180456):1.013565483,t250:1.350956463):5.066409324):1.10688053,t251:7.522244689):0.2158490162):0.03386398203,(((t252:1.573322195,(t253:0.7412218953,t254:0.7089913184):0.7331809201):0.8378377781,(t255:1.349979221,(t256:0.4736849522,t257:0.3251893885):0.8601488424):0.8367472654):0.3573781945,((t258:0.6902073588,(t259:0.5245797477,t260:0.4989681357):0.06283589478):1.498676546,t261:2.054049568):0.126875787):4.924158551):0.2335969218,((t262:0.999430385,t263:0.8992956202):4.34165865,(t264:1.624836278,((t265:1.119067407,t266:1.102542868):0.06638145603,t267:1.159590137):0.4210851155):3.484528801):1.946598028):0.05331267083,(t268:5.108669039,t269:5.102956917):1.747823424):0.6350696124,t270:7.304417314):0.2929544987):0.3019702488,t271:7.708462541):0.04421603109):0.04671257324):1.044301585):4.868698606):1.822464446,(((((t272:0.104749903,t273:0.02749320156):0.6150179918,t274:0.4661840878):4.777506788,t275:5.182587478):3.953699896,((t276:4.213937055,t277:4.200937655):0.7305296087,t278:4.924373741):4.189973499):2.707700807,((((t279:4.412227845,((t280:2.981270913,t281:2.976677921):1.151691257,t282:4.123456657):0.2376740922):0.3452782172,t283:4.499461965):1.938219773,(((t284:0.3732142313,t285:0.1269842367):4.31855289,(t286:2.921097896,t287:2.914366636):1.168206287):1.496137602,(t288:4.787178816,(t289:1.770796666,t290:1.717416097):2.949715163):0.7704181944):0.1621317514):0.1874345045,(t291:4.50730472,((t292:2.813355145,t293:2.726506152):0.6481943218,t294:3.317666649):0.9375015486):1.11995496):4.914551157):3.190781808):0.876232678):0.04713063392):0.9851206868,(((((((t295:2.315557419,(t296:1.939760167,t297:1.69085352):0.2722084079):1.608294036,t298:3.568375885):0.08717161688,(t299:3.553605472,((t300:1.843904879,t301:1.740751508):0.1052061996,(t302:1.575770139,t303:1.434981836):0.1164015594):1.533143708):0.03750231012):2.02776391,((t304:2.496138607,(t305:2.257185588,((t306:0.3410788242,t307:0.2537747839):1.154786901,t309:1.242606368):0.7223828473):0.1906599266):1.636383938,t310:3.746273152):0.8576189106):0.7407639309,((t311:4.13396848,(((t312:1.731469713,t313:1.695072698):0.7996781248,t314:2.475141468):1.180782229,((t315:0.6994431278,(t316:0.1651889082,t317:0.1441212404):0.3154281767):1.129765483,(t318:0.5730444157,t319:0.2066360448):0.9472888713):1.723846357):0.3412133524):0.4565756067,(t320:2.217235939,((t321:0.02978961302,t322:0.02055794179):1.146544015,(t323:0.6999478408,t324:0.6285831851):0.3623322286):1.035576182):1.457042968):0.5969005433):6.138152266,(((t325:1.868241135,t326:1.832576384):6.259536456,(t327:2.19535714,(t328:1.491984755,t329:1.424551302):0.5503059779):5.686667884):1.759485375,(((t330:0.4412889561,t331:0.4012198598):1.542032821,t332:1.906142552):6.052592486,(t333:1.362131037,t334:1.350089545):6.573307956):1.172547885):0.2857215789):1.250654932,(((t335:0.447111147,t336:0.3564032852):4.557323169,((t337:1.692224367,t338:1.597845795):0.06083666508,t339:1.588686602):3.147197555):4.148324395,(((t340:0.5053983118,t341:0.1411023952):2.328090944,(t344:0.468033932,t345:0.3994344858):1.530755027):5.155065912,(((t346:1.591169328,t347:1.344040134):0.255410559,t348:1.599265718):2.400244623,t350:3.560257523):2.621693078):0.8732808288):1.37040481):1.148829077):0.09743526079):0.05857121791,(((t351:1.897716233,(t352:0.648078363,t353:0.6275350438):1.241711355):3.437266259,((t354:3.607645803,t355:3.442105189):0.5129823221,((t356:0.7116530398,t357:0.5425550319):1.585605897,t359:1.827214762):1.648564581):1.127208626):0.7013362254,t360:5.134822773):3.397205238):1.25804795):4.172290399):0.98848133):1.082337585):0.9905874412,(((t361:1.345996906,t362:1.305161396):4.861436598,(t363:5.343433099,(t364:2.653830217,t365:2.590413364):2.687048477):0.765450259):4.725561804,(((((t366:3.583249144,t367:3.477431747):2.462556066,((t368:0.1442193814,t369:0.09524236819):0.7901279908,t370:0.7255121685):4.821092922):1.273935313,(t371:4.202642793,t372:4.172048306):2.5792028):1.19391698,((((t373:0.3343865194,t374:0.2935686999):2.90109412,t375:3.078021048):2.056193054,(t376:0.8066235172,t377:0.6099407129):4.214280226):2.105338047,(((t378:3.268596234,(t379:2.714776996,t380:2.651314573):0.5462686079):1.921770675,(((t381:0.1627556524,t382:0.05566446122):0.1405299096,t383:0.1162428232):2.972761477,t384:3.048553742):1.72816041):0.9453824378,(((((t385:0.384793674,t386:0.2937619634):3.884275257,t387:3.995008506):0.6639922871,(t388:0.6630914155,t389:0.6013924097):3.970768769):0.03664677458,(((t390:2.602999703,(t391:0.5688798482,t392:0.4400115081):2.005813389):1.037426478,t393:3.413310701):0.7149241452,((t394:0.6050713325,t395:0.4769478842):0.3133250111,t396:0.7343539354):3.135900208):0.2374882083):0.3136194741,t397:4.268959135):0.4054165218):0.7572526657):0.5454847504):1.596219754,((t398:1.014487548,t399:0.8497902392):1.654789521,t400:2.45838776):4.749457694):0.4416580139):6.087272614):16.67709052):4.7120126):0.405601617,((t401:14.8921497,((((((t402:2.824419077,(t403:1.24639142,t404:1.242480614):1.540961447):0.06460615084,(((t405:1.165753668,t406:1.102682778):0.5057860986,t407:1.602628207):0.9465230464,t408:2.423784397):0.1419275143):1.027193053,t409:3.571343788):1.432661774,((t410:1.097650517,t411:0.9692014033):3.355263884,t412:4.314523674):0.5479692724):0.01660784171,((t413:0.9922386367,t414:0.8897234952):3.262457062,((t415:2.815302763,t416:2.736736356):1.256369416,t417:3.897245594):0.02203243102):0.5316333214):7.42289589,(t418:0.3060619877,t419:0.2924957294):11.55906063):2.083971557):0.837738636,(((((t420:3.301195685,(((t421:1.381957533,(t423:0.3100549354,t424:0.2265867836):0.9653383011):0.6752134462,t425:1.849056663):1.146089186,(t426:1.027622461,t427:0.5058316005):1.863780691):0.04709574282):0.2297249544,(t428:2.021087837,t429:2.014659524):0.2432617536):2.040859698,((t430:1.814620379,((t431:1.288586915,t432:1.281554758):0.3692651222,t433:1.537059478):0.01879841378):1.842839933,t434:3.299149745):0.5803694021):7.5423516,(((t435:5.62171037,(t436:1.99068373,t437:1.79401896):3.233524987):2.175379304,((t438:0.4509570076,t441:0.08266437178):6.392933557,((t442:1.617623379,(t443:0.2606549371,t444:0.1200324796):1.186655275):0.7224354854,t445:2.026302869):4.077986519):0.3553847743):1.965458827,(t446:1.308805355,t447:1.192579368):6.985536549):1.426996062):0.09842161596,(t449:0.78431802,t450:0.6836352929):8.441795672):1.482641183):19.6225427):1.550668468):30.19991565,(((((t451:1.526348544,t452:1.493205737):2.589266128,t453:3.984370735):1.698119176,(t454:1.595623073,t455:1.528265304):3.961734825):5.080592643,(((t456:0.2821614958,t457:0.05645771157):7.296592986,((t458:0.413094377,t459:0.2940470226):1.034169116,t460:1.249899535):5.88120479):1.762547982,t461:8.873897227):1.104350033):0.4177985218,(((t463:7.083485051,t464:6.92385629):1.036025742,(t465:2.376418634,(t466:1.013329732,t467:1.003721623):1.307994453):5.473265336):0.8439730922,t468:8.465320443):0.828791263):50.66255101);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T33.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
