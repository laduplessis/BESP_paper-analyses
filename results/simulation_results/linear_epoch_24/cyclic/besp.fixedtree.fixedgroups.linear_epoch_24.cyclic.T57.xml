<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((t452:1.810674599,t453:1.809963858):0.4658350263,(t454:0.1245163868,t455:0.03342645872):1.917542135):1.263305405,((t456:0.7835743197,t458:0.221490342):1.744616369,((t459:0.6886607264,t461:0.3356594261):1.064660142,((t462:0.6289843959,t463:0.4620992206):0.412476349,(t464:0.6985396151,t465:0.6183313545):0.1303415088):0.3481291517):0.1050024639):0.6487972129):6.074942277,(((((t466:0.6267026041,t467:0.515552352):0.3856752752,(t468:0.4131899317,t471:0.01001713046):0.4777660535):1.535779265,t472:1.650904654):0.4580009119,(t473:0.8127503414,t474:0.7918262873):1.194343256):1.257954595,(t475:1.440791037,t476:1.422915677):1.802965115):3.621387505):0.07911842216,((t477:1.21218055,t478:1.160708524):1.39773474,t479:2.547095046):4.278101508):2.538837258,(((t480:3.835865676,t481:3.656617595):4.545167754,((t482:1.8689364,(t483:0.1953504907,t485:0.104695413):1.602991691):5.729796282,t486:7.20773054):0.5054326629):0.9377603784,(t487:0.4544181744,t488:0.1556873297):8.022204385):0.01091030093):31.20679638,((t490:6.381786322,(t491:5.255291399,t492:5.231364723):1.098978961):18.04690892,(((t493:1.152322051,t494:1.150865208):13.32707326,t495:14.25772733):1.697705743,(t496:0.3198106057,t497:0.3115513414):15.61168527):8.145392203):14.43323477):5.53150272,t498:43.92142426):3.731583406,((t499:8.643220581,((t500:0.184672679,((t489:0.1918550136,(t484:0.04607931009,((t469:0.08743902529,t470:0.01703327661):0.0754829172,(t460:0.05811800417,(t457:0.2042839234,((((t357:0.324101943,((((t280:0.001898709835,(t279:0.0242828749,(t273:0.05277548965,(t272:0.1918495573,(t267:0.1087518639,((t248:0.001860088392,(t210:0.08388330599,(((((t167:0.1440477932,(t162:0.2033877138,(((((t53:0.1270598387,((t35:0.01252250519,(t1:1.623195979,(t2:1.229994177,t3:1.218618223):0.2869852786):2.066340075):1.28981062,((t4:2.899621496,t5:2.600379183):1.467686547,t6:4.00349343):0.4714937909):0.4256330893):1.374446628,(((t7:2.003571715,t8:1.805995417):0.09322203177,t9:1.670953182):3.401681433,t10:4.488605978):0.7546778449):4.911512358,(t11:4.732654959,t12:4.306891155):5.388809768):0.3354966901,((t13:0.7546195013,t14:0.7062746354):2.90629276,(t15:2.756546633,(((t16:2.395178151,(((t17:1.090649794,t18:0.9752452077):0.4547462624,t19:1.36190689):0.3081692741,t20:1.637234486):0.5372629835):0.1272304122,(t21:1.718785793,(t22:0.7911981595,t23:0.7413421207):0.9193472072):0.4125699447):0.01794121203,(t24:1.946591278,(((t25:0.6992544906,t26:0.5775071445):0.1345325737,(t27:0.5787396703,t28:0.5672884781):0.1139749):0.6075522259,t29:0.922091262):0.4448072751):0.08659741923):0.1913807471):0.8270089147):6.36658703):0.8315805349,(((t30:1.342166407,t31:1.330227152):0.5514865838,((t32:0.2104144886,t33:0.1962249524):0.9896783356,t34:0.9501027032):0.6670133306):6.56111748,t36:8.101235739):1.059133261):0.7525332826):0.643283734):0.255431261,((((t37:4.359728117,(t38:0.8466546505,(t39:0.1620041557,t40:0.1563305293):0.51930132):3.390263769):3.950358079,(((t41:0.7239183793,t42:0.6986733205):0.3611216677,(t43:0.7066279677,t44:0.167771575):0.3029615201):0.3538297854,t45:0.6147504242):6.542080367):1.202097863,((t46:4.047940983,((t47:0.4337331011,t48:0.4198849812):0.3794834677,t49:0.7492419341):3.20326309):4.086138822,(t50:4.905624621,((t51:0.1139780388,t52:0.06429303602):1.014932722,t54:0.8496717228):3.738641292):3.118729775):0.06180551564):0.3490141036,((t55:1.859453243,(t56:1.330651147,((t57:0.1914127308,t58:0.1506180514):0.1131923453,t59:0.192628089):0.9872333744):0.4767545346):5.061840344,((t60:0.7791608163,t61:0.7240654208):2.52084012,(t62:0.08328945188,t63:0.005994074961):3.103309438):3.354129826):1.152335433):0.9136034899):0.560273524,(((t64:4.110289067,(t65:1.211340139,t66:1.180991605):2.862778489):3.88990302,((((t67:3.558031887,((t68:0.588945974,t69:0.5823385691):1.601913129,t70:2.094900399):1.230991199):0.5619442539,t71:3.82519269):1.197418367,(t72:0.3699463534,t73:0.2418999437):4.58719092):0.1158453971,t74:4.933750862):2.318698567):0.3142789683,(((((t75:0.3643416998,t76:0.2712050539):0.5306316642,t77:0.7767633007):0.4576686815,(t78:0.7705929414,t79:0.6959258467):0.447156822):5.405441137,(((t80:0.3213280837,t81:0.2812971782):3.791167119,(t82:1.392323388,t83:1.380579775):2.579007799):1.033891044,(t84:0.1415107408,t85:0.04548570975):4.802681286):1.389017138):0.05280135538,(t86:5.445915867,((t87:3.606051007,t88:3.527990173):0.7589450345,(t89:0.8258483623,((t90:0.2890626372,t91:0.2254974584):0.07971412226,t92:0.2972469054):0.3588201553):3.398211578):1.065286042):0.8175584888):0.6037725793):0.7118250919):0.4852146998,((((t93:3.68521,t94:3.621011026):2.330138619,(t95:4.168411414,t96:3.971362634):1.769261732):0.2565671864,((t97:4.282699164,t98:4.19336885):1.567759979,((((t99:4.510316729,t100:4.494470287):0.178448347,((t101:0.8457810456,t102:0.7298210711):2.846509205,((t103:0.2437960318,t104:0.2339994939):2.49603871,t105:2.721669014):0.7975398079):0.9386953718):0.2863155061,(t106:2.546777493,(t107:0.3817864895,t108:0.3593354324):2.080220075):2.034019356):0.4800535577,((((t109:1.094285765,t110:1.065667913):2.315541146,t111:3.36136821):0.9838675733,(t112:2.550650832,t113:2.487670424):1.7101646):0.4549833878,((t114:1.166022875,t115:1.020205776):1.85098361,t116:2.835368851):1.550706258):0.0714410039):0.2348453002):0.08130408021):0.7989587823,t117:5.345504157):0.5685628958):0.08350780817,(((t118:2.554812643,(t119:1.654832775,(t120:1.34990995,t121:1.321358497):0.2708658275):0.8386304254):0.4366758862,(t122:1.387646111,t123:1.355502893):1.449118155):1.470992175,t124:4.272387774):1.469389108):2.631142878):2.826288772):1.19428045,((((t125:2.541482584,(t126:0.7158483203,t127:0.6760553407):1.734366466):1.090796631,((t128:2.057882081,t129:2.03844295):1.063222101,(((t130:0.2029127707,t131:0.1056839843):1.48644075,t132:1.545776411):0.1923111986,((t133:1.141080549,t134:1.136309759):0.1370119281,t135:1.232368759):0.4578992809):0.879866506):0.3309829516):1.804139113,((t136:3.961963673,((t137:2.602032014,t138:2.583163374):0.8146001611,(t139:1.001218584,t140:0.8653740619):2.248322685):0.3912541787):0.449636046,(t141:2.408834354,(t142:1.202181559,t143:0.9651052965):1.131100323):1.366800065):0.1286290274):0.9547954103,((t144:0.8633041855,t145:0.823025585):0.8501043748,(t146:1.009884471,t147:0.9559610189):0.5001395612):2.793394415):5.850665419):1.193023869):0.4484512777):0.1951019171):0.5703605561):0.004898252689):2.622000253,(((t148:2.750787967,t149:2.595729826):0.04618269512,(((t150:0.8018107186,t151:0.4902913068):0.9209193968,t152:1.339603369):0.1656674326,((t153:0.7177454541,((t154:0.2404681875,t155:0.1617106504):0.3233668275,t156:0.4728414332):0.1386084185):0.0171232199,((t157:0.2551621001,t158:0.1486376205):0.03630212373,t159:0.09594993135):0.2647717163):0.6403978968):0.7224890875):9.858708846,((t160:3.284509069,t161:3.237540141):7.407494002,((((t163:1.026554896,t164:1.018085545):1.130132335,((t165:0.3157538852,t166:0.2650786988):1.531796681,t168:1.517861401):0.257208847):3.627792224,((t169:0.6870354176,((t170:0.4331424723,t171:0.4086727139):0.1633760657,(t172:0.2983457186,t173:0.2158140038):0.2686342638):0.01134036062):1.143733949,(t174:1.000992097,t175:0.9692829929):0.5896243225):3.453375386):3.115095014,(t176:7.263802463,(t177:0.2870209637,(t178:0.2379819006,t179:0.1784907221):0.004740871065):6.784825675):0.6664409268):1.140211556):0.8794399318):2.429766951):4.504680204,((t180:8.070514895,(t181:7.490879958,(t182:7.077471069,((t183:0.3349242721,t184:0.2188096008):1.364759341,t185:1.581043872):5.27155073):0.2832842093):0.4529253147):4.075706001,((((t186:4.720076694,(t187:0.9272687031,t188:0.7554476788):3.710435777):2.590188565,(((t189:4.564301639,(t190:1.614379987,t191:1.496836996):2.64748338):0.7892935615,t192:4.787782286):0.6388569047,(t193:2.731741923,t194:2.691687049):2.663494322):0.9879738531):1.152394391,(t195:3.575127313,t196:3.484767709):3.894573734):1.022234921,t197:8.048737914):2.083054749):4.330539856):1.412764765,(((t198:9.706458066,(((((t199:3.64812855,t200:3.623307692):2.005189173,t201:5.509053462):0.3790799006,((t202:3.273048645,(t203:0.9944596658,t204:0.9698037812):2.244309507):0.5355566599,t205:3.682807746):2.069550118):0.2328211771,((t206:4.242540198,t207:4.147747046):0.9258289092,t208:4.836621412):0.7893118642):1.882002749,(t209:5.815370078,(t211:3.716217249,t212:3.686888406):1.673405575):1.631670779):1.476780764):1.160047379,((t213:5.418798774,t214:5.225782528):0.6471944495,(((t215:3.916206294,t216:3.78918931):0.8666437624,t217:4.633968226):0.9614648004,(t218:5.041994235,((t219:1.372887178,t220:1.324549235):3.458425483,t221:4.779931615):0.1827137593):0.549629122):0.07267618581):3.449212968):0.9217969413,(t222:9.726947014,(((t223:1.105744617,t224:1.02567921):1.504508821,((t225:1.585114503,t226:1.49039987):0.2045943705,(((t227:0.5221641446,t228:0.5100619398):0.1982177084,t229:0.6907054892):0.4606243832,t230:1.13785149):0.4777491076):0.6438898773):2.923832834,((t231:0.354016096,t232:0.258365702):0.7753599638,t233:0.9779130662):3.978412686):4.090091872):0.1607801599):4.054935334):0.3201217635):1.32683878,(((((t234:2.587590773,(t235:1.349363123,t236:1.262732038):1.22976988):2.204953299,((t237:2.145848973,t238:2.137063901):1.444295097,(t239:3.00244895,(t240:2.946893591,t241:2.888808746):0.004186939214):0.4815259532):1.080671888):2.574594421,((((t242:2.735825212,(t243:2.344164128,(t244:0.3540373528,t245:0.2351030497):1.925582295):0.3516605313):1.780490533,(t246:2.403468076,t247:2.041934617):1.872052342):0.08525244587,(t249:0.8451584533,t250:0.8104285581):3.028053255):0.7250980671,((((t251:0.6954615296,((t252:0.2635689696,t253:0.2538070172):0.06958241983,t254:0.2179851206):0.2514456928):0.2608603122,t255:0.4559021534):2.425709,((t256:1.947316184,(((t257:0.09344533733,t258:0.0646290434):0.8448230757,t259:0.8785418996):0.5497577022,t260:1.089802541):0.4360136446):0.05081751103,t261:1.502450175):0.6040961217):0.2116951749,t262:2.170873654):0.9045990608):1.680998471):0.5911271452,(((t263:3.726284225,(t264:2.705227265,t265:2.671111094):0.9330602383):0.1997329234,(t266:0.6096858065,t268:0.3127704956):2.88363891):0.3774648499,((t269:1.258726996,t270:1.215353471):0.5312889585,((t271:0.6834696028,t274:0.2275471753):0.352427668,(t275:0.3859208597,t276:0.3416839948):0.1581198477):0.6077371807):1.73750701):0.8996227368):5.789936743,(((((t277:0.2248182011,t278:0.1666410121):0.5430704098,t281:0.2599637174):1.008105558,(t282:0.2890708079,t283:0.04741476529):0.7486636962):5.739091752,((((t284:0.6000370422,t285:0.4619977015):0.6831043342,((t286:0.4635105979,(t287:0.3830282601,t288:0.3068215974):0.06015863657):0.3363977677,t289:0.6203247686):0.2117194025):2.966893829,t290:3.743128909):1.376641766,(((t291:0.7677123246,t292:0.2722704408):2.918295584,t293:3.035955471):0.8365598824,(t294:0.7630577016,t295:0.251437798):3.070149367):0.5136687682):0.8990648705):0.4269402916,t296:5.048811619):1.512928236):1.082406392):7.99126779,((((t297:5.714804622,t298:5.698145387):2.065113952,(t299:3.105466476,(t300:1.192382437,t301:1.109617905):1.76336293):4.428995831):2.05063573,(t302:4.446239059,(t303:1.42496346,(t304:0.5113484562,t305:0.4863937712):0.9027782005):2.920237237):4.894425906):3.270377102,(((t306:3.242522862,t307:2.95470822):1.182134776,t308:4.06967838):1.288130103,((t309:0.5812405633,t310:0.367098962):4.388178056,t311:4.720372514):0.2568057954):6.743243514):2.474915175):0.09916788296,((((t312:6.478800853,(((t313:1.559033275,t314:1.409799128):3.249855475,(t315:2.528345431,t316:2.504579157):2.02047438):0.72108197,((t317:0.2631069161,t318:0.2627623039):2.357164278,t319:2.593864914):2.533525067):0.8671411413):1.9109328,((((t320:1.404059004,t321:1.374507784):2.721167279,t322:4.0880136):1.115968969,((t323:1.316568132,t324:1.304271802):0.8749021841,t325:2.152331442):2.993631695):2.43250298,(((t326:1.592902519,(t327:0.2254992849,t328:0.2216596035):1.151481063):1.496727842,(t329:2.395643946,(t330:0.466165456,t331:0.0810176954):1.9054404):0.47180816):3.462132728,(t332:2.835328663,t333:2.767260959):2.863191097):0.8802119146):0.09453664109):1.183893027,(((t334:2.461031337,((t335:1.002395629,t336:0.9247394648):1.197516791,((t337:1.332615941,(t338:1.024543746,t339:0.789793484):0.2523424392):0.5257015532,t340:1.144686009):0.2004411122):0.2548125159):2.415695987,((((t341:1.194974268,t342:1.167177851):0.4993132939,((t343:0.8097569044,t344:0.7855982548):0.7367513562,t345:1.456500008):0.02016409199):0.4280041268,(t346:1.060026381,t347:1.004712399):0.7660152756):1.579294989,(t348:2.035657206,t349:1.996812474):1.22018689):0.03393132066):0.3680689131,(((t350:0.2160764548,t351:0.192086233):0.6553046248,t352:0.7629532608):0.07001354878,t353:0.7146004405):2.664809685):2.524034604):0.5773814778,(t354:2.266466075,t355:2.080113078):4.127203787):3.915659096):0.4572493829):0.4650014963):1.051408186):1.176956773):1.156840758):0.1077433381,((((t356:8.625510083,(((t358:2.279973125,t359:1.764879994):1.813305962,(t360:2.541680307,(((t361:0.1164945588,t362:0.04106563334):0.3237976383,(((t363:0.04614950999,t364:0.01363711015):0.001837883849,t365:0.01019840528):0.130133935,t366:0.1138589792):0.06639405606):0.8772608971,(t367:0.6436420041,t368:0.616265886):0.410584585):1.220867572):0.8868572244):0.6816170427,t369:3.731699774):3.343566349):1.821629213,(t370:7.069665707,((t371:1.804692131,((t372:0.1379432611,t373:0.0438970474):1.169219155,t374:0.9319112422):0.2255684319):0.495568838,(t375:0.4528905113,t376:0.368643583):1.171032125):4.753862366):1.803708051):1.543824519,(((t377:1.125150764,t378:1.061062745):4.033171214,(t379:3.09496769,t380:3.057962905):1.850253929):2.216483709,((((t381:2.158222372,(t382:1.120522525,t383:1.11497061):0.9118733197):1.383839192,t384:3.297782207):0.1671383668,t385:3.395144869):1.886751777,(t386:4.673449233,t387:4.28273558):0.6034045832):1.305141054):2.147387147):0.7461195069,((t388:6.65225195,(t389:0.1051677924,t390:0.07497581812):6.447687539):0.008711240797,(t391:5.367799305,(t392:3.968962484,t393:3.923229468):1.313275099):0.8560449099):2.3689763):1.536627347):0.6567461491):2.26895545,(((((t394:1.194355992,t395:0.885468459):3.166523948,t396:3.962476867):2.605523685,((t397:5.726082122,((t398:4.35776593,(t399:0.926429494,t400:0.9046553692):3.361894851):0.3279165102,(t401:2.950618573,(t402:0.2307266928,t403:0.002286123073):2.556217171):1.641467218):0.9857638514):0.5510710859,t404:5.692345802):0.2645815041):1.542524496,((t405:2.467563737,(t406:1.97686615,t407:1.906632133):0.4786681278):4.147112618,((((t408:3.586994138,t409:3.574023471):0.9422056073,t410:4.301936572):0.4053100688,t411:4.543230038):0.1847446367,((t412:3.058170094,t413:3.022812024):1.203128015,t414:4.190547162):0.1847843409):1.345180092):0.8262245871):0.1509209996,(((t415:0.6463868268,t416:0.5966386687):3.81893525,(t417:3.493524956,t418:3.39952679):0.9015193263):0.5238842001,((t419:2.850965039,(t420:1.93770328,(t421:1.756399262,t422:1.745597815):0.1198058417):0.8993720197):1.570451926,((((t423:1.304206304,t424:1.25945556):0.4475501651,t425:1.706242601):0.9979139975,t426:2.699694058):0.2970555507,(((t427:0.2701933442,t428:0.1065083842):1.703668461,(t429:0.1168285448,t430:0.04909256077):1.624408335):0.9080940646,((t431:1.110355128,t432:1.085038753):0.2804393615,t433:1.340077745):1.090345475):0.06599785836):1.264227069):0.3408322981):1.421597485):4.12608156):6.182491842):17.89081344,(((((t434:2.326706401,((t435:1.2715172,t436:1.147527739):0.0659421562,t437:0.9007799752):0.7882501306):0.6889303198,(t438:0.7209739951,t439:0.6359616756):1.634233211):1.277501143,((t440:0.4656198288,(t441:0.3114468768,t442:0.2656025687):0.1325631013):2.748834616,(((t443:0.04865452443,t444:0.006930393914):0.5424791906,t445:0.3628082093):1.914496606,t446:2.221353653):0.4401396838):0.3317345386):0.2716264818,t447:3.046726018):3.310195523,(t448:2.192291135,((t449:0.3334669545,t450:0.2082920694):0.5954836088,t451:0.7524375303):1.169327081):4.126267889):25.79338949):21.11053244);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T57.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
