<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t471:28.4713257,(t472:3.426042154,t473:3.317928713):24.98583037):0.2418193964,(((t474:7.439493979,((t475:0.3390528039,t476:0.2817496975):4.544206995,((((t450:0.04335194928,(t438:0.4317587268,(t439:0.0837912099,((((t363:0.1502607968,((t346:0.02606656434,((((t275:0.1270229704,(t253:0.1701173708,((t252:0.1439527404,((t245:0.2259976641,(t235:0.0842601109,(t233:0.2172338465,(t163:0.07846578722,(t148:0.06024119205,(t133:0.201228434,(((t81:0.07284762031,(t24:0.168304592,(t21:0.03524453576,t1:2.222107298):0.674667798):6.685990103):3.424145991,((((t2:3.173895854,t3:3.11516283):2.42853597,((t4:4.908350618,(((t5:2.133188272,t6:2.09298442):0.3040371336,t7:2.344524456):0.3127117521,t8:2.645802188):1.996515047):0.2999461169,(t9:4.04666887,(t10:3.14744807,t11:2.968992883):0.8958497523):0.8137291625):0.2446994995):2.135400603,(t12:3.61294754,t13:3.488266242):3.317771174):4.046623353,((t14:4.693538452,(t15:2.331588546,(t16:0.9057875154,t17:0.6732000582):1.346488075):2.304536487):0.4974035593,((t18:0.4753669114,t19:0.4741101466):0.2246063516,t20:0.5418690994):3.877109252):5.218321261):1.190480956):1.593886297,((t22:1.780171059,t23:1.737861135):8.125254982,((t25:1.678249043,(t26:1.303933282,(t27:1.093791689,t28:0.9628799564):0.08798604238):0.3148601448):2.377669445,(((t29:1.0846104,(t30:0.6814169852,t31:0.541348762):0.2748621028):0.1589959913,(t32:0.469081867,t33:0.4543414315):0.181737916):0.01677978976,t34:0.400953147):2.448895886):5.365909141):2.13672669):0.1193430529):1.800659391):1.402661413):5.162905766):0.3365029782):0.9525197274):0.3581461079,((((t35:1.611601446,t36:1.528671015):7.203522175,((t37:3.460449552,((t38:0.8720991462,(t39:0.4540225893,t40:0.3741590475):0.1909112002):0.1203712194,t41:0.6121934766):2.457384352):4.445102987,(((t42:2.734312559,t43:2.539055848):1.861916131,((t44:0.9860715386,(t45:0.5675458915,t46:0.4265037172):0.3635675681):2.672382885,(t47:0.4453259087,t48:0.2950933008):3.000875552):0.6530656089):2.677221056,(t49:1.700269822,t50:1.641417851):4.87546577):0.1005823931):0.4199468085):9.140232544,(((((t51:3.188690171,t52:2.740342657):1.990096819,t53:4.675307538):1.440026645,((t54:0.9107309019,t55:0.871641042):1.740398962,t56:2.524839761):3.283993066):2.92566671,(t57:6.030749483,(t58:2.833307957,t59:2.78537935):3.080686398):2.357402912):2.429157268,(t60:9.336387959,(((((t61:4.624679387,(t62:1.490996494,t63:1.4688251):3.064299165):1.012886398,t64:5.408185816):1.062537384,(((t65:0.9699060638,t66:0.8638931127):0.03132984686,t67:0.7648565196):2.226960704,t68:2.872615935):3.190044916):0.6110329297,((((t69:0.2266711864,t70:0.110248082):0.8872232229,t71:0.9827248448):3.463145621,(t72:3.202915112,t73:3.185014401):1.085003802):1.494142567,((t74:1.097960533,t75:0.9738801784):4.136939653,t76:5.097089213):0.5200403324):0.5774691282):0.5588097502,(((t77:1.161679426,t78:0.7835969935):0.554010119,t79:1.329483604):4.611449162,(((t80:5.435156596,(((t82:2.907411557,t83:2.900002407):1.118940958,(t84:2.504502859,t85:2.440250586):1.453050497):0.6867709661,(t86:4.256354666,(t87:1.419927605,t88:1.412348737):2.770336871):0.2972718274):0.1983094004):0.1400240365,(t89:3.596022372,(((t90:0.5427098284,t91:0.3555287728):2.389908572,t92:2.731862351):0.502097973,(t93:2.817187337,t94:2.611426979):0.2913275851):0.1612310251):1.152530078):0.1095284167,(t95:4.08203688,(t96:1.22783869,t97:1.209829275):2.779543488):0.1653525256):0.2088246256):0.3148494133):1.439080845):1.296870635):4.181086911):2.39040874,(((((((t98:2.491912529,t99:2.367186834):0.6943084581,t100:3.050977027):0.3169366044,((((t101:2.015831469,t102:1.867331702):0.2739941412,((t103:0.4579357331,(t104:0.3276408126,t105:0.1878699062):0.09180054731):1.460962076,(t106:1.285039342,t107:1.17108389):0.3621163363):0.1787802297):0.1732658724,(t108:0.6271761413,t109:0.5748665649):1.219551094):0.09486844384,t110:1.677501417):0.3778866791):0.4946895709,t111:2.487613152):1.551039841,(t112:0.6164881307,t113:0.5850422265):3.178523019):0.7616942344,((t114:2.179553061,(t115:0.8733054403,t116:0.8319020605):1.168968965):0.5527747775,t117:2.533817473):1.73740936):5.161437407,(((t118:2.920578661,(t119:1.656854043,(t120:0.8390649411,t121:0.8349468785):0.8000372602):1.199182508):0.215115745,(((t122:0.7866291746,t123:0.1388842875):1.306162549,t124:1.434187695):0.2224177789,(((t125:0.1835677231,t126:0.004674267782):0.4850351633,(t127:0.3336423619,t128:0.2500855199):0.09831872489):0.1871361828,t129:0.5142465146):0.6439214237):0.7298607203):6.286082573,(((t130:0.4179112582,t131:0.3882166698):1.53049187,t132:1.883641975):0.6933263176,t134:2.327749767):5.233533934):0.008157387868):2.299479542):0.1117498067):0.6187265602):0.2521368505,(((((t135:2.724347112,t136:2.591178079):4.812752948,(((t137:3.08154406,t138:2.959118456):3.762176936,(t139:3.820243683,t140:3.600227552):2.763889522):0.1664803737,(((t141:0.5032037189,t142:0.3388863653):5.245550525,t143:5.582624503):0.2645057894,(((t144:1.069563481,t145:0.8107272543):0.110000926,t146:0.8094933673):0.8654815409,(t147:1.093729923,t149:0.8612464902):0.5352826955):3.715160235):0.5049876477):0.140668805):2.008855264,(t150:7.525420421,t151:7.337748274):0.1609773899):0.03044226717,((t152:5.807521888,((t153:4.557816996,(t154:4.43725717,t155:4.400344895):0.1019920273):1.121767733,((t156:5.383422018,(t157:4.709184809,t158:4.401877519):0.4593920039):0.02593783539,((t159:0.3107812084,t160:0.272689947):2.888211885,(t161:0.6955733109,t162:0.5960281874):2.380718052):1.65591269):0.1524148927):0.02476375239):0.5237264344,((t164:3.815947938,(t165:3.235781676,t166:3.169198144):0.5247546606):0.1414816138,t167:3.818826491):1.274477293):1.183324479):0.3168863679,((t168:3.389232085,t169:3.174927299):1.467915999,((t170:1.903154165,t171:1.889531489):2.43055009,t172:4.295878831):0.1863111108):1.418777916):0.9356235885):0.03435845741):2.397159862):3.069853198,(((((((t173:3.027012898,(t174:1.514045035,t175:1.482120659):1.482112913):0.4160607932,t176:3.198880639):1.442603374,t177:4.616754022):0.4169859385,(((t178:1.002642143,t179:0.988332389):2.366668012,t180:3.331536477):1.395202529,t181:4.665922971):0.2504235747):0.009573659488,(((t182:2.21500162,t183:2.148551821):0.03474032343,t184:2.097782275):0.5186671366,t185:2.58519297):2.067841081):0.3745984635,((t186:2.42914998,t187:2.36852497):0.3854850363,(t188:1.873094216,(t189:0.9886625881,t190:0.8861844122):0.8482785099):0.8262688005):2.148875198):0.7193855728,t191:5.427217931):5.892804117):2.156022483,((t192:3.497188765,(((t193:0.3368160459,t194:0.2812899309):1.476290207,(t195:1.524260159,t196:1.506146045):0.1532564729):1.187643942,(t197:1.943744934,t198:1.856282165):0.837848676):0.3990591615):4.311642062,(((t199:3.032810075,t200:2.908780069):0.3676953611,((t201:2.466170706,t202:2.43405855):0.6012365734,(t203:1.949391325,((t204:1.039380256,t205:0.8915488415):0.3989600733,(t206:0.900887612,t207:0.791925687):0.3857993506):0.5101011015):1.06034025):0.1957508813):1.520763376,((t208:2.243940942,(t209:1.237010429,t210:1.005966714):0.9766629238):0.0003440102493,t211:1.661232395):2.216171826):2.41954182):5.581182833):1.343679633,((((t212:7.371918865,((((t213:1.911955476,(t214:0.9724463821,t215:0.620331585):0.9016870587):0.4759855004,(t216:0.6846600906,t217:0.5182312866):1.293682074):2.37523206,((t218:1.075907098,t219:1.03173713):0.8081699866,t220:1.808640877):2.299902281):1.075531104,((t221:1.485489267,t222:1.370561468):0.2263038937,(((t223:0.2549466108,t224:0.2539032939):0.4047477413,t225:0.6402711737):0.4841297973,t226:1.088125018):0.3853769687):3.459013393):1.497387279):0.1891164987,(t227:2.935838053,(t228:1.969993698,t229:1.938338507):0.8914044006):3.624648212):1.472725357,(t230:0.07800069892,t231:0.05997929744):7.748183429):3.034273271,((((t232:2.44501621,t234:1.935807):2.94076924,(t236:1.691422035,(((t237:1.50030436,t238:1.436227179):0.02962521603,t239:1.440699829):0.06108937656,(t240:0.276969061,t241:0.1882438359):1.129307762):0.06851284578):2.795382402):0.7413952515,(((t242:0.6857980594,(t243:0.5866045125,t244:0.5767771823):0.09190782197):0.4586014047,t246:0.741859476):0.2625357709,t247:0.6333377179):3.416941703):4.537771031,(((t248:1.853495125,t249:1.822479595):5.17350408,(t250:6.292371105,t251:6.225094355):0.6984940114):0.08420574696,((t254:1.685848459,(t255:0.8548898854,t256:0.8240607357):0.6748094801):1.79562446,t257:3.280279197):3.013373221):1.268783521):0.0189160338):1.106277121):0.3900286939):1.715902549,((((t258:0.300009447,t259:0.2594689665):2.711641227,(t260:2.215325215,t261:2.082808604):0.6096210542):6.51879274,(t262:7.706823959,t263:7.473062065):1.405780746):0.7131193326,((((((t264:3.37014871,(t265:0.23233107,t266:0.2149126226):3.08806088):2.11570506,(t267:3.976110331,((t268:3.100750269,t269:2.922573448):0.2577980382,(t270:2.505216879,t271:2.307560099):0.4308503351):0.5814514095):1.405481205):0.9511824722,(t272:1.684478109,t273:1.625298248):3.937321607):1.557044911,(((t274:5.55208357,(((t276:1.296801434,t277:1.269974137):1.760158184,(t278:1.917200659,(t279:0.4372901215,t280:0.2214352746):1.308225917):1.110594141):1.392743898,t281:3.88541844):0.5886176359):0.4897924168,(t282:0.1227975797,t283:0.009753568334):4.584510611):0.384115868,((t284:4.37671549,(t285:2.0939339,t286:1.998430106):2.238995706):0.05054174188,(t287:3.360001974,t288:3.280913458):0.8253616621):0.4131427773):0.6717866814):0.361581526,(((t289:2.756195013,t290:2.75443436):1.479633134,(t291:3.016695593,((t292:0.7506443779,t293:0.731217959):1.513456888,t294:2.223416499):0.7213107102):1.205661874):0.04558708909,(t295:2.650212821,t296:2.555680851):1.534669388):1.26475524):1.060430651,(t297:3.828174932,((t298:3.332456395,t299:3.067635965):0.3402867742,((((t300:1.666595998,t301:1.611680989):0.7419877912,(t302:0.7273937306,t303:0.5984509462):1.343347313):0.4776987643,t304:2.274226345):0.410653633,((t305:0.7927437601,t306:0.5397564866):1.209352668,(t307:0.8592758819,t308:0.8472106385):0.8347288614):0.5781901236):0.09818786147):0.1151522893):2.487560562):0.1172983955):0.2501771126):0.5084681515):1.070573313,(((t309:2.626120633,(t310:1.48502374,t311:1.336540022):0.8976190284):0.6062099435,(t312:1.80779658,((t313:1.090309786,(t314:1.041073377,t315:1.026021024):0.02224219859):0.3577873419,t316:1.035581902):0.3562505628):0.8415061131):2.684622516,((((((t317:0.2829092325,t318:0.2330368029):0.3468687948,(t319:0.3721432346,t320:0.276267767):0.07675951967):0.8090530682,t321:1.077363977):0.7352355865,t322:1.624029219):0.4209220065,(t323:1.393052419,t324:1.349499388):0.6354502512):0.777482842,(((t325:0.5005729378,t326:0.4784460932):0.1994256674,t327:0.6626429164):0.6951553458,(t328:0.903030348,t329:0.7495615552):0.3914664981):1.338199966):1.38930199):0.716334314):0.7530458457,((t330:3.293453539,(t331:2.635505751,(((t332:0.3491505304,t333:0.2679721949):1.34912575,((t334:1.187192862,t335:1.175111375):0.2857877289,((t336:0.05723115713,t337:0.02509098364):0.5608061018,t338:0.5225727513):0.6974306728):0.07762203655):0.2861620963,t339:1.571067484):0.4309043739):0.6449935271):1.096523025,((t340:0.4347232955,(t341:0.2488931231,t342:0.1824959586):0.03434517439):1.319996571,(t343:0.3906017987,t344:0.3516385223):1.108687705):1.960971293):0.9453496071):3.664468495,(t345:7.183080617,((t347:0.9419155326,t348:0.6617458244):5.470315851,(t349:4.307963628,(t350:0.4932214685,(t351:0.1708614896,t352:0.003757796741):0.2883443713):3.786591375):1.802083709):0.5682110768):0.6351086829):1.464492914):0.3024285234):1.300830271):0.7919484405,(t353:7.915273665,(((t354:5.015928915,(t355:2.311790141,(t356:1.62424514,t357:1.565394015):0.594696689):2.342395646):0.4461237613,t358:4.827971007):2.082022518,((t359:5.023841407,(t360:0.6677307996,t361:0.2646083624):4.317762799):1.335581881,((t362:5.535610722,(t364:3.521177201,(t365:2.56367223,t366:2.534969349):0.656439744):1.805473825):0.3032727769,((((t367:2.06241634,t368:1.999969808):2.043280629,t369:3.457040006):0.0545026253,t370:3.489890859):0.3460662657,t371:3.687410891):0.5289586698):0.07015781986):0.4622815245):0.1904990805):2.991642034):1.626072176,(t372:3.217506677,(t373:1.221581552,t374:0.9277164012):1.668916473):6.260897434):4.038070931,(((t375:2.185641216,((t376:0.7230909388,(t377:0.6589197525,t378:0.4566083777):0.02657222762):1.002022571,t379:1.471224418):0.4323920129):4.581777166,((((t380:2.881865805,t381:2.813481244):1.884130689,(((t382:3.493043785,t383:3.4792859):0.7249865643,((t384:3.505259159,(t385:3.238028858,(t386:1.700429787,t387:1.678533396):1.52747187):0.2142334094):0.1343118805,t388:3.404739791):0.5359390389):0.4170658489,(((t389:1.439079282,t390:1.334727736):1.638633627,t391:2.95728034):0.6259118313,(t392:3.144218265,(((t393:1.879720314,t394:1.850104968):0.7145505739,(t395:1.936591065,t396:1.883675245):0.578746092):0.2785685892,(t397:2.652981968,t398:2.62903651):0.0820270137):0.2580734269):0.2957908387):0.6309206724):0.02669173908):0.4928410769,(((t399:1.702206613,t400:1.631314136):1.850601819,((t401:0.5877474894,t402:0.4507003159):1.112786848,t403:1.556219392):1.679039293):0.4888767862,(t404:2.729717377,t405:2.6742955):0.9896019317):0.332995559):0.184708145,((t406:1.274533031,t407:1.193559681):1.790014727,(t408:1.394840944,t409:1.251116815):1.411021972):1.098773999):0.9301796064):0.2218109983,(t410:1.987022691,t411:1.901585006):2.785572208):5.865902012):0.499539799):2.477113278):2.372320571,(((((((t412:0.9650560738,(t413:0.6570018651,t414:0.5800237595):0.03839545082):1.387417676,t415:1.967576426):0.4670138252,((t416:0.7948027589,(t417:0.7597284267,t418:0.6717913077):0.01238392568):0.9183617619,t419:1.59320602):0.6941312945):0.4679842339,(t420:1.207329888,t421:1.078847001):1.537368405):0.2664370397,((t422:1.735945783,(t423:0.4319066501,t424:0.4216374445):1.234616211):0.2962099321,(((t425:1.307720217,(t426:0.7560687081,t427:0.6652700335):0.468798705):0.1133185789,(t428:0.2138131921,t429:0.1018767625):0.9112196603):0.4224283104,(t430:0.4470258854,t431:0.1866040501):0.9857657024):0.08585472359):0.637112584):0.6859306819,((t432:0.3981075583,t433:0.3234172918):2.089544897,t434:2.348368409):0.0708509953):5.139495821,(t435:0.6045312905,t436:0.5476151496):6.686358027):6.344771744):14.98965511,(t437:13.62127058,(((t440:1.174367439,t441:1.161641032):3.586630857,(t442:0.7451922197,t443:0.6574119658):3.906997834):2.629385216,(t444:1.985995044,t445:1.954343189):5.14466606):5.468007729):14.93110001):3.649398279):4.96691102,((t446:0.5210625305,t447:0.3765933489):11.31108978,t448:11.63072093):23.98869697):181.298869,(((t449:1.020530787,t451:0.8997468038):16.57903808,((t452:4.263675317,((t453:0.5505312296,(t454:0.3930368672,t455:0.3089475173):0.1427519535):3.381683717,(t456:2.10306801,t457:2.008883765):1.479441567):0.2316436299):5.955297383,t458:9.586357016):7.252358025):51.21669718,(t459:19.07376418,(((t460:1.439662648,t461:1.369103708):7.180064536,(t462:1.200321994,t463:1.12734418):7.340283693):10.04261424,((((t464:1.139436644,t465:1.108553495):0.4380890131,t466:1.471230944):7.049552319,(t467:0.3664875045,t468:0.2712946809):8.122349996):0.09411337615,(t469:0.8327209559,t470:0.6180388271):7.636169483):9.74249544):0.3235359421):48.72254421):147.9743746);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T53.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
