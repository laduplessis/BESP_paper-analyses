<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t480:3.425817063,t481:3.396017783):69.06000131,(((((t482:5.432866089,t483:5.415191347):6.409848103,((((t453:0.07421684555,((((t435:0.2047615358,t436:0.18558262):0.126041966,(t437:0.01894465387,(t419:0.01194109555,((t347:0.005759221256,(t325:0.5339089043,((t301:0.1353505759,(((((t246:0.01555460117,(t207:0.01721362444,((t172:0.1434978238,(t162:0.03426984017,((((((t149:0.04834981339,t150:0.03486375634):0.4917389063,t151:0.3686539126):0.1394795516,t153:0.1659535041):0.03820481027,t154:0.1953408084):0.1027040078,(t152:0.01639351846,((((t100:0.1310344639,(t56:0.1075524931,(t55:0.1876292351,((t52:0.001735511985,(t32:0.02332529346,(t1:3.769223611,t2:3.694688497):0.03003967153):1.810854279):0.4716085858,(t3:2.517750897,t4:2.41554355):3.460134285):0.007664530258):0.2620607773):3.366039978):2.844234922,t5:12.26750109):0.07268738755,((t6:2.786239943,t7:2.7828973):3.444229591,(t8:4.599088383,(t9:4.028152286,t10:3.776224764):0.4389747109):1.552442867):5.983659048):0.2043953716,((t11:2.437806262,t12:2.116036947):1.701903908,(t13:2.895901782,(t14:1.894377328,t15:1.874130456):0.6228462475):0.7046994792):7.764323018):0.4075937532):0.3676548033):0.1821859805,(t16:9.140759483,(t17:2.244277353,t18:2.164191571):6.851118014):2.610900456):0.7087317083):1.296654461):1.168209662,((((t19:1.971246479,t20:1.969633078):1.510310686,(((((t21:0.2266853173,t22:0.09889507902):1.384839792,t23:1.421792055):0.9085861618,(t24:1.062864173,t25:0.6592070403):0.9756332772):0.06111272459,(t26:1.373987298,t27:1.157122236):0.3077048599):0.7351572342,(t28:0.5136473753,(t29:0.1743620954,t30:0.02025290937):0.3121152853):1.681107225):0.05579000716):0.7887650917,((t31:0.6599917481,t33:0.5300624877):1.786213864,t34:2.202416632):0.3558389005):8.840356399,(((((t35:2.177654418,(t36:0.1528921015,t37:0.09990909503):1.984201814):1.294022794,t38:3.255295048):4.952492418,((t39:1.792965554,((t40:0.4310380715,(t41:0.3169962274,(t42:0.116238597,t43:0.06747930749):0.1502116101):0.06352380498):0.9048255139,t44:1.134134231):0.3848091829):6.284881788,(((t45:0.08138085652,t46:0.0595814612):0.6910181869,t47:0.4725832522):0.09473924716,t48:0.4507219328):6.914220962):0.07178907853):0.702741118,t49:8.008939804):1.405626238,((((t50:1.559653172,t51:1.510192547):2.67664552,t53:3.861446082):3.736348676,(((t54:0.6014539788,t57:0.07703092811):6.03377811,t58:5.972975658):0.5533188904,(t59:4.455973571,((t60:3.663391571,t61:3.592286299):0.08820526951,t62:3.599800926):0.7006804479):1.915625624):0.1879202582):1.195320262,(t63:0.8579223047,(t64:0.5815611651,t65:0.5238325598):0.2698618514):6.724810662):0.2465157562):0.6458937084):1.635650229):2.896507714):3.283905879):0.9940059647,((((((((t66:0.6114446851,t67:0.4519532211):4.718879566,(t68:4.573335414,(t69:3.489450601,(((t70:0.5908004894,t71:0.5771170176):2.316299425,(t72:1.550613991,(t73:1.339851555,t74:1.31042343):0.1914545039):1.337307042):0.1833908471,((t75:0.6068234542,t76:0.5629100674):0.07428721434,t77:0.6072346992):2.129544601):0.3370257639):0.966448224):0.4407153615):0.1523508408,((t78:1.116325618,t79:1.06548351):3.184283332,((t80:0.142934663,t81:0.07267216621):2.969976681,t82:3.022268101):1.008447286):0.2915764207):0.5948872076,t83:4.910861088):5.967241035,(((((t84:4.226030716,t85:4.135610312):0.8738665392,t86:4.905788111):0.4682928191,(t87:1.992167173,t88:1.76677274):3.299518379):1.192893479,((t89:2.57786611,t90:2.565131205):3.53019425,(t91:3.8664154,(t92:1.873444168,t93:1.815888406):1.968806374):2.175362085):0.07261266089):1.031663288,(((t94:0.9338171636,t95:0.8158696498):3.392278006,t96:4.141248021):2.32575606,(t97:4.000250186,t98:3.99298482):2.433524106):0.3959093286):2.883169087):0.1830105646,(((((t99:2.95294197,(((t101:1.332936552,t102:1.208078936):0.6265677104,(t103:1.196605981,t104:1.190928484):0.5649504812):0.06152228485,t105:1.783186974):0.5722054786):0.1230760907,((t106:1.260563663,t107:1.215786168):0.5694734682,(t108:1.568462883,(t109:0.5746937124,t110:0.4847112555):0.8614249316):0.1726021849):0.6027486485):1.834568457,(t111:1.72775537,(t112:1.702040394,t113:1.688549262):0.01706741652):2.099675168):1.390111191,((t114:2.152554712,t115:2.147010678):1.506028197,(t116:2.441845076,(t117:1.262449061,t118:1.162029804):1.161157272):1.188434791):1.522492313):0.5634997939,((t119:1.325774731,t120:1.315449171):1.018036854,t121:2.313574967):3.0118579):2.913292311):0.4670329065,(((t122:3.593397524,((t123:1.413647219,(t124:1.291621223,t125:1.149084748):0.03359321282):1.309886842,t126:2.480415393):0.8546864027):0.9682447053,(((t127:1.790471141,t128:1.783145449):0.08829279485,t129:1.802834783):1.661955685,t130:3.233241109):0.6351948904):0.1949187168,t131:3.899851999):3.923619973):2.358196923,((((((((((t132:0.8568135699,((t133:0.3628963474,t134:0.3247165293):0.3038368471,(t135:0.4699898307,t136:0.4356757683):0.0944988483):0.1506183031):0.04328677713,t137:0.6904680891):0.01847021759,t138:0.6765962686):0.6973474189,t139:1.300315748):0.5181400331,t140:1.74362508):0.09679806179,(t141:0.08043405328,t142:0.07458271):1.739337241):0.8752822249,((((t143:0.4659069728,t144:0.4483844547):0.3554024469,t145:0.7614117459):0.6135932199,t146:1.304827555):0.7938222392,((t147:0.4383694584,t148:0.425173771):1.505898869,t155:0.9274083623):0.06239158574):0.4557311138):1.808695188,t156:3.187251511):1.03489932,(t157:1.200431531,((t158:0.3585614913,t159:0.1733547847):0.07876338078,t160:0.2448779343):0.609742822):2.882840939):3.108424389,t161:6.625624027):0.9403105733):2.108352676):0.3599394808,t163:9.965156469):0.2063202629,(((((t164:0.067185444,t165:0.005349667453):6.91891166,t166:6.633974877):1.360999196,((t167:0.4464787133,t168:0.3851806987):6.457455413,t169:6.458929831):0.9216622886):0.4642879238,(((t170:1.211324909,t171:1.161235052):1.802236517,t173:2.620091145):4.783972583,((((t174:0.04391321058,t175:0.01797223029):0.05358553304,t176:0.01337980695):1.106234164,t177:0.7457438318):5.017514495,(t178:2.979975209,t179:2.948832155):2.758358818):1.054936895):0.04171276255):0.8079468216,(t180:5.844055988,(t181:0.1787014751,t182:0.1307284314):5.334978655):1.630538021):0.5110786633):0.7388096539,((((t183:5.264639071,t184:5.104609246):1.139857477,(((t185:1.226227211,t186:1.096620991):4.0911009,t187:5.116926016):0.5659772973,(((t188:0.1560460609,t189:0.1041040649):5.062087634,t190:5.127598639):0.3902481351,((t191:4.044514253,t192:4.035516215):0.7276535222,t193:4.736829737):0.6434236928):0.003073873347):0.2520349744):0.3417371404,(t194:5.587102607,((t195:2.001174518,t196:1.818151304):2.183306501,(t197:2.219144398,t198:2.113156217):1.766622311):0.6367722456):0.3482526015):0.8006507958,t199:5.620552488):0.7434323916):3.655123006):1.90601647,(((t200:5.32617526,((t201:2.696692485,((t202:0.8505949595,t203:0.7671789558):0.3514682093,t204:1.090942511):1.45284661):0.2764014947,(t205:2.478478861,t206:2.455955917):0.3002181758):2.199225353):0.5573126243,(t208:0.5307352558,t209:0.3220562028):4.580260887):1.321989972,(t210:2.061921522,(t211:0.7171887793,t212:0.6699817879):1.262543519):4.153651082):4.700063887):0.8166191956):2.512020399):3.502128797,(((((((((t213:0.4766450884,t214:0.4103989043):3.896038705,(t215:3.363507092,t216:3.361566513):0.8402058122):7.889998105,((t217:3.616290644,(t218:1.864573744,t219:1.773374755):1.741818463):2.191571664,(t220:1.806678325,t221:1.723445734):3.891240872):6.270540931):1.132570073,(((((((((t222:0.7862181524,(t223:0.3047995534,t224:0.255422818):0.4423030746):1.001789737,t225:1.619117827):1.149104731,t226:2.581752951):2.306348392,((t227:2.306658971,(t228:1.78053893,(t229:1.655369861,(t230:0.8140458714,t231:0.7949504199):0.7545776214):0.1084769053):0.287752791):0.4955781571,(t232:0.4468004047,t233:0.08957969254):1.959473568):2.059032579):1.463551007,(((t234:1.3919548,t235:1.350222109):1.381724575,(t236:1.944504206,t237:1.904778747):0.6261197317):1.267040982,(t238:2.255877489,(((t239:1.417994534,t240:1.413208929):0.4044457779,t241:1.743308612):0.03819382627,(((t242:0.6254700558,t243:0.1831973875):0.5032946184,t244:0.5478513512):0.4149887844,t245:0.7368075619):0.1512452779):0.3560401942):1.516574165):1.52208539):0.8132414343,(t247:4.180010977,(t248:1.539917031,t249:1.234124248):2.391918529):0.5614748831):1.415304136,((t250:0.7535546057,t251:0.6604037055):4.71932887,(t252:4.243573183,(t253:0.7412886243,(t254:0.2455435884,t255:0.01586233081):0.4214900872):3.371052468):1.10330872):0.1183370668):2.397788607,(t256:2.041098954,(t257:0.2939750173,t258:0.03454273593):1.710650535):5.263364228):1.546110204,(t259:8.318408573,(t260:7.618957145,(((t261:2.798701382,t262:2.795659154):2.722154837,(t263:0.3575518826,t264:0.2516276707):5.129845398):1.364635135,((t265:0.2311121856,t266:0.04235650245):2.595047365,(t267:0.8225751,(t268:0.4478632749,t269:0.356168784):0.2665861463):1.813178084):3.860673125):0.5216129839):0.62902576):0.02446280274):0.1332095451):0.4854147271,(((t270:0.5768082257,t271:0.5088528342):0.3228040816,t272:0.8015350179):0.9722496758,t273:1.761707396):6.112360078):0.7219343096,(((t274:0.8990752084,t275:0.5877686447):1.235879908,(t276:1.349751435,t277:1.241934579):0.3751204564):3.899588965,(t278:0.1393665212,t279:0.1189139221):5.313841037):2.385801745):1.170104901,((t280:8.284901391,((t281:4.358773773,t282:4.066616162):2.223583245,((((t283:3.841765794,t284:3.776696918):0.4861172177,t285:4.237519942):0.0716754892,(t286:1.705870089,t287:1.640152934):2.602729942):0.789199705,(((t288:1.389164888,t289:1.303758463):1.829029826,(t290:0.1909708628,t291:0.1637496855):2.832618587):0.569743746,t292:3.371440391):1.01111167):1.056046092):1.585304935):0.01970832522,((((t293:2.710147675,t294:2.612663439):1.541192358,(t295:3.660432462,((t296:3.024862773,(t297:2.938618851,t298:2.86582133):0.04785830277):0.3372784831,t299:3.078666114):0.2726726657):0.4900693045):0.7763350987,t300:4.589011212):0.5440101456,((t302:1.331010206,t303:1.298636958):2.981491916,t304:4.235920469):0.3547610451):1.344872956):0.6248323599):0.1055619377,(t305:1.661732219,t306:1.64083006):4.901567879):0.848356409,((((t307:4.71870042,t308:4.703824962):0.14171603,((t309:1.962250767,t310:1.89420925):1.606424172,(((((t311:2.337865747,t312:2.116062884):0.3584291394,((t313:2.093434132,t314:2.031829885):0.008439171688,t315:1.983432096):0.2776621851):0.2361589933,t316:2.359663692):0.4000982126,t317:2.753199488):0.0115172477,(t318:1.612443911,((t319:0.8599092611,t320:0.6011866196):0.1846383176,t321:0.6653216955):0.5240323245):1.1153135):0.1159978388):1.224836941):0.4695533942,((t322:0.4281899017,(t323:0.221866462,t324:0.05380762238):0.1811798345):3.039969678,((t326:0.4814670882,t327:0.4096584804):1.97483544,t328:2.309058204):0.04315194595):0.4804033081):0.7196368471,(t329:2.715706253,(t330:1.734133775,((t331:0.7399113277,t332:0.7349589268):0.9593152107,t333:1.370478898):0.004357198565):0.9395531225):0.8296985981):1.28851523):0.8336779462):4.19846554):1.323626746):0.01119416739):0.2447416797,(((t334:0.294396212,t335:0.2582650446):2.082814223,t336:2.04322031):0.04358076725,(((t337:0.1992668771,t338:0.1187888282):0.2855956943,t339:0.1888822539):1.434868436,(t340:1.18827035,t341:1.006776674):0.3205588781):0.1305767793):8.610228859):0.1723931946,(t342:0.6801465171,t343:0.6059074391):9.391773518):1.5052444):3.771493337,((((((t344:0.7456559599,t345:0.554291001):2.249025224,t346:2.6842972):4.783284691,t348:7.308835219):1.921144336,t349:9.199507504):0.384532646,((t350:0.9835494593,t351:0.9512531971):5.194999502,(t352:5.784793545,((t353:2.239858907,t354:2.172772641):1.280972245,t355:3.078778145):2.089068139):0.143897598):3.364452696):4.760849689,(((((t356:0.6819145016,t357:0.6705747236):5.568766273,((t358:0.5552976206,t359:0.3220545356):0.9652893923,(t360:0.7797383601,t361:0.7482864079):0.4928772918):4.683315951):4.350393575,(((t362:7.170156031,t363:7.13676589):1.559006092,((((t364:0.8995930007,t365:0.8574527325):2.186386228,t366:3.01818682):3.563530432,(((t367:1.176132903,t368:1.113164006):0.1687441285,(t369:0.5253765431,t370:0.4523801261):0.7334354951):2.638996384,t371:3.820077913):2.430392694):0.5733130416,(t372:6.754329083,(t373:6.345538955,(t374:1.353470413,t375:1.211403263):4.951746184):0.4055107028):0.05228537591):1.003227957):0.3247033542,(((t376:0.8712954796,t377:0.8676185174):5.546924949,t378:6.380672264):0.5290765326,(((t379:3.788247943,t380:3.744835931):1.011571227,t381:4.746849332):2.047933523,(t382:5.917534991,t383:5.771881519):0.8069951618):0.02060744784):0.8492300819):1.122743878):1.811488336,(((t384:6.678689244,(((t385:5.274196078,(t386:1.252194608,t387:1.208179163):3.91013085):0.5264162969,t388:5.297013656):0.5305291751,(((t389:3.353226694,(t390:0.8976087803,t391:0.8248609728):2.411138879):1.817293617,(t392:2.850172214,(t393:1.223429817,t394:0.7840024311):1.51753558):2.171633748):0.1384273963,t395:4.552044627):0.3775326502):0.2994089834):1.885195416,(((t396:2.453717402,t397:2.297285792):1.14851271,(t398:3.273715262,(t399:2.579416907,t400:2.487564855):0.5299580931):0.1350815138):2.34809989,t401:5.49610059):0.9692503554):1.203651571,(((t402:0.8169776474,t403:0.766246205):1.883329154,t404:2.645220246):3.32459329,((((t405:2.713756172,(t406:1.535881384,t407:1.481161036):1.173283633):1.016383444,((t408:2.958767241,(t409:0.3001298011,t410:0.2672789168):2.343391973):0.1135019677,t411:2.498479756):0.59747255):0.06623373629,(t412:2.45156479,((t413:1.846986697,(t414:0.9389057758,t415:0.8075956956):0.7054523958):0.3237897972,t416:1.764387544):0.2368050544):0.587748152):0.7574244874,(t417:1.883932032,t418:1.836256525):1.293147102):1.34910998):1.297041096):0.5054215088):0.6206646867,(t420:6.287341313,(((((t421:0.109915563,t422:0.1082570391):1.261081651,t423:1.328660315):1.777425615,((t424:1.581794164,(t425:0.4656368782,t426:0.4416294433):1.080116473):1.210565401,(t427:0.8206626325,t428:0.6211415315):1.864366469):0.2948298534):0.6910438475,((((t429:0.06714443704,t430:0.04369256022):0.07910360744,t431:0.1044890075):1.992611484,((t432:0.903519557,t433:0.8248874547):0.1872669196,(t434:0.7987140964,t438:0.3012583491):0.1671952245):0.8039401104):0.1228707451,t439:1.369974286):1.163548083):2.251174644,(t440:3.55926157,t441:3.341620707):0.957489075):0.08500651919):0.2263988489):0.2971463081):0.2031506529):5.093732519,(t442:8.752327379,(((t443:2.690031112,t444:2.560204244):0.9314559151,(t445:2.836550479,(t446:1.879756161,t447:1.579187868):0.9444124852):0.4921426035):0.8100163487,((((t448:0.3662985853,t449:0.2244295442):0.1232507179,t450:0.2691723679):0.6239642629,(t451:0.4336651276,t452:0.289087331):0.4393399618):0.03730357915,(t454:0.1022197937,t455:0.08503534525):0.3500143583):2.654347545):4.313169387):1.258401277):0.2670273191,((t456:1.350275237,t457:1.313822323):0.9561402613,t458:2.229565632):6.535108559):5.295798989):8.430110391,((t459:0.4277529645,t460:0.2973956697):1.847619748,t461:2.110744881):20.11675143):6.384753367,((((t462:5.133696203,t463:5.042753661):1.841324068,(((t464:0.6940982683,(t465:0.5152154531,t466:0.5039789313):0.07042064215):0.7110417785,t467:0.814777505):4.178758355,t468:4.918773663):1.251570084):0.07535904498,t469:6.193267551):1.852951068,((t470:5.847648091,t471:5.806127565):0.8988823637,t472:6.677424695):1.171503228):19.38920779):9.443760798,((t473:7.099519418,t474:6.912378294):9.852226866,(t475:8.397590539,((t476:5.992897334,(t477:4.442855524,t478:4.360190571):1.545644241):0.493454431,t479:6.35291703):1.814786699):8.277093706):19.71600578):36.32644468);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T36.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
