<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t491:2.659327091,t492:2.650457331):1.084278573,t493:3.503546592):2.564718412,t494:6.055914557):1.713245927,(t495:7.24363347,t496:7.176091072):0.4904561484):20.05664835,(t497:25.65772484,((((t498:0.3424688253,t499:0.09148216495):7.049692583,t500:6.833825373):2.036664013,(t501:7.056523147,(t502:5.6831321,(t504:2.835602661,((t503:0.01749208988,((t477:0.09787926713,(t470:0.07024246665,(((t370:0.03283156561,(t264:0.03041087076,((t261:0.1243848045,t262:0.01395182531):0.03820848059,(t240:0.0538820796,(((t218:0.01592446702,((((t176:0.09184952338,((t140:0.02100636364,(t137:0.03721206243,(t132:0.07953674105,((((((t1:5.35446693,(((t2:3.097503779,t3:2.956267504):0.945429011,t4:3.826246355):0.8596191334,(t5:2.072942083,t6:2.035079608):2.59049683):0.4381227706):0.1173956781,(t7:3.286882706,(t8:2.429582149,t9:2.353616765):0.7583529606):1.846102784):3.430213947,((t10:4.47027556,(t11:2.125844442,t12:2.012823627):2.13608353):0.5636686706,(((((t13:1.868457645,(t14:1.633591167,t15:1.571510866):0.0361496994):0.3812029941,(t16:1.862541611,t17:1.764644669):0.07055698761):0.6929446856,(t18:1.980639647,t19:1.968870739):0.4224253447):0.2760914925,(t20:2.183926754,t21:2.130178915):0.4438541664):0.271615989,t22:2.844263933):1.189191821):3.21370939):1.451925448,(((t23:3.60170592,(t24:0.1614890639,t25:0.080516357):3.357485704):0.2740163794,(((((t26:0.7792326888,t27:0.7369111609):0.951296691,t28:1.624265723):0.02737126937,(t29:0.9816207271,t30:0.8856968125):0.6315483763):0.4106898193,t31:1.893018389):1.303154453,(t32:0.7823257625,t33:0.7265960725):2.148475737):0.2306367729):3.222785642,(t34:3.553545804,t35:3.326883618):2.643425799):1.231527258):0.7719659917,(((t36:3.052782085,t37:3.015040456):3.60910578,t38:6.419635422):0.6924889495,(t39:1.263457572,(t40:1.128515333,t41:0.7740587611):0.08251091011):5.547110822):0.5364352698):0.1620744452,(t42:6.341757092,(t43:1.016120176,(t44:0.8968228716,(t45:0.2842494271,(t46:0.2356948513,t47:0.1718465528):0.03836717021):0.5113414401):0.09460240968):5.297371699):0.5266187521):1.9878639):0.870866855):0.2853593537):0.353428204,(t48:8.457212705,(t49:6.053978536,(t50:1.218315286,(t51:0.4032694728,t52:0.09993977828):0.7959890022):4.811944256):2.27267128):1.471757408):3.914712135):0.5083310955,((((t53:0.3091601922,t54:0.08499485967):0.1722734389,t55:0.1907183921):6.829367537,((t56:0.6827873613,t57:0.6593960135):1.856179061,t58:2.327007382):4.453257593):0.1371766814,(t59:0.3105060327,t60:0.1095027974):6.566774277):6.346277309):2.291115974,(((((t61:1.050133111,t62:1.048192268):1.485462155,t63:2.356604361):6.520128153,t64:8.743014401):1.049595621,(((t65:5.921142952,(t66:5.715406895,(t67:4.285397147,(t68:0.4006310791,t69:0.1443432808):3.821336463):1.382381231):0.08476883408):1.373212345,(t70:2.240210789,t71:2.230285172):4.432712693):0.3628284466,(((t72:4.904409882,t73:4.901834392):0.9992257026,(t74:5.392347845,((t75:4.061913538,t76:3.955642382):0.638719434,((t77:0.218789851,t78:0.1328065881):3.178857761,t79:3.029589841):1.080042484):0.6879850137):0.5027776691):0.4491908171,((t80:1.815948152,t81:1.634316482):3.247784906,(((t82:2.289027069,t83:2.225803205):0.01609428258,t84:2.169768119):1.205075847,t85:3.326138542):1.351482498):0.5145372407):0.6276281334):1.589406746):4.568445565,((t86:2.959434827,t87:2.856146356):3.782099809,(((t88:1.943692041,t89:1.837511966):0.1923143165,(t90:1.983174726,(t91:0.4848764291,t92:0.4023759597):1.481720398):0.03086338863):4.156503072,(((t93:3.235719123,((t94:0.8185737741,t95:0.8047569252):1.862272882,((t96:1.396206795,t97:1.330831133):0.4068839784,t98:1.625109547):0.7343803386):0.5389174546):1.119424566,t99:3.882653741):1.401282544,((((((t100:1.330081462,t101:1.328312862):0.1519259441,t102:1.47660821):0.1863926059,t103:1.630519486):0.2295553058,(t104:1.243384858,t105:1.215486675):0.5776236423):0.3115746566,t106:1.76480027):2.451223469,(t107:3.068711752,(t108:1.937138636,t109:1.908725506):0.9676283801):1.104057526):0.5015503197):0.2980526448):0.2898822227):5.009810617):0.4614621969):0.1099843054,((((t110:0.7987151818,t111:0.7582424447):1.840702174,(t112:1.704238233,(t113:1.168647191,t114:1.148562622):0.5308122779):0.8796206683):0.3981293939,t115:2.90024818):1.886446917,(((t116:1.762787674,t117:1.426476824):1.216330479,t118:2.573533304):0.4217746692,(t119:1.551720806,(t120:0.06255159379,t121:0.005257277667):1.291411978):1.420299086):1.344187974):5.604320935):0.8566842814):0.05018700796,(t122:3.980075266,(t123:0.6447626326,t124:0.6310801582):3.213084057):6.547968474):0.6115460817,((t125:1.038665607,t126:0.9874384882):9.505746116,((t127:3.40688572,((t128:0.7254893411,t129:0.4778408417):2.100880682,(((t130:1.11502588,t131:0.9940439103):1.006101943,(t133:1.251137001,t134:1.225925259):0.1389944519):0.1726207607,(t135:1.432656191,t136:1.111992644):0.006898573183):0.1911449772):0.5617369033):0.9724879864,((t138:0.1954992884,t139:0.1365813627):0.3408320801,t141:0.133962958):2.091575753):6.061700181):0.2391444635):1.221367355):1.775371654):0.1281988279):9.076731905):0.2493115406,(((((t142:0.08069015911,t143:0.0325343135):0.9325222803,t144:0.9441618173):9.758769586,(((((t145:0.07286093279,t146:0.02343827754):0.4959634895,t147:0.4186142965):6.831245025,(t148:6.982481537,((t149:5.142411508,(t150:2.707543891,t151:2.287180535):2.337151392):0.1599814995,(t152:0.8788299873,(t153:0.6414748695,t154:0.6105543863):0.1537956056):3.723259487):1.429401988):0.05471403212):0.9569022008,(((t155:5.046546848,(t156:3.043398163,t157:2.861812213):2.001675311):0.08674258148,(t158:4.474450772,(t159:2.287497442,t160:2.209244582):2.090822822):0.3089832191):0.7411908168,t161:5.25104492):0.9005107012):1.047778037,((t162:6.241647016,(t163:3.215543901,(t164:0.1028999135,t165:0.09645962834):3.04921242):2.653924469):0.09758465447,(((t166:5.104207314,(t167:2.723665946,t168:2.642194946):2.328426412):0.02754688018,t169:4.990885579):0.1779209986,t170:5.055111043):0.4800649793):0.704303127):1.279706633):4.502119664,(((((((t171:2.868042991,t172:2.815431568):2.551414202,((t173:0.7645985967,t174:0.678455226):3.862582968,t175:4.235363197):0.5966028167):1.273073269,(t177:3.400029748,(t178:2.758335184,(t179:0.2386303048,t180:0.2309347556):2.518278835):0.6074327538):2.42481331):0.5228467103,((((t181:2.689800027,t182:2.434654699):1.261645048,t183:3.664445051):0.6764474433,((t184:0.2915269321,t185:0.2228707018):2.758359857,t186:2.936636469):1.180801031):0.9237391285,((t187:2.655200838,(t188:2.524060705,t189:2.356730297):0.07452343232):0.5431978697,t190:2.965392239):1.731605773):0.4359996481):1.164198474,(((t191:1.742171167,t192:1.701373762):0.9252743468,(t193:2.552546215,(t194:2.286667348,t195:2.205657368):0.2608774481):0.02614852123):3.105344096,(((t196:1.154266905,t197:1.040819815):1.204653185,t198:2.231512285):1.965274308,(((t199:0.595155195,t200:0.5875392259):1.535468477,(t201:1.901859088,(t202:1.771307926,t203:1.597995398):0.05676515546):0.1459916851):1.919055174,((t204:2.751980132,t205:2.678122225):0.1996793228,t206:2.62491032):0.7628706189):0.01359029785):1.25663349):0.4792825338):0.8483563298,(t207:2.317120594,((t208:0.4132313056,t209:0.2899311392):1.336742949,t210:1.30930964):0.4046173148):3.481451107):0.3859352941,(t211:2.10279358,t212:1.965764508):3.454532668):2.402126626):3.664158732,(((t213:0.09255294382,t214:0.06541319956):1.065484968,((t215:0.7407954919,(t216:0.4602030952,(t217:0.3242636514,t219:0.2489029304):0.09761183976):0.1275326952):0.3649012468,t220:0.8276692484):0.005873738851):2.324841866,t221:3.148386461):7.95163835):1.946375338):1.304611231,(((((t222:1.630682677,t223:1.581146454):6.379576576,((t224:0.6132539903,t225:0.5962436395):0.8830280316,((t226:0.6481848777,t227:0.6475644357):0.6423523092,(t228:0.9899685479,t229:0.9052014307):0.2278982509):0.1102351448):6.455829839):1.193027498,((((t230:1.813362219,t231:1.583885593):3.513592077,((((t232:1.165397612,t233:1.159779963):0.9092832392,t234:1.936993322):0.5451295745,t235:2.279675936):0.987006772,((t236:0.6143976484,t237:0.5592410193):0.764965753,((t238:0.2926995093,t239:0.146983895):0.1975772098,t241:0.2588995478):0.5939006507):1.660098812):1.439689251):0.532139785,(t242:2.187863789,(t243:0.9596790307,t244:0.9542709308):1.186078112):2.285017451):1.22100423,((((t245:0.5724779234,(t246:0.3289082054,t247:0.3164745312):0.196408571):1.196231038,(t248:0.3312076183,t249:0.2989080671):1.249314427):0.4111235203,t250:1.683132551):3.043744671,(((t251:1.126319683,(t252:0.5937696419,t253:0.449093174):0.1955974761):0.9514331758,(t254:0.9333320679,t255:0.8536631553):0.6572363969):0.1982314183,t256:1.633494535):2.269452641):0.3594515661):1.779702035):1.163411265,(t257:4.800841101,(t258:1.749429934,(t259:0.4746230338,t260:0.4535330222):1.257845294):2.999451944):2.390191933):2.230207119,((t263:6.568860832,(t265:1.886070974,t266:1.793338706):4.409306467):2.088535376,((t267:1.167758821,t268:1.136886405):4.875768248,t269:6.004311972):2.20126616):0.3842656319):1.649385363):7.167650841):0.9421802192):2.081494567,((((((((((((((t270:4.642254116,(t271:2.247331117,t272:2.081815406):2.231512599):0.331454216,t273:4.623983037):0.0611076941,t274:4.578194848):0.3793511818,((t275:0.3761644408,t276:0.2828697854):3.371297441,(t277:0.5824199655,(t278:0.3025086817,t279:0.2469434581):0.2283986033):3.028286279):1.193971653):0.2282580216,t280:4.837115048):2.562541492,((t281:5.485280261,(t282:1.35064862,t283:1.331349799):4.130920071):1.194452398,t284:6.645925387):0.6406121287):0.6165361086,((((t285:0.1532090801,t286:0.1027275036):2.476234173,(t287:0.411313692,(t288:0.1221633575,t289:0.06421361663):0.2585962052):1.945446422):2.851576932,t290:5.026245037):1.513431207,(t291:5.353641835,((t292:0.8515656597,t293:0.8307785091):1.747456744,t294:2.544308607):2.210491487):1.011174023):0.8844282018):1.472500736,((((t295:3.754662641,t296:3.753230446):2.47485554,(((t297:4.489550087,(t298:3.70327577,t299:3.679640484):0.765913837):0.05191084478,((t300:0.4833407338,t301:0.376081301):2.941329183,t302:3.269413758):0.9933929294):0.471621841,((t303:1.846139582,t304:1.632477781):1.582064268,((t305:1.39167627,t306:1.354777197):0.4726269773,(t307:1.070572214,t308:0.9959647166):0.6775550624):1.336119654):1.169755048):1.004105454):0.167090675,(t309:4.903463511,((((t310:0.01158154801,t311:0.001661369561):1.605506262,(t312:0.2888140769,t313:0.2486597796):1.283173479):1.665188976,t314:3.014381856):1.170708783,(t315:2.76546822,t316:2.545544939):1.318623776):0.2851196937):0.3154643075):0.9941733715,(((t317:2.092329036,(t318:1.571456854,(t319:1.064476047,t320:1.027426716):0.4387420749):0.3369398308):0.2646947173,t321:2.047647004):1.838066201,t322:3.884714913):1.252784821):0.719517115):0.487430907,((((((t323:1.21100362,t324:1.207898874):1.600404258,(t325:1.015939257,t326:0.9927439781):1.60780174):0.1888920664,t327:2.744949617):0.8732469746,((t328:0.6566173127,t329:0.633811139):0.7538890426,(t330:0.2327393881,t331:0.1398890694):1.083940627):2.131979332):0.5327879454,(t332:1.205672414,(t333:0.2906997865,t334:0.2665809221):0.8154334273):2.442927948):0.306581259,((t335:0.7745546133,(t336:0.6511008042,t337:0.6117923736):0.07486633826):2.228202752,((t338:1.299603612,t339:1.290771271):0.5598337844,(t340:1.199955871,(t341:0.8190490863,t342:0.8135566883):0.2249618075):0.6171454678):1.040816389):0.8121476388):1.455206344):0.005420685797,((t343:1.50486953,(t344:1.058272007,t345:0.9867690835):0.4118241629):0.5173609876,t346:1.652473743):2.90757971):3.714377876,(t347:2.139847608,(t348:0.7153125187,t349:0.7015819974):1.33630648):5.943701612):2.036899199,((((t350:0.7513617602,t351:0.6250798147):0.3391317254,t352:0.9564809503):0.1767658462,t353:0.683368475):0.5502356095,t354:0.8422769031):8.124311773):1.157003521,((((((t355:0.442094753,t356:0.3204295951):0.1675245947,(t357:0.2538429319,t358:0.2115083502):0.1846131846):1.791684177,((((t359:0.03563565591,t360:0.01329511933):0.404747824,t361:0.1496448372):0.1604373284,t362:0.245961885):0.8048890357,(t363:0.1954998581,t364:0.1930965565):0.7171033241):0.7258717397):4.335164374,t365:5.921409384):0.8601976196,((t366:5.291136967,(t367:0.07201757456,t368:0.047057093):5.205018507):0.4351031271,((t369:2.390519746,t371:2.226779298):1.97926787,((((t372:0.3395832267,t373:0.270177657):0.4102514282,t374:0.6554597841):0.2010440673,t375:0.773712394):1.598451658,(t376:0.7523217247,t377:0.7372228139):1.573012574):1.598633151):1.282682128):0.9937922764):1.032685372,(((t378:0.3029612335,t379:0.1781826987):5.902940028,((((t380:1.10693851,t381:1.103073599):2.467155856,(t382:2.990039423,(t383:0.4593687888,t384:0.2703522213):2.395943243):0.5427634849):0.315836521,(t385:2.861980821,t386:2.706037172):0.2126101989):0.580033798,((t387:1.56602694,t388:1.546179409):1.674598118,(t389:0.2711131568,t390:0.2709285757):2.88722264):0.1684313131):1.582874371):0.3333575219,((t391:4.64011503,((t392:0.1254463803,t393:0.1232790865):3.99863991,((t394:0.3489539401,t395:0.1795228381):0.8053666046,t396:0.86022871):2.785334174):0.4886542462):0.3555595384,t397:4.409339977):0.2294083982):0.6765703852):1.423383488):0.5397775565,((t398:4.214919604,(t399:4.157480747,t400:4.137370552):0.01529746961):2.107885617,((t401:2.129216464,t402:2.070101245):3.05200845,(t403:2.844007896,t404:2.801305997):2.231811547):1.04790488):0.9076857142):2.165295686):0.8110740034):1.303058627,(t405:7.78825221,(((((t406:2.680071856,t407:2.601686321):2.293168995,t408:4.776716826):0.6473952256,t409:5.163128622):0.703925101,((t410:2.113316058,t411:2.059812127):1.419362387,t412:3.405090439):2.144171615):0.7128904745,((t413:2.910150205,(t414:0.5498143139,t415:0.3249194806):2.27039748):3.124340732,(t416:4.47307215,t417:4.335172198):1.186704934):0.1631667704):0.7063985351):3.459066364):1.534009802):2.809686949):1.25725531):1.737768548):7.79119795,((((t418:3.993459918,((t419:3.328305952,((t420:2.223604861,t421:2.192082111):0.2077060207,t422:2.319498546):0.865304502):0.1886924472,(t423:0.175787689,t424:0.1583155233):3.17985561):0.3910184402):2.080738263,(((((t425:1.732906176,(t426:0.6880325109,t427:0.6029579055):1.028010008):0.5064102525,t428:2.092884858):1.406910954,(t429:1.579377168,t430:1.55175958):1.828433171):0.3209016271,((t431:3.298497134,(t432:3.060149547,t433:3.046558849):0.1955560923):0.07860722788,((t434:0.6235407567,t435:0.5833124774):0.0851829775,t436:0.5635377924):2.579405045):0.1222488973):0.6140837485,t437:3.716104921):1.199747647):1.600033097,(((t438:0.8832241873,t439:0.8671312517):2.001333295,t440:2.849527998):2.653439264,(((t441:1.241128981,t442:1.231711844):0.7548402861,t443:1.978089031):2.445626832,t444:4.006916356):1.059309838):0.9589424982):8.372359352,((((t445:3.107737113,t446:2.859993428):0.1522999591,t447:2.965842031):3.844990894,t448:6.541389789):6.10351121,((t449:3.039616614,(t450:2.542135506,(t451:1.319833569,t452:1.067061746):1.204111565):0.4351653005):9.38203084,(((((t453:2.858211045,((t454:1.848307173,(((t455:0.1916621726,t456:0.02442861519):1.446725306,t457:1.42329277):0.07676711835,(t458:1.307823131,t459:1.301158742):0.01388439261):0.09043223773):0.5067920723,t460:1.764166906):0.4955837989):2.05770985,((t461:1.313702327,(t462:0.1676698644,t463:0.1353201569):1.083786754):1.357144347,((t464:0.417295547,t465:0.3903570439):1.656960981,t466:2.007937988):0.4887038629):1.433964426):0.2962062848,(((t467:1.764342399,(t468:0.5096525388,t469:0.5015364486):0.5439123484):1.193240683,((((t471:0.8304080109,t472:0.6838989312):0.03518352597,t473:0.6189904112):0.1324504803,t474:0.5988621767):0.02196739353,(t475:0.4430385801,t476:0.3499636274):0.1083786642):1.078741417):1.082359293,t478:2.085982512):0.01197845409):0.09883353241,(t479:1.201211838,t480:0.9804222694):0.8421491556):6.463739265,(t481:7.839255682,t482:7.702059509):0.4246704572):0.2878324109):0.204435856):1.098090499):8.871083484):8.415424577):2.007752082):118.4619162,(((t483:2.367852899,(t484:1.059764755,t485:0.9920480314):1.215949872):6.3917141,t486:8.568703564):89.85672415,((t487:7.727022882,t488:7.425670695):4.685436696,(t489:0.8239952783,t490:0.7925345284):11.17524758):85.94315128):48.79687494);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T75.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
