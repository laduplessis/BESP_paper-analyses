<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t470:0.2285588791,t471:0.1337161448):12.11074327,t472:12.23788724):2.066918489,((t473:6.820961825,((t474:1.560881372,t475:1.501687313):2.520757965,(t476:0.2802784519,t477:0.2651910048):3.679355066):2.703521601):0.8748052879,(t478:7.167119818,(t479:3.329351667,t480:3.265313511):3.772422155):0.326803004):6.5813981):30.62291062,((((t432:0.2013554439,(t430:0.02019618305,((t424:0.1137826984,(t420:0.1252754839,(t390:0.08488346576,(t383:0.1235084949,(t367:0.1595296687,(t361:0.09159253582,(((t346:0.0241587565,((t343:0.1191583128,((((t330:0.01300697896,(t325:0.04024807923,(t323:0.101539292,((t286:0.2409398622,(t273:0.06428932098,(t261:0.05601258914,((t239:0.02193849836,(((t201:0.1656152395,((t167:0.1463512755,((((t139:0.1560545564,((t72:0.1550738819,(((t1:4.853500867,(t2:3.227514511,(t3:1.818013652,t4:1.77302917):1.351003972):1.590728159):0.6098787525,(t5:4.722870603,t6:4.69086192):0.5532348554):1.066833741,(t7:3.353929833,t8:3.250179783):2.956412682):0.1912784373):5.287630515,(((t9:1.925447245,t10:1.904719066):2.088017456,(((t11:2.480695641,t12:2.458732238):0.4086133797,(t13:2.675489486,t14:2.667244569):0.167273951):0.6940288588,t15:3.505600413):0.281704391):3.185086717,(t16:1.581537877,t17:1.505792896):5.303761503):4.480462234):1.229801752):0.1263406648,((t18:2.615292556,(t19:1.429509464,t20:1.285187729):1.063795025):1.026133083,(t21:2.44620182,t22:2.299142108):0.9034131691):8.990756268):1.158346547,(((t23:1.333251398,t24:1.256708202):1.518176483,t25:2.762378258):9.15475771,((((t26:2.176070456,(t27:1.756841486,t28:1.608072863):0.3442305669):0.0378520752,t29:1.714020115):2.533349425,(((t30:0.3852904061,t31:0.3451952217):2.117325603,(t32:0.9682718226,t33:0.9033975596):1.487275988):0.4706367859,((t34:1.900109757,(t35:0.3958072992,(t36:0.1703186879,t37:0.1530149436):0.1141716002):1.4562673):0.4159930202,((t38:1.524140048,(t39:0.6547694047,t40:0.595566112):0.6775784508):0.2303408217,((t41:0.06880564748,t42:0.06023209861):1.195976439,t43:1.187359354):0.1691949971):0.3571814298):0.4243425981):1.006465475):2.671081229,t44:5.69156455):4.253174474):1.252592641):1.11089591,(t45:3.971790643,((t46:1.060295225,t47:0.7982191418):0.8133951959,((t48:0.4078310368,(t49:0.2834254885,t50:0.2333021187):0.08203033343):0.5308874998,t51:0.7143624948):0.5967168508):1.869375935):8.189440449):0.2854551123):1.845861622,(t52:10.75826045,((t53:6.916897295,((t54:0.5491589385,t55:0.4262919433):5.449737067,((t56:0.3055916546,t57:0.1600189275):2.270897633,t58:2.429731595):3.235586798):0.6750844506):1.777031331,(((t59:4.304335053,((t60:0.3264843439,t61:0.1266023339):0.1348732958,t62:0.07433463412):3.795271914):1.82615688,(t63:2.257292778,t64:1.952998017):3.400156534):1.396863795,((t65:0.365787846,t66:0.3220735947):5.174194058,(t67:5.43300369,(t68:3.786061639,t69:3.62122368):1.246393301):0.02605267738):1.160381607):0.5270535695):2.063785569):2.738137338):1.930062482):1.100190099,(t70:1.620704288,(t71:0.5462661063,t73:0.2304018614):0.9536741105):12.77467424):2.905691096,(((t74:0.9687333894,t75:0.9477979178):6.822296046,((t76:1.583615472,t77:1.540309928):3.288678086,(t78:2.367446981,t79:2.212464918):2.334108625):2.825057462):7.390413014,((t80:6.059968409,((t81:1.253999093,(t82:0.5562021347,t83:0.4803667135):0.6356099569):4.070878911,t84:5.14480134):0.6811171983):0.5881205833,((t85:4.771407624,((t86:1.795630684,t87:1.690814079):1.133470456,t88:2.739328459):1.288777161):1.258049318,((t89:0.08534970991,t90:0.07625742507):4.945463075,(t91:4.767954268,(((t92:1.311533576,t93:1.200192722):2.318640342,t94:3.495503595):0.8312783908,(((t95:3.55824956,t96:3.412837958):0.04730440267,t97:3.393170673):0.5916397622,((t98:1.339822361,t99:1.282044872):0.1866560065,(t100:1.420170433,(t101:0.8639494523,t102:0.7201171147):0.5389031596):0.03597965255):2.446937999):0.1145646005):0.04749245668):0.1352033785):0.2134990823):0.2971074997):7.969637722):1.303940185):0.2856162817):1.221705814,(((((((t103:4.002348921,(t104:3.749595093,t105:3.742912716):0.229351527):0.2728960059,(t106:2.357442033,t107:2.329956172):1.837413816):1.244408715,((t108:3.678716082,t109:3.578974138):1.330101156,(((((t110:1.491790813,t111:1.419086224):0.7994718698,t112:2.213580908):0.8976397492,(t113:1.745321788,(t114:1.614030117,t115:1.368395501):0.1028568237):1.325747732):0.2809166864,t116:3.038729085):0.5183119948,(((((t117:0.8039555794,t118:0.6161045188):1.783343245,(t119:2.054362547,t120:2.027465348):0.2079976048):0.1964496132,t121:1.892418752):0.6352573577,(t122:2.107112088,((t123:1.085555434,t124:1.039890404):0.2288891596,(t125:0.3973919452,t126:0.3333787532):0.8166744927):0.7812229387):0.402694987):0.04558078644,(t127:2.088137743,(t128:0.2283534342,t129:0.202226472):1.700797307):0.1049079569):0.005281619932):0.6994231461):0.3120954068):4.941510069,((t130:3.430800531,t131:3.377025753):0.2534006506,(t132:1.024135632,t133:0.9722636274):2.561826877):4.238118343):0.7044796019,(t134:8.152843713,(((((t135:1.622719839,((t136:0.2144795022,t137:0.08883016691):0.4719106611,t138:0.5556212589):0.8812675634):0.1632864651,t140:1.368287285):1.505568495,(((((t141:0.02601050817,t142:0.01784508441):0.4416441836,(t143:0.297809225,t144:0.2620832715):0.09258173384):0.2876183204,t145:0.3276988479):0.5468372274,(t146:0.1710971118,t147:0.06469617125):0.6833539695):0.1888426713,t148:0.934523486):1.341866131):1.669166998,((t149:1.067265117,t150:1.005661676):0.02649653169,((t151:0.4856348675,t152:0.4556556795):0.4632038894,t153:0.850212783):0.01179121077):2.794417103):0.8224757302,(((t154:0.9347408467,(t155:0.2197557317,t156:0.2150889371):0.5721658482):0.1232764612,t157:0.8538088775):0.7086873137,t158:1.510286631):2.643723747):2.09632463):0.3162388768):1.218601722,((t159:0.4153662014,t160:0.1974020728):5.014876533,(((t161:0.1839334687,t162:0.07405098546):0.9230414635,t163:0.7920997029):1.711353286,((t164:2.114004,(t165:1.481000148,t166:1.404046463):0.5945786588):0.003990469881,t168:1.617192594):0.04134669461):2.358512496):2.222487304):1.728031787,(t169:5.244508474,((t170:0.5601931701,t171:0.4048160629):4.052423585,t172:4.271594953):0.1832885735):2.682685581):1.199009745):1.427568567):1.17257541):1.018897252):1.562982616,(((t173:4.085925352,t174:4.064088494):1.122896382,t175:5.000908069):1.562316804,((t176:1.757077706,t177:1.675159019):3.772785235,t178:5.293442819):0.9713874835):6.729209309):1.793572316):0.08036551201):0.38550523):0.309106569,(((t179:5.794122549,(t180:2.835924534,(t181:2.296961911,t182:2.270409096):0.5182003237):2.827481819):1.611913524,t183:7.215342173):2.637957447,((t184:5.122688265,(t185:3.969880284,(t186:0.2352553964,t187:0.1820126143):3.626079777):1.138385025):2.694140974,((((t188:3.692027333,t189:3.489301405):1.307172656,(t190:1.436448383,t191:1.366817722):3.279743935):0.5073379192,((t192:2.488970791,t193:2.401354602):2.14548858,t194:4.493480536):0.3580686326):1.218085302,(t195:4.04957659,t196:3.953387459):2.018298826):0.5537460133):2.029291243):5.381540005):0.2992173346,(((t197:3.953376114,t198:3.935623306):1.533635469,((t199:3.017826153,(t200:1.363673306,t202:1.091349722):1.551423889):0.3078400009,(t203:2.264427134,t204:2.115974592):0.653494794):2.049416289):8.191521407,(((t205:0.4728908157,t206:0.3963494888):1.989877202,(t207:2.152417315,t208:2.120593732):0.1715971787):4.547493041,(((t209:4.456884693,(t210:1.48941016,t211:1.475049632):2.878652978):0.2121761222,((t212:1.146075993,t213:1.129734108):1.86029734,(t214:1.12649544,t215:1.11824479):1.725661498):1.496318861):0.7521786199,t216:5.010994409):1.38400084):5.976280472):0.2647838258):0.737478622,(t217:4.856386941,(t218:1.122919386,((t219:0.7680341694,t220:0.6177795059):0.1080858398,t221:0.5628600719):0.1937396168):3.549660687):8.467944081):0.2020419447):0.04994886863,(((((t222:0.4852243497,t223:0.2080998633):1.959364187,t224:2.057807466):5.4943874,((t225:2.435541549,t226:2.390952972):0.5487165029,(((((t227:0.6781759851,t228:0.4766603627):0.6194701794,t229:1.067904569):0.3746125541,t230:1.011528189):0.2999782345,t231:1.191842914):0.1892299607,(t232:1.302526509,t233:1.142121488):0.05515977603):0.7546785032):4.395407958):0.06340905863,t234:6.04976721):4.520704269,((t235:2.213802508,((t236:1.352646343,(t237:0.396006254,t238:0.2915376178):0.7476961521):0.01121593283,t240:0.8925060693):0.798957653):7.236874812,(((t241:1.126620416,t242:1.101094096):1.482801898,((t243:0.3383664416,t244:0.1982416512):0.8604451983,(t245:0.749374517,t246:0.616452398):0.1533713919):1.369647581):5.330119747,((((((t247:0.1022062705,t248:0.06419911449):0.4848498055,t249:0.5146058005):0.2216971499,t250:0.5844882083):1.127973887,t251:1.650636892):5.089101493,(t252:0.1270556658,t253:0.09370489867):6.519590718):0.1082421411,(((t254:1.370364569,t255:1.342768186):1.012955056,t256:2.299157327):1.104501465,t257:3.336571812):2.813390201):0.08018673638):0.903805386):0.9846541689):0.2311310938):0.5196801041):0.5386270965,((t258:5.057918569,(t259:0.1247399738,t260:0.1109661856):4.669033943):3.245831695,(((t262:6.11425046,(t263:2.082072912,(t264:2.049878255,t265:1.920752258):0.02435718137):3.795263226):0.1508321836,(t266:4.979327649,(t267:3.2662502,(t268:2.199667327,t269:2.174412391):1.040555216):1.67845845):0.8006450239):0.5339892149,(t270:5.995361925,(((t271:3.960993191,t272:3.628440258):1.566196487,((((t274:2.855222697,t275:2.769592451):1.109916276,t276:3.833566288):0.03751906609,(t277:0.8521773667,t278:0.6211260078):2.909386108):0.08986601375,t279:3.57251623):0.9539238046):0.006644263687,t280:4.527425268):0.4555148307):0.1946092584):0.9807552845):0.7738487397):0.3286762452,(((t281:3.238996534,(t282:0.2085743888,t283:0.09273547973):2.993900009):0.370904164,t284:3.453189959):2.787431705,t285:6.195524572):0.8593087996):0.6210486448):0.685093448):1.292064506):1.170595548):2.466136982):0.5334264282):0.06889748455,((((((t287:2.52322923,t288:2.134220393):1.554537964,(t289:2.108276525,t290:1.946282891):1.469993392):0.4667028216,t291:3.881154272):1.058652987,((t292:1.634701206,t293:1.615983535):1.437390998,t294:3.009833858):1.854973565):0.7185571117,((((((t295:0.8812523829,t296:0.8672119472):0.8326942082,t297:1.684814986):0.7385707388,(t298:0.1855395302,t299:0.08546420797):2.086321891):0.4171134808,t300:2.575836904):1.31038878,t301:3.867331783):0.7729300778,t302:4.545342427):0.5956304471):0.2150585504,((t303:2.252332018,(t304:1.702623489,t305:1.523021131):0.5056209318):0.4986761242,(t306:2.447592456,t307:2.423266181):0.06766673509):2.524815416):7.04681449):0.4250270082):0.4300143897):1.67846396,(t308:13.76975353,(((((((t309:2.67630918,(t310:2.447780659,(t311:1.545519343,t312:1.542717104):0.8082044856):0.1170747878):3.601208382,((((t313:0.3249177692,t314:0.1872547959):0.8662750819,t315:1.005313297):2.929164536,(((t316:0.4477476866,t317:0.4432575616):1.262519586,(t318:0.8300970702,t319:0.8055692615):0.8666404675):1.840683487,t320:3.09754281):0.0890706633):0.5312415269,(((t321:0.1417478504,t322:0.006140784812):0.4700802433,t324:0.3612146995):2.816510411,(t326:0.3865182145,t327:0.2943229364):2.59402543):0.1385910253):1.346176669):0.4789569323,(((t328:1.54369864,t329:1.523462669):0.7714932835,(((t331:0.6348904011,t332:0.5997337381):1.109843651,t333:1.506859629):0.2155838564,(t334:1.013931685,t335:1.007029757):0.5743075339):0.1842054955):0.7834701006,t336:2.510458137):1.639419137):0.6247228011,(t337:2.835480364,t338:2.769909798):1.530361555):1.144250257,((t339:0.2076409116,t340:0.1047246793):0.07819136394,t341:0.1570047372):4.945616706):5.006269552,(t342:8.34842774,((t344:1.750327558,(t345:0.5845695888,t347:0.1556450273):1.00124271):2.964097206,t348:3.865631329):3.281321359):1.679528856):0.1755335461,((t349:1.153130651,(t350:0.2571938675,t351:0.1663360632):0.6639621876):4.477734694,(t352:3.035110757,((t353:0.04690862854,t354:0.01579056016):2.769117265,t355:2.725901806):0.1639667753):2.21769141):3.359459765):0.05570423366):0.6726395665):17.39743154,(((((t356:2.103109535,t357:2.079908374):10.29829065,((t358:1.178962092,t359:1.141693065):9.341637132,((t360:8.644397886,(((t362:0.3771275997,t363:0.3043081726):5.097929469,(t364:0.6896065921,t365:0.6617607544):4.699382622):1.281504713,((t366:1.881145843,t368:1.498284104):0.4528191109,t369:1.933665826):4.09648763):1.425407284):1.261189717,((t370:4.717336317,(((t371:0.1058038134,t372:0.1030336954):2.770148924,t373:2.804364013):1.378978049,((t374:0.3551232638,t375:0.2755891751):0.9225459843,t376:1.012422226):2.816529194):0.4391591174):1.158542119,(t377:3.363285855,((t378:1.14298101,t379:1.128786098):1.313164269,t380:2.417729539):0.768507904):2.024481981):2.779052912):0.5456688193):1.830353262):3.268002618,(((((t381:4.122726697,(t382:3.99148346,((t384:1.210943022,t385:1.167992429):0.5220250961,t386:1.459682871):1.967553024):0.02695778044):2.629896039,(t387:2.40500961,t388:2.234458994):3.592305759):0.4039586065,(((((t389:1.332456809,(t391:0.1827653977,t392:0.1253701183):0.6591683743):0.5670292378,t393:0.8961791741):1.892715721,t394:2.750961897):1.049246276,(t395:2.768576578,(t396:1.617670471,t397:1.593797268):1.113350273):1.013312672):0.3188357074,t398:4.0210226):0.9997975625):2.757995167,((t399:0.7638940544,t400:0.7313290311):1.502350801,t401:2.168332764):5.490539308):1.856166207,(t402:5.05810402,((t403:2.521144866,(t404:0.2151543062,t405:0.1596281805):2.304371985):1.34312046,t406:3.771782476):1.03513828):4.441513281):1.768411752):1.845116358,(((t407:5.926945738,t408:5.856259567):5.693492091,(((t409:3.674747006,((t410:2.035315571,t411:2.0307502):0.5597099749,(t412:1.288327168,((t413:0.3384547146,t414:0.2976926915):0.3634526918,t415:0.5959000768):0.4669779572):1.266037298):0.9804172139):1.451788299,((t416:1.877542234,t417:1.822096255):1.922408291,(t418:3.060470065,t419:2.898541395):0.6596434576):0.5814114525):0.6527186881,t421:4.354606662):5.725025007):0.8010773839,((((t422:2.670103645,((t423:1.003872005,t425:0.6596083454):1.316701159,(t426:1.565678086,((t427:1.017151468,t428:0.8798599113):0.4882264104,t429:1.232467926):0.04742378466):0.3887295636):0.2283117784):1.603845934,((((t431:1.242227894,t433:0.6531966059):0.07601554153,t434:0.3068923809):0.7838648781,((t435:0.3720611384,t436:0.2483477926):0.4653977175,t437:0.629722705):0.1986066767):0.05299892165,t438:0.7871882199):1.259910882):0.9208064595,((t439:0.763017567,t440:0.6719774055):0.403883139,t441:0.9149235123):1.536064744):0.5878521408,t442:2.935275989):5.08600402):0.4331833264):1.678548827,t443:10.12165374):7.358609807):20.14414826,(((t444:0.9080722433,t445:0.8238126131):0.04170892406,t446:0.7201341502):1.079128649,t447:1.449669413):35.52699533):9.973094293):23.47248535,((t448:0.8489315268,t449:0.7967006411):1.597214861,t450:2.242516141):67.94117585):8.302912322,((t451:7.888290263,(t452:3.73999409,((t453:0.3674788042,t454:0.2977185235):1.945431786,((t455:0.6913979562,(t456:0.3485653653,t457:0.3206144582):0.2932206509):0.5224182241,t458:0.8816778017):0.8711663024):1.327273823):4.108350974):8.333843599,((t459:7.740424013,((((t460:0.3048192289,t461:0.2554047987):2.999155111,t462:3.161703621):2.633454866,t463:5.738606701):1.110210676,(((t464:1.891868336,t465:1.870839037):0.5418525312,(t466:1.375240643,t467:1.228896516):0.9244852042):1.353978089,t468:3.396953111):3.03887388):0.6114841477):0.1617342739,t469:7.191065656):7.535454891):62.15081896);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T12.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
