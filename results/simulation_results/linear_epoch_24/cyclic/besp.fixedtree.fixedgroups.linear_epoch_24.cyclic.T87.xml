<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t424:3.102940827,(t425:2.18591557,((t426:0.9158224913,t427:0.8567826103):1.060463043,t428:1.74986119):0.1377502396):0.6387396481):0.570111776,(t429:1.10551527,(t430:0.5985476535,t431:0.5706091502):0.4575613452):1.962664069):11.01000476,(((t432:2.864088097,t433:2.835723375):0.117251483,((t434:0.6336030432,t435:0.5436341151):0.5237700978,t436:0.9972802451):1.734369437):8.666433096,((((t437:0.8639200724,t438:0.8064065639):0.1796153665,(t439:0.7643142834,t440:0.7489344392):0.1898945624):2.804387967,((t441:1.625300855,t442:1.557854217):1.159287399,((t443:0.935689324,(t444:0.3464317111,t446:0.03482168436):0.4885120071):0.1560254612,t447:0.6186146361):1.6134248):0.8950835105):7.072038917,((t448:0.8044702388,(t449:0.3703666352,t450:0.3047189195):0.2257125155):1.432096152,t451:1.848685422):7.66719792):0.4741682983):2.238589111):7.07743315,((((t452:1.399575153,t453:0.9703496483):2.652105625,(t454:3.31676102,t456:2.936708778):0.3014859541):4.235559867,((((t458:0.2087238792,t459:0.1462761651):0.7888294916,t460:0.8218840765):1.721138899,t461:2.231741854):4.093333251,t462:6.261941423):0.4252302276):0.06002715111,(t463:0.3596227884,t464:0.3349200718):6.212981472):10.89997326):11.18280468,((t465:6.91584469,t466:6.856567608):13.18360438,((((t467:8.608520375,(t468:3.593031575,t469:3.424292913):4.756575978):2.938680074,((t470:8.943195126,(t471:0.9746222007,t472:0.9732082063):7.930697618):0.2493305793,((t473:4.606760136,(t474:3.346499013,t475:3.271441029):1.229213096):1.568802489,(t476:3.508118149,t477:3.475551325):2.542211698):2.812568933):1.914395851):0.2329621557,(t478:2.723470588,t479:2.621534414):8.241592359):7.718559506,(t480:17.94792804,(t481:6.961603704,(((t457:0.05000123284,((t455:0.04565583413,(t445:0.005028515837,(((t361:0.3014319131,(t349:0.05446443159,((t346:0.007285890953,(t341:0.04884047307,(((t323:0.08448776558,t324:0.06610199857):0.04036725234,(t280:0.1381659647,(t256:0.0179552597,(t247:0.1367785856,((((t144:0.01996436107,((t126:0.2343327418,(t123:0.02709013689,(t99:0.02580120232,((t56:0.1787762944,((t1:3.529214513,t2:3.33021627):1.942562386,(t3:3.915721707,(t4:3.13358321,t5:3.015173065):0.6345551459):1.267636874):0.8078410394):0.6569396512,((t6:2.955160426,t7:2.740964471):0.06410251801,t8:2.791427187):3.221815488):4.053335762):2.367048145):0.4631599897):0.53674886,(((((t9:3.528828105,t10:3.521859339):1.934143638,t11:5.380123586):0.1964454249,(((t12:2.192535469,(t13:1.349641096,t14:1.120349892):0.2746473287):0.2393101471,t15:1.619898093):1.791026904,t16:3.375613386):1.246156528):2.767384019,((((t17:3.633751718,(t18:1.47820813,t19:1.447081537):2.118832723):0.2569106998,((((t20:0.7573580845,t21:0.7337962446):0.5567952662,t22:1.207647269):1.378734384,t23:2.324802748):0.4588883084,t24:2.676925863):0.34277698):0.7112670478,(t25:0.696086308,t26:0.6272466546):3.014104671):0.1948184647,((t27:3.005086006,t28:2.704597165):0.2548892703,(t29:0.5221121086,t30:0.5045187332):2.411181174):0.4745345962):2.478607026):4.549774379,(t31:2.234498337,((t32:0.03315581089,t33:0.01510063313):1.296445351,((t34:0.1079590822,t35:0.01713010232):0.369975588,t36:0.1304489723):0.8082349707):0.8833517143):8.180068457):0.3754105263):1.348566863):1.409621482,((((t37:7.545459605,(t38:6.915858433,(t39:2.677024416,((t40:0.4808614783,t41:0.3948672547):0.1481248887,t42:0.2752339556):2.018267017):4.203990431):0.6029427248):1.184342514,(t43:0.379274581,t44:0.3195558432):7.80448137):1.11003611,(t45:8.886835338,(((t46:2.435458536,t47:2.268161227):1.073630591,t48:3.277757013):3.698109082,((t49:1.265741131,(t50:1.001806816,t51:0.5533156867):0.2488170346):3.747845698,(t52:1.651835709,t53:1.515545509):2.826848414):1.930281591):1.542961656):0.3129252941):1.798814717,(((t54:0.7936534629,t55:0.7540556657):5.676362502,(t57:2.698986718,t58:2.423024941):3.287864595):2.319251708,(((((t59:3.340280944,t60:3.272741725):2.836630954,(t61:0.5569219816,t62:0.5390044547):5.497807681):0.4757379893,(t63:5.1664319,(t64:3.968725977,t65:3.944347003):1.035723011):1.039501895):0.9768011003,((t66:5.032145429,t67:4.7987456):0.2884145699,t68:5.068416591):1.581259324):0.09471982231,(t69:4.338064985,t70:4.29669246):2.365477646):0.1768584842):1.089353254):1.365581598):6.199409739,(((((t71:3.775113628,t72:3.698605147):3.438492433,(((((t73:0.7485974549,t74:0.7027659851):2.356567035,t75:2.965844823):0.5289777295,t76:3.474128306):1.907087838,(t77:2.033761152,t78:2.00776852):3.134858104):0.1711385287,(t79:4.484059353,t80:4.199908889):0.7679614859):0.9050734958):1.25010308,((t81:5.293829521,(((t82:1.133181782,t83:1.095902867):2.309990541,t84:3.315412478):0.04560350787,t85:3.28729477):1.630557241):1.498281597,(((((t86:0.9368970601,t87:0.7653256568):2.221869867,(t88:2.714877862,t89:2.609430411):0.2645175818):1.89363483,(t90:3.459639935,(((t91:0.7479798511,t92:0.5999677285):0.01023721455,t93:0.5636799723):1.160788671,t94:1.713341986):1.337267461):1.144577651):0.500174178,(t95:2.854461894,t96:2.794339978):1.837777023):0.04648530966,(t97:3.246803629,(((t98:1.258890338,t100:1.221250249):0.1396391132,t101:1.037449782):1.114360043,(t102:1.014408884,((t103:0.5769282846,(t104:0.2720299402,t105:0.2449890931):0.2741270181):0.1081682851,t106:0.5042243798):0.01182148374):1.06375359):0.6984731358):1.290557295):0.7243763353):0.2771799454):1.288173526,((t107:1.68455042,t108:1.655421616):0.03180783603,t109:1.669149262):4.091205149):4.57870138,((t110:0.7604075023,t111:0.712993809):9.221357888,(((((t112:0.2972284872,t113:0.1647987678):1.670285821,t114:1.452252599):0.5149036329,((t115:0.9726091892,t116:0.9606831836):0.1236969426,t117:1.002366732):0.8022007348):0.4405541989,(t118:1.275073259,t119:1.144305804):0.9690520806):5.907775345,(((t120:0.1957153494,t121:0.08624734518):1.346396006,t122:1.431158605):2.234218576,(t124:0.7685134561,(t125:0.5972085147,t127:0.2909866272):0.01783365359):2.691107232):4.100360881):1.103020366):0.3019443777):0.9869918448):1.049930081,(((t128:2.893858841,((t129:0.7107625996,t130:0.698923898):1.051765747,t131:1.746192423):1.077920904):5.662930997,((((t132:0.2263590083,t133:0.1553777008):0.69456878,t134:0.7762068111):5.704506174,(((t135:0.3921838665,t136:0.2543282021):0.7633753086,(t137:0.4477731865,t138:0.3954943782):0.5519031414):4.413533505,(t139:1.458793481,(t140:0.5157740265,t141:0.3659745655):0.8402419337):3.762223076):0.5821608447):1.727732445,t142:6.957603422):0.1053792312):0.07975359202,((((t143:0.7552612941,t145:0.5277458323):3.957130618,(t146:4.103621053,(t147:2.997330285,(t148:1.767577865,t149:1.5408061):0.9592604512):1.053845166):0.3023481955):1.158956195,t150:4.956019117):0.3099621991,t151:5.020678944):0.9217500089):1.703204579):1.398290919):0.8938945526):1.9294845):3.803898546):0.873470548,(((((t152:6.272000971,t153:6.16091905):2.021998688,(((t154:3.393323766,((t155:0.5848413792,t156:0.3982832178):1.647862206,t157:1.890636715):0.9861368901):2.757758321,(t158:3.741322782,t159:3.739752773):1.875160045):0.5671862875,t160:6.15660477):1.204844072):4.858528894,((((t161:1.114902837,t162:1.046666278):5.730621485,(t163:1.274303362,(t164:0.3460319633,t165:0.3170237321):0.517800829):5.395302871):2.241967703,(((t166:3.840789911,(t167:2.059922522,t168:1.975259193):1.733886813):0.5939100057,t169:4.198800901):3.850593028,(t170:7.504096337,((t171:3.148037213,t172:3.125645575):0.06526075528,t173:3.180394362):4.243105715):0.381821954):0.1483649671):0.1605104072,(t174:4.144146275,(t175:3.074630236,t176:2.836966024):1.051574238):3.876490228):2.912811122):0.5198913586,(((t177:1.275703257,t178:0.9898001012):2.835454231,t179:3.808842949):1.513943521,((t180:4.216868446,(t181:3.207738761,t182:3.049324876):0.9494140215):0.9012551036,t183:4.865440127):0.1360799502):5.554106105):0.08429844057,(((t184:2.617462704,(((t185:1.524482459,t186:1.49229404):0.01319692719,t187:1.407972627):0.4102232558,t188:1.814387947):0.6576007816):1.727137048,((t189:2.536980599,((t190:0.789635812,(t191:0.2846074094,t192:0.2318070274):0.3438675395):1.648101903,t193:2.175295037):0.08032620603):0.5157079435,t194:2.618418585):1.132349785):1.031028235,(((t195:3.150134304,t196:3.124691594):0.4530770141,((t197:1.953967852,(t198:1.696461147,t199:1.571946116):0.2375793579):0.1190364125,(t200:1.613109725,t201:1.575478468):0.1915272226):1.433473868):0.6789494146,((t202:2.296819823,t203:2.25524413):0.05161129759,t204:2.054449582):1.408323637):0.4782876225):5.213459712):2.707444506):1.286074027):0.2164539422):0.08743906779,(((t205:0.3393134303,t206:0.3207752645):4.096418624,(((t207:1.700349052,(t208:1.117430282,t209:0.8982886503):0.5491083396):0.4104981297,(t210:0.6730325929,t211:0.6220446275):1.144124756):1.428826148,(((t212:1.285441946,(t213:0.8872279196,((t214:0.1250494823,t215:0.0979070875):0.7109956327,t216:0.6231633641):0.03683805366):0.2267749357):1.006925833,t217:1.657310823):0.7675221805,(t218:1.45281054,t219:1.305052685):0.9641710507):0.09568692855):0.7587765737):1.990487023,((((t220:1.184878021,t221:0.9578522402):0.2386758122,t222:1.149419766):1.39874749,t223:2.354134521):0.4674583887,((t224:0.2727053611,t225:0.2539976615):0.8281998178,(t226:0.7311125711,t227:0.5166118743):0.2840396787):1.528928142):1.776989339):6.717529787):0.4816862709):1.152405697):0.6239129127,((((((t228:0.04142961325,t229:0.01320810662):0.1176087179,t230:0.09586412716):1.03983092,(((t231:0.6677401901,t232:0.6418682637):0.0003279006198,t233:0.5924521343):0.0717903525,t234:0.5506169352):0.248916005):1.558992217,t235:2.286280789):5.54781168,((t236:2.60089263,t237:2.56000673):1.409763088,(((t238:0.3339259207,(t239:0.08068496253,t240:0.0393927771):0.1817503062):0.5924518208,t241:0.566578471):0.8438425175,t242:1.359940351):2.185925638):3.80193976):2.102628864,((t243:4.375968153,(t244:0.9850937492,t245:0.7643046995):3.20067404):3.372403062,((t246:1.369286367,(t248:0.4504859188,t249:0.3715595329):0.748705415):1.37666284,t250:2.46728966):4.558732847):1.586127993):2.611308713):5.00338371,((((t251:0.28921355,t252:0.1628027388):0.8153628291,t253:0.7152965326):6.080190763,(t254:6.474566909,t255:6.446960417):0.1203064161):4.93627254,(((((((t257:2.408240149,t258:2.332008486):1.681410416,t259:3.896187805):0.3707097281,((t260:1.277266375,(t261:0.743346213,t262:0.7104316239):0.3865481523):2.264947265,t263:3.361846857):0.6598090258):0.1818482243,(t264:0.552875011,t265:0.54681478):3.597114858):1.252092729,t266:5.36871021):1.877776946,t267:7.091543913):0.003665972434,t268:7.005623248):3.573248796):4.086268732):1.515554749):1.477801424):0.05878799166,(((t269:3.536565506,t270:3.487072056):0.110569902,t271:3.518720034):12.93839814,((t272:8.721766694,(((t273:6.095734403,t274:6.051201564):1.669287861,(((((t275:0.8897202878,t276:0.7439312532):1.91557838,(t277:1.655683433,t278:1.608169041):0.9670728401):2.764456836,((t279:4.899526614,(((t281:1.120241445,(t282:0.3863103295,t283:0.2845995811):0.7138188174):1.867711372,t284:2.683902234):1.252616714,t285:3.791323978):0.4947608193):0.1373431555,((t286:3.120897088,t287:2.88173515):0.7069578163,t288:3.546263422):0.5176314362):0.1507887021):0.1144798952,(((t289:2.553836383,(t290:1.073889892,t291:1.02146967):1.381158483):1.163410153,t292:3.500107163):0.01306925532,t293:3.424533408):0.5893324957):0.9109996458,((((t294:2.10146378,t295:2.051030082):1.35983924,(t296:1.29935555,t297:1.285120845):2.108616676):1.337233004,(((t298:1.391926062,t299:1.363210944):0.2897492818,t300:1.624547806):1.35058149,t301:2.945281738):1.643278963):0.1127730849,(t302:1.9067129,t303:1.890411217):2.743413237):0.003024533707):0.8465320009):0.6418236925,(((t304:0.6865490854,t305:0.6426387836):3.915216297,((((t306:2.456491797,t307:2.40207419):0.9761112926,t308:3.357823617):0.7716389495,((t309:3.007781034,t310:2.978979638):0.1983282333,((t311:2.309375242,t312:1.902890418):0.4018243575,t313:2.270645157):0.4216994721):0.8507949787):0.1319860401,t314:3.607887179):0.09609635315):0.8295063007,(((((t315:0.4511059627,(t316:0.125558081,t317:0.07218422822):0.2053911177):0.4141663399,t318:0.5580159961):0.6251003699,t319:0.9309359326):0.7157447445,t320:1.526747605):1.986074378,(t321:1.913338785,t322:1.75100255):1.392858812):0.1639004025):0.5832420996):0.2369822464):4.122510083,(t325:0.6964951981,t326:0.5913858143):7.382785281):3.610457426):1.060712429):0.3462261632):0.8516226684,((((t327:1.638775661,t328:1.569208515):1.328358641,t329:2.851872345):7.720505472,((((((t330:1.675294197,(((t331:0.2334916304,t332:0.2204286149):0.3165055698,t333:0.5007783784):0.4165311264,t334:0.72696335):0.5723415106):0.3703972313,(t335:0.3591623513,t336:0.3011690208):1.04406499):2.416821346,(t337:3.380406241,((t338:1.26241093,(t339:0.2948764778,t340:0.1198612611):0.8668208975):1.576776737,((t342:0.8616826652,t343:0.8541404489):0.7282975073,t344:1.512455605):0.6491205396):0.3725025338):0.04924477109):3.809584411,t345:6.361928573):0.8162746277,t347:6.989313273):1.027319019,(t348:1.922586274,t350:1.508026102):5.994191405):0.4236099027):2.737400032,(((t351:0.4639828711,(t352:0.2132124553,t353:0.07419167101):0.1705999563):7.476688385,((t354:1.850141631,(t355:1.558680371,t356:1.522538196):0.1850116597):4.479600344,(t357:2.476453223,(t358:0.6977033854,t359:0.6913381048):1.770221921):3.702085518):1.390083148):2.453603318,(((t360:7.2636,(((((t362:0.2081304809,t363:0.08226847525):3.992253955,t364:4.071520368):0.7722459525,(t365:1.894871817,t366:1.652198593):2.920826475):0.4401832539,(t367:0.3577321123,t368:0.2967878495):4.404131346):0.795967616,((t369:0.9819783466,t370:0.9732885463):1.115788863,t371:1.979476988):3.377907545):0.5030944409):0.8659991781,(t372:6.116530473,(((((t373:0.3730124573,t374:0.3325949877):4.512418636,t375:4.732115447):0.04508099429,t376:4.735329276):0.4028548142,(((t377:2.659813003,(t378:0.6930677794,t379:0.4926664923):1.958333487):1.903900382,(t380:4.247675847,(t381:3.893755928,t382:3.890681837):0.2601239209):0.1049033928):0.2624802141,t383:4.499034284):0.2082904023):0.3556534682,(t384:3.429961901,t385:3.350916747):1.256574701):0.3949128695):0.2236661273):0.9393204928,(t386:3.535269454,((t387:1.3647251,(t388:0.1014895751,t389:0.08336926159):1.224932041):1.794700991,t390:3.073906073):0.342016404):2.435343522):0.788178095):0.2552959928):0.2935288957):0.8932687462,(t391:6.107006424,(t392:1.940207714,t393:1.862654934):3.946672529):1.972301474):7.623387172):10.75543917):0.4420643062):0.3623313154):8.524926548):74.40633424,(((((t394:3.685305141,((t395:3.192285814,(t396:2.844610517,(t397:1.151422287,(t398:0.3462191765,t399:0.2359672343):0.6216053908):1.662280214):0.2018024018):0.2335636878,(((t400:0.3925607337,t401:0.3294443025):1.786119931,t402:2.095730811):0.7296129902,t403:2.753004305):0.007811025225):0.2403748978):0.2917586144,((t404:2.5209362,(((t405:0.8582042488,t406:0.7494831066):0.7996072803,(t407:1.403356245,t408:1.394485211):0.105289846):0.4224578624,(t409:0.9553951427,t410:0.8858858097):0.8079869976):0.377563433):0.2551900104,(t411:1.392333622,(t412:0.4827292666,t413:0.4676220382):0.8347414548):0.896755426):0.5163755809):1.024666788,t414:3.611230701):0.08108308345,((t415:1.439029426,t416:1.266850037):1.984179926,t417:3.124771256):0.1706595625):2.852404131,((((t418:0.8516178356,t419:0.7522938313):0.6989911002,(t420:1.043580877,t421:1.000305386):0.04139827824):0.3787682825,t422:1.401178184):2.550617696,t423:3.901327845):1.571482313):101.9015633);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T87.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
