<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t468:1.409115298,((t469:0.2149818607,t470:0.1325470701):0.1189061606,t471:0.194311677):1.040206813):4.921142357,(t472:5.598446734,t473:5.5730765):0.4501088694):1.868607957,(t474:1.140991201,t475:1.08308947):6.748266312):10.73869059,(((t476:5.213430071,((t477:1.141759721,(t478:0.1242156359,(t455:0.1130723743,((((((t408:0.0795693488,t409:0.07657345172):0.04598836407,((((((t322:0.01483862562,(t297:0.04970466473,(t278:0.02361611428,(t256:0.1251372029,(t243:0.01075032939,((t231:0.1010459066,((t168:0.09897855259,(t158:0.04246411576,((t144:0.2105066217,(t139:0.1216054306,(t138:0.1648845987,((((t61:0.08462175291,(((t51:0.005501829286,(t25:0.02507029384,t1:2.309991921):2.033871916):0.6197182921,(t2:2.82374113,t3:2.821916175):2.102174553):0.09612544701,(((t4:2.5815524,t5:2.34455679):1.403988063,t6:3.744747089):0.8390741099,((t7:3.780325656,(t8:1.974494638,(t9:0.942595514,t10:0.7374197109):0.997153439):1.794226363):0.1371764035,t11:3.532309784):0.662587905):0.1658539846):0.05421742142):1.35315361,((t12:3.245300714,(((t13:1.527578485,t14:1.319255333):0.8612316605,t15:2.166267406):0.2626152232,t16:2.231163383):0.5058251399):1.051849965,(((t17:1.935082329,t18:1.905213767):0.202815955,(t19:0.7381370377,t20:0.608550627):1.360237905):0.9346609878,((t21:1.453525336,t22:0.9771405076):0.7772802447,t23:1.585005014):0.6107820039):0.6003994098):1.466897111):0.7810812105,((((t24:2.390303741,((t26:0.1078382502,t27:0.09906102808):2.134348121,((t28:1.061286428,t29:1.015983524):0.3816863493,(t30:1.301018521,t31:1.182397815):0.07814097889):0.7665453928):0.0676319775):0.1750220978,t32:2.162541445):0.08644926784,((t33:0.3676475435,t34:0.332725468):0.9383518841,(t35:0.7921102021,t36:0.7143210924):0.318865864):0.920507542):0.3064571368,t37:2.170767581):2.005483425):2.531301882,t38:6.427597341):2.518238689):0.2387226528):0.6076490293):1.691815971,(((((t39:0.6002811775,t40:0.5266530727):0.5962256754,t41:1.04769611):0.2312010761,(t42:0.8363365269,t43:0.6947480588):0.431365251):1.718165942,((t44:1.097109884,t45:0.9335752464):1.496145603,t46:2.413342045):0.1734753832):6.794745663,((t47:0.495456605,t48:0.4827923758):4.644921681,((((t49:0.8426141384,(t50:0.6375017521,t52:0.5003228757):0.1429863384):0.08798189428,t53:0.7063446888):0.2262506825,t54:0.7481076131):0.1948508918,t55:0.9132754254):3.739810916):4.092815476):1.492007668):0.3022958986):0.940601883):0.1274956889,(((t56:7.820406195,(((t57:1.461064877,t58:1.335587803):1.577762077,(t59:0.7679745016,t60:0.7350058283):2.125759262):3.097349987,((((t62:0.2975371734,t63:0.2196324936):0.07912736513,t64:0.2274136297):0.6216682148,t65:0.7815896584):1.320023122,(t66:0.5634043618,t67:0.5562018851):1.533342604):3.368273859):1.623175841):0.4682536851,t68:7.531842651):2.553698181,(((t69:2.996394532,(t70:0.7912259543,t71:0.6745900115):2.041089753):3.699029271,t72:6.206339667):0.8990929861,((t73:0.8909489027,t74:0.8557342886):1.313562356,(t75:0.5580503379,t76:0.3622641305):1.593184437):4.882533712):2.391674488):0.698818005):6.203632415):1.330895613,((((t77:7.725348741,((t78:0.1949560243,t79:0.1139734198):3.053117578,t80:2.911121805):4.440233353):0.195349093,((t81:2.309036788,t82:2.285793972):5.172904412,(t83:1.563773766,t84:1.534954651):5.877781163):0.02127092296):0.7000693605,((t85:5.038846663,((t86:2.452560824,t87:2.404184678):0.7521477464,t88:3.141552145):1.776974824):0.7904195417,t89:5.589346127):2.211862082):7.934993127,(((((((((t90:3.877491287,t91:3.832249651):0.1523631311,t92:3.961603795):0.7152815152,(t93:3.863842345,t94:3.792983498):0.7773507511):0.8547324062,(t95:0.0845980973,t96:0.07385050021):5.273717152):1.688891379,((((((t97:1.77581441,(t98:1.180447061,t99:1.060609484):0.4376341515):2.827634522,(t100:3.766156111,(t101:1.095020809,t102:1.050476271):2.659505613):0.4498787641):0.6135560459,((t103:0.7705448306,t104:0.7196322646):1.273425688,t105:1.941778087):2.551413772):0.1296177876,t106:4.519399739):0.2286659854,((t107:3.65619294,(t108:3.505819826,(t109:2.135075903,t110:2.120767591):1.355765574):0.01071620503):0.01728146175,(t111:2.273343368,t112:2.174804639):1.004077966):1.042089812):0.6403380539,(t113:0.127658458,t114:0.07140260525):4.630664602):0.3998143247):0.2071602228,((t115:3.332058107,((t116:1.472259273,t117:1.458328528):0.140607263,t118:1.572183015):1.242529482):1.708426216,t119:4.501775897):0.2477559804):1.612769223,((t120:3.367106692,(t121:0.2488694693,t122:0.1185644142):2.977928686):0.3071279201,(t123:2.937942446,((t124:1.166659961,((t125:0.5262415232,t126:0.398491194):0.05764884781,t127:0.4446393363):0.5769785073):1.228428033,t128:2.138280994):0.5279808002):0.4548443587):2.591145468):4.324466317,((((t129:1.083539717,(t130:0.08172764298,t131:0.04609402636):0.8941874073):1.185184006,t132:2.055709228):0.08154944106,t133:1.933067007):0.922239633,((t134:1.995935967,(((t135:0.7332727382,t136:0.6849263789):0.741707938,t137:1.364928948):0.2941051716,t140:1.102887139):0.1166680285):0.09104114663,t141:1.309278456):0.6466936411):6.67723387):1.829426384,(((t142:1.053427168,(t143:0.717208878,t145:0.4735738899):0.08890966182):1.203993635,(t146:0.913606607,(t147:0.7482670235,t148:0.5837170757):0.1593140895):0.6328988102):7.457332466,((((t149:0.7226584711,t150:0.4944213744):0.4161625423,t151:0.8382345891):5.701625981,(t152:1.606398262,((t153:0.8486321911,t154:0.7034282957):0.2211443991,t155:0.7297671416):0.4193441941):4.920862517):0.7771287344,((t156:3.292498507,t157:2.851606863):0.520018215,t159:3.026646598):3.03207054):1.025472081):0.7152537538):0.1360404123):0.496303144):0.09789957819):0.7435134679):2.803686591):1.832978365):2.479294581):0.0008831958173,(((((t160:7.412175229,(((t161:0.154021016,t162:0.1529536002):4.725726771,(t163:4.70090739,(t164:2.801496551,(t165:0.3673560115,(t166:0.1908235107,t167:0.1727698719):0.07210973177):2.269510822):1.863713734):0.162253175):1.565998872,((t169:0.4334549951,t170:0.3308840353):0.5319858251,t171:0.5271077969):4.641178193):0.9321454024):0.3680104697,t172:6.401311281):1.743179709,(t173:7.351362358,((t174:6.012585103,((t175:0.6927213874,t176:0.5567033021):4.550386594,(t177:4.856913702,(t178:3.90690319,t179:3.870870618):0.935618855):0.1247806283):0.7241549381):0.516458097,(t180:4.532733752,(t181:4.279948827,(t182:0.7347496625,t183:0.7272482018):3.510145697):0.1782253741):1.621725064):0.7709622901):0.7830852466):0.4570151629,((t184:6.2830069,t185:6.23369011):0.1570312379,(t186:5.782678375,((((t187:0.4604383241,t188:0.230168729):1.63896988,t189:1.338110518):2.341240867,t190:3.505086846):1.27684618,t191:4.685803174):0.03580564242):0.108650776):1.431444504):3.646238072,(((((t192:3.294654158,t193:3.276853649):1.653243,((t194:3.375930526,((t195:2.91188149,t196:2.862066209):0.03420017273,t197:2.762396207):0.4265993704):0.522722428,(t198:2.035909873,t199:1.942648592):1.624412817):0.9607277421):0.8022120583,t200:5.311233306):0.208654431,((t201:4.166685786,(t202:2.956178518,((t203:0.5019741821,t204:0.48436539):2.205463329,(t205:1.931887914,(t206:1.458919182,t207:1.392651058):0.4670024774):0.6406404822):0.2226853452):1.160075411):1.076827633,(((t208:1.205175414,t209:1.170791858):0.7924144563,((t210:1.712629916,(t211:1.571739362,(t212:1.349865258,t213:1.223348266):0.1475089914):0.06560548503):0.05549701492,t214:1.403003481):0.108908527):2.317950506,(t215:2.620688876,((t216:0.2973599809,t217:0.2807676329):2.011699699,(t218:2.013686683,(t219:1.095742783,(t220:0.2878215121,t221:0.2436094469):0.74178365):0.7187295891):0.2704945733):0.05697612774):1.152752695):0.6160209606):0.2480361976):0.7186591491,(((t222:2.099511008,t223:1.930661155):0.7117830153,(t224:1.477741593,t225:1.17970076):1.095829271):1.114882803,t226:3.333379425):0.760314076):3.096213831):2.743879627):1.246410386,(t227:7.596065957,(((t228:1.661825777,t229:1.650025794):0.3544789613,t230:1.935885131):2.079442794,(((t232:1.068856035,t233:1.059116259):1.431896725,((t234:1.538085433,t235:1.506066686):0.4004927683,t236:1.731311026):0.542571291):0.2732994357,(((t237:0.5447830693,(t238:0.1688256232,t239:0.05171992037):0.1864568362):0.06948747646,t240:0.2860357857):1.257123772,t241:1.270650673):0.6167519894):1.073867169):3.382804813):3.254117225):0.5377885355,(((t242:3.139421854,(t244:1.251264787,(t245:0.6177042986,t246:0.5458297718):0.6150582909):1.769488014):1.576984442,(((((t247:0.2229989627,t248:0.2022321848):0.4319496168,t249:0.5788303305):0.9710943784,(t250:0.729349218,t251:0.6849770836):0.7705063292):0.3996476423,(t252:0.02632587003,t253:0.01580304393):1.726461154):0.822528834,t254:2.541844244):1.577241567):1.671585366,t255:5.723106359):3.312883636):0.283695624,(((t257:2.173427737,t258:2.130827731):1.082474305,((t259:0.4674994442,t260:0.1328415339):0.4289035023,t261:0.5512043739):2.252665048):5.568316985,((((t262:0.1799070394,t263:0.1606641195):1.011696542,t264:1.09131664):4.173180433,((t265:1.036404715,(t266:0.162544664,t267:0.1319453246):0.7374804076):1.273445412,(t268:1.000140935,t269:0.9978881731):1.112293318):2.940808245):2.062622347,t270:6.94392972):0.9148474092):0.2993232511):3.425805893,(((((t271:0.2251912787,t272:0.1072558457):0.7171804828,t273:0.7720875186):3.31819467,(t274:1.225318209,t275:0.4698083102):2.497252321):3.514386974,(t276:1.102064296,t277:1.068606534):5.237980226):1.849750873,((t279:1.19826624,t280:1.183084554):5.812383825,(((t281:0.7418033821,t282:0.7128080614):5.948021039,((t283:4.380654976,(t284:0.8419464121,t285:0.6349898733):3.532053869):1.08318301,t286:5.239214652):1.062428924):0.1756804857,(t287:5.853231395,(t288:2.533576291,t289:2.448705505):3.245874193):0.5701281733):0.06444578987):0.8949849912):1.884331136):3.282355332):0.6655700301,((((((((t290:1.112349929,t291:0.9639864595):3.692872909,((t292:2.985131975,t293:2.8714959):0.0916804901,(t294:0.8651599612,t295:0.6768353104):1.938187834):1.427586814):1.337704194,(t296:3.074402485,t298:2.770019782):2.097290953):1.349915135,(((((t299:1.006827568,t300:0.982169363):2.565271374,(t301:2.546996084,(t302:2.233321343,t303:2.136684777):0.1375388453):0.8208902406):0.6949299542,(t304:2.810806805,(t305:0.5985393712,t306:0.5706959541):2.211673476):0.977548343):0.8592565437,(((t307:0.8319737705,t308:0.7695158034):2.416596318,(t309:0.5563940472,t310:0.5119201747):2.625866027):0.2465778221,((((t311:1.284719625,t312:1.105229121):0.7621128959,t313:1.809466484):0.4527422903,t314:2.20268016):0.5523559354,t315:2.729742893):0.2555821694):0.9862278973):0.6028502001,((t316:3.156448262,((t317:1.831909626,t318:1.725939473):0.7328679961,t319:2.401549988):0.05994870879):0.707943879,(((t320:1.433719857,(t321:1.067746978,t323:0.6610927467):0.3429510224):0.5096648438,((t324:0.5085422171,(t325:0.07469901516,t326:0.05569991077):0.3092609835):0.7438275738,(t327:0.4579914264,t328:0.4500004403):0.5814629235):0.2589659968):0.9073773231,t329:1.776546458):0.288262004):0.5771341188):0.4176817607):0.1405076871,((t330:2.126055741,((t331:0.2511878112,t332:0.2123646937):1.52164852,((t333:0.6948921907,t334:0.5909638394):0.6492528699,(t335:0.3239335665,t336:0.2125922027):0.8905768497):0.3525812051):0.2394162965):0.6036810788,t337:2.269856085):0.3702273706):1.83070364,((t338:1.553023068,t339:1.290204615):1.743942287,((t340:0.9757569333,t341:0.9435194371):0.8996928852,((t342:0.9303850149,(t343:0.524577943,t344:0.4184567438):0.237231623):0.2107648719,t345:0.8572913989):0.4132649131):1.055027602):1.115376627):1.926164571,((t346:1.416569081,(t347:0.8058954964,t348:0.6162781396):0.5030998028):2.408986244,t349:3.352694571):1.508049525):1.26374826,((t350:0.2512263735,t351:0.2212077538):4.802135353,((t352:0.2924893427,t353:0.2920696244):3.114723505,(t354:0.4682401658,t355:0.292900189):2.922745955):1.531614205):0.5386346377):0.3549534162):3.013092296,(t356:1.362984691,t357:1.233504988):7.240713067):0.2882058825,((t358:5.39366402,(t359:3.625229701,((((t360:0.5998440772,t361:0.4728827929):0.3915021791,t362:0.729309318):0.01618185422,t363:0.7373020584):2.17394079,(t364:1.926806226,t365:1.731766069):0.809413178):0.3146130589):1.637190449):3.286194335,(t366:5.672367561,t367:5.482334817):2.050381757):0.007326460691):0.5269759203,t368:7.985742183):0.659333853):2.304960692):1.005290309):2.449630384,((t369:5.94180196,(((t370:0.416720642,t371:0.2274397908):3.172072534,(t372:0.261418615,t373:0.2507904861):3.138036881):2.123936426,t374:5.384979126):0.04386250237):3.920648287,((t375:5.292176773,(((t376:1.687234659,t377:1.627112237):2.068045794,t378:3.674471625):0.4281353708,t379:4.094642359):1.040724077):0.2450022168,t380:5.192203168):3.809073014):4.533083585):1.62099996):0.4348860671,((t381:0.7609470068,t382:0.4296825538):6.783613309,((t383:4.190989895,(t384:3.48992155,t385:3.481051015):0.6417153555):1.139614388,((((t386:0.9865799632,t387:0.9442975066):0.6888295804,t388:1.583105207):2.267183238,((t389:2.386483139,t390:2.351867897):1.13933275,(((t391:1.456741048,t392:1.367651162):0.5599104657,t393:1.907676562):0.3411340823,t394:2.217319792):0.9568135469):0.2505117435):1.138241341,(t395:3.823921763,((t396:2.233712682,(t397:0.4781139974,t398:0.3577843175):1.691631713):1.288503456,t399:3.31072552):0.2578026742):0.7380376735):0.1318712118):1.520743492):7.716041248):12.52888538,((((((t400:4.862164762,((t401:2.87930355,t402:2.836939383):1.23765416,t403:4.056159694):0.7133552435):0.2350237653,(((t404:2.504441612,t405:2.446650327):0.5449985241,(t406:2.641761966,t407:2.532429996):0.2247030205):0.3348403596,((t410:1.66701447,(t411:0.9246966368,t412:0.9078066204):0.7277448571):0.9361795574,(t413:1.360877573,t414:1.323811149):1.148745979):0.3541019357):1.570093604):2.384316114,((t415:1.933644849,t416:1.806386895):2.261616865,(((t417:1.5505918,t418:1.496432448):1.477933935,(t419:1.558671231,t420:1.399621911):1.288990854):0.5321312409,(t421:2.892380532,(t422:0.8936991173,t423:0.5416800853):1.785128895):0.3129203598):0.3517435644):2.583246128):0.2659038958,t424:5.707761706):5.155876322,(((t425:1.199461273,t426:0.9825908091):0.6206456705,t427:1.592288686):0.8955129649,((t428:0.3919882812,t429:0.3473353093):1.660663848,t430:2.006151245):0.367610147):8.080484828):1.484918087,((((t431:2.766367396,((t432:1.686194754,(t433:0.8055242747,(t434:0.4003129518,t435:0.3348356835):0.3944881283):0.744196012):0.4553949653,(t436:1.04138808,(t437:0.3201377346,t438:0.1697366849):0.6750712204):0.8154145817):0.4529384548):3.823197166,((((t439:0.04298341595,t440:0.000972829245):0.9128802138,(t441:0.5068181067,t442:0.4884134413):0.3526629693):0.07733479256,t443:0.5077716773):2.397947997,t444:2.470371333):2.419730779):4.006779318,t445:8.84017376):0.858955276,((t446:1.023899124,t447:0.9258189973):2.658953355,(t448:0.9366134825,t449:0.7629617002):2.534710282):5.975509589):0.4587364078):11.67768458):0.263607679):57.42203487,((((t450:0.1192492773,t451:0.08808905544):8.009353163,(t452:1.305194194,t453:1.258263503):6.122753343):10.14001276,((t454:0.4587831355,t456:0.04491681208):8.937112641,(((t457:4.570047386,((t458:0.8848232556,t459:0.8816684442):1.822838703,t460:2.288232695):1.71829935):3.275269202,(t461:5.112686815,t462:4.976364909):2.168266972):0.7121740672,(t463:6.579441786,(t464:0.7695758379,t465:0.7322478242):5.678146126):0.9636503433):0.4067173629):7.973715049):3.696076727,(t466:17.83529627,t467:17.67802137):1.595450734):57.10008531);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T70.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
