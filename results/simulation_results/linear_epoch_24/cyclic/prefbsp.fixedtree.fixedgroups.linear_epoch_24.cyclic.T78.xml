<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t478:4.968426659,t479:4.844289026):3.243082656,(t480:5.98733158,(t481:0.8181507809,t482:0.806490666):5.101853837):2.058707662):150.8406765,(((t483:0.7934905049,t484:0.7854504027):28.28207454,((t485:5.942110512,t486:5.940818462):9.195203643,(t487:7.756059582,((t488:5.365554047,t489:5.355255235):0.6069514883,t490:5.895654359):1.764935946):7.185734737):13.81825479):28.91482497,(((((t491:1.85387342,(t492:0.5076823591,t493:0.4817589073):1.301856488):3.7675102,t494:5.471205491):4.138470158,(t495:5.756624802,(t496:3.208312924,t497:2.770993995):2.527638782):3.623052902):7.814459887,((t498:5.795021634,((t499:4.777073192,t500:4.719906388):0.3259257256,(t501:0.3590864368,((((t382:0.1543366605,(t376:0.02766465235,(t374:0.06312253533,((((((t231:0.005074229841,(t207:0.0932132379,((t148:0.001269028352,(t146:0.2684996211,(((t76:0.04225112057,((t46:0.1850637514,(t1:1.377409797,t2:1.368784304):2.299846551):2.69340095,((t3:3.562958704,(t4:3.168670009,t5:3.148044452):0.3717633769):0.2479688459,(t6:2.357588877,(t7:1.680755987,(t8:1.383587786,t9:1.355619624):0.2376474733):0.6516118367):1.372385538):2.509693645):0.8365249972):5.535612152,(((t10:2.760155296,t11:2.744374282):3.77407709,(t12:5.957642473,(t13:4.02615647,(t14:3.241336232,(t15:1.62309161,t16:1.527735137):1.567691959):0.6450751205):1.865983):0.5336076346):0.0946641591,((t17:0.8945255309,t18:0.8215914775):3.555898122,((t19:3.193920138,(t20:2.480714704,(t21:1.944276181,t22:1.885559067):0.4782758477):0.6020091453):0.7500798379,(t23:3.2563035,t24:3.183362986):0.2709263316):0.278783687):1.392422149):5.83161106):0.01156010451,((((t25:1.428759437,t26:1.419892587):0.5502577154,t27:1.828228564):0.1321207946,t28:1.910156205):4.252245162,((((t29:1.581757463,t30:1.539888034):0.5740457543,t31:2.061597942):0.0150369238,(t32:0.9787986927,t33:0.964191171):1.057233853):1.887144899,(t34:1.162653529,t35:1.153905444):2.657605593):2.01860272):4.468580896):1.628431943):0.4129125252):2.993760952,(((t36:1.769956621,t37:1.746525341):0.6918915048,((t38:0.3960734415,t39:0.2479981109):1.157337625,t40:1.294603897):0.8331813698):0.07688991289,(t41:1.440796978,t42:1.414064206):0.5756896514):12.79111372):1.434282845):1.551949499):3.048866257,((((t43:0.6421910061,(t44:0.5073665113,t45:0.2209347661):0.07065303342):2.650366662,t47:2.702035587):9.399427111,(((((((t48:0.4809376148,t49:0.4706268369):0.7290448851,t50:1.118272511):1.714975746,((t51:1.133100495,t52:0.9043403158):0.6174513546,(t53:0.9183848384,(t54:0.5965403319,t55:0.5259335041):0.19857998):0.5950325652):0.549212109):4.244534003,(t56:5.079205178,((t57:0.2151553689,t58:0.169493255):2.368554505,(t59:1.038257557,t60:0.9816885453):1.472156469):2.489276062):0.5850698242):0.3213038415,t61:5.681040184):2.596891945,(t62:1.566381581,t63:1.377683481):6.705036433):0.5512630147,(((t64:2.105271381,(t65:1.346636539,t66:1.255106259):0.6698025586):5.472716853,((t67:1.593804837,t68:1.577566808):3.31340133,((t69:0.3515032758,t70:0.10809161):2.347740866,t71:2.43975445):2.104341334):2.343132326):0.6307117545,((t72:6.425007457,((((t73:0.6036207057,t74:0.5236542412):3.139334778,t75:3.505252965):0.853014177,((t77:2.953710097,(t78:2.563696018,t79:2.559307482):0.1315509645):0.512963469,t80:3.077905315):0.7402625649):0.8924940547,t81:4.635523658):0.8819406264):0.5280828318,((t82:3.457185992,t83:3.456833944):0.7592563355,t84:3.758007362):1.686517064):0.4523575129):0.4070288809):1.139190846):3.314914168,(((t85:6.82547201,(t86:4.974802294,t87:4.811803653):1.771166042):0.5429220889,((t88:4.560488145,(t89:2.682409788,t90:2.593632114):1.845553703):1.228050482,((((t91:2.718938923,t92:2.643555621):1.278968023,t93:3.778697638):0.9324862096,(t94:0.943832686,t95:0.7398825552):3.722594997):0.4330695734,(t96:2.725039725,t97:2.723073037):2.016458698):0.2974910125):1.092141019):0.4062974509,((t98:2.968652744,(t99:2.667282176,((t100:1.808424056,(t101:1.279965143,(t102:0.8220115109,t103:0.790514248):0.448881907):0.4403114565):0.2298797006,t104:1.902510047):0.6173926444):0.2286671428):1.175778952,t105:3.825624851):2.382539544):2.845948225):4.721062474):0.06204826948,(((((t106:4.104728473,t107:4.018996076):2.055255553,t108:5.883951524):2.059510641,t109:7.817467479):2.583343178,((t110:2.662737424,t111:2.652774842):1.40949617,((t112:2.05142666,t113:2.023175547):1.006652467,(t114:1.856851026,(t115:1.409105351,t116:1.220302258):0.2485858161):1.115850579):0.9347027373):6.328243617):2.783664316,((((((t117:1.870634197,t118:1.548045302):0.8160237189,t119:2.073148675):0.4757232091,(t120:1.979240482,t121:1.845473239):0.5432317299):0.5527832538,((((t122:0.07998064024,t123:0.0607179236):0.8006594054,t124:0.8228982635):0.1932967981,t125:0.9123326045):0.2026075816,t126:1.032204962):1.599733034):0.1276950886,t127:2.565970549):1.384041648,(((t128:0.3694988371,t129:0.3121277208):1.045805501,t130:1.191625239):0.5126127078,t131:1.684884029):1.770876575):7.337281451):0.1627728394):2.821860828,(((((t132:1.111868517,(t133:0.621007196,(t134:0.2337791451,t135:0.1619698924):0.2878377272):0.4198190169):0.1942863208,t136:0.8622795314):0.6241732394,(t137:0.8683242816,(t138:0.08631302439,t139:0.006028811206):0.7039306264):0.4724455587):2.778683441,((t140:1.762956199,((t141:1.496472616,t142:1.365617785):0.2061751593,t143:1.560631956):0.05306037404):0.5570659762,((((t144:0.2851204096,t145:0.272060028):0.2748013103,t147:0.07395360418):0.398964688,t149:0.214594552):0.5588674426,t150:0.6291232787):0.5544588613):1.618283827):0.4740626539,(t151:2.36398654,t152:2.33791158):0.7829178219):8.484724756):0.3932200378,((t153:6.114006378,(t154:3.465683746,((t155:0.4509196922,t156:0.3395358024):0.0842007482,t157:0.4022248636):2.842322101):2.615040226):3.846944942,((t158:8.808427728,((t159:4.928756273,(t160:0.3592291844,t161:0.2907949674):4.530397944):3.437241371,(t162:8.150526901,((((t163:0.2460647618,t164:0.02562590893):0.314420386,t165:0.2500534555):6.263009511,t166:6.498265357):0.3806853507,((t167:5.58124494,(t168:2.105735464,t169:1.982052345):3.367716816):0.7910801473,t170:5.829964343):0.2889460495):0.8616024395):0.004618392845):0.3849098067):0.5236246859,((t171:3.381334614,((t172:0.31775888,t173:0.1999062452):0.4968903175,t174:0.6273632783):2.535852818):2.153853077,(t175:3.975332922,t176:3.964705278):1.280579282):2.351431591):0.3061167786):1.934612992):6.812679959,(((((((((t177:1.325375364,((t178:0.2771683402,t179:0.2259815658):0.4245833372,t180:0.613994747):0.5801342297):4.328530405,((((((t181:0.09723796634,t182:0.05981888747):1.538791873,t183:1.593917604):0.8696108399,t184:2.463228732):0.3345954357,(t185:1.496244869,t186:1.485636801):1.28067685):1.073201859,t187:3.675511096):1.355560138,t188:5.021564868):0.1221273612):1.03360573,((t189:4.521943884,((t190:1.263100433,t191:1.173382297):2.715360883,t192:3.837327759):0.5433174684):0.4086089903,t193:4.70317898):1.204568086):0.6029258682,((t194:4.1205202,(t195:2.169401722,t196:2.15234145):1.641692014):2.117988254,(((t197:3.095260658,(((t198:2.616006934,(t199:1.131053441,t200:1.055134534):1.458685431):0.2721589903,t201:2.675553974):0.04154646911,(t202:1.452717378,t203:1.430920565):1.218096972):0.1542887337):0.1529469345,((t204:0.4518663756,t205:0.3737547629):0.0583031083,t206:0.4233308189):2.32056868):0.5549841821,(t208:0.5756133098,t209:0.5207066593):2.606408818):2.063101084):0.1159839423):0.6234436581,(t210:3.359945167,(t211:3.015830564,(t212:0.6953095376,t213:0.6768704598):2.291501701):0.2880496421):2.514729209):1.615488875,(t214:6.401157479,(((((t215:1.895441668,t216:1.868189296):2.968487483,((t217:1.900208754,t218:1.814445944):1.613394648,(t219:3.199022977,(((t220:0.3096192154,t221:0.1492370149):2.13814839,t222:2.234643616):0.3313681612,(t223:1.019407975,t224:0.9750076882):1.500976595):0.3680523154):0.1785951159):1.165479342):0.08929625655,((t225:2.087053549,(t226:1.410620833,t227:1.319890927):0.6356373012):2.042353389,(t228:0.809648808,t229:0.5864273253):3.144136939):0.1260424373):1.04807826,((t230:3.677772793,(((t232:0.7707895002,t233:0.7281253229):0.3048289288,(t234:0.4512753097,t235:0.4044983426):0.4301315738):2.013509053,t236:2.817413786):0.4019476636):0.698026366,(((((t237:0.05284302863,t238:0.02256188118):2.779058036,(t239:1.719866877,(t240:1.081368432,t241:0.9310514201):0.6006879871):0.9255456912):0.559828989,(t242:1.262296878,(t243:0.3835428761,t244:0.3747367578):0.8638890868):1.479348438):0.03322088245,(((t245:0.8715260909,t246:0.8578494373):0.05824532621,t247:0.7255122771):0.6607155805,t248:1.328573726):1.080827244):0.1185467571,((t249:0.4072778986,t250:0.2891817444):0.1667242574,t251:0.2426324715):1.919291763):0.3292903143):0.5029979192):0.1086183727,((t252:0.2715507987,t253:0.2039322415):1.45204589,(t254:1.460174155,t255:1.455274637):0.1211963022):1.303537325):0.1867945043):0.9114496927):3.358987458,((t256:1.171409818,t257:0.8479047728):2.699875633,((t258:1.332326814,t259:1.252577369):0.5709299396,t260:1.720028453):1.59998155):3.284388098):2.91270435,((((t261:1.069213852,(t262:0.9906440829,t263:0.9180646599):0.04081549872):1.329525584,(t264:0.7312498472,(t265:0.3560674416,(t266:0.2854906999,(t267:0.1832503531,(t268:0.1068761309,t269:0.09926544009):0.04141086082):0.01486984124):0.03512944308):0.3326244625):1.387877595):3.438101682,((t270:2.53805369,(t271:1.598471382,(t272:0.2287391337,t273:0.05860615534):1.303549657):0.8839405745):0.4904759004,t274:2.633142868):2.290853744):1.687002304,((t275:0.3249870284,t276:0.3182884484):1.66128744,(t277:0.5717205505,t278:0.3778050893):1.241986187):4.16255788):1.97496703):0.6629834124,t279:8.410256846):0.1490029496):0.08774194909):0.2455047304):1.063385727):7.390636554,((((((((t280:0.2491395271,t281:0.1521724837):5.653721684,t282:5.794012419):1.01163652,((t283:0.9298291797,(t284:0.6861185182,t285:0.5879619272):0.06020387193):5.573183735,t286:6.144616669):0.252209675):0.02008022789,t287:6.410296022):1.716175685,((t288:1.097256177,t289:0.8884837655):0.7195353842,t290:1.439986545):6.275921207):0.6051998811,((t291:1.284088209,t292:0.9177778737):5.258435406,t293:6.097571647):1.778570321):0.04024591119,((t294:6.332679442,(t295:5.768261938,(t296:2.529653291,(t297:0.8656068448,t298:0.773079804):1.638583595):3.196917544):0.5063277865):1.391946888,(((t299:0.5647162358,t300:0.5125450712):5.367418582,(((t301:2.790929833,t302:2.673112232):0.4733008293,t303:3.073656421):0.9835684218,(t304:0.3969220733,t305:0.2721907496):3.63914803):1.626686774):0.8149468938,t306:6.346654733):0.7284661125):0.1861694313):0.2160201284,(t307:0.2882839078,t308:0.2747293115):7.154327182):7.758675321):1.352401759,(t309:2.000499556,(t310:1.725459174,(t311:0.8807111696,t312:0.8257797413):0.8331481778):0.113170032):14.41811906):0.111677217,(((t313:5.291487244,((t314:4.365220004,((t315:1.879225411,t316:1.557404275):0.1916646282,t317:1.655066308):2.271705884):0.407453947,t318:4.24658152):0.5133676344):0.7902883723,(t319:3.356570159,(t320:1.085585285,t321:1.072323526):2.206228722):2.161886643):1.374306449,t322:6.715031617):8.805954854):4.069734112):4.682238207):0.6687841972):0.7574385447,((((((t323:4.437218542,(t324:3.561581617,((t325:3.064573166,t326:3.020308559):0.05088342553,t327:3.040024442):0.1475904937):0.4994756124):2.07672,((t328:4.212123221,t329:4.143032334):0.9871295382,(t330:4.04157605,(t331:3.696577998,((((t332:0.5536877279,t333:0.4970915535):2.284792626,t334:2.781269629):0.01235177942,t335:2.781022752):0.5489995943,t336:3.310965941):0.2615837271):0.2456790807):1.051576049):0.5281377078):0.4086856751,(((t337:0.5233876373,t338:0.409158903):3.142404581,t339:3.506879274):1.639527827,(t340:3.272425207,t341:3.226578003):1.75801383):0.4875568958):8.820987138,((t342:3.21309249,(((t343:1.597728367,((t344:1.299701602,(((t345:0.1958204953,t346:0.1357935898):0.6278294905,t347:0.4049012648):0.2550644974,t348:0.3316765663):0.07714495564):0.1703298836,t349:0.5313747549):0.08676848344):0.7635191197,(t350:1.111354197,((t351:0.1317453231,t352:0.1237004488):0.7167894936,t353:0.7938708392):0.02720607974):0.2573411576):0.3218371409,t354:1.366673747):0.2352347087):7.982613135,(t355:0.4650847104,t356:0.3461226307):9.084626137):2.970043578):3.271826522,(((((((t357:0.3782269384,(t358:0.05147018877,t359:0.05137735826):0.2878459034):0.3984201781,t360:0.6456655286):1.282013179,t361:1.771540169):0.6402284993,(t362:1.694118355,t363:1.64755841):0.7035674828):2.813166267,(t364:2.00786703,t365:1.941528855):3.073839268):8.105876556,((((((t366:3.379392158,(t367:2.333907871,t368:2.302488669):0.6960540592):0.5427168758,((t369:1.552979035,(t370:0.6376245661,t371:0.5770841806):0.8198182709):0.7033066944,((t372:0.6733125988,t373:0.5743097379):0.3545433745,t375:0.6946035266):0.9442679458):1.189808443):4.452452721,(((t377:1.479206973,t378:1.290213274):2.231496922,t379:3.406047085):3.107827668,(t380:1.281428818,(t381:0.8325130365,(t383:0.0774696913,t384:0.06092665777):0.4801622421):0.2156981119):5.150116029):0.09967400317):1.353847985,(t385:0.8469164578,t386:0.5368776719):6.451555857):1.237131062,((((t387:0.051451686,t388:0.03177684189):0.1626482783,t389:0.03524210093):4.97711549,(t390:1.804575598,(t391:0.04829308218,t392:0.0425915156):1.686688399):2.690812706):0.3077100204,((t393:0.9311546018,t394:0.9227934103):0.4342321838,t395:1.202181441):3.196969615):2.593642306):0.06628215776,((t396:2.150727673,t397:2.106917488):4.829783951,(((((t398:1.604761391,t399:1.478191815):0.4812505199,t400:1.943198202):2.034928233,t401:3.913586595):0.4035389462,t402:4.129633352):2.008866307,((t403:1.282787995,(t404:0.4997333788,t405:0.4851569009):0.7603799562):3.355084343,t406:4.529029762):1.474593662):0.135438522):0.01643472358):1.857805727):1.534222745,(((((t407:4.375087933,t408:4.296780068):0.2293334114,((t409:2.0795928,(t410:1.298837189,t411:0.9872448712):0.4704449968):2.017138808,t412:3.207110649):0.1863604371):1.088238502,t413:4.428956108):0.4355690578,((t414:1.639756619,t415:1.564111403):0.6404710769,(t416:0.319724445,t417:0.206568816):1.786150948):2.496481584):0.8586153453,((t418:3.199737342,t419:3.174637724):0.112252401,(((t420:0.5230131644,t421:0.5167539209):0.392861013,t422:0.8302162846):2.25814798,t423:3.077556403):0.01250355538):2.007318291):2.303710698):0.4193501294):5.198435853,(((t424:0.3742862992,t425:0.01991144346):2.794300083,t426:2.777016121):1.410819575,t427:4.144154919):8.435192065):1.228525104):10.16233575):11.99421865,((((((t428:3.87407092,t429:3.872270637):0.0208537612,(t430:2.832287048,(t431:1.52873441,t432:1.313289213):1.300165399):0.9493581529):0.1746210643,((t433:2.567406762,(t434:2.294530261,(t435:0.6642405666,((t436:0.1175761616,t437:0.08938575041):0.3140812888,t438:0.307739968):0.06374195028):1.315711458):0.2072275883):0.973823478,((t439:1.446861627,t440:1.260279898):0.6853753202,t441:1.93335249):0.7332062348):0.1782133484):2.166912165,(t442:2.155243947,(t443:0.8656605888,t444:0.8613450681):1.21265708):2.647883569):3.378150465,((t445:0.7919771958,t446:0.195576099):6.663876028,((((t447:0.9362086987,t448:0.8164401858):2.941479136,t449:3.640728159):1.272781178,(((((t450:0.2591874944,t451:0.007051785499):0.3711882069,t452:0.3208492932):1.613611261,((t453:1.054766709,t454:0.9192789218):0.695085537,(t455:0.998151969,t456:0.9509854064):0.3816577311):0.003329409537):0.02798386189,t457:1.348174491):1.487566539,(((t458:1.482603767,t459:1.415558829):0.3611447318,(t460:0.7859531957,t461:0.6704532075):0.8684337624):0.000258312284,t462:1.338042794):0.9351289487):1.006945573):1.453746197,((t463:1.127028113,t464:1.047964441):0.6812167976,(t465:0.1757980771,t466:0.1290472894):1.552268899):2.883074199):0.2396251432):0.5358011226):5.426968287,((t467:7.82042441,(t468:6.011992447,(t469:5.141767858,(t470:1.005053475,(t471:0.8547172588,t472:0.7532588854):0.1252278029):4.128229814):0.8138912178):1.641122633):1.179767565,(((t473:0.9910490437,t474:0.8949388632):2.114425919,(t475:0.842545791,t476:0.7747459168):1.852986356):0.1948167058,t477:2.80049826):5.228887382):1.573545807):20.91709099):28.00483505):100.5916678);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T78.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
