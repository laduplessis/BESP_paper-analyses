<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(t472:26.55787156,((((t473:7.921616894,t474:7.898649231):0.8298424179,((((t394:0.631699654,((t377:0.1050960611,((t358:0.1514929354,((((((t287:0.2053040447,(t241:0.005838357151,(t199:0.09367539841,(t196:0.002594335863,(t173:0.009799440987,(t160:0.02166888925,((((t77:0.01578020962,(t51:0.5276469614,((t1:4.263714535,(t2:4.065197408,(t3:2.225901172,(t4:0.05285064821,t5:0.03759131619):2.132877343):1.767056213):0.07134464404):0.4028062361,t6:4.405644785):0.2850839915):2.549153786):4.284726381,((t7:4.030336231,t8:3.812579193):0.109607808,(t9:2.970609187,t10:2.952727189):0.9204523358):7.355000004):0.9125488444,((t11:1.717979973,t12:1.701363362):4.066997457,((((t13:2.741536963,(t14:2.237071354,t15:2.23287282):0.277033055):0.7548273881,(t16:2.762696707,(t17:2.343122837,t18:2.285455357):0.4096058654):0.4965879472):0.2012668323,t19:3.385965798):0.3855091187,(t20:1.335739355,t21:1.314898406):2.424053545):1.54173735):6.306902914):1.42291378,((((t22:2.793113165,t23:2.418831083):0.09525450909,t24:2.502434941):1.5705404,((t25:1.60086827,t26:1.577919044):1.803703351,((t27:1.898945612,((t28:0.7382977722,t29:0.7006395148):0.417059621,t30:1.08001719):0.7067400863):0.3492404647,t31:2.114171708):1.03811717):0.6651883287):6.212736385,(((((t32:1.408886656,t33:1.334541463):0.1928509259,t34:0.8807279127):0.2988158054,t35:1.173155126):1.014051153,t36:2.159067884):6.55912014,((t37:0.7880777146,t38:0.7134036629):2.156796421,(t39:0.6022609786,t40:0.5866693055):2.173708284):5.715721713):0.5085977172):1.792533185):1.041173881):0.918745337):1.719389987):0.6476022538):3.309028091):4.751490705):2.35985654,(((((((((((t41:0.4534778043,t42:0.449094638):0.283779789,(t43:0.07765624654,t44:0.05056863772):0.422456308):4.724928183,((t45:2.501904592,(t46:2.314457867,t47:1.893034333):0.08065841939):0.668786235,(t48:1.470193337,((t49:0.4470873294,t50:0.4254406985):0.9485543801,t52:0.6881547038):0.0569931736):1.144925912):1.867282061):4.774480449,((t53:4.301207085,t54:4.252816607):0.1855081164,(t55:1.142477464,t56:1.089901959):3.224623361):3.950070552):0.6631064215,((((t57:0.6960260045,(t58:0.1541310814,t59:0.1059243674):0.2642283259):5.773244446,((t60:3.9303785,t61:3.820160612):1.63299302,t62:5.411579669):0.5307887734):0.4383830631,t63:6.175044943):1.183535743,(((t64:0.7331300837,t65:0.5237193232):0.8587985587,t66:1.20714006):0.8436840621,t67:2.004013199):4.818906023):0.7750096164):8.215411875,(((t68:3.332851202,t69:3.216137565):3.864684975,((t70:0.5500620987,t71:0.4864730711):5.147054168,t72:5.559723849):1.313905797):1.639814032,((t73:5.105298653,((t74:1.115628163,t75:1.112577271):0.4053293259,(t76:0.1775162259,t78:0.1311635778):1.251202219):3.583297782):1.746468995,(t79:4.686188185,(t80:3.262895167,t81:3.032038742):1.379308898):1.949812625):1.42255109):6.876002083):1.254067053,(((((((t82:8.042000196,(((((t83:0.2718192005,t84:0.1141256142):2.96908268,(t85:1.615133908,t86:1.512244593):1.423161216):1.655545613,(t87:4.318020335,(t88:3.295849911,t89:2.896636797):0.9782252807):0.04219714522):2.21548021,((t90:4.170973529,t91:4.078840559):1.175994494,(((t92:3.917922006,(t93:0.9079270147,t94:0.8705210558):2.949382109):0.1333331984,((t95:2.170787977,t96:2.136078897):0.8880467542,(t97:0.4870694067,t98:0.4862095869):2.508885831):0.7800665798):0.1449386572,(t99:3.391455747,(t100:3.335456199,t101:3.319128182):0.002519106801):0.5275312995):0.8927343547):0.7288335659):0.6875429541,(t102:3.002264912,(((t103:1.609309219,t104:1.560997438):0.6754469662,(t105:0.9065190991,t106:0.7906562188):1.233814697):0.01614578189,t107:1.842201702):0.5779903064):3.084467767):0.2289318037):0.2770927873,(((((t108:2.449189799,(t109:1.887638692,(t110:1.020685668,(t111:0.319896227,(t112:0.09964195552,t113:0.05027286575):0.1422308988):0.6970821238):0.7051689981):0.556641821):0.496384608,((t114:1.239739665,t115:1.029043608):0.7017729598,(t116:1.418465587,(t117:0.9617500142,t118:0.8727774014):0.4115297861):0.3086037123):0.5138589545):1.216360157,(t119:3.004170309,(t120:0.3068901479,t121:0.1034293674):2.612799288):0.3129019068):0.4169685689,(t122:1.033269062,t123:0.9202086375):2.297135397):0.3520509748,(t124:1.054241041,(t125:0.6241537601,t126:0.06771053174):0.4228565867):2.476978549):1.078992903):0.0056408538,(t127:1.559986485,t128:1.505411447):2.468156948):0.3256579867,((t129:0.8562414721,t130:0.8020027774):0.8325233353,t131:1.591258998):2.587333871):3.007205917,(((t132:1.422760772,t133:1.363693606):0.2052137563,(t134:1.351212471,t135:1.289114549):0.1134316831):1.783887793,(((t136:0.5056813392,t137:0.3803029838):0.9332956058,t138:1.242491698):0.5644824378,t139:1.676804434):1.021760357):3.768059145):2.005808651,((t140:0.623363621,t141:0.5347963818):1.181078993,t142:1.656241713):6.494891011):1.627935346,(t143:2.721925748,t144:2.519161835):7.021602257):0.6072100292):0.181607065,((((t145:1.179756175,t146:0.8724413415):0.2830147741,t147:1.093991233):1.766612778,(((t148:0.1555144235,t149:0.0761674128):1.045592767,t150:1.051593684):1.066322179,(((t151:0.5133528382,t152:0.4462312734):0.1570057445,(t153:0.451681598,t154:0.4270424982):0.1478281547):0.1670455389,(((t155:0.173548211,t156:0.155676148):0.1731572601,t157:0.2694458975):0.1706275931,t158:0.3228718424):0.07430566806):1.065712355):0.5755110485):6.632887228,t159:8.585252252):0.4303074953):0.3092533648,(t161:2.901362108,((t162:2.281207155,(((t163:0.7496291133,t164:0.629658096):1.057839633,(t165:1.031870036,t166:0.8413199278):0.6504623819):0.00680498929,t167:1.41280282):0.373662099):0.3242689059,t168:2.10876665):0.2896557054):6.150803314):1.618248646,(((((((t169:3.280868547,t170:3.19049771):2.584742418,(((t171:2.216730346,t172:2.116741526):0.7623057979,(t174:0.8490771528,t175:0.7858474439):1.785651717):1.564098329,t176:4.101052634):1.184815629):1.018658583,((t177:0.02552211203,t178:0.01012616802):5.232759137,(t179:0.4445463608,t180:0.3473357533):4.785218863):1.041974603):0.6627871935,(t181:6.78202755,(t182:0.5727680206,t183:0.4754833524):6.205179701):0.03642047718):0.5525098516,(((t184:0.8335413838,t185:0.7752542555):0.5555830942,t186:1.307159286):5.81431662,(((t187:0.6722126581,t188:0.4508498368):3.637316972,t189:3.976367842):0.9706901217,t190:4.878451554):1.789412342):0.03119291806):0.2344827592,(t191:6.343223844,((t192:4.117395508,t193:3.776864708):0.4278746092,t194:4.17163032):1.619625399):0.4692480019):1.727674324,(((t195:3.376212599,t197:3.301788803):3.086322119,(((t198:1.206770538,t200:0.5663135212):3.116175264,((t201:2.88974507,t202:2.857805127):0.4662847494,t203:3.232135844):0.1663687863):0.935365607,(t204:1.565110862,t205:1.45415108):2.750303862):1.113825493):1.503452535,(t206:4.211416088,(((((t207:1.608588398,t208:1.362466587):0.9397636866,t209:2.264752203):0.1730798732,t210:2.411929549):0.1995440221,t211:2.568031601):0.8420093884,(t212:2.746569443,(t213:1.699928035,(t214:0.2158779877,t215:0.03542587235):1.428740755):1.026972987):0.6405486442):0.3601509882):2.595683137):0.02110249662):0.1054619409):0.5097648612,((t216:2.617250632,t217:2.609536112):0.6375685999,(t218:2.528689857,(t219:2.206894867,t220:2.158478891):0.1824204371):0.6885626019):3.406633231):2.477530384):0.8229885626,((((t221:0.2039189294,t222:0.1748042919):0.1329046994,t223:0.2316399302):3.103971183,(t224:2.647012324,t225:2.638868484):0.5240452186):4.397741842,t226:7.554839052):1.692701476):1.714525576,(((t227:3.591849011,t228:3.526847356):0.8786774701,(((t229:2.535005779,t230:2.513387006):0.2475513317,((t231:1.58547317,t232:1.44433294):0.1247806047,t233:1.514296408):1.027581682):0.709844003,((t234:0.9302947136,t235:0.7861515732):1.242100813,t236:1.964346779):1.046452808):0.897973324):2.287957124,((t237:3.314404003,((t238:2.209632666,t239:2.056815316):0.3187226403,t240:2.336940067):0.7499155679):0.1396793404,t242:2.845483157):2.492583779):4.165322926):1.999391291,(((t243:2.934241503,((t244:2.162256796,(t245:0.3669134988,(t246:0.2513429289,t247:0.2368475827):0.07603436576):1.77475763):0.4376628636,(t248:0.4888122477,t249:0.4626177586):1.870164702):0.3263427965):0.489251337,(t250:3.034411336,(t251:0.2065114191,t252:0.204054388):2.805962566):0.1080571153):1.183668149,((((t253:0.1188420567,t254:0.0800840535):1.33806593,t255:1.361190997):1.270193753,(t256:1.440998251,(t257:0.4303769889,t258:0.2805038756):0.8153647225):1.171356212):0.02946613848,(((t259:0.2606175247,t260:0.2378872971):1.226705448,t261:1.345401276):0.611483476,t262:1.628346536):0.07664131338):1.515370867):6.860795922):0.372191809,(((((t263:1.559073671,t264:1.434510479):1.152480772,(t265:0.3166569234,t266:0.2827954371):2.042219868):3.002229616,((((t267:0.4832543638,t268:0.4143270655):1.794517547,(t269:1.460579042,(t270:0.2149669609,t271:0.1931219354):1.054962743):0.5814163938):0.8547134149,(t272:0.07967354968,t273:0.04421936726):2.535804095):0.7298216084,(((t274:0.3157498843,t275:0.2814300118):0.5222701885,t276:0.7174807879):0.2884152755,(t277:0.8092772122,(t278:0.7156011959,(t279:0.3998184939,t280:0.183376897):0.2147585554):0.03550337776):0.1684298148):1.788809561):1.127162401):4.199837161,t281:7.684663848):0.3375178729,((((t282:3.047123186,t283:2.984993169):2.171343301,t284:5.078392701):0.5901900561,(t285:5.314554183,t286:5.282077487):0.05733778362):1.94355381,(t288:0.7946060712,t289:0.7763253434):6.172389492):0.05368856028):0.1609948998):0.3263238228):0.7462278943,(((((t290:6.095315956,((t291:1.545679409,t292:1.521553281):3.74663939,((t293:1.092166888,(t294:0.4352745984,t295:0.3936298957):0.6317939276):0.2332050486,t296:1.125620252):3.932029646):0.6993576551):0.3503515424,(t297:6.070328369,t298:6.033369207):0.02887184886):0.06480388968,(t299:4.19863144,(t300:2.24584944,(t301:1.376251897,t302:1.308707525):0.8142120188):1.940883811):1.624006701):1.087227026,(t303:4.286803969,(t304:1.02219273,t305:0.9578553871):3.260438224):2.417174771):0.1429743671,(t306:0.8088718965,t307:0.795639603):5.897142665):0.3310513329):1.642052467):0.03744237056,((t308:3.609712608,t309:3.576239423):0.07240789295,t310:3.629766207):4.6863049):2.631227085):5.59783749,((((t311:6.604522938,(t312:4.497023289,(t313:3.619566311,t314:3.593026438):0.8389590466):1.96284171):7.951472767,((((((((t315:1.78005537,(t316:0.568766464,t317:0.4364814986):1.102169387):1.890176909,t318:3.288637101):0.986644358,t319:4.183279312):0.6060392371,t320:4.739186142):0.7585419144,((t321:3.707226986,(((t322:1.638747019,t323:1.628800541):0.3491482819,(t324:0.539474714,t325:0.3527684285):1.182999459):1.093307857,((t326:1.517812919,t327:1.345992451):0.1499775267,t328:1.471654852):0.8506612652):0.4387968367):1.536663957,(t329:3.051228412,(((t330:1.195943888,t331:1.07344029):0.3795035076,t332:1.372777067):0.9232938053,(t333:1.794794609,t334:1.684280354):0.4272251379):0.4390034089):1.192964975):0.118132999):1.744546666,((t335:1.035185811,t336:0.7731407791):2.011861387,t337:2.551863416):1.848821658):3.523460267,((t338:0.5146871127,t339:0.4479025967):1.581300733,t340:2.028314476):5.813625282):2.169811385,((((t341:0.02566021504,t342:0.02250980409):2.698173268,(t343:0.761343851,t344:0.5902037111):1.938711591):0.3463100047,(((t345:0.4114063708,t346:0.2076804051):0.8966784873,(t347:0.4474783778,t348:0.3233043594):0.5844972259):0.4237186514,t349:1.306993026):1.128822315):6.439033773,((t350:1.44009959,(t351:0.3816600829,t352:0.2979616435):0.9699868231):5.02110007,(t353:2.75273885,(t354:1.102228661,t355:1.004414719):1.534620309):3.353412849):2.390000607):0.4994423044):0.8094560736):1.227056155,t356:10.68953149):0.1331357397,(((((t357:0.8802660819,t359:0.7001034332):2.142822654,(((t360:0.5423506885,t361:0.4420164778):1.35996671,t362:1.776413074):0.1288102007,(t363:0.4821439037,(t364:0.1919796963,t365:0.01334526134):0.2724480855):1.311569363):0.8015749736):0.1174437295,t366:2.374183715):5.648361568,t367:7.430179554):1.363370414,((t368:1.019045222,(t369:0.6304852907,t370:0.2261956129):0.3527775992):1.172046778,((t371:0.2106572955,t372:0.1800731986):0.3044830036,t373:0.2592532703):1.229912757):6.518951653):0.2485465436):0.4278806451):8.802948915,((t374:9.035843661,((((t375:6.584172613,t376:6.506404717):0.5214471179,(((((t378:1.634931396,t379:1.542875219):0.8980545352,t380:1.953422305):1.117785495,(t381:1.797685053,t382:1.771690317):1.086357326):2.676764081,(((t383:0.5887644125,t384:0.4151042157):2.003629646,t385:2.341857329):2.394206601,t386:4.66490284):0.3495446261):0.2926731612,((t387:1.848866865,t388:1.843918534):2.451508978,(t389:1.114426165,t390:0.9255616184):2.972012949):0.9975050671):0.2161352506):1.285965056,(t391:5.170570426,(((t392:1.104415585,t393:1.041085596):0.4703919416,t395:0.742293533):0.7205849007,t396:1.433694807):2.756684308):1.175356871):0.3672004152,((t397:4.454377313,t398:4.347369819):0.009691476787,((t399:1.204401748,t400:1.102123571):2.101281012,(t401:2.133417512,t402:2.080722291):0.9175884802):1.039122579):1.155154035):0.1122767836):7.046078241,((t403:3.941280508,((t404:2.212978926,(t405:1.251482137,(t406:0.3886840648,t407:0.2850862869):0.7414174869):0.9019141394):0.6927799203,t408:2.582763126):0.6008326235):1.196528136,(((t409:2.164292192,t410:2.101218819):0.3743421538,t411:2.445676838):0.01022905009,t412:2.303362899):1.829382197):7.173065012):1.389033465):1.207386076,(((((t413:0.9454770154,t414:0.9092908246):1.965031729,(t415:2.195097538,((t416:0.6577030576,t417:0.5047019992):1.42028062,t418:1.408232572):0.03519522819):0.5990449245):1.270792188,((t419:1.617626989,(t420:0.853117004,t421:0.8325883094):0.70137659):0.2069973645,((t422:0.1264799708,t423:0.07302539472):0.5729279479,t424:0.6331428684):0.922830094):1.400524093):7.237262139,((((t425:0.8440382478,((t426:0.3473951081,t427:0.2053649896):0.3047674305,t428:0.3635869447):0.14048184):2.836856283,t429:3.284627355):0.2294568043,(t430:1.565677062,t431:1.527316646):1.925640571):1.132205087,(((t432:0.5634663044,t433:0.3779889745):1.700022208,((t434:0.9564602441,t435:0.8731243667):0.0562545735,t436:0.2700603711):1.058601771):0.5020435797,((t437:0.3393433569,(t438:0.0432937972,t439:0.013436917):0.2513221766):0.7227537955,t440:0.8787015525):0.6595766696):1.777619366):4.978869222):0.5871614446,((t441:0.08262603741,t442:0.001892724189):7.136368512,((t443:2.057566394,t444:1.94696901):2.685872384,(t445:2.922312812,(t446:0.8842523273,(t447:0.5445313053,t448:0.4044599365):0.1530550578):1.782921511):1.467744759):2.278639233):1.458577797):1.770481593):1.862346494):8.774137271,(t449:5.08746787,t450:5.033474335):14.8440844):0.2785298555,((t451:0.3187109301,t452:0.1757167661):18.93063908,((t453:6.748164608,(t454:0.5320100411,t455:0.4998657205):5.996591397):6.363206897,((((((t456:0.3329903661,t457:0.2863615887):0.9866299103,t458:1.143923189):0.1304485616,t459:1.067430317):4.395287487,((t460:1.548903706,t461:1.537063688):0.3069024897,(t462:0.5717289922,t463:0.5539091597):1.083194631):3.593287485):3.041198826,(t464:7.606651638,(((t465:1.462893407,t466:1.378711795):5.835698918,t467:7.005139914):0.1172895666,(t468:5.107920483,(t469:3.561914758,t470:3.218753383):1.49754462):1.952555182):0.1344224864):0.6198729029):3.485408166,t471:10.90254224):0.2636680973):5.894135352):0.859154187):8.7138845);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T13.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
