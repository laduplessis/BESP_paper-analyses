<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t402:0.2692241563,t403:0.2248303049):1.706238758,((((t404:0.2488106174,t405:0.2356804015):0.04101753109,t406:0.2704530715):0.1466848327,t407:0.2906338271):0.983081601,((t408:0.3890030476,t409:0.2992612327):0.7760660173,t410:0.9175410837):0.05953189609):0.4740836713):2.850831986,(t411:3.947486091,(t412:3.26889596,((t413:0.802295688,t414:0.8005730788):0.07506303328,t415:0.7338929541):2.205272854):0.5684602282):0.3405736629):20.75895458,(((((t416:0.7731881983,t417:0.7687457389):3.077261577,((t418:1.836887046,((((t419:0.3462334626,t421:0.1424744079):0.4485471295,t422:0.4262229107):0.6540029981,t423:0.9455684927):0.132268544,t424:1.058241401):0.2344301922):0.4605126557,t425:1.401320918):1.524965229):4.983509914,((t426:1.643014239,((t427:1.257486021,t428:1.178127661):0.3542733356,t429:1.489160787):0.02164582395):1.440149537,((t430:0.4677868721,t431:0.3761902482):0.7310094244,t432:1.003616942):1.499159661):4.706502385):1.168067627,(((((t433:0.9489206456,t434:0.9433328256):0.04629174527,t435:0.8945217671):0.7753792884,t436:1.249210198):1.760400037,t437:2.960324108):0.02422847812,((t438:1.383652257,t439:1.22563259):0.3007754946,(t440:0.6073349539,(t441:0.30719672,t442:0.2899603713):0.1686386482):0.8991447285):1.287800294):4.660722198):1.866577604,((t443:1.944608268,t444:1.81380077):6.487583253,((t445:0.811670997,t446:0.7617466014):4.635218499,t447:5.039807621):2.61907452):0.6957998813):12.71176839):6.96812829,((t448:2.417116468,t449:2.382399723):14.73929855,(t450:4.20029203,t451:4.045287993):12.86544204):10.87391813):30.82040011,(t452:36.0482243,((t453:8.016049361,(t454:2.98190518,t455:2.744752039):4.890461346):19.04733265,(((t420:0.01866198193,((t350:0.1532586364,((t341:0.03025403148,((t329:0.177845212,((t308:0.1974434942,((t253:0.06159323569,(t252:0.01870281,((((((((t130:0.02716442604,(t91:0.13427099,(t57:0.1896971154,(t12:0.05032693629,t1:1.176144137):4.660993263):3.348920232):3.018481548):0.7585518886,(((((t2:2.079035498,t3:2.065525469):1.030244567,(t4:0.8868120428,t5:0.8603755775):2.168744123):1.507121697,t6:4.15816414):0.6109132649,((t7:2.289370402,t8:2.104205131):1.822175268,(t9:1.115259213,t10:1.080341245):2.614754528):0.6409297682):0.5488279875,((((t11:1.097141782,t13:0.7677208019):1.113273471,t14:1.863259672):0.4986352815,t15:2.302174262):0.5809412004,t16:2.537881604):1.576448634):7.132936289):0.004214788953,((t17:2.30494005,t18:2.250453781):3.505847624,((((t19:1.314317165,t20:1.20591904):0.8160580719,t21:1.867324236):1.32303734,t22:3.18149574):0.08799862174,(t23:1.495354624,(t24:1.036598856,t25:1.003865761):0.2107042016):1.772507499):2.172824729):5.317312379):3.656802465,(((((t26:2.038550367,((t27:0.2471264068,t28:0.2465624398):0.2129437587,t29:0.1810197599):1.543402921):6.555507603,((t30:7.863357089,((t31:0.1181918061,t32:0.1007130253):6.15778213,(t33:1.205971836,t34:0.9941915085):4.609820633):1.319793284):0.0628430731,(t35:0.2560522121,t36:0.218827876):6.693288094):0.3072994037):0.464534167,(t37:7.578912111,((((t38:0.1658312106,t39:0.0885213414):0.3661243438,t40:0.1682510314):0.9089938481,t41:0.9091034348):1.755404326,(t42:1.93430143,t43:1.817465526):0.7299194782):4.255060485):0.1049017627):2.480825576,(((t44:0.1296457795,t45:0.1260142301):2.240334247,((t46:0.3117832756,t47:0.2433694178):0.244936576,t48:0.4161353335):1.803824528):2.462325692,t49:4.606599643):4.164416542):0.1789099036,t50:8.934376615):2.391264331):1.540340646,((((t51:2.216705249,((t52:0.1917221097,t53:0.1795898572):0.3686420909,t54:0.4358802674):1.598490005):0.3765472171,(t55:1.282184477,t56:1.275581175):1.049619001):0.9149735409,((t58:0.1375020526,t59:0.1304678184):0.9064253501,t60:0.895902669):1.884280975):5.339960978,(((t61:0.7262370917,t62:0.4900580933):2.602171127,(t63:0.1701740059,t64:0.08738850757):2.883061366):1.425170583,((t65:3.741674614,(t66:2.359010078,(t67:2.121845946,(t68:0.8052464219,t69:0.7373467244):1.308301098):0.1996726732):1.276472256):0.0602851002,(t70:2.208946682,t71:2.187388304):1.095695735):0.4955089554):3.3248612):3.994851153):0.5343211331,((((((t72:3.856937101,(t73:3.579740421,t74:3.519334635):0.1576666701):1.234894258,t75:4.745357877):0.6280326995,t76:5.31421635):2.039094625,(((t77:2.526387168,t78:2.443248661):3.003292406,t79:5.306962681):1.050193665,((((t80:0.08855593051,t81:0.04585506288):2.527489545,t82:2.53892158):2.725610884,((t83:3.80388016,(t84:3.549231813,t85:3.495096557):0.08197979778):0.8059382495,((((t86:0.3543614551,t87:0.1740577353):2.462245185,t88:2.384748877):0.7303930506,t89:3.102648856):0.6608849016,(t90:2.558102036,t92:2.375141813):1.203410966):0.04176523174):0.6001866256):0.2256954909,(t93:2.829021406,t94:2.751957465):1.579502944):0.454200877):0.756692178):0.4166407535,((t95:2.575963895,t96:2.4936237):3.121769335,(((((t97:0.7440590267,t98:0.5896234363):0.0674100243,t99:0.5568105541):1.284767115,t100:1.837123941):2.837650995,t101:4.673353265):0.2873965625,((t102:1.458531814,(t103:0.971475896,t104:0.9696180863):0.4610191651):2.36379312,(t105:3.622213171,t106:3.539043935):0.1662038444):1.061207116):0.2371575769):0.1898039404):2.995544374,((t107:0.6040012472,t108:0.5343792717):3.888717347,(t109:2.674169442,(((t110:0.8813776186,t111:0.761605562):0.4506563767,t112:1.182377431):0.1630170388,t113:1.205352973):1.168720784):1.747198091):3.68808462):0.442045738):5.182106794,(((t114:2.549351415,t115:2.538954877):3.144875651,(t116:4.820273006,((t117:0.09963971039,t118:0.07870593004):3.690946524,t119:3.706093869):0.7128265747):0.808478855):7.273560304,(((t120:5.812148819,(((t121:0.6545595197,t122:0.4380327692):3.39616639,t123:3.732487772):0.2373828114,(((t124:1.005462284,t125:0.9001237864):0.1109728647,t126:0.9358694758):1.661643593,(t127:1.213226019,t128:1.175241905):1.127874769):1.177409708):1.479625151):5.528095003,t129:10.39735887):0.8098299611,(((((((t131:1.049871764,t132:0.9737053336):0.7903452443,t133:1.74442684):0.5954374586,(t134:1.712988975,(t135:0.6584243335,t136:0.4373452722):0.5782191921):0.5098774119):0.08516921572,t137:1.174015418):0.1970870243,t138:1.363960611):0.3131737926,(t139:0.21094804,t140:0.03645070898):1.432001011):2.437825759,(t141:0.4268181163,t142:0.4049937104):3.342545445):5.405803261):0.3325410843):0.4163584929):0.5739424624,(((t143:0.1591027865,t144:0.1092013346):0.1852520417,t145:0.09354682067):8.329922216,((t146:0.5985829357,((t147:0.1453507261,t148:0.04723531493):0.2690983942,t149:0.1477554858):0.004738108092):7.166386846,(t150:1.310558927,(t151:0.2463355828,t152:0.01820502661):1.025331373):5.904312407):0.4928039044):1.644270258):0.7116497933):0.2300527123):3.877195569,(((t153:5.957555721,(t154:5.006619512,((t155:0.2168580784,t156:0.1084233063):1.553644819,(t157:0.794377705,t158:0.6581559087):0.5981097044):3.066108878):0.7255042324):3.080113469,((t159:2.74658276,t160:2.473272079):2.681087044,(t161:3.923997566,(t162:1.615487846,t163:1.586237225):2.285735311):1.204626748):2.540758807):0.3948344668,(((((t164:4.343971513,((t165:3.398452486,t166:3.393542252):0.247896151,(t167:3.379959272,(t168:0.9846332025,t169:0.8536055072):2.313752687):0.1132530743):0.6252750802):1.280568588,t170:5.147475964):1.397197811,(((t171:2.269288899,t172:2.176122874):3.291404219,(t173:4.641156903,((t174:3.177904308,(t175:2.733519621,t176:2.475198408):0.2222812732):1.23727834,t177:3.547873522):0.213572143):0.7777981617):0.1864362499,(((t178:0.8151193461,t179:0.7912687818):0.09617589864,t180:0.8845159317):1.764003035,t181:2.627671109):1.974527502):0.7493010664):0.4606993375,(((t182:0.6918218463,(t183:0.2268991193,t184:0.1036502349):0.2399719459):3.336055057,t185:3.387578728):0.678868295,t186:4.051594908):1.088403429):0.02872215665,(t187:4.580281726,((t188:4.121868626,(t189:2.842136208,(t190:2.198098632,(t191:1.483684099,t192:1.462902228):0.6045677319):0.5820325864):1.256383578):0.06370289147,(t193:2.166069505,t194:2.125956502):1.711083821):0.2514894588):0.5666076568):0.496756988):4.387254265):2.019469779):1.564915932,(((t195:4.893702718,(t196:4.820546804,((t197:2.888963395,t198:2.883711864):0.943771572,(t199:3.677249168,((t200:2.50462259,t201:2.500908503):0.6576526241,(t202:0.5192741777,t203:0.4579832761):2.405283517):0.5025505883):0.064456206):0.9863141248):0.05496966682):1.163721771,(t204:1.837718615,t205:1.824525864):3.70177966):3.77182273,(((t206:3.414432526,(t207:2.633109551,t208:2.53961587):0.7782894665):0.2886854197,((t209:1.982665959,((((t210:0.2552708659,t211:0.2547960888):0.3721814915,t212:0.5917292113):0.3932484236,t213:0.9783817659):0.363939829,t214:1.000599751):0.521871707):0.4844390822,(t215:0.4819828543,t216:0.3369537081):1.48858445):0.9067892076):1.96224346,((t217:2.993684025,((t218:1.689072029,((t219:0.148729085,t220:0.01551796123):0.9620077358,t221:0.9630714114):0.5641390079):0.5414703939,t222:2.041199587):0.7440761365):0.9589905983,((t223:1.294628308,(t224:0.3461024361,t225:0.3213348482):0.9325913939):2.333578701,(t226:2.071516255,(t227:0.7668829141,t228:0.7569005522):1.26338477):1.495712876):0.09712942696):0.5963206328):3.06938824):3.236588729):0.6787530356):0.9066555974,(((t229:2.474691769,(t230:2.169781532,((t231:0.4648307032,(t232:0.2824320417,t233:0.2515770226):0.04270082247):1.40314596,(t234:0.7029338681,t235:0.6278946173):0.9922167128):0.170166374):0.2297029699):0.3943442569,(t236:2.356474652,(((t237:0.27376334,t238:0.1790483692):0.3399207212,t239:0.503743299):0.7680508507,(t240:0.4306522545,t241:0.4028780826):0.6643139085):0.8441042438):0.02582045697):8.889954262,((t242:0.7368724377,t243:0.705772925):8.314644508,t244:8.962228948):1.362807777):0.2892617835):0.01161782554):0.259830531,((((((t245:0.3839049326,t246:0.2598105717):0.2554091752,t247:0.4870913418):7.976491027,(((t248:0.2335588806,t249:0.2020428711):0.2356857337,t250:0.401632554):3.018004614,(t251:1.913607783,t254:1.331747403):1.121677876):4.847668058):0.04995480432,(t255:6.246559051,t256:6.232561236):0.8616812226):0.2145652275,t257:7.141283177):1.645114557,(t258:3.927149419,t259:3.789147094):4.760580673):0.07732258173):0.6526070056):0.3075439509,((t260:5.519818368,((t261:1.480516255,((t262:0.1944024973,t263:0.1906478112):0.7258597773,t264:0.2779751837):0.1850602381):0.1689799571,t265:0.6230761168):3.825969583):1.527860513,(t266:2.567990773,t267:2.529439772):3.2075051):2.538844826):7.454524816):1.27094531,((((((t268:4.811735716,((t269:0.9663288041,t270:0.9401642166):2.439260232,t271:3.330996095):1.3473831):2.903751724,(((t272:2.827640908,((t273:0.2637339475,t274:0.05462252756):2.497410345,t275:2.546926963):0.04328018861):2.840320451,(t276:2.206482865,t277:1.929563614):3.169782685):0.1034914889,t278:4.869501258):1.78324378):0.07576615381,(((t279:0.6157220484,t280:0.5487642725):3.292769014,t281:3.685902668):1.78262983,(t282:4.284630263,t283:4.217384539):1.176422597):0.8158055722):0.9052301796,((t284:3.807528919,(t285:2.516325623,t286:2.256524832):1.108061216):2.814301323,(t287:3.384762819,t288:3.327068771):2.780531007):0.4763908699):1.319562175,(t289:3.520756382,((t290:2.453389056,t291:2.443300627):0.846957566,t292:3.163393687):0.09904969193):4.331032672):2.887478914,((t293:1.929615541,(t294:1.65081269,t295:1.571077802):0.2755393309):3.766871066,(((t296:1.182433048,t297:1.050165708):1.326225477,t298:2.157664733):2.734344167,(((t299:0.9245205162,t300:0.8265992351):3.241010856,(t301:3.681679292,(((t302:0.2602849583,t303:0.2549095568):1.545093662,t304:1.799133883):1.625651707,(t305:2.349215821,((t306:0.7379692325,t307:0.6357748017):0.3181841174,t309:0.63922944):1.21945922):1.025084546):0.1980867435):0.2605158269):0.6342182655,((t310:1.859250627,t311:1.850852362):2.04965944,((t312:1.573652955,t313:1.425805615):0.9570205656,((t314:0.5059652621,t315:0.4424236896):1.511056864,((t316:0.6571115225,t317:0.323025523):0.7588634995,t318:1.046033495):0.5245539978):0.3516068784):0.9443284586):0.03188572679):0.0694798844):0.2770425537):4.689305929):4.057316077):19.76269703,(((((((t319:0.4550304372,t320:0.4235262453):0.5806727336,t321:0.985574709):0.5849161809,(t322:0.2987221227,t323:0.2215461628):1.162113163):9.760860714,((((t324:0.1618263145,t325:0.03907922056):0.7025617975,t326:0.6555746514):9.885907778,((((t327:1.342198012,t328:1.302864654):0.613223454,t330:1.40071482):1.308528863,t331:2.567841539):7.069728797,((((t332:0.9320468093,t333:0.8132616203):1.901664862,((((t334:0.5765961992,t335:0.4728346539):0.8060561791,(t336:0.221681534,t337:0.1532410613):0.9137202129):0.388972858,t338:1.407555388):0.1487115889,t339:1.547030143):0.782362606):0.1595326474,(t340:1.327248856,t342:1.23793173):1.136844033):4.0118885,((t343:0.597038098,t344:0.5899751785):4.196177108,(t345:1.671694178,((t346:0.3924167243,t347:0.3676304541):0.120047148,t348:0.19003443):1.062990296):2.99018571):1.549196956):2.599873995):0.1979305381):0.1230969706,((((t349:1.063010468,t351:0.5865434958):0.724947854,t352:1.070237147):1.622110828,t353:2.619451942):0.1024749577,t354:2.620810338):5.192924365):0.02925115415):2.262022441,(((((t355:1.094396906,t356:0.94538367):0.2762636744,(t357:1.018906556,t358:1.002071005):0.06839733469):5.218031484,((((t359:2.484610743,t360:2.433946589):1.086263442,(t361:2.892831962,(t362:0.2267666033,t363:0.09810759662):2.616599233):0.5109474964):1.894213495,((t364:0.558052826,t365:0.557909074):3.613566025,t366:4.079672312):0.8979967229):0.7523016447,t367:5.686819194):0.01077165666):1.814864558,((t368:3.210245877,t369:3.046258737):0.1146945822,t370:3.076841041):4.142236903):0.1721734773,t371:7.376866352):1.30610848):3.266939912,((t372:3.993244337,((t373:2.377071146,t374:2.276021703):1.077963567,((t375:2.070191064,t376:1.653547541):0.8561724801,t377:2.477580567):0.1783928138):0.4565211582):1.796631228,((t378:4.396495337,t379:3.908615935):0.2846630926,(((t380:1.932817925,t381:1.931607269):0.1249754124,t382:2.034259119):0.8276322218,(t383:2.655671186,(t384:1.300371973,t385:1.237971558):1.347410189):0.1096560593):1.193295028):0.18638276):5.636731808):14.43134951,((((((((t386:0.9211453726,t387:0.8600625224):2.257181857,t388:2.797872818):0.3758272288,(t389:0.7897372203,t390:0.7719850921):2.228865181):0.4369788311,t391:3.373062882):0.5476717761,t392:3.912755469):1.800266939,((t393:4.605425465,t394:4.588857275):0.7490327975,((t395:2.68858251,t396:2.616127074):0.009684722898,t397:2.339252693):2.573054757):0.2418352582):2.266082968,(t398:3.13655505,t399:2.768148129):3.857111565):6.148121245,(t400:0.3032469496,t401:0.2149252186):12.33068707):9.286355389):0.4057945994):10.21223928):8.676920123):22.29578909);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T35.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
