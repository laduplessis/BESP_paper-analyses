<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t494:5.866000277,t495:5.851727998):6.909348738,t496:12.72255497):14.51521914,((((t497:0.2546749709,t498:0.2074126474):2.648357728,(t499:0.7007102751,((t483:0.1093786663,((t469:0.05950170878,((t463:0.09075268183,(((((t273:0.2223473131,((t229:0.00753131845,(t157:0.07852056822,((((t122:0.01510390561,((t92:0.07948248735,((t21:0.1166313506,t1:2.871649391):0.9806256057,t2:3.842245173):6.402241746):0.7715769811,((t3:3.017615356,t4:2.777579643):2.228648932,(((t5:3.50210205,t6:3.325017774):0.2285091744,t7:3.472915336):0.6568892078,(t8:2.951110032,(t9:2.029906394,(t10:0.5051611532,t11:0.393226238):1.518440194):0.5762470274):1.112052362):0.5110207229):5.678035714):1.919291677):1.135094878,((((t12:1.758660285,t13:1.659775758):0.02769176649,t14:1.036028501):4.778459642,t15:5.803311524):3.546320073,(t16:3.233936508,(t17:1.054717245,t18:0.8807893345):2.108052829):5.996734719):2.629570505):0.06059740396,((((((t19:1.98175211,t20:1.943213526):0.9278310375,(t22:0.6818258373,t23:0.5148274295):1.622730896):6.978436109,t24:8.85148638):0.4871400266,((t25:0.8784402754,t26:0.6395558748):6.713374322,(((t27:1.89236121,((t28:0.7650921939,t29:0.4377941958):0.7167694475,t30:1.050298148):0.3775947711):1.960844193,t31:3.36967438):2.852139868,t32:6.146641714):0.6257490897):1.714671899):0.4431634301,t33:8.654398773):0.6524994627,(t34:8.02416217,(t35:3.100461871,t36:2.855130307):4.860800691):1.0821731):0.196671335):0.7993326663,(t37:1.613238709,t38:1.543193234):8.112063995):1.807169423):5.270380694):3.101098046,(((((t39:0.4117034589,((t40:0.07763991118,t41:0.05361729101):0.1151597571,t42:0.1301968917):0.08882731752):5.596254627,((t43:1.578121283,t44:1.52767242):0.05248100264,t45:1.390339322):4.182310654):3.128942876,(((t46:1.322292464,t47:0.9741396876):5.348267499,(t48:5.017408431,t49:4.711244052):1.122180867):1.525759455,((((t50:0.9506162941,t51:0.9336949945):2.273248381,t52:3.198548159):2.522849079,((t53:4.563378151,(t54:4.444441431,(t55:0.6652375939,t56:0.4785425555):3.721195551):0.09286972066):0.009414215577,t57:4.276361956):0.9972715161):1.584859883,(t58:5.578767376,((t59:3.159971377,((t60:0.8895256038,t61:0.8027543014):1.72926247,t62:2.465744111):0.4907664175):1.704020819,t63:4.543472632):0.5903436012):1.200528823):0.02411919315):0.1981730784):0.3994128281,(((t64:2.964374107,((t65:0.7932476395,t66:0.7910469168):0.1486320875,t67:0.7022122569):1.943757281):1.150853079,(t68:3.572794173,(t69:2.943048399,t70:2.929099394):0.6206557945):0.1902559142):2.158055072,t71:5.863781088):0.2535858785):9.976984786,(((((((t72:4.578408404,t73:4.559295523):2.078074893,((t74:3.619134576,(t75:1.677800179,t76:1.672489885):1.840016708):2.499853906,(((t77:2.066575916,t78:1.874923792):1.452182465,(t79:1.823085136,t80:1.793048386):1.455403743):1.546201885,(t81:4.629808435,((t82:0.3011396797,t83:0.2670595017):1.931050363,(t84:1.871503662,t85:1.821739847):0.214683834):2.232379475):0.1287896761):0.9324141372):0.3529041481):0.7245354567,((t86:2.580188029,t87:2.44609572):0.6476007054,((t88:2.448515952,t89:2.394920371):0.5765345711,(t90:0.4567622661,t91:0.4489564661):2.442694097):0.05778138215):3.094133701):2.935856061,(((((t93:1.101194317,t94:0.9979967475):3.495719535,((t95:0.8260592588,t96:0.7274374895):0.3258987956,(t97:0.1360319828,t98:0.08080437342):0.5414702694):3.249685851):0.4820231876,((t99:2.007147067,t100:1.889722893):1.397545328,((((t101:0.9402052701,(t102:0.1861763455,t103:0.1376797611):0.6372320952):1.153593292,t104:1.855175752):0.3136037474,(t105:1.232988848,((t106:0.06889902409,t107:0.0339367425):0.7437717178,t108:0.555454009):0.04553741473):0.8139140763):0.01811913199,((t109:0.7585906631,t110:0.7477719531):0.6146155932,(t111:1.148913346,(t112:0.3077185473,t113:0.2651619643):0.7967238695):0.2134417559):0.01548415023):0.8160281639):0.9315676639):0.8139056315,(t114:2.123551485,t115:2.068663075):1.71446756):2.121313512,(t116:0.3107264713,t117:0.2897047531):5.518332662):0.7196936162):0.01574039646,(t118:1.927589035,(t119:1.029716127,(t120:0.349264082,t121:0.291134309):0.5744384395):0.8635797031):4.487571912):2.950548372,((t123:3.061541066,((t124:1.925082165,((t125:1.098189291,(t126:0.9605662636,t127:0.9366229926):0.02044179641):0.7372231985,(t128:0.6469810877,t129:0.5360948971):0.9854886982):0.08599599883):0.7555144856,(t130:1.618378464,(t131:1.200030686,((t132:0.657876366,t133:0.5658368987):0.3923549562,t134:0.8426930206):0.1138223871):0.403568785):0.6547461727):0.1778734358):1.010203515,(t135:0.4467381751,t136:0.3746309504):2.681625527):4.33062547):1.274280658,(((t137:1.120958474,(t138:0.3676844536,t139:0.3297625909):0.7221113429):1.397495984,t140:2.24208785):2.86499475,(t141:0.3056052563,((t142:0.09868831188,t143:0.05233240035):0.04602454793,t144:0.02384173968):0.02580081421):4.757935229):3.177872932):1.526046706):0.2904489908):1.3584945):7.368205121,(((((t145:0.6684656121,t146:0.6334292424):1.525279838,((t147:0.3506941707,t148:0.3030891335):0.1055138295,t149:0.339136733):1.532068858):3.987702428,((t150:0.261270576,t151:0.2225817738):2.984837527,(t152:0.3993393091,t153:0.3233369884):2.744123697):2.520327538):1.424647407,((t154:1.059907314,t155:0.8547691115):2.16929373,t156:2.913987607):3.670014521):1.26744295,((((t158:3.561848111,(t159:1.552162431,(t160:1.103435888,t161:1.062535249):0.3489093209):2.00962322):1.84905847,(t162:2.711602503,(((t163:0.1634087017,t164:0.08367623195):0.07529313387,t165:0.1008065262):2.460752756,t166:2.557226143):0.01158942732):2.483357029):1.281728099,(t167:5.443355685,t168:5.209879742):0.8582118329):0.4286426052,(((t169:3.859542846,(t170:0.3205817488,t171:0.2318417558):3.521443987):1.652954803,t172:5.348048373):0.7897788988,((((t173:0.7433088024,t174:0.7127636068):3.962197998,(t175:4.486706108,(t176:0.3435403324,t177:0.2844282511):4.126758204):0.1766993107):1.231257621,((t178:4.786386412,t179:4.670773487):0.8601893604,(t180:4.594533004,(t181:3.669031302,t182:3.619409717):0.7777862744):0.6852267325):0.1392201932):0.168534539,((t183:3.282244975,t184:3.10835407):1.169616517,((t185:3.456596043,((t186:0.6557970012,t187:0.5123902804):2.575507597,(t188:3.009490349,(t189:1.826437359,t190:1.818700797):1.171867362):0.07103086264):0.0897278858):0.6222077884,((t191:0.4176359406,t192:0.3922251371):1.268989813,t193:1.555950894):1.843859066):0.03367960359):0.8520762982):0.02238510006):0.144798769):0.2945103726):9.603020803):3.197675844,(((((((((((t194:1.656699776,t195:1.507591103):0.9725183204,t196:2.475671353):2.368219928,(t197:4.499506694,((t198:0.3565957319,t199:0.3526487454):2.190754478,t200:2.529768321):1.944364115):0.2928685084):2.609567599,t201:7.260874738):6.167062302,((((((t202:0.6922343929,(t203:0.2173484771,t204:0.0823363901):0.4201258551):0.7611381373,t205:1.248043163):1.250259537,t206:2.494044987):1.842668709,((((t207:1.733722158,t208:1.697386031):1.383132379,(t209:1.801340333,t210:1.740149686):1.272353538):0.3558508487,t211:3.341035144):0.05952726222,(t212:2.646601879,t213:2.562726773):0.648087795):0.7374555671):4.387095257,((((((t214:1.717574434,(t215:0.243063272,t216:0.2351359906):1.407732987):0.9801878532,t217:2.545247886):0.5976860224,(((t218:0.6217879551,t219:0.5671343706):0.7167642698,t220:1.262604274):0.2736708123,t221:1.432647396):1.318335269):0.4363256396,((t222:0.1538869596,t223:0.1292993097):2.780917375,(t224:1.814336361,t225:1.764905201):1.058538295):0.03888902301):0.8450219533,((((t226:2.390655399,(t227:1.18514075,t228:1.172698511):0.8918547248):0.02215140816,t230:1.989294758):0.5205965072,t231:2.465750186):0.5702004827,t232:3.003252561):0.1050620266):0.09559054103,(t233:1.727732838,(t234:1.421045502,(t235:1.202958785,(t236:0.1569478308,t237:0.09195900024):0.8479924053):0.1352216924):0.2311791256):1.340110709):3.533867292):2.956139726,((t238:0.3359026706,t239:0.2522462776):1.636534395,((t240:0.458550261,(t241:0.08386309821,t242:0.05643811127):0.3070213712):0.03059003542,t243:0.3474604967):1.367701372):7.115802879):1.501593827):0.8682075494,((((t244:7.020982985,t245:7.013042989):0.6919601448,((t246:0.2590563395,t247:0.08987888464):2.172646071,(t248:2.140943522,((((t249:0.4180156531,t250:0.4121935305):0.3621132476,t251:0.7041523329):0.2314570587,t252:0.9192772783):0.1375188957,(t253:0.5225917451,(t254:0.4660927875,t255:0.4615812794):0.0437002045):0.447566701):0.9469157879):0.07801011405):4.680286095):1.351290667,((((((((t256:0.7671957928,t257:0.7473206575):0.5753561429,(t258:0.9326804536,(t259:0.2250942706,t260:0.1280257191):0.532423354):0.3710064947):0.5785343779,t261:1.520287105):0.1401698697,(t262:0.1636415143,t263:0.07814448888):1.196841664):1.812021796,((t264:2.132350275,t265:1.840858308):0.4645520783,t266:2.154759812):0.4593894703):1.572685215,((t267:0.8540147416,t268:0.769264046):1.622173887,t269:2.350511872):1.457907523):1.780898879,t270:5.570851222):0.437119828,((t271:1.199470752,t272:0.8047061715):0.0924581211,t274:0.630305517):4.702932908):0.3295071798):0.7268259975,(((t275:0.09458011179,t276:0.07896271324):2.50789511,t277:2.324901307):0.6342215422,t278:2.902726961):3.146856235):1.341976159):0.1390691284,(t279:5.918903456,(t280:5.079447864,t281:5.038699455):0.8237101978):1.540314767):0.4521181416,(t282:7.329015528,((t283:3.635164662,t284:3.401632585):2.381361653,(t285:4.557887971,(t286:0.4049268514,t287:0.2684919746):4.042310364):1.199961308):1.219052679):0.4004037722):0.009799606329,(t288:5.669047912,(((t289:1.167600166,t290:1.120994478):1.323199533,t291:2.302364598):3.010616755,((t292:1.980881446,t293:1.929702132):1.606246912,t294:3.19304725):1.442714647):0.1144369577):1.463547949):0.6575259149,((((t295:3.256483287,(t296:2.993053026,t297:2.844680181):0.1868700397):0.7072639751,(t298:2.421396251,t299:2.199861302):1.201155616):0.6254711193,(t300:2.476079136,(t301:1.290018302,t302:1.22260695):1.090908427):1.505921211):0.9800182811,(t303:1.833375079,t304:1.74276877):2.957075565):1.114179884):0.01560233282,(t305:2.108377282,t306:2.067851581):3.712762081):1.523851331):0.3228969945,((t307:2.602300176,t308:2.476155614):2.301452466,((t309:3.793205709,(t310:2.332353937,(t311:1.973305744,t312:1.84365664):0.2753579524):1.369186146):0.6517570068,(t313:0.8413584111,t314:0.7719600987):3.263999846):0.2981040098):2.697734902):1.851020707,((t315:4.385846903,((t316:2.790495637,t317:2.788028908):0.9434215387,(t318:1.568349556,((t319:0.8251799534,t320:0.8049428964):0.2142726505,t321:0.6642366423):0.4433746358):2.097505711):0.5622902736):0.1520788996,(t322:3.27477188,(t323:2.739081672,((t324:1.294313478,(t325:0.8077194939,t326:0.8013014324):0.314938793):1.168419512,t327:2.262355945):0.06190797946):0.4633395939):0.2595400773):4.127777655):3.952223018):0.1409014939,((((t328:2.263462453,t329:2.256430771):0.2741747347,t330:2.512167739):7.06804779,((t331:1.632511059,((t332:0.7827899993,t333:0.583550051):0.2106397874,t334:0.6615972782):0.6069284695):7.072515406,((((((t335:1.926033777,((t336:1.073478163,t337:1.033157684):0.3091658199,((t338:0.3192873887,t339:0.1228591456):0.3179046669,t340:0.3955314178):0.6752051743):0.4460309817):0.3592233681,t341:1.875894118):0.8480578685,((t342:0.1276849503,t343:0.01683621936):0.1208211655,t344:0.05256149729):2.45209546):0.1040021935,(t345:0.9245709939,t346:0.8810690278):1.632239852):1.161128722,t347:3.585360546):0.144262168,((((t348:0.9351901831,(t349:0.1922180998,t350:0.1903317213):0.5927209583):1.287671371,(t351:1.436564532,(t352:0.2900088618,t353:0.1122946201):1.06897373):0.6142271522):0.116636423,(t354:0.8092189915,t355:0.8080788399):1.070861746):0.8719237203,(t356:1.135537186,(t357:0.9268205625,t358:0.6208107037):0.003550525602):1.584997876):0.3377306375):3.770125742):0.778455802):1.487254146,((t359:0.7471593352,(t360:0.1694632554,t361:0.03908600374):0.5355237201):4.881404426,t362:5.221190294):2.792340595):0.1673426442):0.7517884281):0.09440092497,(((t363:0.5193994825,t364:0.5064489118):7.715132484,((t365:0.9659951428,(t366:0.2243170484,t367:0.1882663706):0.6574580845):4.749885149,((t368:5.476650188,t369:5.388442599):0.06232156969,((t370:0.5868910717,t371:0.5445171062):0.1617086549,t372:0.5943422735):4.617468725):0.03930077589):2.2776663):0.6580830963,(t373:6.126652554,(t374:4.862834041,t375:4.772136429):1.226085662):1.965444247):0.1327111781):1.671759341):0.8558999141,((((((t376:0.2078938182,t377:0.1270387872):5.621284029,t378:5.65023633):0.1850169635,t379:5.753631663):1.985304226,(((((t380:3.515346357,(t381:3.214762632,t382:3.195651927):0.1843805199):1.026507238,((t383:0.6388054693,t384:0.5711271919):0.2496985485,t385:0.8158141148):3.41091052):1.025204479,t386:5.131674698):0.4537065263,((t387:3.150670507,t388:3.093005029):1.845641155,(t389:0.4445607297,t390:0.4283751136):4.327753227):0.4982671209):1.383415534,((t391:5.83418987,(t392:0.8707455578,((t393:0.3761623785,t394:0.275488039):0.1833118032,t395:0.4275490138):0.2557695774):4.92313578):0.7301524985,(t396:3.189913802,t397:3.151412768):3.145214598):0.05288365997):0.04331086329):0.3818032006,(((t398:3.823894872,(t399:1.308414069,(t400:0.6889929724,t401:0.6756708193):0.5866729642):2.48964719):2.075332239,((t402:0.9934452851,t403:0.9116541435):2.692837461,t404:3.599057431):2.133906899):0.7075412381,t405:6.353748878):0.1189011953):1.491290534,(t406:5.061517304,t407:4.914013873):2.757489664):0.7288054059):1.96017738):2.019721467):4.932489606,((((t408:0.7273081716,t409:0.5861644259):3.859063484,(t410:2.618989738,t411:2.503410861):1.604161996):1.535633647,((t412:2.913813648,t413:2.770962784):0.7249450734,(t414:3.390549304,(t415:1.074585259,t416:1.050511763):2.315304363):0.0766995922):1.965723929):9.518330456,((t417:5.890718158,(t418:3.731056443,t419:3.55718574):2.115066147):8.870683609,t420:14.52152071):0.02657972733):1.627699716):10.21112457,((((((t421:1.043388572,(t422:0.3148720322,t423:0.2868762362):0.445819115):1.311474241,t424:1.985221922):1.041511423,((t425:0.7145831894,t426:0.7060935219):1.845057254,t427:2.512755885):0.2434016019):0.5269146466,((t428:2.921981752,t429:2.919892869):0.07088715898,((((t430:1.177582763,t431:1.100758222):0.05901278672,t432:1.122680251):1.481538161,(t433:1.515729254,t434:1.408798762):0.5958285502):0.09187195039,t435:2.081551116):0.1681613718):0.2238502646):1.744070911,t436:4.203653341):10.13409143,(((((t437:1.298191787,t438:1.24303647):2.076905831,t439:3.109494471):0.9561099893,((t440:1.637717028,t441:1.543298062):1.972893544,(t442:1.637213346,t443:1.465415476):1.665124642):0.3745207229):1.07360874,(((((t444:1.531327089,t445:1.420288629):0.04587489336,t446:1.430785176):0.06438094364,t447:1.342802402):1.261894526,((t448:0.9821805105,(t449:0.8439465356,t450:0.8158563306):0.1214708297):1.005914062,t451:1.929822433):0.6132474992):0.1053689744,(t452:2.24835392,((t453:0.1173979746,t454:0.1012949388):0.01820967717,t455:0.1182465729):2.112067073):0.3298797498):1.30791954):0.3235568566,((t456:1.268122541,t457:1.19281511):0.2248154301,t458:1.36269076):2.556677392):8.591727808):10.54291764):8.834103334):0.3159360414,(((((t459:0.2851438163,t460:0.1895695649):1.701699972,(t461:1.68669712,t462:1.608421145):0.1651483288):1.17091058,t464:2.765976359):9.577901311,(((t465:0.700761804,t466:0.3775988628):2.054138079,t467:2.402770253):6.702955008,((((t468:0.2677762073,t470:0.1672882888):1.383843878,t471:1.464986393):5.072290224,t472:6.490637808):2.123549229,((((t473:0.493203581,t474:0.4330559086):1.602936346,(t475:0.9895179072,((t476:0.6462209758,t477:0.6341783989):0.08888500097,t478:0.7097856406):0.1553575278):0.9737263805):0.3938938247,(t479:0.2999325352,t480:0.2891131592):1.822945718):0.9156057332,(t481:0.7873499248,t482:0.3415442462):2.094408913):4.666216964):0.01923286962):2.724620246):4.938013648,(t484:1.492696761,t485:1.068949372):13.01463047):14.45960833):3.156930333,((((t486:0.01670407665,t487:0.004740351097):5.274000015,t488:5.200486214):3.619398912,(t489:2.269445857,t490:2.242042694):6.510380208):18.59345076,(t491:17.39417513,(t492:6.704354147,t493:6.452094295):10.54725589):9.89790444):4.084890674);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T23.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
