<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t462:9.857051597,(t463:7.765641027,((t464:1.630536642,((t465:0.9856065331,(t466:0.9286909537,t470:0.1368120881):0.01047216916):0.05595815441,t471:0.1851208902):0.5754061339):1.503433194,t472:2.18467003):4.621722194):2.073041524):0.2905540018,(t473:3.157880367,t474:3.077366108):5.854645785):13.60941952,(((t475:0.3402181916,t476:0.1224172703):7.059283599,(t477:1.22115526,t478:1.217362967):5.882632377):1.419392281,t479:8.08968311):13.67028149):2.359739398,t480:24.0786166):24.86352027,(((t481:3.350704637,t482:3.338573737):31.52963407,((((t483:8.486113817,(((t484:0.8842783271,t485:0.7783624939):1.302232832,t486:1.856282166):5.079330883,t487:6.875347044):1.121745199):0.269106735,(((t488:1.694247769,t489:1.656058081):1.536950354,(t490:2.019472659,t491:1.936936988):1.171481369):2.930883478,t492:5.99317831):1.947873185):1.035164932,(t493:6.478282275,((t494:0.1295294223,t495:0.04117048688):3.218759369,t496:3.230715939):3.070859412):2.357170793):0.8680618137,(t497:4.594665708,t498:4.563619488):4.9085731):24.19470566):2.555282643,((((t467:0.3459545791,t468:0.1306977084):0.3092811165,(t469:0.07452988602,((((t453:0.2497089411,(t435:0.1463005939,(t434:0.05653137287,((t369:0.4029437708,(t370:0.06664174216,(((t251:0.04091622339,(t252:0.0130865209,(t243:0.02162165754,(t242:0.3863831675,(((t211:0.07114577153,((t168:0.01271132955,((t151:0.1265792827,((((t1:3.965177269,t2:3.839426598):1.454283912,((((t3:1.316523414,t4:1.30789535):1.985410239,(t5:1.943560881,t6:1.943530105):1.348862282):0.5152340533,t7:3.790096119):0.750267402,((t8:3.616258929,((t9:1.894823153,(t10:0.6788709194,t11:0.553881292):1.214319642):0.5014788235,t12:2.195350335):1.194482639):0.4445632364,(t13:0.4634131429,t14:0.4093554796):3.209651228):0.3822398224):0.6957713376):7.499927179,(t15:5.003217846,((((t16:0.1455548875,t17:0.09744266321):2.228470691,t18:2.304230693):0.6999509637,(t19:2.402414239,t20:2.224793321):0.5881901825):1.345742264,(t21:2.866564682,t22:2.863083412):1.212664579):0.5191026688):6.988403169):0.08130648664,(((((t23:0.8256445191,t24:0.6681169685):0.03413481797,t25:0.5300969706):2.846823409,((t26:2.382518649,(t27:0.5937072891,t28:0.5732207168):1.75786409):0.8491248975,t29:3.116296711):0.08833779673):7.031030832,((((t30:1.197063814,t31:1.173626805):1.553505026,(((t32:0.8431432586,t33:0.8092296379):0.2427288538,t34:1.047299198):0.3862415529,t35:1.185998629):1.234647229):0.2920867968,t36:2.689096616):4.501381562,((t37:1.736958426,((t38:1.097491057,t39:0.690412706):0.4516184872,(t40:0.1471902493,t41:0.1454585733):0.9866380744):0.1503294532):2.151716116,(((t42:1.396068686,t43:0.9839754768):0.1075962913,(t44:0.06365643015,t45:0.03749590406):0.9917233409):0.5153136624,t46:1.436628887):1.378618817):3.242874475):2.545314665):0.7794021922,t47:9.24558894):0.1255168547):0.1519059553):1.729652232,((((((t48:4.82012377,((t49:1.296843345,t50:1.273973195):0.5823501994,(t51:0.9337984431,t52:0.9088039733):0.778650007):2.877177187):4.389230557,(t53:8.703199939,((t54:1.199174741,((t55:0.522323824,t56:0.3328802954):0.634575511,t57:0.9241276586):0.04060999426):5.455136609,(((t58:0.3429773157,t59:0.3142990768):0.2083702279,t60:0.4895781293):0.209806051,t61:0.5999774154):5.517690868):1.938913729):0.1667089232):0.001544405638,(t62:8.091715095,(t63:7.785504411,t64:7.765234876):0.3060160721):0.04843033233):0.4462859658,(((t65:0.1578418659,t66:0.1390152448):1.024402291,(((t67:0.2724114411,t68:0.1659724141):0.1570472357,t69:0.2227305588):0.2216091568,(t70:0.2701650696,t71:0.147965781):0.1501259195):0.194435153):5.777412158,t72:6.203902216):1.581541785):0.3247945947,((t73:0.7637197067,t74:0.6370516753):1.28435365,t75:1.776358922):5.516368332):0.5411779658,(((t76:0.5983316088,t77:0.5506571685):0.8149708315,(t78:1.185537385,t79:1.040539077):0.1478757309):5.698619121,(((t80:0.2523225058,t81:0.1936259076):0.2836456416,t82:0.3913198949):5.556892436,((t83:1.662209655,t84:1.641761846):0.6637245034,(((t85:0.1731798765,t86:0.1180617241):0.2823783632,t87:0.398426452):1.004530001,t88:1.278794935):0.8147306905):3.575009468):0.7550739094):0.7186273228):0.3535038589):0.08651299915):3.981618784,(((t89:6.620896135,t90:6.606186212):1.653550936,(((t91:3.319245015,t92:3.294666464):0.2941793597,t93:3.562826076):2.83209677,(t94:5.055983156,(t95:4.551013386,((t96:0.2080026296,t97:0.1885372572):2.924012709,(t98:1.385572614,t99:1.357385164):1.558041564):1.315573943):0.4856021795):1.314817414):1.811568287):0.6787544159,((t100:2.283187724,t101:2.023439992):2.748859847,(((t102:2.873461947,t103:2.776317529):0.2626286896,t104:3.015126131):1.146626075,t105:4.010276092):0.4194331532):3.215537077):2.506668541):0.450564034):1.310436138,((((t106:2.106633037,t107:1.985551202):3.638095456,(t108:2.187530763,t109:2.11199594):3.390357863):1.50759781,(((t110:1.099070089,t111:0.9773131739):2.126715383,(((t112:0.6486052176,t113:0.6253387554):0.6635748074,t114:1.195125823):1.111295576,t115:2.27132334):0.5050584444):2.427826567,((t116:2.793629297,t117:2.743154131):0.4778222191,(t118:2.989352021,t119:2.922324813):0.1911572083):1.892985824):1.116368228):1.564577664,(((t120:2.197551137,t121:2.189826969):1.131142118,((t122:2.016928713,t123:1.938895566):0.7362237183,((t124:0.5557306101,t125:0.5282150889):0.1722879478,t126:0.6773529531):1.937860835):0.5350303256):0.0816787234,t127:3.096918332):4.115106846):2.971431395):1.746549839,(((t128:0.4047440862,t129:0.30213066):2.723020151,t130:2.976254122):0.4398357987,((t131:1.332374246,(t132:0.09714680707,t133:0.07245670428):1.161707479):1.117634036,t134:2.336279352):0.8418507317):8.182975931):1.000382519):0.2328934362):0.8026967149):0.02479628102):0.9149109869,((((((((t135:0.8559848388,t136:0.652365456):1.680359052,(t137:0.7931707806,t138:0.5224535682):1.462708583):1.498383335,(t139:3.020066937,(((((t140:0.9872706032,(t141:0.5439564724,t142:0.542515308):0.4422803846):0.2573461125,t143:1.208007288):0.2067823291,(t144:0.8103192664,(t145:0.1871248314,t146:0.03259740149):0.5680133512):0.6002407228):0.79087471,(t147:1.634589935,t148:1.235495507):0.2890769254):0.4705381913,t149:1.765858118):0.1789885813):0.4294540875):3.082492889,(t150:2.712585948,t152:2.522646559):2.668270474):0.9026639018,(((t153:0.3073022461,t154:0.1891849989):4.879183205,((t155:2.154663304,t156:2.107141925):2.876663969,((t157:1.447019319,((t158:0.2264495271,t159:0.1067374356):0.8592943796,(t160:0.3165376646,t161:0.2717370478):0.6131447307):0.3275070611):0.5780562109,t162:1.74500817):2.574439206):0.01048884995):0.5421260773,((((t163:0.9237257008,t164:0.8508202973):0.04897606475,t165:0.8686002148):0.1542750561,(t166:0.4094404157,t167:0.2945663256):0.4931244462):0.5818615235,t169:0.6699621177):3.160814706):0.2491525968):0.1813133236,t170:4.242583855):3.681096757,(t171:6.854252795,((t172:2.370735238,(t173:0.2209195642,t174:0.1153271038):2.108684558):2.318941838,(t175:1.403739134,(t176:0.4174986666,t177:0.4159164711):0.9436226787):3.135020968):2.15820358):0.7532492517):1.081807955,(((((t178:0.3535312065,t179:0.3188501541):5.822316092,(t180:0.8480850195,t181:0.7587385404):5.123188967):0.8108799757,(t182:5.673046678,(t183:0.7509718775,t184:0.5687546283):4.859150483):0.4048940992):0.2936834097,t185:6.114651848):1.056153541,(t186:1.304322063,t187:1.198817535):5.866463475):0.06309841905):1.229928053):8.275351958,(((((t188:1.009636431,t189:0.8811877223):4.516151116,t190:5.375927759):1.807496832,((t191:1.558877379,t192:1.517902969):0.6352417007,t193:2.014000408):4.863156433):0.3725375125,((((t194:0.1638931969,t195:0.07078859179):0.5504514882,t196:0.6063327619):1.568773239,(t197:0.1924164319,t198:0.05056141691):1.802569631):1.104475168,t199:2.78413024):3.858515502):4.099042448,((t200:2.795215673,(t201:2.571214396,t202:2.153238647):0.2234568157):3.74968679,t203:6.06892592):4.173205308):4.74857729):2.118424884):0.2373104543):1.092009615,((((((((((t204:3.903522918,(t205:2.137981183,(t206:1.482933443,t207:1.370016196):0.5043445975):1.764633897):1.008218279,((t208:3.946548348,(t209:3.566331863,(t210:3.184987326,(t212:2.319185043,t213:2.310714553):0.5910593178):0.2198230578):0.3363721774):0.1390425401,(t214:3.571542026,((t215:2.202266798,t216:2.200977309):0.1405828613,t217:2.142557925):1.148149352):0.02332472809):0.485879656):0.2880446376,(((t218:2.337347119,(t219:2.105614057,t220:1.975859461):0.1146367746):1.203329093,(t221:0.9192426978,t222:0.849001105):2.144756571):0.2502634325,t223:3.142129207):0.2567210328):0.7644288429,(t224:0.1892718282,t225:0.1310087522):3.774152392):3.184242581,(t226:4.746008006,((t227:2.87668122,(t228:1.630622058,t229:1.134794733):1.141477798):1.113884071,t230:3.371599265):0.6932035857):2.026424774):4.675420477,((((t231:1.561118162,((t232:0.4614013263,t233:0.4517888597):0.2402585101,t234:0.5611664374):0.5484709747):1.559229281,(((t235:0.8619333103,(t236:0.5772849395,t237:0.5017438563):0.0428480663):1.062884213,t238:1.471147343):0.4810311099,((t239:0.09796980049,t240:0.09197949411):1.513405233,t241:1.530482243):0.3140735562):0.216148857):2.525011878,(t244:1.07491936,t245:1.056323522):2.797179472):4.902521925,((t246:3.788831992,(t247:2.27051287,((t248:0.7858887537,t249:0.5426167476):0.7233049695,(((t250:0.4313000422,t253:0.3072910583):0.02892934374,t254:0.2984358145):0.03799926051,t255:0.2663201229):0.7150742985):0.7410131613):1.416608698):3.956479079,((t256:1.739556962,(t257:1.015388636,t258:0.6937515169):0.6633932568):0.4427344388,t259:1.760747168):4.779160009):0.7540582207):0.04105672711):0.2629803151,(t260:1.001514677,t261:0.8181770339):6.501978784):0.5974048166,(((t262:3.160628979,t263:3.07720004):2.583956031,(t264:4.201859056,t265:4.17827985):1.252137185):1.86533999,((t266:1.809434931,t267:1.588404839):3.909012329,((t268:0.9945785635,t269:0.9357265102):1.492743891,t270:2.345222546):2.863153541):1.445914304):0.2564692776):1.585664274,(((t271:5.621272729,(t272:4.500243414,(t273:1.974471181,(t274:0.5602763232,t275:0.5337330682):1.297914465):2.484177769):1.094642075):0.1952451043,t276:5.297674434):1.569906035,(t277:5.711315638,(((t278:4.285917599,((t279:1.463774626,(t280:0.5092197504,t281:0.4861163219):0.7876778605):2.531421667,(t282:0.2721087789,t283:0.268143402):3.529520701):0.2052091825):1.121105321,((t284:3.152459584,t285:3.097522802):0.7929598535,(t286:1.559945848,(t287:0.8425374249,t288:0.8285240595):0.5564945061):2.115349802):1.128175037):0.05751962622,t289:4.590911229):0.1768060171):1.144784104):0.9433669254):0.9501050317,((t290:3.249588949,t291:2.899585545):3.974618991,(t292:5.348338982,t293:5.34499895):1.32195137):0.5645015351):1.206424827):4.581495166):0.179968048):1.444301184):0.4477892333,((((t294:3.705051612,t295:3.698387612):5.607092639,((t296:3.302047866,t297:3.280372154):2.699440462,(t298:1.269912365,(t299:0.4970886873,t300:0.4526406855):0.7409000826):4.521748164):3.187834273):2.665234375,(t301:5.445724041,(((t302:2.622351371,(t303:1.40460959,t304:1.373705195):0.7784053727):1.399583243,(t305:0.7362424765,t306:0.6243091916):2.797928653):1.149928861,t307:4.55087414):0.1654936595):6.116271621):1.011834019,((((t308:1.868987178,t309:1.766329957):0.2624854412,(t310:1.212931589,t311:1.179740633):0.8076654946):3.108514495,((t312:2.77999332,(t313:2.498053378,t314:2.252249839):0.2792827108):0.5411652853,((t315:1.949107452,(t316:0.3539732519,t317:0.3363175798):1.418300641):1.002575819,((t318:1.213716061,t319:0.9712883854):1.007155218,(t320:1.817172335,(t321:0.7870607851,t322:0.5363219758):0.7335349556):0.1540221994):0.3959182592):0.1142870666):1.764038453):2.990978037,((((t323:0.6891892287,t324:0.6376245776):2.02587188,(t325:1.661555865,t326:1.631733856):0.9185114206):0.08353660654,(((t327:0.2127210234,t328:0.188463532):0.6003406042,t329:0.7655272651):0.02850372741,t330:0.7735675538):1.751137895):0.3192604371,(t331:1.811485224,(t332:0.8901009415,t333:0.8804457196):0.8907162025):0.9639561991):3.418563402):3.571448945):1.874856036):0.4805155268,(t334:2.174840616,((t335:0.2167792539,t336:0.1056066802):1.800948027,t337:1.851264016):0.1402103511):9.764660625):0.1408606383,(((t338:0.4325599118,t339:0.3454500029):8.132979764,(((((t340:1.001832964,t341:0.9051178134):0.4656148558,t342:1.31862002):2.212443635,t343:3.169517819):0.3025849359,((((t344:0.6065267758,t345:0.5863424745):0.4336773124,(t346:0.9097606543,(t347:0.5784491174,t348:0.2035823473):0.1798900748):0.07161633586):0.794304824,t349:1.216007694):0.8378232707,t350:1.673656566):0.7641756091):2.046801497,t351:4.468446173):2.35255749):1.12217548,(((t352:1.00731294,((t353:0.02155307976,t354:0.01980040518):0.2491635606,t355:0.1682758063):0.7056448149):0.2965806702,t356:1.130393145):6.497928823,(t357:4.311575577,(t358:0.3695706848,t359:0.335513673):3.444866066):3.30454735):0.04159394552):2.053619571):0.7248235552):0.04412136656):1.124796119,(((((t360:1.057501556,((t361:0.5369346639,t362:0.4916175161):0.3152475275,t363:0.7966980875):0.1918433138):7.444479647,((((t364:0.1882056661,t365:0.1090189044):0.007497128861,t366:0.06636998901):7.300763493,(((t367:0.5527619139,t368:0.5338525857):3.162497643,(t371:1.329183965,t372:1.272875402):1.689745445):2.665666374,(t373:0.6151814352,t374:0.4349155061):4.829284518):0.9808219767):0.542603936,(t375:1.581123567,t376:1.445469735):5.057711516):0.3613241679):1.005790519,t377:7.771211488):0.1057864404,(((t378:0.9715605593,t379:0.862639146):0.9358919002,t380:1.777347209):4.344400227,(t381:4.286842653,(t382:3.84456685,((t383:1.221644812,t384:1.19479032):2.507128807,t385:3.666901715):0.08212859401):0.439208039):1.747586616):1.525798598):0.3291468253,((t386:1.396999708,t387:1.257301511):2.33748129,t388:3.41927776):4.0301619):1.089288259):9.903656852,((t389:8.453484415,((((t390:4.275731616,(t391:2.76231632,t392:2.745063244):1.510197072):2.203185012,((t393:3.224301876,t394:3.098722468):0.3872540029,(t395:3.319482003,t396:3.221468059):0.06585048403):2.819331834):0.5834325366,((t397:5.604926261,t398:5.599475767):0.6711340495,((((t399:3.056785671,t400:2.938619164):1.177187731,t401:4.026524376):1.33911502,((((t402:1.302121277,t403:1.221671142):3.069158932,t404:4.215345528):0.1605751423,((t405:2.576141796,(t406:0.05713957301,t407:0.05485235932):2.487144927):1.660100471,(((t408:3.292292785,(t409:1.444996586,t410:1.403487584):1.557745196):0.3454768601,t411:2.964356261):0.008059108672,t412:2.962908798):0.5315916017):0.1197395515):0.01187233877,((t413:0.757051613,t414:0.589968101):2.077465777,(t415:2.595931083,t416:2.562239372):0.03788101596):0.7461977388):0.7729675806):0.01150555622,((t417:0.128708157,t418:0.1011940839):2.912556251,((t419:2.056205861,t420:2.045648659):0.5886534096,((t421:1.569497992,t422:1.487148614):0.197979209,t423:1.582788232):0.8407236469):0.1805106028):1.085059688):0.5926337656):0.005537591342):0.2603040373,((t424:1.273996579,t425:1.05828167):3.066984019,(((t426:1.320268445,(t427:1.182897285,t428:1.078319395):0.006943746191):1.854224622,((t429:0.6339937675,t430:0.5277526815):1.121121543,t431:1.556894695):1.130641647):0.2002638226,((((t432:0.5414079453,(t433:0.2939739234,t436:0.03450571157):0.1229925356):0.02626712453,t437:0.1764500224):0.958362697,t438:0.9904101633):0.9232154979,t439:1.767265887):0.3536453804):0.7024522533):0.1478773817):1.110702281):7.094779584,((((t440:2.781060782,(t441:2.599504564,((((t442:1.080273983,t443:1.043403447):0.7953319817,(t444:1.54556633,(t445:0.4238231542,t446:0.4133967121):1.046267758):0.2843797955):0.2863305554,((t447:0.9217225569,t448:0.8501481572):0.9075788414,t449:1.657011759):0.1984448778):0.3746081021,(t450:1.582450895,(t451:0.3154565948,t452:0.1457784469):1.168749169):0.533950257):0.03378645729):0.1584623649):0.4909647798,t454:2.212492214):0.216087266,((t455:0.6365630214,t456:0.5990986467):0.4990434303,t457:1.080416325):0.9074192477):4.441595501,(t458:2.272547662,((t459:0.6856484449,t460:0.6020052548):0.3137038167,t461:0.8985521352):1.082939345):4.106861405):3.146715781):2.818733255):27.89049277):11.18623958);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T19.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
