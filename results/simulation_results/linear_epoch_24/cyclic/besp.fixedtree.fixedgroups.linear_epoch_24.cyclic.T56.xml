<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t452:0.3415824386,t453:0.08007155559):6.660155547,t454:6.690271516):3.475039431,t455:10.1417793):133.7999028,((t456:1.952918967,t457:1.881831346):41.16371922,(((((((t458:0.2156102879,t459:0.1922582893):8.12867832,((t460:1.791220188,t461:1.768993087):2.353857749,(t464:1.795125012,t465:1.635902172):1.844311148):4.128909405):2.983923932,(t466:4.385454474,t467:4.229931556):6.020287309):6.105289449,t468:16.05029862):1.341885434,((t469:5.114819025,(t471:0.5677369653,t472:0.5428049184):4.19931007):2.522383712,(t473:6.4311862,(t474:0.9065231963,t475:0.8590466583):5.469864192):0.6891135371):9.656915469):1.153143108,t476:17.80611375):20.96336486,(t477:36.62224827,((t478:0.4090007541,t479:0.1847349445):6.019109713,((((t470:0.03689060022,((t462:0.1630503836,t463:0.1437204259):0.07154747802,(((t347:0.161101988,(t337:0.03258155091,(t281:0.03865132667,(((((((((((t156:0.05200326491,(((t139:0.007537136965,(t130:0.001423443034,((((t46:0.04207269641,(t1:4.198692782,((t2:3.179790314,t3:3.167756592):0.2661877754,t4:3.346253581):0.7241313994):0.7865687014):0.1469864018,t5:4.996934372):6.059391761,((t6:5.945595264,((t7:1.581553127,t8:1.436840026):2.486458495,(t9:2.308319937,t10:1.895385454):1.490596002):1.799889158):1.358105139,(((t11:1.60156105,t12:1.486001715):1.094919369,t13:2.377466489):0.7803977123,t14:3.131285309):3.003754633):3.718028808):1.376049143,(((t15:0.789143973,t16:0.5298591479):4.346694377,(t17:4.141905924,((t18:0.1915965017,t19:0.1873975589):2.007764738,t20:2.184860723):1.94177221):0.7143624186):1.376065608,((t21:3.202917556,(((t22:1.697088256,t23:1.622142758):0.550161047,t24:1.957258239):0.3444654856,(t25:1.623190206,(t26:0.4148140025,t27:0.3503715374):1.203308911):0.6490948122):0.552476833):0.6598026774,(((t28:1.256204585,((t29:0.5770711038,t30:0.4974094076):0.2208198461,t31:0.6032681697):0.4439732143):1.411246393,t32:2.37581908):0.1524654127,((t33:0.8658399423,t34:0.8265990856):0.5762938674,t35:1.396270408):0.7514126433):0.1487944184):2.276565266):4.319703221):1.066175795):0.5341875962):0.5328372678,(((t36:2.651670127,((t37:0.4626251913,t38:0.4189341378):0.01667351116,t39:0.2137522158):1.861546848):6.335719103,(t40:0.22211992,t41:0.1854989497):7.948008214):1.717959597,((((t42:0.7421215381,t43:0.7225287533):0.4971330672,t44:1.083965729):0.9981719626,t45:2.009153261):7.102832038,((t47:7.229873579,t48:7.093668168):0.6500497782,((((t49:2.542180379,(t50:0.931193541,t51:0.9265519778):1.506531629):3.418863539,t52:5.72411286):0.6612407137,(((t53:0.9234608756,t54:0.7563887187):2.427380468,t55:3.147715707):2.016402904,(t56:2.547321539,(t57:1.532861603,t58:0.8778702913):0.9844695335):2.611965571):0.7352200546):0.1059014521,t59:5.071567247):0.9410599915):1.178765749):0.4681056247):0.1784970396):0.2896019492,((t60:1.656552199,t61:1.592872792):3.477815924,((t62:0.5215942992,t63:0.3968715903):4.293822333,t64:4.643372817):0.2352057476):2.966893834):0.7102949813):2.090767545,((((((((t65:4.855838308,(((t66:0.3652020046,t67:0.3603641223):0.8482443692,t68:1.05840467):2.751955522,t69:3.740286069):0.8277001981):0.6124326783,t70:4.984079442):0.994227482,((t71:0.9535199408,t72:0.8580810185):4.115059031,t73:4.550774041):0.8376384031):0.8868757261,((t74:2.878236738,(t75:0.1363405871,t76:0.1318256084):2.54242871):2.732484664,(((((t77:2.800984866,(t78:1.692737701,t79:1.685454028):1.10076786):0.8183888599,(t80:2.341113101,t81:2.317816337):1.020535379):0.1228496921,t82:3.390870815):0.001857624612,t83:3.288741257):0.41266411,(t84:2.579142315,t85:2.484117444):1.083893271):0.9496622034):0.554841841):0.9733459077,(t86:5.200525606,t87:5.188145643):0.6434590318):0.1824703377,((t88:0.232608604,t89:0.1544498184):4.067383345,((t90:1.315577127,t91:1.179599222):1.888307609,(((t92:1.29716121,t93:1.206118919):0.5307165824,t94:1.428552784):0.9937077407,((t95:0.02365773863,t96:0.004453268767):1.793362009,(t97:1.289530669,t98:1.222460597):0.4848820891):0.4431272184):0.1294205984):0.8393538949):1.698198454):0.4707767265,(t99:3.1596961,t100:2.984460953):2.115503241):1.42819102,t101:6.506759178):0.1715603505):3.38619296,(((((t102:1.058156527,t103:1.001338261):2.155445138,((t104:2.01140421,(t105:0.1225991734,t106:0.07409061779):1.817705443):0.3474144561,t107:1.839995241):0.5715731536):0.6423787203,(((t108:1.248202099,t109:1.232418924):0.7111596067,t110:1.91218378):0.4169956441,t111:2.278839717):0.653966467):0.3039564887,(t112:2.094875684,t113:2.064063917):1.097623818):2.37783697,(t114:0.3404150446,t115:0.1313794115):5.192800436):3.447012757):0.7540073575,(((((t116:0.2560039129,t117:0.2352595337):1.060281991,t118:1.271257244):1.24339462,t119:2.302867835):0.1246545987,t120:2.361308703):0.5209941806,(((t121:1.532964368,t122:1.50564104):0.07213436213,((t123:0.6035558924,t124:0.6010731778):0.8469704167,(((t125:0.2702371342,t126:0.1860856562):0.3822166093,t127:0.5110607628):0.02087657205,t128:0.4705490406):0.7577959576):0.1076270817):0.6213263199,t129:1.542351453):0.5381025322):6.312007233):0.7237414013,(((t131:0.309179301,t132:0.294768579):0.04501680372,t133:0.2439062522):0.8147424276,(t134:0.8691847127,t135:0.857806341):0.1732174005):7.777850198):0.09141706339,(((((t136:1.012425332,t137:0.996906762):0.2109371087,(t138:0.9485778541,t140:0.8925422688):0.05405996749):1.100028875,(t141:0.907412981,(t142:0.6955687846,t143:0.6373767564):0.1448430134):0.9778510642):0.7208134933,(t144:2.421645873,((t145:1.037518132,t146:0.785687029):0.211830494,(t147:0.5175371362,(t148:0.119984087,t149:0.06877898701):0.2771210295):0.423568298):0.9394393715):0.02707430008):5.142741109,t150:6.861555938):0.656980604):0.8643399311,((t151:1.345510107,(t152:0.1433675119,t153:0.1107109648):1.091517755):2.336844011,((t154:0.9209967262,t155:0.7866068544):1.766761902,(((t157:0.04793352804,t158:0.04226013397):0.2536694991,t159:0.262502098):0.4462665638,t160:0.4520738769):1.624001411):0.7533034597):4.663580263):0.801403287,(((t161:6.386035241,t162:6.192773125):0.7104376266,((t163:5.482433436,t164:5.286520184):1.340899744,(t165:6.384701583,t166:6.306636745):0.1755252835):0.0377488321):0.2533134095,t167:6.575188202):0.5910129424):0.6261499027,t168:7.778664054):0.09190286792,(((t169:6.984320677,(t170:4.150177929,(t171:0.2364998813,t172:0.1558063434):3.901731906):2.757081008):0.7483298717,(((t173:1.338569949,t174:1.248857089):3.856065415,t175:4.966596933):1.899454902,(t176:5.058756374,(t177:3.096822266,t178:2.803241569):1.758460101):1.661989598):0.1940398725):0.08446034301,((((t179:2.256835278,t180:2.213345708):1.982017716,t181:4.107895056):0.8017424211,t182:4.89993858):0.7122509064,(t183:4.948190836,(t184:4.046521735,(t185:2.288913431,t186:2.269235369):1.587252828):0.8721520302):0.6027041892):0.7050355923):0.02612933432):0.01490533493,t187:5.357059417):3.589417804):3.705566369):1.182254882):8.715597316,((((((((t188:2.395993619,(t189:1.893273975,t190:1.798523892):0.4832388914):1.870186066,(((t191:0.2200108822,t192:0.1839435585):2.508405272,((t193:2.543171316,(t194:2.103508244,t195:2.02771689):0.4360337418):0.1211155295,t196:2.542837289):0.02387515332):0.5131079939,(t197:1.431571943,t198:1.285106746):1.53288722):0.8962529336):4.864775264,((((t199:2.304308509,(t200:1.251595637,(t201:0.6428474088,t202:0.625980993):0.4851337388):1.029911692):0.6252565731,t203:2.109335708):0.1242056039,t204:2.12555188):2.582263519,((t205:1.213378825,t206:0.9539935706):0.03208068907,t207:0.9569972806):3.318832267):2.826390952):2.460142925,(((t208:0.5932895379,(t209:0.4262112739,t210:0.4256974558):0.1540773855):2.424465741,t211:2.998201626):5.144646393,(((((t212:1.900989339,(t213:1.628343025,t214:1.560282854):0.255227926):1.163568636,(t215:2.374849942,(t216:2.1772856,t217:2.171284744):0.193578244):0.6029814711):0.008843169527,((t218:0.3276669152,t219:0.3062091704):1.29528093,((t220:1.076837032,(t221:0.7675295977,t222:0.6153538849):0.2593178163):0.3308067258,(t223:0.8790503275,t224:0.6734482986):0.3110843016):0.1393370739):1.301820899):0.1224248534,(t225:0.9903022921,t226:0.8528094883):1.356887328):1.219427652,((t227:0.08030892405,t228:0.06670726006):2.794008009,t229:2.761022997):0.3889306133):3.681631346):1.329930514):4.771182284,(((((t230:0.5577132861,t231:0.5340629523):0.3009163953,(t232:0.1787439242,t233:0.1153250749):0.6252646302):0.9598306795,(t234:1.371457289,t235:1.317344362):0.322070294):2.180981678,(((((t236:0.5391797846,t237:0.1637543416):0.813853745,((t238:0.1291214358,(t239:0.02448020375,t240:0.01624792127):0.04808090285):0.6008067028,t241:0.6413981495):0.1881082478):0.07881919124,t242:0.4972711412):0.1765819901,t243:0.6537542174):0.9739585853,t244:1.512326499):1.210797516):8.586748377,((t245:0.3921869992,t246:0.2725207968):0.250295812,(t247:0.1309390648,t248:0.08555939628):0.295552622):10.64098207):0.3415849107):1.112576382,((((t249:7.18229539,((t250:2.169905839,(t251:0.3584036577,t252:0.345822678):1.798373191):0.03075659704,t253:2.12456941):4.958108364):2.114795588,t254:9.033605113):0.7695676101,((((t255:4.57636143,t256:4.480517516):1.432988134,t257:5.338467236):0.4936415814,((t258:1.369161038,t259:1.350091935):3.573267909,t260:4.831696065):0.6125139864):0.3028434349,((t261:1.634428898,t262:1.54043777):4.06891413,t263:5.524865075):0.02954561357):2.4227762):1.027965277,(((t264:4.462841654,(t265:3.567951965,t266:3.52446395):0.4986211277):2.648335847,((((t267:0.6018722746,t268:0.5940723936):0.1182856513,t269:0.6850414182):3.29017605,t270:3.96528713):0.6351390724,(t271:3.587759996,t272:3.538441765):0.9670891351):1.982975021):1.762028656,(((t273:4.660997932,((t274:2.34943069,t275:2.255471591):0.003994761853,t276:2.193074825):2.287949614):2.432618218,(((t277:3.341735529,t278:3.247704169):1.212283228,t279:3.978774659):0.9133542688,((t280:3.654256237,(t282:2.283850935,t283:2.283176188):1.145952):1.154556608,(t284:1.786325561,t285:1.683151366):2.793636866):0.02021011743):1.375147119):1.073488623,((((t286:3.017248917,((t287:2.168439221,(t288:0.2839676707,t289:0.2503633776):1.83736648):0.3284104252,(t290:0.3291825082,t291:0.2106040221):2.074151953):0.1697924987):1.955850349,(t292:3.340755529,t293:3.313186043):1.066935961):0.8547225483,(((t294:1.616339928,(t295:1.093305023,t296:1.050068065):0.4912997158):1.20063432,(t297:0.2051036023,t298:0.1091065621):2.480923887):1.491143056,(t299:3.897908636,t300:3.880903223):0.1615034175):0.8753520413):0.04557207686,t301:4.941147549):1.054119101):0.0507369994):0.09657731462):1.349794533):2.543023273,((((t302:3.421893363,((t303:0.8654895371,t304:0.8156280567):0.3736027574,(t305:0.8027776287,t306:0.7793017922):0.3791732896):2.031514906):0.2245868489,((((t307:0.2932295095,t308:0.2667271843):0.1644804723,t309:0.3933850334):1.867394041,t310:2.254644973):0.06773698997,t311:2.214288463):0.9961418403):1.0089728,(t312:0.5597717508,t313:0.5546184874):3.643840832):1.78124899,(((t314:0.1997678105,t315:0.1940566527):3.163211362,t316:3.304305134):1.927276344,((t317:0.4794232639,t318:0.4215706683):3.731845979,(((t319:0.9373540013,t320:0.8439638755):1.766292185,(t321:1.160265475,t322:1.039307213):1.312158913):0.9035649034,(((t323:0.2938084455,t324:0.2695594175):1.375920443,t325:1.613872747):1.361919837,(t326:1.569249448,t327:1.457135669):1.30293181):0.2065626398):0.3006575525):0.9323221272):0.5820098069):3.435551585):1.050771782,(t328:2.94688466,t329:2.665784482):6.284310561):1.307935775):3.171811178,(((t330:1.146726015,t331:1.136870627):3.778614079,((t332:0.5976998007,t333:0.5560052174):2.769512112,((t334:0.1280743551,t335:0.1228641836):2.807676613,((t336:1.151882932,t338:0.9832664634):0.8268274324,(t339:1.235123762,(t340:0.6476218929,(t341:0.204969148,t342:0.005808617288):0.3506222756):0.5384742222):0.5182084475):0.8153483965):0.3580360363):1.533720229):6.71724727,(((t343:0.5921375628,t344:0.2630997442):7.405489322,(((t345:0.3784990331,t346:0.2747332875):1.882079836,t348:1.978099267):2.899563528,((((t349:1.221194601,t350:1.089359397):0.1245561244,(t351:0.5671713513,t352:0.5500338933):0.5245808925):0.6031268708,t353:1.608984552):0.3812470184,(t354:0.6954705625,(t355:0.3472070986,t356:0.2573986784):0.3429109659):1.217463867):2.168884672):2.443888475):1.397344185,(((t357:1.16524079,t358:1.153498058):2.299558728,(((t359:0.3079896505,t360:0.1133983266):1.715490185,t361:1.775655973):0.104238187,t362:1.683013436):1.272801038):0.1821238634,((t363:1.061441404,t364:0.9605000696):0.2000402176,t365:0.8445868746):1.869701675):4.03917305):1.426159704):1.739021404):0.3751156358):1.172220561):3.961444673,((t366:9.345228931,((((t367:5.8199192,(t368:0.09363753143,t369:0.03176743891):5.720142632):1.48779556,t370:7.215465979):0.8492556948,((t371:2.469113225,t372:2.185436171):5.007609255,((t373:2.360284969,t374:2.234955161):4.610435484,((t375:4.597640933,t376:4.238643447):1.027801716,(((t377:3.382544488,t378:3.285054469):0.1408590026,(t379:2.276249297,t380:2.070413542):1.095835629):1.173968567,t381:4.239691794):0.3143698083):1.203162992):0.1105984172):0.4999540151):0.8320815949,((t382:5.709543141,((t383:0.321316065,t384:0.3040723742):1.513456141,(t385:0.4325429503,t386:0.350885576):1.340364233):3.83005722):1.216824825,((t387:3.591251761,t388:3.588147312):2.683803257,(t389:5.865279437,(t390:2.294100232,t391:2.190940823):3.561133662):0.3824625987):0.3490283743):0.160156253):0.3136737115):0.9387765001,(((((t392:2.654210386,t393:2.559145557):1.57243308,(t394:3.127761238,(t395:0.1014164162,t396:0.09870548337):3.019329432):0.9694777137):1.577812283,(t397:1.617372227,t398:1.559156766):3.948080941):0.2526582233,((t399:3.874433892,t400:3.68484939):1.739570404,t401:5.008206755):0.1429089187):0.6318134106,((t402:4.636327573,(((t403:2.494399639,t404:2.462589509):1.824323105,((t405:1.46300635,t406:1.448702014):0.8701658482,t407:2.277648183):1.867325126):0.1218698965,(t408:0.7298562575,t409:0.7294314519):3.533173401):0.0291890267):0.003309792165,t410:4.262605898):0.8799878358):0.7972953253):5.080495608):2.235815803,((((((((t411:2.935142305,(t412:1.877596043,(t413:0.029136837,t414:0.02663426707):1.836787857):1.055534328):0.2562629758,t415:3.038399639):0.6255382109,t416:3.469776587):1.041705072,(((((t417:0.6730875162,(t418:0.336589722,t419:0.3217678736):0.1827365438):1.467303467,t420:1.850103422):0.9103934609,t421:2.660896746):0.8166981522,(((((t422:0.6402766726,(t423:0.3546477351,t424:0.03350533638):0.1445416909):0.2127148835,t425:0.2562717403):1.199805048,t426:1.370087002):0.1676875737,t427:1.1998144):0.7550512561,(t428:1.228726276,(t429:0.4401076907,t430:0.3971044152):0.7423605346):0.6650381467):0.3964737835):0.1532842411,(t431:0.4078629056,t432:0.3847203359):1.934130818):0.3846834058):0.1276500857,t433:2.512361196):2.298894663,((((t434:0.08150540447,t435:0.06632630822):2.420763748,(t436:1.640324125,(((t437:0.2297153913,t438:0.07010582017):0.5804947214,t439:0.6496196289):0.7081697489,t440:1.293739801):0.09591934427):0.7474909318):0.2018559913,(t441:1.270603377,t442:0.9111335408):1.008811192):1.323407739,(t443:1.142112882,(t444:1.032165442,t445:0.9788379597):0.09976682751):2.077470973):0.7607607978):0.2523696067,t446:4.138048414):2.814319821,(t447:4.241047592,(t448:2.199891674,t449:1.987319827):2.007680667):2.700499576):2.883310733):0.6039433912,(t450:0.6695700218,t451:0.4853562815):9.227176537):0.274277768):30.18647707):1.896977633):1.774365851):100.800061);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T56.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
