<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t451:2.522114339,(t452:0.7136883901,t453:0.6999321605):1.549236748):2.932975729,t454:5.177875869):7.188771186,(((t455:2.780531206,t456:2.777891267):2.020680204,(t457:1.22315816,(t458:0.4261694546,t459:0.4141955646):0.6059819452):2.912776222):5.456845593,((t460:0.06429206209,t461:0.004889069603):4.521543914,((t462:0.7668128686,(t463:0.1136993045,t464:0.07838197802):0.6512481586):1.127847125,(t465:0.4711560754,(t466:0.07876241673,t467:0.06884163246):0.01567932853):1.375631353):2.571364538):4.668332019):1.969362806):7.512416321,((t468:2.245093416,(t469:1.475866172,(t470:1.048399956,t471:0.6447268426):0.1320900471):0.7146608213):4.046111618,((t472:1.922896215,t473:1.831689563):3.111480746,t474:4.553717523):0.1423418868):11.88877796):71.89598241,(((((t475:8.048992224,(t476:6.932850572,(t477:0.2722871433,t478:0.2337143839):6.177770473):0.7377331515):0.4970671387,t479:7.512969908):9.238957696,((t480:4.185767923,t481:4.060088374):2.068615406,((t482:0.7211691232,t483:0.6839681908):1.375796965,t484:1.885417379):3.99082879):10.47206425):49.09581186,(((t486:5.572471902,(t487:4.835104204,t488:4.834346887):0.6705503758):0.3000582278,((t489:1.923245217,(t485:0.008502448616,(((t394:0.0156331724,(t390:0.1097882373,(t372:0.1468730358,(((((((((t230:0.05897243651,(t224:0.1888559481,((t164:0.006823897516,(t149:0.01944735807,((((((t105:0.02454352902,((t73:0.3619184973,t74:0.2630442436):0.1497926718,(t59:0.05883888117,((t1:2.244841446,t2:2.227678627):1.813436244,(t3:3.768161522,(t4:2.293330936,t5:2.25832396):1.419103749):0.2636015504):0.1826607516):2.091542352):3.286756823):1.495730461,((((t6:0.4367096637,t7:0.4040408505):2.840344209,(t8:1.937376232,(t9:0.6763977961,t10:0.6632936381):1.160847012):1.296514574):2.567147129,((((((t11:3.569580638,(t12:3.158851627,t13:3.152848991):0.29968572):0.2913022399,(t14:3.031988393,t15:2.958487174):0.7012036347):1.00518684,t16:4.615210066):0.08245995163,(t17:4.217853292,(((t18:1.513161546,t19:1.509274172):0.3704045211,t20:1.723239969):0.8433712778,t21:2.458836595):1.476885417):0.4388282253):0.05887829373,(t22:3.633065989,((((t23:2.037160908,t24:2.02121424):0.5730297867,(t25:1.312225424,(t26:0.2702492844,t27:0.2455622908):0.702941012):1.27263743):0.4773134854,t28:2.682738023):0.0681488168,((t29:0.8943266763,t30:0.8718647451):0.166445638,t31:0.9464573628):1.615522812):0.1980814194):0.7793951568):0.648513124,(t32:3.444504003,((t33:0.8146846028,t34:0.6983470515):1.989621808,((t35:0.932888235,t36:0.9003105583):0.5786986647,(t37:0.3853487874,t38:0.3811571732):1.064953392):1.143459866):0.6212237341):0.5841398834):0.02023997101):4.519010681,(((t39:1.834466459,(((t40:0.4593653021,t41:0.3821532762):0.9270530637,(t42:0.442519465,(t43:0.29584096,t44:0.2553027048):0.1080985219):0.8579704337):0.2802195163,t45:1.474898234):0.111358218):0.3007202642,(t46:1.410247128,t47:1.332301079):0.4285446184):5.851175366,((t48:0.8087756603,((t49:0.4067050674,t50:0.1918053077):0.09740907479,t51:0.1066397839):0.2974797577):1.87370972,(t52:0.9206069492,t53:0.8926874659):1.31663852):4.885115814):0.276004215):0.6266318495):0.8370188714,(t54:0.8449055137,t55:0.7835575462):7.783288081):1.135489099,t56:9.662459122):0.4138044033,(t57:0.9414091033,t58:0.7321146701):8.756510474):0.4451983325,(((t60:0.7477766994,(t61:0.5253238819,t62:0.418208812):0.06333442221):2.941992372,(((((t63:0.5217935779,t64:0.5035163686):0.4852732668,t65:0.8704595428):0.1831165074,t66:0.8944829845):0.6142409812,t67:1.318958984):0.6169002694,t68:1.839823309):0.7412552112):5.332206071,t69:7.882604983):0.5858238188):0.3317162076):1.582686553):4.792759825,(((((((t70:6.919086059,((t71:1.317289263,t72:1.294313838):4.210485638,(t75:2.497132033,(t76:0.5054614596,t77:0.4987901892):1.78568813):1.861546926):1.279014546):2.02380046,(t78:4.80976337,(t79:2.633686092,t80:2.569411321):1.975275412):2.552620025):0.544176409,(t81:5.435978858,(t82:1.826796313,t83:1.642107571):3.607351268):2.198371601):0.3217163248,((t84:1.93849691,t85:1.928088407):4.168830486,(t86:0.3809195291,t87:0.3321178783):5.612243819):1.622071903):2.389078164,((t88:5.978704433,t89:5.943862167):2.502523454,((((t90:0.9149695917,t91:0.7737106349):0.9819768316,t92:1.724601979):4.322846753,t93:5.822068843):0.04779114363,((t94:3.29889343,t95:3.258649068):1.803308196,(t96:4.887017472,((t97:1.262921833,(t98:1.160217848,t99:1.104318063):0.07980589551):2.978634923,t100:4.078841548):0.6173725814):0.03566149162):0.363623521):1.894324761):1.429832886):1.046922877,(t101:5.458621132,((t102:2.034620077,t103:1.968997719):0.7438838242,t104:2.653663673):2.623807412):3.968330923):0.1453599161,((((t106:3.133075245,(t107:1.949020206,t108:1.894469006):1.134224079):0.3405830675,(t109:2.653110096,(t110:2.564018404,((t111:0.7579595166,(t112:0.5805096801,t113:0.4436755839):0.1770529641):0.9636592196,t114:1.583911174):0.683127538):0.03101729114):0.7006791488):1.733691986,t115:4.665525231):3.357993184,((t116:2.136095534,(((t117:0.300207473,t118:0.1611291185):0.4759213365,(t119:0.5724234963,t120:0.3327563862):0.0561357978):0.5753160587,t121:0.9589342747):0.5021389357):3.209305185,(((((t122:1.041170308,t123:1.026037698):2.535674508,(t124:1.782175143,(t125:1.051697239,t126:1.041103473):0.6665197426):1.749226999):0.04132800435,((t127:0.1816445985,t128:0.07831918167):1.928524514,(t129:0.7363744293,(t130:0.2619684303,t131:0.1102505571):0.3697371731):0.9366340387):1.303313519):0.7380407727,((t132:1.401992701,t133:1.371404435):0.2045506474,(t134:0.3000783005,t135:0.2166795644):1.220964082):1.719783454):0.2067393959,(t136:2.390509853,t137:2.208722642):0.8387853516):0.09663547632):2.621637951):0.6736913201):1.760410459):0.4308256073):1.156651448):1.845093633,(((t138:2.357329443,t139:2.178239334):6.519165452,(((t140:0.149157311,t141:0.1321880423):3.590261956,t142:3.43395626):3.519623511,((t143:0.4400451268,t144:0.4105484664):2.033317385,((t145:1.256701762,t146:1.230363942):0.8550431619,t147:1.944105292):0.1729808609):4.282498855):1.164720132):2.400293721,(((t148:0.1771400939,t150:0.02599387249):1.72105414,t151:1.425533633):1.056628772,(((t152:0.3065124062,(t153:0.1844938384,t154:0.1447191839):0.0736006401):0.9496142145,(t155:0.2113569086,t156:0.2013582923):0.9321166652):0.06061954032,t157:1.172506716):1.015291966):6.812240116):0.17486728):0.05401719293,t158:9.17861459):2.818453688,(((t159:8.837741458,(t160:0.8955653246,t161:0.8667727929):7.388728275):0.6721048989,(((t162:5.711785355,((t163:1.922616841,t165:1.849986611):0.205782549,(t166:1.146122418,t167:0.9679292295):0.7857483219):3.444149861):1.729527526,((t168:0.1886956033,t169:0.01222393453):2.941183211,((t170:1.188745922,t171:1.147308173):0.2625003827,(t172:0.1508748398,t173:0.07253206634):1.231670164):1.445330441):3.733298348):0.2248014902,(((t174:0.797996531,t175:0.7513923196):3.236729091,(t176:3.437533545,t177:3.342522461):0.5030358434):0.05865724045,(t178:3.494434954,t179:3.40881647):0.408286243):2.506910636):1.258058718):1.170908542,(((t180:2.941994151,(t181:1.262239729,(t182:0.7554417129,t183:0.7538946739):0.4576556346):1.46975067):1.945912704,t184:4.58425297):3.765918165,((((t185:1.495978327,t186:1.424637352):3.917856017,t187:5.048722898):1.267965463,((t188:4.708489018,(t189:3.96763281,(t190:2.561896344,t191:2.466980766):1.294346614):0.6371977164):1.359388403,(((t192:3.388679631,t193:3.206696626):0.7093971457,t194:3.800896198):0.7500378741,((t195:1.811696016,t196:1.791146375):0.4329198482,t197:2.147842425):1.977473616):0.8657090238):0.2288641534):1.288435375,(t198:5.752063349,((((t199:1.630935648,t200:1.303916981):3.175426527,t201:4.440568699):0.2319995492,(t202:4.001005002,t203:3.8728998):0.6527443182):0.2977311798,((t204:1.946603913,t205:1.869170162):1.354646671,((t206:0.7949080518,t207:0.7461352134):0.8139781797,t208:1.553951862):1.506124656):1.376268086):0.327427189):0.5774372814):0.3086669443):0.07313128673):1.166740625):0.4489972841,(t209:4.624927934,((t210:4.255304594,((t211:0.5325600145,t212:0.5094551177):3.45973298,t213:3.952329206):0.1968026266):0.04440942518,(t214:0.5045669501,t215:0.3955810333):3.602794846):0.2787299096):2.68012064):3.689315989,(((t216:4.176614131,((t217:0.5832416174,t218:0.5778980517):2.106455389,(t219:1.477253429,t220:1.423869156):1.069759311):1.365936851):0.1405282306,t221:3.965076284):4.072248698,(((t222:0.918416805,t223:0.8752124644):0.9630468755,t225:1.641951126):2.293519491,((t226:0.4244518724,t227:0.1835379388):0.6591207245,t228:0.5690166631):2.834949282):3.831281639):2.245288469):1.952988165,(((t229:2.351945807,(((t231:1.226808467,(t232:0.2515011077,t233:0.2055796675):0.6443736026):0.3787896656,((t234:0.3641254941,t235:0.2246375705):0.5208918102,t236:0.5580228115):0.3259130139):0.3124715076,t237:1.185251261):0.1332791216):0.9701138927,(t238:2.198834859,t239:2.140488515):0.02904692117):7.545498024,((((t240:0.5085704883,t241:0.4352918735):0.4865011953,t242:0.7618002832):0.8629095515,t243:1.601632297):0.7519721721,((t244:1.52253691,(t245:0.07055220093,t246:0.07037871323):1.242694652):0.1196903622,((((t247:0.2555075854,t248:0.2494937189):0.3418558234,(t249:0.4793137796,t250:0.4237228357):0.1071907138):0.3903757421,t251:0.9098922554):0.00612818422,t252:0.8787639413):0.4301389994):0.3844955191):7.067289588):0.1936268212):2.132631799,(((((((t253:0.1896949121,t254:0.06790164529):0.5775567554,t255:0.5956647163):0.02651174495,(t256:0.3681979759,t257:0.3190153369):0.1943334626):1.109868423,t258:1.621803209):2.928148316,((t259:1.565504125,(((t260:0.4286403981,t261:0.3624838734):0.008205145836,t262:0.3007910653):0.1215276244,(t263:0.2715839053,t264:0.1584219414):0.1465701594):0.940918422):0.4264352277,(t265:0.9627301541,t266:0.8374406655):0.7056132177):2.524570101):4.324559208,((t267:1.977415833,t268:1.864489131):5.102137925,(t269:0.7873448685,t270:0.5830911763):5.929628852):1.198914812):1.321411076,(((t271:0.6684216376,t272:0.5966421392):1.627430575,t273:2.199178024):5.129932862,(t274:1.22356517,t275:1.009453038):5.842506307):1.510648147):0.5367446368):0.4718864148,((t276:5.239292507,t277:4.758595032):0.904639322,(t278:1.766297523,t279:1.689160649):3.83701659):3.213655733):0.1290417876):1.960407181):0.5179696669):4.107384825,(t280:5.383563106,((t281:0.06797050563,t282:0.04750325503):3.666089359,t283:3.510007529):1.624737202):9.901807363):3.839016723,(((((t284:4.749195964,((t285:0.3541459587,t286:0.3268194484):4.176812828,(t287:3.307714865,t288:3.212412861):1.127226645):0.1977244604):1.107285433,t289:5.617033791):2.003139369,(((t290:5.547555789,(t291:5.16495805,t292:5.134762264):0.3323438148):0.4342920338,(((t293:1.071431325,t294:0.8102139846):0.113174214,t295:0.9024704063):3.696633215,((t296:3.710519003,t297:3.404110931):0.50771872,t298:3.582493714):0.3543888036):0.8900362154):0.6052767712,(((t299:1.581309948,t300:1.551821094):1.376414864,t301:2.920955225):2.067796632,(((t302:2.659666636,t303:2.653922443):0.2925168437,(t304:0.9992142362,t305:0.9909325345):1.901317218):1.442516042,(t306:2.645817552,(t307:0.5533992444,t308:0.5445108005):2.017912941):1.673526719):0.5745039647):0.2517641845):1.012764485):2.225232017,((t309:2.356125502,(t310:0.1391554808,t311:0.1322754499):2.10969358):3.568181113,(((t312:0.7388254023,t313:0.7182377042):3.026276011,(t314:1.758530225,t315:1.636171977):1.971503225):1.500039229,((t316:3.538109855,(t317:2.144137342,((t318:0.5036809822,t319:0.4375529667):0.7737452893,t320:1.020409007):0.8338256196):1.340978378):0.115550277,((t321:0.7944313945,t322:0.7512925301):2.206836393,(t323:2.315393821,(t324:1.17774323,t325:1.167129747):1.134372592):0.4918002484):0.2338166114):1.362523889):0.5062109511):2.340632015):7.303851883,(((((((t326:3.813027193,t327:3.502018169):0.8885918805,(((t328:1.94286243,t329:1.661183901):0.5459725583,(((t330:1.490720414,t331:1.43010074):0.01266116155,t332:1.409845243):0.2197095534,t333:1.548722029):0.4247872361):1.64347176,t334:3.164415496):0.1694797086):0.6863770563,(t335:2.432171309,t336:2.32610123):1.587361347):0.5658445809,(t337:3.424370663,t338:3.317547765):0.7819207507):6.517705501,((((t339:0.12204009,t340:0.04757912208):1.721727173,t341:1.715587849):1.700260063,((t342:0.9491938049,t343:0.9249782096):1.952731043,((t344:1.187596849,((t345:0.353286226,t346:0.2840300162):0.1181349234,t347:0.3444814764):0.6642253342):1.173376096,(t348:1.775332625,((t349:0.7902266827,(t350:0.3715728439,t351:0.3590763194):0.3566415249):0.3754749613,t352:1.03034087):0.572438224):0.3714512097):0.5008481906):0.4803863072):7.015783271,((t353:1.498425642,t354:1.437725421):8.242079586,((((t355:0.485876681,t356:0.03331015459):6.663466717,((t357:3.099203758,(t358:0.8461101226,t359:0.5936680267):2.189239932):1.021970659,(t360:0.3277773669,t361:0.004008741912):3.440120165):2.173556252):0.5187403979,((t362:1.971983881,((((t363:0.3690434943,t364:0.3193986465):0.09508954581,t365:0.2730634782):0.514603789,t366:0.2608595282):0.8033789143,t367:0.9585794126):0.1355850218):2.07014035,(t368:2.198516549,(t369:0.6717607924,t370:0.6717358707):1.520860418):0.8413620086):1.911408277):1.020913084,t371:5.906717121):0.94961408):0.2112910277):0.003966686116):0.38181319,(((t373:0.1900551701,t374:0.1388938664):1.45365133,t375:1.578563525):4.063062768,t376:5.419219132):1.408622905):0.8827315587,(t377:4.61089896,t378:4.32113617):3.062275424):0.8022769436):1.454690199):1.501482879):2.02233366):1.777061437,((((((t379:0.2004851962,t380:0.1967529061):5.002947208,t381:5.149665243):0.2152064253,(t382:3.010252039,t383:3.008141406):2.244568585):0.7820811115,(t384:1.794919272,t385:1.577334054):4.150793622):0.6911117162,t386:6.315082795):0.883001466,(((t387:2.075581751,t388:1.967289259):3.029796282,t389:4.951493709):1.627498578,(t391:3.058012108,(t392:1.306273206,t393:1.230936333):1.358512009):3.391473216):0.4517931566):6.863897353):2.07835019):1.251441978,((t395:14.16227536,(t396:7.508075179,((((t397:3.116499556,t398:3.055105617):1.031273273,t399:4.073105067):1.16215707,(t400:4.883127809,(t401:4.360476767,((t402:0.9577209018,t403:0.9277122602):2.696246582,t404:3.425444832):0.6257599892):0.3692725939):0.2820413119):0.9230213324,(t405:5.342272097,(((((t406:0.5556340626,t407:0.5511887468):1.922171539,(t408:0.1722174576,t409:0.1436268022):2.245409653):0.7061198247,t410:3.082526571):0.02942859358,((t411:2.619089447,t412:2.383120965):0.04597500859,(t413:1.228844042,t414:1.203915032):1.188134413):0.3932957629):0.7069467872,((t415:1.038273056,t416:0.9117154999):1.684037067,t417:2.588075131):0.7505859934):1.376458151):0.2081439976):1.26057909):6.290125826):1.525831544,(((t418:3.707114885,(t419:3.371246365,(((t420:1.768773469,t421:1.753174056):0.8586036128,t422:2.487730603):0.4327968062,(t423:1.968234979,((t424:0.4865756399,t425:0.4817392422):1.473091803,t426:1.860694342):0.00158651521):0.8246248341):0.11378967):0.3202953853):1.093536053,((t427:0.5207157394,t428:0.2021404825):0.5712255189,t429:0.6490080286):3.117751941):2.178069553,(t430:4.649680216,((((t431:1.068646301,t432:0.9501044314):0.8908358833,(t433:1.275898629,(t434:1.067890371,(t435:0.5355621259,t436:0.375494779):0.4201391627):0.1598929304):0.5101357612):0.2178574591,t437:1.529223621):1.207476914,(t438:1.212198165,t439:1.09564753):1.498170325):1.233007317):1.278483425):6.914103413):0.8505317215):58.25013088):6.551913997,((((t440:0.6207243126,t441:0.5653045211):2.172737542,((t442:2.137481663,(t443:1.336115281,t444:1.334447455):0.6630869074):0.5035911148,((t445:0.5362929975,t446:0.5127422771):1.522259854,(t447:1.396316555,t448:1.35114415):0.5928521103):0.4257523378):0.0969094183):0.1032835573,t449:2.465017478):0.06954229882,t450:2.395540582):74.68362329):15.02995395);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T41.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
