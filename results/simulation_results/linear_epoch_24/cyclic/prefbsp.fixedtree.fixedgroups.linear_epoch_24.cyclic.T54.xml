<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t481:21.96944114,((((t482:4.593384481,(t484:0.36254813,t485:0.3382814828):3.879436989):2.906958868,((t486:1.372548809,t487:1.303768755):2.982018274,t488:4.243315052):2.64767345):5.352518071,(t489:3.452455279,t490:3.410112022):8.728738581):5.49004503,((t491:7.756825396,(((((t483:0.08476425405,(t459:0.2221645009,((t453:0.09935842068,(t443:0.2351174433,(t442:0.08542857049,(((((t338:0.03552044515,((t260:0.05895426113,(t234:0.5865611158,(((t222:0.05080370258,(t216:0.0408422518,((t175:0.01321265199,((((((t134:0.1586327586,(t135:0.04948893189,((t125:0.07511796951,((t81:0.1820891555,(t63:0.1535616701,(t55:0.004208499342,((t36:0.001570956566,((t34:0.1649305098,t1:3.534411309):0.05095251112,t2:3.493146553):0.1357666861):0.136634892,t3:3.678034922):1.465616695):1.046923519):1.732011604):4.443001291,((((t4:1.734445558,t5:1.698960954):1.998726051,t6:3.675169945):0.05210144408,t7:3.612059108):1.01822946,t8:4.482011732):7.494071021):0.01811893134):0.15761566,((t9:1.258779656,t10:1.207542868):4.483997611,t11:5.655965896):6.034369312):0.5457690816):0.04395420485):0.9126504637,(((((t12:1.756814526,t13:1.665044084):2.207327799,t14:3.575837056):1.079888751,t15:4.613645042):3.74973767,t16:8.267623085):1.962775139,(t17:3.865860429,(t18:0.1030016324,t19:0.08159463496):3.738005361):6.070929124):2.383915683):0.5733024599,(((((((t20:1.230222223,t21:0.9874889529):1.1347336,t22:2.08392981):2.317221335,((((t23:1.332291134,(t24:0.2863397101,t25:0.2532046979):0.9387786898):1.378816553,((((t26:0.7903936744,t27:0.5451554094):0.750922741,(t28:1.167053618,(t29:0.3634907682,t30:0.3602177915):0.772760773):0.06804587218):0.2026646721,t31:1.281834362):0.08313619856,t32:1.187605693):0.5719655781):1.134252056,((t33:1.638504002,(t35:0.9598373322,t37:0.8033431264):0.3540529515):0.08366471323,t38:1.215031496):1.11628806):0.4675416442,(t39:0.06470569826,t40:0.05467227798):2.614976628):0.05271658279):0.748101702,t41:3.200195322):4.298568675,(t42:6.234730964,(t43:4.411212736,(t44:0.3218771062,t45:0.3073765427):3.749979284):1.700835954):1.118470487):1.460048184,((((((t46:1.056014891,t47:1.05291023):0.209856334,(t48:0.2568929704,t49:0.2232146096):0.9134774767):0.1039489651,t50:1.213451128):2.078721405,t51:3.207207229):0.1468364907,(t52:2.239520187,t53:2.167530785):1.100976633):0.2004138252,(t54:1.971896943,(t56:0.5196005921,(t57:0.4495931024,t58:0.3649793028):0.04649217815):1.343088994):1.417159464):4.506249593):1.287856338,t59:8.859696951):0.3036680326):1.010959987,(((((t60:0.5116571998,t61:0.2433569199):6.694938371,(t62:1.508109852,t64:1.273711888):5.396789926):0.3870896445,((t65:0.1146743754,t66:0.03832618708):0.3191972334,t67:0.3248501994):6.521352676):0.850667452,((t68:5.222604146,t69:5.136590583):1.563993279,(((t70:3.579164883,t71:3.536098575):0.9197929653,(t72:0.2425084963,t73:0.1533834018):4.139183122):1.290684945,t74:5.326004023):0.8266646024):0.7666986537):0.4363915247,(t75:2.839540721,(t76:1.719497283,t77:1.715912267):0.7802703596):4.477277649):1.051478759):0.8453912379,((((t78:0.2070112925,t79:0.1668745096):4.887098826,t80:5.036515387):1.760288278,((t82:3.336552508,t83:3.323362751):2.975263176,(t84:6.059612382,(((((t85:0.831819824,t86:0.8041074994):2.803537442,((t87:0.5824627289,t88:0.535641741):2.941273763,t89:3.464138364):0.01042763655):0.6296533299,t90:4.077522504):0.9488629744,(t91:3.389830578,t92:3.38246488):1.618404164):0.3525368656,(t93:4.039430325,(t94:2.063351462,t95:2.024870912):1.673164036):1.179386592):0.2680678637):0.005743276023):0.1889484927):0.5498497077,(((t96:3.663931019,((t97:1.03617699,(t98:0.3977567776,t99:0.2315719523):0.5950592102):1.316697562,t100:2.111377908):1.273458066):0.4595837354,((t101:3.303599452,(t102:2.766383428,(t103:2.462280891,(t104:1.439690157,t105:1.366757569):0.9578082675):0.2979985558):0.2222040556):0.3021323283,((t106:1.382738473,t107:1.357493887):0.7276645584,t108:2.073665199):0.948312092):0.1483614036):1.319294664,t109:4.479217788):0.3140430318):1.431847052):0.005666712893,(((t110:2.843115263,t111:2.827010977):1.839733139,t112:4.586311805):0.6501212807,(t113:5.060886276,(((t114:1.765858352,(t115:0.5440323148,t116:0.5068279207):1.218310514):1.382300291,(t117:2.659134902,((t118:0.5678727934,t119:0.5472276732):0.07427202999,t120:0.6198831297):1.984665205):0.3142151549):0.2175554305,(t121:1.35499644,t122:1.31977224):1.280565126):1.187344164):0.005885920489):0.7890161018):0.7982800991):0.4994698962,((t123:2.765861714,((t124:2.050204932,t126:1.897046137):0.5087636702,(t127:1.345201632,t128:1.315538802):0.9193926033):0.03945614193):1.160176098,((t129:2.343844901,((t130:0.9811435902,(t131:0.04366820249,t132:0.01917326487):0.9057669679):1.183779379,(t133:1.319999303,t136:0.8087808186):0.7323384019):0.1521919318):0.07259527734,((t137:0.06053840044,t138:0.05196617172):1.354317546,t139:1.141340998):0.2432711795):0.7869873448):1.780329113):2.895903674):0.8124512027):0.179282122,(t140:0.3595609016,(t141:0.1963929443,t142:0.1344528764):0.1484361231):7.446010069):2.155885295,(t143:6.352413799,t144:6.320879422):3.489670332):0.03655231776):1.852518181):0.7207821434,((t145:10.08767028,(((t146:5.723804089,(((t147:0.4244526422,t148:0.2532213137):0.6115922925,t149:0.8558382275):0.002492910132,t150:0.5768557162):4.635997895):2.483480078,(t151:7.084311579,t152:7.074504385):0.5887171666):0.8612027824,(t153:8.007178949,((t154:0.6204546497,t155:0.5726300341):2.195853538,((t156:0.8007342107,(t157:0.1635059366,t158:0.09388329934):0.5875769927):0.337223356,((t159:0.04539381775,t160:0.0452564365):0.2572015119,t161:0.01861518683):0.6308086394):1.378014275):4.856075367):0.5106382858):0.8232527681):0.3869710878,(((((t162:4.117387172,((t163:0.5281982133,t164:0.5088883913):1.573430821,t165:2.05219079):1.971668614):0.5151877521,t166:4.429416438):0.8596858964,((t167:1.055073312,t168:0.9420468449):3.081785956,t169:3.968700319):1.110909129):2.197157068,(t170:6.607578269,(t171:2.12124415,t172:2.091076972):4.143673073):0.6317192474):0.7179521296,t173:7.475646466):0.01831569306):1.768894889):6.346952582):0.4354281478,(((((t174:0.3730562443,t176:0.3540809618):3.777962323,(t177:2.177273219,t178:2.146590993):1.923842643):3.869556164,t179:7.857954163):5.911997925,(((((t180:7.16427354,((t181:4.804600147,t182:4.773246126):0.0840850606,(t183:2.972125273,t184:2.940668026):1.782523941):2.183102521):0.2908069388,((t185:5.956583153,((t186:2.969172916,(t187:0.6204569498,(t188:0.5587432975,t189:0.5571132539):0.0009916178649):2.238026188):1.458775913,t190:4.042068319):1.461673942):0.09702733286,t191:5.333802985):0.9066902256):0.3017719022,(((t192:1.144758299,t193:1.048915807):3.250884657,(t194:2.264381781,(t195:1.380883273,(t196:1.06309401,t197:1.045127355):0.2408935733):0.8737806097):1.930444159):0.09489702657,t198:4.129647638):2.045140982):2.730828805,((t199:4.476615328,((t200:0.3760993922,t201:0.3104021339):2.22233346,(t202:1.216934182,t203:1.174325732):1.276827905):1.676156946):1.372380955,((((t204:1.150642263,t205:0.8696544952):0.7283306035,t206:1.556148476):0.5901136107,(t207:0.5158296279,t208:0.4852461261):1.626364843):1.608507845,(t209:3.439759798,t210:3.277853861):0.2656751334):1.413244787):2.866442014):0.639959973,(t211:1.02184094,t212:0.8957227535):7.434522813):2.459689303):1.557566492,(((t213:2.661861405,t214:2.600531475):1.967798804,(((((t215:1.917124582,t217:1.63912418):0.9333353713,(t218:2.101769735,(t219:0.8810983343,t220:0.7575366498):1.155588879):0.3408051876):0.4340358498,(t221:2.233021319,t223:2.042882594):0.3498583631):0.3032812344,((t224:0.6933177992,t225:0.5835457619):1.50583513,t226:2.068727212):0.07246809591):0.6565474341,t227:2.611449508):0.3109459366):0.7649743583,((t228:1.543986372,t229:1.487190679):0.03994780032,(t230:0.6058451222,t231:0.5627011546):0.8293051599):1.846173759):6.807764288):0.4639088908):0.04246157001,((((((t232:0.5602603508,t233:0.4374092682):1.133292327,(t235:0.3062429484,t236:0.2791475337):0.2614662103):0.2793970548,t237:0.8128899171):0.7210491667,(t238:0.9481073184,t239:0.8223514454):0.5712273408):6.069728203,(((t240:0.8276111846,t241:0.8194602909):1.045276042,((t242:1.025115776,t243:0.8946725255):0.4436049868,t244:1.31563082):0.3827949416):4.693035417,t245:6.269670492):0.800352938):1.436486254,(t246:5.745355581,t247:5.611467377):2.717087934):0.309595511):1.359280252,((((t248:1.196091957,(t249:0.08765655364,t250:0.02959368778):0.8849816005):4.495661928,t251:5.356934358):0.4961433198,(t252:1.744609522,(t253:1.028876422,t254:1.021737368):0.4502230764):4.040735497):1.089747798,(t255:2.815357658,(t256:1.149864926,(t257:0.03937353885,t258:0.03786871062):0.9134903458):1.655353392):3.7240382):2.670093958):7.821719262,((((((t259:1.216114863,t261:0.6331540485):4.825254913,t262:5.379701526):1.604485504,(((t263:4.701686684,(t264:1.32659451,t265:1.223473761):3.209996085):1.059412145,t266:5.109401506):0.8046515735,t267:5.909705733):0.3222580302):0.8559951755,(t268:0.7713965487,t269:0.5680803673):6.272230425):0.5363258827,(((t270:5.600975696,(t271:1.399281386,(t272:0.9823065214,(t273:0.4422787779,t274:0.2656613594):0.4214338594):0.2855145305):4.153390317):0.8135138556,((t275:3.608709993,t276:3.178835829):1.126749465,(((t277:2.813614829,(t278:1.633582815,t279:1.587541493):1.095918385):0.7824102988,t280:3.443355848):0.6007463427,(t281:2.12375201,t282:2.104393117):1.817222475):0.1021885749):1.1628158):0.3649557206,t283:5.463615885):0.5906862307):0.4255815206,(((t284:5.103443703,(t285:3.107514957,(t286:2.241587494,t287:2.144701198):0.7246041818):1.762679343):0.5297368466,((t288:4.087072698,((t289:2.305005874,(t290:1.475281246,t291:1.405898833):0.777183912):0.1459023819,(t292:1.695671626,t293:1.641642711):0.6083235576):1.586824179):0.4952723718,t294:4.326422663):0.3068790701):0.1922466229,t295:4.810038835):0.634143848):7.337283964):0.6950117606):0.3916681184):0.9608677793):0.411481667,(((((((t296:2.178908862,t297:2.129145761):0.239372646,t298:2.20531066):0.6200716041,(t299:2.337704719,(t300:1.01022742,t301:0.8531292603):1.322245135):0.4820579195):1.395558199,(t302:3.656783276,(t303:1.282090157,(t304:0.9076797879,t305:0.8492562036):0.3239832617):2.357434884):0.3154952357):0.7819953057,(t306:4.500695411,((t307:4.076195697,t308:3.746113906):0.1503848813,t309:3.873198281):0.2699823382):0.1174909615):1.474527611,((t310:3.332429669,(((t311:2.353206473,t312:2.284851315):0.2093745321,t313:2.396825101):0.4697316186,t314:2.8427544):0.2116891726):2.061922113,t315:5.000663952):0.1901889868):0.01604534675,(((t316:1.39788885,t317:1.280088887):1.003610292,t318:2.179330157):1.162999388,t319:3.260218891):1.603873152):8.530227603):0.1216153516):2.095152654):0.2845443036,(((((t320:3.645907413,t321:3.598566177):1.601889948,((t322:2.837116949,((t323:0.2181086337,t324:0.2055225881):2.571018854,((((t325:0.732772012,t326:0.7300899562):0.1596698924,t327:0.8857801493):0.8384378685,t328:1.716602823):0.9786772269,t329:2.665841909):0.008873278437):0.0002662390608):1.002827126,(((t330:1.549501206,((t331:0.1143530348,t332:0.09803042294):0.4352275911,t333:0.5127890726):0.9298292214):0.05897068286,(t334:0.186602384,t335:0.08473435571):1.201119675):1.235603471,((t336:0.8060966987,t337:0.7060753229):1.452570653,(t339:1.68084294,t340:1.156620517):0.1852409597):0.1775218672):0.6126807305):1.290614851):0.1778680118,((t341:1.311246733,t342:1.158788159):0.4697680736,t343:1.615239215):1.757972366):6.171546209,(((((((t344:0.363380776,t345:0.2790359154):0.07159429787,t346:0.3341915009):0.3305041127,t347:0.6103323271):1.318955965,(((t348:0.3368638886,t349:0.2882498403):0.747643561,t350:0.8925284945):0.2687193804,(t351:1.010719045,t352:0.8316708824):0.02755231928):0.4631002151):6.012475319,t353:7.245620469):0.6597816579,(((t354:0.9169111684,(t355:0.4991229273,t356:0.4944315672):0.2110287208):0.1366399416,t357:0.6022453253):2.681532036,t358:3.246200457):3.996725887):0.219279089,t359:7.384325901):0.4542369153):1.431362725,(((t360:7.855338549,t361:7.63652541):0.09925633542,(t362:6.992843786,(t363:4.533205171,(t364:1.673424993,t365:1.642463893):2.557957332):2.114644051):0.7385975357):0.2229616238,((t366:1.810731292,t367:1.733788837):2.592677039,(t368:2.833103806,((t369:0.6285231068,t370:0.5211775891):0.02512265035,t371:0.5370901455):2.098403973):1.422500555):2.32106008):1.041012401):2.731143931):6.129236175,(t372:4.968979438,t373:4.943356823):11.21769789):0.05408599211,((t374:7.494337245,(t375:6.756655042,(((((t376:1.1305561,t377:1.083211266):1.025523047,(t378:1.241346289,t379:1.02485213):0.752944623):1.511237188,t380:3.216764416):0.5748781863,t381:3.699062329):1.271599986,(t382:4.483336573,((t383:1.808638507,t384:1.790768188):2.209043345,t385:3.954562474):0.1659181295):0.3122062457):1.132696598):0.6165201635):2.476731013,(((t386:3.744148652,t387:3.731201327):2.699162226,(t388:2.351782922,t389:2.260650557):3.965241183):0.2577665607,t390:6.461092989):1.848185907):6.202161549):0.8852455121,((((t391:2.071867828,(t392:1.145317905,t393:1.00820295):0.876904957):0.8908282248,t394:2.749770775):2.632020643,t395:5.37815452):8.849807331,(((t396:4.592747949,(((t397:1.075832246,t398:1.068314369):1.659369534,t399:2.628368727):1.442982996,(t400:0.6007267603,(t401:0.3620622437,t402:0.3389817271):0.2234201374):3.467495813):0.344050127):0.5798497145,((t403:3.120345928,((t404:1.191464249,t405:1.081230384):1.334323946,t406:2.302015745):0.4760116527):0.6708067715,(((t407:2.47241112,t408:2.353661455):0.7505299515,((t409:1.615199993,t410:1.573976664):0.152899294,t411:1.72147004):1.319614389):0.1195046312,((t412:2.547463252,(t413:1.356818083,t414:1.266006252):1.143881337):0.3977171604,((t415:2.197254702,((t416:1.849774938,((t417:0.9629541949,(t418:0.7234416565,t419:0.6089722331):0.2070878607):0.4398765096,t420:1.151576684):0.06053702595):0.2476077083,(t421:0.3931763972,t422:0.3046159264):0.9096977189):0.07775587715):0.08056834459,t423:1.235570218):0.3687386824):0.04952354368):0.09071542691):1.125603759):1.445827967,(t424:2.318728881,(t425:1.386914096,(t426:0.521073585,(t427:0.314988772,t428:0.2218872691):0.1586573226):0.7838548126):0.8892239276):1.897797627):7.545288074):0.8243056932):1.03634489):9.405717058,((((((t429:0.2413486001,t430:0.2373980075):0.8868855638,t431:1.076122277):1.402652026,(t432:1.462881752,(t433:0.9468083613,(t434:0.7783814223,t435:0.6484019926):0.05774345262):0.459035247):1.011990044):1.632530419,(t436:1.794740182,(t437:1.567845607,t438:1.540335234):0.0470483025):2.012379408):1.272800352,((t439:1.272592016,(t440:0.3775457955,t441:0.3590619672):0.8741337458):0.03860288263,t444:0.5189479947):3.483303299):4.208922943,((((t445:2.170389302,(t446:0.9402795959,t447:0.8921612053):1.196981366):0.8369829549,t448:2.827283422):3.865297549,((((t449:1.996815889,(t450:0.5721739978,t451:0.5217404058):1.386859001):0.2892193302,t452:2.093424384):0.7499161058,t454:2.492521863):3.596720595,(t455:2.603255513,(t456:0.7714555142,t457:0.6884189946):1.728769538):3.471784843):0.02947234547):0.8828391357,t458:6.799464526):0.4028767498):12.94671125):0.4594520014):3.441448521):24.74473099,(((t460:8.322369898,(t461:3.305258695,t462:3.104130998):4.994812586):20.80484701,(((t463:8.583812661,((t464:0.6581170966,t465:0.5421814031):0.1641870281,(t466:0.3165671058,(t467:0.1310822523,t468:0.03632574733):0.08114606833):0.3707751359):7.721481522):8.886811251,(t469:9.049902839,t470:8.790027295):8.041322063):1.999072962,(t471:9.425665093,((t472:4.502452976,((t473:0.07302252123,t474:0.05675033539):0.9423148336,t475:0.9842523065):3.310267564):3.7516814,t476:7.86674454):1.14215499):9.39216984):9.35195014):1.545579305,((t477:2.918431891,t478:2.869311355):1.357819546,(t479:3.403605955,t480:3.396330763):0.6512171563):24.96016854):17.80734557);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T54.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
