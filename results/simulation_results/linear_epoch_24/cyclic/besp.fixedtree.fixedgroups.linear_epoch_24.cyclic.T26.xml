<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t403:0.9811888745,((t404:0.6125108455,t405:0.5032966346):0.2016799992,t407:0.4483514472):0.1342066099):1.172260109,t408:1.743840293):0.5934534718,((t409:1.585240098,(t410:0.3041849252,t411:0.2959630894):1.22958411):0.04350839465,(t412:1.04828447,t413:0.9704322287):0.3595827367):0.5764840718):9.023992288,(((t414:1.773675147,t415:1.737977047):1.771083971,(t416:1.571781134,((t417:0.2218056251,t418:0.1295488127):1.303680646,t419:1.271480848):0.004638466018):1.701531336):5.180349837,(((((t420:0.5098455574,(t421:0.09401830521,t422:0.08561561026):0.3185782207):1.058409329,t423:1.439599087):0.1647883488,t424:1.587540102):0.2886369342,t425:1.726218267):5.475235478,(t426:1.429600936,t427:1.219044795):5.654693967):0.3368533207):2.189792192):1.635688255,((t428:0.2498773375,t429:0.1949726261):7.198027652,t430:7.068468744):3.438635639):26.3686898,(((((t431:0.1474182961,t432:0.07842243151):8.517315951,t433:8.490519899):0.6645281376,(t434:1.59641628,t435:1.406561357):7.495448457):18.52938636,(t436:5.97086372,(t437:1.995286968,(t438:1.051876715,t439:0.9955626317):0.7517880387):3.774433365):21.35896563):1.03738466,(((((t440:2.384460981,(t441:2.150298986,t442:2.038139681):0.1926462659):0.1671604852,((t443:0.8738550811,t444:0.8362114092):0.5386401312,t445:1.327349824):0.9324219284):2.016427208,t446:3.843395842):1.614312837,((t447:2.646650722,t448:2.596420744):0.1910647886,(t449:0.1374479647,t450:0.002295248019):2.645642001):2.553550518):11.83138628,(((t451:4.743095134,t452:4.659492583):2.578693273,((t453:0.0226251064,((t406:0.07491928418,(t375:0.04240364563,(t343:0.06851971507,((t253:0.02226641176,(t244:0.1935018512,(((t232:0.1363793748,(t224:0.04454341777,(t181:0.03135840041,((((t137:0.3814272401,(((t44:0.02058909682,(t39:0.4164504087,t1:4.313048311):0.4558770111):4.754584291,t2:9.208843453):3.490363231,(t3:3.984408551,((t4:3.189624887,t5:2.951264958):0.4012791189,(t6:3.132946831,t7:3.127517376):0.1922338148):0.2898208234):8.632177238):0.9071690504):1.895909986,(((((((t8:4.455285282,(((t9:1.672511451,t10:1.6300772):1.394978838,(t11:1.260296792,t12:1.024781109):1.739830555):0.4877516631,(t13:2.845902091,((t14:1.071369152,t15:0.675798405):1.453367321,t16:1.95589004):0.2502350871):0.332750834):0.8118515537):6.16005302,((((t17:1.974912871,((t18:0.7968315722,t19:0.7485457917):0.2240025151,t20:0.8254941897):0.9508634071):0.02123908776,t21:1.793970755):0.1714957559,t22:1.935634589):7.185309305,((t23:2.574709409,((t24:0.5524857189,t25:0.3562268517):0.03891748866,t26:0.3942148977):1.905684336):1.975812433,(t27:0.06819439677,t28:0.03845746953):4.161022882):4.525944492):0.08910746353):0.9314120645,((t29:3.121101486,t30:3.117912472):1.562988837,(t31:4.231670429,(t32:1.536191633,t33:1.463133478):2.650230132):0.4234202399):4.935163782):0.6537005884,((t34:1.286674027,(t35:1.076183618,(t36:0.3611249653,t37:0.1787434135):0.6520151905):0.1617136443):3.554883881,(t38:1.388723934,((t40:0.4388235178,t41:0.4313619509):0.1094735376,t42:0.2533536581):0.3095917825):2.700272931):5.086010509):0.6483294312,((t43:3.84589379,(t45:3.038145125,(((t46:0.2919729348,t47:0.2624086189):0.1019491475,t48:0.267886453):0.6360649033,(t49:0.100329681,t50:0.07953398138):0.7557649634):1.906500991):0.6586841936):5.04539077,(t51:7.888358553,t52:7.87889514):0.4368520412):0.09081912177):1.083610158,(t53:7.769742111,((((((t54:0.1626147273,t55:0.01697621346):2.069203019,(t56:0.6164139006,t57:0.5355791976):1.458635396):1.14027045,t58:3.054837517):2.479412402,t59:4.937945751):0.5772647781,t60:5.004909414):0.09143320423,t61:5.064427332):1.223964237):1.368229827):0.6982714538,(((((t62:1.956786479,t63:1.78467503):2.056001835,t64:3.719670991):1.28842086,(t65:3.942246544,t66:3.899043559):1.008647344):0.1405230569,(t67:4.776479129,t68:4.614535892):0.2565004452):0.7092800247,(((t69:1.95780642,t70:1.939507822):1.454915219,t71:3.386789112):1.874814921,((t72:1.844662875,(t73:0.3174222375,t74:0.2633672164):1.462574025):3.290639949,((t75:2.47946259,t76:2.31866618):0.7278043441,t77:2.474605653):1.698733127):0.09147845255):0.2213928809):2.194198518):0.3508440736):0.4136724036,(t78:1.749987781,t79:1.692077043):5.602986866):0.723184753,(((t80:2.873658793,t81:2.83439163):2.113041329,t82:4.904249718):1.623012293,(((t83:1.934811707,t84:1.913887689):4.055530477,(t85:4.936894166,(((t86:1.767985316,t87:1.750564585):1.137877144,t88:2.83748063):0.8696988113,(t89:3.527585482,((t90:2.079481245,((t91:0.2457524485,t92:0.146419057):0.3955608125,t93:0.5328829606):1.313026371):0.6897484647,t94:2.505649718):0.7199168106):0.1782808785):0.9884707703):0.9665458894):0.1220057762,((((t95:3.124346421,(t96:2.614591586,t97:2.512756028):0.3925934309):0.9350090129,((t98:0.2494544612,t99:0.1178390418):1.363853535,t100:1.367805752):2.182466125):0.1101705546,t101:3.659132082):1.046606853,(t102:2.378794285,t103:2.257662986):2.26651758):0.2182324704):0.2229550194):1.392251657):0.9052446044):5.629251629):1.107875225):0.7664359994,(((((t104:2.101640636,t105:2.061977143):2.402552688,((t106:0.9058977687,t107:0.6714636493):3.448320318,(((t108:0.8749687088,t109:0.8656232448):1.964215584,(t110:2.666842759,t111:2.627777587):0.146445506):1.066960108,((t112:1.420922532,((t113:0.9438714386,t114:0.8768213751):0.06614023695,(t115:0.7292762666,t116:0.407661726):0.190956765):0.1831966274):0.1217170638,(t117:0.7820374412,t118:0.5570886652):0.1021009388):2.276036689):0.1560640631):0.1036509434):8.11037048,(((t119:2.361199271,(t120:1.810178203,(t121:1.569092807,t122:1.518482173):0.2069170403):0.4252613685):0.3100292568,(t123:0.3300983081,t124:0.2293769279):2.073842856):4.090427207,(t125:2.164752681,(t126:1.883940345,t127:1.790512554):0.2636013707):4.169385958):4.446646543):0.1718390383,(t128:2.09456215,t129:2.083861147):8.6834779):0.1029560458,(((t130:0.2812324196,t131:0.1507315256):1.237692774,(t132:0.9984831966,t133:0.8635805894):0.1391382103):2.108454479,t134:3.02949936):7.226903272):1.850805334):0.5994122031,((((t135:1.430147844,t136:1.38806427):0.08283503047,t138:0.7109441991):0.1209736753,((t139:0.4064876649,t140:0.2398852275):0.06811542784,t141:0.304870828):0.3460257877):3.623997934,(t142:1.639683049,t143:1.389074631):2.489548781):7.348404477):0.1278939138):1.109999174):4.79631054,(((((t144:1.866757715,(t145:0.2273831749,t146:0.1250001536):1.444008005):6.575902797,((((t147:2.410769681,t148:2.364092175):0.6264267891,(((t149:0.5596182835,t150:0.5512403077):1.302644313,(t151:0.05743573894,t152:0.04943682122):1.771929194):0.1344061091,(t153:1.317329388,(t154:0.7963891949,t155:0.6696768335):0.5104512314):0.5692031313):0.9592147645):1.076831941,t156:3.677597397):0.5575644908,(t157:3.281735702,(((t158:1.944430536,(t159:1.684173159,((t160:0.1266429275,t161:0.1213599951):0.116754002,t162:0.2285866565):1.255343789):0.2192769335):0.4189431628,t163:2.076855278):0.03081728938,(t164:0.8125679766,(t165:0.7173495368,t166:0.2243988385):0.005208054321):1.275201473):0.8710414984):0.8808130815):3.384111507):1.041108685,(t167:5.614381283,(t168:2.28032424,t169:2.105207136):3.060853338):2.008057926):1.116002571,((((t170:0.49593687,t171:0.4012137277):2.424490146,t172:2.820529656):3.321611984,((t173:4.624785535,(t174:2.100528512,t175:1.983312963):2.501357438):0.5029557245,t176:4.939188445):0.9722662456):1.910769378,(((t177:0.2512541943,t178:0.06338050393):5.466632937,t179:5.43356823):0.4956711294,(((t180:3.512972381,t182:3.101204263):0.2566537351,(t183:1.613528772,((t184:1.199736188,t185:1.038811015):0.1380561165,t186:0.9745579589):0.2349029244):1.519846067):0.676474096,t187:3.223120082):1.432628542):1.548815709):0.08396746143):2.590379027,((t188:5.362663826,(t189:3.475983449,(t190:3.434678287,t191:3.420987282):0.01651862557):1.883334044):0.1985971429,((t192:1.499187009,t193:1.256022193):2.564363721,t194:3.726705):1.330338928):3.102597439):4.070103073):5.18110202):3.239925311):2.372329818):1.777897705,((((t195:4.243643104,t196:4.07519087):0.3067293397,((t197:3.18130697,t198:3.148040893):1.113346815,((t199:2.675387093,((t200:1.509746969,t201:1.405802939):0.6312698208,(t202:1.130122758,(t203:0.8365998759,t204:0.6756571417):0.2621579165):0.8875694085):0.3356119546):0.6998049165,t205:2.762775963):0.7946683308):0.05915005399):9.39165664,((t206:0.282368395,t207:0.2700728289):0.9016558539,t208:0.8184202375):11.82392621):6.448942336,((((((((((((t209:1.083187564,t210:0.8709298229):1.551513009,t211:2.242996255):0.2627930772,(t212:2.213624823,(t213:0.7704173057,t214:0.6081543393):1.232348493):0.2035813696):0.1573444845,(t215:1.29638049,(t216:1.267090634,t217:1.09080143):0.02779118038):0.521153534):0.02994558722,t218:1.397942187):0.4858783531,t219:1.865356116):5.312163989,(t220:4.402423455,((t221:1.529429209,t222:1.500850406):0.2992992671,t223:1.628230571):2.561131912):2.540306888):2.300287703,((t225:1.748203649,t226:1.537558439):0.2381567255,(t227:0.557452491,t228:0.4461452336):1.115844297):6.567785895):0.9387974706,(t229:5.901009296,((((t230:0.7146866052,t231:0.6877618232):1.152765501,(t233:0.7764546634,t234:0.6714354213):0.5850358277):0.2998354269,t235:1.419976792):1.707631177,t236:3.088623588):2.013672805):3.079776642):0.3173182426,(t237:0.6512240436,t238:0.5240674637):7.807435449):0.9991610634,((t239:0.08818144355,t240:0.006939814926):8.816039934,((t241:5.119842957,(((t242:0.7008806709,t243:0.606087347):0.9986314895,(t245:0.2990495813,t246:0.1055819917):0.9937684737):2.732738035,(t247:0.4961404233,t248:0.4312448949):3.288320255):0.6813050696):3.139030002,t249:7.364305814):0.4436343685):0.2335035397):0.5123460809,t250:8.480115879):5.018388147):4.384371837):3.43402134):6.218269116,(((((((t251:2.457505509,t252:2.452553041):13.03914564,((t254:1.307441921,t255:1.300058937):6.24534935,((((((t256:0.3538787928,t257:0.3056474165):0.06163520612,t258:0.3152145414):2.484210259,t259:2.753423869):3.304676046,(t260:3.574368371,t261:3.551094478):2.467843237):0.4450107137,t262:6.29150858):0.008417831393,t263:6.277127322):0.8561616449):7.652808732):0.2820138358,((((t264:3.190331847,(t265:1.674322905,t266:1.474396144):1.13722124):3.939468938,(t267:5.901621745,t268:5.233145663):0.6249572397):0.6614844519,((t269:3.14027394,t270:3.074452753):2.398862869,((t271:0.8945873659,t272:0.845261863):2.572900649,((t273:2.179576478,(t274:1.619607638,t275:1.594272625):0.5058109856):0.4208081996,t276:2.40369686):0.6535594307):1.920477492):0.960996117):0.5200296272,(t277:3.824727462,(t278:1.17756668,t279:1.114311451):2.613851128):2.28618636):6.362932065):0.6857136868,((t280:4.073189446,(((t281:1.510555409,t282:1.502382612):0.7860921155,(t283:1.630753994,t284:1.59801847):0.6241911642):0.3792752519,((t285:0.3301407941,t286:0.2644078172):1.520842904,(t287:0.5057992181,t288:0.4378173654):1.273754033):0.7439742354):1.31807355):0.7861402562,(t289:1.74789649,t290:1.565829856):2.701710265):8.195837182):1.247343848,(((((((t291:2.18311006,(t292:0.6372116715,t293:0.3693323484):1.440325165):0.2081171923,(t294:1.510357199,(t295:0.6071851657,(t296:0.3104023577,t297:0.2250681126):0.2651497987):0.8740628494):0.235185835):0.4510225537,(t298:0.06741472807,t299:0.06399841941):1.960165819):0.8189139816,(t300:0.2237000339,t301:0.1665124241):2.497511027):1.951254802,(((t302:2.203698073,(t303:1.231195022,t304:1.144193661):0.7783157602):0.08102402165,((t305:0.7941562245,(t306:0.2840372289,t307:0.2486673656):0.4672106023):0.09843035229,(t308:0.2591915184,t309:0.2355945215):0.3111985794):1.0691547):2.169724059,((t310:1.148880865,t311:1.08061333):0.725048328,(t312:0.8277930126,t313:0.6675990659):0.974837337):1.663357335):0.1586923754):2.18075292,(((t314:1.194857278,(t315:0.2326683858,t316:0.02485931709):0.4887620386):0.1902532464,(t317:0.09509446975,t318:0.0006488057763):0.4192213624):1.43096029,t319:1.824833303):2.795195509):0.1341005984,t320:4.732127649):5.581155473):0.007603624812,((((t321:0.3433566689,t322:0.2275268858):6.068759234,((t323:1.682119712,t324:1.535115402):4.551370278,((t325:0.2085721461,t326:0.1728696843):1.72714123,t327:1.870644204):4.108220388):0.03338388275):0.4637792113,(t328:0.664059168,t329:0.495650756):5.603077765):2.154312055,(((t330:1.275232024,t331:1.070114667):1.278112855,t332:2.297784367):3.295769467,t333:5.525016219):2.263839208):1.150785233):1.281648515,((((t334:0.9320920803,(t335:0.8956510725,t336:0.7551760992):0.02706249313):0.1040409367,(t337:0.5155035466,t338:0.1272190338):0.06646514089):6.852002707,(((t339:3.389771707,t340:3.374267349):1.31589422,(t341:2.46013647,(t342:2.254091655,t344:2.11037137):0.1376123841):1.908980276):1.33772869,(((t345:0.07719303386,t346:0.06726708587):2.729699963,((t347:0.3656283871,t348:0.2068199215):2.400808058,t349:2.585057166):0.02866526527):2.465224458,t350:4.933512282):0.1171612103):0.9980058842):0.4714516732,((t351:5.780835339,(t352:3.862594832,(t353:3.127614313,t354:3.055069298):0.5835080621):1.826670585):0.3316036267,t355:5.456716908):0.3142222247):1.811904656):8.257678198):0.8825357674):0.006475154004,(((((((t356:0.2433900848,t357:0.09984543835):5.353960196,((t358:4.031174802,(t359:1.191712058,t360:1.024819889):2.803395168):0.5365064914,t361:4.178958714):0.8122481255):0.7884975821,((t362:3.3144653,(t363:1.537701719,t364:1.48659978):1.759516867):0.4506270564,(t365:1.872702608,((t366:0.6993373013,t367:0.5728298397):1.01942012,t368:1.566045122):0.02431263756):1.652999574):1.787973249):0.05149655809,(t369:2.074683788,t370:2.060274572):2.994289431):0.3988416623,(t371:2.51172403,t372:2.301912638):2.891134584):0.1188560277,((t373:3.718896403,((t374:1.342762166,t376:1.198088763):1.579140219,((t377:1.186729492,(t378:0.5279059303,t379:0.5039136461):0.6104088744):0.8569427501,t380:1.895259636):0.6554481054):0.7236678161):1.454059586,((t381:1.418715234,t382:1.316295214):0.965964742,t383:2.204994313):2.271409451):0.00191374179):3.137029132,(((t384:0.672514959,t385:0.6715670128):1.783379066,t386:2.365519991):1.723553556,(((((t387:0.8924681805,t388:0.8624934586):0.6676730452,t389:1.246218794):1.102367815,(t390:1.321187524,(t391:1.235400341,t392:1.061405418):0.06349905509):1.003307741):1.183154538,((t393:2.642701169,(t394:2.246393711,(((t395:0.1029297046,t396:0.04563208832):1.116140527,t397:1.141503358):0.2726961485,t398:1.372337339):0.4778223656):0.3232084061):0.03422495313,(t399:0.9954493342,t400:0.8686316906):1.16739078):0.6248669004):0.056536013,(t401:0.516207344,t402:0.5028762619):2.185147883):0.1525392746):3.349870348):6.582870851):9.695639461):9.396133823):7.973428327);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T26.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
