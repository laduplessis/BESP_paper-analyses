<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t469:5.761369896,(t470:1.281433879,t472:1.173659688):4.464619685):3.818897193,(((t473:0.3767227581,t474:0.1650952063):1.22365434,t475:1.253989608):2.687098,t476:3.923343533):5.012937102):1.606667696,(t477:7.775072219,t478:7.692762634):2.61749826):0.880499948,(t479:4.416382961,t480:4.225537053):6.654624256):12.69091313,((((t481:0.7662494028,t482:0.7335023306):4.389429413,(t483:0.7655163793,t484:0.7378698181):4.252105084):1.873540529,(t485:2.060828561,((t486:0.07003095306,t487:0.06684313926):0.2432388714,t488:0.276368127):1.680845384):4.78722458):1.103714072,(t489:1.183842339,t490:1.12784179):6.596013343):15.40022775):23.20459799,(t491:18.56091505,(((((((t471:0.008508485807,(t416:0.0504460169,(t400:0.0168080101,(t367:0.007137776082,((((t330:0.04175048758,(t328:0.05218372227,(((t205:0.1500227982,(t193:0.003335771083,(t146:0.3082178196,(t141:0.07946434259,((t137:0.01555450728,((t125:0.03647726014,(t116:0.3182423316,(t1:6.422631398,(t2:2.099414874,t3:2.039508098):4.262475837):5.579161598):0.9323736044):1.22014886,((((t4:2.430680257,t5:2.38985315):4.763777499,(((((t6:1.179959987,t7:1.154240708):1.369916562,t8:2.417817571):1.803775892,(t9:1.21590681,t10:1.071922902):2.985175961):0.1632672366,(((t11:2.328194754,t12:2.207133195):1.632226444,(t13:1.903378176,(t14:1.450853617,t15:1.401833712):0.3921351137):1.825155025):0.1427636778,t16:3.699763698):0.09157261731):2.087222418,((t17:0.5420291519,t18:0.1738426092):2.643242796,(t19:2.440722954,t20:2.263491406):0.3101356999):2.623271247):0.5256724834):4.867519262,(t21:2.708825057,(t22:1.187939526,t23:1.121025125):1.432809646):7.861638549):0.3543286415,(t24:3.942231515,(((t25:1.019568304,((t26:0.4161551271,t27:0.4031732955):0.1133675734,(t28:0.4436452422,t29:0.3911841904):0.06387524597):0.3278835497):1.914670251,((t30:2.238171582,t31:2.145745863):0.2448276515,(t32:1.489245595,((t33:0.107846382,t34:0.02730348885):1.068760971,t35:1.030267326):0.2708438544):0.8597026973):0.160089138):0.6098304788,(t36:1.350773116,((t37:1.01711912,t38:0.8200173668):0.2856970866,t39:1.034573969):0.03037413928):1.302409583):0.3951802701):6.759720954):1.509086228):0.3191575608):0.4934934636,(((t40:5.201655196,(t41:0.6488246406,(t42:0.5761874954,t43:0.5705929377):0.008031991146):4.494301758):2.090512279,(t44:1.866659784,((t45:0.3218671651,t46:0.2171091116):0.9112169715,t47:1.082301935):0.6169218185):5.11172598):3.054323732,(((t48:2.438978814,(t49:1.455900005,t50:0.7144560867):0.526482713):0.3303460396,t51:1.443616681):5.439593286,(t52:5.491914545,((t53:0.5662920948,t54:0.5084563315):0.331408623,t55:0.755789328):4.452533355):1.332852116):1.508262829):1.100115826):0.3106475509):0.9812533545):3.065229736):0.9951367136):4.769814706,(((((((((t56:5.8621598,t57:5.516490207):2.593114822,(t58:0.9536210494,t59:0.9405554789):6.987618783):0.07114479655,t60:7.881343701):0.1922304234,t61:7.930354102):0.007376883263,(((t62:0.09604835288,t63:0.08848379609):0.6161477455,t64:0.4744202315):0.4886477363,t65:0.8214467473):6.724351723):0.2327589804,((t66:1.108356388,(t67:0.1789499022,t68:0.09928986001):0.8876478341):5.830379722,((t69:5.256014875,((t70:3.30103067,(t71:0.597001578,t72:0.5301371825):2.702798142):0.1941408039,t73:3.363146271):1.669491412):1.396641541,(((t74:0.8692591866,t75:0.7733758767):2.438362828,(t76:0.7394321476,t77:0.6239895885):2.373488589):2.802022487,t78:5.765010723):0.2772180974):0.1247010164):0.719024517):1.267587184,(((t79:5.774791354,(t80:4.426319538,t81:4.227105603):1.295290257):1.573325407,(((t82:4.483521714,((t83:1.31207551,t84:1.045753595):2.961974174,t85:3.66808007):0.1887588558):0.1752647996,((t86:0.5076442614,t87:0.4749800001):2.429587522,t88:2.831361525):1.002816952):1.387868624,((t89:3.024700407,t90:2.991966563):0.2703145372,t91:3.256446745):1.863932931):0.9726917966):0.6325028128,(((t92:2.329876762,t93:2.309879776):0.08024582279,t94:2.378141197):2.597641554,((((t95:0.7222064231,t96:0.7035126743):0.4831071647,t97:1.157031896):2.156199202,t98:3.313035432):0.02316337034,(t99:2.218496892,t100:2.094383816):0.9356410859):1.409379811):1.650936118):0.1338472911):1.127005505,(t101:3.281982069,t102:3.276289142):3.759217425):3.817046442,((t103:0.9272879006,(t104:0.8153475333,t105:0.7047703029):0.05733141232):4.882493859,(((t106:1.628638023,t107:1.475409761):2.510195453,(((t108:0.3166188618,t109:0.3011258852):0.07729236217,t110:0.1527624555):2.547587656,t111:2.263595915):1.033575783):0.08384238306,((t112:2.964371018,(t113:2.784855829,t114:2.76919654):0.08597268201):0.2803135729,((t115:0.6729424702,t117:0.003844107445):0.1535942097,t118:0.1393462939):2.26243779):0.05317622479):1.411425295):4.915233147):4.052873276):2.185842211,(((((((t119:0.4089210721,(t120:0.1886206969,t121:0.1854601671):0.0954882998):2.039550792,((t122:0.7122943898,t123:0.5419064199):0.3109573826,(t124:0.2409070741,t126:0.02587793737):0.4904023928):1.252547132):1.51008393,(((t127:0.1908167266,t128:0.1686975034):0.7412921132,t129:0.8048092022):1.102657207,t130:1.904669454):0.9906633719):5.994003741,t131:8.574397034):0.7928062876,(t132:6.834703424,(t133:4.784511526,t134:4.73771541):1.879442791):2.432405062):0.9044997478,(((t135:1.406157399,t136:1.309479233):5.670791566,(t138:0.6406123871,t139:0.2878791429):6.197612374):1.738532649,(((t140:1.757027028,(t142:1.296990487,t143:1.252725813):0.1792569784):5.440031304,((t144:4.392993716,((t145:1.599634246,(t147:0.2850372587,t148:0.2004272608):0.7617894243):1.269594406,((t149:0.3568341102,t150:0.1927051585):0.4008364324,t151:0.5316735761):1.330966696):1.521467667):0.9847495084,(t152:1.658084603,t153:1.626216764):2.692312499):1.217070603):0.4680514842,(t154:2.957571308,t155:2.913569224):2.99717787):0.2825067158):0.9631650412):2.870806691,(((((t156:6.426386042,t157:6.223383364):0.3273436931,(((t158:0.5116633256,t159:0.4568318054):3.795971707,t160:4.216365752):0.8819494015,(t161:1.144268957,(t162:0.8852527516,t163:0.8784078887):0.2479869343):3.939310321):1.359349705):1.124303667,(((t164:5.982066451,(((t165:2.985359726,(t166:0.7153127409,t167:0.6861192767):2.162462894):0.0005170330707,(t168:2.802974675,(t169:0.4704372389,t170:0.4573610108):2.270435385):0.03654260904):2.460605855,((((((t171:0.7134672628,t172:0.6210848262):1.428056244,t173:1.998374527):1.458493288,t174:3.405373088):0.1106241664,(t175:3.312951597,(t176:0.528798144,t177:0.501305027):2.768908645):0.1714878641):0.6669448472,(t178:2.591409141,(t179:1.36304077,t180:1.243512404):1.152018424):1.445389655):0.594793269,t181:3.954723491):0.245835885):0.533526356):0.3691107991,t182:4.977690329):0.7579084843,(t183:2.704957737,((t184:0.179381348,t185:0.06413754011):2.120063979,t186:2.102023991):0.3903238843):2.992238547):0.2587769422):1.00219054,((t187:1.732156045,t188:1.678668944):2.709377386,((t189:0.9747379471,t190:0.9544773943):3.196719423,((t191:2.661827408,((t192:1.06401056,t194:0.9961825258):0.9077347664,t195:1.682309311):0.6301788629):0.3353239557,((t196:0.9029056162,t197:0.8886321203):0.9381618137,t198:1.724020783):0.7697096437):1.061035084):0.2089849062):2.285310818):0.9321736699,(t199:3.71606259,(t200:2.592508365,t201:2.574233018):1.063723047):3.264042521):0.1891261469):0.3519620939):6.555402319):0.1422777758):0.8266304143,((((((t202:12.16264796,(((((((t203:2.967313131,t204:2.73754773):0.6359088578,t206:3.180387322):2.217280661,(t207:2.57963951,t208:2.512126456):2.78945376):1.392235225,((((t209:3.342106252,(t210:3.286635647,(t211:2.457997289,(t212:2.16278882,((t213:0.1938181367,t214:0.1736619218):0.9842439248,t215:1.11322811):0.7368196026):0.229494835):0.7263493009):0.03097370069):0.493063804,((t216:1.216048363,t217:1.072372091):1.553776473,(t218:1.121294824,t219:0.8208054734):0.9787430373):0.4784308388):0.4179974598,(t220:2.465261027,t221:2.307907423):0.2225444293):1.445448768,(t222:3.640617764,((t223:2.453420758,((((t224:0.5516644461,t225:0.459983368):0.5748002382,t226:1.015722648):0.1277117664,t227:1.130334658):1.069020971,(t228:0.1308645447,t229:0.05477186895):2.033590721):0.03189863788):0.8429775726,((t230:0.6097217415,t231:0.5298004042):0.252269297,t232:0.7215373352):1.775779048):0.1891440844):0.1165783181):0.9915132226):1.366016541,((t233:1.621128956,t234:1.609211399):1.516861431,(t235:2.003771997,((t236:0.7059745682,((t237:0.1617274327,t238:0.05851946083):0.06964031423,t239:0.1103785654):0.2353248735):1.132388587,t240:1.336135605):0.07835540706):0.9716980347):1.62579659):1.010085016,t241:4.948168587):0.7617749308,(t242:1.702520788,(t243:0.4318662835,t244:0.4055526992):0.9152309671):3.602249286):1.76419394):0.1403939456,t245:6.728168308):0.5161630331,t246:6.870587439):0.5000705437,t247:7.275824841):0.7632467399,(t248:7.745016409,(t249:5.252582227,((t250:0.8519917413,(t251:0.04742255914,t252:0.008396519484):0.6829223257):3.499498763,((t253:0.2258183752,t254:0.1703627413):1.597294592,t255:1.570719476):2.073695997):0.8292454039):2.318811354):0.2750855599):0.2339094637,t256:7.274232543):0.5998887072):0.1477374637,(((t257:4.921129427,((t258:3.014525775,t259:2.951552651):1.418876963,t260:4.282120706):0.3990501798):1.161605874,(t261:4.329955463,t262:4.107105646):1.463410814):1.678648247,(t263:6.036215646,((t264:3.453345994,t265:3.411295619):1.705256064,t266:4.942034967):0.6363444513):1.135552083):0.2321240541):0.7839487683,(((((t267:3.426669344,(((t268:1.237315606,t269:0.6751458487):1.701774164,t270:2.005506906):0.0182992357,t271:2.00684526):0.3772637532):1.012835003,t272:3.108842):1.169063992,t273:4.18024274):0.6332026853,(((t274:2.445102085,(t275:2.347121916,((t276:1.170765665,(t277:0.7508532882,t278:0.706259134):0.2650735591):0.2295820606,t279:1.104848143):0.9368991967):0.04637498472):0.7735685955,(t280:1.844489452,t281:1.632840752):1.005425211):1.334204832,(t282:2.416580646,t283:2.414264487):1.547319088):0.232203901):1.092044958,t284:5.206335598):0.2499383342):1.694016439):2.823520467):1.252978135):4.740852008):3.153011036,((((((((((t285:2.328962885,((t286:1.326492108,t287:1.207192081):0.00167158328,t288:1.193245775):0.9877379977):0.7149850384,(t289:2.500272387,(t290:1.549129928,t291:1.38612676):0.9082405952):0.3827657807):0.2241402089,((t292:1.102790733,t293:1.099409997):0.9383137815,t294:2.004716116):0.8333106794):1.616277927,(t295:3.567128681,((t296:1.371730995,t297:1.281539566):1.253634169,t298:2.525068099):0.926976869):0.7009109123):1.218894901,(((t299:1.585490455,t300:1.540476387):0.421888242,t301:1.925835263):2.693470089,(t302:1.896001479,t303:1.719085783):2.546194211):0.5819983718):4.247012215,(t304:2.435178213,t305:2.18986792):6.585445077):0.4476842295,((((t306:2.311928869,(t307:0.3022567477,t308:0.2378408607):1.992216926):1.303174788,(((t309:1.778916928,(t310:0.2551380474,t311:0.2456202278):1.513943297):0.987152436,((((t312:0.6725559764,t313:0.5497805316):0.08670620542,t314:0.6187288985):1.159096802,(t315:0.6820581756,(t316:0.2422295124,t317:0.2138494188):0.3994029496):1.066200004):0.1307890953,t318:1.769371282):0.6912272865):0.09941502599,(t319:0.5872964608,t320:0.3974067737):1.84712142):0.621172413):0.7268104422,t321:3.577242632):1.387491707,((((t322:1.075578042,(t323:0.7041319865,t324:0.6075090729):0.3433039599):1.608230558,(t325:0.2404162029,t326:0.1312135259):2.241980427):0.2510270971,(t327:1.892885951,t329:1.333033538):0.6220608009):1.559073514,(((((t331:1.423078854,t332:1.24585593):0.1540557063,t333:1.348133716):1.022192693,t334:2.218048548):0.2155148812,(t335:1.339151596,t336:1.27607475):1.06796604):0.1696033756,(t337:0.8118152526,t338:0.786737104):1.610536054):0.3441528511):0.4426547062):3.429946187):1.276346286,((((t339:0.2409957572,t340:0.2221648934):0.291067121,t341:0.4724650628):0.6504609486,(t342:0.5994881925,t343:0.5743851245):0.4030721421):1.623565196,t344:2.53332596):5.010177388):1.430316724,((((t345:0.4597539265,t346:0.2500357345):0.7229967293,t347:0.9319778308):0.2500437432,t348:1.108310317):3.776428415,(t349:0.1592575759,t350:0.0598061565):4.47040285):3.76004448):0.1176959428,(t351:3.605320015,t352:3.560279574):4.679240905):5.346897643):1.735016567,(((t353:0.9809409817,t354:0.9384186523):8.909027484,(((t355:2.0970347,(t356:0.8494347661,t357:0.8142624816):1.108781036):3.164717943,(t358:0.2830084884,t359:0.2725959886):4.761171459):2.891432047,(((t360:6.637798501,((t361:1.992374695,t362:1.777989599):2.0893158,t363:3.485356392):2.474691578):0.1365289481,(t364:4.793710009,t365:4.780382272):1.165156698):0.7667247243,t366:6.585723731):0.2434613838):1.662980725):1.60443679,(((t368:1.686226886,t369:1.672795916):3.29192158,t370:4.891646796):2.706544473,((t371:6.922776409,((((t372:0.3397243644,t373:0.3051567601):2.561833163,t374:2.862272576):2.828610906,(((t375:3.280470124,(t376:2.536841344,(t377:1.83167626,t378:1.597213603):0.6567753059):0.1290570379):0.02011951351,t379:2.383064396):1.551650267,(t380:2.912852846,t381:2.900338657):0.8380915963):0.6547984055):0.3555481146,(((t382:1.752536728,t383:1.649000061):0.6869340892,(t384:1.660112621,t385:1.643326872):0.6499254276):0.1419446447,(t386:1.541776167,(t387:0.5870357436,t388:0.4615442213):0.8018443897):0.8921617901):2.112874504):0.6728529564):0.1527088062,(((t389:2.930569152,((t390:0.1333096757,t391:0.0832548908):1.873061106,t392:1.813821198):0.8929669841):0.3866639337,(t393:2.508408386,(t394:0.2501398679,t395:0.2077030773):2.189704168):0.5117956035):1.195534299,t396:4.095544284):0.5654796679):0.5072334819):2.251208549):3.740624509):0.6738402431,((((t397:2.726721502,(t398:2.46659347,(t399:2.00698368,(t401:1.102439852,t402:1.098513881):0.6854655705):0.4555433678):0.2354454713):1.679400439,(((t403:2.104473632,t404:1.974404421):0.2272048654,t405:2.142892724):0.378290038,(t406:1.224428657,t407:1.117901703):0.990042091):1.255539302):2.663878951,((((t408:2.874163131,(t409:1.7650256,t410:1.666003022):1.086906484):0.5473069995,t411:3.274164638):0.2499757465,(((t412:0.9579953042,(t413:0.7437946214,t414:0.7274683336):0.1332459998):0.5930709168,t415:1.378979556):0.9182579066,t417:2.045744162):1.031738056):1.749031244,((((t418:1.85524973,t419:1.694402907):0.4483248839,(t420:1.281014779,t421:1.273310236):0.6759888284):0.1735031665,((t422:1.465639971,t423:1.44771845):0.2721720552,t424:1.713083991):0.2596689171):0.632978797,(t425:2.024031167,t426:1.979091556):0.4894937545):1.712493733):0.5679694277):2.318122742,t427:7.060165248):2.405760083):0.5501407591,((t428:0.3557159445,t429:0.235656607):2.197283276,(t430:2.193282982,t431:2.119537551):0.1767817951):7.402046763):1.558923779,(t432:8.788148458,((t433:0.3867494616,t434:0.3519270581):2.614170995,t435:2.96319817):5.439623781):2.24278084):2.234922053,(((t436:0.762093275,t437:0.7579040654):0.9565752393,(((t438:0.7246489168,t439:0.3391780161):0.6438801853,((t440:0.219922106,t441:0.1995426214):0.5820442721,t442:0.6860859154):0.06743664868):0.1458483664,(t443:0.3660337177,(t444:0.07042643427,t445:0.04100104048):0.2859774066):0.4652320456):0.1702976437):0.1550489505,((t446:0.3609299826,t447:0.3604653328):0.2657266824,(t448:0.06129817046,t449:0.02640614319):0.3181953232):0.3860304921):10.9939929):10.25082365):27.73098611):9.706974299,(((((t450:0.499725376,t451:0.4799787171):1.807053036,(t452:0.7723254323,(t453:0.1387722686,t454:0.07992605609):0.5737164115):1.419717718):9.012365407,((t455:2.763726817,(t456:0.845536748,t457:0.6088607047):1.911986463):5.804350932,(t458:0.4873782678,t459:0.4414809921):7.755645318):2.45268176):1.70297149,((t460:2.476983579,(t461:0.2905663611,t462:0.2687616684):2.141490981):5.167284696,((t463:0.4617749664,(t464:0.1510529077,t465:0.1063174556):0.3038545633):0.1666748524,t466:0.4898963018):6.925215554):4.620404736):7.73054795,(t467:5.598328367,t468:5.224530179):14.04011519):38.5913594);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T67.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
