<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t463:3.236910132,t464:3.062015287):5.630103966,((t465:0.4765431403,t466:0.3709189014):7.096384178,(t467:1.022792863,t468:0.860887643):6.397327241):0.9072107967):9.752171405,((t469:4.632991243,t470:4.525446365):3.39763918,t471:7.663056591):9.829466237):3.593184518,(t472:0.6099532732,t473:0.560447021):20.40232166):37.43210611,(((t474:8.641017112,t475:8.522636678):0.2821317402,(t476:4.195771875,t477:4.169884036):4.509106034):39.58173184,(((t478:0.3558082702,t479:0.02153809089):6.413516342,t480:6.42837008):28.07172238,(t481:14.31327924,(((t482:0.340767633,t483:0.278415148):6.598060291,(((t457:0.1069078978,((t432:0.05090063869,(t397:0.0297673613,(((t261:0.003479822241,((t258:0.03364238974,((((t237:1.427224732e-05,((t230:0.393127904,t231:0.2495618823):0.008222283687,(((t158:0.03286269188,((t148:0.1117966819,(t147:0.1851340555,(((t120:0.132123685,((t57:0.09922317703,((t52:0.2104448789,t53:0.001158571924):0.1124922782,((t1:3.594952565,(t2:2.76306818,t3:2.759109741):0.827505777):0.483568814,t4:4.03913835):1.331128325):0.4012521915):0.5643975661,(t5:2.601499868,t6:2.549449958):3.561068821):4.68992064):0.9647597683,((((t7:2.210216518,t8:2.189426458):0.6942759463,(t9:2.012837905,(t10:0.2467990578,t11:0.0159438676):1.484499895):0.8394275671):3.797893976,(t12:4.19163407,t13:4.018241614):1.937543175):3.642291498,t14:9.531886635):1.304657748):0.4600608478,((t15:3.075440844,t16:2.884366494):0.7149291388,(((t17:1.153012897,t18:1.055448464):1.529685492,(t19:0.4570762136,t20:0.2242913822):2.009112738):0.6562196002,t21:2.878938392):0.2415282545):7.471337634):2.056116676):0.4662280406):0.4593935033,t22:13.4257541):0.3564992132):1.026197256,((((((((t23:1.959955043,t24:1.930446153):0.8985719958,((t25:2.40078355,(t26:0.4458998285,t27:0.3611113035):1.928991322):0.09864142834,(t28:0.6055696697,t29:0.5750989455):1.697802654):0.3265947929):0.5064087199,t30:3.091148039):0.3098052046,(t31:1.71920072,t32:1.430783115):1.62622664):0.05898809352,((((t33:0.1977431141,t34:0.1881810277):0.3097701026,t35:0.329287787):0.351047242,t36:0.5033407374):0.3132833574,t37:0.7590474455):1.821591941):6.660439245,((t38:0.9826802432,(t39:0.8502488025,t40:0.7161204601):0.001560837187):7.677103282,(((t41:4.924975077,t42:4.660950486):0.173128317,((t43:1.171184438,t44:1.06288792):2.41261485,(((t45:0.79134508,t46:0.506298381):0.2809215175,(t47:0.5058535639,t48:0.4999408474):0.1371271935):0.176391502,t49:0.8128139515):2.191517233):1.245732185):2.643355214,(((t50:0.3074414674,t51:0.01266154644):0.9092508019,t54:0.5482615209):4.836558744,(t55:2.833297743,(t56:0.8694698684,t58:0.4751362417):1.931020656):2.480851397):0.7906155633):0.4559814114):0.3935175801):2.217698712,((t59:6.987249766,(t60:0.503361087,t61:0.1756496064):6.407550096):0.7616829409,((t62:6.788025517,(t63:1.698392942,(t64:0.1079049959,t65:0.007568543378):1.411227397):4.778500788):0.3884673378,(((t66:6.000397346,(t67:2.564808366,(t68:1.870652166,(t69:0.9447254908,t70:0.9446372695):0.7897667818):0.637594857):3.253778303):0.08659400661,(t71:5.490562806,(t72:0.2438941879,t73:0.05792484726):5.199488767):0.1532088567):0.3393006053,((t74:0.325780999,t75:0.2539381372):1.594477375,t76:1.815658417):3.829149575):0.1512599616):0.1526756543):0.9827685016):0.03128989929,(((((t77:0.7659972971,t78:0.7521161022):1.479424357,t79:2.142670718):2.898238535,((t80:4.706055413,(t81:0.7157952053,t82:0.6308690843):3.767678716):0.1015033007,(t83:3.776165771,(t84:2.592784952,t85:2.531702992):1.142237582):0.5812545602):0.02683813385):0.2510922979,t86:4.529636363):0.04238550947,t87:4.533546593):1.479851655):2.135067945):3.931628988,((t88:3.909333849,(t89:3.211162996,t90:3.182704694):0.5366365682):1.499594911,(((((t91:2.629387947,((t92:1.93553207,t93:1.901217693):0.2504810261,t94:2.022592599):0.2636862298):0.1167869315,t95:2.208373542):1.744298453,t96:3.743614711):0.2671103806,(t97:2.304823966,t98:2.216574647):1.677523009):0.05686477647,(t99:2.99115987,((t100:1.165565543,t101:1.165137625):0.2752226811,t102:1.436448218):1.534906828):0.9159012425):0.3618381088):6.591704475):1.130811219):0.6080909838):0.3477528343,(((((t103:2.555846483,t104:2.495580071):2.144886136,(t105:3.563955893,t106:3.486268346):1.064913825):5.473071006,((((t107:1.270368102,t108:1.256791546):0.2325394462,t109:1.427627763):1.104700553,t110:2.423208318):1.379932379,t111:3.769810264):5.98595429):0.1349161394,(((t112:2.657170874,(t113:1.108505567,t114:1.002185123):1.54232401):1.405246995,t115:3.942783265):0.9504307781,((t116:3.112160636,t117:3.109282024):0.7477833422,((t118:2.561267547,(t119:1.410148151,t121:0.8130377857):1.096364276):1.143089896,(t122:0.5036854401,t123:0.2958240134):2.397291716):0.1103515814):0.9053226265):4.865521452):1.694145484,((t124:1.908725402,(t125:0.1981275205,t126:0.09592549293):1.46421248):2.113102331,(t127:1.092713445,t128:1.047320361):2.519642412):6.200328356):0.7237852826):0.574811899,(((t129:1.742921922,t130:1.628095324):0.4981237577,(t131:2.078712245,(t132:1.362299415,t133:1.236360609):0.6565908273):0.03316184189):6.304402616,(t134:4.487140244,(t135:3.014728787,(t136:2.213273758,(t137:0.6933454688,t138:0.5935817694):1.460640162):0.5397841808):1.469693337):3.344266145):2.469760507):0.9196917977,(((((t139:0.3266477734,t140:0.2892983375):0.04832730306,t141:0.09676861307):0.8579591869,t142:0.663770289):8.447049397,(((t143:0.22600301,t144:0.1964398545):4.148762945,((t145:0.149232172,t146:0.1390601616):1.64404921,((t149:0.7036988995,t150:0.6726483949):0.05838403098,t151:0.6912185008):0.3051738112):2.448086938):4.574200128,((t152:3.554928949,t153:3.521445669):3.660757286,((t154:0.3480077389,t155:0.2384269608):6.326038357,((t156:0.5641223915,t157:0.5339232829):3.607563862,(t159:2.125156819,t160:1.998992888):1.622612793):2.209692722):0.4426992907):0.648583851):0.1015789549):0.671322051,((t161:1.900859035,(t162:0.4878666695,t163:0.4241433964):1.224912508):1.257735936,((t164:1.438829374,t165:1.193673638):0.3359550219,t166:1.451370748):0.877023786):4.476702739):0.4318234466):0.3948810058):0.6144699739,(t167:3.991464245,t168:3.968556072):4.221306805):0.07225818111):8.951114521,(((((t169:1.513412148,(t170:0.5897168759,t171:0.5873300652):0.7251764822):0.1450527469,t172:1.393150171):6.030500762,((t173:0.895600467,t174:0.8376959162):4.648306898,((t175:0.8049540964,t176:0.8018705484):4.419859562,(t177:4.653366264,t178:4.648212847):0.5610240733):0.2583450177):1.824391452):0.05370163648,((t179:0.7666983075,t180:0.7140829858):1.912719423,((t181:0.3339182288,t182:0.2997223219):0.5036263557,t183:0.7596839674):1.76946859):4.611193843):4.449251267,((t184:6.560714789,(t185:4.784343603,(t186:2.160839468,t187:1.862210812):2.61698714):1.77215029):0.6513270746,(((t188:1.062822403,t189:0.780119141):4.752803996,(t190:5.228279231,t191:5.226907452):0.2695826917):0.638924783,(t192:3.560793767,t193:3.55713405):1.841883523):0.352914561):4.350971754):4.94727496):0.2000795873,(((((((((t194:3.006587724,t195:3.002212764):1.633803176,t196:4.613524656):0.007131042366,((((t197:1.261471759,t198:1.158753936):1.477511086,(t199:2.266986507,(((t200:1.502485457,t201:1.492427326):0.2507224207,t202:1.681060713):0.1180001355,t203:1.798318063):0.3906883687):0.3568927585):1.377918269,t204:3.917709258):0.09476558972,(((t205:1.268604237,t206:1.194461651):1.037223925,t207:2.227684144):0.6569116035,t208:2.836237813):1.01092114):0.4025706251):0.0006073977714,((t209:2.854323649,((t210:2.456055659,(t211:0.178005879,t212:0.1703385149):2.24579652):0.1279103669,t213:2.431834149):0.2441135338):1.154495107,((t214:0.9396598538,t215:0.8470211419):1.474019177,t216:2.259399254):1.382416323):0.03008948814):0.1885288994,(t217:0.6928895874,t218:0.6927456529):3.093403058):5.580567227,((t219:3.401066405,t220:3.395302899):1.035160742,t221:4.259455041):4.916899516):2.017761534,((((t222:2.91337457,t223:2.739879035):1.73478131,(t224:1.196281147,t225:1.186494073):3.228794756):1.115968324,((t226:1.553857297,t227:1.553737791):2.116045903,t228:3.610880288):1.813137004):1.085897831,(((t229:2.83404437,(((t232:0.187272574,t233:0.185134968):1.549382278,(t234:1.26526094,t235:1.116657049):0.447176388):0.1291082655,t236:1.667307837):0.3453478618):0.3859937599,(((t238:0.3659445808,t239:0.3248264884):0.09573250154,(t240:0.2321296198,t241:0.09786130058):0.01775082539):0.4197130576,t242:0.5270774863):1.253279647):1.815681397,((((t243:0.2705512776,t244:0.03665700114):1.315033458,(t245:1.063618096,t246:0.8566184729):0.2680116451):0.8066898468,t247:1.897963601):0.8394216904,(t248:1.427820983,((t249:0.4073158748,t250:0.3225267309):0.2828785654,t251:0.5734018927):0.559636786):1.063029438):0.1532183742):1.296579265):3.98354237):0.4007711099,((((t252:0.3743182002,t253:0.2497622111):2.170219543,t254:2.365775037):0.5409443094,t255:2.875781845):1.378207233,(t256:2.113421002,(t257:1.133052295,t259:0.7144475006):0.8784129557):2.125216871):3.396999056):0.6504344271,t260:7.435398474):1.734994229):4.25410451):3.597144432):1.461402909,((((((((t262:1.417651845,t263:1.381001744):3.937614666,(t264:0.07011069528,t265:0.0656176613):5.082372396):2.297580515,((t266:2.29781873,t267:2.133627878):0.1745955559,t268:2.036524298):4.911650138):0.4854135002,((t269:4.833589915,(t270:0.4428055094,t271:0.4007607203):3.922321241):0.6977649353,((t272:0.08994140963,t273:0.06107632139):2.653481559,t274:2.386402087):2.1910475):1.83802698):0.5944967936,((((t275:4.37308022,((t276:3.727289359,(t277:3.1419762,t278:3.019404523):0.5741543343):0.2818668056,t279:3.871862086):0.216974912):0.4115760676,(t280:4.329743127,(t281:3.931993507,t282:3.894294516):0.3935753727):0.1141861256):0.4783978263,(((t283:2.271296459,t284:2.149926125):1.39685975,t285:3.538017592):0.5009866054,t286:4.033767176):0.7075421141):0.4274572005,t287:4.907450307):1.315173472):1.325188774,(((t288:2.039938839,t289:2.003187464):5.125642839,t290:7.002760941):0.3019238039,(t291:6.210587998,((t292:3.46937553,(((t293:0.5145417657,t294:0.5107317213):0.9532019437,(t295:1.331036184,(t296:0.2715417224,t297:0.242572245):0.9749710264):0.1268048093):1.536898478,t298:2.632102248):0.3707748447):1.107336812,(((((t299:1.262244043,t300:1.188464483):1.364941085,(t301:0.03902963429,t302:0.005247374732):2.408270899):0.7772226636,(t303:2.193739169,t304:2.176224735):0.995857939):0.1772169972,t305:2.940190765):0.008739806589,(t306:2.30359402,t307:2.244385667):0.5216806742):0.4462598058):1.421313279):0.9861331804):0.02421565508):2.077404758,(t308:2.659542404,t309:2.648979631):4.914725094):5.699881252,(((t310:5.099094071,(t311:3.360906796,t312:3.179296042):1.669284275):3.273277689,(((t313:0.5592991836,(t314:0.1536842104,t315:0.1505484482):0.1023321651):2.496769459,((t316:1.217639288,t317:1.201035739):1.243443551,t318:2.436746165):0.05568247994):0.4378787327,t319:2.86058509):4.56239487):2.306868613,((((t320:3.393903686,(t321:0.9757535156,(t322:0.3468637126,t323:0.3276372998):0.5135406113):2.375578957):0.4721225029,t324:3.685410871):1.982446881,((((t325:2.952000492,((((t326:1.227668594,t327:0.9416702291):0.4485289242,(t328:0.2288802313,t329:0.2002176959):1.112379054):0.7931612375,t330:2.01621074):0.03196219532,(t331:0.8236338863,t332:0.7978227039):1.040780661):0.1659015066):1.651830294,(((t333:1.662146417,(t334:0.5618079493,(t335:0.3056723053,t336:0.2284343035):0.2232332268):1.066624459):0.7521896497,(t337:0.8309285204,t338:0.4798143703):1.1029572):0.1372573468,t339:1.667142142):0.855894822):0.3742431624,t340:2.776305674):0.3982051155,t341:3.127131103):0.2690667696):2.967508419,((t342:3.044446883,((t343:0.310610409,t344:0.2667101879):0.8174450561,(t345:0.821314476,(t346:0.03862529047,t347:0.0351071184):0.7521626941):0.09840848086):1.705999931):0.9042215183,t348:3.402624523):2.328181984):0.9011443299):2.546799119):0.5546381884):1.019733207):0.7229872439,(((((((t349:0.9732808908,(t350:0.2647963267,t351:0.2558021739):0.5930074096):0.7514900655,t352:1.557547358):6.030202606,(t353:5.498341993,((t354:0.431333234,t355:0.3999263746):3.17223648,((t356:1.351870827,(t357:0.0901475176,t358:0.08913829269):1.035499678):1.311469941,(t359:1.160482139,t360:1.04767473):0.9875535022):0.5997171461):1.752109601):2.088725716):2.912847153,(t361:9.089285904,((((((t362:3.457009983,t363:3.258586292):1.171021947,t364:4.270688282):0.9757437942,t365:5.212544016):1.532615678,(t366:3.57691933,t367:3.545145803):2.973601515):0.5817102358,(((t368:0.3187860029,t369:0.2036553497):2.360306069,t370:2.483967124):3.579376488,t371:5.754223674):0.762408879):0.6158589766,(t372:4.790839067,(t373:3.863182504,t374:3.655527607):0.8579546171):2.30372968):0.6891637066):0.02294794473):0.1287582161,(((t375:0.5792233731,t376:0.4376454127):5.639339734,t377:6.000683072):0.4972382622,((t378:4.958567945,(t379:4.926649765,t380:4.91578677):0.01837625735):1.390437579,((((t381:0.4849130859,t382:0.4733428693):0.6383071296,t383:1.055224448):1.566017331,t384:2.608619068):1.955249429,(((t385:0.7989258348,t386:0.7574667642):2.781315913,((t387:0.5394343662,t388:0.487407184):0.3735971814,t389:0.7106251081):2.525368952):0.6141663284,t390:3.696273767):0.3365363824):1.543820779):0.09677625617):0.9283128645):0.3365698319,(t391:6.377809618,t392:6.362595615):0.4770478699):0.2461481714,((((t393:4.098180439,((t394:0.4435217369,t395:0.4308728509):2.95549802,t396:3.369715272):0.4921263426):1.002669474,t398:4.650769254):0.2331071162,((t399:2.39712398,t400:2.278682362):0.9363831607,(t401:2.208869929,t402:2.141630918):1.000390338):1.363962598):1.231605415,(t403:3.538405324,t404:3.536280347):2.189977319):0.5058902379):0.08773563122):0.7040440435,((t405:2.555245659,(t406:1.668622511,t407:1.601352557):0.7814483994):3.280984099,((t408:2.165352054,t409:2.104519251):2.107892534,((t410:1.536827212,t411:1.517793772):0.8621005941,t412:2.331905262):1.79720152):1.343920872):1.079776769):8.308672423):1.322511945,((((((t413:3.524349955,((t414:1.004712428,t415:0.9328051663):0.1420237821,t416:0.9245231101):2.372094554):8.017257334,((((t417:2.708007088,t418:2.637238533):1.234940225,t419:3.766032778):0.8611944367,(t420:4.031423334,(t421:1.83512454,(t422:0.5181878885,t423:0.4832233238):1.170158233):2.179797488):0.4982327524):3.105326085,((((t424:0.7806436996,t425:0.6934016626):0.4384462728,(t426:0.6287134273,t427:0.5086657379):0.4417813447):2.165332093,(t428:0.2694924951,t429:0.03931573519):2.732766915):2.929785647,(t430:2.174596026,t431:2.154751213):3.11003598):0.7740146562):3.275229472):1.438779714,((t433:0.3457232147,t434:0.3301872677):3.478205775,(t435:0.3621732757,t436:0.3579248178):3.443958966):6.415971186):1.123852568,(((t437:0.8045064958,t438:0.4262823399):1.726953878,((t439:0.3321097532,t440:0.2335721345):1.308916761,t441:1.293447284):0.3215187709):0.3495633777,(t442:0.2107164023,t443:0.1099409472):1.686049512):8.45348346):0.5640923504,((t444:2.319349881,t445:2.317590636):7.544054644,(((t446:1.27366146,(t447:0.8233018856,t448:0.8078129574):0.4345571038):0.1261982464,((t449:0.8723478447,(t450:0.5289089523,t451:0.468699719):0.2352748501):0.06547317898,t452:0.6143248631):0.2603580079):6.33601149,(t453:1.107632605,((t454:0.272464194,t455:0.247045525):0.6132741226,(t456:0.2952018794,t458:0.1280007087):0.5491033823):0.2151211138):5.83329346):2.108536221):0.7634494339):1.362624381,((t459:0.7051766143,t460:0.6143747048):6.285223044,(t461:0.9042029787,t462:0.8718863857):5.908916845):3.875447718):0.03939179882):5.975492723):19.95302461):13.37560993):9.713529906);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T6.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
