<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t477:2.3722443,t478:2.347182995):6.211260215,(((t479:0.9759423719,(t480:0.4601542944,(t481:0.4032454497,t482:0.09561539225):0.03818221598):0.3555954048):0.3517225171,t483:0.5887622591):1.794782987,(t484:0.6330725706,t485:0.6211304443):1.635544469):5.427397393):48.87397122,t486:56.40303426):42.70332825,((t487:8.002976583,((t488:7.102497839,t489:6.688813067):0.2405834635,(t490:5.705173125,(t491:1.95580257,(t492:0.6448982634,t493:0.5449152972):1.235151982):3.739052271):1.170383644):0.6181527456):59.23445003,(((t494:8.846519126,((t495:0.6201248974,t496:0.5724688768):3.138453372,(t497:2.467664685,((t468:0.1680091957,(t438:0.04976114223,((t357:0.04393380634,((t291:0.1515515107,(t269:0.1515409536,(t255:0.1235057947,(t232:0.1330410157,(t229:0.004321627928,(((((((t198:0.03162241914,(t146:0.1947492532,((((t117:0.1410838487,(((t69:0.03263960667,(t61:0.03267213822,(t50:0.3517930655,((t35:0.139649577,((t1:3.571920803,t2:3.472946275):0.1008093289,t3:3.527944716):0.1714529395):1.396013341,(t4:2.500943931,t5:2.36230313):2.518488067):1.015560884):1.279778061):0.8206410757):3.184624419,((t6:4.421922081,((t7:2.51904655,t8:2.449959775):1.76133016,(t9:3.913379599,(t10:3.613506721,(t11:3.497359888,(t12:2.617574433,(t13:1.955598173,t14:1.911346294):0.3396605525):0.6264054573):0.07925906712):0.2576330992):0.2272523514):0.1379953291):3.894785263,((t15:0.7361669819,t16:0.3493586918):4.674062613,(t17:4.153985013,(((t18:2.640020117,(((t19:0.967459387,t20:0.757195114):0.2096012082,t21:0.7702449239):0.3680347821,t22:1.101733706):1.093189753):0.1648728502,(t23:1.201250649,t24:1.171497567):1.155397005):0.2500329692,t25:2.519650062):1.036609227):0.5687199046):2.026862787):2.770288757):0.2974825916,(t26:7.598330955,(((((t27:0.500077893,(t28:0.2613460587,t29:0.1876832236):0.1114082604):1.272853342,t30:1.526927619):1.393290151,(t31:0.02940699162,t32:0.02014739841):2.780511323):2.612236052,t33:5.384720881):0.7528914505,((t34:4.064166346,(t36:1.092460138,(t37:0.08063195216,t38:0.07199423983):0.6041058768):2.378974338):1.305737837,(t39:1.863099464,t40:1.848165234):2.429139479):0.4343724855):1.023244734):1.562193332):0.3640499604):0.8875425989,((t41:0.5626610148,((t42:0.4905426037,t43:0.4797287356):0.008737981424,t44:0.2549120334):0.03585465037):7.090935243,((t45:0.3777543654,t46:0.2223836624):6.448916353,(t47:2.336348536,(t48:1.512675817,t49:1.483752596):0.6511966699):4.045271022):0.3452250503):0.8424472645):1.637313749,(((((t51:1.341789689,t52:1.189696487):0.1367410712,t53:1.20619848):6.337964989,(t54:6.538084711,(t55:6.443996851,(t56:0.8715048296,t57:0.8089557829):5.562881979):0.0666157805):0.6703013301):0.3795066571,((((t58:3.421343114,t59:3.382652699):1.982171464,(t60:3.797016862,t62:3.588886693):1.242017961):0.7475059394,((t63:0.4667561045,t64:0.2410053769):4.754506713,(t65:2.9894341,t66:2.985020306):1.997591008):0.3053333417):0.8300404744,((t67:2.995282431,t68:2.879566681):0.3157422958,t70:3.06837816):2.571054832):0.4315140818):0.2111099464,((t71:4.461903012,t72:4.447675536):0.6850224756,(t73:4.173413804,((t74:3.608445912,(t75:2.372524111,t76:2.329298764):1.222222854):0.005407329916,((t77:1.77228113,t78:1.713122154):0.5993254971,t79:2.273486019):1.119566243):0.4034262364):0.9477429447):1.082741256):0.04226810101):0.5757215627,t80:6.413743282):0.464815737):5.055627028):0.5617171416,((t81:5.737353848,((((t82:0.7965649935,t83:0.7428071485):3.110330809,((t84:1.682489372,(t85:1.018721033,t86:0.7524447829):0.6146955988):1.213703715,(t87:0.9880500388,((t88:0.08200509852,t89:0.02487764374):0.05209088791,t90:0.07435921585):0.8374374843):1.574578949):0.8113032845):0.2838952017,t91:3.484317977):1.17485751,((((t92:0.1386640614,t93:0.1175536254):1.711946096,t94:1.46517584):1.542223638,(t95:1.95567447,(t96:1.395548585,(t97:0.634612467,t98:0.6312749482):0.7485992219):0.4967497033):1.00419563):0.9740534707,t99:3.830180415):0.2559508952):0.3088442608):3.529323953,t100:7.910012747):3.195499877):0.1744540668,(((t101:2.278913885,t102:2.203873989):1.563112047,(((t103:1.59537813,t104:1.58117531):0.3056086258,t105:1.824936055):0.4439049496,t106:2.239664059):1.220866936):2.257469329,(((t107:2.723978898,(t108:2.125085912,(t109:1.407716117,t110:1.342007872):0.4231207237):0.4503114334):0.3258473281,t111:2.433599244):1.858555504,((t112:2.811160438,(t113:2.059495828,t114:2.010750998):0.484508052):0.4500382276,t115:2.68414493):0.997515996):0.7632208556):5.117920009):0.4666417035,(t116:3.158554756,t118:2.661518405):6.833106202):0.4185685767,((((t119:1.57267879,t120:1.559453958):0.6658903436,t121:2.050717009):2.187953738,(t122:1.097317529,t123:0.9450450391):3.136661211):0.1155506193,(((t124:0.735761604,t125:0.6724020431):0.3164396614,t126:0.7178320376):0.2810565237,t127:0.6422309124):2.585558136):5.362385246):0.214904563,((t128:0.295896391,(t129:0.06092508435,t130:0.05358141074):0.141757889):2.11588624,(t131:0.2718076107,t132:0.2690934574):2.018844165):6.170999801):1.324864363,((((t133:0.06408613056,t134:0.059626403):1.553854863,(t135:0.1412487937,t136:0.1218913541):1.460147393):0.9013397797,t137:2.298276799):1.694960239,((t138:0.473486389,t139:0.3727569873):0.731522018,t140:0.9904573102):2.677677519):5.53323472):0.2391301473):0.7943661056):1.943411442):1.063797756):1.840649769):4.439593829,(((t141:4.647695175,(t142:4.496688093,((t143:0.6523663558,t144:0.5068039036):3.292809586,t145:3.39726706):0.487373303):0.1442558227):4.928977961,((((t147:1.150028445,(t148:0.04912808455,t149:0.02045734284):1.042504479):1.190467686,t150:2.042509695):4.43520555,t151:6.350968526):1.372800477,(t152:6.905797377,t153:6.813009892):0.7725358838):0.4149013053):8.731403979,((((t154:1.747605569,t155:1.747312833):3.389096582,((t156:2.20612055,t157:1.777471765):2.731839958,(t158:4.220419657,(t159:3.215399437,t160:3.202372064):0.9876052219):0.008340324367):0.1874952779):1.433858749,(t161:3.170860385,t162:3.091294653):2.556767598):9.924158496,(((((t163:6.869641469,t164:6.832586388):0.01849256911,t165:6.754077561):0.4152834609,((t166:2.036217943,t167:1.984753373):4.160244649,t168:6.069161079):0.9270397222):0.2607031499,((((((t169:0.5142442353,t170:0.3983997183):2.470460401,(t171:1.657069785,t172:1.353026464):1.001390545):0.7647056243,(t173:2.90521575,t174:2.846767939):0.151067404):1.208240118,t175:4.109493065):0.2168867125,t176:4.162353916):1.95274936,(((t177:5.577827263,((((t178:0.4443071477,t179:0.3438929959):2.801893307,t180:3.018396039):0.9542421668,((t181:2.663695763,t182:2.624452548):0.7646297865,t183:3.32029078):0.4639657407):0.7598814904,(t184:3.62520739,t185:3.504584281):0.772286255):0.5104979595):0.2201229415,t186:4.859029286):0.02839075585,(((((t187:1.668206712,t188:1.598204281):0.1629554889,t189:1.724160242):0.9276151855,(t190:1.958290309,(t191:0.7713312489,t192:0.6662074259):1.130397363):0.5501207356):0.2434204991,(t193:1.865154521,t194:1.860408489):0.723926202):1.521293828,(t195:3.240313558,((t196:2.133674966,t197:1.859355763):0.1449775502,t199:1.950114783):0.6935451135):0.860946503):0.3330992206):0.2879349702):0.1036428806):7.71253746,(((t200:5.517982183,(((t201:1.056505704,t202:1.035792047):0.6733653357,t203:1.584870067):2.252182858,(((((t204:0.2839540482,t205:0.04181265896):1.980551434,t206:1.796949648):0.3214790409,(t207:0.7988567962,t208:0.7932779635):0.9788999235):0.1663546205,t209:1.706468469):0.5686087817,(t210:1.707138794,(t211:0.1267395717,t212:0.07545732693):1.527526421):0.4678627444):0.4951460058):1.488414872):0.6703323448,t213:4.590657167):0.502397617,(((((((t214:1.691068128,t215:1.463611779):0.1923515665,(t216:1.012401597,(t217:0.6511749082,t218:0.4672240169):0.2879821375):0.6334546261):0.3675970081,t219:1.716485478):0.0806365579,t220:1.477515054):0.8962106492,((t221:1.468971707,t222:1.321616855):0.164049767,t223:1.48104423):0.6545632436):0.4480573825,t224:2.559666866):0.008475233819,((t225:0.6568282133,t226:0.5939009644):1.004947799,(((t227:0.1483942097,t228:0.01585720656):1.169060857,t230:0.9928637496):0.02446358962,t231:0.6553392539):0.1938615351):0.8385429706):1.351249525):5.126468631):0.2618921712):0.0763534163):1.182474982):0.6194283334):0.2224347568,(((t233:3.088177032,(t234:2.631669811,t235:2.545974325):0.4538296452):5.190851059,t236:8.098708699):0.7328360156,((t237:4.750583826,(t238:3.902604791,(t239:1.799782198,(t240:1.078633764,((t241:0.1700776201,t242:0.1352971312):0.06852794017,t243:0.1813834086):0.8309264753):0.6094625179):2.017775568):0.7148230659):1.526591099,t244:5.805181043):2.447835963):0.9645857785):7.461528769):2.235621128):2.714317245,((t245:13.04311658,(((((t246:1.348456502,t247:1.279063671):4.94683395,(t248:5.290245437,(t249:2.816891256,t250:2.746168277):2.312816394):0.8841913047):0.6657665423,t251:6.558079561):1.288942508,((t252:6.478582727,(t253:2.001216889,t254:1.861407554):4.44536212):0.4701081969,((t256:1.392006944,t257:1.011933318):4.325280851,t258:5.328193332):0.8699102956):0.8024267076):0.4783091287,(t259:4.607824204,(t260:0.7282337018,t261:0.6990406352):3.869534408):2.769024149):4.187445836):4.067450713,((((((((t262:0.02226313686,t263:0.01775148714):2.328811275,((t264:0.1471690478,t265:0.04849711181):1.540809591,t266:1.57313567):0.6316764526):4.212396811,(((((t267:3.596887916,t268:3.563522274):1.26764341,(t270:0.2337339194,t271:0.08073266593):3.961408061):1.00760296,(((t272:3.301515702,t273:3.098808429):0.5819741911,t274:3.62427565):0.9215131442,(t275:4.445875661,((t276:2.708888,t277:2.684355239):1.709872243,(t278:3.84408479,(t279:1.975041313,t280:1.895937908):1.814366652):0.5465932868):0.02259500374):0.04449629227):0.1815171187):0.3949759602,((t281:1.489620786,t282:1.31813756):3.138701886,(t283:3.349896898,(t284:2.075340758,t285:2.030898424):1.237432649):1.075052088):0.2318269016):0.008388932394,t286:4.567581738):0.122936842):0.3268736397,(t287:4.867373816,(((t288:3.411106578,(t289:2.63914936,t290:2.631871613):0.7684238172):0.4870061322,t292:3.561660301):0.8880752334,((t293:2.335901411,(t294:0.7916127527,t295:0.7508099861):1.543794529):1.647643858,(t296:3.295218279,((t297:1.071045955,t298:1.068083565):0.622624393,t299:1.56196121):1.479416337):0.622775478):0.4660807327):0.01089437565):0.08960127617):1.451280002,((((t300:0.9963493108,t301:0.8939195888):0.1942200219,t302:0.9979810653):0.128218272,(t303:0.4669889363,t304:0.4274733507):0.6472790007):2.958226064,t305:3.960840374):1.387478437):2.211532994,((t306:2.13426313,t307:1.974505232):4.253436813,((t308:3.593992327,((t309:1.049851435,t310:1.041290964):1.49443443,(t311:0.1991532806,t312:0.02161051685):2.308974591):0.3574387931):0.4211279119,t313:3.05370369):2.200258634):1.160530159):3.011572499,((((t314:0.2688292146,t315:0.2662797982):1.687715551,(t316:1.523411065,(t317:0.9118323736,t318:0.8731170944):0.5900703937):0.2558673061):0.9997023328,((t319:0.312401142,t320:0.1730416785):0.5872314031,t321:0.7171622201):1.80955401):0.276114331,(t322:1.88318326,((((t323:0.1348985226,t324:0.0706332179):0.2105560512,t325:0.2211286544):0.8219895476,((t326:0.1955966004,t327:0.1822175226):0.08750775025,t328:0.2103310813):0.6207099859):0.0641024332,t329:0.86576989):0.5138954099):0.9038330669):6.183565668):0.9372416572,((((t330:0.961007103,(t331:0.633975717,t332:0.431358306):0.2312894244):0.9126280849,((t333:1.247135611,(t334:0.9295785438,t335:0.8669950982):0.2615107855):0.0161091722,(t336:1.026112994,t337:1.018591444):0.02449847661):0.2828736):0.8123953543,((t338:1.014492658,t339:0.9680059142):0.7852027344,((t340:0.589971108,t341:0.5836936241):0.4149833638,(t342:0.7832796853,t343:0.6294624912):0.1425803327):0.6783446499):0.2081744172):4.357918498,(t344:2.143152936,(t345:1.142833673,(t346:0.7575538782,t347:0.4978821692):0.113934654):0.9268878736):3.854542523):2.344764811):1.005299033):4.470840252):2.847475336):1.181940499):5.021219818):1.022050243,((((((t348:0.6085861214,(t349:0.176163439,t350:0.1275706848):0.4213572785):9.074513676,((((t351:1.994471875,((t352:0.4810412515,t353:0.4425097418):0.8580478884,t354:1.143849935):0.6333469466):0.3708721794,t355:2.078976921):1.48657534,((t356:0.6939891565,(t358:0.158733928,t359:0.08579242265):0.3565220031):2.409506947,(t360:0.7290605092,t361:0.4319152724):1.833127174):0.4228504921):3.520533385,(t362:1.769916585,t363:1.17948657):4.28996804):2.204709728):0.3211331936,(((t364:6.074570026,t365:6.020183551):0.1220495543,(t366:4.295425013,t367:3.956128473):1.713693027):0.4788040349,(((t368:0.2564833817,t369:0.219758832):3.344391019,t370:3.52211766):0.1482876487,t371:3.635117839):2.228463739):1.311106247):1.075403203,((((t372:1.259058569,t373:1.218353776):5.911130309,((t374:2.45427975,t375:2.423864235):3.112932588,t376:5.523589953):1.544383794):0.6346480587,(((t377:0.4480459357,t378:0.445856008):6.859185639,((t379:4.021860988,(t380:2.667575602,t381:2.622518308):1.301664487):2.146394722,(((t382:1.115696427,(t383:0.8921785331,t384:0.8786478457):0.08678421023):1.412524467,t385:2.282774992):0.9809570251,(t386:2.447814405,t387:2.126586307):0.7201350103):2.532428673):1.074755567):0.08606623528,(t388:5.237270894,t389:4.959885595):1.161532809):0.1376911027):0.1696820086,t390:6.390711889):0.227823759):0.304457262,((((t391:1.273730743,t392:1.054162438):2.145141231,t393:3.157572958):2.16162857,(t394:4.56874915,((t395:0.2213761388,t396:0.2190680328):3.231691874,t397:3.286272173):1.090346237):0.7357538666):0.02187605101,((t398:4.342885493,(((t399:1.882187081,t400:1.743119464):1.533386441,(t401:3.106380782,t402:3.062784438):0.1630016728):0.3051463149,(((t403:2.648568633,(t404:1.512853869,t405:1.441063291):1.03402716):0.04292235885,(t406:1.443698351,t407:1.369115133):1.046867565):0.6331314962,t408:3.045662037):0.1538841567):0.5794805285):0.05434145043,(t409:1.994015901,((t410:1.520373549,(t411:0.9074092722,t412:0.8395999056):0.4023184758):0.1388340868,t413:1.327553265):0.2940507212):1.831271079):0.5599892369):1.160989043):7.529390001,((((((t414:1.389685658,t415:1.156686304):2.420473873,(t416:1.215057637,t417:1.129612037):2.147096304):0.4777298216,((t418:1.214729541,t419:1.185442745):1.635087033,t420:2.779464451):0.9039956585):1.901944733,(t421:4.25737056,(t422:1.801893128,t423:1.795611196):2.446399732):1.313779285):1.792477951,(((((t424:0.762786799,t425:0.5904688769):2.224160154,(t426:2.078396295,(t427:0.6645094041,t428:0.6022179388):1.382208769):0.7331130944):0.4409127993,((t429:2.27121295,((t430:0.302692186,t431:0.2729649529):0.1131130981,(t432:0.1356325781,t433:0.124782197):0.09096883879):1.453075449):0.03070864752,((t434:0.3581178702,t435:0.2810792026):0.7134881859,t436:0.9164417519):0.5948031499):0.8213012932):1.447842098,t437:3.653760048):1.333742047,(t439:1.779341725,t440:1.728723121):3.027510153):1.1134518):0.8494184062,(t441:1.728979166,t442:1.702114405):4.767346994):3.836250648):4.355141835):29.50284264,((((((t443:0.6415746794,t444:0.4424578906):0.7507430209,(t445:0.3035436887,t446:0.123348412):0.79410241):0.1007479672,t447:0.9751801049):0.4268771912,t448:1.401170995):9.08422514,(((t449:0.9096416588,t450:0.7688025449):4.468641289,t451:5.079026909):2.553447571,((t452:1.295414275,t453:1.27713083):1.812383396,((t454:0.09387835433,t455:0.03309422584):2.144540533,((t456:0.2493840851,t457:0.2375757526):1.746111113,(t458:0.4261524071,t459:0.4118893527):1.510721493):0.1709213727):0.7374214128):4.419230427):2.532085151):0.5428504055,(((t460:1.719754667,((((t461:0.1299287664,t462:0.08238171568):0.1096110136,t463:0.1727905197):0.09525136773,t464:0.1573956354):0.2166716504,t465:0.3678502582):1.127354308):7.657210961,t466:9.142825736):0.4460494623,((((((t467:1.123573696,t469:0.5371759041):0.3159212879,t470:0.7756772856):0.5661255056,(t471:0.2881592252,t472:0.2591489336):0.9235850101):1.479727519,t473:2.58438667):3.065372318,(t474:2.716642754,t475:2.714117961):2.692484497):1.381747015,t476:6.711471274):1.544008128):0.4592308417):32.59809115):27.05938914):31.86654243);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T0.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
