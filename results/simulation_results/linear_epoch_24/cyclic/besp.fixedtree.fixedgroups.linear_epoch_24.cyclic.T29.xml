<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t483:4.851623313,t484:4.773278589):3.805118401,(t485:8.025463591,((t486:0.3695504095,(t487:0.05806150492,t488:0.02992406785):0.2845037929):2.0932045,t489:2.282521996):5.451280068):0.4624676928):100.6178858,((t490:5.49999089,t491:5.427384367):22.16805453,((t492:7.04982666,((t493:4.118672495,((t458:0.03690252716,(t444:0.05742763684,(t438:0.1793113074,((t367:0.09461433703,(((t362:0.1148170101,(t337:0.1280843507,(t309:0.04606281562,(t295:0.1372383021,((t272:0.02113549041,((t257:0.08727229142,((t180:0.05657373624,(t166:0.04852978419,((t96:0.01500076318,((t81:0.1112167299,(t74:0.07191193388,(t69:0.1543064586,(t62:0.09588871666,((t1:3.463538636,t2:3.446271247):0.583291587,((t3:1.846081765,t4:1.784053527):1.727908708,t5:3.448806146):0.4359955851):0.4541647865):0.5208121923):0.542834921):1.132322917):0.3569945116,(((t6:1.820384585,t7:1.794399493):3.169195415,(((t8:1.316336679,t9:1.266453356):2.383764388,t10:3.646963358):0.964936879,(t11:0.452928409,t12:0.4295908967):4.154763823):0.2833135428):1.322164605,((((t13:2.351891481,t14:2.164521583):0.8039522122,(t15:1.244159666,t16:1.153860802):1.657440497):1.890649263,((t17:2.728234556,t18:2.721253269):0.3010259884,t19:2.518136918):1.668408903):0.09695321611,(t20:2.07232978,t21:2.050278095):2.159104761):1.002625068):0.5164376932):1.48404356):0.8110647321,((((t22:2.20463572,(t23:1.169469216,t24:0.9592162489):1.002794417):0.7508499516,t25:2.696884534):0.5229761479,t26:3.192073219):0.06926916747,(((t27:1.217898517,t28:1.021892339):0.1924191294,t29:1.186573444):0.07353318904,t30:1.234768286):1.686103171):4.457079993):7.027600594):1.300090237):4.948559623,(((((((t31:2.358343592,t32:2.142141181):1.420977091,(((t33:1.949867945,((t34:0.7019793992,(t35:0.5487720064,t36:0.5456790087):0.1379357775):1.09986139,(t37:0.9537759118,t38:0.8667963829):0.8244118694):0.03059080573):0.5691809642,(t39:1.626841297,t40:1.455198776):0.6446925079):0.8476750358,(t41:1.459334735,(t42:0.4372848595,t43:0.4245815283):0.9923209018):1.372121254):0.1800068603):5.737410084,((t44:0.09459721828,t45:0.09094276437):1.51904262,(t46:0.7640597892,t47:0.7128823937):0.8279575189):6.966990068):2.418683766,t48:10.90383427):0.9910097881,(((((t49:0.7381124991,t50:0.7181100409):0.2338144705,((t51:0.5541956271,t52:0.3269219766):0.3338771915,t53:0.4297745192):0.04747549774):0.5635838068,((t54:0.0898267416,t55:0.005063635641):0.3150625619,t56:0.3169562177):0.4866023223):9.124390778,(t57:2.421944121,(t58:0.6966546253,t59:0.6644798047):1.597374153):7.414539602):0.009696643987,(((t60:1.456708848,t61:1.403374096):1.502519807,(t63:1.171008089,t64:1.162537271):1.314630898):3.939505188,t65:6.201063159):2.771601019):1.194345465):2.008266403,(((t66:8.515965953,(t67:0.6925756561,t68:0.6742157552):7.718268092):1.169924544,(((t70:7.112778466,(t71:6.360517703,((t72:0.4315200675,t73:0.2408001697):1.686649968,t75:1.639492089):4.229780045):0.6204086488):1.208225868,(t76:7.377155804,t77:7.344242644):0.2348648352):0.3012230803,(t78:6.694467809,((t79:4.710650566,(t80:1.089701646,t82:0.2130728058):3.479935331):1.649233589,(t83:4.187595515,t84:3.994363904):0.9236079974):0.3114283137):1.116981066):0.7296149663):0.07223048752,(((t85:0.5571180315,t86:0.5035648987):1.012659,t87:1.470687674):5.428657765,t88:6.879801452):0.06161155376):2.405959918):0.1483684189,((((t89:1.559369865,t90:1.46643801):5.134232068,t91:6.451150272):0.8786112172,((t92:3.419259149,((t93:2.163300797,t94:1.97577263):0.3386381171,t95:2.169838595):0.9045624209):3.362333653,((t97:3.649852443,(t98:1.453603917,t99:1.220337694):2.027852804):1.012424564,t100:4.238282399):1.361551336):0.4837293711):0.0689826104,((t101:0.4674619544,t102:0.4351569135):1.144493912,t103:1.575332884):4.334634143):1.826006744):5.569390367):2.663004595):0.7565263969,((((((((t104:0.7600006925,t105:0.5680165075):3.380425194,t106:3.858217776):1.244105294,t107:5.046249386):0.1891456524,(t108:4.759130264,(t109:1.888944055,(t110:0.3187961611,t111:0.1207211404):1.555660057):2.7744105):0.4454049566):0.6420071955,t112:5.483298454):1.224342443,((t113:2.621934677,(t114:2.54726073,(t115:2.436547943,((t116:0.7263367207,t117:0.5439308745):1.310866662,t118:1.718077567):0.2206572644):0.02124721486):0.04523532391):0.3457065013,t119:2.256710837):3.687654037):3.072976611,((t120:4.218503845,((((t121:1.87279885,t122:1.57466088):0.1504255103,(t123:1.262308183,t124:1.14036178):0.03296332043):1.686101788,(t125:1.280781182,t126:1.193014718):1.518081825):0.06455840643,t127:2.578456763):0.3946250507):0.661819285,((t128:1.782705186,t129:1.778396672):1.129481539,(t130:1.508905526,t131:1.411761761):1.331512727):0.655134327):4.104740547):3.662944315,((((t132:0.5251521073,t133:0.4558122158):4.646927075,((t134:0.9196083119,t135:0.8349046294):0.5967848013,(t136:0.788840233,(t137:0.5856696942,t138:0.4062110341):0.1921552852):0.2257713025):3.527799011):3.913164647,t139:8.219094722):1.364910938,(((t140:1.073230291,(t141:0.5127490476,(t142:0.1764361391,t143:0.01653401026):0.2889108092):0.3782404015):2.220663173,((t144:0.316985338,t145:0.2653314299):1.61063475,(t146:0.4603838168,(t147:0.2037823456,t148:0.08835417678):0.2318672745):1.288288328):0.9511192761):0.323473545,((t149:0.2999833675,t150:0.2640268362):0.6770482639,((t151:0.2177837142,(t152:0.1516707911,t153:0.1185893266):0.04213073168):0.3788134127,((t154:0.1784629437,t155:0.05633882635):0.08450376397,t156:0.06552429761):0.1311255148):0.1993383888):1.812661185):5.863582679):0.6534673773):2.529843839):0.7409559659):0.6739116433,(((((t157:0.08007292161,t158:0.07312946664):1.51976817,t159:1.47863931):0.8518610853,(t160:0.3177581399,t161:0.2753035517):1.983925221):4.692192373,((t162:0.6400945639,t163:0.5964929616):5.048071613,((t164:4.026904311,t165:3.93468932):1.257060993,t167:4.867975327):0.3003531114):1.221000688):0.01859123782,t168:6.397266387):4.498447171):1.274730102):1.07408167):3.033203355):2.490242512):0.03449619794,(((t169:0.1762558,t170:0.1035476235):6.193319902,t171:6.259553455):11.5385196,(((((t172:7.074230084,(t173:4.731123833,(t174:0.364548368,t175:0.3076747378):4.326224892):2.255735759):1.904246904,t176:8.700634487):1.142117098,((t177:6.730181082,(t178:5.261044229,t179:5.227989724):1.356588715):0.1392493716,(t181:5.992583292,((((t182:0.3598244686,t183:0.298441869):2.061451731,t184:2.282058453):2.229588321,((t185:0.9902995085,t186:0.8934431435):0.8868131795,(t187:0.9398068764,(t188:0.2942876473,t189:0.2159216485):0.640471899):0.6470904446):2.548853786):0.8504952746,((t190:4.317746809,(((t191:3.440596525,t192:3.221165402):0.4106461585,(t193:3.434231779,(t194:2.808859451,t195:2.687460357):0.5759616327):0.1001347519):0.08069729468,t196:3.407301913):0.3626370651):0.06319509347,t197:3.703048628):0.5069857609):0.3537904339):0.238800316):2.940899854):4.82036444,(((((t198:1.86815608,t199:1.866180347):1.545447421,t200:3.178476461):2.144789281,((t201:1.190763459,t202:1.05669325):3.488790985,((t203:1.032485585,t204:1.030737288):2.719673989,((t205:1.245601071,t206:1.175277253):2.449482606,(t207:2.59679209,(t208:1.372899936,(t209:1.101534212,t210:0.98308636):0.175705198):0.9619217086):0.8753621001):0.0410029976):0.74071363):0.6168955601):1.277194831,((((t211:2.434640785,((t212:0.9355054025,t213:0.8998507408):0.9005607597,((t214:0.6039043323,t215:0.5768587411):0.2982319936,t216:0.8672147436):0.8606139737):0.5532285897):0.7872317151,(t217:2.806468243,t218:2.530851431):0.2142505128):0.3556341438,t219:2.908116805):0.1885641838,((((t220:0.6714773583,t221:0.6651024427):0.8193652765,((t222:0.5236895301,t223:0.4922934652):0.1015252341,t224:0.4629215415):0.8013133044):0.6608284846,t225:1.878783772):0.6534156575,(((t226:1.230030989,t227:1.179701):0.3774818185,(t228:1.265985996,t229:1.262890065):0.2677073969):0.6450337091,(t230:1.266953694,t231:1.233075853):0.9077869288):0.2188194754):0.1206928704):1.734140481):5.475895732,(((t232:1.362001515,t233:1.354333747):3.72290807,(((t234:0.5946031185,t235:0.5855588955):1.322284419,(t236:1.064737741,t237:1.005151267):0.6525469265):1.649334615,(t238:1.748950584,((t239:0.7471504138,t240:0.7392820805):0.09982749266,(t241:0.1316001481,t242:0.01605159976):0.6505238494):0.8774469111):1.400904067):1.492027949):0.3080625803,(t243:1.462909363,(t244:1.027669048,t245:0.8458457303):0.3509245613):3.110708161):4.201989592):0.0185756571):0.9353334096,((((t246:3.752694955,(t247:1.525333185,t248:1.379822536):2.091961148):4.257313196,((t249:3.525460301,(t250:2.019530579,t251:2.009326444):1.457565463):2.27245062,((t252:1.013252179,t253:0.4926919861):2.394962671,((((t254:0.3382592904,t255:0.074944558):0.3192618901,t256:0.3496085043):0.2702234899,t258:0.3241255814):1.862991592,(t259:1.903335067,(t260:1.05250074,t261:1.022996556):0.6110485346):0.2357279639):0.05985182961):2.325883118):1.883612861):0.8368129831,((t262:0.3208415651,t263:0.2526451855):5.399290099,(t264:1.448665804,(t265:0.6230529249,t266:0.3625030225):0.6629823169):4.08937791):1.161173855):0.1134890856,(t267:5.62092885,t268:5.615875578):0.7016575887):0.1148427532):1.715691604):0.8157944496):0.01090593877,(t269:6.764661568,t270:6.623204599):2.127263845):0.9505841675):5.784480344,((((((t271:4.463858541,t273:4.32460881):1.111765992,((t274:0.2388314932,t275:0.2188157175):2.726946617,t276:2.944552146):2.24912108):0.9088651774,t277:6.090418609):0.08256895982,(t278:5.277807572,t279:5.26698854):0.8605633481):0.2668798122,(((t280:3.167951994,(t281:1.434663981,(t282:0.9222432518,t283:0.854957247):0.3434310254):1.673890131):0.1781771292,(t284:1.642324928,(t285:0.4161797703,t286:0.3949949822):1.155553225):1.397121152):1.84163325,(t287:1.654327094,t288:1.621744771):2.986002425):1.156224772):1.192309497,(t289:5.047188624,(t290:4.770726467,(t291:2.151368835,t292:2.140509207):2.573730588):0.2412700208):1.888805098):7.32453385):0.2679239649):0.3012144866):1.501445093):0.6552085161,(((t293:4.281750095,t294:4.113165313):1.047509064,(t296:3.04616239,t297:2.96123619):1.519963681):2.792389172,((((t298:4.980841351,(t299:3.773314929,t300:3.749220043):1.197004692):0.7444321067,t301:5.622551863):0.8053478595,t302:6.406001302):0.03839721445,(t303:3.012125525,((t304:1.70067818,t305:1.682138752):1.135173126,t306:2.75942377):0.1336562303):3.418410763):0.4901010113):8.460050939):7.033877409):2.468867621,(((((t307:3.253729914,((t308:1.465503237,(t310:1.118613038,t311:1.091196018):0.1737212476):0.408013193,t312:1.50809832):1.268860431):1.5550468,((t313:2.356007494,(t314:1.706696052,t315:1.618949169):0.5976444426):1.454376148,((t316:0.4827904335,t317:0.4412911914):2.814286706,t318:3.180502512):0.251248677):0.3431364185):0.3317321505,t319:3.931801951):1.722207726,((((t320:1.355114762,t321:1.157934315):0.2129144623,t322:1.342784643):1.855488089,(t323:2.114319695,((t324:0.6276782172,t325:0.3621815576):1.18999627,t326:1.123518831):0.2170569352):1.041103066):1.316447358,(t327:0.4384903198,t328:0.3421872136):3.067770572):0.7540626565):9.291114122,((t329:1.803725413,t330:1.800381669):11.40211668,(((t331:0.3797698107,t332:0.3637275544):10.14877441,(t333:0.3934632546,t334:0.3836442611):10.02984351):1.036653671,(((((t335:1.604294377,((((t336:0.6075598667,t338:0.3608013559):0.1021749038,t339:0.3749068478):0.1658864104,t340:0.417385458):0.3280290624,(t341:0.1954169329,t342:0.1452403539):0.531311753):0.2979316025):2.244739365,(t343:0.6315529636,t344:0.1030306463):2.250740123):0.2400214676,t345:2.50895191):3.317779853,(t346:0.03185232475,t347:0.02912320735):5.75408187):2.227803386,((((t348:0.2180848267,t349:0.2138957159):0.2691582534,t350:0.4553386509):0.02465533616,t351:0.4720617786):2.227914659,(t352:1.049981156,t353:0.9562014861):1.559013881):5.194879492):1.736501813):1.604821157):0.2318353016):8.582716659):0.1927685181):2.986244876,(((((((((((((((t354:0.625945763,((t355:0.2747697445,t356:0.2328405181):0.2060439743,t357:0.2923200097):0.02266883982):0.052863853,(t358:0.07600863629,t359:0.06824622748):0.2828049417):1.53457549,t360:1.68703046):0.0245452804,t361:1.595531111):2.55935955,t363:3.968886909):0.8815568877,(t364:1.310650367,t365:1.181409144):3.446011474):0.773168659,t366:5.261474008):0.4501444649,((t368:0.8386019904,t369:0.8344923405):0.7949555311,t370:1.460116754):3.470058281):2.452566549,((((((t371:4.768148899,((t372:2.128550296,t373:2.118092554):1.78466115,t374:3.837204517):0.8262326431):0.2030169638,(t375:4.469658647,(t376:2.862558822,t377:2.734482212):1.547815273):0.3841503503):0.138625558,t378:4.728346627):0.546224668,t379:5.266294843):0.0875772843,(t380:2.832924634,t381:2.8080234):2.488518857):0.5815161917,t382:5.693995145):0.7336017556):0.9242191723,(t383:3.371065697,t384:3.247752772):3.911607005):0.732261055,(((((t385:0.337641252,t386:0.3254744143):3.865481076,(t387:1.889236501,t388:1.815445113):2.136795986):0.9105672291,((t389:2.651130958,t390:2.641939262):1.803587236,((t391:2.668864195,(t392:2.118578983,t393:1.996023148):0.469033098):1.46109637,(t394:3.504363486,(((t395:1.87814761,t396:1.761320756):0.05558134645,t397:1.755885599):0.4389930259,t398:2.037702207):1.112934507):0.4077089458):0.2442806384):0.1232276767):0.6476169683,(((t399:0.3457566964,t400:0.2993390917):0.4385923049,t401:0.6444526829):3.43728037,((t402:1.885902069,t403:1.809709037):0.7323590867,(t404:1.664092553,(t405:0.6866668739,t406:0.6737962166):0.9530704705):0.7911342372):1.41497486):0.2950467051):0.7221772429,((t407:3.352612929,t408:3.339683216):1.377965227,t409:4.709731503):0.07001069995):0.6881909632):6.19921981,((((t410:1.342213158,t411:1.194718672):1.94821855,t412:3.062750358):0.6726996177,t413:3.697705651):0.943002643,t414:4.581053957):6.752936044):3.486880827,((((t415:3.342858739,t416:3.319685682):0.9481515989,(((t417:0.9030889761,t418:0.8966811313):0.8213474804,(t419:0.3264310287,t420:0.313016622):1.373826192):2.219388416,((t421:1.374182184,t422:1.36282378):1.110155044,((t423:0.6705994907,t424:0.6681251021):1.299115447,t425:1.958974799):0.4373282533):1.166195965):0.3046769303):0.4237191716,((t426:0.7510216378,t427:0.6831631309):2.616890707,((t428:0.3512287608,t429:0.165421184):1.697519829,((t430:1.11875936,(t431:0.969343135,t432:0.9072791979):0.07850603083):0.4382569025,(t433:0.137178494,t434:0.08080893183):0.9166050698):0.3056825644):1.071791397):0.7551111529):8.546254628,((((t435:2.119048985,(t436:1.890238586,t437:1.874210588):0.1889709272):0.2135293934,(t439:0.5695403091,t440:0.5630089691):1.363225161):0.4935476103,((t441:0.7416664914,(t442:0.7050236255,t443:0.6935397695):0.003691581258):0.8697069764,((t445:0.299816524,t446:0.1538113578):0.5097454137,t447:0.6429587818):0.5495803197):0.7851200806):1.855098102,(((((t448:0.7081282892,t449:0.6853100744):0.3494328633,t450:0.962322491):0.07111814619,(t451:0.4347515115,t452:0.3927259673):0.2810605614):0.003510936634,((t453:0.4638559866,t454:0.4058660028):0.01259416201,t455:0.2931125272):0.1266567024):0.1321799489,t456:0.4854270007):2.35995927):6.970687574):1.458403994):0.5324160458,(((t457:1.073012435,((t459:0.3997048991,t460:0.2559289131):0.3144768043,t461:0.2289597033):0.2491675756):9.049457562,t462:9.48442001):0.1689633253,(((((((t463:0.3456119233,t464:0.042417094):2.136596533,t465:2.082399915):0.08999074464,(t466:0.6917691952,t467:0.6849001743):1.462710994):0.3069060013,(t468:0.5391085385,t469:0.5122796292):1.902912515):2.256106566,(t470:1.404396333,t471:1.107223908):3.200419679):1.471039601,((t472:0.09084277552,t473:0.02544448476):1.519271126,t474:1.528387301):4.13264981):2.900326799,(t475:2.215840088,t476:2.180251717):6.224420378):0.07056700833):1.390395937):0.8410310544,(((t477:1.782426622,((t478:0.6007416204,t479:0.3720640007):0.9353944262,t480:1.305667696):0.2425312695):1.207318472,t481:2.526757543):3.838997426,t482:6.291029479):3.528453748):0.9046606422):17.55559792):81.09890519);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T29.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
