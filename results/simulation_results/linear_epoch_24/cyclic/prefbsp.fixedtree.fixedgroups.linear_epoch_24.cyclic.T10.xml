<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t494:26.33677897,((t495:16.6780572,((t496:1.812677028,t497:1.71273652):6.965175804,(t480:0.005030744091,(t461:0.004715263175,(t457:0.1171152491,(t453:0.02512777679,((t450:0.07396597224,(t435:0.007329875801,(t398:0.05640688361,(((t341:0.0162055936,(t326:0.03440592719,(((t309:0.005353074678,(((t247:0.1614046208,((t229:0.008516864658,(t224:0.005176802173,(t138:0.02135994706,(t135:0.005023188773,((t85:0.01248500958,(t63:0.07574826196,(t52:0.03178371975,((t1:3.701733863,(((t2:2.546289138,t3:2.391907577):0.7168739669,(t4:2.138373898,t5:2.020531309):0.9171104194):0.1161801313,t6:3.046025508):0.250373825):0.9269928403,t7:4.157743352):0.04693141453):1.063938449):1.855377707):4.97860629,(((((t8:0.4562562874,t9:0.4409183872):1.812945684,(t10:2.109041102,t11:2.082483485):0.09707386903):2.212008314,((t12:2.559228813,((t13:0.6958570356,t14:0.6913232688):1.292425346,t15:1.490035025):0.4022329032):1.475107844,t16:3.289582495):0.3145544636):0.07511519394,(t17:2.597212092,(t18:1.93529321,t19:1.845882126):0.4350857243):0.9763341908):2.025977185,((t20:3.25233539,((t21:2.155362072,((t22:1.087127683,t23:1.016622732):0.6850049035,t24:1.616164423):0.3105472536):0.1295602821,t25:2.03263943):0.8794998073):1.306004724,((t26:0.8204393212,t27:0.7813893084):3.052750752,t28:3.829082769):0.343006812):0.6567756753):5.481589158):0.0562045721):0.7159579258):9.235449036):0.5523173453):1.876937149,((((((((t29:2.164741491,((t30:1.322421852,t31:1.285496696):0.1977806771,(t32:0.09973298401,t33:0.05560179535):1.342120163):0.5695284555):5.113922916,t34:7.053206688):3.553043739,(t35:8.693665321,((((t36:0.4426631113,t37:0.3495998346):1.231802207,(t38:0.4723629122,t39:0.3435447718):1.045442636):0.5489214066,(t40:1.413180178,((t41:0.4402999705,t42:0.4234570567):0.151247736,t43:0.1047574006):0.7987451609):0.3569535289):5.342801885,(t44:2.078158912,t45:2.050897442):4.149232764):1.100660635):1.866671941):0.6619151024,t46:9.778828819):1.060656205,((t47:1.804178503,(t48:1.564398286,(t49:0.1379782815,t50:0.05469062612):1.385290509):0.02587726535):0.4929407847,((t51:0.8088678329,(t53:0.4974062526,t54:0.344520499):0.1127305527):0.8166668055,((t55:0.4005058323,t56:0.1114885424):0.7339734489,t57:0.6919779988):0.09188244074):0.3327487193):8.414977335):2.368361122,((((t58:2.339722469,t59:2.328371748):4.929730698,(t60:6.037225243,(t61:4.357124033,(t62:3.708142075,t64:3.368949036):0.6248131342):1.662582985):0.9694129803):0.5306373358,(t65:3.465395884,t66:3.340194976):3.281665516):1.521332666,((((t67:4.458455775,(t68:0.8445989505,t69:0.8030512162):3.429632641):1.316680197,(t70:5.241223004,(t71:1.60487245,((t72:0.3334668362,t73:0.3276938185):1.053996444,t74:1.377671978):0.1367728216):3.550861237):0.2740367513):0.3874664965,(t75:5.331870447,t76:5.222240117):0.3443248274):1.053307754,(((t77:3.229060633,t78:3.172661898):0.1761832967,t79:3.320619643):1.814957003,(t80:0.3591572822,t81:0.313636631):4.765483252):1.382199634):0.8254842907):2.555168607):1.324052233,((t82:3.269544767,t83:3.217386481):5.433155873,(((t84:3.389035706,(t86:2.789829596,(t87:0.5722813809,t88:0.5590879589):2.167188368):0.4734453166):3.620954419,(((t89:3.891454681,(t90:3.724077561,(t91:2.633985901,t92:2.333024777):1.038065328):0.1570939124):0.4022846981,(t93:3.38770843,t94:3.274986809):0.1945975658):0.5187712893,((t95:2.839117345,t96:2.618821602):1.081525339,t97:3.665159101):0.009588871223):1.988695356):0.05527112173,((t98:4.501631118,(t99:4.22467356,(t100:2.880924119,(t101:2.59879046,t102:2.547967773):0.277040454):1.284605304):0.2525887396):0.5794181855,((t103:3.487933203,((t104:1.76171023,t105:1.743164544):1.224314492,t106:2.754716172):0.3651678377):0.003524010324,t107:2.894477154):1.443796317):0.6034060787):1.566448371):2.4431127):2.365588303,(((t108:1.953746294,(t109:0.3468017947,t110:0.3303044365):1.49533814):2.707977593,(((t111:2.620318486,t112:2.495964729):0.8103323712,(t113:2.882690845,(t114:2.292332586,t115:2.283252275):0.2926263635):0.2648826874):0.2968563381,(t116:2.187730159,t117:2.183266457):0.9291371581):0.7657791744):4.859459928,((((t118:1.449511444,t119:1.39148168):0.7081576828,t120:1.348174986):1.390663768,(t121:1.760037092,t122:1.548519696):0.9484719577):2.251174604,(t123:3.622244332,t124:3.517376726):0.9899223178):2.916476536):1.760912698):4.086118205):0.5317307384):0.0752608217,((((((t125:3.4283879,(t126:3.334109488,(((t127:0.6313438568,t128:0.6019930354):1.483172265,t129:2.044145648):1.012190367,t130:2.984737066):0.1786319491):0.0401728309):4.027952566,(((t131:0.2464675972,(t132:0.1249065353,t133:0.01106983099):0.04196768055):0.7433923703,(t134:0.660072021,t136:0.3451706002):0.1186000716):2.792414415,t137:3.057659193):3.315297183):1.962265725,(t139:1.987779589,(t140:1.858426311,((t141:0.1214284114,t142:0.08612727551):0.3095694676,t143:0.3948580359):1.113867911):0.06434734161):5.87818882):1.365681455,((((t144:0.3923109625,t145:0.2571516297):1.557537901,t146:1.675296665):3.543849613,(t147:2.387755336,(t148:2.322291468,t149:2.267861668):0.01941407402):1.987452351):1.223135846,t150:5.466916657):1.968258322):0.2004006668,(((t151:1.372470241,t152:1.353329008):3.93223555,((t153:0.04302109465,t154:0.04118201708):4.34393672,t155:4.326988024):0.5095328099):0.8193177299,(((t156:0.35094615,t157:0.3504542622):5.175771198,t158:5.365112957):0.04738133496,t159:5.287611343):0.0801951199):1.50094494):0.830405571,(t160:1.219028942,t161:1.106924262):6.409001281):1.866776491):0.6666738302,(t162:9.003531399,((((t163:4.982549358,t164:4.958657131):3.056685061,((t165:0.4189724856,t166:0.2881046417):4.294728428,t167:4.539135788):3.295908095):0.1206918903,((t168:0.4294529841,t169:0.3650533236):5.807520876,((t170:4.338548291,t171:4.321366347):0.1636867507,t172:4.46939611):1.662044532):1.712958578):0.4465039016,((t173:4.800385422,t174:4.71949295):1.343317116,((t175:4.313478587,t176:4.066701011):0.6217234324,(t177:2.397548998,t178:2.362753056):2.270031231):1.058003388):1.975149183):0.2905887326):0.5984788395):5.87444038):0.8633461108,(((t179:4.103707504,t180:3.884842249):0.3584871516,t181:3.930599916):2.94727651,((t182:2.686890297,t183:2.482046802):3.266498241,(((t184:3.249182728,(t185:1.699332029,(t186:1.29962509,t187:0.7181371747):0.09701690178):1.504210995):0.5276480336,t188:2.685689082):0.287099531,t189:2.722511092):1.637955277):0.6652176262):7.796659527):0.04837016225,(((t190:2.922302992,t191:2.888326648):0.1462706517,t192:2.985726199):6.74592878,(((((t193:2.856834067,t194:2.807115175):0.9852750077,(((t195:1.946779017,t196:1.897806987):1.106428991,(t197:0.6449507164,t198:0.6041150332):2.328834495):0.5890476033,((t199:2.129242308,t200:1.950276116):0.2992844962,(t201:1.750738919,(t202:0.3228757365,t203:0.08291073304):1.40189878):0.4449114842):1.040719844):0.1414699932):0.9631626872,(t204:1.707374816,t205:1.577784176):2.341762027):0.03770443692,(t206:0.5934171545,t207:0.5111955002):3.151625267):1.743469587,(t208:1.223797652,t209:1.207976533):3.916738021):3.137840935):2.995094371):0.9713933392):0.7408917906):0.09693138576,((((((t210:2.477220683,((t211:2.193371026,(t212:1.229195325,t213:1.124856891):0.9558450324):0.2192376529,(t214:1.976232252,t215:1.928585525):0.2620591689):0.02079018317):0.09718605936,(t216:2.129536539,(t217:1.45775173,(t218:0.7198190868,t219:0.6885866385):0.6914320329):0.6711052076):0.1632259442):0.07678909068,((t220:0.6113429828,t221:0.563169219):0.110895879,t222:0.6196711253):1.50324155):1.829268685,((((t223:0.3305443737,t225:0.2970432585):0.04110212847,t226:0.07284478665):2.282834513,t227:2.259166366):0.7723003953,t228:3.026520457):0.5111261587):7.300079869,(((((t230:1.039670205,t231:0.8265822202):0.2704256866,t232:0.693865611):0.2885961561,(t233:0.5885115153,(t234:0.1096906603,t235:0.09501632134):0.4160009433):0.3787308489):0.4170763962,t236:1.290040515):6.85860427,((t237:0.1749346685,t238:0.01099450751):0.5588034245,(t239:0.08847727003,t240:0.009520766139):0.3620040524):7.353857381):1.730978186):0.9486268982,((t241:4.523291954,((((t242:0.1967641302,t243:0.1325580161):1.129773396,t244:1.243670735):2.919269159,t245:4.021056429):0.1720368372,t246:3.605259707):0.01615715007):3.276072407,(t248:1.494764741,(t249:0.2412976801,t250:0.05960107887):1.15323067):4.968211363):2.604437758):0.1421697545):1.585817788,(t251:2.298186395,t252:2.243675861):8.134683993):3.261803889):2.440448606):0.7143997534):0.09417413655,((((((t253:0.6668456942,(t254:0.3184729483,t255:0.291099254):0.2535260866):4.411524191,t256:4.789760242):2.291024679,((t257:1.92625866,t258:1.877130233):4.267552348,(t259:4.059571598,(t260:2.037335141,t261:1.962271551):1.649356331):2.052754137):0.6917700744):1.596837539,((t262:5.526759098,t263:5.520700652):1.308632817,(t264:6.202268751,((t265:4.111046763,(t266:2.705805091,(t267:0.5484829602,t268:0.4474333013):2.082341995):1.368171405):0.5119600022,t269:4.352749121):1.557965399):0.5512932201):1.063250353):2.495306222,(((t270:3.013804609,(t271:1.727443463,t272:1.720977213):1.229355237):1.675682637,t273:4.593969395):3.872111885,(((((t274:0.8816091866,t275:0.7528779004):4.353293154,(t276:4.152652494,(t277:2.054506566,t278:1.998167946):1.953785939):0.9007301436):1.528153894,((t279:4.638621949,t280:4.318366096):0.6203626904,((((t281:0.8368356656,t282:0.7910090862):2.812760879,t283:3.591493844):0.3829857644,t284:3.774661879):0.4689164491,t285:4.13235216):0.4281566787):0.9552654446):0.9008153397,(t286:4.309726874,(((t287:2.477101252,((t288:1.782778158,t289:1.570386209):0.0001528249143,(t290:1.478990042,(t291:1.322735717,t292:1.257488071):0.1452517665):0.06731391029):0.6908019779):0.2111245258,(t293:1.016222236,t294:0.9782991571):1.316907299):1.255044087,t295:3.521159043):0.02420437039):2.091084579):0.0943076663,(t296:3.991005515,((t297:0.3286168819,t298:0.1434460815):0.2864302691,t299:0.1386947104):3.234472612):1.346373531):0.630544513):1.325821891):2.058407192,(((t300:1.707821672,t301:1.059609393):2.242527669,((t302:1.869052804,t303:1.662051929):0.08636868396,(t304:0.4912155413,t305:0.4816678192):1.179445897):1.305706427):2.82730692,(t306:1.097277991,t307:1.092120639):4.652270116):1.92271016):3.352416438):0.5850705828):0.5556513418):0.2604165856):2.059297066):9.982945429):7.825231906):5.408133335,((((((((((t308:1.400222579,((t310:0.5965124879,t311:0.4678668099):0.3844130588,t312:0.5844511941):0.3549236501):4.06084461,(t313:1.22457573,(t314:1.170879397,t315:1.092568905):0.02442468302):3.674046551):0.8757780657,(t316:0.5816077769,(t317:0.3037706018,t318:0.1701011864):0.05322799939):4.987925052):4.89664822,(t319:8.958461026,(((((((t320:0.1067909259,t321:0.002292520863):0.7172435338,t322:0.6910245449):0.4718066739,(t323:0.5999915251,(t324:0.09475396199,t325:0.009934904962):0.4205736226):0.2149729023):0.3894002858,t327:0.9302018112):1.321500179,t328:2.217182514):0.3811260704,(((((t329:0.1153241528,t330:0.05545012255):0.7869311934,(t331:0.7923415966,((t332:0.4782347735,t333:0.3961258172):0.0602846009,t334:0.3661637551):0.1872557698):0.012394026):0.07809136058,(t335:0.6071666985,t336:0.5616512334):0.001730840974):0.06759118284,t337:0.6122287368):0.4162891646,t338:0.9828583394):1.121656178):1.108768114,(t339:0.9424590194,((t340:0.4214999658,t342:0.3407631219):0.1520038917,t343:0.331494134):0.2197634913):2.254449711):4.428953666):1.098199208):0.05600011654,((((t344:0.5994492673,t345:0.488456173):0.1144421915,t346:0.5901787179):0.5892297795,t347:1.080541707):6.762503039,(((t348:0.4611080131,(t349:0.04172821118,t350:0.005136317654):0.3572284966):0.2066078584,t351:0.4916606483):6.035966605,(t352:5.21597199,t353:5.107208117):1.167992878):1.109845524):0.2396782422):1.519829495,t354:9.088968035):0.06840796661,((t355:2.487708029,(t356:1.601211983,t357:1.563184257):0.4481381411):6.430091632,(((t358:0.8382766648,t359:0.8068375467):0.201722168,t360:0.9755347513):0.3810617793,(t361:0.3498758972,t362:0.3062324571):0.9978248794):6.980944007):0.2155173608):0.3984319044,((t363:2.197800137,t364:2.026779261):1.621192825,t365:3.561703173):4.962024901):0.2734858656,((((((((t366:2.04183901,t367:1.914942246):0.03609631785,t368:1.92350619):2.388841478,t369:4.155134649):0.633261263,(t370:0.1330828862,t371:0.03613421414):4.651691767):0.1672206345,(t372:1.203437935,(t373:0.5797467908,(t374:0.3032747558,t375:0.2496690391):0.1768418589):0.526083143):3.551825734):1.82013536,(t376:5.220426421,t377:4.783640012):1.041765328):0.828046735,(((t378:4.580908077,(t379:2.705712714,(t380:2.131297122,(t381:1.251985688,t382:1.155484774):0.8738677516):0.5720663621):1.792294589):0.6295338868,t383:5.004265848):0.6082490702,(((t384:3.518393643,t385:3.367642003):0.7790612307,(t386:2.584549318,(t387:2.398604383,t388:2.057844456):0.1337137752):1.457085981):0.4458650635,((t389:2.590290009,(t390:1.71402272,(t391:0.4216243666,t392:0.379633442):1.23975468):0.8126830219):0.2002913565,(t393:2.144346794,t394:2.136308426):0.4539791119):1.229121461):0.7187171121):0.7802765683):0.1456963334,((((t395:1.476974192,t396:1.451239985):2.139016053,(t397:2.777601434,((t399:1.521196876,t400:1.50749898):0.5273759262,t401:1.976522347):0.6586010853):0.694827927):0.7172999243,(t402:3.153705385,((t403:2.309997618,(t404:1.407157168,(t405:1.286339952,t406:0.9219494187):0.116860094):0.8554619226):0.627812021,(t407:0.8843948855,t408:0.8753593806):1.600182298):0.1883402236):0.8780202902):0.3223931077,((t409:3.230972305,(t410:0.7436662735,t411:0.6986524406):2.450321732):0.5689509169,(((t412:1.30975934,(t413:0.8400139656,t414:0.7504868825):0.393118673):1.022904347,t415:2.059505371):0.1620218228,(t416:0.8189471697,t417:0.800700349):1.387331096):1.223181327):0.04818764269):0.7946291081):0.6862713192):9.068674292,(((t418:2.849203513,(t419:2.392049921,t420:2.293820313):0.1175348087):8.185123297,t421:10.47338275):2.861210364,(((((t422:1.105955781,t423:1.070570785):1.231062239,(((t424:0.8350736434,(t425:0.4324582996,t426:0.3267789455):0.3979336732):0.2393279762,t427:0.7893895663):0.2341047095,t428:0.905697756):0.9893873859):3.838626299,(t429:5.212279377,(((t430:1.283154764,(t431:1.242280052,t432:1.193228588):0.03400310645):1.32328035,t433:2.548233493):1.37149408,(t434:3.226351112,t436:3.185636273):0.6720395095):1.172967286):0.3534854285):0.9603126877,((((t437:0.08342865677,t438:0.007490466902):0.5462805887,t439:0.480767567):1.376438929,(t440:1.6543161,t441:1.627783196):0.1833540395):0.2014140343,(((t442:0.4022097232,(t443:0.3042566289,t444:0.2842902599):0.09401791701):0.6919657127,(t445:0.8409987276,t446:0.7710354177):0.2186026974):0.4912909204,t447:1.444030139):0.3809839995):3.992618918):2.89378939,(((((t448:0.9486228044,t449:0.9325683617):0.9467048099,(t451:0.4152399654,t452:0.414217878):0.9839285396):0.7920338908,(t454:0.4953447144,t455:0.4351976096):1.335029874):0.05266248569,(t456:1.329901913,(((t458:0.03335827774,t459:0.0121924891):0.1666304481,t460:0.03606549067):0.4562400652,t462:0.06817742208):0.3265165437):0.3230190035):0.03647234347,t463:0.6417572468):5.88364253):3.27554292):0.01970528918):14.93065847):4.184301329):50.77972526,((((((t464:0.5821959031,t465:0.5104194888):0.01048251557,(t466:0.1379186434,t467:0.05998955593):0.2836737601):8.441318211,(((t468:2.171504345,t469:2.013255119):3.903467929,(t470:0.06156634419,t471:0.0465100363):5.821373453):2.332091976,(t472:1.321924774,(t473:0.3961219543,t474:0.3714709344):0.8229680571):6.835490399):0.3020931444):2.659019053,((t475:0.3717657769,t476:0.3609435259):6.564521724,t477:6.915354959):3.770399746):9.063799167,(t478:6.141026644,t479:5.832103065):13.5183496):21.18838424,(((t481:4.046113419,(t482:1.496330903,t483:1.397801956):2.404243462):5.004510986,(t484:4.707228728,((t485:0.2139508359,t486:0.1366556447):3.472936331,t487:3.438047936):0.9363662543):4.030884597):6.831697606,(t488:6.059690664,(((t489:0.2293156103,t490:0.2172538924):1.798076473,(t491:0.3262624978,t492:0.3077035216):1.599940379):3.983126415,t493:5.815729167):0.02595375402):9.164077142):24.39114587):37.75065865);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T10.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
