<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t466:0.2359053257,t467:0.2158260058):8.693238288,(t468:7.088783031,t469:7.009745088):1.637440237):2.712528449,(t470:0.3460000922,t472:0.1346980679):10.70725261):8.745986017,(((((t473:1.264319789,t474:1.051215806):4.668992067,t475:5.695217631):2.089687286,t476:7.780999059):4.16646178,((t477:7.811134935,t478:7.78807407):0.4778877755,(t479:6.917189201,((t480:0.2508134933,t481:0.2226283119):0.04042302317,t482:0.2008118642):6.547571994):1.294603513):3.600587007):3.161967633,(t483:7.166703448,((t484:3.975037595,t485:3.968595608):1.537202455,(t486:0.7331322522,t487:0.6576981844):4.755311281):1.602527457):7.332011172):3.686996231):37.53049988,((t488:28.67930775,t489:28.66747787):18.08284658,((t490:3.639969219,((t491:0.02047696146,t492:0.01739787399):2.066368085,(t493:0.7524647116,t494:0.6889101401):1.176924153):1.519008461):24.56994556,((((t495:1.823352586,t496:1.728262459):2.086596544,(t497:0.480294577,(((t471:0.07957702859,((t439:0.126823391,(t373:0.05383443061,(t369:0.05783292576,((t360:0.008186431956,(((t322:0.04161944457,(t323:0.003486177141,(t319:0.04949182718,(t303:0.2068894272,((t263:0.04846074501,(t253:0.02629789371,(t245:0.08500804565,((t205:0.03828817641,(((((t131:0.1693155491,((((t119:0.06691530988,(((t85:0.1047418539,(t56:0.2147912293,((t43:0.08093945928,((t23:0.2457673137,t1:2.977994188):1.529867147,t2:4.497748357):0.2109043588):0.4410451791,t3:5.064114315):0.8370530471):3.789006561):1.39526911,((((t4:3.110843388,t5:3.067414997):1.254554983,t6:4.224671726):3.723655274,(((t7:3.324980469,t8:3.268643336):0.4558764487,t9:3.523652318):1.725950626,(t10:3.821030329,t11:3.511824319):1.193895453):2.353391364):2.504527674,((t12:3.338528609,((t13:2.397853238,(t14:1.774266655,(t15:1.315566811,t16:1.300539457):0.1656693013):0.5674916228):0.09025945666,t17:1.648062742):0.7534624045):3.753249925,(t18:2.819151156,t19:2.706027201):3.307698179):2.449488628):0.4277819273):0.5524225622,(((((t20:1.548508078,t21:1.487908065):0.1047649334,(t22:0.9092960286,(t24:0.3388108164,t25:0.3292192123):0.0941542316):0.5970099809):2.387338844,(((t26:0.4450455263,t27:0.4181698883):0.8685275023,t28:1.039927239):1.823856816,(t29:2.143238697,t30:1.957659517):0.580943712):0.2348888545):0.1010026275,t31:2.779767324):4.915197392,t32:7.610488169):0.2860056175):1.467927586):1.03279539,(((t33:0.2132092065,t34:0.1737978415):0.3622628485,t35:0.3437458096):4.232521268,(t36:3.856239738,t37:3.759404803):0.714608145):5.497908188):0.03180124543,((t38:0.5633585174,(t39:0.388214045,t40:0.3274330974):0.0785280301):9.124988571,((t41:1.206438576,t42:1.054613141):5.501958521,t44:6.23986539):2.802093868):0.2955208731):0.0707182213,(((((t45:0.2013273673,t46:0.1833576724):3.528902002,((t47:0.829915815,t48:0.7904752166):2.499673263,((t49:1.635788766,t50:1.304093388):1.481524574,t51:2.675083518):0.1715454735):0.3143516051):3.336211487,(((t52:1.55974629,(t53:0.1934712088,t54:0.181655659):1.307690427):0.007656567382,(t55:1.381344828,(t57:0.5821902501,t58:0.4869492138):0.3028122541):0.01615129675):2.818265939,(t59:2.430252238,t60:2.345671003):1.132627232):2.021176314):0.1097541161,(t61:1.510563027,t62:1.358086475):4.02922137):0.4679382279,(((t63:3.138391683,t64:2.992380302):0.7593418392,(t65:2.77901158,(t66:1.770259542,t67:1.736079342):0.8859096567):0.9395555484):1.554956311,t68:5.112832798):0.1009425104):1.744111302):0.3958680887):0.4128339315,((t69:6.037429452,t70:5.93132693):0.9790538037,(t71:4.206350519,t72:4.07475669):2.503917355):0.5897867503):0.5942623699,(t73:5.408582573,(t74:1.901181288,t75:1.828746566):3.329632239):1.80111596):0.1612315247,(((((t76:0.4100919799,t77:0.3807624118):0.7513658908,t78:0.8572639973):2.290926148,t79:3.09390851):2.045118186,((t80:2.701728407,t81:2.641187895):2.124806342,t82:4.758127473):0.1247132191):1.119049398,(t83:4.587567386,((t84:1.900381535,(t86:1.323885295,t87:1.093891671):0.3829569018):0.8775466515,t88:2.243942778):1.76474106):1.378708566):0.3471875221):0.8532575673,(t89:4.845473676,t90:4.714344322):1.73322734):3.877994571):2.944390921,(((((t91:2.263657127,t92:2.228418793):0.8868799791,((t93:0.2602366863,t94:0.2006985933):2.541307986,(t95:2.347855802,t96:2.222020065):0.2973647667):0.08382872291):7.751022208,(((t97:1.848421544,(t98:0.2384391797,t99:0.1612981127):1.523273414):0.2151854208,((t100:1.265396549,t101:1.087381898):0.4376269076,(((t102:0.5549282644,t103:0.4061475418):0.2885967037,t104:0.5323661238):0.1252960585,t105:0.5861612919):0.4904884154):0.08385057618):1.979400393,((t106:2.10346142,t107:2.049137631):0.5286499926,(t108:1.604941151,t109:1.542242254):0.9139164783):0.4665305486):6.20678102):0.4254157578,(((t110:1.290863795,t111:1.283318055):0.8464684603,t112:2.076509953):1.570113669,t113:3.589577308):5.800515767):1.510178038,((t114:2.845949884,((t115:0.3538081938,t116:0.1530658173):0.568394923,t117:0.7101870023):1.689382826):5.757556761,((t118:1.873205002,t120:1.308685201):0.5688843287,(t121:1.019437671,t122:0.8981702848):0.7550525513):5.675353163):2.14645514):0.4093177469):0.946745356):0.9620538627):1.004076085):0.8668601574,((((((t123:0.3736121973,t124:0.2340475002):3.01718576,(t125:2.976499186,(((t126:0.1963678964,t127:0.123454571):1.255440362,(t128:0.1308059037,t129:0.1210632027):1.178579703):0.6207939659,((t130:0.9003519211,(t132:0.3262692554,((t133:0.09496456307,t134:0.04894749882):0.04786689006,t135:0.01839256892):0.1169845903):0.2271141895):0.1973915997,t136:0.5507365989):0.7335467703):0.7792133076):0.1557374746):0.2080418837,t137:2.336524472):2.144581317,((t138:1.125442653,t139:1.036047928):1.10762736,t140:2.084702537):2.174775897):5.359783785,(((t141:3.605383793,(t142:1.379933059,((t143:0.7777149828,t144:0.6968777516):0.5366503956,(t145:1.013667035,t146:0.9619251381):0.08667405875):0.03821787868):2.151950681):1.071837697,t147:4.202642799):3.917092833,((t148:2.451865589,t149:2.250262825):3.764572037,t150:5.996363918):1.754684829):0.9963489288):0.6482196047,(((t151:5.561247406,((t152:4.390648587,((t153:0.7248480232,t154:0.5858558025):1.097360786,(t155:0.1128413771,t156:0.02153830657):1.411637924):2.508539856):0.4494274107,t157:4.327429164):0.7129331098):2.410558029,((((t158:0.4686096651,t159:0.3085827437):5.017998214,(t160:4.254701881,t161:4.187686676):1.068980893):0.2427122003,(t162:0.1339471985,t163:0.07367088293):5.304712923):0.3369223958,(t164:4.795652021,t165:4.75847108):0.9144222197):0.9854355954):1.009270056,(((t166:4.998537796,(((t167:0.05463250509,t168:0.03664950809):1.335084978,t169:1.358226814):3.246254641,t170:4.56009956):0.1379119344):0.5976848992,(t171:4.82169386,t172:4.498791525):0.4123686535):0.5995668951,t173:5.308985773):1.436815224):0.408702572):1.733668305):3.156703005):1.554274957):0.4640940669):0.01426734973):1.237849572,(((t174:7.003086098,(((((t175:3.949805467,t176:3.639150389):1.147029503,(((((t177:2.252547213,(t178:2.084130382,(t179:0.6329953372,t180:0.4772417284):1.407719135):0.1113393749):0.1297094799,t181:2.086534541):0.5236355858,(t182:2.189926959,t183:2.18197481):0.3427674519):0.7292228899,t184:3.142632955):0.6750438423,t185:3.802874649):0.4314463277):0.1670186398,(t186:3.436683318,((t187:1.900398627,(t188:1.77122806,t189:1.67340568):0.0722786806):0.9631712226,t190:2.609080188):0.4192275871):0.9526477272):0.3908487817,((t191:3.914433028,(t192:0.8838613518,t193:0.8588444237):3.025216834):0.3374496013,((t194:0.404239491,t195:0.3551055583):2.802321419,t196:3.135391377):0.9893142506):0.08775525904):0.7532682054,(((t197:2.844703202,((((t198:0.1374307729,t199:0.1062415245):0.8251309898,t200:0.8799729038):0.5556138193,t201:1.414978556):0.9950033969,(((t202:0.5951725437,(t203:0.5553263588,t204:0.549142057):0.01366627383):1.457471814,t206:1.829816955):0.1121747838,t207:1.886909382):0.0695541608):0.3037657921):1.133134646,(t208:2.74055089,((t209:1.320971681,t210:1.235941458):1.290221645,t211:2.366896397):0.03973181432):0.6500893095):0.101351625,(t212:0.3746787547,t213:0.2847682675):2.586808404):0.721684182):0.5177503266):6.568598448,(((((t214:0.4197726075,t215:0.3240070988):1.842207089,(t216:1.898590596,t217:1.863800987):0.02556121507):0.3240711482,t218:2.161709407):1.029637853,(((t219:1.719008393,t220:1.45796757):0.07808657,((t221:0.1133584772,t222:0.06765995606):0.9253885273,t223:0.9084657089):0.477394142):0.07020870411,t224:1.356220666):1.321273072):6.75012054,((t225:3.414298175,(t226:1.66812293,(t227:0.1841151586,t228:0.1666952536):1.45799543):1.736694033):0.3539219173,(t229:1.358897234,t230:1.336019707):2.272728591):5.408437797):0.2734791916):1.143845334,((((t231:1.296098708,(t232:0.2927059142,t233:0.2785272423):0.9953465349):0.09712834861,t234:1.081043588):1.723421435,(t235:0.8820018423,t236:0.7646870863):1.893971513):3.127976718,((t237:1.235143625,t238:1.220056829):0.3026491942,t239:1.228487042):4.122742658):3.970553785):0.5814590492):1.228009021,(t240:1.984035533,((t241:0.9804824854,t242:0.9421775427):0.829830871,(((t243:0.1659954945,t244:0.1152920807):0.6220850174,t246:0.3420530244):0.3332835209,t247:0.575661405):0.593128906):0.1067641462):9.110734894):0.4937315099):0.560167143,(((((t248:0.7376777717,(t249:0.286704856,t250:0.1966051744):0.3814004097):6.015610951,t251:6.407398376):2.055602189,(t252:3.526215955,(t254:0.7293597614,t255:0.6441106215):2.541497735):4.723981086):1.866508779,((t256:2.482798863,(t257:0.8909554023,t258:0.8818557293):1.56863609):5.941830856,(t259:3.079865941,(t260:1.726807731,(t261:0.3977483842,t262:0.3196509104):1.304476035):1.283841731):5.009653687):1.270624133):0.13087256,((((t264:1.494198545,t265:1.491749744):4.843457704,((t266:1.826681222,(t267:1.627715367,t268:1.504266981):0.06670311004):2.854961191,t269:4.39332008):1.508438326):0.9377986658,(t270:4.687057377,(((t271:0.7900103912,t272:0.7502726926):1.116379582,t273:1.68077559):2.172997617,t274:3.8497369):0.5374324055):2.147407209):0.05198148321,(t275:5.313848093,t276:5.250452425):1.210300952):1.729338152):0.4039744091):0.05583694341):0.6308944198):5.499106373):1.356615957,(((t277:6.913154817,(((t278:5.807121535,(t279:0.1881743943,t280:0.1756393326):5.568175496):0.5410244406,(t281:2.292355075,((t282:0.4185902469,t283:0.2828673904):0.325356594,t284:0.3941755821):1.168178956):3.901947661):0.2705443674,(((t285:1.229704687,t286:1.171378864):0.7916851063,t287:1.90635923):0.5516552503,(t288:0.3313919874,t289:0.3073638948):2.121939394):3.069365791):0.2285976711):4.472035417,((t290:6.345745722,(t291:4.250049349,t292:4.18488802):1.970726879):2.504143414,(t293:6.679414345,t294:6.655473035):1.896085529):1.098422915):3.028771939,(((((t295:1.514584378,t296:1.471596958):1.558771534,(t297:1.440034969,t298:1.0495117):1.585828866):1.470942481,((t299:0.151980869,t300:0.1303308681):2.476462939,(t301:0.154676173,t302:0.1025311198):2.351235678):1.085455624):0.8629584131,(t304:2.019713394,t305:1.71394505):1.962974963):6.265595676,(t306:5.853744654,t307:5.832667909):4.043214902):0.9796529):1.697982251):2.256405725):0.9326749257,(((((((((t308:1.009229637,t309:0.9775165423):0.6506760938,(t310:0.6220483799,t311:0.5269186684):0.9713746159):1.006579773,t312:2.403267811):1.148027575,(t313:3.328951113,(((t314:1.320770929,t315:1.29610817):0.4322519446,(t316:1.489843169,t317:1.382955785):0.2078076769):0.1007100129,t318:1.450106645):1.36364262):0.1686173794):0.8164953207,(((t320:1.206043176,t321:1.063380365):0.1710982274,t324:1.151403751):0.5476688804,(t325:1.366061398,t326:1.168873404):0.2905466431):1.454379859):0.3559389295,(((t327:1.476190765,t328:1.324178397):0.2030323767,(t329:0.6615101419,(t330:0.04278709099,t331:0.02867481497):0.4674189754):0.8417355374):0.9105007404,((t332:1.019161626,t333:0.8806272634):0.4576983631,t334:1.273527006):0.5799151097):0.6001389637):0.7727880549,((t335:0.4626003851,(t336:0.2428798407,t337:0.2267129939):0.1646354898):0.05673409563,t338:0.3896365716):2.410372064):1.68381226,t339:4.351151977):5.362981078,((((t340:0.419326659,t341:0.393242133):0.5310990725,(t342:0.1266660082,t343:0.003761580842):0.6950531317):4.467617886,(t344:4.821486766,(t345:0.4514199015,(t346:0.4161712843,(t347:0.1660806263,t348:0.1482373985):0.1836435732):0.03264786772):4.124142389):0.3252866759):1.676373102,((((t349:0.394496205,t350:0.389640183):0.1467483017,t351:0.4180878921):0.4965502764,(t352:0.06897487937,t353:0.04180364384):0.7998030802):0.3420664447,((t354:0.4164118625,t355:0.3215884411):0.4486963705,t356:0.7556319941):0.296809657):4.987938104):2.525403172):2.893945059):0.1727647625,((((t357:1.153935941,t358:1.128727788):0.5710345296,t359:1.667602058):0.4857472281,((t361:0.5817804025,((t362:0.2632658226,t363:0.172132297):0.1428776329,t364:0.2238711129):0.1633375202):0.4173562659,t365:0.7912955026):1.122736014):0.4799578376,(t366:0.3281630924,(t367:0.2297283326,t368:0.1743887964):0.02822526875):2.043658796):8.860190428):1.391658946):3.324346544):6.839162275,((((((t370:1.107603276,(t371:0.2543393992,t372:0.1761122135):0.461417359):5.190416396,t374:5.670252444):1.899371655,(t375:4.812925628,t376:4.752530487):2.692523237):0.2822516433,((((t377:0.6999454618,t378:0.5902864559):1.813569878,(t379:0.2428362545,t380:0.2164507894):2.127095358):3.448984589,t381:5.768332421):1.631247822,(t382:6.182881338,t383:6.143604338):1.131199575):0.1275626268):9.986509019,(((((((((t384:4.584925392,(t385:3.081570319,t386:3.000539823):1.461624235):0.4081862803,t387:4.782411266):0.3303187388,((t388:0.3966399116,t389:0.3863177189):1.066756294,t390:1.312686754):3.641067355):0.3049307737,(t391:4.523225323,(t392:4.202410838,(((((t393:0.3673719888,t394:0.1548712881):0.3856935781,t395:0.5343190613):1.754486446,t396:2.02517953):0.09712998178,t397:1.965670772):0.8895605545,(t398:0.5703101111,t399:0.5055352588):2.279745759):0.3867035914):0.3163635325):0.6299586508):0.5624672908,(((t400:1.765698232,((t401:1.34526758,t402:1.310119032):0.1182649569,t403:1.358158488):0.1964212392):1.293545984,(t404:2.431983858,(t405:1.835586739,t406:1.786189544):0.5817179368):0.4161041749):1.579997629,(t407:3.898740657,(t408:0.9993291138,(t409:0.9016635645,t410:0.8944613569):0.03929404781):2.882908757):0.0820585436):0.01302525055):1.232122989,t411:5.124406136):0.7933731998,t412:5.856610719):0.4969103469,(t413:3.954148758,(t414:2.115561509,(t415:0.6694782767,t416:0.654636086):1.444248797):1.70351195):2.353766153):6.258910944,(t417:7.115016325,(((t418:2.447717124,((t419:1.071241287,t420:0.857567976):0.7103364655,(t421:0.07461155192,t422:0.07460187874):1.430724121):0.4374971757):0.6279787431,t423:2.519261405):1.387484897,(t424:1.474634513,t425:1.437742137):2.319143847):2.584657157):5.262953534):2.36304534):0.2771695009,(((((((t426:1.13672126,(t427:0.7149733722,t428:0.5131607091):0.3839356567):1.761035667,(t429:1.800911571,(t430:0.7487977749,t431:0.7240791094):1.026686512):0.800309053):0.2658917855,(t432:0.4864449162,t433:0.3457953367):2.222706573):0.6368626304,((t434:2.114563919,t435:1.701913187):0.6948881304,t436:2.357614545):0.3106123509):0.2625385853,((t437:1.937219999,((t438:0.895816738,t440:0.3577998515):0.06393102147,t441:0.4079978246):0.8160812658):0.9284883585,t442:2.075039357):0.05276284576):0.1038952126,(t443:1.614449999,((t444:0.7608657087,(t445:0.4408457238,t446:0.3120948971):0.2771735227):0.3480479541,t447:0.9200724564):0.3190562558):0.545328042):9.619300882,((((t448:0.6757164446,t449:0.6661065321):0.5968883653,t450:1.254923365):0.8390364548,((t451:0.2973458041,t452:0.2509376165):1.075312505,(t453:1.035016311,t454:1.023438198):0.1927915076):0.13963755):9.089454231,((t455:0.2076296794,t456:0.1805753504):0.3753679063,t457:0.5497926232):9.71784696):0.1715296131):0.358222211):3.583740953):6.337822131,(((t458:0.566739413,t459:0.5608778741):2.022630077,t460:2.505520783):3.267942889,((t461:1.51387107,t462:1.382769705):0.5106627191,((t463:0.3345640422,t464:0.1775813581):0.1831579444,t465:0.007924767878):1.364745981):3.703277414):14.81430725):10.83482695):18.52505293):8.798471782);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T11.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
