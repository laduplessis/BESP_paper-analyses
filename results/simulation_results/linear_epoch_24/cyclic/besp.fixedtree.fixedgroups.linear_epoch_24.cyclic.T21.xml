<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t486:3.383469671,(t487:2.208942428,t488:2.024312482):1.062939748):2.394131576,t489:5.469675874):139.6225647,((((t490:8.678259735,((t491:6.339665482,(t492:0.2912491466,t493:0.1237241564):5.978506689):1.763631377,((t494:6.255123288,t495:6.224707127):0.8965895828,t496:6.960479472):0.4355669429):0.5296241232):7.334902498,(t497:6.702966087,((((t498:4.941298379,(t477:0.08141446527,(((t413:0.05923187682,(((((t346:0.05060451701,(t336:0.1606280905,((t290:0.07528160087,((t275:0.1052217285,(t247:0.09324611944,(((t194:0.01203436703,((t178:0.046152096,(t173:0.08774652513,(t168:0.0865222831,((t104:0.2777912785,(t86:0.02744509102,(((t78:0.01309288461,((t60:0.05825040389,((t1:0.7843736412,t2:0.705451355):2.318987627,(t3:1.86963753,t4:1.832293461):1.124465688):1.635051649):0.3107645093,(t5:3.610078892,(t6:3.307806988,(t7:2.774367023,t8:2.733618431):0.4692146719):0.2660637248):1.288171283):1.059624315):0.6996573789,((t9:2.764958204,t10:2.697267705):0.9023001621,t11:3.57525005):2.838365467):0.06162707523,(t12:5.354217412,(((t13:2.611353595,t14:2.559773654):1.520065157,(t15:1.436194536,t16:1.395365001):2.635547975):0.592663681,(t17:4.189800662,(((t18:0.3175929742,t19:0.1889701014):1.405273232,t20:1.557683108):0.7471091059,(t21:1.108386699,t22:1.10679396):1.124425743):1.659710773):0.1798713798):0.5311644141):1.115594617):0.2863911971):2.013428715):2.601293495,((t23:2.936729326,(t24:1.784745744,t25:1.695214538):0.9800805881):2.513550059,((t26:1.07914409,t27:1.031199005):3.350381492,(t28:1.633559937,t29:1.568913698):2.728634082):0.749097798):4.864341584):1.683872726):0.7093192152):0.4941830614):0.5465952713,((((((((t30:2.386996393,(t31:0.3820932686,(t32:0.2508650958,t33:0.01552945612):0.1082280749):1.909880473):0.5786973619,((t34:1.643715489,t35:1.596595762):0.7772281516,(t36:1.48635362,(t37:1.184728628,t38:1.169993181):0.2846888609):0.848036972):0.1022708538):0.08511847718,t39:2.31983292):2.091774726,(t40:0.5856795742,t41:0.5134176409):3.800280585):1.911525298,(t42:1.529794435,t43:1.509632909):4.578969727):2.207065674,(((t44:0.3894833283,t45:0.3548618628):1.075366368,((t46:0.6979118409,(t47:0.4787953696,t48:0.4171980917):0.02001285748):0.287475427,(t49:0.2681009465,t50:0.235391157):0.4496422453):0.3830023776):2.882248724,((t51:0.4342744939,t52:0.3860563983):0.2498407412,t53:0.5500578288):3.084866641):3.850518993):2.227479876,(t54:5.719546826,(t55:2.082453227,((t56:0.2982780656,t57:0.2205468059):0.4979689947,t58:0.5987807209):1.272365973):3.552267486):3.687051256):1.400219489,(t59:0.8263462442,t61:0.4333497473):9.62729809):0.3801510306):0.9116430993):0.6245617473,(((((((t62:0.3871521735,t63:0.3744251574):0.2855266785,t64:0.6193752471):0.4084900473,(t65:0.1057272031,t66:0.0878662899):0.8159138254):2.069246498,(((t67:0.2181661973,t68:0.1719146754):0.2729354741,t69:0.4164928467):0.5918316568,t70:0.9324639328):1.778529707):4.365818484,((t71:0.5685447329,t72:0.5320686312):0.1677114517,t73:0.6092757542):6.248052864):2.485554057,(((((t74:0.1555929497,t75:0.0535922107):2.532323541,(t76:1.10233251,t77:1.020052334):1.455456576):3.743315533,(t79:3.208613303,t80:2.840836817):2.949035405):0.6558869483,((t81:5.496935727,(t82:1.101762528,t83:1.051668113):4.392652116):0.7065746396,(((t84:1.640226374,t85:1.516726033):2.834762726,t87:4.192846752):0.4172882569,((t88:1.184920253,t89:1.184552435):0.839113609,t90:1.659571437):2.515626144):0.9732954552):0.1784529831):2.063204713,(t91:6.785731234,(t92:5.049283883,((t93:2.482566678,t94:2.462952754):0.08223270502,t95:2.458356068):2.327592969):1.713779861):0.5844023976):0.1579389586):0.05494731745,(((((t96:3.801439094,(t97:2.194508921,(t98:1.547306358,t99:1.464506888):0.5200932225):1.515460463):1.361673736,(t100:4.64706925,t101:4.562820847):0.1356425712):0.4292325134,(t102:2.300594925,t103:2.090867113):2.594422464):1.379338305,(((t105:2.928727564,t106:2.896160494):2.425565573,((t107:3.659864234,t108:3.631730342):0.3586804016,t109:3.881808666):1.266760048):0.3665421393,((t110:3.764695808,t111:3.756718194):0.2480855741,(t112:2.192608011,t113:2.028870981):1.772329839):1.381064791):0.03081882576):0.02245922913,((((t114:0.3236812681,t115:0.3126804845):0.9757412734,t116:1.196216124):0.3036879252,t117:1.47744881):0.9625105435,t118:2.400088786):2.60375859):0.275455722):1.501769897):2.997917634,(t119:2.120998667,(t120:2.006712553,t121:1.97427564):0.07887414337):7.623994906):2.621697922):3.140593078):0.8661944251,(((((((t122:0.5704955198,(t123:0.4982558068,(t124:0.03019904478,t125:0.02375205226):0.4447378133):0.004501297792):4.322497953,t126:4.759347602):0.9216622232,(t127:1.937377983,t128:1.911536169):3.690383126):0.8945707652,((t129:0.05146393216,t130:0.009843550051):2.543350109,(t131:1.542940254,t132:1.458638002):0.9505055609):3.850651275):1.79089047,((((((((t133:2.049895191,t134:1.975721336):0.4973464581,t135:2.311199752):0.6755243409,t136:2.880830242):0.8119868183,(t137:1.957895469,(t138:1.03441294,t139:0.9738546747):0.8732113369):1.699787285):0.1874255134,((t140:0.3346913443,t141:0.2797196549):2.210150232,(t142:0.9036249992,t143:0.8996830032):1.326435946):1.073718858):0.1985872872,(t144:2.879227,t145:2.859938959):0.392364568):0.9805587622,(((t146:0.1527318222,t147:0.1247698547):0.230273556,(t148:0.1322745533,t149:0.08479967403):0.1895685044):1.925201892,(t150:1.042368842,((t151:0.3942118734,t152:0.3688606359):0.5872675621,(t153:0.5920875731,t154:0.5900706464):0.282717832):0.0003264385559):1.128926493):1.793447586):2.561733978,(((t155:1.166366803,t156:1.029778549):1.283901447,((t157:0.5530987552,t158:0.550998653):0.7037813663,t159:1.247449504):0.991562228):3.177612458,(t160:2.394072482,((((t161:0.1019730759,t162:0.07741627844):0.1747867132,t163:0.2177035275):1.383349642,t164:1.34053751):0.06358775284,(t165:0.346849212,t166:0.2534710798):0.8463468014):0.659328396):3.01314291):0.67382373):0.02341109128):3.75797353,(((((t167:0.3676665917,t169:0.0712992212):1.179195356,t170:1.007080217):0.9479546288,t171:1.728725621):0.7973087663,t172:2.471104982):1.966468671,((t174:3.175173613,(t175:2.761790706,t176:2.759954707):0.3569411466):0.6835657154,t177:3.793429453):0.200112398):3.867635038):2.400770709,(t179:9.725493888,((t180:8.017568169,(t181:0.3757614275,t182:0.3029051997):7.571107051):0.0774756533,t183:7.883803324):1.513086069):0.2688662406):1.638162814):0.6275831082):3.237105726,((((((t184:6.401178986,t185:6.250027053):1.98038714,(((t186:0.4190446966,t187:0.2456318432):2.48289083,(t188:1.599741178,((t189:0.1449575647,t190:0.08172857612):1.314215507,(t191:0.3328733595,t192:0.1859687135):1.033201413):0.08964091142):1.047250178):5.294955962,((t193:6.451513179,((t195:0.7351726684,(t196:0.2269708978,t197:0.226752633):0.3515817314):0.07657739104,t198:0.4125242307):5.431581716):1.139293012,((t199:0.9000151772,t200:0.7646454373):3.172927097,(((t201:0.4329356598,t202:0.1997631076):0.1230261378,t203:0.3214113388):2.069647717,t204:2.315115104):1.125368351):2.791409795):0.05712587911):0.007901742491):1.05657087,((((t205:0.5886937315,(t206:0.4036139127,t207:0.3942145787):0.08293953697):2.542325609,t208:3.018060424):2.242731778,((t209:3.024691718,(t210:0.7484619861,t211:0.7225800163):2.257265608):0.7053488069,t212:3.644783237):1.491755219):1.409631467,t213:6.505185905):0.4808503834):0.7101027332,(((t214:6.156788343,(t215:3.75929492,((t216:2.153313566,(t217:1.531818445,t218:1.465545819):0.2808108379):1.296215686,t219:2.68419358):0.307315949):2.312816342):0.4110216503,(t220:1.150533117,t221:1.080435093):4.074675184):0.6256778066,(t222:4.4383083,t223:4.197984015):0.9716084384):0.3620417493):0.2684331626,((t224:1.6116429,t225:1.581075589):1.189841407,(t226:1.723162628,t227:1.694355876):1.042845815):2.941853542):1.019809877,((((t228:2.194789368,t229:2.194426543):1.693029715,(t230:2.761540616,(t231:1.057493167,t232:0.9690978944):1.518680659):1.076625061):0.9659957649,t233:4.206626358):1.001963315,((t234:1.546604804,t235:1.525028048):2.268057886,((t236:1.630258498,t237:1.348426796):1.774321703,t238:3.032497424):0.2357061578):1.273689449):0.8353084554):3.602258252):0.7066412691):0.610735341):0.0296861142,(t239:2.664209281,t240:2.630499371):7.449069882):2.545245838,(t241:2.224120325,t242:2.06013975):10.06288264):0.9733235947,(((t243:1.318765428,t244:1.290967073):0.07831073378,(t245:1.042558458,t246:1.041883334):0.2589717782):1.293822629,t248:2.382071442):10.3077443):3.066591761,((t249:3.987633265,((((t250:1.189871462,t251:1.150701494):0.9612880692,((t252:0.6101373043,t253:0.5439259988):0.4119484459,t254:0.8099445419):0.9550833981):0.7137502823,((t255:2.148481842,(t256:1.595271017,t257:1.373255422):0.398597196):0.02642175883,((t258:0.9046734329,t259:0.8989026681):0.6876830119,t260:1.436233583):0.2013913257):0.2747719224):0.8965910337,(t261:0.5380837723,t262:0.390652185):1.89707765):0.2053337681):5.74370532,((t263:1.365632731,t264:1.360949701):4.911281537,(t265:0.1355735384,t266:0.05123904335):6.122229156):1.844418036):5.87592998):0.2780008642):1.260859217,(((((((t267:0.3123238568,t268:0.0931017419):0.214583112,t269:0.2002238178):0.2777352842,t270:0.3059792033):3.403480192,(t271:2.499709688,t272:2.082117125):1.184124062):5.080376243,(t273:0.2574581089,t274:0.2350599687):8.025787868):3.54705159,((((t276:0.6853640101,t277:0.6303555167):0.2044681613,t278:0.7959631739):3.288985843,t279:4.00281628):3.757412168,((((t280:1.328195727,(t281:0.9285288237,t282:0.858387362):0.3449288619):4.87565729,((t283:1.791428366,(t284:0.336226675,t285:0.2188745292):1.328015519):3.648900809,t286:4.969950317):0.3788727041):0.364918645,t287:5.475844388):0.9899460322,(t288:3.242299057,(((t289:0.2620906942,t291:0.1606988148):2.680998419,(t292:1.958164356,t293:1.749923537):0.8550787194):0.2612201195,(t294:0.9471001557,t295:0.9355680255):1.334364325):0.01760482234):3.219465408):0.1764460918):3.616394277):1.017338991,(((t296:1.357644005,t297:1.31832981):4.549014173,(((t298:0.3479577341,t299:0.29071543):4.872237154,t300:5.11054228):0.3256105416,((((t301:0.4849648051,t302:0.3814772157):0.2903429494,t303:0.4893676206):1.687070668,t304:1.874024975):2.630876592,(t305:1.601346404,(t306:0.7595337397,t307:0.7451850116):0.6294786885):2.865923876):0.1524392159):0.2972699209):0.03911911258,(t308:3.291363747,t309:3.268595898):1.234624827):4.370134665):1.541822786):1.800477855,(((((t310:0.214728145,t311:0.1192935073):0.8741241156,t312:0.9409569305):2.313082969,t313:3.141318207):4.071826205,((((t314:2.531224652,t315:2.336217697):0.9880345854,t316:3.312304568):1.152573307,t317:4.444872585):1.400100488,((((t318:0.6384345997,(t319:0.5553208507,t320:0.553079208):0.06148628605):1.453305873,t321:2.061766038):1.406319718,(t322:1.348856709,t323:1.301296636):2.104837554):0.9486800673,(((t324:2.144284262,(((t325:1.639988304,t326:1.610082823):0.1990563842,t327:1.776151813):0.0219132652,t328:1.700328759):0.2684092398):1.682475267,(t329:2.87409983,(t330:1.901486411,(t331:0.963874986,t332:0.9596083509):0.867866592):0.9074689686):0.7758625049):0.0939448738,(((t333:1.703198924,t334:1.565843771):0.561925547,t335:2.075005074):0.121621127,(t337:1.121215113,t338:1.088200668):0.7888899462):1.161365483):0.4023948932):1.390050139):1.128208217):3.741496057,(((t339:0.4636332228,t340:0.4388514797):4.026590473,t341:4.3990548):3.124646195,((((t342:2.066226737,(t343:1.298057621,t344:1.290431177):0.6879564112):1.146699639,((t345:2.686878237,((t347:0.5460932524,t348:0.4150916137):1.215096515,t349:1.290802052):0.7428057872):0.05607238853,t350:2.077016781):0.3308033444):0.814154273,(t351:1.27798567,(t352:0.1920567168,t353:0.1802205316):0.7889244523):1.902213877):0.09920801759,(t354:2.289669542,t355:2.044064345):0.5717345668):3.292891819):2.00353046):0.8170110109):3.640672596):7.729172206):1.515238726,((((((t356:0.6407830332,t357:0.5586622859):3.450646898,(((((t358:0.9572478638,t359:0.5733519232):0.6895972803,(((t360:0.2823315576,t361:0.2570371262):0.4095990799,t362:0.6480300364):0.2046018005,(t363:0.5635321873,t364:0.3652060573):0.2350203471):0.3003331028):0.3170132052,(t365:0.4466143139,t366:0.1604466797):0.628989406):1.372951946,((t367:1.879962872,t368:1.826666842):0.04251879719,(t369:1.664770495,t370:1.634868653):0.1913769379):0.1291917062):0.4119731699,(t371:0.8827062596,(t372:0.6991916725,t373:0.4044164673):0.1716707716):0.8445486144):0.2114048531):4.983463774,(((t374:0.7374558154,t375:0.7274708672):0.2584432632,(t376:0.5043519391,t377:0.4581841826):0.4493474054):1.858519393,t378:2.660956621):3.743061106):0.7474893191,((t379:0.5460438565,t380:0.5107232401):2.251043981,t381:2.702766319):4.317532305):1.67490365,((t382:7.389553478,((t383:0.8506892062,(t384:0.1932584428,t385:0.1131856501):0.5624121023):2.827084804,t386:3.472007932):3.707905169):0.9786162866,(((t387:0.2260763645,t388:0.2193120601):0.5354505106,t389:0.7360278478):0.2948829139,t390:0.8376967247):7.054566668):0.3136769706):2.341096043,(((((t391:1.406389002,t392:1.215640315):5.101705247,(((t393:2.443822791,t394:2.42321236):2.376480222,(t395:0.7488957403,t396:0.7267914654):3.741178514):0.779482978,t397:5.180724256):0.6065305217):0.5836402249,((t398:0.9974377468,t399:0.7438500878):4.573588458,t400:5.170199429):0.6958657849):1.43437033,(((t401:1.851454379,t402:1.666473439):2.110910943,t403:3.659194182):1.928103595,((t404:0.202077685,t405:0.1684954847):4.814646614,t406:4.947796471):0.5582179353):1.380210346):0.09281202683,t407:6.962085515):1.858726615):7.732317543):0.02132026296,(((((t408:0.1055578457,t409:0.102054017):1.614500956,t410:1.562162865):5.231017839,(((t411:2.88109426,t412:2.758032525):1.035928361,((t414:1.109067565,t415:0.94212094):2.154481976,t416:3.021546963):0.2969436964):2.050312258,(t417:3.635110326,t418:3.52699694):1.725811687):0.7278591122):0.2839830752,((t419:5.612028861,(t420:3.904062754,(t421:3.151312949,(t422:1.593254844,t423:1.524466354):1.480036606):0.7195015394):1.626163196):0.3617235245,(t424:3.188745276,t425:3.038950503):2.264610901):0.2900731125):8.552605684,(((t426:2.496944547,t427:2.437576767):0.05052914734,t428:2.482914838):2.583064378,(((t429:1.505315576,t430:1.471723416):2.269702148,t431:3.72919863):0.8166497245,t432:4.428341251):0.4667299237):9.000800509):0.7485187976):0.06377347452,((((t433:3.541607285,((t434:0.6459579767,t435:0.3412381919):2.435847265,(t436:1.926245701,(t437:1.329751201,(t438:0.7432760683,t439:0.6965561563):0.5455652427):0.5570687174):0.6683922534):0.4520620721):2.009468757,t440:4.86315748):1.160384169,(((t441:1.502362214,(t442:1.119014974,t443:0.8092281202):0.2002008987):1.757571635,(t444:1.288755889,(t445:0.9354737921,t446:0.4981093592):0.3256727257):1.45432309):0.7994361673,((t447:0.8921615613,t448:0.8411854516):0.9438052688,(t449:0.405316134,t450:0.2661498189):1.356887916):0.9364438991):1.951208996):0.6779866392,((((t451:0.2631780707,t452:0.2202514337):0.2971131657,t453:0.3624639918):1.092328038,t454:1.387540839):1.227111732,((t455:1.360790598,(t456:0.2675995696,t457:0.1892195171):0.9017712189):0.9805405226,(t458:0.4216317152,t459:0.2892379504):1.645805356):0.2322610237):2.301200144):7.243684782):0.07127321975):8.431787417):5.046280454,(((t460:6.479898194,(((t461:0.7528133233,(t462:0.446503775,t463:0.440629442):0.2908270775):2.376557535,(t464:1.498592565,t465:1.405429991):1.550734404):0.8293976032,(((t466:0.2239707326,t467:0.1032438701):0.6804826599,t468:0.6640468317):1.491171674,t469:2.035332697):0.7189027944):2.380094353):4.244281059,(((((t470:0.1060086238,t471:0.007519828726):0.1274055728,t472:0.1023901233):1.378368783,(t473:0.4248670096,t474:0.1222088909):1.026446858):1.740864566,(t475:0.9917496165,(t476:0.8176640759,t478:0.3535621327):0.1611842433):1.85724077):1.829282434,(t479:0.219395707,t480:0.2155125729):3.666205208):4.194366886):1.629853924,(t481:1.46303538,t482:1.392170387):8.062957497):12.79585169):24.5921812,(t483:0.9724698346,(t484:0.4407836149,t485:0.0672147862):0.4300583962):45.59583101):99.43918992);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T21.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
