<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t479:7.720172127,(t480:5.8186795,(t481:0.9531958968,t482:0.9403382981):4.85435692):1.757771681):1.611287729,((t483:6.579328143,(t484:0.8853427165,t485:0.806349966):5.423988254):1.767300189,(t486:1.862075464,t487:1.693602249):6.135113232):0.8150940725):27.76149898,((t488:15.411619,t489:15.23680058):11.18556898,((((t490:1.159559016,t491:1.11393883):6.29111836,t492:7.344525004):0.4230086478,(t493:0.381645319,t494:0.3756853961):7.359587941):8.189936582,(t495:0.2848666887,t496:0.2157410108):15.50502223):9.813919736):9.614313925):32.73703538,((t497:8.578715768,((t498:6.433432846,((t499:3.315813236,t500:3.302740294):1.164896721,t501:4.458687943):1.736751165):0.3169750576,((((((t478:0.02153482775,((t399:0.007641284543,(((t373:0.1685337411,(t372:0.03809103474,(t370:0.002655895194,((t335:0.04791910693,(((t268:0.1877227565,((t267:0.03719484227,(t261:0.09110153759,(t248:0.04452706803,(t242:0.03358264195,(t212:0.04271404823,(t165:0.3441233499,((t143:0.06537799036,(t72:0.0375973882,(t47:0.04440255486,(t1:4.115560542,t2:4.094383211):0.7497246981):2.02926108):5.633909592):1.796641847,(((t3:4.649937731,(t4:3.875620151,t5:3.857190221):0.7712931756):3.786359182,((t6:3.761338174,t7:3.606989976):3.416243541,((t8:2.755698506,t9:2.684625243):1.191255171,t10:3.770691277):2.652374905):1.2357473):4.842956363,((t11:3.476176558,t12:3.420806919):6.881905581,t13:10.25429595):2.132471609):0.8444086547):0.6012791726):4.8947762):3.012741348):0.7592344745):0.8127961293):0.3690367897):0.1031669696,(((((((((t14:9.806792144,((t15:3.451642291,(t16:1.4139848,t17:1.281777935):1.971245517):3.129291524,((((t18:3.068315528,(t19:2.568827337,t20:2.517991249):0.4218203299):0.7109294651,(t21:2.67227567,((t22:0.3565792,t23:0.2587950966):1.308135148,t24:1.543149201):0.6696395345):0.5253932761):0.5661500812,(((t25:0.3624598378,t26:0.09482489327):0.932242355,t27:0.7444130173):0.5207714482,(t28:0.4515330385,t29:0.437587811):0.7578889051):1.348854676):1.428928041,((t30:1.214335974,t31:0.6998100516):0.08115908624,t32:0.7144124527):2.58346986):0.4208090235):3.221066452):0.3757784045,(((((((t33:0.3073674652,t34:0.2989766018):0.5145374383,((t35:0.05934929498,t36:0.05800854763):0.6267655143,t37:0.5280335804):0.1252037873):0.1900184416,(t38:0.7333008267,t39:0.7236973939):0.1080822652):1.359981352,t40:2.081661462):0.1977855706,(((t41:0.5819737605,t42:0.4139865089):0.4286249261,t43:0.7461115514):0.4899027685,t44:1.058321019):0.7739760786):1.113098635,(t45:0.5642685235,t46:0.5385002346):2.354741161):3.38536077,((t48:1.371276889,(t49:0.6076289019,t50:0.5386759759):0.7630399231):0.3209494185,t51:1.128966853):4.513303527):0.2303889331):2.558095275,(t52:7.826700632,(((t53:2.475474389,(t54:1.245449141,((t55:0.6931513288,t56:0.6607076215):0.3284456682,(t57:0.6384016155,(t58:0.3626874462,t59:0.3128168784):0.2248475715):0.309411174):0.1873528805):1.172831011):0.16432114,t60:2.343214798):4.765654957,t61:7.079422736):0.3807042171):0.5450462823):1.056565151,((t62:1.313643986,t63:1.229408287):0.8989961225,t64:1.954699058):6.845743464):2.355846493,(((((t65:1.459752034,t66:1.339657579):4.040543867,(t67:2.850957453,t68:2.846008335):2.298413803):2.210917801,((((t69:1.621413826,t70:1.530950603):0.291534563,t71:1.763042367):4.154434337,((t73:1.331059854,(t74:0.8645282679,t75:0.826232678):0.4121622958):4.084434651,(t76:3.52106791,t77:3.486943858):1.737541005):0.4088270875):0.2857637431,t78:5.833805795):0.8926931588):0.8263989101,(t79:7.258678956,((t80:4.573297851,(t81:0.9796086143,t82:0.898774586):3.390511281):1.513575432,((t83:4.660856167,(t84:3.287914589,t85:3.250164906):1.08880657):0.6489557123,((t86:0.1018111684,t87:0.09345436441):4.493590966,t88:4.523145665):0.2752957912):0.4875941315):1.147530991):0.2489771492):0.4202954503,(t89:5.406065713,(t90:3.910062173,(t91:1.80322244,t92:1.790648584):1.780148354):1.200237794):1.508471751):2.145461847):4.611254884,(((((t93:3.465125558,t94:3.42283517):1.315914413,((t95:0.327675836,t96:0.288054155):4.224568835,((t97:1.404590061,t98:1.399538971):3.011438265,((t99:0.3524382283,(t100:0.2665654617,t101:0.1838350698):0.07218580229):3.962104169,((t102:3.337285884,t103:3.316562386):0.5952023426,t104:3.74901528):0.2085236048):0.07703300109):0.08024012628):0.1070335862):0.06573774488,t105:4.286344199):0.124409085,(t106:4.147228935,t107:4.136339375):0.2491763151):6.844803315,(((t108:2.336342322,(t109:0.9419798028,t110:0.9097474498):1.321060422):1.01059005,(t111:1.668333267,t112:1.653424946):1.352990435):2.458086604,((t113:0.5079086513,t114:0.4991806286):2.606577819,t115:2.917923674):2.265979163):5.309648552):1.214564804):1.267009773,((((((t116:1.762937903,t117:1.704290293):0.3643253238,t118:2.063242434):1.097996968,((t119:1.345376869,(t120:0.6480775535,t121:0.4705452276):0.6860881507):1.652478767,(((t122:0.9721632895,t123:0.96805406):1.344486917,t124:2.18400034):0.2552136539,((t125:0.9145337461,t126:0.7740169145):0.9215519881,t127:1.606569665):0.563050106):0.1256577241):0.07022591528):5.004345591,(((t128:1.657640879,((t129:0.8305817728,t130:0.5075427547):0.7272809213,(t131:0.4076948186,t132:0.0404341846):0.8029771201):0.05339572014):1.554801758,((t133:1.164674657,(t134:0.9294617747,t135:0.8961290561):0.2108940396):0.04222152563,(t136:1.008341764,t137:0.9547759449):0.1156168165):1.103274663):0.6019870998,((t138:0.8487793138,(t139:0.4909690828,t140:0.4870806601):0.2796082349):0.03659768689,t141:0.777043387):1.833114684):3.542994008):3.123162845,(t142:6.774444584,((t144:1.23351016,(t145:0.8202523878,(t146:0.59072416,t147:0.5839754935):0.1975965667):0.2988013187):3.3041684,(t148:3.609977341,((((t149:1.267658804,(t150:0.3836016091,t151:0.213854236):0.8678380982):0.2413442094,(t152:1.037066987,(t153:0.8864108168,t154:0.4021912998):0.1132822543):0.2649451352):0.8220773474,((t155:0.4237179671,t156:0.3627138919):0.3195425248,t157:0.643310359):0.8154055836):0.6561036374,t158:2.107024822):0.0251692211):0.7527423349):2.041285686):2.455870647):0.7188352711,(((((t159:0.1937858948,t160:0.1400913039):0.06532842162,t161:0.05890060474):1.274896276,t162:1.325956243):3.138340187,((t163:0.628725603,((t164:0.5406923662,t166:0.07530538085):0.04772979638,t167:0.06329627392):0.003092113057):1.403959889,((t168:0.6968750889,t169:0.4207708808):0.258396216,t170:0.371439454):0.4906316851):2.37040474):2.939441871,(t171:2.663440765,t172:2.540989933):3.416593009):0.4844881178):0.8547988925):0.6530444947,((t173:5.130139654,(t174:0.6143173331,t175:0.5766151987):4.497383404):2.53394666,((t176:0.06598572072,t177:0.033509269):6.261856019,((t178:4.346749975,(t179:3.125636296,t180:3.024080712):1.160128777):1.646284704,t181:5.798397141):0.2809606221):1.200094441):0.2658413717):0.5872351921,(t182:6.193524333,(t183:1.13028718,(t184:0.4177481918,t185:0.3786177839):0.5449183677):5.050760522):1.556141078):0.4667456966):0.1195371878):0.3198584648,((((((t186:0.5381411477,t187:0.2265661368):2.982242993,t188:3.190794242):1.522889237,(t189:0.1768980353,t190:0.1712845793):4.444411946):2.310721963,t191:6.858898153):0.3290231255,((t192:3.364466611,t193:3.227334583):0.3119266834,t194:3.512905497):3.458961011):0.1160788561,(((t195:2.151503579,t196:2.071588295):3.810529455,((t197:1.467662355,t198:1.446523409):3.012430116,t199:4.272589489):1.358399729):0.4987200797,((t200:2.634279642,((t201:1.883874254,t202:1.713537131):0.2512262181,t203:1.874481709):0.4441556082):0.2814016193,t204:2.309263528):3.199479034):0.3876713426):0.261335856):2.555903764,(t205:4.025522467,t206:3.972841584):4.615813385):2.398450737):2.318967848,((((t207:2.17444267,t208:2.150783013):2.57806849,(t209:2.735058801,t210:2.634349603):1.870189227):0.7228451615,(t211:4.944771267,(((t213:1.876261044,t214:1.815294856):0.9008455166,(t215:2.066911583,t216:2.011191693):0.594849682):0.4646591743,(t217:1.794717497,(t218:0.4379449314,t219:0.3270715009):1.248841941):1.181945339):1.561945005):0.1355210877):3.860125761,((t220:2.943932086,t221:2.461808749):0.7227320694,(((t222:0.1072170612,t223:0.09495243693):1.591156195,(t224:0.4104482201,t225:0.2302221708):1.272856311):1.269495802,(t226:2.349540616,(((t227:1.429608828,t228:1.371086696):0.3717173052,((t229:0.663994442,(t230:0.4999730867,t231:0.4769822611):0.1265908711):0.3849231613,t232:0.4194363655):0.6747686846):0.4795918914,(t233:0.7930105603,t234:0.5417976984):0.7551326189):0.05630690759):0.3462902723):0.2048834575):4.58722446):3.967503777):1.754578845):0.1096307751):0.1782758548):0.06071164729,((((t235:1.67867573,t236:1.493512211):0.7308102597,(((t237:0.9126082188,t238:0.8530969927):0.0434450692,t239:0.8873889356):1.037427086,t240:1.842454022):0.179073205):1.256440622,((t241:1.230091286,t243:1.074495895):0.3973483775,t244:1.465917425):1.407871333):1.943277981,(((t245:1.716712737,((t246:0.543682504,t247:0.339945389):0.362453106,t249:0.3271063987):0.760579404):0.61494923,t250:1.641923078):0.8114638127,t251:2.373292554):1.613068237):6.92089937):2.374057368,(((((((((((t252:1.088145938,(t253:0.6627565229,(t254:0.4550797893,t255:0.3212979213):0.197777604):0.4240949873):1.108776302,t256:2.002654279):1.78770935,(((t257:1.46327917,(t258:0.1122570044,t259:0.09071979312):1.334291068):0.007847136186,t260:1.350891001):1.750785897,t262:2.918635589):0.5248507267):4.74748294,((t263:0.1456582234,t264:0.06923487732):6.603961376,(((t265:2.516728849,t266:2.414248101):0.7564285545,((t269:0.3026465643,t270:0.2858593044):2.191374631,(t271:1.644103655,t272:1.597513931):0.7101998655):0.3599979623):0.4264782474,t273:2.863796259):2.915167623):1.421403871):0.3136483651,((t274:4.409010324,(t275:0.9175482298,t276:0.876319873):3.423186383):2.990821908,t277:7.263164514):0.06957512179):0.0970673555,((t278:6.187303717,(((t279:1.829978599,(t280:0.397524294,t281:0.3829901517):1.376834459):0.5638104327,t282:2.272248169):0.06947447599,t283:2.272179996):3.668435503):0.02470003253,t284:5.923486221):1.178427562):0.2009494275,(t285:7.235962931,t286:7.097161212):0.0200826312):0.6086803333,(t287:0.2548873307,t288:0.1259007527):7.428111939):0.229889276,((t289:2.087603784,t290:2.06550456):3.315644184,(t291:1.686819315,(t292:0.3058641664,t293:0.1619110544):1.285041232):3.630897959):2.041985513):1.017046137,((t294:0.136402826,t295:0.11942192):7.677813142,((t296:4.817241392,t297:4.743694132):0.4833056674,((t298:1.055377589,(t299:0.7636073618,t300:0.5991871809):0.1484856449):2.425456705,t301:3.152275491):1.738600589):2.376448853):0.3216004015):1.240162402,((((t302:5.875776296,(t303:4.633925508,t304:4.614938652):1.175801834):1.094289103,t305:6.833568563):0.7476609238,(t306:4.76338506,((t307:4.317292162,(t308:1.840469519,((t309:0.4185110773,t310:0.417838859):1.174417747,(t311:0.7689997038,t312:0.6479367722):0.5867257535):0.2037206834):2.47475062):0.1760226644,(t313:1.262836747,t314:1.185879545):2.765284):0.2588439639):2.678077533):0.06742011346,((t315:3.53258528,t316:3.532073249):3.297857507,t317:6.801245374):0.0856578595):0.9743853461):0.6988954668):0.4081992437):7.221721031,(((((((t318:3.996370479,(t319:3.41576462,t320:3.397435796):0.5251521856):0.693375054,t321:4.490692573):1.170974471,(((t322:0.06443906325,t323:0.0499076455):1.6860896,(t324:1.405298622,t325:1.310085168):0.2114030006):1.780831127,((t326:2.001407069,t327:1.715423393):0.8563566524,t328:2.562725942):0.4086262172):2.106341003):0.1345909064,(t329:2.011395189,(t330:1.214621892,(t331:0.5956738517,t332:0.4023075788):0.5664928227):0.7454642093):2.914843162):0.1763516962,(t333:3.846041156,t334:3.775712698):0.8821240075):4.126414718,(((((t336:1.636244167,t337:1.475464314):0.3069351061,t338:1.466263606):1.93026323,((t339:1.101708692,(t340:0.6695504425,t341:0.2922740801):0.3137437905):0.31304921,t342:0.8557493296):1.971203235):1.671436326,(((((t343:0.7324042799,t344:0.6241919807):2.368483617,(t345:2.309876342,t346:2.180006931):0.5890153938):0.05266492606,t347:2.732030105):0.3969731014,((t348:2.404098903,(t349:1.364103804,t350:1.336983535):0.6586078315):0.3315911663,t351:2.301448879):0.2670265574):0.2727972257,((t352:0.9840768785,t353:0.9153829133):1.579424781,((t354:0.7434711372,t355:0.6148159029):0.595137276,t356:1.028388708):1.127264365):0.2285459922):0.618735633):1.285510695,t357:4.272347665):1.590543579):4.077042542,(t358:0.4218160393,(t359:0.3186138824,(t360:0.2133189716,t361:0.1757269187):0.03873257486):0.09388919284):9.407674003):1.685056616):0.9033689382):0.4172223994,(((t362:1.994240759,((t363:0.2520383189,t364:0.1359339271):0.006380714235,t365:0.009400131196):1.733066464):0.2250152713,t366:1.662743613):1.425636237,t367:3.06686):8.930507574):0.294743196,((((t368:3.980622042,t369:3.869297801):0.1155155345,t371:3.823666275):0.5613167263,(t374:2.364843251,t375:2.32264403):1.57257996):3.670821698,((t376:1.713468974,t377:1.699876557):0.9176770574,((t378:0.3152992819,t379:0.1413099915):0.5392071366,t380:0.5661526704):1.443027627):4.717187431):3.890812955):0.7788372109,(t381:4.71990376,t382:4.649169035):6.646866004):6.504930607,((((((((t383:0.6024420666,t384:0.5786222405):1.523142545,t385:2.007603463):1.618710238,((t386:0.4467962169,t387:0.4349833987):1.200712836,t388:1.520601034):1.808953749):1.444367903,t389:4.659676555):2.954150511,(((t390:1.243546232,t391:1.221739993):0.4995718078,t392:1.397479407):0.7262285695,t393:2.103917266):5.074588149):0.6006565,(((t394:3.958110028,t395:3.765252403):0.8090933236,t396:4.441847681):2.721966736,t397:7.066834283):0.1948951365):0.5924432443,(((((t398:0.5842516775,t400:0.467343856):0.2309993583,t401:0.6436495341):2.337282987,(t402:2.616730906,t403:2.614870953):0.1812381145):1.935398234,t404:4.701497328):1.3160817,((t405:1.211257135,(t406:1.12690511,t407:1.102985633):0.0370637206):2.852483796,t408:3.988473493):1.935015235):1.369560694):0.58588511,((t409:4.367250724,(((t410:0.1738776262,t411:0.04152358278):1.86488288,(t412:0.5748734283,t413:0.3354214476):1.256534143):1.16334136,t414:2.689412027):0.8666838181):2.788281887,t415:6.054708667):0.6788600771):7.773365385):0.02132207059,t416:14.31108976):0.8860241096):1.724564608):6.021055089,((((((t417:1.560855103,t418:1.384616163):1.386663726,(t419:2.660220882,t420:2.519533988):0.08162156631):3.019657046,(t421:4.796794821,(((((t422:0.3839342488,t423:0.3412327348):0.3641189548,t424:0.6275398487):1.14986929,t425:1.746086765):1.141606319,(t426:0.05870644867,t427:0.04162772165):2.820094357):0.3157586444,t428:3.164506299):1.361915319):0.7888816896):0.5923060431,((t429:3.718254808,((t430:1.876798801,(t431:0.7849649331,t432:0.679815697):1.062249568):1.344971601,(((t433:0.2320249004,t434:0.180759955):2.081170204,(t435:1.326310867,t436:1.233630803):0.703745696):0.1922068945,t437:2.084868925):0.5437673166):0.4819201217):1.78759505,((t438:4.260290633,((t439:1.710740466,(t440:1.253268366,t441:0.9800215577):0.3094796745):0.5895068166,((t442:0.7736750826,(t443:0.3897297292,t444:0.3722322786):0.283037494):0.4070403578,t445:0.9935135642):0.1892287476):1.783674271):0.1078099693,(t446:1.464255466,t447:1.417909799):1.58541663):0.4970430821):0.1057669488):0.04213628069,(((t448:0.158829674,t449:0.1337370583):1.838133043,((t450:1.338134324,t451:1.319545078):0.2348864204,(t452:0.5883252489,t453:0.5305175505):0.9182455769):0.3450632621):0.4067128348,(t454:0.4530281313,t455:0.2448490234):1.691196891):1.211476019):11.27123726,(((t456:0.6361101108,t457:0.5594155175):1.822694487,(t458:0.9347756564,(t459:0.7975178579,t460:0.716698348):0.1274451314):1.202349683):6.292913268,(((((((t461:0.5019905063,t462:0.3052723304):0.6863780597,t463:0.8356194786):0.7530691746,t464:1.243490704):0.004936591747,t465:1.237117578):1.058853307,(t466:0.3026768658,t467:0.1809234982):1.934050981):1.978785637,(t468:0.1114905529,t469:0.08457708884):3.979262936):1.456653743,(((t470:1.373500597,t471:1.277694577):1.533304357,(t472:2.269491595,(t473:1.153318987,t474:1.025084035):1.10638055):0.4764876534):2.37985017,((t475:0.5685518851,t476:0.5511952696):0.1722990964,t477:0.6965699668):4.240278436):0.05270218732):1.656203117):5.10029549):5.033728587):53.24441833);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T74.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
