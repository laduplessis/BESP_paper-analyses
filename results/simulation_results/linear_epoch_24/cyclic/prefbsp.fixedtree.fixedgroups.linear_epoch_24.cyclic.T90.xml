<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t448:17.72417267,t449:17.67128141):60.75124392,(((((t450:2.750838094,(t451:1.346780192,((t445:0.04861274469,(t436:0.198930485,(t429:0.07839433127,((t419:0.0600044195,(t364:0.1691185721,(t363:0.03839681631,(t341:0.2323838807,(t336:0.06864018841,(t323:0.06401833497,((t304:0.02904416116,((t262:0.06405374042,((t243:0.170775731,t244:0.1542749269):0.1744429844,(t242:0.1806032408,(t233:0.1070143135,((t178:0.07082688444,(((((t143:0.04447284532,(t141:0.04037974873,(((((((t39:0.1835713345,(((t1:2.760739014,t2:2.621928527):0.9301960933,(t3:2.624384539,t4:2.490612927):0.9010564515):0.7727559266,(t5:2.136903884,t6:2.079125675):1.986093984):0.1036021823):0.356324605,t7:4.518750206):0.4698772964,(t8:4.276027839,(t9:3.300248728,t10:3.076981212):0.7937340022):0.4407907184):2.619098274,((t11:2.131081246,t12:2.117928972):3.851887952,t13:5.695404947):0.5844881672):1.044977045,t14:7.227335712):3.408248463,(t15:2.955030267,(t16:2.744761326,t17:2.703229344):0.2005078547):7.544157766):0.7716194676,((t18:1.503014867,t19:1.425597261):7.640685332,((t20:1.735061475,((t21:0.6527387456,t22:0.6181754445):0.676319189,t23:1.284053244):0.2925348019):1.749349461,(((t24:1.990036881,(t25:1.585463787,t26:1.524409526):0.3366252612):0.175555833,(t27:1.426920158,t28:1.227178539):0.3770616994):0.7987119592,((t29:0.3917040612,(t30:0.1462921863,t31:0.06745606236):0.1079817886):1.44364717,t32:1.58354593):0.3567388594):0.3094181239):5.5356782):2.051711602):0.5415478062):0.218235936):0.65003421,((((t33:9.081623036,(((((t34:0.06681528101,t35:0.00469436096):0.8040258202,(t36:0.3631073293,t37:0.2043646421):0.44219652):0.9207222692,t38:1.324166159):0.07694727676,t40:0.9312191237):1.426053152,t41:2.153259769):5.518644999):0.1013032444,(t42:0.911765474,t43:0.8505328578):6.845500269):1.943460978,((t44:4.421775074,(t45:1.252489586,t46:1.106693876):3.066896199):1.285714804,((t47:1.214936844,t48:1.051526964):2.347471277,(t49:1.240511964,((t50:0.2736618276,t51:0.2504764371):0.01708892279,t52:0.04992016553):0.8772375827):2.10742665):1.744317459):3.591190378):0.05877571332,(((t53:6.693562005,((((t54:1.931242344,(t55:1.096834998,t56:1.084485177):0.8001012925):0.8784755933,t57:2.615702541):1.11304104,t58:3.673249405):2.031385121,(t59:5.094443481,t60:4.924190878):0.3612094284):0.6351948417):0.1293040959,(((t61:5.026032964,t62:4.948799431):0.5438665047,(t63:0.4913939213,t64:0.2696611931):4.981915644):0.3203032366,(t65:4.492508808,((t66:1.922740752,t67:1.874014668):0.1750007613,t68:1.957023639):2.326388849):1.053254794):0.148993152):1.031247605,t69:6.49923844):0.4058762299):0.04875425599):0.9683937939,((((t70:2.672856806,t71:2.625711374):2.773374472,t72:5.355081436):0.5278937836,((t73:3.212534203,t74:3.056555348):1.402374242,t75:4.314405534):1.188277669):1.790112499,((((((t76:1.282174298,t77:1.225350772):1.746810022,t78:2.80434577):1.397227925,t79:4.151820385):1.742106489,(t80:1.920988855,t81:1.861707981):3.921314687):0.1984314893,((((t82:3.445877466,(t83:2.446975204,(t84:0.1481837885,t85:0.06240582126):1.979330267):0.978709716):1.586847274,t86:4.602450074):0.09111614635,((t87:2.398749191,t88:2.376819798):1.911091738,(t89:3.391771054,t90:3.383517995):0.7526102132):0.3305644473):0.2074707349,(((((t91:1.610059734,t92:1.550737063):0.8039650451,t93:2.27058671):0.6296493042,t94:2.769375292):0.4409378381,(t95:1.099747671,t96:1.070248112):1.675939115):1.071155257,(t97:0.2799938295,t98:0.2299238795):3.46260551):0.07838817236):0.6197199258):0.2961653093,((((t99:2.767480998,t100:2.702112434):0.2693240116,(t101:2.251073531,t102:2.242566184):0.7149069538):0.1573569348,t103:3.053412965):1.04683355,(t104:0.8273604305,t105:0.8177141741):3.168110024):0.4127985182):0.5679337439):0.1161828118):0.2371321389,(t106:0.6384802715,t107:0.4753528086):4.490519645):1.425530831,t108:6.33915145):1.087733656):6.432662952,((t109:4.254228236,((t110:2.456524143,t111:2.45371431):0.6617953241,t112:3.030404406):1.100371471):0.2221495184,(t113:1.658748947,(t114:1.135858543,t115:0.9046664824):0.4900641453):2.451685682):9.349186679):0.01638871496):1.552141168):0.3743732059):1.515618679):1.156693954,(((t116:1.406888776,t117:1.404388728):0.4395664388,t118:1.700828726):0.7536648547,(t119:0.3639537794,t120:0.335496637):1.963028774):14.80943236):2.643570914):1.809046031,((((((t121:1.344509659,((t122:0.3185015466,t123:0.2682193509):0.04055071914,t124:0.1803922297):0.9193791739):1.093947897,t125:2.037183525):8.512561217,((t126:1.931430621,t127:1.734670286):8.264848355,((t128:1.553502995,(t129:0.3455841715,t130:0.3382169452):1.148794956):2.879244983,t131:4.357474274):5.343579681):0.307773948):2.412410332,(((((((t132:0.08020503078,t133:0.04704777761):0.135719752,t134:0.1578560617):0.07399390181,t135:0.1034624555):2.058644127,t136:2.160565022):6.858710698,t137:9.004079204):0.325509007,((t138:0.6107056395,t139:0.5993328824):0.2948530551,t140:0.7170222514):8.419813677):1.086484352,((t142:8.069752022,((((t144:1.9543012,(t145:0.4336834643,(t146:0.3089545099,t147:0.2820615471):0.01327233016):1.507230529):1.348266151,(t148:0.7720586847,t149:0.004040978237):2.277101374):2.747150725,(((t150:0.2326105479,t151:0.2253568233):0.5355317474,(t152:0.1962560791,t153:0.1365664377):0.4453846914):2.512470843,((t154:1.147274224,(t155:0.1110161905,t156:0.04663268094):1.024197406):0.3869847254,(t157:0.6464497469,t158:0.3879790658):0.7378950148):1.555810153):1.514329522):1.633011948,((t159:0.2327210126,t160:0.2234942416):0.9768515941,t161:1.023955892):4.595024194):0.1924083782):1.117999405,(t162:5.103001913,(t163:1.927805184,(t164:1.139912922,t165:0.9236876569):0.7687093048):2.964480084):1.498396103):0.8856521116):1.766309954):0.644466464,((((((t166:0.2876934834,t167:0.2308125283):0.3342579586,t168:0.5302337364):1.066195931,t169:1.564107979):4.88974395,(t170:6.332519755,(((t171:1.015454896,t172:0.9372696213):0.8667929856,t173:1.747515975):0.7363795756,t174:2.456051079):3.237854916):0.08548464127):1.795834531,((((t175:4.280655112,((t176:2.315796598,t177:2.120481589):0.2909493976,t179:2.052158944):1.641651398):0.5274753274,t180:4.107658773):1.073731511,((((t181:2.752821352,t182:2.386488804):0.05171350531,(t183:0.07780588527,t184:0.01489518645):2.356300552):0.1178227216,t185:2.417828563):0.9823392121,t186:3.360243108):1.26414905):0.2387439696,t187:4.778381729):1.240226159):0.8516857657,t188:6.864060216):0.1476840438):6.714361343,((t189:2.957842275,t190:2.900379795):6.405563764,((t191:6.59235275,t192:6.327157703):1.432649589,(((((t193:2.216357954,(t194:1.534077975,t195:1.532994542):0.5696601126):0.0321074958,((t196:1.92361344,t197:1.917697062):0.1153363759,t198:2.0286117):0.05591249117):0.5924939846,(t199:1.681105356,t200:1.664083583):0.953633534):1.47476473,t201:3.834436446):0.3321001602,((t202:1.085408107,t203:1.074499758):1.785955434,t204:2.609829266):0.892110643):2.958571377):1.262559389):4.362311242):0.8274264931):0.2935779022):1.694640416):0.6433634077):1.794564836):0.2906433572):5.444536948):0.5688864669,((((((t205:4.355495233,(((((t206:0.947586492,t207:0.7821412438):1.966868574,t208:2.439762213):0.5651118002,((t209:2.208615164,(t210:0.7152726261,t211:0.6451324468):1.400589921):0.4254202884,(((t212:0.8583644566,t213:0.756019045):0.02943774346,t214:0.7143960098):1.314813576,(t215:0.5995616324,t216:0.3808888549):1.429063679):0.2025303536):0.2380140177):0.2677664109,(t217:1.075272942,t218:1.03842283):1.396653252):0.2769284477,(t219:2.011320431,(t220:1.629346878,t221:1.44904132):0.3800531508):0.6519549768):0.2062825909):8.45988606,((((t222:7.973993107,(((((t223:0.7166827484,t224:0.5961319133):0.177871999,t225:0.3309996623):1.994769625,(t226:1.444517423,(t227:0.1757420103,t228:0.1222829509):0.8062791087):0.6825194225):1.782784812,(t229:1.552372615,(t230:1.147516764,t231:1.029739127):0.2107696502):1.836467068):0.7719613815,t232:3.765852815):2.504062565):0.9462242873,t234:6.85100686):0.2249162779,t235:6.723347106):1.165891159,((t236:5.262878446,t237:5.261448771):1.667764161,t238:6.751198838):0.9088937583):0.8311545561):1.179199875,((t239:5.471469561,t240:5.289186091):0.6366179515,(t241:1.742492057,t245:0.9058794613):3.890233365):3.468030642):0.5623511539,((((t246:6.435686097,((((t247:0.2417870689,t248:0.2307770647):3.659842447,t249:3.8211998):1.075597895,((t250:2.908478087,(t251:1.444792987,t252:1.178003592):1.432145192):1.579208039,(t253:2.661295764,t254:2.631636454):1.514436549):0.3788283676):0.6921808218,(t255:4.191970669,t256:4.163170657):0.9325622319):0.6813640849):1.323874495,(t257:1.217668303,t258:1.151024567):5.755904634):0.07018166364,(t259:6.078810953,(t260:5.43184788,(t261:4.579919227,(t263:4.370781036,t264:4.263199265):0.002959408488):0.7860052251):0.5204276855):0.8407880859):0.08912650761,(t265:4.477797597,t266:4.477052634):1.993315375):0.739940526):6.176005569,(((t267:5.788610759,((t268:4.047775823,t269:3.992479042):1.687010671,((t270:2.773544154,t271:2.727170774):1.170028264,(t272:2.150344308,(t273:2.005220845,t274:1.91485816):0.1117711298):1.386940183):1.663091367):0.03174136755):0.6284397322,((t275:3.274761953,(((t276:2.059182562,t277:1.69879588):0.9049053355,t278:2.565802668):0.133561262,t279:2.616198893):0.115607861):1.057714349,(((t280:0.3239736145,t281:0.2592024997):1.759936579,(t282:1.886881139,t283:1.85971413):0.01674463326):1.123517475,t284:2.941808132):0.5549326816):1.391859718):4.435419326,((((t285:1.39676954,(t286:0.5549080187,t287:0.5426340118):0.7517688231):3.041860123,((t288:2.716306035,t289:2.527317212):1.427687592,t290:3.794948303):0.1517197738):0.473806389,(t291:1.617699289,t292:1.526477393):2.786856073):1.123438369,(((t293:1.386444608,t294:1.27267925):1.776426125,(t295:0.5376073318,t296:0.3234146601):2.462769034):0.1989124856,t297:2.959491878):2.031206846):3.274449128):2.40431287):2.095672879,((((t298:2.014358031,t299:1.808416312):2.099783443,(t300:1.855045847,(t301:0.06324508517,t302:0.04342539479):1.506792715):2.020292425):3.987820032,((t303:0.9474997544,t305:0.6793988831):4.779102646,((t306:1.340658137,((t307:0.5906842356,t308:0.3831396108):0.4110505302,t309:0.7909143778):0.3243594026):1.895002209,t310:2.87850493):2.186492256):1.770325045):2.272873773,(t311:0.363305302,t312:0.2442310631):8.628158733):2.135820873):0.6684174726):0.655948547):0.8027470862):1.424559652):0.1265024293,((t313:1.502061634,(t314:0.3715271928,t315:0.2405851182):0.958518866):2.037324431,((t316:0.8490599598,(t317:0.510168172,t318:0.2612947813):0.3289197058):0.3109444803,(t319:0.1138814823,t320:0.02473645891):0.6293303556):1.811860169):11.11202714):1.639719055):1.388962409):3.127506911,(((t321:9.691513322,((((t322:0.8615354004,(t324:0.6069389759,t325:0.5577460831):0.112339826):1.827931924,(t326:0.2449103718,t327:0.2013304526):1.670479712):2.600772231,t328:4.346582388):3.75740216,(t329:2.77850013,t330:2.709473912):5.309801253):0.6415898826):0.332896241,(t331:0.1809682652,t332:0.04989806069):8.779447897):3.691872204,(((t333:0.3086566739,t334:0.2561654882):6.691843219,(t335:1.788598153,t337:1.343429824):5.101694409):0.8702251383,(((((t338:1.178913932,t339:0.8688111528):0.793771222,t340:1.602291996):0.7050520569,(t342:0.5542173228,t343:0.5196227916):1.365545095):0.1557082027,(t344:1.790423317,(t345:0.7994389518,(t346:0.4528094779,t347:0.4060748305):0.2828664804):0.9774387976):0.2141620756):1.89603116,t348:3.746263387):2.566568333):4.576982149):6.011950482):1.11155105,((((((((t349:0.3278384952,t350:0.3189189302):3.518790071,(t351:0.4729216866,t352:0.409585012):3.30840555):2.968719666,(t353:5.10765183,(t354:3.977942971,t355:3.665079122):1.099321132):1.499986416):1.498590889,((t356:2.707175252,t357:2.704238966):4.62094397,(t358:7.19301947,(t359:2.774487633,t360:2.725434818):4.326334047):0.09050000752):0.3928580741):0.7756066883,((((t361:0.5288503107,t362:0.3904261992):1.540375568,t365:1.597775003):4.42631529,((t366:5.191356169,(((t367:2.946550738,t368:2.926566772):0.2712449882,(t369:2.927611204,((t370:0.1658768938,t371:0.1408191528):1.25134613,t372:1.390840379):1.20313996):0.1890691339):1.1727456,t373:3.922873891):0.7866617894):0.1557196276,t374:4.830074):0.6188275947):1.338786476,((((t375:0.02207144089,t376:0.007996571906):0.3375318296,t377:0.3319009124):4.628123102,((((t378:2.772198252,t379:2.754688551):0.2916296439,t380:2.778494323):0.106858207,(t381:1.552579988,t382:1.550265699):1.218131385):1.041874354,(t383:2.221463509,t384:2.218637013):1.576471674):0.6567108055):1.368397092,(t385:3.376832981,t386:3.368754907):2.364404387):0.05511947115):0.1335658891):1.688228209,((t387:0.8241882414,t388:0.8108932652):2.145281325,t389:2.906560583):4.388302996):0.9899271267,((t390:2.988309629,t391:2.892239292):2.599093389,((t392:2.104462233,((t393:0.4437636819,t394:0.3694695851):1.176786761,((t395:0.4253363438,t396:0.1535191365):0.5837645595,t397:0.6670787479):0.3941627322):0.4104616794):2.544463028,(t398:2.710614507,t399:2.705987192):1.071800335):0.7642466008):2.500909533):3.182189367,(t400:4.032554234,t401:3.999602506):5.973248482):2.930408211):9.841200394,(((((t402:2.18773219,t403:2.105119564):0.2965444276,(((t404:0.3692818282,(t405:0.118583163,t406:0.03631222316):0.2474801411):1.262084012,(t407:1.325122718,t408:1.003060355):0.03560218398):0.6089877508,(t409:1.114655543,t410:0.9225366161):0.1940289652):0.126666571):0.2341527058,t411:1.448044411):1.67549691,(((t412:0.4424178636,t413:0.2997610963):0.4591494025,t414:0.599776156):0.2179284866,t415:0.7858940939):1.904568368):9.322153111,(((t416:0.2527731524,t417:0.204873719):8.565309203,(t418:0.7310539127,t420:0.5328774016):7.847776238):1.966911277,((((t421:0.2486331612,t422:0.1063769651):0.2106904286,t423:0.2530707089):4.733317492,t424:4.910051816):2.804790527,(t425:6.788636081,t426:6.499480774):0.5631503577):2.317447849):1.204721199):9.002031981):57.00335046,((((t427:0.4311977037,t428:0.4241336904):2.731074096,t430:2.932221677):5.769146931,(t431:0.9676289642,t432:0.9332572259):7.487127323):22.02634204,(((t433:2.362604931,t434:2.33919107):7.570281377,(((t435:0.4590500319,t437:0.1996728517):7.551582072,(t438:6.247278861,(t439:2.703479362,t440:2.686399168):3.425289602):1.138243677):1.165173165,(((t441:2.060760647,t442:1.716807035):4.226356898,(t443:0.3316910902,t444:0.3277290046):5.531001136):0.6104027598,t446:6.213464088):1.187627052):0.72493994):13.91106712,t447:21.93222879):6.450862188):45.61239435):4.489049313);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T90.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
