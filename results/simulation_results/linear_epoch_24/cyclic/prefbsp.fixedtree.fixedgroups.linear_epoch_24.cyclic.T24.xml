<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t452:0.8802710203,t453:0.5231982348):7.286575546,(t454:4.214960111,(((t455:1.661349199,t456:1.57273418):0.1634672748,((t457:0.06689383433,t458:0.02379521232):0.8711488233,t459:0.8764692561):0.789629521):0.5543555983,t460:2.181500439):1.808503475):3.500481447):13.35378594,((((t461:0.6483076379,t462:0.6369316262):7.251358993,((t463:1.667535049,t464:1.652916053):6.077753856,((((t465:0.2214815324,t466:0.1362627224):1.039442768,t467:1.068664416):3.496877995,(t468:0.4083057922,t469:0.3466198352):4.031027664):1.39697359,t470:5.746766879):1.542441994):0.1281260643):7.430414162,t471:14.79193767):3.951309856,((t472:9.139783528,(t473:1.443417954,t474:1.442782973):7.663603594):4.960172383,t475:14.03426945):4.572255615):1.351548335):85.95196093,(((t476:2.631458816,(t477:0.203866086,t478:0.189711093):2.349900863):6.480033442,(t479:0.3054056401,t480:0.168349037):8.713892466):29.12441268,((((((t481:4.358338553,(t482:1.658024283,((t443:0.01790822258,(((t427:0.06670048368,(t425:0.2448294202,((t411:0.01501025965,(t391:0.2546883018,((t354:0.1937248275,((t340:0.07123673264,(t333:0.2603170413,((t299:0.03201811634,(t266:0.1158096668,(t260:0.05943575937,((t246:0.09689724237,((t226:0.2623275285,((((t55:0.1504071479,(t53:0.00692758034,(t1:4.050796995,(t2:2.182826922,t3:2.156627871):1.790061271):0.8106535679):0.2439637897):6.548608482,((t4:5.906973555,((((t5:1.103780153,t6:1.102470072):1.468480739,t7:2.55338704):1.197463106,t8:3.739545992):1.386497244,(t9:3.677010615,(t10:2.360282001,t11:2.302109035):1.095054233):1.358950203):0.5581416819):2.830434707,(t12:4.000295863,(((t13:1.878865329,(t14:0.1749762695,t15:0.1297473394):1.647440302):0.7608302281,t16:2.400541219):0.260724977,(t17:2.578121569,t18:2.416238349):0.07640208563):1.095914037):4.137433989):2.753485614):3.855203411,(((t19:2.404336293,t20:2.397109913):5.031332798,((t21:4.15284943,(t22:2.189496936,t23:1.949510731):1.808163692):2.520960756,((t24:4.911950558,((t25:1.403352602,t26:1.368638184):1.009598939,((t27:1.320389719,t28:1.066295836):0.6967199141,t29:1.614547253):0.3164665626):2.26887066):0.02417243547,((t30:0.1547691009,t31:0.120801517):2.866285065,(t32:2.323033361,(t33:1.291557151,t34:1.212253778):1.009839063):0.5750852817):1.066224607):1.235751257):0.7225278327):5.463427551,(((((t35:1.159936181,t36:1.123125347):0.5412354403,((t37:0.5025057945,t38:0.4611819217):0.01934030808,t39:0.4600472343):1.035200116):0.0905456558,(t40:0.6138897048,t41:0.611816137):0.8707179011):2.000312146,(t42:2.700311776,(t43:1.538789528,((t44:0.2548763131,t45:0.1522876684):0.5381578763,t46:0.5383202364):0.7256901336):1.107180638):0.4987383322):5.991125263,((t47:0.3165580584,t48:0.1707855109):6.506230836,((t49:0.2767296124,t50:0.1021588983):1.047275262,t51:1.117376327):5.336467529):1.813346192):1.368083199):1.377714794):1.323132615,(((((t52:0.1626258018,t54:0.06200919722):3.582070827,(((t56:1.558945947,(t57:0.588147903,t58:0.5802313705):0.875141761):0.362550765,t59:1.721829308):0.5355305885,(t60:1.048969317,(t61:0.2454047364,t62:0.2217828559):0.7285271355):1.036429275):0.7915453477):1.224369815,(t63:2.197255133,(t64:0.1124780663,t65:0.08056540697):2.052509309):1.684063024):2.445306451,((t66:0.2951410037,(t67:0.1968489005,t68:0.07905540701):0.06112441212):2.208362371,(t69:1.905518552,t70:1.870767669):0.05645679735):3.741136234):2.057805427,(t71:7.630243685,t72:7.580987139):0.03451008172):2.592044199):5.154743699):0.2877094127,(((((t73:6.980467935,t74:6.729469447):0.6429454014,(t75:5.947077384,((t76:0.7359289885,t77:0.7327924076):5.011729897,((((t78:1.088991047,t79:1.013459055):2.90050711,(t80:3.414190599,t81:3.355737596):0.3977933712):0.5909761816,((t82:0.3955518137,t83:0.1839497759):2.308364634,t84:2.427810438):1.511991525):0.3497835555,((t85:0.4350796401,t86:0.3698961207):0.5393998667,t87:0.8896866074):3.301224961):0.8006015869):0.05903957066):1.37873571):0.1328643513,(t88:5.645946825,(((t89:0.1756956821,t90:0.06349772974):0.9602705842,t91:1.017225524):2.954006956,(t92:2.460353619,t93:2.409742344):1.291672304):1.441072065):0.8931677061):0.455288686,(((t94:0.4218494517,t95:0.4149547915):3.559035073,(t96:1.599692324,t97:1.566893914):2.284697083):1.00768332,t98:4.758553545):1.236645879):1.308431477,(((t99:2.017293513,t100:1.960091584):1.288082754,t101:3.170796992):0.6995248213,t102:3.719941515):3.272793705):6.065603243):1.854389261):0.1547615875,((t103:0.9141891693,t104:0.8851489379):3.422510423,(t105:2.074197932,t106:1.849113981):2.117386013):10.51345126):0.810195448):0.6643317972):3.294683626):0.2677599732,((((((((((t107:3.107827269,t108:3.097416789):0.2040162051,(t109:2.283846562,t110:2.136025196):0.9571664994):0.09536808309,(t111:2.949348148,t112:2.88579385):0.1603950265):0.5273949659,((t113:2.370891382,t114:2.250693943):0.1310031338,t115:2.292119768):1.068673226):0.5392987313,((t116:2.052051905,(t117:0.9784224066,t118:0.9573769276):0.9652081091):1.169681835,(t119:2.704113009,t120:2.631056124):0.3500655812):0.5497622207):1.816499038,(t121:2.809967518,((t122:2.134774537,t123:2.083695042):0.3023988723,(t124:0.6816871448,(t125:0.3332244716,t126:0.2867791117):0.1413650525):1.617207185):0.02515896823):2.515775649):6.655439668,(((t127:3.051811221,(t128:1.520678746,(t129:1.055286378,t130:0.9834711049):0.4022194913):1.476173946):1.815511502,((t131:2.377012365,t132:2.316705077):0.4378620493,(((t133:0.4313838038,(t134:0.1191759094,t135:0.04547530073):0.3035905408):0.7789834746,(t136:0.7674889823,(t137:0.4428052728,t138:0.354065174):0.1472490835):0.3602929529):1.176148207,((t139:0.4751941266,t140:0.3316296094):1.276855036,t141:1.593404398):0.2469561379):0.3345759974):1.768282006):3.577028555,(((((t142:0.6258174381,t143:0.5740644936):0.7762960922,(t144:1.312870929,(t145:0.7337545716,t146:0.5367387306):0.4669248597):0.01424460841):0.8026533731,t147:1.673575146):3.12617356,(t148:3.397849823,t149:3.349524077):1.311747944):0.7096923018,((((t150:1.265585429,t151:1.193912657):0.07133923777,(t152:0.2914968031,t153:0.1946519228):0.5064640437):0.5227729014,(t154:0.2552829301,t155:0.2004085588):0.8517138748):3.23112502,t156:4.246780453):0.02347066166):1.458842866):2.556503089):1.41967508,(((((t157:0.05130370909,t158:0.01784852676):0.8389213888,t159:0.8343288111):0.1282354493,t160:0.9487363306):0.1972786938,t161:1.063170546):0.1805136775,(t162:0.6888050364,t163:0.4756059574):0.4521875389):7.630136506):2.640398895,(t164:10.93069092,(t165:8.50876466,(t166:7.469822503,(t167:0.9247930035,t168:0.7927886628):6.376112428):1.03592934):2.386750049):0.1159823094):2.135426358,(((((((t169:0.8623226715,(t170:0.5063478242,t171:0.4254011687):0.268409836):1.725321273,t172:2.362777986):1.595805514,(t173:1.989600176,t174:1.914381764):1.880552848):1.2682512,t175:4.873106352):0.954101236,(t176:5.448440438,((t177:4.022207444,(t178:0.4534255101,t179:0.2897763004):3.548426222):0.9954159345,((t180:0.1541597211,t181:0.005558227314):4.648358492,t182:4.643779776):0.02104351266):0.3503169972):0.2959648472):0.6602331052,t183:5.965365361):0.04420549205,((t184:1.927229829,(t185:0.9736147811,t186:0.8981562652):0.935617778):0.1849735229,t187:1.978332307):3.748563883):5.599050897):0.2321314807):3.643463379):0.9913303359):1.140433426,(((((t188:6.719755272,(((t189:5.769758361,(t190:3.79698764,t191:3.752885979):1.875763943):0.02464334637,(t192:2.905584462,t193:2.841906076):2.716616695):0.5387613304,t194:6.006243525):0.3782949549):1.594288159,(((((t195:2.889537103,t196:2.610391542):0.9987383001,(t197:3.334777197,t198:3.164230698):0.2697412514):1.324034697,t199:4.68595571):0.6971960166,t200:5.381926927):0.6445006853,(((((((t201:2.421950891,((t202:0.2617383765,t203:0.1450263455):0.3524921584,t204:0.4369823424):1.535474055):0.5217767765,t205:2.379517141):1.033996994,(((t206:1.331383213,t207:1.315773502):0.7824574932,t208:2.078510525):0.2687891176,(t209:2.287976237,t210:2.162495558):0.04308332507):0.8108002439):0.2259396802,(t211:2.975861542,(t212:0.4484257701,t213:0.3553867636):2.445130475):0.1679668743):0.4213715787,t214:3.369139569):0.1295811142,(t215:1.659131528,t216:1.532049766):1.835083247):0.392389732,((((t217:1.055787625,t218:0.6740128144):0.3183281095,t219:0.9635982329):0.2902090339,t220:1.200849021):1.705134634,(t221:2.223527189,t222:2.188492864):0.6007576023):0.3380702586):0.6134437919):1.355682532):0.5099634793,t223:5.5168318):2.551780618,(t224:5.870586923,t225:5.796874325):1.854053012):3.346617279,(((((t227:2.230663974,(t228:1.792719584,((t229:1.057777811,t230:1.011393901):0.5074351034,(t231:0.4883589745,t232:0.3612715076):0.7291264345):0.1721617698):0.4271477375):0.03690789451,t233:1.685285679):0.239338632,t234:1.864070167):0.5544123435,((t235:1.266886234,(t236:0.1420417214,t237:0.02885452007):0.9993555265):1.025742687,(t238:1.381120118,(t239:0.04266765775,t240:0.02893652502):1.286830742):0.6400880125):0.01140045525):3.107500283,((((t241:0.9641398579,t242:0.8600019762):0.2073852279,t243:0.9986584312):0.005268069232,((t244:0.5198204882,t245:0.420237009):0.1470963639,t247:0.03048167436):0.192782466):2.77844311,t248:2.994606832):1.01507023):4.42645674):2.439118985):0.6368648753):0.5958696319,(((((((t249:0.4668458532,t250:0.3949098396):0.07737269885,t251:0.4527614529):7.847317355,(t252:1.206010266,((t253:0.2852733121,t254:0.2793147927):0.3367921888,(t255:0.3064632327,t256:0.224557443):0.2539007725):0.5443816738):6.964087937):1.508996797,((((t257:0.2358955552,t258:0.0183749667):0.6706344896,t259:0.6369535656):5.158296561,t261:5.634864414):2.008761783,((t262:0.9100162048,(t263:0.2314854859,t264:0.2202162718):0.6462705664):6.531171559,(t265:5.490611649,t267:5.18891069):1.650233777):0.09943816156):1.414056287):0.08645513253,((t268:1.278370636,((t269:0.871739854,t270:0.7573184496):0.004713054565,t271:0.2732613285):0.3800192358):3.442500128,(t272:0.543894071,t273:0.4965863916):3.490402837):3.639572473):1.528102293,((t274:0.7070423731,t275:0.5885432874):7.421040914,(t276:6.129887302,(t277:4.335197254,t278:4.220787447):1.695843007):1.873461946):1.01137919):0.3007163513,(((t279:2.12250676,t280:2.030294547):3.541523132,(t281:4.770545851,t282:4.692751038):0.7664443577):0.08706078499,t283:5.497349437):3.259684673):0.1770952831):3.113683431):2.236234986):1.583800937,(t284:4.843688834,(t285:1.039252595,t286:0.9575779748):3.662175773):11.00019749):0.4621955428):0.2858967546):0.4204587914,(((t287:2.332384847,t288:2.323689369):0.1579355307,(t289:0.1029556944,t290:0.06213859808):2.363793227):4.78695706,(t291:2.432033544,(t292:0.7047050019,t293:0.3601648762):1.681463729):4.742587256):9.414331698):0.2137952859,((((((t294:4.394516944,t295:4.315096409):0.06899085484,(t296:2.124765014,t297:1.984340389):2.207958694):0.1045705052,t298:4.265598381):1.731943384,(t300:3.462700165,t301:3.365126793):2.486412328):7.18799235,((((t302:1.133968584,t303:1.114028075):3.774231399,((t304:1.887879029,t305:1.870939438):2.61351407,t306:4.429482806):0.3210883988):0.7517420653,(((t307:4.264972986,(t308:3.529444468,(t309:3.218561358,(((t310:2.119045295,t311:2.107103281):0.1508237277,t312:2.142880372):0.41145458,(t313:2.413757214,t314:2.353781901):0.09282182943):0.5183531656):0.1765403724):0.2358784536):0.1084958628,(t315:3.050718351,(t316:2.247726424,(t317:2.142924946,(t318:1.627702673,t319:1.555705485):0.3234292037):0.06325983165):0.7040636229):0.2532787967):0.2969440127,(t320:1.930965986,t321:1.665751104):0.91614185):0.793218592):0.198933257,(t322:2.090538176,(t323:1.762455306,t324:1.674142238):0.3076976497):0.8788615664):7.146248296):2.168249041,(((((((((t325:2.751127593,((t326:1.283166706,t327:1.163950749):1.348208965,t328:2.480908475):0.03974512572):0.0243339418,((t329:0.9130619634,t330:0.8537029014):0.395678354,t331:1.245567552):1.173479236):0.3606545,t332:2.731603424):0.492880244,t334:2.833063071):3.8850102,(t335:4.576259919,((t336:0.213489636,t337:0.1603091453):3.820285264,((t338:0.4390919631,t339:0.4249055235):1.338864485,(t341:1.468893549,t342:1.207072746):0.1037955202):1.666722985):0.4828258036):2.008184211):0.6991040688,((t343:0.9031514122,(t344:0.2732518198,t345:0.2719834157):0.436448776):0.06035200123,t346:0.6975100115):5.046067219):1.896666242,((t347:1.274650505,((t348:0.3318293097,t349:0.2411505424):0.2879263031,t350:0.4569935511):0.5983643597):5.895096896,((t351:2.95054732,t352:2.876707086):3.720962,((t353:2.202001944,t355:1.941271357):3.351411325,(((t356:1.006301439,t357:0.8251491698):3.481494147,(t358:1.095319247,t359:0.7654611944):3.116649285):0.253908221,t360:4.0585464):0.5219537739):0.6846361545):0.2186468465):0.374216801):1.650729226,((t361:1.762991856,(t362:1.225193902,(t363:0.2115860512,t364:0.1367831617):0.9772659933):0.4703542219):1.190578001,t365:2.769716237):4.308129135):0.04309275319,((t366:4.689960342,t367:4.626952576):2.254509352,(((t368:0.6267270694,t369:0.4791317108):0.7156343785,t370:1.186324752):2.744354066,((t371:0.1884120784,t372:0.1674145099):2.921540999,t373:3.002963772):0.746283188):2.756323221):0.0158985807):0.35636229):0.2844551906):0.7765404924):2.296878905,((t374:6.447909582,t375:6.386690276):1.288829314,(t376:6.891145486,(((t377:3.088232567,t378:3.03969486):1.233168698,t379:4.251654805):2.353132634,(t380:6.194708898,(t381:4.611247101,t382:4.415876945):1.240780391):0.2520335419):0.1744470193):0.7052233171):2.446157606):1.893601007):2.692433643):2.278153918,((t383:4.628736612,(t384:3.94049304,t385:3.802793175):0.6738894162):11.10942698,(((((t386:4.33598186,(t387:0.9944443879,t388:0.9455882622):3.283555716):0.5226413669,t389:4.750730241):0.01270246925,(t390:3.312873633,t392:2.579022433):1.291215623):0.07772663663,t393:3.925472613):0.608515895,(((t394:2.37590085,t395:2.244246126):0.9339327929,t396:3.15960346):0.1215355105,t397:3.265291123):1.098625788):9.904645558):0.3530471699):0.7170528184,(t398:7.876064181,t399:7.834702995):7.442497781):0.4989234881,((((t400:3.682169784,t401:3.548169844):2.175658282,(((t402:3.00943321,(t403:0.8593946924,t404:0.8397574165):2.13852875):1.668877591,t405:4.602065269):0.2138150271,((t406:0.8597505919,t407:0.6738995982):1.719835188,(t408:2.000322069,t409:1.806345439):0.1748333083):1.660451339):0.7534226382):0.6758822879,(t410:1.59387353,t412:0.9025657995):3.418576261):2.634051236,((((t413:0.4771588116,t414:0.4378479963):0.3104305168,t415:0.6540640826):0.12695398,t416:0.7796218764):0.6565069044,(((t417:0.2556222191,t418:0.244803088):0.5962176398,(t419:0.646027709,(t420:0.3984439385,t421:0.2763907753):0.2132810442):0.1673932795):0.305639484,t422:0.7437299675):0.2063801641):5.111109986):6.513088559):0.06673638398,((((((((t423:0.2818953392,t424:0.1902309775):1.351329134,(t426:1.072418978,t428:0.7953960248):0.07677228432):0.1040135769,t429:0.9391649276):1.048475188,((t430:1.669719363,t431:1.48704056):0.109493865,t432:1.589451182):0.1700789104):1.579370422,(t433:1.369394708,(t434:0.09739805471,t435:0.03159815857):1.149865091):1.961294652):2.162586963,t436:5.287449591):1.665601123,(t437:6.832375259,((t438:0.5632451529,t439:0.4703946731):3.821625067,t440:4.118928996):2.118258417):0.03961126956):0.7349203829,((t441:1.432007587,((t442:0.1219256816,t444:0.01215265901):0.02001863145,t445:0.03111962192):1.189092525):2.137700308,(t446:1.135251076,(t447:1.011342708,t448:0.939633636):0.1009996472):2.018536698):3.358890843):3.677168575):12.12345301,(t449:1.539665092,(t450:0.3732985327,t451:0.3065357697):1.111302543):20.54119063):17.93151336):67.67165978);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T24.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
