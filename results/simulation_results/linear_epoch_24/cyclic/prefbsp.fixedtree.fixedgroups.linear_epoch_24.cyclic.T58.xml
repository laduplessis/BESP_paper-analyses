<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t494:5.975499097,(t495:5.528247077,(t496:2.951612736,t497:2.944572641):2.313192783):0.3971686695):1.847011045,((t475:0.05693516436,(t465:0.124557095,(t466:0.05137797322,((t389:0.002042605436,(t380:0.1468618892,(t375:0.09731287939,((((t300:0.01628753061,((t263:0.06975627601,(t250:0.1000861787,((t169:0.08269411091,((((((((t72:0.2087375513,((t1:1.314320049,t2:1.253426726):1.787036336,(t3:2.81677275,((((t4:2.339874068,(t5:1.337989676,t6:1.193659441):0.9869365248):0.07619582075,t7:2.230657278):0.3619462954,t8:2.532202599):0.01425259738,(t9:2.467695692,t10:2.409050962):0.07758887805):0.02117171993):0.1057420645):3.567067266):1.247597664,(t11:6.354059397,(t12:5.108754511,(((t13:2.357522835,(t14:2.246262854,t15:2.165670433):0.01234607507):0.1319769755,(t16:2.23512748,(t17:1.940332995,(t18:0.7453717849,t19:0.6579145737):1.026124954):0.2184304139):0.01741448857):1.139056439,((t20:0.1861981102,t21:0.1037611463):2.801417633,t22:2.860845731):0.03668558995):1.464615258):1.17506934):0.6251321478):2.628228318,((t23:1.687872563,t24:1.679924892):3.432716296,((t25:2.422026124,t26:2.3585953):0.9791502357,t27:3.264692892):1.695493422):3.51769253):0.8994582851,(((t28:0.4413149301,t29:0.4312086003):2.801705608,(t30:2.761049514,((((t31:0.8133871172,t32:0.7163451368):0.700451594,(t33:0.4169301864,t34:0.2743185804):0.9964714005):0.6709510092,(t35:1.679944678,t36:1.615291325):0.217509894):0.02589970049,t37:1.842369556):0.5330806352):0.4566712587):0.7397689605,(t38:2.272696461,((t39:0.4355294307,t40:0.09009717854):0.4834316577,t41:0.4829110976):1.293776936):1.172640745):5.315416397):2.357333979,(((t42:1.611353853,t43:1.128586618):2.294130263,(t44:0.4300206464,t45:0.4259063086):2.916205023):0.6928241624,((t46:0.8385634241,(t47:0.7189941499,t48:0.4791904986):0.01667071463):0.386843957,((t49:0.3639495867,t50:0.3525330765):0.2203034381,t51:0.4807766388):0.2777351117):2.773396613):5.972955364):0.08957497266,((t52:1.493648154,(t53:0.816708547,t54:0.7414141874):0.334609228):7.361981805,t55:8.423272094):0.7110860426):0.5328678043,((((t56:0.3277251952,t57:0.3252166322):0.236444153,t58:0.5570731615):0.1048622024,t59:0.6500815674):7.429291239,(t60:7.683732995,((t61:0.66295685,t62:0.4452973519):0.842167216,t63:1.211885291):6.033199242):0.2308559948):1.453085726):0.5046586014,((t64:7.282032212,(((t65:2.348283401,t66:2.323443086):0.1612843276,t67:2.366482832):2.639809476,t68:4.973541859):2.059726726):1.810024615,t69:8.783694423):0.3088590752):0.6582383836):0.4467731556,((t70:6.564231696,((t71:0.8453706278,t73:0.5505004012):1.542261676,(t74:1.415293328,t75:1.311542028):0.6519725412):3.591530099):0.1883592118,t76:5.657867405):3.43446502):6.295772008):1.427670165):0.8487849507,((((t77:0.5241941494,(t78:0.4911593854,t79:0.4769781207):0.004134711143):3.259065144,t80:3.733742226):0.5062468564,((t81:0.2075759489,t82:0.0791977751):3.200437224,t83:3.228762454):0.8178636727):12.24002485,((t84:1.777810972,((t85:0.1608370824,t86:0.09301661488):1.481136879,(t87:0.07488314628,t88:0.07268912724):1.48846308):0.1334760798):3.231347874,t89:4.789554824):11.26621635):1.120188622):2.083240716):4.352270127,(((((((((t90:3.936749664,t91:3.907015711):1.075892487,((t92:1.261953009,t93:1.177592113):1.026855396,t94:1.990834179):2.2996726):2.030699664,(((t95:3.189339317,(t96:2.725862975,(t97:2.274668479,t98:2.102652269):0.4090778499):0.3899071832):0.09478234479,(t99:0.3936981834,t100:0.2710149545):2.578289361):2.686748347,((((t101:2.401920779,t102:2.401011935):1.281219604,((t103:0.1859838846,t104:0.1649228297):2.65571653,t105:2.736012543):0.8291462838):0.6198103632,(((t106:1.232499049,t107:1.162465236):2.076206298,t108:3.142102487):0.7142302331,(t109:1.604878043,((t110:0.6322449697,t111:0.6113041886):0.1714588275,t112:0.6090894789):0.7032832336):2.070558876):0.08925106669):0.4172138034,((t113:2.086744973,(t114:1.49010066,((t115:0.1578334232,t116:0.1321077493):0.7493799013,t117:0.7811752491):0.561278468):0.5207706754):0.2245996666,t118:1.929138317):1.482652708):0.7962839766):0.1484767469):2.283967516,(t119:4.249971529,(t120:2.751586843,t121:2.740164054):1.404851836):2.386444591):3.266203479,((t122:1.059572765,t123:0.9712781044):3.421849015,(t124:3.684881053,(t125:3.433112279,t126:3.424139129):0.1813314654):0.6710818209):5.178244908):2.659852431,(((((t127:3.889866237,((t128:1.657905208,(t129:0.8528200895,t130:0.8403282733):0.7536843385):1.661204481,(t131:2.303625365,t132:2.29719295):0.8917000191):0.501432589):0.04226069752,(((t133:1.525992529,t134:0.7780080821):1.42693711,(t135:0.1623630365,t136:0.08887665624):1.911156096):0.02839621871,(t137:1.601478004,t138:1.51091052):0.4220136076):0.74282418):0.3160624557,t139:2.914136289):1.651073727,((t140:3.460694266,(t141:2.305903668,(t142:1.824969286,t143:1.823937904):0.4628114932):0.9744905908):0.9579724518,(t144:1.803977581,(t145:1.68143421,t146:1.536067346):0.08500068427):2.349141745):0.1158557707):1.636401251,((((t147:0.7076927845,t148:0.5013009271):0.3948142776,t149:0.7174406567):0.0207231673,(t150:0.5383250533,t151:0.4575972893):0.08163558479):0.08472092951,t152:0.5796890265):3.935600563):4.528104402):1.639452943,((((t153:0.3560621783,t154:0.2222521983):1.680858075,((t155:0.3223323571,t156:0.1181852907):1.104095199,(t157:0.8408546883,t158:0.7849961586):0.1662453516):0.344589818):1.719600582,t159:2.972133955):5.003389614,t160:7.935813108):1.900698434):3.545658223,(((((t161:0.1300673365,t162:0.07675041368):7.227231895,(t163:5.013639168,(((t164:0.3134797691,t165:0.3089590864):0.8681761609,t166:1.162993201):2.340149651,t167:3.481450093):1.473197418):2.198302818):0.6982987057,t168:7.849840613):2.499007977,(((t170:5.663590025,(t171:1.123853801,t172:0.8106801533):4.537021724):2.081113509,t173:6.79525297):1.675120183,((t174:1.081736894,t175:1.071579868):7.10921678,((t176:4.246806672,t177:4.017497876):1.876500907,((t178:0.9075412188,t179:0.8678034815):4.6260859,(t180:0.2797819065,t181:0.2457485815):5.151922885):0.3157999814):2.055923869):0.08307174223):0.7441764823):0.5707219366,(((t182:6.169561404,(((t183:4.217295531,t184:4.172715337):0.8419916814,((t185:3.089444786,(t186:2.87142225,t187:2.661461047):0.2047621569):0.5924832867,(t188:2.237705279,t189:2.127041693):1.034660426):1.299194937):0.1404033316,t190:4.389004397):0.8575199935):0.009458648707,(t191:3.222951037,((t192:2.200711125,t193:2.149818771):0.1111738151,(t194:1.496395467,t195:1.495266421):0.696770193):0.834681105):1.91959962):0.7279690591,(t196:4.96171992,(t197:2.619654864,((t198:1.179860695,t199:1.142442844):1.228945548,t200:2.346011825):0.1276435415):2.290848727):0.5989481989):2.247962):1.585959084):1.150318458,((((t201:0.6291528544,t202:0.5762939606):3.74049228,(t203:1.572141822,(t204:0.8791277966,t205:0.8519441996):0.5487699189):2.728171592):0.1726313258,t206:4.291913317):2.978469792,(t207:2.538009806,t208:2.515701674):4.669465676):2.652381952):1.963230182):1.825718252,((((t209:1.781546986,((t210:0.9441590245,t211:0.8971609754):0.3992639947,(t212:0.4434138018,t213:0.40239395):0.7876497468):0.277809098):3.342321062,((t214:2.279467836,t215:2.172457299):1.843913352,(t216:3.686268251,(t217:3.236153128,t218:3.200572921):0.4491888799):0.3190077091):0.6223235766):3.621418562,((((t219:1.851316989,(t220:0.513581593,t221:0.5114011592):1.209932921):1.479799878,((t222:1.201300602,(t223:0.4610142937,t224:0.3619803866):0.7318211795):0.9171455418,(t225:1.47755416,(t226:1.199643005,t227:1.076964591):0.193631993):0.4829317204):1.068425619):2.165382498,(t228:1.36485732,t229:1.354155615):3.559926728):0.03279501501,((((((t230:1.374934355,t231:1.331677354):0.2764879918,t232:1.476359167):0.2851878659,(t233:1.461219061,t234:1.384534173):0.1419081862):0.2082346701,(t235:0.6081891374,t236:0.5837900669):1.089909308):0.8378594434,((t237:1.157634186,t238:1.062613472):0.958461136,t239:1.914148666):0.3551186185):1.020630052,(t240:1.207076916,t241:0.9711027797):2.080573558):0.8375215599):2.672309901):3.21896943,(t242:3.275209874,(((t243:0.8529752362,t244:0.7847114596):0.7206872,((t245:1.186124935,t246:1.139816637):0.1225341334,t247:1.19278112):0.1301057271):0.994187244,(t248:2.148759375,(t249:0.6379137755,t251:0.3444237954):1.488835393):0.1527749373):0.6849564694):6.350780604):1.43079167):0.2963209174,((t252:4.402455813,(((t253:2.059967392,((t254:0.8494716947,t255:0.8471602629):1.048685899,((t256:1.291990796,(t257:0.6201324788,t258:0.555072064):0.4493279318):0.08346204394,t259:0.8372635443):0.3398517544):0.1260275566):0.3929002364,t260:1.533360766):1.337933206,(((t261:1.180168677,(t262:0.7237969596,t264:0.569542396):0.3136800744):0.1720006823,(t265:0.6469672696,t266:0.6332206387):0.3052714597):1.393427825,((t267:0.3555553166,(t268:0.1007952696,t269:0.007920451138):0.2344030999):0.8688832499,(((t270:0.1055692918,t271:0.09825486729):0.3299002927,t272:0.4213975421):0.2327160064,t273:0.4475602518):0.4292166687):1.077515119):0.04920545585):0.5864782729):4.591136529,(t274:0.9823908109,(t275:0.7197904026,t276:0.695517503):0.1889423615):6.164769035):1.657336749):0.6194605613):0.4913460093):0.9251102424):1.383553979,(((((((t277:0.6066410746,t278:0.3162798439):6.473319161,(((t279:0.1890259199,t280:0.1545321727):0.8043630301,t281:0.9056480421):0.4617322129,t282:1.354829545):5.162260618):0.6019243225,(((t283:0.3001199566,t284:0.2779188977):0.04809569638,t285:0.07515446275):6.722932092,(((t286:4.166631592,t287:4.129600379):0.03103562088,(t288:3.785886485,((t289:1.131495798,(t290:0.705519841,t291:0.6320343501):0.3197964876):0.05551982018,t292:0.7833198843):2.329861105):0.3552752766):1.29624144,(t293:4.649126396,t294:4.456115842):0.04629727518):1.298564137):0.04772727631):0.8720795362,(t295:2.531616973,t296:2.499521859):4.096454547):0.5965482673,(((((t297:0.2148441572,t298:0.1890065853):0.9920026763,t299:1.162702486):2.694865654,(t301:2.200214293,t302:2.031256017):1.492396478):1.078186113,(t303:1.583818511,t304:1.577562115):2.606423811):1.991791691,((t305:4.508570455,((t306:2.017244025,(t307:0.9516243657,t308:0.9509734667):0.8722570595):1.623315305,t309:3.445363725):0.7944745141):0.07564734558,t310:4.236213128):1.538284997):0.1774064081):1.309826957,((((t311:0.7939682454,t312:0.7932689092):3.458725508,(t313:3.954935331,(t314:3.186544135,t315:3.020464064):0.6248706173):0.2502029784):0.6008875326,(t316:2.168937529,t317:1.913455174):2.263189015):0.03509520506,t318:4.144649655):2.348777713):1.399128852,t319:7.85587909):0.2443427338):7.604023293):0.01192773249):1.122120645):1.607676941,(((((t320:6.091606688,((t321:5.547148633,(t322:2.085316119,t323:2.083696229):3.381802919):0.2224383991,t324:4.907443845):0.05429319679):1.142190302,t325:6.070099228):0.6409500773,((t326:3.122288958,((t327:2.461870469,((((t328:0.3892376699,t329:0.3743467589):0.1938863701,t330:0.5629591461):0.7915800978,t331:1.345225513):0.5364912266,(t332:1.13306922,(t333:0.7992875132,t334:0.7090781636):0.3044313176):0.72973134):0.5497752081):0.09748732299,t335:2.379408983):0.5410276451):0.6823477473,(t336:2.079270473,t337:2.039207571):1.476367592):2.891558354):1.073300591,(((((t338:2.558731024,(t339:2.132792647,t340:1.88667658):0.4214672945):0.1050833596,t341:2.392677419):0.7486627019,(t342:0.7380032418,t343:0.7293301271):2.193012493):0.06632145309,(t344:2.635955631,t345:2.597300314):0.3465651311):2.042298475,(((t346:0.6349983379,t347:0.4997626064):1.316472129,t348:1.223649025):1.180147272,(t349:2.160574574,t350:2.092422142):0.2032505979):1.810840759):1.949770818):7.677574487,(((((t351:1.194747664,t352:1.069541861):2.97406062,(t353:3.022172969,((((((t354:0.5315262812,((t355:0.1734067196,t356:0.153505728):0.2637851737,t357:0.3479427909):0.06725175932):0.1087048543,t358:0.4756925056):0.6061928403,t359:0.9588428211):0.2992342584,t360:1.117021131):0.457581805,(t361:1.053300079,t362:0.8651777658):0.5183341621):0.7571289592,(t363:1.117781352,t364:1.11101492):1.015597299):0.2243949085):0.9824232199):5.952792463,(t365:7.842024235,((t366:1.892008075,((t367:0.1941199836,t368:0.02263557512):0.2839087412,t369:0.2745093274):1.339928548):0.1829341525,(t370:1.671933801,t371:1.614889222):0.0292649291):5.550073927):1.389770231):0.3199310718,((t372:0.1398353784,t373:0.07923526298):2.063472076,((t374:0.4440577727,t376:0.07853822296):1.164362109,t377:1.201043904):0.2201676662):6.653916147):1.393876171,t378:9.450862243):1.752885577):1.805494419):8.191527058):11.6796222,((((((t379:9.759745406,((((t381:0.4830212089,t382:0.4454435989):0.03807901614,t383:0.427969725):0.8792529094,t384:1.266599833):7.111503352,((t385:3.513045719,((t386:0.2799417952,t387:0.2556341563):0.04228579564,t388:0.05006063739):3.173841386):4.541359514,t390:7.475335567):0.09267904563):0.9829263251):0.7141423712,(t391:6.461243212,((t392:0.06968829305,t393:0.03769649601):5.337508352,t394:5.238721866):0.8503865806):2.266703526):0.2382857328,(((t395:0.1724995666,t396:0.171566739):1.881455128,t397:1.738397454):3.760070921,(((t398:4.573507767,t399:4.497466166):0.2027619233,t400:4.610303928):0.04005154538,t401:4.54801527):0.5383246134):2.467625437):0.2543504151,(((t402:4.091869485,t403:3.980550715):1.082180622,(t404:4.545077453,t405:4.445865423):0.5066153076):1.673305982,((t406:5.517418067,((((t407:4.207047683,t408:4.18807617):0.1044122568,(t409:3.011019665,t410:2.965737434):1.136917397):0.5123949542,t411:4.607692947):0.3606098241,(t412:2.233074316,t413:2.036016067):2.466707048):0.1725948784):0.1448892491,((t414:0.486233485,t415:0.3534136685):1.349644181,t416:1.506667654):2.912741585):0.8388035382):0.7259507312):0.6296794936,(t417:2.314104645,t418:2.260998544):4.057924895):6.362541774,((((t419:4.677495797,(t420:0.8597935131,t421:0.7765012975):3.7779653):0.250042756,(t422:4.313146919,((t423:2.162247385,(t424:1.710316155,t425:1.693120046):0.3267254893):0.5375030918,((t426:0.3752644277,t427:0.2882663469):1.268916201,t428:1.461804628):0.9126070234):1.611585386):0.4310374829):1.066611154,t429:5.467576209):3.112814007,((t430:5.193966063,t431:5.13581777):0.04605808219,(((t432:0.5637884328,t433:0.3065563972):2.312536551,(t434:0.9320296642,t435:0.88530747):1.603348844):1.764165675,(t436:3.009678932,((t437:1.714791932,t438:1.60261335):0.6620934076,t439:1.852198864):0.621269967):1.22515029):0.4765063254):3.224746428):3.565449932):14.71635609):60.81690069,((((((t440:1.776634263,t441:1.483359373):1.787891407,(((((t442:0.214943612,t443:0.2069559037):0.348147852,t444:0.4813232191):0.8390181349,t445:1.294275121):1.153566955,t446:2.392415848):0.1286329437,((t447:0.5613951264,t448:0.4594705291):0.91188641,(t449:1.224764834,(t450:0.847561009,((t451:0.3340228178,t452:0.1749358314):0.06156734899,t453:0.1937911592):0.3644905454):0.2765592672):0.01786471092):0.948921502):0.4261721514):6.280678077,(t454:3.205552245,(t455:0.8119550239,(t456:0.175095152,t457:0.1687175249):0.5209191092):2.318877895):5.280347692):5.21707285,((t458:0.7946788551,t459:0.700519015):2.915195047,(t460:0.7449299858,t461:0.04553864169):2.654852444):9.786003423):8.884595287,t462:21.25277049):57.44540982,(t463:20.51772878,((((t464:1.534060273,((t467:0.901378953,(t468:0.8545423892,t469:0.6856977196):0.02000059692):0.1860703975,t470:0.8677470718):0.292385302):2.671658129,t471:3.495604924):5.508429491,t472:8.910189732):4.075239125,(t473:10.49169513,((((t474:0.9475739237,t476:0.759477447):5.992041797,((t477:0.5835222604,((t478:0.2247791231,t479:0.1147196536):0.2756964395,(t480:0.104864391,t481:0.09307251676):0.2239629338):0.05317326661):5.209218998,((t482:0.3338275806,t483:0.2227827672):4.290233879,(t484:0.7411680431,(t485:0.541635266,t486:0.3933331305):0.1679690993):3.63870062):0.6765390511):0.9563514439):2.618964346,(t487:0.6006365139,t488:0.4925255305):7.850666426):0.3320492668,(((t489:0.8410939342,(t490:0.2255298942,t491:0.06310555147):0.3355275045):5.836647558,t492:6.222140517):0.63990121,t493:6.677105688):1.21606725):0.3276524792):2.453734606):6.657594307):58.09654112):5.008145242);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T58.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
