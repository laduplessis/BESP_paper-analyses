<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t451:1.357026081,(t452:1.07456131,t453:1.07277289):0.2316377229):0.153206986,t454:1.303052057):0.04634931566,t455:1.288393183):1.478835654,((t456:2.270684072,((t457:0.8143184105,t458:0.5549137657):0.007357131316,t459:0.451932502):1.415697704):0.2356473426,((t460:1.275756198,t461:1.202729145):0.3125707938,(t462:0.4438737654,t463:0.3485293798):0.812852538):0.4672218104):0.2071796602):8.822500522,((t464:4.052502956,((t465:1.416728382,(t466:1.018558999,t467:0.7364227267):0.2458224149):0.3895633467,t468:1.116291857):2.238714497):6.393973877,t470:9.533530518):0.1868830938):120.1529869,((((t471:0.601724544,t472:0.5289787812):7.201313971,(t473:2.93346257,(t474:0.327323481,t475:0.3098935201):2.561007003):4.766625376):2.543542904,t476:10.04819101):9.577780203,(((((t477:0.576251189,(t480:0.323808788,t481:0.2431691202):0.1335120686):1.510827467,t482:1.860907072):5.871981615,((t483:3.687821197,(t484:3.185156906,((t485:0.1566570394,t486:0.06706338299):1.584983665,t487:1.345791855):1.257941502):0.492600129):0.1123169086,(t488:2.682371764,(t489:0.3254646105,t490:0.167896648):2.055712396):0.249060609):3.91096551):4.756930026,(((t492:3.918493442,t493:3.867629562):3.126667598,((t494:0.2563221372,t495:0.2347469531):4.939256037,(((t496:1.408669482,t497:1.141757295):1.928751442,t498:3.041572242):0.8086549909,(t499:2.156488878,t500:2.116623865):1.693288194):1.005991178):1.691530952):1.363174683,(t501:7.371079993,t502:7.321931957):0.4091137489):2.503580683):5.348876595,(((t503:5.961194763,((t491:0.1683262195,(t478:0.04570966189,(t479:0.002424992898,(t469:0.1851584771,(t442:0.0125387114,((t433:0.2064740538,t434:0.003249468374):0.009984691089,((((t368:0.08595905405,(((((((t294:0.1099300752,(t253:0.6355431785,((t255:0.1162455395,(t254:0.004880097109,(t231:0.08175566067,((t150:0.03855600648,((t148:0.07739061935,(t147:0.2599977091,(t134:0.0637762682,((t65:0.0856729835,(t56:0.07624038257,(t53:0.03425487428,(t42:0.1392958031,t1:3.601579697):0.8264332847):0.1330205186):1.660039818):0.34653111,(((t2:2.299364256,t3:2.236705418):3.89006929,((((t4:3.117856358,t5:3.024225199):1.041291068,((t6:1.936004645,t7:1.89772227):1.252178544,((t8:2.751199505,t9:2.601110509):0.1288689398,(t10:1.358604205,t11:1.2510817):0.8883600794):0.04961774602):0.8023227043):0.03065408874,(t12:2.850079405,(t13:2.355843169,(t14:2.126150696,t15:2.00035743):0.1832487171):0.4645064942):7.320367137e-06):0.307214256,(t16:0.8143403583,t17:0.6754628739):2.127714061):1.627981268):0.1789682384,((t18:1.551621633,t19:1.486833458):1.26392652,((t20:2.171193996,t21:2.101504826):0.5048634174,(t22:0.759730079,t23:0.7528156697):1.844862195):0.06312015073):1.791142711):0.1834953425):5.730574709):1.12337457):0.274105797):0.1352450519,(((((t24:4.286895155,(t25:2.276896665,((t26:0.2840516096,t27:0.1722113261):1.058120997,t28:1.200948606):0.9157093812):2.000137004):0.7366481849,t29:4.822199329):1.294618458,((t30:0.6648769616,t31:0.5980810322):2.943759054,(t32:3.038330519,t33:2.989547723):0.4705741702):2.464981737):0.1058993144,((t34:0.44162877,t35:0.335459529):4.970216074,((t36:1.012790107,(t37:0.1763999797,t38:0.04828893295):0.7935115703):3.603569211,t39:4.389072059):0.6623809355):0.3904662514):3.221343328,(t40:1.112073639,(t41:0.8453762073,t43:0.2830396646):0.253462033):7.35309523):2.166993921):0.1653401426):5.053897861,(((((((((t44:0.2218363142,t45:0.2125518389):0.03827094253,t46:0.1464047025):0.483257778,t47:0.6262465141):5.040109093,((t48:3.613022665,t49:3.485529982):0.4935214218,(((t50:0.4610518114,(t51:0.2783576856,t52:0.2622297011):0.07827438771):0.5496639416,t54:0.7590772986):1.616488219,(t55:1.24957819,t57:1.098718642):1.115549038):1.248867851):1.533050508):1.663892307,((t58:3.545071976,((t59:0.4246463069,t60:0.2846147288):1.987924455,(t61:1.705999604,t62:1.443725302):0.3728757791):1.03989608):2.552216436,(t63:0.5286478577,t64:0.4423148282):4.746000349):0.2449494699):3.036815701,(t66:7.638622655,t67:7.630197948):0.1618598109):0.9956281372,((((t68:0.08038826928,t69:0.04735742732):5.908374471,(t70:4.662781221,((t71:1.470620204,t72:1.438174612):2.846507661,t73:4.23667519):0.3219373962):1.222096406):0.6733367437,((t74:4.197404845,(t75:1.473375734,(t76:0.2423844813,t77:0.1216577628):1.144701095):2.572929633):1.761796198,t78:5.484460877):0.4222077808):1.249506536,((((t79:3.647092973,t80:3.560942832):0.7224939352,t81:4.263327525):0.06066070745,(t82:4.271774412,t83:4.263158773):0.02327899943):1.735287467,(t84:3.882415069,(t85:1.984252706,t86:1.775427784):1.692952079):2.09658467):0.9201290987):0.6742652558):2.103739999,(((t87:3.069592864,t88:3.040301257):0.9379766542,(t89:2.379317596,t90:2.244628433):1.519097973):1.907217176,t91:5.461196021):3.177229206):1.321643901,(((t92:4.518237011,((t93:4.253701419,t94:4.22387063):0.05546860148,t95:4.193159161):0.2003874667):0.8098595905,t96:5.062137286):0.9311784964,((t97:2.383311116,t98:2.239081971):1.522933708,(t99:3.18894498,(t100:1.227496313,t101:1.132322309):1.857738592):0.4828616776):1.98774554):3.643865817):0.3040078334):1.692122644):2.556989718):0.1457144089):0.2596764561,((((((t102:0.6945714251,t103:0.6849340725):0.9929982732,((t104:0.2821941769,t105:0.2558467539):0.9767730245,(t106:0.2060544864,t107:0.1723628571):0.9497624459):0.2918064602):1.50317919,t108:2.894052064):0.713142348,t109:3.577101995):0.1089207423,(t110:1.982567495,t111:1.907903354):1.623257469):7.310183282,(((t112:2.814317239,t113:2.782275104):2.386329419,(((t114:3.085832226,(t115:1.819114368,t116:1.736576977):1.255210604):0.1579048061,(t117:2.928503606,t118:2.806242872):0.186618091):1.324058595,(t119:2.492316309,(t120:2.141373009,t121:2.127716669):0.2347563787):1.739319346):0.561983678):0.2697251835,(((((t122:2.201943845,(t123:1.951346282,(t124:1.280538275,t125:1.006426701):0.5407063323):0.2193074281):0.2680401129,(t126:0.2651648778,t127:0.1525577516):1.603328487):0.8519949854,(((t128:1.731303825,(t129:1.19483186,(t130:0.9856158155,t131:0.5967385364):0.09677729773):0.5285488901):0.3556256671,t132:1.571602077):0.1560872523,(t133:0.5422231729,t135:0.4110224975):1.148574415):0.1146048791):0.241184136,(t136:0.7501338278,t137:0.6085654623):1.139672489):1.187257941,t138:2.83429773):0.1575367101):5.368855026):2.737184666):0.005251190643):4.068863939):0.4597143374,(((((t139:0.4228900172,(t140:0.1268347697,t141:0.05275733019):0.1493376815):0.02002670978,t142:0.1813110125):0.03520284775,t143:0.2055650198):1.301674422,(t144:0.6268447688,t145:0.6251453664):0.8608835315):7.607832611,(t146:8.622556107,t149:7.80762162):0.4140008655):6.089921383):0.4187765714,(((t151:3.286834946,(t152:0.2436236999,(t153:0.119557899,t154:0.08186127437):0.121892168):2.871259351):3.268301349,((t155:1.100659921,t156:1.01003744):0.6110660751,t157:1.276562279):4.600559769):7.152537697,((t158:1.062188617,t159:1.045452404):8.530447102,((((t160:1.629666693,(t161:1.043171849,t162:0.7904998814):0.5091121148):6.290770111,((((t163:3.887556702,(t164:0.7700706959,t165:0.7458694411):3.105702132):0.7208912764,t166:4.333871265):2.481918777,(t167:1.55611985,t168:1.347083679):4.993816053):0.2892723186,(t169:5.973158106,((t170:2.196131611,t171:2.073196455):3.418498267,((t172:0.1031104024,t173:0.1029385022):2.064460386,(t174:1.281828488,(t175:0.9901140464,t176:0.9433774531):0.223334593):0.7875224195):3.302920899):0.2505795405):0.2865331589):0.1151191582):1.10546907,((((t177:0.4275494719,t178:0.3222462091):0.2715184857,(t179:0.2341052717,t180:0.2027593976):0.265940669):0.7480835832,t181:1.153172597):4.063045434,t182:5.202773568):1.473886139):0.05738812267,((((t183:0.6183872854,t184:0.6047853267):3.557020977,((t185:0.9169782753,t186:0.9108872096):1.222472555,t187:2.04744075):1.920328114):0.8326286185,t188:4.79826423):1.209966711,(t189:1.96243052,t190:1.857069596):3.997574543):0.4945142392):0.4734539893):3.342934675):0.9193617325):1.097136721,((t191:4.541121098,(((t192:0.1440273172,t193:0.1371811454):0.401301335,(t194:0.0756544664,t195:0.008335295829):0.4572572094):0.02627777413,t196:0.4074070518):3.847117584):3.125414812,t197:7.165579756):4.451289995):3.437676692,(((((t198:4.561759364,((t199:0.2549570924,t200:0.1533173988):3.260663946,(t201:2.922568654,t202:2.920464799):0.3310721576):0.9161583595):0.03795181384,((((t203:0.3237048746,t204:0.3038068809):2.436257616,t205:2.679353716):0.6761978911,t206:3.131772978):0.3964024306,(t207:2.544122255,t208:2.286233668):0.838022911):0.1925689039):1.854505784,(t209:2.125012063,t210:2.108082603):3.008702494):5.176767126,(((t211:5.470988375,(t212:5.081983009,(t213:3.393453905,((t214:2.227528102,t215:2.208754047):1.046139836,(((t216:0.8766044632,t217:0.8532949674):1.431142547,t218:2.269808732):0.1967348308,t219:2.464719009):0.6873400927):0.09252949071):1.685562077):0.08021803512):0.4635675022,(t220:4.446982043,((t221:0.8149129504,t222:0.8022113021):1.560713832,t223:2.352147676):2.001043667):0.9867191843):0.5690219306,(t224:2.701782259,((t225:0.5705242073,t226:0.5408759289):0.8261028708,t227:1.298695213):1.262767964):3.203194631):3.775334916):2.736490715,((t228:4.835558219,t229:4.719276039):0.8596431961,(t230:3.476075959,(t232:1.155544826,t233:1.093922928):1.998632531):2.047414947):6.513249448):0.5192898448):0.9665080151,(((((((t234:0.3083109006,t235:0.2692025576):0.7341183983,t236:0.9653560396):2.090782868,(t237:2.591796481,((t238:0.8797710258,t239:0.6877236831):0.5475706923,t240:1.069756436):1.086513504):0.1276066974):1.128486577,t241:3.338853027):0.6070638139,t242:3.883151818):4.994744807,((((t243:2.134932277,(t244:1.613609044,(t245:1.199258892,t246:1.17189845):0.3951190555):0.4760618009):1.129059515,(t247:1.605407919,(t248:1.157810882,t249:1.054934276):0.2735870234):1.562838472):3.279170009,(((((t250:0.8449091379,t251:0.8135858344):0.1399396733,t252:0.8463189763):0.6521887377,t256:0.5732869963):1.607599767,(((t257:0.792658822,t258:0.7444788369):0.0004371365724,t259:0.5763509279):0.864199661,(t260:0.6968381806,t261:0.6784250048):0.6914235995):0.4857171911):1.512428459,(t262:0.1782826687,t263:0.1616737511):3.125883153):1.265039064):1.353272829,((t264:1.20061824,t265:1.172573885):2.511821826,((t266:2.299875759,t267:1.957452167):0.05515667102,(t268:0.8982569442,t269:0.832925806):0.8578910064):0.8053664897):2.192689733):0.7345058834):2.493052099,(((t270:0.8963507561,t271:0.6906835756):0.3179669349,t272:0.9957722407):0.2338894885,t273:1.212742864):6.421195727):0.6260707394):0.7963791985,((t274:6.018720138,t275:5.671578987):0.5434944996,((t276:0.6119993127,t277:0.5473786223):5.459900176,(t278:4.749355378,t279:4.643692613):1.005214568):0.127967421):2.306596043):0.3861857126):1.014955364,(((((t280:1.814552235,(t281:1.052615129,t282:0.8921133044):0.7549592372):3.817177014,(t283:5.439568744,(t284:4.409940549,(t285:2.109160197,t286:2.017871377):2.167823244):1.025874596):0.00135459292):0.04610205709,(t287:4.026656251,((t288:0.3119940971,t289:0.310758721):1.259188604,t290:1.565164358):2.233708286):1.208182667):2.14892932,t291:7.146425066):0.5434785624,(t292:6.185654767,(t293:4.640980105,(((t295:3.567942401,t296:3.243074775):0.3078268101,(t297:0.8678637517,t298:0.8653918148):2.670357434):0.1587359068,t299:3.689458507):0.3922882431):1.541610952):1.452605884):1.07418003):0.02072492596,(((t300:3.761690935,(t301:3.181604422,t302:3.023737189):0.4887978849):0.5660756474,(t303:2.227912489,t304:2.210473212):1.680779794):0.818125934,((t305:0.6272346814,t306:0.5985779808):2.775068765,t307:3.237122324):1.094990634):2.961045622):5.281414818,(((t308:6.348248381,(((t309:2.88759629,t310:2.61268524):0.008612881631,((t311:1.364551374,t312:1.167211754):0.3874755552,(t313:0.5014419067,t314:0.4289602019):0.9561874402):0.8623152411):1.375701556,((t315:0.8353584955,t316:0.6108113925):1.851437537,t317:2.282455287):0.8726092789):1.995729718):0.6182852592,(((t318:1.97269956,t319:1.853806019):1.576830354,(t320:1.982168141,((t321:0.1200351511,t322:0.1029069066):1.599077852,(t323:0.7723407128,((t324:0.2827392285,t325:0.2325956132):0.2473822102,t326:0.4362034961):0.1058942276):0.7693265062):0.1811499397):1.431562351):0.1163813371,((t327:1.583543242,t328:1.516443282):0.2453081201,t329:1.721149295):1.054085307):2.065744067):2.218248804,(((t330:2.243880803,t331:2.218859929):1.375155328,(t332:1.666046447,t333:1.171940744):1.921921538):0.2054753146,(((t334:1.598759639,(t335:0.2173684876,t336:0.1690136458):1.362867356):0.1025685218,t337:1.572498351):1.386910118,t338:2.928277559):0.2081714787):3.165985833):3.259763715):0.1371461315):0.4370201838):2.639769605):0.6286270552):0.007222386479):1.69757078):5.040575673,((((t339:7.408576308,t340:7.387381189):1.000328725,((t341:1.869282029,t342:1.781339371):2.124879847,t343:3.884554161):4.378967656):3.70897029,((((t344:2.155404099,t345:2.069246204):2.5217765,(t346:1.289190625,(t347:0.8908953631,(t348:0.08224372196,t349:0.05894947846):0.6730769856):0.3035921101):3.288270928):5.179675383,(((t350:0.4693623821,t351:0.158103002):1.186466288,(t352:0.6278026091,t353:0.2246591482):0.7133731738):1.743888695,((t354:0.486678633,t355:0.2252393459):0.02041735344,t356:0.07629649054):2.171044605):5.959054162):0.9762379989,(((((t357:1.002766294,t358:0.5140268804):1.133916268,(t359:0.486438748,(t360:0.4077847817,t361:0.3611361694):0.02130945707):1.123245605):1.632755957,t362:3.013045437):3.989079463,(((t363:0.2657549952,t364:0.2618893341):0.1257175743,(t365:0.1671335104,t366:0.1121082746):0.1598613318):0.5311858226,t367:0.6750276786):6.012883):0.6470037003,(((t369:0.2132884547,t370:0.193844322):3.978738519,(t371:1.715746991,t372:1.620214816):2.42060969):0.8915650757,t373:4.633158824):2.073219067):0.6686632158):0.9846032587):3.636060619,(((t374:5.910591153,(t375:5.331962542,((((t376:0.972503112,t377:0.8205669316):0.6190791417,(t378:1.008429516,t379:0.6728707572):0.4289307934):0.3551020912,t380:1.283052758):1.455116255,t381:2.715875342):1.895663995):0.5320374783):0.3037492609,(t382:0.4944343678,t383:0.3899721819):4.940085329):3.921032477,((t384:5.227420443,(t385:4.677654836,(t386:4.263860564,t387:4.188285212):0.4024889533):0.5174173865):1.743223161,((t388:3.515287884,t389:3.437851483):2.247688907,((t390:1.68102352,t391:1.657893517):1.51590856,(t392:2.815209963,t393:2.81492327):0.3032628715):2.38112796):1.022049274):2.099386324):1.622881251):4.377653015):1.6110133):3.349032767,(((t394:4.516586141,((t395:1.446200653,t396:1.383879918):3.007180302,t397:4.339510729):0.02895531637):1.799561711,t398:5.82782879):0.6611255323,((t399:5.922553033,t400:5.813132898):0.3274620819,((t401:2.603118402,(t402:1.736099985,t403:1.632954185):0.7906765088):0.7822669914,t404:3.002949691):2.710918005):0.09225202574):12.48844623):0.01448929895,((((t405:0.3505231484,t406:0.3276486766):8.357263458,(((((t407:0.6178650954,t408:0.4440929391):3.17419358,(t409:2.521333455,(t410:0.3550364085,t411:0.2344069619):2.11640542):0.9907462589):2.012161288,((t412:3.074138024,t413:3.00202717):1.290128208,(((t414:1.62224926,t415:1.594724081):0.8579058029,t416:2.416844595):0.1444282024,t417:2.456981147):1.552675194):0.9169385252):0.2341571617,t418:5.08506599):1.659282013,((t419:3.801102449,t420:3.623793748):2.095255338,((((((t421:0.6843059939,t422:0.5006496218):0.5502392495,t423:0.7903249613):0.1994480778,t424:0.8203873703):0.3355558276,(t425:0.8844293364,(t426:0.1411842821,t427:0.05695912201):0.6406476286):0.1823927265):0.4444034012,t428:1.208430613):2.531774203,(t429:1.819168239,t430:1.808003899):1.80069942):0.92829645):0.832488754):0.9244598845):4.681828626,(((t431:2.82805221,(t432:2.503550052,t435:2.132994731):0.2775808152):0.1230923497,(t436:1.024502338,t437:0.9323810937):1.437816825):3.163247281,(t438:1.211660165,t439:1.189868589):4.320010625):4.811990826):4.696006309,((t440:1.314086233,t441:1.304537438):4.724903215,((((t443:0.5549498115,t444:0.5193499158):0.213469131,t445:0.7177561483):0.4242198956,(t446:0.1479577286,t447:0.1106021818):0.9003868125):4.450778966,(t448:2.892790231,(t449:0.5554826336,t450:0.4663987753):2.191107027):2.487179011):0.1708912456):8.957752592):0.2045383039):6.246418475):1.43485511):109.8599456);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T94.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
