<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t486:0.8605454604,t487:0.652003865):1.269413203,(t488:1.692681267,t489:1.647253094):0.2064501605):1.266166006,t490:3.105081421):1.933477198,t491:4.954100978):72.95969401,((((((t492:3.261276943,(t493:0.5396557153,t494:0.5052410654):2.466868079):1.865347358,((t495:0.9336475933,t496:0.8991262408):1.432690415,t497:2.315207264):2.282015107):2.436918138,(t498:0.4580188491,t499:0.3819563998):6.560574323):2.021776257,(t500:4.334349689,t501:4.309515586):4.598600519):10.02024994,t502:18.9191821):38.55276114,((((((t469:0.1134818461,(t452:0.3562252617,((t442:0.1414947014,((t383:0.02339263045,(((t348:0.1270137608,(t347:0.01776404156,((t326:0.03712025203,((t269:0.01519697363,(((t254:0.08862662015,((t247:0.1270671521,(((((t157:0.04511183103,((t131:0.09192173794,(t72:0.3289788857,(t73:0.1686151358,((t60:0.1571042735,(t61:0.04359045789,(t1:4.51271498,(t2:2.313441365,(t3:1.730892092,t4:1.672191895):0.5753425127):2.087285677):0.936152964):0.05962931122):0.8651773795,(((t5:3.437445267,(t6:2.424572092,t7:2.408588487):1.011899622):0.7756417496,((t8:3.362059747,t9:3.304157525):0.5355613351,(t10:1.709431462,t11:1.589334872):1.898446678):0.07343579338):0.6207407386,t12:4.162355554):1.255206827):0.5781696809):0.04469357551):5.213419419):1.751282454,(((((t13:0.4469670479,t14:0.4421321305):1.772471475,t15:2.040558842):2.562026527,(t16:3.174635284,((t17:0.754091858,t18:0.4288695795):0.3668921907,t19:0.7170941201):1.664707751):1.37553522):6.285842994,(((((t20:1.707068597,t21:1.698915915):1.841384959,((((t22:1.607572127,(t23:1.331137421,t24:1.27234891):0.2338861532):0.6685894729,t25:2.118042426):1.021617291,(t26:2.755970788,t27:2.735075164):0.3763249825):0.1153912325,t28:3.142588681):0.09161135389):1.091377874,(t29:4.067017946,t30:4.037391533):0.1885177481):1.937357891,(t31:3.945691943,((t32:0.7472731782,t33:0.7142547494):1.55105564,((t34:0.3913834482,t35:0.3856806383):0.4519888519,t36:0.7846068445):1.396838113):1.561742469):2.170082564):0.5001491922,(((((t37:0.1584831393,t38:0.1315239985):0.3617503313,(t39:0.4434916458,t40:0.06032244269):0.02239261192):0.2936288986,t41:0.2929318741):0.6449270633,t42:0.691309176):0.2937498993,t43:0.8173734283):4.422952625):2.871861783):1.552256956,((t44:0.19067155,t45:0.1669463319):6.970866169,(t46:7.116272557,(((((t47:0.255906022,t48:0.1920996823):0.06230162858,t49:0.1419929919):0.008546719136,t50:0.05872324799):2.112020975,((t51:0.8870516142,t52:0.8601287736):0.06689795766,t53:0.8962182927):1.075149029):0.4683033398,(t54:0.05172045095,t55:0.02800613022):2.173936751):4.201071426):0.00636622579):2.475356813):0.2814164493):0.9873037119):1.890075139,(((t56:0.5754794184,t57:0.4146886966):9.210929357,(((((((t58:0.5300385748,t59:0.3858490853):1.614026297,(t62:1.479874582,t63:1.451861767):0.2281206815):5.198107998,t64:6.803312913):0.6334863502,(t65:2.049372606,t66:1.98085809):5.285753398):0.1592502104,(t67:1.182842143,t68:0.9900342181):6.015726112):0.2967419413,((t69:4.210635334,(t70:1.324253346,t71:1.00222099):2.874598338):1.290658949,((t74:1.942845361,(t75:0.415216184,t76:0.4006782787):1.463878654):2.517642512,t77:4.238982182):0.1592036965):1.770857384):0.6638582196,((t78:3.748133223,t79:3.728792293):1.649869821,(((t80:1.232589732,t81:1.103462276):0.5457955261,(t82:0.2291316232,t83:0.1994277304):1.405235355):3.283390622,((t84:2.55262167,t85:2.473189512):0.7708269511,(t86:0.05109463927,t87:0.002895001008):3.032202018):1.540528662):0.1736823491):1.348249251):0.4542425018):1.646266323,((t88:3.444026328,t89:3.344645805):2.394337448,(((t90:3.633043444,t91:3.438177409):0.1832946467,t92:3.607509966):1.300535489,(t93:3.794022287,t94:3.775650777):1.076941188):0.5437401702):2.309816948):0.4823767277):3.978327181,(((t95:3.270412533,(t96:2.663823354,t97:2.651941771):0.151063029):1.877139255,(t98:4.005737891,(t99:2.119061244,t100:2.001959455):1.870401662):0.6166515289):0.2808964228,((t101:3.59230693,t102:3.381958279):0.6202756257,(t103:3.777491458,t104:3.674310939):0.2202263086):0.5027185131):6.671995714):1.880040194,(((((t105:3.278844852,(t106:0.9183711596,t107:0.7871925813):2.295254223):2.086748588,t108:5.160937486):0.0882479405,((t109:3.655104708,(t110:0.3804556495,t111:0.1877510837):2.899434213):0.111633988,((t112:1.44269556,t113:1.416149514):0.9120438065,((t114:1.850327901,t115:1.823450737):0.1382213994,(t116:1.126055788,((t117:0.1337058561,t118:0.0556810138):0.9814916212,t119:0.9863430662):0.00638772395):0.7915859918):0.3395469445):0.7351463636):1.427557496):1.447110552,((((t120:0.3512046186,t121:0.1888642318):0.8021936836,t122:0.9308382471):0.86865834,t123:1.787078929):0.1001177274,t124:1.545736607):3.477065913):1.643433917,((t125:4.572021592,((t126:1.832037203,(t127:1.766618975,t128:1.740042089):0.02056193284):1.027494289,(((t129:1.066174991,t130:0.9752923566):0.5550037719,(t132:0.5043686983,(t133:0.1414365058,t134:0.07830429657):0.1684963269):0.8672942134):0.7232385278,(t135:1.535671366,(t136:1.167473903,t137:1.118724128):0.2658850574):0.2873341534):0.22714801):1.685310583):0.01933276455,t138:3.59424109):2.071876211):4.378187591):0.3724293695,((((((t139:2.419200741,t140:2.354650735):0.2305630673,(t141:0.6857113026,t142:0.6228308965):1.880081706):0.4961762687,((t143:2.501038775,((t144:1.941415193,t145:1.436862441):0.2459235411,t146:1.472349043):0.05009187344):0.09178251636,(((t147:0.2842060035,t148:0.2146473933):0.297364354,(t149:0.3433802995,t150:0.3253006652):0.005764989025):0.6082915844,(t151:0.7766738468,t152:0.7588572772):0.05103677216):0.2226175342):0.4016676876):2.304356765,t153:3.6504285):4.593333254,((t154:0.3337033412,t155:0.2093646306):0.8860572164,t156:1.074970604):6.799870829):0.1646947916,(t158:3.890086416,t159:3.82457309):3.923687946):0.1505486082):0.2631305938):0.7985610975,((t160:0.4944507237,t161:0.288270649):7.40196188,(t162:5.649337771,((t163:2.779602552,t164:2.763873919):1.42427162,t165:4.153159212):1.287151241):1.999069105):0.9957740594):0.3523179914):0.3305324236,(((t166:4.741305101,t167:4.476300954):0.09771302025,(t168:2.553755802,t169:1.928286775):2.010507565):0.008911555105,t170:3.925634642):3.749762845):0.0441176305,((((t171:3.892468278,t172:3.760947264):2.506162199,(((t173:1.598450751,t174:1.512335461):0.2496021191,((t175:0.393687257,t176:0.3891576569):0.6293039942,t177:0.973596374):0.7324129409):3.235554856,t178:4.908972084):1.130714088):0.5715495054,(((t179:2.691963049,(t180:1.0342328,((t181:0.8788236167,t182:0.6807892622):0.08481598956,t183:0.6820017192):0.02282410333):1.634639287):0.4795862288,t184:2.665215849):0.7760474268,t185:3.362665459):2.489721503):0.5483984151,((t186:4.576096945,((t187:2.663290601,t188:2.656352022):1.636113212,((t189:2.671979059,(t190:2.432164023,t191:2.286789964):0.1714514197):0.39812885,t192:2.749223142):1.126461819):0.2225191312):0.4574038217,((t193:2.067492517,t194:2.05580345):1.937199221,(t195:3.552315377,t196:3.359672433):0.3957246353):0.2810509791):1.16142704):0.1465968445):1.257371438):1.139572905,((((t197:2.402229732,t198:2.358236186):0.310486616,(t199:0.9927364957,t200:0.943566275):1.636860262):1.520551926,((t201:1.301803007,t202:1.298397359):1.769976749,t203:3.068035331):0.9659374191):0.3096498173,(t204:3.296383699,t205:3.221842189):1.029475809):3.168866113):3.509412958):2.111567727,t206:13.01823896):0.3261880063):0.3696689688):0.5531305406,(((((t207:5.026949961,(t208:2.992703653,t209:2.894453742):1.996841513):0.3120236907,(t210:5.169903681,t211:5.162032726):0.005088750572):0.3383815585,((t212:1.877529229,(t213:0.5348428554,t214:0.5074716296):1.319130239):0.6692487769,(t215:1.167935837,t216:1.144416866):1.279724505):2.89523614):0.7966766607,(((t217:1.644231723,(t218:0.7227711818,(t219:0.3213867101,t220:0.3140221841):0.33862591):0.8362952214):3.528277487,((((t221:2.691636692,t222:2.663031802):0.1077596668,(t223:1.613236103,t224:1.580301742):1.097441081):0.03221673885,(t225:0.900209051,t226:0.7682982128):1.665680433):0.6006903534,((t227:1.64594254,t228:1.557218149):0.7489513881,t229:2.078392205):0.2085881068):1.522188482):0.1953493002,(((t230:1.809458371,(t231:1.432038116,t232:1.333784533):0.3432938588):0.4711225377,t233:1.970902278):1.281463201,(t234:3.017147448,(t235:1.771996374,t236:1.747195559):1.016540679):0.03866002689):0.4079845448):0.7178267168):6.99015322,((((t237:0.1176229071,t238:0.1175989144):0.1871316134,t239:0.2921384263):6.831534928,(((t240:0.3073125121,t241:0.2334753492):2.026316602,t242:2.220559506):1.50424256,((t243:1.791349017,t244:1.624686382):1.392763184,(t245:1.467657682,t246:1.382815825):1.533103503):0.3989747869):3.273929582):3.414879195,(((((((t248:0.2896671319,t249:0.06934796277):0.922094326,t250:0.614075393):0.4854867165,t251:1.05021838):0.4268801878,t252:1.342215282):4.868422489,(t253:4.393477751,(t255:2.075809446,t256:2.074947636):1.941620922):1.771433345):0.9673347228,((((t257:1.721670431,(t258:1.339119325,t259:0.984567733):0.3370333807):0.07865306647,t260:1.276355379):0.4634906374,t261:1.730842876):4.312460465,(t262:3.399502364,((t263:2.073801229,t264:1.945642888):0.2886054955,(t265:1.183563715,t266:1.157215743):0.9290107967):0.8094057402):2.547747769):0.1418082356):0.9848591471,(((t267:5.81043437,(t268:0.43565039,t270:0.2517509222):5.335618883):0.06002581338,t271:5.511394157):0.3364540457,t272:5.53941582):0.1704113117):0.7390842276):0.1998537435):0.7724467133):0.4757037632,(t273:1.175961144,t274:0.9768676288):6.557878236):2.982689217):3.781670415,((((((t275:1.484059413,(t276:0.2251542915,t277:0.1621120391):1.157897152):3.887684599,(t278:4.967742684,(t279:2.206641784,t280:2.136086975):2.672005041):0.2361226222):0.9808271093,(t281:0.4387687368,t282:0.4019922956):5.564188925):1.413371749,((t283:3.95964739,(t284:1.043747831,t285:1.033545192):2.860000019):2.613179369,(t286:1.436429933,t287:1.421747831):5.068334354):0.6874079678):0.9348408381,((((t288:0.8451871047,t289:0.8267664983):3.621322496,t290:4.441110594):1.724148265,(((t291:3.736501564,(t292:1.178486886,t293:1.176215992):2.532955881):0.04991806804,t294:3.718844593):1.253038839,((t295:3.912263846,t296:3.842263374):0.1037306611,(t297:1.809917477,t298:1.731532622):1.91894258):0.8884905239):0.6104340053):1.252229648,((t299:1.751173075,t300:1.73257019):1.46641725,((t301:0.7762338865,t302:0.7656507563):2.03587014,(t303:1.242527406,t304:1.242103578):1.558332062):0.3373483627):2.74699918):0.452899149):4.195966716,(t305:5.61711046,(((t306:1.258370207,t307:0.9924727486):1.904901863,((t308:2.53020694,t309:2.507977225):0.04991086526,t310:2.525391755):0.2894593793):0.4524555723,((t311:1.993124409,t312:1.872761867):0.2313812012,t313:2.075325917):0.9641744444):1.927513299):4.839366984):1.38134541):1.265762828):0.2047567977,(t314:1.837347124,t315:1.832722567):10.82006656):0.8987435517):1.530573434):0.3765034842,(((((((((t316:1.040922874,t317:0.9869504286):0.2094003277,t318:1.026683184):1.671964537,t319:2.631133547):0.2706463294,((t320:2.020448957,t321:2.003300023):0.6192807905,t322:2.619079213):0.2280520588):0.3793046753,t323:3.192238613):0.8007209345,(((t324:0.6240683697,t325:0.5891159503):2.224826172,((t327:1.987845508,t328:1.690999924):0.1234669825,t329:1.711221648):0.4530789193):0.2644389589,(t330:1.563951892,t331:1.232728171):0.8578888166):0.8565741767):2.640768954,((((t332:2.673049322,t333:2.389238696):0.5951449493,(((t334:1.414927915,(t335:0.990736847,t336:0.9527576307):0.3865528715):0.3295223726,t337:1.660500924):0.7513579084,((t338:0.06457220755,t339:0.0577962272):0.04773771899,t340:0.09235283068):2.287316052):0.4188168982):0.0103964396,t341:2.770000977):0.2591474,(t342:2.540185847,(t343:0.2309096681,t344:0.2139870116):2.305710777):0.2015908879):2.018242278):6.299230253,(((((t345:1.395775124,t346:1.272672274):1.175461618,(t349:1.020123261,t350:0.7189840592):0.3832360921):0.4905856664,t351:1.549224399):2.855086391,t352:4.390258345):3.239798767,t353:7.542621031):1.868313947):1.428082052,(((t354:2.882537754,t355:2.822323407):0.8496167928,(((t356:0.5777421735,t357:0.4891457867):1.780356786,(((t358:0.07107209493,t359:0.03451311667):0.1476313404,t360:0.1234634277):0.3499570404,t361:0.3056216668):1.591073104):0.07563772329,(t362:1.129539705,(t363:0.9522733268,t364:0.7570933671):0.09058843329):0.8042455294):1.189152254):3.78636227,(t365:1.897559518,t366:1.861382124):4.725771724):3.269428635):0.6453265067):7.489964044,((((((((t367:0.6967598497,t368:0.663181873):2.017950378,(t369:1.389788824,t370:1.260861996):1.284100696):0.2126325479,t371:2.686917103):3.033186717,((t372:3.505122625,t373:3.47784416):1.423392677,((t374:1.921915386,t375:1.87882917):0.4984678742,(t376:0.3845560509,t377:0.005415019123):1.427087457):2.430931852):0.596337818):0.8653308392,t378:5.030831667):2.273500377,((t379:3.549528474,(t380:0.6234440381,(t381:0.163586096,t382:0.152980704):0.4298283546):2.829009354):1.034591125,(t384:2.079218489,(t385:0.4917913975,t386:0.4704291412):1.569837148):2.136423537):2.607552778):2.728653925,((((t387:6.241863445,t388:6.159784175):0.3964047141,t389:6.550443016):1.819739147,(t390:7.04103977,((t391:3.811426504,t392:3.798570005):0.3325239185,t393:3.921477891):2.776271033):1.315935819):0.6725393538,(((t394:3.709438457,((t395:1.050004377,t396:0.9792696797):1.070788906,t397:2.047873698):1.577074185):2.694284543,(t398:4.257138555,(t399:2.537481889,t400:2.347617065):1.487910039):1.980231621):1.377377578,((((t401:0.2336039529,t402:0.1638832963):2.77787555,(t403:0.6562658061,t404:0.5952800388):2.175590153):0.5977455258,(t405:1.155651961,t406:1.018045287):2.174073319):2.072535782,(t407:3.880995247,(((t408:0.2030263951,t409:0.1957563165):2.062393792,t410:2.254946001):1.104604561,(t411:1.07941722,t412:1.037424667):2.276762957):0.4347438115):1.358540943):1.486943144):0.2957245679):0.3642132247):0.7972121025,(((((t413:1.276531727,t414:1.2551637):1.156860151,t415:2.401844832):2.45683438,(((t416:3.186408864,(t417:0.7970448893,t418:0.7797299342):2.200252173):0.2002045798,(t419:1.976213953,t420:1.796419492):1.181648646):1.398396022,(((t421:0.5763569506,t422:0.5729360528):1.527230487,(t423:1.260829462,t424:1.260171227):0.7870365057):1.717005401,((t425:0.8589918178,t426:0.8449790606):2.647779721,(t427:1.809308916,((t428:1.248177025,t429:1.173439698):0.200878768,t430:0.6997487708):0.3047748075):1.643941989):0.1727451142):0.3504138605):0.06619649843):0.6892596675,((((t431:1.29985625,t432:1.045656941):0.397517444,t433:1.417822567):0.003566917361,t434:1.38388382):1.873291908,((t435:2.01299792,t436:1.926115053):0.8451430853,t437:2.710347758):0.363154364):0.252716101):0.0668733917,((t438:2.422899214,(((t439:0.5209503493,t440:0.4715276945):0.04308481341,t441:0.4878136352):1.684187782,(t443:1.359799282,t444:1.269853461):0.5108873191):0.1698739857):0.1117815413,((t445:0.7670830461,t446:0.6911386033):1.169169698,((t447:1.256737731,t448:0.9746658737):0.4351411914,(t449:0.2662192381,t450:0.246249141):1.142500175):0.1468748044):0.113213866):0.7330721171):2.403379207):5.13463288):1.875602962,((((t451:0.7070729971,t453:0.2903233455):2.138559008,t454:2.140155487):4.433775548,(t455:1.382925425,((t456:0.1503699189,t457:0.05479631714):0.8397666962,t458:0.8444633532):0.3733058903):5.116838032):0.2405830298,(((t459:0.08240619769,t460:0.04699972926):0.8604716606,t461:0.8609550431):2.058520318,(t462:1.651337467,(t463:0.5253899622,t464:0.426851014):1.050973082):1.150556483):3.57283737):4.155410054):0.6943713472,(t465:1.656485998,t466:1.407426878):9.377079954):39.06075328,(((t467:0.7101120533,t468:0.5703201568):0.104575148,t470:0.2640988208):8.562867919,(((t471:7.548957372,(((t472:1.856677517,t473:1.81996487):1.263128168,(t474:1.370807414,t475:1.297344997):1.641154335):4.270844393,(t476:2.848062605,t477:2.580071872):4.326743373):0.1573773928):0.1083866104,t478:7.048296258):0.340422826,((t479:1.048884691,t480:0.8098776581):5.219821796,(((t481:0.5535400629,t482:0.511217546):1.639957317,t483:2.146370651):1.031167493,(t484:0.06015399359,t485:0.007502277194):3.09708027):2.673608718):1.11107461):0.778289251):40.46456098):10.64063595):19.69074537);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T65.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
