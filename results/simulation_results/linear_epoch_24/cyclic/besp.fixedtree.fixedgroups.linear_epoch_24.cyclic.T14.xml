<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t482:0.4321646494,t483:0.4137762584):6.523603656,(t484:4.579505246,t485:4.406864666):2.198864531):1.807956298,t486:8.25891923):20.94018069,((((t471:0.4511280987,((((((t441:0.01359107682,(((t325:0.5188149527,(t326:0.04382062904,(((t269:0.008165774356,((t252:0.07937342257,((t250:0.01523609817,((t237:0.05963673979,(t232:0.2297008637,((t192:0.03478598804,((t177:0.1309951227,t178:0.09270194683):0.09126196884,(t165:0.04897789231,(t161:0.1244759742,(t153:0.001560935249,(((t142:0.2723848024,t144:0.04541002594):0.1830453034,((t145:0.0486163778,(t143:0.0259819053,(t121:0.007966130397,((((t46:0.6445293745,(t47:0.3214931026,t1:5.145360597):0.2610530964):1.024229333,(t2:3.228457512,(t3:0.9361448345,t4:0.8951949334):2.183281596):3.069969992):1.435129719,((t5:2.863554015,t6:2.837125625):0.6713913187,t7:3.415156752):3.978552077):2.787343849,((((((t8:0.9981445413,t9:0.9800166212):2.183838964,t10:3.086046345):1.258189935,(t11:3.022398891,(t12:2.995438048,(t13:2.409580511,(t14:0.3305350795,t15:0.3179965225):2.024047627):0.32607312):0.02246984425):1.311842456):1.433794281,(((t16:1.184516772,t17:1.16938602):1.259507973,(t18:1.795378546,t19:1.574911298):0.6296306256):1.573005159,t20:3.659563248):1.239756424):2.691691698,((t21:1.026965094,t22:1.009314515):3.405478468,(t23:2.416864415,((t24:0.9570171473,t25:0.8865126207):0.5536849779,t26:1.277561815):0.7773429234):1.833354476):2.878581137):1.557613008,(((t27:0.4862174629,t28:0.3471050998):3.327858832,(((t29:1.870413543,t30:1.754991365):0.420527118,t31:2.090762552):0.2979821487,t32:2.117805011):0.9876247672):1.184226794,(t33:3.773260133,(t34:1.258461413,t35:1.233965777):2.469892353):0.3829347766):3.310140748):0.00774109465):1.257909245):1.769274733):0.2346012399):0.0006542259295,(((((t36:1.285960389,t37:0.8145881611):0.7958853861,((t38:0.884558769,t39:0.5895759101):0.4137684474,((t40:0.4215183666,t41:0.4197707649):0.4483260965,t42:0.8433279185):0.088107105):0.2333258871):2.110667446,((t43:1.955382181,t44:1.709263392):0.1940274474,t45:1.830900142):1.067663096):0.6168748551,t48:2.557531438):5.212703792,((t49:1.460928082,t50:1.36380423):1.137233942,(t51:2.079131571,t52:2.018901391):0.3578302724):5.034145939):0.493116013):0.1441923511):0.06807621353,((t53:4.352573398,((t54:1.917876482,(t55:1.261565629,t56:1.229938093):0.6276906646):0.9920115302,t57:2.810782859):1.432168421):2.110476463,((t58:0.1018145133,t59:0.08801888885):3.270388645,t60:3.2467081):2.945427341):1.61708138):0.3282849442):0.3585459768):0.1705133718):1.2142154):1.708993804):2.82152645,(t61:7.267625992,(t62:1.76610953,t63:1.655397161):5.480785853):7.125947227):1.887138246):0.7701259385):0.5080933294,((((((t64:0.5781411855,t65:0.3723377679):8.064675559,(((((t66:5.822073893,(((t67:1.420835115,t68:1.323947246):0.6842174534,t69:1.977030565):2.16709343,t70:3.999300468):1.533381081):0.2906250112,(t71:4.231478493,(t72:0.5691437573,t73:0.558715969):3.605038764):1.559512517):0.789607209,((t74:0.5899898857,t75:0.5882271575):5.096478383,(t76:2.67295759,t77:2.549074506):2.872265287):0.7120626614):0.9758869901,((t78:1.374421748,t79:1.277753973):3.966838726,((t80:4.229437623,t81:4.140445947):0.1211514654,(t82:0.93166477,t83:0.8500620229):3.265847215):0.8395819939):1.607263796):0.03236480178,((((t84:4.09285272,(t85:0.09417485109,t86:0.09074526362):3.886821796):1.865585871,(((t87:2.788924731,t88:2.76412894):0.4871783338,(t89:2.449289428,t90:2.439862136):0.7780443133):2.052921185,((t91:3.477920151,t92:3.420829241):1.543764976,((t93:3.303619376,t94:3.187685745):1.028191001,t95:4.214990137):0.4199988241):0.2391697521):0.2996689826):0.1762021371,(((t96:0.05136159005,t97:0.03427796707):1.595384203,t98:1.621199816):1.679914261,(t99:1.882166507,t100:1.757345656):1.298274391):1.724258455):0.233205378,(t101:4.050668222,t102:4.02798316):0.8880128687):0.2184471608):0.2586635812):0.7522264844,((t103:4.032966462,(t104:3.029213428,t105:2.9800099):0.9948957512):0.2259492823,(((t106:0.4673546256,t107:0.2119610502):0.2692181942,t108:0.3717369857):0.4522431513,t109:0.792429567):2.946434446):1.817279841):0.3755504632,(((t110:3.085533702,(t111:1.256735092,((t112:0.5824862701,t113:0.5390468222):0.1441972918,(t114:0.6131396632,t115:0.5452583631):0.01047385377):0.4101731489):1.749027361):1.314026783,(t116:1.509852353,t117:1.39307457):2.417390945):0.3940226335,(((t118:1.390163723,(t119:1.054717064,t120:0.8662396027):0.3312704915):0.5222423104,t122:1.164036106):1.366058895,((t123:0.195603106,t124:0.1402279849):1.483415714,((t125:1.037673296,(t126:0.3790905684,t127:0.3379554072):0.6508068284):0.2224993459,t128:1.200811543):0.32449452):0.6999141748):0.8174718613):1.122084599):6.466425068,((((t129:3.040337273,(t130:2.344366218,t131:2.318202359):0.6788179255):0.9894732985,((t132:0.9330798834,t133:0.8867803849):1.826062858,t134:2.696107655):1.219352944):0.8217371733,((t135:0.6135117035,(t136:0.3378207394,t137:0.1793723589):0.05496235769):2.485714855,(t138:1.070591327,(t139:0.6506024407,(t140:0.1142875724,t141:0.02721605683):0.4311774791):0.1627813258):1.61578653):1.559648673):1.774105446,((t146:1.831063086,t147:1.739461744):0.433139445,t148:2.17016903):2.783159297):3.871849895):0.4813793893,(t149:1.995540404,((t150:1.392148862,(t151:0.7455964081,t152:0.6871053583):0.5939060624):0.3329004059,((t154:0.07266764521,t155:0.002583960458):0.4933643127,t156:0.445805985):0.9825746449):0.1941489477):7.249428571):0.4337137078):0.6457197697):0.07646194377,(((t157:2.847193555,t158:2.824517123):5.184545479,((t159:3.594511903,((t160:1.498953669,(t162:1.300284599,t163:1.29271344):0.06062990318):0.6696944812,(t164:1.622535668,t166:1.450610747):0.3683442173):1.418296517):3.283492411,(t167:2.768943391,(t168:0.7162933231,(t169:0.1777316364,t170:0.06880971129):0.4688620212):1.954335418):3.706759134):1.129960482):1.749075839,((((t171:3.784742138,(t172:0.191898951,t173:0.06869064517):3.582262661):1.564249272,t174:4.976037914):2.733707405,t175:7.639155272):0.2593357526,((t176:5.951862137,t179:5.509387282):0.3004061036,(t180:0.7412527121,t181:0.1830994102):4.946635905):1.580560434):0.639452079):0.1812066222):0.04111515239):0.1106911961,t182:7.519198674):1.454396725):3.992980271,(((((((t183:0.9056653345,t184:0.8961806747):5.655788606,(t185:3.839529882,(t186:2.675311774,t187:2.631519136):1.152121416):2.487592905):0.1718146431,(t188:4.917105512,((t189:0.3584925262,t190:0.1866338328):2.596833718,t191:2.760621041):1.911125365):1.486009238):1.360434215,(((t193:3.510769786,t194:3.40195249):0.0003041360903,(t195:2.663138635,t196:2.370303934):0.7180879458):3.180073053,(t197:2.06471835,t198:1.951702051):4.19504858):0.280240374):0.6474825262,((t199:2.308739227,t200:2.261595621):3.385682602,(t201:3.262939814,t202:3.200246987):2.33248256):1.225839472):0.7052369647,((t203:3.753772312,t204:3.738185131):0.3689731514,t205:4.105753781):3.182731733):2.150498584,(((((t206:1.873540762,t207:1.826031864):0.1546881311,(t208:0.356898635,t209:0.1907691097):1.513005861):2.953590336,((t210:1.277077423,(t211:1.066100068,t212:0.9460168512):0.1769162595):2.274676855,t213:3.376652433):1.064603935):0.4496544769,((t214:4.3244856,t215:3.922225183):0.2838078182,t216:4.07982658):0.2618889681):1.280937972,((t217:1.365657629,t218:1.357557561):3.413194074,(t219:3.477474583,(t220:3.372404227,(t221:0.8163337583,t222:0.6568583735):2.551881297):0.09653448713):1.267387384):0.5999359998):2.488013526):1.367059537):1.216302926,((t223:4.409377251,(t224:0.7291476681,t225:0.7135575466):3.629072059):0.382217489,(t226:0.398744121,t227:0.2434050448):4.197620653):4.830463894):0.516563865):0.1016613254):1.070554586,((((((t228:2.747235523,((t229:0.1327702059,t230:0.0902472991):2.285003226,t231:2.343926359):0.2920635108):1.775329399,t233:3.980765629):0.1102530648,(t234:0.763060347,t235:0.5526937165):3.136926538):0.356637674,((t236:2.273545587,(((((t238:0.7202440943,(t239:0.244809579,t240:0.2346005909):0.4193475113):0.583606288,t241:1.007158697):0.09555691055,(((t242:0.3482733041,t243:0.06580938562):0.427653041,(t244:0.1994954985,t245:0.1867699939):0.2844183339):0.1534316428,(t246:0.3705723639,(t247:0.1160432713,t248:0.05161711132):0.05736827031):0.1926961789):0.1374412124):0.02478285978,t249:0.4629058333):0.3548197643,(t251:0.1879276024,t253:0.06022323587):0.4333473579):0.3523258384):1.02295487,(t254:0.9527115185,t255:0.8881333471):0.896252741):0.6141749909):1.847044797,(t256:1.650110129,t257:1.520930011):2.594345368):2.663011538,(t258:0.5821326274,t259:0.4187299401):6.031146588):1.42638309):5.07262998,((((((((((t260:2.60828044,(t261:2.039030015,((t262:0.9165638458,(t263:0.5540743337,t264:0.3751815345):0.3241753452):0.4286280097,t265:1.046129776):0.6557377874):0.4694417787):5.364823851,(t266:0.5873418264,t267:0.46199121):6.825244426):0.09695206465,(t268:4.300805269,t270:4.196693943):2.848872109):0.443429146,t271:7.174654394):0.04233364361,((t272:1.254965207,(t273:0.736030722,t274:0.7208754303):0.3068719741):5.586533865,t275:6.474674995):0.2862203608):0.2514292553,(t276:1.489470895,t277:1.447100271):5.48786642):0.04553878236,t278:6.965281755):0.4602081818,(t279:3.349493859,t280:3.236517903):4.060621163):0.6921799075,((((t281:5.341545969,(t282:4.385673017,t283:4.227858891):0.9519850729):0.4642115643,(t284:0.2420461888,t285:0.1858712614):5.329440204):0.728330336,t286:6.156512774):0.2841157276,(t287:2.934832116,t288:2.912348284):3.476375663):1.127792102):0.2448923858,((((t289:0.3161225914,t290:0.2792403488):5.993047456,t291:6.234336556):0.1194546072,(t292:3.989955073,(t293:3.633290092,t294:3.576282986):0.05557394366):2.33062754):1.153230874,(t295:4.313080368,(t296:3.1908036,t297:3.148183387):1.05454845):2.782298895):0.0966754091):2.651127019):4.514758379):1.253665636,((((t298:7.271207123,((t299:0.5887901043,t300:0.5298811594):4.991105469,((((t301:2.829784993,(t302:2.201720465,((t303:0.7194309503,(t304:0.4626812558,t305:0.4517180273):0.2214922786):1.211587801,t306:1.782998929):0.2655375066):0.5758742026):0.05912343158,t307:2.682431124):0.3038501213,t308:2.907367066):1.714939426,(((t309:3.447702028,(t310:3.059631843,(t311:1.810899555,t312:1.691097294):1.036780242):0.1416562715):0.4245459816,t313:3.282657938):0.2823731176,(t314:1.816645843,(t315:1.114548663,(t316:0.4532724111,t317:0.02282107295):0.6197929454):0.6221869697):1.729761034):0.3590295362):0.2960172056):1.522585994):0.2529433909,(((t318:2.095935447,(t319:1.640200511,(t320:1.602160919,t321:1.499583595):0.006067209982):0.3492901044):1.075350673,(t322:1.341532195,t323:1.221215489):1.442756659):0.9871437774,(t324:2.870490496,((t327:0.4403766807,t328:0.4195053437):1.689211693,(t329:1.461520395,t330:1.39533196):0.6311334562):0.1856202725):0.7141527527):1.064399523):3.031774414,(((((t331:0.2632658498,(t332:0.1796237054,t333:0.05460051875):0.05480619627):0.3233097083,t334:0.4065879934):2.281556024,((t335:0.3895780993,t336:0.3372225858):1.879722973,(t337:1.982248867,t338:1.978605721):0.1736879658):0.3758722564):0.2537279512,((((t339:0.3495900351,t340:0.2590215639):1.29266739,t341:1.507016887):0.2687374415,t342:1.647832391):0.5851796022,(t343:0.1897108627,t344:0.06429871756):2.025417557):0.2375197841):1.56763894,(((t345:0.613663805,t346:0.2744038578):0.4706776543,t347:0.4859392362):0.4049436793,t348:0.8331691769):2.069864842):2.248205278):4.575257261,(((((t349:0.3773445926,t350:0.3231393081):0.8838474069,t351:1.117745504):1.157758131,t352:2.208853875):1.450280309,t353:3.522703904):4.720682496,(((t354:1.577465918,(((t355:0.2165079868,t356:0.1246245552):0.410401676,t357:0.516466834):0.6925078567,((t358:0.1768259448,t359:0.1511657779):0.4836321474,t360:0.5998346425):0.4621736891):0.2543826381):0.5849742488,(t361:0.4604080938,t362:0.2376035381):1.319047725):4.851633068,(((t363:1.410686419,t364:1.369547794):2.738299139,t365:4.075186204):0.8313336664,(t366:0.8312573487,t367:0.7724070533):4.01316544):1.317772662):0.9732158053):1.094774831):0.1773438378):0.02139640354,((((t368:3.08254032,t369:3.0395401):3.219354633,(t370:0.7288554247,(t371:0.38094538,t372:0.3260287677):0.3190841712):5.47519768):0.1278493035,((t373:4.803858931,t374:4.575462898):0.4608855696,t375:4.966965279):0.8677650303):0.4436659834,t376:5.795778121):1.419908837):0.6593073027,((t377:3.87422346,(t378:2.977190637,t379:2.859027029):0.6403094627):2.607534237,((t380:0.8847618675,t381:0.7564964535):4.867780524,t382:5.61097765):0.3457152521):1.362896545):1.179222492,(((t383:4.606351341,t384:4.527869754):1.737428248,(t385:1.084421738,t386:0.8951572766):4.982208508):1.046243242,(((t387:1.110273797,t388:1.064123797):3.699619411,t389:4.274675966):1.536170282,(((t390:4.584927458,(t391:1.359742562,t392:1.254055109):3.145025471):0.3021608912,(((t393:2.106030579,t394:2.100629618):0.928980438,t395:3.011283894):1.606089504,((t396:1.606617955,t397:1.554613953):2.098701986,(t398:0.4319198216,(t399:0.3270422833,t400:0.264849806):0.05026140966):3.1297421):0.8875621419):0.04890992953):0.6916881432,(t401:4.934506576,t402:4.917494787):0.1018972288):0.1860018025):0.4964094102):1.071056916):0.6922382182,(t403:3.52048627,t404:3.514611684):3.918344521):0.5716932361):5.093083735,(((((((t405:0.5821249017,t406:0.4579561927):2.477544152,t407:2.848438456):0.9489307429,((t408:0.9204319221,t409:0.797349851):2.469078891,((t410:2.603166006,t411:2.51428852):0.4746005468,(t412:1.761570289,t413:1.72835522):0.9983996034):0.1747994651):0.3309977862):0.05924291536,t414:3.276237772):0.4984634381,(t415:3.035326191,((t416:1.274266486,t417:1.11212946):0.7995546408,t418:1.653539053):0.7633647649):0.7187297274):1.763007251,t419:4.833089424):0.1093612635,t420:4.917922684):6.639453298):1.511046768,(((t421:1.438537591,t422:1.430138761):1.655297271,t423:3.04292427):7.941170111,(((((t424:2.623257688,t425:2.33746258):0.2751546526,t426:2.191914673):0.5715659681,t427:2.675694817):0.8878303024,(t428:1.483916874,t429:1.339304745):1.817539492):0.1944351062,((((t430:0.9919151125,t431:0.9856920467):0.004004382056,t432:0.9739005036):0.7452600751,t433:1.714231734):1.066891995,(t434:1.213216599,t435:1.062667905):1.492193389):0.5389242258):6.180197395):1.946437601):1.479374346,t436:12.66661178):21.97493693):8.159424539,t437:42.72121816):0.2496617648,(((((((t438:2.542189676,t439:2.542151566):1.331136684,(((t440:0.5125857864,t442:0.3618371611):0.4768331617,t443:0.7726367652):1.810022371,t444:2.424902177):1.026403367):0.8466101492,((t445:2.004163063,((t446:1.235861253,(t447:0.4564063781,t448:0.3053692872):0.7272889974):0.6498064321,t449:1.679665338):0.0202630775):0.06964042239,(t450:0.7842768499,t451:0.7245543495):0.9354222364):2.202532513):1.332518395,((t452:1.139766072,(t453:0.9322710142,t454:0.7675221732):0.08960614909):0.3909448807,(t455:0.716996159,t456:0.7165026717):0.1078643607):3.388069251):6.172204262,t457:10.00021288):4.504566203,(((t458:0.01748047324,t459:0.00647813847):5.476979258,(t460:2.477758571,t461:2.286269483):2.936314799):5.463124095,t462:10.58079352):3.370790819):23.35309426,((t463:9.824734353,((t464:1.288684391,((t465:0.4762031836,t466:0.2516386122):0.1075646266,t467:0.270580335):0.5666537299):2.768943258,t468:3.281828179):5.709281499):8.211210565,(((t469:6.89078499,((t470:1.737823824,t472:1.158148928):4.758236419,(t473:1.542470624,t474:1.518142151):4.353680271):0.2858251506):1.071091646,(t475:6.956063802,(t476:1.564837508,t477:1.544712331):5.36431043):0.1883526227):0.1211106197,((t478:1.391732118,(t479:1.186765066,t480:1.150644886):0.1713969394):4.336621184,t481:5.646507134):1.483398954):9.020165515):19.20932798):2.82680708);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T14.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
