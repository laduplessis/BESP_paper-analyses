<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t486:1.066801498,t487:1.045620907):4.204256862,(t484:0.04249935707,((((t436:0.1543545689,((t413:0.09690362574,(t405:0.01806678422,(((((((t281:0.05730988292,(((t246:0.09119873351,(t245:0.1609016709,((((((t71:0.09554721579,((t42:0.509347873,(t35:0.06342116392,t1:3.016869927):1.421840131):1.007206111,(t2:2.752203325,(t3:1.265235447,t4:1.176336922):1.406153135):2.535039391):2.503548638):6.006249111,((((t5:3.022999314,t6:2.937105883):3.170173541,t7:6.10459906):4.384676199,((((t8:2.617249788,t9:2.427864858):0.8989165613,t10:3.275010809):4.354072773,((t11:1.42868492,t12:1.412246391):2.464101534,t13:3.759123822):3.515607037):2.160350721,t14:9.264473907):0.05508083794):0.3319035599,((((t15:0.8864149105,t16:0.6900489329):1.111167585,((t17:1.3746047,(t18:0.2964721905,t19:0.2839246248):1.050392258):0.2216699475,t20:1.547601949):0.2046533198):1.061833493,(t21:1.750809186,t22:1.530281929):0.9950275461):0.3462548029,(t23:0.9368824325,t24:0.9070386872):1.839031692):6.217348425):2.654866726):1.692286815,(((((t25:1.471721841,(t26:0.7602484168,t27:0.7423912229):0.7009886451):3.635753183,(t28:4.214980701,(((t29:1.509003609,((t30:0.5156492593,t31:0.440060632):0.08830514885,t32:0.4885389128):0.8470276106):0.804296088,(t33:2.00868369,(((t34:0.5908068049,t36:0.4730689766):0.09458124079,t37:0.5330246355):1.013710477,t38:1.501031282):0.3063508684):0.1253969535):0.293803168,t39:1.942651793):1.487486893):0.708384842):1.157908668,((t40:0.9557748303,t41:0.8997009788):1.667884723,(t43:1.137890442,t44:1.050659312):0.6397201304):2.388525646):4.297161516,((t45:0.611486668,t46:0.5616210897):5.381335234,t47:5.713314705):2.293180906):0.5072607549,t48:8.439967376):2.149416117):1.105090456,(((t49:2.084284712,t50:1.91104523):0.8136662396,((t51:0.5645210694,t52:0.4298649056):1.435313253,t53:1.419557921):0.6973444606):6.487693159,((t54:4.647782617,((t55:2.423231399,t56:2.221460433):0.9784031125,t57:3.138164055):1.062941246):2.476347414,(t58:0.2663265466,t59:0.25853079):6.025715661):1.410874445):2.08269603):4.17401289,(((((((t60:0.9422888885,t61:0.8182417646):4.356091648,t62:5.153453124):0.3410747294,(t63:3.529970747,(t64:0.8642819645,t65:0.8579479623):2.565699866):1.897419263):2.656076168,(((t66:6.060012959,t67:5.768056461):0.5641123219,t68:6.291306956):0.1736722186,t69:6.411832336):1.173845225):0.111185381,(((t70:3.196234754,t72:2.847808772):3.672132744,(t73:5.58317339,((t74:1.731513381,t75:1.668474909):1.157712668,t76:2.622493962):2.691215367):0.8064578978):0.5200009172,(((((t77:0.2000500847,t78:0.0442067141):1.272420051,t79:1.217809043):1.647454937,((t80:1.802403643,t81:1.67312608):0.7915851152,t82:2.376091738):0.2514593512):0.4309019215,(((t83:0.9733912052,t84:0.9236616055):1.514164642,t85:2.434810056):0.2865636154,t86:2.666419258):0.1822172781):2.311273826,t87:5.102877005):0.7005563676):0.2971695701):0.6112720209,((t88:5.547385065,((t89:1.354809519,t90:1.329006016):2.563625249,(((t91:2.708808834,(t92:2.282621117,(t93:0.6441864441,t94:0.622487552):1.568822425):0.3956449738):0.6757279862,(t95:1.782592281,t96:1.769650693):1.392683419):0.1207223335,(((t97:1.497624152,t98:1.421838042):0.7899193745,((t99:0.912915038,((t100:0.2121500181,t101:0.2089897673):0.4466319753,t102:0.4979094046):0.2496817287):0.4635287761,t103:1.182680274):0.8042321814):0.6665531364,t104:2.648950542):0.3137820767):0.16899784):1.601496904):0.2477228594,(((((t105:0.7146016584,t106:0.6696307628):0.9580323038,(t107:0.9217576276,(t108:0.758592756,t109:0.4657441909):0.158241568):0.6798752245):0.2221481951,t110:1.516376042):0.9141461377,t111:2.300598498):1.739232204,((t112:3.002641289,(t113:1.922104863,t114:1.90427342):0.9672328216):0.09511914718,(t115:0.4379404779,t116:0.4309655107):2.515382017):0.8765466133):0.3749400449):0.9119180123):3.320339239,((((t117:3.530794614,(t118:2.196450017,t119:2.151691741):1.152946497):1.406129729,(t120:3.046611168,t121:3.001792703):1.159145261):0.2399337734,((((t122:3.307229833,(((((t123:1.133699473,(t124:0.831706209,(t125:0.7006075524,(t126:0.2638074359,t127:0.1955956424):0.3656647572):0.1283276716):0.2185970142):0.1776128553,t128:1.024056743):0.8718049829,(t129:1.287537682,(t130:0.7010246109,t131:0.6829150653):0.486692451):0.5711664296):0.1498874429,(((t132:0.3142825288,t133:0.2515553024):0.731692719,t134:0.9073118334):0.3138070779,t135:0.7355729664):0.4169543489):0.2588992505,t136:1.146590837):0.6888836691):0.03713655667,(t137:0.6083906227,t138:0.391930906):1.248903128):0.3283894034,(t139:0.5913067822,(t140:0.3839378494,t141:0.3297495667):0.1327076971):1.269573052):0.04531852215,((((t142:0.07479908883,t143:0.03568807438):1.098556554,(t144:0.3768852273,t145:0.3724332823):0.7049066648):0.1608950924,((t146:0.5559472661,t147:0.5466071605):0.5446144255,(t148:0.5082165441,((t149:0.04458190396,t150:0.04218651296):0.3063997655,(t151:0.2898243363,t152:0.1008007192):0.0447713583):0.0902128774):0.5562186653):0.1122435394):0.1780424951,t153:1.060870801):0.1848509889):0.5637005905):1.929229162,t154:3.492865011):1.301874904):1.466857595):0.08750699607,(t155:0.6274932079,t156:0.6263167128):5.660780142):2.710662034):0.2195208918):0.5166432087,t157:9.726679576):1.151463369,(t158:1.111905523,(t159:0.3869932166,t160:0.3528368783):0.4619375561):9.761313719):2.290441131):1.469125391,(((((((t161:2.199148842,(t162:0.3017975489,t163:0.112973937):1.836441118):0.06149602185,t164:2.009376228):1.747238682,(t165:3.04920455,(t166:0.5687186163,t167:0.5628773913):2.380385918):0.6381091406):2.450121111,t168:5.932537346):1.528636397,((t169:0.3407688394,t170:0.2082530723):0.04127095961,t171:0.1763291695):6.628095805):1.294794879,((t172:5.571985111,t173:5.56955265):1.835984669,((t174:3.81182338,t175:3.671755654):1.412535567,(t176:0.8533014929,t177:0.717384552):4.178341827):2.152972019):0.6409381252):0.4917696969,t178:7.956246638):4.469689674):1.526573623,(t179:13.56212649,(t180:4.825116915,((t181:0.2859494337,t182:0.2726486424):3.980729369,t183:4.252798458):0.4587054099):8.661765912):0.3428245188):2.348684399,(((((t184:3.833047085,((t185:2.399410012,t186:2.371586991):1.255725689,t187:3.311856916):0.06241943996):2.42503467,t188:5.751721307):0.9505342382,((t189:3.404570799,t190:3.209122995):0.3889361367,(t191:1.330310922,t192:0.8498537719):2.068759089):2.887558475):0.0953811811,(((t193:1.761915933,t194:1.531875266):1.798550763,t195:3.29500206):0.6618333051,((t196:1.2163567,(t197:0.06426562793,t198:0.04453499155):1.138982469):1.063735571,(t199:0.6208196917,t200:0.5672358699):1.483190367):1.59320175):1.625453):8.417116512,((t201:1.340682405,t202:1.22021649):4.710472748,((t203:3.522361415,t204:3.360975104):1.052359873,(t205:2.421724437,t206:2.209872477):1.990154528):1.32490154):7.617168209):0.3411558511):0.1956211608,((((t207:1.12231549,t208:1.08437155):3.908085447,(((((t209:1.61860602,t210:1.615720522):0.880035422,(t211:0.6992786822,(t212:0.2058429328,t213:0.1602564386):0.4246921624):1.529991715):0.6147231332,(t214:0.3111512674,t215:0.304824388):2.365533709):0.3745984527,t216:2.984807721):0.8279719343,((((t217:1.626339095,(t218:0.05684932876,t219:0.0438593295):1.344967328):0.4367721265,t220:1.811060684):0.1533191568,t221:1.822859646):1.260789615,(((((t222:1.065894075,t223:0.808623058):0.2968373139,(t224:0.175846774,t225:0.04035094877):0.924718301):1.397227382,(t226:1.807883524,(t227:0.7474591509,t228:0.735292092):0.873982636):0.4877958084):0.1221050281,(t229:1.538822713,t230:1.319270664):0.6425271998):0.01382055485,(t231:0.9669506946,t232:0.8655633485):0.8437246285):0.1775574824):0.3093252889):0.6607482827):6.926711895,((((t233:3.419288537,(t234:0.08477867474,t235:0.0306498095):3.191085962):1.646158891,((t236:1.493160924,t237:1.234958188):2.533026135,t238:3.727246291):0.8389328181):0.2711223622,t239:4.604502285):4.335145296,((t240:2.531140624,(t241:2.244533429,((t242:0.1516239689,t243:0.1385893593):0.3199817909,t244:0.3524844914):1.336511183):0.1639804261):1.502291224,(t247:1.563877291,((t248:1.003894841,t249:0.971137715):0.03499115672,t250:0.9936404842):0.5231523718):1.251447184):4.853364692):0.08055728631):0.6050126657,(((((t251:0.6007378094,(t252:0.1256475275,t253:0.112351308):0.3512265052):0.1468796116,(t254:0.3174765382,t255:0.06597533006):0.2477693153):0.07465433518,t256:0.3620916896):0.8628628982,t257:1.106425663):0.4707870171,((t258:0.3723991757,t259:0.2999732207):1.092120632,(t260:1.223803179,t261:0.8023650513):0.07569522353):0.07811310308):6.144835177):1.11670108):0.1677914555,((((t262:2.981350586,((t263:0.8483318788,t264:0.6064631323):0.3479972219,t265:0.9497355945):1.772922164):4.316317244,(t266:1.13787075,t267:1.012632944):5.74100678):0.3462558625,((t268:1.612634214,(t269:0.7896595541,(t270:0.603695693,t271:0.2349330406):0.1526236213):0.6110317207):2.086205165,t272:3.050058579):2.651752357):0.4805235596,t273:6.117533352):0.1949413289):1.152236395,t274:7.414332441):5.579092765):0.5343705914):0.5626599544,((t275:7.613455039,t276:7.337965296):5.28095209,(((t277:3.132429233,t278:3.09829143):2.478212066,t279:5.513627775):1.859295345,((t280:3.404690418,(t282:2.551733379,t283:2.157576351):0.3555464757):3.394161435,(((t284:2.739185289,t285:2.662005887):2.265869518,((t286:1.7647181,t287:1.680741398):1.505871791,t288:3.142778274):1.580856601):0.4259368687,((t289:3.725965687,t290:3.688314133):0.3876413836,t291:3.957421911):1.015597382):0.3361911339):0.55575165):5.139192706):1.130586425):1.751983014):0.9894805074,(((((t292:1.2391044,t293:1.157564259):2.787571944,((t294:1.208629126,t295:1.208317749):1.988819151,t296:3.110707159):0.6738972039):0.7845811455,(t297:3.961294899,((t298:1.691789237,t299:1.635614336):0.09724171733,t300:1.638450675):2.102541083):0.5792605166):0.3407635445,(t301:2.382961133,t302:2.374802269):2.255881927):0.1028534692,t303:4.730164805):9.490335236):1.561577785,(((t304:2.800354353,t305:2.779249039):1.087837672,(t306:3.203414438,(t307:2.39339375,(t308:1.055109927,(t309:0.4331834265,t310:0.2727098493):0.009411869154):1.144835198):0.4470809653):0.3682603539):11.38859649,((((((((((t311:2.005579404,t312:1.933428884):0.6564328865,((t313:0.2383310248,t314:0.2317571014):0.3623193271,t315:0.4802862196):1.662730999):0.5929939496,(t316:1.865641517,(t317:1.582364603,(t318:0.48191825,(t319:0.4335268515,t320:0.3959030144):0.02993206448):1.073670934):0.04133038752):0.7601695998):0.6384963402,(t321:1.366523584,t322:1.11226629):1.458690375):2.165019017,t323:4.474868302):4.016509083,((t324:0.8003364971,t325:0.6143338556):0.6001031195,(t326:0.696997058,t327:0.693846979):0.4618797152):6.971934428):1.439379234,(t328:3.013785896,(t329:0.3532502003,t330:0.2194271985):2.65477328):6.534867643):1.444419197,(((((t331:1.388827455,(t332:0.8440807572,(((t333:0.1713744645,t334:0.1593574636):0.543492554,t335:0.5757851549):0.07335881243,t336:0.6438004761):0.04979219883):0.5270807364):2.446430502,t337:3.645193284):5.002944332,(t338:5.803519723,(t339:2.297320457,((t340:1.725788165,(t341:0.2881116519,t342:0.1947325916):1.241282195):0.3543359253,t343:1.675831213):0.06404776219):3.132571598):2.808737936):0.2963920906,t344:7.869827299):0.04913277412,(t345:5.52603549,(t346:2.953471737,(t347:0.7444395832,t348:0.4165302957):2.071409687):2.494384048):1.944175075):1.485651832):0.1988147387,((t349:2.806625909,t350:2.630575549):3.797046131,t351:6.351283152):1.933779782):0.02549931885,(((t352:5.421488058,t353:5.259727758):0.1256496552,t354:5.328907664):1.571984665,((t355:4.262418744,t356:4.258513878):1.738512547,t357:5.950136367):0.8395251468):1.150548824):0.3267065098):0.2531635833):1.760075467,((t358:5.44481437,(((t359:0.148656926,t360:0.1206121495):2.08312548,t361:2.13686046):2.742754828,t362:4.871571847):0.468929797):4.565949458,(((((t363:3.210284233,(t364:2.825495157,t365:2.816687078):0.1654331791):2.176655879,(((t366:0.5501933731,t367:0.4543829039):1.673254132,t368:2.122504158):2.391362638,t369:4.502091411):0.5297389177):1.801255032,(t370:5.368028089,(t371:4.98032639,(t372:2.36105225,(t373:1.074026223,t374:0.8659179551):1.253571846):2.581142492):0.10834472):1.45460229):0.6949182419,(t375:6.606013225,((t376:0.3726459874,t377:0.1727113288):3.352428482,t378:3.322835707):2.878813538):0.2808495633):1.171250165,((t379:3.528339729,t380:3.51736574):3.361866003,(((t381:4.518795132,t382:4.489634796):0.8196558097,((t383:1.64262309,t384:1.639781979):0.9584155183,(t385:1.635957902,t386:1.529274312):0.8774365178):2.583757132):0.5857564807,((t387:0.8501412252,t388:0.8334383981):3.893494174,((t389:1.405256349,t390:1.334852663):2.795317684,(((t391:0.449446425,t392:0.3812942967):1.843378326,(t393:1.553575583,t394:1.502527261):0.6564019172):1.614833113,((t395:1.279441907,t396:1.243261651):2.092346609,(t397:1.79819001,(((t398:1.076478131,t399:1.029396282):0.2957513912,t400:1.240877293):0.05597549337,t401:1.283241879):0.3156572925):1.501174121):0.3578564827):0.1801649006):0.4976737157):0.482784073):0.9474193567):0.761940978):0.7787261554):0.2315741905):0.1334979327):5.481746611):0.3713665056,((t402:1.940835267,t403:1.921270191):0.2046013798,t404:2.042694602):11.14700872):21.60688161,((((((((t406:2.505845031,t407:2.466639987):1.877912866,((t408:2.25989865,t409:2.216005358):1.817134302,((((t410:2.041181706,t411:1.866213348):0.5074546489,(t412:1.638271135,t414:1.283271263):0.7300408757):0.9586952121,((t415:1.34526471,(t416:0.7350538825,t417:0.7260717457):0.5573687823):0.3751894891,(t418:1.368489547,((t419:0.9840512199,t420:0.737786107):0.1085443704,t421:0.8050106592):0.01397588627):0.08515562279):1.249707865):0.2673760531,(((t422:0.4823957713,t423:0.4793750852):0.117819344,t424:0.5904426023):1.448817124,(t425:1.587485003,t426:1.541707871):0.3978621198):0.3147206636):0.1966257317):0.1871341864):0.1859655012,(t427:1.270490953,t428:1.256964665):1.541103367):2.771682605,(t429:4.944486934,((t430:0.9577326354,(t431:0.1133226593,t432:0.1087040067):0.7355462251):0.6336844569,t433:1.366612722):3.325290236):0.4163932194):0.23158177,((((t434:0.871130128,t435:0.8539494826):1.11131966,(((t437:0.2012080023,t438:0.1622703684):0.3468783735,t439:0.4670751628):0.05281152711,t440:0.4350940587):0.6189410426):0.9686109093,(t441:0.2860324504,t442:0.2635751437):1.713512611):0.614644379,((t443:0.3329945428,t444:0.04890460169):1.147138916,(t445:0.6262763234,t446:0.579172361):0.5532439608):1.006123331):1.397608025):2.46041628,t447:5.854804834):14.08770624,(((t448:10.50419942,((t449:0.2036025097,t450:0.104761453):1.161508811,(t451:0.2792698009,t452:0.2682799794):0.922063868):9.067311168):6.291977388,((((t453:0.132114211,t454:0.01796797043):1.525143357,(t455:0.8155263531,t456:0.645665327):0.5682366177):5.811805079,(t457:3.711767096,(t458:1.050975081,(t459:0.2625138176,t460:0.07182616683):0.7877779234):2.464138783):3.2646781):5.641716288,((t461:1.330181835,t462:1.235868415):6.971132766,((((t463:0.05973503541,t464:0.03830735793):1.557165558,t465:1.376625868):1.191565954,(t466:1.294473764,t467:1.216920717):1.013429751):4.775171016,(t468:6.361917501,(t469:1.683262361,t470:1.504707696):4.642503398):0.621806052):0.5978618357):3.885444467):3.425176436):3.042637745,((t471:6.802991975,((t472:3.51191342,t473:3.175131538):0.2658923585,t474:3.370582068):3.009088958):4.490529912,t475:10.85095943):6.345172601):0.07666495889):5.040716048,(((t476:0.4409297127,t477:0.4290238427):17.11902382,t478:17.51043437):2.233552783,((t479:4.620676374,t480:4.515908296):2.919917407,(t481:5.520950544,((t482:0.3908661575,t483:0.3222239981):0.3927652929,t485:0.5193976997):4.73135419):1.847170852):12.18337594):2.441032857):5.588728226);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T30.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
