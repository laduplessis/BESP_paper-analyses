<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t476:0.2762137002,t477:0.254580654):5.938147736,((t478:1.626607446,t479:1.497801753):4.129654234,t480:5.309288949):0.3887009041):0.3339557257,((t481:1.22834109,t482:1.183564676):3.704249648,t483:4.829054592):0.9194191525):22.30897858,t484:28.03138056):100.3880011,(((t486:0.775744141,t487:0.67611976):6.547762294,((t488:1.404136303,t489:1.402266292):5.339747878,(t490:5.931740501,t491:5.768363375):0.7648610546):0.476508575):32.31845188,((t492:7.083015485,((t493:1.261676252,t494:1.139118212):2.293806405,t495:3.233203342):3.524486461):18.03815277,(((((t485:0.0658211102,(((t392:0.02995398531,((t367:0.07376396917,((((t298:0.02381036519,(t259:0.4498706791,(t260:0.1551004991,(t257:0.03480842179,(t243:0.02329037501,(t242:0.101907333,((t230:0.03475950116,(t196:0.03906100565,(((t152:0.1511216961,(t151:0.003405489429,((t144:0.4121319333,t145:0.09056860563):0.1841458495,(t137:0.1689902308,(t133:0.008210414846,(((t58:0.0133927289,((t46:0.03868754256,(t42:0.05636911443,t1:3.683223728):0.3616383781):0.1863182187,t2:4.204073545):0.8811592121):1.392374357,((t3:4.074079964,t4:4.052255099):0.4346476007,((t5:3.26088636,t6:3.220822852):0.696039929,(t7:3.080574728,(t8:2.804635128,t9:2.791871034):0.1776822329):0.8269191147):0.5043561532):1.882441147):2.289245724,t10:8.379313123):3.312146116):0.7794180348):0.9647957795):0.32141468):0.1949990673):1.012105376,(t11:4.963370486,(((t12:1.619323551,t13:1.612368186):0.8297082992,t14:2.382913047):1.90937061,t15:4.169824595):0.5374308453):9.991065882):0.344202875,(((((t16:7.226674585,((((t17:2.243669667,t18:1.886080016):0.7865692385,t19:2.633242578):0.5237652251,t20:3.112516877):2.368111835,t21:5.450895271):1.07273647):3.018403759,((t22:4.346683159,t23:4.167529107):4.677820907,((t24:0.629087201,t25:0.3855010161):1.732196478,((t26:0.5001135175,t27:0.4932285138):1.267108033,(t28:0.5082163303,t29:0.3488146239):1.139191712):0.2618714422):6.454680457):0.3323097548):1.200577557,((t30:1.666389271,(t31:0.9083711868,(t32:0.6067178958,t33:0.5319837886):0.1942991087):0.6478013453):3.268979823,(t34:1.823955172,t35:1.772351763):2.812547306):4.760508089):0.9751448664,(((((t36:0.8046915355,t37:0.7556613302):1.735630724,t38:2.418842406):4.314753432,((((t39:0.5904412742,t40:0.5073619598):0.3922044318,t41:0.7289499236):2.077722854,(((t43:0.5587040448,t44:0.5058878959):0.6286703533,t45:1.044690697):0.2497369017,(t47:0.3134842479,t48:0.3105314943):0.8681268265):1.082376517):1.391678227,((t49:0.1411431512,t50:0.1315328345):3.308215727,(t51:0.1016787034,t52:0.08035703561):3.24430182):0.201368303):2.152305741):3.051785697,(((t53:0.7153472362,(t54:0.09801972453,t55:0.04873481747):0.2956609017):2.389346506,((t56:0.4877371788,(t57:0.3979219981,t59:0.2135541197):0.08075368126):0.9989803036,t60:1.023108043):1.072386535):4.829630269,(t61:6.459323703,(((t62:1.455463335,(t63:1.14329825,(t64:1.040321306,t65:0.9518263379):0.05881701033):0.2731772404):3.982657746,(t66:0.4423954235,t67:0.341758681):4.721840583):0.3408207101,(t68:0.4823133467,t69:0.4576455458):4.643783378):0.5110738616):0.2884895692):0.6060595222):0.03396070782,(((t70:1.334007924,t71:1.302584557):2.294666047,t72:3.581141329):1.740798886,(t73:4.104343055,((t74:0.2652285858,t75:0.181121699):2.536960031,t76:2.679447667):1.242098181):1.164901804):0.3499132278):0.3518081596):2.290789458,(((t77:4.566896998,(t78:4.369960046,t79:4.176729296):0.1826137884):1.073671078,t80:5.395605277):2.071941961,((t81:3.972848266,t82:3.80475706):1.342007858,(t83:3.961926094,(t84:1.620875531,(t85:1.222150641,t86:1.209172799):0.2980299824):2.320696857):1.007432423):2.080788555):0.2692172558):0.07621381414):3.133533057):2.999771263):0.5008355538,((((t87:5.013291641,(t88:4.540292298,(t89:2.167513936,t90:1.932864525):2.305194373):0.4419644982):1.210730147,((t91:2.764705071,t92:2.700540661):2.418745342,t93:4.907848059):0.4011794049):1.314659502,t94:6.565047191):1.761514428,(((t95:1.980192133,t96:1.791977866):3.59130242,(t97:3.82215113,t98:3.777550633):1.506879235):1.993284943,(t99:2.828111525,(t100:2.481124217,t101:2.468941591):0.3306971828):4.448452608):0.7262314598):4.591738972):0.6500160497):0.0339964103):1.693738312):0.322360605):0.1827519818):2.774941018):4.141029627,((((t102:2.786002704,t103:2.730019024):7.107194483,(t104:2.778059725,t105:2.767090875):6.928211806):4.711913964,((((t106:0.362673191,t107:0.3522036231):4.196722021,(((t108:3.173930309,((t109:1.157884506,t110:1.147389492):1.50086279,(t111:0.3426222862,t112:0.3399501093):2.17978414):0.4685447476):0.4720425388,(t113:0.3824082875,t114:0.3065779835):2.774469666):0.2194276282,(t115:1.807384093,t116:1.793444838):1.418426343):0.6772761536):8.426288309,(((t117:1.725020992,(t118:1.711328902,(t119:1.61735255,t120:1.443450026):0.09010987801):0.001134005162):2.198876275,t121:3.725802211):2.012994681,((t122:2.77178263,(((t123:0.1732234435,t124:0.0007565139776):2.154356022,t125:2.115087025):0.2338686636,(((t126:1.755669417,(t127:1.414536072,t128:1.218043842):0.280999973):0.2674545889,t129:1.574661441):0.2518074511,((t130:1.426511095,(t131:0.4656477791,t132:0.4553720086):0.7271902249):0.1953610196,t134:1.188001457):0.1573390876):0.04080396947):0.1714320298):1.963608121,(((t135:0.3515490775,t136:0.1476427421):1.232626987,t138:1.038201772):0.7255900133,t139:1.644671396):1.099741679):0.9842701178):6.351429218):0.9611750264,(t140:9.196917352,((((((t141:2.131497643,((t142:1.651816653,(t143:1.305246046,t146:0.5940961916):0.2755918792):0.369793408,t147:1.234375505):0.0883373934):0.3808787062,(t148:0.5524861422,t149:0.3829956898):1.144579033):1.859002935,(t150:0.7609946287,(t153:0.2357380762,t154:0.2318317298):0.2398453004):2.594098779):0.5057503515,t155:3.50772916):0.4752269499,(t156:2.53607658,t157:2.332245748):1.357818217):1.744392668,t158:5.398600003):2.098680938):1.748202925):0.4327281504):1.16301945,(((((t159:0.2356294193,t160:0.2096585058):0.0556482647,t161:0.2478566163):0.8345350862,((t162:0.2938093414,t163:0.2133294149):0.1621349663,t164:0.3549417161):0.3340319672):0.3266682935,t165:0.9884879609):8.934670169,(((((((t166:0.1114663956,t167:0.06716587758):3.36460471,(t168:1.278581496,(t169:0.2332586193,t170:0.1317226866):1.020548746):2.138390016):0.4631069325,((((t171:0.3356480973,t172:0.2686788847):0.08389701886,t173:0.231645487):2.657746877,t174:2.801206975):0.07107594786,t175:2.857151864):0.4152658405):0.3491807626,(t176:1.598750982,t177:1.558741323):1.857764567):3.261989759,(((t178:0.4945502748,t179:0.1769482183):3.172211491,t180:3.34276373):2.265336871,(t181:0.7149933532,t182:0.617543014):4.58976895):0.4502387534):2.276831123,((((t183:0.2204988369,t184:0.1690311058):0.1547316736,t185:0.1879557285):4.07325169,t186:4.227705237):0.8283924084,t187:4.987757682):2.610518255):0.02206255031,((t188:5.382972798,((t189:0.5058995759,t190:0.4743040436):4.371869344,(t191:0.6246554376,t192:0.586443853):4.116532795):0.5036688146):1.79863703,(t193:6.763971654,(((t194:2.941417949,t195:2.236556266):0.8950973417,t197:2.745993882):2.384550678,(t198:1.860772645,t199:1.856121773):3.237205845):0.4186015662):0.2127622827):0.4031238047):0.05131733059):0.4394287221):6.481738883):1.243982088,((((t200:4.358983518,t201:4.312779345):0.09416994894,((t202:1.171333534,t203:0.9340178832):2.758215712,(t204:2.214371288,t205:2.186097167):1.47259768):0.4505601411):0.8536658139,(t206:2.825117909,t207:2.810407653):1.902968008):0.6937880853,((t208:3.204407239,(t209:2.541161825,t210:2.518456506):0.659381611):1.444497619,((t211:1.905778078,t212:1.807481844):1.947548615,(t213:3.540245488,t214:3.539261728):0.1066695977):0.4681827262):0.7547692854):8.240577402):2.10027125,(((((t215:1.255375628,t216:1.245648863):0.1678976217,t217:1.237933054):2.177502958,((t218:1.703892539,t219:1.657302494):1.283079866,t220:2.90080062):0.3999450085):1.505842072,t221:4.64890231):9.198667804,(((((t222:2.213321152,t223:2.19645848):7.976777901,((((t224:3.281213805,t225:3.134052396):0.009209622658,t226:2.938114377):0.3983951324,(t227:2.014207727,t228:1.875373932):1.121311714):1.516015166,(t229:2.730040566,t231:2.590399927):1.758577416):4.905158149):2.059324205,(((((t232:0.6148013986,(t233:0.5285002626,t234:0.4753149984):0.06549002111):0.5666256427,t235:1.106167463):5.380575878,t236:6.471585481):3.985902799,(((((t237:0.9735511979,t238:0.8244305928):2.061371892,t239:2.691501779):0.9146033088,(((t240:0.1206364673,t241:0.0048358896):1.452128089,t244:0.6188469407):0.0490891406,t245:0.6067893419):1.923293871):0.5496868002,((t246:0.2502047752,t247:0.1659813022):0.7733372826,(((t248:0.03745111267,t249:0.02681889294):0.1934012878,t250:0.1405919707):0.4739890446,t251:0.5724498475):0.1601419725):1.671721424):0.00369649273,(t252:1.930194466,(t253:1.254431747,t254:1.088269322):0.6367574971):0.4076109461):5.920687725):0.08041619616,(((t255:1.099740261,((t256:0.543459286,t258:0.295572896):0.4684414419,t261:0.268682488):0.01558480276):3.263355539,((t262:2.238419453,((t263:0.4022826601,t264:0.283343149):1.066685974,t265:1.331483536):0.3625616961):0.0858324439,t266:1.663497283):1.207807903):2.36342557,(t267:4.068583667,((t268:0.192762723,t269:0.05407194918):2.276945272,(t270:0.739054776,(t271:0.1947389489,t272:0.1558414816):0.4988268977):1.574323962):1.330068148):1.14228238):1.406509058):0.6416879581):0.4879813223,((t273:6.266153974,(((((t274:1.337844481,t275:1.253663151):1.614384929,(t276:0.9969056981,t277:0.9673326827):1.790995122):0.2288279549,(t278:0.2760860011,(t279:0.1104885932,t280:0.07584588009):0.1361163978):2.625076187):0.9467207849,(t281:1.113646539,t282:1.01626319):2.568615903):1.05812053,(t283:0.9359342663,t284:0.9192434249):3.691498242):0.9736037792):0.0753829606,(t285:4.021931145,((t286:0.3792726595,t287:0.3653455295):1.441162203,(t288:1.60461822,(t289:0.341834069,t290:0.3362540619):1.22074374):0.1270390573):2.195393015):1.608441634):0.8262821484):0.02023599523,t291:6.247413624):1.013974541):0.7414240382):0.2688565828):1.22126349,(((t292:6.109697201,t293:5.994582689):0.04800887694,((t294:4.466336057,t295:4.449207854):0.2056971775,(t296:3.370232642,t297:3.245917622):1.273932589):1.346852924):2.679711584,((t299:0.1453078198,t300:0.02299678183):6.316735117,((((t301:3.000402271,t302:2.66948301):1.984293266,(((t303:2.565298105,(((t304:0.5942056656,t305:0.5205693019):0.5348274326,t306:1.049669041):0.2082581172,t307:1.098688603):1.226576897):0.738648407,t308:2.971555932):0.9374461413,t309:3.884788086):0.2353459128):0.788029686,(((t310:2.721207449,t311:2.669198223):0.2894948139,t312:2.808265434):0.7576088124,(t313:1.526624902,t314:1.497364693):2.0122953):0.7460951695):0.2232547079,t315:4.416837953):0.2711376995):1.63996415):0.6248711394):1.582467008):5.240605584,((((t316:5.409372204,((t317:4.243409747,((t318:2.04531293,t319:1.876995469):1.923662339,t320:3.69580417):0.2302937374):0.5390265544,((((t321:0.3196897978,t322:0.2344005882):2.484485777,t323:2.640266542):0.7181888654,t324:3.357091727):0.3155074466,t325:3.606228234):0.471839535):0.6229093533):0.7179867728,((t326:3.386118753,(t327:3.105944073,(t328:2.615439426,t329:2.05475512):0.4311347735):0.1902154648):0.4587734236,(t330:1.386960064,t331:1.098858603):1.622394064):1.453516662):1.122181194,(t332:5.123595422,((((t333:0.4503092462,t334:0.4175365524):1.198155082,((t335:1.098702408,t336:1.093915199):0.270415246,(t337:0.5467942296,t338:0.4314551036):0.796754458):0.2168722807):1.18336299,(((((t339:0.4264026062,t340:0.2661921412):0.7351333345,t341:0.7564171526):0.1134186325,t342:0.8470634748):1.176974423,((t343:0.7496357451,(t344:0.1443172865,t345:0.09998301925):0.6011876276):1.045947895,t346:1.700064682):0.1000028263):0.00183560626,((t347:0.6032061088,t348:0.4760178165):0.2369907908,t349:0.1909360932):0.7265719142):0.03023089129):1.995100641,(t350:1.631330764,((t351:0.3608583479,t352:0.3315499124):0.09140582076,t353:0.4171123513):1.089737746):1.168148785):0.2628752487):0.1102574653):4.548088648,(((((t354:0.5951195803,t355:0.4874221111):2.12541138,(t356:2.302020085,(t357:0.9276174858,t358:0.9110389926):1.330342965):0.2892767263):3.430519121,t359:5.855461209):0.574630592,(t360:0.5950045614,t361:0.5073099034):5.731088243):0.3941787628,(t362:6.284621947,(t363:0.8242423824,t364:0.7588292766):5.345611051):0.1642496666):0.4448159639):1.953321435):1.094793354,t365:9.735556943):2.225010504):0.2184936263,((((((t366:3.046433777,t368:1.927394764):2.801451312,(t369:2.263653844,(t370:0.8203291633,t371:0.8148046565):1.307270325):2.33252528):3.042376802,(t372:6.472641909,t373:6.449812496):1.00409062):0.934835888,(((t374:3.837543165,t375:3.836879806):2.209695032,t376:5.962240925):0.2776361557,(t377:5.459957579,t378:5.454584135):0.7290068937):1.842542056):1.064097754,((t379:7.084820679,(((t380:4.703549608,(t381:0.3508542762,t382:0.1609700527):4.327286827):1.182029897,t383:5.561079705):0.4598830346,(t384:0.3388494423,t385:0.3317508816):5.653308565):0.7252928057):1.336525227,((((t386:0.7004563276,t387:0.6428553637):0.3527663565,t388:0.9075146051):5.21425502,t389:6.000182782):0.4277939323,(t390:4.559916507,(t391:2.62273244,t393:2.366443411):1.584651861):1.70542413):1.260593278):0.5949277993):0.2685267623,((((t394:3.345821071,(((((t395:0.3677794337,t396:0.277213172):0.1668315389,t397:0.4351499712):0.004853237341,t398:0.3680147787):0.4135299566,t399:0.5352645624):1.429701047,(t400:1.524592268,t401:1.444853311):0.4355824633):0.7939629106):2.16134761,((t402:1.592196677,t403:1.586516969):2.019935645,(t404:3.324774739,(t405:2.363458175,(t406:2.203704749,t407:2.089208371):0.1414831189):0.8146108859):0.2708007478):1.092914586):0.7597621726,(t408:3.672208896,t409:3.556433456):1.483325469):0.8800344358,(((t410:0.967619279,t411:0.9581890079):2.909807211,t412:3.840114764):0.03176431243,((((t413:1.584973179,t414:1.568053437):0.6662556876,t415:2.216819795):1.328993817,((((t416:0.323991121,t417:0.2874170455):1.231624874,t418:1.466321662):0.6737220807,t419:2.126729433):0.5017121345,((t420:0.6846389677,t421:0.6796708507):0.8534990493,t422:1.501373691):0.9774356686):0.8124944615):0.1274372828,(t423:0.7177639999,t424:0.7090413057):2.550303384):0.1049349819):1.988087939):0.612760349):0.9062907394):5.726896093,((((((t425:1.312579757,t426:1.279141421):3.519668105,((t427:2.453754801,t428:2.420827294):1.657720633,((((t429:2.317077805,t430:2.290474438):0.07448795487,(t431:0.7844660555,(t432:0.6358246971,t433:0.6040888517):0.04867307171):0.7750343066):0.5749988976,t434:1.994008277):0.4556654499,((((t435:0.9638875973,(t436:0.29286972,t437:0.2565263429):0.6093927212):0.3024118926,t438:1.040234015):0.5828139731,(t439:0.736462999,t440:0.7363576361):0.7950648304):0.4273417199,t441:1.763429326):0.08793782244):0.4507265503):0.6600623713):0.3569578177,(t442:2.168531076,t443:1.886410839):1.060895062):0.5637339841,(((t444:1.177939156,t445:1.098785359):0.9623878153,(t446:1.156461716,t447:0.9962972712):0.6365923744):0.5534291854,t448:2.181051318):0.801798884):1.091484447,t449:3.930449608):2.205432617,t450:5.973190493):3.440455802):1.831062736,((t451:9.681515655,(t452:7.834408208,t453:7.827222528):1.660167568):1.322512949,((((t454:0.2439132943,t455:0.1497402126):2.236775603,(((t456:0.09724875089,t457:0.07606038979):0.7337054435,(t458:0.4928767671,(t459:0.1678244501,t460:0.1236885378):0.1966249437):0.3117251498):0.5515583881,((t461:0.714658548,((t462:0.4065888113,t463:0.3395458966):0.2440516081,t464:0.4074919282):0.03037317904):0.220563518,t465:0.3865660071):0.1912950514):0.9990672978):2.816669464,t466:4.23376158):3.656840361,(t467:0.7309840578,t468:0.7096582726):7.154503402):1.633066829):0.2184198152):1.355352129,((((t469:1.109924533,t470:0.8629292654):1.150599703,t471:1.908275625):0.5648850738,(t472:2.357180766,t473:2.290109113):0.04647367752):5.142673815,(t474:0.5432883677,t475:0.5238279038):6.871193144):2.908370665):16.44274531):14.13193862):88.6305259);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T48.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
