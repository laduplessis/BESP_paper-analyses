<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t457:0.5243018431,t458:0.3770187649):2.501337868,(t459:0.6397312495,t460:0.5192371427):2.229473474):48.45490546,(((((t461:0.5067020852,t462:0.38131766):1.269516349,t463:1.568835255):11.74136762,(((t464:2.885915238,t465:2.841783081):0.9208359663,(t466:1.838540652,t468:1.663604663):1.756856163):5.562452273,(((t469:0.7922131197,t470:0.5572296102):2.457030178,t471:2.926247009):4.61947712,(t472:1.979911896,((t473:0.1471809026,t474:0.03743905647):1.385820868,t475:1.385921541):0.4083497405):5.34255651):1.056622175):3.816248895):17.48429607,(((((t476:3.185335349,(t477:2.115507113,t478:2.088055357):1.068347754):1.341219319,(t479:0.4149119874,(t480:0.2801102246,t481:0.119098505):0.1149649719):3.996158056):4.763899576,((t482:0.5025402011,t483:0.4148796868):3.448309637,(t484:3.649929511,t485:3.649458309):0.1977091589):5.011728983):2.67220286,(t489:10.16612706,(((t490:0.4378355904,t491:0.407185052):0.5253287444,t492:0.7633351093):7.299345136,t493:8.02755957):1.842958692):0.1672075067):8.788540037,(t494:6.230190204,t495:6.226274085):12.41149796):8.688785875):14.43223987,((t496:6.75840916,t497:6.603055503):0.1113113275,(t498:1.893711227,((((t486:0.6630995329,(t487:0.2710559307,t488:0.002139471432):0.2421361622):0.1797876097,((t467:0.1095308606,(((((t372:0.03024525852,(t360:0.02199856035,(t356:0.1425959325,(t299:0.02554920962,(((t275:0.185719024,t276:0.09059462006):0.3426390199,((((((t144:0.08519353772,((t46:0.02668755974,(((t1:3.313223091,t2:3.308108584):0.2645353137,(t3:2.763441815,(t4:1.984695817,t5:1.943222591):0.7582961071):0.6642371833):0.2443838183,t6:3.608502006):0.8473943888):0.1286894784,t7:4.559839894):8.647178645):1.192465864,((t8:2.455515724,t9:2.431902689):1.923102212,((((t10:3.042178131,(t11:1.82025045,t12:1.654382594):1.211177936):0.688820713,t13:3.162392367):0.2868103478,t14:3.287636685):0.1190593911,(t15:2.824336447,t16:2.822426346):0.4966903281):0.157916627):9.826408185):1.317241481,((((((t17:2.534714024,t18:2.351318545):0.511697065,((t19:1.563460978,t20:1.400026783):1.001806756,(t21:0.6260169337,t22:0.4717522755):1.65744955):0.07129286829):2.770152056,((t23:0.3855454018,t24:0.3807624638):0.2654592322,t25:0.5423144914):4.271006429):5.334368029,((t26:1.793249184,(t27:0.1976431943,t28:0.05241616857):1.575844588):1.795835566,(t29:2.15940488,(t30:0.7921942776,t31:0.6616245425):1.16828585):1.126935291):6.515336801):0.2544036198,((((((t32:1.631124428,t33:1.473027029):0.1506958465,(t34:0.5161162327,t35:0.06152927368):0.8194927939):0.03120265569,(t36:0.2748032733,t37:0.1780585576):0.5908034247):2.19009133,t38:2.940182888):2.997629807,((t39:0.1670823946,t40:0.1320342847):2.51280265,t41:2.594110009):3.107563351):2.172227626,((t42:2.220349006,((t43:0.1025958866,t44:0.09210322321):1.647380672,t45:1.697963539):0.4550679884):0.1152476961,t47:2.216028069):5.533371252):0.4507102278):0.8069017689,(((t48:3.337002623,(((t49:0.2069287869,t50:0.04350684032):0.9939577617,((t51:0.4968076358,t52:0.313557305):0.3430718012,t53:0.6271550447):0.1535232737):0.8122601415,t54:1.589645295):1.191438573):2.775169151,(t55:5.198356526,t56:4.991438262):0.3075419157):1.672998598,(t57:0.7025812409,(t58:0.3054688932,t59:0.1777614714):0.1847743998):6.235459223):1.205820338):2.262801234):5.942193007,(((t60:7.055570085,t61:7.016857821):3.454877578,t62:10.47138421):0.319884839,((((t63:0.2470630167,t64:0.2183832416):5.727449503,t65:5.760925043):2.507345632,(((t66:6.158854737,(t67:6.004157484,(((t68:1.343593079,(t69:0.1902218695,t70:0.1193616578):1.071219371):0.2415289825,t71:1.405962618):2.170008071,t72:3.526551967):2.185850336):0.0427126):1.592809928,(t73:6.669318273,((t74:0.1609267172,t75:0.09486838887):0.8616718337,t76:0.8388376276):5.368598195):0.5265269719):0.2628877736,((((((t77:1.531980148,t78:1.362195332):2.373291645,t79:3.726316852):0.2551299857,t80:3.962414076):0.3734790212,(((t81:0.1928403876,t82:0.06822046549):0.2253827023,t83:0.08247449244):1.445229829,t84:1.413328126):2.297479301):1.297947764,t85:5.00137314):1.070177267,((((t86:3.82031543,((t87:2.794668808,t88:2.67713626):0.6622304662,(t89:2.606557047,(t90:2.320405564,((t91:0.9484586226,t92:0.9027471001):0.3881893719,t93:1.202390781):0.9387991255):0.07668358943):0.6515670031):0.2666077254):0.9547961465,(t94:3.332633322,(t95:0.9717848611,t96:0.8679340373):2.185715101):0.7534397803):0.2454187859,((t97:2.663780425,t98:2.640099788):1.008166266,(t99:3.123104617,((t100:2.913995385,(t101:1.718638192,t102:1.690311485):1.129464192):0.05260093029,t103:2.781149706):0.1223090191):0.3980958142):0.3775807989):0.2448989555,((t104:2.889891246,t105:2.884589349):0.01723884378,t106:2.799640218):0.9854242484):0.7002266535):0.06607093038):0.2339362869):0.06236487955,((t107:3.262208851,t108:3.235197683):0.5818411243,((t109:2.797765097,((t110:1.575494614,(t111:1.518411951,t112:1.448763147):0.001358890673):0.317779791,(t113:0.180677138,t114:0.127161144):1.578938475):0.7726970466):0.03684482193,(t115:1.654400782,t116:1.633892374):0.6915924535):0.8003704487):0.926770176):2.091758433):4.838462806):0.8385811139,(((t117:0.729751857,t118:0.7222179105):0.2811825962,t119:0.9563364589):3.909583769,(t120:3.699350146,(t121:2.555688535,(t122:1.085992372,t123:1.066863168):1.0743573):1.062247845):1.155533202):6.585464107):1.693601952,((((t124:3.065116256,(((((t125:1.052050871,t126:1.03310129):0.2101732027,t127:1.23479357):0.7660916507,((t128:0.7428863459,(((t129:0.5403550054,t130:0.3510380235):0.04644895883,t131:0.3187362742):0.111578827,t132:0.4114282891):0.03366016777):0.9624446164,t133:1.346997362):0.09004204263):0.5107600489,(t134:1.016997685,t135:1.004763081):0.9300853161):0.4711399706,t136:2.318468289):0.006780304958):0.5383853087,((t137:2.122082449,t138:2.118282787):0.524280411,t139:2.618668082):0.1386211501):2.975883202,t140:5.538106516):3.596945945,(((((t141:1.031787575,t142:0.9908835417):0.7685959004,t143:1.694441687):0.04609561555,(t145:1.030510116,t146:0.9966632287):0.1163993069):0.06179634818,t147:1.059385603):0.06074927232,(t148:0.2751867661,t149:0.2305438431):0.7423430124):7.004163616):2.216591054):2.042783569):1.053337337,((((((t150:0.4354944041,t151:0.4174590254):0.5169574736,t152:0.8870651908):1.848684629,((t153:0.2194274171,t154:0.1916930578):0.6321710447,(t155:0.5208334739,(t156:0.04984363347,t157:0.0009983125303):0.4335621296):0.2826442996):1.791988164):3.463000584,t158:5.952465293):1.880733963,(t159:2.138275653,t160:2.060223617):5.654686292):1.801209787,t161:9.160800625):3.270553793):1.099810612):5.066479936):0.237215785):1.15676899):0.4814596331,((((((((t162:0.2750642182,t163:0.2347445315):0.8624542785,t164:1.086265967):8.103176911,((((t165:0.3353107362,t166:0.240657284):0.8547248283,(t167:0.05287702858,t168:0.00300776643):0.9660159536):6.187147282,t169:6.939908422):0.4099266927,(((t170:0.1862517661,t171:0.06611667765):1.322690119,t172:1.37594825):2.136207003,(((t173:0.4475817261,t174:0.1917925873):0.5077864085,(t175:0.3970590274,t176:0.305925357):0.1531148457):1.459039366,t177:1.907902298):0.861170009):3.632210257):1.364762755):6.448668307,((((t178:9.121099965,(((t179:6.514421869,((((t180:3.567867176,t181:3.424402098):0.1150361177,(t182:0.969730153,t183:0.9266360498):2.478532494):1.172924192,(t184:3.360452247,(t185:0.6684015502,t186:0.6463321425):2.657580032):1.100144853):0.2010426146,((t187:0.4391804018,t188:0.4225449336):3.752579295,(t189:2.608044488,t190:2.338132086):1.313319136):0.3857816351):1.311245582):0.6951973625,((((t191:2.467333913,t192:2.445238781):1.879289131,((t193:0.6969350532,t194:0.11150113):0.4283433995,t195:0.5182878197):3.120197235):0.4086740191,t196:4.005072878):0.6562951423,(t197:3.063493829,(t198:0.5078451716,t199:0.4826237013):2.490476155):1.531247424):0.596201298):1.212482832,((t200:1.051440148,t201:0.7070909624):3.24379655,(t202:1.45200737,t203:1.390328349):2.439028635):1.961484379):0.4367209844):0.05079926449,((t204:4.266425729,((t205:1.820263081,t206:1.79873939):1.820850067,((t207:0.9791979851,t208:0.9512074759):1.963309798,t209:2.854481276):0.6625365475):0.5863167002):1.636908619,t210:5.72208702):0.3728183645):1.786054584,((t211:4.099923914,(t212:2.739455457,t213:2.737759497):1.359680488):3.016380608,(t214:3.008560276,t215:2.896161745):4.099959157):0.755811178):0.3989269872,(((((t216:2.207664602,(t217:0.8209233109,t218:0.6586478294):1.355554954):1.862193576,t219:3.744544526):0.5378058003,((((t220:1.82522235,t221:1.592324088):1.1192102,(((t222:0.2638281136,t223:0.1786181926):1.913370231,((t224:0.5317887647,t225:0.3488600749):1.357948525,(t226:1.120653966,t227:1.063196929):0.532834988):0.09624442757):0.01997695473,((t228:0.1350810071,t229:0.1232932205):1.227439842,t230:1.270010057):0.3417773975):0.4894376754):0.5977727071,(((t231:0.8063363414,t232:0.7932889233):0.06013738198,(t233:0.4736927854,t234:0.4361652857):0.2404679761):1.38975205,(t235:0.8370259075,t236:0.7680133871):1.197991732):0.1611576328):0.4170760406,t237:2.483433351):0.1328302132):0.813864066,(t238:2.27995185,(t239:0.3520793841,t240:0.1704049279):1.8534764):0.9844289781):0.06026340952,t241:2.975418292):2.633800592):2.792437866):1.941404556,(((((t242:1.020940045,(t243:0.6069678802,t244:0.4900322289):0.3129643957):0.3183199492,t245:0.9049059621):0.3736486662,t246:1.203506402):0.009819767402,t247:1.157079937):7.97446163,(((t248:1.189356781,t249:0.8695658606):5.784942505,(t250:4.493599325,((t251:0.1535785417,t252:0.1468546931):0.3059006837,t253:0.4403371253):4.03070767):2.134050942):1.924605139,((t254:0.4474574583,t255:0.4287058277):1.627454025,t256:1.963556619):6.432433972):0.2213469311):0.262603425):0.7722247102,(((t257:3.542487542,((((t258:0.3355784195,t259:0.2726573434):0.1156847885,t260:0.2455631225):0.1894131947,t261:0.2497081176):2.318194523,(t262:0.8747965848,t263:0.8134558761):1.596485078):0.580617018):4.118339296,(((t264:0.7559911596,t265:0.6103977018):0.01008902902,t266:0.5856285781):5.510082993,(t267:2.40752583,((t268:0.2937615096,t269:0.2211574252):1.612460735,(t270:0.9284186859,t271:0.9144025307):0.8343811088):0.4335705935):3.675199748):0.8103872035):1.485312169,(t272:0.6278782477,t273:0.282842902):7.418883883):0.4131400293):0.7231512007,((t274:5.00923859,t277:4.355356379):2.549940399,((((t278:1.823017699,t279:1.739204527):1.71274247,(t280:0.3845873029,t281:0.1576141595):2.930861606):1.049350315,t282:4.023624698):1.339127923,(t283:3.918038135,t284:3.820624441):1.374333308):0.8938609743):1.185371717):0.5202148461,(t285:6.430499094,(t286:4.360756565,(t287:2.697727656,t288:2.662646073):1.509087179):2.048743039):1.197138864):0.4766153402):3.430000863,((((((((t289:1.042090889,((t290:0.6647281705,t291:0.5079178472):0.3180748514,t292:0.7158297993):0.04395025747):0.7991678861,((t293:0.4010013669,t294:0.08274738178):0.2109793766,t295:0.2933737629):0.7777730644):2.489527364,(t296:2.440888596,t297:2.409489902):1.078676492):2.626940998,(((t298:1.297245717,t300:1.110505649):2.248032239,t301:3.106679518):2.131764369,(t302:3.32369911,(t303:2.769526786,t304:2.707780839):0.4787558348):1.895869433):0.4212431986):0.2051491567,((((((t305:0.5571712651,t306:0.5058526056):1.398129134,t307:1.865990244):0.03195063736,t308:1.740869971):2.139316814,(((t309:1.554373975,t310:1.475921114):1.654987005,(t311:0.9251899218,t312:0.873141131):2.169090103):0.4275889023,((t313:2.811953593,t314:2.717972563):0.6500197968,t315:3.263818938):0.006786801025):0.2290408484):1.089226264,t316:4.579153695):0.1200896017,(t317:4.258358317,(((t318:1.015525735,(t319:0.8286651669,t320:0.7803540186):0.1120823135):2.435080163,t321:3.292372178):0.5556004851,((t322:1.837187575,t323:1.810129871):0.8728674275,((t324:0.526347992,t325:0.4685537908):1.069848078,t326:1.395165099):1.01282715):1.04545487):0.1804353023):0.3530701741):0.364101841):0.2179655845,(((t327:1.83577001,t328:1.769791871):1.354848089,((t329:1.004325388,t330:0.9925006133):1.606771334,(t331:2.117778506,t332:2.078568305):0.4204629604):0.4924914735):0.5046130362,(t333:0.7053486907,t334:0.6749208711):2.662176117):0.8579342525):1.619198167,(((t335:2.668795423,t336:2.44275033):0.8554876582,((t337:1.202448282,(t338:0.7079110539,t339:0.2720075308):0.4645729638):0.6432186106,t340:1.33010815):1.052251455):0.2688737669,(t341:2.478486887,(t342:0.589139757,t343:0.4921393914):1.813691194):0.1169375023):1.978267871):1.034316496,((t344:2.476158916,(t345:1.246782548,t346:1.226428777):1.144898731):0.1283911638,t347:2.461232923):2.676267278):1.255318618):3.317234399,((t348:3.743977354,t349:3.689343557):1.064735367,((((t350:1.452554824,t351:1.364151794):0.8132533791,((t352:0.5143907204,t353:0.4054508776):1.451997674,t354:1.846332162):0.1700962005):0.562649705,(t355:0.7029348281,t357:0.2783318548):1.789166449):0.3156613437,(t358:0.7298437243,(t359:0.1851549494,t361:0.1061018213):0.5410367606):1.476740309):1.394729552):4.810631451):2.241747452,(t362:0.7960288141,t363:0.7758005432):9.732202893):0.05112030743):0.009363349805,((t364:0.1457394047,t365:0.04191792549):3.999506442,((t366:0.9375783383,t367:0.883271745):0.443571867,(t368:0.5310583755,(t369:0.3667263694,t370:0.04279362719):0.01426139838):0.5281992581):2.641628032):6.408156931):2.241020217):0.0044546048,(((((t371:5.480444697,(t373:3.406070765,((t374:0.7100709162,t375:0.4360444241):0.6606823003,t376:1.015342202):1.887106274):1.907960686):0.2888508386,t377:5.06213414):1.576319191,t378:6.491499467):2.035678068,((((t379:1.487125001,t380:1.316253115):0.3356371093,t381:1.572192627):1.783170494,t382:3.252963181):0.2269059698,t383:3.442085909):4.648309569):0.5995379202,(((((((t384:0.599084984,t385:0.5504875192):0.02751075583,t386:0.3840313988):6.042792888,t387:6.179828039):0.5640734458,(t388:0.8250746424,t389:0.7415810772):5.906801826):0.4907894325,(t390:6.67213864,(t391:4.767174464,t392:4.670573838):1.833348393):0.4571607535):0.5856736876,((t393:5.396403421,(t394:2.773710471,(t395:2.119780133,t396:2.052986377):0.5514921764):2.437196322):1.584720878,((t397:0.3249210143,t398:0.2873772635):2.636653562,t399:2.916330345):3.452102568):0.5623571215):0.2641776785,(t400:1.648089159,t401:1.064854366):5.239775394):0.01648976827):1.853324048):1.041717076,((((t402:5.129437965,((t403:2.081196779,t404:1.978955405):1.405374973,t405:3.177369911):1.413014719):0.6977769806,((t406:3.280221751,t407:3.245823917):1.683388664,((((t408:1.16346622,t409:1.160798878):1.273341159,(t410:0.08657503043,t411:0.00588903957):2.193910753):0.9362701298,(t412:1.093251243,t413:1.009979709):1.906554932):0.9231847912,((t414:3.030431918,((t415:1.186593358,t416:1.1314726):0.7304947347,t417:1.860878416):1.001723878):0.700791162,t418:3.511292411):0.09348962163):0.3509230848):0.09199930822):1.294599375,((((t419:3.01651535,t420:2.973031202):0.2504143132,(((t421:1.219944385,(t422:0.1876992037,t423:0.1835853768):0.6856105633):1.102008214,t424:1.955739939):0.4883344753,((t425:0.9354996776,t426:0.627157075):0.07276201355,t427:0.3274088565):1.34657181):0.3627258641):0.1192525384,(t428:1.241467376,(t429:0.6266535335,t430:0.5356276698):0.6103964812):0.6490463906):1.524927238,(((t431:0.5679362243,t432:0.5426131905):1.965123902,(t433:2.080075448,(t434:1.126170729,t435:1.012812225):0.8618465409):0.3781809112):0.3494144792,t436:2.543307148):0.3645618699):0.4044794749):0.9128290438,(((((((t437:0.119402307,t438:0.07156909857):0.8580722785,(t439:0.3081570326,t440:0.2970817263):0.5932246918):1.043278382,((t441:1.275920322,t442:1.270290174):0.3641663301,((t443:0.4306774911,t444:0.3394894366):0.9560130235,(t445:0.4557725635,(t446:0.1905046731,t447:0.1691862798):0.1821114817):0.8087501408):0.2429280334):0.2690479338):0.6571811759,t448:2.304662537):0.1657296919,(t449:2.225418336,t450:2.18102398):0.1788207911):0.8430872653,t451:3.196239805):0.03102788102,(t452:1.798160394,((t453:1.00173953,(t454:0.4310165905,t455:0.3145117672):0.5141274897):0.1181926833,t456:0.9436960868):0.6219503436):1.423214315):0.4555520032):1.136648755):1.944194768):4.745281392):34.75227661):5.579117047);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T49.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
