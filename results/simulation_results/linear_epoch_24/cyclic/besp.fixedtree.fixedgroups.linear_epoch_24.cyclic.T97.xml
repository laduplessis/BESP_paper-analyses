<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t501:4.944047838,((t496:0.03676712009,(t477:0.05957655591,((t468:0.09342558944,(t464:0.06582642297,((t447:0.0883497334,((t442:0.5712581557,t443:0.2570571798):0.3656039578,(t411:0.00694923072,(t364:0.04632332345,((((((((t252:0.1624332664,(t249:0.1017216621,((t190:0.1440385176,((((((t38:0.3171449774,((t1:1.530556943,t2:1.36823533):1.579596013,t3:2.84281697):1.043975532):0.756447724,t4:4.572737584):7.12929919,((t5:4.10469443,t6:4.067556633):0.3997191847,t7:4.435196027):7.147571744):1.909131597,(((((t8:3.359090158,t9:3.230699495):0.2795028262,(t10:3.336469648,t11:3.293464865):0.1452964454):0.7424073779,(t12:3.733115635,(((t13:1.812351572,(t14:0.5901532397,t15:0.5126842806):1.0802188):0.8990497852,t16:2.3374186):0.3735716909,t17:2.68696296):0.5560474931):0.3829988904):4.540787099,(t18:2.037757588,t19:1.535965481):6.076575253):4.308056922,((t20:1.463314509,(t21:0.2401990395,t22:0.1177698642):1.0768302):7.286341677,(t23:4.08345094,((t24:1.440201054,t25:1.426789337):0.8735818632,(t26:1.997998772,t27:1.870707244):0.1437553186):1.759908981):4.374797543):2.853546288):0.2248471196):1.355695224,(t28:12.35846943,(((((t29:0.5984316808,(t30:0.1038175936,t31:0.09351972518):0.1399285204):2.41335971,(t32:2.334388872,(t33:0.1405705537,t34:0.06899301315):1.863548393):0.2475042091):6.770556164,((t35:0.1560684343,t36:0.1057527506):0.7930171931,t37:0.8273210056):7.924409781):0.6048366706,((((t39:1.562834006,(t40:0.3686772856,t41:0.3572048131):1.078299217):0.01297060763,t42:1.433695226):2.665303199,((t43:0.9899868111,t44:0.9716225255):0.341167306,t45:1.200833032):2.622945332):4.065512313,((((t46:2.310746275,t47:2.157068395):4.746558116,(((((t48:0.8541405484,t49:0.7968205505):0.01968010833,t50:0.659322256):1.818614431,(t51:0.09334319786,t52:0.06157201578):2.25082912):1.033700926,t53:3.324880497):2.291507316,(t54:2.371879309,t55:2.332971076):3.072944365):0.616599029):0.3509509876,(((t56:0.375733628,t57:0.1334515265):2.127350486,t58:2.122981743):0.7959920884,(t59:1.457485892,t60:1.362726406):1.437260844):2.928188811):0.4377271381,(t61:2.098231685,t62:2.039448111):3.954377838):0.03630148453):0.5443480866):1.401750389,((t63:3.709110447,(t64:0.7831223321,t65:0.5862744062):2.489402881):0.7312827691,t66:3.643413995):3.515479531):0.5149606436):0.2027462192):2.682960944,((((((t67:0.9226993252,(t68:0.2771950864,t69:0.2636737485):0.613203841):2.409743257,(t70:2.399637003,t71:2.359229104):0.8540658089):2.537542356,(t72:3.93211069,t73:3.77234572):1.678662485):1.277450648,(((t74:4.798588551,t75:4.749516046):0.1692807191,(t76:4.217960638,t77:4.112919219):0.5727886595):0.06927410456,(t78:1.268879021,t79:1.116090725):3.421143037):1.672827579):1.315236488,(((t80:0.3661609505,t81:0.2711453488):3.869704031,t82:3.934208841):2.347343708,((t83:4.294540333,(((t84:2.050893039,(t85:1.573737351,t86:1.537731187):0.3896998529):0.3524845671,t87:2.207174882):0.04594837756,(t88:2.022245662,t89:1.955396768):0.1518804396):1.614835314):0.9430833286,((t90:2.753909427,t91:2.714887646):1.137910084,t92:3.7074622):0.7233983529):1.032053807):0.6517479049):0.9854951853,(((((t93:2.107541911,((t94:1.404920998,t95:1.146824465):0.3475032017,t96:1.438593287):0.2219642983):1.607719605,(((t97:0.8228128983,t98:0.7565639445):0.578318154,t99:1.322896798):1.194565137,((t100:1.904231047,t101:1.891137659):0.003720262087,t102:1.80728631):0.4385900268):0.6393598391):0.3511502103,((t103:0.671040957,t104:0.5868211571):1.215594866,t105:1.797760822):1.313944841):1.048890607,(t106:2.379147248,t107:2.349340287):1.758368446):0.8565111429,(((t108:0.2024224868,t109:0.1855993817):0.4515690073,t110:0.6149700514):2.505365806,(((t111:1.202342251,((t112:0.5744745631,t113:0.4211288046):0.3859045102,t114:0.5722646429):0.2413241132):0.6041606206,t115:1.338473261):0.8874796764,t116:1.830663218):0.4136523888):1.792117677):0.9190994007):1.101554268):0.816729681):5.381754006,(((((t117:0.6210413221,t118:0.6006191204):1.409533482,(t119:1.202111483,t120:1.095222453):0.7794143387):0.318010705,t121:1.958486124):1.51748622,(((t122:1.824876696,(t123:0.136268286,t124:0.1289103888):1.650573985):0.4565777949,t125:2.126557934):0.5332211974,t126:2.467523408):0.6377016922):2.208430494,t127:5.29235429):6.158637591):0.5824351657):0.576499555):0.7135847226,((t128:1.721299224,t129:0.9553077578):1.782662414,(t130:0.9316198164,(t131:0.5802200222,t132:0.554962018):0.2369527099):1.567377415):9.646819849):5.155379918,((((t133:0.9232974343,(t134:0.1918662936,t135:0.07592528504):0.6631194103):6.959358432,((t136:1.986104372,t137:1.712467152):4.784469893,(((t138:0.08349741779,t139:0.005844291467):0.5847858826,t140:0.5061446567):2.677865798,(t141:2.040817345,t142:2.032838626):1.100215956):3.068852663):0.8572318651):0.02183191324,(t143:0.7884900618,(t144:0.1158188101,t145:0.09727750667):0.6319699546):6.277642129):5.644490779,(((((((t146:0.7997957467,((t147:0.2408460283,t148:0.1341590716):0.3485394849,t149:0.4354492854):0.1938577014):0.4100934454,t150:0.9874531426):3.431026755,(t151:2.032667207,(t152:1.264797947,t153:1.104967388):0.7651829267):2.36411615):1.708139315,(t154:0.704489702,t155:0.6632735269):5.234674895):2.137677063,(t156:7.642466281,((((t157:1.839205031,t158:1.743950025):0.4760195162,t159:2.136998813):2.048313376,t160:4.146412272):3.133401947,t161:7.042041897):0.02457549201):0.3777196575):0.1084950559,((t162:2.916586515,(t163:0.07893457264,t164:0.06872047391):2.613331474):2.059065912,((t165:0.08784133856,t166:0.04690347946):3.737084826,t167:3.646286576):0.7385194763):2.553452626):1.604337926,((((t168:1.401393104,t169:1.391092287):4.746669546,t170:6.044387516):1.229987515,((t171:3.739803773,(t172:3.255965792,t173:3.229939094):0.4116039074):1.720787132,(t174:5.025860891,((t175:0.6308319526,t176:0.4522651969):2.898362531,(t177:0.926761732,t178:0.876205239):2.313134961):1.492132803):0.335471961):1.739048636):1.123525328,(t179:7.226875023,(t180:6.909474371,((((t181:1.414941091,t182:1.382605386):1.653568019,(t183:2.858104064,t184:2.777318757):0.1740908077):2.279548866,((((t185:2.977844609,t186:2.915904961):1.346573153,(t187:2.379174733,t188:2.143765434):1.741669459):0.03364741887,((t189:0.4974194379,t191:0.1350113712):2.239927986,t192:2.366013332):1.173359518):0.1291492542,(t193:3.38435072,(t194:2.430154882,t195:2.417042528):0.7836982063):0.2180256552):0.7254899593):0.9934615885,t196:5.130902009):0.549557268):0.1689672822):0.6506868614):0.01923001465):2.168927035):3.318708873):1.816362558,(((((t197:1.846728263,t198:1.831880507):2.192503771,((t199:1.280469314,(t200:0.200015415,t201:0.1545464732):1.005103809):1.104023101,t202:2.142914673):1.464296719):0.4831799285,t203:4.060628539):5.099771107,(((t204:2.229498211,t205:2.209862118):0.7432738221,t206:2.893154603):3.589767472,((((t207:2.208527065,t208:2.120582014):1.361870809,(t209:1.30050578,t210:1.248250208):2.147843014):0.06675773702,((t211:2.177021829,(t212:1.164469308,t213:1.072306777):0.9748969979):0.4638162936,(t214:2.002827218,t215:1.990550146):0.4819477093):0.7972706277):0.7179164722,((t216:1.679458724,((t217:0.4235256369,t218:0.3059748201):1.057845777,(t219:0.9669966481,t220:0.935878414):0.3701644121):0.1016710641):0.1928140559,(((t221:0.6212545978,(t222:0.1297404966,t223:0.01763044667):0.3970736015):0.2083376577,t224:0.5103135529):0.4287964912,t225:0.7567400799):0.2938038892):2.071823007):2.067393451):2.312948182):4.087124135,(((((t226:1.665761742,t227:1.653778083):0.5410228622,t228:2.068362718):2.222074859,(((t229:2.506963687,t230:2.488713842):0.01725601184,(t231:1.998801969,(t232:1.76386144,t233:1.631856216):0.1071519062):0.0591546006):0.06650557398,t234:1.674830103):1.621742071):2.676340461,(((((t235:1.110169343,t236:1.094542424):0.2602724662,t237:1.336544824):1.045410917,(t238:1.03732792,t239:1.029468092):1.245959505):0.3502650161,t240:2.468274822):0.6184146585,(((t241:1.432637522,t242:1.153444547):0.2512971275,(t243:0.7223093849,t244:0.5745873031):0.5751574083):0.245984827,t245:1.145613585):0.9429992599):2.476861681):3.979961275,((t246:3.656953906,t247:3.439473311):4.001123254,(t248:0.9221587482,t250:0.4109674518):6.387143846):0.8624661025):0.5035323418):0.08359379473):1.194166355,(((t251:7.924202799,((t253:0.8066760745,(t254:0.145592064,t255:0.06537934472):0.4942854827):0.7567392932,t256:1.277029395):5.866453483):0.2180572006,(((t257:2.943513426,((t258:1.871624502,t259:1.804621729):0.5245110514,t260:2.283392685):0.5266561344):2.662693986,t261:4.984568914):1.1461509,((t262:2.315092676,t263:2.239785164):1.580153468,(t264:1.353256271,t265:1.296620906):2.12867287):2.19473468):0.4647281068):0.8956038912,t266:6.912023754):0.3213795491):0.1863331229,(t267:0.1432745843,t268:0.1356071085):7.20867318):0.3698939203,t269:7.662111742):2.025724193,(((t270:7.63352144,t271:7.596049728):0.2342502479,(((((t272:2.994884004,t273:2.988826254):1.248067416,t274:4.236352779):0.06055660899,t275:4.258563046):1.51400705,((((((t276:0.7989493865,((t277:0.2200177795,t278:0.1713799842):0.2866199545,t279:0.4333293751):0.2730284198):2.780702053,t280:3.482837977):0.06066726355,(t281:3.498538066,t282:3.485577566):0.0418974813):0.2259937321,t283:3.712805226):0.3723804848,t284:3.973469663):0.002623065189,t285:3.466713169):1.407025469):1.318917547,(((t286:4.52997557,t287:4.470722536):0.1376123623,((t288:3.85754346,t289:3.814598169):0.3392407467,t290:4.034572364):0.2171731683):1.449301627,((t291:1.408072981,t292:1.270897909):1.849541701,((t293:0.1613497304,t294:0.06380024628):1.880495203,t295:1.942342688):1.042782542):2.412686532):0.03639620197):0.5227561473):1.374997982,((t296:0.381784709,t297:0.3605815576):1.232953988,t298:1.467045788):5.601573205):0.111149052):0.09413068389):2.565882171):2.662532688):0.3470367262):0.5856919889,((t299:0.2121075701,t300:0.1929658108):0.1266416178,t301:0.298218374):12.95029561):1.096873607):0.6416023787):0.6863174028,(((((((t302:0.4285405804,t303:0.3572809161):2.315936801,(t304:1.374486338,t305:1.248259194):1.259416019):0.4104456375,t306:2.900067766):4.424044046,(((t307:0.9014467411,t308:0.8943010829):1.960565484,t309:2.724977981):1.872693661,t310:4.496253968):2.522783104):0.7939310098,((t311:2.63016678,t312:2.466640648):3.404309464,((t313:3.587854411,(t314:2.212594309,((t315:0.9326567002,t316:0.8390787439):0.5739973616,t317:1.38294308):0.6284339137):1.323655473):1.388295725,((((t318:0.148866635,t319:0.02790628202):1.463564982,(t320:0.2589507236,t321:0.2283534885):1.182490418):1.623717419,(t322:0.445721879,t323:0.367425836):2.123432841):0.740726326,t324:3.06030771):0.680823085):0.8190215887):1.741014666):6.703228428,(((((((t325:4.317233642,((t326:0.4927630758,t327:0.3785596781):1.363572498,t328:1.654064866):2.34282458):1.121840352,((((t329:0.3484699704,t330:0.01223504042):0.9465679644,t331:0.598089224):0.572856726,t332:1.084008193):0.3939350164,t333:1.445002508):2.666624454):2.803456381,((((t334:0.2035498538,t335:0.04436431109):1.56172936,(t336:0.5988407141,t337:0.4804521284):0.6865195385):0.9758389664,(t338:0.3302041379,t339:0.3191225667):1.796308655):0.4898657477,((t340:0.9917623871,t341:0.9382368792):0.6299893488,(t342:0.6891216547,t343:0.2254666178):0.8479637211):0.9704978022):3.646388377):1.504806621,((t344:6.225228661,(t345:2.563396519,t346:2.265395001):3.330092117):0.1914923134,(((((t347:0.1991949186,t348:0.09088330367):1.006333282,t349:1.039361396):0.2302195044,t350:1.265162854):1.16340641,t351:2.373298805):0.09944693534,t352:2.233638227):3.057729533):0.6708805687):1.498843767,(t353:7.170618369,(t354:2.180377026,t355:2.116971049):4.867184734):0.180806075):0.05752645398,(((((t356:1.235660388,t357:1.151084951):0.2796014533,t358:1.29384177):1.321397399,(t359:1.327232968,((t360:0.8877574261,t361:0.7935150345):0.07673480918,t362:0.8366609243):0.283973356):1.263607073):3.669702939,(t363:5.823061896,((t365:2.165278168,t366:2.128908401):2.34014098,(t367:1.311230538,t368:1.141482761):3.12833667):1.11932937):0.114408303):0.349481713,(t369:4.26194033,t370:4.223255517):1.54746552):0.2908816508):1.122506115,((t371:3.949328891,((t372:0.1942544249,t373:0.09586450878):3.096254798,t374:3.121341295):0.6416323512):1.39820891,((t375:2.691021118,t376:2.687565039):2.088277222,t377:4.748773552):0.3657551736):1.804319422):0.4773717458):0.5086440426,((t378:3.813608537,((t379:1.921213232,t380:1.862774851):1.393369637,t381:3.108652613):0.4945088117):3.392429294,(t382:5.386924341,((t383:0.07204020857,t384:0.01710354532):0.8245456435,t385:0.8120851202):4.477779473):1.55880311):0.6955376657):0.04372836278):0.0839396115):1.965202516):4.849093688,((((((t386:1.18818909,t387:1.145228616):1.096290373,t388:2.188428303):2.314352449,t389:4.283313628):3.013348489,t390:7.210616828):0.7686636027,((t391:0.2487088522,t392:0.2278634497):4.018976403,t393:4.163437712):3.675787356):2.338465076,((((t394:0.08602944539,t395:0.05401870386):3.327841856,((t396:2.077161762,t397:1.889613336):0.5467768934,(t398:1.47662033,t399:1.433555967):0.9438480585):0.7248373841):4.851211719,((((t400:0.4851094835,t401:0.473266157):4.036997308,t402:4.477776406):0.04789084192,(t403:3.907529533,t404:3.906338339):0.6122651265):2.251468671,(t405:0.7868018067,t406:0.608668441):5.978208163):1.039779172):0.4711269834,((((((t407:2.841068138,t408:2.758302972):0.07429039437,(t409:1.329177552,(t410:0.4408767936,t412:0.2881534868):0.8212807067):1.487827068):1.25028355,((t413:1.238483492,t414:1.14381173):0.7089193935,(t415:0.6224426942,t416:0.5955627098):1.228840138):1.868714468):0.245413714,((t417:1.197633816,t418:1.142317111):1.026133676,(t419:0.05545329956,t420:0.03820822017):2.110175241):1.664858011):1.664616213,((((((t421:1.662933295,t422:1.59628453):0.1393708547,t423:1.662587939):0.1807154918,t424:1.749497956):1.037264463,((t425:1.08414805,t426:1.002658797):1.398785649,t427:2.305639498):0.2310375239):1.340428966,((((t428:0.7790930851,(t429:0.4655785289,t430:0.3475491766):0.2447876077):1.546129889,((t431:0.2011215072,t432:0.2000056691):0.3200408709,t433:0.4160132785):1.546689267):0.5548661714,t434:2.424234682):0.2292708918,(t435:0.161398629,t436:0.1309876859):2.48555648):0.7371160019):0.7876279497,((t437:1.027619509,t438:0.9104819063):2.00927688,(((t439:0.1335876885,t440:0.1026847421):0.3854426866,t441:0.4527293636):1.852775949,(t444:0.8117990885,t445:0.811418198):0.5027579681):0.4856213223):1.023577507):0.3141752751):1.527594063,(t446:3.694973091,(t448:1.937078574,((t449:0.3470404976,t450:0.2887717443):1.131189656,(t451:0.1627929234,t452:0.1054686517):1.245345963):0.452319969):1.425543823):0.9664344469):0.4506947499):1.334707073):3.766773052):0.5554649908):0.6706949588,(((((t453:0.3445243791,t454:0.3287230709):1.242833305,t455:1.245962202):0.1355702289,(t456:0.8088660458,(t457:0.5603927421,t458:0.3790208829):0.0496616217):0.5066363971):0.08562217257,t459:0.7596679574):1.387990371,(t460:1.658696063,t461:1.635850544):0.4610251165):7.649724142):15.20400962,(((t462:0.563605691,t463:0.4199426293):1.133339363,t465:1.363283644):6.404021748,(t466:1.593676982,(t467:0.2769817539,t469:0.05489841261):0.9570129634):6.171031395):16.80227476):127.020883,((t470:3.30602746,(((t471:2.349224956,(t472:2.164775584,t473:2.042274194):0.07287153746):0.1643868791,(t474:1.895851478,t475:1.819280218):0.3553455924):0.4933374591,t476:2.601529901):0.20149964):38.1793605,((((t478:0.7143186612,(t479:0.5974493492,t480:0.583694776):0.03916791905):8.572144805,((((t481:0.3921725335,t482:0.3788351197):7.238175524,(t483:6.110794726,t484:6.103589654):1.394377638):0.6693330113,t485:8.09288335):0.7952410292,(t486:8.049622999,(t487:6.461885214,(t488:0.3390388759,t489:0.2819359093):6.094328346):1.384639455):0.7282177721):0.0899284995):0.2917612925,(t490:2.286018154,(t491:0.5077234501,t492:0.4985074647):1.759873873):6.443006234):28.9770876,((t493:9.355649311,(t494:6.094630879,(t495:3.824001451,t497:3.732025333):1.955493158):3.15846059):20.23844384,((t498:0.1693376851,t499:0.1164417913):17.39107177,t500:17.4991888):11.39308633):7.699322601):2.135977867):109.3434917);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T97.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
