<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t368:1.801146693,t369:1.439027529):0.01279777525,t370:1.278591736):7.662395746,((t372:2.024524187,t373:2.017862024):3.85004107,(t374:3.977859444,(t375:0.6686585804,t376:0.6604475907):3.276337621):1.756385744):2.608474911):0.1538745162,(t377:6.463651911,((((t378:4.829479054,((t379:3.668241045,(t380:2.921980626,t381:2.911331082):0.7018436323):0.329338804,t382:3.87792542):0.8002591976):0.1105903704,((t383:2.252059828,t384:2.113364903):2.297628949,t385:4.391426614):0.08657660119):0.4060231424,t386:4.746558894):0.8185023058,t387:5.55364866):0.2614538566):1.981149012):118.5706949,((((((((((t388:6.861064873,((((((t390:4.041878018,t391:4.041240386):0.08903363938,(t393:0.5669444976,t394:0.3804640323):3.438143935):0.2105222976,t395:3.735667776):0.08807279929,t396:3.769714483):1.139766325,(t397:4.022997041,(t398:1.414679195,t399:1.359563242):2.502509417):0.4263928795):0.508823208,((t400:0.1202990093,t401:0.1065383052):4.412522751,t402:4.481774692):0.1244848009):0.7419613315):0.407088276,(((((t403:2.670927326,t404:2.575691551):1.039687221,t405:3.528294382):0.06704688374,(t406:2.648815345,t407:2.406523959):0.8065718669):0.1733819345,(t408:2.64037984,((t409:1.063212615,(t410:0.4554436655,t411:0.4453088083):0.5939820984):0.6810629848,(t412:0.8711026954,t413:0.77761867):0.7456548924):0.8326544779):0.4194884658):0.005522927994,t414:2.616550562):1.583415226):0.07512607153,(((((t415:0.6257924274,t416:0.5911819706):2.667104682,t417:3.204699731):0.1628040007,(t418:0.7752591697,t419:0.696129878):2.44696405):0.01818651613,(t421:0.8581376206,t422:0.826960343):1.88343028):0.2741214991,((t423:1.511225857,((t424:1.01970025,(t425:0.7453703259,(t426:0.665865748,t427:0.6577881275):0.02940557148):0.1584303839):0.1350130076,t428:0.9119303902):0.3178669486):0.9725374729,t429:2.194017373):0.3669754859):0.4728229097):1.314322983,t430:4.235183661):1.651232652,(((t431:0.5045430017,t432:0.4409460546):1.226128065,((t433:0.9406947394,t434:0.8828669375):0.05419310981,t435:0.8164695821):0.6534703118):0.848824287,t436:2.294899561):3.278818953):4.023650992,((t437:0.0305075702,t438:0.003744347551):2.882665074,(t439:1.338621232,t441:0.9712006303):1.454668785):6.658948038):2.966593337,(((t443:2.280010225,(((t444:0.8139909098,t445:0.5295874991):0.5093681027,(t446:0.09932189214,t447:0.02702497237):0.8855836287):0.6105416676,(t448:0.7030567712,(t449:0.6373425017,t450:0.1963132646):0.02043892725):0.7729765479):0.2961187809):0.30275498,t451:1.554314903):2.383910127,(t452:2.145735648,(((t453:0.6008322112,(t454:0.2892404183,t455:0.1431213457):0.1401592452):0.8544580278,t456:0.9655654157):0.3818615123,(t457:0.1564127734,t458:0.1376609422):1.087348694):0.1371075067):1.746348943):6.928344677):11.58533389,((((((t459:0.8092750908,(t460:0.5221226829,((t461:0.2173586913,t462:0.1961052415):0.1112547527,t463:0.2734045724):0.1202833747):0.2544752445):1.931620966,t464:2.473182242):3.70889579,((((t465:0.2848986284,t466:0.2229908309):0.1717515571,(t467:0.3090496289,t468:0.260822539):0.07327913022):1.743497462,(t469:0.3775210434,t470:0.2544834066):1.613267049):3.5568841,(t471:0.9976182423,t473:0.5633843468):4.343168289):0.365429083):1.149080861,(t474:0.759284848,t475:0.7098581158):5.474828991):11.40804748,((t476:6.327796444,(t477:0.3909507561,t478:0.2054300336):5.910551083):0.7025909605,(t479:1.181508812,(t480:0.7826152966,t481:0.6906829435):0.3209747833):5.362587985):10.54439239):0.9230902514,((t482:8.986974783,(t483:0.2133837471,t484:0.1396774327):8.744285141):5.130395889,((t485:5.199939471,t486:5.142623327):4.728880203,t487:9.846357788):3.904420645):3.608009703):1.638526596):7.84488218,(t488:9.303707969,(t489:3.907642236,t490:3.867449574):5.174726043):17.51801092):9.672626899,(t472:0.1108114202,(((t442:0.1231431621,(t440:0.07545096698,((t420:0.222631791,((t392:0.02174927782,(t389:0.005836998691,(t371:0.1403705268,(t350:0.2623613657,(t341:0.04850596971,(t269:0.01587032376,(t266:0.01455842934,(t262:0.02510006702,((t226:0.1303981214,((((t163:0.1183187562,(t54:0.09887832102,((((t22:0.007149678466,t1:2.171834341):1.999363143,t2:3.965242552):0.279607718,(t3:1.151204032,t4:0.8941923306):2.913880042):1.167645309,(t5:2.494151551,(t6:1.930993122,(t7:0.5183986201,t8:0.4917344594):1.297102979):0.4368463117):2.421557882):0.5489848215):9.70938206):1.075211161,(((((((t9:3.367724455,((t10:0.3667876169,t11:0.2612539612):0.6849536095,t12:0.9402432985):1.866802866):3.245084299,((t13:3.189225825,t14:3.032033568):0.7880793545,t15:3.684050754):2.002505034):0.5105391102,(t16:2.549544595,t17:2.527188353):3.620226686):5.796000709,(((((((((((t18:1.237886552,(t19:0.08721341018,t20:0.08309887129):1.08796565):1.251641657,(t21:0.1752941701,t23:0.07751520993):2.227101631):0.9632429026,(t24:1.452505478,(t25:0.960301118,t26:0.8688219111):0.2102899808):1.774141105):0.5115335393,(t27:2.707355788,t28:2.605168389):0.5974806319):0.2142740973,(t29:3.230307134,t30:3.200209301):0.1163226634):0.1987148287,t31:3.440268476):5.557642804,(t32:1.863093316,(t33:0.5541143099,t34:0.463608241):0.8285756187):7.07267899):0.1982157804,(((t35:0.1242325206,t36:0.0006521007047):0.6018087031,t37:0.5240698204):0.4060165416,t38:0.8422389526):7.037179543):0.2754504276,(((t39:1.057208091,t40:0.8494486106):3.365319053,t41:4.185293409):3.288584996,((t42:3.100071906,t43:2.775321319):0.6906229613,t44:3.395468973):3.459384051):0.3281610932):1.30043143,(((t45:6.683632736,t46:6.530209095):0.4492916451,((((t47:1.372606904,t48:1.241098596):4.786304507,((t49:0.1338962196,t50:0.09710749613):0.2672147703,t51:0.2953216568):5.585864602):0.507240673,(t52:6.25220316,t53:6.242033699):0.01775353053):0.1682104973,((t55:0.2174588905,t56:0.1634678643):2.233974077,t57:2.129777518):3.415193115):0.09339183786):0.6405071758,(t58:3.968349542,t59:3.964329345):2.152777973):0.6644163342):0.06055467676,(t60:5.884528832,t61:5.858957999):0.9182020447):0.1692687883):0.07424439154,(((t62:0.2984554137,t63:0.2922803013):2.468779119,(t64:0.1903087399,t65:0.1785735013):2.502485451):2.410913699,t66:5.080049101):1.830762978):0.5934321276,((t67:6.915532328,((t68:4.502793946,t69:4.451494755):2.076797188,((t70:3.914506571,t71:3.869680407):0.8818812459,t72:4.681133588):1.565854136):0.2728556757):0.04859613143,(t73:4.598182199,(t74:1.926649451,t75:1.886822039):2.5122219):1.862638954):0.5060980024):1.437632085,((((t76:0.2821254043,t77:0.04051484324):4.03359091,(t78:3.590292164,((t79:2.563967272,t80:2.532374528):0.5958834411,t81:2.807497767):0.1163039188):0.4267972991):1.292343887,((t82:2.908092883,t83:2.857759241):0.6873600367,t84:3.432571422):0.9209954821):1.520048274,t85:5.755689478):0.9469186577):0.8821521345):0.3741056923,(t86:4.330545897,(t87:4.292071063,(t88:2.849394481,t89:2.814141277):1.439058546):0.001066269209):3.601299696):5.155618788,t90:13.00729194):1.124189603):0.1858289079,(((t91:3.603835696,t92:3.592264353):0.0762003985,(t93:1.549697634,t94:1.397207789):2.087580516):1.73853417,((t95:2.047581925,((t96:1.149718637,t97:1.14272812):0.3930242354,t98:1.524906375):0.2969662427):1.972852166,(t99:0.5222073149,(t100:0.2699158966,t101:0.1228053529):0.2321412327):3.235832164):1.073075429):8.888691058):3.105271453):0.3095083355):0.1259612375):6.630087907):0.9425990679):1.982648805):0.9222065137):0.1016359856):0.5187608105,((((((t102:0.4114204552,(t103:0.3399617096,t104:0.3330983078):0.04229007232):1.933845678,(t105:0.4577864972,t106:0.442926296):1.777088448):2.584955962,t107:4.716708698):2.551876877,(((((t108:4.249910669,((t109:0.3921556385,t110:0.2568287296):2.972628967,t111:3.1926992):0.850123741):0.1878777363,(t112:3.893371327,(((((t113:1.696871996,(t114:1.356797111,(t115:0.3198217006,t116:0.2120867685):0.9920974393):0.3251241115):0.05826253663,t117:1.542938184):0.5837570612,t118:2.046966358):0.2508813412,((t119:0.06103181495,t120:0.03449088968):0.8911436305,(t121:0.7003518448,t122:0.6104147185):0.1447984895):1.31655226):0.6478158363,t123:2.567237781):0.630761061):0.2442801023):0.3098104716,((t124:0.5352852851,t125:0.4549851351):1.903252677,t126:2.185309228):1.287616095):0.4079704172,(t127:0.7052825716,t128:0.6681776963):3.082176537):0.0136174538,(((t129:1.239675711,t130:1.179692212):0.9857314471,t131:2.144349375):1.474622237,(t132:1.163301982,(t133:0.3761829048,t134:0.2076928843):0.678176538):2.316901005):0.009958483828):1.973075439):4.029405579,t135:9.07269878):15.2910903,((((((((((t136:0.3936719553,t137:0.2561834974):0.2193302135,(t138:0.1854627207,t139:0.1575754723):0.2170108937):0.5172875284,(t140:0.2227510814,t141:0.1729211727):0.4341576064):8.408624099,((t142:4.270873375,(((((((t143:0.6221811526,t144:0.4012193253):0.03296368957,t145:0.4315930683):0.6218940628,((t146:0.613440423,t147:0.4260194504):0.1928891973,t148:0.606716886):0.2217828728):1.262742641,t149:2.062496581):0.44661221,t150:2.430488172):0.02474848972,t151:2.420559273):0.1360164266,(t152:0.2518391097,t153:0.2242808896):2.109601558):0.7779105488):4.172163836,((t154:0.8940961122,(t155:0.4636091062,(t156:0.4268022117,t157:0.2658089322):0.03444021203):0.00388685055):1.05075385,t158:1.212253374):5.252220367):0.5223231149):2.716457374,((t159:7.173052602,t160:7.042635452):1.634642389,((t161:0.858663366,t162:0.8031557424):6.492652311,t164:7.154323351):1.18915519):0.8515091907):0.8401809475,((((t165:0.8198267815,(t166:0.6374778871,t167:0.6255245136):0.1741004773):1.042933824,t168:1.574344357):3.219788567,t169:4.517366018):3.538684715,((((t170:1.776696125,t171:1.709356144):4.401698471,(t172:1.453991072,t173:1.402116393):4.555444106):0.6070602287,(((t174:1.440073627,t175:1.171057621):2.239312332,t176:3.374625217):2.682542431,(((t177:3.313126657,(t178:1.363021845,t179:1.26088685):1.835316492):0.6943572482,t180:3.725098205):0.9880669343,(t181:2.174649473,t182:2.051697011):2.185541193):0.8758496019):0.1862261476):0.190106674,(t183:1.090947255,t184:0.9028636467):4.297475597):0.6758940896):1.365082899):6.143525784,((((t185:5.947498096,t186:5.896853695):0.3321518326,((t187:2.348660578,t188:2.235451819):2.91142469,(((t189:1.633641952,t190:1.270418909):0.2835215811,t191:1.338892908):1.323450576,(t192:0.9023664065,t193:0.8685294061):1.71519862):1.833271172):0.9380450928):2.890917873,((((((t194:2.245705899,t195:2.219862084):0.009401349463,(((t196:0.4935824781,t197:0.3620897278):0.3689011873,t198:0.7193705374):0.8763050048,t199:1.59213573):0.4489568076):1.215008077,(t200:1.674011563,t201:1.460076601):1.541893162):1.531791314,t202:4.378791508):0.2829034251,(t203:1.326369904,(t204:0.7382343429,t205:0.6906220637):0.5589552135):3.300386385):2.6371794,((((t206:2.579124629,((t207:0.6342625495,(t208:0.194257817,t209:0.1884480903):0.4010332139):1.008791421,(t210:1.321368256,(t211:0.848567361,t212:0.6314649321):0.436275349):0.210054656):0.7642962071):2.61711575,((t213:0.2744924374,t214:0.2565946755):2.993393958,t215:3.232699022):1.337201727):0.3940571819,t216:4.851939873):1.060279597,((((t217:0.2002223113,t218:0.08621590004):2.489995088,(t219:1.977108412,((t220:0.9030307128,t221:0.322267343):0.3233064705,t222:0.5890002782):0.6801138046):0.5933833457):0.6133996312,(t223:0.06661812664,t224:0.0652344742):2.112232097):0.5879084213,(t225:1.384742913,t227:0.9002609814):1.298460545):1.692551182):0.2450480679):0.2063100763):1.711564834,(t228:2.088633545,((t229:0.9624744369,t230:0.7604014318):0.9662501531,t231:1.41940982):0.01994721813):3.758559204):2.378394278):0.8175323121,(t232:3.259600324,((t233:0.02800907477,t234:0.01640443507):1.950710307,t235:1.960693917):1.025777746):5.071002699):3.133015079,((t236:7.930994652,t237:7.873565462):1.076475318,((((((t238:0.6064833651,t239:0.5895298507):3.597698493,t240:3.928627999):3.46265781,t241:7.285061917):0.1082483511,((t242:1.108791949,t243:1.012652164):4.197158827,(((t244:0.03659294092,t245:0.03361028165):1.508865009,t246:1.542133215):1.057665733,((t247:1.929840462,(((t248:0.2222510545,t249:0.1176757297):1.3524171,t250:1.188871258):0.2000828602,t251:1.386997449):0.1217207599):0.2178163609,t252:1.641148773):0.4362230089):2.605901872):2.080501653):0.2942423148,((t253:0.7070266445,t254:0.7026049671):5.961959191,((t255:4.273448734,((t256:2.174023735,t257:2.132662435):0.3080511514,(t258:1.628301251,t259:1.586531917):0.6069955407):1.780899486):1.576776989,(t260:4.390047236,t261:4.375895755):1.14562661):0.8001197679):0.3413720104):0.2064273564,((((t263:0.186040788,t264:0.1000226168):1.892688168,t265:1.869671891):0.1725549291,t267:1.945314944):2.99453098,t268:4.938448869):1.503326389):0.6553952311):1.676535048):0.09631678986,((((t270:4.840413085,(t271:1.60248603,t272:1.517015986):3.232085917):2.026603469,((t273:2.739397186,t274:2.637557875):1.689357515,(t275:3.795371406,t276:3.78606555):0.4437507098):2.270612389):0.02190549743,(((t277:1.287124276,t278:1.238735779):1.455519791,(t279:0.2147484965,t280:0.1432826336):2.00729616):1.430347859,(((t281:0.5783143658,t282:0.5067946389):2.408558099,t283:2.805171484):0.01962510322,t284:2.794356914):0.4815368238):2.326393197):0.0851286034,((t285:1.634881508,t286:1.628322352):0.3291404244,(t287:1.1737921,t288:1.152632466):0.7714099411):3.6858497):1.701509556):1.039055967):1.287085371):3.078595492):0.3977994217,((((t289:6.035829738,(t290:2.037881553,t291:1.887814348):3.912700477):1.920817027,(((t292:5.844476993,((t293:1.920547808,t294:1.917631965):2.483500682,t295:4.161353263):1.298427859):0.292478603,(t296:4.864229314,((((t297:1.791468756,t298:1.74871883):1.480947023,((t299:1.410889353,t300:1.404951466):1.464568413,t301:2.754449214):0.1457089032):0.5327136863,((t302:2.466451959,t303:2.386785275):0.3983970784,(t304:1.753455926,t305:1.73320348):1.011152759):0.4889061735):0.6733833087,(((t306:0.944240819,t307:0.854632566):2.635663299,(t308:0.8326986541,t309:0.6880289793):2.587428126):0.3116324315,(((t310:2.19209672,t311:2.160464391):0.3847773974,(((t312:1.027466382,t313:1.017414334):1.131831846,((t314:0.3998017617,t315:0.3969559086):1.417810891,t316:1.60495003):0.2811898989):0.224807423,((t317:0.9829224761,t318:0.9318457794):0.853314498,t319:1.770636586):0.1504272647):0.1187349407):0.3696350549,(t320:0.4679617409,t321:0.2991819589):1.926746668):0.5824007307):0.006189171137):0.2004504623):0.8820431607):0.2673426632,((((t322:1.493778972,t323:1.467403654):1.84316221,((t324:0.4302005243,t325:0.3828566672):2.35678191,((t326:1.885681685,((t327:0.7906060186,t328:0.7192955981):0.7457485997,t329:1.368673469):0.07650837596):0.2260244018,t330:1.475087998):0.5898805166):0.5066649054):0.07769637708,((t331:2.084998389,t332:2.082184176):0.251686477,(t333:1.811075511,(t334:0.5275904076,t335:0.3834089917):1.149380101):0.3964714182):0.1196445123):0.1636976889,(t336:0.6057821575,t337:0.4527700593):1.437391154):0.4254982347):1.146150507):3.84335902,(((t338:1.261278164,t339:1.199415472):0.2972934755,(t340:1.097056311,t342:0.8778698556):0.1419341879):3.077680336,(t343:1.181686815,t344:1.181228673):2.778397754):2.509951476):1.170045728,(((t345:0.17522948,t346:0.09348259535):0.8697058452,t347:0.9021243402):1.396812297,(t348:2.004706931,t349:1.93500765):0.2941018757):5.129580754):0.1180829367):0.8998149223):0.3530769023):2.409649066,(((t351:1.114854841,t352:1.090628712):7.326479915,(t353:1.874867207,t354:1.681363065):6.47345408):1.593126762,((((((t355:0.124182802,t356:0.05277258232):0.2469573555,(t357:0.09469202766,t358:0.06704835826):0.1840528996):0.829990161,t359:0.8886209005):1.411476941,t360:2.280869415):1.555803895,(t361:1.750673428,(t362:0.4584937225,t363:0.4579759919):1.23902532):2.072047373):3.267053977,t364:7.02496549):2.301924275):0.5953639647):0.1862191167,(t365:0.4441156254,(t366:0.1189078055,t367:0.09143153998):0.2702666146):9.468661525):0.3571534499):38.0708219):79.94269413);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T5.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
