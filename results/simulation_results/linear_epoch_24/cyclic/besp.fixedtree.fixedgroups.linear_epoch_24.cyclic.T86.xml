<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(t471:137.5269233,(((((((t472:1.415886362,t473:1.288410203):0.01964264195,t474:1.128641804):3.563488146,t475:4.319357556):5.126052921,(t476:1.554323022,(t477:0.1250791124,t478:0.03854676778):1.427686916):7.751084559):0.498408304,((t479:1.575688903,t480:1.548252416):5.743358656,(t481:4.117483835,(t482:1.698131928,t483:1.63780323):2.228054968):3.109363761):2.346644484):24.70949369,((t484:4.672738852,t485:4.606111043):12.25730303,((((t486:0.5918194657,t487:0.4699907876):0.1481643001,(((((t459:0.1811218054,t460:0.1460129761):0.07899740417,t462:0.05425556804):0.1077451064,(t461:0.01310681323,(t456:0.02719398306,((((t395:0.05520428352,(t378:0.04694026321,((t354:0.04586669375,((((t321:0.07713238326,((((t274:0.008687825847,(((t264:0.06915032699,((t166:0.004372154129,((((t132:0.0152847917,(t113:0.01966248579,((((t50:0.07192238681,t1:4.399192108):0.6921289542,(t2:3.569135546,t3:3.516375649):1.478114974):1.462682931,t4:6.454132669):1.047425841,((((t5:1.512600896,t6:1.409455863):1.395184444,t7:2.597178974):1.646083133,((t8:2.635677418,t9:2.361036156):0.7144578495,(t10:2.286565502,(t11:1.230139671,(t12:0.3439898181,t13:0.2580156524):0.7024385088):1.041516117):0.5994618333):0.7857030059):0.5405399746,t14:3.772077635):2.323720767):2.247147589):1.557387225):0.813258049,((t15:4.274663303,(((t16:2.445447211,(t17:1.801269841,t18:1.672393826):0.5795746079):0.3329142473,((t19:1.520759546,(t20:0.4461322232,t21:0.3831995745):0.9064520823):0.9115417376,(t22:1.522466843,t23:1.481474189):0.6750043515):0.04220253679):0.5314416051,(t24:0.3421487855,t25:0.2481880761):2.386707721):0.9332884436):0.9293101869,((t26:1.817907869,t27:1.762484589):1.563027299,((t28:1.837878211,((t29:0.9014408139,t30:0.8707964376):0.6160997468,(((t31:0.06858836349,t32:0.01834119998):0.2834983975,t33:0.02522052683):0.0886505457,t34:0.100924044):1.025514005):0.2207423198):0.2205710823,t35:1.540872044):1.25352711):1.086445946):5.502505182):1.140118614,((t36:0.2757835993,t37:0.2473150594):1.294120645,t38:1.506945825):8.881965935):1.090676208,(((t39:0.6493650186,t40:0.5502800192):1.30620606,(t41:0.7556344435,t42:0.6826979413):1.07297659):8.50604203,(((t43:3.905950975,(((t44:0.1706786672,t45:0.03408758895):0.08946282289,t46:0.1065893272):1.364690683,t47:1.417529488):2.033691298):1.901293495,((t48:1.064804243,((t49:0.5326737717,t51:0.3316261458):0.02999790046,((t52:0.1749217561,t53:0.1418235768):0.06794505346,t54:0.06528181315):0.01751826652):0.453525552):0.328252115,((t55:0.2478863375,t56:0.06558113283):0.1190488396,t57:0.182304012):0.4331101341):3.819437244):1.131618851,(t58:1.643718219,(t59:0.6216641629,t60:0.4551551819):0.9926123051):3.87922121):3.134960493):0.7366178989):0.02633590415):7.044480861,((((((t61:0.3755205612,t62:0.119213336):0.4792674891,(t63:0.4092155761,t64:0.2864421034):0.1813636215):5.582772537,((t65:3.303072418,t66:3.125190083):0.2954568604,t67:3.320976344):2.376222077):2.883875412,(((t68:3.004407908,(t69:0.9941810273,t70:0.7408846664):1.915529301):1.384865038,t71:3.943014333):3.065448405,(((t72:0.2986310797,t73:0.1482659525):0.250903807,t74:0.3874291038):4.370216803,(t75:3.478733463,((t76:0.3020108723,t77:0.1105611891):0.7289553858,t78:0.823073333):2.44346116):1.245477372):2.077341898):0.9780992664):0.0600019683,((t79:0.9120446181,(t80:0.1153113236,t81:0.05860794792):0.7526685423):6.387257402,(((t82:0.2618741638,t83:0.2307232785):1.258994779,t84:1.487932838):5.520536549,((t85:3.205572421,t86:3.162364341):3.346332999,(t87:2.614035032,t88:2.468503076):3.648541453):0.4071023914):0.08724954137):0.3049550319):0.273405068,(t89:6.787017263,t90:6.677449207):0.3625411609):6.590669726):1.657483904):0.3770027118,(((t91:6.943484385,(((t92:1.371374842,t93:1.073099435):1.699462217,t94:2.671797418):3.061914603,((((t95:2.85156506,t96:2.683613621):0.3777904501,t97:2.827635052):1.065155967,t98:3.84602318):0.272287322,(((((t99:0.3604374138,t100:0.2803815022):0.5446321792,t101:0.8143714933):0.01000133885,t102:0.7938796155):2.159534683,t103:2.908486383):0.8699242781,(t104:2.575075428,t105:2.521150041):1.008179383):0.05622815123):1.00891392):0.8063396211):0.64842109,(t106:5.96898393,(((((t107:2.210718953,t108:2.135194102):0.8566384027,(t109:1.530094741,(t110:0.1541337651,t111:0.1507266029):1.363365908):1.454067572):0.4166212807,t112:3.193298165):1.596433337,((t114:3.340103734,(t115:1.688158557,(t116:1.153491356,t117:1.125075138):0.4950184957):1.619537244):1.205520298,((((t118:2.532614335,t119:2.488883306):0.1442346954,(t120:2.341581268,t121:2.260596624):0.1913260564):0.2111376506,(t122:1.459652425,((t123:0.3283103288,t124:0.3217321633):0.08911962122,t125:0.2828419106):0.9298267532):1.202198111):0.6519087851,(t126:1.379736885,t127:1.286660397):1.501583992):0.8155081884):0.07570646709):0.6707381162,(t128:0.8718417498,t129:0.7275196734):3.240751673):0.1741904249):0.02880157573):2.655771789,((t130:0.2466475741,t131:0.2049030807):1.416062724,t133:1.541534208):5.16304843):5.41583742):0.05679860833,((((t134:2.014652987,(t135:1.618483585,t136:1.598913704):0.3356854475):2.374948024,((t137:0.3142932733,t138:0.1842301377):1.441529812,(t139:0.9901191505,t140:0.9320174331):0.4738686796):2.479989004):4.861551818,(t141:2.094093957,t142:2.080931386):6.461578296):1.976659179,(t143:5.458744956,(t144:0.4750101939,t145:0.4468845739):4.973392462):4.971274988):0.9295698983):0.6804213337):0.186538825,(((((t146:0.572018815,t147:0.3304675969):0.8923887546,t148:1.203814339):6.883520635,(((t149:2.037300767,t150:2.028990713):0.5313813927,t151:2.29324862):4.145051228,((((t152:1.811628669,t153:1.754591383):1.1771865,(t154:1.943821633,(t155:1.485947917,(t156:0.9519518037,t157:0.5773236002):0.3912106062):0.3050067544):0.9643175636):0.185060309,(t158:0.3685274967,t159:0.2604239648):1.937840918):1.181658463,((t160:0.3364493556,t161:0.2641411426):1.452362075,t162:1.660677312):1.479330202):1.847703005):1.372708152):2.479607392,(t163:8.463033801,((((t164:0.4093893723,t165:0.3900162292):1.374960641,(t167:1.611944154,(t168:1.139377521,((t169:0.5228320375,t170:0.4842341595):0.2780579628,t171:0.3601138921):0.2669047248):0.4354407083):0.09892619833):0.4054525311,(t172:1.49844431,(t173:1.110841417,t174:1.017101302):0.2319835547):0.04235913432):2.814754701,((t175:0.1469594049,t176:0.07669385753):3.474963007,(t177:0.6896461407,(t178:0.3246718401,t179:0.1754977045):0.3058182887):2.851340418):0.4641880432):3.428308881):0.3233824048):0.8652228642,(((t180:0.1525929309,t181:0.1189922779):7.89672009,((t182:1.263948896,t183:1.002347927):2.021577782,(t184:1.60445947,t185:1.495132287):0.975166617):4.685037489):0.01332023772,(((t186:0.8342582179,(t187:0.779744738,t188:0.694136644):0.03460063491):5.518022634,(t189:2.26335394,t190:2.181376354):3.902478667):0.1395261343,(t191:0.4526558728,t192:0.3254372417):5.74005902):0.6148291003):0.1533676558):0.4541133604):0.9193118866,((((((t193:4.922833241,(t194:4.404384996,(t195:1.642642416,t196:1.531717668):2.754495885):0.4943099617):0.9244818463,(t197:5.524296026,((t198:1.403664679,t199:1.354017751):1.213630312,t200:2.532150522):2.83644395):0.1262326621):0.4940542748,(t201:4.197196547,t202:4.139023544):1.763566927):0.140498194,t203:6.031257942):0.2942057211,(t204:1.568056554,t205:1.387116244):4.69054311):0.0216260805,(t206:3.067357702,t207:3.010963119):2.996890092):1.397579495):0.7195512988,((((t208:3.76023757,t209:3.484284756):1.435666485,(((t210:0.365723933,t211:0.2147527112):3.441908319,(t212:3.525467587,((t213:1.24377275,t214:1.173634922):2.112380071,t215:3.166328517):0.008005238806):0.1002699753):1.077054772,(t216:0.9117144624,t217:0.8620980185):3.422173901):0.0225740538):0.6449860092,t218:4.901956198):0.2508491679,(((t219:1.780022882,t220:1.759813965):1.055157882,t221:2.616732942):2.018162754,((t222:0.09286442056,t223:0.02098084457):3.919892138,t224:3.926943895):0.5355348088):0.2640678358):1.893294009):3.584299432):2.492774269,(((t225:5.71054312,(((t226:3.485963561,((t227:1.855813505,t228:1.781053566):1.337231874,(t229:2.99950241,(t230:2.859235346,(t231:2.07592647,t232:2.057568296):0.7822189557):0.1234293134):0.01069721383):0.2160216073):0.1385234944,((t233:2.214080133,t234:1.960268398):0.6610381857,t235:2.525986685):0.3481441084):1.934424139,((t236:2.206861713,t237:2.064809563):1.58735619,((t238:0.488606427,t239:0.4507121092):1.664383015,t240:1.934315757):1.088196628):0.9281100912):0.1238783578):0.1920296234,(((t241:1.256776667,(t242:0.4467862347,t243:0.3766953289):0.7212608551):1.144375056,(t244:1.166298479,t245:1.066026413):1.02406272):0.8440548318,((t246:2.641875723,(((t247:0.3870468417,t248:0.1463994088):0.3862693296,t249:0.4635876969):0.3307177633,t250:0.7887961721):1.48904722):0.05440675485,t251:2.277748831):0.2113460998):0.8503565056):3.46389763,(((t252:1.993300033,(t253:0.5603439135,t254:0.5126514637):1.363915039):2.694189951,((t255:0.3527480182,t256:0.3312539193):0.8180796422,t257:1.145871697):3.355417969):0.6039432811,(((t258:1.786642345,t259:1.469885858):1.040740659,(((t260:0.4888339017,t261:0.3063551273):0.6704069204,(t262:0.8741208025,t263:0.8286987039):0.06608279635):0.1180228133,(t265:0.9121138623,(t266:0.8539607343,t267:0.7993710543):0.05268156225):0.009635464633):1.189658517):0.6266134876,t268:2.628946902):1.513967104):1.478974999):3.274676055):0.2357226696,(t269:2.896819605,(((t270:1.154747623,(t271:0.8809106509,t272:0.7425042685):0.05693842073):0.3553148491,t273:1.042744033):0.1272277088,t275:0.9172262205):0.9919084639):6.132048306):1.049062966,(t276:6.078286808,((t277:0.2327774764,t278:0.1936706343):1.602184129,t279:1.679693688):4.237613641):2.935361593):0.3541277794):1.859595619,((t280:1.414801323,t281:1.280582452):8.216634159,t282:9.493769415):1.349573241):0.2976352369):1.869767554):5.027638344,((((t283:8.414821267,(((t284:7.907338631,t285:7.630156305):0.07350214963,(t286:5.573611698,t287:5.570011284):1.885640684):0.3241567916,((t288:0.6290788511,(t289:0.3031362985,t290:0.2806617437):0.2716760081):0.3431372157,(t291:0.730174178,t292:0.09196202851):0.1573755798):6.784011702):0.05956824195):2.186827698,((t293:7.037134398,((t294:0.2650279559,t295:0.1339802903):2.192263966,((t296:0.7686634563,t297:0.4094033461):0.4747560266,t298:0.7269456913):1.03653616):4.307256289):0.504420648,t299:6.550602749):1.655606181):2.347622742,t300:10.37849834):4.632794252,(((((t301:2.819955222,t302:2.815677466):0.9212917455,t303:3.614731515):3.171751791,((t304:2.759632888,t305:2.638634135):2.633995794,(t306:2.089573917,t307:1.944646833):3.045226389):1.30993843):1.301722765,((t308:4.106999954,t309:3.942474937):2.740443294,(((t310:2.237549072,t311:1.953773774):2.324169153,(t312:4.126813457,(t313:1.499068063,t314:1.424433438):2.622105037):0.075152011):1.335043736,t315:5.451906424):0.7755629642):0.6871948998):3.575007676,(((((t316:1.469010033,t317:1.397321831):2.993273328,((t318:3.875564484,t319:3.855169539):0.07736821663,t320:3.843685365):0.3204603479):0.2334323884,t322:4.171026568):0.6061750088,(t323:3.156934783,t324:3.052720899):1.479936752):2.282073212,((t325:3.298163934,t326:3.168312552):0.7494842715,((t327:2.185974281,t328:2.141164082):1.297916471,t329:3.265550252):0.4325668816):2.722449196):2.779907753):3.189755857):0.1295452385):0.3766808171,(((t330:3.593998866,(((t331:1.092529594,t332:1.054369904):0.4757599049,((t333:0.09489194801,t334:0.02450163275):0.1361111706,t335:0.1035737003):1.13244001):0.7936504107,(t336:0.8837421857,((t337:0.02736355114,t338:0.003811038858):0.7341305149,t339:0.4545645052):0.1159342689):0.2713034279):1.198307425):1.715195616,((((t340:0.6713057555,t341:0.5116679099):0.414186821,t342:0.8530747709):0.2705807658,t343:1.074705275):0.1194836913,t344:1.071170331):2.262294069):6.476368917,(t345:7.264824219,(((t346:3.039864448,((t347:1.979780149,(t348:1.034052503,t349:0.8425242456):0.8467768544):0.69308855,((t350:0.4605624299,t351:0.3593508452):0.3978445241,(t352:0.1756863975,t353:0.01815599846):0.2288327204):1.390115243):0.3379008577):3.221757302,(t355:2.069444774,(((t356:0.5425178176,t357:0.5386705651):0.1792865707,t358:0.6282204641):0.5769618182,t359:1.1943023):0.6280738967):3.03199808):0.1409254415,(t360:1.057363092,((t361:0.127922284,t362:0.08426119625):0.7190593087,t363:0.7980392559):0.09067029188):3.929387642):0.7278949131):2.444081772):0.9857058679):0.5057615396,((t364:0.6034860264,(t365:0.3106816158,t366:0.2779121537):0.1299041201):1.333912748,((t367:0.4321318168,t368:0.3867336215):0.2071671351,t369:0.5361058355):0.5905374346):7.46968504):0.6537769605):0.2744915696):0.3025746813):0.2117118426,(((((t370:0.4649173725,t371:0.3546320675):2.725531587,t372:3.032976798):3.503391693,(t373:0.9893286751,(t374:0.6252528253,t375:0.3491973981):0.3377195992):5.422722603):0.6059480593,t376:6.650915011):0.4198995529,(((t377:4.61902845,t379:4.405226552):0.5892372858,((t380:4.113932848,(t381:1.950669014,t382:1.519622121):1.965304919):0.3850216437,t383:3.562221443):0.2223979963):1.518991763,t384:5.232703056):0.3171540408):2.280348505):0.5455124747,(((((t385:2.841881421,(t386:2.081045445,t387:2.046892788):0.7153065163):2.098757341,t388:4.854270244):0.7424104705,t389:5.594410275):0.671422296,(t390:5.449783818,t391:5.423031357):0.7424134973):1.129913041,(((t392:0.2975484899,t393:0.2270139337):6.298471315,(((t394:0.914925329,t396:0.7282027613):4.275576832,((t397:0.4304466992,t398:0.04429466181):4.501538393,(t399:3.91550788,t400:3.760733892):0.5208498646):0.03049504786):0.4354011297,t401:4.670495384):0.8829521808):0.1930270152,(((t402:2.990318489,(t403:0.4553917932,t404:0.4077179457):2.410980314):2.074029129,t405:4.738623833):0.1917023502,(t406:3.85550718,t407:3.80659838):0.8385827298):0.2634828284):0.4193794181):0.8725806183):2.530626815):6.642297645,((((t408:2.907866783,(t409:2.713558731,t410:2.514768895):0.1825567191):0.9978629719,t411:3.50137046):7.559765889,((t412:5.108545201,(((t413:2.60456664,t414:2.551552834):1.18164792,(t415:0.448164782,t416:0.3201117934):3.198835372):0.9594605949,(((t417:1.429052222,(t418:0.8199805927,t419:0.7883870744):0.4541851101):0.4710570788,(t420:1.564329846,(t421:1.256257093,t422:1.075755085):0.2108898448):0.1434749218):0.004785537124,t423:1.384950923):2.535521145):0.3286834101):0.6161097544,(t424:1.265288957,t425:1.100071923):3.548183215):5.31926114):1.530273331,((((t426:2.9130014,t427:2.878299847):3.590018234,(((t428:0.9367145076,(t429:0.307078436,t430:0.2958713891):0.2971814162):2.689028377,(t431:0.4691371961,(t432:0.1582585314,t433:0.04635083184):0.2489650798):2.711186029):0.80315876,((t434:1.777598155,t435:1.698842841):0.6312507583,((t436:0.119333789,t437:0.08465652939):1.031641836,t438:1.037436835):1.056288022):1.379216044):1.877081216):0.320355532,t439:5.668775042):0.1669140285,(((t440:2.305459011,t441:2.303627615):1.110553386,(t442:1.636412495,t443:1.604479724):1.750852265):0.3423754336,(t444:3.404312376,(t445:1.997097567,t446:1.777911174):1.337137894):0.2481137611):2.027662846):4.084811911):2.372158989):0.6599861404,((((t447:1.645878009,t448:1.333223421):0.1897369551,(t449:1.052311168,t450:0.8877924765):0.2594681632):1.161459939,(t451:0.5184716838,(t452:0.2044423326,t453:0.1910462185):0.2423427104):1.738310491):5.291975246,(t454:0.4569477662,t455:0.4136019214):6.809582197):4.038679932):8.741160519):16.96462746):33.49049985,(((t457:0.7117184309,t458:0.6480200008):18.39197663,((((t463:0.8943958258,t464:0.7321763666):0.5013982039,t465:1.157259948):0.27598832,t466:1.397535413):7.345534435,((t467:0.3612483238,t468:0.3278483498):1.461334209,t469:1.733221462):6.880925185):9.49560264):15.75479998,t470:33.67852686):35.42782407):68.42880623);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T86.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
