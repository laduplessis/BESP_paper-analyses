<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t484:7.469910301,t485:7.469324336):2.102238721,((t486:4.990316998,t487:4.880016896):1.148223771,(((t488:0.1783544286,t489:0.03236855333):0.2205985848,t490:0.2365973316):1.159227574,t491:1.39111997):4.460274995):3.349292057):47.94026168,(((t492:5.58052771,(t493:1.67560705,((t494:0.1432530805,t495:0.1086422321):1.076224626,t496:1.022335453):0.3829828418):3.766620863):3.618178385,((t477:0.1080377771,(t469:0.09700044762,((t466:0.2509128588,(t459:0.001339892236,((t442:0.09217663027,((t386:0.01799563846,(((t346:0.00314618376,(t327:0.07259517202,(t323:0.08861627809,((t267:0.1312111529,((((t247:0.7380788472,(t249:0.3451325369,t250:0.1409069339):0.1346284169):0.1224970545,t251:0.2887288159):0.07522241228,((t248:0.09865582436,((t241:0.1622828753,(t240:0.2258261428,((((t162:0.02980081436,((((t131:0.01067421265,(t129:0.119638993,(t122:0.2215838828,(t95:0.00212041752,(t75:0.01915135316,(t39:0.006244825477,(t37:0.1171716191,((t1:0.820441169,t2:0.6781599893):2.601089601,t3:3.171215589):0.3665783207):0.07299092767):2.922486285):2.088658655):3.131701799):0.5525906842):0.09683731008):2.023195761,((((((t4:4.273307046,t5:4.204668453):1.646350188,(t6:2.142890535,t7:2.056767613):3.689154429):0.02278012689,(((t8:1.319439627,t9:1.037128234):1.362786084,t10:2.302635073):0.3067975587,((t11:2.102651487,(t12:0.8248917529,t13:0.7138770552):1.038631193):0.1091694906,t14:1.675574161):0.2554350801):2.638382152):1.362970054,((t15:1.130173395,t16:0.8969156948):3.032361183,t17:3.921333134):1.688121986):0.5878026109,(((t18:2.173541469,(t19:1.694795217,t20:1.565648336):0.4710375887):0.5578748362,(t21:2.207328045,(t22:1.946729981,t23:1.840381063):0.2499243107):0.3235360144):0.02636046418,(t24:1.011253493,t25:0.9877574087):1.316802042):3.42307141):2.759775503,(t26:3.480471374,((t27:0.4231886608,t28:0.2882647873):1.027711765,t29:1.209134731):2.006749722):4.996954336):3.717447011):0.1107237434,(((t30:2.221732674,(t31:1.027928977,t32:0.8996652552):1.187026812):6.538040653,(t33:4.479966797,((t34:0.1960127331,t35:0.192142597):1.672448512,t36:1.643216677):2.423593296):4.037813734):1.601251329,((((t38:2.410560191,(((t40:0.6705484324,t41:0.46648894):0.5312038361,(t42:0.6163173684,t43:0.4389321858):0.1248744312):0.2522393016,t44:0.792823501):0.7584162608):0.6679234052,(t45:0.9175672766,t46:0.8911502685):1.263779931):4.314147781,(t47:3.419092934,(t48:1.655982381,t49:1.601039251):1.570222216):2.755125157):1.253515069,t50:7.155972465):0.7020996649):1.627831763):1.766338559,((t51:1.3606723,t52:1.305464915):9.445228772,(((t53:5.262994194,((t54:0.4360727878,t55:0.4214699129):0.04660431436,t56:0.4431792442):4.764264051):1.883845397,(t57:4.514525665,((t58:0.5641598758,t59:0.5634389515):3.930513171,(t60:0.44833958,t61:0.413001879):4.041813833):0.01395822459):2.529676034):1.19306745,(t62:2.960096877,(t63:1.710373926,t64:1.66561841):1.211862011):5.204656531):2.379480654):0.272063497):0.1149865806):0.4226085993,((t65:0.1487429459,t66:0.004857752535):5.452404536,(t67:5.258770996,(t68:4.619345564,t69:4.539168597):0.6246998823):0.1120648627):5.574262905):5.964720744,(((((t70:1.224572391,t71:1.192124875):4.967073996,(t72:5.161399464,(t73:0.7819596571,t74:0.6742940359):4.260395474):0.7949794789):1.763039789,(t76:4.575933073,t77:4.490196702):2.847851571):0.505770485,(((((((t78:0.6334973138,t79:0.5820140845):0.2421272201,t80:0.7693727814):0.6532307305,t81:1.343645334):0.6595889405,(t82:1.408555864,t83:1.404410371):0.5733999532):2.115870636,t84:3.836112201):1.517565207,((t85:2.513652589,(t86:0.482839733,t87:0.4179175026):1.981887087):2.088846883,t88:4.376189615):0.6427623241):1.407489692,((t89:2.268351936,t90:2.244420131):3.33752436,((t91:3.71523393,t92:3.702885692):0.08660157554,t93:3.643763784):1.590081831):0.5955115808):0.4564857557):4.485107368,((((t94:5.303897898,t96:4.981470001):0.01529338156,((t97:0.3312456606,t98:0.288122448):3.084180854,(t99:2.44193245,t100:2.284847886):0.8577169182):1.503591914):1.083698388,((t101:3.292590075,t102:3.158313632):1.764022912,t103:4.797061698):0.521257995):2.406731129,((((t104:2.32956918,(t105:0.5768174817,t106:0.5648012528):1.725187239):0.3096594028,t107:2.432586513):0.2430577315,(t108:2.10726851,t109:1.886527819):0.5307552392):1.738729961,((t110:3.406147096,(t111:2.721252086,t112:2.634247424):0.6661155378):0.5176477075,((t113:2.458627123,t114:2.452871423):1.256305289,((t115:1.543455431,t116:1.409304587):1.433758449,t117:2.794211928):0.7131725556):0.02352322834):0.2283722531):3.059750278):1.791363886):3.813005117):0.4988503014,((((t118:1.046463252,t119:0.989908491):2.419748771,t120:2.810748797):1.721943964,(((((t121:2.186533831,t123:1.891322378):0.01697026688,t124:1.880715803):0.7798991862,t125:2.619910953):0.04842371134,(t126:2.182480714,(t127:0.7967103064,t128:0.7018970611):1.283132015):0.4355156445):0.920377564,(t130:0.8161687511,t132:0.7884226274):2.264816197):0.262106226):0.1412434138,(t133:2.7691118,((t134:0.9407514845,(t135:0.5215745458,t136:0.1269036012):0.0843669993):0.8531753037,t137:0.9842204761):0.7840199095):0.5147797517):7.43114406):0.1330870017):0.1796778288):0.5322532501,((((((t138:0.7580627995,((t139:0.1251069616,t140:0.1129474385):0.3297877838,t141:0.1777899206):0.2370139853):1.440482719,(t142:0.704463404,t143:0.6022796904):1.118409046):0.4219592202,t144:2.133195777):6.799603311,((t145:5.308454395,t146:4.98071633):2.030245224,((t147:2.329284179,(((t148:0.1399324181,t149:0.06969131658):0.2472481163,t150:0.3047036121):1.50492479,(t151:0.8745626691,(t152:0.6731278994,t153:0.5461579226):0.09229110182):0.6855868041):0.3298820048):1.285370046,(t154:1.396096786,t155:1.17094131):1.507392427):3.232557232):1.419777872):0.1356538794,(t156:4.173699919,t157:4.104741958):3.28554506):0.2577622776,(((t158:2.42753087,t159:2.422728011):3.55813192,(t160:4.282509292,t161:4.232200358):1.633612559):0.755306306,t163:6.276149469):0.7285538932):0.556351111):0.04447651531):0.5866494807,((((t164:4.974120259,(t165:0.1035678009,t166:0.09414299758):4.799450491):1.169553171,t167:6.012899617):1.230552168,(t168:3.465885124,t169:3.356423574):3.711137566):0.5381138368,t170:7.499973118):0.2560618655):0.1262930667):0.2626657204,((t171:4.956419107,(((t172:3.626412869,t173:3.565013435):0.1597008452,t174:3.645414746):0.2434091348,((t175:1.139274973,t176:1.104291654):0.519949941,(t177:0.3611572407,t178:0.2843374106):1.099358823):1.996204569):0.8964372166):2.335105697,((t179:3.782650143,(t180:0.09084242059,t181:0.03088122362):3.484681159):1.836497107,(t182:0.60543503,t183:0.6026234915):4.529397807):0.9783245184):0.3970037045):1.406788364):0.7601186471,((((t184:5.214164398,(t185:0.3467750169,t186:0.2197341711):4.853009411):0.06996986802,((t187:0.4665674057,t188:0.4459108465):1.087095391,(t189:1.187175658,t190:0.9842180689):0.3157507928):3.540838528):1.52151193,t191:6.302830885):0.2886582579,((((t192:2.209422901,(t193:1.024008983,t194:0.9715093554):1.073058289):0.9894357496,(t195:2.553996292,(t196:2.112222391,(((t197:0.2010741508,t198:0.1461297226):0.00465718279,t199:0.08040952671):1.553301215,t200:1.617070394):0.2796684218):0.3640613537):0.2810940901):0.8141883861,t201:3.311448863):1.965884583,(((t202:1.031318183,t203:0.8975839261):2.118636326,t204:2.937622117):1.703314641,(((t205:2.571935682,t206:2.349269811):0.4407008927,t207:2.779073755):0.7214797211,((((t208:1.161219285,t209:1.144086935):1.189379733,t210:2.288205101):0.31572321,(t211:1.608914162,t212:1.520055097):0.5666566602):0.3188797589,(t213:2.175881616,(t214:1.454166638,(t215:0.2951149414,t216:0.2195767303):0.9407341282):0.7155756234):0.1689771922):0.3006108694):0.8764011919):0.4107532591):0.5890624855):1.521616243):4.543250536):0.613438648):1.881781875):0.9790135888,((((((t217:1.853086912,t218:1.803481508):1.275859611,(t219:1.193969828,(t220:1.127794595,(t221:0.2333425044,t222:0.1319006372):0.7990122791):0.04892190729):1.855753625):3.539855036,(((t223:0.4093363908,t224:0.3665330176):3.895413121,((t225:1.393191719,t226:1.31721837):0.9303870518,((t227:0.2969418755,t228:0.259581802):0.6256491193,t229:0.8277959904):1.134455775):1.872414167):0.1760198203,(((t230:0.4549008395,(t231:0.2405585193,t232:0.2234916778):0.1749584846):2.406693592,(t233:0.3752849541,t234:0.3182669847):2.354287714):0.05867763647,(t235:1.223398715,t236:1.133114599):1.31353216):1.086117573):1.87675344):3.35424526,((((t237:0.1442601502,t238:0.07004648291):0.2372052235,t239:0.2970369213):0.7554963951,t242:0.4946150071):5.798221478,((t243:0.3865352126,t244:0.3547198393):2.11717462,(t245:1.26464733,(t246:1.105096064,t252:0.05095564374):0.1268613944):1.152022352):3.641320237):1.779793243):0.1036064391,((t253:3.687404126,t254:3.338325375):2.675150112,t255:5.951589087):0.483524985):1.386443772,t256:7.800473103):2.101453964):2.056039962,((t257:7.779085697,((((t258:4.932153119,t259:4.87664643):0.2789533312,(t260:4.784211359,t261:4.749566368):0.0316030792):1.018231904,(t262:3.011332041,t263:2.959583079):2.655316914):1.270498072,(t264:4.20060716,((t265:0.4692398625,t266:0.3612213762):0.3028382642,t268:0.2492533712):3.425696451):2.621922698):0.2485982765):1.448803328,t269:7.981921687):2.704033411):0.03647136629):0.4935012957,(((((t270:0.9872157415,t271:0.819437):2.242335485,(t272:0.4098448055,t273:0.3080961141):2.536054834):4.801857159,t274:7.605987417):0.1433581181,(t275:5.956065637,(t276:5.306669914,((t277:0.7103181914,t278:0.6856508981):2.875246824,t279:3.47802548):1.503735135):0.6349255948):1.699752318):0.6141666581,((t280:4.284106221,(t281:2.499669959,t282:2.449162368):1.68899123):1.213492768,t283:5.273369506):2.265881204):2.417749893):4.383270403):0.1181961791,((((t284:6.528983274,((t285:3.738555347,(t286:2.739248395,t287:2.735876183):0.8699978399):2.35738506,t288:5.864705921):0.3710517195):0.8346660593,(((((t289:3.745583438,((t290:0.8357664287,t291:0.7451613979):0.1148847373,t292:0.8599877771):2.794213059):0.6277270682,t293:4.170937541):0.5892055205,((t294:0.5806034473,t295:0.5322163315):2.807193652,(t296:2.253943084,(t297:0.7183032729,t298:0.6638812865):1.41058029):0.6981316256):1.287827624):1.006151558,((t299:3.907343651,t300:3.903524726):0.6959528664,(((t301:0.2820719801,t302:0.272632379):0.613485143,t303:0.8357015563):3.337923455,(((t304:1.088627935,t305:1.004002918):1.138647235,t306:2.113365986):0.3762486768,t307:2.239838626):1.485105987):0.2378183113):0.3321104144):0.8496131336,((t308:2.16880237,((t309:0.6892072587,(t310:0.5318681368,t311:0.4244676571):0.1222981905):0.3129487994,t312:0.8389240342):0.9886963208):1.697864322,(((t313:0.3158959579,t314:0.2733118567):2.844256063,(t315:3.01459792,t316:2.960837965):0.07415978469):0.05537021365,(t317:1.671827241,(t318:0.6806779255,t319:0.4805527733):0.9841703411):0.9229313009):0.1051222736):1.237360926):0.2419130731):0.3570237468,(((t320:2.415016865,((t321:1.357744179,t322:1.352619672):0.1224382065,t324:1.301358126):0.9126772501):0.005915469562,t325:2.12497965):0.4130718076,(((t326:0.6032346669,t328:0.3734252518):0.4345771912,(t329:0.5215033867,t330:0.4921936911):0.1607563456):1.11897706,(((t331:0.1429394921,t332:0.1425445922):1.028746169,(t333:0.6475875782,t334:0.3355147102):0.4960830167):0.3295158317,t335:0.8606458914):0.03699941105):0.1260772331):1.485504244):5.961963954,((((t336:0.6090653864,(t337:0.09849317988,t338:0.002698665595):0.4029647152):1.033106192,(t339:0.6367003324,(t340:0.5932758362,t341:0.4413499995):0.02463804859):0.7922420304):3.85192284,(((t342:0.9965017444,t343:0.9329994229):0.05293290851,t344:0.8979840561):0.04898404979,t345:0.9347110608):3.976435795):2.409582094,(((((t347:0.3161269475,t348:0.2387996849):0.8767805229,t349:1.100310399):0.1405252514,t350:1.203755004):1.101111582,(t351:0.51633952,t352:0.3456822727):1.783272357):1.160333324,t353:3.138554512):3.625697012):0.4201255307):0.4112752127):1.34054989):0.8883178251):0.1519218796,((t354:4.576090399,t355:4.446021594):5.179350479,(((t356:6.485735086,(t357:1.548238622,t358:1.248157626):4.903620789):0.2141444688,(((t359:1.966906666,t360:1.896833324):0.603570583,(t361:0.1406028834,t362:0.08826717822):2.328747795):2.999249996,(((t363:2.755048491,t364:2.66077165):2.038523634,t365:4.487640834):0.4015339133,(t366:3.128770865,t367:2.92985125):1.493366684):0.1505801221):0.7792414568):1.620562244,t368:6.958470036):1.300976958):0.08947532963):0.0833021252):0.8980582033):9.172945669,((((t369:2.26989462,t370:2.104079124):9.335804317,(((t371:5.990177951,t372:5.912990714):1.716149111,(((t373:6.11687075,t374:6.048925731):1.143606201,((t375:2.315116884,t376:2.213517028):4.62915595,(t377:6.319781667,t378:6.290329605):0.5155688857):0.1441650945):0.2104807759,(((((t379:0.6712219542,t380:0.6003067302):2.542237848,t381:3.084618481):2.218123389,(t382:1.420955141,t383:1.419952728):3.871794156):0.7819617412,t384:5.999710584):0.1459801595,(t385:1.266950163,t387:1.172914902):4.841549273):0.7897271866):0.1039365945):3.421294862,(((t388:0.406323907,t389:0.3597857292):3.739377451,t390:3.993215736):1.274521075,t391:4.861236443):4.855093418):0.3070239317):4.488987836,((((t392:2.051572385,t393:2.014009305):2.366710482,(((t394:1.434350601,(t395:0.2028300491,t396:0.1963861485):1.052856038):2.042414517,t397:3.284482262):0.005528774389,t398:3.286250167):0.7075593479):2.780580045,((((t399:1.947898239,t400:1.947875309):1.564432768,((t401:2.696217512,t402:2.495288112):0.3980325935,t403:2.88350281):0.2795068532):2.151379328,((((t404:2.992891322,t405:2.892146515):0.04432034022,(t406:1.984654471,(t407:0.6588635006,t408:0.5302910455):1.250707897):0.8394096069):1.093412235,((t409:1.103874486,t410:1.036203466):0.3062317331,t411:1.296359978):2.294412524):0.3166401484,(t412:1.557050277,t413:1.555356176):2.34606337):0.821967261):0.09334345136,((((t414:0.940785143,t415:0.8957538418):0.568828648,t416:1.358002221):1.298485506,(t417:0.6505538514,t418:0.4011724605):2.003671014):0.9274424863,((t419:1.708444666,(t420:1.335895861,t421:1.3123714):0.2660562907):0.4812287215,(t422:0.9836782714,t423:0.9569346317):0.555871127):1.065532114):1.079460993):0.9783451469):1.577853927,(t424:0.7334079976,(t425:0.1311431071,t426:0.057790556):0.430486363):5.399302366):5.520576633):2.313906525,(((t427:0.7817628017,(t428:0.4875249837,t429:0.4857384094):0.2872939011):1.166374127,t430:1.899306795):0.7193689759,((t431:1.36409709,t432:1.286248621):1.081098438,t433:2.072573525):0.107978748):10.99048742):0.08789643736):1.43656318):2.543155702,(((((((t434:2.060282868,(((t435:1.324657945,t436:1.273304993):0.227075379,t437:1.481138876):0.4946476874,(t438:0.1793313355,t439:0.1284829315):1.772666196):0.008995062596):0.07145761406,(((t440:0.3595383738,t441:0.3370570311):1.369001838,(t443:0.1655934272,t444:0.1585285487):1.256267697):0.0938446913,(t445:1.240725287,(t446:0.1131941262,t447:0.002433144513):0.975868143):0.167053072):0.07831484164):0.6438436212,(t448:1.310705867,((t449:0.5896394002,t450:0.4981768929):0.2831037991,t451:0.6393389136):0.2316906066):0.5082656313):6.019348018,((t452:2.01327155,(t453:1.656598924,(t454:0.9223671156,(t455:0.7577245872,t456:0.7554795135):0.1060019222):0.690942495):0.1253607496):2.959354143,t457:4.549423886):2.404222895):2.127220262,((((t458:0.269531106,t460:0.1871237069):0.08457751361,t461:0.2636883055):1.857054781,(t462:1.381166106,t463:1.175520138):0.7393003221):1.013501824,t464:2.685506999):5.824392577):0.6436047184,(t465:2.959150557,(((t467:0.1894170723,t468:0.123715779):0.2984483392,(t470:0.04250695643,t471:0.03981273801):0.08327539254):0.9330433359,t472:0.7284326136):1.188032682):6.151187067):1.106312937,((t473:8.214016715,(t474:1.268730734,(t475:0.1474844335,t476:0.1386231516):1.104291939):6.852710614):0.392737611,t478:8.063647623):0.379473492):4.400437524):45.38499365):11.9113429,((t479:0.4697633656,t480:0.2963143699):28.39640661,(t481:8.26141794,(t482:4.054994659,t483:3.997191781):3.918348018):20.42157307):41.09898059);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T43.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
