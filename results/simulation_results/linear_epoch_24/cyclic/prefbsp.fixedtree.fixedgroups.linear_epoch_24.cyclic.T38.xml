<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t468:4.835393601,(t469:2.970131559,((t470:0.5590194506,t471:0.4140488291):0.6293062491,t472:1.015913905):1.735194652):1.857947659):5.006441416,((t473:0.3677822718,t474:0.318214788):0.4745992435,t475:0.5911497351):8.603488535):7.738744851,(((t476:1.183326526,t477:1.040814448):2.466103433,t478:3.449278885):9.130543862,t479:12.43603459):4.108176195):22.11501362,(((((t480:0.812491433,t481:0.6975570565):0.5270593912,t482:1.191939703):5.551727107,(((t483:2.123162191,t484:1.490303992):0.1535077685,t485:1.6403074):4.289464996,(t486:5.435086142,((t487:0.9558428214,t488:0.8808799768):2.677467951,t489:3.336223613):1.793429146):0.4811553334):0.09860456173):9.380119502,((t490:7.456203905,((t491:3.196702194,(((t464:0.007992788954,((t460:0.03235358436,(((t449:0.0321032686,((((t400:0.0313829718,((((t347:0.3220389768,((t312:0.08619876176,(t280:0.06746910414,(t248:0.002949729297,(t246:0.09956689915,(t243:0.06797538793,((((t189:0.002117944044,t190:0.002074767929):0.1581001473,(t145:0.03979817679,(t135:0.08213921931,(((t92:0.447419553,((t71:0.002021862743,(t53:0.07047455436,(t52:0.153451439,((t1:3.483424341,t2:3.479050928):0.1319750792,(t3:1.370983783,(t4:0.7936979806,t5:0.7753519313):0.5691574187):2.232350781):0.1233426508):0.0794997849):2.146772612):1.333915026,(((((((t6:1.482273474,t7:1.476352977):1.426531342,t8:2.900262762):0.6609093233,((t9:2.479655075,(t10:2.403936528,t11:2.397103736):0.06034915731):0.7385172452,t12:2.913855209):0.2239743363):0.6500640375,t13:3.77757661):0.6835527741,((t14:0.5208178149,t15:0.4908703538):2.414974554,(t16:2.525709796,t17:2.34907026):0.2708920489):1.499914801):1.508434931,((t18:5.087430335,(t19:4.357513197,(t20:2.013420246,t21:1.986605495):2.317237899):0.6444424034):0.2661835956,((((t22:2.562051774,t23:2.529179836):0.06806870701,t24:2.515980525):0.6956338925,t25:2.996071726):1.252628367,((t26:1.61995817,t27:1.555322181):2.367257696,((((t28:0.4270327417,t29:0.2310667238):2.121640667,t30:2.304858261):0.08857925355,(t31:1.638000623,((t32:1.077609103,t33:0.9554900538):0.4821067816,t34:1.383293947):0.07349346701):0.5717769339):1.019602682,t35:2.980410573):0.199375025):0.1169102476):0.6230538762):0.2258711733):0.6312165497,(t36:0.2157309832,t37:0.1202097678):4.503816358):0.203016618):1.106028199):0.0953999229,((((t38:1.181462227,(t39:0.4776277273,t40:0.3254934686):0.6447842722):0.977185836,t41:1.937355767):3.029679179,(((t42:1.091490734,t43:1.073728655):0.7821409307,(t44:0.1519425561,t45:0.1098732365):1.692325498):2.668625599,(((t46:2.543020502,((t47:0.9603662511,t48:0.5821030137):0.7166899146,t49:1.203617528):0.8103545668):0.06070908786,t50:2.05522557):1.071481946,t51:3.029196459):0.77552753):0.3565193817):0.4244289731,t54:4.077569659):0.3587481698):3.130036389,((t55:1.253231397,(t56:0.4813116671,t57:0.1497416197):0.7718734779):0.6790462154,t58:1.393188641):5.546803215):1.298788523):0.7051893336):5.317243469):2.67754454,((t59:1.728450549,t60:1.375006269):12.91859498,((((t61:0.6249182514,t62:0.5656527096):6.537336992,t63:6.984458831):1.18124874,((t64:1.075902262,t65:1.070325259):4.759357567,(t66:0.1367979256,t67:0.1221565327):5.687845831):2.239500965):0.8783649038,(((t68:2.234409323,((t69:0.2373296824,t70:0.1177237989):1.27344015,t72:1.368391864):0.6713776362):2.209470914,(t73:3.813291477,(t74:1.64842336,t75:1.315186635):1.901115289):0.4021639994):4.138929025,((t76:5.03860859,((t77:2.408610295,t78:2.322417137):0.2203582502,t79:2.384315996):2.272589525):2.242969938,t80:6.795331323):0.3212436491):0.2082950086):5.001231827):2.053353611):2.000302118,((t81:0.5132174783,(t82:0.2813517617,t83:0.1961031787):0.1794048487):9.683115252,((((t84:4.887992665,(t85:1.164462545,t86:1.115651894):3.704275236):0.8388838479,t87:5.655728996):0.7610957801,t88:6.382355388):0.7533189155,t89:7.008057304):2.782710703):6.084932641):1.405387736):0.3367423614):0.2445530494):2.882167349):2.476246326):2.68366968,((((((t90:9.29964899,(((t91:5.018032326,(((t93:3.123773327,t94:3.095851738):0.4758463274,((t95:0.4849162249,t96:0.4592695607):1.741473713,t97:2.16315741):1.064463124):0.02271193319,t98:3.222640099):0.7741947345):2.140904748,((t99:3.829715892,t100:3.584445555):1.453062591,(t101:3.491517302,((t102:0.8153445813,t103:0.7485239518):2.50290005,(t104:1.28045637,t105:1.262315216):1.896238277):0.1674462696):1.474745584):0.8138959786):0.6477121934,((((((t106:3.168360227,t107:3.138340079):0.5739008255,t108:3.665455375):0.3178589999,((t109:3.196990532,t110:3.070151701):0.2071361966,t111:3.005679243):0.4448850474):0.5148484643,(t112:0.8167322802,t113:0.2981578962):3.09033359):0.4070878796,(((t114:2.968379889,(t115:0.5223669618,t116:0.4407187071):2.432836768):0.2183361104,((t117:1.317004309,(t118:0.8633399543,t119:0.5875180971):0.3442278011):1.055478678,t120:1.947575064):0.4036346993):0.09161624441,t121:2.395800002):0.5060706066):0.4694501829,((t122:0.4831036708,t123:0.2475245652):0.9693467975,(t124:0.4439285348,t125:0.366790034):0.6141083919):1.823108079):0.7190619342):1.41260245):1.518788018,((((t126:0.2851255482,t127:0.1561378103):1.685766123,(((t128:0.01058881876,t129:0.001202845548):0.08038715078,t130:0.08000754283):0.4731207783,t131:0.5288640461):1.204003676):0.41557342,t132:1.971210927):0.507904273,((t133:1.02687472,t134:0.9338816327):1.129230624,(t136:1.145639326,t137:1.066526243):0.6623559386):0.2848777961):3.511010896):4.731163596,(((t138:0.8913696152,t139:0.8755306564):1.741963407,(((t140:0.5444124485,t141:0.4578310554):0.2187523066,t142:0.6345912531):1.39665878,(((t143:0.9860972958,(t144:0.3242033623,t146:0.07641154581):0.6567631741):0.1043853125,(t147:0.4661824988,t148:0.4512613393):0.3181665971):0.4619133825,((t149:0.683635543,t150:0.52510651):0.2265991809,t151:0.6905094317):0.2337992983):0.3116520923):0.3851138583):5.329121776,((((t152:0.3176982625,t153:0.1066723539):0.3673322825,t154:0.4091697325):0.2213831229,t155:0.6036445969):4.297653407,t156:4.833084644):1.722733277):2.285869078):3.067783118,((t157:3.284399849,t158:3.187799323):1.813201482,t159:4.663104614):6.45977353):4.756296528,((((t160:1.922246204,t161:1.856088687):0.9305107259,(t162:0.4085604495,t163:0.3445759655):2.361336039):4.562464301,((t164:4.389134463,t165:4.344485017):2.529067636,((t166:0.1872195767,t167:0.1541436247):4.990689633,t168:4.94616672):1.313209562):0.2717917041):0.1757958697,(t169:4.151556334,(((t170:1.14057187,t171:0.8083114117):2.268551993,(t172:1.883946171,t173:1.682657535):1.080242123):0.3973463713,(t174:0.2488243055,t175:0.1873217376):2.825988733):0.2837374693):2.342887015):8.214159108):2.352527505,((((t176:0.7548888164,t177:0.704050909):7.46717972,(((t178:5.259045731,t179:5.23965354):0.4418092715,(t180:3.191956151,t181:3.106718416):2.4859904):1.744845789,(((t182:1.930022802,t183:1.921784919):2.423843376,t184:4.168811194):1.489248297,((t185:3.671640722,t186:3.457521791):1.334967743,((t187:3.52505306,((t188:1.970631925,t191:1.490154662):0.7061729062,t192:2.13327478):0.777617862):0.5776632407,(t193:2.076435599,t194:2.072305026):1.348140154):0.5317769103):0.4721447337):1.412135494):0.6334168172):2.789946311,((t195:5.167563573,(((t196:0.4863323929,t197:0.4657136231):2.472047754,(t198:1.745990902,t199:1.745622605):1.177666146):1.978226699,(t200:3.606379644,(t201:1.320277792,t202:1.152894636):2.162588161):1.027638052):0.195858354):1.230781317,(((t203:0.820444856,t204:0.6777486011):3.399609306,((t205:3.154589591,((t206:0.9047131396,t207:0.5548059491):1.147680453,t208:1.628424346):1.091070441):0.2449404019,t209:2.558959128):0.6427531663):1.341370208,((((t210:1.206357154,t211:1.082656508):1.300351137,t212:2.276750178):1.112343617,(t213:1.690632083,t214:1.679984275):1.56010132):0.4665455065,((t215:2.913134673,t216:2.877431206):0.1953178013,t217:3.052921233):0.5616646534):0.1302535433):0.08684625708):2.609894314):4.383838769,((((t218:2.929167337,(t219:1.950615682,t220:1.87801389):0.6276324188):1.668085984,(t221:0.6033864991,t222:0.3764660192):3.537955693):4.138783382,((((t223:0.4321611698,(t224:0.1940661852,t225:0.1247629962):0.1734037996):0.9499699638,(t226:0.8380883732,t227:0.7740507755):0.3621837421):0.1293210689,(t228:1.248934916,(t229:1.009248058,t230:0.884414479):0.2203165896):0.009379496988):0.1033932178,t231:1.116335295):6.222165607):0.7994325681,((((t232:0.9512946914,t233:0.8905934455):0.3235873514,(t234:0.376460519,t235:0.2431687497):0.7909986342):1.321310169,(t236:1.024480954,(t237:0.6112529428,t238:0.3981050492):0.3029653604):1.303192428):2.144118251,((t239:0.9809420742,t240:0.9221385103):2.20991259,t241:3.066878646):0.3830217957):3.345606761):1.243283157):0.7042658295):0.05691385758):0.8967893999):0.3790104247,t242:10.05121388):1.358352675,((((t244:4.842570403,((t245:1.189142854,(t247:0.7441237115,t249:0.4610644092):0.1127310526):2.009194505,(t250:0.2879709691,(t251:0.1979647874,t252:0.1673610406):0.05952536889):2.246012645):1.597229579):0.4807775005,t253:4.222298989):3.024832038,(t254:5.319298832,(t255:0.3102560878,t256:0.2490483743):4.968876165):1.663297246):0.285616239,(t257:2.91122156,t258:2.830817662):4.149509165):2.490362318):0.9351583383,(((((t259:5.969685818,t260:5.858229967):0.5490194639,((t261:0.5437191366,t262:0.474157968):3.74625063,t263:4.213200877):2.116274168):0.06576512871,t264:6.236286336):1.648588945,(((((t265:4.431573178,(t266:3.731166437,t267:3.710609371):0.6380238222):0.6592589058,(t268:1.616875524,t269:1.35427694):3.390820831):0.1803567271,(t270:4.581213986,t271:4.527324418):0.2393763621):1.288878476,(((t272:1.563826722,t273:1.545446963):1.937889459,t274:3.460461736):2.358050222,t275:5.803748903):0.1184416503):0.2156736596,(t276:5.679501978,((t277:3.366472747,t278:3.347083667):2.027108141,(t279:3.409402196,(t281:1.553059446,t282:1.457219229):1.452538356):1.810968897):0.2034431495):0.4509666106):1.043032108):0.1070427315,(((((t283:2.486706769,t284:2.386385388):0.6023485273,t285:2.987390399):1.207052237,(t286:2.390892025,(t287:2.284470063,t288:2.260658318):0.06802196654):1.583277938):0.02169262948,t289:3.928201103):1.417132542,(t290:1.312307134,t291:1.247457927):3.779444132):0.7727361459):1.96524343):1.689150303):1.478853486,(t292:2.196862614,t293:2.189120226):8.692255677):0.4630409804,((((t294:1.278772668,t295:1.265700226):1.189395042,t296:2.454058818):1.232853737,(t297:3.013312203,((t298:1.428314493,((t299:0.6652253591,t300:0.3917781966):0.5019103576,t301:0.810211288):0.2452910566):1.325379346,t302:2.319059551):0.2508214134):0.6100854607):4.493671822,((((((t303:1.839836739,(t304:1.788947209,t305:1.786120225):0.02005337842):1.626148245,t306:3.243263123):0.8827048659,(((t307:0.6259777725,t308:0.4381543968):0.05820348674,t309:0.4087453198):3.348564487,(((t310:0.4213971346,t311:0.3956768461):0.05023317865,t313:0.2746501628):2.609656156,t314:2.879607531):0.5170445914):0.05991250096):0.4877929527,t315:3.899569484):0.9862830051,((t316:0.4300939105,t317:0.2303910865):3.220858196,(((t318:0.2690831973,t319:0.163113982):1.76757748,((((t320:0.402660894,t321:0.3458005681):0.01789053144,t322:0.3490273856):0.137006697,t323:0.4595071239):0.9319145577,t324:1.369562264):0.3712364191):0.250478121,t325:1.952716052):0.7112392288):1.223474979):0.8751420828,((t326:1.408399679,t327:1.319081181):1.473358898,t328:2.782245767):1.850992438):0.8641635019):3.142855293):0.2928422084,((t329:2.578981178,((t330:1.491350611,(t331:0.7904883385,t332:0.6596823306):0.6090638295):0.1313125663,(t333:0.8515104471,t334:0.6960328414):0.4019516995):0.7696135346):0.5254024979,((((t335:0.2141634788,(t336:0.02869100254,t337:0.02649997957):0.009069915342):0.345627424,t338:0.3155379481):0.6108426172,t339:0.9249651003):0.5079161581,t340:1.384468619):0.5621124009):5.805703646):1.469328091):0.7694636923,((t341:3.344201516,(t342:1.481261134,(t343:0.7961732482,(t344:0.5530603037,t345:0.2697018611):0.1370834652):0.6236196243):1.731759934):0.6137623719,((t346:0.9871658607,t348:0.4279554955):1.526671411,t349:1.941297408):0.8252820073):5.975379648):0.434809935,(((t350:1.016926046,((t351:0.5538254328,t352:0.4891605567):0.1748802527,t353:0.6627330788):0.2531733122):5.995909398,((t354:0.1158522211,t355:0.05957476812):5.494085739,(t356:1.384137589,t357:1.279854955):4.147927459):1.238634719):1.127520812,((((((t358:0.4328047391,t359:0.3010979062):0.2720977386,t360:0.5555394829):0.3304765535,(t361:0.3476555138,t362:0.2699035587):0.4108978939):0.1135313205,(t363:0.09146806849,t364:0.05817894982):0.6440426004):5.252094978,((t365:1.007225841,t366:0.9325885185):1.045407694,t367:1.945454534):3.796455718):0.8775553304,(t368:2.02737526,(t369:1.336325664,t370:1.261866805):0.6622379118):4.569405084):0.4954860864):0.9345015498):0.2773438038):0.5703185631,((t371:0.861518247,t372:0.7909055259):2.719802336,t373:3.464964092):5.02423634):0.2772474302):0.7108345549,(((t374:1.672590746,(t375:1.564612952,t376:1.551722228):0.07248120525):4.26413196,t377:5.825646835):0.2099394218,t378:6.024922609):3.058958202):0.8351479987,(t379:7.742454433,t380:7.537423289):2.167568605):4.582427874):3.327410045,((t381:6.013700953,((t382:3.747454407,(((t383:0.6046779243,t384:0.564617359):0.9878707186,t385:1.38592367):0.7944382503,(t386:1.280197867,t387:1.263260113):0.8386574801):1.334971728):1.449531126,t388:4.796671383):0.6699698806):0.4763106359,(t389:5.235598101,t390:5.085416566):0.6142307682):10.99365464):0.7535969686):1.894629344,(((t391:1.77130825,t392:1.740797476):4.14074883,((((t393:2.026559186,t394:2.014569089):2.65428374,(t395:1.622224976,t396:1.343954131):2.997696848):0.4673286096,(((t397:2.916303233,t398:2.809657706):0.4799800426,t399:3.237235817):0.7796494137,(t401:3.579081643,((t402:1.905697405,t403:1.747698515):1.284675608,t404:2.985636762):0.1667377971):0.2359573223):0.3416741463):0.3796936996,((t405:3.702195213,(((t406:1.749083338,(t407:0.8559751913,t408:0.7829859347):0.7949853139):0.8896257069,t409:2.371987202):0.1424495483,t410:2.499499292):0.8666587129):0.0567896183,(((t411:0.1105896617,t412:0.09666916731):0.9229533761,(t413:0.5129435069,t414:0.4812317707):0.4977010324):2.075726526,((t415:2.214686824,t416:2.103531507):0.0172377952,(t417:1.408730386,t418:1.254542803):0.6022917356):0.7458748194):0.1595970247):0.3441530467):0.2994512886):7.795990327,(((t419:4.256354822,(t420:1.226156111,t421:1.207241052):3.028142711):1.902886367,t422:6.021240058):0.06551651557,(t423:4.144672351,(t424:1.406730553,t425:1.130609252):2.594725353):1.841829412):4.968526513):5.490979184):5.66203432):5.630409327,((((t426:0.380648163,(t427:0.3289022662,t428:0.19266345):0.01765338382):2.907819294,t429:3.096750595):0.6118304071,(t430:1.002070272,t431:0.8774623109):2.610698014):19.81767465,t432:22.73113917):3.574599059):16.70171147):40.49593726,((((((t433:2.513421746,(t434:2.257340261,t435:2.24762095):0.2246176863):1.834973405,t436:4.249164301):0.742138271,((t437:2.005352275,t438:1.977749132):0.8487245746,t439:2.748093425):2.108044107):5.649763529,((t440:1.238261808,(t441:0.9852613542,t442:0.9600061281):0.1840629225):1.796283137,(t443:1.700479077,t444:1.6963601):1.227261563):7.417776443):1.523871881,(((t445:0.1773771214,t446:0.163714656):0.3168160329,t447:0.4528081258):3.301684611,(t448:1.048505518,(t450:0.3550093035,t451:0.2791947248):0.6150576281):2.670244984):8.034871085):66.06790294,((((((t452:0.39125531,t453:0.2599598428):0.1625391443,t454:0.3567985003):0.5423821143,t455:0.7117309564):2.555721437,(((t456:1.277776178,t457:0.6849751742):0.8296679919,t458:1.501762913):0.4656627864,((t459:0.6919229566,t461:0.1401184257):1.006332968,t462:1.11849026):0.2561248177):0.4759338854):7.429862866,(t463:2.888770877,(t465:0.8612344306,t466:0.6004962352):1.572100535):6.382989508):11.58722629,t467:20.13232286):54.92850837):5.164420468);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T38.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
