<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((t484:0.273311754,t485:0.1056743876):0.2045003924,t487:0.1481444762):0.3309704001,t488:0.2669821425):0.642473988,t489:0.8218055628):2.324387128,t490:2.463478913):4.949441237,t491:7.265754394):3.510755712,((((t492:0.9362521429,t493:0.6614001571):4.016252413,t494:4.618257694):2.971893537,(t495:0.5902793454,t496:0.5735805142):6.894135008):1.741257899,((t497:4.932853877,t498:4.928866086):3.274636763,((t499:1.346454807,t500:1.322023773):3.906416356,t501:5.215811296):2.949653384):0.8847469595):0.8795360846):17.85136345,(t502:18.44157927,(((t503:8.994341419,(t486:0.08948982042,(((((t433:0.05169570153,(t429:0.2890347816,((t424:0.03045194103,(((t381:0.09136045132,(((t356:0.003597886285,(t350:0.04950846564,(t315:0.1751479529,(t275:0.1495261418,(t270:0.03822579839,(t268:0.009138132222,(t265:0.1217610534,(((t168:0.003576087138,((t165:0.03376887329,t166:0.01220759432):0.111546093,((t159:0.2435425478,(t155:0.107729586,(t156:0.002271440674,(t149:0.003866176949,((t65:0.07535906481,(t45:0.02283358829,(t34:0.3922378316,t1:2.909239208):0.7917819358):2.142124556):6.706837721,((((((t2:3.885140844,(t3:3.446842949,(t4:1.287939082,t5:1.258252878):2.120828588):0.4025460671):2.072033976,(t6:3.765479891,t7:3.759278592):2.084840711):0.149675631,(t8:5.602403999,t9:5.576979972):0.3510373473):1.424989494,(((t10:3.0984833,t11:2.993101473):1.286616745,(((t12:2.463378288,t13:2.237828086):0.8328619511,(t14:2.924343289,((t15:1.495281407,t16:1.428578195):0.5102990711,t17:1.925841159):0.9019102577):0.144032655):0.7146745078,(t18:3.499055098,(t19:2.726544823,t20:2.685334312):0.6496039648):0.09366152324):0.2344333769):0.3609708317,(((t21:3.568365011,((((t22:2.187197729,t23:1.812122863):0.5727575258,t24:2.231588083):0.2449996174,(((t25:1.625997967,t26:1.625859466):0.08099409006,(t27:1.011457184,t28:0.9744707167):0.4996350574):0.03805206595,((t29:0.6118180888,t30:0.564669699):0.1906029356,t31:0.3313724937):0.7005472165):0.6553926198):0.1541303161,(t32:1.715851849,t33:1.588997197):0.04700920045):0.3547359348):0.02396157388,((t35:1.057267637,t36:1.027607105):0.2921305379,((t37:0.2797731049,t38:0.2634202377):0.4032996933,(t39:0.652300561,t40:0.454847444):0.001794860328):0.5288475439):0.202899419):0.4276342766,t41:1.607359825):0.00290205384):2.604653782):1.106793342,(((t42:1.18837847,t43:1.148567507):0.6727362489,((t44:1.32093219,t46:1.089505434):0.189795516,t47:1.109132921):0.1687234531):0.1929166787,(t48:1.121077461,t49:1.06298057):0.2869425883):3.263455289):1.326930022,(((t50:1.719663478,t51:1.716354692):0.3532296003,(t52:0.9734406786,t53:0.9705067633):0.9439845656):0.1261437762,t54:1.975285354):3.722350493):2.569080333):0.9126162665):0.8535026456):0.06040470933):0.3950187204):0.6683231694,(((t55:0.4536810411,t56:0.4184564907):2.478574842,((t57:0.63674727,t58:0.4086987172):1.698848948,t59:1.9028016):0.09762222683):1.728330662,(t60:0.6917032435,t61:0.6631896118):2.861337903):6.356989931):0.2535535795):0.01891592184):1.596844151,((((t62:0.5989047233,t63:0.5818234398):5.538287913,t64:6.095386684):2.035905635,((t66:0.4360285126,t67:0.433637374):0.3225914994,t68:0.6896788724):6.960491998):0.07775270523,t69:7.590050189):3.484398646):5.962251082,(((((t70:0.4040587661,t71:0.3739423198):13.53117462,((((t72:5.881778337,((t73:3.000396931,t74:2.932396166):0.7613913147,t75:3.667078561):1.852729554):1.818788907,(t76:7.107862698,t77:7.079712937):0.01410850678):0.2432478888,((t78:4.058947571,t79:3.981692804):0.3078442841,(t80:2.289938686,t81:2.255374819):1.975369173):2.852840361):1.173468535,(((((t82:2.556887365,(t83:1.82014747,(t84:1.775897877,t85:1.745881065):0.03549574496):0.6640783726):1.345996745,(t86:2.651756856,t87:2.624149835):1.030145442):0.8409902477,t88:4.180865065):1.412408683,(((t89:2.66987524,t90:2.669411571):1.533518326,(((t91:2.38376767,t92:2.346148078):0.7879988351,t93:3.035949281):0.5972687717,(t94:3.12617761,t95:3.088944332):0.4361295795):0.3846248949):1.150688599,(t96:4.109782124,t97:4.011152462):0.8392767728):0.00920017113):0.5937888902,((t98:4.020293195,(t99:2.827181353,(t100:2.248708253,t101:2.046767907):0.5678448907):1.099042252):1.076427457,((((t102:0.4709293583,(t103:0.250966142,t104:0.2476689565):0.1922531766):2.079269916,(t105:0.4431346246,t106:0.3919390819):2.033034637):0.3961404729,t107:2.763958072):1.444590776,(t108:0.9899426263,t109:0.9382586341):3.168852023):0.2617801724):0.2857198191):1.452149341):4.630051268):0.4739549664,(((t110:1.691923976,t111:1.672571511):0.166961568,(t112:1.388389384,t113:1.356888448):0.33113378):2.816562949,(t114:3.180846721,((t115:1.844991645,(t116:1.27858517,t117:1.224494872):0.3440236952):0.2488135412,(t118:1.687330705,t119:1.681046205):0.01857175185):0.9029651018):1.228409718):6.418173441):0.3050788768,((((((t120:0.1683508899,t121:0.1424568548):0.8333379938,t122:0.940389705):1.748323358,t123:2.661070807):0.690387606,((t124:0.7522536796,(t125:0.562348382,t126:0.4954018695):0.1537180027):0.894219152,t127:1.508402843):1.694914072):3.042279517,((t128:2.092815228,((((t129:0.1567168826,t130:0.1018723024):0.2533446876,t131:0.05315011115):1.037322538,t132:1.033085181):0.286516518,t133:1.311174269):0.161658484):1.029659108,(t134:1.462988582,(t135:1.275318611,t136:1.270744737):0.1581160826):0.697806189):3.096026455):0.3279004278,((t137:2.370936581,t138:2.30007408):0.08196730327,(t139:0.9384913877,t140:0.8014190858):1.385490734):3.046896472):3.687086495):0.4282101073,(((((((t141:0.7221947498,t142:0.6298985136):0.7833556605,(t143:0.519201085,t144:0.3777136822):0.7612248283):0.9781055846,(((t145:0.08171168973,t146:0.06296951628):0.1024357176,t147:0.1508785719):0.719790817,t148:0.8544834132):1.11345141):0.2431574515,t150:1.570592244):2.64379198,(((t151:0.533064721,t152:0.1611107977):0.6249086386,t153:0.6933280292):1.677227246,t154:2.352873241):1.333040195):0.9717594456,t157:4.411640363):0.8348912642,(t158:1.674601719,t160:1.314623514):3.540712139):2.050941804):1.530922297):0.7158661898):0.2452916854):0.3532486555):0.5922139871):3.149867151):3.728616066):0.3628218274):1.725175925,((((((((t161:3.31500183,(t162:1.778607409,t163:1.502756871):1.303686902):2.043164572,(t164:1.699214079,t167:1.398313203):3.146164239):2.021239251,(((t169:0.5074978942,t170:0.4255377712):2.610280483,t171:3.000045005):2.628495034,((t172:0.1573332686,t173:0.1033721899):0.3261423041,t174:0.2474346345):5.063636899):0.7669658635):1.690855205,(t175:5.415334936,t176:5.408958352):2.282086513):2.173159162,((((t177:4.221209136,t178:4.192972316):2.93401566,(((t179:2.000502846,t180:1.703024948):3.073336134,((t181:1.102898649,t182:1.09002809):3.537877285,(t183:4.226254105,((t184:0.6345121032,t185:0.6280629635):0.223387288,t186:0.7943036245):3.315924142):0.3134389675):0.1153224763):1.260440688,(t187:0.8750030177,t188:0.8532394196):4.886731854):0.618434817):0.7373828018,(((t189:0.3381025267,t190:0.2084886122):2.857447887,t191:3.020393584):0.7051543252,(t192:0.8873517059,(t193:0.4509504735,t194:0.4478724738):0.4079233289):2.771166425):3.06469169):1.489358207,((t195:5.117155049,((t196:3.180598077,(t197:0.6940519556,t198:0.6261425519):2.450180312):0.2409252256,(t199:2.438595654,t200:2.09818396):0.6319586545):1.63899885):1.527331929,((t201:5.132199249,(((t202:3.769190903,(t203:1.820043822,t204:1.815215526):1.91211053):0.03046573903,(t205:2.834664156,(t206:1.419453114,t207:1.19799645):1.243306722):0.8458997368):0.3505937235,t208:3.503820008):0.951571323):0.6467027813,((t209:3.242405947,t210:3.226675265):1.632688861,(t211:3.18702399,(t212:1.200545961,(t213:0.1864546215,t214:0.1763058299):0.9146104983):1.966551054):1.493921478):0.09507123318):0.03497273491):1.526851825):0.1578318713):0.28957273,(t215:5.985848801,(t216:1.688601755,(t217:1.368452895,t218:1.344729501):0.2843372321):4.217001808):0.6509025377):3.983911477,(((((t219:1.100277594,t220:1.068462656):0.7175154295,t221:1.767748724):0.3146163436,((t222:0.7833757042,t223:0.7480264758):0.3557169363,t224:1.07290403):0.8979274251):1.327895278,t225:3.282166092):0.6374306118,t226:3.909355781):6.165149126):0.299945297,(((t227:5.466056818,((t228:3.696659953,t229:3.522056423):0.1119459691,((t230:2.088409968,(t231:0.2007379311,t232:0.116971107):1.810058057):1.096105317,(((t233:0.5323493979,t234:0.5011046413):2.011920712,(((t235:0.1934477282,t236:0.08587356663):1.785340343,(t237:1.724293643,t238:1.717608119):0.1147404733):0.2353082067,t239:1.993412848):0.2849138317):0.3965140719,t240:2.654861371):0.05342414875):0.4103021472):1.531422359):1.156713727,((t241:3.721310148,(t242:1.208261086,t243:0.811414528):2.415712465):1.092835388,((t244:0.6050182812,t245:0.4222429709):2.653781328,((t246:0.09242287266,t247:0.08448402572):1.847238145,t248:1.867166408):1.12650945):1.015530575):0.8545806949):3.719517921,t249:8.561351009):0.02796052867):3.439525111):0.2266273957,(t250:10.78661801,((t251:2.93757254,((t252:1.14047537,t253:1.124414841):0.4675439135,t254:1.439529564):1.251110313):0.1165123503,((((t255:0.2837007496,t256:0.2711331573):1.019931537,((t257:0.1945316089,t258:0.09502544821):0.1945221618,t259:0.06815315958):0.7788409317):0.3275280871,(t260:0.3674960972,t261:0.2372204794):0.7957617923):0.3617732648,(t262:1.041845122,((t263:0.3995630388,t264:0.3183320818):0.1776785066,t266:0.277540822):0.2999855683):0.2152699164):0.5786973384):7.608002071):1.403383623):0.463880669):0.402875257,((((t267:1.605186017,(t269:0.1259411292,t271:0.05596530232):1.163005461):1.553805285,(t272:0.8845256571,t273:0.8571874513):1.760764938):4.625215003,(((t274:1.416222687,t276:0.801375462):1.395566378,(t277:1.721140863,t278:1.563217036):0.4280988947):2.426694076,t279:4.356740881):1.970892483):2.537757062,((((((t280:1.183160081,(t281:0.3082969173,t282:0.2613330114):0.8659603297):1.672219815,(t283:2.391057129,t284:2.332493623):0.3970883276):0.7135332602,((t285:1.160483673,t286:0.8814757761):1.867557584,t287:2.613621154):0.4010345587):1.826842356,(t288:2.010080322,t289:1.979409871):2.704902611):1.479572564,(((t290:1.404528734,(t291:0.648485015,t292:0.6043284208):0.6498852488):2.440492473,t293:3.606027059):1.988159475,((t294:0.7867875325,t295:0.6499725075):3.66011112,(t296:1.748366296,t297:1.706211215):2.54351291):1.126277352):0.2399286417):1.308956016,((t298:3.328023031,t299:3.308736253):1.518165598,(t300:3.951539909,t301:3.91257532):0.8416551397):1.977600831):0.6504089743):0.6959444742):1.669395152,((t302:4.791530265,((t303:1.428990925,t304:1.354977933):2.093617583,t305:3.315273079):1.159209112):2.89453993,(((((t306:0.5413564675,(t307:0.125097198,t308:0.08947757267):0.3994429318):4.336655145,(t309:4.257194524,((t310:1.047626816,t311:1.034020108):2.633563444,t312:3.525229738):0.4860002182):0.4691186886):0.4565422154,((t313:1.690132214,t314:1.63877448):2.62889182,((t316:1.508253488,t317:1.230398124):0.3965006349,t318:1.605611381):1.987951891):0.5981205278):1.448922799,((t319:2.229831799,t320:2.190960634):1.78249866,t321:3.79375891):1.476972427):0.3644714487,(t322:5.00359703,(t323:1.586264568,t324:1.55476447):3.327030565):0.570759208):0.05411050778):2.027108413):1.058944385):0.03958882349,(t325:1.796950411,t326:1.691081069):6.811394828):1.133606447):0.2400026044):0.08139555022,((t327:5.817678257,t328:5.803502429):1.289281277,(t329:4.474225628,(t330:2.327727352,t331:2.015731327):2.144007768):2.524040382):2.815779905):3.079368034,(((t332:2.551172216,t333:2.549921667):3.495164231,(t334:5.121126439,(((t335:2.466540346,t336:2.342292593):0.4868820548,(t337:1.293186919,(t338:1.185163924,t339:1.037994317):0.06725766857):1.483515055):0.1181329863,(t340:1.8703758,(t341:0.360911975,t342:0.1372590459):1.400487139):0.8169064178):2.013984782):0.7561072898):2.755613188,(t343:2.490934304,(((t344:0.9244598537,(t345:0.0819115795,t346:0.06746053069):0.7907594785):0.08188755456,t347:0.5875341466):0.9299647815,(t348:0.6198977269,t349:0.6056833053):0.8271257184):0.07828233515):5.322323566):3.743471317):0.5135779311,(t351:0.7081991045,t352:0.6586218698):10.23008261):0.6789630265,(((((t353:4.432065302,(t354:1.856658713,t355:1.814214002):2.491254379):2.198434932,(((((t357:0.4278727014,t358:0.346542111):1.996470402,t359:2.27763722):0.2361341411,(t360:0.290646676,(t361:0.1901908133,t362:0.1091543858):0.03604850702):2.184504539):0.815511057,((t363:1.176110728,((t364:0.6713109151,t365:0.5641428553):0.1564302429,t366:0.6619310009):0.3150503762):0.7801709573,(((t367:1.41247262,t368:1.404769481):0.1248132479,(t369:0.6755297991,t370:0.3968143748):0.8359144145):0.02233665608,t371:1.1818555):0.1729858471):1.146271535):1.037979497,((t372:1.411143797,t373:1.284477004):0.9656374168,((t374:1.224547255,(t375:0.8191718087,t376:0.7525783135):0.2635869312):0.7038276708,(t377:1.219405712,t378:1.138024038):0.2781819419):0.1621450786):1.033836866):1.84015504):2.741427811,(t379:1.619674521,t380:1.563610885):5.534644968):1.779651666,((t382:5.147876437,(t383:1.839180906,(t384:0.05303786521,t385:0.04661859631):1.640908463):3.122628869):2.576986089,(((((t386:1.521097463,t387:1.496328607):0.4083315195,(t388:0.3819724176,t389:0.05799837163):1.49005644):3.088365816,(t390:2.598867722,(t391:1.339906315,t392:1.338181366):1.127451629):1.857731896):0.1321854776,((t393:1.629077441,(t394:0.4058036635,t395:0.2907896883):1.211295048):1.548345124,(t396:0.06580216813,t397:0.0150007033):2.813418781):1.21405966):1.005708762,(t398:4.161983476,(t399:2.139501064,(t400:1.93131413,(t401:0.2756197597,t402:0.1999755046):1.587657445):0.1545344237):1.993083553):0.5959597114):1.225000697):0.8556449158):0.05378961064,((t403:1.092320701,t404:1.050930435):0.3604345218,t405:1.362533144):5.179595555):0.2522983167):2.048435672):11.15891898):0.05769603723,((((t406:5.569544808,(t407:0.406194976,t408:0.3816325487):5.092705026):1.652867166,((t409:3.106713975,(t410:0.7274713414,t411:0.7246806743):2.327414431):2.993263837,(t412:5.732185659,t413:5.641788554):0.2439355874):0.9594956428):0.2887370279,((t414:3.796304423,(t415:2.027680797,t416:2.001605852):1.737561821):2.57914269,t417:6.121823268):0.7177159696):0.5144409768,(t418:7.200718343,(t419:4.888738405,((t420:2.015445268,t421:2.000310057):1.566386351,t422:3.527902406):1.292148358):2.142749822):0.150868908):11.98332247):7.721486823,((((((t423:0.9204606981,t425:0.7706972331):2.231172556,t426:2.302144718):1.845137164,(t427:3.245714378,t428:3.201757736):0.8769503396):0.6753467127,(((t430:3.699956056,t431:3.64087842):0.4305766899,t432:3.997193382):0.1532396759,t434:3.939922068):0.1191636924):1.089098701,((t435:1.23784475,t436:0.9742331674):3.332404527,t437:4.22345903):0.5267979197):10.79285076,(t438:7.861830411,(((t439:1.678798631,((t440:0.3917053146,t441:0.2949187071):0.3576229351,t442:0.5331671337):0.6832665776):2.639035555,((t443:2.38973486,(t444:1.973225417,t445:1.971049142):0.4164794978):0.5270952577,t446:2.592484272):0.8847711591):2.320334305,((((t447:1.76748558,(t448:1.270267905,t449:1.055621013):0.4001799999):0.9395287819,t450:2.351528944):0.9356228532,((t451:1.795849771,((t452:1.147961764,t453:0.9611078701):0.5162047522,t454:1.314630989):0.02957440035):0.6704685983,t455:1.908628945):0.4326238236):0.1929217659,(t456:0.5044225478,t457:0.4143893304):2.001142252):1.826813283):1.1959372):7.650982194):9.243137973):1.572004688):9.308733771):42.36016127,((((((((t458:2.212535471,((t459:1.295071753,t460:1.273996158):0.2834421071,t461:1.314148327):0.6309625617):0.5034502746,((t462:0.7280470968,t463:0.4336628356):0.5422531815,t464:0.9433116846):1.155725537):0.7333259951,(t465:1.658775934,t466:1.62454617):1.157234914):0.09606202077,(t467:0.2360973388,t468:0.2099742933):2.592221792):0.1417405824,t469:2.814059854):2.708771548,t470:5.095636696):4.6122257,(t471:0.6707832148,(t472:0.5497336858,t473:0.5452768836):0.03280656877):9.011119142):1.549053057,(((((t474:0.9889922995,(t475:0.2952326087,t476:0.12908405):0.5934319769):0.2742408532,t477:0.8761537056):3.329106821,t478:4.029975958):2.271013637,(t479:1.940363561,t480:1.782880809):4.347696098):3.389026352,((t481:0.6508046704,t482:0.6304745044):0.04467157158,t483:0.1633484895):8.702839724):0.6835034):62.97506569);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T46.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
