<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t449:0.7998084845,t450:0.7662333529):0.4034899897,(((t451:0.6122471456,t452:0.3659620684):0.1076856911,t453:0.4189619671):0.08769977458,(t454:0.1124531919,t455:0.03002139172):0.2810105307):0.3471689572):1.690888803,t456:2.312707188):5.990691932,(t457:1.400755676,((t458:0.2658210992,t459:0.2550339875):0.5038002465,t460:0.6562802638):0.5382099783):6.825403551):11.21036917,((t461:0.6588603125,t462:0.6569240398):18.41670633,(((t463:7.321309413,t464:7.222585859):3.746916752,(((((t465:1.281288363,t466:1.25737363):4.357297324,t467:5.605353256):0.03893485925,t468:5.591281316):2.636022909,(t470:2.378766158,(t471:0.287886442,t472:0.2663576233):2.036580947):5.554913108):0.1212653694,t473:7.820187386):2.414862312):6.631852051,(((t474:4.162162176,t475:4.101243683):4.532494418,t477:8.384965372):7.168676214,((t478:5.036843314,t479:5.019898613):3.356073201,(t480:5.417665704,(t481:0.4504120466,t482:0.3674238161):4.96310436):2.885490498):7.123054805):0.9271770906):1.202924675):0.1366269621):66.8738802,((t483:14.98639506,(t484:7.516677325,(t485:6.679911132,(t476:0.09132370464,(t469:0.1998946716,(((t445:0.1740366429,t446:0.03592103893):0.152866108,t447:0.1844823108):0.1291831195,(t440:0.05849779736,(t432:0.04087210983,(t431:0.04279330479,(t423:0.0543353631,((t411:0.116317917,((t341:0.09755028613,(((t323:0.2962942159,t324:0.2410765471):0.06501361978,(t289:0.0701426371,((t274:0.03391803007,((t258:0.2044491805,(t250:0.1324263007,((((((t193:0.03285094445,((t161:0.06631773078,((t152:0.2984609614,((t142:0.04399980937,((((t96:0.04802049881,(t52:0.3654397724,(t47:0.09218043191,t1:2.96425934):0.7086847036):4.924159191):2.017285129,(((((((t2:0.8037664726,t3:0.6988643969):0.4090725444,t4:1.048034221):0.6484530177,t5:1.673829545):0.8302791497,t6:2.430867298):2.517345438,(t7:4.412834236,(t8:1.619201222,t9:1.342575132):2.754771166):0.5252886857):4.157863992,((t10:0.6990300474,t11:0.5875351929):5.625969788,(((t12:2.067496003,t13:1.911051446):1.512843468,(t14:2.946476121,((t15:1.908267529,(t16:1.559487551,t17:1.544297448):0.2657089648):0.4591387189,t18:2.241893403):0.5440011326):0.4297502948):1.454278206,((t19:1.576850201,t20:1.575102752):1.325158566,t21:2.882620888):1.619755815):1.123964245):2.448187638):0.9633566024,((t22:1.13160031,(t23:0.04965406223,t24:0.002879476499):1.075728369):1.804451426,(((t25:1.496341612,(t26:1.226414589,t27:1.188883633):0.2537280992):0.1892697228,t28:1.615447481):0.8103498597,((t29:0.9352017004,t30:0.7822610025):1.28806496,t31:1.976788737):0.0168326825):0.3583878291):5.964515341):0.2465943172):0.2996196486,t32:8.830214328):0.4998267425,(((t33:1.963205761,(((t34:0.1937763108,t35:0.1085110543):1.066209071,t36:1.074274778):0.4186653469,t37:1.344033098):0.2805278423):1.127027171,(t38:1.938344523,(t39:1.31217117,(t40:0.9614691471,t41:0.8799272545):0.2415465435):0.5855755906):0.724919926):0.7284617359,t42:3.15799692):5.460381287):0.8494614955):1.528792884,(((((t43:3.235839861,(((t44:0.8726454879,t45:0.8719560498):0.9201280632,t46:1.736767):0.3965155042,t48:2.028585154):1.034149834):0.2446550104,(t49:1.607713275,(((t50:0.8052035329,t51:0.7902942859):0.139367125,t53:0.136622462):0.1685685438,t54:0.2317353526):0.4464561516):1.60457398):0.08230244241,t55:2.30027781):0.6309399162,(t56:0.6774925226,t57:0.5907460069):2.250204876):5.323229656,((((t58:0.6546990924,(t59:0.352721908,t60:0.274869569):0.2621465962):0.4280977453,t61:0.8357728706):0.7653401784,t62:1.359307664):2.895969309,((t63:1.101663875,t64:0.8362344551):0.07735133622,t65:0.8684250652):2.952802677):3.329779191):1.479024572):0.03393694677):0.2220705358,(((t66:4.305949595,t67:4.215371465):1.867699591,(t68:0.7668949081,t69:0.7022744938):5.174944871):1.112457044,(t70:2.346592784,(t71:0.9027755083,t72:0.8806807999):1.376486253):4.393570949):1.570325442):0.7426223987):1.012848976,(t73:8.610798585,(((t74:0.456606119,t75:0.4554466168):0.6453825525,t76:1.045212297):5.603516821,((t77:1.621663464,t78:1.233775258):3.461102558,(t79:0.4517597535,t80:0.2749028585):4.182706874):1.480513642):1.884467357):1.329366626):2.453877893):3.408372426,(((((t81:0.977299001,(t82:0.7983429555,t83:0.7796541207):0.1563073371):3.567291341,t84:4.22834693):0.2816978533,t85:4.157030597):1.458034755,(((t86:2.336421347,t87:2.272152145):0.9920474606,(((t88:0.554460092,t89:0.4369967678):0.1365677021,t90:0.4311207543):1.175652247,t91:1.467180446):1.39431532):1.798171149,(((t92:1.556558408,(t93:0.2939623435,t94:0.2736291297):1.116728663):0.4294555516,t95:1.788865239):0.1278782338,t97:1.663566592):2.535768369):0.4149759797):3.700011706,t98:8.215290774):4.655164566):1.364432152,(((((t99:3.88703181,t100:3.859417749):2.807706688,(((t101:1.980178699,t102:1.971048688):3.348575649,(t103:4.006205871,((((t104:0.2449236699,t105:0.1684616059):1.092445984,t106:1.238929763):2.279428383,(t107:1.773877098,t108:1.771538334):1.7365552):0.1893215676,(t109:3.26304407,((t110:1.792899448,t111:1.747364633):0.5557651669,t112:2.212468178):0.8584409588):0.4143508734):0.1187968582):1.088800284):0.4762939198,(t113:4.553258352,(t114:4.46271276,t115:4.228966145):0.03043134067):0.5568275951):0.8405856347):1.878467644,((((t116:3.063696657,((t117:1.833050239,t118:1.793028318):0.9106997513,t119:2.685831103):0.2801435656):0.4547536848,t120:3.413574295):0.8675571098,(t121:1.24450114,t122:1.224144181):2.981977257):0.05458217935,t123:4.235776442):3.069383381):1.164240421,((((t124:2.909521671,t125:2.817653421):0.9764147926,((t126:1.762824039,t127:1.738566144):0.3870215016,t128:2.036918186):1.634926055):0.154699585,((((t129:0.5512669869,t130:0.5429836581):0.8065350367,t131:1.304112943):0.7524340676,t132:1.88360128):0.8214169631,(t133:0.1164332545,t134:0.0126719573):2.3243113):0.8110085489):0.5742718617,(t135:3.252354097,t136:3.114938349):0.4681480891):3.83514358):1.729803544,((t137:3.903478161,(((t138:0.4097331226,t139:0.1553077413):1.307626516,t140:1.403319846):1.363405543,(t141:1.489774292,(t143:0.8523601847,t144:0.5118492506):0.5782097417):1.111125987):0.8136121388):0.63565426,((t145:2.495931891,((t146:0.4804452127,t147:0.178994941):1.47999722,t148:1.606356497):0.5323035802):0.6202208216,(((t149:0.9972383245,t150:0.6887121745):1.512344134,(t151:1.588561709,t153:1.043672961):0.5655814106):0.006643729047,(t154:0.1450841617,t155:0.1179504818):1.449437902):0.1604198374):0.5182457531):4.060603668):2.700726641):0.0973167005,((((t156:0.6085613081,(t157:0.06929628268,t158:0.02766370118):0.4621083648):3.528254958,(t159:1.117291071,t160:0.7494235929):2.762659063):0.1980340939,t162:3.153603799):0.5047628096,t163:3.261886376):4.241289772):0.5556194389,((t164:0.198513842,t165:0.1666701593):6.18742788,((((t166:3.442188014,(t167:0.1910654057,t168:0.06081382535):3.110263217):1.792166872,(t169:0.7748686548,t170:0.6952995456):4.070150839):0.02784954862,(t171:4.322745095,t172:4.187590387):0.317760613):0.2990720285,(t173:1.703764999,t174:1.618587202):2.993653076):0.6623788889):1.651731106):0.149849036,(t175:5.439358408,t176:5.358874063):1.401822375):0.1312035039):0.8245590164):0.6452304777,(((t177:0.5791084704,t178:0.562014873):5.566326222,t179:5.953701341):0.5743428054,(t180:0.5277435523,t181:0.3336441684):5.978029929):1.535158259):1.331515173):0.3570497159,(((t182:3.403783785,((t183:1.789733577,t184:1.749760514):1.390932781,t185:3.132910055):0.2137394894):0.699057675,t186:3.975491353):2.138073747,(t187:0.5914566451,t188:0.5040033319):5.491739834):3.28604883):0.583486339):4.12116836):1.3640269,(((((t189:4.123936865,t190:3.972937848):0.6492000768,t191:4.590369207):1.656031166,(((t192:3.01611321,t194:2.805001125):2.436888409,(((t195:1.338458286,t196:1.254091773):1.149513124,t197:2.39325626):0.7074163362,t198:3.006927236):1.872849259):0.2196794265,t199:5.046152982):0.5594054369):2.209262125,((t200:5.000268033,t201:4.944831511):0.4724738578,(((t202:1.964529419,t203:1.844102827):1.3487892,((t204:0.8278773369,t205:0.8032082573):0.1384143622,t206:0.9032578552):2.163003374):0.7858305644,t207:3.563608989):1.174979022):2.322977929):0.6587015355,(((t208:2.465783065,(t209:1.226121797,t210:1.174168678):1.151800297):1.039835323,t211:3.294447665):2.092417926,(t212:2.680348902,t213:2.616626365):2.676109678):1.92889061):6.043469168):0.7509233518):5.005895923,(((((((((t214:4.499124403,(t215:2.620557644,(t216:1.124161395,(t217:0.8284511956,t218:0.7092809839):0.1440700946):1.434588495):1.779472656):0.01468407851,(t219:3.786630486,(t220:2.985412733,(((t221:1.077877376,t222:1.039778283):0.1836292404,t223:1.076985837):0.6726419322,((t224:1.035540927,t225:0.9655451844):0.1933376318,t226:0.9926755329):0.4939651722):0.942610408):0.7627436737):0.07980220983):0.1852996262,t227:3.087714811):1.540882609,((t228:1.087419873,t229:1.014568376):1.95091024,((t230:0.4580687088,t231:0.4562547262):0.1275538571,t232:0.4618123659):2.064366082):1.556396867):7.249383976,((t233:0.5442248949,t234:0.5142106915):2.989991577,(((t235:1.423405135,t236:1.316218196):0.2550825341,t237:1.477165568):0.7184409142,t238:2.158908788):1.08337035):7.727583981):1.245514553,(t239:8.174748759,((t240:6.122835675,(((t241:1.481538884,((t242:1.066036488,t243:0.7595351524):0.2071100539,(t244:0.1484931232,t245:0.04642218721):0.8095147368):0.1413256853):0.180409818,((t246:1.023605197,t247:0.9431400858):0.02066999857,(t248:0.7919394842,t249:0.5941294639):0.1506839481):0.0134878123):0.6011164455,t251:0.8924169864):3.827726652):0.8324134039,((t252:0.1521014588,t253:0.06866702465):4.230052595,(t254:0.221157975,t255:0.1672538505):4.007531357):1.156552281):1.159440876):3.931233633):1.527679555,(((t256:1.364385919,(t257:0.7579044511,t259:0.1722346118):0.5688213803):5.578773866,t260:6.104203961):2.914405246,((((t261:0.3326444203,t262:0.1033210257):4.174826692,t263:4.186072857):0.04309735443,(t264:1.364492589,t265:1.292177744):2.839505819):2.436053377,(t266:0.9064415729,t267:0.7665924224):5.632556953):1.881508833):2.052887913):0.02964915406,((((t268:1.620963829,t269:1.181022835):0.06059931183,t270:1.000139433):5.507476221,t271:6.475703502):2.567070659,(((t272:3.969191697,(t273:0.3874318779,t275:0.2636075595):3.549715316):1.318657475,t276:5.099501733):3.67283246,(((t277:1.697768782,t278:1.56979986):6.198635558,t279:7.71134991):0.7470439869,((t280:0.6263997869,t281:0.5530518724):6.675583758,(((t282:2.238808473,t283:2.22928046):0.8445809253,(t284:1.327596439,(t285:0.9628092784,t286:0.9568404692):0.3084805842):1.745989252):2.441872343,t287:5.360875717):1.621345333):1.125062087):0.1091688247):0.05537721877):0.5541248464):0.2567012546,(((t288:5.515711856,((t290:1.424026453,t291:1.306309743):3.330263089,(t292:1.77163022,t293:1.766797169):2.855619172):0.6396042047):0.918713799,((t294:5.171057698,(t295:1.011745648,t296:1.003531692):3.871988689):0.6468268701,(((t297:1.741926847,((t298:0.004971851323,t299:0.001040926397):1.09433997,t300:0.9400877276):0.4795549597):2.192854362,(t301:3.189692742,t302:3.090180753):0.3430699846):1.298993181,(((t303:2.886343594,t304:2.786929811):0.5615804398,t305:3.148012131):1.034926785,((t306:2.943837971,(t307:0.9172886664,t308:0.6351613145):1.92579092):0.8064335762,(t309:1.675811374,(t310:1.289373979,t311:1.283305685):0.2061684031):1.362060978):0.4307356056):0.1447116933):0.1027854755):0.3596039032):0.4837922601,t312:4.305074029):1.944229981):2.454151855):2.360488303):0.8522650124,((((t313:3.757623255,t314:3.674391951):1.301820858,((t315:3.176882108,t316:3.156302538):1.643524928,t317:4.456861448):0.114387814):2.425294095,(t318:3.428877388,t319:3.428685675):3.416153618):0.03930756048,((t320:1.271693395,t321:1.234146366):0.2437567303,(t322:1.109197453,t325:0.326976533):0.2345487804):5.225445616):4.35418547):0.1940422631):0.5413558537):0.05990301503):1.195117327):0.6167931726):1.913453049):0.636772837):7.187841056):0.7689543831):7.396465336):32.90951305,(((((t326:2.71754611,t327:2.689303531):1.325042701,(((t328:1.547415364,((t329:1.115792203,t330:0.9419144968):0.1671625801,t331:0.9345133454):0.248628478):2.172296411,(((t332:0.2599970652,t333:0.2150588832):0.9069213129,(t334:0.7632467716,t335:0.7118833435):0.2751084683):1.253807538,(((t336:1.239961163,t337:1.08464383):0.3660681174,t338:1.396011971):0.2048285456,t339:1.347298141):0.404571879):0.73018169):0.09223906096,(t340:2.195074084,((t342:0.6750060769,t343:0.5785107065):0.2917740558,t344:0.8046991346):0.5137146845):0.2273227857):0.1837607007):10.76398019,(((t345:0.3303251425,t346:0.1960446741):1.308548669,t347:1.433891072):2.679527616,t348:4.002396371):7.876599715):0.2719349912,(t349:9.689172057,((t350:8.067449435,(t351:0.3017958062,t352:0.2805969575):7.58142125):0.1220598596,(((((t353:0.3127515531,t354:0.2616632777):0.1685564681,t355:0.3382180525):2.817244596,(t356:2.834353788,(t357:1.545730348,t358:1.45950889):1.234492515):0.2534490876):0.771614551,(t359:0.7803497271,(t360:0.5381185915,(t361:0.4019763347,t362:0.2204424099):0.02808777904):0.2080835033):2.910690365):3.807588907,((t363:2.031898793,t364:1.996336328):0.6375978882,t365:2.430209278):4.239576106):0.09818722174):1.239305886):2.447911232):18.60364551,((((t366:0.3474659374,t367:0.2269307081):9.636256524,(((((((t368:0.4425556952,t369:0.3485532374):5.5286734,t370:5.866303043):0.7311571,(t371:5.705776767,t372:5.67527619):0.8415280923):0.8779765042,(((((t373:4.031880361,(t374:2.640067894,t375:2.620059076):1.265946545):0.835182125,(t376:0.2087886371,t377:0.1741826874):4.430712085):0.4157282238,t378:4.971380718):0.5806733568,t379:5.533060697):0.1189910306,((t380:0.1644564522,t381:0.09510168893):0.5344399267,t382:0.6018007683):4.890375154):1.258071144):0.7815135879,(((t383:2.931398371,t384:2.554739208):2.515977702,t385:5.035207179):0.687805784,(t386:5.166342585,(t387:4.487107509,t388:4.403877249):0.5047708711):0.4896232647):1.391377445):0.210753645,((t389:4.055822063,t390:3.929299523):0.1574681917,((((t391:2.217869892,t392:2.141248949):1.198801623,t393:3.326931747):0.4091617595,((t394:2.058058759,t395:1.929992534):1.110615218,t396:2.810106857):0.4504511934):0.1066156099,t397:3.155219639):0.1177268708):2.498985582):0.5819324579,((t398:1.622267407,(t399:0.7899814353,t400:0.7014908979):0.8120067988):0.9169867969,t401:2.382259315):3.272994984):0.6699563663):2.464261849,((((t402:2.773355062,t403:2.701213482):0.3277906711,t404:3.005312639):2.026829885,((((t405:3.968843297,((t406:2.707366345,(t407:1.557908776,t408:1.495921534):1.141614108):0.5332893403,((t409:0.563707246,t410:0.5289477055):0.7228433617,t412:1.086097878):1.874891225):0.4920260865):0.1022472204,((t413:1.825002254,t414:1.653470688):1.004358759,((t415:0.5887928791,t416:0.5876378109):1.67295977,(t417:0.2801466168,(t418:0.2208778665,t419:0.2137460134):0.003149205862):1.840242799):0.3268579872):0.5045068729):0.1742662952,(t420:1.297746784,t421:1.149049522):1.724728471):0.1198765989,(t422:1.899467566,t424:1.795561787):1.023123655):0.5319249146):2.17281779,(((t425:0.9201019418,(t426:0.3693865123,t427:0.2558998894):0.4569653289):0.6759617998,(t428:0.4859423536,t429:0.4239661871):0.7487850459):1.548769712,((t430:0.6217340244,t433:0.3330938796):1.209636937,t434:1.494035188):0.8466707454):2.36776794):1.342651163):6.206775419,(((t435:1.054173769,(t436:0.0569709709,t437:0.0509397897):0.9428607486):3.78942034,((t438:0.937527241,t439:0.867905441):1.922480303,(t441:0.7162920595,(t442:0.1142497805,t443:0.1022698061):0.5923733165):1.551724364):1.612119518):5.888788067,(t444:0.832440026,t448:0.07315873765):8.828411252):1.475908778):10.28053097):29.86134955):36.46236647);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T84.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
