<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t368:9.010945621,((t369:3.780749117,t370:3.574340203):3.46770885,(t371:0.2620097416,t372:0.2258647413):6.755358451):1.637441222):9.716193525,(((((t373:0.1955279432,t374:0.1075894413):5.666498675,(((t375:0.1915060845,t376:0.1902790069):4.124984915,t377:4.293529101):0.3223880883,(t378:3.34286547,t379:3.310963946):1.093839256):1.133146678):1.046985655,(((t380:0.2398000213,t381:0.121908305):2.537705921,(t382:2.355804304,t383:2.342741208):0.1745997946):2.061420846,t384:4.539171055):1.694763383):0.1779056458,((t385:4.487373523,(((t386:0.5465028049,t387:0.4826617995):0.9941369588,t388:1.278783416):1.50686391,((t389:0.1945172505,t390:0.1365784396):1.1113938,t391:1.172834094):1.350434819):1.321508678):0.5303835415,(t392:3.432460268,t393:3.018464053):0.9315814312):1.347247564):0.1352634239,t394:5.406020218):11.0993811):0.7068576482,(((((t395:2.90808783,t396:2.848536386):1.075768342,t397:3.917681441):1.422528522,((t398:2.145674436,t400:2.007396229):1.433291163,t401:3.130985514):1.725680562):0.9951902534,(((t402:3.426117471,(t403:1.380822871,t404:1.340854316):1.937757309):1.465181482,((t405:4.240474561,t406:4.217600299):0.05079502096,(t407:3.891693941,((t408:1.495291336,t409:1.476587098):2.094945534,(t410:2.177182751,t411:2.025000654):1.388049898):0.2774347814):0.1845210612):0.418459326):0.3039306425,(((t412:2.863206329,(t413:0.997511744,t414:0.9261439964):1.82217984):1.13390719,(((t415:0.4828881027,t416:0.4576870033):0.8708878205,t417:1.288034682):2.043732548,(((t418:1.921025847,t419:1.625660411):0.4311121696,t420:1.780373788):0.7917772511,t421:2.316784361):0.1805296677):0.1157765828):0.3927150066,t422:2.950789029):0.0406897766):0.6119144918):1.554315171,((((((t423:1.393047825,t424:1.287059596):0.6117931186,t425:1.861253826):0.3176565454,t426:2.124296547):0.4683479904,(t427:1.519284389,(t428:0.6692233469,t429:0.6471474507):0.8216858609):0.8721051136):0.2927409425,t430:2.480654802):1.689384576,t431:4.074745172):0.2337913733):9.246271361):8.416657921,((t432:1.399747452,(t433:1.311914871,t434:1.01179644):0.05667866054):1.98449175,((t435:1.043766823,t436:1.024376015):1.64270163,((t437:0.3262407645,t438:0.3248571768):1.95065832,t439:2.268112249):0.3140792974):0.335516779):18.5634277):45.11209752,((t440:0.1649640034,t441:0.1605069381):44.25872413,(((((((t442:4.263297086,(t443:2.225464869,((((t444:0.6906889598,(t445:0.1316093504,t446:0.01951587292):0.424441164):0.03811173629,t447:0.4086670701):0.2768639301,t448:0.5008814718):0.6562193637,t449:1.069978706):0.5498823096):1.970670398):3.930950954,((t450:2.545163868,t451:2.541617582):2.852776599,t453:4.903284111):2.100830527):4.055673029,(((t454:1.349103573,t455:1.269926676):0.708777103,(t456:0.2913468388,t457:0.1661180282):1.64153984):5.801780539,((t458:0.9923377846,(t459:0.8918327477,t460:0.7295458017):0.001255921153):3.233520581,((t461:0.7523505414,t462:0.6775362148):2.794587089,(t463:1.159653788,(t464:0.3590746685,t465:0.2940511787):0.7846818603):2.2249596):0.3372128693):3.380100823):3.163883695):1.585207663,(((t466:1.493523564,t467:1.431312992):4.657169691,t468:6.075680323):2.228900918,t469:8.279051939):3.389116428):7.896538845,(((((t470:0.3071015351,t471:0.01850617766):0.163969333,t472:0.0180196121):1.564663294,t473:1.38769425):6.492276468,(t474:6.029366644,((t475:2.033570698,t477:1.845482445):2.566078439,((t478:0.3230217633,t479:0.2877369526):0.5788567362,t480:0.5706249933):3.304099384):1.324400925):1.722917114):0.4216126023,(t481:0.619819785,t482:0.5168890311):6.684891379):10.44022862):2.768632481,(t483:2.602976067,t484:2.593157021):17.67046784):7.277450047,(((t485:3.277988868,t486:3.222647048):2.392440916,(t487:0.3067261534,t488:0.08106177436):5.306101538):1.75209647,((t476:0.004300070684,(t452:0.09830108141,(((t399:0.005968017724,((t362:0.02566819687,(t359:0.006675393604,(t354:0.03375031822,((t329:0.01747215057,(t290:0.131687051,(((t233:0.02116477966,(t169:0.4864893003,(t170:0.1773011474,(t163:0.02611433474,(((t140:0.01648097912,(t122:0.07351583801,((t72:0.07865933488,(t69:0.07248443758,(((t36:0.2532351561,t37:0.1971033639):0.1104994375,(t38:0.11048447,((t1:2.452149104,((t2:0.9588911875,t3:0.8656165103):0.8028313112,t4:1.563576368):0.6718025618):0.3622507337,t5:2.382246686):1.449838297):0.005757686782):0.7813131542,((t6:2.412461811,t7:2.328301122):0.8006799301,t8:3.060225636):1.326161308):2.82704745):0.4719818272):2.995594298,((t9:4.136999133,(t10:2.873278621,t11:2.794786503):1.21089169):1.827923838,((t12:1.75715908,t13:1.549341435):0.7409558152,(t14:1.896575426,(t15:1.015557495,t16:0.4154553772):0.7999690926):0.2667841189):3.217687841):4.707210653):1.456052547):2.074853438):0.1787173241,t17:13.03769865):1.50266344,(((((t18:2.292097818,t19:2.259011833):2.10563383,((t20:1.818397898,t21:1.775293888):0.5232554335,t22:2.087938352):2.011811626):2.531752484,((t23:3.571645621,t24:3.560747418):2.757619863,((((((t25:0.257698531,t26:0.1305376396):0.556728761,t27:0.6209105477):0.05144013154,t28:0.5435706528):2.990348076,(t29:2.03160163,t30:1.850321915):1.479911803):0.01039751368,t31:3.224807865):0.7620082359,(t32:3.816171491,t33:3.745551182):0.1008304662):1.584706492):0.2723000981):2.67090703,t34:8.209617765):0.3367301304,(((t35:1.630077175,(t39:0.1583080294,(t40:0.1123662412,t41:0.03169183224):0.01083369784):0.9295838339):0.8978321399,(t42:0.6011918455,t43:0.5572998373):1.059784997):4.576752116,((((t44:0.3120178769,t45:0.2558277103):0.324206421,t46:0.3990135925):0.2210530284,t47:0.2787398301):0.3233324199,t48:0.3588514173):4.982067012):1.295082262):4.341506882):0.3462030115):0.6100453324):0.1540356737):4.986771958):2.130728342,((((((((t49:6.027721727,(t50:4.914573498,t51:4.876625723):1.100816594):2.14498883,(t52:0.8002953674,(t53:0.3540146587,t54:0.3263568919):0.4428797832):7.258893624):0.383546261,(t55:7.426838875,(t56:7.140665423,(((t57:2.2334763,t58:2.019960514):3.342273607,((t59:2.42664054,t60:2.344413239):1.946097488,t61:4.189546041):0.7600895644):0.5096749511,t62:5.35621424):1.053187651):0.2812167451):0.8286416771):0.5688345122,((t63:4.311687942,t64:4.018153379):2.519703746,((t65:5.906715516,(t66:2.715124571,t67:2.592081624):2.946817884):0.05380436849,(t68:3.661679425,t70:3.582097766):1.763619367):0.4945043227):1.113458868):4.605211021,((((t71:2.823288018,(t73:1.957217926,t74:1.942338465):0.1582250932):1.824404135,((t75:1.138833664,t76:0.988187311):1.523871534,t77:2.48686248):1.148782983):2.535845543,(((((t78:4.008983038,(t79:0.3430138964,t80:0.1798775921):3.650265011):0.7294580741,t81:4.496797407):0.0661051209,t82:4.513145525):1.174451135,(((t83:4.385449853,(t84:3.278631266,t85:3.270388315):1.027032065):0.1659742894,(t86:2.453741789,t87:2.446552731):2.005544369):0.8675489361,t88:5.232016518):0.07552642433):0.07381338386,t89:5.245144748):0.08816268523):1.648029538,(((t90:1.908161861,t91:1.845581808):0.7409703174,(t92:2.362599019,(t93:2.219638573,t94:2.073602806):0.10536563):0.223953055):1.035000916,((t95:2.064698215,(t96:0.7982436227,t97:0.7968001882):1.263616294):1.219644687,((t98:2.109068167,t99:2.011913016):1.00857749,((t100:2.04951078,t101:1.901592204):0.3644606354,(t102:1.807030822,t103:1.765787099):0.2190298534):0.5402319756):0.1282229726):0.05701145934):3.260423986):2.59981332):2.310008654,(((t104:3.383720416,t105:3.370721956):0.9925234579,(((t106:0.639861737,t107:0.3720024182):2.014812869,(t108:1.31172511,(t109:0.5749201004,t110:0.3786706219):0.6141692215):0.9719706355):0.8629772364,t111:2.688821979):0.6593536583):4.696269394,(t112:4.735393983,t113:4.545493348):3.308798824):1.772602815):1.422056417,(((((t114:2.151695654,t115:2.055486504):0.5578886988,t116:2.611225031):1.4668534,((t117:0.2270194812,t118:0.1261151017):1.138010259,t119:1.169535647):2.701197359):0.9687579571,(t120:2.218266692,(t121:1.183366027,t123:0.884885143):0.8521193278):2.594881523):4.727889827,((t124:2.079421447,((t125:0.1895230227,t126:0.1418678324):1.719917881,(t127:1.464523182,((t128:0.3656774208,t129:0.08534159723):0.3321823233,t130:0.3408717183):0.6541576455):0.2149938583):0.1413306744):3.037349615,t131:4.2999887):3.930832836):1.167479489):0.2616707665,((((t132:0.6377377162,t133:0.3423233387):7.831032657,(t134:7.990777485,(t135:1.523821587,t136:1.231854525):6.378941441):0.1459967073):0.112900485,(t137:1.458370451,t138:1.451655358):6.372288418):0.8438937428,(((t139:0.5860779414,t141:0.415665637):1.24519844,(t142:0.9940437296,((t143:0.3413399623,t144:0.303454315):0.3179374804,t145:0.5979393933):0.1964557558):0.6026991364):5.237988577,t146:6.566275272):1.540594943):0.08428175897):1.353748682):4.028523581,t147:13.57106499):0.1531589955):3.559232501):1.532242781,(t148:17.83968674,(((((((t149:5.849366181,t150:5.797605524):3.090467962,(((t151:0.272547976,(t152:0.00829281276,t153:0.002265220414):0.2247506161):1.215051652,t154:1.439694538):1.530437707,t155:2.96549594):5.867181287):0.2937656743,((((t156:0.6953162238,t157:0.6795958848):5.222655571,((t158:3.24618666,(t159:3.077533757,t160:2.734848506):0.135139597):2.261251501,(t161:2.516695094,t162:2.483824095):2.427726399):0.2530482135):1.495556221,((((t164:0.6764667166,t165:0.6181148679):0.05123895049,t166:0.6615905425):0.4071786162,t167:0.9257583999):5.334746843,(t168:5.523595414,t171:4.988118838):0.6888430531):0.1407766054):1.272187665,(t172:0.3471820629,t173:0.1664175512):6.733381943):0.1533681159):0.5005837292,((t174:0.4435782042,t175:0.3525179914):5.527999942,(((t176:1.396497827,t177:1.368574507):2.624340857,t178:3.978480184):1.233142487,(((t179:3.580736126,(t180:3.109310586,(t181:2.156612206,t182:2.143792124):0.5321913743):0.4487739612):1.153615965,(t183:1.645007611,t184:1.539835973):2.63201705):0.2101489105,t185:4.325055413):0.2243157252):0.3970828096):1.572872621):1.646770727,(((t186:5.986953456,(((t187:5.060220035,(((t188:1.388442976,t189:1.249237092):1.03504841,t190:2.276233513):1.903501522,(t191:1.339757866,(t192:0.6933065369,t193:0.6686600409):0.5536702732):2.630260467):0.6897264818):0.5915328522,t194:5.072167402):0.0145000715,(((t195:0.7692077271,t196:0.6631048824):2.194231253,t197:2.831704014):0.153120563,t198:2.859032306):1.923953492):0.3043004538):1.600096005,(t199:4.338704867,(t200:3.086759025,(t201:2.851194216,(t202:0.1090838249,t203:0.1080640006):2.638739959):0.2237899743):1.215834743):2.242475181):0.4131656522,((((((t204:3.22527524,((t205:0.3486013342,t206:0.1689864066):2.087259744,((t207:1.174131651,t208:1.123467846):0.5315451279,(t209:0.9799377716,(t210:0.1543203185,t211:0.1490234973):0.6197901676):0.6460587266):0.4411805564):0.7584280179):1.328810037,((t212:3.083893156,(((t213:0.9915386951,t214:0.9028913487):0.129877988,t215:0.9431641053):1.52441396,t216:2.415451569):0.374998041):0.0643056369,t217:2.752763216):0.6537948653):0.2704022191,(t218:0.5974138859,t219:0.576219352):2.980497254):0.2815035887,(((((((t220:0.9998431876,((t221:0.04275075064,t222:0.03769147672):0.7982035455,t223:0.7199921705):0.1310757046):0.1606945167,t224:0.8962915427):0.00204175281,t225:0.7117101399):0.005191774182,((t226:0.2715598483,t227:0.1265840194):0.2532453762,t228:0.2284005876):0.1641851751):1.008874556,(t229:1.384846242,t230:1.27622092):0.01210383719):0.05565952463,t231:1.340239018):0.4732099804,(t232:0.8221804553,((t234:0.583455098,t235:0.2511253978):0.02411695154,t236:0.06374176888):0.1331175338):0.9338417324):0.9233746129):1.086459661,(t237:0.1469575116,t238:0.06537181328):2.769117165):0.5093574232,((t239:0.1155684323,t240:0.06068451217):1.584507223,(t241:0.1496830181,t242:0.1235326472):1.407403888):1.638153853):0.131186357):0.07158360087):5.133178605,(((t243:1.060260573,(t244:0.684522106,(t245:0.5684087672,t246:0.5455305944):0.02660469916):0.1803051612):1.267346953,(t247:0.095866164,t248:0.003196061392):1.692733797):0.4035227199,t249:2.075858367):5.772184837):0.6415733785,(t250:2.070537335,t251:2.037131464):6.386139363):0.2633753706):0.9317732943):1.180937654):0.489273984):0.120473115):0.9354074074,((t252:8.064279956,(t253:6.936501324,((t254:0.4559019979,t255:0.308301172):6.167540657,(t256:0.7212147478,(t257:0.5962715887,t258:0.5584958067):0.03947538749):5.570047363):0.2331391399):1.043754795):2.36946505,(((t259:1.38358912,t260:1.289247225):1.581097531,(t261:2.749102924,t262:2.693790943):0.04376293463):0.1168163827,((t263:2.352935327,((t264:0.9433133258,t265:0.919670532):0.6198081121,(t266:1.193794803,t267:1.100877317):0.05923862946):0.7622693315):0.04290326097,t268:1.933074061):0.4191431914):6.596366239):1.828173478):2.358078045):4.164458134,(((((((t269:7.880541216,(t270:6.878732531,(t271:5.896353113,(t272:5.452201795,((t273:0.0436478744,t274:0.002413786739):1.527503068,(t275:0.8837802159,t276:0.6906990591):0.6261069471):3.873517279):0.3596928694):0.8926807605):0.8112377251):0.9917157884,(((t277:6.42737221,t278:6.367591361):1.207488329,((t279:0.4216373276,t280:0.2303540634):7.008834,((((t281:0.924664952,(t282:0.6874328995,t283:0.538641542):0.01337947582):3.307459574,t284:3.824005659):1.192322674,t285:4.905111094):0.6545356286,(t286:3.676866733,t287:3.513491574):1.731668595):1.027662266):0.1366110581):0.38256076,((t288:5.281233324,((t289:3.224042581,t291:2.895875125):1.655672031,(t292:4.199875834,((t293:1.981492922,t294:1.95772714):1.646131688,t295:3.588902108):0.2718125081):0.1320785055):0.1098797299):1.089586046,((t296:3.883451419,(((t297:2.044015757,(t298:0.693711244,(t299:0.5638857152,t300:0.5286063616):0.05116585462):1.241856802):1.141951777,t301:2.96270035):0.5811003779,t302:3.431048539):0.04844905224):0.3575669529,t303:3.827286666):0.9283446144):0.2256123475):0.09671954563):1.105435995,t304:6.176828489):0.1048611327,(((t305:0.9472267724,t306:0.5426783029):1.469287922,((t307:0.8955813054,t308:0.8930710991):0.3219426444,t309:1.161397066):0.744023881):0.7083769148,(t310:0.9485222792,t311:0.9445193673):1.646680178):3.1529893):1.043358123,((t312:0.2784279081,t313:0.262308745):3.714031345,(t314:3.664696512,((t315:2.612841366,t316:2.562895415):0.2203154414,t317:2.573330184):0.7593191122):0.3078121997):2.526456931):3.516921847,(t318:8.42994108,(t319:2.090046577,(t320:1.740083161,((t321:0.5503439195,t322:0.3743726778):0.6897758592,t323:1.038827769):0.4225795759):0.3208759331):6.295507956):1.143308204):0.1067270392,(((((t324:1.843302167,t325:1.804526831):1.04053457,(t326:2.234660436,(((t327:0.5851275253,t328:0.3754125766):0.928664755,t330:1.150738931):0.4310476713,t331:1.313711181):0.1565800254):0.6083000509):2.911017205,(t332:0.3640090342,t333:0.3531152535):4.590602515):0.1611472841,((((((((t334:0.4349935297,t335:0.3513050349):1.061761373,((t336:0.08006509453,t337:0.07194771723):0.3506129669,t338:0.3979303257):0.8990019335):0.5199616046,t339:1.796295965):0.08144394223,t340:1.785746989):0.2380607533,t341:1.963025296):0.6023256764,(t342:2.103547912,t343:2.080266012):0.128970819):0.3614891912,t344:2.041124431):0.08241804556,(t345:1.008195237,((t346:0.6157180088,t347:0.4571524936):0.3112015718,t348:0.6251648429):0.06475972902):1.001074568):1.714494129):0.09048907624,t349:3.426761305):2.884684101):2.365537219):0.7761850361,(((t350:0.4399651486,t351:0.3106998579):2.251196695,(t352:1.108880983,(t353:0.7053148401,t355:0.6297001628):0.2249791713):1.232397289):5.581674121,(t356:6.592537857,(((t357:0.8486017791,t358:0.6983732601):0.9757288464,(t360:1.240560663,t361:1.234751678):0.3117746218):0.6101113817,t363:2.062721205):3.939582974):1.044992688):1.154052638):0.4007709182):2.267074594):0.6446604335,((t364:6.608681576,(t365:0.9331909044,t366:0.8636475739):5.56078824):0.04300547975,t367:6.317568469):4.316307028):7.640670154):20.11067335):12.42093843):22.16275905);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T95.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
