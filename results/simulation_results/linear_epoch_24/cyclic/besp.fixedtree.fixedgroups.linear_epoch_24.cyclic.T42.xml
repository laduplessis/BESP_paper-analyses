<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t405:5.20272976,(t406:5.039818643,((((t407:2.496916423,t408:2.46380465):0.2556001387,t409:2.600855752):1.337696554,(t410:3.586265598,((t411:0.4889965705,t412:0.4540338693):0.8078680567,t413:1.220513195):2.185014249):0.3361397434):0.1034590635,(t414:1.459816528,t415:1.451670294):2.384788002):0.789137475):0.09770631508):100.9590397,((((((((t416:0.6964338645,t417:0.6607566787):3.299135405,t418:3.860308095):0.8138900655,(((t419:1.767123399,t420:1.589673254):1.17851992,t421:2.735435689):1.490407787,t422:4.083193407):0.2054605523):3.528031589,t423:7.647669763):3.615754257,(((((t424:2.187224667,t425:1.596400904):0.8591636069,t426:2.382931365):1.427800134,(t427:2.141284096,(t428:1.765230951,t429:1.722185255):0.3236814443):1.420177507):0.08668831029,(((((t430:0.595144087,t431:0.5644353256):0.7142737529,t432:1.210681482):0.3207578632,(t435:0.6890958234,t436:0.6503471461):0.4285625308):1.25194037,((t437:0.780867235,t438:0.6658252322):0.9881595154,((t439:1.182237445,t440:0.9873740193):0.115046038,(t441:0.7417542437,t442:0.7073269576):0.2953064917):0.3068566155):0.5302383453):0.1121240137,(t443:0.2716600385,t444:0.2185367688):1.645704688):0.5125376754):5.901332912,((t445:0.2787892185,t446:0.2478518411):1.053567806,(t447:1.127281167,(t448:0.1305171658,t449:0.0813277919):0.6837204516):0.1697103844):6.751599132):0.7055267614):2.061155317,((((t450:0.7667606636,t451:0.6622716025):0.2609339286,t452:0.3675897377):7.544486946,(t453:0.7422135399,(t455:0.1953539943,t456:0.09021684541):0.37011817):7.122325441):1.310147994,t457:8.783495681):0.4895733124):13.46618723,(((t458:8.075247406,(((t459:0.3136553482,t460:0.1624796649):0.1201265685,t461:0.1725798985):3.259839848,t462:3.234539236):4.373642356):3.209206863,(t463:1.567341115,t464:1.338358899):9.087574016):7.793590584,(t465:18.00800466,(t466:17.22092656,(t467:14.25744709,(((((t468:2.587738566,(t469:0.2577444667,t470:0.2250082384):2.120599083):3.427878274,(t471:2.293234669,(t472:0.5267722442,t473:0.4012402942):1.698577159):3.443267479):0.1954404914,t474:5.725984086):1.066450558,t475:6.511952177):0.6622648684,(t476:5.142158394,(t477:0.5560214608,t478:0.4566422478):4.569009307):1.874663611):6.223536122):2.947213612):0.7342866473):0.1263503407):3.641966346):8.884443934,(((t479:4.170546342,(t480:3.100863747,t481:2.903858949):1.001456307):1.111380842,((t482:0.4257181424,t483:0.4058960232):0.6026186752,((t454:0.1229287773,((t433:0.3732105113,((t434:0.1669703048,(((t376:0.1015990221,((t340:0.2297100797,(t255:0.2083799863,(((t241:0.01858023809,(t239:0.3892054774,(t187:0.1190534363,(t158:0.1759236387,((t147:0.07133522159,(t135:0.08019654042,(t125:0.03145322167,((t53:0.1258727409,(t47:0.1179180557,(t30:0.1082487938,((t1:3.292382481,t2:3.274582792):0.9047941953,(t3:3.571511047,t4:3.235725724):0.5362459333):0.2334292377):1.800187613):0.5629788755):0.9367585239,(t5:2.702068548,t6:2.572343444):4.586893421):4.580029357):0.6237604674):1.562145037):0.9832954485,(((((t7:4.674102694,(t8:3.677854922,(((t9:1.264665684,t10:1.096112436):1.716459019,(t11:1.554135525,t12:1.229778517):1.21448561):0.4363536823,t13:2.163316406):0.1096882255):0.7445040914):2.724715166,(t14:4.966700083,(t15:0.7538632882,t16:0.5729308572):3.995670363):0.7459465694):5.490050442,(((((t17:3.201241312,t18:3.199700191):0.6664379383,(t19:2.469538281,(t20:2.34162751,(t21:0.4288530399,t22:0.2679743751):1.818310479):0.09744852416):1.373389364):3.620592785,((t23:2.287995776,(t24:1.560276791,(t25:0.9548495171,t26:0.8653702509):0.4931260026):0.7169764127):0.4345281914,t27:2.488914691):4.101586738):2.667336509,(t28:2.776741159,t29:2.281728627):6.374193252):0.2984088125,((t31:0.5478737348,t32:0.4869043486):1.341541523,(t33:1.05993761,(t34:0.1869828599,t35:0.1708202842):0.8618619485):0.5643379031):6.472627112):0.3502431186):0.2050786313,((t36:0.1244988905,t37:0.03243418531):0.5457151201,(t38:0.2470387297,t39:0.1800973282):0.3095765417):7.906332157):1.414602668,(t40:6.911869064,t41:6.901198815):2.886736557):0.3183328036):0.2115717752):3.707958168):4.222869649):0.3918412407):0.2865640286,((((((t42:1.122523468,t43:1.05767387):0.9892873081,t44:1.878604011):5.568613243,(((t45:1.922814127,t46:1.910037356):3.799775657,(t48:1.580623485,t49:1.515951185):3.853117185):0.8846143263,t50:6.175861206):0.4384735618):0.6065798979,(t51:1.902275068,t52:1.824965963):5.27903678):0.7885959586,(t54:6.035786769,(((t55:2.667029203,(t56:0.1508256997,t57:0.1361797172):2.452126978):2.113396959,t58:4.635655467):0.1616219383,(t59:3.141098094,t60:3.073160306):1.442874404):1.018363909):1.687584597):8.513724131,(((((t61:4.046812421,t62:4.008642311):0.03691395583,(t63:3.131470532,t64:3.028418929):0.8832476481):5.297417645,((t65:4.032444823,t66:4.001672944):3.644110608,(((((t67:1.527181559,t68:1.444506082):3.152767922,(t69:1.431324179,t70:1.267279667):2.81061972):1.239480785,((t71:3.967074839,t72:3.872056115):0.5574018095,(t73:4.317648623,(t74:4.027546949,t75:3.889227502):0.2560970129):0.03205967866):0.7637483558):0.4557175946,((t76:4.063776765,((t77:1.027603345,t78:0.6373553643):0.1392902666,t79:0.7178368361):2.789860258):0.881389051,(t80:3.452745892,t81:3.440850097):0.9064063112):0.3321320901):0.4539048811,(t82:4.452475994,(t83:3.174752354,t84:3.13133449):1.20738992):0.6689436849):0.634849085):1.527847282):3.424059842,((((t85:0.5702661172,t86:0.568781684):3.605591816,((t87:1.730098168,(t88:1.450455765,t89:1.429105218):0.2056696609):1.602756945,t90:3.211229683):0.7923456914):1.299133564,t91:5.288013892):0.07149232489,((t92:0.4631575457,t93:0.4256216659):3.947108149,(t94:0.729619444,t95:0.6869420085):3.566938363):0.9216981361):4.964549154):2.429258399,(((t96:3.87214768,t97:3.87177798):2.326088382,((t98:2.076387668,(((t99:0.2056684467,t100:0.02615912361):0.03896628771,t101:0.04003235692):1.086351292,t102:1.125318752):0.703003077):1.088094065,((t103:1.852463281,t104:1.84585893):0.08705614078,(t105:0.4025957045,t106:0.3298603786):1.490625033):0.9187250456):3.017081464):1.46737431,((((((t107:0.3107523624,t108:0.3035420346):0.2525526825,t109:0.4157875812):0.2708619996,t110:0.5806865742):1.553112067,(t111:2.038362714,t112:1.968742732):0.03916443629):1.94399503,(t113:1.900188506,t114:1.873076397):1.422274254):2.071918843,((((t115:2.176523356,t116:2.165096974):0.5404130012,(t117:1.764379246,t118:1.711066745):0.7859121113):0.9887654043,((t119:0.9108337711,t120:0.8636388441):2.037174257,((t121:0.4934452482,t122:0.4199181547):1.694289754,(t123:1.405642571,(t124:0.5224756311,t126:0.426555724):0.8176904688):0.6910148152):0.6595541518):0.4572182917):0.9075686983,t127:3.953888909):0.7229297968):0.7604299382):4.824424726):0.4064056273):1.258520627):0.6165853849,(((((t128:0.1728089885,t129:0.0867621168):4.736416352,(t130:1.149485611,t131:1.068681021):3.666510535):0.7819403666,((t132:1.068895938,t133:1.037928306):0.4025208638,(t134:0.7341646464,t136:0.5717957463):0.7048981193):3.898197244):5.313775526,(((((((((t137:0.1909196478,t138:0.1860531507):0.2365106258,t139:0.1849776428):0.0297474188,t140:0.009172125049):1.867757228,(t141:0.4246309038,t142:0.4155751068):0.9425346181):2.439159595,t143:3.682119736):1.371316579,((((t144:1.36287317,(t145:0.7252625622,(t146:0.493546054,t148:0.1098144201):0.1845371129):0.6236613943):0.5077978884,t149:1.40940356):0.1561964807,t150:1.383448326):1.694284511,t151:2.924244967):1.173497929):0.4301341832,(t152:1.267686136,(t153:0.2415746496,t154:0.212448012):0.9167067851):3.250081168):2.571943138,(((t155:1.986271333,t156:1.831022449):0.3003665399,t157:2.121929908):4.168002474,t159:6.024574581):0.487084411):0.4914709826,((t160:0.3210951194,t161:0.274750732):0.7482292173,t162:0.9832545279):5.635399267):0.7507504224):1.040564558,(t163:6.569166935,t164:6.509484733):1.73885576):0.4001101574):0.6244112483):7.686866287):0.7064337318,(((t165:9.363983799,((t166:0.6434437921,t167:0.5039427792):0.1862853325,t168:0.643713087):8.193305808):1.95682392,(((((t169:4.640184373,t170:4.385618544):0.1830155093,t171:4.521052468):2.103653863,t172:6.608460855):0.7393686925,((t173:4.708601758,t174:4.683644368):1.966369256,t175:6.646857935):0.6401738722):0.3086515215,t176:7.219047899):2.612117208):3.732118411,((((t177:6.109328492,t178:5.919709301):2.344472293,((t179:5.338848532,(t180:5.196093906,(((t181:3.456852013,t182:3.378191799):0.003569425241,(t183:1.017430905,t184:0.9800985428):2.288863398):0.9242192403,(t185:3.736457811,t186:3.687731636):0.3300229662):0.340823864):0.02511243361):0.8034608188,(t188:3.346272567,t189:3.326422461):1.586718446):2.033111933):1.575951997,((((t190:1.625452958,t191:1.568850927):2.996006909,((t192:1.324293909,t193:1.266214833):2.630921127,t194:3.877803885):0.4847425414):0.2619673774,((((t195:2.492751978,(((t196:1.603865933,t197:1.58876315):0.1335194995,t198:1.706894622):0.703777754,(t199:2.137308458,(t200:1.061649111,t201:1.05570272):1.022113895):0.2416200005):0.0455823628):0.5717309191,(t202:1.835308621,t203:1.759281414):1.083326029):0.346180163,t204:3.182835824):0.854610728,((t205:2.787601375,((t206:1.357477101,(t207:1.115343326,t208:1.088385271):0.2285478125):1.011499336,(t209:1.104784914,t210:1.100662102):1.203489131):0.3339357569):0.5054557592,(((t211:0.3460772142,t212:0.2759231769):1.528574043,t213:1.548983358):0.7128073436,t214:2.259202892):0.475350739):0.6018282149):0.2292116409):0.02634754018,(((t215:1.528914779,t216:1.409719635):0.2647555485,(t217:0.1884628146,t218:0.1519741847):1.095186708):1.292464329,t219:2.516393404):0.4788993264):3.597143197):0.8713980543,((((t220:1.997238789,t221:1.771012165):1.891624068,(((t222:2.399917669,t223:2.350007676):0.5714815325,(((((t224:0.3451058554,(t225:0.2475953115,t226:0.2111525339):0.08390753593):0.4153145974,(t227:0.5180552199,t228:0.323106108):0.1696934074):1.181800253,t229:1.521304341):0.6069076135,(t230:0.5163106091,t231:0.3844200016):1.478120273):0.1104167862,t232:1.919462133):0.182321541):0.17554393,(t233:2.150681194,t234:2.093847979):0.1108750378):0.2427353112):1.087068492,((t235:1.879626526,t236:1.840835046):0.2510919054,(t237:1.283981814,t238:1.211553142):0.7851480378):1.314861268):1.915389868,(t240:1.598776627,t242:1.121164416):3.087072584):0.5526067962):2.50194393):2.512298514):3.107799888):3.932287919,((t243:1.278772158,t244:1.232563081):10.50592197,(((t245:1.586456649,((t246:0.4338869118,t247:0.3241610966):0.8131866726,t248:1.136163152):0.2158307763):0.7370987805,t249:2.002327078):3.000602845,((t250:2.216997372,t251:2.141441676):0.8467038765,(((t252:0.9934571404,t253:0.7648509089):0.2383622808,t254:0.9320820469):1.374639335,t256:2.022439599):0.2692971569):1.939190994):6.358107521):4.819091295):0.6600337946,(((((((t257:9.43823499,t258:9.401963731):0.1555562713,(((t259:4.431841654,(t260:3.240204488,(t261:0.3329776852,t262:0.005453808243):2.882540668):1.117051893):1.728750636,((t263:0.2006132851,t264:0.1013247801):2.175075315,t265:2.192339713):3.324090678):1.481153104,(t266:6.815913901,t267:6.768455633):0.1797793793):1.853219307):0.001299790014,(t268:6.222603525,((t269:4.436985379,((t270:1.180207334,t271:1.16716183):2.200184515,(t272:2.875449209,t273:2.734080112):0.3191679775):0.900289699):0.120087374,t274:4.00589865):1.51895634):2.378626591):2.988341649,((((t275:1.180476357,(t276:0.4038272337,t277:0.3172405106):0.7598030024):4.902238064,t278:5.954981189):3.981608358,(t279:7.327502544,((t280:2.205500135,t281:2.015887869):4.735903322,(t282:6.062844336,t283:5.857766142):0.5259711047):0.3337133422):2.585989521):0.337611132,(((t284:4.731198076,(t285:4.331418733,t286:3.763756213):0.3507477461):0.8278990331,(t287:1.888745962,t288:1.782053681):3.01075339):0.7153754682,((t289:1.358714421,t290:1.308202064):2.181151004,(t291:0.3001950021,t292:0.199745984):3.184878682):1.952685776):3.275205928):0.4088457732):1.694556956,((((t293:4.457189223,t294:4.143467453):0.5436972205,(t295:1.254231313,t296:1.203859922):3.404495658):0.1550019164,(t297:2.896378396,t298:2.853545534):1.803509284):0.6424555815,((t299:3.12451584,(t300:2.143873183,(t301:0.9970496807,t302:0.9378466427):1.140048411):0.9438282665):1.200511198,((((t303:3.345055146,(t304:3.286755284,(t305:2.974551217,(t306:1.225346788,t307:1.02789868):1.73140793):0.3055354828):0.05304756103):0.4844966448,(t308:2.435053073,(t309:1.91085367,t310:1.878095777):0.4809315933):1.138384089):0.05801455061,((t311:0.1524139138,t312:0.1327796646):1.940156041,t313:2.066273619):1.401351873):0.1953741834,(t314:2.81761198,((t315:1.431035358,t316:1.400047381):0.9843067084,t317:2.352234274):0.2200496293):0.6623671157):0.1342646541):0.9313248403):4.894964865):0.4450919197,((((t318:0.2595035589,t319:0.1745928932):2.819579968,t320:2.927197879):3.975840295,(t321:5.452133748,(((((t322:1.2185607,t323:1.16999173):0.5729292111,(((t324:0.2603575231,t325:0.1529335717):0.9086695555,t326:1.026066306):0.1259238227,t327:0.6640737898):0.3171244111):1.29755207,(t328:1.691242783,t329:1.616192469):0.4952102893):0.4665406721,(((t330:0.8373739474,t331:0.8145514048):0.3871636527,(t332:0.1968277252,t333:0.1935012477):0.9526504699):0.4521359698,(t334:0.7893597356,t335:0.7859852689):0.7826160532):0.8081998101):0.3912842714,(t336:2.613646269,((t337:0.8017642208,t338:0.6608515562):0.3840935547,t339:1.016073375):1.421048662):0.136707802):1.468354231):1.303379598):2.250796475,(((t341:0.6712205953,t342:0.5197295358):0.5058339398,t343:0.6858946564):1.256549436,t344:1.844239813):4.512538357):0.1866509441):0.1269697945,(((t345:2.223723311,((t346:0.3778306908,t347:0.291942698):0.7598665965,t348:0.8864648308):1.080133305):1.297914584,t349:3.082675608):2.274002051,(((((t350:3.319097652,t351:3.2396416):0.1586042064,(t352:1.309568487,t353:1.3008154):2.016400008):0.1991775292,((t354:0.1094353997,t355:0.03296555594):0.6385519083,t356:0.4829667414):2.529025309):0.02004434144,(t357:0.9301951965,t358:0.7113706478):2.08856218):0.9735049677,t359:3.58385528):0.4828925524):0.6848520982):1.113603226):1.046232297):0.04893552751,(((t360:0.3255839578,t361:0.3169133637):0.1343540026,t362:0.4392532692):4.294417431,(t363:0.6539049758,(t364:0.5640620576,t365:0.4585860386):0.0751477204):4.07191155):2.18067563):0.1488040709):0.7037088903,((t366:5.366548455,(t367:2.051366743,((t368:1.225526911,t369:1.195035811):0.07634165883,(t370:0.6404881596,t371:0.6250368107):0.1669560603):0.7274202408):3.136225337):2.230815674,(((t372:1.072592772,t373:0.9865892452):5.308879319,(t374:3.27261269,((t375:0.6223823295,t377:0.3303811995):1.306651055,(t378:0.0435964564,t379:0.0283967388):1.479828923):1.323715751):2.906832458):0.09020276999,(((((t380:0.4111619686,t381:0.3605916585):1.113916061,(t382:1.290083773,t383:1.198532114):0.0823788317):1.940407567,(t384:0.6223123063,t385:0.5847266971):2.574566386):0.5444934088,t386:3.443073259):1.022893025,(t387:0.6770940251,t388:0.6402830994):3.722196983):0.7588651692):0.4008028003):0.003585314215):1.480942186):1.803546237,((t389:6.236826044,t390:6.203024332):0.3848637706,((t391:3.937500293,t392:3.697283403):2.311377099,(t393:3.377752925,t394:3.075224521):2.597959166):0.3256722546):1.968756516):2.028362052):3.853406147):1.959303279,(((t395:3.255949493,t396:3.206467054):2.582695331,(t397:4.316152094,(t398:3.176457095,(t399:1.608955512,t400:1.567121002):1.48352726):1.075940607):1.252095134):0.01078563796,((t401:0.9623041267,t402:0.9456321515):3.188196576,(t403:3.893467204,t404:3.505186879):0.1127770595):1.162287938):9.90556006):22.21389177):69.30931667);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T42.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
