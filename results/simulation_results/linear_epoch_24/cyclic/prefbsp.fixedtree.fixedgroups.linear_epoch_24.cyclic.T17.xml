<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((t465:0.6668488496,t466:0.655942348):36.34405729,((t467:5.12178261,(t468:3.537508669,t469:3.532783114):1.577246618):12.49738997,t470:17.40859723):19.09997908):0.574479985,(((t471:6.465575576,t472:6.458845639):0.6028749297,(((((t432:0.04354978335,((t363:0.05516574089,(t358:0.4398683394,(t350:0.01970723125,((t335:0.1616870446,(t329:0.006746629901,(t326:0.01428369691,(((t271:0.1536288583,((t257:0.06554650084,((t237:0.2829640067,(t238:0.1249054377,(t161:0.196417952,(t153:0.02005442143,(((t141:0.1998387756,((((((t1:4.751216955,((t2:1.818159419,(t3:0.6523773109,(t4:0.2226599398,t5:0.2133423862):0.2749697579):0.9885663291):2.034443388,t6:3.473104763):0.8065498862):0.795779184,((t7:2.794117431,(t8:2.45099395,t9:2.43524025):0.2435214582):0.5547763066,(t10:2.421690538,(t11:0.9843591161,t12:0.9489221916):1.322281013):0.7939396312):1.697692747):6.054123665,t13:10.79884937):0.02316254142,((((t14:3.090775755,t15:3.055636218):1.612799048,t16:4.512578333):0.4237878005,(t17:3.030546315,t18:2.860194371):1.791299339):0.9571253184,(((((((t19:0.9070984762,t20:0.8512523979):1.582490462,t21:2.370187503):0.1555178898,t22:2.241119844):0.1345603804,((t23:1.643671374,(t24:1.102677745,t25:1.086373562):0.3938802231):0.04252500629,t26:1.46111548):0.6041531405):0.4033099803,(t27:1.892547856,t28:1.797142228):0.5322408559):0.4872638241,((t29:1.528105005,((t30:0.7736969302,t31:0.6585053983):0.4212594993,t32:0.8515985629):0.3012172346):0.338958338,(t33:0.6968618394,t34:0.6698967279):0.749450485):0.8789885714):1.535700917,((t35:1.513780378,(t36:1.317330293,((t37:0.1376295086,t38:0.1225354617):0.4266729671,t39:0.3553839853):0.7507282512):0.1581449642):0.9600610831,t40:2.217442531):1.119378556):0.2134608077):4.649072863):0.3136766797,((t41:2.306547862,((t42:1.145015473,t43:1.131698622):0.9404655222,t44:1.897992548):0.1866304192):3.275632846,t45:5.352172877):2.914729258):0.03269854871,t46:8.253238401):0.6927353059):0.4591513283,(((t47:0.1021035342,t48:0.02457169172):1.118289823,(t49:0.6980386384,t50:0.6912305568):0.1983001688):7.784990055,(t51:1.824390797,(t52:0.3675534797,t53:0.3160124838):1.432127765):6.696658089):0.2029854318):0.3781896814,t54:8.98494177):0.4525262608):1.177620763):7.200123886):0.05944486313):0.4429045992,(((((t55:0.7715326412,t56:0.2861888991):2.752275768,(t57:1.594877182,t58:1.442863748):1.13400115):6.562344502,(t59:6.497035042,t60:6.385745628):2.23570908):3.189052965,((((((t61:0.587507227,t62:0.5776642226):0.2724854341,t63:0.835209556):4.390460457,t64:5.119326188):1.692044101,t65:6.710158631):0.3989917729,(t66:6.243389145,((((t67:0.3438062848,t68:0.1229080323):0.9635311109,t69:0.9413395079):2.292864777,t70:3.197700114):2.351478026,t71:5.356210847):0.2348379864):0.7914741834):1.678674605,(t72:5.889616298,(t73:1.030483234,t74:0.9392099257):4.85746059):1.93683296):2.68853215):2.836540064,((((t75:6.883311031,((((((((t76:0.1272151503,t77:0.1240025899):0.8306494037,t78:0.8558472402):2.579476486,t79:3.260105425):1.028796324,t80:4.25029645):0.00610281615,t81:4.222842074):0.177422814,t82:4.381506406):0.0763429479,t83:4.256974499):1.399659869,(t84:4.47332548,(t85:3.304770842,t86:3.302018221):1.047068443):1.163049989):0.6367692047):0.596087767,((((((t87:1.028221033,t88:0.7865773134):3.184396209,(t89:3.445968429,t90:3.348479655):0.3086407742):0.549132246,((t91:2.616035973,((t92:1.603594599,t93:1.545061641):0.5669718403,t94:2.06860018):0.2585091895):0.4875303307,t95:2.746300732):0.8643092038):0.3684668646,(t96:3.626547504,((t97:0.07007659186,t98:0.03147027787):1.22234306,t99:1.188772456):2.306646011):0.3238020442):1.026176279,t100:4.798105529):0.06833801447,(t101:0.9149100481,t102:0.8856691735):3.81107822):0.3756214529):2.197365701,(((((t103:2.593030984,(((t104:1.08214443,t105:1.077271503):0.7964182766,t106:1.725375684):0.6292545248,(t107:0.1318873025,t108:0.09938970322):2.088608697):0.07693387613):1.894263454,((t109:1.184609919,t110:1.134586749):0.5253527825,((t111:1.026761195,t112:0.9657927509):0.5002312869,t113:1.458459941):0.08180673614):2.433438831):0.1039944879,t114:3.99749236):0.5242204877,t115:4.409813747):2.041751031,((((t116:0.5999395368,t117:0.56893889):1.940407087,(t118:2.33925561,((t119:0.451709924,(t120:0.09675905849,t121:0.06703909622):0.1557305677):0.6195813754,t122:0.8390120066):1.236780931):0.1085836951):0.6685670741,((((t123:0.5145144453,t124:0.4111676258):0.8367314461,t125:1.245952325):1.145832651,(t126:0.7606106028,t127:0.7312677633):1.542947574):0.02708787394,t128:2.25636613):0.3040712171):0.3975884037,t129:2.950323164):2.830661509):0.07211318113):0.3902819166,((t130:2.060228543,t131:1.943055739):2.225032023,(t132:3.144915504,(t133:2.46887159,((t134:0.9956979927,(t135:0.6727180686,t136:0.6677206):0.3111131851):0.6368319519,t137:1.573684844):0.6635919304):0.552768656):0.8463977223):1.917702675):3.094814353):2.113470144):1.719400226):1.605075827,(((t138:3.640813794,((t139:0.9561250753,t140:0.7715268157):1.859059171,t142:2.223740871):0.7866663424):3.778914749,(((t143:0.7757747634,t144:0.6550331292):0.3412773409,t145:0.7961900504):5.412317113,(((t146:0.6629597934,t147:0.6558338676):0.6502916692,t148:1.272362535):0.1937533711,(t149:0.1584889161,t150:0.07614884515):1.139730044):4.625893765):0.143912046):5.119577228,((((t151:0.9421988929,t152:0.6695858113):1.636408608,((((t154:0.6633473838,t155:0.6560879064):0.02200789886,t156:0.6244324085):0.3125551862,((t157:0.2834193646,t158:0.2222170201):0.2371880675,t159:0.1640278988):0.3483806759):0.5975994236,t160:1.10174458):0.5888919408):5.870831703,((t162:1.854150831,(t163:1.062898966,t164:0.933700525):0.712518602):1.023696296,t165:2.535301407):3.906772545):2.433336268,((t166:1.812502021,(((t167:1.101806691,t168:1.067987697):0.01386134737,t169:0.979831374):0.5062703593,(t170:1.242857874,(t171:0.8385638437,t172:0.7222269704):0.3900056221):0.1741223737):0.1399111671):5.713451108,(t173:0.7254847005,t174:0.5356810121):6.293622259):1.276712363):0.2141458542):1.488453256):0.2868010678):0.8431557161,(((t175:1.816815134,t176:1.739642523):6.963679554,((((t177:1.085365589,t178:0.9981269784):4.899669534,((t179:2.621954801,t180:2.486728053):2.970040522,t181:5.380648032):0.2096964795):0.6453439295,t182:6.01282549):0.1647076039,(((t183:4.82985387,((t184:0.5299886786,(t185:0.2456986775,t186:0.193298217):0.1871480088):3.405832427,((t187:3.349662028,(t188:1.361507557,t189:1.265098519):1.928174932):0.106100822,t190:3.27839813):0.2709625343):0.7870649384):0.1747176212,((t191:1.424939439,t192:1.13083245):0.3443308674,t193:1.360089309):2.626409128):1.015069714,((t194:4.260286108,(t195:3.578528375,t196:3.561290526):0.6251848671):0.004757543862,t197:4.052927624):0.6126543124):0.09387810926):1.858810431):1.611709253,(t198:5.648423626,(((t199:4.098010311,(t200:2.127573137,t201:2.045461773):1.694113114):1.333016887,t202:4.966734792):0.06545119939,(t203:4.216055645,(t204:2.375696963,(t205:1.562452647,(t206:0.2281872284,t207:0.1155468787):1.331442556):0.8089886011):1.783575846):0.7602680853):0.1004639007):2.508253595):0.3519065872):1.142626686,(((t208:0.8500977625,t209:0.8211436128):3.397382554,t210:4.171211735):1.731489692,((t211:2.029800249,t212:2.005168301):3.427145635,((t213:4.774706088,t214:4.66900963):0.235630877,t215:4.849152463):0.1992545354):0.419317784):2.843025315):4.1825728):0.4079071627):0.6880028024):1.041608871,(((((((t216:0.8987315752,t217:0.8709263861):1.643448016,t218:2.366234255):0.476641023,t219:2.723781887):8.507791128,((t220:0.3239259256,t221:0.2611624595):3.526858371,t222:3.470975124):7.372000566):0.4845009467,(((t223:3.599295788,(t224:3.167283682,t225:2.982496943):0.4193290618):0.4836546977,((t226:0.3707144991,t227:0.1136561743):2.652367203,(((t228:1.402440698,((t229:0.2407138879,t230:0.1322487813):0.9369275025,(t231:0.9634788888,(t232:0.6820691389,t233:0.672059254):0.2461983358):0.1015921818):0.1287227215):0.2121953075,(t234:0.8849713281,(t235:0.607472242,((t236:0.4562671077,t239:0.05502381822):0.1096406546,t240:0.05181379794):0.0393186223):0.2583227981):0.4731734255):0.9050425016,((t241:0.4562586362,t242:0.3942242672):0.126976002,t243:0.3743861474):0.9103222015):0.1636820426):0.6658929864):2.854133351,((((t244:1.128705773,t245:0.8099883533):0.1731538006,(t246:0.1636684357,t247:0.1206708761):0.6257854774):2.070662511,(t248:1.364982399,t249:1.342973121):1.260019551):0.6140213291,((t250:0.5611367103,t251:0.4998996881):1.453046612,t252:1.814275336):1.106397391):0.8156082417):4.365713683):2.031631774,(((t253:3.299767763,(t254:1.572604373,((t255:0.5518789377,t256:0.4983158449):0.3142834401,t258:0.202750443):0.6883361295):1.721533836):0.993805942,(t259:2.000353588,((t260:0.6810469611,t261:0.09956552812):1.205206289,t262:1.267233365):0.09944894825):1.494940964):3.180156154,t263:6.013380845):2.585364548):0.3885562392,(t264:7.490306289,(t265:0.3874057407,t266:0.3093652736):7.081165633):1.49382581):0.03668581882):1.139716785):1.223994473):0.5743385564):6.41752353,((((((t267:0.902172442,t268:0.8903746777):2.002283373,(t269:0.8906617687,t270:0.823915694):1.908590215):3.718959922,t272:6.232315434):0.5145978982,(((t273:2.389870212,((t274:0.6329413973,t275:0.5166946575):1.073920768,t276:1.555853552):0.5700621037):2.921370237,t277:5.038894269):0.07279645853,(t278:0.9070847778,t279:0.83704362):4.167960119):1.214210396):0.05274525454,((t280:0.4007456471,t281:0.204790013):5.591392318,(t282:4.036732141,t283:3.782473494):1.675367704):0.2258087957):9.517288072,(((t284:9.011591161,((t285:5.58578224,((t286:1.626357053,t287:1.61674101):3.452981113,((t288:0.7665237266,t289:0.7599626154):2.921152666,t290:3.597972676):1.371468924):0.4554847848):1.715114448,((t291:5.607765369,(((t292:2.257208965,t293:2.00422698):1.678946301,(t294:2.567459709,(t295:0.1816275603,t296:0.1771506125):2.146247228):0.8388278631):1.553876153,t297:4.671683216):0.08348795166):0.5290154592,t298:5.274100628):0.6536611426):1.447391643):1.062862126,((t299:5.491824088,((t300:3.577278554,(t301:1.222774587,t302:0.8244458507):2.128844709):0.05416963307,(t303:2.238039328,t304:2.186592804):0.7395938449):1.649255276):2.487628473,((((t305:3.712886042,t306:3.525178629):0.9327143031,(((t307:1.620307602,t308:1.426926028):1.70049832,t309:2.85116836):0.8050527997,((((t310:0.6727288315,t311:0.5165747111):1.747688882,t312:2.252786786):0.001809254099,((t313:0.3967867051,t314:0.3555930625):0.8800712406,t315:1.189862293):0.6082010645):0.725244429,(t316:1.999601016,(t317:0.0914564987,t318:0.06554406344):1.833515683):0.5121702597):0.456785872):0.1514638193):0.2110709903,(t319:2.118335036,(t320:1.223577234,((t321:0.1646120674,t322:0.1575060315):0.3067904652,t323:0.4234779931):0.6487689822):0.8258057407):1.045989444):0.1619579612,(t324:2.124099159,t325:2.032316411):0.9684087613):1.820298071):0.3103884537):4.464963136,((((((t327:0.6312616271,t328:0.5513102355):0.3345553185,t330:0.5233534996):0.7549155539,(t331:0.1681276064,t332:0.1199551898):1.098129902):0.01624597658,(t333:1.061921704,t334:0.9776999339):0.07676557194):2.485461127,((((t336:0.04077780533,t337:0.0006234357789):0.7289049488,t338:0.6715486918):0.7079258755,t339:1.114426558):0.145311491,((t340:0.09576488703,t341:0.06230611399):0.5973705751,t342:0.5782685973):0.08442476776):1.174137881):4.966568229,((t343:0.6372302837,t344:0.4341568021):1.271846787,t345:1.680032347):4.799609652):0.3352830506):0.6427810612):1.318080063):0.04203574067):2.713414453,((t346:7.182293354,((t347:4.064305574,t348:4.031101534):1.993642406,t349:5.986101969):1.062882562):0.9370429913,(t351:0.0577770387,t352:0.004686873793):7.495308401):3.353049383):6.107192071,((t353:0.120411354,t354:0.1075380723):11.08344539,((t355:6.242218458,t356:6.197712859):1.344528423,t357:7.532948042):3.131860766):5.674361347):0.6610061459,((((((t359:2.232804785,((t360:0.09166608475,t361:0.07080526049):0.7405125232,t362:0.8104885019):1.101125685):3.778795405,(t364:5.006250362,t365:4.995096759):0.4176940315):1.904972941,(t366:5.963008259,t367:5.908659416):1.322467148):6.128334277,(((t368:1.475313729,t369:1.138595001):4.07644423,(t370:4.216003218,((t371:1.01064829,(t372:0.9672874712,t373:0.9053798515):0.02609142583):1.962060631,t374:2.772999682):1.221373363):0.6592247081):1.714378588,t375:6.313215787):5.985638862):0.4120943292,(((((t376:2.43395739,(t377:1.534221157,t378:1.449216576):0.8133647257):2.280362941,(t379:4.322449461,t380:4.311257466):0.1646306531):0.6401968104,((t381:2.690548715,t382:2.596988775):0.3498114286,t383:2.938849892):2.065694223):1.739728909,((((((t384:0.3101064147,t385:0.2945052421):2.135985837,(t386:0.7013353199,t387:0.6268557926):1.652496873):0.4030113176,(t388:1.822223027,t389:1.709523515):0.8277354818):2.80952831,((t390:1.530701306,t391:1.449659173):3.388185516,(((t392:2.80890169,t393:2.440403862):0.8050151676,(((t394:0.07866888764,t395:0.02370596994):1.225031391,t396:1.230169263):1.426018869,(((t397:1.070432198,t398:0.8610795685):0.8879202763,t399:1.556383796):0.5514291385,(t400:0.09084028536,t401:0.02980810841):1.952920559):0.1160659578):0.1733746148):0.9109924628,t402:3.165340724):0.263428613):0.3631069909):0.2402459386,(((t403:1.263855699,((t404:0.2889210648,t405:0.1445674185):0.4809085564,t406:0.4360416398):0.1986051871):1.519155345,(((t407:0.399851888,t408:0.3380809162):0.07652143931,t409:0.4028118042):0.9240791041,(t410:0.3783792372,t411:0.3770714205):0.7356186274):0.6801690278):1.019647061,((((((t412:0.1902529256,t413:0.1370548166):0.3269622078,t414:0.3978351664):0.862866666,t415:1.188932787):0.02627529636,t416:1.212385195):0.01874853962,t417:1.224496872):0.8766750457,(t418:0.2031505327,t419:0.2026317981):1.878746997):0.5021176675):0.1857707043):0.1427212177,((t420:0.9736552539,t421:0.8947685638):0.1577774657,t422:1.010215921):1.679920996):0.6773981312):4.10455909,(t423:1.951427561,(t424:0.6912456773,t425:0.6479078786):1.157823731):5.431643198):1.380101562):0.2804199389,t426:8.827371311):1.719596236):0.3811999938,((t427:3.224745917,(((t428:1.207000289,t429:0.9392536202):1.188348564,t430:1.933152163):0.288211121,((t431:0.6730496229,(t433:0.109467625,t434:0.003337248028):0.1946319709):0.8776604904,t435:1.050658893):0.5506240844):0.5015276661):4.240067387,(t436:2.427097953,((t437:0.5823695661,t438:0.3327654811):0.861577742,t439:1.118726039):0.9781669878):3.68039279):3.162231707):0.9951187503):5.809175109,(((t440:7.174725135,((t441:0.2172681119,t442:0.142174742):2.961821052,t443:3.099951237):3.96017871):4.801429738,((t444:2.702469608,(t445:1.024547044,(t446:0.1181311269,t447:0.1139845724):0.817750392):1.524568068):7.100757904,((t448:0.5550868021,t449:0.4712518638):7.741594414,((((t450:0.5081580108,t451:0.466933248):2.990706155,(t452:2.426595316,((t453:0.0621074908,t454:0.04161288166):2.236249599,t455:2.248092209):0.05711194444):1.013482631):4.134673624,(t456:4.487214476,t457:4.251848846):2.93961963):0.05378598511,t458:7.215763148):0.07378043247):1.158035919):2.005776376):0.108755494,((t459:2.6026057,t460:2.522244397):1.273389457,((t461:0.4738470132,(t462:0.1372956248,t463:0.09019745573):0.2909998727):0.08386353616,t464:0.4547777949):3.202826676):6.685119861):3.114475307):24.14100562);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T17.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
