<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t475:5.894657671,t476:5.627381149):9.346902461,((t477:3.077010928,(((t457:0.1226323627,((((t358:0.2166815938,(t355:0.03938744257,(((t310:0.06603578972,((t259:0.01317298249,(t251:0.3270682865,((((((t191:0.03917915165,((((((t141:0.03840849867,((t134:0.0145433016,(t130:0.002580593997,(((t87:0.04020513097,((((t53:0.03391439104,t54:0.007081379739):0.2710744823,t55:0.1264859137):0.7308565404,t56:0.6802840415):0.0210278517,((t57:0.3354165234,t58:0.3014518419):0.04368594978,((t59:0.09053965131,(t45:0.08111881513,((t40:0.08721163485,((t35:0.1410434957,(t31:0.04471091172,t1:2.455227486):0.2879653875):0.4796067316,t2:3.185070607):0.0744214619):0.4730446031,t3:3.698335465):0.01724412541):1.161714257):0.01999737344,(((t4:2.784599928,t5:2.759669214):0.4250071274,t6:3.080806818):0.7903684901,t7:3.847718762):0.790029449):0.1621249825):0.07271894426):3.581752338):2.867150014,((((t8:3.702486991,((t9:3.23907387,t10:3.205542241):0.1796484493,(t11:2.442249707,t12:2.420657344):0.9072052912):0.2567306194):0.1285200018,t13:3.554852237):0.09465376063,(t14:3.252579857,((t15:2.626492178,t16:2.601404856):0.1237035235,t17:2.500199142):0.4417120565):0.1657670367):1.501665526,(t18:1.108722309,(t19:0.3576996701,t20:0.3564199104):0.5994517803):3.483650749):5.822376691):0.263087576,(((t21:2.562151628,(t22:1.607646435,t23:1.49570951):0.89013379):1.1412556,(t24:2.661725745,(t25:2.114492179,t26:1.931283218):0.2174930746):0.7643332943):3.833092361,((t27:0.4751300882,t28:0.4313852485):3.888272855,(((t29:1.199505045,t30:1.128099959):0.1684875015,t32:1.158661795):2.507570117,((t33:0.2643927583,t34:0.2332382575):1.033198152,t36:0.9308599947):2.363873591):0.4282547031):2.344514418):2.958615687):0.445279082):0.3649752554):0.09178268833,(((((t37:1.862546666,t38:1.828732966):0.2635647893,(t39:1.184869984,t41:0.7858389207):0.9050360288):1.707646702,t42:3.343241372):0.7242341534,t43:4.021083636):4.329872981,((t44:1.06611355,t46:0.8425720467):1.333683522,((((t47:0.6585621679,t48:0.5492990826):0.09507836118,t49:0.6199342858):0.3823446177,t50:0.9669727516):0.04355593209,t51:0.9158081189):0.9379987937):5.942052702):0.8894087014):0.6978575201):0.233122603,((((t52:1.322706254,t60:0.1695887063):4.579558331,(t61:1.422558776,(t62:0.9103779195,(t63:0.5799486554,t64:0.4783276641):0.2764402579):0.3989349689):3.253578662):3.119882283,(t65:5.977662198,t66:5.969084573):1.497419222):0.4962380929,(((t67:3.442643191,(t68:2.557629448,(t69:1.29975867,t70:1.046806938):1.173560057):0.8224937518):1.494081212,t71:4.210378464):1.985941214,t72:5.966170322):1.029699694):0.091157887):0.2764865144,t73:7.311935216):1.284848084,((t74:4.937877502,(t75:3.461626507,t76:3.449263684):1.466279627):1.700031779,t77:5.868828456):1.952114297):0.8314379607,((((t78:3.647052274,t79:3.581503562):0.646385226,(t80:2.742554375,(t81:2.007136642,t82:1.898303097):0.6290893547):1.483007119):2.1512507,((t83:4.87171437,((t84:1.032928947,t85:0.6918961753):2.509671666,t86:2.86052768):1.131178174):1.268596984,t88:5.042690786):0.005495161401):1.01703737,((t89:3.469989581,t90:3.45246937):1.584713665,(t91:0.783181486,t92:0.7318009602):4.202026402):0.9898961786):1.149256696):1.51248773,(((t93:0.2734896275,t94:0.2054961137):4.874236852,(((t95:2.871571586,t96:2.829277264):0.1380626018,t97:2.548291713):1.737029296,(t98:3.403290821,(t99:1.439198258,t100:1.264147837):1.94061186):0.8807522498):0.2981300917):2.313021186,(((((t101:3.038228896,t102:3.018371528):0.2640109545,t103:3.280984006):2.29697589,(t104:3.092554514,(t105:2.64393002,(t106:0.6184809306,t107:0.5583232958):1.992560947):0.4483228916):2.480343119):6.469325516e-06,((t108:1.849467779,t109:1.735696804):2.129618348,((t110:1.656950442,t111:1.300770133):0.3761974695,(t112:1.137150864,t113:1.13182285):0.1749993742):1.801730509):1.451156444):0.968851113,(t114:3.182271264,t115:3.093750686):2.314584639):0.02378463892):1.109814005):1.647378475):2.53185375,(t116:10.37939694,((t117:1.049098897,t118:0.9618706465):2.257370891,(t119:1.575885613,(t120:0.5583897078,t121:0.3863909402):0.9092926425):1.555123051):7.066688876):0.339917186):2.693487446,((((t122:0.4692099066,t123:0.4512496818):1.14267797,t124:1.253631749):0.8621211974,((t125:0.2908455843,t126:0.2640588806):0.8475580004,t127:1.110447514):0.9768566839):8.725674958,(t128:10.3966642,((((((((t129:0.6528946565,t131:0.4712774021):0.539840052,t132:0.8463413719):0.03212342309,t133:0.8356817037):0.7352859654,(t135:0.8074783373,(t136:0.7187741726,t137:0.7034859049):0.05146281335):0.469821139):0.5374998566,(t138:0.04670361524,t139:0.02959085211):1.454188294):2.197586448,((t140:1.586885353,t142:1.314281574):0.3546926358,(t143:0.7940768019,t144:0.7794232431):0.7068118676):1.616242916):4.42843615,(((t145:1.154682881,((t146:0.2329810983,t147:0.06637874521):0.2314640429,t148:0.05386732433):0.6479594274):0.054424152,t149:0.7366354375):2.843499628,t150:3.4991621):3.328637983):1.071724113,(t151:2.093324283,(t152:0.2984509191,t153:0.09866493081):1.650097657):5.724892147):0.1394000449):0.2634474345):1.665414285):0.04274248798,((((((((t154:0.3440135712,t155:0.2082673874):0.9709926903,t156:1.164885046):2.170105128,t157:3.097102599):2.711493065,t158:5.449386885):0.2244931337,(t159:0.1897353872,t160:0.1429345456):5.456738773):0.4211532236,(t161:3.737970294,t162:3.710762415):2.073399393):0.2300353765,t163:5.930882008):1.86298059,(t164:7.608078711,((t165:0.6173958158,t166:0.6006699804):6.252186096,(((((t167:5.126708465,t168:4.917893577):0.03145088843,t169:4.799893936):0.4363932451,(t170:3.744828262,t171:3.725506171):1.329547637):0.2708744653,t172:5.299317933):0.7450908627,((t173:0.7948773169,t174:0.7795843758):4.552248369,(t175:0.3462934317,t176:0.3436589334):4.792884194):0.5147128657):0.04016283648):0.568852768):0.06798807803):0.4917604966):0.1135139705,((t177:5.820785954,(t178:0.5905682167,t179:0.5193313926):5.168656503):0.01137846474,((t180:3.167625731,(t181:2.763852672,(t182:1.591534032,t183:1.507858102):1.130135562):0.2749499308):0.3366346532,t184:3.122106686):2.052196982):1.008820345):0.09794728627,(((t185:2.363230044,t186:2.150048018):1.745910884,(t187:2.361125262,t188:2.246095929):1.374101531):1.279929129,t189:4.892392924):0.795368238):0.8047650099):0.9406737827):4.61171021,(((t190:4.112977185,(t192:3.550043678,t193:3.370741298):0.4623009236):4.357645518,((t194:0.7205137262,t195:0.6199953264):5.669428922,(((((t196:2.543250754,(t197:0.568897347,(t198:0.1796432624,t199:0.1102019704):0.3748747099):1.894116869):0.8459852485,t200:3.133189932):1.87350472,t201:4.818931858):0.4168588385,t202:5.10322343):0.09254987081,(t203:3.716943607,(((t204:2.541706403,(t205:1.982668323,t206:1.973633388):0.5347073068):0.08152298063,(t207:1.902280373,(t208:0.6387565426,t209:0.5846736474):1.234560451):0.6754173028):0.1841204524,t210:2.623461211):0.8375505278):1.428841194):0.5028551423):1.763960558):0.7116962004,(((((t211:1.689130322,t212:1.68733004):1.115641332,(t213:2.567926184,t214:2.532506376):0.05150088968):0.0845671865,t215:1.987207626):0.9600726113,(((t216:0.3912437925,t217:0.004533547336):1.970765146,t218:1.959251118):0.2003681018,t219:1.881265479):0.3599009236):1.216308873,((t220:2.322971918,(t221:0.632319328,(t222:0.329026489,t223:0.2929829424):0.1667430956):1.569589523):0.3247374549,t224:2.219901799):0.5508879729):2.760194591):2.702015637):0.03232848758):0.2241836917,((t225:2.36977063,(t226:2.006125221,((t227:1.219225599,t228:1.181456056):0.606376578,(((t229:0.3909688316,t230:0.2980492859):0.05881525874,t231:0.2470329977):0.6551349477,t232:0.8090963775):0.6287498204):0.1090011762):0.2501275505):2.326220085,(((t233:0.8651704503,((t234:0.6218311125,t235:0.3333115121):0.03769720731,t236:0.02814598577):0.1989306554):0.09239768236,t237:0.1974500468):1.242969986,t238:1.378752307):1.917794625):3.764037372):1.938374118,(((t239:0.4095307351,t240:0.3762008511):6.588427977,(((t241:1.147429282,((t242:0.866184888,t243:0.8421616774):0.08868372639,t244:0.8899249767):0.1496972856):1.311748331,(t245:0.707133484,t246:0.6609564055):1.598182151):0.2020646389,t247:2.291475863):4.212143166):0.480295097,(((t248:1.632062676,(t249:0.5177713149,t250:0.4831695176):1.013088005):0.1295220389,t252:1.050662262):1.342393625,(t253:0.2909105032,t254:0.2680210069):1.922058783):3.779285754):1.492555109):2.381632296):0.5791624071):5.829412027,(((t255:0.3735544279,t256:0.3729708691):8.415286744,t257:8.390679071):1.594051294,((t258:1.585240504,t260:1.551453313):7.186974624,((((t261:1.051995869,(t262:0.5743327885,t263:0.4755973541):0.4000819902):0.322350831,t264:1.162406189):5.493702662,t265:6.138299881):0.2912234855,((t266:3.994442682,((t267:1.016155094,t268:1.004834879):2.424283393,t269:3.406316349):0.55301233):1.126848953,((t270:2.197772405,(t271:0.02725762947,t272:0.01525680421):2.059220207):2.829787932,t273:4.904183385):0.03405594478):1.264165538):1.280438356):0.9817073103):5.864072109):1.426056749,(((((t274:6.357270682,((t275:5.046780685,(t276:1.651864825,t277:1.57598174):3.353387544):1.030099136,((t278:3.812832839,((t279:1.049351409,t280:0.9545610449):0.9569700158,t281:1.804001137):1.626149451):1.829575514,(t282:3.870074456,t283:3.787596908):1.249924261):0.2449135709):0.1859982026):0.04687482179,t284:5.361798274):0.6366509566,t285:5.928321872):3.924766027,(((((t286:0.8561003925,t287:0.8204294667):2.200124163,t288:2.94501304):0.9432328106,(t289:2.799341832,t290:2.766288623):0.9521193484):0.6182674096,(t291:0.9113395795,t292:0.8753988574):3.042227519):1.691792835,(t293:3.363483041,t294:3.301673833):2.229587082):3.355335303):4.475734084,(((((t295:2.55294093,(t296:1.680828209,((t297:0.08897369606,t298:0.05780861685):1.240602141,t299:1.228141232):0.2425726348):0.8606102779):1.121638949,(t300:2.495970055,(((t301:1.004502416,t302:0.8373605164):0.1449869783,t303:0.9434494295):0.06489967269,(t304:0.6933552502,t305:0.6318671038):0.1560587452):1.102890257):0.8204142928):1.822877983,(t306:3.971318534,(t307:3.148224765,t308:3.147607542):0.7953248747):0.547909939):0.1608533335,((((t309:0.6880973915,(t311:0.1550227079,t312:0.08116008496):0.415258458):0.9948660238,t313:1.407494081):1.588325623,(t314:2.768782201,(t315:1.355188305,t316:1.327478497):1.367877015):0.1720046197):0.5464439833,(((t317:1.851801114,(((t318:1.256946609,(t319:0.4787373786,t320:0.3883314008):0.6086410951):0.09723060779,(t321:0.1630425204,t322:0.1169807057):0.9052419528):0.06282962798,(t323:0.949905114,t324:0.8240696361):0.06688096138):0.2580254042):0.1385460329,t325:1.221406832):0.005627752153,(t326:0.1721297728,t327:0.1618083857):0.9182000459):1.26346416):0.7362206246):5.705064311,((t328:0.4971605127,(t329:0.2719909121,t330:0.1219992895):0.2202879126):1.999438125,((t331:1.585320021,t332:1.371023539):0.6954037432,t333:2.05375697):0.02755458498):6.268434694):1.948875602):0.2809257216):0.1842219876,(((((((t334:0.2698957841,t335:0.1331871818):0.4501563454,t336:0.5432922453):0.5084477702,t337:0.9142696751):1.154275046,(t338:1.793243956,t339:1.705247462):0.137267925):0.468295713,(t340:0.7148055584,t341:0.4441292115):1.488490016):2.774294466,(t342:1.901500718,(t343:0.8848899525,(t344:0.1143555943,t345:0.08808034415):0.7544635094):0.9393350142):2.791093741):1.176540449,(t346:0.6690944423,t347:0.251103484):5.037771824):3.92821841):1.977325652):3.01170191,((t348:1.234561452,t349:1.151941572):7.383323485,(t350:2.944201054,(t351:0.3018681934,(t352:0.2106272431,t353:0.1173446939):0.07051328843):2.620487769):5.452264683):5.357303012):2.034229103,((((t354:1.042490739,t356:0.7920058792):2.866813697,t357:3.47970126):2.661280334,((t359:2.539631598,t360:2.355089499):3.072983945,((t361:3.984567813,(t362:0.8040302201,t363:0.799557013):2.938377762):0.3695885723,t364:3.838556311):0.9945141889):0.1716773548):2.547549518,((t365:4.006381601,(t366:3.02233971,(t367:0.7666760413,t368:0.7063493184):2.209121045):0.90676611):3.330250513,(t369:5.704744961,t370:5.637216144):1.427324379):0.1277916467):6.118547209):0.07886148344):1.99137585,(((((t371:6.043825906,(t372:5.993800159,(t373:4.432881473,(t374:4.151197077,(t375:2.670973689,(t376:1.81069424,t377:1.7642823):0.8276053252):1.443008616):0.2263156442):1.313939991):0.02905228669):0.3203007757,(((t378:0.8513137489,t379:0.6229647436):1.281027814,t380:1.888141527):2.836131443,((t381:2.011949747,t382:1.498175186):1.511012218,(t383:2.290633987,t384:2.230537099):0.3538958498):1.197971369):0.8452320487):1.053972039,t385:5.624234607):0.7417764089,(((t386:5.256592611,t387:5.243764799):0.6782489902,((t388:3.585803818,t389:3.556643205):1.041760679,((t390:4.415708553,t391:4.271619267):0.08977502002,t392:4.26223221):0.07455794181):1.211268247):0.3033181626,((((t393:2.056312391,t394:2.031998842):0.2386268968,(t395:1.75483963,t396:1.741832157):0.3848558152):0.9613087039,t397:3.048416792):0.08989794118,t398:3.136213887):2.430208645):0.1192512116):0.8512622393,(((t399:2.135249222,(t400:1.648663242,t401:1.646886165):0.291677327):0.717457006,t402:2.540747708):0.7966006606,(t403:1.398132162,t404:1.19951641):1.849372977):2.866873132):6.299064235):9.760193848):2.856037673,(((((((t405:1.447982272,t406:1.398447925):1.568406148,(((t407:1.55237513,(t408:0.8261831871,t409:0.4805632147):0.6478112903):0.1965468568,t410:1.293655636):1.069855167,t411:2.355590705):0.1337551061):2.406868738,(((((t412:1.320429762,t413:1.317143272):0.8074182478,t414:2.105855733):0.4688271333,t415:2.555739109):1.542926423,(t416:3.591187037,(t417:3.407209167,(((t418:1.389645315,t419:1.333155862):1.31312142,t420:2.559182184):0.01123612155,((t421:1.740347724,(t422:1.600134455,t423:1.455610944):0.0004493088825):0.2358198739,((t424:0.1286408231,t425:0.02791068057):1.163597024,t426:1.166154103):0.3750466549):0.188517564):0.6129876644):0.0665088637):0.4813467721):0.2264428937,(t427:2.496020072,t428:2.484628431):0.5540429033):0.404462792):1.590942091,((((t429:0.9461353523,t430:0.9091961942):0.76634825,(((t431:0.6620721797,t432:0.60210386):0.5262481594,t433:0.9585397522):0.1312661357,t434:0.916839721):0.06269101324):1.471658772,t435:2.402842969):1.721885423,(t436:2.571805997,(((t437:0.545194375,(t438:0.1881861181,t439:0.1618999543):0.2343605384):0.02410954133,t440:0.4110206548):0.9660942492,((t441:0.8094204348,t442:0.5008929889):0.01098671974,(t443:0.400845316,t444:0.2651605725):0.1016094896):0.5567030966):0.9964831092):1.421411315):0.05302090144):7.42407072,(((t445:1.210874396,(t446:0.5651248722,t447:0.5450366629):0.2957824944):0.212321179,t448:0.9780423428):3.145057336,t449:3.994878362):6.165738408):2.720855733,((t450:6.935644022,((t451:0.1998698723,t452:0.1443070287):0.5153906568,t453:0.6447449496):6.055853308):0.907875507,(t454:2.852108942,t455:2.8438223):4.599890211):4.960680938):6.995611954,(((t456:4.548845773,t458:4.360931908):1.523426392,(t459:1.073421562,t460:1.052856015):4.794330502):2.668620751,(t461:6.830662519,t462:6.747126721):1.680394896):10.55065673):0.6248045037):47.95897244,(((((t463:0.6135399586,t464:0.4270561722):0.3887451586,t465:0.4178394908):7.932191674,(t466:0.4122438576,t467:0.2501839466):7.853141872):2.070737317,(t468:2.210471474,(t469:0.2652654532,t470:0.2345291148):1.721974644):7.827663295):5.110801729,((t471:1.048843871,(t472:0.7160069405,t473:0.6433437926):0.3221044257):6.380458285,t474:7.247448222):7.433234659):51.39305743);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T80.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
