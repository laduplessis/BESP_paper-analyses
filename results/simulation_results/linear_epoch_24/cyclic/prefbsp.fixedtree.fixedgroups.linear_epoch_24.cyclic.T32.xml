<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t485:3.894912555,t486:3.894261745):1.918884456,t487:5.791862141):0.5470641871,((t488:2.816921053,t489:2.804692451):1.852605328,t490:4.654666314):1.564623832):3.441985564,(t491:7.758729621,((t492:1.229135112,t493:1.038298185):0.3642915331,t494:1.392691441):6.164945507):1.90078131):1.208184479,((((((t495:0.6422024411,t496:0.5718747768):2.661349797,t497:3.152443005):0.1706351146,t498:3.302547504):0.5289173723,(((((t467:0.1197994516,(((t399:0.08785312603,(((t362:0.04453689314,(t354:0.006025174293,(t352:0.03277378337,((t330:0.04290530426,((t293:0.203776975,((((t227:0.01324134617,((t150:0.03364955831,(t141:0.2486892354,((t39:0.0009028331198,((t36:0.08254622086,t1:3.898775874):0.1633172434,((t2:2.564606707,t3:2.468395795):1.28518617,t4:3.71443941):0.1970665171):0.0281908243):0.6300346742,(t5:2.052480657,t6:1.922184538):2.348394056):9.758994825):0.8334021539):1.488402219,((((((t7:4.479421898,((t8:0.2879857721,t9:0.1754364807):3.50366587,t10:3.590687008):0.5777877349):2.143575649,((t11:4.718149049,((t12:1.496117719,t13:1.492759124):0.2011098994,t14:1.680785627):2.99143095):1.305945253,(((t15:3.11976272,t16:3.005094925):0.302279573,(t17:1.456965592,t18:1.281682406):1.693560264):1.5009215,t19:4.013665977):0.9931220896):0.2621327132):5.257646253,(((((t20:0.581952054,t21:0.5701815146):0.4616236118,t22:0.8982210135):0.6019799601,t23:1.463267479):0.3488635197,t24:1.807701015):4.100423333,(t25:2.173589564,(t26:0.5426181763,t27:0.5261346944):1.600863892):3.694971176):4.372463706):1.729802011,(((((t28:0.9082113856,t29:0.8819542274):3.905020353,(((t30:1.871333933,t31:1.775796094):0.6566230377,t32:1.482069336):0.06480008453,((t33:0.309818714,t34:0.2169133346):1.101468316,((t35:0.4898747076,t37:0.2839855814):0.3202516068,(t38:0.509383824,t40:0.4479023948):0.06616721697):0.4610585105):0.06120944358):1.936850952):4.229174944,t41:7.088098262):1.435447588,(((t42:2.264949759,t43:2.172006382):0.4370621028,t44:2.33325114):3.78469064,(t45:3.036953221,t46:2.943110358):3.03958919):1.665099242):1.347116847,((t47:1.155242469,t48:1.003743283):0.7647113738,(t49:0.6516734,(t50:0.2502483074,t51:0.1555305733):0.318022221):0.9859035491):7.014019796):0.09865775921):1.242037422,((((((t52:0.7269055412,t53:0.6409442398):1.780297179,t54:2.192622183):3.211091035,(t55:4.266472938,t56:4.235882083):1.016052642):2.579235318,(((t57:5.375091278,t58:5.098416513):0.8108737079,((t59:0.548775651,t60:0.5080591161):2.907348524,t61:2.976242615):2.39238364):1.333937854,((((t62:3.599178234,t63:3.575203329):0.3242289555,(t64:0.06513831009,t65:0.001537220453):3.824579991):1.018205317,((t66:2.711420844,t67:2.663151413):2.038899904,(((t68:0.8854521222,t69:0.8727567431):1.239364298,t70:2.090328029):1.571804761,((((t71:0.9698363926,t72:0.9242094268):0.0568030513,t73:0.7533908226):0.7141806435,(t74:1.072378137,t75:1.04215684):0.3805247029):0.230619996,t76:1.492618278):1.611358685):1.002715163):0.01129730076):0.7226172777,t77:4.788573278):0.8763484711):0.138839413):1.271820499,(t78:3.870005492,t79:3.798559043):3.021320339):0.003670351451,((((t80:1.731944248,t81:1.716772803):2.393609496,t82:4.080006553):1.302195568,t83:5.367662253):1.060092726,(((((t84:3.698219905,((t85:2.304554785,(t86:0.5537595616,t87:0.4969993883):1.616582548):0.6318784123,(t88:1.930875909,t89:1.902928282):0.5458494347):0.7561231348):0.4609330589,t90:3.517081101):0.2110675147,(t91:3.436579588,t92:3.316478609):0.2857332439):0.3404757465,t93:3.890021874):1.451361379,(t94:2.820848309,t95:2.820486678):2.506271117):0.2627441031):0.2588455463):0.07265345733):0.706441331,t96:6.614686651):0.6757799079):5.327903525):0.2958267326,(t97:3.765211486,t98:3.654493147):9.147835617):0.001356365993,((t99:7.845694177,((((t100:1.903333723,t101:1.847407507):0.8920195439,t102:2.734405047):1.529905973,(((t103:2.758419878,(t104:2.546325859,t105:2.437819126):0.1449614707):0.197006783,(t106:2.496279749,(t107:1.066990514,(t108:0.8028050995,t109:0.7593492436):0.1791785507):1.414252898):0.2129602703):0.3605198165,((t110:0.4172587036,t111:0.2512588207):2.143762096,(t112:1.798116922,(t113:1.173600836,(t114:0.3183562285,t115:0.2931449707):0.784128541):0.6131500972):0.5023567855):0.259862239):0.8664731764):1.933489892,t116:4.972392714):1.560556568):4.277343969,(t117:4.649209184,(t118:3.876461656,t119:3.685139553):0.6397654755):6.103139333):0.5180346415):5.594466202,(((((((((t120:0.1575382562,t121:0.05711620677):0.1087357713,t122:0.05793747952):1.753426901,t123:1.632789026):0.4920884468,((t124:1.013610214,(t125:0.5487499613,t126:0.3669464932):0.4530231397):0.03725210486,t127:0.8472268523):0.997395934):0.8717042703,t128:2.462559596):9.975627405,(((t129:2.223581453,(t130:2.004509379,t131:1.802978836):0.1962222392):2.441613237,(t132:0.5114903989,t133:0.4477860442):3.86433836):6.686845621,(((t134:2.042306445,(((t135:0.3718687157,t136:0.1140097748):0.6814957697,t137:0.7850937759):0.7615919713,t138:1.395156086):0.08661522594):1.320322991,((((t139:0.4435953174,t140:0.3936804708):0.2800998879,t142:0.2059457063):0.763826719,t143:0.9695456944):1.057929599,((t144:0.1679713381,t145:0.07607438928):0.01873694838,t146:0.005525912285):1.66798221):0.2458079875):0.7747458748,t147:2.552785846):6.524919716):1.065862988):1.710546268,((((t148:0.6307246006,t149:0.527495476):7.129167533,(t151:6.762604122,(((t152:0.4534628895,t153:0.2788073375):0.02570795887,t154:0.2629468252):2.486198297,t155:2.669798373):3.734956554):0.7128105107):0.279288168,(((t156:0.06724804033,t157:0.06051942286):0.6049935761,t158:0.6256952644):4.436357269,((t159:4.329342094,t160:4.209136788):0.5027761702,(t161:4.339689498,t162:4.238180819):0.3051702301):0.2069786352):2.139955881):3.15930838,((t163:6.144235848,(t164:3.992005427,t165:3.89315362):1.837101857):2.692195896,((t166:1.759425009,((t167:0.0683887073,t168:0.04592282727):0.3053641067,t169:0.2999276135):1.216718545):6.147653789,((((t170:4.130161451,(t171:2.209200845,(t172:1.674847308,t173:1.525322011):0.4685574226):1.86237433):1.49746138,(t174:5.036926467,(((t175:0.386257891,t176:0.3014097841):1.539842303,t177:1.730647849):1.082195012,(t178:1.608090045,t179:1.582872688):1.164424311):1.850112422):0.1951443787):0.9548605481,((t180:4.843339978,((t181:0.4635197622,t182:0.1956081268):1.485923251,t183:1.575710625):2.800844834):0.2242681267,(((((t184:0.7589055722,t185:0.7130138882):0.7990436645,t186:1.100088769):0.3649045699,t187:1.46038839):0.6464228511,t188:1.94326506):1.348988559,((t189:1.787010485,(t190:0.7773387915,t191:0.7333247972):1.005506223):1.424982994,t192:3.155999575):0.02843896788):0.6244878179):0.3673214614):0.569415731,t193:4.718753938):0.4857947545):0.3744224268):1.20255056):0.619500871):0.6081510141,((t194:2.088456715,t195:2.031001973):4.867550435,(((((t196:2.39875044,t197:2.398501186):0.9887572105,t198:3.386941863):0.5726583663,(t199:2.989014169,(t200:1.373548341,(t201:0.9553379966,t202:0.8973647981):0.3677352332):1.603853908):0.8548408907):0.7417701031,(((t203:1.690143472,(t204:0.7861801658,t205:0.7840847668):0.8785333492):2.544307934,(t206:2.586508868,((t207:1.932620851,(t208:0.5362957607,t209:0.532537748):1.377507216):0.2789814823,(t210:2.119046833,t211:2.086257956):0.04746425695):0.3715581554):1.417288579):0.04490701071,t212:3.758592251):0.1674545722):0.1975559997,(t213:2.861769654,t214:2.637432295):1.201352111):1.750217187):0.9456186573):0.367032943,((t215:2.575586226,((t216:0.3716596043,t217:0.1422452255):0.9598979097,t218:1.029962325):1.106712601):0.2678866888,t219:2.007505008):3.918384274):0.08935630245):0.7493397204):2.1653591,((((t220:1.802810022,t221:1.757463246):1.317306688,t222:3.065146804):0.7343522803,(((t223:2.206018429,t224:2.19260137):0.1492296336,((t225:0.887228622,((t226:0.2283402669,t228:0.004730772818):0.352075546,t229:0.3502851852):0.2970966769):1.288470212,((t230:0.4566058697,t231:0.3530637504):0.5316983355,t232:0.7098384788):0.6941924425):0.1582434857):0.06269379194,t233:1.562155865):1.379764328):4.365289426,((((t234:0.3361393324,t235:0.01728634063):1.335798281,((t236:0.3616367856,t237:0.2532564023):0.8148143549,t238:0.7906536474):0.02266940058):0.470133331,((t239:0.6425065582,t240:0.5909735163):0.1030441548,t241:0.6309413351):0.4193337886):3.522600875,((t242:0.2793720304,t243:0.192417216):1.991612502,t244:2.167911164):2.279508471):1.438823334):0.700610908):0.5233058937):0.1871889649,((t245:0.1241922298,t246:0.0884401746):1.516720699,t247:1.374689706):5.55457578):2.477745535):0.1206040179):0.2159200159):0.1552054568,((((t248:0.7246374937,t249:0.7002060481):8.256514332,((((t250:0.8183491837,t251:0.7544448642):6.714079909,(t252:3.55355218,((t253:2.096296285,t254:1.803474355):0.4646469456,t255:2.025820407):0.973968316):3.899764016):0.571441048,(((((t256:1.190207315,t257:1.15981576):0.5369553144,t258:1.65321564):1.656489235,t259:3.114111373):2.98318247,(t260:0.2979462817,t261:0.2946179155):5.642374055):0.5893097193,t262:6.257409809):0.4722700183):0.3788862018,(t263:4.432002934,t264:4.391794168):2.50619549):0.4320885404):0.05291581733,(t265:1.230406776,t266:0.9733917303):5.989520564):0.3816473611,(t267:5.485941629,t268:5.46317294):1.733491991):0.4016925102):0.03338695599,((t269:0.9345762989,t270:0.7636611386):5.346635756,(((t271:1.300350256,t272:1.296838952):4.293300566,(t273:3.953013198,(t274:0.6957078859,t275:0.6822283556):3.241666488):1.59347739):0.2342673121,(((t276:3.16760319,(t277:3.098019351,t278:2.986260936):0.01785164533):0.8066194359,t279:3.748567958):1.61023566,(t280:3.635976475,t281:3.62785803):1.610942864):0.1518787306):0.2308590812):1.328835737):3.322013151):6.807733669,((((((((t282:2.83180416,t283:2.805006306):1.47893432,(t284:2.40018687,t285:2.390385654):1.809590785):2.226238147,(((((t286:3.228173206,(t287:1.948597529,t288:1.830166322):1.129179569):0.5193461242,t289:3.458377363):0.07604087017,(t290:2.753497824,t291:2.6339817):0.7625256453):0.8498035708,((t292:3.669701706,((t294:0.4122096546,t295:0.294745495):0.6954046705,t296:0.9571355783):2.283878192):0.291444572,(t297:1.889068917,(t298:0.426452107,t299:0.4170728956):1.382842802):1.638419762):0.1418844755):0.3811625592,((t300:1.671632614,t301:1.667858325):1.731905811,(t302:0.3891612453,t303:0.2857334552):2.932088018):0.3852683333):1.291146752):1.623245495,(((t304:3.983634937,((t305:1.672812364,t306:1.639804028):2.1789563,((t307:2.693592309,t308:2.630676151):0.7562675574,t309:3.377433449):0.355015378):0.1017503762):1.059359171,t310:4.862809945):1.187480293,(((t311:4.724440445,t312:4.622605403):0.1494727977,((((t313:2.379094214,t314:2.355620332):0.3182320693,(t315:0.7627076809,t316:0.729928581):1.77136046):1.798337347,((t317:2.438436321,t318:2.429833105):0.2925128867,(t319:2.325898154,t320:2.254497639):0.3841175254):1.496600673):0.2369924544,(t321:3.780034159,(t322:1.476036211,t323:1.428134202):2.262329542):0.5629313475):0.03390572954):0.1315379983,((t324:3.210562822,((((t325:0.4647667753,t326:0.3192310432):0.2005243439,t327:0.2648228438):0.9727796602,t328:1.110318758):0.6986940584,t329:1.723047659):0.8163795004):0.9952201261,(t331:1.675829231,t332:1.152109531):1.517178223):0.2087230009):0.9593086632):0.06544418913):2.033962096,(((t333:0.2127169506,t334:0.152299055):2.01994814,t335:2.041125374):2.173053832,((((t336:0.4641244815,(t337:0.2318714804,t338:0.183705292):0.1546103634):0.669170143,t339:0.8938226884):1.05290558,(((t340:1.094582922,(t341:1.047694385,t342:1.008569426):0.0348685264):0.3568878856,t343:1.383022674):0.003862968843,(t344:0.6244893095,t345:0.6203989645):0.4200593463):0.4080028235):0.1069554999,((t346:0.974669443,t347:0.8848713367):0.08082221307,t348:0.9629879841):0.3325243608):1.748301983):1.47646264):0.5368808453,((t349:1.002890775,t350:0.8989927156):0.4929438812,(t351:0.8796051919,t353:0.7166336455):0.4959169479):3.116031298):3.792178415,(t355:3.711899823,t356:3.694393573):4.255408025):1.083204762,((t357:8.235137691,(((t358:3.267135333,(((t359:0.511327064,t360:0.511146041):0.2306897909,t361:0.7382624259):0.4561599923,t363:0.9884669286):2.042934869):3.053027683,((t364:0.1898115738,t365:0.1788774179):3.336997994,t366:3.359699011):2.490331536):0.8443852584,(((t367:0.9081399362,t368:0.7594585326):1.100237918,((t369:0.3474887003,(t370:0.249957682,t371:0.2044709687):0.006050056267):1.226788305,(t372:0.2041174244,t373:0.148197182):1.180617871):0.2401355918):3.790186592,(((t374:1.71815839,t375:1.646099757):0.2338783582,t376:1.864719572):3.138334321,(t377:1.524177425,(t378:1.277002494,t379:1.188541482):0.1069664121):3.473536675):0.002623620618):0.8941093734):1.053796077):0.4933866245,t380:7.082639675):0.3018874265):1.431484307):0.256492354,(((((t381:4.640746183,(t382:3.949942724,t383:3.865372591):0.6849645016):0.2501150686,t384:4.699056379):0.1093486845,(t385:1.216582939,t386:1.174767328):3.544880619):0.439825738,(t387:1.853382983,(t388:0.4931530216,t389:0.357833973):1.271891155):3.064535739):1.577977668,(t390:0.5421008661,t391:0.2526520526):5.614366882):1.763669021):0.2670157505):1.267538524,((t392:6.031328282,t393:5.967881664):2.285245958,(((t394:0.1293239127,t395:0.1264111222):5.340940453,(((t396:1.505416535,t397:1.449394033):0.3624050806,t398:1.771638164):1.722149368,t400:2.787578713):1.819347444):0.04695623997,t401:4.652585412):2.610685204):0.7468469641):0.6481109974,(((t402:5.367416061,(t403:4.675349314,t404:4.673176843):0.6853105366):0.009381447978,((t405:4.388754008,t406:4.374636155):0.06329060852,t407:4.204686046):0.7884056594):0.2106739993,((t408:0.8905411311,t409:0.6098547876):2.495892972,t410:2.86937136):1.806946424):3.067113286):0.6998196918,((((t411:1.916253635,t412:1.837599233):1.549252143,t413:3.369157476):0.1661381123,(t414:1.257174138,t415:1.131697865):2.208123198):1.29537472,t416:4.613975925):3.497430343):0.5097932509,(t417:2.95870061,(((t418:1.150854781,t419:1.133733338):1.231835365,(t420:0.7804660838,t421:0.7504143183):1.584732196):0.3848208064,((t422:1.956535079,t423:1.929955649):0.07006603164,t424:1.963776023):0.6157294791):0.054980126):5.610164278):3.296257226):1.781824695,((((((((t425:0.245064101,t426:0.1577665143):1.017406819,t427:1.128056359):1.896186552,t428:2.734276978):0.4928500469,((t429:1.710839479,t430:0.9627578858):0.7674886903,(t431:0.8171416458,t432:0.5713750391):0.8550214333):0.3932732423):0.4803686619,(t433:0.1914087216,t434:0.1076871421):2.085962545):3.608713498,(t435:2.149943684,t436:1.968636039):3.590013918):0.07720917282,(((t437:2.22846462,((t438:1.453446659,t439:1.447088163):0.5283158941,t440:1.943995529):0.173087909):0.03354274,t441:2.063849116):1.43255695,(t442:2.591943233,(t443:1.786665263,((t444:0.2137029644,t445:0.1549822695):1.036644533,t446:1.179765929):0.5184952632):0.7702362504):0.8526080383):1.896940039):4.036042975,((t447:3.530659077,((t448:1.372709213,t449:1.188333307):1.505303428,(((t450:1.014225439,t451:0.8999477674):0.5585834173,t452:1.407731112):0.7818581406,t453:2.060384535):0.1192310915):0.5416151209):3.271416767,(t454:0.2092355574,t455:0.0204295051):5.630742778):2.417652551):1.445317863):0.2891653261,(((t456:0.4431639865,t457:0.4064658109):0.1629416908,(t458:0.5149947757,t459:0.4375023733):0.01318597054):1.068631866,t460:1.489669624):8.111321267):4.581478948):16.96897066,((((((t461:0.4057959938,t462:0.2901720689):5.987014253,t463:5.87274222):1.695546388,t464:7.339385554):1.93918531,(t465:0.7998775915,t466:0.6922965991):8.370420088):10.44054748,t468:19.30799294):8.049880368,((t469:2.551246184,(t470:1.019323871,t471:0.9062190462):1.383082999):6.328660699,((t472:1.072982352,t473:0.753719461):6.994344382,(t474:0.9326977058,t475:0.8942031501):6.80301137):0.4613499827):18.45931095):2.625349421):9.393372351,((((t476:1.604503649,t477:1.593596888):5.784537299,(t478:1.821578559,(t479:0.7500508016,t480:0.7274093342):1.005698715):5.203112422):0.1095382738,(t481:5.925257866,t482:5.813394749):1.055032394):2.106897967,(t483:0.5235810753,t484:0.3171455253):8.396279312):28.96324261);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T32.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
