<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t493:0.723598835,t494:0.6595392166):0.5257326613,t495:1.184582893):0.8355916072,t496:1.984164105):66.28429186,(((t497:1.435828778,t498:1.372768605):29.38178144,((((t499:6.001501708,t500:5.900758115):2.181014833,((t481:0.07986445748,((t471:0.01333446498,(t436:0.01633711953,(t431:0.05755116714,(((((((t320:0.0194670045,((((t208:0.05273428569,((t108:0.1041684735,((t58:0.008934657384,(t37:0.006946312661,(t1:2.271630523,t2:2.260333025):0.7112426895):1.987177797):0.7852236701,((t3:2.985300493,((t4:1.365106321,t5:1.360393642):1.351346074,(t6:1.419139972,t7:1.388596807):1.245664195):0.2210248416):2.515015498,(t8:3.773510601,(t9:1.631034799,t10:1.568401385):2.091433736):1.594313404):0.2296303473):4.165354725):5.577802152,(t11:4.23610473,(((t12:3.004359731,(t13:2.178248879,t14:2.055887676):0.6222742844):0.6966599144,t15:3.254256754):0.1652377082,t16:3.378804073):0.3471036781):10.95496657):4.754433373):5.381205116,(((((((((t17:2.865406412,t18:2.746430984):0.03083237171,t19:2.69400384):5.351418104,t20:8.025759519):3.379466658,((((t21:2.479199366,(t22:1.881767414,t23:1.859719926):0.3440946744):1.171654469,(t24:2.575037056,((t25:2.03955394,t26:1.946976177):0.3381202552,(((t27:1.862409566,t28:1.849090484):0.05239591509,(t29:0.8797489667,t30:0.8155197279):0.9579746271):0.1631734789,t31:1.890359985):0.07630399465):0.06420290845):0.5647904664):1.309892104,(t32:1.229601896,t33:0.8802047063):2.507522675):2.36594134,((t34:2.829471194,((t35:1.411942831,(t36:0.2469384135,t38:0.1037599715):1.047316281):0.0006523199027,t39:1.02949704):1.406007608):2.833365225,((((t40:0.1420496107,t41:0.1169487099):0.2677750285,t42:0.3325324474):0.4582737197,t43:0.5910211251):3.571542697,((t44:0.1469167547,t45:0.06232787824):1.194391935,(t46:0.9610429988,t47:0.9510068162):0.1744677922):2.770969014):0.7418187768):0.08796660413):3.976229027):0.5499158326,(((t48:1.430194448,((t49:0.2794893552,t50:0.2505090558):0.6624705327,(((t51:0.4536906357,t52:0.4339762206):0.08234822477,t53:0.5070620931):0.1310292387,(t54:0.463643547,t55:0.3103162821):0.0887047077):0.2442591062):0.4617895519):3.401841355,(t56:1.419860653,t57:1.031910641):3.082792208):2.740164962,((t59:2.947058444,(t60:2.785992155,(t61:2.123972018,t62:2.099968865):0.6522681303):0.02539109628):1.646917086,t63:4.261346023):1.883899795):1.39627308):0.7286363069,(t64:5.893565792,(t65:5.751520764,t66:5.716846156):0.1190487543):2.201943032):9.335454473,(((((t67:0.6821778896,t68:0.669711072):6.824096314,(((t69:5.047453467,(t70:2.698495698,t71:2.527395187):2.165996544):1.77908026,(t72:1.099324243,t73:1.062853333):5.044620566):0.4358685022,t74:6.474595172):0.06217723095):1.373433961,(t75:0.3427211263,t76:0.2223141079):7.507565187):0.5656060709,(((t77:8.058907855,((t78:6.541452557,((t79:2.527331108,(t80:2.321322899,t81:2.115220994):0.1320509442):3.453822623,((t82:4.101008793,(t83:1.224965526,t84:0.8154290441):2.823770859):0.4954713771,(t85:0.837609731,(t86:0.3301152675,t87:0.2682969458):0.4353657135):3.286766895):1.073323914):0.5339606836):0.4128777319,(t88:4.147891823,t89:3.875532274):1.814349078):1.09609587):0.07206707666,(t90:1.884488906,t91:1.861281617):4.653563508):0.05375659332,((t92:2.47736641,t93:2.414750073):3.626265504,((t94:4.943188335,((t95:4.338991714,(t96:4.057416018,((t97:1.858050533,((t98:0.2236573414,t99:0.2181134291):0.6197478845,t100:0.8189096857):0.9473294616):1.814374844,t101:3.517471232):0.360137033):0.2256716825):0.3299654512,(t102:0.5621171182,t103:0.5351428169):3.822198471):0.0914528551):0.5063316653,(t104:3.537025412,((t105:2.164548067,t106:2.119167175):0.7320171599,t107:2.76256337):0.5719617237):1.345760844):0.5109222757):0.3510053509):0.005714149664):7.06037175,(((t109:1.379351867,t110:1.280308145):9.199855503,((((((t111:1.029406647,t112:1.000531333):3.545716551,t113:4.488571304):0.7397253999,((((t114:3.396483535,t115:3.269151229):0.0597722196,(t116:2.544920181,(t117:1.310830466,t118:1.098750463):1.093937782):0.7296568302):0.3430058318,t119:3.158999974):0.6370188852,(((t120:1.65521952,(t121:1.205668059,t122:1.067753494):0.189478029):0.5191020198,((t123:0.6236053629,t124:0.3691147275):0.3768992694,(t125:0.2548661923,t126:0.1670306904):0.3381051813):0.6766738999):0.8806631855,(t127:1.681189884,(t128:0.8369693442,t129:0.8260062367):0.8170713654):0.3745093862):0.39306404):0.7162540388):0.8578448109,(t130:2.720492924,(t131:0.5222016695,t132:0.5221413585):2.131915757):1.189516817):1.492213251,(t133:1.854564058,((t134:0.3109459484,t135:0.2663259495):0.2121749356,(t136:0.1730735296,t137:0.02967238085):0.06506186895):1.281761926):3.455743935):0.9695268994,((t138:1.517617466,((t139:0.8608935663,t140:0.4530103399):0.3920686692,(t141:0.3223428659,t142:0.2896108058):0.5091198593):0.1698834127):1.187467586,((t143:1.741703015,t144:1.607686624):0.03986312752,(t145:0.1704379219,t146:0.1524495745):1.453498199):0.02820677328):2.978793156):1.802874096):1.513322482,(t147:3.296978275,t148:3.189391021):4.408613968):0.1205500697):0.8160945725):1.117619085,(((t149:6.444245356,t150:6.366184911):1.647215004,(((t151:7.570942022,(t152:1.737215263,((t153:0.7138325976,t154:0.5107503038):0.1469662362,((t155:0.4008546653,t156:0.3469825051):0.06339649791,(t157:0.06307264488,t158:0.03313044483):0.301852447):0.09577247841):0.7134692195):5.762099269):0.08284294029,t159:6.925238884):0.072459405,((t160:0.3809852056,t161:0.3142911429):5.713054274,((t162:3.288229224,((t163:0.8318044888,t164:0.7354992917):1.578025638,t165:2.105168552):0.8581904103):1.920336726,t166:4.673832579):0.8107560119):0.7067729059):0.2289836225):1.17333903,(((t167:0.8767641643,t168:0.6272885092):1.618905728,t169:2.197085021):0.08112683072,t170:2.06147578):4.905867349):0.2969987212):0.7746420472,(t171:7.340788347,(t172:0.116653265,t173:0.1029892648):7.167735708):0.2406537813):0.6795105333):1.756979208,(((((((t174:3.651787745,(t175:0.8793883944,t176:0.8386393405):2.675167369):0.9149365584,t177:4.354769372):0.9839415757,(t178:1.467479856,t179:1.456787589):3.769753427):0.9721729301,(t180:4.335787322,t181:4.198241034):1.847553975):0.9923323849,(((t182:6.099981093,((t183:4.494727339,t184:4.35905069):0.3418844287,((t185:3.672781631,t186:3.543710184):0.1456913261,t187:3.579483931):0.7046509418):1.253409701):0.1814505057,t188:5.654540128):0.5215337098,(t189:3.489088363,t190:3.355364327):2.575232106):0.1941842248):0.01216721533,t191:6.031723516):0.6357562062,(t192:1.280223909,t193:1.204688463):5.117162172):1.688206553):2.120941192,((((t194:1.911712819,t195:1.779658255):3.788974313,t196:5.496369751):0.1263303804,(t197:0.184188385,t198:0.1125745173):5.418625014):0.7191595847,((t199:4.635730543,(t200:1.947280705,(t201:1.297780441,t202:1.189880369):0.6379476086):2.546989372):0.275870598,(t203:2.734096247,t204:2.721806607):1.812956153):1.291096506):3.575359397):1.00320243):2.569725807,((t205:5.762149562,(((t206:0.1389925899,t207:0.134669309):4.493325332,(((t209:3.971724805,(((t210:1.642436784,t211:1.469227466):1.969157902,(t212:2.855688929,((t213:0.7308033907,t214:0.7120360561):0.1768296509,t215:0.85426417):1.925544002):0.5431303024):0.0744271703,(((t216:0.2694150696,t217:0.2481731984):2.061939458,t218:2.288499516):0.7527801617,t219:2.97277191):0.2056861119):0.1890949799):0.03385391832,((t220:1.446603113,t221:1.154133683):1.703902719,(((t222:1.093098485,t223:1.069308311):0.7335914544,(t224:1.133065264,(t225:1.072765297,((t226:0.2674395238,t227:0.2451244742):0.3637411714,t228:0.4354549231):0.4275425226):0.05700391121):0.2948713666):0.8766159267,t229:1.724642292):0.1420862413):0.1880223565):0.3258944055,t230:2.330977729):0.1078068473):0.8735192625,((t231:0.5783262672,(t232:0.04287037449,t233:0.04105028053):0.5156458392):2.2509852,(((t234:0.5267266178,t235:0.5157713129):0.9899859429,(t236:1.304000524,(t237:0.5070854547,t238:0.4131485396):0.6698026236):0.1766055279):0.9033408399,t239:1.894136136):0.3672785108):0.3693320126):0.2165274644):0.7000162971,((((t240:0.151035401,t241:0.06540854686):1.412466105,t242:1.425164168):0.04247056047,(t243:0.5506720285,t244:0.4726851539):0.537884537):1.131333879,t245:1.776358445):0.7815042368):6.508659746):0.4507749266,((((t246:0.7224470635,(t247:0.2495445504,t248:0.2332929505):0.4353430695):2.446574584,(((t249:0.4948640559,t250:0.4255995099):0.326602568,t251:0.6803726904):1.346744044,t252:2.023998417):0.8839855385):0.8006285635,(t253:0.1044134607,t254:0.06672041091):3.543175384):5.456720208,((t255:4.345173709,(t256:0.7435509479,t257:0.7206233237):3.478134946):3.53266023,(t258:4.029539085,t259:3.961750647):3.483177205):1.144994658):0.03191523598):0.9331193685,(((t260:8.384662773,t261:7.85114651):0.2452000692,(t262:3.753749894,((t263:0.4295349167,t264:0.3499055658):1.198339013,t265:1.53459244):2.107300147):4.322258545):0.1034491329,(t266:7.307706043,((t267:2.312084639,((t268:0.2888116823,t269:0.269397656):1.018093501,t270:1.035612033):0.9191490792):1.355102311,t271:2.988950959):3.608745242):0.7526257108):0.7247265055):2.002979036,(((t272:5.778563423,(t273:0.5499081561,t274:0.3926725323):5.221383767):2.488088508,((t275:5.700165765,(t276:4.911546837,((t277:1.702748776,(t278:0.30603908,t279:0.3056660635):1.37336672):2.561582992,((t280:1.355035019,t281:1.336171443):2.051385278,(t282:1.612712491,t283:1.549471009):1.685775908):0.8234138589):0.6008161531):0.6251532752):0.6584765558,(t284:3.064007232,t285:2.969905658):2.848759362):1.723314479):0.2167336008,t286:7.474048055):1.300765902):2.748047896,t287:11.09403677):1.558977442,((t288:5.354908816,(t289:4.445221605,t290:4.443195111):0.6996917466):4.213526404,((t291:3.639833366,(t292:3.345470187,t293:3.317940961):0.1602710346):2.288802152,(((t294:1.528993969,t295:1.420547677):0.6739975997,t296:2.054444496):2.36159786,(t297:2.323105454,t298:2.320665059):1.956289887):1.007066473):3.347270248):2.94096603):1.144938498):0.2006522667):2.67631815):0.2375467824,(((((((t299:3.72256886,t300:3.597791905):0.8108488537,((t301:0.05410474883,t302:0.0500850372):4.142545939,(t303:0.9924907372,t304:0.9814140019):3.160953704):0.1397670923):0.3143107014,((t305:3.322397354,t306:3.223951427):0.2453930287,t307:3.426627498):0.9371348454):2.094322555,(t308:2.626704422,(t309:1.522928068,t310:1.465705399):1.03005731):3.71729561):2.100663729,(((t311:2.755262918,(t312:0.9343755459,t313:0.8691743239):1.783691321):0.7376131183,t314:3.343989451):1.58888691,((((((t315:0.6327376634,t316:0.6234305266):0.9511496555,t317:1.548319157):0.9518891376,(t318:2.039079834,t319:1.955069921):0.4457918861):0.4298222355,t321:2.453836746):0.2214339396,t322:2.669167143):1.256883704,(((t323:0.2729586471,t324:0.210269747):1.536353703,((t325:0.9606544443,t326:0.8748811831):0.1476427272,t327:0.9166682386):0.4613353652):0.7468276155,t328:1.886759606):1.296383071):0.4462044121):3.179814711):4.359147229,(((((t329:0.8387190879,t330:0.7358471861):1.136733365,(t331:0.1781608986,t332:0.01607617799):1.620858814):3.924394289,((t333:0.1922680795,t334:0.1880784187):1.118366302,(t335:0.3981311567,t336:0.3210409962):0.8346929018):4.156968726):2.399422066,(((t337:1.029393865,((t338:0.1401628306,t339:0.08649470741):0.4473832429,t340:0.5157242247):0.2680181718):2.96641835,(((t341:0.3619447453,t342:0.3242639806):0.07353311058,t343:0.3831719074):1.503691572,t344:1.720289774):1.784371744):0.03556046524,((t345:0.7972829797,(t346:0.6073801616,(t347:0.09653240179,t348:0.03073879487):0.4706852077):0.1480292922):0.9145745329,(t349:1.205262511,t350:1.041987008):0.09453260638):1.811986679):3.530422854):2.616766371,((((t351:4.317487297,((((t352:0.6401348182,(t353:0.4339026267,((t354:0.1402537882,t355:0.1367753775):0.2362521782,t356:0.3444379881):0.05004830081):0.1444866163):0.1449647276,t357:0.6782323879):1.079595851,(t358:0.7654744913,((t359:0.2782606847,t360:0.1335089506):0.1939821578,t361:0.1531136522):0.00628018976):0.8372306925):1.533260274,t362:2.022974268):0.6399591928):2.261647508,(t363:0.5230485137,(t364:0.3554565056,t365:0.2969004318):0.07596243868):4.26951323):1.550358305,((t366:1.490954235,t367:1.447651935):2.927119816,t368:4.34569732):1.727866211):0.5171984361,(((t369:1.248977666,t370:1.149868589):0.06502696262,t371:1.040441676):3.633849931,(t372:1.365790023,t373:1.225381945):3.130919579):1.557708054):0.1766536934):0.1618456107):2.284027581,((t374:2.224528524,t375:1.98028575):3.720347776,(t376:0.1669610896,t377:0.123034235):5.480314862):2.572508824):0.1052954231):0.9139405672):0.06613180154,(t378:7.406044424,(t379:6.674376612,(t380:5.756410588,(t381:2.873609443,t382:2.791426499):2.857871579):0.6013303277):0.730818791):1.811392625):10.01662765):2.580389437,((((((((t383:1.213944554,t384:1.173016978):2.102890102,t385:3.215582001):2.457458936,(t386:4.095470771,t387:3.968597675):1.570275539):0.8851260651,(((t388:3.869480902,t389:3.791927504):1.306966569,((t390:2.51951356,(t391:1.034877046,t392:0.9830968059):1.463850573):0.8708565331,t393:3.231519083):1.689853901):1.130334646,(t394:5.392647968,t395:4.722488152):0.5611123013):0.03954073718):0.977441688,((((t396:4.523438357,t397:4.437321228):0.3938485767,((t398:3.596465497,(t399:2.879330711,((t400:0.6655362234,t401:0.4808461065):2.165308884,t402:2.602320393):0.03725441552):0.6964217768):0.4067380792,t403:3.585015418):0.72960537):0.3212662144,(((t404:1.871139007,t405:1.781290768):1.161554521,(((t406:0.7721989806,(((t407:0.1549712755,t408:0.09137178447):0.1644988418,t409:0.1750680841):0.2715840728,t410:0.3913533941):0.1646770083):1.966289755,(t411:0.5876501099,t412:0.3447071341):1.820508174):0.1969939978,t413:2.2665247):0.004401753683):0.9197029331,(t414:2.21664655,t415:2.110404143):0.9391452395):0.6678430567):0.001927732505,(t416:0.9513733082,(t417:0.1945982463,t418:0.02201421368):0.5588686292):2.675525439):0.8727366613):0.2909154933,((t419:3.548122831,(t420:0.4678514429,t421:0.2894541529):3.067135785):0.4245769572,((t422:2.669588365,(t423:1.240126099,t424:1.228052296):1.426535973):0.2161219571,t425:2.726164725):0.6688490819):0.4288875019):9.209831669,((((t426:3.848066602,((t427:1.887105058,t428:1.824803301):0.3820680819,t429:2.128592496):1.552514548):0.532770778,((t430:0.5939094888,t432:0.3209772829):1.65257783,(t433:1.757045898,t434:1.692369598):0.1660880371):1.919670223):1.336674768,t435:5.085802528):4.820706294,(((((t437:0.0914792915,t438:0.04990867322):2.729084075,(t439:2.057490917,((t440:0.6362664392,t441:0.5485338461):1.190264618,((t442:0.4179762886,t443:0.3950092369):1.02718857,((t444:0.6434895986,t445:0.4553280639):0.3324825395,t446:0.5115121145):0.3916745763):0.229901589):0.1850907294):0.6566162644):0.4129813579,(t447:1.700219057,(((t448:0.6107555393,t449:0.5969686143):0.04509814162,t450:0.624859681):0.2158898331,((t451:0.2731523244,t452:0.2580952542):0.350275001,t453:0.6040979363):0.1006037386):0.6470417192):0.6702878583):1.616824993,(((t454:1.085014,(t455:0.4278385908,t456:0.3856497206):0.6462397896):0.3764194915,t457:1.336351871):0.2407670204,(t458:0.07769705103,t459:0.01709246058):1.491742929):1.756737164):2.867137959,(t460:1.573045054,t461:1.55972264):4.275513737):2.111413767):2.42714759):2.981247883,(((t462:0.08106046292,t463:0.05150917248):4.246581306,(t464:1.851526235,t465:1.821795361):2.441026207):4.975704632,((t466:1.275323359,t467:1.190065293):1.203420517,t468:2.208526524):6.661970093):4.027122307):1.223095521):18.16404434,((((t469:0.4291614537,t470:0.3661542852):0.5460387896,t472:0.6547457892):9.862684776,((((t473:0.1879531616,t474:0.04503039234):4.212010243,((t475:1.816887792,((t476:0.4355914411,t477:0.3989521936):0.6953669692,t478:1.081329924):0.3687282101):2.180371412,((t479:0.8401859847,t480:0.6790468844):1.848768422,(t482:1.007506639,t483:0.7572960424):1.122625356):0.9156394733):0.1558839568):4.103672597,((t484:0.4489169865,t485:0.3666842589):4.531864973,t486:4.739725872):2.011153746):1.808191725,(t487:0.5842270235,t488:0.5047920726):7.899399781):0.06098033129):10.1478798,((t489:1.039323272,t490:0.725764546):7.607671171,t491:8.190037114):9.860159):11.23307514):1.821682416):25.41617645,t492:56.49154299):11.87978671);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T39.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
