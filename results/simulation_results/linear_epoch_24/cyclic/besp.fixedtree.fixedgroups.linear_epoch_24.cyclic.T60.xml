<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t490:17.23266965,(((t468:0.04206939915,((t450:0.0587299796,(t403:0.164085943,(t390:0.3806989049,((t275:0.009783999567,(t269:0.01912841317,(((t210:0.2063731571,(t171:0.01406361582,(t167:0.1782837386,(((t138:0.107545315,(((t126:0.03703178641,((t73:0.3721895716,(t63:0.05172196361,(t56:0.02548763,(t48:0.09496471488,(t1:2.47507638,(t2:2.358930976,(t3:1.090261411,t4:1.068211742):1.168526169):0.0645934917):2.226432708):0.7502793047):0.8718610692):1.26570124):4.97686483,((t5:4.356321491,(t6:1.771799958,(t7:1.042045494,t8:0.8975266569):0.5921878661):2.504469018):1.489499725,((t9:0.1705214425,t10:0.1443165235):3.789084169,t11:3.827626776):1.480488706):6.526876956):0.3368313037):0.4657973236,(((((t12:1.683554861,t13:1.608782844):1.53670058,((t14:0.1981190056,t15:0.1583356):1.104179254,t16:1.250841639):1.817955157):0.9201229241,t17:3.942051341):0.6062903336,((t18:3.019895481,t19:2.995184983):0.6446390003,t20:3.387959597):0.8724246907):1.512757624,(((t21:0.9371948244,t22:0.8750239869):1.967426275,(t23:1.23827804,t24:1.186202844):1.596998895):0.384525892,(t25:2.231585637,t26:2.179677422):0.657253822):1.72096458):6.358322258):0.7708803237,(((t27:7.066642121,(t28:6.85204789,((t29:2.219299708,(t30:1.707694767,t31:1.660667449):0.4887970158):4.086800776,(t32:1.465662863,t33:1.328439282):4.704980157):0.5294434371):0.1860595771):2.425608288,((((((t34:0.3205670785,t35:0.2958012406):1.615410796,(t36:0.6249418709,t37:0.5932025899):0.9311000396):0.7765954024,t38:2.230045483):1.081041453,((t39:1.354809701,t40:1.314546044):1.689392704,(((((t41:0.2561174221,t42:0.1311201076):0.2525981801,t43:0.3321953873):0.248631286,t44:0.5543257526):0.4168344267,(t45:0.6033625717,(t46:0.1918595747,t47:0.1881052951):0.282445117):0.3524766164):0.6208601805,((t49:0.169877382,t50:0.1499923668):0.6393979126,t51:0.5740296198):0.1189686557):0.9984103126):0.01470490035):2.376688321,t52:4.074411747):2.52424257,((t53:0.5008430012,t54:0.4982301091):0.6729425887,t55:0.9958337692):5.189077529):0.4748169735):0.5933972931,((t57:0.4155332941,t58:0.3541618904):0.9533400187,t59:1.269997067):5.819207358):1.473996834):0.09435636053):2.720388714,((t60:0.7798619484,t61:0.751348651):5.284646121,t62:5.866846396):5.103775367):0.6195851924,(((t64:1.68847278,t65:1.395578597):4.640488065,(t66:3.91261598,t67:3.88932961):2.065667053):3.18112603,((((t68:3.188245433,t69:3.17220116):3.230154144,(t70:4.029958556,(t71:3.215321796,t72:3.160006317):0.517676787):2.366375518):0.0542650938,(t74:4.307715255,(t75:3.028424966,t76:2.923943032):1.278445284):1.365786407):0.5749910762,((t77:3.796292367,t78:3.692261344):2.191699395,t79:5.370667678):0.001397950635):2.062763609):1.661492395):0.2355049298):0.2414049709):3.637569269):2.368524859,(t80:6.326112604,((((t81:3.026845272,t82:2.912696721):2.166845667,(t83:3.195482087,t84:2.932863819):1.875866172):0.2466676125,(t85:4.765126812,(t86:3.401476825,(((t87:0.2900543622,t88:0.2618189276):1.058730592,t89:1.305203282):1.541368522,(t90:0.3087053401,t91:0.2189986491):2.411902275):0.4568372814):1.338177552):0.2634886505):0.08375284425,((t92:2.494942535,(t93:1.83554011,t94:1.806332334):0.6031465855):2.151880393,(t95:3.482911538,((t96:1.562596873,t97:1.386603688):0.228278296,t98:1.604258526):1.354460661):1.057006249):0.0040323772):0.7754135609):8.968604736):0.7344701399,(((((((((((t99:2.274022296,(t100:2.038944461,t101:1.857548845):0.2247953681):0.6435195923,((t102:0.5830872524,t103:0.5559697435):0.8540416052,t104:1.401144816):1.153556545):0.6949535503,t105:3.238645956):0.7659938247,((t106:3.892070938,t107:3.856304881):0.0190717414,((t108:0.4566973872,t109:0.4464136153):2.211151181,t110:2.394733892):1.141948503):0.06674136419):0.8225647228,t111:4.070255301):6.693475218,((((t112:2.513838057,(t113:1.55594025,t114:1.45460767):0.9274780768):2.761418487,(t115:2.831257193,((t116:0.8421655065,t117:0.8092536112):1.314535282,t118:1.994687449):0.5737463331):2.047267195):0.2794255124,((t119:0.4230690392,t120:0.3431185646):3.313104205,((t121:2.256354509,t122:2.248986287):0.1728380234,(t123:0.5774048724,t124:0.5273853921):1.782659254):1.079500872):1.072736456):0.7853109917,t125:5.199483905):4.289618315):0.7495677516,((((t127:2.481762954,(((t128:1.665773814,t129:1.334648644):0.3278791197,(t130:0.5093537592,t131:0.4460143936):0.9500014111):0.03403504606,(t132:0.6303014645,t133:0.5236376097):0.7897737932):0.2223526612):0.6020087636,(t134:1.450871642,((t135:1.033076196,(t136:0.4175902013,t137:0.3854650077):0.5845468955):0.06191894896,t139:0.8611528165):0.3119332568):0.5357615707):0.2107439796,(((t140:0.4279641408,t141:0.3931849213):0.2350053413,t142:0.5221579163):0.8672763744,(t143:0.2986412384,t144:0.2933469243):0.9478209131):0.2850504995):3.601836696,(((t145:0.831420117,(t146:0.4474918303,t147:0.4232939031):0.1320261824):1.183837997,((t148:0.7434503328,t149:0.503234988):0.3159047855,(t150:0.5859529582,t151:0.03577637315):0.1325205549):0.6087139):1.419433718,t152:2.161903831):1.661641658):3.22304261):0.2109689666,((t153:4.286914426,t154:4.263408794):2.499879481,(((t155:1.495091833,t156:1.390978332):3.973021593,t157:5.208961127):0.4721107123,((t158:2.932525458,t159:2.897901079):0.2790179313,t160:2.778117309):2.319722583):0.7191054396):0.4392794863):0.5522994675,(t161:6.137853418,t162:5.982136367):0.6308439818):0.8646912846,((t163:2.064016218,t164:2.054665451):4.866281774,((t165:4.126413179,(t166:3.682618801,(t168:0.6878196509,t169:0.6254942129):2.766432941):0.07987669284):2.181350138,t170:5.61108531):0.5640027191):0.5194944736):0.08222904524,t172:6.469272393):0.05288468678):3.152835772):1.16327322):5.142032304,((((t173:3.804331906,(t174:2.513473691,t175:2.080291123):1.211333478):0.59706147,(t176:3.382044056,(t177:3.177672931,t178:3.161451282):0.1032436673):0.4239764707):1.487399073,(t179:4.19551134,(t180:0.405088696,t181:0.3807983202):3.779881896):0.9095313413):0.7995893942,((t182:0.9969847378,t183:0.9473141598):3.181072875,t184:4.083123725):1.535937659):9.097635739):4.026442134):1.076191642):4.924230212):0.3289713273,(((((((((((t185:2.036361497,t186:1.991937198):0.7136435328,t187:2.674939735):0.03806812215,(t188:1.144516506,t189:1.11565835):1.522278017):0.8174400107,t190:3.448961118):3.083904841,((t191:0.6802976082,t192:0.6688280922):1.114392446,(((t193:1.364088302,t194:1.306407822):0.1797409724,t195:1.420482308):0.1131980284,t196:1.510716735):0.05986587648):4.706938074):7.387459494,(t197:7.513401935,(t198:6.424887983,(((((((t199:2.029488122,t200:2.012169542):0.09604548927,(t201:1.442413066,t202:1.339158394):0.4359634388):0.4001674237,t203:1.875062955):1.065935859,(t204:2.616353215,((t205:0.3216185967,t206:0.273982858):0.5881740562,t207:0.6846906596):1.648500438):0.07029314872):0.05993122362,(t208:1.431865796,(t209:1.140889615,t211:0.7806771408):0.2447603382):0.9467319612):0.3073605612,t212:2.091313005):2.140305745,(((t213:1.913109673,t214:1.868936887):1.199532488,(t215:0.8675269126,(t216:0.3597737835,t217:0.2848383873):0.4068577722):2.032144401):0.3891164455,((t218:0.5306992274,t219:0.2816890589):0.618197265,(t220:0.52947885,t221:0.3870313737):0.2606888615):1.627505985):0.6514891503):0.3227408966):1.07540158):6.104742945):0.9453776511,((t222:3.201660719,t223:3.103598982):7.472171388,(((((t224:0.6609607474,(t225:0.4496066556,t226:0.3805678067):0.1669824911):1.299705499,t227:1.788002114):7.523977934,(t228:0.7458720055,(t229:0.4757098228,t230:0.4272801414):0.187460054):8.092292068):0.2777614495,((t231:1.790724181,t232:1.705295176):1.942706986,(t233:1.399127191,(t234:0.601215973,t235:0.498051893):0.7712683198):2.156148599):5.119604133):0.01230256916,(((t236:0.5597782001,t237:0.4980205494):7.186290966,(t238:7.429977021,t239:7.253733663):0.08225237723):0.4692730221,((t240:1.426231772,(t241:0.7957410821,t242:0.7885877052):0.6304411158):5.757357954,(((t243:0.6265868187,t244:0.6029665941):4.583122298,(((t245:0.5608917837,t246:0.5517478845):1.020282801,t247:1.530402705):3.414514471,(t248:1.133282766,t249:0.9883145473):3.577267247):0.1764684598):0.589304258,((t250:1.217704497,t251:0.9474685925):1.479274776,t252:2.426451109):2.292991196):1.377331827):0.6018717783):0.09899739018):0.6611224674):0.5966806361):0.08728074417,((((t253:2.460128921,t254:2.115666589):3.173782106,((t255:4.009770309,(((t256:0.3106226195,t257:0.2095115325):0.5918227418,t258:0.7349841528):0.2168693304,t259:0.8616734903):2.889857668):0.1720572048,(t260:0.331295547,t261:0.3211245471):3.497513885):1.082735385):0.01213346652,t262:4.846996577):0.4765207567,t263:5.318249005):1.822706716):0.09658413238,(((t264:1.643127051,t265:1.600337482):3.610652964,t266:5.203631337):0.788728581,((t267:0.8159527904,(t268:0.1631244404,t270:0.08573695612):0.5581788466):4.679453247,((t271:1.623713102,t272:1.592758649):1.651335747,(t273:1.114322962,(t274:0.4035124758,t276:0.2742277703):0.1774441575):1.869839062):1.832643789):0.4037371902):1.059956949):0.3098312434,(t277:5.093980991,(t278:2.846065779,t279:2.771407898):2.190967002):0.8074774192):6.800218033,((((((t280:2.642111496,(t281:0.9628755702,(t282:0.1543725454,t283:0.1299881246):0.7272787909):1.653804763):1.600361544,t284:4.012110622):1.413484376,(t285:4.621087216,(((t286:0.7231410733,(t287:0.1685682802,t288:0.1104585245):0.5262138382):0.3845992499,t289:1.004847795):1.81340651,(t290:2.256113575,((t291:0.8914035324,(t292:0.5144208067,t293:0.5024625769):0.2394582741):1.134670467,t294:1.852129943):0.2295758035):0.5246017621):1.657417695):0.7525720271):0.8194162407,t295:5.768143017):4.27136993,((((t296:3.351056238,(t297:2.794744922,(t298:2.147137696,t299:2.049714181):0.6072152387):0.5074878775):2.15647126,t300:5.280213826):1.165362207,((t301:1.868344799,t302:1.821126357):0.8467721498,(t303:1.288466714,((t304:0.382555355,t305:0.2711272897):0.01342787033,t306:0.2061707052):0.85482421):1.332790188):3.666443943):1.702525377,(((t307:3.138718009,((((t308:1.685865721,t309:1.675973214):0.4290507992,(t310:1.748837885,t311:1.701326495):0.3076366668):0.5053815215,t312:2.501548073):0.4489353854,t313:2.901988094):0.02861045276):2.73153466,t314:5.571317991):0.02743605042,((((t315:2.387251833,t316:2.364438462):1.388207828,((t317:2.969528202,((t318:0.4056073019,t319:0.3376398074):1.628046658,t320:1.853713372):0.8804434703):0.4710919847,(t321:1.675788609,(t322:0.3829172261,t323:0.2577663356):1.290124659):1.394282615):0.2959607128):0.4281199587,((t324:0.1130695251,t325:0.07038690576):1.800826648,(t326:0.5348608354,((t327:0.3839745786,t328:0.1632088739):0.02139087715,t329:0.04075999176):0.1048737253):1.263254933):1.714376457):0.3958183409,((t330:1.513990164,((t331:0.2930350951,t332:0.099756687):0.09365361305,t333:0.1149472933):0.9676998519):1.419000544,((t334:0.4828769511,t335:0.3522369217):1.327234149,t336:1.611414551):0.6873082212):0.56773398):0.7726700106):1.795601763):1.565538209):0.492248555,((t337:0.7060457634,t338:0.592574816):0.5221516187,t339:0.9071285421):6.0918761):1.156084136):2.734912625):1.099462282):0.4688996374,(((((((t340:1.000418505,(t341:0.06632272493,t342:0.01792612265):0.4631989537):2.208081176,((t343:0.5526327694,(t344:0.4229965715,t345:0.4049921988):0.1227772992):1.128704608,((t346:0.6363589468,t347:0.5643186805):0.3646998289,t348:0.8585627748):0.4655135985):0.8809782616):2.507321851,(t349:3.545450055,t350:3.521513117):1.037895346):1.538810626,(t351:2.845054226,(t352:0.7187042747,t353:0.6674816504):2.109998352):3.062843388):0.7169765874,(t354:0.6121032248,t355:0.593292933):5.880945119):0.590561086,(((t356:0.919417714,(t357:0.6965077905,t358:0.6665511303):0.1412090625):3.51590429,(t359:3.245291998,t360:3.238040508):0.9357425435):1.829074338,(t361:0.5658229924,t362:0.5428088381):5.415161668):0.732734236):3.823250909,((((((t363:2.472773154,t364:2.453204982):4.449317454,(t365:1.716624966,t366:1.604865161):5.121279291):0.573092508,((t367:2.004030474,t368:1.589748074):0.9732179611,(t369:0.6667322952,t370:0.4328091548):1.777847956):4.310126224):0.1115458821,((t371:2.174490746,t372:2.064772432):3.467650995,((((t373:1.67243471,(t374:0.5529917558,t375:0.5483157277):1.084564744):0.9574344908,t376:2.588703104):0.4034499754,(t377:0.6370453941,t378:0.5160313308):2.332193822):1.699876561,t379:4.483519607):0.5471358823):0.851012198):0.6079672277,((t380:2.903299519,t381:2.850711516):2.463131476,(t382:3.982888754,(t383:3.845144948,t384:3.782072298):0.1373387018):1.316896732):1.021595912):1.323971548,((t385:6.522563377,((t386:5.328235664,(t387:2.627403519,(t388:0.6597823229,t389:0.5833205458):1.934514135):2.700088857):0.08452127793,((t391:0.1968277485,t392:0.1685128535):3.200239812,(t393:2.569882665,(t394:1.423069249,t395:1.400613496):0.946438599):0.7822609452):1.441626932):1.053351779):0.8707266858,((t396:3.888364597,t397:3.588330622):2.114883262,(((t398:0.4162167902,t399:0.3451768496):2.61816712,t400:2.935516322):0.9259898004,t401:3.825876773):1.714520774):0.4849227426):0.1694411454):0.8624235617):0.06965149655):5.635200993,(((t402:3.110284215,t404:2.864998272):2.92975803,((((t405:2.203212871,t406:2.193124652):0.7065355094,t407:2.80790741):1.942129974,(t408:3.021908949,((t409:2.597258545,(t410:2.339299751,t411:2.296699152):0.2554178935):0.1087620532,((t412:1.263471317,t413:1.092155099):0.4340692972,t414:1.505407588):0.9623827426):0.181499043):1.719390523):0.2962109451,((t415:1.066693893,t416:1.025656357):2.308631853,t417:3.318645276):1.164238325):0.5956685459):0.4824298762,(((t418:4.201710254,((t419:2.021957176,t420:1.958432139):1.645730695,t421:3.559212012):0.4543185684):0.05572652631,t422:3.855936714):0.3303261118,((t423:1.217180596,t424:1.195511755):1.700671401,t425:2.881101361):1.040009602):0.9543887731):6.134329512):13.39457523):63.4376481,((((((t426:0.7564018632,t427:0.6285295121):1.060394808,t428:1.566768397):2.241892358,((t429:3.06781041,t430:3.020946656):0.2899676499,((t431:0.7974975914,((t432:0.05508753498,t433:0.04540401957):0.2770172901,t434:0.006329700489):0.2308063705):1.1985018,(t435:1.034323044,t436:0.8263534436):0.38490195):0.7896338204):0.3311896561):18.89279365,((((t437:2.229307388,(t438:1.465764921,t439:1.415713906):0.4737921453):2.186100647,(t440:3.402855624,(t441:2.480578378,((t442:0.1368759035,(t443:0.06349267626,t444:0.01744747397):0.04331209392):1.510305104,t445:1.436419217):0.774778356):0.6491878109):0.4350255168):1.607627896,((t446:1.0609569,t447:1.039031324):0.7214079612,(t448:1.030573814,(t449:0.3938126211,t451:0.136154323):0.5517026176):0.7087946377):3.08456709):6.471977125,((((((t452:0.4008590693,t453:0.3040127505):1.239100838,t454:1.411085182):1.404812458,t455:2.730804092):2.507035362,(t456:3.846655864,t457:3.788918732):1.364563742):0.4510710722,((((t458:0.307913833,t459:0.145100964):1.120900721,t460:1.106145866):0.4264643489,t461:1.509570915):0.01739125408,(t462:0.5809356626,t463:0.4717677455):0.9052824127):3.720952367):1.124888025,(t464:2.880752021,(t465:0.4139431195,t466:0.3993527328):2.408696325):3.334502248):3.588085473):8.676285436):12.49253071,t467:30.82703884):12.37859921,(((t469:8.26418316,(t470:3.253293632,t471:2.910818918):4.520392075):0.1617485205,(t472:3.982674012,((t473:1.064189579,t474:1.022740917):0.2282521745,((t475:0.1536733935,t476:0.1489366524):0.5293364652,t477:0.449159325):0.4046230638):2.637050435):3.555891197):10.71426075,((t478:7.578739683,t479:7.568288682):0.7923607335,((t480:5.576442347,((t481:0.1721058547,t482:0.1126006407):3.776664845,t483:3.842573432):1.504354699):2.376135852,(t484:7.57184432,(((t485:0.08117002314,t486:0.04411908584):6.531890819,(t487:5.712996002,t488:5.656714158):0.7624999609):0.2875365434,t489:6.59500525):0.5977559072):0.1458650872):0.3692722855):9.252171152):23.99024174):39.79384188);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T60.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
