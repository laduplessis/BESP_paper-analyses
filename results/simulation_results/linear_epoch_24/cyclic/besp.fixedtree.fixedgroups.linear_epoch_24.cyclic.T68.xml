<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t407:2.321501604,(t408:2.190771341,((t409:0.2767420574,t410:0.1578903557):0.1099521843,t411:0.2644078485):1.212562184):0.1232329932):1.424974307,(t412:1.416104559,(t413:1.156795705,t414:1.076863249):0.2588045594):1.554235399):0.3601343759,(((t415:1.075226629,t416:1.061835885):1.66195181,((t417:2.356634853,(((t418:1.466880529,(t419:1.048262117,(t421:0.3525996998,t422:0.3001212336):0.1555493836):0.1979150363):0.2075339823,t423:0.6471106982):0.05078560787,t424:0.6236355381):0.575198352):0.08968760547,(t425:0.8578656508,(((t426:0.223076504,t427:0.216292436):0.02474331197,t428:0.1967562024):0.09187594857,t429:0.2716573507):0.4291810639):0.188280931):0.2120181804):0.06983209583,(t430:0.8878820719,t431:0.6477950685):0.2619297562):0.1817978158):0.8090915676,t432:1.892282872):87.74660071,((t433:2.711359027,((t434:0.6284695435,t435:0.5325584263):1.615731067,t436:2.039596356):0.4359903607):29.03501598,((t437:9.372882574,(((t438:3.105777892,t439:3.086991516):0.3228663587,(t440:1.034625244,(t441:0.7056544288,t442:0.6388191911):0.2706436289):2.06248819):1.213513657,((t443:0.2242721737,t444:0.091486778):0.6391597334,(t445:0.4102585556,(t446:0.2678959397,t447:0.2666960111):0.03432797678):0.318458491):3.297712969):4.595259716):15.32916243,(((((t448:1.658580829,t449:1.591934062):0.7383794324,t450:2.295036245):5.130524942,t451:7.316031167):3.046521627,(t452:6.667131716,t453:6.625132837):3.691437728):9.580912778,(((t454:6.687126274,((t455:1.086479893,t456:1.007693741):0.02234895561,t457:0.8948415142):5.009045109):2.497084843,(t458:1.440774378,(t460:0.8274409077,t461:0.7984877242):0.3958309089):6.862017655):10.54189603,(((t462:1.622088791,t463:1.49041434):6.103149181,(t464:7.02459258,((t465:2.235672582,t466:2.199940132):3.425715996,t467:5.61057882):1.310467221):0.3296500185):9.011759045,((t468:6.959039826,(t469:6.02188653,(t470:1.626055331,t471:1.566034076):4.339352288):0.9122006433):0.3282346691,(((t459:0.09414854301,((t420:0.3827516009,(((t356:0.3749180857,((((t286:0.002893224337,(((t222:0.08722987286,((t201:0.05892344882,(t177:0.1084332216,(t174:0.03441814859,((t136:0.02762645888,(t125:0.1114628454,((t111:0.05655418939,(t92:0.124609102,(((t58:0.1188477663,(t44:0.03958837457,t1:5.298094883):1.595169):2.083360737,(((t2:5.110884248,(t3:0.5866101088,t4:0.5598559745):4.509992519):1.196465106,t5:6.190100706):0.06437621331,t6:6.139248559):2.562096046):1.177096963,(((((t7:3.011103191,(t8:2.806763254,t9:2.369984177):0.0764196746):1.482042765,t10:3.634875563):0.5773972435,t11:4.005889425):2.76309816,(((((t12:1.50008203,((t13:1.1704406,t14:0.9189230829):0.0593412553,t15:0.9056154372):0.01648971288):0.3215499499,t16:1.228352116):0.4661740106,t17:1.642625912):3.120014188,(((t18:2.511139169,(t19:1.933063915,(t20:0.5740248939,t21:0.5562802335):1.349071932):0.5067570792):0.278196644,(t22:1.68770212,((t23:1.322037194,t24:1.184803483):0.1385358651,(t25:1.156585044,t26:1.069427591):0.01090844826):0.1367547362):0.8522317982):0.09845176272,(t27:0.7870900624,t28:0.4539201043):1.347887048):1.780114857):0.8315292467,t29:4.393380906):0.4953604745):0.01180246979,t30:4.797185497):1.901322247):0.522347878):1.580610463):0.7744426889,t31:9.554260559):0.8221288408):0.6261542513):0.337276948,(t32:8.559221338,((t33:2.24271647,t34:2.193009098):3.129522769,(t35:2.537006472,(t36:1.585711714,t37:1.11861136):0.9017090955):2.546787276):2.962495977):2.518995869):3.723775211):0.4014383121):2.460590849):2.00109487,(((((((t38:0.8806611471,t39:0.8565264161):0.8036835193,t40:1.6420688):0.3897375723,(t41:1.049535395,t42:1.049310046):0.936286913):1.31657212,t43:3.253669483):5.070995304,((t45:1.170167858,(t46:0.236515596,t47:0.2026176443):0.8674721121):3.855919771,(t48:1.931626269,(t49:0.3388863107,t50:0.3364783375):1.578223823):2.895448351):2.867811442):2.911259019,(((((((t51:2.512016054,t52:2.083004637):1.2739189,(t53:1.148609775,t54:1.139606311):1.941510823):3.227833155,(((t55:0.8189653799,t56:0.7043233084):2.565863599,t57:3.204907991):1.205308716,t59:4.17095736):1.64981734):0.2300083745,((t60:4.626231209,t61:4.587248582):0.9185613845,(t62:5.118696372,t63:5.097902508):0.1510802146):0.4703111891):0.5191463301,(t64:0.2763471053,t65:0.2191570581):5.927501862):1.464717836,(((t66:4.262499942,(t67:3.763878413,(t68:3.218501045,t69:3.042493973):0.456303965):0.4679441315):1.534691687,(t70:2.913886492,t71:2.868078533):2.191671069):1.271879374,t72:6.312454354):0.1017175767):1.151538125,((((t73:5.040551219,(t74:3.718642895,t75:3.62268804):1.135424518):0.3305120118,(((t76:2.781847076,(t77:1.011114564,t78:1.003312543):1.770670439):1.468228751,t79:4.231216794):0.6530216889,(t80:3.226586237,t81:3.106307509):1.544596308):0.1368707694):0.08409071598,(t82:2.832777035,t83:2.780620224):1.999155792):1.790270962,(t84:5.01169081,t85:4.959428052):1.55441127):0.03068067082):0.1843831969):5.284079993,((t86:4.20203281,t87:4.142641064):5.798714472,(t88:5.065678312,((t89:2.372956761,t90:2.070358506):1.817541881,(t91:3.055994821,(t93:1.852468443,t94:1.835698933):1.018829955):0.7332668249):0.8655974452):4.477120671):1.971866405):1.786929454):0.3118222659):0.5005705313,((((((t95:1.302157285,t96:1.154602609):0.6481481755,t97:1.561100702):0.2389724831,t98:1.792186998):0.2968305994,t99:1.974542395):0.6251063182,(t100:2.413385727,((t101:1.158909219,t102:1.155572945):0.6569987566,((t103:1.096927131,t104:0.7765117197):0.5722865738,(((t105:0.339994031,t106:0.2914643465):0.6720498825,t107:0.8071167736):0.2186981913,t108:0.9819290898):0.1034149834):0.1402566002):0.5502938506):0.01592475154):8.770232279,(((t109:1.509351685,t110:1.467086457):3.417966193,((t112:0.8278089886,t113:0.8174693965):0.5617145812,t114:1.292985286):3.352513365):5.128451374,t115:9.618874137):0.5028580081):1.548013255):3.056162726,(((((t116:2.555859246,(t117:0.7099511119,t118:0.6814641159):1.616996501):1.415035256,t119:3.629503547):0.4645964079,(t120:2.003739599,(t121:0.7697195657,(t122:0.3355913126,t123:0.301239214):0.2287279105):0.9712927048):1.88625162):7.374075405,(t124:6.667498956,(((((t126:0.252754811,t127:0.2418949937):1.683374077,(t128:0.1734690642,t129:0.1395146347):1.462448676):0.8020626198,t130:2.362790291):0.3158551041,((t131:1.279019916,(((t132:0.1588295183,t133:0.145937572):0.2785424322,t134:0.4100940888):0.3726793617,t135:0.7555742105):0.4434706723):0.8430071572,(t137:0.9339132232,t138:0.8739537119):0.9571915343):0.5490650735):2.710469463,((t139:0.2839565617,t140:0.1183447638):3.78047721,(t141:0.3908206758,t142:0.3119980239):3.187791749):0.8144042114):0.6731118662):4.048039041):1.976801252,(((t143:7.267334963,((((t144:0.3866856458,t145:0.3706963613):4.294881752,t146:4.634856661):0.7131216729,(t147:3.00237419,(t148:1.469622888,(t149:0.7888453824,t150:0.7647665024):0.3250193098):1.311725099):2.255442749):1.240085741,((t151:0.3997726885,t152:0.3060746535):3.926374965,((t153:0.1189933663,t154:0.05367130107):1.707284536,t155:1.693600788):2.38464288):1.081339722):0.4088700623):0.1951749929,(t156:3.14845267,t157:3.085416562):2.569346231):0.979507009,((t158:3.156495784,(t159:1.207755242,t160:1.187449522):1.910673826):0.7105905695,t161:3.786108042):2.689781574):2.548005427):0.9098595247):2.317434833):2.887240208,(((t162:3.746828887,t163:3.521794843):2.722194911,((t164:3.717030013,t165:3.68449951):1.148412953,t166:4.828301891):1.327392906):8.113064389,(((((((((t167:0.7061342076,t168:0.652942189):4.209193435,((t169:0.5211504809,t170:0.3485559942):4.089479564,(t171:3.713325744,((t172:2.108875046,t173:2.041388463):0.9686953775,t175:2.742408757):0.3819054053):0.6505975819):0.2368175291):1.513458047,t176:5.445192914):0.1073682563,(t178:3.279873747,(t179:2.678130593,(t180:0.9055869302,t181:0.8976506607):1.562740636):0.579730932):1.996670097):1.705441314,(((t182:2.0939054,t183:2.093411984):2.431403497,(t184:3.733927488,((t185:1.9325732,t186:1.901330258):0.9635155209,(t187:1.100050632,t188:1.077123825):1.677601274):0.7413120279):0.6900915272):0.990749746,((t189:0.929299491,t190:0.8625172055):2.950099471,t191:3.797010742):1.0351567):1.079098696):0.4492060438,((((t192:0.1736892422,t193:0.1528543846):0.9814650145,(t194:0.357116399,t195:0.3515702432):0.5361431034):0.3417845533,t196:1.070178065):2.987725502,((t197:3.254311259,((t198:1.663147055,(t199:1.237614616,((t200:0.4037655524,t202:0.02516501512):0.2878944538,t203:0.2588370361):0.3473938645):0.2369661219):0.5704711761,t204:1.258160085):0.897173651):0.1528434188,(t205:2.108296438,t206:2.018105525):0.06598958975):0.6505121386):1.675455888):0.5895320315,(((t207:0.8590128581,t208:0.8261133755):1.348373384,t209:2.071125557):0.7565409776,t210:2.799320654):1.922170274):0.3026836117,(t211:1.36972268,t212:1.298513508):3.609900222):3.966057358,((t213:3.187878402,(t214:0.8227963276,t215:0.6953702132):2.348589422):2.435113879,(((t216:1.155239185,(t217:0.7762499855,t218:0.7027061496):0.1318009058):0.2215177218,t219:0.8145248438):0.9190537978,(t220:1.295570554,(((t221:0.4392491946,t223:0.07757565747):0.1935200185,t224:0.2607024713):0.08502862026,t225:0.3042517089):0.4013898897):0.3959736302):3.12747483):3.237938051):0.6877777873):0.5393617728):0.259209621,((((t226:1.802222484,(t227:0.8754200119,t228:0.8018139333):0.8872756434):1.342704684,(((t229:0.6584128749,t230:0.6429797595):1.522738031,(t231:0.1128874275,t232:0.08856418852):2.038164456):0.3470079018,(((t233:0.3966304035,t234:0.3953197327):0.319894666,t235:0.426196693):0.9643499305,(t236:0.84792915,(t237:0.1006250041,t238:0.02141141514):0.6335503647):0.5380900318):0.7406853285):0.4941112731):0.5075672824,t239:2.803625361):3.013332278,((t240:0.6369019867,t241:0.185956642):2.127598919,t242:2.159279758):3.011277829):2.037503414):2.999241766,((t243:7.950258428,(((t244:5.519098501,((t245:2.363040434,t246:2.279337596):1.154207149,t247:3.373534185):1.990001725):0.6559473755,(t248:2.700042099,t249:2.657717357):3.177213887):0.7672457064,t250:6.550767836):0.3060889583):1.208862183,(((t251:6.080113032,(t252:2.055221094,t253:2.050729336):3.848417492):1.398655738,(((t254:6.116075031,(t255:4.817852978,t256:4.809244693):1.064108536):0.3111720597,(t257:3.872432219,t258:3.815622132):2.292294293):0.06646285317,(((t259:0.2878301921,(t260:0.254066604,t261:0.2464794873):0.02196333244):0.4454547207,(t262:0.1023383468,t263:0.07833675958):0.5956143151):3.730036393,(t264:4.219085198,((t265:3.315049409,(t266:1.126654269,t267:1.050422397):2.186907261):0.8789919485,t268:4.092541878):0.01960596915):0.1073523064):1.593438157):0.7954520162):0.1497817361,(t269:4.618951039,((t270:2.419975808,t271:2.297492696):0.2983594816,(t272:0.0400407537,t273:0.03812281267):2.39429182):1.86412534):1.982316153):0.377889999):0.6358485133):0.5260192697):1.119474024,(t274:2.472456696,t275:2.186474144):6.400184235):4.542019842,(((((t276:5.725898536,(t277:2.673164137,t278:2.643388211):3.049862036):0.8960424859,((t279:4.245437142,t280:4.200080158):0.6384062704,t281:4.836884516):1.657752153):0.3060557746,(((t282:3.042486087,t283:2.911442436):1.214767758,((t284:2.000315192,t285:1.928694678):1.684762247,(t287:0.6348360842,t288:0.5342303784):2.780126526):0.38782782):1.237809725,(t289:4.638538517,((t290:3.696259794,(t291:2.101159736,t292:2.077509012):1.495665397):0.6193874878,((t293:3.730589991,(t294:1.150739494,t295:1.037141937):2.506241714):0.2041530188,(((t296:1.12820517,t297:1.021296029):0.4643502384,(t298:0.706707001,t299:0.6240877381):0.6910663475):0.1445999302,t300:1.330292874):1.936760629):0.03432209031):0.2327890188):0.2713517854):1.007988078):2.372420547,((((((((t301:0.4580275259,t302:0.428408391):0.7530957425,(t303:1.114657953,t304:1.047682547):0.0177815868):0.2224293089,t305:1.195915785):0.1761915877,t306:1.310237687):0.1000551096,t307:0.9712306488):2.342334285,((t308:2.452869659,((t309:1.377819027,(t310:0.4482524324,(t311:0.1131328735,t312:0.08379088852):0.3294388875):0.9116734517):0.08106512982,t313:1.37789367):0.848619708):0.396782435,((t314:1.227527069,t315:1.138695308):1.233427646,(((t316:0.8565774279,t317:0.8388068399):0.5107065118,t318:1.284344945):0.6339053549,t319:1.825179865):0.3452917609):0.1619726731):0.4080814726):0.6971695051,(((((t320:1.991036476,t321:1.941271808):0.0902377042,t322:1.9836048):0.1682708754,(t323:1.483374957,t324:1.477665593):0.5671237378):0.4958186129,(t325:1.040869229,(t326:0.1949928432,t327:0.02884083115):0.7451906347):1.392689497):0.4265185331,(t328:2.008047507,(((t329:0.1964360659,t330:0.1646224406):0.004190363957,t331:0.1181096064):1.180458955,t332:1.289737713):0.6202241835):0.4666240232):0.05624398414):2.1948209,(t333:2.26895119,t334:2.163550961):2.3113978):0.2080894782):3.699294187,t335:8.326369082):0.03427046603):1.423571012):0.7218855124,((((t336:1.019969936,t337:0.5831536252):0.2217419474,(t338:0.3648575633,t339:0.2803783575):0.3242060615):0.2780217373,t340:0.8766833796):1.46231114,t341:1.957509499):7.314145944):2.983115068):3.321218639,((t342:10.49399058,(((t343:4.08919767,t344:4.059433977):4.861259545,((((t345:0.9950865299,t346:0.936089527):1.478641843,(t347:0.06365417195,t348:0.04683747394):2.309721248):2.968855544,((t349:1.44681851,t350:1.390995847):0.5436689723,(t351:0.4578506412,t352:0.3928495679):1.453476194):3.211460361):2.246175911,t353:7.1108137):1.131203933):1.336873813,((t354:2.739940509,t355:2.657652004):6.320675925,(((((t357:1.166325376,t358:1.153805508):0.3980725788,t359:1.513082881):0.7421018018,(t360:0.2352362301,t361:0.2138402236):1.932863959):1.797966845,t362:3.548084893):3.42712678,t363:6.955298017):0.9559025301):0.5135569756):0.05008499389):0.6585678586,(((((t364:4.337617557,t365:4.313431058):1.754706237,t366:5.926624412):0.5398827555,(t367:3.587924407,(t368:1.237031701,t369:1.094266869):2.259352281):2.817521382):0.1016963072,(((t370:3.355681347,t371:3.273693055):0.9287960855,(((t372:0.1271298494,t373:0.1244597341):2.279519347,t374:2.398745931):1.132641186,((t375:0.3510248576,t376:0.3060325178):2.634015439,t377:2.915608627):0.5396990137):0.5718643535):1.408194916,t378:5.397873478):0.4874336712):1.756854169,((t379:3.439892082,(t380:3.284062119,t381:2.960853216):0.1101409459):2.367585917,(t382:1.334119597,t383:1.184593116):3.88708079):1.608138579):0.470318092):4.347914077):3.953096138,((((t384:1.698640455,t385:1.452843927):1.406631921,t386:2.853926966):1.343246868,(t387:2.625291425,t388:2.483027551):1.474570422):5.074133349,((((t389:1.088077438,t390:1.069721457):4.653227086,((t391:3.953501888,t392:3.940302864):0.9303420377,(((t393:3.610226812,((t394:2.350626799,t395:2.190840903):0.3357489105,(t396:1.476372792,t397:1.461184857):1.042768261):0.8572004521):0.2450641301,t398:3.57862279):0.4801693898,t399:3.870199127):0.4690810815):0.7364242015):0.5927869587,(t400:2.332208534,t401:2.243590307):3.221622585):2.250761763,((t402:5.19832866,(t403:4.585575951,t404:4.431076257):0.2257893189):2.184051012,(t405:0.8107281367,t406:0.5818411799):6.013276333):0.3041443966):0.2747501812):5.807579874):0.6600592329):8.952826455):1.834016724):0.0789882388):3.681346789):6.806468165):57.74718502);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T68.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
