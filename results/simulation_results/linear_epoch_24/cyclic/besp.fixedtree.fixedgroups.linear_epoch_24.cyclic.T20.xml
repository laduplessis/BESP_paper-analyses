<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t470:0.1563691994,(((t425:0.06026132205,(t424:0.003759265403,(t396:0.007284305299,((t375:0.1043867805,((t345:0.2439827838,((t244:0.1708736473,((t238:0.03590213833,(t231:0.07216404104,(t218:0.08527840028,(t208:0.03176738628,(t167:0.03358323842,(t161:0.1371706977,((((t143:0.03813820561,(t144:0.01934670511,(t142:0.2441175502,(t119:0.0526711643,(t113:0.1235939833,(t89:0.00822924694,((t70:0.03136110355,(t61:0.1411589342,((t49:0.1371118997,t50:0.07841624576):0.002383382698,(t47:0.08804147292,(t1:3.861084309,(t2:2.039883683,(t3:1.752230732,t4:1.748637576):0.2731489208):1.650046644):0.7282446298):0.5746687024):1.03765303):0.6911910507):1.302609803,((((t5:1.510703813,(t6:1.105916337,t7:1.061690596):0.2699861789):2.196807388,(t8:1.240170921,t9:1.239471061):2.255253752):1.096629014,((((t10:2.804523451,t11:2.787408649):0.1358456464,t12:2.82472219):0.4170912305,t13:3.050285492):1.132193026,(t14:3.646482047,t15:3.57068309):0.5279754195):0.04723313381):1.309969514,(((t16:1.899732305,t17:1.824304143):1.68543305,t18:3.503711486):0.8285335911,((t19:2.947892256,t20:2.689254336):0.6700925634,t21:3.00936737):0.5141403508):1.035626691):1.736540611):0.08698914333):1.927895339):1.449357169):2.635050745):0.05073271119):0.01340328252):0.5206165391,((((((t22:1.770044327,t23:1.734339619):2.008194058,(t24:2.696014222,t25:2.672614597):1.040683818):2.521140805,((t26:1.860250527,t27:1.807864368):1.993077731,(((t28:2.722561624,(t29:2.55562445,t30:2.453054146):0.03890069669):0.04166407317,(((t31:0.8344322818,t32:0.6619956775):0.5609541764,t33:0.6766036286):1.035356218,t34:1.52040037):0.06211504422):0.1606822978,t35:1.679752841):0.8270422356):2.297434879):2.323146243,(((t36:2.042576019,t37:1.707515763):1.197549476,t38:2.835554209):0.7705674568,(t39:0.3866315652,t40:0.2602377069):3.159474749):3.113839756):2.577767498,(((t41:0.6335729489,t42:0.6309731657):5.95639988,t43:6.357139587):0.6284470406,((t44:0.3040543697,(t45:0.05661322277,t46:0.04649889709):0.2212877054):1.598241727,t48:1.318364157):5.058682579):1.865143585):0.7202523146,((((t51:3.080208313,((t52:0.519577658,t53:0.4815679888):1.469886607,t54:1.902297534):1.079293527):0.2090649591,t55:2.832910531):4.667791485,(((t56:6.556459759,((t57:1.19234179,(t58:0.7594603446,t59:0.6562604878):0.3438465582):3.462472547,t60:4.326022716):1.868735947):0.2460978004,(((t62:2.084355658,t63:2.05832136):1.66718951,t64:3.705689862):1.117666392,(t65:0.3344165198,t66:0.2525632861):4.237732321):1.282724082):0.5869010198,(t67:5.567115722,((t68:4.971509724,(t69:4.679047098,t71:4.431206559):0.2667213492):0.3073643869,((t72:3.976508458,t73:3.955095214):0.1248641206,t74:4.027792369):0.8633085978):0.1494743212):0.7705809572):0.1096455013):0.283472008,t75:6.135728383):0.4543919712):1.001723879):0.6215037184,(((t76:0.2824007968,t77:0.1975416045):0.5085723056,t78:0.699760854):5.838358941,t79:6.533753874):1.546732162):0.009129847465,((t80:0.8528747964,t81:0.7870113892):6.125087837,((((t82:4.93264011,(t83:0.7534346543,t84:0.7098216163):4.164991981):0.08678141782,(t85:4.601239174,t86:4.543305924):0.2985045845):0.3827875992,((t87:2.072952834,t88:2.02949985):1.894000853,t90:3.588737675):1.083065198):1.20491274,((t91:3.228752194,t92:2.966294215):1.446052578,(((t93:0.8004390736,t94:0.7869967594):1.128787131,t95:1.758187445):1.540881771,t96:3.248247524):0.7707284352):1.165618686):0.2900303091):1.021009541):0.0628040713):0.9286662704):3.744494204):0.7550013771):1.146503878):0.6371625009):0.7972833584,((((((t97:3.639776557,t98:3.557117281):2.436290744,(t99:4.339918982,t100:4.339184582):1.644416384):0.5275709347,((((((t101:0.528752111,t102:0.5206107652):0.9280704048,t103:1.432656475):2.294789445,(t104:2.762871001,t105:2.664926456):0.8351489893):0.9697084657,t106:4.419531423):0.6091978056,(((t107:0.7390101486,t108:0.6394808678):0.3643270864,t109:0.9284041963):3.707973128,t110:4.556836422):0.2120230371):0.09943576416,((t111:1.685262596,t112:1.647053432):2.550017463,(t114:2.758666432,t115:2.673976733):1.094262679):0.5537892819):0.9611663272):6.100096216,((((t116:1.465648976,t117:1.037823571):0.01712283239,t118:0.9727333999):8.189397617,((t120:0.5923936354,t121:0.4562050254):3.960030868,((t122:2.466759352,((t123:0.08334443541,t124:0.04497248549):1.253756817,(t125:0.8849239024,t126:0.8043371165):0.2883173231):1.129621027):1.456413346,((t127:0.6903613688,t128:0.3394666015):1.710218532,(t129:1.752514174,t130:1.734486952):0.1759315175):1.267017633):0.470523247):4.017141775):1.110407788,((t131:1.271441413,t132:1.020247277):1.436940881,t133:2.166702032):6.042687965):0.4903602172):0.2079125207,(t134:2.510578674,(t135:1.814540224,(t136:1.441823034,t137:1.226444805):0.2961032487):0.6004362102):6.390206035):1.386676227,(t138:9.629237065,((t139:1.459062979,t140:0.9940564951):7.293260465,((t141:0.5320625852,t145:0.08661918131):0.5697233361,t146:0.6481310784):7.173253649):0.8638126024):0.2664944375):0.1314219568):0.4666219537):8.214748081,(((((t147:5.064691691,(t148:3.421410209,(t149:0.3079224495,t150:0.1018234599):3.110756861):1.610317612):4.433256392,((((((t151:0.2047744667,t152:0.1901554343):0.3348809067,((t153:0.1286418536,t154:0.05541636934):0.1057553852,t155:0.1132665152):0.1939468996):0.335621257,t156:0.433427883):1.294671187,t157:1.727361225):4.033793812,(t158:0.5015837535,(t159:0.1922149614,t160:0.1413549798):0.2608567543):5.194625528):1.585113484,(t162:2.287483629,t163:2.261409972):4.655774803):1.444780011):2.63092975,(((((t164:1.511943733,t165:1.435619045):7.030997216,((t166:1.144720239,t168:0.1394621918):3.911784519,t169:3.714218628):3.402866746):0.4843344275,(t170:1.994453389,t171:1.925425499):5.509420128):0.2339767022,(((t172:1.317724963,t173:1.270848169):6.036335978,((((t174:1.863834586,t175:1.783559027):2.196067444,(t176:2.615955134,t177:2.560857162):1.359450527):1.754320172,t178:5.598819381):0.4545667945,(t179:0.4717244555,t180:0.448874695):5.581070221):1.000067573):0.1537256585,(t181:6.142459973,(t182:1.188128799,t183:1.149106768):4.851760277):0.9651612376):0.1189501828):0.5618035369,((t184:3.083423376,t185:3.068578022):1.895473239,(t186:3.631416504,t187:3.478511089):1.328554939):2.208045066):1.167560386):0.09696051904,(t188:2.185570905,((t189:0.08755462777,t190:0.0265909943):1.38169586,t191:1.377349566):0.6733639045):5.847849404):3.373978274,((t192:5.775073115,(((t193:0.8004691902,t194:0.7873996848):2.920417573,t195:3.494735909):0.3699130506,(((t196:1.183813034,t197:1.062255522):2.0009989,(t198:1.700951452,t199:1.645676746):1.120021477):0.2542774829,t200:2.997112857):0.4172904372):1.52949383):0.2832063684,(t201:4.867629621,((t202:0.2622943164,t203:0.2167473763):0.7371273543,t204:0.9535864397):3.846535915):0.2898485783):5.029253023):2.146242821):2.975036756):0.9162402415,(((t205:1.822690512,(t206:1.747717568,t207:1.741138242):0.005077751677):3.466853766,((((t209:1.141774284,(t210:0.8421750888,(t211:0.730300923,t212:0.7219828857):0.1007732174):0.1431294296):0.9887133343,(t213:0.8602425767,t214:0.7900545205):1.029251696):0.393624116,((t215:1.493167739,t216:1.477746534):0.687695634,(t217:1.972454124,t219:1.73532817):0.1148655466):0.03019633611):1.486214767,t220:3.229078539):0.8620926967):9.576914919,((((t221:0.7254180648,t222:0.7235519667):0.04886565242,t223:0.674336477):2.606447017,t224:3.233034607):1.317680978,(((t225:0.7512242501,t226:0.7097081864):0.7649164815,t227:1.252044787):2.715172913,((t228:0.3935702905,t229:0.3026608141):1.889950039,(t230:1.436607258,t232:1.285836626):0.7345229662):1.50475664):0.2542123884):8.90162234):1.261534027):1.173171818):1.954945837,(((((((t233:3.14934512,((t234:0.7442021831,t235:0.6716977805):1.189726774,((t236:0.4956704739,t237:0.3257692785):0.9790264688,t239:0.6053147596):0.374240902):1.191374009):0.08552510577,((t240:0.2091624276,t241:0.06704827025):0.5783835072,t242:0.4527163929):1.172897976):5.084273097,(t243:0.8578971819,t245:0.6608077823):5.845846387):2.529184048,(t246:8.117388002,((((t247:0.5146061871,((t248:0.05109067753,t249:0.0155175126):0.308663936,t250:0.1565073598):0.1106574619):0.2527200597,(t251:0.09393270109,t252:0.02759866584):0.3029880394):5.916807281,(t253:2.369860248,t254:2.298046681):3.716330881):0.8869652536,((t255:3.189098595,(t256:0.970898709,t257:0.9519165771):2.119247248):2.089005263,(t258:1.851208,(t259:1.198055413,((t260:0.2772040398,t261:0.1290327561):0.2699157085,t262:0.1746738329):0.630604017):0.5747253175):3.219394996):1.62090442):0.4980388405):0.6366141509):2.136833845,((((t263:2.073367785,(t264:1.836026108,(t265:0.3330346838,(t266:0.1730138212,t267:0.1596429865):0.02365157926):1.485258647):0.05005652366):3.95734246,((t268:0.1880679152,t269:0.1286332899):4.328323353,t270:4.448946445):1.030747997):0.6332334519,((t271:5.641958849,(t272:3.145968974,(t273:2.084263663,t274:1.733055042):1.012780704):2.394653335):0.1058319333,t275:5.026517321):0.2202772857):1.909280395,(t276:3.649404854,(t277:1.527356175,(t278:1.348433128,t279:1.263441533):0.07754134973):2.086518341):3.463249068):0.7798920121):1.192462365,(((t280:4.750691526,(t281:0.2468399048,t282:0.1700765361):4.423117685):0.7870138736,t283:5.286553179):1.019183694,((((((t284:3.044533173,t285:2.76778797):1.472204653,t286:4.122564437):0.1911618331,t287:4.246204384):0.2883091866,t288:4.448935111):0.1068421508,(t289:4.037465146,t290:3.580428118):0.4611753241):0.5817515731,(t291:3.838457339,((((t292:1.77188702,(t293:1.59468583,t294:1.39440063):0.1565795507):1.169267441,t295:2.636901698):0.1271407669,(t296:2.50769322,t297:2.414569188):0.182015634):0.42083051,t298:2.925921718):0.2592480817):0.7466554467):0.487185008):2.26980323):1.77954501,((((((t299:2.60500697,(t300:0.5963260359,t301:0.4815646051):1.925378727):3.528761105,(((t302:2.092691935,t303:1.823000049):0.4254434981,t304:2.175934271):1.596081251,(t305:1.798939464,t306:1.79002922):1.844746564):1.753873182):0.2848493411,((t307:2.810550584,t308:2.621321601):2.272826795,((t309:0.9818158409,t310:0.8377342987):3.21832871,(t311:3.08288673,((t312:0.3270316176,(t313:0.1100541359,t314:0.1022140227):0.1439170651):1.318161012,t315:1.507041711):1.294728505):0.8387953961):0.2445263208):0.5216596618):0.05990658527,(t316:4.239406144,((t317:1.625355197,(t318:0.1352875068,t319:0.1135411619):1.20581036):0.9992575211,t320:2.262652647):1.585747424):0.1374586945):0.685931304,(((t321:1.442084217,t322:1.422753685):0.9625575658,((t323:1.484193093,t324:1.478769054):0.4238774961,(t325:0.8783930102,((t326:0.5157687521,t327:0.4541489302):0.2495782449,t328:0.5418557381):0.07371409419):0.8938989284):0.4629153929):0.3331418095,((t329:0.2476335164,t330:0.1629000078):0.5316889709,t331:0.6147678783):1.483349866):1.722881209):1.015585242,(t332:0.9182427025,(t333:0.4499856102,t334:0.1078617418):0.2982947434):3.718739468):0.2649215326):1.072563093):0.3277180321):2.280908957):0.1103616388):2.12553499,(t335:9.661779343,(((t336:0.5543318538,(t337:0.2570446459,t338:0.2168993148):0.0156025461):6.887919632,((((t339:1.075346993,t340:1.067269473):0.2310755364,(t341:0.8982048766,t342:0.8253919068):0.3462134085):0.5739154923,t343:1.531399147):0.8981900987,t344:2.25709705):4.237009209):2.135470173,(((t346:1.580166003,t347:1.537193469):0.3574478543,t348:1.833080223):5.749181621,(((t349:5.017374733,(((t350:1.363376671,t351:1.291669573):1.295828578,(t352:1.498644664,(t353:0.2658951753,t354:0.1894098302):1.159633424):1.021775891):1.563015121,t355:3.790418892):0.7905693787):0.7809604696,t356:5.29134705):1.693328551,((t357:0.3392894402,t358:0.05701297371):5.574846318,t359:5.616142743):1.035346702):0.01808536171):0.6013521258):0.04975243224):0.5408646201):0.561537986,t360:8.414525504):1.668756761):0.6724071121,((((((t361:1.628983144,t362:1.56991164):4.881678825,(t363:1.688233907,t364:1.627348659):4.750329105):0.5157199023,t365:6.799676299):1.825533025,(t366:7.266210074,t367:7.130805722):1.32229353):0.2157213052,(((t368:2.33813991,t369:2.308228133):5.15535338,(t370:6.994090888,(t371:6.870018328,((t372:0.6567109248,t373:0.6087354661):5.518365523,t374:6.026647947):0.548377825):0.09424509293):0.3967297007):0.5542015899,(((((t376:4.922993671,((t377:0.9440140039,t378:0.8366615921):2.44979558,t379:3.271338246):1.420482541):0.2805673297,(((t380:1.799760267,(t381:0.2535945754,t382:0.1375448787):1.480358514):2.877310156,t383:4.446801511):0.08127283926,((t384:3.204741136,t385:3.030304065):1.122395988,t386:3.94129924):0.1763790593):0.1973678235):0.1366502089,(t387:4.261320517,(t388:3.03412265,t389:2.988019014):1.127875555):0.07671432446):0.7296224408,(t390:4.055892856,t391:3.984367536):0.6312933803):0.508380649,(t392:1.220451832,t393:0.7457237135):3.676226789):0.9042185307):0.5552125457):0.1076692775,((t394:2.312287222,t395:2.277616081):2.684220591,(t397:3.492184487,(t398:2.540726851,(t399:1.795987747,(t400:1.404865492,(t401:1.229477879,t402:1.208984804):0.1292298871):0.09339705317):0.7204086276):0.9168056813):1.309882869):0.9882540581):1.540850845):2.375542024,(((t403:4.266686304,(((t404:1.04207258,t405:0.9673971711):1.133527696,t406:1.991517674):1.139333828,(t407:2.753331906,(((t408:0.4104476336,t409:0.3508488426):0.7307707327,t410:1.069090219):0.4385832768,t411:1.500869435):1.13924534):0.3169810131):0.7932808168):0.6905050209,((((t412:0.5823361819,t413:0.5581513137):1.923038607,t414:2.479375498):0.08734323203,t415:2.469793376):1.060838629,t416:3.27406386):0.7701024656):0.001160347194,t417:3.975139724):4.200553801):2.808431653,((((t418:3.678593384,(((((t419:0.3003074597,t420:0.005642863065):1.277089057,t421:1.227549315):0.4944557116,t422:1.659854665):0.3960152286,t423:1.930795237):0.2641747999,t426:1.965502172):0.8359511886):0.2428212502,(t427:2.72873191,(t428:1.230619798,(t429:1.074785963,((t430:0.1605115821,t431:0.05768352978):0.3730123132,t432:0.2452099533):0.4847986252):0.05458803253):1.468922405):0.2780507073):1.905404301,(t433:2.092214278,t434:1.786371659):2.175145899):4.627436494,((t435:1.900084842,((t436:0.2598624688,t437:0.06515330376):0.5354987242,t438:0.5295998194):0.9727375908):1.432231573,((t439:1.333259718,t440:1.330722643):1.063376531,((t441:0.5968614034,t442:0.4855014146):0.845897384,t443:1.221844779):0.5669743951):0.4717646843):5.238861427):0.5281829779):74.11590669,((((((t444:2.165209956,t445:2.114285642):0.1778330991,t446:2.182851533):0.3927264131,(((t447:0.8635761741,(t448:0.03312025316,t449:0.01051942961):0.7372561188):0.108682619,t450:0.8398310066):0.4921602666,(t451:1.257510376,t452:1.125767661):0.05225168481):1.015853153):6.60712878,t453:8.71838391):3.625604505,((t454:2.766683741,(t455:0.2384011938,(t456:0.1086221309,t457:0.09215109514):0.0725820965):2.411215387):3.181073542,t458:5.747828485):6.316682548):39.14002076,(((t459:22.32804715,(t460:0.8958436329,(t461:0.3461806447,t462:0.2546025755):0.5403901856):21.28062412):7.744248636,((t463:9.383412557,(t464:7.473709695,t465:7.432633634):1.865144505):11.83872493,(((((t466:0.2147693301,t467:0.02641379486):4.143035689,(t468:2.518186214,t469:2.348131266):1.644008048):1.583778884,((t471:0.7959046095,t472:0.7904075711):2.510481569,(t473:1.740954422,t474:1.496162893):1.55743856):1.949788676):3.06991989,t475:7.941460079):0.4849284832,((t476:0.1554139137,t477:0.07826906736):4.804677539,t478:4.804904979):3.440529586):11.54450334):8.481256681):18.715757,(((((t479:0.8175041816,t480:0.7331570434):0.8591924332,t481:1.580819752):3.159727879,(t482:4.317006316,(t483:1.14340213,t484:1.088373067):3.086630128):0.3710783102):0.5193045627,t485:4.981076553):1.941289043,((((t486:1.165903246,t487:1.146193933):2.502115615,t488:3.618449538):2.428337564,t489:6.035742099):0.4518806133,t490:6.481714871):0.3591660864):39.4457295):2.342257527):29.92410788);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40 42 44 46"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.cyclic.T20.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
