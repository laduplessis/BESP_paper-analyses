<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((((((t143:1.851593048,t144:1.843693975):0.1929001109,((t145:1.224977214,(t146:1.082082265,t147:1.077724412):0.1415609799):0.122713174,t148:1.336618247):0.6801385619):0.15472774,t149:2.169748766):0.2788037351,t150:2.391735683):0.4079098406,t151:2.791425282):0.06298960489,(t152:2.323450189,((t153:1.974921487,(t154:0.1261082936,t155:0.1227389595):1.838132253):0.1056666226,t156:2.045150523):0.2183130769):0.5285336147):0.7747034829,(((((t157:0.6478990718,((t158:0.2818973738,t159:0.2750920323):0.001617089283,t160:0.2682715902):0.3600845577):0.4037100533,t161:1.021439596):0.2825496764,t162:1.299855395):1.027471469,(((((t163:0.4004533099,t164:0.3977004098):0.2941697037,t165:0.6823583899):0.3100201022,t166:0.9883892434):0.986238415,t167:1.954228157):0.1183315871,(t168:1.194986023,(t169:0.5178373211,t170:0.506139139):0.6689647426):0.8743971374):0.2180924756):0.8991391339,((((t171:1.709798314,t172:1.688170538):0.07363955516,(t173:1.20516502,((t174:0.3229134587,t175:0.3126854223):0.6604346011,t176:0.9679786904):0.2112497464):0.5482791645):0.6346774821,(t177:1.300511242,t178:1.293780955):1.041377453):0.3927426512,t179:2.717280339):0.3529192075):0.2990563946):1.085592224,((((((((t180:2.17960036,t181:2.175901327):0.1853006974,((t182:1.884853169,t183:1.871283627):0.1519777937,((((t184:0.03081677712,t185:0.01411196172):1.215566963,t186:1.222329265):0.1448452857,((t187:1.123498281,t188:1.11891151):0.139089861,t189:1.248905113):0.09711286261):0.5277984167,((t190:1.267001408,t191:1.251960825):0.122519737,(t192:0.7249247529,t193:0.7079021272):0.6020956627):0.4775126915):0.09833994446):0.3085172328):0.05710804618,((t194:1.626102249,(t195:1.328635737,t196:1.327680642):0.2972578933):0.4117840575,(((t197:0.8887206643,t198:0.8720444168):0.05840049558,t199:0.9263090137):0.3744827064,t200:1.2951871):0.7133859628):0.2069703046):0.5692438546,(t201:2.150721269,t202:2.14199069):0.6208427267):0.174737115,(t203:1.001690688,t204:0.9504595586):1.927192451):0.09568772295,((t205:1.272156014,((t206:0.09563333455,t207:0.0499391234):0.9524154555,t208:0.9886914409):0.1989134628):0.4690232092,t209:1.655025153):1.228379407):0.2215298184,(((((t210:1.058521937,(t211:0.2412569914,t212:0.2310474643):0.801262125):0.1015435612,(t213:0.6220715513,t214:0.6122214704):0.5075171909):1.1789249,(t215:0.7928637635,t216:0.7853992394):1.503601354):0.3454188204,((((t217:0.5994628046,t218:0.5908732949):0.3018021218,t219:0.881214149):0.1000865445,t220:0.9704527125):0.8150064702,t221:1.78191748):0.7999339325):0.255307809,((t222:1.810032542,(t223:1.685208658,((t224:1.038530847,(t225:0.9264224142,((t226:0.4718438911,t227:0.4450732562):0.2103252087,t228:0.6442293225):0.2344949885):0.0795560924):0.412337971,t229:1.368890179):0.2234496694):0.1117927531):0.6014869618,((t230:1.650786702,(t231:1.144189798,t232:1.1391256):0.5014410444):0.5047662324,(((((t233:0.4754978529,(t234:0.4350908962,t235:0.4173955709):0.03920266159):0.5739101343,t236:1.028661912):0.1241696287,(t237:0.1947987469,t238:0.1937929421):0.9469514279):0.1650355937,t239:1.295423354):0.2462967316,(t240:0.2301214499,t241:0.22868563):1.300669899):0.548902408):0.1493409319):0.4240094868):0.1560640928):0.3754094089,((((t242:1.145647054,t243:1.135186549):0.4671268569,(((t244:0.4053887509,(t245:0.3182538309,t246:0.3082054316):0.07740200313):0.5188628353,t247:0.8981258004):0.08147442038,(t248:0.560489221,(t249:0.3634275023,t250:0.3618833688):0.1796316238):0.4031645058):0.5945721193):0.06281989386,((t251:1.060747457,(t252:0.757503934,(t253:0.7157547949,t254:0.6976397248):0.03654606914):0.2981897487):0.06653682321,t255:1.095453469):0.4689619044):1.103453491,(t256:2.000960294,(((((t257:0.3417036403,t258:0.3274924721):0.9555758816,(t259:0.5718698747,t260:0.5648104898):0.7106186696):0.3035792778,t261:1.575194952):0.2468756384,(((t262:1.245265623,(t263:0.8263826682,t264:0.8033611854):0.4166113278):0.4726805475,(t265:1.259589611,(((t266:0.5874166829,t267:0.5804247971):0.01638800385,((t268:0.2650916846,t269:0.2504703472):0.2222216922,t270:0.4721328188):0.1031860095):0.2352290551,t271:0.7951927877):0.4088584373):0.4313636208):0.03398640785,t272:1.650778105):0.06788825359):0.04357911992,((((t273:0.5324165055,t274:0.5305568859):0.6478470204,(t275:1.052439522,t276:1.050772051):0.1110608654):0.3229034434,(t277:1.107881985,(t278:0.3029808407,t279:0.301527849):0.7949200248):0.363302387):0.2518406992,t280:1.690379855):0.005095143535):0.09625176113):0.6570077524):0.3977519111):0.5861828837):0.2092070755,(((t281:1.727798128,(t282:1.698957424,(t283:0.969540256,(t284:0.1814982823,t285:0.1787187233):0.7749026595):0.7225312762):0.02526156939):0.8942526881,(((t286:0.1538912649,t287:0.1505142011):0.5528120266,t288:0.7005977675):0.4240385999,(t289:0.8361631018,(t290:0.2870944647,t291:0.2826990258):0.5484224199):0.2867560749):1.456273599):0.6542963023,((((t292:0.2637559103,t293:0.2583278241):1.166896683,(t294:0.8945032423,t295:0.8915198192):0.5298679952):1.087678478,(((t296:0.168427239,t297:0.1651328539):1.50157386,(t298:0.6091732113,t299:0.5878211457):1.023179486):0.3574474506,(t300:0.6676483713,(t301:0.6220662895,t302:0.5954809121):0.04547595736):1.272550905):0.4614465382):0.463498768,((((t303:1.663184423,(((t304:0.5180671496,t305:0.5133526626):0.7935184703,(t306:1.077983174,(t307:0.8817024886,(t308:0.4749903406,t309:0.4702367613):0.4031797685):0.1916147533):0.1968211983):0.008276684989,(((t310:0.4132122686,t311:0.4071164357):0.1331190442,(t312:0.484156468,t313:0.4624661774):0.054058697):0.2512763395,t314:0.7402606915):0.4718629258):0.3295522816):0.1051425558,(t315:1.133916455,((t316:0.8463433388,((t317:0.05654318869,t318:0.05521297343):0.7280207923,t319:0.7776068999):0.0349328498):0.01348294608,t320:0.8122813742):0.2431267413):0.5088878367):0.2458872612,(t321:1.117444618,((t322:0.5432384212,t323:0.5406478818):0.2787040697,t324:0.8161312122):0.2820956755):0.6901076983):0.3743125706,((t325:0.5562396017,t326:0.5515643196):0.6767927382,(t327:0.7693512347,(t328:0.1834118031,t329:0.156034451):0.5502700164):0.4569049914):0.9165291024):0.4429684967):0.2455660764):0.3377751918):0.2516697422,(((((((t330:0.9435900099,((t331:0.3642464191,t332:0.3605949153):0.3218034802,(t333:0.3553745204,t334:0.3370386724):0.3155069338):0.235240511):0.3051658331,((t335:0.2865116647,(t336:0.1592926878,t337:0.1493433247):0.1259511592):0.3136790401,(t339:0.1277630408,t340:0.1177188043):0.4463556786):0.5886897914):0.1321608347,t341:1.2777259):0.1603614564,t342:1.430961199):0.3595968573,(((t343:0.8936292748,((t344:0.2971162484,t345:0.2956109141):0.4460410288,t346:0.7216443337):0.1312523638):0.0535379533,(t347:0.1890694983,t348:0.1791262128):0.6885987235):0.8050138462,(t349:0.7194879892,t350:0.6833392276):0.9531290877):0.03675799982):0.677422907,((((t351:0.7303734676,t352:0.7300040847):0.4862955817,(((t353:0.3666513568,t354:0.3592332773):0.05938839,(t355:0.01834637481,t356:0.01371901997):0.3768580588):0.2920974366,((t357:0.1165593217,t358:0.1148296523):0.1463673032,t359:0.2605358907):0.4166970157):0.4934134272):0.0657811808,(t360:1.036627474,(t361:0.4264176759,t362:0.3583997957):0.6089545063):0.1970125055):0.186473092,t363:1.349041124):0.8591425112):0.3337022137,(((((t364:0.2106423595,t365:0.2043366043):0.4592476857,(((t366:0.2550642917,t367:0.2439357954):0.06197748836,t368:0.294525968):0.02672253233,t369:0.2994844125):0.3193149567):0.5633279495,t370:1.16674073):0.6573369749,((t371:0.313821314,t372:0.2941821545):0.3097537026,t373:0.6016482708):1.197177482):0.1047450147,(((((t374:0.530202908,t375:0.5240191263):0.3243644722,t376:0.8483523214):0.120713926,t377:0.9688107497):0.1960253246,t378:1.163912825):0.1315135606,(((t379:0.4278417412,(t380:0.1253841685,t381:0.1063695176):0.2978225404):0.3758403641,t382:0.7753462497):0.01740574366,((t383:0.01177358146,t384:0.00331870897):0.7152543047,(t385:0.6668594903,(t386:0.58719842,t387:0.5774656028):0.07649146186):0.02821378432):0.05551884922):0.4423083729):0.5953145538):0.5455492436):0.4397745574):1.516168321,(((t388:0.7650345348,(t389:0.1107099419,t390:0.0968763246):0.6486297726):1.328232268,((((t391:0.307754156,(t392:0.1789005401,(t393:0.08087133726,(t394:0.01894775121,t395:0.004566861247):0.05801010097):0.08616446137):0.1251756536):1.063625353,((t396:0.7043436436,(t397:0.2917375492,((t398:0.02659271907,t399:0.01840291996):0.01863631069,t400:0.03434299029):0.2439440194):0.4085546952):0.4108827385,((t401:0.2553489396,(t402:0.1100158835,(t403:0.08781563771,t404:0.08639077165):0.0215515977):0.1322311193):0.6084761819,t405:0.8478549659):0.2160330355):0.2222469805):0.001957145382,(((t406:0.1556551821,t407:0.1545633594):0.832623403,((((t408:0.0173148195,t409:0.009046384456):0.1559274927,t410:0.1595905492):0.2156393947,t411:0.353501074):0.4134879914,((t412:0.3332105705,t413:0.3328451721):0.1946079421,((t414:0.07300986425,t415:0.07230823342):0.325740213,(((t416:0.2178663006,t417:0.1887009783):0.03505780832,(t418:0.07767083267,t419:0.07685974068):0.1421207334):0.1069791739,((t420:0.1180985713,t421:0.1121062278):0.1409877085,(t422:0.1705307257,((t423:0.01985601,t424:0.01853291329):0.02033481056,t425:0.03508863241):0.1270572816):0.08184412797):0.06497401977):0.03635816014):0.1266049436):0.2247271718):0.1694280885):0.02302688358,((t426:0.1128751727,t427:0.08025046116):0.06754989589,t428:0.1247786852):0.6853139993):0.2751922023):0.4726028935,((((t429:0.1950945189,t430:0.1882690251):0.7248119519,t431:0.9092920237):0.2186161138,(((t432:0.1905032832,t433:0.1873353631):0.2762217145,((t434:0.1494247821,t435:0.1445250338):0.1175388277,(t436:0.2010712605,t437:0.1929097562):0.06048166619):0.1808687706):0.5725626975,t438:1.006048295):0.07598004887):0.2797814253,((((t439:0.01873130493,t440:0.01440800552):0.2199119952,t441:0.2315039927):0.9552863915,(((t442:0.213392364,t443:0.2109367821):0.1263627621,(t444:0.1236689187,(t445:0.01621739254,t446:0.005096793168):0.07468155545):0.2123265803):0.6027146473,(((t447:0.3169471675,t448:0.3057209999):0.3039018902,(t449:0.5882584867,(t450:0.3056845956,t451:0.3027817645):0.2789215552):0.01352433239):0.1192963634,t452:0.7116878288):0.1494870379):0.2423263768):0.1335356472,(t453:0.8004454233,((t454:0.04675136683,t455:0.04273740179):0.618091985,t456:0.6497352317):0.1352336203):0.4116752246):0.02132070628):0.1374431046):0.2229103894):1.549689107,(t457:0.7308771819,(t458:0.09191502071,t459:0.08847463537):0.6293809177):2.393997159):0.6233637822):1.208828759,(((((t460:0.2833315173,(t461:0.1852631224,t462:0.1646186017):0.06306606017):0.9616575867,(t463:0.7959368406,(((t464:0.2059490065,((t465:0.06598012568,t466:0.04959076748):0.02145442263,t467:0.06342558741):0.1136413701):0.02344804125,t468:0.1676229641):0.2411292893,t469:0.3655091292):0.3148502621):0.3931196478):0.3886490744,(t470:0.1947038747,t471:0.1835030108):1.237087279):0.9010529728,((((t472:0.07401913429,t473:0.06064323292):0.3901887477,(t474:0.2641128805,t475:0.2613851297):0.1700270387):0.3575795214,t476:0.7749060931):1.472743202,(((t477:0.1547377477,t478:0.1543646122):1.042399248,(((t479:0.1908755715,t480:0.1681665741):0.05486541802,t481:0.2103586171):0.6244750192,((((((t338:0.009333561666,(t1:3.574120197,(t2:0.7146452463,(t3:0.4787559158,t4:0.4784932407):0.2112251683):2.856490752):0.0004410060663):0.2091510123,((t5:1.90592465,t6:1.9058301):0.6695577672,(t7:0.2870584896,t8:0.284950928):2.252932643):1.17232285):0.07438199754,(t9:0.9465291283,t10:0.9260495233):2.835760933):0.1008384599,((t11:3.511804612,(((t12:1.546832615,t13:1.541070822):1.144291109,t14:2.679905641):0.1764532304,t15:2.855107191):0.6416344432):0.3363188323,((t16:1.103516801,t17:1.082060107):1.491462497,t18:2.56486563):1.227447908):0.01079514754):0.8120123286,((((t19:0.9932014091,(t20:0.4833590769,(t21:0.3887874549,t22:0.3882981251):0.08917003711):0.5082344647):2.118977223,(t23:1.318748822,t24:1.295858671):1.785237918):0.3131353704,(t25:1.491213726,t26:1.488945684):1.900259595):0.6314958247,((t27:2.296044356,t28:2.291341801):0.8108076992,t29:3.086954504):0.8951955104):0.5566612214):0.9576151006,((((t30:1.897844779,t31:1.890592946):1.452751954,(t32:2.371393805,t33:2.370856888):0.9589496496):0.01099583975,(t34:1.14738413,t35:1.112518195):2.185601412):2.048249837,(((((t36:2.358793353,t37:2.340032416):0.812465726,(t38:1.901148496,t39:1.897362919):1.192184395):0.7411255121,(t40:3.223472447,(t41:1.941688953,t42:1.941102292):1.28124331):0.6008903373):0.6575108989,(t43:4.119251179,(((t44:1.649314368,(t45:0.09752394474,t46:0.09359823742):1.540167123):1.656450435,t47:3.285800247):0.1841910551,((t48:1.72032389,t49:1.715232817):0.8231266951,t50:2.530995534):0.924728608):0.5941071764):0.3580075453):0.1345236867,((t51:3.161895791,t52:3.153460863):0.3839627276,t53:3.535277846):0.9957532454):0.6288911122):0.07474002278):0.09676672647):0.2999795169):0.03365731145,((((t54:3.952662846,(((t55:2.84073924,t56:2.840306494):1.060726582,((t57:2.699407553,t58:2.698095758):0.4663508121,t59:3.161484579):0.7310347152):0.004763787069,(t60:2.925475128,t61:2.908539811):0.971462823):0.04517389084):0.2883960873,((t62:3.157280527,t63:3.131232195):0.4377899244,((t64:0.0860608768,t65:0.07372311056):2.085880897,t66:2.155378129):1.394493784):0.613464002):0.05736557364,((t67:2.572711228,((t68:1.998598079,(t69:1.901994531,t70:1.898348937):0.09184825046):0.2740472693,(t71:2.163739762,t72:2.146688015):0.08883997316):0.2570714723):0.4850536816,((t73:2.632139534,t74:2.621460382):0.1212575864,(((t75:1.051399425,t76:1.03018341):0.2103591664,(t77:0.2835415864,t78:0.2715463955):0.9472963518):0.88250762,((t79:1.627714516,t80:1.619075541):0.2169571548,t81:1.820410192):0.2445206917):0.5978730067):0.2117658103):1.155443555):0.5027083003,t82:4.527443064):0.8431317643):0.9781935597):0.02322103558):0.3856721283,(((t83:2.613222236,((t84:1.387000836,t85:1.378325891):0.4059641815,(t86:0.9569372556,t87:0.9541051985):0.8079968453):0.8096530015):1.955741362,(((t88:0.6066304603,t89:0.6013451051):2.622360097,(t90:0.6748948828,(t91:0.1501768776,t92:0.1423362195):0.5060828154):2.548476516):0.491034961,((t93:3.184502828,t94:3.184339396):0.08547847036,t95:3.26637404):0.3857682663):0.7898354625):0.5606140944,((((((t96:2.127872334,t97:2.111499335):0.9276503049,(t98:2.917498787,(t99:2.327859852,t100:2.327633016):0.5838458832):0.1139692449):0.2168327209,(((t101:1.771806371,t102:1.769796995):0.6468034498,t103:2.398796462):0.3473086204,(t104:0.3057735618,t105:0.294872233):2.434750406):0.4565124035):0.225407063,(((t106:1.695746775,t107:1.693088795):0.1319579719,t108:1.817760813):0.7297189938,((t109:2.055840071,t110:2.050545471):0.2875448542,t111:2.333347358):0.178950855):0.8473574549):0.7143171101,(((t112:3.667454468,((t113:1.425067177,t114:1.423254829):2.154918469,(((t115:1.970586,t116:1.96071229):0.3249055378,(t117:1.974143762,(t118:0.5036408352,t119:0.4858968854):1.457549252):0.3100249047):1.242823787,t120:3.475474853):0.02748238427):0.06964057463):0.05956214598,((t121:2.349497001,((t122:1.413070288,t123:1.354880728):0.3698509067,t124:1.721582299):0.5339255438):0.7772550084,(t125:2.362660192,((t126:0.5690516656,t127:0.5684031035):0.1280185951,t128:0.6693057474):1.649400655):0.6668158743):0.4961930608):0.005538562901,((t129:1.454682459,t130:1.451007083):1.706879646,(t131:2.630139942,t132:2.623885677):0.5254738841):0.3256638762):0.3151658286):0.2436701752,(t133:3.629290111,((t134:2.928523774,((t135:1.038930641,t136:1.037948666):1.571382404,(t137:1.796905844,t138:1.780590801):0.7899278574):0.2983557769):0.6499900685,((t139:0.2322913241,t140:0.2110929046):1.817168653,(t141:0.4282770773,t142:0.4004768875):1.592488883):1.455848392):0.03583107727):0.3918332686):0.5389746935):1.622500876):2.020012784);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.boombust.T75.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
