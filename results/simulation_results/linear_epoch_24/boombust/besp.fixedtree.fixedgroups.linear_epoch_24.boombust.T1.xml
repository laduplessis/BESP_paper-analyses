<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((t18:3.709357966,((t19:2.595542107,t20:2.59269458):0.2347681315,((t21:1.259807535,t22:1.246361565):1.174933513,(t23:2.260697742,((t24:0.2171882757,t25:0.1722052149):0.5648706292,t26:0.7267472192):1.475268144):0.1455936618):0.3887505776):0.8747225397):0.5072840811,(t27:3.630855054,(t28:3.17351313,(t29:1.765424165,t30:1.72846431):1.399938438):0.4458024812):0.486814339):1.901852528,(((((((t31:2.870372841,t32:2.862218352):0.01535471074,(t33:1.725208178,t34:1.715417351):1.118287927):0.1226701832,t35:2.942812061):0.3740184689,(t36:3.154116358,(t37:2.392743707,(t38:1.950396186,t39:1.945513341):0.4322022653):0.7240314805):0.1475505771):0.4340626756,(t40:2.916836189,(t41:2.446773145,(t42:0.2289508144,t43:0.2228288264):2.195083243):0.4650127048):0.7637947255):0.4998740379,(t44:0.5783430914,t45:0.5764331294):3.565476207):0.3486499534,(((t46:3.055917836,(t47:1.622892315,t48:1.6028144):1.429835483):0.4604545628,((t49:2.608043115,(t50:2.487048115,(t51:0.4069730365,t52:0.4010070105):2.071416862):0.1201852244):0.3244993738,t53:2.910328126):0.5426249478):0.2386285176,((t54:3.180350378,((t55:2.399734616,t56:2.341722596):0.626107113,((t57:2.869111255,((t58:2.2665448,(t59:1.983848199,(t60:1.628809667,t61:1.616979144):0.3410456974):0.282496125):0.1927272277,((t62:0.1561042482,t63:0.1393344883):0.0462984183,t64:0.1818369173):2.230206887):0.3839665319):0.03615463264,((t65:1.960528694,t66:1.959616333):0.5375648613,t67:2.491779795):0.325488119):0.05986389336):0.1239489246):0.179421435,t68:3.175054881):0.3237474499):0.7325919654):1.289989781):2.454302981,(((((((((((t69:2.915002063,t70:2.905404164):0.1754009884,(t71:2.790480985,(t72:0.6017680176,t73:0.5843241655):2.173559622):0.2824347706):0.3328740439,((t74:2.82925863,(((t75:1.0145349,t76:1.013296525):1.629400762,(t77:2.329895369,(t78:0.5165523484,t79:0.515937041):1.812892799):0.2985772273):0.1575703541,t80:2.749197116):0.02236603241):0.2639385311,t81:3.034262147):0.246873716):0.2293919887,t82:3.485295395):0.7849315402,((t83:3.191531618,(((((t84:2.002292404,t85:2.000609074):0.2983049759,((t86:0.6592985378,t87:0.6511087931):1.538134415,t88:2.164076363):0.09800015578):0.1755571467,(t89:1.401356784,t90:1.400200877):1.029630221):0.5230949808,t91:2.94961788):0.01348829497,((t92:1.755039685,t93:1.750454065):0.3195680974,t94:2.059553712):0.863026881):0.1781555096):0.3528154304,((t95:2.862928596,(t96:2.273608737,(t97:2.014705565,(t98:0.9505655262,t99:0.9394335936):1.046696323):0.2469175678):0.588548359):0.2340847878,t100:2.993758581):0.356154803):0.7241023696):1.167397979,(t101:2.02112921,t102:1.989464801):3.20190339):0.4885906475,((((((t103:2.214543856,t104:2.210969859):0.518880404,t105:2.725984252):0.8832968431,((t106:1.961762034,(((t107:0.7318925187,t108:0.7229948191):0.2328592048,t109:0.9522047392):0.8847359632,(t110:1.225927846,t111:1.188989443):0.5984994722):0.1047787607):1.314008218,((t112:2.259893991,((t113:1.002874292,((t114:0.3403974868,t115:0.3399601674):0.5448594257,t116:0.875013319):0.09779486609):0.7751267097,t117:1.744906793):0.476324216):0.1301795009,(t118:0.8626324773,t119:0.8472475903):1.488011788):0.8105553115):0.317971387):0.532122703,(t120:3.984511703,((t121:2.05291674,t122:2.039600539):0.8704551997,((t123:1.629880115,t124:1.627614556):0.4546202212,(t125:1.583219602,t126:1.571199085):0.4940119142):0.8149447419):1.045031403):0.007334120518):0.6038934612,(((((t127:1.759566996,t128:1.751953332):0.35042569,t129:2.098762322):1.07357287,((t130:2.877820121,t131:2.861480514):0.1303667183,(t132:1.56740664,(t133:1.37284287,t134:1.366926253):0.187858827):1.417683038):0.1550158345):0.3141913875,((t135:2.062212511,(t136:0.9165108853,t137:0.9120352288):1.134737908):0.2567894117,(t138:1.026587783,t139:1.002629777):1.268482683):1.109779856):0.2474294201,((((t140:1.651724534,t141:1.649914289):0.7529153368,((t142:1.333892239,t143:1.333151229):0.2900194262,(t144:1.194981486,(t145:0.6899995905,t146:0.6865496777):0.4703118416):0.4251165187):0.7768419773):0.3410212011,(t147:1.265512512,t148:1.254198522):1.428684669):0.3666344934,(t149:0.8436682382,(t150:0.1159474721,t151:0.1124211196):0.7147834572):2.191555308):0.5149277806):0.782978838):0.01462691831,((t152:3.528612973,((((t153:1.812669585,(t154:0.3267162082,t155:0.2894832354):1.47306461):0.9717677976,(t156:2.140598965,(t157:1.994506008,(t158:1.684559135,(t159:0.5208135626,t160:0.5023051401):1.156753301):0.2910196072):0.1374557967):0.5835896702):0.272138421,((t161:2.408752807,(t162:1.801963215,(((t163:0.2273905615,t164:0.2251248344):0.07229871019,t165:0.2973141478):0.7383808264,t166:1.012187353):0.7598672386):0.6061898611):0.2773235896,((t167:1.914474551,((((t168:1.082442872,t169:1.075820413):0.1742106605,t170:1.24538185):0.1160486772,t171:1.354580733):0.2233597653,(t172:0.5673207934,t173:0.5613000787):1.009773164):0.3169282227):0.1078630286,t174:1.994751573):0.622492266):0.251980388):0.1037259256,(t175:1.13592603,t176:1.13336647):1.836251208):0.3587305419):0.760214383,((((((((t177:0.0303985431,t178:0.02483405476):1.455847875,t179:1.452063553):0.5592630499,(((t180:1.203895017,((t181:0.7893139626,t182:0.7861115358):0.0336620068,t183:0.8030461404):0.3729815582):0.2021172223,(t184:1.082876463,t185:1.082161165):0.284302023):0.2567230472,(t186:0.7039731923,(t187:0.6322439946,t188:0.622582633):0.06333655881):0.9148909712):0.3445506814):0.8507727455,(((t189:1.419714502,(t190:1.078406539,t191:1.073287297):0.337031749):0.01930333493,(t192:0.4558008947,t193:0.4444653568):0.9389946096):0.4637125303,((t194:1.517055755,((t195:1.131621771,t196:1.095007762):0.313324455,t197:1.395780902):0.06634837927):0.1027776683,(((t198:0.003885978711,t199:0.001935789773):0.679770722,t200:0.6679645448):0.3198137077,t201:0.9868243448):0.5607282849):0.2163623097):0.8887247402):0.02390837404,(t202:2.271655467,(((t203:0.5179545157,t204:0.5116913163):0.2031435229,t205:0.7090657364):0.01010982954,(t206:0.3578405385,t207:0.3575894961):0.35917956):1.536263739):0.4025670341):0.5055788139,(((((t208:1.553733784,(t209:1.445791851,((t210:0.703539779,(t211:0.05111750703,t212:0.04308083243):0.6412338683):0.5691000871,((t213:0.3845388461,t214:0.3551454535):0.5762931768,t215:0.9282605857):0.2694822006):0.1704925429):0.1012029793):0.4392826957,(t216:1.220140356,(t217:0.4665051648,t218:0.4585025826):0.7420434888):0.6602962209):0.1903701742,(((t219:1.141517538,(t220:0.6441309301,t221:0.6382644239):0.4921841635):0.02852061736,t222:1.107272763):0.1735473754,(t223:0.9385417201,(t224:0.4321510928,t225:0.4245496702):0.499036363):0.3344603678):0.7044250105):0.1955502832,((t226:1.589306094,(t227:1.245149447,t228:1.238351935):0.3358839292):0.3899153196,t229:1.951431326):0.1697018365):0.5593456576,t230:2.680409503):0.2157203276):0.1497380462,(((t231:0.5770054609,t232:0.5647042382):0.3469009599,t233:0.8804019589):1.725402433,((t234:1.450153617,(t236:0.4543853728,t237:0.4515839432):0.9728933191):0.5376815702,(t238:1.875644461,(t239:0.6806196727,t240:0.6692820871):1.179549474):0.08278913155):0.6164610108):0.3920060674):0.04132983219,((((((t241:0.8655120196,((t242:0.3590441886,t243:0.3271418466):0.4551639286,(t244:0.7388857404,((t245:0.5961522552,t246:0.593059933):0.05179417434,(t247:0.567068149,t248:0.5623663643):0.04376451452):0.07145891895):0.03038879093):0.04597758568):1.616688557,t249:2.363705197):0.2066922744,(((t250:0.3433805472,t251:0.3373766729):1.549638038,((t252:1.140189757,(t253:0.9003741658,t254:0.8848601754):0.2388189843):0.1042777422,t255:1.207712851):0.6253014358):0.1183461032,(((t256:0.3551720046,t257:0.354723331):0.763209891,t258:1.082898601):0.2714778388,t259:1.315963995):0.5534241434):0.5525610929):0.04861143505,((((t260:0.2229299956,t261:0.2198523784):0.1724611694,t262:0.3920118656):0.2725529486,t263:0.6617915159):1.606705853,(((t264:0.7052300856,t265:0.7009093474):0.8247150827,((t266:0.282651484,t267:0.2645944274):0.6170147389,t268:0.8803496015):0.6244121142):0.1222330504,((t269:0.4893244164,(t270:0.4288649716,(t271:0.2904648037,t272:0.2809360109):0.0935989432):0.04792517575):1.021631962,((t273:0.5067277505,(t274:0.2001525959,t275:0.1758217723):0.2899187355):0.4983639563,t276:0.96247914):0.4351983544):0.1068796545):0.6135420709):0.1918018867):0.2205581873,((t277:2.015295759,((t278:0.8417447608,(((t279:0.5177262186,t280:0.5155889547):0.1324221836,t281:0.6405348251):0.1413378506,(t282:0.5814454478,t283:0.5766161655):0.1582788829):0.04882090999):1.15614441,((t284:0.7601080952,(t285:0.5149207685,(t286:0.172661637,t287:0.1695661671):0.3403740912):0.2403171851):0.3001995745,((t288:0.6147209489,t289:0.6074358327):0.103182527,t290:0.7034187935):0.3304746971):0.872884284):0.01367269243):0.325472886,(((((t291:1.029371556,((t292:0.9270880915,t293:0.9219659722):0.008514372116,t294:0.8778165162):0.09356888143):0.2209014272,(t295:0.8566163871,t296:0.8556449322):0.3295681988):0.06367996588,((t297:0.4820110336,t298:0.4810610174):0.6051594213,(((((t299:0.1650082412,t300:0.1625325229):0.1368952489,t301:0.2814211994):0.3597308101,(t302:0.0589418572,t303:0.05551206187):0.5798878989):0.2503641681,t304:0.8856428218):0.02917503762,(t305:0.781942591,(t306:0.6819279774,(t307:0.3046778194,t308:0.3032451082):0.375565346):0.07845198176):0.1228969103):0.1417156378):0.1571052017):0.1558153454,((t309:0.7005292886,(t310:0.4085897921,t311:0.4004990107):0.2744029488):0.5051739899,(t312:1.054200158,t313:1.052489847):0.09598637369):0.1138933908):0.6391020785,(((t314:0.6410373057,t315:0.637119836):0.2699504733,((t316:0.7301554939,(t317:0.6512813369,t318:0.6341275185):0.07874149602):0.09905946444,(t319:0.6909862142,t320:0.6768699455):0.08654563775):0.03613676392):0.5760393068,((t321:0.8447906391,((t322:0.1210914211,t323:0.1190545575):0.01598373743,t324:0.1008486488):0.7065118146):0.2727423508,t325:1.077531847):0.2501197353):0.410712881):0.1364969415):0.1830985046):0.0162424568,(((t327:1.106375388,((t328:0.5379402688,t329:0.5277614558):0.3725938567,t330:0.9000995349):0.1844581476):0.08703199331,(t332:0.6504176343,(t333:0.3165288385,t334:0.297151938):0.3318121058):0.4933802433):0.4986232495,(t335:0.01168869714,t336:0.009485210628):1.607899221):0.3639179951):0.0009703031042):0.461103034):0.0282960571):0.9082232545):0.03775350563,((((t337:0.1487857076,t338:0.1409786347):0.07339213796,t339:0.2138574194):2.017300147,(((t340:1.346995503,(((t341:1.073633987,(((t342:0.6078319194,((t343:0.06477972101,t344:0.06238586426):0.1474102897,t345:0.1996787668):0.3773422755):0.08001922251,((t346:0.200191962,(t348:0.01697056171,t349:0.002233237282):0.1454946882):0.0410499911,t350:0.16422219):0.4115252667):0.03698890059,(t351:0.457736341,t352:0.4298543247):0.1449031278):0.3138569451):0.001688898172,(t353:0.3543262432,(t354:0.06292509354,t355:0.06206304002):0.2792264448):0.5305076456):0.003362938204,(t356:0.4823725826,((t357:0.1437467309,t358:0.1419103993):0.1497397277,(t359:0.01191808887,t360:0.008358682834):0.2728688067):0.1871016499):0.3751812518):0.2592533872):0.3022529609,(t361:1.30952134,(t362:0.9446078808,(t363:0.2744921653,(t364:0.1796508572,t365:0.1761304604):0.09258417404):0.657876784):0.3582121489):0.08315380614):0.345116968,((t366:0.5029267851,(t367:0.4304073042,t368:0.4065394176):0.06573493274):0.379840268,(((t369:0.5317430486,t370:0.5130623906):0.0509575959,t371:0.5385903597):0.1998081049,t372:0.7212843349):0.06768528227):0.8216699673):0.2204043478):0.2119569846,(t373:0.04256257027,t374:0.02902314451):1.994092676):0.9466072103):0.1344376466,((((t375:0.04251113641,t377:0.01949915337):0.1825228792,t378:0.1995906618):0.04440925447,t379:0.2425336269):1.100182849,(t380:0.7074915695,t381:0.7057516455):0.6279842329):1.731021647):1.160271778,(((t382:2.173533063,(t383:0.4477724741,t384:0.4433799664):1.693300871):0.3866386897,((t385:0.7173003087,(t386:0.4657334544,(t387:0.123189946,t388:0.1118186662):0.3414418085):0.2421833749):0.1123925164,((((t390:0.01517931987,t391:0.0134856406):0.07175301314,t392:0.07210116299):0.05192576225,t393:0.08970981915):0.6381997393,(t394:0.05320005041,t395:0.04745556633):0.6516525376):0.003309050351):1.686081932):0.614882995,((((t396:0.04561338509,t397:0.03848723634):0.7888301431,t398:0.8248501967):0.6664981166,((((t399:0.3883251918,((t400:0.2702451726,t401:0.2691473528):0.06592396904,t402:0.3295776299):0.02641179946):0.02157217498,(t403:0.363618982,(t404:0.09778452306,t405:0.09657483593):0.2606698672):0.01077664753):0.1768053846,(((t406:0.0908191484,t407:0.08975494418):0.1495044363,t408:0.2289533417):0.2387809061,(t409:0.4263737308,(t410:0.3279872523,(t411:0.08379340668,t412:0.03098577903):0.1804293153):0.09646693466):0.008221081621):0.06016808788):0.4786001931,(t413:0.2499543396,t414:0.2492196133):0.5891351944):0.4073928609):0.1742594415,((t415:0.02993472777,t416:0.02720229287):0.6319749571,(t417:0.3826658312,(t418:0.2561055964,t419:0.2526081835):0.125319025):0.2706577979):0.7578674238):1.324591007):1.032902959):0.2102023915,((((((t420:0.6131337128,((t421:0.184290824,(t422:0.1571764224,t423:0.1559069715):0.007370557571):0.08233310303,t424:0.2219741169):0.3254910916):0.2211196576,((t425:0.2071287424,t426:0.1796393099):0.4456911383,t427:0.6234440136):0.1024210572):0.2953518638,(t428:0.8337809451,t429:0.831367524):0.1841619751):0.06545482074,(((t430:0.1502912782,t431:0.124345354):0.2726402305,(((t432:0.08043532872,t433:0.06558538861):0.08841932229,t434:0.1527694863):0.1372646468,t435:0.2785982638):0.08196307189):0.2338268755,t436:0.593854573):0.3950407498):0.3943039328,(((t437:0.545428148,(t438:0.4339635598,t439:0.4242840889):0.1029053858):0.3032594307,((t440:0.07485216607,t441:0.07294344393):0.0738639688,t442:0.1437679212):0.6606404357):0.4155909823,(((t443:0.08778672729,t444:0.08413171867):0.05739839476,t445:0.1407834446):0.5171273845,(t446:0.5186878491,t447:0.5052070751):0.1163822646):0.5568106582):0.1148273):1.853182877,(t448:1.015834558,((((t449:0.168485736,t450:0.1629838837):0.1786931515,t451:0.335877179):0.2337685318,((t389:0.01132614329,(t376:0.01363886254,(t347:0.002484425635,(t331:0.01351508028,(t326:0.006159537611,((t235:0.01203833769,(t1:0.1668725229,t2:0.1603671367):2.488951837):0.5422416043,(t3:3.108796442,(t4:2.932791787,t5:2.931995653):0.1310981326):0.06226986829):0.4146160142):0.04691467286):0.1790823026):0.3305503217):0.1193272513):0.7118459724,((t6:2.657028044,t7:2.611224507):1.840829635,((t8:3.485325358,((t9:2.620334541,(t10:2.204448372,t11:2.154889028):0.3636420745):0.8260271957,(t12:1.067043909,t13:1.043021038):2.268463371):0.009461374732):0.509853331,((t14:0.4263567713,t15:0.4260036484):3.03578077,t16:3.441137629):0.3632587861):0.4362924257):0.4148858426):0.5595564791):0.1005379382,t17:5.295631595):0.3246871869):2.121169376):0.5130123196):0.3318481226);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.boombust.T1.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
