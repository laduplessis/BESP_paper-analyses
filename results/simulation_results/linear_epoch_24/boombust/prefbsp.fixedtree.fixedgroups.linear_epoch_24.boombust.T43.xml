<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((t254:3.074574066,(((t255:1.338416526,t256:1.336188513):0.3686739777,((t257:0.7397766349,t258:0.7329500667):0.4798805109,t259:1.187003984):0.4834622463):0.7820665921,((t260:0.3697789781,t261:0.3601395633):1.701484362,(t262:1.652469491,(t263:0.614125567,t264:0.5710584416):1.033802317):0.4061336582):0.3407463162):0.577651966):0.1676059695,((t265:1.696517775,(((t266:0.3937666796,t267:0.3878093378):1.123905189,(t268:0.4605904852,t269:0.4516074736):1.048221092):0.1061848487,(t270:0.9241961882,((t271:0.6981696242,(t272:0.6174052841,(t273:0.2781586457,t274:0.2754982306):0.3293937848):0.06051119118):0.128847961,(t275:0.1435979848,t276:0.143067296):0.6489437822):0.09166557782):0.6587952526):0.05325772889):1.055680514,(((((t277:0.5560502749,t278:0.5522356334):0.4366113665,((t279:0.40879839,(t280:0.2526176836,t281:0.2350072086):0.1515774711):0.4809574261,((t282:0.2334569179,t283:0.2277726348):0.3441821384,t284:0.5705320796):0.2841454977):0.08571490685):1.354750702,((((t285:1.536324542,(((t286:0.1002783063,t287:0.08275046438):0.2429355332,(t288:0.1682776304,t289:0.1251411168):0.1516731689):0.6064234222,t290:0.846174253):0.5638408797):0.1450274166,((((t291:0.2416940524,t292:0.2197662741):0.2004228593,t293:0.3922239974):0.2755723975,((t294:0.1835725271,t295:0.1831283001):0.1226638596,t296:0.2990426634):0.3566301065):0.4955218241,((t297:0.9098829443,(t298:0.2358005952,t299:0.2355037212):0.6727810017):0.07866679039,(t300:0.3595666834,t301:0.3488236972):0.6072145665):0.1515206611):0.319848128):0.019177277,(t302:0.6286712027,(t303:0.4137049534,t304:0.4036470492):0.2107558506):0.8125565884):0.1379591358,(t305:1.31987884,((t306:0.2579987902,t307:0.2550977498):0.5594248019,(t308:0.625975741,t309:0.6175957342):0.1745923121):0.4739962317):0.2449676718):0.4446762927):0.1734840604,(t310:2.082256919,(((t311:0.7971996939,t312:0.7811511804):0.0449704401,(t313:0.5804072285,t314:0.5719305899):0.2225272241):0.5321565276,(t315:0.8970406603,(t316:0.2027322226,(t317:0.05070237155,t318:0.03802605554):0.1511949706):0.6843161526):0.4270919701):0.6733569871):0.03671409648):0.01259797097,(((((t319:0.2143684144,(t320:0.1702428926,t321:0.1605091129):0.01611064358):0.5937063795,(((t322:0.3458046045,(t323:0.2994025087,t324:0.2893477867):0.04347965266):0.1667845835,(t325:0.1025741905,t326:0.08852086267):0.395151931):0.06459939075,t327:0.5469500418):0.17619702):0.09564450427,t329:0.7560246816):0.2178002421,((t330:0.3770759338,((t331:0.1229766984,t332:0.1187267595):0.2216129415,t333:0.3318978719):0.03225903822):0.4994333042,(t334:0.6956259235,(t335:0.3213639376,(t336:0.01738831482,t337:0.003456260441):0.3030141769):0.3602433888):0.1567946529):0.07944114954):0.709943679,(t338:0.45175408,t339:0.431757382):1.153061007):0.1734550595):0.1167079856):0.3203298953):0.1794092448,((t340:0.4497151907,t341:0.4445972148):1.357629651,((t342:0.8390823808,(t343:0.6078646348,(t344:0.3948525044,(t345:0.1152075146,t346:0.1078051388):0.2790017678):0.2102756479):0.2137815169):0.531676061,(t347:0.5549799894,t348:0.5543994636):0.7765717248):0.4295045139):0.5482482829):0.3613732852,((((t349:0.8999693573,((t350:0.319245353,t351:0.314041778):0.1988213364,((t352:0.362342464,t353:0.3354588006):0.1355219332,(t354:0.3639519639,t355:0.3327151579):0.1021134561):0.01345733971):0.3768479857):0.4846282886,(t356:1.07485337,(t357:0.33393474,t358:0.3241311225):0.7202632944):0.2335079313):1.088227346,((((t359:0.852793413,(((t360:0.3329274637,(t361:0.1121815316,t362:0.1119734623):0.212321522):0.1175825165,t363:0.4193569357):0.3277613584,(t364:0.5961819963,((t365:0.1645507362,(t366:0.04885706202,(t367:0.006093581566,t368:0.002222891441):0.0299428479):0.1140542873):0.2938329359,t369:0.430346416):0.120604465):0.1505086757):0.07124181296):0.5693708057,((t370:0.09834721765,t371:0.08926876683):0.7448517265,t372:0.8022476736):0.472651785):0.04042460396,((((((t373:0.09000034573,t374:0.08588659613):0.6119828551,(t375:0.1339895853,t376:0.1172548804):0.549530659):0.2405220803,t377:0.8769812586):0.1398185056,t378:1.010895542):0.02106020657,t379:1.030907176):0.1047029803,(t380:0.5822361149,t381:0.5496552161):0.5525571352):0.09074073811):0.3384410063,((((((t382:0.05092144715,t383:0.04698100271):0.1327047702,(t384:0.1669093012,t385:0.1663271929):0.008707162047):0.3066587733,t386:0.47039131):0.3245451573,(t387:0.5571720681,t388:0.5535985971):0.2207545585):0.1133908893,(t389:0.04382954539,t390:0.04131687215):0.8425621686):0.03620926714,(((t391:0.1067447256,t392:0.09890086863):0.4806755023,(t393:0.5205615292,((t394:0.2450037687,t395:0.2353843645):0.04129322707,t396:0.2538736168):0.2103405403):0.05750506262):0.3074772,t397:0.828682027):0.0235907858):0.5477778045):0.5593287764):0.1045890264,(((t398:0.9174567936,(t399:0.1316571989,t400:0.1259011831):0.7765571382):0.3426263099,((t401:0.1170197048,(t402:0.07320520226,t403:0.05361916406):0.04183462483):0.8685500928,t404:0.9575119573):0.2391706507):0.4247909015,(t405:0.4460571743,(t406:0.01939769742,t407:0.01667409563):0.4153741956):1.163592681):0.3731454032):0.06042103005):0.06557501894,((((((t408:0.4310502532,(t409:0.2840828056,t410:0.283807666):0.1464943451):0.1782202824,((t411:0.07545767773,t412:0.06403435448):0.2824525706,(t413:0.2950867156,t414:0.2944251515):0.01697449758):0.2373996269):0.1800437658,t415:0.727822069):0.3502328966,((t416:0.1366022217,t417:0.1346886775):0.1336294112,t418:0.2654057721):0.8031763302):0.6122523528,(t419:0.2946863172,t420:0.2861619407):1.372886318):0.04227570502,((((t421:0.9138406254,(t422:0.1867907267,t423:0.1661420489):0.711846993):0.1406411106,(t424:0.3650217927,t425:0.3496746162):0.6243604421):0.3172511888,((t426:0.3360423629,t427:0.3279940829):0.9146022556,((t428:0.1352144826,t429:0.1181245054):0.7406744893,t430:0.831356477):0.3532923798):0.02021231719):0.2870941001,(((t431:0.1985955688,t432:0.180863442):0.2314850112,t433:0.4053906463):0.118335285,(t434:0.00597041625,t435:0.004042258427):0.5143363693):0.9398545837):0.03147981566):0.2937967215):0.3930523524,((((t436:0.2172070504,t437:0.1945552104):0.3950931325,((t438:0.1052794081,t439:0.06293026771):0.2452585571,t440:0.3078926708):0.2281051609):0.1176520696,t441:0.6389843349):0.859581695,((t442:0.4011224885,t444:0.3756893386):0.2137237123,t445:0.5735493941):0.8638511825):0.5849279468):0.9552853551,((((t446:1.341748679,(t447:1.29026362,((t448:0.1214696341,(t449:0.03082541576,t450:0.02714680471):0.07848921626):0.1417578587,(t443:0.009607817708,(((((t328:0.006645473156,(t1:3.624643238,(t2:2.797414043,((t3:0.4493242108,t4:0.4130620293):2.17946179,((t5:1.230331139,t6:1.224067942):0.04409763386,t7:1.259296433):1.317529858):0.09986069994):0.8270269943):0.03108304624):0.58821645,t8:4.109955077):0.250821752,((t9:2.605205335,(t10:1.839219599,t11:1.835951918):0.7547447169):1.141882163,(t12:1.030970147,t13:1.01997028):2.687120484):0.5988347361):0.02587318355,(t14:3.754336044,((t15:0.8925245658,t16:0.8915238011):1.341027131,t17:2.220791672):1.504438704):0.5433098095):0.1015359666,((((t18:3.282129064,(t19:3.24539931,t20:3.23741459):0.02162228012):0.3065397503,((t21:0.9851879103,(t22:0.8107464081,(t23:0.2831450207,t24:0.2730206561):0.515518696):0.1646342342):1.450331949,t25:2.394821958):1.121074958):0.06198164819,(((t26:2.705214763,(t27:0.7484489897,t28:0.7460730949):1.952022649):0.1376440935,t29:2.83472718):0.3820835826,(t30:2.381256611,t31:2.374247528):0.8323292188):0.3268260081):0.2078665013,(t32:2.65737105,t33:2.656181868):1.082719526):0.5018962538):0.292005052):0.313840492):1.012274466):0.04495496492):0.4179905374,((t34:4.710621027,(t35:3.837204428,(t36:2.76783402,(t37:0.3472411748,t38:0.3471821137):2.414971908):1.06894115):0.8518675381):0.140370681,(((((t39:0.428784958,t40:0.3744717365):2.043165323,((t41:0.4760111531,t42:0.4744150998):0.9604347022,t43:1.426683865):0.9802732554):1.470171869,((((t44:0.5150196799,t45:0.5052605646):1.162030698,t46:1.665071438):1.94299754,(t47:3.185585814,(t48:3.015440281,(t49:0.6994051757,(t50:0.1998572793,t51:0.1878841326):0.4890295061):2.315187497):0.1518061015):0.4092893913):0.2063774192,((((t52:0.6146247728,t53:0.6085544252):0.9124477752,((t54:0.4407314162,t55:0.4361380291):1.009611255,t56:1.430703243):0.05105363036):1.179792224,(t57:2.019766135,t58:2.015469883):0.6392156215):0.02299179805,t59:2.665688865):1.02297544):0.02321382285):0.3795640744,t60:4.083423642):0.1334186493,(t61:3.387145439,(((t62:0.09750399551,t63:0.07961627044):1.826134296,t64:1.90284452):1.03196469,((t65:0.2957220475,t66:0.289839246):0.3685896702,t67:0.6420854531):2.260637583):0.4073293304):0.823209545):0.3664533208):1.464721136):0.4117537517,(((((t68:2.771024043,(t69:2.106592842,(t70:1.648207648,(t71:1.078877191,t72:1.069417211):0.5551390405):0.4545387783):0.6572978229):0.3567140391,(t73:2.992620165,((t74:0.484215556,t75:0.4618085919):2.001077916,(t76:1.359436174,t77:1.358060587):1.08132138):0.4869784549):0.09329979317):0.7484504157,((t78:0.2924623434,t79:0.2886791211):2.93612444,((t80:2.039241121,(t81:1.757884503,((t82:0.4021443424,t83:0.3980871347):1.209070622,t84:1.569846128):0.1465952843):0.2684659278):0.4452006152,(t85:1.973965257,t86:1.973445258):0.4396501358):0.7343181142):0.5324843388):1.768499059,(((((t87:2.991979861,(t88:2.663243765,(t89:1.932084795,t90:1.931879436):0.7226923964):0.3277463791):0.1175074555,t91:3.097676399):0.6482911786,((t92:2.715458523,((t93:2.26928371,(t94:2.065261351,t95:2.058554301):0.1944342675):0.1512354563,t96:2.40073349):0.2941436425):0.9965976315,((t97:3.174576406,(t98:0.07783231652,t99:0.06999747975):3.086721161):0.2742528818,(t100:2.965724887,((t101:2.630719335,(t102:1.818347288,t103:1.810647534):0.8025924476):0.1249491652,((t104:0.9010336236,t105:0.8857715756):1.430984453,t106:2.310576811):0.3724553722):0.204788501):0.4643475016):0.2242898309):0.01184611862):0.6180841099,(((t107:3.572199199,((t108:1.412885438,t109:1.402049016):2.038722235,((((t110:1.207220037,t111:1.196814375):0.6019302116,(t112:1.119918208,t113:1.113726382):0.6782087895):0.1175679004,t114:1.907567547):1.356599109,(t115:3.02837535,(((((t116:0.413269228,t117:0.4124612341):1.746752938,(t118:1.211796774,(t119:0.4903496023,t120:0.4654481345):0.7154306824):0.9389703898):0.06810189458,t121:2.186864954):0.5543977905,(((t122:0.9513031323,(t123:0.6709717505,t124:0.6686873312):0.277719175):1.070851157,t125:2.01618378):0.5310911288,(t126:1.454444982,t127:1.453584768):1.069043825):0.1644522304):0.01045130547,t128:2.688512083):0.2221353591):0.2320393447):0.138824048):0.1104565374):0.03214558225,((t129:3.133142219,(t130:0.4070841985,t131:0.4005513441):2.716513824):0.2227172412,(t132:3.258876461,(t133:2.951859313,t134:2.942922812):0.306421936):0.06847592028):0.06697726913):0.3451254037,((t135:2.10593879,t136:2.100151371):1.138098282,(((((((t137:0.7125337307,t138:0.6943835161):1.569091264,t139:2.262432712):0.1999042043,(t140:1.503598076,((t141:0.3846070308,t142:0.3796516042):0.1897875448,t143:0.5669396492):0.8932159937):0.9525460215):0.5965136741,((t144:0.3764889056,t145:0.3546253926):2.259212691,t146:2.594264682):0.3674056109):0.06994327645,(t147:1.398139319,t148:1.383827681):1.619987518):0.02783800726,t149:3.021907635):0.02356833043,((t150:0.1500200712,t151:0.136175383):1.948732541,((t152:0.9647087281,t153:0.9538333225):0.08485575612,t154:1.010100224):1.032282335):0.94581857):0.02434803901):0.4842061256):0.2517013679):0.2747739487,((t155:1.98346579,(t156:1.705150972,t157:1.699868662):0.2725158282):1.086754434,((t158:2.240246485,t159:2.239129181):0.7959517725,((t160:2.377414628,(((t161:0.7636270695,t162:0.7627252478):0.4917620398,(t163:1.232240744,t164:1.207806316):0.008008468013):0.3230000869,(t165:1.110246055,t166:1.100479152):0.4263298079):0.7914956483):0.03577703376,t167:2.353511584):0.6174586167):0.0209236589):0.9362125171):0.7838433151):0.1828330068,(((t168:3.093015285,((t169:1.76583146,t170:1.761850453):0.680022956,((t171:1.304643042,t172:1.298929148):0.2241315136,t173:1.520204923):0.905989554):0.6401196541):0.5580601822,((t174:3.080352471,((t175:1.217456439,t176:1.18072806):1.021514849,(t177:1.725200542,t178:1.722061635):0.4545330153):0.8324123757):0.1397136354,((t179:2.314140592,(t180:2.051121428,t181:2.041629935):0.2628287967):0.2611670663,(((t182:1.141810334,t183:1.129017286):0.6513789115,(t184:1.432497758,(t185:1.408577421,(t186:1.268537001,t187:1.268475886):0.1087807206):0.01789877046):0.3424999802):0.6143328455,(t188:0.9424729385,(t189:0.8628746552,t190:0.8454674666):0.07580235218):1.39958505):0.1486285586):0.5494217336):0.3709917826):0.1506231345,(((((t191:1.387559142,t192:1.374041613):0.919810208,(t193:1.391261562,t194:1.382385486):0.8974993814):0.3576120522,(t195:2.334596423,(t196:1.839345238,t197:1.831767078):0.492182449):0.2924880682):0.3150103639,((((t198:1.376339901,t199:1.370366096):0.1216040581,t200:1.485862429):0.267493979,(t201:1.542348976,((t202:0.4892605605,t203:0.4433377555):0.8580195062,(t204:0.639848104,t205:0.6339483999):0.64902874):0.1869283131):0.2087692658):0.5050606803,t206:2.170863986):0.6530246326):0.114895023,((t207:1.242510846,(t208:1.206075517,(t209:1.049172394,(t210:0.2405341222,t211:0.2163057654):0.7933139603):0.144208459):0.02994712007):1.584074899,(((t212:1.142168844,(t213:0.9813602531,(t214:0.8987015985,t215:0.8932759022):0.06565285626):0.1559513171):0.4912308038,(t216:0.6439112825,t217:0.6292170855):0.9506424116):0.5249006807,((t218:1.864543436,((t219:1.050829383,(t220:0.9126455942,t221:0.9020407978):0.1377233807):0.3757390588,t222:1.412732865):0.4263685918):0.2099564979,t223:2.046681702):0.02347188911):0.5973198665):0.1119294811):0.4204190408):1.090990441):0.5446717388):0.6660141235,(((((t224:0.7905918696,t225:0.7902113401):0.1334177831,t226:0.9224827388):1.543235318,((t227:0.7479013625,((t228:0.2152820289,t229:0.2126598785):0.01881806822,t230:0.2258921672):0.5027343326):0.3069237843,t231:1.033349107):1.409244521):0.217196536,t232:2.60095827):2.630574031,(((t233:1.193043166,(t234:0.8991182871,t235:0.8773661044):0.2409488057):0.3548830236,(t236:0.2795673492,t237:0.2589038961):1.166487466):1.375721491,((((t238:0.9141146799,(t239:0.7195802425,(t240:0.664535471,t241:0.6625430031):0.0164146474):0.1822678598):0.8392367663,t242:1.684736307):0.4824702036,t243:2.155683669):0.5319403559,((t244:0.01001591195,t245:0.004674628364):2.303878233,((t246:1.291644362,((t247:0.9975829138,t248:0.9969778917):0.1131448121,(t249:0.2249030785,t250:0.2233366032):0.8789489477):0.1604237309):0.6467800522,(t251:1.165301501,(t252:1.13327182,t253:1.126002625):0.0304320614):0.7071409354):0.3697300098):0.3735927888):0.01808780898):2.299379564):0.1638573611):0.1376496721);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.boombust.T43.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
