<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((((((t3:3.232198031,((t4:0.8106093615,t5:0.7865397367):2.406213127,((t6:2.458180602,t7:2.441962189):0.6468103685,t8:3.067279844):0.08674017616):0.004020362591):0.9815421061,((t9:1.369448544,(t10:0.2641366451,t11:0.2576315911):1.102076312):2.314774729,((t12:3.30013571,t13:3.298318797):0.2466766434,t14:3.542007624):0.1124443894):0.443522936):0.06209713538,(((t15:0.6931392943,t16:0.6893767385):1.421211493,t17:2.096520881):1.941946119,t18:4.01238343):0.1029527099):0.406944486,(((t19:0.770831398,(t20:0.6669679012,t21:0.6636405735):0.059172898):2.076945956,t22:2.798992349):1.63977961,((((t23:2.031865543,t24:2.024391108):1.115529422,t25:3.129961332):0.07702740847,t26:3.201811407):1.052617316,(t27:2.069535001,t28:2.063274338):2.172186763):0.1462356191):0.03021564517):0.7270670051,(((t29:0.3797782338,t30:0.3732967697):1.673997943,t31:2.038734244):2.363742347,((((t32:2.233859323,t33:2.219197586):0.9774118071,(t34:1.821866426,t35:1.810013613):1.356954123):0.9129704737,(((t36:2.602609977,t37:2.598084345):1.276782181,(t38:3.250121224,t39:3.243829455):0.6093470507):0.166816355,(t40:3.875099975,t41:3.847690157):0.1366856623):0.03112069308):0.04646407213,((t42:0.8495865622,t43:0.8380028597):2.689662554,(t44:3.073641066,t45:3.069171491):0.4506223112):0.5028568932):0.2120234796):0.7191318637):0.979646684,((((((t46:0.7431856915,t47:0.7235440642):2.822473228,(((t48:1.174918592,(t49:0.6161779314,t50:0.6090877144):0.5529550503):2.194986585,(t51:1.370272017,t52:1.361062279):1.967657954):0.05646614573,((t53:0.7224014097,t54:0.708692161):1.328209548,((t55:1.439842289,t56:1.437275091):0.08248686127,t57:1.503720182):0.5060426935):1.32817552):0.1120539935):0.1716089308,(((t58:2.196292685,(t59:1.174693679,t60:1.158460496):1.012023208):0.4750660604,t61:2.640554502):0.7460136829,t62:3.372043823):0.1818886878):0.3282626447,t63:3.87215714):0.3192145115,(t64:0.8753893311,t65:0.7856114942):3.305283505):0.2046692192,(t66:3.747031642,(t67:2.941447314,(t68:0.2508987405,t69:0.2473119248):2.690124557):0.8034402149):0.5302209212):1.331832869):0.3521100421,((t70:3.06406244,(t71:1.399211363,(t72:0.4004773289,t73:0.392398084):0.9778579068):1.664540878):1.169853031,((t74:2.077370038,t75:2.075537246):1.682955235,((((t76:3.184337312,((t77:2.44259464,t78:2.430674252):0.4328491897,(t79:1.5754237,t80:1.563392922):1.281667022):0.3064053975):0.1962041711,t81:3.296698972):0.1096566021,(((t82:1.172236283,t83:1.151074227):1.111811101,(t84:1.291064588,t85:1.290405416):0.9705873459):0.6159613802,t86:2.875870258):0.4874517766):0.02103879285,t87:3.374004381):0.2145099606):0.4439600024):1.700855556):0.697829162,(((t88:3.514114045,(((((t89:1.691247875,t90:1.678603714):0.09530923189,t91:1.77183716):0.8390927241,t92:2.605988191):0.3281927797,t93:2.915317735):0.1489339638,(((t94:0.6058459188,t95:0.5877828926):1.620587135,(t96:1.582184694,t97:1.57304518):0.6004233772):0.4672565398,t98:2.611818305):0.3673227446):0.361101209):0.1430541087,(t99:2.784835523,(((t100:2.292816304,((t101:2.011473476,t102:2.010588524):0.2691508724,(t103:2.070234952,(t104:2.047696913,(t105:1.990696352,t106:1.99012623):0.04818389898):0.01371710285):0.208720349):0.01209338538):0.3186352026,t107:2.587337747):0.1244939218,t108:2.702571889):0.004642483114):0.6976249656):1.381568542,(((((t109:3.149977273,((t110:2.398610353,(t111:1.267689837,t112:1.222094061):1.093116752):0.444951277,t113:2.750941578):0.2779746978):0.5688825223,(((t114:1.913369134,t115:1.910901413):0.673223469,(t116:2.451381727,t117:2.435787337):0.1113402985):0.8425700678,((t118:1.143961029,t119:1.129039696):0.06518387254,(t120:0.8673931002,t121:0.8566447311):0.3227317966):2.171577522):0.1528499434):0.1094612807,(((t122:1.620444828,t123:1.610161614):0.84463012,(t124:2.31825743,t125:2.309186677):0.1328957662):0.589833457,((((t126:1.772597072,t127:1.749664431):0.1119970197,(t128:0.4042813511,t129:0.3907624341):1.442209971):0.3590971447,(t130:1.731217187,(((t131:0.5985886191,t132:0.5954193164):0.2379985717,t133:0.8290156578):0.2576190703,t134:1.068906019):0.6303435968):0.4608332067):0.7229776166,(((t135:1.225687468,t136:1.220401):0.534246553,t137:1.741256836):0.3854276056,((t138:1.158778714,(t139:0.0218499314,t140:0.01944792408):1.134906823):0.1932879422,(t141:0.6801993433,t142:0.6557604867):0.6401666933):0.7459243673):0.7201111472):0.05962958056):0.5387872879):0.4023188951,(((((((t143:0.7142079333,t144:0.6860082015):1.104062247,t145:1.784036322):0.1085693455,(t146:1.802568831,(t147:0.5392173857,t148:0.5381502935):1.26245366):0.08486701884):0.02952633446,((t149:1.560887818,t150:1.52954529):0.3346413982,(t151:1.589297019,t152:1.568700893):0.2708346675):0.00138503903):0.743021961,(t153:2.389131987,((t154:0.5517650417,t155:0.5397845104):1.808986444,(t156:1.570239284,(t157:0.01743063453,t158:0.01680744556):1.548338125):0.770366904):0.01572411759):0.1925846489):0.05211787714,(((t159:1.338167481,t160:1.320833266):0.6140096343,(t161:1.418923934,(t162:0.4975448464,t163:0.4918948402):0.9178614284):0.5050323424):0.5991958387,((t164:0.2337975282,t165:0.2225300984):1.763999425,((t166:1.07368858,t167:1.072317219):0.6767803985,(t168:1.577701436,((t169:0.7409832129,t170:0.7312030255):0.404997456,(t171:0.6878523713,t172:0.6728211339):0.4360306491):0.4058452697):0.170807364):0.2357115366):0.5142423676):0.04425706066):0.6824316635,((t173:1.259783218,(t174:1.12003118,t175:1.110440461):0.1370008541):0.9431793452,(t176:1.393197135,(t177:0.7731506693,t178:0.763636967):0.6085837155):0.7926603649):0.9374420809):0.3030021):0.01826123341,(((((((t179:0.2781977563,t180:0.2692055953):0.2002459364,t181:0.4683931451):1.455259647,((t182:0.6888630111,t183:0.6874802339):1.122835481,((t184:0.3976172809,t185:0.3920898818):1.284079697,((t186:0.435190767,t187:0.4169096836):0.07625646265,t188:0.4911242884):1.162818949):0.1186089986):0.09194075469):0.1215585177,((t189:1.514504695,(t190:0.1820174255,t191:0.1504910444):1.329944814):0.3481403703,(t192:1.62588689,(t193:1.462701875,((t194:0.8657428761,t195:0.850098585):0.4939393431,t196:1.338745378):0.09543387563):0.1564297019):0.1901941616):0.122414727):0.09280072817,(t197:1.179699944,t198:1.173237695):0.811690332):0.2481965337,((t199:1.73201012,(t200:1.074259998,(t201:0.1434489354,t202:0.1427674744):0.9135652696):0.6438696182):0.1182212286,((t203:1.169808869,t204:1.162142108):0.4241528751,((t205:0.6809696941,t206:0.669642197):0.8539169814,t207:1.522730103):0.05114948438):0.2106223301):0.3790135843):0.5632822781,((t208:0.5580594673,t209:0.5465810914):1.789945618,((t210:0.6838194931,t211:0.6808172407):1.511150557,(((t212:1.411858029,t213:1.402758187):0.5326408422,t214:1.933432271):0.1286000233,(t215:0.06035574788,t216:0.04219592499):1.983521161):0.1161942486):0.1406096007):0.3760731202):0.4245439947):0.5355283882):1.360716767):0.362736869,((((((((t217:0.7623724427,(t218:0.3581378032,t219:0.3505097197):0.3975009196):0.06039268602,t220:0.7949915253):0.2907731147,t221:1.073524931):0.8719572576,(t222:1.900020574,t223:1.896561427):0.03955447318):0.08113760468,(t224:0.8638554981,t225:0.8561903332):1.132236383):0.006922934188,(((t226:1.238011028,(t227:0.9263626668,t228:0.9249816344):0.3008322433):0.1631577208,t229:1.377064148):0.4322216925,(((t230:1.02674459,t231:1.024123237):0.1186306276,((t232:0.5437624546,t233:0.5415643295):0.2443803348,t234:0.7786361171):0.3487037906):0.3949313543,t235:1.519640747):0.2014759784):0.1504708557):0.6961527736,(((t236:1.105640588,t237:1.099990352):0.4711107585,((t238:0.05699093562,(t239:0.01571221888,t240:0.005323632304):0.03228216904):0.7210596495,t241:0.7381146961):0.7915146467):0.7880047305,(((t242:1.32319754,(t243:0.8004273102,(t244:0.5493783343,(t245:0.1144764349,t246:0.09184150322):0.4250475405):0.2418100861):0.5127942927):0.58331606,((t247:1.090943397,(((t248:0.02456169516,t249:0.01265438442):0.1284349235,t250:0.1224052289):0.469175078,t251:0.5878920706):0.4662581951):0.1266820794,(t252:0.7267644207,t253:0.7243797949):0.4381293211):0.6036450443):0.2865579709,((((t254:0.616784464,(t255:0.09761420594,t256:0.093589581):0.5172839595):0.2880577541,((t257:0.600074466,t258:0.5855383881):0.2888139052,t259:0.8721945865):0.003410694496):0.8377620628,(t260:0.6742243176,t261:0.6562859073):1.038499509):0.1841271282,((((t262:0.5056737811,t263:0.4974795259):0.3573176128,((t264:0.6860791202,t265:0.6597737225):0.02550413855,(t266:0.159986413,(t267:0.1298058978,t268:0.1238364037):0.0300041402):0.5107740369):0.1348118453):0.6899014086,t269:1.486737033):0.2483655826,(((t270:0.2241896685,t271:0.2080348464):0.3525122106,t273:0.4989629099):0.710126343,(t274:1.010966212,t275:1.009573523):0.1959649148):0.4475768189):0.05742367416):0.1232559627):0.1118526258):0.197934344):0.9326423131,((t276:0.2124788866,t277:0.2024365545):2.624023401,(((t278:0.934351761,(t279:0.3354542515,((t280:0.2416785449,((t281:0.09112132978,t282:0.08351816158):0.01996930755,t283:0.1032494938):0.1184935633):0.005015594627,t284:0.2125887751):0.08838694693):0.5696415915):0.7205139825,((t285:0.2329463472,t286:0.2237032865):1.3245232,((t287:0.363338574,(t288:0.02088495585,t289:0.02046568815):0.3326680324):0.8996433718,(t290:0.9086523311,(t291:0.6117703074,t292:0.6047619315):0.2844534833):0.2692657385):0.2812849577):0.005913542219):1.091846522,(t293:1.585408018,((((t294:0.337290281,t295:0.3107591983):0.3198148255,(t296:0.4394406008,t297:0.4362781068):0.1902356988):0.2011398818,(t298:0.6845522717,(t299:0.3195299031,t300:0.3161827713):0.3610052427):0.1417903931):0.2046140852,(t301:0.251544169,t302:0.2506901945):0.7687820369):0.5031566044):0.9507209428):0.0743972513):0.2393165355):1.604852503):1.188113881,(((((((t303:0.2641073273,(t304:0.1189584817,t305:0.0830365923):0.1324308022):0.0253009417,t306:0.2220859425):0.01978190255,t307:0.2385678365):0.5311024765,((t308:0.4538725652,t309:0.4366816455):0.2446581724,(t310:0.412778407,t311:0.4037676841):0.2651720375):0.06819121856):1.006360581,(((t312:0.5698422873,t313:0.5594337359):0.2503897881,t314:0.788108877):0.4840273685,(t315:1.04710023,((t316:0.743104444,t317:0.7413351336):0.2707920658,(t318:0.4184323795,t319:0.4136148761):0.5799799288):0.02011372923):0.2164878433):0.4303351081):0.9552009196,((((((((t320:0.2041125809,t321:0.2005616367):0.3979026478,(t322:0.4415584749,t323:0.4349535475):0.1534410385):0.05361361499,t324:0.6418722984):0.4560633741,t325:1.093091947):0.4548405858,t326:1.534697158):0.2211278398,t328:1.732252899):0.3377167177,((t329:0.2772070939,t330:0.2714657266):0.6700253806,((t331:0.1093530817,t332:0.1007473888):0.1008970545,t333:0.1880498567):0.7172048255):1.115369526):0.2781860278,((t334:0.415167052,t335:0.4076784317):1.733329283,(t336:1.730736181,((t337:0.3561453501,t338:0.3561301626):1.163520521,(t339:0.2114056808,t340:0.2049301935):1.305211922):0.192151118):0.4048556472):0.1413243285):0.2112256895):2.293125102,(((((t341:0.8781205532,t342:0.8634886491):0.07422083112,((t343:0.371424755,(t344:0.229696554,t345:0.2252576964):0.1355602345):0.1494223252,t346:0.5003049479):0.4068844252):2.330307646,((((t347:0.7978219782,(((t348:0.1594268389,t349:0.1508803111):0.07700575972,t350:0.2048137047):0.4466417077,t351:0.6463572167):0.1114930675):1.285571754,((t352:0.1418146654,t353:0.115656489):1.307691253,t354:1.420303212):0.5765054791):0.7158980961,(((t355:1.122361516,(t356:0.4686708917,t357:0.4677823182):0.6475073061):1.256756056,(((t358:0.03771501507,t359:0.03401771388):0.4695600206,(((t360:0.1323192688,(t361:0.04861213158,t362:0.01687990562):0.08304188523):0.2040416539,t363:0.3012245809):0.07178499414,t364:0.3712030915):0.09171401228):1.317313763,(((((t365:0.260550511,t366:0.2597699653):0.4499014855,t367:0.7057001045):0.1713771987,(((t368:0.2329879042,t369:0.2245988512):0.09346874892,(t370:0.07949322307,t371:0.06685634469):0.2376592739):0.1474908125,t372:0.446257969):0.3905100502):0.2031520142,((t373:0.157455648,(t374:0.09536352493,t375:0.09184138397):0.06047606241):0.09085907767,t376:0.2279982423):0.7681294926):0.1513643203,t377:1.121351164):0.5394053834):0.5401614542):0.05045712894,t378:2.243508654):0.2829897703):0.02211447141,((t379:0.3485978005,t380:0.3284033188):1.01083651,(((t381:0.749000764,(t382:0.256987237,t383:0.2526306473):0.474686066):0.0672167964,(t384:0.5177075456,t385:0.5176768888):0.2512149657):0.4470927162,t386:1.199880966):0.0696442226):1.185447666):0.399868153):0.3171232627,(((((t387:0.04775616064,t388:0.04663872513):0.333864043,t389:0.3737145359):1.039020446,(((((t390:0.3213229703,t391:0.3120829805):0.1567224274,(t392:0.3624132556,t393:0.3605497551):0.1063424526):0.2385332289,t394:0.7012339097):0.257790067,(t395:0.7085157932,t396:0.695216492):0.2370738776):0.08969635054,(((t397:0.5677519723,((t398:0.3846893566,(t399:0.01850775779,t400:0.01787125736):0.3612899833):0.01054562404,t401:0.3735251263):0.1639695688):0.3293267434,t402:0.8565671779):0.05172666676,((t403:0.5548786156,t404:0.5373968598):0.2580732211,(t405:0.2172095646,(t406:0.160534917,t407:0.1602923126):0.05066836372):0.5503960068):0.0943246032):0.06391817733):0.3451165086):1.176754828,((((((t408:0.2779047163,t409:0.2749892348):0.5603787797,(t410:0.1407563714,t411:0.1374394496):0.6869693544):0.02818958799,(t412:0.679918241,((t413:0.3752163237,(t414:0.3325191253,(t415:0.131211082,(t416:0.09211266109,t417:0.05384636219):0.03868620222):0.1950809345):0.03203380618):0.1048812717,t418:0.3916261766):0.1708061828):0.1533472371):0.08078300452,t419:0.7933630179):0.3339078431,t420:1.123230793):0.2563012979,(t421:1.03940892,(t422:0.1780546029,t423:0.159112792):0.8357827196):0.3391799423):0.8990730975):0.2852888666,t424:2.516386566):0.2875462647):0.203759405,(((((t425:0.6742612411,((t426:0.2087116381,t427:0.2030481788):0.1653482409,(t428:0.0600376801,t429:0.0587496262):0.3071381757):0.2996668411):0.02773570204,t430:0.6707199644):1.113339523,((t431:0.6689422618,(((t432:0.1199490429,t433:0.1042357607):0.08965012321,t434:0.176181176):0.1326350814,t435:0.3050220282):0.323916044):0.08526475326,((((t436:0.1724445824,t437:0.1716377602):0.1329725512,t438:0.2886723765):0.008305824289,(t439:0.1449914301,t440:0.1335227546):0.1437873897):0.2614787831,(t441:0.1500496683,t442:0.1276133206):0.3812357621):0.1346095074):1.002095596):0.1783170931,((((t443:0.09425826918,t444:0.08412645532):0.07801166029,t445:0.1542815673):1.360336212,(t446:0.1114083653,t447:0.05312393504):1.399543464):0.1520193734,(((t448:0.08902014924,t449:0.08274066497):0.3626291075,(t450:0.1352259523,t451:0.1199657036):0.301990814):0.3872087966,t452:0.754459661):0.7628067002):0.1328065019):0.07001858337,(t453:0.9822088985,(t454:0.3405210976,(t327:0.008352395099,(t272:0.0067771853,(t1:0.7621167821,t2:0.7374410886):2.378839451):0.5316851118):1.654789971):0.6221908615):0.7037870157):0.9293270372):0.9490920749):0.484902328);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.boombust.T41.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
