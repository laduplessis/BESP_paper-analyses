<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((t465:0.4364369415,t466:0.4274655252):2.993151558,((((t467:0.9487272902,((t468:0.1950156417,t469:0.1748517686):0.2376735495,t470:0.4084249223):0.5094491838):0.2029682106,(t471:0.3613574636,t472:0.349516077):0.7483252826):1.62141935,((t473:0.6154086886,(t474:0.08647255018,t475:0.0810436482):0.5179454212):1.792692787,(t476:1.346508702,((t477:0.5995498197,t478:0.5954655194):0.2199183977,(((t479:0.09960898345,((t412:0.002047084107,((t310:0.006773569194,(t293:0.009201929588,(t221:0.006368969991,t1:2.435392837):0.7794095943):0.132534578):0.8282754387,t2:4.172511382):0.21506314):0.2888479106,((((((t3:3.682521947,t4:3.662978011):0.2532470108,((((((t5:0.6130165504,t6:0.5720360763):1.393330188,(t7:0.4105913199,t8:0.4091828816):1.546915556):0.4584030183,t9:2.400503073):0.7183788159,(t10:3.029187582,t11:3.023331329):0.08595697288):0.4579123972,(t12:3.45082652,((t13:0.6399699424,t14:0.6325755634):0.6242565947,t15:1.2529426):2.172089724):0.1150053227):0.2428617862,t16:3.778563871):0.02827061469):0.2794240128,(t17:0.6715282826,t18:0.6668585083):3.404395015):0.08999230004,(t19:2.752907934,((t20:0.4002160572,t21:0.3876044026):1.958137137,t22:2.338442576):0.3794119788):1.404936638):0.04762635838,((t23:4.082792647,((t24:2.9320988,(t25:1.31462356,(t26:0.1374545203,t27:0.1327168397):1.162352842):1.596603797):0.3683795897,(t28:1.773937261,t29:1.770817752):1.479998883):0.7725103271):0.05925574842,(t30:1.652777113,((t31:0.3199595399,t32:0.3014392703):0.8737096628,t33:1.163446809):0.4468971132):2.419033927):0.004285430246):0.05959960198,((t34:3.354828315,(t35:2.808461396,t36:2.807491455):0.5334171649):0.6834353267,(((t37:0.4297919805,(t38:0.313155867,t39:0.3095831307):0.1150076531):0.717993664,t40:1.123239855):1.908557822,t41:3.021480541):0.9634906906):0.04346195939):0.253948546):0.4149210959):0.2366321966,(((t42:2.485102919,t43:2.482305956):1.106238311,t44:3.580765815):0.4477712603,(t45:3.339105648,((t46:2.773928867,(t47:2.759737754,t48:2.756904385):0.01237360378):0.4602427718,t49:3.214737516):0.1035346036):0.6773984033):0.8903809694):0.1213587188,(((((((t50:3.82763252,((t51:2.963545439,t52:2.954334869):0.270889765,(t53:2.781158892,t54:2.772896385):0.4363986482):0.5924966846):0.1058943589,(t55:3.812116596,((((t56:3.062866377,(t57:2.334719222,(t58:2.214666459,(t59:0.2669038527,t60:0.2578328274):1.919764075):0.111735457):0.7227892635):0.02073962576,((t61:1.101284953,t62:1.091961086):1.539449805,((t63:1.709520375,t64:1.69795332):0.7864786098,t65:2.482227743):0.128843196):0.3798075683):0.07536515619,(t66:2.43122793,t67:2.399442713):0.6174055809):0.03333805695,((t68:1.396848736,t69:1.378467455):0.949523395,t70:2.275509657):0.675939277):0.618492678):0.09259534729):0.03112929858,(t71:3.614222099,(((t72:1.71164228,t73:1.707511011):0.03992262943,t74:1.715328266):1.693443613,((t75:2.503888077,(t76:2.277720497,t77:2.263330658):0.193090819):0.09682867688,(t78:0.4784279261,t79:0.4749633736):2.070743816):0.8007510521):0.1689811475):0.07042262762):0.03138138773,(t80:2.814802081,t81:2.784926891):0.8021577655):0.1593816909,(((t82:1.728344976,t83:1.713894492):1.733600092,((((t84:0.1869812708,t85:0.1602291655):2.79999698,(t86:1.578615779,t87:1.576274676):1.377364712):0.2827140889,(t88:2.539564155,(t89:1.479528474,t90:1.464756049):1.054476037):0.6705838074):0.07634214865,(t91:2.250877208,(t92:1.662068409,t93:1.657431949):0.5774326208):1.006169854):0.1003332565):0.2040579293,(((t94:0.1123068463,t95:0.1121949458):1.531392814,t96:1.623555675):0.9786797582,((t97:1.992897753,(t98:0.9003174454,t99:0.8974011599):1.076216165):0.3203032211,((t100:1.756784202,t101:1.741397896):0.02749962679,(t102:0.449076913,t103:0.4360796427):1.309888696):0.4967754192):0.2603881548):0.8935872494):0.07965452008):0.1391101598,(((((((t104:0.1629664053,t105:0.1516741687):1.730634785,(t106:1.439080319,t107:1.426051654):0.4355165183):0.7214460198,((t108:0.04074199858,t109:0.01761349191):1.855712192,t110:1.873175688):0.6760291005):0.6231154296,((((t111:1.458103709,t112:1.4471929):0.6497203176,t113:2.092498256):0.4896687122,t114:2.576608857):0.003369185721,(((t115:1.862765835,(t116:1.58428272,t117:1.568704401):0.2584367475):0.305028063,((t118:0.09332466578,t119:0.07564882184):1.947242147,(t120:1.489145176,t121:1.470714601):0.4881550035):0.07274147823):0.396209945,(t122:0.8397204255,t123:0.8390047515):1.584822567):0.01379404827):0.5385896826):0.07348622176,t124:3.043680077):0.02334732062,(t125:1.8839737,(t126:1.320436329,t127:1.289939161):0.5399732788):1.159800548):0.1712427055,t128:3.152126969):0.09374442868):0.1179849942,(((t129:2.52933933,(t130:1.482379892,t131:1.478166783):1.012928996):0.3947266126,t132:2.884614646):0.01804760964,t133:2.886091613):0.4111608121):0.5732076884):0.3444364371):0.5212055263):1.042746986):0.2896230501):0.5625989023,((((((((t134:1.196598202,t135:1.191903932):1.556800314,(((t136:2.258838938,((t137:1.348257539,t138:1.34398481):0.7930172773,(t139:2.06637455,((t140:1.634652891,t141:1.622021711):0.03895728393,(t142:1.55443229,(t143:1.351454718,t144:1.348050704):0.1985458144):0.08495006555):0.3811055875):0.06872422247):0.0858973194):0.2061686619,(((t145:0.2179119189,t146:0.1952584965):0.7562642944,t147:0.9404514654):0.7653360529,t148:1.704660525):0.632990185):0.09490106535,(t149:1.797393685,t150:1.796584663):0.6174378745):0.16690865):0.04837772952,(((t151:0.1785156143,t152:0.1751164016):0.6653642205,t153:0.8355083761):0.4942629394,t154:1.321952931):1.286775569):0.6146465329,(((t155:2.071842341,(t156:1.854181866,(t157:1.758156171,(t158:1.528810078,((t159:0.5652005921,t160:0.5618470612):0.4199873327,(t161:0.7833620852,t162:0.7807609657):0.1978562115):0.5312760459):0.2246048054):0.086697381):0.2167448884):0.7679355507,t163:2.79397131):0.3379809283,((t164:2.094674289,((t165:1.455374654,t166:1.449437547):0.5652592136,((t167:0.6556098845,t168:0.6466008315):1.077193368,t169:1.722373657):0.2791228661):0.07308139071):0.7304883714,(((((t170:1.62687896,(t171:1.543904614,t172:1.537449316):0.07477568744):0.6563782271,((t173:1.03088026,t174:1.024474168):1.195231961,(t175:2.007514244,t176:2.005569668):0.2044428402):0.03326453124):0.2416957289,t177:2.46770043):0.1882348645,((((t178:0.9134679047,t179:0.9058608216):1.053676375,((t180:1.381424143,t181:1.378130553):0.3774107889,((((t182:0.2383700058,t183:0.2110083071):0.7027236043,t184:0.9070128485):0.2712173454,t185:1.172782183):0.3892314703,t186:1.5378136):0.1485932711):0.1957634606):0.02677657062,(t187:0.06910353781,t188:0.06895893965):1.837152547):0.2213392192,(((((t189:0.5965093751,t190:0.5911270886):0.3448301569,(t191:0.8471595938,t192:0.8273052135):0.07989261842):0.3913299553,t193:1.297478121):0.4749198497,(((t194:0.6309429658,t195:0.6194007693):0.5357449789,(((t196:0.6702688963,t197:0.6572483133):0.179911668,t198:0.8360970227):0.1365627694,t199:0.971138028):0.1642039297):0.1762245542,t200:1.299016824):0.4123603337):0.07448632138,(t201:0.1513691593,t202:0.1505746161):1.565398385):0.2318590094):0.4374984346):0.07107420044,(((t203:0.04737672645,t204:0.03762327088):2.207191985,(t205:1.685543821,(t206:1.379358814,t207:1.377021068):0.3025254789):0.5580155737):0.07703734435,(t208:1.600192189,t209:1.597930755):0.7004359898):0.1242840291):0.01073442704):0.3027550242):0.02921918549):0.5561467645,(t210:1.604650992,t211:1.581845235):1.694139037):0.414875665,((((t212:0.04739834299,t213:0.02619173652):2.427677643,(((t214:0.2874310273,t215:0.2775325706):1.988151164,((t216:1.422932477,(t217:0.6553308458,t218:0.6222623602):0.7600337214):0.7817807744,(t219:2.042200798,(t220:1.175618086,t222:1.15831487):0.8595336649):0.1080142314):0.03643916):0.1117913418,(t223:1.932673887,t224:1.931431776):0.3388708402):0.06444940375):0.3460317913,((t225:0.9846826454,t226:0.9616299244):0.9005081541,(t227:0.7264502079,(t228:0.2502364406,t229:0.2490736127):0.4686883014):1.109277646):0.7898311296):0.1463744389,(((((t230:0.8780215822,t231:0.8456657718):0.06083411722,t232:0.8875460531):1.009248792,((t233:1.069840755,t234:1.06878471):0.3370255737,t235:1.405309222):0.4879990055):0.09004344147,((((t236:1.046398041,t237:1.044964293):0.03887631297,t238:1.05732618):0.5467694715,((t239:0.6028836414,t240:0.5797221152):0.7204782906,t241:1.283824051):0.2791335698):0.1456363005,(t242:0.8558981652,t243:0.8542704214):0.8391376365):0.1839186097):0.009327478823,(t244:0.3763195185,t245:0.3668894717):1.508849907):0.71367935):0.706092986):0.5934993997,((((t246:1.277603018,t247:1.264227372):1.585905436,(((((t248:1.788297265,t249:1.775392969):0.3509821484,((((t250:1.18136306,t251:1.169728846):0.5279669536,((((t252:0.4026093136,t253:0.3807335435):0.02162657435,t254:0.3968665757):0.7729227855,(t255:0.8124221024,t256:0.792629087):0.3541994871):0.03506406429,((t257:0.3593822997,t258:0.3559913711):0.4006589292,t259:0.7290857173):0.4111512803):0.4440981534):0.04792413648,((t260:0.04358895234,t261:0.04077441005):0.54785595,(t262:0.5672794051,t263:0.5663919953):0.01791265351):1.030735329):0.3470227273,(((t264:0.9696166025,(t265:0.1129263939,t266:0.09941946817):0.8455553587):0.03215156554,t267:0.9761333397):0.4554325068,((t268:0.1076918809,t269:0.07535039842):1.166586401,((t270:0.429217622,t271:0.4265471984):0.5366626294,(t272:0.3230133467,t273:0.3185538654):0.6308176344):0.2710050748):0.1519417168):0.4861239511):0.01200417409):0.08874136558,(t274:0.1661217746,t275:0.1384095672):1.783078981):0.05679823229,t276:1.976145343):0.1731738333,t277:2.121495336):0.3840689786):0.2519837316,(((t278:0.09609365864,t279:0.07394525318):1.513146907,(((t280:0.2128772434,t281:0.2123486699):0.2934226472,t282:0.479190665):0.9246417442,((t283:0.2603615465,t284:0.2526709457):0.8428088405,(t285:0.6589463559,((t286:0.5115616774,t287:0.5112502573):0.01965575966,(t288:0.5161520005,t289:0.5152132461):0.005573949279):0.1168314011):0.4008016075):0.2895054093):0.1515292541):0.4172811625,(t290:1.776056967,(t291:1.619787814,((t292:0.9287846135,t294:0.9096376091):0.009076350527,(t295:0.287019828,t296:0.2667965924):0.6266877312):0.6818852869):0.150393113):0.1170189431):0.7104201055):0.3052476421,(((t297:1.91858271,((t298:1.354138467,(t299:0.1472615368,t300:0.1439089581):1.205660103):0.2657065274,((((t301:0.2294355533,t302:0.2289819987):0.44326486,(t303:0.6354967147,((t304:0.246742591,t305:0.2348931063):0.3718792057,t306:0.6023532765):0.01119930992):0.02374433604):0.1715334088,t307:0.7984449223):0.4907978198,t308:1.279628039):0.2744372538):0.2943815002):0.6775329145,(((t309:0.2021979524,t311:0.1782642606):0.2081658245,t312:0.3853191617):1.303866267,((t313:0.09910594395,t314:0.08600069452):1.133245432,(t315:0.89531206,t316:0.879411279):0.3229095165):0.4396327625):0.801107372):0.1556584468,(t317:2.087758107,(((((((t318:0.2648462419,(t319:0.2590219413,t320:0.2511762957):0.00139397301):0.3843141026,(t321:0.1958769907,t322:0.1697803359):0.4371548564):0.4271581175,(t323:0.9363743423,((t324:0.625822798,(t325:0.5331612785,(((t326:0.04033784865,t327:0.02448969615):0.1132693159,t328:0.1307656896):0.05601469663,t329:0.1796862442):0.3212527892):0.08716396496):0.1646714192,t330:0.7471418469):0.145384948):0.08840132238):0.1175441896,(t331:1.027954521,t332:1.022364253):0.06274173211):0.0002904009949,((t333:0.2161343794,t334:0.2086909672):0.8580591245,(t335:0.07917885582,(t336:0.04609871668,t337:0.0430195141):0.02702578832):0.9798015897):0.003214808123):0.08539161849,(t338:0.8539860916,t339:0.8441074095):0.2543128256):0.2783273029,t340:1.368077499):0.5252896774):0.5039384155):0.09968825049):0.4655735974):0.6968716018,(((t341:1.41180308,(t342:0.9239233164,(t343:0.1654289397,t344:0.1595732654):0.7202012539):0.473068716):0.9579101589,((((t345:1.237283692,(((t346:0.692524166,((t347:0.1430911935,t348:0.1214185147):0.3455247999,t349:0.4665507997):0.1960351483):0.3208841103,(t350:0.4185293619,t351:0.4114597017):0.5433656924):0.04183682426,(t352:0.05030355724,t353:0.04532433685):0.9293624426):0.1780062938):0.1821962831,((t354:0.8258846605,t355:0.8069143167):0.1800337395,t356:0.9812284641):0.3270106565):0.4816618285,t357:1.787063866):0.08534439383,((t358:1.254835254,(((t359:0.323654363,t360:0.3179947975):0.02138088686,t361:0.322308707):0.8519472291,(t362:0.8829896673,(t363:0.4539144022,(t364:0.1178384115,t365:0.1146471146):0.3275154107):0.4130902382):0.2608442809):0.05298224077):0.4383206997,t366:1.607128759):0.1767971187):0.3002709224):0.9649573481,(((((((t367:0.4643430852,t368:0.4349059659):0.1503623866,((t369:0.1981462534,t370:0.176454015):0.1431036063,(t371:0.2404050423,t372:0.2278857229):0.07542456738):0.2386960435):0.4354035171,t373:0.9555039483):0.26800304,(((((((t374:0.1063632965,t375:0.09865461817):0.06739827725,t376:0.1619548852):0.005739888012,t377:0.1655143093):0.1894372314,(t378:0.1106189517,t379:0.1080500089):0.2383316594):0.4707796208,(t380:0.1397128613,(t381:0.132965806,t382:0.1279437021):0.00664835001):0.6648118413):0.02554532783,t383:0.8238628686):0.2191943432,(t384:0.2338154785,((t385:0.1092945749,t386:0.1052509899):0.07450542472,t387:0.1625360813):0.0450401619):0.8006705476):0.1242798301):0.1219617938,(((((t388:0.1586949978,t389:0.1314494818):0.5289391933,((t390:0.0862774885,t391:0.08274114138):0.5160022522,(t392:0.3470685912,t393:0.3266076981):0.2486894867):0.03614152399):0.1280805261,(t394:0.1888421285,t395:0.1815991375):0.5343248065):0.09940906819,t396:0.8152114438):0.1337422386,(t397:0.9128917169,(t398:0.4484126173,t399:0.4424836938):0.4411231868):0.008620042868):0.1983621382):0.09405554744,(t400:0.975550061,(t401:0.0526395921,t402:0.05045289714):0.9215539854):0.2085461316):1.399130531,(((((t403:0.9675094084,(t404:0.570475156,t405:0.568635754):0.3900877238):0.4590924859,((t406:0.8929193024,(((t407:0.04771337767,t408:0.04473244495):0.5562229811,(((t409:0.07849143888,t410:0.06957896488):0.2656973986,t411:0.3270602622):0.2293501288,((t413:0.1876125335,t414:0.1822067752):0.09360318925,t415:0.2575979499):0.2641138444):0.02282195695):0.1021464458,t416:0.6415588804):0.1621605008):0.08588836701,(((t417:0.01079634503,t418:0.008310918411):0.5668386114,t419:0.5593349619):0.3004151816,(((t420:0.3530369758,t421:0.3410635975):0.05238872759,(t422:0.3816451453,t423:0.3738759592):0.01041337988):0.05385667192,t424:0.4225646495):0.3971378195):0.005635515576):0.4033900127):0.7079586776,(((t425:0.4592001876,t426:0.4388642816):0.3665010272,(t427:0.6632177111,(t428:0.6411934104,t429:0.6333544634):0.02119347032):0.1349505208):0.7172863647,(t430:0.2052932344,t431:0.1958809294):1.295199091):0.3876926299):0.0957593925,(((t432:0.2576663194,t433:0.2537850512):0.05630499474,t434:0.3084732994):0.09065264113,t435:0.3960332842):1.56810999):0.002211966762,((((((t436:0.4045377694,t437:0.3866439931):0.9488393975,((t438:0.5050912322,t439:0.5017034025):0.5168982787,(t440:0.03715570693,t441:0.03370831057):0.9616232308):0.276567526):0.03789836779,t442:1.305080384):0.1266688115,(((t443:0.2836949147,t444:0.2762473821):0.5276339115,((t445:0.2679525343,t446:0.2444160332):0.1837299068,t447:0.4221945195):0.3486351255):0.04808808584,(((t448:0.3676880265,t449:0.3668272463):0.1776439558,t450:0.5351028894):0.1443179825,t451:0.6732242875):0.1205271074):0.5221190018):0.3602354712,((t452:0.3277596232,t453:0.3084914246):0.7615834824,((t454:0.3663217003,t455:0.3591934814):0.001321265451,(t456:0.3092626977,t457:0.309008443):0.05116947918):0.699685284):0.5862273338):0.002501221205,((t458:0.3679267902,t459:0.3626777103):0.5682506597,(t460:0.6898391221,((t461:0.1208098986,t462:0.1163646454):0.29526884,(t463:0.2508847062,t464:0.2355905102):0.1593557658):0.2710763507):0.2124620474):0.7029964722):0.08509919108):0.3464425608):0.08416022734):0.310422766):0.9450649079):0.08030572144);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.boombust.T54.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
