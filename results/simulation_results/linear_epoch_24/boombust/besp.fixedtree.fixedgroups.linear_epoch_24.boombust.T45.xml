<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t321:0.1166570182,(t322:0.1071106326,t323:0.09844169097):0.003599296339):1.307687489,(((t324:0.4007906619,t325:0.38718567):0.1878190882,t326:0.5598610892):0.5578336056,((t327:0.842657001,(t328:0.7609144289,t329:0.7558957698):0.01663011001):0.1672678257,((t330:0.3261621124,t331:0.3188823096):0.243660738,t332:0.5603811886):0.3686880838):0.07686405202):0.2614497436):0.2308393912,(t333:0.5598804242,((t334:0.02807195585,t335:0.02678776189):0.1579227687,t336:0.1815922337):0.3700840225):0.9160368745):0.3357500118,((t337:1.074508464,(t338:0.3066061794,t339:0.2980139169):0.7547609774):0.4960416259,((t340:0.3449592055,t341:0.3245138888):0.8926571258,((t342:0.3250912603,t343:0.3099177265):0.3601601753,((t344:0.4235398518,t345:0.4142125845):0.1346408045,t346:0.5372922481):0.1056126604):0.52204324):0.2919233658):0.232084006):2.024511967,((((t347:0.5413490163,t348:0.5354414112):0.1633234907,t349:0.6845789251):0.6231990475,((t350:0.6764731801,t351:0.6743242887):0.2763974559,(t352:0.1696251577,t353:0.161610025):0.771035278):0.3527803187):1.725968824,(((((t354:0.09832159004,t355:0.08022275718):1.064148667,t356:1.095548309):0.05906898348,t357:1.151224768):0.4506506684,(((((t358:0.4103978909,t359:0.4059026248):0.002617086316,t360:0.4012035087):0.3267845229,t361:0.7025717153):0.2308806716,t362:0.917687224):0.4719523496,(((t363:0.5885215443,t364:0.5613825315):0.01156168548,t365:0.5724368194):0.3280650917,(((t366:0.3273964502,t367:0.3220505248):0.3385260116,t368:0.6435000581):0.0778416924,(t369:0.4269137195,(t370:0.1658533648,t371:0.1578964879):0.1981326255):0.2880159703):0.1533104108):0.4405584595):0.1412777486):0.8121901462,(((((((((t372:0.08790626369,(t373:0.03608118974,(t374:0.004398427473,t375:0.004381583388):0.03021805404):0.0252131283):0.0345977846,t376:0.08252382478):0.3835545009,t377:0.4582911571):0.1027983592,(t378:0.4911657471,(t379:0.3671137038,t380:0.3544954255):0.1114302991):0.06339725728):0.2395421852,t381:0.766449398):0.07782941565,t382:0.8218535811):0.0001205396276,(((t383:0.0224898428,t384:0.02159328756):0.3312437573,t385:0.343048527):0.2490178574,((t387:0.2884544349,t388:0.2829417744):0.06399192945,t389:0.3311170314):0.2228412743):0.1766930876):0.7447112974,(t390:0.7188684189,t391:0.6858559597):0.7490344027):0.2362291552,((t392:1.52659753,((t393:0.6933554603,t394:0.6580759057):0.5992883027,(((t395:0.8785185417,((t396:0.1698786162,(t397:0.1390874978,t398:0.1350355872):0.01974644474):0.3929783987,(t399:0.2121678266,t400:0.2060222133):0.3352393106):0.2893431707):0.1795044265,((t401:0.3486926544,t402:0.3427864177):0.6417072303,(t403:0.2684683982,t404:0.2514297643):0.7067341173):0.01849583435):0.0386755319,(((t405:0.03432346089,t406:0.01349290419):0.3922002852,(t407:0.2241490291,t408:0.222335407):0.1784767997):0.5467031494,(t409:0.4638148523,(t410:0.1811268186,t411:0.1621440545):0.2752841265):0.466977593):0.012923612):0.148874987):0.2313888434):0.1126208009,t412:1.406006826):0.00805975438):0.2785570349):0.5241088585):0.6544531996):1.785013609,((((t413:2.139792511,(((t414:1.37337132,(t415:1.250401109,t416:1.2277494):0.1177128166):0.02711643628,((t417:0.1082657895,t418:0.07446699259):0.1322381019,t419:0.1990697836):1.126748817):0.07859590548,((t420:0.2074469168,t421:0.1956476122):0.1493531278,t422:0.3314935084):1.039175142):0.6578816419):0.1095763047,((t423:0.8632022193,((t424:0.3352196881,(t425:0.07997231756,t426:0.07148071487):0.2511599829):0.3378196064,(t427:0.3759192327,(t428:0.3594649152,t429:0.359107439):0.00900201591):0.2817179724):0.1810426121):0.3943928444,(t430:1.175034116,((t431:0.7171093516,(t432:0.288205058,t433:0.2787977625):0.4210256345):0.398250811,(((t434:0.00308671731,t435:0.0009875971357):0.6138334691,(t436:0.503090319,t437:0.4974815485):0.09103196294):0.3625151363,(((t438:0.3416101797,t439:0.32430853):0.1409167337,(t386:0.01293745743,((t280:0.03881303614,t1:3.104676575):0.1023040838,(t2:0.6174614974,t3:0.6157120531):2.570391656):1.208745605):1.017631954):0.3035603528,((((t4:3.418973692,(t5:3.391874382,(t6:3.087715339,((t7:0.6454890569,t8:0.6268406881):2.434753256,t9:3.061131927):0.00741895662):0.2898677143):0.01914482153):0.2158255017,(t10:0.1959617329,t11:0.191384412):3.382157844):1.192490326,(t12:3.552628584,(((t13:2.749236271,t14:2.734971311):0.1832068928,t15:2.911992047):0.3465655813,((t16:1.476108223,t17:1.466292758):0.8872652199,t18:2.350798975):0.8936577881):0.2645272977):1.19858007):0.7013315999,(((((((t19:1.335717718,t20:1.311783347):2.481274677,(t21:3.17241526,((t22:0.5997959654,t23:0.5850353177):2.204581441,(t24:1.486403846,t25:1.477784102):1.288546912):0.3617318021):0.6160780683):0.03267560474,t26:3.775546104):0.4911164563,(t27:4.249738618,t28:4.239046843):0.008068338399):0.08797430526,(((((t29:0.5630284287,t30:0.5564424622):2.444800652,(t31:1.945066569,t32:1.929797741):1.046402703):0.194856325,(((t33:0.4134177353,t34:0.3912440049):0.7770272855,t35:1.152486632):1.663779963,((t36:0.6913098199,t37:0.6895394571):1.706853131,t38:2.375393564):0.4150766295):0.3046190024):0.3312762681,((t39:0.1094308346,t40:0.09705201001):0.7782882686,t41:0.8635602908):2.519818732):0.6521475903,(((t42:2.589007777,(t43:2.535115363,t44:2.532295503):0.03175038801):0.4277129372,(t45:1.745125502,t46:1.744296199):1.227269861):0.4616615484,t47:3.430503332):0.547502766):0.1293809591):0.3685666942,(t48:2.247270798,t49:2.245981972):2.218421202):0.1091190035,t50:4.570203121):0.4789120273):0.1851643724):0.1590517916):0.1184843456):0.0504815167):0.04974906557):0.8767594599):0.1521381497,((((t51:2.624569905,t52:2.616554282):1.111349,((t53:2.531515625,t54:2.522390105):0.6571843151,(((t55:1.401028627,t56:1.3307032):0.8633876335,t57:2.155878171):0.07891191985,(t58:2.207457553,t59:2.20335947):0.02523586551):0.8357739536):0.5310667088):1.268429349,(((t60:2.855533242,t61:2.836647983):0.8428762809,(t62:0.9345339257,t63:0.906948895):2.737508637):0.1314581292,(((t64:1.475030887,t65:1.469528721):1.582307683,((t66:2.602555137,(((t67:1.240230282,t68:1.229535575):0.11847146,t69:1.344484003):0.4482642566,t70:1.786413075):0.7863934793):0.3231934378,t71:2.895323281):0.05906138831):0.2267031968,(t72:2.40542133,t73:2.398655554):0.7740912747):0.4880065895):1.03380882):0.952262823,((((((t74:2.42951478,((((t75:1.658695765,(t76:1.155798029,t77:1.154739102):0.4969658999):0.2290817952,t78:1.846288504):0.2431928635,(((t79:0.1632132615,t80:0.1606626924):1.410728385,t81:1.564579233):0.2219043286,(t82:0.03974007218,t83:0.03183683908):1.744699309):0.2879382477):0.05715239839,(t84:1.073120383,(t85:0.2108001077,t86:0.2100945825):0.8617770484):1.042189534):0.2236991568):1.639629396,((((t87:2.495767259,(t88:1.927322013,(t89:0.609186789,t90:0.5971762718):1.317504072):0.5678251396):0.2914556883,(((t91:0.3833879613,t92:0.3754058579):1.064519411,t93:1.430946407):1.020129316,t94:2.439703928):0.2990375907):0.5257729449,((t95:2.469030763,(t96:1.943567942,t97:1.922537756):0.5118545429):0.4998298633,(t98:0.8066567437,t99:0.8008187195):2.122893442):0.2919199765):0.05201649506,(t100:2.561974946,((t101:0.1894124321,t102:0.1709789631):0.03889806952,t103:0.1925076295):2.327730305):0.6795580624):0.598441432):0.03544326312,((t104:2.125334557,(t105:0.8344941268,(t106:0.7373513016,t107:0.7356598099):0.0742107608):1.272992386):0.3959228516,(t108:1.3544857,t109:1.353651704):1.121364617):1.310008892):0.1482813844,(((t110:2.065627275,t111:2.055062035):0.5950055308,(((t112:1.074986882,(t113:0.3354771253,t114:0.3273558403):0.7073154638):0.9000439985,t115:1.904456721):0.3198699145,(t116:1.611852909,(t117:1.499286215,(t118:1.013247834,t119:0.9825650938):0.4825264295):0.09529035167):0.5890892524):0.3507735954):0.753882012,((t120:2.624304518,((t121:1.43216278,((t122:1.02260355,t123:0.9756257327):0.09194401374,t124:1.063801866):0.3121449974):0.7264365549,(t125:0.6448916677,t126:0.6335557248):1.453724543):0.4649745459):0.4546425826,t127:3.001816277):0.1655645172):0.51796128):1.160054257,((((t128:2.089461009,t129:2.0749219):0.9876341817,((t130:2.793135473,(((t131:0.2153159714,t132:0.1761133643):0.7588061223,t133:0.9193604661):1.607196616,(t134:1.30303206,t135:1.29990164):1.223241325):0.2115788239):0.1002184588,(((t136:2.058980943,(t137:1.593422565,t138:1.589152055):0.455544551):0.2477471627,(t139:2.172686041,t140:2.163252056):0.1188203038):0.1699954014,t141:2.445303269):0.3546579749):0.1657291451):0.6374291574,(t142:2.08381638,t143:2.057900963):1.507911799):0.3037632153,(t144:1.20682779,t145:1.195418554):2.656448899):0.8241248649):0.1216836748,(((((t146:1.221552363,t147:1.214483245):0.6950894427,t148:1.895650855):0.2680313146,t149:2.1624884):0.4885820707,(t150:1.148925507,(t151:1.083648254,(t152:0.1012431778,t153:0.09544760987):0.9819684618):0.0525734286):1.498378521):0.2577655524,(((t154:2.031300708,t155:2.027696147):0.2397658605,((t156:0.7336597945,(t157:0.3769175475,t158:0.3724675182):0.3502041093):0.759249545,t159:1.42734112):0.7462974139):0.3435663861,(t160:1.799231668,t161:1.786006747):0.7074160356):0.2641739694):1.86002328):0.08818995303):0.6591058345):1.21661797,((((t162:1.174307846,t163:1.14222237):2.2174388,(t164:0.3464591767,t165:0.3281931429):3.003384913):0.3628657096,(((t166:1.388962092,t167:1.374887845):0.7382255967,(t168:1.690759142,(t169:1.272423205,t170:1.272110543):0.4156046939):0.3954215982):1.033840075,((t171:1.732726108,(t172:0.04488948592,t173:0.03901204255):1.685159124):0.08236617725,(t174:1.252626697,t175:1.252352986):0.543110192):1.300266236):0.533161246):2.314854849,((((t176:3.123518353,(((t177:2.000815629,t178:1.998245332):0.2354053065,(t179:0.2909495183,t180:0.2836484748):1.931607101):0.6586397442,(((t181:0.9793776602,(t182:0.1537569553,t183:0.1530538637):0.7954196273):0.3788156639,t184:1.322532836):0.2825419635,(t185:1.236991977,t186:1.234280892):0.3525502302):1.230736253):0.2227545172):0.09215090532,((t187:2.213178643,((((t188:0.1869246939,t189:0.175857352):1.605715991,t190:1.768173058):0.04323981269,t191:1.79277198):0.0481789305,(t192:0.7062985757,t193:0.7053870685):1.127424111):0.3143854472):0.566327886,t194:2.712245045):0.3476263443):0.3282219544,((((((t195:1.237508764,(t196:0.7582199523,t197:0.7269021033):0.4603208441):0.77733181,(t198:0.9269968163,t199:0.9124939005):1.033000166):0.521610023,(((t200:1.274869978,t201:1.273452647):0.3646921069,(t202:0.1141028586,t203:0.09768537101):1.519989244):0.2489857813,t204:1.857188422):0.5767527515):0.3961545172,(((t205:0.7741253016,t206:0.7650629113):1.025683079,(t207:1.54307144,t208:1.539703015):0.243249384):0.5603086246,t209:2.328741079):0.4650822242):0.1507651551,((((t210:1.244900984,t211:1.24113227):0.3873278989,t212:1.62617457):0.9151259756,((t213:0.2140695464,t214:0.2011410372):0.5869528853,t215:0.78351989):1.737689442):0.1777337169,t216:2.664093295):0.219151556):0.1883964162,((t217:0.6654585535,t218:0.6580712399):0.842584197,(t219:0.5666817493,(t220:0.08652922659,t221:0.06320429263):0.478980934):0.9309832118):1.550865482):0.1072954229):0.06406992838,(((((t222:2.295184892,(((t223:0.2725395277,t224:0.2711304051):1.978217731,(((t225:0.2042479954,t226:0.196231312):1.269696646,(t227:1.455789144,t228:1.442535748):0.008877889106):0.6177026994,((t229:0.5583849901,t230:0.5550851769):0.7880943895,t231:1.342908477):0.7175317965):0.1334307396):0.02803161747,((t232:0.8763890124,(t233:0.2567222932,t234:0.2563307435):0.6147759192):1.088417327,t235:1.954431338):0.2160166106):0.002420922676):0.1797521434,(t236:1.804922128,((t237:0.7055469923,t238:0.6918365765):0.4787967968,(t239:1.129845264,t240:1.126851605):0.0299000649):0.6184298901):0.5460718861):0.2793489075,((t241:1.5057546,((t242:0.5813864608,(t243:0.3900779103,t244:0.3726358642):0.1743919718):0.8207972133,(t245:0.8064711232,t246:0.7880427312):0.5442335073):0.09945421918):0.5115975956,(t247:1.218768648,t248:1.210901348):0.7192377424):0.5767219024):0.06159743142,((t249:1.684385679,(t250:0.09229065302,t251:0.08384837836):1.576477439):0.5448457533,t252:2.199604483):0.3210780072):0.3556953557,(((((t253:2.148981127,(((t254:0.2013079716,t255:0.1996104111):0.363240239,(t256:0.3260879513,t257:0.3051170156):0.2262026289):0.8497556847,((t258:1.112925953,t259:1.09568066):0.1346988945,t260:1.204281497):0.130508261):0.7333000376):0.004274961575,((((t261:0.04714758156,t262:0.02685262774):0.2222911374,t263:0.2445313739):1.058316974,(t264:0.7182991105,t265:0.6733204711):0.5696181942):0.6622286956,(t266:0.2423667115,t267:0.2162271303):1.641115021):0.07936106082):0.1416493947,((((((t268:0.9192731518,((t269:0.2470165551,t270:0.2460684057):0.2189427464,(t271:0.2840846491,t272:0.2749577501):0.1606091414):0.4524767139):0.432236136,t273:1.309134467):0.187620526,t274:1.49478134):0.4241636577,(((t275:1.003936004,(t276:0.2885152091,t277:0.2878952413):0.6799652259):0.2920347099,(t278:1.095472062,t279:1.092368029):0.09331315801):0.3900924378,(t281:0.7339883939,t282:0.7054824953):0.7351691624):0.2004993591):0.04095658628,t283:1.659164036):0.01026714964,(t284:1.120491872,(t285:0.8092185519,(((t286:0.1485580335,t287:0.1392219614):0.4125867106,(((t288:0.2120682247,t289:0.211079748):0.1440077951,t290:0.3521299571):0.07768761108,(t291:0.3942185574,(t292:0.2061623734,(t293:0.04567653818,t294:0.03585249966):0.1453327672):0.1793959461):0.001713379703):0.1089665872):0.01234248849,t295:0.4807275445):0.2300905665):0.2836830049):0.5356629105):0.06009670072):0.3566801574,(t296:1.523479311,((t297:1.297808998,(((t298:0.2403477039,t299:0.2398444954):0.963243658,(t300:1.0853727,((t301:0.09735659244,t302:0.0969385994):0.2612605345,t303:0.3543530969):0.7204279333):0.1126796615):0.01994796406,(t304:0.4767991903,t305:0.4567153461):0.7203616203):0.05194759403):0.1341842339,((t306:0.6448124651,t307:0.6229026021):0.31603671,((t308:0.579149033,(t309:0.5504303683,t310:0.5452855388):0.004381426828):0.1973901015,t311:0.7406831929):0.1553641315):0.3986410783):0.07502170645):0.4218749249):0.02001909584,((t312:1.285139467,((t313:0.4630870117,(t314:0.3701232041,t315:0.3570312273):0.08716149403):0.2835452254,(t316:0.3243655883,(t317:0.02941908286,t318:0.02845372074):0.277478486):0.3943513461):0.5366324938):0.0288379835,(t319:1.176226123,t320:1.168855024):0.08495833596):0.4776602739):0.1957644732):0.01087197785):2.329220793):0.5078421075):1.033117452);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.boombust.T45.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
