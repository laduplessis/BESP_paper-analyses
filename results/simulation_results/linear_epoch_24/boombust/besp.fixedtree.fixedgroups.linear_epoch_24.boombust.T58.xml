<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="((((((t428:1.162238284,((t429:0.4076179146,t430:0.3839039194):0.26822583,t431:0.6505167698):0.4617775203):0.7634528033,((t432:0.4934926185,(t433:0.346075749,t434:0.3349132204):0.1256446489):0.5970679289,(((((t435:0.2542165389,(t436:0.08631313731,t437:0.08597915213):0.1527670304):0.09001225635,((t438:0.02521129001,t439:0.007645350817):0.2791254467,t440:0.2862061298):0.02323658475):0.2489283375,t441:0.5494628437):0.3134726166,t442:0.8563913049):0.04926000001,(t443:0.3619242416,t444:0.3603821556):0.5219218208):0.09841553536):0.7685011096):0.4487734254,(t445:1.345843294,((t446:0.4436434144,((t447:0.2065985145,t448:0.2054095828):0.004779509931,t449:0.2055686179):0.2215079666):0.7339984895,t450:1.133227252):0.1561444844):0.8346495895):0.3983260006,((((t451:0.2227085491,(t452:0.07343168566,t453:0.07279134788):0.1276699842):0.03520979511,t454:0.2313532947):1.540663942,(t455:0.4369714081,(t456:0.3471734269,(t457:0.08422859087,t458:0.0722738207):0.2551765143):0.07604380185):1.326511549):0.3419397362,((t459:0.1710087898,t460:0.1667197617):0.9210499898,(t461:0.5233474374,(t462:0.3251135798,((t463:0.186172227,t464:0.1812294062):0.0005408822276,((t465:0.1381344218,(t466:0.09884364944,t467:0.08189660519):0.03281499961):0.002271982936,(t468:0.05352045197,t469:0.04835930266):0.04803169007):0.01149208573):0.1346574536):0.1976984038):0.5540773999):0.9773893806):0.3812052666):0.8920592131,(t470:1.648396934,(((t471:0.5062719639,(t472:0.0651768239,t473:0.06128229061):0.4373464305):0.7021313689,((t474:0.3339835247,(t475:0.03439825416,(t476:0.01382992992,(((t408:0.02931232185,t409:0.00601487626):0.02102748937,((t246:0.0069213191,(t1:1.328485878,t2:1.316932366):1.219486079):0.8245046901,(t3:1.656908598,(t4:0.9888595932,t5:0.9764050733):0.6575916526):1.700121954):0.9262927006):0.4872324652,(((t6:3.703364642,t7:3.681994506):0.2144014888,(t8:3.200329676,t9:3.199097237):0.6940298978):0.03043582951,((t10:2.904850804,t11:2.897312918):0.7997652774,(t12:1.17978347,t13:1.173368968):2.513776307):0.2135185951):0.7946782044):0.212529364):0.0129063077):0.2929174342):0.3106483178,((t14:3.890760915,((t15:0.271694094,t16:0.2691057992):3.599082878,(t17:2.730140208,(t18:2.339400183,t19:2.32614719):0.384726902):1.133872831):0.003235620984):1.266362695,((((t20:0.6007686949,t21:0.5994506772):2.761751212,(((t22:2.181238872,t23:2.181102676):0.6117018613,t24:2.790631646):0.2519833883,t25:3.039103887):0.3140496925):0.7440094457,((t26:1.516374414,t27:1.508679769):1.279904622,((t28:0.2147635418,t29:0.1891954165):0.5974494302,t30:0.7730917685):1.968918038):1.283356677):0.3557477681,(t31:1.156249997,t32:1.147370074):3.219070068):0.6487992729):0.3532573809):0.5499017588):0.2103378766,(((t33:3.945113117,(((t34:0.7692804503,t35:0.7582372924):2.679414628,(t36:1.812000658,((t37:0.8101412897,t38:0.7904476109):0.3293706096,t39:1.116994172):0.645091315):1.601794308):0.1508823307,(t40:2.858188907,t41:2.855399696):0.6214839402):0.3310939472):0.8487502801,((((((t42:0.7818994769,(t43:0.2056579485,t44:0.2027157523):0.5514020475):1.800934916,t45:2.548816978):1.069216889,((t46:3.167683851,(t47:1.372273974,((t48:0.2199652446,t49:0.2033103814):0.7285560862,(t50:0.08933088378,t51:0.08134593076):0.8362067306):0.4202216247):1.79348637):0.2966503423,t52:3.422045072):0.1473031473):0.6297730809,((((t53:2.945920924,(t54:2.509781448,t55:2.491854439):0.4354702616):0.2635091197,t56:3.178969097):0.4846728009,((t57:3.016387501,(((t58:1.267590216,(t59:0.6021817611,t60:0.598657868):0.661879219):1.188248745,(t61:1.337790357,t62:1.334306269):1.108791229):0.1967849266,t63:2.637026355):0.3427810562):0.5301969861,((t64:3.113075723,((t65:1.177184461,t66:1.171659979):1.337690846,(t67:1.095753564,((t68:0.4225400053,t69:0.4144228483):0.148365847,(t70:0.2125173745,t71:0.2011443872):0.3215773658):0.5160980659):1.401667378):0.5710764476):0.2692826223,(t72:2.140589298,(t73:1.936531153,(t74:1.076524367,(t75:0.6704439414,t76:0.6106187272):0.4025447024):0.8478034248):0.1992875913):1.112035644):0.1258402448):0.1155745184):0.3206533998,((((t77:2.329185496,t78:2.32496482):0.7897875695,((t79:1.391670127,t80:1.378832803):1.266225406,t81:2.627033515):0.4554570413):0.4885848927,t82:3.540704081):0.00127978712,((t83:1.547957626,t84:1.544166919):0.6816713634,t85:2.225720011):1.307239169):0.124373299):0.1662177963):0.06294638219,(t86:2.95212502,t87:2.915405329):0.9324111875):0.2178198308,((t88:0.7877026331,t89:0.7843272233):2.777736605,t90:3.53737663):0.4929860321):0.08125212054):0.5890274286,(((((t91:3.681697396,(((t92:1.478967837,t93:1.476075784):0.4197569283,t94:1.894034517):0.6546533899,(t95:2.256882842,t96:2.236309956):0.291526039):1.121782251):0.07485643327,(((t97:2.095933926,t98:2.094808605):0.4493476685,t99:2.543161965):0.5914853718,(((t100:0.567971987,(t101:0.5482203862,t102:0.5438360773):0.01776241221):0.3419550141,t103:0.8756595447):1.952170497,(t104:2.260978879,t105:2.257933619):0.5667661653):0.2574889189):0.5844571947):0.413720048,((t106:2.37736438,(((t107:0.02919450063,t108:0.02760911511):0.2517964669,t109:0.2718954614):1.470965504,(t110:0.8097231143,t111:0.8028955147):0.9067746526):0.6144125345):0.7205240476,t112:3.043288727):0.9666673076):0.4036410535,(t113:2.679354953,t114:2.658767591):1.707138648):0.07277404736,((((t115:1.028714348,t116:1.019074728):1.363151207,t117:2.369552776):1.151957824,t118:3.494393781):0.3046510717,(t119:0.3306200245,t120:0.324665815):3.462343698):0.5873927809):0.04129713392):0.7439153174):0.2274764399):1.590455932):0.1826295159,(((((((t121:1.460558788,(t122:1.170616476,t123:1.168669901):0.2889489825):0.8437013664,(t124:1.599864382,(t125:1.12083413,t126:1.117979195):0.4663044627):0.6978212807):0.9616591757,((((((t127:0.4529183456,t128:0.4312097901):1.512629203,(t129:0.9904281659,(t130:0.7420796451,t131:0.7340312245):0.2472762176):0.9400361542):0.5661381789,(t132:2.212845197,t133:2.182174801):0.2597943254):0.004662351639,t134:2.442298921):0.1428977996,t135:2.583906827):0.5155343353,(t136:2.590655771,(t137:1.826074939,((t138:1.040631418,t139:1.03337953):0.1742606123,(t140:1.119240789,t141:1.117906715):0.08788516953):0.5781725453):0.7447579546):0.484498256):0.04589529699):1.56937269,(((t142:1.806214173,t143:1.800343435):0.5616687243,t144:2.351939352):1.595166275,(((t145:2.900339835,t146:2.885629954):0.7269190219,(t147:0.7284338979,t148:0.7272744816):2.879647748):0.3122197792,(t149:3.151627516,(((t150:2.303880865,((t151:1.750939497,t152:1.715004117):0.1584762662,(t153:1.191311879,t154:1.182659386):0.6669664343):0.3840292149):0.04114878179,(((t155:1.225316092,t156:1.214470557):0.6616791917,t157:1.852643409):0.2354150507,((t158:0.5566021362,t159:0.5527225643):0.1823714199,t160:0.7339207843):1.336680962):0.1494643339):0.4471917576,((t161:0.7822726795,t162:0.7787866535):0.3315427739,(t163:0.7528536669,t164:0.7455378888):0.3534437308):1.549623448):0.3546625966):0.7662908652):0.006663481448):0.6651757069):0.763217877,(((t165:1.429480739,t166:1.427043976):0.8954826933,((t167:1.59229449,(t168:0.8599556169,(t169:0.6172045686,t170:0.6021302014):0.2401528619):0.6839724333):0.6307305365,t171:2.137767062):0.08880696588):2.184374348,(((t172:2.38036481,(t173:1.425786535,t174:1.409090695):0.9483160599):1.514061377,(((((t175:1.159251153,(t176:0.945694899,t177:0.9393610923):0.2080325329):0.6916052301,t178:1.838714428):0.2562585483,(t179:0.8216612956,(t180:0.1734169548,t181:0.1412372376):0.6417991837):1.265355419):0.3585197165,(t182:1.992202874,(t183:1.767067783,t184:1.761051866):0.1982407805):0.3891953546):1.293825878,(((t185:1.876208677,t186:1.875299591):0.1450951617,t187:2.017670199):0.4099210744,((t188:1.34939412,t189:1.338566726):1.032345531,((t190:1.308906542,((t191:0.7740283795,(t192:0.3048575369,t193:0.29300252):0.4429011251):0.1662365537,t194:0.8729872793):0.3525203313):0.6645224408,t195:1.889648737):0.3878601681):0.04584262113):1.19266803):0.1108405033):0.02299663747,(((((t196:0.1444472423,t197:0.1410595118):0.9154671219,(t198:0.6935437058,t199:0.6802484774):0.3610485045):0.8574215709,((t200:1.470194447,(t201:0.3305258447,t202:0.3287096707):1.138967214):0.2006363971,(t203:1.571740158,t204:1.559152835):0.09634430876):0.2250470485):0.6083695482,(t205:1.070525577,t206:1.066368085):1.410945104):1.040200803,((((t207:1.339697444,(t208:0.4456760739,t209:0.4451675259):0.8697403964):0.08805551112,(t210:1.368104166,t211:1.308165548):0.02815904479):0.1467582519,(t212:0.7884182292,t213:0.7751285549):0.67063233):1.184865965,(((((t214:1.600489318,(((t215:0.2944678707,(t216:0.1969012424,t217:0.1732297302):0.07118312847):0.8316639366,t218:1.074726916):0.3891813176,(t219:0.950355402,(t220:0.6141286691,(t221:0.1587034996,t222:0.155827884):0.4492580544):0.3359322912):0.4800422495):0.07759393214):0.3592840846,t223:1.849513416):0.064665243,((t224:1.087664287,t225:1.08414122):0.2779292731,((t226:0.7394903088,t227:0.7263683702):0.5720052253,(t228:1.03828017,t229:1.037933346):0.2408998305):0.03234049445):0.5311749901):0.1563674805,((t230:0.490804907,t231:0.4643523863):0.5440830138,t232:1.001767254):0.9623127163):0.2232071185,((t233:1.105844698,(t234:0.1855997987,t235:0.1722567166):0.9180822476):0.935991261,((t236:1.695394527,((t237:0.8074823839,t238:0.79245145):0.3574996204,(((t239:0.2179376772,(t240:0.1474824321,t241:0.1443644551):0.06351448109):0.2238434597,t242:0.4272224501):0.2407050051,t243:0.6554228999):0.4609153327):0.5073286919):0.1509644945,(((t244:0.3214635142,t245:0.3063964369):0.5565525132,(t247:0.5966680946,t248:0.5920149187):0.2329477335):0.6302925625,((t249:0.569515827,t250:0.5221991776):0.7657681387,t251:1.28629613):0.1132075664):0.2467274135):0.1748049335):0.1394723897):0.2237907254):0.7537197739):0.07445713712):0.4887661078):0.688928991):0.2350987711,(((((((t252:1.305012537,(t253:0.5137047254,t254:0.5079306517):0.7912966624):0.3186405198,t255:1.596084511):0.9119268324,((t256:2.179125382,(t257:1.762464752,((((t258:0.6177606596,t259:0.607571977):0.04722570733,(t260:0.4253079202,(t261:0.161470431,(t262:0.05520848128,t263:0.04254522619):0.102964957):0.2551354965):0.2191888093):0.1035974126,t264:0.7153325355):0.7121367955,(t265:0.6738799075,t266:0.668810399):0.7498611378):0.2726232611):0.4123144815):0.1814944606,(((t267:0.1704466399,t268:0.1320734543):0.2232961673,t269:0.3418315167):0.779451812,t270:1.114717392):1.086426214):0.1274292734):0.1623501039,(t271:1.914983706,(((((t272:0.6210178939,t273:0.6144787674):0.01678288123,((t274:0.1042984295,t275:0.1034591167):0.06523155518,t276:0.1646098291):0.4587835946):0.2193538831,(t277:0.3472341323,t278:0.3434714364):0.4714306341):0.60131267,t279:1.409213992):0.1182214953,((t280:0.6948729055,t281:0.6801983197):0.668845344,(t282:1.099400278,t283:1.093463242):0.2493094969):0.1485593664):0.2926090399):0.572329701):0.3732547252,(t284:1.292520906,t285:1.288839272):1.435018854):0.2328252668,((((t286:1.114859042,(((t287:0.1508120087,t288:0.1394432492):0.6961824033,t289:0.8264975449):0.2504602781,t290:1.074596148):0.0160940104):0.04112502266,t291:1.128054761):0.0502714387,(t292:0.3936122178,t293:0.3793561971):0.7712143157):0.998984645,(((((t294:1.079894187,(t295:0.8079782989,(t296:0.3693122643,t297:0.368751332):0.4322112906):0.2643484067):0.032802761,t298:1.086410882):0.5996592284,((t299:1.342740143,((t300:0.2357291588,t301:0.2256171854):0.6605533674,(t302:0.5485226817,t303:0.5355573185):0.3179809237):0.4460423481):0.2134972387,(t304:0.9326575431,t305:0.9277680574):0.5643087202):0.1204267709):0.1428063483,((((t306:0.6766201584,t307:0.6668244186):0.5277061876,(t308:0.05744679728,t309:0.0434314085):1.136167445):0.07825796478,t310:1.257830179):0.2131248254,t311:1.459345176):0.2593615257):0.2421575196,(((((t312:0.909585393,t313:0.9058814483):0.05875278207,t314:0.9502861888):0.3016409242,(t315:0.8292297888,t316:0.8113573978):0.418864084):0.08060792158,(t317:0.7205465299,(t318:0.3013740722,t319:0.2934313739):0.4140937252):0.5815758222):0.376593006,((t320:0.3250268995,t321:0.3172534894):0.5569020318,t322:0.8732976889):0.76372696):0.2287648502):0.04082543627):0.7489739975):0.3344003135,(((t323:0.5285891645,t324:0.5276627734):0.1492023428,(t325:0.5946510955,t326:0.5749050029):0.08217487721):0.8766902876,((t327:0.02696230463,t328:0.02515343332):0.9509805304,((t329:0.8099970131,t330:0.7947838191):0.1443916021,(t331:0.02745796478,t332:0.01866838931):0.8936458756):0.02049345775):0.5463636318):1.432755769):0.7708912248):0.5172550409,(((((((((t333:0.09275017101,t334:0.08806660018):0.5213985466,t335:0.6056605343):0.2901941859,(t336:0.362242254,t337:0.3584236362):0.5275759103):0.3563277101,(((t338:0.139383991,t339:0.124830594):1.038240073,t340:1.155410993):0.02053265971,(t341:1.166901206,t342:1.16616468):0.002102485576):0.01731714801):0.2045604819,((t343:0.8538952383,(t344:0.5978672047,t345:0.5978440316):0.2504459124):0.109388392,(((t346:0.2119941043,t347:0.2084214315):0.01551544562,t348:0.216817174):0.3228775682,t349:0.51672948):0.3938078046):0.4265870403):0.7077989752,((((t350:0.3556004579,t351:0.3223258382):0.02156332252,(t352:0.08194431928,t353:0.05893946226):0.25930886):0.5996297516,((t354:0.6015373972,t355:0.5862658405):0.1173161642,(t356:0.5326598652,(t357:0.02730750796,t358:0.02617624542):0.4706448856):0.166929464):0.1814087767):0.1391438527,((t359:0.3430542517,t360:0.337993317):0.063043408,t361:0.3853086043):0.5591740101):0.9081964973):0.02948712071,(((t362:0.7238128802,(t363:0.6996116974,(((t364:0.08922280908,t365:0.08107493806):0.4658319586,t366:0.545960074):0.07640029653,(t367:0.2678835671,t368:0.2657013165):0.3519861062):0.02746535426):0.02012141388):0.4423787074,(t369:1.081615939,(t370:0.3953056859,t371:0.3664917932):0.6714363642):0.01710476776):0.09755266378,t372:1.122590742):0.6091180568):0.2621112417,((((t373:0.01791087894,t374:0.006621490155):0.467579088,t375:0.4689483949):0.5252845385,(((t376:0.1986341065,t377:0.1906717731):0.0189049145,t378:0.2086693759):0.3051632374,t379:0.4984152762):0.4448325261):0.9194877191,((t380:0.3576840079,(t381:0.1280699716,t382:0.1220420971):0.222399852):1.331854497,((t383:0.9102944267,((t384:0.1473534297,t385:0.1437871887):0.5070986336,t386:0.6478879403):0.2535565801):0.5216544704,((t387:0.7261683137,t388:0.7076509686):0.1580464648,((t389:0.1872735282,t390:0.1407578262):0.6256990461,(((t391:0.05809328756,t392:0.04769573099):0.5419898655,t393:0.5775126704):0.01857292329,t394:0.56891787):0.1476071972):0.02926351302):0.513021268):0.2385852264):0.1471617168):0.05165340231):1.625500688,(((t395:1.121360853,(((t396:0.8084639116,t397:0.8001691266):0.1177817979,(((t398:0.7217061735,t399:0.7066662218):0.1432731118,t400:0.8353044869):0.02549520351,((t401:0.5153385896,(t402:0.2995291936,(t403:0.04105189705,t404:0.03884553722):0.2524133361):0.2091248373):0.03578833428,t405:0.5152012329):0.3079593072):0.02084909229):0.06201992851,(t406:0.673906169,t407:0.6734410155):0.2306602099):0.1309651794):0.3800777061,(t410:0.2200803397,t411:0.2016993541):1.113199123):0.4362170565,(((t412:0.2221893505,t413:0.2214958745):0.510138116,((t414:0.2397100647,t415:0.2358419239):0.1065823261,(t416:0.1625591114,t417:0.1605860711):0.1686495645):0.3609869996):0.5679158782,(((t418:0.4135802213,(t419:0.05219315431,t420:0.04108153978):0.355034524):0.1795041471,t421:0.5613943503):0.2701423688,(((t422:0.4979301664,(t423:0.4289505282,t424:0.4283554954):0.05877338048):0.244048998,t425:0.719604112):0.06752727997,(t426:0.244905645,t427:0.2373993833):0.5333001166):0.002321716705):0.3937557191):0.4271163348):1.381410053):0.1041084267):0.804905682);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.boombust.T58.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
