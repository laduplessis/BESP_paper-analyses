<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((((((((t75:1.375460662,t76:1.370081222):1.156768319,t77:2.52401585):0.5570556352,t78:3.034104645):0.4798696313,((t79:2.900320779,(t80:1.364848801,t81:1.351399487):1.532632239):0.5862825329,t82:3.436423836):0.0161969242):1.081144551,((t83:4.032430327,(t84:3.895657673,(((((((t85:0.2377117587,t86:0.2344022126):0.1312363928,t87:0.3511477093):1.614149441,(t88:0.2335676756,t89:0.2330808795):1.721244728):0.3689113206,((((t90:0.07496467699,t91:0.07226077282):0.1028053748,t92:0.1727773865):0.9667126968,t93:1.132917337):0.5174641617,t94:1.647356472):0.6555021354):0.8384121323,t95:3.120967386):0.4635140811,(t96:2.041000508,t97:2.009403439):1.538704598):0.04472662848,((((t98:1.609273131,t99:1.594799827):1.220472401,(t100:1.913819537,((t101:0.04969685914,t102:0.04252963528):1.715886645,t103:1.755521878):0.1383380346):0.8964575275):0.05586246339,((t104:2.235213744,t105:2.220766852):0.5575070862,t106:2.778190992):0.04650006388):0.6829668223,(t107:1.568887966,t108:1.566706235):1.933396878):0.007244038362):0.1900050101):0.1357386948):0.1799259569,((t109:3.161981184,((t110:1.404054719,(t111:0.2253814929,t112:0.2252981755):1.164215776):1.723197497,((((t113:1.026966344,t114:1.01988994):0.6822917388,t115:1.701065232):1.028837298,t116:2.728806791):0.2516564852,t117:2.978601877):0.1190271826):0.01942554894):0.7411074024,(t118:2.042708806,(t119:1.421910541,t120:1.42057673):0.6073517966):1.80338208):0.0674731392):0.3185888455):0.7189318022,(((t121:0.09094835691,t122:0.08636087417):2.008865734,t123:2.09094496):2.224152601,(((t124:2.97824875,((t125:2.444162389,(t126:1.321441224,(t127:0.9588364248,t128:0.9561386325):0.3571949365):1.117878101):0.4903240558,((t129:0.927533846,t130:0.9199728897):0.3993586708,t131:1.318468734):1.560042356):0.04294156633):0.2306293355,(t132:1.659205909,t133:1.644598118):1.479516992):0.8793976765,((t134:1.825622411,t135:1.818833654):1.015075733,(t136:2.282698616,((t137:0.9497138059,t138:0.9492395688):0.4090457657,(t139:0.9980868893,t140:0.9921506734):0.3571113053):0.9144668059):0.5317938611):1.160308134):0.2259334703):0.6120674547):0.401874136,((((((((t141:3.332023391,((((t142:1.337235419,t143:1.309851623):0.6562380724,t144:1.965518638):0.06900097672,((t145:1.684346788,t146:1.673879841):0.2056261045,((t147:1.006606383,t148:0.9916431931):0.6886540943,t149:1.674632096):0.1733600631):0.1282068937):0.3735262235,((t150:1.401132216,t151:1.399154362):0.5008363451,t152:1.899257843):0.4422517745):0.8850760477):0.04960920783,t153:3.251084592):0.1850304844,t154:3.43595399):0.3142575674,((t155:1.824678358,(t156:1.200190561,t157:1.168476062):0.6210674838):0.9291536329,(t158:0.06535662566,t159:0.05377209983):2.650770269):0.9836896351):0.06434307625,((t160:2.599675079,(t161:1.896521609,(t162:1.889135053,(t163:1.28281204,t164:1.27174137):0.5776886828):0.0005848090225):0.6720496741):0.5772410084,((t165:1.256652068,t166:1.251427522):0.6736270777,t167:1.89799292):1.165231152):0.5616030583):0.4371028191,((((t168:0.6846590932,(t169:0.5706595638,t170:0.5323076468):0.1097859832):0.9662213169,t171:1.603863493):1.865466583,(((t172:2.424803113,((((t173:1.942783771,t174:1.926597305):0.1689851209,(t175:1.923285439,(t176:1.672780977,t177:1.662676022):0.2411900977):0.1651607712):0.06972051647,(t178:1.74263808,t179:1.741167272):0.3908397282):0.0678241944,(t180:1.047623085,(t181:0.5276484411,t182:0.5220308187):0.5131612203):1.137588596):0.1741292686):0.4365289539,t183:2.772958192):0.183649224,((t184:0.9287614434,t185:0.9266712527):0.2979699583,t186:1.220488946):1.727917281):0.4243082925):0.2432313352,((t187:1.953195742,((t188:1.602563615,t189:1.589637609):0.144372425,((t190:0.8343896248,t191:0.8337834577):0.5983191714,((t192:0.7710718429,t193:0.7522202753):0.2019173838,((t194:0.7207210123,t195:0.7202935936):0.1588215699,t196:0.8634392294):0.05635757965):0.4153407753):0.2680675818):0.1836431206):0.611141823,(((t197:1.512486272,t198:1.509317666):0.5951537983,(((t199:1.01841271,t200:0.9771159752):0.1009208934,t201:1.042361646):0.4688849782,t202:1.503582604):0.5161394362):0.01622234408,((t203:1.340049465,(t204:1.222352537,t205:1.212074562):0.1065546262):0.5771778026,(((t206:0.9531116431,(t207:0.7744618754,((t208:0.6918011893,t209:0.6711986133):0.05408466975,t210:0.7229433052):0.0252899604):0.1782628511):0.5403979464,(t211:0.1252385345,t212:0.1149954109):1.333250811):0.0403986477,((t213:0.4344761771,t214:0.4315892989):0.1836186676,t215:0.5980911146):0.8495554405):0.3574204578):0.09471380191):0.2668883593):1.050526192):0.2795283751):0.4453482648,(t216:1.276688541,(t217:1.081943903,(t218:0.3572222005,t219:0.3569380738):0.6998712962):0.1860161809):2.654075378):0.1056380323,((((t220:1.419639891,t221:1.413591137):0.1079597529,t222:1.478296237):1.222770265,((t223:1.816801053,((((t224:1.43773196,t225:1.404905058):0.03059941438,((t226:0.1163251242,t227:0.1096123363):0.008188467531,t228:0.1072445188):1.294158421):0.2020570364,t229:1.600230173):0.0951556526,t230:1.691046142):0.04352866192):0.8463356147,(((((t231:1.259487553,t232:1.231847497):0.1041109013,(t233:1.060761898,t234:1.059262268):0.2747406647):0.2115360745,(t235:1.078864093,((((t236:0.1583335825,t237:0.1501777425):0.6357554286,t238:0.7826159656):0.1543731863,t239:0.9363765615):0.06890395183,(t240:0.8960565182,t241:0.8932218486):0.09367711731):0.05141029833):0.4568296384):0.2891770051,(t242:1.53739893,((t243:0.1660638366,(t244:0.06587274196,t245:0.04795590564):0.08850192718):0.02257714564,t246:0.1572993549):1.337471579):0.2440234909):0.6610323724,((t247:0.3601950536,t248:0.3571370247):0.8393446058,t249:1.195971506):1.191546531):0.04086153741):0.03765803093):0.3403111039,((((t250:0.6966022572,t251:0.6927750605):0.3220583844,(t252:0.1752552493,(t253:0.03430811174,t254:0.0230427488):0.1298155245):0.836285619):0.926373764,(((t255:0.8840276972,((t256:0.4580207162,(t257:0.2837209576,t258:0.2739488006):0.1707425271):0.295405408,t259:0.7169582692):0.1271806352):0.5006804298,t261:1.319350756):0.004800463483,t262:1.306537834):0.4981697084):0.3385969684,(t263:0.9839310646,t264:0.9798948136):1.143760458):0.5155395521):0.9078198677):0.2390685403):0.4750070923,((((((((t265:0.8657068196,t266:0.8580540593):0.2767131761,((t267:0.1805099238,t268:0.1598975015):0.7563758603,t269:0.9013820503):0.1843019635):0.1849818118,(t270:1.010225019,(t271:0.9194869519,(t272:0.8922570975,t273:0.8419474246):0.0237783539):0.07319058372):0.2430641706):0.632969107,(((((t274:0.3312336531,t275:0.3199343817):0.5933165362,t276:0.8952063538):0.3134013545,t277:1.204280956):0.2440611712,t278:1.446752943):0.08377902921,t279:1.529032072):0.2404929595):0.2613223733,((t280:1.194185011,(((t281:0.5853694525,t282:0.5697104952):0.4248095274,t283:0.966556155):0.06008652019,(t284:0.9974189036,t285:0.9966046966):0.00884483172):0.1106735411):0.6642111847,(t286:1.513387685,(((t287:0.1032754137,t288:0.07294611259):0.9564862863,t289:1.008588044):0.1613724902,(t290:1.037074638,t291:1.030493756):0.1246224488):0.2913374128):0.2656816019):0.1623053025):0.2901564199,t292:2.157858289):0.5044416222,(t293:1.416890037,t294:1.414683583):1.244372426):0.03204749452,((t295:1.014604381,t296:1.010270097):0.7530553041,((((t297:0.4809398432,t298:0.4706283142):0.7583024267,t299:1.216123048):0.1253974647,(t300:0.3474027147,t301:0.3308712801):0.990116608):0.3079464204,(((t302:0.6054531948,t303:0.5928614733):0.2039419341,((t304:0.03591449824,t305:0.03206533593):0.6159932656,t306:0.6464052587):0.1361827099):0.07802910414,t307:0.85159936):0.7315588801):0.05413594):0.913695331):1.210282068):0.3867133899,((((((((((t308:0.02006340513,t309:0.0196102501):0.08529196218,t310:0.1047106401):0.7198678186,t311:0.82452248):0.2822135772,t312:1.103684131):0.5730124145,((t313:1.005881513,t314:0.997298844):0.03797129158,t315:1.032307998):0.6292136035):0.1659941238,((t316:1.093115148,(t317:0.2447135616,t318:0.2286963403):0.8446650032):0.6752770289,(((((t319:0.2971914747,t320:0.2908295301):0.5471053071,t321:0.8310223409):0.2042341965,t322:1.022191798):0.05757745984,((t323:0.8711477716,(t324:0.8308928792,t325:0.8161409022):0.03408710502):0.1645873361,((t326:0.7417575279,t327:0.7318034159):0.0478119103,((t328:0.2006858646,t329:0.1997296784):0.2742244551,t330:0.4722396862):0.2828078468):0.2230286334):0.02329129031):0.4271468062,(((t331:0.9758114016,t332:0.9693191111):0.2196437679,((((t333:0.2883106517,t334:0.2492975713):0.1568849725,t335:0.4053230142):0.3800725013,(t336:0.5056559945,t337:0.4889105474):0.2645448408):0.2858970396,(t338:0.3100115403,t339:0.3094255351):0.727391897):0.06914459793):0.2026287075,((t340:1.124011424,(t341:0.6186453939,(t342:0.4957038172,(t343:0.1599063105,t344:0.1452366117):0.3280227103):0.09048308416):0.5009753502):0.02957162258,((t345:0.3214463416,t346:0.3177874365):0.7690610699,((t347:0.02739071905,t348:0.02176113131):0.1868319415,t349:0.2061460606):0.8655120743):0.001982794625):0.1472468693):0.01972567091):0.2094046064):0.05702633922):0.7391099941,(t350:1.38803112,t351:1.384796148):0.851514496):0.1273493183,((((t352:0.6637088584,t353:0.6601443594):0.5350184557,(t354:0.4272484701,t355:0.4064375888):0.7352663969):0.4232125213,(((t356:0.1638403128,t357:0.08518211036):0.9964749758,(t358:0.7807620774,(t359:0.2650836294,t360:0.2516269743):0.5113132798):0.2861335792):0.1580319864,(((t361:0.6350777832,t362:0.6256515265):0.4144373267,(t363:0.9109839657,(t364:0.5363135603,t365:0.5347228809):0.3653610805):0.128069471):0.06953934041,(t366:0.1306015811,t367:0.1064559527):0.9599572974):0.06988258965):0.192206494):0.5416981241,(t368:0.6815236028,(t369:0.1291371642,t370:0.1274889096):0.5455051007):1.185030944):0.1973138301):0.1400270131,(((((t371:0.1163888162,t372:0.1111215777):0.4804241824,(t373:0.4612124896,t374:0.4570644098):0.1165373703):0.1748995731,t375:0.7211638063):1.146239165,((((t376:0.3344169323,t377:0.3118491354):0.06962803407,t378:0.3755932143):0.7498109218,t379:1.120770398):0.5352749794,(((t380:0.4006020989,(t381:0.3110020193,(t382:0.2550493166,t383:0.2516760803):0.05421297228):0.08048989508):0.4053747677,((t384:0.4971407225,(t385:0.07333783686,t386:0.0682085189):0.3936696197):0.2262403498,(t387:0.237555233,t388:0.2336468087):0.443898756):0.03063638195):0.5175335614,(t389:0.5264492775,t390:0.5144965953):0.6974949717):0.2988947963):0.178113006):0.05811826465,(((t391:1.167076494,(t392:0.7350789659,((t393:0.1198511073,t394:0.1140376987):0.43490761,t395:0.5478765121):0.1753735494):0.4234736306):0.08755391268,(((t396:0.2337455561,t397:0.2310956291):0.2358338492,(t398:0.4511992649,t399:0.4444954999):0.01413304216):0.1084384187,((t400:0.1869945841,t401:0.1781568126):0.06828662966,(t402:0.1338285725,t403:0.1049140843):0.1059731432):0.3059756325):0.6382578121):0.3927459597,((t404:0.6770205707,(t405:0.2707344016,t406:0.2633002545):0.3963605602):0.5329781373,t407:1.154354925):0.315404529):0.06981162455):0.2098592566):1.073087178,((((((((t408:0.06631174512,t409:0.05904503607):0.3552141829,(t410:0.2287140631,t411:0.2063257563):0.1831321586):0.2142329171,(t412:0.489315581,t413:0.4646208914):0.1139920572):0.1141607077,(t414:0.4748656143,(t415:0.1874512919,t416:0.1636564945):0.2823962206):0.2085296449):0.1416638509,t417:0.7901392037):0.2509813482,(((t418:0.5408649572,(t419:0.4220356424,(t420:0.0497479681,t422:0.03625059413):0.360877977):0.1118434386):0.04342964347,t423:0.5507409108):0.3682955106,t424:0.9167681101):0.08589834765):0.2702613095,((t425:0.3161621523,t426:0.3039246899):0.6648390039,(t427:0.4034319337,t428:0.3831387027):0.564955089):0.2913512253):1.224430213,(((((t429:0.3732757329,t430:0.3654810373):0.2105416992,(t431:0.1168904342,t432:0.1125536744):0.4316390504):0.3237798389,(t433:0.009177076242,t434:0.005872864334):0.8554277154):1.224856092,(t435:0.241078469,t436:0.2332355782):1.824017842):0.07477069136,(((((t437:0.1124889688,t438:0.0902615485):0.1544987351,(t439:0.1706269618,t440:0.1594881526):0.07241090285):0.1333939198,t441:0.3382222258):0.9465372529,(((t442:0.6132221931,t443:0.6087242093):0.2996576028,t444:0.9076115493):0.02387195021,t445:0.9032078021):0.3302306359):0.5140417326,(((t446:0.1954596614,t447:0.1626079104):0.9644841695,t448:1.115502088):0.5214132253,((((t449:0.316845202,t450:0.3106689827):0.2581015408,(t451:0.1397191571,t452:0.1064037943):0.4197289909):0.02147744791,t453:0.5379553398):0.5487619033,((t454:0.3912973575,((t455:0.07344723448,t456:0.07232430994):0.2184072582,t457:0.2865676294):0.09147317773):0.6320460961,((t458:0.47972697,(t459:0.02846170003,t460:0.02809719212):0.4301249214):0.3440194235,t461:0.8005084323):0.1794907847):0.05808664358):0.4823718745):0.06477289177):0.2701533106):0.2339755969):0.1730455896):0.1924799496):1.224368575,(((((t462:1.112995348,((t463:0.0267024581,t464:0.02032208913):0.008188562742,t465:0.02680093169):1.073917266):0.8460574284,((t466:0.1868821905,t467:0.1827718252):0.2127133443,(t468:0.2982874775,t469:0.2888730739):0.09360420085):1.537013295):0.6956295365,t470:2.59879217):0.5109863112,(t471:2.812227444,(t472:1.070647787,(t473:0.4181018161,(t474:0.005643370841,t475:0.004452513985):0.4024754971):0.6467836915):1.72881333):0.2425569584):0.4329826805,((t421:0.004820598069,(t260:0.004168325734,(t1:0.421739225,t2:0.4205368097):2.170380319):1.827989465):0.3648766778,t3:4.777003086):3.649267384):0.0802533482):0.02867735634,((((((t4:0.6057207056,t5:0.6052838345):3.192913272,((t6:2.862157909,t7:2.850508642):0.4702697686,((t8:0.8473679469,t9:0.8371600681):2.07652114,(t10:0.8078881179,(t11:0.8060335633,t12:0.7988247149):0.0009406166377):2.068956928):0.393460063):0.4626307371):0.04295002969,((t13:0.3897641173,t14:0.3883196714):0.06155900034,t15:0.439136153):3.310260071):0.3212963267,(t16:0.3576315296,t17:0.3570956267):3.707216939):1.044725439,((((t18:0.6971491048,t19:0.6961339155):3.079063294,(t20:3.686073924,(t21:3.454667992,(((t22:2.256336416,t23:2.249485977):0.7718883122,t24:3.01844177):0.3416469667,t25:3.354412108):0.08231133615):0.2297735326):0.0733260909):0.7805747181,(((t26:3.881582147,((t27:2.418168232,((t28:2.264686997,t29:2.257304783):0.0551280405,(t30:0.1527701904,t31:0.1384671412):2.13148737):0.08524709138):0.5440446582,(t32:2.794340904,t33:2.784377477):0.09655551722):0.9152399737):0.3327951269,((t34:0.3874556658,t35:0.3385308):3.484123979,((((t36:1.130363929,((t37:0.1132581059,t38:0.1092599438):0.8726632317,t39:0.95964816):0.1429698568):0.09271558962,t40:1.187737595):1.764819026,(t41:2.91499567,t42:2.909317102):0.02697413177):0.4620902552,(((t43:1.022855387,t44:1.016024256):1.409208538,(t45:1.921850984,((t46:0.7775818838,t47:0.7771224752):0.9066055796,t48:1.65464759):0.2360539813):0.4957714735):0.120285363,t49:2.474586585):0.8420817143):0.3720183213):0.242846008):0.1652405843,(t50:4.079498573,(t51:0.6187836746,t52:0.6186919796):3.427088373):0.01100466543):0.1403893728):0.2609895917,((((t53:0.4676520548,t54:0.467148585):0.1230479108,t55:0.5867866462):2.590322312,(t56:2.890408108,(t57:1.103373644,t58:1.103299511):1.787032408):0.2673165129):0.5021049988,((t59:0.6396780294,t60:0.6361950776):0.01635959915,t61:0.6356290343):2.993297938):0.7589486121):0.2885578306):0.1828633864,((((t62:0.9132258485,t63:0.9112847334):2.598392004,((t64:1.013444294,(t65:0.633348883,t66:0.6141167608):0.365070529):0.3047668907,t67:1.280976674):2.189007661):0.5704495772,((t68:0.6645785345,t69:0.6639986985):2.365502234,(t70:2.567585834,(t71:0.1576131499,t72:0.1483540677):2.395459263):0.4598811174):1.004913801):0.4513712867,(t73:1.980763311,t74:1.950820576):2.471254625):0.3228313352):3.1447261);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.boombust.T49.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
