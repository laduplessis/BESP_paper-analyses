<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t440:0.06326770045,t441:0.06310205047):0.6449577227,t442:0.6721445258):0.9996769659,(((t443:0.8563560453,t444:0.8442474092):0.1343928129,((t445:0.5704459648,t446:0.563905159):0.08061093228,t447:0.5890975548):0.3169115203):0.6044130997,((((t448:0.250449081,t449:0.2451756022):0.297618951,t450:0.5296398605):0.224839438,(t451:0.1483007994,(t452:0.05165259223,t453:0.04630589567):0.07716714766):0.583961945):0.4623433847,(((t454:0.2477217651,t455:0.2401392681):0.1321413395,(t456:0.163735933,t457:0.1636066918):0.1967777398):0.03157179018,((t458:0.1035295993,t459:0.09759336519):0.06042964188,t460:0.1535081427):0.22556555):0.7474776598):0.2681240039):0.07008750847):0.5199821474,(t461:0.9659530244,(t462:0.01453970744,t463:0.0009456107724):0.9502953395):0.9840701981):1.420955931,(((((t464:0.9695628867,(((t465:0.1310977183,t466:0.1070408745):0.37598397,(t467:0.04622895637,t468:0.02475889324):0.4347518401):0.4455824265,t469:0.8951179206):0.01665006931):0.06698687424,((t470:0.5723930871,t471:0.5509498655):0.1919203904,t472:0.7181019132):0.1769238851):0.1261837618,((t473:0.1204690548,t474:0.1196834574):0.6462968637,(t475:0.4680226243,(t476:0.2229293707,t477:0.2212179019):0.2392565605):0.2941591203):0.2534279957):0.385111659,(t478:0.5500033645,((t479:0.1903117695,(t480:0.06171428367,((t433:0.002894438411,(t428:0.004540075363,(((((t27:0.02770572383,t1:0.2202085354):0.7157684178,t2:0.9348833473):2.209549722,t3:3.132915274):0.6733133938,(t4:3.248638144,t5:3.245663782):0.5453475529):0.1620904809,(t6:1.148312389,t7:1.144025278):2.800462077):0.2853678534):0.08139550957):0.1265876199,((((t8:1.374175512,t9:1.371850988):1.196564267,(t10:2.11075994,t11:2.098473748):0.4557049668):0.09546913221,(t12:0.8457496383,t13:0.8452589702):1.789805613):1.381939643,(((t14:0.5335491445,t15:0.5217735161):3.222848611,(t16:0.1622779724,t17:0.1601488862):3.580865073):0.17869747,(((t18:1.568531636,t19:1.564123893):1.204679024,t20:2.766189473):0.8872401094,(t21:0.7548485009,(t22:0.5258487166,t23:0.522159345):0.2090543191):2.888963615):0.2505027391):0.07539083291):0.388745546):0.5252830836):0.1206631139):0.05298529841,((((((t24:1.645305702,t25:1.634687251):0.8359773182,(t26:1.658863589,(t28:0.3475233878,t29:0.3397100625):1.206583218):0.7986226037):1.681053945,((t30:3.09685099,((t31:2.406007405,(t32:1.372188004,t33:1.358627438):1.025627291):0.5449201536,t34:2.916802541):0.138732456):0.5409345178,t35:3.595693739):0.3849370522):0.1614208078,(((t36:0.1588867818,t37:0.1511630808):1.037758009,t38:1.179054797):2.04930025,(t39:2.167132583,t40:2.11919324):1.059591073):0.8816844335):0.3308319339,(((t41:1.333393909,t42:1.33317762):0.801705565,(t43:0.479710845,t44:0.4647601398):1.629276463):0.9861711575,(t45:1.75074206,(t46:0.8607107784,t47:0.8405293303):0.8870310054):1.325729443):1.266476721):0.05627215834,(((t48:2.744557438,(t49:0.6962271947,t50:0.6955418374):2.045538):0.8114403437,((((t51:1.04401828,t52:1.041841588):1.251559448,t53:2.292871307):0.7920904854,t54:3.082089142):0.2845064813,t55:3.362363131):0.1791635194):0.1592254852,t56:3.692206754):0.6455346047):0.3121322277):0.305725091):0.8302246702):1.300098362,((((((t57:3.003372688,((t58:2.370275568,t59:2.348074117):0.3075516901,t60:2.649231327):0.32179758):0.7588000828,(t61:3.000064775,t62:2.970849934):0.7123797664):0.7136473525,((t63:0.5296157542,t64:0.5094018301):3.701398836,((((t65:2.536508104,t66:2.525990386):0.819343658,(t67:3.318563324,((((t68:0.4771178151,t69:0.4724278082):0.2544552388,t70:0.7224337066):0.08592298138,t71:0.80572097):1.733106292,(t72:0.3903523381,t73:0.3684405752):2.134720172):0.7597939114):0.02645538661):0.1673051424,((t74:2.57389646,t75:2.5683074):0.3234410193,(t76:2.670485286,t77:2.667787657):0.2182268199):0.5492897765):0.2702544597,((t78:0.1355908408,t79:0.1283877609):0.6614343162,(t80:0.2058998671,t81:0.2056935844):0.5790472103):2.885542153):0.4032107326):0.1632950623):0.1495165288,((((t82:2.368096909,t83:2.365419405):0.2069271099,(t84:0.9388167776,t85:0.9309082497):1.625949899):0.7347103612,(t86:2.952946123,t87:2.945475274):0.3174598994):0.5465185908,(t88:3.144270637,(t89:0.8179558479,t90:0.8163833941):2.315856166):0.6508600112):0.5269273946):0.9031965192,((((((((((t91:0.04234682434,t92:0.02895998701):0.07771450006,t93:0.05835819625):0.07639577452,t94:0.122476723):2.587904465,t95:2.694213677):0.3430098854,(((((t96:0.130945442,t97:0.1156060184):0.8056910339,t98:0.89289333):0.345005947,t99:1.223297987):0.9382093253,(t100:2.035338984,t101:2.021402697):0.1250563259):0.6555555288,t102:2.800281722):0.1537207537):0.5443753087,(t103:2.861474783,((((t104:2.071359714,(t105:2.051926743,t106:2.048579696):0.01216177366):0.1547880175,t107:2.214749997):0.2836535992,(((t108:1.429186837,t109:1.429029358):0.4658437384,(t110:0.2579153871,t111:0.2577763696):1.635728563):0.3975100015,t112:2.280407829):0.2013278902):0.2327434609,(((t113:0.5558506388,t114:0.5501108306):1.376937336,(t115:1.320199454,t116:1.309362246):0.5968906346):0.1840820754,t117:2.07005286):0.596793195):0.1188517453):0.6329179816):0.3466231633,(t118:2.845193528,t119:2.844572305):0.9197426974):0.1484989204,t120:3.908486293):0.0513122814,t121:3.959167766):0.4567012401,((t122:3.061845396,((t123:1.339097823,(t124:0.9789658892,t125:0.9755043934):0.3525004373):0.1623275709,t126:1.475257809):1.546769508):0.005905655181,(t127:2.514237431,(t128:1.752327474,t129:1.749375405):0.7567503099):0.5027814882):1.332618336):0.5315226719):1.227935434,((((((((t130:0.1083702602,t131:0.1006816338):1.79731914,t132:1.895642649):0.8266884876,(t133:2.197819104,t134:2.161055205):0.518772794):0.3340104838,t135:3.010817896):0.9651143061,((t136:1.65544352,t137:1.643108634):1.221787272,(t138:1.791991778,t139:1.783099938):1.047722586):1.085121009):0.3329422837,((t140:3.595861729,(((t141:2.793686152,(t142:1.738223636,(t143:1.543218529,t144:1.540303461):0.1946757285):1.02211961):0.2428446776,(t145:1.58188341,t146:1.572863505):1.413942378):0.4354416994,(((t147:1.703782073,t148:1.695262104):0.3924101113,(((t149:0.3700832893,t150:0.3510270771):1.27248142,t151:1.614196402):0.3099759039,t152:1.911303201):0.1200725238):0.9331525763,(t153:2.893492004,(((((t154:1.486813352,((((t155:0.1334863681,t156:0.1136541681):0.9651372197,t157:1.067247164):0.09677835978,t158:1.113321113):0.1322534205,t159:1.238402702):0.1544383627):0.1889175138,t160:1.549621006):0.4056130112,t161:1.945816184):0.1222245301,t162:2.022603366):0.4210716547,t163:2.432299576):0.2662925896):0.06855680272):0.3728876998):0.119266854):0.4153990251,((((t164:2.002411284,((t165:0.9197240225,t166:0.8966642535):0.8687400017,t167:1.759127858):0.2106016162):0.509894616,((t168:2.096367957,(((t169:1.049333861,t170:1.049131442):0.1500603408,t171:1.198041061):0.8547631645,(t172:1.328692314,t173:1.328277819):0.7139155526):0.03336265567):0.1670297633,(t174:1.342888955,t175:1.329714689):0.899633307):0.1617064732):0.8197211431,(t176:2.418866547,t177:2.412696543):0.7710876467):0.2172509119,t178:3.395398467):0.1039295133):0.2230573033):0.8987325501,(((((t179:3.070009666,(((((t180:2.141247011,(t181:1.113373949,(t182:0.5023158178,t183:0.4509421812):0.608946359):1.026649691):0.5501506313,((t184:0.05227090478,t185:0.02262300931):1.67063666,(t186:0.7499175571,t187:0.7465283675):0.928081691):0.9125015965):0.1444097548,(((((t188:1.361407463,t189:1.356034713):0.5042283045,t190:1.774682416):0.2325093213,(t191:1.035828805,t192:1.033103386):0.9434430011):0.3155646682,(((t193:1.0303637,t194:1.027207456):0.1688691942,t195:1.181837173):0.7183250213,t196:1.89819949):0.3477825609):0.1866342147,(t197:2.077524006,(t198:1.173653947,t199:1.168519386):0.898958808):0.3406175711):0.1152831753):0.1201749887,(t200:1.66179608,((t201:0.2870557416,t202:0.2829541036):0.6363299505,t203:0.9164297484):0.7364481537):0.9709425045):0.0126788396,(((t204:0.346029767,t205:0.3442764794):1.13808456,(t206:0.5504902857,t207:0.547156372):0.9222473338):0.6137592305,t208:2.079702055):0.5324120062):0.0900395618):0.1407905839,(((t209:0.06706266178,t210:0.05436443834):0.7684512464,((t211:0.1311879407,t212:0.1308513829):0.1978109502,t213:0.3207047046):0.4767715085):0.02866846144,t214:0.8249163118):1.973688244):0.2570097111,(((((t215:0.3077560401,t216:0.2981627717):1.301813661,t217:1.56518524):0.4123584166,t218:1.9735161):0.2111969515,(((((t219:1.081105058,t220:1.079366995):0.9535572046,(t221:1.942717178,t222:1.936560963):0.08550289545):0.1198294693,((t223:0.7310897332,t224:0.7045401964):0.4774505914,((t225:0.4375447172,t226:0.4372741522):0.3559902878,((t227:0.07517761655,t228:0.06440970656):0.478152372,t229:0.5329592826):0.2382217635):0.3862781972):0.9319014213):0.001426914721,t230:2.086252342):0.01226156538,(((t231:0.9797637773,((t232:0.8158814543,t233:0.8029176534):0.003156257248,t234:0.7956538358):0.157688794):0.2913675745,(t235:0.8037481835,(t236:0.5569729617,t237:0.5270163981):0.2358875616):0.4404327982):0.2714513681,(t238:0.9532887319,t239:0.9485326248):0.5157392434):0.5508262758):0.0156083911):0.1345494931,((t240:1.588830176,(t241:1.496691553,(t242:1.381983891,t243:1.380109101):0.1137177768):0.09041205184):0.4541681507,t244:2.037214406):0.09574541882):0.6772087041):1.089324766,(t245:3.772233757,((((t246:0.9981216652,((t247:0.3540081259,t248:0.3478661877):0.1065712202,t249:0.4409034668):0.5347271962):1.749277457,(t250:1.929002321,t251:1.881664778):0.7486154896):0.9036786798,(t252:0.6251849056,t253:0.6210450988):2.901151934):0.06926903211,(((t254:1.46254684,(t255:0.9285729561,(t256:0.661136682,t257:0.6600838187):0.2523219646):0.5304054891):0.6651103839,(t258:0.627824791,(t259:0.5664021066,t260:0.5596873522):0.04352714571):1.474915637):1.012343063,((((t261:0.9432701047,t262:0.9341854106):1.31604028,((t263:1.609233323,(t264:1.341778864,t265:1.320385478):0.2618949369):0.2574949356,((t266:0.9882848702,((t267:0.06635424798,t268:0.04737767668):0.7314936433,((t269:0.4724841504,(t270:0.4279090932,(t271:0.0712293362,t272:0.0559085927):0.3560680227):0.03545703066):0.144318916,(t273:0.4859403141,t274:0.4832609545):0.1040608775):0.1563354427):0.1789917574):0.7538566848,(t275:0.3219244728,t276:0.3139614147):1.334147803):0.08447848753):0.3729054683):0.02917193096,(t277:0.4049232847,t278:0.3889817727):1.725285569):0.2600910167,((((t279:0.4914811221,t280:0.4885715504):0.1341206059,t281:0.5945430764):0.2721087998,t282:0.8634601409):0.4395151751,(((t283:0.2928081431,t284:0.2866662841):0.5697744411,((t285:0.5731425938,t286:0.5684630666):0.04610049525,t287:0.6107509785):0.2335415714):0.2635837309,(t288:0.6662991656,t289:0.6396500561):0.4400576286):0.1728954032):1.028016204):0.5418333397):0.4421524909):0.05182313908):0.1258846585):0.02304970351,(((((((t290:1.287057206,(t291:0.3821416194,t292:0.379131757):0.8934979832):0.4087735238,(t293:1.602555855,((t294:0.3063811221,t295:0.2900221197):0.6629833924,(((t296:0.1785238218,t297:0.173571986):0.03057351006,(t298:0.1087557366,t299:0.1032830502):0.08330372435):0.3617812583,t300:0.5307509442):0.3802522413):0.6294949819):0.06943134801):0.5199718857,((((((t301:0.6342528224,t302:0.6333178875):0.4039689985,t303:1.016199258):0.0293736834,((t304:0.06468057981,t305:0.06031354321):0.5037564448,t306:0.5522357026):0.4687005616):0.2852159719,(t307:1.249372072,(t308:0.7934535358,t309:0.7767983171):0.455243462):0.05568738281):0.3391433328,(((((t310:0.01213486528,t311:0.0005720796189):0.1880198333,t312:0.1724304678):0.1891676696,t313:0.3489558879):0.1417433441,t314:0.4704233874):0.1524883351,t315:0.5990610667):0.9411119943):0.2479153095,((t316:0.3809459038,t317:0.3745653753):1.016105802,(t318:0.3852301569,t319:0.3840319059):0.9869733958):0.390688068):0.1840141872):0.4331132158,(((t320:0.595074618,t321:0.5888593118):0.6074849083,(t322:0.2351729714,t323:0.2334933175):0.9590700357):0.1263060951,((t324:0.2784082845,t325:0.2749365588):0.3515017101,t326:0.6252177916):0.6803510669):1.032011254):0.1428347411,((t327:2.242803708,(((t328:0.5086982046,(t329:0.2515296323,t330:0.2471299069):0.2317191661):0.6066565042,(t331:0.03393384387,t332:0.02778692449):1.045926579):0.364746487,t333:1.422098124):0.7611723639):0.03549972648,(((((t334:0.2240456487,(t335:0.08383195474,t336:0.07535691315):0.1302710829):0.328077761,(t337:0.5224864654,t338:0.5087140259):0.008891370508):0.1207858541,((t339:0.3804800994,((t340:0.1266097482,t341:0.1197482099):0.1173338765,t342:0.2312627566):0.1304104748):0.1267583319,(t343:0.4097300498,t344:0.405370617):0.05754703893):0.1278018228):0.2794469102,t345:0.8657341305):1.2206409,(((t346:0.7145358817,t347:0.7014176769):0.01000091218,t348:0.7031857631):0.8315395555,(t349:1.517667788,(t350:0.7238749861,(t351:0.1172827811,t352:0.09910663327):0.5933675442):0.7906090337):0.006032434195):0.496361034):0.04130438351):0.1935919912):0.08230499262,((((t353:0.3965028962,t354:0.3937435172):1.006103305,((t355:1.134633251,(((t356:0.2074677856,t357:0.2001452263):0.07228915177,t358:0.2659319323):0.1506577246,(t359:0.3180048021,(t360:0.3049239443,t361:0.2936631822):0.008382460953):0.07630851768):0.7030220671):0.01483149559,((t362:0.06440055576,t363:0.06423754869):0.5888051549,(t364:0.3758697028,t365:0.3646921371):0.2652526487):0.4373948076):0.2495270731):0.4373828269,(((t366:0.3064502721,t367:0.2788241033):0.1407884182,(t368:0.07682866339,t369:0.06896042488):0.3343160593):0.368724057,(t370:0.455840534,t371:0.4517385049):0.2955648383):0.9378658894):0.2990847725,(((t372:0.71088113,t373:0.6871202581):1.1298977,((((t374:0.3650840002,t375:0.3612103253):0.4159820962,(((t376:0.5702565933,(t377:0.1593728778,t378:0.1466239537):0.4067782421):0.06493325614,t379:0.6040556511):0.06835017452,t380:0.6679492302):0.04747194):0.4903289024,t381:1.204133983):0.09342018053,(((t382:0.05111224015,t383:0.04802078558):0.4731684837,t384:0.5087502691):0.2880199208,t385:0.7878481502):0.4732079338):0.4491775719):0.001144962358,(((t386:0.08175228395,t387:0.07737798061):0.01485165755,t388:0.08645258515):0.5753706676,t389:0.6593774891):1.03740925):0.1410236278):0.1439356362):0.1868310065,(((t390:0.5371315441,((t391:0.3900250006,t392:0.3758785402):0.02776480599,((t393:0.1345609671,t394:0.1258436098):0.004048800314,t395:0.1287400282):0.2575615001):0.1102926548):0.1901318492,((t396:0.5624253102,(t397:0.1969609275,t398:0.1935816537):0.3634660252):0.1116734721,t399:0.6645986116):0.002461134321):0.2339194577,(t400:0.7960235211,t401:0.793413877):0.1048719391):1.206812646):0.3712386366):0.03524597268):0.4247804692,((t402:2.528681113,((t403:0.04174986804,t404:0.03751995467):2.237450056,(t405:0.711934405,((t406:0.1244169722,t407:0.1030336904):0.498140699,(t408:0.3754309754,(t409:0.06829548347,t410:0.0541789258):0.2992528044):0.1939565729):0.08700426421):1.562087313):0.2432749802):0.01747084138,(((((t411:0.7078022926,(((t412:0.01222683862,t413:0.0002665246174):0.433177662,(t414:0.3300774618,(t415:0.1888006796,t416:0.1645064837):0.138221848):0.08510717312):0.2129158265,(t417:0.1344163677,(t418:0.02646370482,t419:0.01846716009):0.09072845815):0.4538302292):0.0369908456):0.1145582418,t420:0.7112019233):0.4920768823,(((t421:0.5830183494,(((t422:0.07872037304,t423:0.07701569349):0.03000387323,t424:0.1051766886):0.2729196825,t425:0.3764775753):0.1475345498):0.1152251157,t426:0.6391029515):0.4368699669,(t427:0.5922376346,t429:0.5756231958):0.4504971027):0.05688493688):0.5178934078,(((t430:0.04640404415,t431:0.04072831836):0.2468629322,t432:0.2778438908):0.3771676567,t434:0.6321604751):0.8706371205):0.2962978942,((t435:1.004299485,(t436:0.07409927759,(t437:0.03411525118,t438:0.001227437356):0.03173874404):0.9234439875):0.4262762945,t439:1.373867625):0.3508747348):0.3276746877):0.3902041977):0.4094194731):0.3169404783):0.4819536737);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           

              <!-- popSize prior -->


              <!-- samplingIntensity prior -->
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="PrefBSP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="2.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="prefbsp.fixedtree.fixedgroups.linear_epoch_24.boombust.T91.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
