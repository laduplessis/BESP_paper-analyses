<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast beautitemplate='Standard' beautistatus='' namespace="beast.core
                                                           :beast.evolution.alignment
                                                           :beast.evolution.tree.coalescent
                                                           :beast.core.util
                                                           :beast.core.parameter
                                                           :beast.evolution.nuc
                                                           :beast.evolution.operators
                                                           :beast.evolution.sitemodel
                                                           :beast.evolution.substitutionmodel
                                                           :beast.evolution.likelihood
                                                           :beast.evolution.tree
                                                           :beast.util
                                                           :bsp.distributions
                                                           :bsp.util"
          required="" version="2.5">
    
<map name="Uniform" >beast.math.distributions.Uniform</map>
<map name="Exponential" >beast.math.distributions.Exponential</map>
<map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
<map name="Normal" >beast.math.distributions.Normal</map>
<map name="Beta" >beast.math.distributions.Beta</map>
<map name="Gamma" >beast.math.distributions.Gamma</map>
<map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
<map name="prior" >beast.math.distributions.Prior</map><map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
<map name="OneOnX" >beast.math.distributions.OneOnX</map>



<!-- Fixed tree with date trait -->
<tree spec='TreeParser' id='tree' IsLabelledNewick="true" adjustTipHeights="false" newick="(((((t377:1.708388598,(((((t378:0.1111321859,t379:0.09885145207):0.2221514308,(t380:0.158069032,t381:0.1292151397):0.1427480408):0.3243944022,(t382:0.2615027941,t383:0.244793353):0.3266608056):0.03340176251,t384:0.6034742209):0.02033122452,t385:0.6180519609):0.9543467874):0.4270225236,(((((t387:0.368288021,(t388:0.1413862992,(t389:0.01712201591,t390:0.01497848188):0.1137912451):0.2261262823):0.3400566388,(((t391:0.2214037918,t392:0.1989635976):0.1011786816,(t393:0.1405833759,(t394:0.05485546911,t395:0.04900447477):0.07791162579):0.156847998):0.1327424916,t396:0.4102090353):0.2368867122):0.1278321192,(t397:0.2408818278,(t398:0.01420989832,t399:0.01253130662):0.2266601539):0.5012826392):0.1733999693,((t400:0.3934921631,t401:0.3886902418):0.4520948788,(t402:0.5236467019,t403:0.5189070947):0.3081649296):0.06432425016):0.032127319,((t404:0.4687263353,t405:0.4656490605):0.3290174298,(((((t406:0.06096166306,t407:0.04396216788):0.09674929666,t408:0.1281859616):0.2351338534,t409:0.3596012191):0.06851695019,(t410:0.09811426219,t411:0.08273722392):0.318942288):0.03406223386,(t412:0.1344047041,t413:0.119233396):0.2939849278):0.2976075732):0.1148122315):0.9300431282):0.61314402,(((t414:0.1023026265,t415:0.08833400938):0.02712615423,t416:0.1069263039):0.8637527123,(t417:0.5956890166,((t418:0.1333642403,t419:0.124039472):0.4483522333,(t420:0.3992667479,((t421:0.2072841857,t422:0.2040112624):0.08731368891,t423:0.2879350341):0.07498749764):0.1725338579):0.006553802684):0.3695204455):1.35878686):1.370014935,(((t424:1.219234492,((t425:0.1108649307,t426:0.1090736125):0.8254585097,t427:0.9269774212):0.2752121336):0.4535277646,((t428:0.8489915809,((t429:0.1535033981,t431:0.1246508208):0.6257702174,(t432:0.4559668446,(t434:0.2693644648,t436:0.2354801801):0.1641158041):0.2889823356):0.06778392609):0.5912226006,(((t437:0.007652095294,t438:0.004720718152):0.1682395236,t439:0.1644862116):0.7539541948,(((t440:0.3396869875,t441:0.3247714171):0.1795193126,(t442:0.2975368295,t443:0.2906779666):0.1930398391):0.1565243856,(t444:0.6031532745,t445:0.5925540468):0.02656921372):0.2389489135):0.410515491):0.2082134208):0.5331145177,((t446:0.6030850752,t447:0.5926911052):0.06060402419,((((t448:0.1701567998,t449:0.1554243442):0.04624739555,t450:0.2011063635):0.05878357114,t451:0.2552288625):0.2733740797,(t452:0.4910866478,(t453:0.08947722899,t454:0.08626667709):0.4005109852):0.03685238095):0.1000639844):1.337841472):1.432818461):1.025999263,((((t455:0.146557475,t456:0.1381002248):0.4140068796,(t457:0.07993045388,t458:0.06636787355):0.453860917):1.136908715,((t459:0.009400339263,(t435:0.00601229465,(t433:0.004528174314,(t430:0.0004512159037,(t386:0.008311042828,(((t61:0.003570265157,t1:0.617155648):2.052024983,t2:2.622500758):1.498530196,((t3:2.867037558,t4:2.86137481):0.8557530013,(t5:2.49471227,t6:2.485447833):1.221465449):0.3981281159):0.1943751724):0.3622086092):0.03659807042):0.02047885854):0.1999608613):1.641689802,(((((((t7:2.557959697,t8:2.547481793):1.305877673,(t9:1.638128154,t10:1.633761757):2.200497117):0.5940708151,(((((t11:1.41516342,(t12:0.7600700016,t13:0.7580782735):0.6543669744):1.11504581,t14:2.524793883):0.4692578021,t15:2.988582616):0.8523805974,t16:3.79688162):0.5491002863,(t17:0.5028147061,t18:0.4952723167):3.839864542):0.02547890679):0.7221428426,((t19:3.698726971,(((t20:2.410649928,t21:2.404945177):0.4609525234,(t22:2.44219608,t23:2.441478352):0.4220403971):0.1041421119,t24:2.934463905):0.7064030037):0.8897971452,(((((((t25:3.024939345,(t26:0.4668421597,t27:0.465598157):2.551065613):0.3058032872,t28:3.296378752):0.01818099201,(t29:1.133335136,t30:1.106535331):2.179371989):0.1598897897,(t31:3.163528461,t32:3.163132005):0.2809589883):0.3021566264,(((t33:2.538753827,(((((t34:1.00234479,t35:0.999131338):0.5532669682,(t36:0.1962353338,t37:0.1883990004):1.326144936):0.01281794681,t38:1.514521657):0.4034308911,t39:1.905424106):0.4325205645,t40:2.33415758):0.130351002):1.04652379,(t41:2.51145334,((t42:2.200812073,(t43:1.065075049,t44:1.053069725):1.113198642):0.2538100759,(t45:2.184936318,t46:2.181970393):0.2324183299):0.05436069134):0.9680581656):0.05754145961,t47:3.493310037):0.09369709806):0.3674717547,((((t48:3.215479382,t49:3.206785987):0.4406160614,((t50:2.366148784,t51:2.36082261):0.7060476556,((((t52:0.280222269,t53:0.2735281062):0.7332824936,t54:1.004171786):0.9021652005,t55:1.904502961):0.8788259249,t56:2.764624859):0.2699107292):0.5727241938):0.1081262146,(t57:3.621220883,(((t58:1.695903023,(t59:1.532581832,t60:1.525589018):0.1589193606):1.167317712,(t62:2.641138998,(t63:0.5187014091,t64:0.5172552773):2.115935495):0.1710199081):0.4078413576,(t65:2.789824688,t66:2.769102663):0.4127781424):0.3369940316):0.08828396278):0.1072061191,(t67:1.949343879,t68:1.943762045):1.758477346):0.08218322971):0.1151002701,((((t69:2.491204843,(t70:0.03745335012,t71:0.03277840013):2.442286361):0.3394384816,t72:2.790032231):0.6898806728,((t73:3.128929834,t74:3.125281018):0.2271147496,(t75:0.668901226,t76:0.6668747121):2.681583753):0.1208411971):0.04281592334,(((t77:0.01698200821,t78:0.006694555214):0.857252977,t79:0.8576530363):0.7780463209,t80:1.622229868):1.841414551):0.3342348353):0.2250528508):0.4508195036):0.4595532534,((((t81:0.9724712296,t82:0.9670474064):1.855287698,((t83:0.7871652336,t84:0.7772739757):1.50744537,t85:2.27234148):0.4960771748):0.5293654691,((t86:2.502277071,(t87:0.4156726086,((t88:0.01972751447,t89:0.01068122668):0.1329609377,t90:0.1387751734):0.2611061188):2.07397936):0.7332698229,(((t91:0.1888737243,t92:0.1781223821):0.3542420914,t93:0.5255083132):1.324273394,((t94:0.2269683332,t95:0.2053151893):1.073130555,t96:1.244112801):0.5465527071):1.334620151):0.01873062788):1.322000044,((t97:0.5648441339,t98:0.5563640774):2.662466382,t99:3.191738624):1.234548737):0.2513785389):0.4248443136,((((t100:0.8207370347,t101:0.8174062459):1.528810215,(t102:1.908935324,(t103:1.50494709,t104:1.497210195):0.394458456):0.4218921157):0.7022755251,(t105:1.368745958,t106:1.367393279):1.626029563):2.002624982,(((((((t107:2.193783742,t108:2.190839978):0.007556749032,t109:2.172146348):1.319450799,(((t110:2.512585855,((t111:1.665219742,t112:1.645688599):0.4978496194,(t113:1.823222752,t114:1.807296979):0.3182314648):0.336507859):0.08696730014,(t115:2.19059776,t116:2.170033239):0.3482856861):0.7968380631,((t117:2.259278138,(t118:1.798369416,t119:1.79771866):0.459743232):0.01777201969,(t120:0.2090777209,t121:0.1976806348):2.062992102):1.037732782):0.0924982512):0.3437296964,((t122:3.20452953,((t123:2.773286383,(t124:1.975396003,((t125:0.05361678794,t126:0.03175264648):1.582146218,t127:1.60232881):0.3379554049):0.7871228836):0.2744428736,(((t128:0.7856050595,t129:0.7714256825):1.83880261,(t130:2.490566474,((t131:1.325733818,(t132:1.253074494,(t133:1.189284143,(t134:0.7506115165,t135:0.7381370662):0.4222355233):0.06164515145):0.06970313233):1.009598803,((t136:1.671365848,t137:1.644526174):0.5586935159,t138:2.166590655):0.06325494973):0.1415618756):0.1136154166):0.1093772423,t139:2.580457346):0.24057294):0.135088023):0.01115950002,((t140:1.501788516,t141:1.498512632):1.421783943,t142:2.904469353):0.04360023127):0.5005626831):0.0555993166,((((t143:2.082677864,(t144:0.8365006073,(t145:0.2723430999,t146:0.2710258174):0.5546489645):1.244595949):0.1298795084,(t147:1.990481025,t148:1.982535879):0.1908110744):0.5351660015,(((t149:1.815289705,t150:1.813246425):0.4028945682,((t151:0.6388347076,t152:0.618514638):1.570376123,t153:2.184677006):0.004300979563):0.2545572445,(t154:1.854266824,t155:1.828878796):0.5796184676):0.2275604467):0.03219098078,((t156:1.137634193,(t157:0.9889791035,t158:0.970987229):0.1299441252):0.8226085925,t159:1.862764583):0.6915898254):0.7082249035):0.1416416582,(((t160:1.638996911,t161:1.614600488):0.5110421474,(t162:0.7015929798,t163:0.700211602):1.411485727):0.5180896811,(((t164:2.263104384,((t165:1.456074266,(t166:1.242293049,t167:1.213770886):0.2108683963):0.4116000358,(((t168:0.4544128498,(t169:0.4271783249,t170:0.3979481162):0.006671496486):0.5239440279,t171:0.9128033862):0.02796981675,t172:0.9335008209):0.8106193408):0.3932975031):0.3027093987,(((t173:0.8076696899,t174:0.8032921004):0.83291513,(t175:0.9692417798,(t176:0.5670348094,t177:0.5503859759):0.3892887474):0.6635124806):0.7599617762,(t178:1.459105555,(t179:0.5398370555,t180:0.5314612799):0.8951767852):0.8720580184):0.01672156891):0.00764775271,t181:2.322295223):0.05438902738):0.7326751194):0.004417293436,((t182:2.095897395,(t183:1.077908647,(t184:0.342229237,t185:0.3189979325):0.6775299956):1.015113543):0.4806459006,(((t186:0.8047173266,t187:0.7942387522):1.352408166,((t188:0.3841618109,t189:0.3748526044):1.143000293,t190:1.511584487):0.6035724828):0.1753329015,(t191:2.056156455,((t192:0.9812587633,(t193:0.5514709159,(t194:0.4456736246,t195:0.4387459419):0.09393129551):0.4288303733):0.8307938052,t196:1.781548125):0.2429516911):0.228300363):0.153231971):0.5270050191):0.9218863509):0.03828728041):0.391606556,(((t197:0.1539307642,t198:0.145212046):3.040379216,(((t199:1.71280426,t200:1.711894154):0.5821089863,((t201:1.307566145,t202:1.300930798):0.1183592754,t203:1.417975264):0.867896747):0.793086554,(t204:0.9664190935,(t205:0.8482521058,(t206:0.3757281587,t207:0.368460674):0.4582532491):0.1130736401):2.110921257):0.08998331052):0.6575271592,((((t208:0.3236827209,t209:0.3163079087):1.096748765,(t210:1.250097139,(t211:0.9997150725,t212:0.984860846):0.2151187695):0.142205459):1.73579132,((t213:0.3140592901,t214:0.30319155):2.330402051,(t215:1.988726629,(((t216:0.7653613476,t217:0.7608040685):0.7201161132,t218:1.469511966):0.2560072468,((t219:0.8576798237,t220:0.8513290972):0.3801606845,((t221:0.1487989322,t222:0.1408090262):0.3608843787,t223:0.4941635278):0.7162182708):0.4651646805):0.2366769602):0.635972872):0.4318365671):0.1164415002,((((t224:0.5536802791,t225:0.5426747944):1.457697123,t226:1.99710272):0.08929283089,((t227:0.2153876558,t228:0.186889617):1.073259413,(t229:0.4636390524,t230:0.4515864123):0.7675211546):0.7959266388):0.3404094956,(((((t231:1.57488275,(t232:0.6859028124,t233:0.6857599785):0.8825562061):0.02238560975,(t234:1.520024158,(t235:0.5616497269,t236:0.5613241521):0.9382371293):0.06450462349):0.05648764302,((((t237:1.032532447,t238:1.019228526):0.09260361811,t239:1.100742288):0.1793483436,((t240:0.494496577,t241:0.4829915594):0.3215923043,(t242:0.34963199,t243:0.2885546415):0.4499074967):0.4578551025):0.2543019233,t244:1.429258241):0.04703548035):0.3993771565,((t245:0.1601179583,t246:0.15960681):0.7626935003,t247:0.9219424267):0.9228302182):0.2057924437,((t248:0.7700688377,t249:0.7548001738):1.108808474,t250:1.837651526):0.1601496134):0.09384472482):0.6434624735):0.5154164487):0.4284404076):0.08670374343):0.002196638352):1.9335446,((((((((((t251:1.534751426,(t252:1.434638365,((t253:0.7122125555,t254:0.6927588478):0.315373213,(t255:0.6968304521,t256:0.6870874117):0.3023726327):0.391684927):0.09142035062):0.1050809706,((t257:0.3917864154,(t258:0.2452469298,t259:0.2424665399):0.1387841072):0.9249836262,((t260:0.7159978112,(t261:0.5307150852,t262:0.5300512736):0.1723949278):0.2730745037,t263:0.9637733043):0.3071275735):0.2192520383):0.2247283862,t264:1.694936723):0.0453941998,t265:1.739714262):0.1130000909,t266:1.844348422):0.1275878031,((t267:1.511559438,t268:1.510217387):0.4006912387,(((t269:1.37507015,((t270:0.02072719536,t271:0.01624973199):0.5158471616,t272:0.5296117241):0.8368163093):0.0777451571,(t273:0.5811048014,t274:0.5671522987):0.8599285586):0.4124799418,(t275:1.011309217,t276:0.999388217):0.8263472865):0.03852724839):0.04344771503):0.917749171,(t277:0.09146017626,t278:0.08738282963):2.72859913):0.3671091455,((((t279:0.9632698157,((t280:0.4019574722,t281:0.3890052315):0.46502462,t282:0.8467691127):0.08016131216):0.8234934483,(((t283:0.6002361462,(t284:0.1782302215,t285:0.1548338276):0.413827089):0.8259488265,(((t286:0.5046435179,(t287:0.04662109348,t288:0.0294863304):0.4524350426):0.3443120727,t289:0.8139319623):0.2943838692,t290:1.106963238):0.2325925464):0.2116874631,((t291:0.6206122085,t292:0.6064152612):0.7179934851,t293:1.323366947):0.1451721043):0.1062868181):0.6092458642,(((t294:0.05234689498,t295:0.0491884804):1.700958296,((((((t296:0.4171584797,(t297:0.2595868323,t298:0.2566128908):0.130501357):0.4133698722,t299:0.7998967445):0.08152452779,(t300:0.4193237199,t301:0.4020968834):0.4580164508):0.009085567315,t302:0.8438129886):0.2067785116,t303:1.047197486):0.06889380392,(t304:0.7890363949,t305:0.7643653091):0.3187534582):0.5391002783):0.1585112067,(((((t306:0.6261612065,(t307:0.4699766655,(t308:0.3105838463,t309:0.2811379174):0.1525059441):0.1538058662):0.1768766487,t310:0.7544557137):0.1418831668,((t311:0.7672149753,((t312:0.3912207382,t313:0.3688559834):0.366016358,t314:0.7189585075):0.0001044138476):0.01971965586,((t315:0.2648383169,t316:0.2502034289):0.03255317894,t317:0.2808259609):0.4289049603):0.1078411704):0.3331972411,(t318:0.2729083818,t319:0.2717406299):0.8630405289):0.1278143327,(t320:0.1965264148,t321:0.194998435):1.044720368):0.3623366423):0.2457353767):0.3593702115,((((t322:0.02973337055,t323:0.02934117757):1.034642111,((t324:0.7875378323,t325:0.7850058371):0.1786854053,t326:0.9412266603):0.08793826195):0.3627970736,(((t327:0.2023159422,t328:0.1973172924):0.2807377681,t329:0.4721095145):0.1163216979,t330:0.5839937519):0.7786577351):0.05703616137,t331:1.417591839):0.7227132788):0.3929097978):1.365317843,(((t332:0.4826647683,t333:0.4779397155):0.9283876738,(((t334:0.2716982673,t335:0.2570353771):0.05046488123,t336:0.3046387914):0.1232272109,t337:0.4246937135):0.9588243476):0.2222676383,(t338:0.8402808594,t339:0.8336370157):0.7596377986):2.253572408):0.4863391674,((t340:0.4997240707,((t341:0.2770838158,t342:0.255255603):0.04817615091,t343:0.2993387716):0.1732691927):2.849833635,((((((t344:0.7342248587,((t345:0.00633456718,t346:0.001675145594):0.04802814867,t347:0.04967537763):0.6789896794):0.4694806342,(t348:0.6403320565,t349:0.6399259775):0.55190827):0.1765801071,((t350:0.6586654638,(t351:0.554500938,t352:0.5491417867):0.0962881581):0.2393568548,((t353:0.2420800615,t354:0.2408895467):0.2374873128,(t355:0.4498130428,(t356:0.3971719194,t357:0.3700522125):0.05224745646):0.02178084384):0.3964527382):0.4430884104):0.09481309248,((t358:0.1705787456,(t359:0.1080635565,t360:0.08423434528):0.05211470378):1.057609597,((t361:0.1201769922,t362:0.103430785):0.6340715048,t363:0.7369006924):0.4307313887):0.145792588):0.2065062078,((t364:0.02297459115,t365:0.02113943772):1.034994815,(((t366:0.38035603,t367:0.3585290728):0.2168084094,(t368:0.05535680804,t369:0.04084322217):0.4921478327):0.2470450811,t370:0.779661344):0.2064626845):0.4536955244):0.8089038303,(((t371:0.1156500813,t372:0.1061695814):0.5922144597,t373:0.695682709):0.3388008299,((t374:0.1645516605,t375:0.1645045791):0.6134331288,t376:0.76559978):0.2483217779):1.194296424):0.8110103966):0.9507767016):0.3940795414):0.7845817167);
"/>                    

<run id="mcmc" spec="MCMC" chainLength="20000000" sampleFromPrior="False">

    <state id="state">
          <parameter id="PopSizes" dimension="100" lower="0.0" name="stateNode" upper="380000.0">100.0</parameter>          
          <parameter id="SamplingIntensity" dimension="24" lower="0.0" name="stateNode">1</parameter>          
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

          <!-- Begin prior -->
          <distribution id="prior" spec="util.CompoundDistribution">

              <!-- Smoothing prior -->
              <distribution id="MarkovChainedPopSizes" spec="beast.math.distributions.MarkovChainDistribution" jeffreys="true" parameter="@PopSizes"/>
           
          </distribution>
          <!-- End prior -->

          <!-- Begin likelihood -->
          <distribution id="likelihood" spec="util.CompoundDistribution">

              <!-- Treeprior / Tree likelihood (Bayesian Skyline Plot) -->
              <distribution id="BayesianSkyline" spec="BESP" popSizes="@PopSizes" samplingIntensity="@SamplingIntensity" minWidth="0.001">
                  <treeIntervals id="BSPTreeIntervals" spec="TreeIntervals" tree="@tree"/>
                  <samplingEpochTimes id="EpochTimes" spec="RealParameter" value="0.2083333 0.4166667 0.6250000 0.8333333 1.0416667 1.2500000 1.4583333 1.6666667 1.8750000 2.0833333 2.2916667 2.5000000 2.7083333 2.9166667 3.1250000 3.3333333 3.5416667 3.7500000 3.9583333 4.1666667 4.3750000 4.5833333 4.7916667"/>                  
              </distribution>

          </distribution>
          <!-- End likelihood -->

    </distribution>


    <!-- Begin operators -->
          
          <!-- BSP operators -->
          <operator id="popSizesScaler" spec="ScaleOperator" parameter="@PopSizes" scaleFactor="0.75" weight="15.0"/>

          <operator id="samplingScaler" spec="ScaleOperator" parameter="@SamplingIntensity" scaleFactor="0.5" weight="5.0"/>

          <operator id="updownBD.t:tree" spec="UpDownOperator" scaleFactor="0.75" weight="5.0">
              <up   idref="SamplingIntensity"/>
              <down idref="PopSizes"/>              
          </operator>

    <!-- End operators -->


    <logger id="tracelog" fileName="besp.fixedtree.fixedgroups.linear_epoch_24.boombust.T0.log" logEvery="20000" model="@posterior" sanitiseHeaders="true" sort="smart">
        <log idref="posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
        <log idref="BayesianSkyline"/>

        <log id="TreeHeight" spec="beast.evolution.tree.TreeHeightLogger" tree="@tree"/>        
        <log idref="PopSizes"/> 
        <log id="PopSizeChangeTimes" spec="popSizeChangeTimeLogger" skyline="@BayesianSkyline"/> 
        <log idref="SamplingIntensity"/>        
        <log id="samplingIntensityChangeTimes" spec="samplingIntensityChangeTimeLogger" skyline="@BayesianSkyline"/> 
    </logger>

    <logger id="screenlog" logEvery="200000">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

</run>

</beast>
